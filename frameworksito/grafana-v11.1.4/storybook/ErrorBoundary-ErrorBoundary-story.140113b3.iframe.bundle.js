"use strict";(self.webpackChunk_grafana_ui=self.webpackChunk_grafana_ui||[]).push([[1422],{"./src/components/ErrorBoundary/ErrorWithStack.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{D:function(){return ErrorWithStack}});var _emotion_css__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/@emotion/css/dist/emotion-css.esm.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/index.js"),_themes__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/themes/ThemeContext.tsx"),ErrorWithStack=function(param){var error=param.error,errorInfo=param.errorInfo,title=param.title,style=(0,_themes__WEBPACK_IMPORTED_MODULE_2__.of)(getStyles);return react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",{className:style},react__WEBPACK_IMPORTED_MODULE_1__.createElement("h2",null,title),react__WEBPACK_IMPORTED_MODULE_1__.createElement("details",{style:{whiteSpace:"pre-wrap"}},error&&error.toString(),react__WEBPACK_IMPORTED_MODULE_1__.createElement("br",null),errorInfo&&errorInfo.componentStack))};ErrorWithStack.displayName="ErrorWithStack";var getStyles=function(){return(0,_emotion_css__WEBPACK_IMPORTED_MODULE_0__.AH)({width:"500px",margin:"64px auto"})};try{ErrorWithStack.displayName="ErrorWithStack",ErrorWithStack.__docgenInfo={description:"",displayName:"ErrorWithStack",props:{title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},error:{defaultValue:null,description:"",name:"error",required:!0,type:{name:"Error | null"}},errorInfo:{defaultValue:null,description:"",name:"errorInfo",required:!0,type:{name:"ErrorInfo | null"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ErrorBoundary/ErrorWithStack.tsx#ErrorWithStack"]={docgenInfo:ErrorWithStack.__docgenInfo,name:"ErrorWithStack",path:"src/components/ErrorBoundary/ErrorWithStack.tsx#ErrorWithStack"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/ErrorBoundary/ErrorBoundary.story.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Basic:function(){return Basic},BoundaryAlert:function(){return BoundaryAlert},WithStack:function(){return WithStack},default:function(){return ErrorBoundary_story}});var react=__webpack_require__("../../node_modules/react/index.js"),Alert=__webpack_require__("./src/components/Alert/Alert.tsx"),Button=__webpack_require__("./src/components/Button/Button.tsx");let faro={};var ErrorWithStack=__webpack_require__("./src/components/ErrorBoundary/ErrorWithStack.tsx");function _assert_this_initialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _class_call_check(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _create_class(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _get_prototype_of(o){return _get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_get_prototype_of(o)}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_set_prototype_of(subClass,superClass)}function _possible_constructor_return(self,call){return!call||"object"!==function _type_of(obj){return obj&&"undefined"!=typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj}(call)&&"function"!=typeof call?_assert_this_initialized(self):call}function _set_prototype_of(o,p){return _set_prototype_of=Object.setPrototypeOf||function setPrototypeOf(o,p){return o.__proto__=p,o},_set_prototype_of(o,p)}function _create_super(Derived){var hasNativeReflectConstruct=function _is_native_reflect_construct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_get_prototype_of(Derived);if(hasNativeReflectConstruct){var NewTarget=_get_prototype_of(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possible_constructor_return(this,result)}}var ErrorBoundary=function(PureComponent){_inherits(ErrorBoundary,PureComponent);var _super=_create_super(ErrorBoundary);function ErrorBoundary(){var _this;return _class_call_check(this,ErrorBoundary),_define_property(_assert_this_initialized(_this=_super.apply(this,arguments)),"state",{error:null,errorInfo:null}),_this}return _create_class(ErrorBoundary,[{key:"componentDidCatch",value:function componentDidCatch(error,errorInfo){var _faro_api;null==faro||null===(_faro_api=faro.api)||void 0===_faro_api||_faro_api.pushError(error),this.setState({error:error,errorInfo:errorInfo}),this.props.onError&&this.props.onError(error)}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){var _this_props=this.props,dependencies=_this_props.dependencies,onRecover=_this_props.onRecover;if(this.state.error&&dependencies&&prevProps.dependencies)for(var i=0;i<dependencies.length;i++)if(dependencies[i]!==prevProps.dependencies[i]){this.setState({error:null,errorInfo:null}),onRecover&&onRecover();break}}},{key:"render",value:function render(){var children=this.props.children,_this_state=this.state;return children({error:_this_state.error,errorInfo:_this_state.errorInfo})}}]),ErrorBoundary}(react.PureComponent),ErrorBoundaryAlert=function(PureComponent){_inherits(ErrorBoundaryAlert,PureComponent);var _super=_create_super(ErrorBoundaryAlert);function ErrorBoundaryAlert(){return _class_call_check(this,ErrorBoundaryAlert),_super.apply(this,arguments)}return _create_class(ErrorBoundaryAlert,[{key:"render",value:function render(){var _this_props=this.props,title=_this_props.title,children=_this_props.children,style=_this_props.style,dependencies=_this_props.dependencies;return react.createElement(ErrorBoundary,{dependencies:dependencies},(function(param){var error=param.error,errorInfo=param.errorInfo;return errorInfo?"alertbox"===style?react.createElement(Alert.F,{title:title||""},react.createElement("details",{style:{whiteSpace:"pre-wrap"}},error&&error.toString(),react.createElement("br",null),errorInfo.componentStack)):react.createElement(ErrorWithStack.D,{title:title||"",error:error,errorInfo:errorInfo}):children}))}}]),ErrorBoundaryAlert}(react.PureComponent);function withErrorBoundary(Component){var errorBoundaryProps=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},comp=function(props){return React.createElement(ErrorBoundaryAlert,errorBoundaryProps,React.createElement(Component,props))};return comp.displayName="WithErrorBoundary",comp}_define_property(ErrorBoundaryAlert,"defaultProps",{title:"An unexpected error happened",style:"alertbox"});try{withErrorBoundary.displayName="withErrorBoundary",withErrorBoundary.__docgenInfo={description:"HOC for wrapping a component in an error boundary.",displayName:"withErrorBoundary",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ErrorBoundary/ErrorBoundary.tsx#withErrorBoundary"]={docgenInfo:withErrorBoundary.__docgenInfo,name:"withErrorBoundary",path:"src/components/ErrorBoundary/ErrorBoundary.tsx#withErrorBoundary"})}catch(__react_docgen_typescript_loader_error){}try{ErrorBoundary.displayName="ErrorBoundary",ErrorBoundary.__docgenInfo={description:"",displayName:"ErrorBoundary",props:{dependencies:{defaultValue:null,description:"Will re-render children after error if recover values changes",name:"dependencies",required:!1,type:{name:"unknown[]"}},onError:{defaultValue:null,description:"Callback called on error",name:"onError",required:!1,type:{name:"((error: Error) => void)"}},onRecover:{defaultValue:null,description:"Callback error state is cleared due to recover props change",name:"onRecover",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ErrorBoundary/ErrorBoundary.tsx#ErrorBoundary"]={docgenInfo:ErrorBoundary.__docgenInfo,name:"ErrorBoundary",path:"src/components/ErrorBoundary/ErrorBoundary.tsx#ErrorBoundary"})}catch(__react_docgen_typescript_loader_error){}try{ErrorBoundaryAlert.displayName="ErrorBoundaryAlert",ErrorBoundaryAlert.__docgenInfo={description:"",displayName:"ErrorBoundaryAlert",props:{title:{defaultValue:{value:"An unexpected error happened"},description:"Title for the error boundary alert",name:"title",required:!1,type:{name:"string"}},children:{defaultValue:null,description:"Component to be wrapped with an error boundary",name:"children",required:!0,type:{name:"ReactNode"}},style:{defaultValue:{value:"alertbox"},description:"'page' will render full page error with stacktrace. 'alertbox' will render an <Alert />. Default 'alertbox'",name:"style",required:!1,type:{name:"enum",value:[{value:'"page"'},{value:'"alertbox"'}]}},dependencies:{defaultValue:null,description:"Will re-render children after error if recover values changes",name:"dependencies",required:!1,type:{name:"unknown[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ErrorBoundary/ErrorBoundary.tsx#ErrorBoundaryAlert"]={docgenInfo:ErrorBoundaryAlert.__docgenInfo,name:"ErrorBoundaryAlert",path:"src/components/ErrorBoundary/ErrorBoundary.tsx#ErrorBoundaryAlert"})}catch(__react_docgen_typescript_loader_error){}var jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),lib=__webpack_require__("../../node_modules/@storybook/addon-docs/node_modules/@mdx-js/react/lib/index.js"),dist=__webpack_require__("../../node_modules/@storybook/blocks/dist/index.mjs");function _createMdxContent(props){const _components={a:"a",code:"code",h1:"h1",h3:"h3",p:"p",pre:"pre",...(0,lib.R)(),...props.components};return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(_components.h1,{id:"errorboundary",children:"ErrorBoundary"}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["A React component that catches errors in child components. Useful for logging or displaying a fallback UI in case of errors. More information about error boundaries is available at ",(0,jsx_runtime.jsx)(_components.a,{href:"https://reactjs.org/docs/error-boundaries.html",rel:"nofollow",children:"React documentation website"}),"."]}),"\n",(0,jsx_runtime.jsx)(_components.h3,{id:"usage",children:"Usage"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-jsx",children:"import { ErrorBoundary, Alert } from '@grafana/ui';\n\n<ErrorBoundary>\n  {({ error }) => {\n    if (error) {\n      return <Alert title={error.message} />;\n    }\n    return <Component />;\n  }}\n</ErrorBoundary>;\n"})}),"\n",(0,jsx_runtime.jsx)(_components.h1,{id:"errorboundaryalert",children:"ErrorBoundaryAlert"}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"An error boundary component with built-in alert to display in case of error."}),"\n",(0,jsx_runtime.jsx)(_components.h3,{id:"usage-1",children:"Usage"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-jsx",children:"import { ErrorBoundaryAlert } from '@grafana/ui';\n\n<ErrorBoundaryAlert>\n  <Component />\n</ErrorBoundaryAlert>;\n"})}),"\n",(0,jsx_runtime.jsx)(_components.h3,{id:"props",children:"Props"}),"\n",(0,jsx_runtime.jsx)(dist.ov,{of:ErrorBoundaryAlert}),"\n",(0,jsx_runtime.jsx)(_components.h1,{id:"errorwithstack",children:"ErrorWithStack"}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"A component that displays error together with its stack trace."}),"\n",(0,jsx_runtime.jsx)(_components.h3,{id:"usage-2",children:"Usage"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-jsx",children:"import { ErrorWithStack } from '@grafana/ui';\n\n<ErrorWithStack error={new Error('Test error')} title={'Unexpected error'} errorInfo={null} />;\n"})}),"\n",(0,jsx_runtime.jsx)(_components.h3,{id:"props-1",children:"Props"}),"\n",(0,jsx_runtime.jsx)(dist.ov,{of:ErrorWithStack.D}),"\n",(0,jsx_runtime.jsx)(_components.h1,{id:"witherrorboundary",children:"withErrorBoundary"}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"a HOC to conveniently wrap component in an error boundary"}),"\n",(0,jsx_runtime.jsx)(_components.h3,{id:"usage-3",children:"Usage"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-jsx",children:"import { withErrorBoundary } from '@grafana/ui';\n\ninterface MyCompProps {}\n\nconst MyComp = withErrorBoundary(\n  (props: MyCompProps) => {\n    return <>...</>;\n  },\n  { style: 'page' }\n);\n"})})]})}function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _sliced_to_array(arr,i){return function _array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||function _iterable_to_array_limit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}(arr,i)||function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var BuggyComponent=function(){var _useState=_sliced_to_array((0,react.useState)(0),2),count=_useState[0],setCount=_useState[1];if(count>2)throw new Error("Crashed");return react.createElement("div",null,react.createElement("p",null,"Increase the count to 3 to trigger error"),react.createElement(Button.$n,{onClick:function(){return setCount(count+1)}},count.toString()))},Basic=function(){return react.createElement(ErrorBoundary,null,(function(param){var error=param.error;return error?react.createElement(Alert.F,{title:error.message}):react.createElement(BuggyComponent,null)}))},WithStack=function(){return react.createElement(ErrorWithStack.D,{error:new Error("Test error"),title:"Unexpected error",errorInfo:null})},BoundaryAlert=function(){return react.createElement(ErrorBoundaryAlert,null,react.createElement(BuggyComponent,null))},ErrorBoundary_story={title:"General/ErrorBoundary",component:ErrorBoundary,parameters:{docs:{page:function MDXContent(props={}){const{wrapper:MDXLayout}={...(0,lib.R)(),...props.components};return MDXLayout?(0,jsx_runtime.jsx)(MDXLayout,{...props,children:(0,jsx_runtime.jsx)(_createMdxContent,{...props})}):_createMdxContent(props)}}}};Basic.parameters={...Basic.parameters,docs:{...Basic.parameters?.docs,source:{originalSource:"() => {\n  return <ErrorBoundary>\n      {({\n      error\n    }) => {\n      if (error) {\n        return <Alert title={error.message} />;\n      }\n      return <BuggyComponent />;\n    }}\n    </ErrorBoundary>;\n}",...Basic.parameters?.docs?.source}}},WithStack.parameters={...WithStack.parameters,docs:{...WithStack.parameters?.docs,source:{originalSource:"() => {\n  return <ErrorWithStack error={new Error('Test error')} title={'Unexpected error'} errorInfo={null} />;\n}",...WithStack.parameters?.docs?.source}}},BoundaryAlert.parameters={...BoundaryAlert.parameters,docs:{...BoundaryAlert.parameters?.docs,source:{originalSource:"() => {\n  return <ErrorBoundaryAlert>\n      <BuggyComponent />\n    </ErrorBoundaryAlert>;\n}",...BoundaryAlert.parameters?.docs?.source}}}}}]);
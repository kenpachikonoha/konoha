"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[6299],{2960:(T,f,t)=>{t.d(f,{Q:()=>D});var n=t(96540),o=t(78368),u=t(14236),g=t(69529),m=t(55852),s=t(8484),c=t(97427),C=t(66359),l=t(31678),v=t(37690);const r=50,E={view:new o.R((0,u.Vc)({fields:[{name:"uid",display:!0,values:Array(r).fill(null)},{name:"kind",display:!0,values:Array(r).fill("dashboard")},{name:"name",display:!0,values:Array(r).fill("")},{name:"location",display:!0,values:Array(r).fill("")},{name:"tags",display:!0,values:Array(r).fill([])}],meta:{custom:{locationInfo:[]}}})),loadMoreItems:()=>Promise.resolve(),isItemLoaded:()=>!1,totalRows:r};function D({width:P,height:O,canSelect:d,searchState:i,searchStateManager:e}){const a=(0,l.useDispatch)(),S=(0,l.useSelector)(_=>_.browseDashboards.selectedItems),p=(0,v.QE)(),{keyboardEvents:y}=(0,c.d)(),M=i.result??E,L=(0,n.useCallback)((_,I)=>_?_==="*"&&I==="*"?p:_==="*"?!1:S[A(_)][I]??!1:!1,[S,p]),U=(0,n.useCallback)(()=>{a((0,v.cT)({isSelected:!1,folderUID:void 0}))},[a]),h=(0,n.useCallback)((_,I)=>{const R=!L(_,I);a((0,v.t$)({item:{kind:A(_),uid:I},isSelected:R}))},[L,a]);if(M.totalRows===0)return n.createElement("div",{style:{width:P}},n.createElement(g.p,{button:n.createElement(m.$n,{variant:"secondary",onClick:e.onClearSearchAndFilters},n.createElement(s.x6,{i18nKey:"browse-dashboards.no-results.clear"},"Clear search and filters")),message:(0,s.t)("browse-dashboards.no-results.text","No results found for your query"),variant:"not-found",role:"alert"}));const W={response:M,selection:d?L:void 0,selectionToggle:d?h:void 0,clearSelection:U,width:P,height:O,onTagSelected:e.onAddTag,keyboardEvents:y,onDatasourceChange:i.datasource?e.onDatasourceChange:void 0,onClickItem:e.onSearchItemClicked};return n.createElement(C.P,{...W})}function A(P){switch(P){case"folder":return"folder";case"dashboard":return"dashboard";case"panel":return"panel"}throw new Error("Unsupported kind"+P)}},49904:(T,f,t)=>{t.d(f,{N:()=>m});var n=t(32264),o=t(10096),u=t(31678);function g(s,c){return c?o.contextSrv.hasPermissionInMetadata(s,c):o.contextSrv.hasPermission(s)}function m(s){const c=g(u.AccessControlAction.DashboardsCreate,s),C=!!((!s||n.$.featureToggles.nestedFolders)&&g(u.AccessControlAction.FoldersCreate)),l=g(u.AccessControlAction.FoldersDelete,s),v=g(u.AccessControlAction.DashboardsWrite,s),r=g(u.AccessControlAction.FoldersWrite,s),E=g(u.AccessControlAction.FoldersPermissionsWrite,s),D=g(u.AccessControlAction.FoldersPermissionsRead,s);return{canCreateDashboards:c,canCreateFolders:C,canDeleteFolders:l,canEditDashboards:v,canEditFolders:r,canSetPermissions:E,canViewPermissions:D}}},92126:(T,f,t)=>{t.r(f),t.d(f,{default:()=>d});var n=t(96540),o=t(70713),u=t(67647),g=t(67608),m=t(8484),s=t(19519),c=t(24439),C=t(31678),l=t(2960),v=t(49904),r=t(37690),E=t(39788);let D;function A(){return D||(D=new E.lC({...E.ue,includePanels:!1,deleted:!0})),D}function P(){const i=A();return[i.useState(),i]}const O=(0,n.memo)(()=>{const i=(0,C.useDispatch)(),[e,a]=P(),{canEditFolders:S,canEditDashboards:p}=(0,v.N)(),y=S||p;return(0,n.useEffect)(()=>{a.initStateFromUrl(void 0),i((0,r.cT)({isSelected:!1,folderUID:void 0}))},[i,a]),n.createElement(g.Y,{navId:"dashboards/recentlyDeleted"},n.createElement(g.Y.Contents,null,n.createElement(u.Z,{placeholder:(0,m.t)("recentlyDeleted.filter.placeholder","Search for dashboards"),value:e.query,escapeRegex:!1,onChange:M=>a.onQueryChange(M)}),n.createElement(s.bj,{showStarredFilter:!1,state:e,getTagOptions:a.getTagOptions,getSortOptions:(0,c.getGrafanaSearcher)().getSortOptions,sortPlaceholder:(0,c.getGrafanaSearcher)().sortPlaceholder,includePanels:!1,onLayoutChange:a.onLayoutChange,onSortChange:a.onSortChange,onTagFilterChange:a.onTagFilterChange,onDatasourceChange:a.onDatasourceChange,onPanelTypeChange:a.onPanelTypeChange,onSetIncludePanels:a.onSetIncludePanels}),n.createElement(o.Ay,null,({width:M,height:L})=>n.createElement(l.Q,{canSelect:y,width:M,height:L,searchStateManager:a,searchState:e}))))});O.displayName="RecentlyDeletedPage";const d=O},19519:(T,f,t)=>{t.d(f,{bj:()=>P});var n=t(32196),o=t(96540),u=t(32264),g=t(40845),m=t(67061),s=t(10880),c=t(55852),C=t(94354),l=t(73725),v=t(99818),r=t(8484),E=t(64161);function D(){return[{value:E.P.Folders,icon:"folder",description:(0,r.t)("search.actions.view-as-folders","View by folders")},{value:E.P.List,icon:"list-ul",description:(0,r.t)("search.actions.view-as-list","View as list")}]}function A(d){const i=d.layout??E.P.Folders;return i===E.P.Folders&&(d.query||d.sort||d.starred||d.tag.length>0)?E.P.List:i}const P=({onLayoutChange:d,onSortChange:i,onStarredFilterChange:e=()=>{},onTagFilterChange:a,getTagOptions:S,getSortOptions:p,sortPlaceholder:y,onDatasourceChange:M,onPanelTypeChange:L,onSetIncludePanels:U,state:h,showStarredFilter:W,hideLayout:_})=>{const I=(0,g.of)(O),R=A(h),K=h.tag.length||h.starred||h.query||h.datasource||h.panel_type?[E.P.Folders]:[];return o.createElement("div",{className:I.actionRow},o.createElement(m.B,{gap:2,alignItems:"center"},o.createElement(v.$,{isClearable:!1,tags:h.tag,tagOptions:S,onChange:a}),u.$.featureToggles.panelTitleSearch&&o.createElement(s.S,{"data-testid":"include-panels",disabled:R===E.P.Folders,value:h.includePanels,onChange:()=>U(!h.includePanels),label:(0,r.t)("search.actions.include-panels","Include panels")}),W&&o.createElement("div",{className:I.checkboxWrapper},o.createElement(s.S,{label:(0,r.t)("search.actions.starred","Starred"),onChange:e,value:h.starred})),h.datasource&&o.createElement(c.$n,{icon:"times",variant:"secondary",onClick:()=>M(void 0)},o.createElement(r.x6,{i18nKey:"search.actions.remove-datasource-filter"},"Datasource: ",{datasource:h.datasource})),h.panel_type&&o.createElement(c.$n,{icon:"times",variant:"secondary",onClick:()=>L(void 0)},"Panel: ",h.panel_type)),o.createElement(m.B,{gap:2},!_&&o.createElement(C.z,{options:D(),disabledOptions:K,onChange:d,value:R}),o.createElement(l.r,{onChange:B=>i(B?.value),value:h.sort,getSortOptions:p,placeholder:y||(0,r.t)("search.actions.sort-placeholder","Sort"),isClearable:!0})))};P.displayName="ActionRow";const O=d=>({actionRow:(0,n.css)`
      display: none;

      ${d.breakpoints.up("md")} {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-bottom: ${d.spacing(2)};
        width: 100%;
      }
    `,checkboxWrapper:(0,n.css)`
      label {
        line-height: 1.2;
      }
    `})},39788:(T,f,t)=>{t.d(f,{ET:()=>d,lC:()=>A,ue:()=>r});var n=t(2543),o=t.n(n),u=t(12131),g=t(2619),m=t(33390),s=t(53477),c=t(6204),C=t(24439),l=t(64161),v=t(16757);const r={query:"",tag:[],starred:!1,layout:l.P.Folders,sort:void 0,prevSort:void 0,eventTrackingNamespace:"dashboard_search",deleted:!1},E={sort:null,starred:null,query:null,tag:null,layout:null},D=()=>localStorage.getItem(s.YU)===l.P.List?l.P.List:l.P.Folders;class A extends g.Q{constructor(){super(...arguments),this.updateLocation=(0,n.debounce)(e=>u.Ny.partial(e,!0),300),this.doSearchWithDebounce=(0,n.debounce)(()=>this.doSearch(),300),this.lastSearchTimestamp=0,this.onCloseSearch=()=>{this.updateLocation({search:null,folder:null,...E})},this.onClearSearchAndFilters=()=>{this.setStateAndDoSearch({query:"",datasource:void 0,tag:[],panel_type:void 0,starred:void 0,sort:void 0})},this.onQueryChange=e=>{this.setStateAndDoSearch({query:e})},this.onRemoveTag=e=>{this.setStateAndDoSearch({tag:this.state.tag.filter(a=>a!==e)})},this.onTagFilterChange=e=>{this.setStateAndDoSearch({tag:e})},this.onAddTag=e=>{this.state.tag&&this.state.tag.includes(e)||this.setStateAndDoSearch({tag:[...this.state.tag,e]})},this.onDatasourceChange=e=>{this.setStateAndDoSearch({datasource:e})},this.onPanelTypeChange=e=>{this.setStateAndDoSearch({panel_type:e})},this.onStarredFilterChange=e=>{const a=e.currentTarget.checked;this.setStateAndDoSearch({starred:a})},this.onClearStarred=()=>{this.setStateAndDoSearch({starred:!1})},this.onSortChange=e=>{e?localStorage.setItem(s.w7,e):localStorage.removeItem(s.w7),this.state.layout===l.P.Folders?this.setStateAndDoSearch({sort:e,layout:l.P.List}):this.setStateAndDoSearch({sort:e})},this.onLayoutChange=e=>{localStorage.setItem(s.YU,e),this.state.sort&&e===l.P.Folders?this.setStateAndDoSearch({layout:e,prevSort:this.state.sort,sort:void 0}):this.setStateAndDoSearch({layout:e,sort:this.state.prevSort})},this.onSetIncludePanels=e=>{this.setStateAndDoSearch({includePanels:e}),m.A.set(s.d7,e)},this.getTagOptions=()=>{const e=this.lastQuery??{kind:["dashboard","folder"],query:"*"};return(0,C.getGrafanaSearcher)().tags(e)},this.onSearchItemClicked=e=>{(0,c.MK)(this.state.eventTrackingNamespace,{layout:this.state.layout,starred:this.state.starred,sortValue:this.state.sort,query:this.state.query,tagCount:this.state.tag?.length,includePanels:this.state.includePanels,deleted:this.state.deleted})},this.onReportSearchUsage=()=>{(0,c.Pf)(this.state.eventTrackingNamespace,{layout:this.state.layout,starred:this.state.starred,sortValue:this.state.sort,query:this.state.query,tagCount:this.state.tag?.length,includePanels:this.state.includePanels,deleted:this.state.deleted})}}initStateFromUrl(e,a=!0){const S=(0,v.N1)(u.Ny.getSearchObject());(S.query||S.datasource||S.panel_type)&&(S.layout=l.P.List);const p=D(),y=localStorage.getItem(s.w7)??void 0,M=p===l.P.List?S.sort||y:null;this.setState({...r,...S,layout:p,sort:M??r.sort,prevSort:y,folderUid:e,eventTrackingNamespace:e?"manage_dashboards":"dashboard_search",deleted:this.state.deleted}),a&&this.hasSearchFilters()&&this.doSearch()}setStateAndDoSearch(e){const a=e.sort||this.state.sort||localStorage.getItem(s.w7)||void 0;this.setState({sort:a,...e}),this.updateLocation({query:this.state.query.length===0?null:this.state.query,tag:this.state.tag,datasource:this.state.datasource,panel_type:this.state.panel_type,starred:this.state.starred?this.state.starred:null,sort:this.state.sort}),this.hasSearchFilters()&&this.doSearchWithDebounce()}hasSearchFilters(){return this.state.query||this.state.tag.length||this.state.starred||this.state.panel_type||this.state.sort||this.state.deleted||this.state.layout===l.P.List}getSearchQuery(){const e={query:this.state.query,tags:this.state.tag,ds_uid:this.state.datasource,panel_type:this.state.panel_type,location:this.state.folderUid,sort:this.state.sort,explain:this.state.explain,withAllowedActions:this.state.explain,starred:this.state.starred,deleted:this.state.deleted};return e.sort?.length&&!e.sort.includes("name")&&(e.kind=["dashboard","folder"]),e.query?.length||(e.query="*",e.location||(e.kind=["dashboard","folder"])),!this.state.includePanels&&!e.kind&&(e.kind=["dashboard","folder"]),e.panel_type?.length&&(e.kind=["panel"]),e}doSearch(){const e={layout:this.state.layout,starred:this.state.starred,sortValue:this.state.sort,query:this.state.query,tagCount:this.state.tag?.length,includePanels:this.state.includePanels,deleted:this.state.deleted};(0,c.J$)(this.state.eventTrackingNamespace,e),this.lastQuery=this.getSearchQuery(),this.setState({loading:!0});const a=(0,C.getGrafanaSearcher)(),S=Date.now();(this.state.starred?a.starred(this.lastQuery):a.search(this.lastQuery)).then(y=>{S>this.lastSearchTimestamp&&(this.setState({result:y,loading:!1}),this.lastSearchTimestamp=S)}).catch(y=>{(0,c.KZ)(this.state.eventTrackingNamespace,{...e,error:y?.message}),this.setState({loading:!1})})}}let P;function O(){if(!P){const e=localStorage.getItem(s.YU)??r.layout;let a=m.A.getBool(s.d7,!0);a&&(a=!1),P=new A({...r,layout:e,includePanels:a})}return P}function d(){const i=O();return[i.useState(),i]}}}]);

//# sourceMappingURL=RecentlyDeletedPage.88860c0117e2365e13d9.js.map
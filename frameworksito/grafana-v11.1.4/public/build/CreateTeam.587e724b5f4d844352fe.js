"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[5436],{31084:(L,c,e)=>{e.d(c,{Y:()=>E});var t=e(96540),P=e(41053),n=e(10096),r=e(31678),O=e(37425),s=e(85927);const E=({teamId:o,roleOptions:l,disabled:D,roles:i,onApplyRoles:d,pendingRoles:a,apply:m=!1,maxWidth:C,width:M,isLoading:T})=>{const[{loading:u,value:R=i||[]},A]=(0,P.A)(async()=>{try{if(i)return i;if(m&&a?.length)return a;if(n.contextSrv.hasPermission(r.AccessControlAction.ActionTeamsRolesList)&&o>0)return await(0,s.xN)(o)}catch(_){console.error("Error loading options",_)}return[]},[o,a,i]);(0,t.useEffect)(()=>{A()},[A]);const I=async _=>{m?d&&d(_):(await(0,s.G3)(_,o),await A())},U=n.contextSrv.hasPermission(r.AccessControlAction.ActionTeamsRolesAdd)&&n.contextSrv.hasPermission(r.AccessControlAction.ActionTeamsRolesRemove);return t.createElement(O.n,{apply:m,onRolesChange:I,roleOptions:l,appliedRoles:R,isLoading:u||T,disabled:D,basicRoleDisabled:!0,canUpdateRoles:U,maxWidth:C,width:M})}},54939:(L,c,e)=>{e.d(c,{o:()=>s});var t=e(96540),P=e(24705),n=e(10096),r=e(31678),O=e(85927);const s=E=>{const[o,l]=(0,t.useState)(E),{value:D=[]}=(0,P.A)(async()=>n.contextSrv.licensedAccessControlEnabled()&&n.contextSrv.hasPermission(r.AccessControlAction.ActionRolesList)?(0,O.RL)(o):Promise.resolve([]),[o]);return[{roleOptions:D},l]}},80011:(L,c,e)=>{e.r(c),e.d(c,{CreateTeam:()=>M,default:()=>T});var t=e(96540),P=e(49785),n=e(17172),r=e(12131),O=e(84167),s=e(88575),E=e(10354),o=e(55852),l=e(67608),D=e(31084),i=e(85927),d=e(54939),a=e(10096),m=e(31678);const C={icon:"users-alt",id:"team-new",text:"New team",subTitle:"Create a new team. Teams let you grant permissions to a group of users."},M=()=>{const u=a.contextSrv.user.orgId,[R,A]=(0,t.useState)([]),[{roleOptions:I}]=(0,d.o)(u),{handleSubmit:U,register:_,formState:{errors:f}}=(0,P.mN)(),p=a.contextSrv.hasPermission(m.AccessControlAction.ActionUserRolesAdd)&&a.contextSrv.hasPermission(m.AccessControlAction.ActionUserRolesRemove),W=async g=>{const v=await(0,n.AI)().post("/api/teams",g);if(v.teamId){try{await a.contextSrv.fetchUserPermissions(),a.contextSrv.licensedAccessControlEnabled()&&p&&await(0,i.G3)(R,v.teamId,v.orgId)}catch(B){console.error(B)}r.Ny.push(`/org/teams/edit/${v.teamId}`)}};return t.createElement(l.Y,{navId:"teams",pageNav:C},t.createElement(l.Y.Contents,null,t.createElement("form",{onSubmit:U(W),style:{maxWidth:"600px"}},t.createElement(O.n,null,t.createElement(s.D,{label:"Name",required:!0,invalid:!!f.name,error:"Team name is required"},t.createElement(E.p,{..._("name",{required:!0}),id:"team-name"})),a.contextSrv.licensedAccessControlEnabled()&&t.createElement(s.D,{label:"Role"},t.createElement(D.Y,{teamId:0,roleOptions:I,disabled:!1,apply:!0,onApplyRoles:A,pendingRoles:R,maxWidth:"100%"})),t.createElement(s.D,{label:"Email",description:"This is optional and is primarily used for allowing custom team avatars."},t.createElement(E.p,{..._("email"),type:"email",id:"team-email",placeholder:"email@test.com"}))),t.createElement(o.$n,{type:"submit",variant:"primary"},"Create"))))},T=M}}]);

//# sourceMappingURL=CreateTeam.587e724b5f4d844352fe.js.map
"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[6263],{82138:(T,P,s)=>{s.d(P,{y:()=>x});var y=s(32196),p=s(96540),a=s(42418),w=s(94954),f=s(31678);const x=({initError:m})=>m?p.createElement("div",{className:u.dashboardLoading},p.createElement(a.F,{severity:f.AppNotificationSeverity.Error,title:m.message},(0,w.q)(m.error))):null,u={dashboardLoading:(0,y.css)({height:"60vh",display:"flex",alignItems:"center",justifyContent:"center"})}},9980:(T,P,s)=>{s.d(P,{P:()=>m});var y=s(32196),p=s(96540),a=s(12131),w=s(40845),f=s(66864),x=s(62930),u=s(55852);const m=({initPhase:v})=>{const b=(0,w.of)(c),E=()=>{a.Ny.push("/")};return p.createElement("div",{className:b.dashboardLoading},p.createElement("div",{className:b.dashboardLoadingText},p.createElement(f.gW,{spacing:"md"},p.createElement(f.Gy,{align:"center",justify:"center",spacing:"xs"},p.createElement(x.y,{inline:!0})," ",v)," ",p.createElement(f.Gy,{align:"center",justify:"center"},p.createElement(u.$n,{variant:"secondary",size:"md",icon:"repeat",onClick:E},"Cancel loading dashboard")))))},c=v=>{const b="0.5s",E=(0,y.keyframes)`
    0% { opacity: 0%; }
    100% { opacity: 100%; }
  `;return{dashboardLoading:(0,y.css)({height:"60vh",display:"flex",opacity:"0%",alignItems:"center",justifyContent:"center",[v.transitions.handleMotion("no-preference","reduce")]:{animation:`${E} 0s step-end ${b} 1 normal forwards`}}),dashboardLoadingText:(0,y.css)({fontSize:v.typography.h4.fontSize})}}},2118:(T,P,s)=>{s.d(P,{N:()=>ce});var y=s(46942),p=s.n(y),a=s(96540),w=s(66816),f=s.n(w),x=s(64423),u=s(32264),m=s(28138),c=s(15054),v=s(16233),b=s(80484),E=s(28444),d=s(32196),G=s(84140),S=s(40845),K=s(29158),H=s(8484),U=s(16678);const k=({panel:o,dashboard:e})=>{const t=r=>{r.preventDefault(),e.removePanel(o)},i=r=>{const{gridPos:l}=o,h={...r.model,gridPos:l,libraryPanel:r};e.addPanel(h),e.removePanel(o)},n=(0,S.of)(j);return a.createElement("div",{className:n.wrapper},a.createElement("div",{className:(0,d.cx)("panel-container",n.callToAction)},a.createElement("div",{className:(0,d.cx)(n.headerRow,"grid-drag-handle")},a.createElement("span",null,a.createElement(H.x6,{i18nKey:"library-panel.add-widget.title"},"Add panel from panel library")),a.createElement("div",{className:"flex-grow-1"}),a.createElement(K.K,{"aria-label":"Close 'Add Panel' widget",name:"times",onClick:t,tooltip:"Close widget"})),a.createElement(U.j,{onClick:i,variant:U.s.Tight,showPanelFilter:!0})))},j=o=>{const e=(0,d.keyframes)({"0%":{boxShadow:`0 0 0 2px ${o.colors.background.canvas}, 0 0 0px 4px ${o.colors.primary.main}`},"50%":{boxShadow:`0 0 0 2px ${o.components.dashboard.background}, 0 0 0px 4px ${(0,G.A)(o.colors.primary.main).darken(20).toHexString()}`},"100%":{boxShadow:`0 0 0 2px ${o.components.dashboard.background}, 0 0 0px 4px  ${o.colors.primary.main}`}});return{wrapper:(0,d.css)({height:"100%",paddingTop:`${o.spacing(.5)}`}),headerRow:(0,d.css)({display:"flex",alignItems:"center",height:"38px",flexShrink:0,width:"100%",fontSize:o.typography.fontSize,fontWeight:o.typography.fontWeightMedium,paddingLeft:`${o.spacing(1)}`,[o.transitions.handleMotion("no-preference","reduce")]:{transition:"background-color 0.1s ease-in-out"},cursor:"move","&:hover":{background:`${o.colors.background.secondary}`}}),callToAction:(0,d.css)({overflow:"hidden",outline:"2px dotted transparent",outlineOffset:"2px",boxShadow:"0 0 0 2px black, 0 0 0px 4px #1f60c4",[o.transitions.handleMotion("no-preference","reduce")]:{animation:`${e} 2s ease infinite`}})}};var Y=s(2543),W=s(13544),Q=s(3591),J=s(72574),X=s(72109),M=s(14578),A=s(45994),Z=s(71678),z=s(37390),I=s(88575),q=s(10354),_=s(42418),B=s(55852),ee=s(72235),te=s(92378);const ae=({repeat:o,title:e,warning:t,onUpdate:i,onCancel:n})=>{const[r,l]=(0,a.useState)(o),h=(0,a.useCallback)(g=>l(g),[l]);return a.createElement(ee.l,{defaultValues:{title:e},onSubmit:g=>{i(g.title,r)}},({register:g})=>a.createElement(a.Fragment,null,a.createElement(I.D,{label:"Title"},a.createElement(q.p,{...g("title"),type:"text"})),a.createElement(I.D,{label:"Repeat for"},a.createElement(te.G,{repeat:r,onChange:h})),t&&a.createElement(_.F,{"data-testid":W.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0},t),a.createElement(z.a.ButtonRow,null,a.createElement(B.$n,{type:"button",variant:"secondary",onClick:n,fill:"outline"},"Cancel"),a.createElement(B.$n,{type:"submit"},"Update"))))},se=({repeat:o,title:e,onDismiss:t,onUpdate:i,warning:n})=>{const r=(0,S.of)(ne);return a.createElement(z.a,{isOpen:!0,title:"Row options",icon:"copy",onDismiss:t,className:r.modal},a.createElement(ae,{repeat:o,title:e,onCancel:t,onUpdate:i,warning:n}))},ne=()=>({modal:(0,d.css)({label:"RowOptionsModal",width:"500px"})}),N=({repeat:o,title:e,onUpdate:t,warning:i})=>{const n=r=>(l,h)=>{t(l,h),r()};return a.createElement(Z.$s,null,({showModal:r,hideModal:l})=>a.createElement("button",{type:"button",className:"pointer","aria-label":"Row options",onClick:()=>{r(se,{title:e,repeat:o,onDismiss:l,onUpdate:n(l),warning:i})}},a.createElement(M.I,{name:"cog"})))};N.displayName="RowOptionsButton";class oe extends a.Component{constructor(){super(...arguments),this.onVariableUpdated=()=>{this.forceUpdate()},this.onToggle=()=>{this.props.dashboard.toggleRow(this.props.panel)},this.getWarning=()=>{if((this.props.panel.panels?.length?this.props.panel.panels:this.props.dashboard.getRowPanels((0,Y.indexOf)(this.props.dashboard.panels,this.props.panel))).some(i=>i.datasource?.uid===A.K))return a.createElement("div",null,a.createElement("p",null,"Panels in this row use the ",A.K," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."),a.createElement(X.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows"},"Learn more"))},this.onUpdate=(e,t)=>{this.props.panel.setProperty("title",e),this.props.panel.setProperty("repeat",t??void 0),this.props.panel.render(),this.props.dashboard.processRepeats(),this.forceUpdate()},this.onDelete=()=>{m.A.publish(new E.bY({title:"Delete row",text:"Are you sure you want to remove this row and all its panels?",altActionText:"Delete row only",icon:"trash-alt",onConfirm:()=>{this.props.dashboard.removeRow(this.props.panel,!0)},onAltAction:()=>{this.props.dashboard.removeRow(this.props.panel,!1)}}))}}componentDidMount(){this.sub=this.props.dashboard.events.subscribe(Q._,this.onVariableUpdated)}componentWillUnmount(){this.sub&&this.sub.unsubscribe()}render(){const e=(0,J.w)().replace(this.props.panel.title,this.props.panel.scopedVars,"text"),t=this.props.panel.panels?this.props.panel.panels.length:0,i=t===1?"panel":"panels",n=this.props.dashboard.meta.canEdit===!0,r=this.props.panel.collapsed,l=re(this.props.theme);return a.createElement("div",{className:(0,d.cx)(l.dashboardRow,{[l.dashboardRowCollapsed]:r}),"data-testid":"dashboard-row-container"},a.createElement("button",{"aria-expanded":!r,className:(0,d.cx)(l.title,"pointer"),type:"button","data-testid":W.Tp.components.DashboardRow.title(e),onClick:this.onToggle},a.createElement(M.I,{name:r?"angle-right":"angle-down"}),e,a.createElement("span",{className:(0,d.cx)(l.count,{[l.countCollapsed]:r})},"(",t," ",i,")")),n&&a.createElement("div",{className:l.actions},a.createElement(N,{title:this.props.panel.title,repeat:this.props.panel.repeat,onUpdate:this.onUpdate,warning:this.getWarning()}),a.createElement("button",{type:"button",className:"pointer",onClick:this.onDelete,"aria-label":"Delete row"},a.createElement(M.I,{name:"trash-alt"}))),r===!0&&a.createElement("div",{className:(0,d.cx)({[l.toggleTargetCollapsed]:r}),onClick:this.onToggle},"\xA0"),n&&a.createElement("div",{"data-testid":"dashboard-row-drag",className:(0,d.cx)(l.dragHandle,"grid-drag-handle",{[l.dragHandleCollapsed]:r})}))}}const ie=(0,S.cV)(oe),re=o=>{const e=(0,d.css)({color:o.colors.text.secondary,opacity:0,[o.transitions.handleMotion("no-preference","reduce")]:{transition:"200ms opacity ease-in 200ms"},button:{color:o.colors.text.secondary,paddingLeft:o.spacing(2),background:"transparent",border:"none","&:hover":{color:o.colors.text.maxContrast}}});return{dashboardRow:(0,d.css)({display:"flex",alignItems:"center",height:"100%","&:hover, &:focus-within":{[`.${e}`]:{opacity:1}}}),dashboardRowCollapsed:(0,d.css)({background:o.components.panel.background}),toggleTargetCollapsed:(0,d.css)({flex:1,cursor:"pointer",marginRight:"15px"}),title:(0,d.css)({flexGrow:0,fontSize:o.typography.h5.fontSize,fontWeight:o.typography.fontWeightMedium,color:o.colors.text.primary,background:"transparent",border:"none",".fa":{color:o.colors.text.secondary,fontSize:o.typography.size.xs,padding:o.spacing(0,1)}}),actions:e,count:(0,d.css)({paddingLeft:o.spacing(2),color:o.colors.text.secondary,fontStyle:"italic",fontSize:o.typography.size.sm,fontWeight:"normal",display:"none"}),countCollapsed:(0,d.css)({display:"inline-block"}),dragHandle:(0,d.css)({cursor:"move",width:"16px",height:"100%",background:'url("public/img/grab_dark.svg") no-repeat 50% 50%',backgroundSize:"8px",visibility:"hidden",position:"absolute",top:0,right:0}),dragHandleCollapsed:(0,d.css)({visibility:"visible",opacity:1})}};var le=s(68064),de=s(39569);const $="systemPanelFilterVar";class ce extends a.PureComponent{constructor(e){super(e),this.panelMap={},this.eventSubs=new x.yU,this.windowHeight=1200,this.windowWidth=1920,this.gridWidth=0,this.lastPanelBottom=0,this.isLayoutInitialized=!1,this.onLayoutChange=t=>{if(!this.state.panelFilter){for(const i of t)this.panelMap[i.i].updateGridPos(i,this.isLayoutInitialized);this.isLayoutInitialized&&(this.isLayoutInitialized=!0),this.props.dashboard.sortPanelsByGridPos(),this.forceUpdate()}},this.triggerForceUpdate=()=>{this.forceUpdate()},this.updateGridPos=(t,i)=>{this.panelMap[t.i].updateGridPos(t)},this.onResize=(t,i,n)=>{this.panelMap[n.i].updateGridPos(n)},this.onResizeStop=(t,i,n)=>{this.updateGridPos(n,t)},this.onDragStop=(t,i,n)=>{this.updateGridPos(n,t)},this.onGetWrapperDivRef=t=>{t&&v.TP.user.authenticatedBy!=="render"&&setTimeout(()=>{t.classList.add("react-grid-layout--enable-move-animations")},50)},this.rootEl=null,this.onMeasureRef=t=>{if(!t){this.rootEl&&this.resizeObserver&&this.resizeObserver.unobserve(this.rootEl);return}this.rootEl=t,this.resizeObserver=new ResizeObserver(i=>{i.forEach(n=>{this.setState({width:n.contentRect.width})})}),this.resizeObserver.observe(t)},this.state={panelFilter:void 0,width:document.body.clientWidth}}componentDidMount(){const{dashboard:e}=this.props;if(u.$.featureToggles.panelFilterVariable){for(const t of e.getVariables())if(t.id===$){"query"in t&&this.setPanelFilter(t.query);break}this.eventSubs.add(m.A.subscribe(b.og,t=>{if(t.payload.variable?.id===$&&"current"in t.payload.variable){let i=t.payload.variable.current;"value"in i&&typeof i.value=="string"&&this.setPanelFilter(i.value)}}))}this.eventSubs.add(e.events.subscribe(E.Q$,this.triggerForceUpdate))}componentWillUnmount(){this.eventSubs.unsubscribe()}setPanelFilter(e){let t;e.length>0&&(t=new RegExp(e,"i")),this.setState({panelFilter:t})}buildLayout(){const e=[];this.panelMap={};const{panelFilter:t}=this.state;let i=0;for(const n of this.props.dashboard.panels){if(n.key||(n.key=`panel-${n.id}-${Date.now()}`),this.panelMap[n.key]=n,!n.gridPos){console.log("panel without gridpos");continue}const r={i:n.key,x:n.gridPos.x,y:n.gridPos.y,w:n.gridPos.w,h:n.gridPos.h};n.type==="row"&&(r.w=c.cV,r.h=1,r.isResizable=!1,r.isDraggable=n.collapsed),t?t.test(n.title)&&(r.isResizable=!1,r.isDraggable=!1,r.x=i%2*c.cV,r.y=Math.floor(i/2),e.push(r),i++):e.push(r)}return e}getPanelScreenPos(e,t){let i=0;return t<u.$.theme2.breakpoints.values.md?i=this.lastPanelBottom+c.dU:i=L(e.gridPos.y)+c.dU,this.lastPanelBottom=i+L(e.gridPos.h),{top:i,bottom:this.lastPanelBottom}}renderPanels(e,t){const{panelFilter:i}=this.state,n=[];this.lastPanelBottom=0,this.gridWidth!==e&&(this.windowHeight=window.innerHeight??1e3,this.windowWidth=window.innerWidth,this.gridWidth=e);for(const r of this.props.dashboard.panels){const l=p()({"react-grid-item--fullscreen":r.isViewing}),h=a.createElement(F,{key:r.key,className:l,"data-panelid":r.id,gridPos:r.gridPos,gridWidth:e,windowHeight:this.windowHeight,windowWidth:this.windowWidth,isViewing:r.isViewing},(g,O)=>this.renderPanel(r,g,O,t));i?i.test(r.title)&&n.push(h):n.push(h)}return n}renderPanel(e,t,i,n){return e.type==="row"?a.createElement(ie,{key:e.key,panel:e,dashboard:this.props.dashboard}):e.type==="add-library-panel"?a.createElement(k,{key:e.key,panel:e,dashboard:this.props.dashboard}):a.createElement(de.L,{key:e.key,stateKey:e.key,panel:e,dashboard:this.props.dashboard,isEditing:e.isEditing,isViewing:e.isViewing,isDraggable:n,width:t,height:i,hideMenu:this.props.hidePanelMenus})}render(){const{isEditable:e,dashboard:t}=this.props,{width:i}=this.state;if(t.panels.length===0)return a.createElement(le.A,{dashboard:t,canCreate:e});const n=i<=u.$.theme2.breakpoints.values.md?!1:e;return a.createElement("div",{ref:this.onMeasureRef,style:{flex:"1 1 auto",position:"relative",zIndex:1,display:this.props.editPanel?"none":void 0}},a.createElement("div",{style:{width:i,height:"100%"},ref:this.onGetWrapperDivRef},a.createElement(f(),{width:i,isDraggable:n,isResizable:e,containerPadding:[0,0],useCSSTransforms:!0,margin:[c.dU,c.dU],cols:c.cV,rowHeight:c.sD,draggableHandle:".grid-drag-handle",draggableCancel:".grid-drag-cancel",layout:this.buildLayout(),onDragStop:this.onDragStop,onResize:this.onResize,onResizeStop:this.onResizeStop,onLayoutChange:this.onLayoutChange},this.renderPanels(i,n))))}}const F=a.forwardRef((o,e)=>{const t=u.$.theme2;let i=100,n=100;const{gridWidth:r,gridPos:l,isViewing:h,windowHeight:g,windowWidth:O,...V}=o,R=o.style??{};if(h)i=r,n=g*.85,R.height=n,R.width="100%";else if(O<t.breakpoints.values.md)i=o.gridWidth,n=L(l.h),R.height=n,R.width="100%";else if(o.style){const{width:D,height:C}=o.style;D!=null&&(i=typeof D=="number"?D:parseFloat(D)),C!=null&&(n=typeof C=="number"?C:parseFloat(C))}return a.createElement("div",{...V,style:{...V.style},ref:e},[o.children[0](i,n),o.children.slice(1)])});function L(o){return o*(c.sD+c.dU)-c.dU}F.displayName="GridItemWithDimensions"}}]);

//# sourceMappingURL=6263.8e49ed37c2dc63f6b065.js.map
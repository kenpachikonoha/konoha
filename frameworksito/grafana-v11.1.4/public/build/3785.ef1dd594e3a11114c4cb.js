(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3785],{76287:(Q,I,e)=>{"use strict";e.d(I,{p:()=>o});var n=e(96540),a=e(94841);function o(r){const{children:i,instanceSettings:f}=r,d=(0,n.useMemo)(()=>({instanceSettings:f,meta:f.meta}),[f]);return n.createElement(a.o.Provider,{value:d},i)}},94841:(Q,I,e)=>{"use strict";e.d(I,{o:()=>a});var n=e(96540);const a=(0,n.createContext)(void 0)},13834:(Q,I,e)=>{"use strict";e.d(I,{a:()=>o});var n=e(96540),a=e(94841);function o(r){const{children:i,...f}=r;return n.createElement(a.o.Provider,{value:f},i)}},95187:(Q,I,e)=>{"use strict";e.d(I,{S:()=>n});function n(a){return"instanceSettings"in a&&"meta"in a}},92470:(Q,I,e)=>{"use strict";e.d(I,{Q:()=>o});var n=e(96540),a=e(94841);function o(){const r=(0,n.useContext)(a.o);if(!r)throw new Error("usePluginContext must be used within a PluginContextProvider");return r}},33948:(Q,I,e)=>{"use strict";e.d(I,{I:()=>r,f:()=>o});var n=e(11261),a=e(14236);class o{constructor(l,m){return this.fields=[],this.length=0,r(l,m)}}function r(d,l){const m={fields:[],length:d.length};if(!d?.length)return m;if(l){if(!f(d))throw new Error("source is not an array of objects");for(const h of l)m.fields.push(i(h,d.map(u=>u&&u[h])));return m}if(d.find(h=>h)===null)return m;if(f(d)){const h=d.find(u=>u);m.fields=Object.keys(h||{}).map(u=>i(u,d.map(b=>b&&b[u])))}else m.fields.push(i(n.Bc,d));return m}function i(d,l){const m={name:d,config:{},values:l,type:n.PU.other};return m.type=(0,a.dF)(m)??n.PU.other,m}function f(d){const l=d.find(m=>m);return d.length>0&&typeof l=="object"}},33526:(Q,I,e)=>{"use strict";e.d(I,{x:()=>o});var n=e(36120),a=e(37471);class o extends a.k{constructor(i){super(void 0,f=>new n.$({...i,buffer:f}))}}},89667:(Q,I,e)=>{"use strict";e.d(I,{EL:()=>i,Nw:()=>l,or:()=>d,t:()=>r});var n=e(11261),a=e(14236);const o={Inf:1/0,NegInf:-1/0,Undef:void 0,NaN:NaN};function r(m,s){let h;for(h in m){const u=o[h];for(const b of m[h])b<s.length&&(s[b]=u)}}function i(m,s){for(let h=0;h<s.length;h++)s[h]=m[Number(s[h])]}function f(m,s){for(const h of s)if(h!=null)return(0,a.by)(m,h);return n.PU.other}function d(m){const{schema:s,data:h}=m;if(!s||!s.fields)throw new Error("JSON needs a fields definition");const u=h?h.values.reduce((g,P)=>Math.max(g,P.length),0):0,b=s.fields.map((g,P)=>{let c=h?h.values[P]:[],y=c.length,p=g.type;y!==u&&(c.length=u,c.fill(void 0,y));let v=h?.entities?.[P];v&&r(v,c);let D=h?.enums?.[P];D&&(i(D,c),p=n.PU.string);const E=h?.nanos?.[P],S={...g,type:p??f(g.name,c),config:g.config??{},values:c,entities:v??{}};return E!=null&&(S.nanos=E),S});return{...s,fields:b,length:u}}function l(m){const s={values:[]},h=[];let u=!1;const b={refId:m.refId,meta:m.meta,name:m.name,fields:m.fields.map(g=>{const{values:P,nanos:c,state:y,display:p,...v}=g;return"entities"in v&&delete v.entities,s.values.push(P),c!=null?(h.push(c),u=!0):h.push(null),v})};return u&&(s.nanos=h),{schema:b,data:s}}},78368:(Q,I,e)=>{"use strict";e.d(I,{R:()=>a});var n=e(18008);class a extends n.F{constructor(r){super(),this.data=r,this.index=0;const i={},f={};for(let d=0;d<r.fields.length;d++){const l=r.fields[d];if(!l.name)continue;f[l.name]=l;const m=()=>l.values.get(this.index);i.hasOwnProperty(l.name)||Object.defineProperty(i,l.name,{enumerable:!0,get:m}),i.hasOwnProperty(d.toString())||Object.defineProperty(i,d,{enumerable:!1,get:m})}this.obj=i,this.fields=f}get dataFrame(){return this.data}get length(){return this.data.length}getFieldDisplayProcessor(r){if(!this.dataFrame||!this.dataFrame.fields)return;const i=this.dataFrame.fields[r];if(!(!i||!i.display))return i.display}get(r){return this.index=r,this.obj}toArray(){return new Array(this.data.length).fill(0).map((r,i)=>({...this.get(i)}))}}},85404:(Q,I,e)=>{"use strict";e.d(I,{L:()=>o});var n=e(11261),a=e(14236);class o{constructor(i){this.fields=[],this.fieldByName={},this.fieldByType={},this.fields=i.fields.map((f,d)=>({...f,index:d}));for(let f=0;f<i.fields.length;f++){const d=i.fields[f];if(d.type===n.PU.other){const l=(0,a.dF)(d);l&&(d.type=l)}this.fieldByType[d.type]||(this.fieldByType[d.type]=[]),this.fieldByType[d.type].push({...d,index:f}),this.fieldByName[d.name]?console.warn("Duplicate field names in DataFrame: ",d.name):this.fieldByName[d.name]={...d,index:f}}}getFields(i){if(!i)return[...this.fields];const f=this.fieldByType[i];return f?[...f]:[]}hasFieldOfType(i){const f=this.fieldByType[i];return f&&f.length>0}getFirstFieldOfType(i,f=!1){return this.fieldByType[i]?.find(m=>f||!m.config.custom?.hidden)}hasFieldNamed(i){return!!this.fieldByName[i]}hasFieldWithNameAndType(i,f){return!!this.fieldByName[i]&&this.fieldByType[f].filter(d=>d.name===i).length>0}getFieldByName(i){return this.fieldByName[i]}getFieldsByLabel(i,f){return Object.values(this.fieldByName).filter(d=>d.labels&&d.labels[i]===f)}}},37471:(Q,I,e)=>{"use strict";e.d(I,{p:()=>f,k:()=>d});var n=e(2543),a=e(11261),o=e(14236);function r(l,m){return m.type||(m.name==="time"||m.name==="Time"?m.type=a.PU.time:m.type=(0,o.HW)(l)),m.type===a.PU.number?s=>parseFloat(s):m.type===a.PU.boolean?s=>!(s[0]==="F"||s[0]==="f"||s[0]==="0"):s=>s}var i=e(18008);const f=void 0;class d extends i.F{constructor(m,s){if(super(),this.fields=[],this.first=[],this.parsers=void 0,this.creator=s||(h=>h??[]),m){const{name:h,refId:u,meta:b,fields:g}=m;if(h&&(this.name=h),u&&(this.refId=u),b&&(this.meta=b),g)for(const P of g)this.addField(P)}Object.defineProperty(this,"length",{enumerable:!0,get:()=>this.first.length})}get length(){return this.first.length}addFieldFor(m,s){return this.addField({name:s||"",type:(0,o.HW)(m)})}addField(m,s){let h;m.values&&(h=m.values);let u=m.type;!u&&(m.name==="time"||m.name==="Time")?u=a.PU.time:(!u&&h&&h.length&&(u=(0,o.HW)(h[0])),u||(u=a.PU.other));let b=m.name;b||(b=`Field ${this.fields.length+1}`);const g={...m,name:b,type:u,config:m.config||{},values:this.creator(h)};if(u===a.PU.other&&(u=(0,o.dF)(g),u&&(g.type=u)),this.fields.push(g),this.first=this.fields[0].values,s)for(;g.values.length<s;)g.values.push(f);else this.validate();return g}validate(){const m=this.fields.reduce((s,h)=>Math.max(s,h.values.length),0);for(const s of this.fields)for(;s.values.length!==m;)s.values.push(f)}setParser(m,s){return this.parsers||(this.parsers=new Map),this.parsers.set(m,s),s}parseValue(m,s){let h=this.parsers?.get(m);return h||(h=this.setParser(m,r(s,m))),h(s)}appendRow(m){for(let s=this.fields.length;s<m.length;s++)this.addField({name:`Field ${s+1}`,type:(0,o.HW)(m[s])});if(this.length<1)for(let s=0;s<this.fields.length;s++){const h=this.fields[s];(!h.type||h.type===a.PU.other)&&(h.type=(0,o.HW)(m[s]))}for(let s=0;s<this.fields.length;s++){const h=this.fields[s];let u=m[s];h.type!==a.PU.string&&(0,n.isString)(u)&&(u=this.parseValue(h,u)),h.values.push(u)}}push(...m){for(const s of m)this.add(s);return this.length}reverse(){for(const m of this.fields)m.values.reverse();return this}add(m){const s=m;for(const h of this.fields){let u=s[h.name];h.type!==a.PU.string&&(0,n.isString)(u)&&(u=this.parseValue(h,u)),u===void 0&&(u=f),h.values.push(u)}}set(m,s){if(m>this.length)throw new Error("Unable to set value beyond current length");const h=s||{};for(const u of this.fields)u.values[m]=h[u.name]}get(m){const s={};for(const h of this.fields)s[h.name]=h.values[m];return s}toJSON(){return(0,o.Kl)(this)}}},9631:(Q,I,e)=>{"use strict";e.d(I,{Kh:()=>d,Ls:()=>b,k9:()=>s,m8:()=>h,wC:()=>P});var n=e(11261),a=e(8249),o=e(73060),r=e(43659),i=e(14236),f=e(89667),d=(D=>(D.Append="append",D.Replace="replace",D))(d||{});const l="__name__";var m=(D=>(D[D.wide=0]="wide",D[D.labels=1]="labels",D))(m||{});class s{constructor(E){this.options=E,this.meta={},this.fields=[],this.length=0,this.schemaFields=[],this.timeFieldIndex=-1,this.pushMode=0,this.labels=new Set,this.packetInfo={schemaChanged:!0,number:0,action:"replace",length:0},this.serialize=(S,T,M)=>{const A=T?Object.assign({},{...this.options,...T}):this.options,x=(0,i.By)(this,S),C=p(x.fields.map(R=>R.values??[]),typeof M?.maxLength=="number"?Math.min(M.maxLength,A.maxLength):A.maxLength,this.timeFieldIndex,A.maxDelta);x.fields=x.fields.map(R=>({...R,values:R.values?.slice(C)}));const O=x.fields[0]?.values?.length??0;return{...x,labels:this.labels,schemaFields:this.schemaFields,name:this.name,refId:this.refId,meta:this.meta,length:O,timeFieldIndex:this.timeFieldIndex,pushMode:this.pushMode,packetInfo:this.packetInfo,options:A}},this.initFromSerialized=S=>{this.name=S.name,this.refId=S.refId,this.meta=S.meta,this.length=S.length,this.labels=S.labels,this.schemaFields=S.schemaFields,this.timeFieldIndex=S.timeFieldIndex,this.pushMode=S.pushMode,this.packetInfo.length=S.packetInfo.length,this.packetInfo.number=S.packetInfo.number,this.packetInfo.action="replace",this.packetInfo.schemaChanged=!0,this.fields=S.fields.map(T=>({...T,type:T.type??n.PU.other,config:T.config??{},values:T.values??[]})),y(this.fields.map(T=>T.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)},this.needsResizing=({maxLength:S,maxDelta:T})=>{const M=S&&this.options.maxLength<S,A=T&&this.options.maxDelta<T,x=T&&this.options.maxDelta===1/0;return!!(M||A||x)},this.resize=({maxLength:S,maxDelta:T})=>{T&&(this.options.maxDelta===1/0?this.options.maxDelta=T:this.options.maxDelta=Math.max(T,this.options.maxDelta)),this.options.maxLength=Math.max(this.options.maxLength,S??0)},this.pushNewValues=S=>{if(!S?.length)return;this.packetInfo.action=this.options.action,this.packetInfo.number++,this.packetInfo.length=S[0].length,this.packetInfo.schemaChanged=!1,this.options.action==="append"?c(this.fields.map(M=>M.values),S,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta):(S.forEach((M,A)=>{this.fields[A]&&(this.fields[A].values=M)}),y(this.fields.map(M=>M.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta));const T=this.fields?.[0]?.values.length;T!==void 0&&(this.length=T)},this.resetStateCalculations=()=>{this.fields.forEach(S=>{S.state={...S.state??{},calcs:void 0,range:void 0}})},this.getMatchingFieldIndexes=S=>this.fields.map((T,M)=>S(T)?M:void 0).filter(T=>T!==void 0),this.getValuesFromLastPacket=()=>this.fields.map(S=>{const T=S.values;return T.slice(Math.max(T.length-this.packetInfo.length))}),this.hasAtLeastOnePacket=()=>!!this.packetInfo.length,this.getOptions=()=>this.options,Object.defineProperty(this,"length",{enumerable:!0}),Object.defineProperty(this,"fields",{enumerable:!0})}static{this.deserialize=E=>{const S=new s(E.options);return S.initFromSerialized(E),S}}static{this.empty=E=>new s(h(E))}static{this.fromDataFrameJSON=(E,S)=>{const T=new s(h(S));return T.push(E),T}}get alwaysReplace(){return this.options.action==="replace"}push(E){const{schema:S,data:T}=E;if(this.packetInfo.number++,this.packetInfo.length=0,this.packetInfo.schemaChanged=!1,S){this.pushMode=0,this.timeFieldIndex=S.fields.findIndex(C=>C.type===n.PU.time);const M=S.fields[0];this.timeFieldIndex===1&&M.type===n.PU.string&&(M.name==="labels"||M.name==="Labels")&&(this.pushMode=1,this.timeFieldIndex=0);const A=this.pushMode===1?S.fields.slice(1):S.fields;this.refId=S.refId,S.meta&&(this.meta={...S.meta});const{displayNameFormat:x}=this.options;if(v(this.schemaFields,A)){const C=A.length;this.fields.forEach((O,R)=>{const L=A[R%C];O.config=L.config??{},O.labels=L.labels}),x&&this.fields.forEach(O=>{const R={[l]:O.name,...O.labels};O.config.displayNameFromDS=(0,r.j)(x,R)})}else{this.packetInfo.schemaChanged=!0;const C=this.pushMode===0;this.fields=A.map(O=>{const R=O.config??{};if(x){const L={[l]:O.name,...O.labels};R.displayNameFromDS=(0,r.j)(x,L)}return{config:R,name:O.name,labels:O.labels,type:O.type??n.PU.other,values:C?this.fields.find(L=>L.name===O.name&&O.type===L.type)?.values??Array(this.length).fill(void 0):[]}})}this.schemaFields=A}if(T&&T.values.length&&T.values[0].length){let{values:M,entities:A}=T;if(A&&A.forEach((C,O)=>{C&&(0,f.t)(C,M[O])}),this.pushMode===1){const C=u(M);for(const L of C.keys())this.labels.has(L)||(this.packetInfo.schemaChanged=!0,this.addLabel(L));let O=Array(this.schemaFields.length).fill([]),R=[];this.labels.forEach(L=>{R.push(C.get(L)??O)}),M=(0,o.fj)(R)}if(M.length!==this.fields.length){if(this.fields.length)throw new Error(`push message mismatch.  Expected: ${this.fields.length}, received: ${M.length} (labels=${this.pushMode===1})`);this.fields=M.map((C,O)=>{let R=`Field ${O}`,L=(0,i.HW)(C[0]);return O===0&&L===n.PU.number&&C[0]>1600016688632&&(L=n.PU.time,R="Time"),{name:R,type:L,config:{},values:[]}})}let x=M;this.packetInfo.length=M[0].length,this.alwaysReplace||!this.length?this.packetInfo.action="replace":(this.packetInfo.action="append",x=this.fields.map(C=>C.values),c(x,M,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)),x.forEach((C,O)=>{const R=this.fields[O],{state:L}=R;R.values=C,L&&(L.calcs=void 0)}),this.length=x[0].length}return{...this.packetInfo}}addLabel(E){const{displayNameFormat:S}=this.options,T=this.labels.size,M=g(E);if(T===0)this.fields.forEach((A,x)=>{if(x>0&&(A.labels=M,S)){const C={[l]:A.name,...M};A.config.displayNameFromDS=(0,r.j)(S,C)}});else for(let A=1;A<this.schemaFields.length;A++){let x=this.schemaFields[A];const C=x.config??{};if(S){const O={[l]:x.name,...M};C.displayNameFromDS=(0,r.j)(S,O)}this.fields.push({...x,config:C,labels:M,values:Array(this.length).fill(void 0)})}this.labels.add(E)}}function h(D){return{maxLength:D?.maxLength??1e3,maxDelta:D?.maxDelta??1/0,action:D?.action??"append",displayNameFormat:D?.displayNameFormat}}function u(D){let E=new Set(D[0]),S=new Map;E.forEach(T=>{let M=Array(D.length-1).fill(null).map(()=>[]);S.set(T,M)});for(let T=0;T<D[0].length;T++){let M=S.get(D[0][T]);for(let A=1;A<D.length;A++)M[A-1].push(D[A][T])}return S}function b(D,E,S,T){let M;S=S||0,T=T||E.length-1;let A=T<=2147483647;for(;T-S>1;)M=A?S+T>>1:Math.floor((S+T)/2),E[M]<D?S=M:T=M;return D-E[S]<=E[T]-D?S:T}function g(D){if(!D.length)return{};if(D.charAt(0)==="{")return(0,a.Xy)(D);const E={};return D.split(",").forEach(S=>{const[T,M]=S.trim().split("=");E[T]=M}),E}function P(D){const E=D.packetInfo;return E?.action?E:void 0}function c(D,E,S=1/0,T=0,M=1/0){for(let A=0;A<D.length;A++)for(let x=0;x<E[A].length;x++)D[A].push(E[A][x]);return y(D,S,T,M)}function y(D,E=1/0,S=0,T=1/0){const M=p(D,E,S,T);if(M)for(let A=0;A<D.length;A++)D[A].splice(0,M);return M}function p(D,E=1/0,S=0,T=1/0){if(!D[0]?.length)return 0;const M=D[0].length;let A=0;if(M>E&&(A=M-E),T!==1/0&&S>=0){const x=D[S],C=x[A],O=x[M-1];O-C>T&&(A=b(O-T,x,A))}return A}function v(D,E){if(D?.length!==E.length)return!1;for(let S=0;S<D.length;S++){const T=D[S],M=E[S];if(T.name!==M.name||T.type!==M.type)return!1}return!0}},61443:(Q,I,e)=>{"use strict";e.d(I,{Km:()=>i,P4:()=>o,WK:()=>r,g6:()=>a,r4:()=>n,xB:()=>f});const n=(d,l)=>({name:d,columns:l}),a=d=>d.columns,o=(d,l)=>d.columns[l],r=(d,l,m)=>d.columns[l].values[m],i=(d,l,m)=>d.columns.map(s=>s.values[m]),f=(d,l)=>d[l]},21423:(Q,I,e)=>{"use strict";e.d(I,{J3:()=>r,ab:()=>f,bW:()=>o});var n=e(2543),a=e.n(n);function o(d,l,m){if(d===l)return!0;if(d?.fields?.length!==l?.fields?.length||d.name!==l.name)return!1;for(let s=0;s<d.fields.length;s++){const h=d.fields[s],u=l.fields[s];if(h.type!==u.type||h.name!==u.name)return!1;if(m)continue;if(h.labels&&u.labels&&!f(h.labels,u.labels))return!1;const b=h.config,g=u.config;if(Object.keys(b).length!==Object.keys(g).length)return!1;let P;for(P in b){if(!(P in g))return!1;if(P!=="interval"&&!(0,n.isEqual)(b[P],g[P]))return!1}}return!0}function r(d,l,m){if(d===l)return!0;if(d?.length!==l?.length)return!1;for(let s=0;s<d.length;s++)if(!m(d[s],l[s]))return!1;return!0}const i=(d,l)=>d===l;function f(d,l,m=i){if(d===l)return!0;if(Object.keys(d).length!==Object.keys(l).length)return!1;let s;for(s in d)if(!m(d[s],l[s]))return!1;return!0}},48120:(Q,I,e)=>{"use strict";e.d(I,{Bt:()=>r.Bt,By:()=>r.By,EI:()=>r.EI,EL:()=>d.EL,ES:()=>r.ES,HW:()=>r.HW,Ij:()=>f.I,J3:()=>l.J3,KR:()=>r.KR,Kh:()=>s.Kh,Kl:()=>r.Kl,Km:()=>i.Km,LI:()=>r.LI,Lc:()=>a.L,Ls:()=>s.Ls,N$:()=>r.N$,Nw:()=>d.Nw,P4:()=>i.P4,Rh:()=>n.R,S1:()=>m.S1,Vc:()=>r.Vc,WK:()=>i.WK,XQ:()=>r.XQ,Yn:()=>r.Yn,aH:()=>m.aH,ab:()=>l.ab,bW:()=>l.bW,by:()=>r.by,ci:()=>r.ci,dF:()=>r.dF,fG:()=>f.f,g6:()=>i.g6,hF:()=>m.hF,jq:()=>m.jq,k2:()=>o.k,k9:()=>s.k9,oE:()=>r.oE,or:()=>d.or,pH:()=>r.pH,pk:()=>o.p,q7:()=>r.q7,r4:()=>i.r4,t:()=>d.t,t9:()=>m.t9,tP:()=>m.tP,uY:()=>m.uY,w3:()=>r.w3,xB:()=>i.xB});var n=e(78368),a=e(85404),o=e(37471),r=e(14236),i=e(61443),f=e(33948),d=e(89667),l=e(21423),m=e(19845),s=e(9631)},14236:(Q,I,e)=>{"use strict";e.d(I,{Bt:()=>F,By:()=>R,EI:()=>B,ES:()=>A,HW:()=>y,KR:()=>L,Kl:()=>O,LI:()=>S,N$:()=>K,Vc:()=>T,XQ:()=>v,Yn:()=>C,by:()=>P,ci:()=>E,dF:()=>p,oE:()=>c,pH:()=>D,q7:()=>x,w3:()=>M});var n=e(2543),a=e.n(n),o=e(47232),r=e(48241),i=e(28240),f=e(11261),d=e(39070),l=e(33948),m=e(89667);function s(w){const U=w.columns.map(W=>{const{text:V,type:_,...H}=W,G=[];return{name:V?.length?V:W,config:H||{},values:G,type:_&&Object.values(f.PU).includes(_)?_:f.PU.other}});if(!(0,n.isArray)(w.rows))throw new Error(`Expected table rows to be array, got ${typeof w.rows}.`);for(const W of w.rows)for(let V=0;V<U.length;V++)U[V].values.push(W[V]);for(const W of U)if(W.type===f.PU.other){const V=p(W);V&&(W.type=V)}return{fields:U,refId:w.refId,meta:w.meta,name:w.name,length:w.rows.length}}function h(w){const U=[],W=[],V=w.datapoints||w.points;for(const H of V)W.push(H[0]),U.push(H[1]);const _=[{name:f.LE,type:f.PU.time,config:{},values:U},{name:f.Bc,type:f.PU.number,config:{unit:w.unit},values:W,labels:w.tags}];return w.title&&(_[1].config.displayNameFromDS=w.title),{name:w.target||w.name,refId:w.refId,meta:w.meta,fields:_,length:W.length}}function u(w){const U=[],W=[];for(let V=0;V<w.data.length;V++){const _=w.data[V];U.push(_[1]),W.push(_[0])}return{name:w.label,fields:[{name:w.label||f.Bc,type:f.PU.number,config:{},values:U},{name:f.LE,type:f.PU.time,config:{unit:"dateTimeAsIso"},values:W}],length:U.length}}function b(w){const U=[{name:w.target,type:f.PU.other,labels:w.tags,config:{unit:w.unit,filterable:w.filterable},values:[]}];for(const W of w.datapoints)U[0].values.push(W);return{name:w.target,refId:w.target,meta:{json:!0},fields:U,length:w.datapoints.length}}const g=/^\s*(-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?|NAN)\s*$/i;function P(w,U){return w&&(w=w.toLowerCase(),w==="date"||w==="time")?f.PU.time:y(U)}function c(w){return w instanceof Date||(0,o.Ar)(w)?f.PU.time:(0,n.isNumber)(w)?f.PU.number:(0,n.isString)(w)?f.PU.string:(0,n.isBoolean)(w)?f.PU.boolean:f.PU.other}function y(w){return w instanceof Date||(0,o.Ar)(w)?f.PU.time:(0,n.isNumber)(w)?f.PU.number:(0,n.isString)(w)?g.test(w)?f.PU.number:w==="true"||w==="TRUE"||w==="True"||w==="false"||w==="FALSE"||w==="False"?f.PU.boolean:f.PU.string:(0,n.isBoolean)(w)?f.PU.boolean:f.PU.other}function p(w){if(w.name){const U=w.name.toLowerCase();if(U==="date"||U==="time")return f.PU.time}for(let U=0;U<w.values.length;U++){const W=w.values[U];if(W!=null)return y(W)}}const v=(w,U=!1)=>{for(const W of w.fields)if(!W.type||W.type===f.PU.other||U)return{...w,fields:w.fields.map(V=>V.type&&V.type!==f.PU.other&&!U?V:{...V,type:p(V)||f.PU.other})};return w},D=w=>!!(w&&w.hasOwnProperty("columns")),E=w=>!!(w&&w.hasOwnProperty("fields")),S=w=>!!(E(w)&&w.hasOwnProperty("value"));function T(w){if("fields"in w)return"length"in w&&w.fields[0]?.values?.get?w:B(w);if(w.hasOwnProperty("type")&&w.type==="docs")return b(w);if(w.hasOwnProperty("datapoints")||w.hasOwnProperty("points"))return h(w);if(w.hasOwnProperty("data"))return w.hasOwnProperty("schema")?(0,m.or)(w):u(w);if(w.hasOwnProperty("columns"))return s(w);if(Array.isArray(w))return(0,l.I)(w);throw console.warn("Can not convert",w),new Error("Unsupported data format")}const M=w=>{const{fields:U}=w,W=w.length,V=[];if(U.length===2){const{timeField:_,timeIndex:H}=L(w);if(_){const j=U[H===0?1:0],Y=U[H];for(let oe=0;oe<W;oe++)V.push([j.values[oe],Y.values[oe]]);return{alias:w.name,target:(0,i.Ct)(j,w),datapoints:V,unit:U[0].config?U[0].config.unit:void 0,refId:w.refId,meta:w.meta}}}for(let _=0;_<W;_++){const H=[];for(let G=0;G<U.length;G++)H.push(U[G].values[_]);V.push(H)}return w.meta&&w.meta.json?{alias:U[0].name||w.name,target:U[0].name||w.name,datapoints:U[0].values,filterable:U[0].config?U[0].config.filterable:void 0,type:"docs"}:{columns:U.map(_=>{const{name:H,config:G}=_;if(G){const{...j}=G;return j.text=H,j}return{text:H}}),type:"table",refId:w.refId,meta:w.meta,rows:V}};function A(w,U,W=!1){const V=w.fields[U];if(!V)return w;const _=[];for(let G=0;G<w.length;G++)_.push(G);const H=(0,r.i)(V,W);return _.sort(H),{...w,fields:w.fields.map(G=>{const j={...G,values:G.values.map((oe,se)=>G.values[_[se]])},{nanos:Y}=G;return Y!==void 0&&(j.nanos=Y.map((oe,se)=>Y[_[se]])),j})}}function x(w){return{...w,fields:w.fields.map(U=>{const W=[...U.values];W.reverse();const V={...U,values:W},{nanos:_}=U;if(_!==void 0){const H=[..._];H.reverse(),V.nanos=H}return V})}}function C(w,U){const W=[];for(const V of w.fields)W.push(V.values[U]);return W}function O(w){return R(w)}function R(w,U){return{fields:(U?w.fields.filter(U):w.fields).map(_=>{let H=_.values;return{name:_.name,type:_.type,config:_.config,values:H,labels:_.labels}}),refId:w.refId,meta:w.meta,name:w.name}}const L=w=>{for(let U=0;U<w.fields.length;U++)if(w.fields[U].type===f.PU.time)return{timeField:w.fields[U],timeIndex:U};return{}};function N(w){const U=v(T(w));if(U.fields&&U.fields.length)for(const W of U.fields)W.state=null;return U}function F(w){return!w||!(0,n.isArray)(w)?[]:w.map(U=>N(U))}function K(w,U){const{series:W,annotations:V}=w;if(w.state===d.Gu.Loading&&W.length===0)return U||(U=w),{...U,state:d.Gu.Loading,request:w.request};const _=performance.now(),H=W.map(Y=>N(Y)),G=F(V),j=performance.now();return{...w,series:H,annotations:G,timings:{dataProcessingTime:j-_}}}function B(w){let U=0;const W=w.fields.map((V,_)=>{const{state:H,...G}=V;return G.name||(G.name=`Field ${_+1}`),G.config||(G.config={}),G.values?G.values.length>U&&(U=G.values.length):G.values=new Array(U),G.type||(G.type=p(G)??f.PU.other),G});return{...w,fields:W,length:U}}},19845:(Q,I,e)=>{"use strict";e.d(I,{S1:()=>l,aH:()=>r,hF:()=>f,jq:()=>i,t9:()=>m,tP:()=>d,uY:()=>s});var n=e(11261),a=e(14236);const o=100;function r(h){if(h.fields.length<2)return!1;const u=h.fields.find(g=>g.type===n.PU.number);let b=!1;for(const g of h.fields)if(f(g)){b=!0;break}return b&&u!==void 0}function i(h){return!h.find(u=>!r(u))}function f(h){if(h.type!==n.PU.time)return!1;let u=null,b=h.values.length>o?o:h.values.length;for(let g=0;g<b;g++){const P=h.values[g];if(u===null||P!==null&&P>u)u=P;else return!1}return!0}function d(h){for(let u=0;u<h.length;u++){const b=(0,a.KR)(h[u]);if(b.timeField!==void 0&&b.timeIndex!==void 0)return!0}return!1}function l(h){return h.fields.some(u=>u.type===n.PU.time)}function m(h,u){if(h.meta?.uniqueRowIdFields!==void 0)return h.meta.uniqueRowIdFields.map(b=>h.fields[b].values[u]).join("-")}function s(h,u){if(u instanceof Array)for(let b=0;b<u.length;b++)h.fields[b].values.push(u[b]);else for(const b of h.fields)b.values.push(u[b.name]);try{h.length++}catch{}}},1933:(Q,I,e)=>{"use strict";e.d(I,{G:()=>i,O:()=>f});var n=e(2543),a=e.n(n),o=e(43127);let r=()=>o.lE;const i=d=>{r=d??r},f=d=>d?.timeZone&&!(0,n.isEmpty)(d.timeZone)?d.timeZone:r()??o.lE},85858:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{isMathString:()=>i,isValid:()=>d,parse:()=>f,parseDateMath:()=>l,roundToFiscal:()=>m});var n=e(2543),a=e.n(n),o=e(47232);const r=["y","M","w","d","h","m","s","Q"];function i(s){return s?!!(typeof s=="string"&&(s.substring(0,3)==="now"||s.includes("||"))):!1}function f(s,h,u,b){if(s){if(typeof s!="string")return(0,o.Ar)(s)?s:(0,n.isDate)(s)?(0,o.KQ)(s):void 0;{let g,P="",c,y;return s.substring(0,3)==="now"?(g=(0,o.oZ)(u),P=s.substring(3)):(c=s.indexOf("||"),c===-1?(y=s,P=""):(y=s.substring(0,c),P=s.substring(c+2)),g=(0,o.KQ)(y,o.mt)),P.length?l(P,g,h,b):g}}}function d(s){const h=f(s);return h&&(0,o.Ar)(h)?h.isValid():!1}function l(s,h,u,b=0){const g=s.replace(/\s/g,""),P=(0,o.KQ)(h);let c=0;const y=g.length;for(;c<y;){const p=g.charAt(c++);let v,D,E,S=!1;if(p==="/")v=0;else if(p==="+")v=1;else if(p==="-")v=2;else return;if(isNaN(parseInt(g.charAt(c),10)))D=1;else if(g.length===2)D=parseInt(g.charAt(c),10);else{const M=c;for(;!isNaN(parseInt(g.charAt(c),10));)if(c++,c>10)return;D=parseInt(g.substring(M,c),10)}if(v===0&&D!==1)return;E=g.charAt(c++),E==="f"&&(E=g.charAt(c++),S=!0);const T=E;if((0,n.includes)(r,T))v===0?S?m(b,P,T,u):u?P.endOf(T):P.startOf(T):v===1?P.add(D,T):v===2&&P.subtract(D,T);else return}return P}function m(s,h,u,b){switch(u){case"y":return b?m(s,h,u,!1).add(11,"M").endOf("M"):h.subtract((h.month()-s+12)%12,"M").startOf("M"),h;case"Q":return b?m(s,h,u,!1).add(2,"M").endOf("M"):h.subtract((h.month()-s+12)%3,"M").startOf("M"),h;default:return}}},70416:(Q,I,e)=>{"use strict";e.d(I,{E9:()=>f,Ri:()=>d,V3:()=>u,WT:()=>l,dU:()=>i,di:()=>s,pp:()=>h,vd:()=>m});var n=e(89369),a=e(68284),o=e(25579);const r={years:["y","Y","years"],months:["M","months"],weeks:["w","W","weeks"],days:["d","D","days"],hours:["h","H","hours"],minutes:["m","minutes"],seconds:["s","S","seconds"]};function i(g,P=!0){if((0,n.d)(g.start,g.end))return"";const c=(0,a.F)(g);return Object.entries(c).reduce((y,[p,v])=>v&&v!==0&&!(p==="seconds"&&!P&&y)?y+`${y!==""?" ":""}${v}${r[p][0]}`:y,"")}function f(g){return g.split(" ").reduce((P,c)=>{const y=c.match(/(\d+)(.+)/),p=y?.[1],v=y?.[2];if(!(p&&v))return P;const D=Object.entries(r).find(([S,T])=>T?.includes(y[2])),E=parseInt(p,10);return D?{...P,[D[0]]:E}:P},{})}function d(g,P){return(0,o.W)(g,P)}function l(g){const P=new Date;return d(P,g).getTime()-P.getTime()}function m(g){return!isNaN(Date.parse(g))}function s(g){for(const P of g.trim().split(" ")){const c=P.match(/(\d+)(.+)/);if(c===null||c.length!==3||!Object.entries(r).find(([p,v])=>v?.includes(c[2]))?.[0])return!1}return!0}function h(g){return b(g,["h","m","s","ms","us","\xB5s","ns"])}function u(g){return b(g,["y","M","w","d","h","m","s","ms","us","\xB5s","ns"])}function b(g,P){for(const c of g.trim().split(" ")){const y=c.match(/([0-9]*[.]?[0-9]+)(.+)/);if(y===null||y.length!==3||!P.includes(y[2]))return!1}return!0}},42994:(Q,I,e)=>{"use strict";e.d(I,{JE:()=>o,Od:()=>r,WC:()=>i});const n="YYYY-MM-DD HH:mm:ss",a="YYYY-MM-DD HH:mm:ss.SSS";class o{constructor(){this.fullDate=n,this.fullDateMS=a,this.interval={millisecond:"HH:mm:ss.SSS",second:"HH:mm:ss",minute:"HH:mm",hour:"MM/DD HH:mm",day:"MM/DD",month:"YYYY-MM",year:"YYYY"}}update(l){this.fullDate=l.fullDate,this.interval=l.interval,l.useBrowserLocale&&this.useBrowserLocale()}useBrowserLocale(){this.fullDate=r({year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),this.fullDateMS=this.fullDate.replace("ss","ss.SSS"),this.interval.millisecond=r({hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},null,this.interval.second).replace("ss","ss.SSS"),this.interval.second=r({hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},null,this.interval.second),this.interval.minute=r({hour:"2-digit",minute:"2-digit",hour12:!1},null,this.interval.minute),this.interval.hour=r({month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1},null,this.interval.hour),this.interval.day=r({month:"2-digit",day:"2-digit",hour12:!1},null,this.interval.day),this.interval.month=r({year:"numeric",month:"2-digit",hour12:!1},null,this.interval.month)}getTimeFieldUnit(l){return`time:${l?this.fullDateMS:this.fullDate}`}}function r(d,l,m){if(f())return m??n;!l&&navigator&&(l=[...navigator.languages]);const s=new Intl.DateTimeFormat(l||void 0,d),h=s.formatToParts(new Date),b={year:"YYYY",month:"MM",day:"DD",hour:s.resolvedOptions().hour12?"hh":"HH",minute:"mm",second:"ss",weekday:"ddd",era:"N",dayPeriod:"A",timeZoneName:"Z"};return h.map(g=>b[g.type]||g.value).join("")}const i=new o,f=()=>!("DateTimeFormat"in Intl)||!("formatToParts"in Intl.DateTimeFormat.prototype)},72724:(Q,I,e)=>{"use strict";e.d(I,{LE:()=>f,M7:()=>d,_Q:()=>m,fq:()=>l,jw:()=>s});var n=e(84743),a=e.n(n),o=e(1933),r=e(42994),i=e(47232);const f=(b,g)=>u(b,(0,o.O)(g)).format(h(g)),d=(b,g)=>u(b,(0,o.O)(g)).format(),l=(b,g)=>u(b,(0,o.O)(g)).fromNow(),m=(b,g)=>u(b,(0,o.O)(g)).format(`${r.WC.fullDate} z`),s=(b,g)=>u(b,(0,o.O)(g)).format("z"),h=b=>b?.defaultWithMS?b?.format??r.WC.fullDateMS:b?.format??r.WC.fullDate,u=(b,g)=>{const P=b,c=a().tz.zone(g);if(c&&c.name)return(0,i.AN)((0,i.yT)(P)).tz(c.name);switch(g){case"utc":return(0,i.AN)((0,i.yT)(P));default:return(0,i.AN)((0,i.yT)(P)).local()}}},38698:(Q,I,e)=>{"use strict";e.d(I,{$D:()=>o.$D,AN:()=>o.AN,Ah:()=>o.Ah,Ar:()=>o.Ar,E9:()=>l.E9,GZ:()=>m.G,HD:()=>r.HD,IM:()=>l.pp,Ii:()=>a,JE:()=>i.JE,JK:()=>o.JK,KQ:()=>o.KQ,LE:()=>f.LE,M7:()=>f.M7,O:()=>m.O,Od:()=>i.Od,P3:()=>r.P3,QZ:()=>r.QZ,Ri:()=>l.Ri,U3:()=>r.U3,V3:()=>l.V3,WC:()=>i.WC,WT:()=>l.WT,XN:()=>o.XN,_Q:()=>f._Q,bQ:()=>d.b,dU:()=>l.dU,di:()=>l.di,fq:()=>f.fq,g$:()=>r.g$,jw:()=>f.jw,le:()=>r.le,mt:()=>o.mt,ns:()=>n,oZ:()=>o.oZ,pp:()=>o.pp,u8:()=>o.u8,vd:()=>l.vd,xQ:()=>o.xQ,xS:()=>o.xS,yT:()=>o.yT});var n=e(85858),a=e(65879),o=e(47232),r=e(91410),i=e(42994),f=e(72724),d=e(53531),l=e(70416),m=e(1933)},47232:(Q,I,e)=>{"use strict";e.d(I,{$D:()=>c,AN:()=>u,Ah:()=>s,Ar:()=>l,JK:()=>i,KQ:()=>h,XN:()=>f,mt:()=>o,oZ:()=>b,pp:()=>P,u8:()=>d,xQ:()=>g,xS:()=>r,yT:()=>m});var n=e(95093),a=e.n(n);const o=a().ISO_8601,r=y=>{a().locale(y)},i=()=>a().locale(),f=()=>a().localeData(),d=y=>y===null||typeof y=="string"||typeof y=="number"||y instanceof Date||Array.isArray(y)&&y.every(p=>typeof p=="string"||typeof p=="number")||l(y),l=y=>a().isMoment(y),m=(y,p)=>a().utc(y,p),s=(y,p)=>a().duration(y,p),h=(y,p)=>a()(y,p),u=y=>h(y),b=(y,p,v)=>{if(y&&y!=="browser"){let D;if(typeof p=="string"&&v?D=a().tz(p,v,y):D=a().tz(p,y),l(D))return D}return h(p,v)},g=y=>a().weekdays().findIndex(p=>p.toLowerCase()===y.toLowerCase()),P=y=>["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].findIndex(p=>p.toLowerCase()===y.toLowerCase()),c=y=>{const p="-weekStart",v=i().replace(p,""),D=y?P(y):-1;D!==-1?a().locale(v+p,{parentLocale:v,week:{dow:D}}):r(v)}},53531:(Q,I,e)=>{"use strict";e.d(I,{b:()=>m});var n=e(2543),a=e.n(n),o=e(84743),r=e.n(o),i=e(1933),f=e(85858),d=e(42994),l=e(47232);const m=(u,b)=>(0,l.Ar)(u)?u:typeof u=="string"?s(u,b):h(u,b),s=(u,b)=>{if(u.indexOf("now")!==-1)return(0,f.isValid)(u)&&(0,f.parse)(u,b?.roundUp,b?.timeZone,b?.fiscalYearStartMonth)||(0,l.KQ)();const g=(0,i.O)(b),P=r().tz.zone(g),c=b?.format??d.WC.fullDate;if(P&&P.name)return(0,l.oZ)(P.name,u,c);switch((0,n.lowerCase)(g)){case"utc":return(0,l.yT)(u,c);default:return(0,l.KQ)(u,c)}},h=(u,b)=>{const g=u,P=(0,i.O)(b),c=r().tz.zone(P);if(c&&c.name)return(0,l.oZ)(c.name,g);switch((0,n.lowerCase)(P)){case"utc":return(0,l.yT)(g);default:return(0,l.KQ)(g)}}},65879:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{calculateInterval:()=>E,convertRawToRange:()=>P,describeInterval:()=>M,describeTextRange:()=>h,describeTimeRange:()=>u,describeTimeRangeAbbreviation:()=>g,intervalToMs:()=>x,intervalToSeconds:()=>A,isFiscal:()=>y,isRelativeTime:()=>c,isRelativeTimeRange:()=>p,isValidTimeSpan:()=>b,msRangeToTimeString:()=>D,relativeToTimeRange:()=>R,roundInterval:()=>C,secondsToHms:()=>v,timeRangeToRelative:()=>O});var n=e(2543),a=e.n(n),o=e(85858),r=e(72724),i=e(47232),f=e(53531);const d={s:{display:"second"},m:{display:"minute"},h:{display:"hour"},d:{display:"day"},w:{display:"week"},M:{display:"month"},y:{display:"year"}},l=[{from:"now/d",to:"now/d",display:"Today"},{from:"now/d",to:"now",display:"Today so far"},{from:"now/w",to:"now/w",display:"This week"},{from:"now/w",to:"now",display:"This week so far"},{from:"now/M",to:"now/M",display:"This month"},{from:"now/M",to:"now",display:"This month so far"},{from:"now/y",to:"now/y",display:"This year"},{from:"now/y",to:"now",display:"This year so far"},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday"},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday"},{from:"now-7d/d",to:"now-7d/d",display:"This day last week"},{from:"now-1w/w",to:"now-1w/w",display:"Previous week"},{from:"now-1M/M",to:"now-1M/M",display:"Previous month"},{from:"now-1Q/fQ",to:"now-1Q/fQ",display:"Previous fiscal quarter"},{from:"now-1y/y",to:"now-1y/y",display:"Previous year"},{from:"now-1y/fy",to:"now-1y/fy",display:"Previous fiscal year"},{from:"now-5m",to:"now",display:"Last 5 minutes"},{from:"now-15m",to:"now",display:"Last 15 minutes"},{from:"now-30m",to:"now",display:"Last 30 minutes"},{from:"now-1h",to:"now",display:"Last 1 hour"},{from:"now-3h",to:"now",display:"Last 3 hours"},{from:"now-6h",to:"now",display:"Last 6 hours"},{from:"now-12h",to:"now",display:"Last 12 hours"},{from:"now-24h",to:"now",display:"Last 24 hours"},{from:"now-2d",to:"now",display:"Last 2 days"},{from:"now-7d",to:"now",display:"Last 7 days"},{from:"now-30d",to:"now",display:"Last 30 days"},{from:"now-90d",to:"now",display:"Last 90 days"},{from:"now-6M",to:"now",display:"Last 6 months"},{from:"now-1y",to:"now",display:"Last 1 year"},{from:"now-2y",to:"now",display:"Last 2 years"},{from:"now-5y",to:"now",display:"Last 5 years"},{from:"now/fQ",to:"now",display:"This fiscal quarter so far"},{from:"now/fQ",to:"now/fQ",display:"This fiscal quarter"},{from:"now/fy",to:"now",display:"This fiscal year so far"},{from:"now/fy",to:"now/fy",display:"This fiscal year"}],m=[{from:"now",to:"now+1m",display:"Next minute"},{from:"now",to:"now+5m",display:"Next 5 minutes"},{from:"now",to:"now+15m",display:"Next 15 minutes"},{from:"now",to:"now+30m",display:"Next 30 minutes"},{from:"now",to:"now+1h",display:"Next hour"},{from:"now",to:"now+3h",display:"Next 3 hours"},{from:"now",to:"now+6h",display:"Next 6 hours"},{from:"now",to:"now+12h",display:"Next 12 hours"},{from:"now",to:"now+24h",display:"Next 24 hours"},{from:"now",to:"now+2d",display:"Next 2 days"},{from:"now",to:"now+7d",display:"Next 7 days"},{from:"now",to:"now+30d",display:"Next 30 days"},{from:"now",to:"now+90d",display:"Next 90 days"},{from:"now",to:"now+6M",display:"Next 6 months"},{from:"now",to:"now+1y",display:"Next year"},{from:"now",to:"now+2y",display:"Next 2 years"},{from:"now",to:"now+5y",display:"Next 5 years"}],s={};(0,n.each)(l,L=>{s[L.from+" to "+L.to]=L}),(0,n.each)(m,L=>{s[L.from+" to "+L.to]=L});function h(L){const N=L.indexOf("+")!==0;L.indexOf("now")===-1&&(L=(N?"now-":"now")+L);let F=s[L+" to now"];if(F)return F;N?F={from:L,to:"now",display:""}:F={from:"now",to:L,display:""};const K=/^now([-+])(\d+)(\w)/.exec(L);if(K){const B=K[3],w=parseInt(K[2],10),U=d[B];U&&(F.display=N?"Last ":"Next ",F.display+=w+" "+U.display,F.section=U.section,w>1&&(F.display+="s"))}else F.display=F.from+" to "+F.to,F.invalid=!0;return F}function u(L,N){const F=s[L.from.toString()+" to "+L.to.toString()];if(F)return F.display;const K={timeZone:N};if((0,i.Ar)(L.from)&&(0,i.Ar)(L.to))return(0,r.LE)(L.from,K)+" to "+(0,r.LE)(L.to,K);if((0,i.Ar)(L.from)){const B=o.parse(L.to,!0,"utc");return B?(0,r.LE)(L.from,K)+" to "+(0,r.fq)(B,K):""}if((0,i.Ar)(L.to)){const B=o.parse(L.from,!1,"utc");return B?(0,r.fq)(B,K)+" to "+(0,r.LE)(L.to,K):""}return L.to.toString()==="now"?h(L.from).display:L.from.toString()+" to "+L.to.toString()}const b=L=>L.indexOf("$")===0||L.indexOf("+$")===0?!0:h(L).invalid!==!0,g=(L,N)=>{if((0,i.Ar)(L.from))return(0,r.jw)(L.from,{timeZone:N});const F=o.parse(L.from,!0);return F?(0,r.jw)(F,{timeZone:N}):""},P=(L,N,F,K)=>{const B=(0,f.b)(L.from,{roundUp:!1,timeZone:N,fiscalYearStartMonth:F,format:K}),w=(0,f.b)(L.to,{roundUp:!0,timeZone:N,fiscalYearStartMonth:F,format:K});return o.isMathString(L.from)||o.isMathString(L.to)?{from:B,to:w,raw:L}:{from:B,to:w,raw:{from:B,to:w}}};function c(L){return typeof L=="string"?L.indexOf("now")>=0:!1}function y(L){return typeof L.raw.from=="string"&&L.raw.from.indexOf("f")>0?!0:typeof L.raw.to=="string"&&L.raw.to.indexOf("f")>0}function p(L){return c(L.from)||c(L.to)}function v(L){const N=Math.floor(L/31536e3);if(N)return N+"y";const F=Math.floor(L%31536e3/86400);if(F)return F+"d";const K=Math.floor(L%31536e3%86400/3600);if(K)return K+"h";const B=Math.floor(L%31536e3%86400%3600/60);if(B)return B+"m";const w=Math.floor(L%31536e3%86400%3600%60);if(w)return w+"s";const U=Math.floor(L*1e3);return U?U+"ms":"less than a millisecond"}function D(L){const N=Number((L/1e3).toFixed()),F=Math.floor(N/60/60),K=Math.floor(N/60)-F*60,B=Number((N%60).toFixed());let w=F?F+"h":"",U=K?K+"min":"",W=B?B+"sec":"";return w&&U?w=w+" ":w=w,(U||w)&&W?U=U+" ":U=U,w+U+W||"less than 1sec"}function E(L,N,F){let K=1;F&&(K=x(F));let B=C((L.to.valueOf()-L.from.valueOf())/N);return K>B&&(B=K),{intervalMs:B,interval:v(B/1e3)}}const S=/(-?\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,T={y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001};function M(L){if(Number(L))return{sec:T.s,type:"s",count:parseInt(L,10)};const N=L.match(S);if(!N)throw new Error(`Invalid interval string, has to be either unit-less or end with one of the following units: "${Object.keys(T).join(", ")}"`);const F=T[N[2]];if(F===void 0)throw new Error("describeInterval failed: invalid interval string");return{sec:F,type:N[2],count:parseInt(N[1],10)}}function A(L){const N=M(L);return N.sec*N.count}function x(L){const N=M(L);return N.sec*1e3*N.count}function C(L){switch(!0){case L<10:return 1;case L<15:return 10;case L<35:return 20;case L<75:return 50;case L<150:return 100;case L<350:return 200;case L<750:return 500;case L<1500:return 1e3;case L<3500:return 2e3;case L<7500:return 5e3;case L<12500:return 1e4;case L<17500:return 15e3;case L<25e3:return 2e4;case L<45e3:return 3e4;case L<9e4:return 6e4;case L<21e4:return 12e4;case L<45e4:return 3e5;case L<75e4:return 6e5;case L<105e4:return 9e5;case L<15e5:return 12e5;case L<27e5:return 18e5;case L<54e5:return 36e5;case L<9e6:return 72e5;case L<162e5:return 108e5;case L<324e5:return 216e5;case L<864e5:return 432e5;case L<6048e5:return 864e5;case L<18144e5:return 6048e5;case L<36288e5:return 2592e6;default:return 31536e6}}function O(L,N=(0,i.KQ)()){const F=N.unix()-L.from.unix(),K=N.unix()-L.to.unix();return{from:F,to:K}}function R(L,N=(0,i.KQ)()){const F=(0,i.KQ)(N).subtract(L.from,"s"),K=L.to===0?(0,i.KQ)(N):(0,i.KQ)(N).subtract(L.to,"s");return{from:F,to:K,raw:{from:F,to:K}}}},91410:(Q,I,e)=>{"use strict";e.d(I,{HD:()=>l,P3:()=>s,QZ:()=>m,U3:()=>h,g$:()=>f,le:()=>d});var n=e(2543),a=e.n(n),o=e(84743),r=e.n(o),i=e(1933),f=(y=>(y.default="",y.localBrowserTime="browser",y.utc="utc",y))(f||{});const d=y=>{switch((0,i.O)({timeZone:y})){case"browser":return"Local browser time";case"utc":return"UTC";default:return y}},l=y=>r().tz.zone(y),m=(y,p)=>{const v=u(y,p);return v||g(y,p)},s=(0,n.memoize)((y=!1)=>{const p=[];return y===!0?p.push("","browser","utc"):y&&p.push(...y),r().tz.names().reduce((v,D)=>{const E=c[D];return!Array.isArray(E)||E.length===0||v.push(D),v},p)}),h=(0,n.memoize)((y=!1)=>{const v=s(y).reduce((D,E)=>{const S=E.indexOf("/");if(S===-1){const M="";return D[M]=D[M]??[],D[M].push(E),D}const T=E.slice(0,S);return D[T]=D[T]??[],D[T].push(E),D},{});return Object.keys(v).map(D=>({name:D,zones:v[D]}))}),u=(y,p)=>{switch(y){case"utc":return{name:"Coordinated Universal Time",ianaName:"UTC",zone:y,countries:[],abbreviation:"UTC, GMT",offsetInMins:0};case"":{const v=(0,i.O)(),E=v==="browser"||v==="utc"?u(v,p):g(v,p);return{countries:c[v]??[],abbreviation:"",offsetInMins:0,...E,ianaName:E?.ianaName??"",name:"Default",zone:y}}case"browser":{const v=r().tz.guess(!0),D=g(v,p);return{countries:c[v]??[],abbreviation:"Your local time",offsetInMins:new Date().getTimezoneOffset(),...D,name:"Browser Time",ianaName:D?.ianaName??"",zone:y}}default:return}},b=y=>/^(\+|\-).+/.test(y)?"":y,g=(y,p)=>{const v=r().tz.zone(y);if(v)return{name:y,ianaName:v.name,zone:y,countries:c[y]??[],abbreviation:b(v.abbr(p)),offsetInMins:v.utcOffset(p)}},P={AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran (Islamic Republic Of)",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia (Federated States Of)",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},c=r().tz.countries().reduce((y,p)=>r().tz.zonesForCountry(p).reduce((D,E)=>{D[E]||(D[E]=[]);const S=P[p];return S&&D[E].push({code:p,name:S}),D},y),{})},18226:(Q,I,e)=>{"use strict";e.d(I,{o:()=>r});var n=e(74486),a=e(88483),o=e(16126);class r{constructor(){this.subscribers=new Map,this.emitter=new n.A}publish(d){this.emitter.emit(d.type,d)}subscribe(d,l){return this.getStream(d).subscribe({next:l})}getStream(d){return new a.c(l=>{const m=s=>{l.next(s)};return this.emitter.on(d.type,m),this.subscribers.set(m,l),()=>{this.emitter.off(d.type,m),this.subscribers.delete(m)}})}newScopedBus(d,l){return new i([d],this,l)}emit(d,l){typeof d=="string"?this.emitter.emit(d,{type:d,payload:l}):this.emitter.emit(d.name,{type:d.name,payload:l})}on(d,l,m){if(l.wrapper=s=>{l(s.payload)},typeof d=="string"?this.emitter.on(d,l.wrapper):this.emitter.on(d.name,l.wrapper),m){const s=m.$on("$destroy",()=>{this.off(d,l),s()})}}off(d,l){if(typeof d=="string"){this.emitter.off(d,l.wrapper);return}this.emitter.off(d.name,l.wrapper)}removeAllListeners(){this.emitter.removeAllListeners();for(const[d,l]of this.subscribers)l.complete(),this.subscribers.delete(d)}}class i{constructor(d,l,m){this.path=d,this.eventBus=l,this.filterConfig=m??{onlyLocal:!1}}publish(d){d.origin||(d.origin=this),this.eventBus.publish(d)}filter(d){return this.filterConfig.onlyLocal?d.origin===this:!0}getStream(d){return this.eventBus.getStream(d).pipe((0,o.p)(this.filter.bind(this)))}subscribe(d,l){return this.getStream(d).subscribe({next:l})}removeAllListeners(){this.eventBus.removeAllListeners()}newScopedBus(d,l){return new i([...this.path,d],this,l)}}},69129:(Q,I,e)=>{"use strict";e.d(I,{LL:()=>m,LO:()=>r,NI:()=>l,Tp:()=>s,We:()=>i,b_:()=>a,gc:()=>f,ql:()=>o,wE:()=>d});var n=e(65463);class a extends n.x{static{this.type="data-hover"}}class o extends n.a{static{this.type="data-hover-clear"}}class r extends n.x{static{this.type="data-select"}}class i extends n.x{static{this.type="annotation-event"}}class f extends n.x{static{this.type="dashboard-loaded"}}class d extends n.a{static{this.type="datasource-updated-successfully"}}class l extends n.a{static{this.type="datasource-test-succeeded"}}class m extends n.a{static{this.type="datasource-test-failed"}}class s extends n.x{static{this.type="set-panel-attention"}}},89550:(Q,I,e)=>{"use strict";e.d(I,{R:()=>a});const n=new Set;function a(o){if(n.has(o))throw new Error(`There is already an event defined with type '${o}'`);return n.add(o),{name:o}}},56302:(Q,I,e)=>{"use strict";e.d(I,{LL:()=>r.LL,LO:()=>r.LO,NI:()=>r.NI,Rb:()=>n.R,Tp:()=>r.Tp,We:()=>r.We,aV:()=>a.a,b_:()=>r.b_,gc:()=>r.gc,or:()=>o.o,ql:()=>r.ql,wE:()=>r.wE,x$:()=>a.x});var n=e(89550),a=e(65463),o=e(18226),r=e(69129)},65463:(Q,I,e)=>{"use strict";e.d(I,{a:()=>n,x:()=>a});class n{constructor(){this.type=this.__proto__.constructor.type}setTags(r){return this.tags=new Set(r),this}}class a extends n{constructor(r){super(),this.payload=r}}},66670:(Q,I,e)=>{"use strict";e.d(I,{K:()=>a});var n=e(83077);class a extends n.O{}},57875:(Q,I,e)=>{"use strict";e.d(I,{H:()=>g,J:()=>u});var n=e(2543),a=e.n(n),o=e(14236),r=e(53531),i=e(47232),f=e(11261),d=e(28802),l=e(62398),m=e(83195),s=e(58563);const h={dateTimeAsIso:!0,dateTimeAsIsoNoDateIfToday:!0,dateTimeAsUS:!0,dateTimeAsUSNoDateIfToday:!0,dateTimeAsLocal:!0,dateTimeAsLocalNoDateIfToday:!0,dateTimeFromNow:!0};function u(c){if(!c||(0,n.isEmpty)(c)||!c.field)return b;const y=c.field,p=y.config??{},{palette:v}=c.theme.visualization;let D=p.unit,E=D&&(h[D]||D.startsWith("time:")),S=!1;if(y.type===f.PU.time&&!E){if(D="dateTimeAsSystem",E=!0,y.values&&y.values.length>1){let L=y.values[0],N=y.values[y.values.length-1];typeof L=="string"?(L=(0,r.b)(L).unix(),N=(0,r.b)(N).unix()):(L/=1e3,N/=1e3),S=Math.abs(N-L)<60}}else y.type===f.PU.boolean?(0,m.j9)(D)||(D="bool"):!D&&y.type===f.PU.string&&(D="string");const T=D?.startsWith("currency"),M=(0,m.j9)(D),A=y.type===f.PU.number,C=!E&&!T&&!M&&!(D==="locale")&&A&&p.decimals==null,O=(0,m.j_)(D||"none"),R=(0,s.jc)(y,c.theme);return(L,N)=>{const{mappings:F}=p,K=D==="string";E&&typeof L=="string"&&(L=(0,i.yT)(L).valueOf());let B=K?NaN:(0,d.t)(L),w,U,W,V,_,H;if(F&&F.length>0){const j=(0,l.Zz)(F,L);j&&(j.text!=null&&(w=j.text),j.color!=null&&(V=c.theme.visualization.getColorByName(j.color)),j.icon!=null&&(_=j.icon))}else if(y.type===f.PU.enum){if(L==null)return{text:"",numeric:NaN};const j=+L;if(p&&p.type&&p.type.enum){const{text:Y,color:oe}=p.type.enum;if(w=Y?Y[j]:`${L}`,V=oe?oe[j]:void 0,V==null){const se=v[j%v.length];V=c.theme.visualization.getColorByName(se)}}}if(!Number.isNaN(B)){if(w==null&&!(0,n.isBoolean)(L)){let j;C&&N!=null?(j=O(B,N,null,c.timeZone,S),j.text=+j.text+""):j=O(B,p.decimals,null,c.timeZone,S),w=j.text,W=j.suffix,U=j.prefix}if(V==null){const j=R(B);V=j.color,H=j.percent}}if(w==null&&(0,n.isArray)(L)&&(w=(0,n.join)(L,", ")),w==null&&(w=(0,n.toString)(L),w||(p.noValue?w=p.noValue:w="")),!V){const j=R(-1/0);V=j.color,H=j.percent}const G={text:w,numeric:B,prefix:U,suffix:W,color:V};return _!=null&&(G.icon=_),H!=null&&(G.percent=H),G}}function b(c){return{text:(0,n.toString)(c),numeric:(0,d.t)(c)}}function g(){return c=>({text:(0,o.oE)(c)==="other"?`${JSON.stringify(c,P())}`:`${c}`,numeric:null})}const P=()=>{const c=new WeakSet;return(y,p)=>{if(typeof p=="object"&&p!==null){if(c.has(p))return;c.add(p)}return p}}},8066:(Q,I,e)=>{"use strict";e.d(I,{Hs:()=>g,Qi:()=>b,lz:()=>P,uf:()=>h});var n=e(21197),a=e(55459),o=e.n(a),r=e(84140),i=e(23596),f=e(75059),d=e(24293),l=e(83077),m=e(58563),s=e(47737);const h=new l.O(()=>[{id:d.Y.Fixed,name:"Single color",description:"Set a specific color",getCalculator:c},{id:d.Y.Shades,name:"Shades of a color",description:"Select shades of a specific color",getCalculator:y},{id:d.Y.Thresholds,name:"From thresholds",isByValue:!0,description:"Derive colors from thresholds",getCalculator:(p,v)=>(D,E,S)=>{const T=S??s.QS;return v.visualization.getColorByName(T.color)}},new u({id:d.Y.PaletteClassic,name:"Classic palette",isContinuous:!1,isByValue:!1,getColors:p=>p.visualization.palette}),new u({id:d.Y.PaletteClassicByName,name:"Classic palette (by series name)",isContinuous:!1,isByValue:!1,useSeriesName:!0,getColors:p=>p.visualization.palette.filter(v=>i.getContrastRatio(p.visualization.getColorByName(v),p.colors.background.primary)>=p.colors.contrastThreshold)}),new u({id:d.Y.ContinuousGrYlRd,name:"Green-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:p=>["green","yellow","red"]}),new u({id:d.Y.ContinuousRdYlGr,name:"Red-Yellow-Green",isContinuous:!0,isByValue:!0,getColors:p=>["red","yellow","green"]}),new u({id:d.Y.ContinuousBlYlRd,name:"Blue-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:p=>["dark-blue","super-light-yellow","dark-red"]}),new u({id:d.Y.ContinuousYlRd,name:"Yellow-Red",isContinuous:!0,isByValue:!0,getColors:p=>["super-light-yellow","dark-red"]}),new u({id:d.Y.ContinuousBlPu,name:"Blue-Purple",isContinuous:!0,isByValue:!0,getColors:p=>["blue","purple"]}),new u({id:d.Y.ContinuousYlBl,name:"Yellow-Blue",isContinuous:!0,isByValue:!0,getColors:p=>["super-light-yellow","dark-blue"]}),new u({id:d.Y.ContinuousBlues,name:"Blues",isContinuous:!0,isByValue:!0,getColors:p=>["panel-bg","dark-blue"]}),new u({id:d.Y.ContinuousReds,name:"Reds",isContinuous:!0,isByValue:!0,getColors:p=>["panel-bg","dark-red"]}),new u({id:d.Y.ContinuousGreens,name:"Greens",isContinuous:!0,isByValue:!0,getColors:p=>["panel-bg","dark-green"]}),new u({id:d.Y.ContinuousPurples,name:"Purples",isContinuous:!0,isByValue:!0,getColors:p=>["panel-bg","dark-purple"]})]);class u{constructor(v){this.id=v.id,this.name=v.name,this.description=v.description,this.getNamedColors=v.getColors,this.isContinuous=v.isContinuous,this.isByValue=v.isByValue,this.useSeriesName=v.useSeriesName}getColors(v){return this.getNamedColors?this.colorCache&&this.colorCacheTheme===v?this.colorCache:(this.colorCache=this.getNamedColors(v).map(v.visualization.getColorByName),this.colorCacheTheme=v,this.colorCache):[]}getInterpolator(){return this.interpolator||(this.interpolator=(0,n.Ik)(this.colorCache)),this.interpolator}getCalculator(v,D){const E=this.getColors(D);return this.isByValue?this.isContinuous?(S,T,M)=>this.getInterpolator()(T):(S,T,M)=>E[T*(E.length-1)]:this.useSeriesName?(S,T,M)=>E[Math.abs(o()(v.name))%E.length]:(S,T,M)=>{const A=v.state?.seriesIndex??0;return E[A%E.length]}}}function b(p){return h.get(p.config.color?.mode??d.Y.Thresholds)}function g(p){return h.get(p??d.Y.Thresholds)}function P(p,v){const D=b(p);if(!D.isByValue)return{color:D.getCalculator(p,v)(0,0),threshold:s.QS,percent:1};const E=(0,m.jc)(p,v),S=p.config.color?.seriesBy??"last",M=(0,f.Nw)({field:p,reducers:[S]})[S]??0;return E(M)}function c(p,v){return()=>v.visualization.getColorByName(p.config.color?.fixedColor??d.F)}function y(p,v){return()=>{const D=v.visualization.getColorByName(p.config.color?.fixedColor??d.F),E=[D],S=6,T=10,M=35,A=35;for(let C=1;C<S;C++)E.push((0,r.A)(D).spin(C/S*T).brighten(C/S*M).toHexString()),E.push((0,r.A)(D).spin(-(C/S)*T).darken(C/S*A).toHexString());const x=p.state?.seriesIndex??0;return E[x%E.length]}}},56323:(Q,I,e)=>{"use strict";e.d(I,{PI:()=>y,Pm:()=>c,XS:()=>S,Zo:()=>A,a_:()=>P,eG:()=>E,k3:()=>h,k_:()=>g,nF:()=>b,py:()=>u});var n=e(2543),a=e.n(n),o=e(78368),r=e(14236),i=e(85200),f=e(75059),d=e(1173),l=e(11261),m=e(57875),s=e(28240);const h="__series.name",u="__field.displayName",b="__field.labels",g="__calc",P="__cell_",c=25,y=C=>{const{replaceVariables:O,reduceOptions:R,timeZone:L,theme:N}=C,F=R.calcs.length?R.calcs:[f.gy.last],K=[],B=(0,i.NS)(R.fields?{id:d.Ct.byRegexp,options:R.fields}:{id:d.Ct.numeric}),w=C.data??[],U=R.limit?R.limit:c;let W=!1;for(let V=0;V<w.length&&!W;V++){const _=w[V],{timeField:H}=(0,r.KR)(_),G=new o.R(_);for(let j=0;j<_.fields.length&&!W;j++){const Y=_.fields[j],oe=Y.getLinks;if(!B(Y,_,w))continue;let se=Y.config;Y.state?.range&&(se={...se,...Y.state?.range});let ne=Y.config.displayName??"";const ee=Y.display??(0,m.J)({field:Y,theme:C.theme,timeZone:L});if(R.values)for(let Z=0;Z<Y.values.length;Z++){Y.state=v(Y,K.length);const z=x(Y,Z),q=ee(Y.values[Z]),ie=p(_,Y,Z,O,z),de=D(ie,C.fieldConfig,N);if(K.push({name:"",field:se,display:{...q,title:ie,color:de??q.color},view:G,colIndex:j,rowIndex:Z,getLinks:oe?()=>oe({valueRowIndex:Z}):()=>[],hasLinks:E(Y)}),K.length>=U){W=!0;break}}else{const Z=(0,f.Nw)({field:Y,reducers:F});for(const z of F){const q=Y.state?.scopedVars??{};q[g]={value:z,text:z};const ie=ee(Z[z]);ne!==""?ie.title=O(ne,q):ie.title=(0,s.Ct)(Y,_,w),ie.percentChange=C.percentChange?(0,f.Nw)({field:Y,reducers:[f.gy.diffperc]}).diffperc:void 0;let de;C.sparkline&&(de={y:_.fields[j],x:H},z===f.gy.last?de.highlightIndex=de.y.values.length-1:z===f.gy.first&&(de.highlightIndex=0));const ue=_.length===1?0:void 0;K.push({name:z,field:se,display:ie,sparkline:de,view:G,colIndex:j,getLinks:oe?()=>oe({calculatedValue:ie,valueRowIndex:ue}):()=>[],hasLinks:E(Y)})}}}}return K.length===0&&K.push(T(C)),K};function p(C,O,R,L,N){const F=O.config.displayName;if(F)return F.indexOf(P)?L(A(F),N):L(F,N);let K=[],B=0;for(const w of C.fields)if(w!==O)if(w.type===l.PU.string){const U=w.values[R]??"",W=w.display?w.display(U).text:U;W.length>0&&K.push(W)}else w.type===l.PU.number&&B++;return(B||K.length===0)&&K.push((0,s.Ct)(O,C)),K.join(" ")}function v(C,O){return{...C.state,seriesIndex:O}}function D(C,O,R){for(const L of O.overrides)if(L.matcher.id==="byName"&&L.matcher.options===C){for(const N of L.properties)if(N.id==="color"&&N.value)return R.visualization.getColorByName(N.value.fixedColor)}return null}function E(C){return C.config?.links?.length?C.config.links.length>0:!1}function S(C){let O="",R="",L="",N="";for(let F=0;F<C.length;F++){const K=C[F].display;K.text&&K.text.length>R.length&&(R=K.text),K.title&&K.title.length>O.length&&(O=K.title),K.prefix&&K.prefix.length>L.length&&(L=K.prefix),K.suffix&&K.suffix.length>N.length&&(N=K.suffix)}return{text:R,title:O,suffix:N,prefix:L}}function T(C){const O="No data",{fieldConfig:R,timeZone:L}=C,{defaults:N}=R,K=(0,m.J)({field:{type:l.PU.other,config:N},theme:C.theme,timeZone:L})(null),B=M(K,O);return{name:O,field:{...N,max:N.max??0,min:N.min??0},display:{text:B,numeric:0,color:K.color},hasLinks:!1}}function M(C,O){return!C||(0,n.isEmpty)(C.text)?O:C.text}function A(C){return C.replace(/\${__cell_(\d+)(.*?)}|\[\[__cell_(\d+)(.*?)\]\]|\$__cell_(\d+)(\S*)/g,(O,R,L,N,F,K,B)=>`\${__data.fields[${R??N??K}]${L??F??B}}`)}function x(C,O){return C.state?.scopedVars?.__dataContext?{...C.state?.scopedVars,__dataContext:{value:{...C.state?.scopedVars?.__dataContext.value,rowIndex:O}}}:C.state?.scopedVars}},90708:(Q,I,e)=>{"use strict";e.d(I,{BF:()=>A,K3:()=>O,_M:()=>C,nJ:()=>p,rJ:()=>R,we:()=>v});var n=e(2543),a=e.n(n),o=e(96540),r=e(80292),i=e(52622),f=e(14236),d=e(21423),l=e(23596),m=e(75059),s=e(85200),h=e(11261),u=e(24293),b=e(71733),g=e(6709),P=e(57875),c=e(58563),y=e(69550);function p(N){let F=null,K=null;const B=[m.gy.min,m.gy.max];for(const w of N)for(const U of w.fields)if(U.type===h.PU.number){const W=(0,m.Nw)({field:U,reducers:B}),V=W[m.gy.min],_=W[m.gy.max];(F===null||V<F)&&(F=V),(K===null||_>K)&&(K=_)}return{min:F,max:K,delta:(K??0)-(F??0)}}function v(N){if(!N.data)return[];const F=N.fieldConfig;if(!F)return N.data;const K=N.fieldConfigRegistry??y.G;let B=0,w;const U=[];if(F.overrides)for(const W of F.overrides){const V=s.sJ.get(W.matcher.id);V&&U.push({match:V.get(W.matcher.options),properties:W.properties})}return N.data.map((W,V)=>{const _={...W};_.fields=_.fields.map(H=>({...H,config:(0,n.cloneDeep)(H.config),state:{...H.state}}));for(const H of _.fields){const G=H.config;H.state.scopedVars={__dataContext:{value:{data:N.data,frame:_,frameIndex:V,field:H}}};const j={field:H,data:N.data,dataFrameIndex:V,replaceVariables:N.replaceVariables,fieldConfigRegistry:K};T(G,F.defaults,j);for(const ne of U)if(ne.match(H,_,N.data))for(const ee of ne.properties)S(G,ee,j);let Y=H.type;if(!Y||Y===h.PU.other){const ne=(0,f.dF)(H);ne&&(Y=ne)}const{range:oe,newGlobalRange:se}=D(G,H,w,N.data);if(w=se,H.state.seriesIndex=B,H.state.range=oe,H.type=Y,H.type!==h.PU.time&&B++,H.display=(0,P.J)({field:H,theme:N.theme,timeZone:N.timeZone}),H.config.unit!=="dateTimeFromNow"&&(H.display=E(H.display,2500)),H.getLinks=C(_,H,H.state.scopedVars,j.replaceVariables,N.timeZone,N.dataLinkPostProcessor),H.type===h.PU.nestedFrames)for(const ne of H.values)for(let ee=0;ee<ne.length;ee++)for(const Z of ne[ee].fields)Z.display=(0,P.J)({field:Z,theme:N.theme,timeZone:N.timeZone}),Z.state={scopedVars:{__dataContext:{value:{data:ne,frame:ne[ee],frameIndex:ee,field:Z}}}},Z.getLinks=C(ne[ee],Z,Z.state.scopedVars,j.replaceVariables,N.timeZone,N.dataLinkPostProcessor)}return _})}function D(N,F,K,B){if(F.type!==h.PU.number||(0,n.isNumber)(N.min)&&(0,n.isNumber)(N.max))return{newGlobalRange:K};if(N.fieldMinMax){const V=(0,c.AP)(F),_=N.min??V.min,H=N.max??V.max;return{range:{min:_,max:H,delta:H-_},newGlobalRange:K}}const w=K??p(B),U=N.min??w.min,W=N.max??w.max;return{range:{min:U,max:W,delta:W-U},newGlobalRange:w}}function E(N,F=2500){const K=new Map;for(let B=-1;B<=15;B++)K.set(B,new Map);return(B,w)=>{let U=K.get(w??-1),W=U.get(B);return W||(U.size===F&&U.clear(),W=N(B,w),W.color&&(W.color=(0,l.asHexString)(W.color)),U.set(B,W)),W}}function S(N,F,K){const w=K.fieldConfigRegistry.getIfExists(F.id);if(!w)return;const U=w.process(F.value,K,w.settings);U==null?w.isCustom&&N.custom?(0,n.unset)(N.custom,w.path):(0,n.unset)(N,w.path):w.isCustom?(N.custom||(N.custom={}),(0,n.set)(N.custom,w.path,U)):(0,n.set)(N,w.path,U)}function T(N,F,K){N.links&&F.links&&(N.links=[...N.links,...F.links]);for(const B of K.fieldConfigRegistry.list())B.isCustom&&!N.custom&&(N.custom={}),M(B.isCustom?N.custom:N,B.isCustom?F.custom:F,B,K);A(N)}function M(N,F,K,B){const w=(0,n.get)(N,K.path);if(w==null){const U=B.fieldConfigRegistry.getIfExists(K.id);if(!U)return;if(U&&U.shouldApply(B.field)){const W=U.process((0,n.get)(F,U.path),B,U.settings);W!=null&&(0,n.set)(N,U.path,W)}}}function A(N){const{thresholds:F}=N;if(N.color?N.color.mode||delete N.color:F&&(N.color={mode:u.Y.Thresholds}),N.hasOwnProperty("min")&&N.hasOwnProperty("max")&&N.min>N.max){const K=N.max;N.max=N.min,N.min=K}}const x=N=>{const{link:F,linkModel:K,dataLinkScopedVars:B,field:w,replaceVariables:U}=N;return F.internal?(0,g.u)({link:F,internalLink:F.internal,scopedVars:B,field:w,range:F.internal.range,replaceVariables:U}):K},C=(N,F,K,B,w,U)=>W=>!F.config.links||F.config.links.length===0?[]:F.config.links.map(_=>{const H=L(N,F,K),G={...K,__dataContext:H},j=(se,ne,ee)=>B(se,{...G,...ne},ee);W.valueRowIndex!==void 0&&!isNaN(W.valueRowIndex)?H.value.rowIndex=W.valueRowIndex:H.value.calculatedValue=W.calculatedValue;let Y,oe=_.onClick||!_.onBuildUrl?_.url:_.onBuildUrl({origin:F,replaceVariables:j});return oe&&(oe=b.I.assureBaseUrl(oe.replace(/\n/g,"")),oe=B(oe,G,i.$m.UriEncode),oe=b.I.processUrl(oe)),_.onClick?Y={href:oe,title:B(_.title||"",G),target:_.targetBlank?"_blank":void 0,onClick:(se,ne)=>{_.onClick({origin:ne??F,e:se,replaceVariables:j})},origin:F}:Y={href:oe,title:B(_.title||"",G),target:_.targetBlank?"_blank":void 0,origin:F},(U||x)({frame:N,field:F,dataLinkScopedVars:G,replaceVariables:B,config:W,link:_,linkModel:Y})}).filter(_=>!!_);function O(N){if(!N||N.length===0)return[];const F=[...N],K=(0,P.H)();for(let B=0;B<F.length;B++){const w={...F[B]},U=[...w.fields];for(let W=0;W<U.length;W++)U[W]={...U[W],display:K};F[B]={...w,fields:U}}return F}function R(N,F,K,B,w,U,W){const V=N?.fieldConfigRegistry,_=(0,o.useRef)(0),H=(0,r.A)(K?.series);return(0,o.useMemo)(()=>{if(!V||!F||!K)return;const G=K?.series;K.structureRev==null&&G&&H&&!(0,d.J3)(G,H,d.bW)&&_.current++;const j={structureRev:_.current,...K,series:v({data:G,fieldConfig:F,fieldConfigRegistry:V,replaceVariables:U,theme:w,timeZone:B,dataLinkPostProcessor:W})};return K.annotations&&K.annotations.length>0&&(j.annotations=v({data:K.annotations,fieldConfig:{defaults:{},overrides:[]},replaceVariables:U,theme:w,timeZone:B,dataLinkPostProcessor:W})),j},[V,F,K,H,B,w,U,W])}function L(N,F,K){return K?.__dataContext?{value:{...K.__dataContext.value}}:{value:{frame:N,field:F,data:[N]}}}},28240:(Q,I,e)=>{"use strict";e.d(I,{Ct:()=>d,Fm:()=>i,Ri:()=>r,fk:()=>m,j2:()=>f});var n=e(85200),a=e(11261),o=e(8249);function r(h,u){if(h.name)return h.name;const b=[];for(const g of h.fields)if(g.type!==a.PU.time){if(b.length>1)break;b.push(d(g,h))}return b.length===1?b[0]:u===void 0&&h.fields.length>0?h.fields.filter(g=>g.type!==a.PU.time).map(g=>d(g,h)).join(", "):h.refId?`Series (${h.refId})`:`Series (${u})`}function i(h){h.forEach(u=>{u.fields.forEach(b=>{d(b,u,h)})})}function f(h,u){h.forEach(b=>{b.fields.forEach(g=>{const P={legend:!1,tooltip:!1,viz:!1,...u.defaults.custom?.hideFrom},c=g.config.custom?.hideFrom;u.overrides.forEach(y=>{if("__systemRef"in y)return;if((0,n.NS)(y.matcher)(g,b,h))for(const v of y.properties)v.id==="custom.hideFrom"&&Object.assign(P,v.value)}),g.state={...g.state,hideFrom:{...c}},g.config.custom.hideFrom=P})})}function d(h,u,b){const g=h.state?.displayName,P=!!(b&&b.length>1);if(g&&P===h.state?.multipleFrames)return g;const c=l(h,u,b);return h.state=h.state||{},h.state.displayName=c,h.state.multipleFrames=P,c}function l(h,u,b){const g=h.config?.displayName&&h.config?.displayName.length,P=!!u?.meta?.timeCompare?.isTimeShiftQuery;let c=g?h.config.displayName:h.name;if(g)return P?`${c} (comparison)`:c;if(u&&h.config?.displayNameFromDS)return P?`${h.config.displayNameFromDS} (comparison)`:h.config.displayNameFromDS;if(h.type===a.PU.time&&!h.labels)return c??a.LE;let y=[],p=!1;if(b&&b.length>1){for(let E=1;E<b.length;E++)if(b[E].name!==b[E-1].name){p=!0;break}}let v=!1,D=!1;if(p&&u?.name&&(y.push(u.name),v=!0),h.name&&h.name!==a.Bc&&y.push(h.name),h.labels&&u){let E=s(b??[u]);if(E)h.labels[E]&&(y.push(h.labels[E]),D=!0);else{let S=(0,o.h6)(h.labels);S&&(y.push(S),D=!0)}}return u&&!v&&!D&&h.name===a.Bc&&u.name&&u.name.length>0&&(y.push(u.name),v=!0),y.length?c=y.join(" "):h.name?c=h.name:c=a.Bc,c===h.name&&(c=m(h,u)),P&&(c=`${c} (comparison)`),c}function m(h,u){let b=0,g=!1;if(u)for(let P=0;P<u.fields.length;P++){const c=u.fields[P];if(h===c){if(g=!0,b>0){b++;break}}else if(h.name===c.name&&(b++,g))break}return b?`${h.name} ${b}`:h.name}function s(h){let u=null;for(let b=0;b<h.length;b++){const g=h[b];for(const P of g.fields)if(P.labels){for(const c in P.labels)if(u===null)u=c;else if(c!==u)return null}}return u}},92461:(Q,I,e)=>{"use strict";e.d(I,{F:()=>i});var n=e(2543),a=e.n(n),o=e(83195),r=e(57875);function i(f){return new Proxy({},{get:(d,l)=>{let m=f.frame.fields.find(b=>l===b.name);if(!m){const b=(0,n.toNumber)(l);m=f.frame.fields[b]}if(m||(m=f.frame.fields.find(b=>l===b.config.displayName)),m||(m=f.frame.fields.find(b=>b.labels?l===b.labels.name:!1)),!m)return;const s=m.display??(0,r.J)(),h=m.values[f.rowIndex],u=s(h);return u.toString=()=>(0,o.cN)(u),u}})}},63877:(Q,I,e)=>{"use strict";e.d(I,{AM:()=>r.AM,AP:()=>h.AP,BF:()=>l.BF,Ch:()=>r.Ch,Ct:()=>s.Ct,DJ:()=>o.D,FM:()=>r.FM,FU:()=>m.F,Fm:()=>s.Fm,Gs:()=>o.G,HB:()=>a.H,Hs:()=>i.Hs,JO:()=>a.J,K3:()=>l.K3,Kr:()=>f.K,N7:()=>r.N7,OU:()=>r.OU,PI:()=>n.PI,Pm:()=>n.Pm,Qi:()=>i.Qi,RU:()=>d.RU,Ri:()=>s.Ri,X4:()=>r.X4,XS:()=>n.XS,Zo:()=>n.Zo,a_:()=>n.a_,eG:()=>n.eG,fk:()=>s.fk,hL:()=>r.hL,hS:()=>r.hS,jc:()=>h.jc,k3:()=>n.k3,k_:()=>n.k_,lG:()=>r.lG,lz:()=>i.lz,m0:()=>r.m0,nF:()=>n.nF,py:()=>n.py,rJ:()=>l.rJ,uf:()=>i.uf,we:()=>l.we,xT:()=>r.xT,xg:()=>h.xg,yQ:()=>d.yQ});var n=e(56323),a=e(57875),o=e(69550),r=e(27310),i=e(8066),f=e(66670),d=e(47737),l=e(90708),m=e(92461),s=e(28240),h=e(58563)},27310:(Q,I,e)=>{"use strict";e.d(I,{AM:()=>o,Ch:()=>r,FM:()=>s,N7:()=>l,OU:()=>d,X4:()=>h,hL:()=>f,hS:()=>n,lG:()=>m,m0:()=>a,xT:()=>i});const n=u=>u,a=(u,b,g)=>{if(u!=null)return parseFloat(u)},o=(u,b,g)=>(delete b.field?.state?.displayName,d(u,b,g)),r=(u,b,g)=>u,i=(u,b,g)=>u,f=(u,b,g)=>u,d=(u,b,g)=>u==null?u:g&&g.expandTemplateVars&&b.replaceVariables&&typeof u=="string"?b.replaceVariables(u,b.field.state.scopedVars):`${u}`,l=(u,b,g)=>u,m=(u,b,g)=>u,s=(u,b,g)=>u;var h=(u=>(u.IncludeAll="all",u.ExcludeBaseNames="exclude",u.OnlyBaseNames="only",u))(h||{})},58563:(Q,I,e)=>{"use strict";e.d(I,{AP:()=>m,jc:()=>d,xg:()=>s});var n=e(2543),a=e.n(n),o=e(75059),r=e(11261),i=e(8066),f=e(47737);function d(h,u){if(h.type===r.PU.boolean)return l(h,u);const g=(0,i.Qi)(h).getCalculator(h,u),P=h.state?.range??m(h);return c=>{let y=0;c!==-1/0&&(y=(c-P.min)/P.delta,Number.isNaN(y)&&(y=0));const p=(0,f.k5)(h,c,y);return{percent:y,threshold:p,color:g(c,y,p)}}}function l(h,u){const b={color:u.visualization.getColorByName("green"),percent:1,threshold:void 0},g={color:u.visualization.getColorByName("red"),percent:0,threshold:void 0},P=(0,i.Qi)(h);if(P.isContinuous&&P.getColors){const c=P.getColors(u);b.color=c[c.length-1],g.color=c[0]}return c=>c?b:g}function m(h){if(h.type!==r.PU.number)return{min:0,max:100,delta:100};let u=h.config.min,b=h.config.max;if(!(0,n.isNumber)(u)||!(0,n.isNumber)(b))if(h.values&&h.values.length){const g=(0,o.Nw)({field:h,reducers:[o.gy.min,o.gy.max]});(0,n.isNumber)(u)||(u=g[o.gy.min]),(0,n.isNumber)(b)||(b=g[o.gy.max])}else u=0,b=100;return{min:u,max:b,delta:b-u}}function s(h,u){const{config:b}=h;let{min:g,max:P}=b;return(0,n.isNumber)(g)&&(0,n.isNumber)(P)?b:u||!h.state?.range?{...b,...m(h)}:{...b,...h.state.range}}},69550:(Q,I,e)=>{"use strict";e.d(I,{D:()=>r,G:()=>o});var n=e(83077),a=e(66670);const o=new a.K,r=new n.O},47737:(Q,I,e)=>{"use strict";e.d(I,{QS:()=>o,RU:()=>f,k5:()=>i,yQ:()=>r});var n=e(24293),a=e(50082);const o={value:0,color:n.F};function r(d,l){if(!l||l.length===0)return o;let m=l[0];for(const s of l)if(d>=s.value)m=s;else break;return m}function i(d,l,m){const{thresholds:s}=d.config;return s?.mode===a.O.Percentage?r(m*100,s?.steps):r(l,s?.steps)}function f(d){return d.sort((l,m)=>l.value-m.value)}},10361:(Q,I,e)=>{"use strict";e.d(I,{a:()=>n.aG});var n=e(52622)},39954:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{AnnotationChangeEvent:()=>s.We,ArrayDataFrame:()=>r.fG,ArrayVector:()=>x.L,BinaryOperationID:()=>n.kP,BusEventBase:()=>s.aV,BusEventWithPayload:()=>s.x$,ByNamesMatcherMode:()=>i.PP,CSVHeaderStyle:()=>n.F7,CSVReader:()=>n.i8,CircularDataFrame:()=>C.x,CircularVector:()=>M.$,DEFAULT_FIELD_DISPLAY_VALUES_LIMIT:()=>m.Pm,DashboardLoadedEvent:()=>s.gc,DataFrameView:()=>r.Rh,DataHoverClearEvent:()=>s.ql,DataHoverEvent:()=>s.b_,DataLinkBuiltInVars:()=>n.cI,DataSelectEvent:()=>s.LO,DataSourcePluginContextProvider:()=>D.p,DataSourceTestFailed:()=>s.LL,DataSourceTestSucceeded:()=>s.NI,DataSourceUpdatedSuccessfully:()=>s.wE,DataTransformerID:()=>i.Fy,DocsId:()=>n.fu,EventBusSrv:()=>s.or,FieldCache:()=>r.Lc,FieldConfigEditorBuilder:()=>n.bk,FieldConfigOptionsRegistry:()=>m.Kr,FieldMatcherID:()=>i.Ct,FieldNamePickerBaseNameMode:()=>m.X4,FrameGeometrySourceMode:()=>b.a,FrameMatcherID:()=>i.jR,ISO_8601:()=>f.mt,InternalTimeZones:()=>f.g$,LayoutModes:()=>P.R,LegacyMappingType:()=>n.An,MISSING_VALUE:()=>r.pk,MatcherID:()=>i.cV,MutableDataFrame:()=>r.k2,NodeGraphDataFrameFieldNames:()=>n.uc,PanelOptionsEditorBuilder:()=>n.pv,PanelPlugin:()=>c.m,PluginContextProvider:()=>v.a,ReducerID:()=>i.gy,Registry:()=>n.OR,SetPanelAttentionEvent:()=>s.Tp,StreamingDataFrame:()=>r.k9,StreamingFrameAction:()=>r.Kh,SystemDateFormatsState:()=>f.JE,ThemeContext:()=>h.Dx,TransformerCategory:()=>i.m_,UnaryOperationID:()=>n._G,VAR_CALC:()=>m.k_,VAR_CELL_PREFIX:()=>m.a_,VAR_FIELD_LABELS:()=>m.nF,VAR_FIELD_NAME:()=>m.py,VAR_SERIES_NAME:()=>m.k3,ValueMatcherID:()=>i.Js,addDurationToDate:()=>f.Ri,addRow:()=>r.uY,anySeriesWithTimeField:()=>r.tP,anyToNumber:()=>n.to,applyFieldOverrides:()=>m.we,applyNullInsertThreshold:()=>i.MS,applyRawFieldOverrides:()=>m.K3,arrayToDataFrame:()=>r.Ij,arrayUtils:()=>n.XC,binaryOperators:()=>n.bP,booleanOverrideProcessor:()=>m.FM,booleanValueFormatter:()=>l.Qc,buildHistogram:()=>i.p3,cacheFieldDisplayNames:()=>m.Fm,classicColors:()=>n.tj,closestIdx:()=>r.Ls,colorManipulator:()=>h.MV,compareArrayValues:()=>r.J3,compareDataFrameStructures:()=>r.bW,containsSearchFilter:()=>n.Eg,convertOldAngularValueMappings:()=>n.bh,createDataFrame:()=>r.EI,createDimension:()=>r.r4,createFieldConfigRegistry:()=>p.O,createTheme:()=>h.an,dataFrameFromJSON:()=>r.or,dataFrameToJSON:()=>r.Nw,dataLinksOverrideProcessor:()=>m.Ch,dateMath:()=>f.ns,dateTime:()=>f.KQ,dateTimeAsMoment:()=>f.AN,dateTimeForTimeZone:()=>f.oZ,dateTimeFormat:()=>f.LE,dateTimeFormatISO:()=>f.M7,dateTimeFormatTimeAgo:()=>f.fq,dateTimeFormatWithAbbrevation:()=>f._Q,dateTimeParse:()=>f.bQ,decodeFieldValueEntities:()=>r.t,decodeFieldValueEnums:()=>r.EL,defaultCalcs:()=>i.C6,deprecationWarning:()=>n.lt,displayNameOverrideProcessor:()=>m.AM,doStandardCalcs:()=>i.H3,durationToMilliseconds:()=>f.WT,ensureTimeField:()=>i.ks,escapeRegex:()=>d.$f,escapeStringForRegex:()=>d.jD,eventFactory:()=>s.Rb,fieldColorModeRegistry:()=>m.uf,fieldMatchers:()=>i.sJ,fieldReducers:()=>i.AS,filterFieldConfigOverrides:()=>y.aW,findCommonLabels:()=>n.yO,findHighlightChunksInText:()=>d.Oq,findMatchesInText:()=>d.bs,findUniqueLabels:()=>n.s6,fixCellTemplateExpressions:()=>m.Zo,formatLabels:()=>n.h6,formattedValueToString:()=>l.cN,frameMatchers:()=>i.RE,getActiveThreshold:()=>m.yQ,getAllValuesFromDimension:()=>r.Km,getBuiltInThemes:()=>h.k7,getColumnFromDimension:()=>r.P4,getColumnsFromDimension:()=>r.g6,getDataFrameRow:()=>r.Yn,getDataSourceRef:()=>n.p$,getDataSourceUID:()=>n.Iz,getDimensionByName:()=>r.xB,getDisplayProcessor:()=>m.JO,getDisplayValueAlignmentFactors:()=>m.XS,getFieldColorMode:()=>m.Hs,getFieldColorModeForField:()=>m.Qi,getFieldConfigWithMinMax:()=>m.xg,getFieldDisplayName:()=>m.Ct,getFieldDisplayValues:()=>m.PI,getFieldDisplayValuesProxy:()=>m.FU,getFieldMatcher:()=>i.NS,getFieldSeriesColor:()=>m.lz,getFieldTypeFromValue:()=>r.oE,getFlotPairs:()=>n.RZ,getFlotPairsConstant:()=>n.rG,getFrameDisplayName:()=>m.Ri,getFrameMatchers:()=>i.Dq,getHistogramFields:()=>i.ix,getLinksSupplier:()=>T._M,getLocale:()=>f.JK,getLocaleData:()=>f.XN,getMinMaxAndDelta:()=>m.AP,getNextRefId:()=>g.M,getPanelOptionsWithDefaults:()=>y.F,getProcessedDataFrames:()=>r.Bt,getRawDisplayProcessor:()=>m.HB,getRowUniqueId:()=>r.t9,getScaleCalculator:()=>m.jc,getSearchFilterScopedVar:()=>n.cs,getSeriesTimeStep:()=>n.tY,getThemeById:()=>h.gh,getTimeField:()=>r.KR,getTimeZone:()=>f.O,getTimeZoneGroups:()=>f.U3,getTimeZoneInfo:()=>f.QZ,getTimeZones:()=>f.P3,getUniqueFieldName:()=>m.fk,getValueFormat:()=>l.j_,getValueFormats:()=>l.Ke,getValueFormatterIndex:()=>l.uH,getValueFromDimension:()=>r.WK,getValueMatcher:()=>i.kK,getWeekdayIndex:()=>f.xQ,getWeekdayIndexByEnglishName:()=>f.pp,getZone:()=>f.HD,guessDecimals:()=>n.E6,guessFieldTypeForField:()=>r.dF,guessFieldTypeFromNameAndValue:()=>r.by,guessFieldTypeFromValue:()=>r.HW,guessFieldTypes:()=>r.XQ,hasLinks:()=>m.eG,hasMsResolution:()=>n.dO,hasTimeField:()=>r.S1,histogramBucketSizes:()=>i.rW,histogramFieldInfo:()=>i.Rt,histogramFieldsToFrame:()=>i.cg,histogramFrameBucketMaxFieldName:()=>i.dA,histogramFrameBucketMinFieldName:()=>i.d$,histogramTransformer:()=>i.OA,identityOverrideProcessor:()=>m.hS,incrRound:()=>i.ZU,incrRoundDn:()=>i.rs,incrRoundUp:()=>i.Uh,intervalToAbbreviatedDurationString:()=>f.dU,isBooleanUnit:()=>l.j9,isCustomFieldProp:()=>y.TQ,isDataFrame:()=>r.ci,isDataFrameWithValue:()=>r.LI,isDataSourcePluginContext:()=>S.S,isDataSourceRef:()=>n.fN,isDateTime:()=>f.Ar,isDateTimeInput:()=>f.u8,isEmptyObject:()=>n.RI,isHistogramFrameBucketMaxFieldName:()=>i.H1,isHistogramFrameBucketMinFieldName:()=>i.NX,isLikelyAscendingVector:()=>i.g2,isReducerID:()=>i.Em,isStandardFieldProp:()=>y.nx,isTableData:()=>r.pH,isTimeSeriesField:()=>r.hF,isTimeSeriesFrame:()=>r.aH,isTimeSeriesFrames:()=>r.jq,isValidDate:()=>f.vd,isValidDuration:()=>f.di,isValidGoDuration:()=>f.IM,isValidGrafanaDuration:()=>f.V3,localTimeFormat:()=>f.Od,locale:()=>l.Hg,locationUtil:()=>n.Ig,makeClassES5Compatible:()=>n.Yi,mapInternalLinkToExplore:()=>n.uS,matchAllLabels:()=>n._p,matchPluginId:()=>n._8,monacoLanguageRegistry:()=>u.l,nullToValue:()=>i.CF,numberOverrideProcessor:()=>m.m0,objRemoveUndefined:()=>n.wm,onUpdateDatasourceJsonDataOption:()=>n.PG,onUpdateDatasourceJsonDataOptionChecked:()=>n.EX,onUpdateDatasourceJsonDataOptionSelect:()=>n.BD,onUpdateDatasourceOption:()=>n.zX,onUpdateDatasourceResetOption:()=>n.yV,onUpdateDatasourceSecureJsonDataOption:()=>n.mn,onUpdateDatasourceSecureJsonDataOptionSelect:()=>n.wY,outerJoinDataFrames:()=>i.KP,parseDuration:()=>f.E9,parseFlags:()=>d.bQ,parseLabels:()=>n.Xy,preProcessPanelData:()=>r.N$,rangeUtil:()=>f.Ii,readCSV:()=>n.Jh,reduceField:()=>i.Nw,renderLegendFormat:()=>n.j_,renderMarkdown:()=>d.Gc,renderTextPanelMarkdown:()=>d.Pn,restoreCustomOverrideRules:()=>y.H9,reverseDataFrame:()=>r.q7,roundDecimals:()=>n.hB,scaledUnits:()=>l.yP,selectOverrideProcessor:()=>m.hL,serializeStateToUrlParam:()=>n.Pp,setLocale:()=>f.xS,setTimeZoneResolver:()=>f.GZ,setWeekStart:()=>f.$D,shallowCompare:()=>r.ab,simpleCountUnit:()=>l.UR,sortDataFrame:()=>r.ES,sortThresholds:()=>m.RU,standardEditorsRegistry:()=>m.DJ,standardFieldConfigEditorRegistry:()=>m.Gs,standardTransformers:()=>i.c9,standardTransformersRegistry:()=>i.h9,stringFormater:()=>l.cH,stringOverrideProcessor:()=>m.OU,stringStartsAsRegEx:()=>d.AP,stringToJsRegex:()=>d.dO,stringToMs:()=>d.dc,systemDateFormats:()=>f.WC,textUtil:()=>d.sQ,thresholdsOverrideProcessor:()=>m.N7,timeZoneAbbrevation:()=>f.jw,timeZoneFormatUserFriendly:()=>f.le,toCSV:()=>n._O,toDataFrame:()=>r.Vc,toDataFrameDTO:()=>r.Kl,toDuration:()=>f.Ah,toFilteredDataFrameDTO:()=>r.By,toFixed:()=>l.Mg,toFixedScaled:()=>l.gZ,toFixedUnit:()=>l.G8,toFloatOrUndefined:()=>d.$D,toIntegerOrUndefined:()=>d.vb,toLegacyResponseData:()=>r.w3,toNumberString:()=>d.kT,toOption:()=>n.zL,toPascalCase:()=>d.MX,toURLRange:()=>n.sQ,toUtc:()=>f.yT,transformDataFrame:()=>i.m6,unEscapeStringFromRegex:()=>d.xb,unaryOperators:()=>n.j7,unitOverrideProcessor:()=>m.lG,updateDatasourcePluginJsonDataOption:()=>n.lO,updateDatasourcePluginOption:()=>n.pN,updateDatasourcePluginResetOption:()=>n.QP,updateDatasourcePluginSecureJsonDataOption:()=>n.wp,urlUtil:()=>n.kM,useFieldOverrides:()=>m.rJ,usePluginContext:()=>E.Q,validateFieldConfig:()=>m.BF,valueMappingsOverrideProcessor:()=>m.xT,valueMatchers:()=>i.hI,vectorator:()=>A.E,withLoadingIndicator:()=>n.kz});var n=e(94032),a=e(64572),o={};for(const O in a)["default","LayoutModes","PanelPlugin","getPanelOptionsWithDefaults","filterFieldConfigOverrides","restoreCustomOverrideRules","isCustomFieldProp","isStandardFieldProp","createFieldConfigRegistry","PluginContextProvider","DataSourcePluginContextProvider","usePluginContext","isDataSourcePluginContext","getLinksSupplier","CircularVector","vectorator","ArrayVector","BinaryOperationID","CSVHeaderStyle","CSVReader","DataLinkBuiltInVars","DocsId","FieldConfigEditorBuilder","LegacyMappingType","NodeGraphDataFrameFieldNames","PanelOptionsEditorBuilder","Registry","UnaryOperationID","anyToNumber","arrayUtils","binaryOperators","classicColors","containsSearchFilter","convertOldAngularValueMappings","deprecationWarning","findCommonLabels","findUniqueLabels","formatLabels","getDataSourceRef","getDataSourceUID","getFlotPairs","getFlotPairsConstant","getSearchFilterScopedVar","getSeriesTimeStep","guessDecimals","hasMsResolution","isDataSourceRef","isEmptyObject","locationUtil","makeClassES5Compatible","mapInternalLinkToExplore","matchAllLabels","matchPluginId","objRemoveUndefined","onUpdateDatasourceJsonDataOption","onUpdateDatasourceJsonDataOptionChecked","onUpdateDatasourceJsonDataOptionSelect","onUpdateDatasourceOption","onUpdateDatasourceResetOption","onUpdateDatasourceSecureJsonDataOption","onUpdateDatasourceSecureJsonDataOptionSelect","parseLabels","readCSV","renderLegendFormat","roundDecimals","serializeStateToUrlParam","toCSV","toOption","toURLRange","unaryOperators","updateDatasourcePluginJsonDataOption","updateDatasourcePluginOption","updateDatasourcePluginResetOption","updateDatasourcePluginSecureJsonDataOption","urlUtil","withLoadingIndicator"].indexOf(O)<0&&(o[O]=()=>a[O]);e.d(I,o);var r=e(48120),i=e(34687),f=e(38698),d=e(40672),l=e(56496),m=e(63877),s=e(56302),h=e(74529),u=e(58612),b=e(10361),g=e(21809),P=e(19484),c=e(65158),y=e(581),p=e(28528),v=e(13834),D=e(76287),E=e(92470),S=e(95187),T=e(90708),M=e(36120),A=e(18008),x=e(79178),C=e(33526)},58612:(Q,I,e)=>{"use strict";e.d(I,{l:()=>n.l});var n=e(96915)},96915:(Q,I,e)=>{"use strict";e.d(I,{l:()=>a});var n=e(83077);const a=new n.O},65158:(Q,I,e)=>{"use strict";e.d(I,{m:()=>l});var n=e(2543),a=e.n(n),o=e(66670),r=e(43429),i=e(95344),f=e(60264),d=e(28528);class l extends r.Ud{constructor(s){super(),this._fieldConfigDefaults={defaults:{},overrides:[]},this._initConfigRegistry=()=>new o.K,this.dataSupport={annotations:!1,alertStates:!1},this.panel=s}get defaults(){let s=this._defaults||{};if(!this._defaults&&this.optionsSupplier){const h=new f.pv;this.optionsSupplier(h,{data:[]});for(const u of h.getItems())u.defaultValue!=null&&(0,n.set)(s,u.path,u.defaultValue)}return s}get fieldConfigDefaults(){const s=this._fieldConfigDefaults.defaults;s.custom={};for(const h of this.fieldConfigRegistry.list())h.defaultValue!==void 0&&(0,n.set)(s,h.id,h.defaultValue);return{defaults:{...s},overrides:this._fieldConfigDefaults.overrides}}setDefaults(s){return(0,i.l)("PanelPlugin","setDefaults","setPanelOptions"),this._defaults=s,this}get fieldConfigRegistry(){return this._fieldConfigRegistry||(this._fieldConfigRegistry=this._initConfigRegistry()),this._fieldConfigRegistry}setEditor(s){return(0,i.l)("PanelPlugin","setEditor","setPanelOptions"),this.editor=s,this}setNoPadding(){return this.noPadding=!0,this}setMigrationHandler(s){return this.onPanelMigration=s,this}setPanelChangeHandler(s){return this.onPanelTypeChanged=s,this}setPanelOptions(s){return this.optionsSupplier=s,this}getPanelOptionsSupplier(){return this.optionsSupplier??(()=>{})}setDataSupport(s){return this.dataSupport={...this.dataSupport,...s},this}useFieldConfig(s={}){return this._initConfigRegistry=()=>(0,d.O)(s,this.meta.name),this}setSuggestionsSupplier(s){return this.suggestionsSupplier=s,this}getSuggestionsSupplier(){return this.suggestionsSupplier}hasPluginId(s){return this.meta.id===s}}},581:(Q,I,e)=>{"use strict";e.d(I,{F:()=>d,H9:()=>b,TQ:()=>g,aW:()=>m,nx:()=>P});var n=e(2543),a=e.n(n),o=e(8066),r=e(24293),i=e(37055),f=e(50082);function d({plugin:c,currentOptions:y,currentFieldConfig:p,isAfterPluginChange:v}){const D=(0,n.mergeWith)({},c.defaults,y||{},(T,M)=>{if((0,n.isArray)(M))return M}),E=l(p,c),S=h(c,E,v);return{options:D,fieldConfig:S}}function l(c,y){const p=y.fieldConfigDefaults,v={defaults:(0,n.mergeWith)({},p.defaults,c?c.defaults:{},(D,E)=>{if((0,n.isArray)(E))return E}),overrides:c?.overrides??[]};s(v.defaults,"",y.fieldConfigRegistry),v.defaults.thresholds&&u(v.defaults.thresholds),v.overrides=m(v.overrides,D=>y.fieldConfigRegistry.getIfExists(D.id)!==void 0);for(const D of v.overrides)for(const E of D.properties)E.id==="thresholds"&&u(E.value);return v}function m(c,y){return c.map(p=>{const v=p.properties.filter(y);return{...p,properties:v}})}function s(c,y,p){let v=!1;for(const[D,E]of Object.entries(c)){const S=`${y}${D}`,T=!!p.getIfExists(S);if(T){v=!0;continue}(0,n.isArray)(E)||!(0,n.isObject)(E)?T||(0,n.unset)(c,D):s(E,`${S}.`,p)||(0,n.unset)(c,D)}return v}function h(c,y,p){if(!p)return y;const v=c.fieldConfigRegistry.getIfExists(i.uo.Color);if(v&&v.settings){const D=v.settings,E=o.uf.getIfExists(y.defaults.color?.mode);if(!D.byValueSupport&&(!E||E.isByValue))return y.defaults.color={mode:r.Y.PaletteClassic},y;if(D.byValueSupport&&D.preferThresholdsMode&&E?.id!==r.Y.Fixed&&(!E||!E.isByValue))return y.defaults.color={mode:r.Y.Thresholds},y;if(D.bySeriesSupport&&E?.isByValue)return y.defaults.color={mode:r.Y.PaletteClassic},y}return y}function u(c){c.mode||(c.mode=f.O.Absolute),c.steps?c.steps.length&&(c.steps[0].value=-1/0):c.steps=[]}function b(c,y){const p={defaults:{...c.defaults,custom:y.defaults.custom},overrides:[...c.overrides]};for(const v of y.overrides)for(const D of v.properties)if(g(D)){const E=p.overrides.find(S=>(0,n.isEqual)(S.matcher,v.matcher));E?E!==v&&E.properties.push(D):p.overrides.push(v)}return p}function g(c){return c.id.startsWith("custom.")}function P(c){return!g(c)}},28528:(Q,I,e)=>{"use strict";e.d(I,{O:()=>r});var n=e(66670),a=e(69550),o=e(60264);function r(f={},d){const l=new n.K,m=a.G.list(),s={};if(f.useCustomConfig){const h=new o.bk;f.useCustomConfig(h);for(const u of h.getRegistry().list())if(u.isCustom=!0,u.id="custom."+u.id,i(u,m)){const b=s[u.category[0]]??[];b.push(u),s[u.category[0]]=b}else l.register(u)}for(let h of m){const u=h.id;if(!(f.disableStandardOptions&&f.disableStandardOptions.indexOf(u)>-1)){if(f.standardOptions){const b=f.standardOptions[u]?.hideFromDefaults,g=f.standardOptions[u]?.defaultValue,P=f.standardOptions[u]?.settings;b&&(h={...h,hideFromDefaults:b}),g&&(h={...h,defaultValue:g}),P&&(h={...h,settings:h.settings?{...h.settings,...P}:P})}if(l.register(h),h.category&&s[h.category[0]])for(let b of s[h.category[0]])l.register(b)}}for(const h of l.list())if(h.path.indexOf("[")>0)throw new Error(`[${d}] Field config paths do not support arrays: ${h.id}`);return l}function i(f,d){return!!d.find(l=>f.category&&l.category&&f.category[0]===l.category[0])}},21809:(Q,I,e)=>{"use strict";e.d(I,{M:()=>n.M});var n=e(77789)},77789:(Q,I,e)=>{"use strict";e.d(I,{M:()=>n});const n=o=>{for(let r=0;;r++){const i=a(r);if(!o.some(f=>f.refId===i))return i}};function a(o){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return o<r.length?r[o]:a(Math.floor(o/r.length)-1)+r[o%r.length]}},40672:(Q,I,e)=>{"use strict";e.d(I,{$D:()=>n.$D,$f:()=>n.$f,AP:()=>n.AP,Gc:()=>a.G,MX:()=>n.MX,Oq:()=>o.Oq,Pn:()=>a.P,bQ:()=>o.bQ,bs:()=>o.bs,dO:()=>n.dO,dc:()=>n.dc,jD:()=>n.jD,kT:()=>n.kT,sQ:()=>i,vb:()=>n.vb,xb:()=>n.xb});var n=e(54479),a=e(36663),o=e(21),r=e(80997);const i={escapeHtml:r.ZD,hasAnsiCodes:r.kE,sanitize:r.aj,sanitizeTextPanelContent:r.G$,sanitizeUrl:r.Jf,sanitizeSVGContent:r.rX,sanitizeTrustedTypes:r.oI,sanitizeTrustedTypesRSS:r.kc}},36663:(Q,I,e)=>{"use strict";e.d(I,{G:()=>f,P:()=>d});var n=e(60023),a=e(33836),o=e(80997);let r=!1;const i={pedantic:!1,gfm:!0,breaks:!1};function f(l,m){r||(n.xI.use((0,a.z)()),n.xI.setOptions({...i}),r=!0);let s;m?.breaks&&(s={...i,breaks:!0});const h=(0,n.xI)(l||"",s);if(typeof h!="string")throw new Error("Failed to process markdown synchronously.");return m?.noSanitize?h:(0,o.G$)(h)}function d(l,m){r||(n.xI.use((0,a.z)()),n.xI.setOptions({...i}),r=!0);const s=(0,n.xI)(l||"");if(typeof s!="string")throw new Error("Failed to process markdown synchronously.");return m?.noSanitize?s:(0,o.G$)(s)}},80997:(Q,I,e)=>{"use strict";e.d(I,{G$:()=>h,Jf:()=>b,ZD:()=>P,aj:()=>l,kE:()=>g,kc:()=>m,oI:()=>s,rX:()=>u});var n=e(16750),a=e(42838),o=e.n(a),r=e(34005),i=e.n(r);const f=Object.keys(r.whiteList).reduce((c,y)=>(c[y]=r.whiteList[y]?.concat(["class","style"]),c),{}),d=new r.FilterXSS({whiteList:f,css:{whiteList:{...r.getDefaultCSSWhiteList(),"flex-direction":!0,"flex-wrap":!0,"flex-basis":!0,"flex-grow":!0,"flex-shrink":!0,"flex-flow":!0,gap:!0,order:!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"align-items":!0,"align-content":!0,"align-self":!0}}});function l(c){try{return o().sanitize(c,{USE_PROFILES:{html:!0},FORBID_TAGS:["form","input"]})}catch{return console.error("String could not be sanitized",c),P(c)}}function m(c){return o().sanitize(c,{RETURN_TRUSTED_TYPE:!0,ADD_ATTR:["xmlns:atom","version","property","content"],ADD_TAGS:["rss","meta","channel","title","link","description","atom:link","item","pubDate","guid"],PARSER_MEDIA_TYPE:"application/xhtml+xml"})}function s(c){return o().sanitize(c,{RETURN_TRUSTED_TYPE:!0})}function h(c){try{return d.process(c)}catch{return console.error("String could not be sanitized",c),"Text string could not be sanitized"}}function u(c){return o().sanitize(c,{USE_PROFILES:{svg:!0,svgFilters:!0}})}function b(c){return(0,n.J)(c)}function g(c){return/\u001b\[\d{1,2}m/.test(c)}function P(c){return String(c).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")}},54479:(Q,I,e)=>{"use strict";e.d(I,{$D:()=>g,$f:()=>c,AP:()=>m,MX:()=>P,dO:()=>s,dc:()=>h,jD:()=>d,kT:()=>u,vb:()=>b,xb:()=>l});var n=e(2543),a=e.n(n);const r="([\\"+["(","[","{","}","]",")","\\","|","*","+","-",".","?","<",">","#","&","^","$"].join("\\")+"])",i=new RegExp(r,"g"),f=new RegExp("(\\\\)"+r,"g");function d(y){return y&&y.replace(i,"\\$1")}function l(y){return y&&y.replace(f,"$2")}function m(y){return y?y[0]==="/":!1}function s(y){if(!m(y))return new RegExp(`^${y}$`);const p=y.match(new RegExp("^/(.*?)/(g?i?m?y?s?)$"));if(!p)throw new Error(`'${y}' is not a valid regular expression.`);return new RegExp(p[1],p[2])}function h(y){if(!y)return 0;const p=parseInt(y,10),v=y.slice(String(p).length),D=1e3,E=D*60,S=E*60,T=S*24;switch(v){case"s":return p*D;case"m":return p*E;case"h":return p*S;case"d":return p*T;default:if(!v)return isNaN(p)?0:p;throw new Error("Not supported unit: "+v)}}function u(y){return y!=null&&Number.isFinite(y)?y.toString():""}function b(y){if(!y)return;const p=parseInt(y,10);return isNaN(p)?void 0:p}function g(y){if(!y)return;const p=parseFloat(y);return isNaN(p)?void 0:p}function P(y){const p=(0,n.camelCase)(y);return p.charAt(0).toUpperCase()+p.substring(1)}function c(y){return y.replace(/[\\^$*+?.()|[\]{}\/]/g,"\\$&")}},21:(Q,I,e)=>{"use strict";e.d(I,{Oq:()=>n,bQ:()=>f,bs:()=>o});function n({searchWords:d,textToHighlight:l}){const m=[];for(const s of d)typeof s=="string"&&m.push(...o(l,s));return m}const a=d=>d.replace(/[[{(][\w,.\/:;<=>?:*+]+$/,"");function o(d,l){if(!d||!l)return[];const m=[],{cleaned:s,flags:h}=f(a(l));let u;try{u=new RegExp(`(?:${s})`,h)}catch{return m}return d.replace(u,(b,...g)=>{if(b){const P=g[g.length-2];m.push({text:b,start:P,length:b.length,end:P+b.length})}return""}),m}const r="-",i=/\(\?([ims-]+)\)/g;function f(d){const l=new Set(["g"]);return{cleaned:d.replace(i,(s,h)=>{const u=h.startsWith(r);for(let b=0;b<h.length;++b){const g=h.charAt(b);u||h.charAt(b-1)===r?l.delete(g):g!==r&&l.add(g)}return""}),flags:Array.from(l).join("")}}},23596:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{alpha:()=>g,asHexString:()=>f,asRgbString:()=>d,darken:()=>P,decomposeColor:()=>m,emphasize:()=>b,getContrastRatio:()=>h,getLuminance:()=>u,hexToRgb:()=>o,hslToRgb:()=>l,lighten:()=>c,recomposeColor:()=>s,rgbToHex:()=>i});var n=e(84140);function a(y,p=0,v=1){return Math.min(Math.max(p,y),v)}function o(y){y=y.slice(1);const p=new RegExp(`.{1,${y.length>=6?2:1}}`,"g");let v=y.match(p);if(!v)return"";let D=Array.from(v);return D[0].length===1&&(D=D.map(E=>E+E)),D?`rgb${D.length===4?"a":""}(${D.map((E,S)=>S<3?parseInt(E,16):Math.round(parseInt(E,16)/255*1e3)/1e3).join(", ")})`:""}function r(y){const p=y.toString(16);return p.length===1?`0${p}`:p}function i(y){if(y.indexOf("#")===0)return y;const{values:p}=m(y);return`#${p.map(v=>r(v)).join("")}`}function f(y){if(y[0]==="#")return y;const p=(0,n.A)(y);return p.getAlpha()===1?p.toHexString():p.toHex8String()}function d(y){return y.startsWith("rgb")?y:(0,n.A)(y).toRgbString()}function l(y){const p=m(y),{values:v}=p,D=v[0],E=v[1]/100,S=v[2]/100,T=E*Math.min(S,1-S),M=(C,O=(C+D/30)%12)=>S-T*Math.max(Math.min(O-3,9-O,1),-1);let A="rgb";const x=[Math.round(M(0)*255),Math.round(M(8)*255),Math.round(M(4)*255)];return p.type==="hsla"&&(A+="a",x.push(v[3])),s({type:A,values:x})}function m(y){if(typeof y!="string")return y;if(y.charAt(0)==="#")return m(o(y));const p=y.indexOf("("),v=y.substring(0,p);if(["rgb","rgba","hsl","hsla","color"].indexOf(v)===-1)throw new Error(`Unsupported '${y}' color. The following formats are supported: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color()`);let D=y.substring(p+1,y.length-1),E;if(v==="color"){if(D=D.split(" "),E=D.shift(),D.length===4&&D[3].charAt(0)==="/"&&(D[3]=D[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(E)===-1)throw new Error(`Unsupported ${E} color space. The following color spaces are supported: srgb, display-p3, a98-rgb, prophoto-rgb, rec-2020.`)}else D=D.split(",");return D=D.map(S=>parseFloat(S)),{type:v,values:D,colorSpace:E}}function s(y){const{type:p,colorSpace:v}=y;let D=y.values;return p.indexOf("rgb")!==-1?D=D.map((E,S)=>S<3?parseInt(E,10):E):p.indexOf("hsl")!==-1&&(D[1]=`${D[1]}%`,D[2]=`${D[2]}%`),p.indexOf("color")!==-1?D=`${v} ${D.join(" ")}`:D=`${D.join(", ")}`,`${p}(${D})`}function h(y,p,v){const D=u(y),E=u(p,v);return(Math.max(D,E)+.05)/(Math.min(D,E)+.05)}function u(y,p){const v=m(y);let D=v.type==="hsl"?m(l(y)).values:v.values;if(p&&v.type==="rgba"){const S=m(p),T=D[3];D[0]=D[0]*T+S.values[0]*(1-T),D[1]=D[1]*T+S.values[1]*(1-T),D[2]=D[2]*T+S.values[2]*(1-T)}const E=D.map(S=>(v.type!=="color"&&(S/=255),S<=.03928?S/12.92:((S+.055)/1.055)**2.4));return Number((.2126*E[0]+.7152*E[1]+.0722*E[2]).toFixed(3))}function b(y,p=.15){return u(y)>.5?P(y,p):c(y,p)}function g(y,p){if(y==="")return"#000000";if(p=a(p),y[0]==="#"){if(y.length===9)y=y.substring(0,7);else if(y.length<=5){let D="#";for(let E=1;E<4;E++)D+=y[E]+y[E];y=D}return y+Math.round(p*255).toString(16).padStart(2,"0")}else{if(y[3]==="(")return y.replace(")",`, ${p})`);if(y[4]==="(")return y.substring(0,y.lastIndexOf(","))+`, ${p})`}const v=m(y);return v.type==="color"?v.values[3]=`/${p}`:v.values[3]=p,s(v)}function P(y,p){const v=m(y);if(p=a(p),v.type.indexOf("hsl")!==-1)v.values[2]*=1-p;else if(v.type.indexOf("rgb")!==-1||v.type.indexOf("color")!==-1)for(let D=0;D<3;D+=1)v.values[D]*=1-p;return s(v)}function c(y,p){const v=m(y);if(p=a(p),v.type.indexOf("hsl")!==-1)v.values[2]+=(100-v.values[2])*p;else if(v.type.indexOf("rgb")!==-1)for(let D=0;D<3;D+=1)v.values[D]+=(255-v.values[D])*p;else if(v.type.indexOf("color")!==-1)for(let D=0;D<3;D+=1)v.values[D]+=(1-v.values[D])*p;return s(v)}},60578:(Q,I,e)=>{"use strict";e.d(I,{D:()=>o});var n=e(96540),a=e(75972);const o=n.createContext((0,a.a)());o.displayName="ThemeContext"},75972:(Q,I,e)=>{"use strict";e.d(I,{a:()=>K});function n(){const w=["xs","sm","md","lg","xl","xxl"],U="px",W={xs:0,sm:544,md:769,lg:992,xl:1200,xxl:1440};function V(H){return`@media (min-width:${typeof H=="number"?H:W[H]}${U})`}function _(H){return`@media (max-width:${(typeof H=="number"?H:W[H])-5/100}${U})`}return{values:W,up:V,down:_,keys:w,unit:U}}var a=e(2543),o=e(23596);const r={white:"#FFFFFF",black:"#000000",gray25:"#2c3235",gray15:"#22252b",gray10:"#181b1f",gray05:"#111217",darkLayer0:"#18181A",darkLayer1:"#212124",darkLayer2:"#2a2a2f",darkBorder1:"#34343B",darkBorder2:"#64646B",gray90:"#F4F5F5",gray100:"#F4F5F5",gray80:"#D0D1D3",lightBorder1:"#E4E7E7",blueDarkMain:"#3D71D9",blueDarkText:"#6E9FFF",redDarkMain:"#D10E5C",redDarkText:"#FF5286",greenDarkMain:"#1A7F4B",greenDarkText:"#6CCF8E",orangeDarkMain:"#FF9900",orangeDarkText:"#fbad37",blueLightMain:"#3871DC",blueLightText:"#1F62E0",redLightMain:"#E0226E",redLightText:"#CF0E5B",greenLightMain:"#1B855E",greenLightText:"#0A764E",orangeLightMain:"#FF9900",orangeLightText:"#B5510D"};class i{constructor(){this.mode="dark",this.whiteBase="204, 204, 220",this.border={weak:`rgba(${this.whiteBase}, 0.12)`,medium:`rgba(${this.whiteBase}, 0.20)`,strong:`rgba(${this.whiteBase}, 0.30)`},this.text={primary:`rgb(${this.whiteBase})`,secondary:`rgba(${this.whiteBase}, 0.65)`,disabled:`rgba(${this.whiteBase}, 0.6)`,link:r.blueDarkText,maxContrast:r.white},this.primary={main:r.blueDarkMain,text:r.blueDarkText,border:r.blueDarkText},this.secondary={main:`rgba(${this.whiteBase}, 0.10)`,shade:`rgba(${this.whiteBase}, 0.14)`,transparent:`rgba(${this.whiteBase}, 0.08)`,text:this.text.primary,contrastText:`rgb(${this.whiteBase})`,border:`rgba(${this.whiteBase}, 0.08)`},this.info=this.primary,this.error={main:r.redDarkMain,text:r.redDarkText},this.success={main:r.greenDarkMain,text:r.greenDarkText},this.warning={main:r.orangeDarkMain,text:r.orangeDarkText},this.background={canvas:r.gray05,primary:r.gray10,secondary:r.gray15},this.action={hover:`rgba(${this.whiteBase}, 0.16)`,selected:`rgba(${this.whiteBase}, 0.12)`,selectedBorder:r.orangeDarkMain,focus:`rgba(${this.whiteBase}, 0.16)`,hoverOpacity:.08,disabledText:this.text.disabled,disabledBackground:`rgba(${this.whiteBase}, 0.04)`,disabledOpacity:.38},this.gradients={brandHorizontal:"linear-gradient(270deg, #F55F3E 0%, #FF8833 100%)",brandVertical:"linear-gradient(0.01deg, #F55F3E 0.01%, #FF8833 99.99%)"},this.contrastThreshold=3,this.hoverFactor=.03,this.tonalOffset=.15}}class f{constructor(){this.mode="light",this.blackBase="36, 41, 46",this.primary={main:r.blueLightMain,border:r.blueLightText,text:r.blueLightText},this.text={primary:`rgba(${this.blackBase}, 1)`,secondary:`rgba(${this.blackBase}, 0.75)`,disabled:`rgba(${this.blackBase}, 0.64)`,link:this.primary.text,maxContrast:r.black},this.border={weak:`rgba(${this.blackBase}, 0.12)`,medium:`rgba(${this.blackBase}, 0.30)`,strong:`rgba(${this.blackBase}, 0.40)`},this.secondary={main:`rgba(${this.blackBase}, 0.08)`,shade:`rgba(${this.blackBase}, 0.15)`,transparent:`rgba(${this.blackBase}, 0.08)`,contrastText:`rgba(${this.blackBase},  1)`,text:this.text.primary,border:this.border.weak},this.info={main:r.blueLightMain,text:r.blueLightText},this.error={main:r.redLightMain,text:r.redLightText,border:r.redLightText},this.success={main:r.greenLightMain,text:r.greenLightText},this.warning={main:r.orangeLightMain,text:r.orangeLightText},this.background={canvas:r.gray90,primary:r.white,secondary:r.gray100},this.action={hover:`rgba(${this.blackBase}, 0.12)`,selected:`rgba(${this.blackBase}, 0.08)`,selectedBorder:r.orangeLightMain,hoverOpacity:.08,focus:`rgba(${this.blackBase}, 0.12)`,disabledBackground:`rgba(${this.blackBase}, 0.04)`,disabledText:this.text.disabled,disabledOpacity:.38},this.gradients={brandHorizontal:"linear-gradient(90deg, #FF8833 0%, #F53E4C 100%)",brandVertical:"linear-gradient(0.01deg, #F53E4C -31.2%, #FF8833 113.07%)"},this.contrastThreshold=3,this.hoverFactor=.03,this.tonalOffset=.2}}function d(B){const w=new i,U=new f,W=(B.mode??"dark")==="dark"?w:U,{primary:V=W.primary,secondary:_=W.secondary,info:H=W.info,warning:G=W.warning,success:j=W.success,error:Y=W.error,tonalOffset:oe=W.tonalOffset,hoverFactor:se=W.hoverFactor,contrastThreshold:ne=W.contrastThreshold,...ee}=B;function Z(q,ie=ne){return(0,o.getContrastRatio)(w.text.maxContrast,q,W.background.primary)>=ie?w.text.maxContrast:U.text.maxContrast}const z=({color:q,name:ie})=>{if(q={...q,name:ie},!q.main)throw new Error(`Missing main color for ${ie}`);return q.text||(q.text=q.main),q.border||(q.border=q.text),q.shade||(q.shade=W.mode==="light"?(0,o.darken)(q.main,oe):(0,o.lighten)(q.main,oe)),q.transparent||(q.transparent=(0,o.alpha)(q.main,.15)),q.contrastText||(q.contrastText=Z(q.main)),q.borderTransparent||(q.borderTransparent=(0,o.alpha)(q.border,.25)),q};return(0,a.merge)({...W,primary:z({color:V,name:"primary"}),secondary:z({color:_,name:"secondary"}),info:z({color:H,name:"info"}),error:z({color:Y,name:"error"}),success:z({color:j,name:"success"}),warning:z({color:G,name:"warning"}),getContrastText:Z,emphasize:(q,ie)=>(0,o.emphasize)(q,ie??se)},ee)}function l(B,w){const U={padding:1,headerHeight:4,background:B.background.primary,borderColor:B.border.weak,boxShadow:"none"},W={borderColor:B.border.medium,borderHover:B.border.strong,text:B.text.primary,background:B.mode==="dark"?B.background.canvas:B.background.primary};return{height:{sm:3,md:4,lg:6},input:W,panel:U,dropdown:{background:W.background},tooltip:{background:B.background.secondary,text:B.text.primary},dashboard:{background:B.background.canvas,padding:1},overlay:{background:B.mode==="dark"?"rgba(63, 62, 62, 0.45)":"rgba(208, 209, 211, 0.24)"},sidemenu:{width:57},menuTabs:{height:42},textHighlight:{text:B.warning.contrastText,background:B.warning.main},horizontalDrawer:{defaultHeight:400},table:{rowHoverBackground:B.emphasize(B.background.primary,.03)}}}function m(B){return B.mode==="dark"?{z1:"0px 1px 2px rgba(1, 4, 9, 0.75)",z2:"0px 4px 8px rgba(1, 4, 9, 0.75)",z3:"0px 8px 24px rgb(1, 4, 9)"}:{z1:"0px 1px 2px rgba(24, 26, 27, 0.2)",z2:"0px 4px 8px rgba(24, 26, 27, 0.2)",z3:"0px 13px 20px 1px rgba(24, 26, 27, 0.18)"}}function s(B){const w=B.borderRadius??2;return{radius:{default:"2px",pill:"9999px",circle:"100%"},borderRadius:V=>`${(V??1)*w}px`}}function h(B={}){const{gridSize:w=8}=B,U=V=>typeof V=="string"?V:V*w,W=(...V)=>(V.length===0&&(V[0]=1),V.map(_=>{const H=U(_);return typeof H=="number"?`${H}px`:H}).join(" "));return W.gridSize=w,W.x0="0px",W.x0_25="2px",W.x0_5="4px",W.x1="8px",W.x1_5="12px",W.x2="16px",W.x2_5="20px",W.x3="24px",W.x4="32px",W.x5="40px",W.x6="48px",W.x8="64px",W.x10="80px",W}const u={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},b={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function g(B=["all"],w={}){const{duration:U=b.standard,easing:W=u.easeInOut,delay:V=0}=w;return(Array.isArray(B)?B:[B]).map(_=>`${_} ${typeof U=="string"?U:y(U)} ${W} ${typeof V=="string"?V:y(V)}`).join(",")}function P(...B){return B.map(w=>`@media (prefers-reduced-motion: ${w})`).join(",")}function c(B){if(!B)return 0;const w=B/36;return Math.round((4+15*w**.25+w/5)*10)}function y(B){return`${Math.round(B)}ms`}function p(){return{create:g,duration:b,easing:u,getAutoHeightDuration:c,handleMotion:P}}const v='"Inter", "Helvetica", "Arial", sans-serif',D="'Roboto Mono', monospace";function E(B,w={}){const{fontFamily:U=v,fontFamilyMonospace:W=D,fontSize:V=14,fontWeightLight:_=300,fontWeightRegular:H=400,fontWeightMedium:G=500,fontWeightBold:j=500,htmlFontSize:Y=14}=w,oe=V/14,se=z=>`${z/Y*oe}rem`,ne=(z,q,ie,de,ue)=>{if(ie%2!==0||q%2!==0)throw new Error("Font size and line height should be integer multiples of 2 to prevent issues with alignment");return{fontFamily:U,fontWeight:z,fontSize:se(q),lineHeight:ie/q,...U===v?{letterSpacing:`${S(de/q)}em`}:{},...ue}},ee={h1:ne(H,28,32,-.25),h2:ne(H,24,28,0),h3:ne(H,22,24,0),h4:ne(H,18,22,.25),h5:ne(H,16,22,0),h6:ne(G,14,22,.15),body:ne(H,V,22,.15),bodySmall:ne(H,12,18,.15),code:{...ne(H,14,16,.15),fontFamily:W}};return{htmlFontSize:Y,pxToRem:se,fontFamily:U,fontFamilyMonospace:W,fontSize:V,fontWeightLight:_,fontWeightRegular:H,fontWeightMedium:G,fontWeightBold:j,size:{base:"14px",xs:"10px",sm:"12px",md:"14px",lg:"18px"},...ee}}function S(B){return Math.round(B*1e5)/1e5}var T=e(25137);function M(B){const w={name:"Grafana Default",typography:{fontFamily:{sansSerif:B.typography.fontFamily,monospace:B.typography.fontFamilyMonospace},size:{base:`${B.typography.fontSize}px`,xs:B.typography.size.xs,sm:B.typography.size.sm,md:B.typography.size.md,lg:B.typography.size.lg},heading:{h1:B.typography.h1.fontSize,h2:B.typography.h2.fontSize,h3:B.typography.h3.fontSize,h4:B.typography.h4.fontSize,h5:B.typography.h5.fontSize,h6:B.typography.h6.fontSize},weight:{light:B.typography.fontWeightLight,regular:B.typography.fontWeightRegular,semibold:B.typography.fontWeightMedium,bold:B.typography.fontWeightBold},lineHeight:{xs:B.typography.bodySmall.lineHeight,sm:B.typography.bodySmall.lineHeight,md:B.typography.body.lineHeight,lg:B.typography.h2.lineHeight},link:{decoration:"none",hoverDecoration:"none"}},breakpoints:{xs:`${B.breakpoints.values.xs}px`,sm:`${B.breakpoints.values.sm}px`,md:`${B.breakpoints.values.md}px`,lg:`${B.breakpoints.values.lg}px`,xl:`${B.breakpoints.values.xl}px`,xxl:`${B.breakpoints.values.xxl}px`},spacing:{base:B.spacing.gridSize,insetSquishMd:B.spacing(.5,1),d:B.spacing(2),xxs:B.spacing(.25),xs:B.spacing(.5),sm:B.spacing(1),md:B.spacing(2),lg:B.spacing(3),xl:B.spacing(4),gutter:B.spacing(4),formSpacingBase:B.spacing.gridSize,formMargin:`${B.spacing.gridSize*4}px`,formFieldsetMargin:`${B.spacing.gridSize*2}px`,formInputHeight:B.spacing.gridSize*4,formButtonHeight:B.spacing.gridSize*4,formInputPaddingHorizontal:`${B.spacing.gridSize}px`,formInputAffixPaddingHorizontal:`${B.spacing.gridSize/2}px`,formInputMargin:`${B.spacing.gridSize*2}px`,formLabelPadding:"0 0 0 2px",formLabelMargin:`0 0 ${B.spacing.gridSize/2+"px"} 0`,formValidationMessagePadding:"4px 8px",formValidationMessageMargin:"4px 0 0 0",inlineFormMargin:"4px"},border:{radius:{sm:B.shape.borderRadius(1),md:B.shape.borderRadius(2),lg:B.shape.borderRadius(3)},width:{sm:"1px"}},height:{sm:B.spacing.gridSize*B.components.height.sm,md:B.spacing.gridSize*B.components.height.md,lg:B.spacing.gridSize*B.components.height.lg},panelPadding:B.components.panel.padding*B.spacing.gridSize,panelHeaderHeight:B.spacing.gridSize*B.components.panel.headerHeight,zIndex:B.zIndex},U={...A,black:"#000000",white:"#ffffff",dark1:"#141414",dark2:"#161719",dark3:"#1f1f20",dark4:"#212124",dark5:"#222426",dark6:"#262628",dark7:"#292a2d",dark8:"#2f2f32",dark9:"#343436",dark10:"#424345",gray1:"#555555",gray2:"#8e8e8e",gray3:"#b3b3b3",gray4:"#d8d9da",gray5:"#ececec",gray6:"#f4f5f8",gray7:"#fbfbfb",redBase:"#e02f44",redShade:"#c4162a",greenBase:"#299c46",greenShade:"#23843b",red:"#d44a3a",yellow:"#ecbb13",purple:"#9933cc",variable:"#32d1df",orange:"#eb7b18",orangeDark:"#ff780a"},W={bg1:B.colors.background.primary,bg2:B.colors.background.secondary,bg3:B.colors.action.hover,dashboardBg:B.colors.background.canvas,bgBlue1:B.colors.primary.main,bgBlue2:B.colors.primary.shade},V={border1:B.colors.border.weak,border2:B.colors.border.medium,border3:B.colors.border.strong},_={textStrong:B.colors.text.maxContrast,textHeading:B.colors.text.primary,text:B.colors.text.primary,textSemiWeak:B.colors.text.secondary,textWeak:B.colors.text.secondary,textFaint:B.colors.text.disabled,textBlue:B.colors.primary.text},H={formLabel:B.colors.text.primary,formDescription:B.colors.text.secondary,formInputBg:B.components.input.background,formInputBgDisabled:B.colors.action.disabledBackground,formInputBorder:B.components.input.borderColor,formInputBorderHover:B.components.input.borderHover,formInputBorderActive:B.colors.primary.border,formInputBorderInvalid:B.colors.error.border,formInputPlaceholderText:B.colors.text.disabled,formInputText:B.components.input.text,formInputDisabledText:B.colors.action.disabledText,formFocusOutline:B.colors.primary.main,formValidationMessageText:B.colors.error.contrastText,formValidationMessageBg:B.colors.error.main};return{...w,type:B.colors.mode==="dark"?T.I.Dark:T.I.Light,isDark:B.isDark,isLight:B.isLight,name:B.name,palette:{...U,brandPrimary:U.orange,brandSuccess:B.colors.success.main,brandWarning:B.colors.warning.main,brandDanger:B.colors.error.main,queryRed:B.colors.error.text,queryGreen:B.colors.success.text,queryPurple:"#fe85fc",queryOrange:U.orange,online:B.colors.success.main,warn:B.colors.success.main,critical:B.colors.success.main},colors:{...W,...V,...H,..._,bodyBg:B.colors.background.canvas,panelBg:B.components.panel.background,panelBorder:B.components.panel.borderColor,pageHeaderBg:B.colors.background.canvas,pageHeaderBorder:B.colors.background.canvas,dropdownBg:H.formInputBg,dropdownShadow:U.black,dropdownOptionHoverBg:W.bg2,link:B.colors.text.primary,linkDisabled:B.colors.text.disabled,linkHover:B.colors.text.maxContrast,linkExternal:B.colors.text.link},shadows:{listItem:"none"},visualization:B.visualization}}const A={gray98:"#f7f8fa",gray97:"#f1f5f9",gray95:"#e9edf2",gray90:"#dce1e6",gray85:"#c7d0d9",gray70:"#9fa7b3",gray60:"#7b8087",gray33:"#464c54",gray25:"#2c3235",gray15:"#202226",gray10:"#141619",gray05:"#0b0c0e",blue95:"#5794f2",blue85:"#33a2e5",blue80:"#3274d9",blue77:"#1f60c4",red88:"#e02f44"};var x=e(24293);function C(B){const w=B.mode==="light"?R():O(),U={};for(const _ of w)for(const H of _.shades)if(U[H.name]=H.color,H.aliases)for(const G of H.aliases)U[G]=H.color;U.transparent=B.mode==="light"?"rgba(255, 255, 255, 0)":"rgba(0,0,0,0)",U["panel-bg"]=B.background.primary,U.text=B.text.primary;const W=_=>{if(!_)return x.F;const H=U[_];if(H)return H;if(_[0]==="#"||_.indexOf("rgb")>-1)return _;const G=N[_.toLowerCase()];return G?(U[_]=G,G):_},V=L();return{hues:w,palette:V,getColorByName:W}}function O(){return[{name:"red",shades:[{color:"#FFA6B0",name:"super-light-red"},{color:"#FF7383",name:"light-red"},{color:"#F2495C",name:"red",primary:!0},{color:"#E02F44",name:"semi-dark-red"},{color:"#C4162A",name:"dark-red"}]},{name:"orange",shades:[{color:"#FFCB7D",name:"super-light-orange",aliases:[]},{color:"#FFB357",name:"light-orange",aliases:[]},{color:"#FF9830",name:"orange",aliases:[],primary:!0},{color:"#FF780A",name:"semi-dark-orange",aliases:[]},{color:"#FA6400",name:"dark-orange",aliases:[]}]},{name:"yellow",shades:[{color:"#FFF899",name:"super-light-yellow",aliases:[]},{color:"#FFEE52",name:"light-yellow",aliases:[]},{color:"#FADE2A",name:"yellow",aliases:[],primary:!0},{color:"#F2CC0C",name:"semi-dark-yellow",aliases:[]},{color:"#E0B400",name:"dark-yellow",aliases:[]}]},{name:"green",shades:[{color:"#C8F2C2",name:"super-light-green",aliases:[]},{color:"#96D98D",name:"light-green",aliases:[]},{color:"#73BF69",name:"green",aliases:[],primary:!0},{color:"#56A64B",name:"semi-dark-green",aliases:[]},{color:"#37872D",name:"dark-green",aliases:[]}]},{name:"blue",shades:[{color:"#C0D8FF",name:"super-light-blue",aliases:[]},{color:"#8AB8FF",name:"light-blue",aliases:[]},{color:"#5794F2",name:"blue",aliases:[],primary:!0},{color:"#3274D9",name:"semi-dark-blue",aliases:[]},{color:"#1F60C4",name:"dark-blue",aliases:[]}]},{name:"purple",shades:[{color:"#DEB6F2",name:"super-light-purple",aliases:[]},{color:"#CA95E5",name:"light-purple",aliases:[]},{color:"#B877D9",name:"purple",aliases:[],primary:!0},{color:"#A352CC",name:"semi-dark-purple",aliases:[]},{color:"#8F3BB8",name:"dark-purple",aliases:[]}]}]}function R(){return[{name:"red",shades:[{color:"#FF7383",name:"super-light-red"},{color:"#F2495C",name:"light-red"},{color:"#E02F44",name:"red",primary:!0},{color:"#C4162A",name:"semi-dark-red"},{color:"#AD0317",name:"dark-red"}]},{name:"orange",shades:[{color:"#FFB357",name:"super-light-orange",aliases:[]},{color:"#FF9830",name:"light-orange",aliases:[]},{color:"#FF780A",name:"orange",aliases:[],primary:!0},{color:"#FA6400",name:"semi-dark-orange",aliases:[]},{color:"#E55400",name:"dark-orange",aliases:[]}]},{name:"yellow",shades:[{color:"#FFEE52",name:"super-light-yellow",aliases:[]},{color:"#FADE2A",name:"light-yellow",aliases:[]},{color:"#F2CC0C",name:"yellow",aliases:[],primary:!0},{color:"#E0B400",name:"semi-dark-yellow",aliases:[]},{color:"#CC9D00",name:"dark-yellow",aliases:[]}]},{name:"green",shades:[{color:"#96D98D",name:"super-light-green",aliases:[]},{color:"#73BF69",name:"light-green",aliases:[]},{color:"#56A64B",name:"green",aliases:[],primary:!0},{color:"#37872D",name:"semi-dark-green",aliases:[]},{color:"#19730E",name:"dark-green",aliases:[]}]},{name:"blue",shades:[{color:"#8AB8FF",name:"super-light-blue",aliases:[]},{color:"#5794F2",name:"light-blue",aliases:[]},{color:"#3274D9",name:"blue",aliases:[],primary:!0},{color:"#1F60C4",name:"semi-dark-blue",aliases:[]},{color:"#1250B0",name:"dark-blue",aliases:[]}]},{name:"purple",shades:[{color:"#CA95E5",name:"super-light-purple",aliases:[]},{color:"#B877D9",name:"light-purple",aliases:[]},{color:"#A352CC",name:"purple",aliases:[],primary:!0},{color:"#8F3BB8",name:"semi-dark-purple",aliases:[]},{color:"#7C2EA3",name:"dark-purple",aliases:[]}]}]}function L(){return["green","semi-dark-yellow","light-blue","semi-dark-orange","red","blue","purple","#705DA0","dark-green","yellow","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"]}const N={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},F={activePanel:999,navbarFixed:1e3,sidemenu:1020,dropdown:1030,typeahead:1030,tooltip:1040,modalBackdrop:1050,modal:1060,portal:1061};function K(B={}){const{colors:w={},spacing:U={},shape:W={},typography:V={}}=B,_=d(w),H=n(),G=h(U),j=s(W),Y=E(_,V),oe=m(_),se=p(),ne=l(_,oe),ee=C(_),Z={name:_.mode==="dark"?"Dark":"Light",isDark:_.mode==="dark",isLight:_.mode==="light",colors:_,breakpoints:H,spacing:G,shape:j,components:ne,typography:Y,shadows:oe,transitions:se,visualization:ee,zIndex:{...F},flags:{}};return{...Z,v1:M(Z)}}},74529:(Q,I,e)=>{"use strict";e.d(I,{Dx:()=>r.D,MV:()=>o,an:()=>n.a,gh:()=>a.g,k7:()=>a.k});var n=e(75972),a=e(97594),o=e(23596),r=e(60578)},97594:(Q,I,e)=>{"use strict";e.d(I,{g:()=>o,k:()=>r});var n=e(83077),a=e(75972);function o(m){return(i.getIfExists(m)??i.get("dark")).build()}function r(m){return i.list().filter(s=>m?!0:!s.isExtra)}const i=new n.O(()=>[{id:"system",name:"System preference",build:f},{id:"dark",name:"Dark",build:()=>(0,a.a)({colors:{mode:"dark"}})},{id:"light",name:"Light",build:()=>(0,a.a)({colors:{mode:"light"}})},{id:"blue-night",name:"Blue night",build:l,isExtra:!0},{id:"midnight",name:"Midnight",build:d,isExtra:!0}]);function f(){const s=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";return o(s)}function d(){const m="204, 204, 220";return(0,a.a)({name:"Midnight",colors:{mode:"dark",background:{canvas:"#000000",primary:"#000000",secondary:"#181818"},border:{weak:`rgba(${m}, 0.17)`,medium:`rgba(${m}, 0.25)`,strong:`rgba(${m}, 0.35)`}}})}function l(){return(0,a.a)({name:"Blue night",colors:{mode:"dark",background:{canvas:"#15161d",primary:"#15161d",secondary:"#1d1f2e"},border:{weak:"#2e304f",medium:"#2e304f",strong:"#2e304f"}}})}},75059:(Q,I,e)=>{"use strict";e.d(I,{AS:()=>m,C6:()=>h,Em:()=>d,H3:()=>u,Nw:()=>l,gy:()=>f});var n=e(2543),a=e.n(n),o=e(39070),r=e(11261),i=e(83077),f=(E=>(E.sum="sum",E.max="max",E.min="min",E.logmin="logmin",E.mean="mean",E.variance="variance",E.stdDev="stdDev",E.last="last",E.first="first",E.count="count",E.range="range",E.diff="diff",E.diffperc="diffperc",E.delta="delta",E.step="step",E.firstNotNull="firstNotNull",E.lastNotNull="lastNotNull",E.changeCount="changeCount",E.distinctCount="distinctCount",E.allIsZero="allIsZero",E.allIsNull="allIsNull",E.allValues="allValues",E.uniqueValues="uniqueValues",E.p1="p1",E.p2="p2",E.p3="p3",E.p4="p4",E.p5="p5",E.p6="p6",E.p7="p7",E.p8="p8",E.p9="p9",E.p10="p10",E.p11="p11",E.p12="p12",E.p13="p13",E.p14="p14",E.p15="p15",E.p16="p16",E.p17="p17",E.p18="p18",E.p19="p19",E.p20="p20",E.p21="p21",E.p22="p22",E.p23="p23",E.p24="p24",E.p25="p25",E.p26="p26",E.p27="p27",E.p28="p28",E.p29="p29",E.p30="p30",E.p31="p31",E.p32="p32",E.p33="p33",E.p34="p34",E.p35="p35",E.p36="p36",E.p37="p37",E.p38="p38",E.p39="p39",E.p40="p40",E.p41="p41",E.p42="p42",E.p43="p43",E.p44="p44",E.p45="p45",E.p46="p46",E.p47="p47",E.p48="p48",E.p49="p49",E.p50="p50",E.p51="p51",E.p52="p52",E.p53="p53",E.p54="p54",E.p55="p55",E.p56="p56",E.p57="p57",E.p58="p58",E.p59="p59",E.p60="p60",E.p61="p61",E.p62="p62",E.p63="p63",E.p64="p64",E.p65="p65",E.p66="p66",E.p67="p67",E.p68="p68",E.p69="p69",E.p70="p70",E.p71="p71",E.p72="p72",E.p73="p73",E.p74="p74",E.p75="p75",E.p76="p76",E.p77="p77",E.p78="p78",E.p79="p79",E.p80="p80",E.p81="p81",E.p82="p82",E.p83="p83",E.p84="p84",E.p85="p85",E.p86="p86",E.p87="p87",E.p88="p88",E.p89="p89",E.p90="p90",E.p91="p91",E.p92="p92",E.p93="p93",E.p94="p94",E.p95="p95",E.p96="p96",E.p97="p97",E.p98="p98",E.p99="p99",E))(f||{});function d(E){return Object.keys(f).includes(E)}function l(E){const{field:S,reducers:T}=E;if(!S||!T||T.length<1)return{};if(S.state?.calcs){const L=[];for(const N of T)S.state.calcs.hasOwnProperty(N)||L.push(N);if(L.length<1)return{...S.state.calcs}}S.state||(S.state={});const M=m.list(T),A=S.values;if(A&&A.length<1){const L={...S.state.calcs};for(const N of M)L[N.id]=N.emptyInputResult!==null?N.emptyInputResult:null;return S.state.calcs=L}const{nullValueMode:x=o.UW.Ignore}=S.config,C=x===o.UW.Ignore,O=x===o.UW.AsZero;if(M.length===1&&M[0].reduce){const L=M[0].reduce(S,C,O);return S.state.calcs={...S.state.calcs,...L},L}let R=u(S,C,O);for(const L of M)!R.hasOwnProperty(L.id)&&L.reduce&&(R={...R,...L.reduce(S,C,O)});return S.state.calcs={...S.state.calcs,...R},R}const m=new i.O(()=>[{id:"lastNotNull",name:"Last *",description:"Last non-null value (also excludes NaNs)",standard:!0,aliasIds:["current"],reduce:c,preservesUnits:!0},{id:"last",name:"Last",description:"Last value",standard:!0,reduce:P,preservesUnits:!0},{id:"firstNotNull",name:"First *",description:"First non-null value (also excludes NaNs)",standard:!0,reduce:g,preservesUnits:!0},{id:"first",name:"First",description:"First Value",standard:!0,reduce:b,preservesUnits:!0},{id:"min",name:"Min",description:"Minimum Value",standard:!0,preservesUnits:!0},{id:"max",name:"Max",description:"Maximum Value",standard:!0,preservesUnits:!0},{id:"mean",name:"Mean",description:"Average Value",standard:!0,aliasIds:["avg"],preservesUnits:!0},{id:"variance",name:"Variance",description:"Variance of all values in a field",standard:!1,reduce:y,preservesUnits:!0},{id:"stdDev",name:"StdDev",description:"Standard deviation of all values in a field",standard:!1,reduce:y,preservesUnits:!0},{id:"sum",name:"Total",description:"The sum of all values",emptyInputResult:0,standard:!0,aliasIds:["total"],preservesUnits:!0},{id:"count",name:"Count",description:"Number of values in response",emptyInputResult:0,standard:!0,preservesUnits:!1},{id:"range",name:"Range",description:"Difference between minimum and maximum values",standard:!0,preservesUnits:!0},{id:"delta",name:"Delta",description:"Cumulative change in value",standard:!0,preservesUnits:!0},{id:"step",name:"Step",description:"Minimum interval between values",standard:!0,preservesUnits:!0},{id:"diff",name:"Difference",description:"Difference between first and last values",standard:!0,preservesUnits:!0},{id:"logmin",name:"Min (above zero)",description:"Used for log min scale",standard:!0,preservesUnits:!0},{id:"allIsZero",name:"All Zeros",description:"All values are zero",emptyInputResult:!1,standard:!0,preservesUnits:!0},{id:"allIsNull",name:"All Nulls",description:"All values are null",emptyInputResult:!0,standard:!0,preservesUnits:!1},{id:"changeCount",name:"Change Count",description:"Number of times the value changes",standard:!1,reduce:p,preservesUnits:!1},{id:"distinctCount",name:"Distinct Count",description:"Number of distinct values",standard:!1,reduce:v,preservesUnits:!1},{id:"diffperc",name:"Difference percent",description:"Percentage difference between first and last values",standard:!0,preservesUnits:!1},{id:"allValues",name:"All values",description:"Returns an array with all values",standard:!1,reduce:E=>({allValues:[...E.values]}),preservesUnits:!1},{id:"uniqueValues",name:"All unique values",description:"Returns an array with all unique values",standard:!1,reduce:E=>({uniqueValues:[...new Set(E.values)]}),preservesUnits:!1},...s()]),s=(E=[...Array.from({length:99},(S,T)=>T+1)])=>{const S=[],T=M=>M>3&&M<21?"th":M%10===1?"st":M%10===2?"nd":M%10===3?"rd":"th";return E.forEach(M=>{const A=M/100,x=`p${M}`,C=`${M}${T(M)} %`,O=`${M}${T(M)} percentile value`;S.push({id:x,name:C,description:O,standard:!1,reduce:(R,L,N)=>({[x]:D(R,A,L,N)}),preservesUnits:!0})}),S},h={sum:0,max:-Number.MAX_VALUE,min:Number.MAX_VALUE,logmin:Number.MAX_VALUE,mean:null,last:null,first:null,lastNotNull:null,firstNotNull:null,count:0,nonNullCount:0,allIsNull:!0,allIsZero:!0,range:null,diff:null,delta:0,step:Number.MAX_VALUE,diffperc:0,previousDeltaUp:!0};function u(E,S,T){const M={...h},A=E.values;if(!A)return M;const x=E.type===r.PU.number||E.type===r.PU.time;for(let C=0;C<A.length;C++){let O=A[C];if(C===0&&(M.first=O),M.last=O,O==null){if(S)continue;T&&(O=0)}if(M.count++,O!=null&&!Number.isNaN(O)){const R=M.firstNotNull===null;if(R&&(M.firstNotNull=O),x){if(M.sum+=O,M.allIsNull=!1,M.nonNullCount++,!R){const L=O-M.lastNotNull;M.step>L&&(M.step=L),M.lastNotNull>O?(M.previousDeltaUp=!1,C===A.length-1&&(M.delta+=O)):(M.previousDeltaUp?M.delta+=L:M.delta+=O,M.previousDeltaUp=!0)}O>M.max&&(M.max=O),O<M.min&&(M.min=O),O<M.logmin&&O>0&&(M.logmin=O)}O!==0&&(M.allIsZero=!1),M.lastNotNull=O}}return M.max===-Number.MAX_VALUE&&(M.max=null),M.min===Number.MAX_VALUE&&(M.min=null),M.step===Number.MAX_VALUE&&(M.step=null),M.nonNullCount>0&&(M.mean=M.sum/M.nonNullCount),M.allIsNull&&(M.allIsZero=!1),M.max!==null&&M.min!==null&&(M.range=M.max-M.min),(0,n.isNumber)(M.firstNotNull)&&(0,n.isNumber)(M.lastNotNull)&&(M.diff=M.lastNotNull-M.firstNotNull),(0,n.isNumber)(M.firstNotNull)&&(0,n.isNumber)(M.diff)&&(M.diffperc=M.diff/M.firstNotNull),M}function b(E,S,T){return{first:E.values[0]}}function g(E,S,T){const M=E.values;for(let A=0;A<M.length;A++){const x=M[A];if(x!=null&&!Number.isNaN(x))return{firstNotNull:x}}return{firstNotNull:null}}function P(E,S,T){const M=E.values;return{last:M[M.length-1]}}function c(E,S,T){const M=E.values;let A=M.length-1;for(;A>=0;){const x=M[A--];if(x!=null&&!Number.isNaN(x))return{lastNotNull:x}}return{lastNotNull:null}}function y(E,S,T){if(!(E.type===r.PU.number||E.type===r.PU.time))return{variance:0,stdDev:0};let M=0,A=0,x=0;const C=E.values;for(let O=0;O<C.length;O++){const R=C[O];if(R!=null){x++;let L=A;A+=(R-L)/x,M+=(R-L)*(R-A)}}if(x>0){const O=M/x;return{variance:O,stdDev:Math.sqrt(O)}}return{variance:0,stdDev:0}}function p(E,S,T){const M=E.values;let A=0,x=!0,C=null;for(let O=0;O<M.length;O++){let R=M[O];if(R===null){if(S)continue;T&&(R=0)}!x&&C!==R&&A++,x=!1,C=R}return{changeCount:A}}function v(E,S,T){const M=E.values,A=new Set;for(let x=0;x<M.length;x++){let C=M[x];if(C===null){if(S)continue;T&&(C=0)}A.add(C)}return{distinctCount:A.size}}function D(E,S,T,M){let A=E.values;T&&(A=A.filter(O=>O!==null)),M&&(A=A.map(O=>O===null?0:O));const x=A.slice().sort((O,R)=>O-R),C=Math.round((x.length-1)*S);return x[C]}},34687:(Q,I,e)=>{"use strict";e.d(I,{AS:()=>i.AS,C6:()=>i.C6,CF:()=>b.C,Ct:()=>n.Ct,Dq:()=>o.Dq,Em:()=>i.Em,Fy:()=>a.F,H1:()=>s.H1,H3:()=>i.H3,Js:()=>n.Js,KP:()=>m.Fd,MS:()=>u.M,NS:()=>o.NS,NX:()=>s.NX,Nw:()=>i.Nw,OA:()=>s.OA,PP:()=>l.PP,RE:()=>o.RE,Rt:()=>s.Rt,Uh:()=>s.Uh,ZU:()=>s.ZU,c9:()=>r.c,cV:()=>n.cV,cg:()=>s.cg,d$:()=>s.d$,dA:()=>s.dA,g2:()=>m.g2,gy:()=>i.gy,h9:()=>d.h,hI:()=>o.hI,ix:()=>s.ix,jR:()=>n.jR,kK:()=>o.kK,ks:()=>h.ks,m6:()=>f.m,m_:()=>d.m,p3:()=>s.p3,rW:()=>s.rW,rs:()=>s.rs,sJ:()=>o.sJ});var n=e(1173),a=e(18282),o=e(85200),r=e(57934),i=e(75059),f=e(2514),d=e(97497),l=e(58972),m=e(73060),s=e(77678),h=e(50311),u=e(46294),b=e(39624)},85200:(Q,I,e)=>{"use strict";e.d(I,{Dq:()=>p,NS:()=>y,RE:()=>P,hI:()=>c,kK:()=>v,sJ:()=>g});var n=e(83077),a=e(7029),o=e(24814),r=e(58972),i=e(72693),f=e(8549),d=e(83855),l=e(60005),m=e(21262),s=e(70218),h=e(55008),u=e(16378),b=e(75754);const g=new n.O(()=>[...(0,i.nz)(),...(0,a._)(),...(0,r.P7)(),...(0,d.W)(),o.u]),P=new n.O(()=>[...(0,i.UM)(),...(0,r.Y7)(),...(0,f.i)()]),c=new n.O(()=>[...(0,m._)(),...(0,s.E)(),...(0,l.d)(),...(0,b.m)(),...(0,h.G)(),...(0,u.z)()]);function y(D){const E=g.get(D.id);if(!E)throw new Error("Unknown field matcher: "+D.id);return E.get(D.options)}function p(D){const E=P.get(D.id);if(!E)throw new Error("Unknown frame matcher: "+D.id);return E.get(D.options)}function v(D){const E=c.get(D.id);if(!E)throw new Error("Unknown value matcher: "+D.id);return E.get(D.options)}},58972:(Q,I,e)=>{"use strict";e.d(I,{P7:()=>g,PP:()=>i,Y7:()=>P});var n=e(28240),a=e(54479),o=e(11261),r=e(1173),i=(c=>(c.exclude="exclude",c.include="include",c))(i||{});const f={id:r.Ct.byName,name:"Field Name",description:"match the field name",defaultOptions:"",get:c=>{const p=l(new Set([c]));return(v,D,E)=>c===v.name||c===(0,n.Ct)(v,D,E)||!!(p&&p(v,D,E))},getOptionsDisplayText:c=>`Field name: ${c}`},d={id:r.Ct.byNames,name:"Field Names",description:"match any of the given the field names",defaultOptions:{mode:"include",names:[]},get:c=>{const{names:y,mode:p="include"}=c,v=new Set(y??[]),D=l(v),E=(S,T,M)=>v.has(S.name)||v.has((0,n.Ct)(S,T,M))||!!(D&&D(S,T,M));return p==="exclude"?(S,T,M)=>!E(S,T,M):E},getOptionsDisplayText:c=>{const{names:y,mode:p}=c,v=(y??[]).join(", ");return p==="exclude"?`All except: ${v}`:`All of: ${v}`}};function l(c){let y;return window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback&&(c.has(o.Bc)?y=(v,D)=>!!v.labels&&v.labels?.__name__===v.name:(c.has("Time")||c.has("time"))&&(y=(v,D)=>D.meta?.typeVersion==null&&v.type===o.PU.time)),y}const m={id:r.Ct.byRegexp,name:"Field Name by Regexp",description:"match the field name by a given regexp pattern",defaultOptions:"/.*/",get:c=>{const y=u(c);return(p,v,D)=>{const E=(0,n.Ct)(p,v,D);return!!y&&y.test(E)}},getOptionsDisplayText:c=>`Field name by pattern: ${c}`},s={id:r.Ct.byFrameRefID,name:"Fields by frame refId",description:"match all fields returned in data frame with refId.",defaultOptions:"",get:c=>(y,p,v)=>p.refId===c,getOptionsDisplayText:c=>`Math all fields returned by query with reference ID: ${c}`},h={id:r.Ct.byRegexpOrNames,name:"Field Name by Regexp or Names",description:"match the field name by a given regexp pattern or given names",defaultOptions:{pattern:"/.*/",names:[]},get:c=>{const y=m.get(c?.pattern||""),p=d.get({mode:"include",names:c?.names??[]});return(v,D,E)=>p(v,D,E)||y(v,D,E)},getOptionsDisplayText:c=>{const y=c?.pattern??"",p=c?.names?.join(",")??"";return`Field name by pattern: ${y} or names: ${p}`}},u=c=>{if(c)try{return(0,a.dO)(c)}catch(y){console.error(y);return}},b={id:r.jR.byName,name:"Frame Name",description:"match the frame name",defaultOptions:"/.*/",get:c=>{const y=(0,a.dO)(c);return p=>y.test(p.name||"")},getOptionsDisplayText:c=>`Frame name: ${c}`};function g(){return[f,m,d,h,s]}function P(){return[b]}},72693:(Q,I,e)=>{"use strict";e.d(I,{UM:()=>D,Yg:()=>s,nz:()=>v,zx:()=>b});var n=e(11261),a=e(85200),o=e(1173);const r={id:o.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:E=>{const S=E.map(T=>(0,a.NS)(T));return(T,M,A)=>{for(const x of S)if(x(T,M,A))return!0;return!1}},getOptionsDisplayText:E=>{let S="";for(const T of E){S.length>0&&(S+=" OR ");const M=a.sJ.get(T.id);S+=M.getOptionsDisplayText?M.getOptionsDisplayText(T):M.name}return S}},i={id:o.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:E=>{const S=E.map(T=>(0,a.Dq)(T));return T=>{for(const M of S)if(M(T))return!0;return!1}},getOptionsDisplayText:E=>{let S="";for(const T of E){S.length>0&&(S+=" OR ");const M=a.RE.get(T.id);S+=M.getOptionsDisplayText?M.getOptionsDisplayText(T):M.name}return S}},f={id:o.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:E=>{const S=E.map(T=>(0,a.NS)(T));return(T,M,A)=>{for(const x of S)if(!x(T,M,A))return!1;return!0}},getOptionsDisplayText:E=>{let S="";for(const T of E){S.length>0&&(S+=" AND ");const M=a.sJ.get(T.id);S+=M.getOptionsDisplayText?M.getOptionsDisplayText(T):M.name}return S}},d={id:o.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:E=>{const S=E.map(T=>(0,a.Dq)(T));return T=>{for(const M of S)if(!M(T))return!1;return!0}},getOptionsDisplayText:E=>{let S="";for(const T of E){S.length>0&&(S+=" AND ");const M=a.RE.get(T.id);S+=M.getOptionsDisplayText?M.getOptionsDisplayText(T):M.name}return S}},l={id:o.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:E=>{const S=(0,a.NS)(E);return(T,M,A)=>!S(T,M,A)},getOptionsDisplayText:E=>{const S=a.sJ.get(E.id);return"NOT "+(S.getOptionsDisplayText?S.getOptionsDisplayText(E.options):S.name)}},m={id:o.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:E=>{const S=(0,a.Dq)(E);return T=>!S(T)},getOptionsDisplayText:E=>{const S=a.RE.get(E.id);return"NOT "+(S.getOptionsDisplayText?S.getOptionsDisplayText(E.options):S.name)}},s=E=>!0,h=E=>!0,u=E=>!1,b=E=>E.type!==n.PU.time,g=E=>!1,P={id:o.cV.alwaysMatch,name:"All Fields",description:"Always Match",get:E=>s,getOptionsDisplayText:E=>"Always"},c={id:o.cV.alwaysMatch,name:"All Frames",description:"Always Match",get:E=>h,getOptionsDisplayText:E=>"Always"},y={id:o.cV.neverMatch,name:"No Fields",description:"Never Match",excludeFromPicker:!0,get:E=>u,getOptionsDisplayText:E=>"Never"},p={id:o.cV.neverMatch,name:"No Frames",description:"Never Match",get:E=>g,getOptionsDisplayText:E=>"Never"};function v(){return[r,f,l,P,y]}function D(){return[i,d,m,c,p]}},97497:(Q,I,e)=>{"use strict";e.d(I,{h:()=>o,m:()=>a});var n=e(83077),a=(r=>(r.Combine="combine",r.CalculateNewFields="calculateNewFields",r.CreateNewVisualization="createNewVisualization",r.Filter="filter",r.PerformSpatialOperations="performSpatialOperations",r.Reformat="reformat",r.ReorderAndRename="reorderAndRename",r))(a||{});const o=new n.O},2514:(Q,I,e)=>{"use strict";e.d(I,{m:()=>m});var n=e(62467),a=e(69862),o=e(81160),r=e(85200),i=e(97497);const f=(h,u)=>b=>{const g=i.h.get(h.id);if(!g)return b;const c={...g.transformation.defaultOptions??{},...h.options},y=h.filter?.options?(0,r.Dq)(h.filter):void 0;return b.pipe((0,a.Z)(p=>(0,n.of)(d(p,y)).pipe(g.transformation.operator(c,u),l(p,g,y))))};function d(h,u){return u?h.filter(b=>u(b)):h}const l=(h,u,b)=>g=>g.pipe((0,o.T)(P=>{if(P===h)return P;if(b){let c=0;const y=h.filter((p,v)=>{const D=!b(p);return D&&!c&&(c=v),D});y.length&&P.splice(c,0,...y)}return P}));function m(h,u,b){const g=(0,n.of)(u);if(!h.length)return g;const P=[],c=b??{interpolate:y=>y};for(let y=0;y<h.length;y++){const p=h[y];if(s(p))P.push(p(c));else{if(p.disabled)continue;P.push(f(p,c))}}return g.pipe.apply(g,P)}function s(h){return typeof h=="function"}},57934:(Q,I,e)=>{"use strict";e.d(I,{c:()=>he});var n=e(66350),a=e(82150),o=e(50311),r=e(34125),i=e(64224),f=e(35602),d=e(1173),l=e(18282);const m={id:l.F.filterByRefId,name:"Filter data by query refId",description:"select a subset of results",defaultOptions:{},operator:(ce,me)=>pe=>{const ye={};return ce.include&&(ye.include={id:d.jR.byRefId,options:ce.include}),ce.exclude&&(ye.exclude={id:d.jR.byRefId,options:ce.exclude}),pe.pipe(i.I.operator(ye,me))}};var s=e(73376),h=e(15400),u=e(81160),b=e(28240),g=e(81010);const P={id:l.F.formatTime,name:"Format time",description:"Set the output format of a time field",defaultOptions:{timeField:"",outputFormat:"",useTimezone:!0},isApplicable:ce=>{for(const me of ce)for(const pe of me.fields)if(pe.type==="time")return g.M.Applicable;return g.M.NotApplicable},isApplicableDescription:"The Format time transformation requires a time field to work. No time field could be found.",operator:(ce,me)=>pe=>pe.pipe((0,u.T)(ye=>c(ce,ye,me)))},c=({timeField:ce,outputFormat:me,timezone:pe},ye,Pe)=>!Array.isArray(ye)||ye.length===0?ye:((0,b.Fm)(ye),me=Pe?.interpolate(me)??me,ye.map(Ie=>({...Ie,fields:Ie.fields.map(Oe=>(Oe.state?.displayName===ce&&(Oe=(0,o.Xv)(Oe,me,{timeZone:pe})),Oe))})));var y=e(25094),p=e(68133),v=e(11261),D=e(85200);const E="Time",S="Time",T="Value",M=g.N.Empty,A=window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback,x={id:l.F.groupingToMatrix,name:"Grouping to Matrix",description:"Groups series by field and return a matrix visualisation",defaultOptions:{columnField:E,rowField:S,valueField:T},isApplicable:ce=>{let me=0;for(const pe of ce)me+=pe.fields.length;return me>=3?g.M.Applicable:g.M.NotApplicable},isApplicableDescription:ce=>{let me=0;for(const pe of ce)me+=pe.fields.length;return`Grouping to matrix requiers at least 3 fields to work. Currently there are ${me} fields.`},operator:ce=>me=>me.pipe((0,u.T)(pe=>{const ye=ce.columnField||E,Pe=ce.rowField||S,Ie=ce.valueField||T,Oe=ce.emptyValue||M;if(pe.length!==1)return pe;const Ne=pe[0],We=O(Ne,ye),Ae=O(Ne,Pe),Ue=O(Ne,Ie),Me=`${Pe}\\${ye}`;if(!We||!Ae||!Ue)return pe;const $e=C(We.values),ke=C(Ae.values),Ze={};for(let xt=0;xt<Ue.values.length;xt++){const ct=We.values[xt],ft=Ae.values[xt],Le=Ue.values[xt];Ze[ct]||(Ze[ct]={}),Ze[ct][ft]=Le}const ot=[{name:Me,values:ke,type:v.PU.string,config:{}}];for(const xt of $e){let ct=[];for(const ft of ke){const Le=Ze[xt][ft]??R(Oe);ct.push(Le)}A&&typeof xt=="number"&&(Ue.config={...Ue.config,displayNameFromDS:void 0}),ot.push({name:xt.toString(),values:ct,config:Ue.config,type:Ue.type})}return[{fields:ot,length:ke.length}]}))};function C(ce){const me=new Set;for(let pe=0;pe<ce.length;pe++)me.add(ce[pe]);return Array.from(me)}function O(ce,me){for(let pe=0;pe<ce.fields.length;pe++){const ye=ce.fields[pe];let Pe;if(A?Pe=D.sJ.get(d.Ct.byName).get(me)(ye,ce,[ce]):Pe=me===(0,b.Ct)(ye),Pe)return ye}return null}function R(ce){switch(ce){case g.N.False:return!1;case g.N.True:return!0;case g.N.Null:return null;case g.N.Empty:default:return""}}var L=e(77678),N=e(41511),F=e(6829),K=e(67641);const B=10,w={id:l.F.limit,name:"Limit",description:"Limit the number of items to the top N",defaultOptions:{limitField:B},operator:(ce,me)=>pe=>pe.pipe((0,u.T)(ye=>{let Pe=B;return ce.limitField!==void 0&&(typeof ce.limitField=="string"?(0,K.w)()?Pe=parseInt(me.interpolate(ce.limitField),10):Pe=parseInt(ce.limitField,10):Pe=ce.limitField),ye.map(Ie=>Ie.length>Pe?{...Ie,fields:Ie.fields.map(Oe=>({...Oe,values:Oe.values.slice(0,Pe)})),length:Pe}:Ie)}))};var U=e(58140),W=e(64586),V=e(82280);const _={id:l.F.rename,name:"Rename fields by name",description:"Rename fields based on configuration given by user",defaultOptions:{renameByName:{}},operator:ce=>me=>me.pipe((0,u.T)(pe=>{const ye=H(ce.renameByName);return!Array.isArray(pe)||pe.length===0?pe:pe.map(Pe=>({...Pe,fields:ye(Pe)}))}))},H=ce=>me=>!ce||Object.keys(ce).length===0?me.fields:me.fields.map(pe=>{const ye=(0,b.Ct)(pe,me),Pe=ce[ye];return typeof Pe!="string"||Pe.length===0?pe:{...pe,config:{...pe.config,displayName:Pe},state:{...pe.state,displayName:Pe}}}),G={id:l.F.organize,name:"Organize fields by name",description:"Order, filter and rename fields based on configuration given by user",defaultOptions:{excludeByName:{},indexByName:{},renameByName:{},includeByName:{}},isApplicable:ce=>ce.length>1?g.M.NotPossible:g.M.Applicable,operator:(ce,me)=>pe=>pe.pipe(f.D.operator({include:ce.includeByName?{names:j(ce.includeByName)}:void 0,exclude:{names:j(ce.excludeByName)}},me),V.x.operator(ce,me),_.operator(ce,me))},j=ce=>ce?Object.keys(ce).filter(me=>ce[me]):[];var Y=e(21128),oe=e(54479);const se={id:l.F.renameByRegex,name:"Rename fields by regex",description:"Rename fields based on regular expression by users.",defaultOptions:{regex:"(.*)",renamePattern:"$1"},operator:ce=>me=>me.pipe((0,u.T)(pe=>!Array.isArray(pe)||pe.length===0?pe:pe.map(ne(ce))))},ne=ce=>me=>{const pe=(0,oe.dO)(ce.regex),ye=me.fields.map(Pe=>{const Ie=(0,b.Ct)(Pe,me);if(!pe.test(Ie))return Pe;const Oe=Ie.replace(pe,ce.renamePattern);return{...Pe,config:{...Pe.config,displayName:Oe},state:{...Pe.state,displayName:Oe}}});return{...me,fields:ye}};var ee=e(2543),Z=e(37471),z=e(14236),q=e(19845);const ie={id:l.F.seriesToRows,name:"Series to rows",description:"Combines multiple series into a single serie and appends a column with metric name per value.",defaultOptions:{},operator:ce=>me=>me.pipe((0,u.T)(pe=>{if(!Array.isArray(pe)||pe.length===0||(pe=pe.filter(Ne=>Ne.length>0),!(0,q.jq)(pe)))return pe;const ye={},Pe=new Set,Ie=new Z.k,Oe={name:v.aI,values:[],config:{},type:v.PU.string};for(let Ne=0;Ne<pe.length;Ne++){const We=pe[Ne];for(let Ae=0;Ae<We.fields.length;Ae++){const Ue=We.fields[Ae];if(Ue.type===v.PU.time){ye[Ne]=Ae,Pe.has(v.LE)||(Ie.addField(de(Ue,v.LE)),Ie.addField(Oe),Pe.add(v.LE));continue}Pe.has(v.Bc)||(Ie.addField(de(Ue,v.Bc)),Pe.add(v.Bc))}}for(let Ne=0;Ne<pe.length;Ne++){const We=pe[Ne];for(let Ae=0;Ae<We.length;Ae++){const Ue=ye[Ne],Me=Ue===0?1:0;Ie.add({[v.LE]:We.fields[Ue].values[Ae],[v.aI]:(0,b.Ri)(We),[v.Bc]:We.fields[Me].values[Ae]})}}return[(0,z.ES)(Ie,0,!0)]}))},de=(ce,me)=>({...(0,ee.omit)(ce,["values","state","labels","config","name"]),name:me,values:[],config:{...(0,ee.omit)(ce.config,["displayName","displayNameFromDS"])}}),ue={id:l.F.sortBy,name:"Sort by",description:"Sort fields in a frame.",defaultOptions:{fields:{}},operator:(ce,me)=>pe=>pe.pipe((0,u.T)(ye=>!Array.isArray(ye)||ye.length===0||!ce?.sort?.length?ye:fe(ye,ce.sort,me)))};function fe(ce,me,pe){return ce.map(ye=>{const Pe=Se(ye,me,pe);return Pe.length&&Pe[0].index!=null?(0,z.ES)(ye,Pe[0].index,Pe[0].desc):ye})}function Se(ce,me,pe){return me.map(ye=>ye.index!=null?ye:(0,K.w)()?{...ye,index:ce.fields.findIndex(Pe=>pe.interpolate(ye.field)===(0,b.Ct)(Pe,ce))}:{...ye,index:ce.fields.findIndex(Pe=>ye.field===(0,b.Ct)(Pe,ce))})}const he={noopTransformer:W.W,filterFieldsTransformer:i.z,filterFieldsByNameTransformer:f.D,filterFramesTransformer:i.I,filterFramesByRefIdTransformer:m,filterByValueTransformer:s.Sv,formatStringTransformer:h.yt,formatTimeTransformer:P,orderFieldsTransformer:V.x,organizeFieldsTransformer:G,reduceTransformer:Y.Wj,concatenateTransformer:a.vz,calculateFieldTransformer:n.SC,joinByFieldTransformer:N.L,seriesToColumnsTransformer:N.L,seriesToRowsTransformer:ie,renameFieldsTransformer:_,labelsToFieldsTransformer:F.V,ensureColumnsTransformer:r.b,groupByTransformer:y.of,sortByTransformer:ue,mergeTransformer:U.o,renameByRegexTransformer:se,histogramTransformer:L.OA,convertFieldTypeTransformer:o.zM,groupingToMatrixTransformer:x,limitTransformer:w,groupToNestedTable:p._}},66350:(Q,I,e)=>{"use strict";e.d(I,{Bp:()=>y,SC:()=>T,UY:()=>c,Uj:()=>D,ip:()=>p,sw:()=>B});var n=e(2543),a=e.n(n),o=e(81160),r=e(14236),i=e(28240),f=e(11261),d=e(39070),l=e(11710),m=e(27618),s=e(75059),h=e(85200),u=e(1173),b=e(34125),g=e(18282),P=e(64586),c=(w=>(w.ReduceRow="reduceRow",w.CumulativeFunctions="cumulativeFunctions",w.WindowFunctions="windowFunctions",w.BinaryOperation="binary",w.UnaryOperation="unary",w.Index="index",w))(c||{}),y=(w=>(w.Percentage="percentage",w.Fixed="fixed",w))(y||{}),p=(w=>(w.Trailing="trailing",w.Centered="centered",w))(p||{});const v={reducer:s.gy.sum},D={reducer:s.gy.mean,windowAlignment:"trailing",windowSizeMode:"percentage",windowSize:.1},E={left:"",operator:l.k.Add,right:""},S={operator:m._.Abs,fieldName:""},T={id:g.F.calculateField,name:"Add field from calculation",description:"Use the row values to calculate a new field",defaultOptions:{mode:"reduceRow",reduce:{reducer:s.gy.sum}},operator:(w,U)=>W=>{const V=w&&w.timeSeries!==!1?b.b.operator(null,U):P.W.operator({},U);return w.alias!=null&&(w.alias=U.interpolate(w.alias)),W.pipe(V,(0,o.T)(_=>{const H=w.mode??"reduceRow";let G;switch(H){case"reduceRow":G=L((0,n.defaults)(w.reduce,v),_);break;case"cumulativeFunctions":G=R((0,n.defaults)(w.cumulative,v),_);break;case"windowFunctions":G=M((0,n.defaults)(w.window,D),_);break;case"unary":G=K((0,n.defaults)(w.unary,S),_);break;case"binary":const j={...w.binary,left:U.interpolate(w.binary?.left),right:U.interpolate(w.binary?.right)};G=F((0,n.defaults)(j,E),_);break;case"index":return _.map(Y=>{const oe=[...Array(Y.length).keys()];if(w.index?.asPercentile)for(let ne=0;ne<oe.length;ne++)oe[ne]=oe[ne]/oe.length;const se={name:w.alias??"Row",type:f.PU.number,values:oe,config:w.index?.asPercentile?{unit:"percentunit"}:{}};return{...Y,fields:w.replaceFields?[se]:[...Y.fields,se]}})}return G?_.map(j=>{const Y=G(j);if(!Y)return j;const oe={name:B(w),type:f.PU.number,config:{},values:Y};let se=[];if(w.replaceFields){const{timeField:ne}=(0,r.KR)(j);ne&&w.timeSeries!==!1?se=[ne,oe]:se=[oe]}else se=[...j.fields,oe];return{...j,fields:se}}):_}))}};function M(w,U){if(w.windowSize<=0)throw new Error("Add field from calculation transformation - Window size must be larger than 0");let W=(0,h.NS)({id:u.Ct.numeric});return w.field&&(W=(0,h.NS)({id:u.Ct.byNames,options:{names:[w.field]}})),V=>{const _=Math.ceil(w.windowSize*(w.windowSizeMode==="percentage"?V.length:1));let H=null;for(const G of V.fields)if(W(G,V,U)){H=G;break}if(H){if(![s.gy.mean,s.gy.stdDev,s.gy.variance].includes(w.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${w.reducer}`);return w.windowAlignment==="centered"?x(V,w.reducer,H,_):A(V,w.reducer,H,_)}}}function A(w,U,W,V){const _=[];let H=0,G=0;for(let j=0;j<w.length;j++)if(U===s.gy.mean){const Y=W.values[j];Y!=null&&(G++,H+=Y,j>V-1&&(H-=W.values[j-V],G--)),_.push(G===0?0:H/G)}else if(U===s.gy.variance){const Y=Math.max(0,j-V+1),oe=j+1;_.push(C(W.values.slice(Y,oe)))}else if(U===s.gy.stdDev){const Y=Math.max(0,j-V+1),oe=j+1;_.push(O(W.values.slice(Y,oe)))}return _}function x(w,U,W,V){const _=[];let H=0,G=0;const j=Math.ceil(V/2)-1,Y=Math.floor(V/2);for(let oe=0;oe<w.length;oe++){const se=oe-Y,ne=oe+j;if(U===s.gy.mean){if(oe===0)for(let ee=0;ee<j+1&&ee<W.values.length;ee++)W.values[ee]!=null&&(H+=W.values[ee],G++);else ne<W.values.length&&W.values[ne]!=null&&(H+=W.values[ne],G++),se>0&&W.values[se-1]!=null&&(H-=W.values[se-1],G--);_.push(G===0?0:H/G)}else if(U===s.gy.variance){const ee=W.values.slice(Math.max(0,se),Math.min(ne+1,W.values.length));_.push(C(ee))}else if(U===s.gy.stdDev){const ee=W.values.slice(Math.max(0,se),Math.min(ne+1,W.values.length));_.push(O(ee))}}return _}function C(w){if(w.length<1)return 0;let U=0,W=0,V=0;for(let H=0;H<w.length;H++){const G=w[H];if(G!=null){V++;let j=W;W+=(G-j)/V,U+=(G-j)*(G-W)}}return V===0?0:U/V}function O(w){return Math.sqrt(C(w))}function R(w,U){let W=(0,h.NS)({id:u.Ct.numeric});if(w.field&&(W=(0,h.NS)({id:u.Ct.byNames,options:{names:[w.field]}})),![s.gy.mean,s.gy.sum].includes(w.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${w.reducer}`);return V=>{let _=null;for(const j of V.fields)if(W(j,V,U)){_=j;break}if(!_)return;const H=[];let G=0;for(let j=0;j<V.length;j++)G+=_.values[j]??0,w.reducer===s.gy.sum?H.push(G):w.reducer===s.gy.mean&&H.push(G/(j+1));return H}}function L(w,U){let W=(0,h.NS)({id:u.Ct.numeric});w.include&&w.include.length&&(W=(0,h.NS)({id:u.Ct.byNames,options:{names:w.include}}));const V=s.AS.get(w.reducer);if(!V)throw new Error(`Unknown reducer: ${w.reducer}`);const _=V.reduce??s.H3,H=w.nullValueMode===d.UW.Ignore,G=w.nullValueMode===d.UW.AsZero;return j=>{const Y=[];for(const ee of j.fields)W(ee,j,U)&&Y.push(ee.values);const oe=Y.length,se={name:"temp",values:new Array(oe),type:f.PU.number,config:{}},ne=[];for(let ee=0;ee<j.length;ee++){for(let Z=0;Z<oe;Z++)se.values[Z]=Y[Z][ee];ne.push(_(se,H,G)[w.reducer])}return ne}}function N(w,U,W){if(!U)return;for(const _ of w.fields)if(U===(0,i.Ct)(_,w,W))return _.type===f.PU.boolean?_.values.map(H=>H?1:0):_.values;const V=parseFloat(U);if(!isNaN(V))return new Array(w.length).fill(V)}function F(w,U){const W=l.b.getIfExists(w.operator);return V=>{const _=N(V,w.left,U),H=N(V,w.right,U);if(!_||!H||!W)return;const G=new Array(_.length);for(let j=0;j<G.length;j++)G[j]=W.operation(_[j],H[j]);return G}}function K(w,U){const W=m.j.getIfExists(w.operator);return V=>{let _=[];for(const G of V.fields)w.fieldName===(0,i.Ct)(G,V,U)&&G.type===f.PU.number&&(_=G.values);if(!_.length||!W)return;const H=new Array(_.length);for(let G=0;G<H.length;G++)H[G]=W.operation(_[G]);return H}}function B(w){if(w.alias?.length)return w.alias;switch(w.mode){case"cumulativeFunctions":{const{cumulative:U}=w;return`cumulative ${U?.reducer??""}${U?.field?`(${U.field})`:""}`}case"windowFunctions":{const{window:U}=w;return`${U?.windowAlignment??""} moving ${U?.reducer??""}${U?.field?`(${U.field})`:""}`}case"unary":{const{unary:U}=w;return`${U?.operator??""}${U?.fieldName?`(${U.fieldName})`:""}`}case"binary":{const{binary:U}=w;return`${U?.left??""} ${U?.operator??""} ${U?.right??""}`.replace(/\$/g,"")}case"reduceRow":{const U=s.AS.getIfExists(w.reduce?.reducer);if(U)return U.name}break;case"index":return"Row"}return"math"}},82150:(Q,I,e)=>{"use strict";e.d(I,{vz:()=>i,x1:()=>r});var n=e(81160),a=e(11261),o=e(18282),r=(d=>(d.Drop="drop",d.FieldName="field",d.Label="label",d))(r||{});const i={id:o.F.concatenate,name:"Concatenate fields",description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",defaultOptions:{frameNameMode:"field",frameNameLabel:"frame"},operator:d=>l=>l.pipe((0,n.T)(m=>!Array.isArray(m)||m.length<2?m:[f(m,d)]))};function f(d,l){let m=!0,s=d[0].length;const h=l.frameNameLabel??"frame";let u=[];for(const b of d){s!==b.length&&(m=!1,s=Math.max(s,b.length));for(const g of b.fields){const P={...g};P.state=void 0,b.name&&(l.frameNameMode==="drop"||(l.frameNameMode==="label"?(P.labels={...g.labels},P.labels[h]=b.name):!P.name||P.name===a.Bc?P.name=b.name:P.name=`${b.name} \xB7 ${g.name}`)),u.push(P)}}return m||(u=u.map(b=>{if(b.values.length===s)return b;const g=b.values.slice();return g.length=s,{...b,values:g}})),{fields:u,length:s}}},50311:(Q,I,e)=>{"use strict";e.d(I,{Xv:()=>g,ks:()=>c,s7:()=>m,zM:()=>d});var n=e(81160),a=e(53531),o=e(11261),r=e(85200),i=e(1173),f=e(18282);const d={id:f.F.convertFieldType,name:"Convert field type",description:"Convert a field to a specified field type.",defaultOptions:{fields:{},conversions:[{targetField:void 0,destinationType:void 0,dateFormat:void 0,timezone:void 0}]},operator:(p,v)=>D=>D.pipe((0,n.T)(E=>d.transformer(p,v)(E))),transformer:p=>v=>!Array.isArray(v)||v.length===0?v:l(p,v)??[]};function l(p,v){if(!p.conversions.length)return v;const D=v.map(E=>({...E}));for(const E of p.conversions){if(!E.targetField)continue;const S=r.sJ.get(i.Ct.byName).get(E.targetField);for(const T of D)T.fields=T.fields.map(M=>S(M,T,D)?m(M,E):M)}return D}function m(p,v){switch(v.destinationType){case o.PU.time:return c(p,v.dateFormat);case o.PU.number:return u(p);case o.PU.string:return g(p,v.dateFormat,{timeZone:v.timezone},v.joinWith);case o.PU.boolean:return b(p);case o.PU.enum:return y(p,v.enumConfig);case o.PU.other:return P(p);default:return p}}const s=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2})$/;function h(p,v){let D=v?{format:v}:void 0;const E=p.values.slice();let S=E.find(M=>M!=null),T=typeof S=="string"&&s.test(S);for(let M=0;M<E.length;M++)if(E[M]){let A=T?Date.parse(E[M]):(0,a.b)(E[M],D).valueOf();E[M]=Number.isFinite(A)?A:null}else E[M]=null;return{...p,type:o.PU.time,values:E}}function u(p){const v=p.values.slice(),D=v.some(E=>typeof E=="string");for(let E=0;E<v.length;E++){let S=v[E];D&&S!=null&&typeof S=="string"&&(S=S.replace(/,/g,""));const T=+S;v[E]=Number.isFinite(T)?T:null}return{...p,type:o.PU.number,values:v}}function b(p){const v=p.values.slice();for(let D=0;D<v.length;D++)v[D]=!!v[D];return{...p,type:o.PU.boolean,values:v}}function g(p,v,D,E){let S=p.values;switch(p.type){case o.PU.time:S=S.map(T=>(0,a.b)(T,D).format(v));break;case o.PU.other:S=S.map(T=>E?.length&&Array.isArray(T)?T.join(E):JSON.stringify(T));break;default:S=S.map(T=>`${T}`)}return{...p,type:o.PU.string,values:S}}function P(p){const v=p.values.slice();for(let D=0;D<v.length;D++)try{v[D]=JSON.parse(v[D])}catch{v[D]=null}return{...p,type:o.PU.other,values:v}}function c(p,v){const D=typeof p.values[0]=="number";return p.type===o.PU.time&&D?p:D?{...p,type:o.PU.time}:h(p,v)}function y(p,v){const D={...v},E=p.values.slice(),S=new Map;if(D.text&&D.text.length>0)for(let T=0;T<D.text.length;T++)S.set(D.text[T],T);else return p;for(let T=0;T<E.length;T++){const M=E[T];E[T]=S.get(M)}return{...p,config:{...p.config,type:{enum:D}},type:o.PU.enum,values:E}}},34125:(Q,I,e)=>{"use strict";e.d(I,{b:()=>i});var n=e(81160),a=e(14236),o=e(18282),r=e(41511);const i={id:o.F.ensureColumns,name:"Ensure Columns Transformer",description:"Will check if current data frames is series or columns. If in series it will convert to columns.",operator:(d,l)=>m=>m.pipe((0,n.T)(s=>i.transformer(d,l)(s))),transformer:(d,l)=>m=>{const s=f(m);return m.length>1&&s?r.L.transformer({byField:s},l)(m):m}};function f(d){let l;for(const m of d){const{timeField:s}=(0,a.KR)(m);if(!s)return;if(!l)l=s.name;else if(l!==s.name)return}return l}},64224:(Q,I,e)=>{"use strict";e.d(I,{I:()=>f,z:()=>i});var n=e(81160),a=e(85200),o=e(18282),r=e(64586);const i={id:o.F.filterFields,name:"Filter Fields",description:"select a subset of fields",defaultOptions:{},operator:(d,l)=>m=>!d.include&&!d.exclude?m.pipe(r.W.operator({},l)):(typeof d.include?.options=="string"?d.include.options=l.interpolate(d.include?.options):typeof d.include?.options?.pattern=="string"&&(d.include.options.pattern=l.interpolate(d.include?.options.pattern)),typeof d.exclude?.options=="string"?d.exclude.options=l.interpolate(d.exclude?.options):typeof d.exclude?.options?.pattern=="string"&&(d.exclude.options.pattern=l.interpolate(d.exclude?.options.pattern)),m.pipe((0,n.T)(s=>{const h=d.include?(0,a.NS)(d.include):null,u=d.exclude?(0,a.NS)(d.exclude):null,b=[];for(const g of s){const P=[];for(let y=0;y<g.fields.length;y++){const p=g.fields[y];if(u){if(u(p,g,s))continue;h||P.push(p)}h&&h(p,g,s)&&P.push(p)}if(!P.length)continue;const c={...g,fields:P};b.push(c)}return b})))},f={id:o.F.filterFrames,name:"Filter Frames",description:"select a subset of frames",defaultOptions:{},operator:(d,l)=>m=>!d.include&&!d.exclude?m.pipe(r.W.operator({},l)):m.pipe((0,n.T)(s=>{const h=d.include?(0,a.Dq)(d.include):null,u=d.exclude?(0,a.Dq)(d.exclude):null,b=[];for(const g of s){if(u){if(u(g))continue;h||b.push(g)}h&&h(g)&&b.push(g)}return b}))}},35602:(Q,I,e)=>{"use strict";e.d(I,{D:()=>r,R:()=>i});var n=e(1173),a=e(64224),o=e(18282);const r={id:o.F.filterFieldsByName,name:"Filter fields by name",description:"select a subset of fields",defaultOptions:{},operator:(f,d)=>l=>l.pipe(a.z.operator({include:i(d,f.include,f.byVariable),exclude:i(d,f.exclude,f.byVariable)},d))},i=(f,d,l)=>{if(!d)return;const{names:m,pattern:s,variable:h}=d;if(l&&h){const u=f.interpolate(h);if(/\{.*\}/.test(u)){const b=u.slice(1).slice(0,-1).split(",");return{id:n.Ct.byNames,options:{names:b}}}return{id:n.Ct.byNames,options:{names:u.split(",")}}}if(!((!Array.isArray(m)||m.length===0)&&!s))return s?!Array.isArray(m)||m.length===0?{id:n.Ct.byRegexp,options:s}:{id:n.Ct.byRegexpOrNames,options:d}:{id:n.Ct.byNames,options:{names:m}}}},73376:(Q,I,e)=>{"use strict";e.d(I,{Sm:()=>m,Sv:()=>s,j4:()=>l});var n=e(81160),a=e(28240),o=e(85200),r=e(1173),i=e(18282),f=e(64586),d=e(67641),l=(b=>(b.exclude="exclude",b.include="include",b))(l||{}),m=(b=>(b.all="all",b.any="any",b))(m||{});const s={id:i.F.filterByValue,name:"Filter data by values",description:"select a subset of results based on values",defaultOptions:{filters:[],type:"include",match:"any"},operator:(b,g)=>P=>{const c=b.filters,y=b.match==="all",p=b.type==="include";if(!Array.isArray(c)||c.length===0)return P.pipe(f.W.operator({},g));const v=[];return(0,d.w)()&&v.push(...c.map(D=>{if(D.config.id===r.Js.between){const E=g.interpolate(D.config.options.from),S=g.interpolate(D.config.options.to);return{...D,config:{...D.config,options:{...D.config.options,to:S,from:E}}}}else{if(D.config.id===r.Js.regex)return D;if(D.config.options.value){const E=g.interpolate(D.config.options.value),S={...D,config:{...D.config,options:{...D.config.options,value:E}}};return S.config.options.value=E,S}}return D})),P.pipe((0,n.T)(D=>{if(D.length===0)return D;const E=[],S=u(D);for(const T of D){const M=new Set;let A;(0,d.w)()?A=h(v,S):A=h(c,S);for(let O=0;O<T.length;O++){if(M.has(O))continue;let R=!0;for(const L of A){const N=L(O,T,D);if(!y&&N){R=!0;break}if(y&&!N){R=!1;break}R=N}R&&M.add(O)}const x=[],C=p?M.size:D[0].length-M.size;for(const O of T.fields){const R=[];for(let L=0;L<T.length;L++){if(p&&M.has(L)){R.push(O.values[L]);continue}if(!p&&!M.has(L)){R.push(O.values[L]);continue}}x.push({...O,values:R,state:{}})}E.push({...T,fields:x,length:C})}return E}))}},h=(b,g)=>{const P=()=>!1;return b.map(c=>{const y=g[c.fieldName]??-1;if(y<0)return console.warn(`[FilterByValue] Could not find index for field name: ${c.fieldName}`),P;const p=(0,o.kK)(c.config);return(v,D,E)=>p(v,D.fields[y],D,E)})},u=b=>{const g={};for(const P of b)P.fields.forEach((c,y)=>{const p=(0,a.Ct)(c,P,b);g[p]=y});return g}},15400:(Q,I,e)=>{"use strict";e.d(I,{gs:()=>d,yt:()=>s});var n=e(81160),a=e(11261),o=e(81010),r=e(85200),i=e(1173),f=e(18282),d=(u=>(u.UpperCase="Upper Case",u.LowerCase="Lower Case",u.SentenceCase="Sentence Case",u.TitleCase="Title Case",u.PascalCase="Pascal Case",u.CamelCase="Camel Case",u.SnakeCase="Snake Case",u.KebabCase="Kebab Case",u.Trim="Trim",u.Substring="Substring",u))(d||{});const l=u=>{const b=u.split(" ");for(let g=0;g<b.length;g++)b[g]=b[g].charAt(0).toUpperCase()+b[g].slice(1).toLowerCase();return b},m=u=>b=>b.values.map(g=>{switch(u.outputFormat){case"Upper Case":return g.toUpperCase();case"Lower Case":return g.toLowerCase();case"Sentence Case":return g.charAt(0).toUpperCase()+g.slice(1);case"Title Case":return l(g).join(" ");case"Pascal Case":return l(g).join("");case"Camel Case":return g=l(g).join(""),g.charAt(0).toLowerCase()+g.slice(1);case"Snake Case":return g.toLowerCase().split(" ").join("_");case"Kebab Case":return g.toLowerCase().split(" ").join("-");case"Trim":return g.trim();case"Substring":return g.substring(u.substringStart,u.substringEnd)}}),s={id:f.F.formatString,name:"Format string",description:"Manipulate string fields formatting",defaultOptions:{stringField:"",outputFormat:"Upper Case"},isApplicable:u=>{for(const b of u)for(const g of b.fields)if(g.type==="string")return o.M.Applicable;return o.M.NotApplicable},operator:u=>b=>b.pipe((0,n.T)(g=>{if(g.length===0)return g;const P=r.sJ.get(i.Ct.byName).get(u.stringField),c=m(u),y=h(P,c);return g.map(p=>({...p,fields:y(p,g)}))}))},h=(u,b)=>(g,P)=>g.fields.map(c=>{if(u(c,g,P)){const y=b(c);return{...c,type:a.PU.string,values:y}}return c})},25094:(Q,I,e)=>{"use strict";e.d(I,{Ce:()=>c,R3:()=>s,Y2:()=>P,of:()=>h});var n=e(81160),a=e(14236),o=e(28240),r=e(81010),i=e(11261),f=e(75059),d=e(18282),l=e(67641);const m=2;var s=(y=>(y.aggregate="aggregate",y.groupBy="groupby",y))(s||{});const h={id:d.F.groupBy,name:"Group by",description:"Group the data by a field values then process calculations for each group.",defaultOptions:{fields:{}},isApplicable:y=>(0,l.f)(y)>=m?r.M.Applicable:r.M.NotApplicable,isApplicableDescription:y=>{const p=(0,l.f)(y);return`The Group by transformation requires a series with at least ${m} fields to work. The maximum number of fields found on a series is ${p}`},operator:y=>p=>p.pipe((0,n.T)(v=>{if(!Object.keys(y.fields).find(S=>y.fields[S].operation==="groupby"))return v;const E=[];for(const S of v){const T=S.fields.filter(x=>u(x,y));if(T.length===0)continue;const M=P(S,T),A=c(T,M);for(const x of S.fields){if(!b(x,y))continue;const C=(0,o.Ct)(x),O=y.fields[C].aggregations,R={};M.forEach(L=>{const N=L[C],F=(0,f.Nw)({field:N,reducers:O});for(const K of O)Array.isArray(R[K])||(R[K]=[]),R[K].push(F[K])});for(const L of O){const N={name:`${C} (${L})`,values:R[L]??[],type:i.PU.other,config:{}};N.type=g(L,x,N),A.push(N)}}E.push({fields:A,length:M.size})}return E}))},u=(y,p)=>{const v=(0,o.Ct)(y);return p?.fields[v]?.operation==="groupby"},b=(y,p)=>{const v=(0,o.Ct)(y);return p?.fields[v]?.operation==="aggregate"&&Array.isArray(p?.fields[v].aggregations)&&p?.fields[v].aggregations.length>0};function g(y,p,v){switch(y){case f.gy.allIsNull:return i.PU.boolean;case f.gy.last:case f.gy.lastNotNull:case f.gy.first:case f.gy.firstNotNull:return p.type;default:return(0,a.dF)(v)??i.PU.string}}function P(y,p){const v=new Map;for(let D=0;D<y.length;D++){const E=String(p.map(T=>T.values[D])),S=v.get(E)??{};v.has(E)||v.set(E,S);for(let T of y.fields){const M=(0,o.Ct)(T);S[M]||(S[M]={name:M,type:T.type,config:{...T.config},values:[]}),S[M].values.push(T.values[D])}}return v}function c(y,p){const v=[];for(const D of y){const E=[],S=(0,o.Ct)(D);p.forEach(T=>{E.push(T[S].values[0])}),v.push({name:D.name,type:D.type,config:{...D.config},values:E})}return v}},68133:(Q,I,e)=>{"use strict";e.d(I,{_:()=>b,l:()=>s});var n=e(81160),a=e(14236),o=e(28240),r=e(11261),i=e(81010),f=e(75059),d=e(25094),l=e(18282),m=e(67641);const s=!0,h=2;var u=(v=>(v.aggregate="aggregate",v.groupBy="groupby",v))(u||{});const b={id:l.F.groupToNestedTable,name:"Group to nested tables",description:"Group data by a field value and create nested tables with the grouped data",defaultOptions:{showSubframeHeaders:s,fields:{}},isApplicable:v=>(0,m.f)(v)>=h?i.M.Applicable:i.M.NotApplicable,isApplicableDescription:v=>{const D=(0,m.f)(v);return`The Group to nested table transformation requires a series with at least ${h} fields to work. The maximum number of fields found on a series is ${D}`},operator:v=>D=>D.pipe((0,n.T)(E=>{if(!Object.keys(v.fields).find(M=>v.fields[M].operation==="groupby"))return E;const T=[];for(const M of E){const A=M.fields.filter(R=>P(R,v));if(A.length===0)continue;const x=(0,d.Y2)(M,A),C=(0,d.Ce)(A,x),O=p(x,v);for(let R=0;R<M.fields.length;R++){const L=M.fields[R];if(!c(L,v))continue;const N=(0,o.Ct)(L),F=v.fields[N].aggregations,K={};x.forEach(B=>{const w=B[N],U=(0,f.Nw)({field:w,reducers:F});for(const W of F)Array.isArray(K[W])||(K[W]=[]),K[W].push(U[W])});for(const B of F){const w={name:`${N} (${B})`,values:K[B],type:r.PU.other,config:{}};w.type=y(B,L,w),C.push(w)}}C.push({config:{},name:"Nested frames",type:r.PU.nestedFrames,values:O}),T.push({fields:C,length:x.size})}return T}))};function g(v,D,E){return{meta:{custom:{noHeader:!(E.showSubframeHeaders===void 0?s:E.showSubframeHeaders)}},length:D,fields:v}}const P=(v,D)=>{const E=(0,o.Ct)(v);return D?.fields[E]?.operation==="groupby"},c=(v,D)=>{const E=(0,o.Ct)(v);return D?.fields[E]?.operation==="aggregate"&&Array.isArray(D?.fields[E].aggregations)&&D?.fields[E].aggregations.length>0},y=(v,D,E)=>{switch(v){case f.gy.allIsNull:return r.PU.boolean;case f.gy.last:case f.gy.lastNotNull:case f.gy.first:case f.gy.firstNotNull:return D.type;default:return(0,a.dF)(E)??r.PU.string}};function p(v,D){const E=[];for(const[,S]of v){const T=[];for(const[M,A]of Object.entries(S)){const x=D.fields[M];(x===void 0||x.aggregations===void 0||x.operation==="aggregate"&&x.aggregations.length===0||x.operation===null||x.operation===void 0)&&T.push(A)}T.length>0?E.push([g(T,T[0].values.length,D)]):E.push([g([],0,D)])}return E}},77678:(Q,I,e)=>{"use strict";e.d(I,{H1:()=>D,NX:()=>p,OA:()=>c,Rt:()=>P,Uh:()=>M,ZU:()=>T,cg:()=>C,d$:()=>y,dA:()=>v,ix:()=>E,p3:()=>S,rW:()=>h,rs:()=>A});var n=e(81160),a=e(57875),o=e(75972),r=e(41260),i=e(11261),f=e(97706),d=e(18282),l=e(73060),m=e(39624),s=e(67641);const h=[1e-9,2e-9,25e-10,4e-9,5e-9,1e-8,2e-8,25e-9,4e-8,5e-8,1e-7,2e-7,25e-8,4e-7,5e-7,1e-6,2e-6,25e-7,4e-6,5e-6,1e-5,2e-5,25e-6,4e-5,5e-5,1e-4,2e-4,25e-5,4e-4,5e-4,.001,.002,.0025,.004,.005,.01,.02,.025,.04,.05,.1,.2,.25,.4,.5,1,2,4,5,10,20,25,40,50,100,200,250,400,500,1e3,2e3,2500,4e3,5e3,1e4,2e4,25e3,4e4,5e4,1e5,2e5,25e4,4e5,5e5,1e6,2e6,25e5,4e6,5e6,1e7,2e7,25e6,4e7,5e7,1e8,2e8,25e7,4e8,5e8,1e9,2e9,25e8,4e9,5e9],u=30,b=[],g=(O,R)=>O-R,P={bucketCount:{name:"Bucket count",description:"approx bucket count"},bucketSize:{name:"Bucket size",description:void 0},bucketOffset:{name:"Bucket offset",description:"for non-zero-based buckets"},combine:{name:"Combine series",description:"combine all series into a single histogram"}},c={id:d.F.histogram,name:"Histogram",description:"Calculate a histogram from input data.",defaultOptions:{fields:{}},operator:(O,R)=>L=>L.pipe((0,n.T)(N=>c.transformer(O,R)(N))),transformer:(O,R)=>L=>{if(!Array.isArray(L)||L.length===0)return L;let N,F;O.bucketSize&&((0,s.w)()&&(O.bucketSize=R.interpolate(O.bucketSize.toString())),typeof O.bucketSize=="string"?N=parseFloat(O.bucketSize):N=O.bucketSize,isNaN(N)&&(N=void 0)),O.bucketOffset&&((0,s.w)()&&(O.bucketOffset=R.interpolate(O.bucketOffset.toString())),typeof O.bucketOffset=="string"?F=parseFloat(O.bucketOffset):F=O.bucketOffset,isNaN(F)&&(F=void 0));const K={bucketSize:N,bucketOffset:F,combine:O.combine},B=S(L,K);return B==null?[]:[C(B)]}},y="xMin";function p(O){return O===y||O==="BucketMin"}const v="xMax";function D(O){return O===v||O==="BucketMax"}function E(O){if(O.meta?.type===r.m.HeatmapCells){let F=O.fields.find(_=>_.name==="yMin"),K=O.fields.find(_=>_.name==="yMax"),B=O.fields.find(_=>_.name==="count"),w=[...new Set(K.values)].sort((_,H)=>_-H),U=[...new Set(F.values)].sort((_,H)=>_-H),W=new Map;w.forEach(_=>W.set(_,0));for(let _=0;_<K.values.length;_++){let H=K.values[_];W.set(H,W.get(H)+B.values[_])}return{xMin:{...F,name:"xMin",values:U},xMax:{...K,name:"xMax",values:w},counts:[{...B,values:[...W.values()]}]}}else if(O.meta?.type===r.m.HeatmapRows){let F=[],K=[],B=[],w="0";return O.fields.forEach(W=>{if(W.type===i.PU.number){let V=W.values.reduce((_,H)=>_+H,0);B.push(V),F.push(w),K.push(w=W.name)}}),B.push(0),F.push(w),K.push(w),{xMin:{...O.fields[1],name:"xMin",type:i.PU.string,values:F},xMax:{...O.fields[1],name:"xMax",type:i.PU.string,values:K},counts:[{...O.fields[1],name:"count",type:i.PU.number,values:B}]}}let R,L;const N=[];for(const F of O.fields)p(F.name)?R=F:D(F.name)?L=F:F.type===i.PU.number&&N.push(F);if(!L&&R&&R.values.length>1){let F=R.values,K=(0,f.h)(F[1]-F[0],6);L={...R,name:v,values:F.map(B=>B+K)}}if(!R&&L&&L?.values.length>1){let F=L.values,K=(0,f.h)(F[1]-F[0],6);R={...L,name:y,values:F.map(B=>B-K)}}if(R&&L&&N.length)return{xMin:R,xMax:L,counts:N}}function S(O,R){let L=R?.bucketSize,N=R?.bucketCount??u,F=R?.bucketOffset??0;if(O=O.map(G=>({...G,fields:G.fields.map(j=>{if(j.type===i.PU.number){const Y=Number(j.config.noValue);Number.isNaN(Y)?j={...j,values:j.values.filter(oe=>oe!=null)}:j=(0,m.A)(j,Y)}return j})})),!L||L<0){let G=[];for(const ee of O)for(const Z of ee.fields)Z.type===i.PU.number&&(G=G.concat(Z.values));G.sort((ee,Z)=>ee-Z);let j=1/0;if(G.length===1)j=1;else for(let ee=1;ee<G.length;ee++){let Z=G[ee]-G[ee-1];Z!==0&&(j=Math.min(j,Z))}let Y=G[0];const ne=(G[G.length-1]-Y)/N;for(let ee=0;ee<h.length;ee++){let Z=h[ee];if(ne<Z&&Z>=j){L=Z;break}}}const K=G=>(0,f.h)(A(G-F,L)+F,9);let B=((""+L).match(/\.\d+$/)??["."])[0].length-1,w=[],U=[],W;for(const G of O)for(const j of G.fields)if(j.type===i.PU.number){let Y=x(j.values,K,b,g);w.push(Y),U.push({...j,config:{...j.config,unit:j.config.unit==="short"?"short":void 0}}),!W&&j.config.unit&&(W=j.config)}if(!U.length)return null;let V=(0,l.fj)(w);for(let G=1;G<V.length;G++){let j=V[G];for(let Y=0;Y<j.length;Y++)j[Y]==null&&(j[Y]=0)}const _={name:y,values:V[0],type:i.PU.number,state:void 0,config:B===0?W??{}:{...W,decimals:B}},H={..._,name:v,values:V[0].map(G=>G+L)};if(R?.combine){const G=new Array(V[0].length).fill(0);for(let j=1;j<V.length;j++)for(let Y=0;Y<G.length;Y++)G[Y]+=V[j][Y];U=[{...U[0],name:"count",values:G,type:i.PU.number,state:{...U[0].state,displayName:"Count",multipleFrames:!1,origin:{frameIndex:0,fieldIndex:2}}}]}else U.forEach((G,j)=>{G.values=V[j+1]});return{xMin:_,xMax:H,counts:U}}function T(O,R){return Math.round(O/R)*R}function M(O,R){return Math.ceil(O/R)*R}function A(O,R){return Math.floor(O/R)*R}function x(O,R,L,N){let F=new Map;for(let U=0;U<O.length;U++){let W=O[U];W!=null&&(W=R(W));let V=F.get(W);V?V.count++:F.set(W,{value:W,count:1})}L&&L.forEach(U=>F.delete(U));let K=[...F.values()];N&&K.sort((U,W)=>N(U.value,W.value));let B=Array(K.length),w=Array(K.length);for(let U=0;U<K.length;U++)B[U]=K[U].value,w[U]=K[U].count;return[B,w]}function C(O,R){if(!O.xMin.display){const L=(0,a.J)({field:O.xMin,theme:R??(0,o.a)()});O.xMin.display=L,O.xMax.display=L}return O.counts[0].display=(0,a.J)({field:O.counts[0],theme:R??(0,o.a)()}),{length:O.xMin.values.length,meta:{type:r.m.Histogram},fields:[O.xMin,O.xMax,...O.counts]}}},41511:(Q,I,e)=>{"use strict";e.d(I,{L:()=>d,W:()=>f});var n=e(81160),a=e(85200),o=e(1173),r=e(18282),i=e(73060),f=(l=>(l.outer="outer",l.inner="inner",l.outerTabular="outerTabular",l))(f||{});const d={id:r.F.joinByField,aliasIds:[r.F.seriesToColumns],name:"Join by field",description:"Combine rows from two or more tables, based on a related field between them.  This can be used to outer join multiple time series on the _time_ field to show many time series in one table.",defaultOptions:{byField:void 0,mode:"outer"},operator:(l,m)=>s=>s.pipe((0,n.T)(h=>d.transformer(l,m)(h))),transformer:(l,m)=>{let s;return h=>{if(h.length>1){l.byField&&!s&&(s=a.sJ.get(o.Ct.byName).get(m.interpolate(l.byField)));const u=(0,i.Fd)({frames:h,joinBy:s,mode:l.mode});if(u)return[u]}return h}}}},73060:(Q,I,e)=>{"use strict";e.d(I,{Fd:()=>m,JI:()=>g,RC:()=>u,WO:()=>b,Yj:()=>l,fj:()=>c,g2:()=>y});var n=e(14236),a=e(11261),o=e(85200),r=e(1173),i=e(41511);function f(p){const{timeField:v}=(0,n.KR)(p[0]);if(v)return o.sJ.get(r.Ct.firstTimeField).get({});let D=[];for(const E of p[0].fields)E.type===a.PU.number&&D.push(E.name);for(let E=1;E<p.length;E++){const S=[];for(const T of p[0].fields)T.type===a.PU.number&&S.push(T.name);D=D.filter(T=>!S.includes(T))}return o.sJ.get(r.Ct.byName).get(D[0])}function d(p){return p.joinBy??f(p.frames)}function l(p,v){if(v>=0){let D=p.fields[v];D.type!==a.PU.string&&!y(D.values)&&(p=(0,n.ES)(p,v))}return p}function m(p){if(!p.frames?.length)return;const v=p.nullMode??(C=>{let O=C.config.custom?.spanNulls;return O===!0?u:O===-1?b:g});if(p.frames.length===1){let C=p.frames[0],O=C;const R=d(p);let L=O.fields.findIndex(N=>R(N,O,p.frames));if(p.keepOriginIndices&&(O={...C,fields:C.fields.map((N,F)=>{const K={...N},B={frameIndex:0,fieldIndex:F};return K.state?K.state.origin=B:K.state={origin:B},K})},L>0)){const N=O.fields[L],F=O.fields.filter((K,B)=>B!==L);F.unshift(N),O.fields=F,L=0}if(L>=0&&(O=l(O,L)),p.keep){let N=O.fields.filter((F,K)=>K===L||p.keep(F,O,p.frames));C!==O?O.fields=N:O={...C,fields:N}}return O}const D=[],E=[],S=[],T=[];let M=1;const A=d(p);for(let C=0;C<p.frames.length;C++){const O=p.frames[C];if(!O||!O.fields?.length)continue;const R=[u];let L,N=[],F=[];for(let B=0;B<O.fields.length;B++){const w=O.fields[B];if(w.state=w.state||{},!L&&A(w,O,p.frames))L=w;else{if(p.keep&&!p.keep(w,O,p.frames))continue;R.push(v(w));let U=w.labels??{},W=w.name;O.name&&(w.name===a.Bc?W=O.name:U.name==null&&(U={...U,name:O.name})),N.push({...w,name:W,labels:U})}p.keepOriginIndices&&(w.state.origin={frameIndex:C,fieldIndex:B})}if(!L)continue;S.length===0&&S.push(L),D.push(R);const K=[L.values];for(const B of N)K.push(B.values),S.push(B),p.keepDisplayNames||delete B.state?.displayName,F.push(M),M++;T.push(F),E.push(K)}let x=[];return p.mode===i.W.outerTabular?x=s(E,T,S.length,D):p.mode===i.W.inner?x=h(E):x=c(E,D,p.mode),{length:x[0]?x[0].length:0,fields:S.map((C,O)=>({...C,values:x[O]}))}}function s(p,v,D,E){let S={};for(let M=0;M<p.length;M++){let A=p[M],x=A[0];for(let C=0;C<p.length;C++){if(C===M)continue;let O=p[C],R=O[0];for(let L=0;L<x.length;L++){const N=x[L],F=D-1;let K=[N].concat(new Array(F)),B=0;for(let w=1;w<A.length;w++){const U=v[M][B];K[U]=A[w][L],B++}for(let w=0;w<R.length;w++)if(x[L]===R[w]){let U=0;for(let W=1;W<O.length;W++){const V=v[C][U];K[V]=O[W][w],U++}break}S[JSON.stringify(K)]=K}}}let T=[];for(let M=0;M<D;M++)T.push(new Array(0));for(let M in S){const A=S[M];for(let x=0;x<A.length;x++)T[x].push(A[x])}return T}function h(p){const v=[],D=(E,S,T)=>{if(S===E.length){v.push(T);return}const M=E[S],[A,...x]=M;for(let C=0;C<A.length;C++){const O=A[C];if(S===0||T.includes(O)){const R=[...T];S===0&&R.push(O);for(let L=0;L<x.length;L++)R.push(x[L][C]);D(E,S+1,R)}}};return D(p,0,[]),v.length===0?[]:v[0].map((E,S)=>v.map(T=>T[S]))}const u=0,b=1,g=2;function P(p,v,D){for(let E=0,S,T=-1;E<v.length;E++){let M=v[E];if(M>T){for(S=M-1;S>=0&&p[S]==null;)p[S--]=null;for(S=M+1;S<D&&p[S]==null;)p[T=S++]=null}}}function c(p,v,D=i.W.outer){let E=new Set;for(let A=0;A<p.length;A++){let C=p[A][0],O=C.length;for(let R=0;R<O;R++)E.add(C[R])}let S=[Array.from(E).sort((A,x)=>A-x)],T=S[0].length,M=new Map;for(let A=0;A<T;A++)M.set(S[0][A],A);for(let A=0;A<p.length;A++){let x=p[A],C=x[0];for(let O=1;O<x.length;O++){let R=x[O],L=Array(T).fill(void 0),N=v?v[A][O]:b,F=[];for(let K=0;K<R.length;K++){let B=R[K],w=M.get(C[K]);B===null?N!==u&&(L[w]=B,N===g&&F.push(w)):L[w]=B}P(L,F,T),S.push(L)}}return S}function y(p,v=50){const D=p.length;if(D<=1)return!0;let E=0,S=D-1;for(;E<=S&&p[E]==null;)E++;for(;S>=E&&p[S]==null;)S--;if(S<=E)return!0;const T=Math.max(1,Math.floor((S-E+1)/v));for(let M=p[E],A=E+T;A<=S;A+=T){const x=p[A];if(x!=null){if(x<=M)return!1;M=x}}return!0}},6829:(Q,I,e)=>{"use strict";e.d(I,{V:()=>f,n:()=>i});var n=e(81160),a=e(28240),o=e(11261),r=e(18282),i=(l=>(l.Columns="columns",l.Rows="rows",l))(i||{});const f={id:r.F.labelsToFields,name:"Labels to fields",description:"Extract time series labels to fields (columns or rows)",defaultOptions:{},operator:(l,m)=>s=>s.pipe((0,n.T)(h=>f.transformer(l,m)(h))),transformer:l=>m=>{if(l.mode==="rows")return d(m,l.keepLabels);const s=[],h=l.keepLabels?.length?new Set(l.keepLabels):void 0;for(const u of m){const b=[],g={};for(const P of u.fields){if(!P.labels){b.push(P);continue}const c={...P,config:{...P.config,displayName:void 0,displayNameFromDS:void 0},labels:void 0};b.push(c);for(const y of Object.keys(P.labels)){if(h&&!h.has(y))continue;if(l.valueLabel===y){c.name=P.labels[y];continue}(g[y]??(g[y]=new Set)).add(P.labels[y])}}for(const P in g)for(const c of g[P]){const y=new Array(u.length).fill(c);b.push({name:P,type:o.PU.string,values:y,config:{}})}s.push({...u,fields:b,length:u.length})}return s}};function d(l,m){const s=[];for(const h of l)for(const u of h.fields)if(u.labels){const b=[],g=[];if(m)for(const P of m)b.push(P),g.push(u.labels[P]);else for(const[P,c]of Object.entries(u.labels))b.push(P),g.push(c);g.length&&s.push({...h,name:(0,a.Ct)(u,h,l),fields:[{name:"label",type:o.PU.string,config:{},values:b},{name:"value",type:o.PU.string,config:{},values:g}],length:g.length})}return s}},58140:(Q,I,e)=>{"use strict";e.d(I,{o:()=>d});var n=e(2543),a=e.n(n),o=e(81160),r=e(37471),i=e(81010),f=e(18282);const d={id:f.F.merge,name:"Merge series/tables",description:"Merges multiple series/tables into a single serie/table",defaultOptions:{},isApplicable:g=>g.length>1?i.M.Applicable:i.M.NotApplicable,isApplicableDescription:g=>`The merge transformation requires at least 2 data series to work. There is currently ${g.length} data series.`,operator:g=>P=>P.pipe((0,o.T)(c=>{if(!Array.isArray(c)||c.length<=1)return c;const y=c.filter(x=>x.fields.length>0);if(y.length===0)return[c[0]];const p=new Set,v={},D=[],E=new r.k;for(let x=0;x<y.length;x++){const C=y[x];for(let O=0;O<C.fields.length;O++){const R=C.fields[O];p.has(R.name)||(E.addField(l(R)),p.add(R.name)),v[R.name]=v[R.name]||{},v[R.name][x]=O,y.length-1===x&&u(v,R,y)&&D.push(R.name)}}if(D.length===0)return c;const S={},T=[],M=m(y,v,D),A=s(y,p,v);for(let x=0;x<y.length;x++){const C=y[x];for(let O=0;O<C.length;O++){const R=M(x,O),L=A(x,O);if(!Array.isArray(S[R])){S[R]=[L],T.push(b(R,S));continue}let N=!1;S[R]=S[R].map(F=>h(F,L)?(N=!0,{...F,...L}):F),N||(S[R].push(L),T.push(b(R,S)))}}for(const x of T){const C=S[x.key][x.index];C&&E.add(C)}return[E]}))},l=g=>({...(0,n.omit)(g,["values","state","labels","config"]),values:[],config:{...(0,n.omit)(g.config,"displayName")}}),m=(g,P,c)=>{const y=c.reduce((p,v)=>Object.keys(P[v]).reduce((D,E)=>(D[E]=D[E]||[],D[E].push(P[v][E]),D),p),{});return(p,v)=>y[p].reduce((D,E)=>D+g[p].fields[E].values[v],"")},s=(g,P,c)=>(y,p)=>{const v={},D=Array.from(P);for(const E of D){const S=c[E];if(!S)continue;const T=S[y];if(typeof T!="number")continue;const M=g[y];if(!M||!M.fields)continue;const A=M.fields[T];!A||!A.values||(v[E]=A.values[p])}return v},h=(g,P)=>{let c=!0;for(const y in P)if(!(typeof g[y]>"u")&&g[y]!==null&&g[y]!==P[y]){c=!1;break}return c},u=(g,P,c)=>Object.keys(g[P.name]).length===c.length,b=(g,P)=>({key:g,index:P[g].length-1})},64586:(Q,I,e)=>{"use strict";e.d(I,{W:()=>a});var n=e(18282);const a={id:n.F.noop,name:"noop",description:"No-operation transformer",defaultOptions:{},operator:o=>r=>r,transformer:o=>r=>r}},46294:(Q,I,e)=>{"use strict";e.d(I,{M:()=>r});var n=e(11261);const a={threshold:(f,d,l)=>f+l,midpoint:(f,d,l)=>(f+d)/2,plusone:(f,d,l)=>f+1};function o(f,d){return f.fields.find(l=>d!=null?l.name===d:l.type===n.PU.time)}function r(f){if(f.frame.length===0)return f.frame;let d=!0,{frame:l,refFieldName:m,refFieldPseudoMax:s,refFieldPseudoMin:h,insertMode:u}=f;u||(u=a.threshold);const b=o(l,m);if(b==null)return l;b.state={...b.state,nullThresholdApplied:!0};const g=l.fields.map(c=>c.config.custom?.insertNulls||b.config.interval||null),P=new Set(g);if(P.delete(null),P.size===0)return l;if(P.size===1){const c=P.values().next().value;if(c<=0)return l;const y=b.values,p=l.fields.map(D=>D.values),v=i(y,p,c,h,s,u,d);return v===p?l:{...l,length:v[0].length,fields:l.fields.map((D,E)=>({...D,values:v[E]}))}}return l}function i(f,d,l,m=null,s=null,h,u){const b=f.length,g=[];if(m!=null&&m<f[0]){let p=Math.ceil((f[0]-m)/l),v=f[0]-p*l;for(;v<f[0];)g.push(h(v-l,v,l)),v+=l}g.push(f[0]);let P=f[0];for(let p=1;p<b;p++){const v=f[p];for(;v-P>l&&(g.push(h(P,v,l)),P+=l,!!u););g.push(v),P=v}if(s!=null&&s>P)for(;P+l<s;)g.push(h(P,s,l)),P+=l;const c=g.length;if(c===b)return d;const y=[];for(let p of d){let v;if(p!==f){v=Array(c);for(let D=0,E=0;D<c;D++)v[D]=f[E]===g[D]?p[E++]:null}else v=g;y.push(v)}return y}},39624:(Q,I,e)=>{"use strict";e.d(I,{A:()=>a,C:()=>n});function n(o){return{...o,fields:o.fields.map(r=>{const i=Number(r.config.noValue);return Number.isNaN(i)?r:a(r,i)})}}function a(o,r){const i=o.values.slice();for(let f=0;f<i.length;f++)i[f]===null&&(i[f]=r);return{...o,values:i}}},82280:(Q,I,e)=>{"use strict";e.d(I,{X:()=>d,x:()=>f});var n=e(2543),a=e.n(n),o=e(81160),r=e(28240),i=e(18282);const f={id:i.F.order,name:"Order fields by name",description:"Order fields based on configuration given by user",defaultOptions:{indexByName:{}},operator:s=>h=>h.pipe((0,o.T)(u=>{const b=l(s.indexByName);return!Array.isArray(u)||u.length===0?u:u.map(g=>({...g,fields:b(g.fields,u,g)}))}))},d=s=>(h,u)=>m(h,s)-m(u,s),l=s=>(h,u,b)=>{if(!Array.isArray(h)||h.length===0||!s||Object.keys(s).length===0)return h;const g=d(s);return(0,n.clone)(h).sort((P,c)=>g((0,r.Ct)(P,b,u),(0,r.Ct)(c,b,u)))},m=(s,h)=>Number.isInteger(h[s])?h[s]:Number.MAX_SAFE_INTEGER},21128:(Q,I,e)=>{"use strict";e.d(I,{Wj:()=>s,rV:()=>m});var n=e(81160),a=e(14236),o=e(28240),r=e(11261),i=e(75059),f=e(85200),d=e(72693),l=e(18282),m=(c=>(c.SeriesToRows="seriesToRows",c.ReduceFields="reduceFields",c))(m||{});const s={id:l.F.reduce,name:"Reduce",description:"Reduce all rows or data points to a single value using a function like max, min, mean or last.",defaultOptions:{reducers:[i.gy.max]},operator:c=>y=>y.pipe((0,n.T)(p=>{if(!c?.reducers?.length)return p;const v=c.fields?(0,f.NS)(c.fields):c.includeTimeField&&c.mode==="reduceFields"?d.Yg:d.zx;if(c.mode==="reduceFields")return g(p,v,c.reducers);const D=h(p,v,c.reducers,c.labelsToFields);return D?[D]:[]}))};function h(c,y,p,v){const D=i.AS.list(p),E=D.map(M=>M.id),S=[],T=v?u(c):[];for(const M of c){const A=M.fields.filter(N=>y(N,M,c)),x=A.length,C=[],O=new Array(x);C.push({name:"Field",type:r.PU.string,values:O,config:{}});const R={};if(v)for(const N of T)R[N]=new Array(x),C.push({name:N,type:r.PU.string,values:R[N],config:{}});const L={};for(const N of D)L[N.id]=new Array(x),C.push({name:N.name,type:r.PU.other,values:L[N.id],config:{}});for(let N=0;N<A.length;N++){const F=A[N],K=(0,i.Nw)({field:F,reducers:E});if(v){if(O[N]=F.name,F.labels)for(const B in F.labels)R[B][N]=F.labels[B]}else O[N]=(0,o.Ct)(F,M,c);for(const B of D){const w=K[B.id];L[B.id][N]=w}}for(const N of C)if(N.type===r.PU.other){const F=(0,a.dF)(N);F&&(N.type=F)}S.push({...M,fields:C,length:x})}return b(S)}function u(c){const y=new Set;for(const p of c)for(const v of p.fields)if(v.labels)for(const D of Object.keys(v.labels))y.add(D);return[...y]}function b(c){if(!c?.length)return;const y=c[0];for(let p=1;p<c.length;p++){const v=c[p];for(let D=0;D<y.fields.length;D++){const E=y.fields[D];for(let S=0;S<v.fields.length;S++){const T=v.fields[S],M=D===0&&S===0,A=E.type===T.type&&E.name===T.name;if(M||A){const x=E.values,C=T.values;E.values=x.concat(C)}}}}return y.name=void 0,y.length=y.fields[0].values.length,y}function g(c,y,p){const D=i.AS.list(p).map(S=>S.id),E=[];for(const S of c){const T=[];for(const M of S.fields)if(y(M,S,c)){const A=(0,i.Nw)({field:M,reducers:D});for(const x of D){const C=A[x],O={...M,type:P(x,M),values:[C]};O.state=void 0,D.length>1&&(O.labels||(O.labels={}),O.labels.reducer=i.AS.get(x).name),T.push(O)}}T.length&&E.push({...S,fields:T,length:1})}return E}function P(c,y){switch(c){case i.gy.allValues:case i.gy.uniqueValues:return r.PU.other;case i.gy.first:case i.gy.firstNotNull:case i.gy.last:case i.gy.lastNotNull:return y.type;default:return r.PU.number}}},67641:(Q,I,e)=>{"use strict";e.d(I,{f:()=>a,w:()=>n});const n=()=>window?.grafanaBootData?.settings?.featureToggles?.transformationsVariableSupport;function a(o){let r=0;for(const i of o)i.fields.length>r&&(r=i.fields.length);return r}},22544:()=>{"use strict"},12463:()=>{"use strict"},43585:(Q,I,e)=>{"use strict";e.d(I,{O:()=>n});var n=(a=>(a.NoData="no_data",a.Paused="paused",a.Alerting="alerting",a.OK="ok",a.Pending="pending",a.Unknown="unknown",a))(n||{})},8790:(Q,I,e)=>{"use strict";e.d(I,{V:()=>n});var n=(a=>(a.Field="field",a.Text="text",a.Skip="skip",a))(n||{})},41987:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>i,Jk:()=>o,hX:()=>r});var n=e(43429),a=e(74135),o=(f=>(f.CloudAlerting="cloud-alerting",f.UnifiedAlerting="unified-alerting",f.Dashboard="dashboard",f.Explore="explore",f.Correlations="correlations",f.Unknown="unknown",f.PanelEditor="panel-editor",f.PanelViewer="panel-viewer",f))(o||{});class r extends n.Ud{constructor(){super(...arguments),this._extensionConfigs=[]}init(d){}setRootPage(d){return this.root=d,this}setComponentsFromLegacyExports(d){if(d.ConfigCtrl&&(this.angularConfigCtrl=d.ConfigCtrl),this.meta&&this.meta.includes){for(const l of this.meta.includes)if(l.type===n.ib.page&&l.component&&!d[l.component]){console.warn("App Page uses unknown component: ",l.component,this.meta);continue}}}get extensionConfigs(){return this._extensionConfigs}addLink(d){const{targets:l,...m}=d;return(Array.isArray(l)?l:[l]).forEach(h=>{this._extensionConfigs.push({...m,extensionPointId:h,type:a.u.link})}),this}addComponent(d){const{targets:l,...m}=d;return(Array.isArray(l)?l:[l]).forEach(h=>{this._extensionConfigs.push({...m,extensionPointId:h,type:a.u.component})}),this}exposeComponent(d){const{id:l,...m}=d;return this._extensionConfigs.push({...m,extensionPointId:`capabilities/${l}`,type:a.u.component}),this}configureExtensionLink(d){return this.addLink({targets:[d.extensionPointId],...d}),this}configureExtensionComponent(d){return this.addComponent({targets:[d.extensionPointId],...d}),this}}var i=(f=>(f.alpha="alpha",f.beta="beta",f.experimental="experimental",f.privatePreview="private preview",f.preview="preview",f))(i||{})},61268:(Q,I,e)=>{"use strict";e.d(I,{r:()=>n});var n=(a=>(a.OpenSource="Open Source",a.Pro="Pro",a.Enterprise="Enterprise",a))(n||{})},58649:(Q,I,e)=>{"use strict";e.d(I,{En:()=>o,d1:()=>a,tw:()=>n});const n=0,a=100,o="SAML"},94624:(Q,I,e)=>{"use strict";e.d(I,{y:()=>n});var n=(a=>(a[a.Off=0]="Off",a[a.Crosshair=1]="Crosshair",a[a.Tooltip=2]="Tooltip",a))(n||{})},39070:(Q,I,e)=>{"use strict";e.d(I,{Gu:()=>n,Gv:()=>f,Nx:()=>a,UW:()=>o,zz:()=>r});var n=(d=>(d.NotStarted="NotStarted",d.Loading="Loading",d.Streaming="Streaming",d.Done="Done",d.Error="Error",d))(n||{});const a=["graph","table","logs","trace","nodeGraph","flamegraph","rawPrometheus"];var o=(d=>(d.Null="null",d.Ignore="connected",d.AsZero="null as zero",d))(o||{});const r=d=>!!d;function i(d){return d}function f(d){return typeof d=="object"&&d!==null?!0:!1}},11261:(Q,I,e)=>{"use strict";e.d(I,{Bc:()=>a,LE:()=>o,PU:()=>n,aI:()=>r});var n=(i=>(i.time="time",i.number="number",i.string="string",i.boolean="boolean",i.trace="trace",i.geo="geo",i.enum="enum",i.other="other",i.frame="frame",i.nestedFrames="nestedFrames",i))(n||{});const a="Value",o="Time",r="Metric"},41260:(Q,I,e)=>{"use strict";e.d(I,{m:()=>n});var n=(a=>(a.TimeSeriesWide="timeseries-wide",a.TimeSeriesLong="timeseries-long",a.TimeSeriesMany="timeseries-many",a.TimeSeriesMulti="timeseries-multi",a.NumericWide="numeric-wide",a.NumericMulti="numeric-multi",a.NumericLong="numeric-long",a.LogLines="log-lines",a.DirectoryListing="directory-listing",a.HeatmapRows="heatmap-rows",a.HeatmapCells="heatmap-cells",a.Histogram="histogram",a))(n||{})},91890:(Q,I,e)=>{"use strict";e.d(I,{$0:()=>o,CC:()=>a,uP:()=>r,x0:()=>n});var n=(i=>(i.Datasource="Datasource",i.Correlations="Correlations",i.ExploreCorrelationsEditor="CorrelationsEditor",i))(n||{}),a=(i=>(i.Regex="regex",i.Logfmt="logfmt",i))(a||{}),o=(i=>(i.Series="series",i.Field="field",i.Fields="fields",i.Value="value",i.BuiltIn="built-in",i.Template="template",i))(o||{}),r=(i=>(i.Values="values",i))(r||{})},40187:(Q,I,e)=>{"use strict";e.d(I,{Is:()=>d,ZF:()=>i,mA:()=>r,tD:()=>o,v2:()=>f});var n=e(92341),a=e(43429);class o extends a.Ud{constructor(m){super(),this.DataSourceClass=m,this.components={}}setConfigEditor(m){return this.components.ConfigEditor=m,this}setConfigCtrl(m){return this.angularConfigCtrl=m,this}setQueryCtrl(m){return this.components.QueryCtrl=m,this}setAnnotationQueryCtrl(m){return this.components.AnnotationsQueryCtrl=m,this}setQueryEditor(m){return this.components.QueryEditor=m,this}setExploreQueryField(m){return this.components.ExploreQueryField=m,this}setExploreMetricsQueryField(m){return this.components.ExploreMetricsQueryField=m,this}setExploreLogsQueryField(m){return this.components.ExploreLogsQueryField=m,this}setQueryEditorHelp(m){return this.components.QueryEditorHelp=m,this}setExploreStartPage(m){return this.setQueryEditorHelp(m)}setVariableQueryEditor(m){return this.components.VariableQueryEditor=m,this}setMetadataInspector(m){return this.components.MetadataInspector=m,this}setComponentsFromLegacyExports(m){this.angularConfigCtrl=m.ConfigCtrl,this.components.QueryCtrl=m.QueryCtrl,this.components.AnnotationsQueryCtrl=m.AnnotationsQueryCtrl,this.components.ExploreQueryField=m.ExploreQueryField,this.components.QueryEditor=m.QueryEditor,this.components.QueryEditorHelp=m.QueryEditorHelp,this.components.VariableQueryEditor=m.VariableQueryEditor}}class r{constructor(m){this.name=m.name,this.id=m.id,this.type=m.type,this.meta=m.meta,this.cachingConfig=m.cachingConfig,this.uid=m.uid}filterQuery(m){return!0}getRef(){return{type:this.type,uid:this.uid}}}var i=(l=>(l.Logs="Logs",l.Metrics="Metrics",l.Tracing="Tracing",l))(i||{}),f=(l=>(l.Cancelled="cancelled",l.Timeout="timeout",l.Unknown="unknown",l))(f||{});class d{}d=(0,n.Y)(d),r=(0,n.Y)(r)},50349:()=>{"use strict"},50219:()=>{"use strict"},24293:(Q,I,e)=>{"use strict";e.d(I,{F:()=>a,Y:()=>n});var n=(o=>(o.Thresholds="thresholds",o.PaletteClassic="palette-classic",o.PaletteClassicByName="palette-classic-by-name",o.PaletteSaturated="palette-saturated",o.ContinuousGrYlRd="continuous-GrYlRd",o.ContinuousRdYlGr="continuous-RdYlGr",o.ContinuousBlYlRd="continuous-BlYlRd",o.ContinuousYlRd="continuous-YlRd",o.ContinuousBlPu="continuous-BlPu",o.ContinuousYlBl="continuous-YlBl",o.ContinuousBlues="continuous-blues",o.ContinuousReds="continuous-reds",o.ContinuousGreens="continuous-greens",o.ContinuousPurples="continuous-purples",o.Fixed="fixed",o.Shades="shades",o))(n||{});const a="#808080"},37055:(Q,I,e)=>{"use strict";e.d(I,{Ow:()=>a,ZW:()=>n,uo:()=>o});function n(r){return i=>"__systemRef"in i&&i.__systemRef===r}const a=r=>"__systemRef"in r&&typeof r.__systemRef=="string";var o=(r=>(r.Unit="unit",r.Min="min",r.Max="max",r.Decimals="decimals",r.DisplayName="displayName",r.NoValue="noValue",r.Thresholds="thresholds",r.Mappings="mappings",r.Links="links",r.Color="color",r.Filterable="filterable",r))(o||{})},93015:()=>{"use strict"},58318:()=>{"use strict"},49812:()=>{"use strict"},8887:(Q,I,e)=>{"use strict";e.d(I,{Uo:()=>o,az:()=>n,n6:()=>a});const n={google:!0,microsoft:!0,github:!0,gitlab:!0,okta:!0,discord:!0,hipchat:!0,amazon:!0,"google-hangouts-alt":!0,pagerduty:!0,line:!0,anchor:!0,"adjust-circle":!0,"angle-double-down":!0,"angle-double-right":!0,"angle-double-left":!0,"angle-double-up":!0,"angle-down":!0,"angle-left":!0,"angle-right":!0,"angle-up":!0,"align-left":!0,"align-right":!0,"application-observability":!0,apps:!0,"archive-alt":!0,arrow:!0,"arrow-down":!0,"arrow-from-right":!0,"arrow-left":!0,"arrow-random":!0,"arrow-right":!0,"arrow-to-right":!0,"arrow-up":!0,"arrows-h":!0,"arrows-v":!0,asserts:!0,"expand-arrows":!0,"expand-arrows-alt":!0,at:!0,ai:!0,backward:!0,bars:!0,bell:!0,"bell-slash":!0,bolt:!0,book:!0,bookmark:!0,"book-open":!0,"brackets-curly":!0,bug:!0,building:!0,"calculator-alt":!0,"calendar-alt":!0,"calendar-slash":!0,camera:!0,capture:!0,"channel-add":!0,"chart-line":!0,check:!0,"check-circle":!0,"check-square":!0,circle:!0,"circle-mono":!0,"clipboard-alt":!0,"clock-nine":!0,cloud:!0,"cloud-download":!0,"cloud-upload":!0,"code-branch":!0,cog:!0,columns:!0,"comment-alt":!0,"comment-alt-message":!0,"comment-alt-share":!0,"comments-alt":!0,compass:!0,"compress-arrows":!0,copy:!0,"corner-down-right-alt":!0,"create-dashboard":!0,"credit-card":!0,crosshair:!0,cube:!0,dashboard:!0,database:!0,"dice-three":!0,docker:!0,"document-info":!0,"document-layout-left":!0,"download-alt":!0,draggabledots:!0,edit:!0,"ellipsis-v":!0,enter:!0,envelope:!0,"exchange-alt":!0,"exclamation-triangle":!0,"exclamation-circle":!0,exclamation:!0,"external-link-alt":!0,eye:!0,"eye-slash":!0,"ellipsis-h":!0,"fa fa-spinner":!0,favorite:!0,"file-alt":!0,"file-blank":!0,"file-copy-alt":!0,"file-download":!0,"file-edit-alt":!0,"file-landscape-alt":!0,filter:!0,flip:!0,folder:!0,font:!0,fire:!0,"folder-open":!0,"folder-plus":!0,"folder-upload":!0,forward:!0,"frontend-observability":!0,"gf-bar-alignment-after":!0,"gf-bar-alignment-before":!0,"gf-bar-alignment-center":!0,"gf-glue":!0,"gf-grid":!0,"gf-interpolation-linear":!0,"gf-interpolation-smooth":!0,"gf-interpolation-step-after":!0,"gf-interpolation-step-before":!0,"gf-landscape":!0,"gf-layout-simple":!0,"gf-logs":!0,"gf-ml":!0,"gf-movepane-left":!0,"gf-movepane-right":!0,"gf-portrait":!0,"gf-service-account":!0,"gf-show-context":!0,"gf-pin":!0,"gf-prometheus":!0,"gf-traces":!0,globe:!0,grafana:!0,"graph-bar":!0,heart:!0,"heart-rate":!0,"heart-break":!0,history:!0,"history-alt":!0,home:!0,"home-alt":!0,"horizontal-align-center":!0,"horizontal-align-left":!0,"horizontal-align-right":!0,hourglass:!0,import:!0,info:!0,"info-circle":!0,k6:!0,"key-skeleton-alt":!0,keyboard:!0,kubernetes:!0,"layer-group":!0,"layers-alt":!0,"library-panel":!0,"line-alt":!0,link:!0,"list-ui-alt":!0,"list-ul":!0,"list-ol":!0,lock:!0,"map-marker":!0,"map-marker-plus":!0,"map-marker-minus":!0,message:!0,minus:!0,"minus-circle":!0,"mobile-android":!0,monitor:!0,palette:!0,"panel-add":!0,paragraph:!0,"pathfinder-unite":!0,pause:!0,"pause-circle":!0,pen:!0,percentage:!0,play:!0,plug:!0,plus:!0,"plus-circle":!0,"plus-square":!0,power:!0,"presentation-play":!0,process:!0,"question-circle":!0,"record-audio":!0,repeat:!0,rocket:!0,"ruler-combined":!0,save:!0,search:!0,"search-minus":!0,"search-plus":!0,"share-alt":!0,shield:!0,"shield-exclamation":!0,signal:!0,signin:!0,signout:!0,sitemap:!0,slack:!0,"sliders-v-alt":!0,spinner:!0,"sort-amount-down":!0,"sort-amount-up":!0,"square-shape":!0,star:!0,"step-backward":!0,stopwatch:!0,"stopwatch-slash":!0,sync:!0,"sync-slash":!0,table:!0,"table-collapse-all":!0,"table-expand-all":!0,"tag-alt":!0,"telegram-alt":!0,"text-fields":!0,"thumbs-up":!0,times:!0,"times-circle":!0,"toggle-on":!0,"toggle-off":!0,"trash-alt":!0,unarchive:!0,unlock:!0,upload:!0,user:!0,"users-alt":!0,"user-arrows":!0,"vertical-align-bottom":!0,"vertical-align-center":!0,"vertical-align-top":!0,"web-section-alt":!0,"wrap-text":!0,rss:!0,x:!0,"add-user":!0,attach:!0};function a(r){return!r||typeof r!="string"?!1:r in n}function o(r){if(a(r))return r}},64572:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{AbstractLabelOperator:()=>d.D_,AlertState:()=>se.O,AnnotationEventFieldSource:()=>l.V,AppEvents:()=>_.r1,AppPlugin:()=>A.hX,CoreApp:()=>A.Jk,CustomVariableSupport:()=>G.f5,DEFAULT_SAML_NAME:()=>n.En,DashboardCursorSync:()=>f.y,DataFrameType:()=>r.m,DataLinkConfigOrigin:()=>i.x0,DataQueryErrorType:()=>x.v2,DataSourceApi:()=>x.mA,DataSourcePlugin:()=>x.tD,DataSourceVariableSupport:()=>G.ZV,DataTopic:()=>d.QR,DefaultTimeZone:()=>b.lE,ExploreMode:()=>x.ZF,FALLBACK_COLOR:()=>L.F,FeatureState:()=>A.Ay,FieldColorModeId:()=>L.Y,FieldConfigProperty:()=>T.uo,FieldType:()=>o.PU,GAUGE_DEFAULT_MAXIMUM:()=>n.d1,GAUGE_DEFAULT_MINIMUM:()=>n.tw,GrafanaPlugin:()=>O.Ud,GrafanaThemeType:()=>N.I,LanguageProvider:()=>x.Is,LegacyGraphHoverClearEvent:()=>_.Tq,LegacyGraphHoverEvent:()=>_.kb,LiveChannelConnectionState:()=>H.ZF,LiveChannelEventType:()=>H.o4,LiveChannelScope:()=>H.qD,LiveChannelType:()=>H.os,LoadingState:()=>a.Gu,LogLevel:()=>m.$b,LogRowContextQueryDirection:()=>m.ZF,LogsDedupDescription:()=>m._C,LogsDedupStrategy:()=>m.fY,LogsMetaKind:()=>m.tG,LogsSortOrder:()=>m.uH,LogsVolumeType:()=>m.Aj,MappingType:()=>P.d,NullValueMode:()=>a.UW,NumericLogLevel:()=>m.s5,OrgRole:()=>F.X,PageLayoutType:()=>s.k,PanelEvents:()=>_.ee,PluginErrorCode:()=>O.ZK,PluginExtensionPoints:()=>de.S,PluginExtensionTypes:()=>de.u,PluginIncludeType:()=>O.ib,PluginSignatureStatus:()=>O.Ac,PluginSignatureType:()=>O.kv,PluginState:()=>O.pn,PluginType:()=>O.QE,SpecialValue:()=>S.N,SpecialValueMatch:()=>P.W,StandardVariableSupport:()=>G.J$,SupplementaryQueryType:()=>m.cF,SupportedTransformationType:()=>i.CC,TIME_FORMAT:()=>b.G$,TIME_SERIES_METRIC_FIELD_NAME:()=>o.aI,TIME_SERIES_TIME_FIELD_NAME:()=>o.LE,TIME_SERIES_VALUE_FIELD_NAME:()=>o.Bc,ThresholdsMode:()=>g.O,TransformationApplicabilityLevels:()=>S.M,VariableHide:()=>R.zL,VariableOrigin:()=>i.$0,VariableRefresh:()=>R.CO,VariableSort:()=>R.ZG,VariableSuggestionsScope:()=>i.uP,VariableSupportBase:()=>G.xi,VariableSupportType:()=>G.Qz,VisualizationSuggestionScore:()=>C.nQ,VisualizationSuggestionsBuilder:()=>C.v2,VisualizationSuggestionsListAppender:()=>C.NV,VizOrientation:()=>C.wV,availableIconsIndex:()=>ie.az,getDefaultRelativeTimeRange:()=>b.Cn,getDefaultTimeRange:()=>b.E2,hasLogsContextSupport:()=>m.Ol,hasLogsContextUiSupport:()=>m.wj,hasQueryExportSupport:()=>d.Ee,hasQueryImportSupport:()=>d.FL,hasQueryModificationSupport:()=>m._0,hasSupplementaryQuerySupport:()=>m.Nc,hasToggleableQueryFiltersSupport:()=>m.FP,isIconName:()=>ie.n6,isLiveChannelJoinEvent:()=>H.Cz,isLiveChannelLeaveEvent:()=>H.jQ,isLiveChannelMessageEvent:()=>H.Z7,isLiveChannelStatusEvent:()=>H.ew,isObject:()=>a.Gv,isSystemOverride:()=>T.Ow,isSystemOverrideWithRef:()=>T.ZW,isTruthy:()=>a.zz,isUnsignedPluginSignature:()=>oe.x,isValidLiveChannelAddress:()=>H.aj,makeTimeRange:()=>b.HW,parseLiveChannelAddress:()=>H.DG,patchArrayVectorProrotypeMethods:()=>M.V,preferredVisualizationTypes:()=>a.Nx,scopeFilterOperatorMap:()=>ue.n,toIconName:()=>ie.Uo,toLiveChannelId:()=>H.Qp});var n=e(58649),a=e(39070),o=e(11261),r=e(41260),i=e(91890),f=e(94624),d=e(73372),l=e(8790),m=e(9557),s=e(64388),h=e(98102),u=e.n(h),q={};for(const fe in h)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType"].indexOf(fe)<0&&(q[fe]=()=>h[fe]);e.d(I,q);var b=e(43127),g=e(50082),P=e(25019),c=e(50349),y=e.n(c),q={};for(const fe in c)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch"].indexOf(fe)<0&&(q[fe]=()=>c[fe]);e.d(I,q);var p=e(49812),v=e.n(p),q={};for(const fe in p)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch"].indexOf(fe)<0&&(q[fe]=()=>p[fe]);e.d(I,q);var D=e(22544),E=e.n(D),q={};for(const fe in D)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch"].indexOf(fe)<0&&(q[fe]=()=>D[fe]);e.d(I,q);var S=e(81010),T=e(37055),M=e(35853),A=e(41987),x=e(40187),C=e(47070),O=e(43429),R=e(12470),L=e(24293),N=e(25137),F=e(62625),K=e(93015),B=e.n(K),q={};for(const fe in K)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch","SpecialValue","TransformationApplicabilityLevels","FieldConfigProperty","isSystemOverride","isSystemOverrideWithRef","patchArrayVectorProrotypeMethods","AppPlugin","CoreApp","FeatureState","DataQueryErrorType","DataSourceApi","DataSourcePlugin","ExploreMode","LanguageProvider","VisualizationSuggestionScore","VisualizationSuggestionsBuilder","VisualizationSuggestionsListAppender","VizOrientation","GrafanaPlugin","PluginErrorCode","PluginIncludeType","PluginSignatureStatus","PluginSignatureType","PluginState","PluginType","VariableHide","VariableRefresh","VariableSort","FALLBACK_COLOR","FieldColorModeId","GrafanaThemeType","OrgRole"].indexOf(fe)<0&&(q[fe]=()=>K[fe]);e.d(I,q);var w=e(38893),U=e.n(w),q={};for(const fe in w)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch","SpecialValue","TransformationApplicabilityLevels","FieldConfigProperty","isSystemOverride","isSystemOverrideWithRef","patchArrayVectorProrotypeMethods","AppPlugin","CoreApp","FeatureState","DataQueryErrorType","DataSourceApi","DataSourcePlugin","ExploreMode","LanguageProvider","VisualizationSuggestionScore","VisualizationSuggestionsBuilder","VisualizationSuggestionsListAppender","VizOrientation","GrafanaPlugin","PluginErrorCode","PluginIncludeType","PluginSignatureStatus","PluginSignatureType","PluginState","PluginType","VariableHide","VariableRefresh","VariableSort","FALLBACK_COLOR","FieldColorModeId","GrafanaThemeType","OrgRole"].indexOf(fe)<0&&(q[fe]=()=>w[fe]);e.d(I,q);var W=e(50219),V=e.n(W),q={};for(const fe in W)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch","SpecialValue","TransformationApplicabilityLevels","FieldConfigProperty","isSystemOverride","isSystemOverrideWithRef","patchArrayVectorProrotypeMethods","AppPlugin","CoreApp","FeatureState","DataQueryErrorType","DataSourceApi","DataSourcePlugin","ExploreMode","LanguageProvider","VisualizationSuggestionScore","VisualizationSuggestionsBuilder","VisualizationSuggestionsListAppender","VizOrientation","GrafanaPlugin","PluginErrorCode","PluginIncludeType","PluginSignatureStatus","PluginSignatureType","PluginState","PluginType","VariableHide","VariableRefresh","VariableSort","FALLBACK_COLOR","FieldColorModeId","GrafanaThemeType","OrgRole"].indexOf(fe)<0&&(q[fe]=()=>W[fe]);e.d(I,q);var _=e(26272),H=e(55004),G=e(29505),j=e(58318),Y=e.n(j),q={};for(const fe in j)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch","SpecialValue","TransformationApplicabilityLevels","FieldConfigProperty","isSystemOverride","isSystemOverrideWithRef","patchArrayVectorProrotypeMethods","AppPlugin","CoreApp","FeatureState","DataQueryErrorType","DataSourceApi","DataSourcePlugin","ExploreMode","LanguageProvider","VisualizationSuggestionScore","VisualizationSuggestionsBuilder","VisualizationSuggestionsListAppender","VizOrientation","GrafanaPlugin","PluginErrorCode","PluginIncludeType","PluginSignatureStatus","PluginSignatureType","PluginState","PluginType","VariableHide","VariableRefresh","VariableSort","FALLBACK_COLOR","FieldColorModeId","GrafanaThemeType","OrgRole","AppEvents","LegacyGraphHoverClearEvent","LegacyGraphHoverEvent","PanelEvents","LiveChannelConnectionState","LiveChannelEventType","LiveChannelScope","LiveChannelType","isLiveChannelJoinEvent","isLiveChannelLeaveEvent","isLiveChannelMessageEvent","isLiveChannelStatusEvent","isValidLiveChannelAddress","parseLiveChannelAddress","toLiveChannelId","CustomVariableSupport","DataSourceVariableSupport","StandardVariableSupport","VariableSupportBase","VariableSupportType"].indexOf(fe)<0&&(q[fe]=()=>j[fe]);e.d(I,q);var oe=e(51527),se=e(43585),ne=e(64367),ee=e.n(ne),q={};for(const fe in ne)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch","SpecialValue","TransformationApplicabilityLevels","FieldConfigProperty","isSystemOverride","isSystemOverrideWithRef","patchArrayVectorProrotypeMethods","AppPlugin","CoreApp","FeatureState","DataQueryErrorType","DataSourceApi","DataSourcePlugin","ExploreMode","LanguageProvider","VisualizationSuggestionScore","VisualizationSuggestionsBuilder","VisualizationSuggestionsListAppender","VizOrientation","GrafanaPlugin","PluginErrorCode","PluginIncludeType","PluginSignatureStatus","PluginSignatureType","PluginState","PluginType","VariableHide","VariableRefresh","VariableSort","FALLBACK_COLOR","FieldColorModeId","GrafanaThemeType","OrgRole","AppEvents","LegacyGraphHoverClearEvent","LegacyGraphHoverEvent","PanelEvents","LiveChannelConnectionState","LiveChannelEventType","LiveChannelScope","LiveChannelType","isLiveChannelJoinEvent","isLiveChannelLeaveEvent","isLiveChannelMessageEvent","isLiveChannelStatusEvent","isValidLiveChannelAddress","parseLiveChannelAddress","toLiveChannelId","CustomVariableSupport","DataSourceVariableSupport","StandardVariableSupport","VariableSupportBase","VariableSupportType","AlertState"].indexOf(fe)<0&&(q[fe]=()=>ne[fe]);e.d(I,q);var Z=e(12463),z=e.n(Z),q={};for(const fe in Z)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch","SpecialValue","TransformationApplicabilityLevels","FieldConfigProperty","isSystemOverride","isSystemOverrideWithRef","patchArrayVectorProrotypeMethods","AppPlugin","CoreApp","FeatureState","DataQueryErrorType","DataSourceApi","DataSourcePlugin","ExploreMode","LanguageProvider","VisualizationSuggestionScore","VisualizationSuggestionsBuilder","VisualizationSuggestionsListAppender","VizOrientation","GrafanaPlugin","PluginErrorCode","PluginIncludeType","PluginSignatureStatus","PluginSignatureType","PluginState","PluginType","VariableHide","VariableRefresh","VariableSort","FALLBACK_COLOR","FieldColorModeId","GrafanaThemeType","OrgRole","AppEvents","LegacyGraphHoverClearEvent","LegacyGraphHoverEvent","PanelEvents","LiveChannelConnectionState","LiveChannelEventType","LiveChannelScope","LiveChannelType","isLiveChannelJoinEvent","isLiveChannelLeaveEvent","isLiveChannelMessageEvent","isLiveChannelStatusEvent","isValidLiveChannelAddress","parseLiveChannelAddress","toLiveChannelId","CustomVariableSupport","DataSourceVariableSupport","StandardVariableSupport","VariableSupportBase","VariableSupportType","AlertState"].indexOf(fe)<0&&(q[fe]=()=>Z[fe]);e.d(I,q);var ie=e(8887),de=e(74135),ue=e(37891)},19484:(Q,I,e)=>{"use strict";e.d(I,{R:()=>n});var n=(a=>(a.Grid="grid",a.List="list",a))(n||{})},26272:(Q,I,e)=>{"use strict";e.d(I,{Tq:()=>f,ee:()=>r,kb:()=>i,r1:()=>o});var n=e(89550),a=e(65463);const o={alertSuccess:(0,n.R)("alert-success"),alertWarning:(0,n.R)("alert-warning"),alertError:(0,n.R)("alert-error")},r={refresh:(0,n.R)("refresh"),componentDidMount:(0,n.R)("component-did-mount"),dataReceived:(0,n.R)("data-received"),dataError:(0,n.R)("data-error"),dataFramesReceived:(0,n.R)("data-frames-received"),dataSnapshotLoad:(0,n.R)("data-snapshot-load"),editModeInitialized:(0,n.R)("init-edit-mode"),initPanelActions:(0,n.R)("init-panel-actions"),initialized:(0,n.R)("panel-initialized"),panelTeardown:(0,n.R)("panel-teardown"),render:(0,n.R)("render")};class i extends a.x{static{this.type="graph-hover"}}class f extends a.a{constructor(){super(...arguments),this.payload={point:{}}}static{this.type="graph-hover-clear"}}},55004:(Q,I,e)=>{"use strict";e.d(I,{Cz:()=>f,DG:()=>m,Qp:()=>h,Z7:()=>l,ZF:()=>o,aj:()=>s,ew:()=>i,jQ:()=>d,o4:()=>r,os:()=>a,qD:()=>n});var n=(u=>(u.DataSource="ds",u.Plugin="plugin",u.Grafana="grafana",u.Stream="stream",u))(n||{}),a=(u=>(u.DataStream="stream",u.DataFrame="frame",u.JSON="json",u))(a||{}),o=(u=>(u.Pending="pending",u.Connected="connected",u.Connecting="connecting",u.Disconnected="disconnected",u.Shutdown="shutdown",u.Invalid="invalid",u))(o||{}),r=(u=>(u.Status="status",u.Join="join",u.Leave="leave",u.Message="message",u))(r||{});function i(u){return u.type==="status"}function f(u){return u.type==="join"}function d(u){return u.type==="leave"}function l(u){return u.type==="message"}function m(u){if(u?.length){let b=u.trim().split("/");if(b.length>=3)return{scope:b[0],namespace:b[1],path:b.slice(2).join("/")}}}function s(u){return!!(u?.path&&u.namespace&&u.scope)}function h(u){if(!u.scope)return"";let b=u.scope;return!u.namespace||(b+="/"+u.namespace,!u.path)?b:b+"/"+u.path}},9557:(Q,I,e)=>{"use strict";e.d(I,{$b:()=>a,Aj:()=>m,FP:()=>u,Nc:()=>s,Ol:()=>d,ZF:()=>f,_0:()=>b,_C:()=>i,cF:()=>l,fY:()=>n.fY,s5:()=>o,tG:()=>r,uH:()=>n.uH,wj:()=>h});var n=e(52622),a=(g=>(g.emerg="critical",g.fatal="critical",g.alert="critical",g.crit="critical",g.critical="critical",g.warn="warning",g.warning="warning",g.err="error",g.eror="error",g.error="error",g.info="info",g.information="info",g.informational="info",g.notice="info",g.dbug="debug",g.debug="debug",g.trace="trace",g.unknown="unknown",g))(a||{});const o={0:"critical",1:"critical",2:"critical",3:"error",4:"warning",5:"info",6:"info",7:"debug"};var r=(g=>(g[g.Number=0]="Number",g[g.String=1]="String",g[g.LabelsMap=2]="LabelsMap",g[g.Error=3]="Error",g))(r||{}),i=(g=>(g.none="No de-duplication",g.exact="De-duplication of successive lines that are identical, ignoring ISO datetimes.",g.numbers="De-duplication of successive lines that are identical when ignoring numbers, e.g., IP addresses, latencies.",g.signature="De-duplication of successive lines that have identical punctuation and whitespace.",g))(i||{}),f=(g=>(g.Backward="BACKWARD",g.Forward="FORWARD",g))(f||{});const d=g=>!g||typeof g!="object"?!1:"getLogRowContext"in g;var l=(g=>(g.LogsVolume="LogsVolume",g.LogsSample="LogsSample",g))(l||{}),m=(g=>(g.FullRange="FullRange",g.Limited="Limited",g))(m||{});const s=(g,P)=>g?("getDataProvider"in g||"getSupplementaryRequest"in g)&&"getSupplementaryQuery"in g&&"getSupportedSupplementaryQueryTypes"in g&&g.getSupportedSupplementaryQueryTypes().includes(P):!1,h=g=>!g||typeof g!="object"?!1:"getLogRowContextUi"in g,u=g=>g!=null&&typeof g=="object"&&"toggleQueryFilter"in g&&"queryHasFilter"in g,b=g=>g!=null&&typeof g=="object"&&"modifyQuery"in g&&"getSupportedQueryModifications"in g},64388:(Q,I,e)=>{"use strict";e.d(I,{k:()=>n});var n=(a=>(a[a.Standard=0]="Standard",a[a.Canvas=1]="Canvas",a[a.Custom=2]="Custom",a))(n||{})},62625:(Q,I,e)=>{"use strict";e.d(I,{X:()=>n});var n=(a=>(a.None="None",a.Viewer="Viewer",a.Editor="Editor",a.Admin="Admin",a))(n||{})},47070:(Q,I,e)=>{"use strict";e.d(I,{NV:()=>d,nQ:()=>i,v2:()=>f,wV:()=>r});var n=e(2543),a=e.n(n),o=e(11261),r=(l=>(l.Auto="auto",l.Vertical="vertical",l.Horizontal="horizontal",l))(r||{}),i=(l=>(l[l.Best=100]="Best",l[l.Good=70]="Good",l[l.OK=50]="OK",l))(i||{});class f{constructor(m,s){this.list=[],this.data=m,this.panel=s,this.dataSummary=this.computeDataSummary()}getListAppender(m){return new d(this.list,m)}computeDataSummary(){const m=this.data?.series||[];let s=0,h=0,u=0,b=0,g=0,P=0,c;for(const y of m){b+=y.length,y.meta?.preferredVisualisationType&&(c=y.meta.preferredVisualisationType);for(const p of y.fields)switch(P++,p.type){case o.PU.number:s+=1;break;case o.PU.time:h+=1;break;case o.PU.string:u+=1;break}y.length>g&&(g=y.length)}return{numberFieldCount:s,timeFieldCount:h,stringFieldCount:u,rowCountTotal:b,rowCountMax:g,fieldCount:P,preferredVisualisationType:c,frameCount:m.length,hasData:b>0,hasTimeField:h>0,hasNumberField:s>0,hasStringField:u>0}}getList(){return this.list}}class d{constructor(m,s){this.list=m,this.defaults=s}append(m){this.list.push((0,n.defaultsDeep)(m,this.defaults))}}},43429:(Q,I,e)=>{"use strict";e.d(I,{Ac:()=>o,QE:()=>a,Ud:()=>d,ZK:()=>i,ib:()=>f,kv:()=>r,pn:()=>n});var n=(l=>(l.alpha="alpha",l.beta="beta",l.stable="stable",l.deprecated="deprecated",l))(n||{}),a=(l=>(l.panel="panel",l.datasource="datasource",l.app="app",l.renderer="renderer",l.secretsmanager="secretsmanager",l))(a||{}),o=(l=>(l.internal="internal",l.valid="valid",l.invalid="invalid",l.modified="modified",l.missing="missing",l))(o||{}),r=(l=>(l.grafana="grafana",l.commercial="commercial",l.community="community",l.private="private",l.core="core",l))(r||{}),i=(l=>(l.missingSignature="signatureMissing",l.invalidSignature="signatureInvalid",l.modifiedSignature="signatureModified",l.failedBackendStart="failedBackendStart",l.angular="angular",l))(i||{}),f=(l=>(l.dashboard="dashboard",l.page="page",l.panel="panel",l.datasource="datasource",l))(f||{});class d{addConfigPage(m){return this.configPages||(this.configPages=[]),this.configPages.push(m),this}setChannelSupport(){return console.warn("[deprecation] plugin is using ignored option: setChannelSupport",this.meta),this}constructor(){this.meta={}}}},74135:(Q,I,e)=>{"use strict";e.d(I,{S:()=>a,u:()=>n});var n=(o=>(o.link="link",o.component="component",o))(n||{}),a=(o=>(o.AlertInstanceAction="grafana/alerting/instance/action",o.AlertingHomePage="grafana/alerting/home",o.AlertingAlertingRuleAction="grafana/alerting/alertingrule/action",o.AlertingRecordingRuleAction="grafana/alerting/recordingrule/action",o.CommandPalette="grafana/commandpalette/action",o.DashboardPanelMenu="grafana/dashboard/panel/menu",o.DataSourceConfig="grafana/datasources/config",o.ExploreToolbarAction="grafana/explore/toolbar/action",o.UserProfileTab="grafana/user/profile/tab",o))(a||{})},51527:(Q,I,e)=>{"use strict";e.d(I,{x:()=>a});var n=e(43429);function a(o){return o&&o!==n.Ac.valid&&o!==n.Ac.internal}},73372:(Q,I,e)=>{"use strict";e.d(I,{D_:()=>a,Ee:()=>r,FL:()=>o,QR:()=>n.QR});var n=e(52622),a=(i=>(i.Equal="Equal",i.NotEqual="NotEqual",i.EqualRegEx="EqualRegEx",i.NotEqualRegEx="NotEqualRegEx",i))(a||{});const o=i=>!i||typeof i!="object"?!1:"importFromAbstractQueries"in i,r=i=>!i||typeof i!="object"?!1:"exportToAbstractQueries"in i},37891:(Q,I,e)=>{"use strict";e.d(I,{n:()=>n});const n={"=":"equals","!=":"not-equals","=~":"regex-match","!~":"regex-not-match"}},98102:()=>{"use strict"},64367:()=>{"use strict"},12470:(Q,I,e)=>{"use strict";e.d(I,{CO:()=>n,ZG:()=>a,zL:()=>o});var n=(r=>(r[r.never=0]="never",r[r.onDashboardLoad=1]="onDashboardLoad",r[r.onTimeRangeChanged=2]="onTimeRangeChanged",r))(n||{}),a=(r=>(r[r.disabled=0]="disabled",r[r.alphabeticalAsc=1]="alphabeticalAsc",r[r.alphabeticalDesc=2]="alphabeticalDesc",r[r.numericalAsc=3]="numericalAsc",r[r.numericalDesc=4]="numericalDesc",r[r.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",r[r.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",r[r.naturalAsc=7]="naturalAsc",r[r.naturalDesc=8]="naturalDesc",r))(a||{}),o=(r=>(r[r.dontHide=0]="dontHide",r[r.hideLabel=1]="hideLabel",r[r.hideVariable=2]="hideVariable",r))(o||{})},25137:(Q,I,e)=>{"use strict";e.d(I,{I:()=>n});var n=(a=>(a.Light="light",a.Dark="dark",a))(n||{})},50082:(Q,I,e)=>{"use strict";e.d(I,{O:()=>n});var n=(a=>(a.Absolute="absolute",a.Percentage="percentage",a))(n||{})},43127:(Q,I,e)=>{"use strict";e.d(I,{Cn:()=>f,E2:()=>i,G$:()=>r,HW:()=>d,lE:()=>o});var n=e(52622),a=e(47232);const o=n.vp,r="YYYY-MM-DD HH:mm:ss";function i(){const l=(0,a.KQ)();return{from:(0,a.KQ)(l).subtract(6,"hour"),to:l,raw:{from:"now-6h",to:"now"}}}function f(){return{from:600,to:0}}function d(l,m){const s=typeof l=="string"?(0,a.KQ)(l):l,h=typeof m=="string"?(0,a.KQ)(m):m;return{from:s,to:h,raw:{from:s,to:h}}}},38893:()=>{"use strict"},81010:(Q,I,e)=>{"use strict";e.d(I,{M:()=>n,N:()=>a});var n=(o=>(o[o.NotPossible=-1]="NotPossible",o[o.NotApplicable=0]="NotApplicable",o[o.Applicable=1]="Applicable",o[o.HighlyApplicable=2]="HighlyApplicable",o))(n||{}),a=(o=>(o.True="true",o.False="false",o.Null="null",o.Empty="empty",o))(a||{})},25019:(Q,I,e)=>{"use strict";e.d(I,{W:()=>a,d:()=>n});var n=(o=>(o.ValueToText="value",o.RangeToText="range",o.RegexToText="regex",o.SpecialValue="special",o))(n||{}),a=(o=>(o.True="true",o.False="false",o.Null="null",o.NaN="nan",o.NullAndNaN="null+nan",o.Empty="empty",o))(a||{})},29505:(Q,I,e)=>{"use strict";e.d(I,{J$:()=>o,Qz:()=>n,ZV:()=>i,f5:()=>r,xi:()=>a});var n=(f=>(f.Legacy="legacy",f.Standard="standard",f.Custom="custom",f.Datasource="datasource",f))(n||{});class a{}class o extends a{getType(){return"standard"}}class r extends a{getType(){return"custom"}}class i extends a{getType(){return"datasource"}}},35853:(Q,I,e)=>{"use strict";e.d(I,{V:()=>n});function n(){Object.getOwnPropertyDescriptor(Array.prototype,"toArray")||Object.defineProperties(Array.prototype,{get:{value:function(a){return this[a]},writable:!0,enumerable:!1,configurable:!0},set:{value:function(a,o){this[a]=o},writable:!0,enumerable:!1,configurable:!0},add:{value:function(a){this.push(a)},writable:!0,enumerable:!1,configurable:!0},toArray:{value:function(){return this},writable:!0,enumerable:!1,configurable:!0}})}n()},60264:(Q,I,e)=>{"use strict";e.d(I,{bk:()=>d,pv:()=>s,iF:()=>m});var n=e(2543),a=e(69550),o=e(27310),r=e(39070),i=e(83077);class f{constructor(){this.properties=[]}addCustomEditor(u){return this.properties.push(u),this}getRegistry(){return new i.O(()=>this.properties)}getItems(){return this.properties}}class d extends f{addNumberInput(u){return this.addCustomEditor({...u,id:u.path,override:a.D.get("number").editor,editor:a.D.get("number").editor,process:o.m0,shouldApply:u.shouldApply??(()=>!0),settings:u.settings||{}})}addSliderInput(u){return this.addCustomEditor({...u,id:u.path,override:a.D.get("slider").editor,editor:a.D.get("slider").editor,process:o.m0,shouldApply:u.shouldApply??(()=>!0),settings:u.settings||{}})}addTextInput(u){return this.addCustomEditor({...u,id:u.path,override:a.D.get("text").editor,editor:a.D.get("text").editor,process:o.OU,shouldApply:u.shouldApply??(()=>!0),settings:u.settings||{}})}addSelect(u){return this.addCustomEditor({...u,id:u.path,override:a.D.get("select").editor,editor:a.D.get("select").editor,process:o.hL,shouldApply:u.shouldApply?u.shouldApply:()=>!0,settings:u.settings||{options:[]}})}addRadio(u){return this.addCustomEditor({...u,id:u.path,override:a.D.get("radio").editor,editor:a.D.get("radio").editor,process:o.hL,shouldApply:u.shouldApply?u.shouldApply:()=>!0,settings:u.settings||{options:[]}})}addBooleanSwitch(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("boolean").editor,override:a.D.get("boolean").editor,process:o.FM,shouldApply:u.shouldApply?u.shouldApply:()=>!0,settings:u.settings||{}})}addColorPicker(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("color").editor,override:a.D.get("color").editor,process:o.hS,shouldApply:u.shouldApply?u.shouldApply:()=>!0,settings:u.settings||{}})}addUnitPicker(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("unit").editor,override:a.D.get("unit").editor,process:o.lG,shouldApply:u.shouldApply?u.shouldApply:()=>!0,settings:u.settings||{}})}addFieldNamePicker(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("field-name").editor,override:a.D.get("field-name").editor,process:o.hS,shouldApply:u.shouldApply?u.shouldApply:()=>!0,settings:u.settings||{}})}addGenericEditor(u,b){return this.addCustomEditor({...u,id:u.path,editor:b,override:b,process:o.hS,shouldApply:u.shouldApply?u.shouldApply:()=>!0,settings:u.settings||{}})}}class l{constructor(u){this.cfg=u,this.path="",this.id="nested-panel-options",this.name="nested",this.editor=()=>null,this.getBuilder=()=>this.cfg.build,this.getNestedValueAccess=b=>{const g=this.cfg.values;return g?g(b):{getValue:P=>b.getValue(`${this.path}.${P}`),onChange:(P,c)=>b.onChange(`${this.path}.${P}`,c)}},this.path=u.path,this.category=u.category,this.defaultValue=this.getDefaultValue(u)}getDefaultValue(u){let b=(0,r.Gv)(u.defaultValue)?(0,n.cloneDeep)(u.defaultValue):{};const g=new s;u.build(g,{data:[]});for(const P of g.getItems())P.defaultValue!=null&&(0,n.set)(b,P.path,P.defaultValue);return b}}function m(h){return(0,r.Gv)(h)&&"id"in h&&h.id==="nested-panel-options"}class s extends f{addNestedOptions(u){const b=new l(u);return this.addCustomEditor(b)}addNumberInput(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("number").editor})}addSliderInput(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("slider").editor})}addTextInput(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("text").editor})}addStringArray(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("strings").editor})}addSelect(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("select").editor})}addMultiSelect(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("multi-select").editor})}addRadio(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("radio").editor})}addBooleanSwitch(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("boolean").editor})}addColorPicker(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("color").editor,settings:u.settings||{}})}addTimeZonePicker(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("timezone").editor,settings:u.settings||{}})}addUnitPicker(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("unit").editor})}addFieldNamePicker(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("field-name").editor})}addDashboardPicker(u){return this.addCustomEditor({...u,id:u.path,editor:a.D.get("dashboard-uid").editor})}}},28802:(Q,I,e)=>{"use strict";e.d(I,{t:()=>o});var n=e(2543),a=e.n(n);function o(r){return typeof r=="number"?r:r===""||r===null||r===void 0||Array.isArray(r)?NaN:typeof r=="boolean"?r?1:0:(0,n.toNumber)(r)}},14588:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{insertAfterImmutably:()=>r,insertBeforeImmutably:()=>o,moveItemImmutably:()=>a,sortValues:()=>d});var n=e(52622);function a(l,m,s){const h=[...l];return Array.prototype.splice.call(h,s,0,Array.prototype.splice.call(h,m,1)[0]),h}function o(l,m,s){if(s<0||s>l.length)throw new Error("Index out of bounds");const h=[...l];return h.splice(s,0,m),h}function r(l,m,s){if(s<0||s>l.length)throw new Error("Index out of bounds");const h=[...l];return h.splice(s+1,0,m),h}const i=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),f=(l,m)=>l-m;function d(l){return(m,s)=>{if(m===s)return 0;if(s==null||typeof s=="string"&&s.trim()==="")return-1;if(m==null||typeof m=="string"&&m?.trim()==="")return 1;let h=i.compare;return typeof m=="number"&&typeof s=="number"&&(h=f),l===n.xB.Descending?h(s,m):h(m,s)}}},11710:(Q,I,e)=>{"use strict";e.d(I,{b:()=>o,k:()=>a});var n=e(83077),a=(r=>(r.Add="+",r.Subtract="-",r.Divide="/",r.Multiply="*",r))(a||{});const o=new n.O(()=>[{id:"+",name:"Add",operation:(r,i)=>r+i,binaryOperationID:"+"},{id:"-",name:"Subtract",operation:(r,i)=>r-i,binaryOperationID:"-"},{id:"*",name:"Multiply",operation:(r,i)=>r*i,binaryOperationID:"*"},{id:"/",name:"Divide",operation:(r,i)=>r/i,binaryOperationID:"/"}])},72436:(Q,I,e)=>{"use strict";e.d(I,{F7:()=>s,Jh:()=>h,_O:()=>p,i8:()=>b});var n=e(2543),a=e.n(n),o=e(44809),r=e.n(o),i=e(37471),f=e(14236),d=e(28240),l=e(11261),m=e(83195),s=(v=>(v[v.full=0]="full",v[v.name=1]="name",v[v.none=2]="none",v))(s||{});function h(v,D){return new b(D).readCSV(v)}var u=(v=>(v[v.Starting=0]="Starting",v[v.InHeader=1]="InHeader",v[v.ReadingRows=2]="ReadingRows",v))(u||{});class b{constructor(D){this.chunk=(E,S)=>{for(let T=0;T<E.data.length;T++){const M=E.data[T];if(M.length<1)continue;const A=M[0];if(A){if(A.startsWith("#")){const x=A.indexOf("#",2);if(x>0){const C=A.slice(1,x),O=C==="name";if(O||{unit:"#"}.hasOwnProperty(C)){this.state===2&&(this.current=new i.k({fields:[]}),this.data.push(this.current));const L=A.slice(x+1);if(O){this.current.addFieldFor(void 0,L);for(let N=1;N<M.length;N++)this.current.addFieldFor(void 0,M[N])}else{const{fields:N}=this.current;for(let F=0;F<N.length;F++){N[F].config||(N[F].config={});const K=N[F].config;K[C]=F===0?L:M[F]}}this.state=1;continue}}else if(this.state===0){this.state=1;continue}continue}if(this.state===0){if((0,f.HW)(A)===l.PU.string){for(const C of M)this.current.addFieldFor(void 0,C);this.state=1;continue}this.state=1}}if(this.state,this.state=2,M.length>this.current.fields.length){const{fields:x}=this.current;for(let C=x.length;C<M.length;C++)this.current.addFieldFor(M[C]);this.callback&&this.callback.onHeader(this.current.fields)}this.current.appendRow(M),this.callback&&this.callback.onRow(M)}},D||(D={}),this.config=D.config||{},this.callback=D.callback,this.current=new i.k({fields:[]}),this.state=0,this.data=[]}readCSV(D){this.current=new i.k({fields:[]}),this.data=[this.current];const E={...this.config,dynamicTyping:!1,skipEmptyLines:!0,comments:!1,chunk:this.chunk};return r().parse(D,E),this.data}}function g(v,D){if(v==null)return"";const E=v.toString();return E.includes('"')?D.quoteChar+E.replace(/"/gi,'""')+D.quoteChar:E.includes(`
`)||D.delimiter&&E.includes(D.delimiter)?D.quoteChar+E+D.quoteChar:E}function P(v,D){return v.display?E=>{const S=v.display(E);return g((0,m.cN)(S),D)}:E=>g(E,D)}function c(v,D,E){const S=v==="name",T=v==="type";for(const M of D){const A=M.config;if(S||T||A&&A.hasOwnProperty(v)){let x="#"+v+"#";for(let C=0;C<D.length;C++){C>0&&(x=x+E.delimiter);let O=D[C].name;T?O=D[C].type:S||(O=D[C].config[v]),O&&(x=x+g(O,E))}return x+E.newline}}return""}function y(){const v=["x","y"];return v.toLocaleString?v.toLocaleString().charAt(1):","}function p(v,D){if(!v)return"";D=(0,n.defaults)(D,{delimiter:y(),newline:`\r
`,quoteChar:'"',encoding:"",headerStyle:1,useExcelHeader:!1});let E=D.useExcelHeader?`sep=${D.delimiter}${D.newline}`:"";for(let S=0;S<v.length;S++){const T=v[S],{fields:M}=T;if(M.length===0)continue;if(D.headerStyle===0)E=E+c("name",M,D)+c("type",M,D)+c("unit",M,D)+c("dateFormat",M,D);else if(D.headerStyle===1){for(let x=0;x<M.length;x++)x>0&&(E+=D.delimiter),E+=`"${(0,d.Ct)(M[x],T).replace(/"/g,'""')}"`;E+=D.newline}const A=M[0].values.length;if(A>0){const x=M.map(C=>P(C,D));for(let C=0;C<A;C++){for(let O=0;O<M.length;O++){O>0&&(E=E+D.delimiter);const R=M[O].values[C];R!==null&&(E=E+x[O](R))}C!==A-1&&(E=E+D.newline)}}S!==v.length-1&&(E=E+D.newline)}return E}},6709:(Q,I,e)=>{"use strict";e.d(I,{c:()=>o,u:()=>r});var n=e(71733),a=e(76885);const o={keepTime:"__url_time_range",timeRangeFrom:"__from",timeRangeTo:"__to",includeVars:"__all_variables",seriesName:"__series.name",fieldName:"__field.name",valueTime:"__value.time",valueNumeric:"__value.numeric",valueText:"__value.text",valueRaw:"__value.raw",valueCalc:"__value.calc"};function r(l){const{onClickFn:m,replaceVariables:s,link:h,scopedVars:u,range:b,field:g,internalLink:P}=l,c=f(h.internal?.query,u,s),y=f(h.internal?.panelsState,u,s),p=f(h.internal?.meta?.correlationData,u,s),v=h.title?h.title:P.datasourceName;return{title:s(v,u),href:i(P.datasourceUid,c,b,y),onClick:m?D=>{D.preventDefault&&D.preventDefault(),m({datasourceUid:P.datasourceUid,queries:[c],panelsState:y,correlationHelperData:p,range:b})}:void 0,target:h?.targetBlank?"_blank":"_self",origin:g}}function i(l,m,s,h){return n.I.assureBaseUrl(`/explore?left=${encodeURIComponent((0,a.Pp)({...s?.raw?{range:(0,a.sQ)(s.raw)}:{},datasource:l,queries:[m],panelsState:h}))}`)}function f(l,m,s){if(!l)return l;if(typeof l=="string")return s(l,m);const h=JSON.parse(JSON.stringify(l));return d(h,m,s)}function d(l,m,s){for(const h of Object.keys(l))typeof l[h]=="string"?l[h]=s(l[h],m):typeof l[h]=="object"&&l[h]!==null&&(l[h]=d(l[h],m,s));return l}},22391:(Q,I,e)=>{"use strict";e.d(I,{BD:()=>m,EX:()=>s,Iz:()=>i,PG:()=>d,QP:()=>c,fN:()=>r,lO:()=>g,mn:()=>l,p$:()=>o,pN:()=>b,wY:()=>h,wp:()=>P,yV:()=>u,zX:()=>f});var n=e(2543),a=e.n(n);function o(y){return{uid:y.uid,type:y.type}}function r(y){return typeof y=="object"&&typeof y?.uid=="string"}function i(y){if(r(y))return y.uid;if((0,n.isString)(y))return y}const f=(y,p)=>v=>{b(y,p,v.currentTarget.value)},d=(y,p)=>v=>{g(y,p,v.currentTarget.value)},l=(y,p)=>v=>{P(y,p,v.currentTarget.value)},m=(y,p)=>v=>{g(y,p,v.value)},s=(y,p)=>v=>{g(y,p,v.currentTarget.checked)},h=(y,p)=>v=>{P(y,p,v.value)},u=(y,p)=>v=>{c(y,p)};function b(y,p,v){const D=y.options;y.onOptionsChange({...D,[p]:v})}const g=(y,p,v)=>{const D=y.options;y.onOptionsChange({...D,jsonData:{...D.jsonData,[p]:v}})},P=(y,p,v)=>{const D=y.options;y.onOptionsChange({...D,secureJsonData:{...D.secureJsonData?D.secureJsonData:{},[p]:v}})},c=(y,p)=>{const v=y.options;y.onOptionsChange({...v,secureJsonData:{...v.secureJsonData?v.secureJsonData:{},[p]:""},secureJsonFields:{...v.secureJsonFields,[p]:!1}})}},95344:(Q,I,e)=>{"use strict";e.d(I,{l:()=>a});const n={},a=(o,r,i)=>{let f=`[Deprecation warning] ${o}: ${r} is deprecated`;i&&(f+=`. Use ${i} instead`);const d=Date.now(),l=n[f];(!l||d-l>1e4)&&(console.warn(f),n[f]=d)}},87885:(Q,I,e)=>{"use strict";e.d(I,{f:()=>n});var n=(a=>(a[a.Transformations=0]="Transformations",a[a.FieldConfig=1]="FieldConfig",a[a.FieldConfigOverrides=2]="FieldConfigOverrides",a))(n||{})},39306:(Q,I,e)=>{"use strict";e.d(I,{R:()=>a,r:()=>o});var n=e(39070);function a({xField:r,yField:i,nullValueMode:f}){const d=r.values,l=i.values,m=d.length;if(l.length!==m)throw new Error("Unexpected field length");const s=f===n.UW.Ignore,h=f===n.UW.AsZero,u=[];for(let b=0;b<m;b++){const g=d[b];let P=l[b];if(P===null){if(s)continue;h&&(P=0)}g!==null&&u.push([g,P])}return u}function o(r,i){if(!i.from||!i.to||!r||r.length===0)return[];const f=i.from.valueOf(),d=i.to.valueOf(),l=r[0][1];return[[f,l],[d,l]]}},94032:(Q,I,e)=>{"use strict";e.d(I,{kP:()=>u.k,F7:()=>i.F7,i8:()=>i.i8,cI:()=>D.c,fu:()=>E.f,bk:()=>c.bk,An:()=>A.An,uc:()=>g.u,pv:()=>c.pv,OR:()=>a.O,_G:()=>b._,to:()=>T.t,XC:()=>n,bP:()=>u.b,tj:()=>m,Eg:()=>x.E,bh:()=>A.bh,lt:()=>r.l,yO:()=>f.yO,s6:()=>f.s6,h6:()=>f.h6,p$:()=>o.p$,Iz:()=>o.Iz,RZ:()=>y.R,rG:()=>y.r,cs:()=>x.c,tY:()=>s,E6:()=>d.E,dO:()=>h,fN:()=>o.fN,RI:()=>l.R,Ig:()=>p.I,Yi:()=>S.Y,uS:()=>D.u,_p:()=>f._p,_8:()=>O._,wm:()=>l.w,PG:()=>o.PG,EX:()=>o.EX,BD:()=>o.BD,zX:()=>o.zX,yV:()=>o.yV,mn:()=>o.mn,wY:()=>o.wY,Xy:()=>f.Xy,Jh:()=>i.Jh,j_:()=>C.j,hB:()=>d.h,Pp:()=>v.Pp,_O:()=>i._O,zL:()=>P.z,sQ:()=>v.sQ,j7:()=>b.j,lO:()=>o.lO,pN:()=>o.pN,QP:()=>o.QP,wp:()=>o.wp,kM:()=>v.kM,kz:()=>M.k});var n=e(14588),a=e(83077),o=e(22391),r=e(95344),i=e(72436),f=e(8249),d=e(97706),l=e(92041);const m=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"],s=R=>{let L,N,F=Number.MAX_VALUE;for(let K=0;K<R.values.length;K++){const B=R.values[K];if(L!==void 0){const w=B-L;N===void 0&&(F=w),w<F&&(F=w)}L=B}return F},h=R=>{for(let L=0;L<R.values.length;L++){const N=R.values[L];if(N!=null){const F=N.toString();if(F.length===13&&F%1e3!==0)return!0}}return!1};var u=e(11710),b=e(27618),g=e(25352),P=e(50877),c=e(60264),y=e(39306),p=e(71733),v=e(76885),D=e(6709),E=e(87885),S=e(92341),T=e(28802),M=e(72495),A=e(62398),x=e(92053),C=e(43659),O=e(80147)},8249:(Q,I,e)=>{"use strict";e.d(I,{Xy:()=>a,_p:()=>i,h6:()=>f,s6:()=>r,yO:()=>o});const n=/\b(\w+)(!?=~?)"([^"\n]*?)"/g;function a(d){const l={};return d.replace(n,(m,s,h,u)=>(l[s]=u,"")),l}function o(d){return d.reduce((l,m)=>{if(!m)throw new Error("Need parsed labels to find common labels.");return Object.keys(m).forEach(s=>{(l[s]===void 0||l[s]!==m[s])&&delete l[s]}),Object.keys(l).forEach(s=>{m[s]===void 0&&delete l[s]}),l},{...d[0]})}function r(d,l){const m={...d};return Object.keys(l).forEach(s=>{delete m[s]}),m}function i(d,l){if(!d)return!0;for(const[m,s]of Object.entries(d))if(!l||l[m]!==s)return!1;return!0}function f(d,l="",m){if(!d||Object.keys(d).length===0)return l;const h=Object.keys(d).sort().map(u=>`${u}="${d[u]}"`).join(", ");return m?h:["{",h,"}"].join("")}},71733:(Q,I,e)=>{"use strict";e.d(I,{I:()=>h});var n=e(40672),a=e(76885);let o={appSubUrl:""},r,i;const f=u=>{try{return new URL(u)}catch{return}},d=u=>{const b=f(u);if(b&&b.origin!==window.location.origin)return u;const g=o.appSubUrl??"",P=g.endsWith("/")?1:0,c=u.startsWith("http");let y=g;return(!u.startsWith("/")||c)&&(y=`${window.location.origin}${g}`),u.length>0&&(u.indexOf(y+"/")===0||u===y)?u.slice(y.length-P):u},l=u=>u.startsWith("/")?`${o.appSubUrl}${d(u)}`:u,h={initialize:u=>{o=u.config,r=u.getTimeRangeForUrl,i=u.getVariablesUrlParams},stripBaseFromUrl:d,assureBaseUrl:l,updateSearchParams:(u,b)=>{const g=new URLSearchParams(b);try{const P=new URL(u);return g.forEach((c,y)=>P.searchParams.set(y,c)),P.href}catch{const P=new URLSearchParams(u);return g.forEach((c,y)=>{P.set(y,c)}),"?"+P.toString()}},getTimeRangeUrlParams:()=>r?a.kM.toUrlParams(r()):null,getVariablesUrlParams:u=>{if(!i)return null;const b=i(u);return a.kM.toUrlParams(b)},getUrlForPartial:(u,b)=>{const g=a.kM.parseKeyValue(u.search.startsWith("?")?u.search.substring(1):u.search);for(const P in b)b[P]===null||b[P]===void 0?delete g[P]:g[P]=b[P];return l(a.kM.renderUrl(u.pathname,g))},processUrl:u=>o.disableSanitizeHtml?u:n.sQ.sanitizeUrl(u)}},92341:(Q,I,e)=>{"use strict";e.d(I,{Y:()=>n});function n(a){return new Proxy(a,{apply(o,r,i){return(typeof Reflect>"u"||!Reflect.construct)&&alert("Browser is too old"),Reflect.construct(o,i,r.constructor)}})}},80147:(Q,I,e)=>{"use strict";e.d(I,{_:()=>n});function n(a,o){return o.id===a?!0:o.aliasIDs?o.aliasIDs.includes(a):!1}},25352:(Q,I,e)=>{"use strict";e.d(I,{u:()=>n});var n=(a=>(a.id="id",a.title="title",a.subTitle="subtitle",a.mainStat="mainstat",a.secondaryStat="secondarystat",a.arc="arc__",a.icon="icon",a.color="color",a.source="source",a.target="target",a.detail="detail__",a.nodeRadius="noderadius",a.thickness="thickness",a.highlighted="highlighted",a.strokeDasharray="strokedasharray",a.fixedX="fixedx",a.fixedY="fixedy",a))(n||{})},97706:(Q,I,e)=>{"use strict";e.d(I,{E:()=>a,h:()=>n});function n(o,r=0){if(Number.isInteger(o))return o;let i=10**r,f=o*i*(1+Number.EPSILON);return Math.round(f)/i}function a(o){return((""+o).split(".")[1]||"").length}},92041:(Q,I,e)=>{"use strict";e.d(I,{R:()=>a,w:()=>n});const n=o=>Object.keys(o).reduce((r,i)=>(o[i]!==void 0&&(r[i]=o[i]),r),{}),a=o=>typeof o=="object"&&o!==null&&Object.keys(o).length===0},50877:(Q,I,e)=>{"use strict";e.d(I,{z:()=>n});const n=a=>({label:a,value:a})},27618:(Q,I,e)=>{"use strict";e.d(I,{_:()=>a,j:()=>o});var n=e(83077),a=(r=>(r.Abs="abs",r.Exp="exp",r.Ln="ln",r.Floor="floor",r.Ceil="ceil",r))(a||{});const o=new n.O(()=>[{id:"abs",name:"Absolute value",operation:r=>Math.abs(r),unaryOperationID:"abs"},{id:"exp",name:"Natural exponent",operation:r=>Math.exp(r),unaryOperationID:"exp"},{id:"ln",name:"Natural logarithm",operation:r=>Math.log(r),unaryOperationID:"ln"},{id:"floor",name:"Floor",operation:r=>Math.floor(r),unaryOperationID:"floor"},{id:"ceil",name:"Ceiling",operation:r=>Math.ceil(r),unaryOperationID:"ceil"}])},76885:(Q,I,e)=>{"use strict";e.d(I,{Pp:()=>h,kM:()=>s,sQ:()=>u});var n=e(47232);/**
 * @preserve jquery-param (c) 2015 KNOWLEDGECODE | MIT
 */function a(b,g){return g&&Object.keys(g).length>0&&(b+="?"+r(g)),b}function o(b,g){return encodeURIComponent(b).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,g?"%20":"+").replace(/[!'()*]/g,function(P){return"%"+P.charCodeAt(0).toString(16).toUpperCase()})}function r(b,g=!0){const P=[],c=/\[\]$/,y=g?(E,S)=>o(E,S):(E,S)=>encodeURIComponent(E),p=E=>Object.prototype.toString.call(E)==="[object Array]",v=(E,S)=>{if(S=typeof S=="function"?S():S===null||S===void 0?"":S,typeof S!="boolean")P[P.length]=y(E,!0)+"="+y(S,!0);else{const T=S?"":"="+y("false",!0);P[P.length]=y(E,!0)+T}},D=(E,S)=>{let T,M,A;if(E)if(p(S))for(T=0,M=S.length;T<M;T++)c.test(E)?v(E,S[T]):D(E,S[T]);else if(S&&String(S)==="[object Object]")for(A in S)D(E+"["+A+"]",S[A]);else v(E,S);else if(p(S))for(T=0,M=S.length;T<M;T++)v(S[T].name,S[T].value);else for(A in S)D(A,S[A]);return P};return D("",b).join("&")}function i(b){return r(b,!1)}function f(b,g){if(g!=null&&g!==""){const P=b.indexOf("?");P!==-1?b.length-P>1&&(b+="&"):b+="?",b+=g}return b}function d(){const g=window.location.search.substring(1).split("&"),P={};for(const c of g){const y=c.split("=");if(y.length>1){const p=decodeURIComponent(y[0]),v=decodeURIComponent(y[1]);p in P?P[p]=[...P[p],v]:P[p]=[v]}else if(y.length===1){const p=decodeURIComponent(y[0]);P[p]=!0}}return P}function l(b){const g={},P=(b||"").split("&");for(let c of P){let y,p,v;if(c&&(p=c=c.replace(/\+/g,"%20"),y=c.indexOf("="),y!==-1&&(p=c.substring(0,y),v=c.substring(y+1)),p=m(p),p!==void 0)){v=v!==void 0?m(v):!0;let D;typeof v=="string"&&v!==""?D=v==="true"||v==="false"?v==="true":v:D=v,g.hasOwnProperty(p)?Array.isArray(g[p])?g[p].push(v):g[p]=[g[p],isNaN(D)?v:D]:g[p]=isNaN(D)?v:D}}return g}function m(b){try{return decodeURIComponent(b)}catch{return}}const s={renderUrl:a,toUrlParams:r,appendQueryToUrl:f,getUrlSearchParams:d,parseKeyValue:l,serializeParams:i};function h(b,g){return g!==void 0&&console.warn("`compact` parameter is deprecated and will be removed in a future release"),JSON.stringify(b)}const u=b=>{let g=b.from;(0,n.Ar)(g)&&(g=g.valueOf().toString());let P=b.to;return(0,n.Ar)(P)&&(P=P.valueOf().toString()),{from:g,to:P}}},62398:(Q,I,e)=>{"use strict";e.d(I,{An:()=>f,Zz:()=>r,bh:()=>d});var n=e(47737),a=e(54479),o=e(25019);function r(m,s){for(const h of m)switch(h.type){case o.d.ValueToText:if(s==null)continue;const u=h.options[s];if(u)return u;break;case o.d.RangeToText:if(s==null)continue;const b=parseFloat(s);if(isNaN(b)||!isNaN(h.options.from)&&b<h.options.from||!isNaN(h.options.to)&&b>h.options.to)continue;return h.options.result;case o.d.RegexToText:if(s==null||typeof s!="string")continue;const c=(0,a.dO)(h.options.pattern);if(s.match(c)){const y={...h.options.result};return y.text!=null&&(y.text=s.replace(c,h.options.result.text||"")),y}case o.d.SpecialValue:switch(h.options.match){case o.W.Null:{if(s==null)return h.options.result;break}case o.W.NaN:{if(typeof s=="number"&&isNaN(s))return h.options.result;break}case o.W.NullAndNaN:{if(typeof s=="number"&&isNaN(s)||s==null)return h.options.result;break}case o.W.True:{if(s===!0||s==="true")return h.options.result;break}case o.W.False:{if(s===!1||s==="false")return h.options.result;break}case o.W.Empty:{if(s==="")return h.options.result;break}}}return null}function i(m){return(typeof m=="number"||typeof m=="string"&&m.trim()!=="")&&!isNaN(m)}var f=(m=>(m[m.ValueToText=1]="ValueToText",m[m.RangeToText=2]="RangeToText",m))(f||{});function d(m,s){const h=[];let u=m.mappingType;if(m.mappingType||(m.valueMaps&&m.valueMaps.length?u=1:m.rangeMaps&&m.rangeMaps.length&&(u=2)),u===1)for(let b=0;b<m.valueMaps.length;b++){const g=m.valueMaps[b];h.push(l({...g,id:b,type:o.d.ValueToText},m.fieldConfig?.defaults?.thresholds||s))}else if(u===2)for(let b=0;b<m.rangeMaps.length;b++){const g=m.rangeMaps[b];h.push(l({...g,id:b,type:o.d.RangeToText},m.fieldConfig?.defaults?.thresholds||s))}return h}function l(m,s){const h={type:o.d.ValueToText,options:{}},u=[];let b;const g=parseFloat(m.text);if(s&&!isNaN(g)){const P=(0,n.yQ)(g,s.steps);P&&P.color&&(b=P.color)}switch(m.type){case 1:case o.d.ValueToText:m.value!=null&&(m.value==="null"?u.push({type:o.d.SpecialValue,options:{match:o.W.Null,result:{text:m.text,color:b}}}):h.options[String(m.value)]={text:m.text,color:b});break;case 2:case o.d.RangeToText:m.from==="null"||m.to==="null"?u.push({type:o.d.SpecialValue,options:{match:o.W.Null,result:{text:m.text,color:b}}}):u.push({type:o.d.RangeToText,options:{from:+m.from,to:+m.to,result:{text:m.text,color:b}}});break}return Object.keys(h.options).length>0&&u.unshift(h),u[0]}},92053:(Q,I,e)=>{"use strict";e.d(I,{E:()=>a,c:()=>o});const n="__searchFilter",a=r=>r&&typeof r=="string"?r.indexOf(n)!==-1:!1,o=r=>{const{query:i,wildcardChar:f}=r;if(!a(i))return{};let{options:d}=r;return d=d||{searchFilter:""},{__searchFilter:{value:d.searchFilter?`${d.searchFilter}${f}`:`${f}`,text:""}}}},72495:(Q,I,e)=>{"use strict";e.d(I,{k:()=>i});var n=e(44240),a=e(39697),o=e(65961),r=e(67791);function i({whileLoading:f,source:d}){return(0,n.h)((0,a.O)(200).pipe((0,o.u)(f),(0,r.Q)(d)),d)}},56496:(Q,I,e)=>{"use strict";e.d(I,{G8:()=>n.G8,Hg:()=>n.Hg,Ke:()=>n.Ke,Mg:()=>n.Mg,Qc:()=>n.Qc,UR:()=>n.UR,cH:()=>n.cH,cN:()=>n.cN,gZ:()=>n.gZ,j9:()=>n.j9,j_:()=>n.j_,uH:()=>n.uH,yP:()=>n.yP});var n=e(83195)},26517:(Q,I,e)=>{"use strict";e.d(I,{Gl:()=>a,cL:()=>i,rT:()=>l,yW:()=>d});var n=e(83195);function a(m,s){const h=["","K","M","B","T"],u=(0,n.yP)(1e3,h);return(b,g,P)=>{if(b==null)return{text:""};const c=b<0;c&&(b=Math.abs(b));const y=u(b,g,P);return s?y.suffix=y.suffix!==void 0?`${y.suffix}${m}`:void 0:y.prefix=m,c&&(y.prefix=`-${y.prefix?.length?y.prefix:""}`),y}}const o=["f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],r=o.indexOf("");function i(m){const s=o.findIndex(h=>h.normalize("NFKD")===m.normalize("NFKD"));return s<0?0:s-r}const f=["","Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"];function d(m,s=0){const h=f.map(u=>" "+u+m);return(0,n.yP)(1024,h,s)}function l(m,s=0){const h=o.map(u=>" "+u+m);return(0,n.yP)(1e3,h,r+s)}},83195:(Q,I,e)=>{"use strict";e.d(I,{Qc:()=>q,cN:()=>H,j_:()=>ce,Ke:()=>pe,uH:()=>me,j9:()=>z,Hg:()=>ue,yP:()=>de,UR:()=>fe,cH:()=>Se,Mg:()=>oe,gZ:()=>ne,G8:()=>Z});var n=e(2543);function a(ye,Pe){return ye===null?{text:""}:{text:oe(ye,Pe),suffix:"%"}}function o(ye,Pe){return ye===null?{text:""}:{text:oe(100*ye,Pe),suffix:"%"}}function r(ye,Pe){if(ye==null)return{text:""};const Ie=i(ye,Pe);return Ie.text.substring(0,1)==="-"?Ie.text="-0x"+Ie.text.substring(1):Ie.text="0x"+Ie.text,Ie}function i(ye,Pe){return ye==null?{text:""}:{text:parseFloat(oe(ye,Pe)).toString(16).toUpperCase()}}function f(ye,Pe){return ye==null?{text:""}:{text:ye.toExponential(Pe??void 0)}}var d=e(72724),l=e(42994),m=e(47232),s=(ye=>(ye.Year="year",ye.Month="month",ye.Week="week",ye.Day="day",ye.Hour="hour",ye.Minute="minute",ye.Second="second",ye.Millisecond="millisecond",ye))(s||{});const h=["year","month","week","day","hour","minute","second","millisecond"],u={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1,millisecond:.001};function b(ye,Pe){return ye===null?{text:""}:Math.abs(ye)<1e3?{text:oe(ye,Pe),suffix:" ns"}:Math.abs(ye)<1e6?ne(ye/1e3,Pe," \xB5s"):Math.abs(ye)<1e9?ne(ye/1e6,Pe," ms"):Math.abs(ye)<6e10?ne(ye/1e9,Pe," s"):Math.abs(ye)<36e11?ne(ye/6e10,Pe," min"):Math.abs(ye)<864e11?ne(ye/36e11,Pe," hour"):ne(ye/864e11,Pe," day")}function g(ye,Pe){return ye===null?{text:""}:Math.abs(ye)<1e3?{text:oe(ye,Pe),suffix:" \xB5s"}:Math.abs(ye)<1e6?ne(ye/1e3,Pe," ms"):ne(ye/1e6,Pe," s")}function P(ye,Pe,Ie){return ye===null?{text:""}:Math.abs(ye)<1e3?{text:oe(ye,Pe),suffix:" ms"}:Math.abs(ye)<6e4?ne(ye/1e3,Pe," s"):Math.abs(ye)<36e5?ne(ye/6e4,Pe," min"):Math.abs(ye)<864e5?ne(ye/36e5,Pe," hour"):Math.abs(ye)<31536e6?ne(ye/864e5,Pe," day"):ne(ye/31536e6,Pe," year")}function c(ye,Pe){return ye===null?{text:""}:ye===0?{text:"0",suffix:" s"}:Math.abs(ye)<1e-6?ne(ye*1e9,Pe," ns"):Math.abs(ye)<.001?ne(ye*1e6,Pe," \xB5s"):Math.abs(ye)<1?ne(ye*1e3,Pe," ms"):Math.abs(ye)<60?{text:oe(ye,Pe),suffix:" s"}:Math.abs(ye)<3600?ne(ye/60,Pe," min"):Math.abs(ye)<86400?ne(ye/3600,Pe," hour"):Math.abs(ye)<604800?ne(ye/86400,Pe," day"):Math.abs(ye)<31536e3?ne(ye/604800,Pe," week"):ne(ye/31556900,Pe," year")}function y(ye,Pe){return ye===null?{text:""}:Math.abs(ye)<60?{text:oe(ye,Pe),suffix:" min"}:Math.abs(ye)<1440?ne(ye/60,Pe," hour"):Math.abs(ye)<10080?ne(ye/1440,Pe," day"):Math.abs(ye)<604800?ne(ye/10080,Pe," week"):ne(ye/525948,Pe," year")}function p(ye,Pe){return ye===null?{text:""}:Math.abs(ye)<24?{text:oe(ye,Pe),suffix:" hour"}:Math.abs(ye)<168?ne(ye/24,Pe," day"):Math.abs(ye)<8760?ne(ye/168,Pe," week"):ne(ye/8760,Pe," year")}function v(ye,Pe){return ye===null?{text:""}:Math.abs(ye)<7?{text:oe(ye,Pe),suffix:" day"}:Math.abs(ye)<365?ne(ye/7,Pe," week"):ne(ye/365,Pe," year")}function D(ye,Pe,Ie){if(ye===null)return{text:""};if(ye===0)return{text:"0",suffix:" "+Ie+"s"};if(ye<0){const Ae=D(-ye,Pe,Ie);return Ae.suffix||(Ae.suffix=""),Ae.suffix+=" ago",Ae}ye*=u[Ie]*1e3;const Oe=[];let Ne=!1,We=0;Pe!=null&&(We=Pe);for(let Ae=0;Ae<h.length&&We>=0;Ae++){const Ue=u[h[Ae]]*1e3,Me=ye/Ue;if(Me>=1||Ne){Ne=!0;const $e=Math.floor(Me),ke=h[Ae]+($e!==1?"s":"");Oe.push($e+" "+ke),ye=ye%Ue,We--}}return{text:Oe.join(", ")}}function E(ye,Pe){if(ye===null)return{text:""};if(ye<1e3)return{text:(0,m.yT)(ye).format("SSS\\m\\s")};if(ye<6e4){let We="ss\\s:SSS\\m\\s";return Pe===0&&(We="ss\\s"),{text:(0,m.yT)(ye).format(We)}}if(ye<36e5){let We="mm\\m:ss\\s:SSS\\m\\s";return Pe===0?We="mm\\m":Pe===1&&(We="mm\\m:ss\\s"),{text:(0,m.yT)(ye).format(We)}}let Ie="mm\\m:ss\\s:SSS\\m\\s";const Oe=`${("0"+Math.floor((0,m.Ah)(ye,"milliseconds").asHours())).slice(-2)}h`;return Pe===0?Ie="":Pe===1?Ie="mm\\m":Pe===2&&(Ie="mm\\m:ss\\s"),{text:Ie?`${Oe}:${(0,m.yT)(ye).format(Ie)}`:Oe}}function S(ye,Pe){return D(ye,Pe,"millisecond")}function T(ye,Pe){return D(ye,Pe,"second")}function M(ye){if(ye<0){const We=M(-ye);return We.suffix||(We.suffix=""),We.suffix+=" ago",We}const Pe=[],Ie=Math.floor(ye/3600),Oe=Math.floor(ye%3600/60),Ne=Math.floor(ye%3600%60);return Ie>9?Pe.push(""+Ie):Pe.push("0"+Ie),Oe>9?Pe.push(""+Oe):Pe.push("0"+Oe),Ne>9?Pe.push(""+Ne):Pe.push("0"+Ne),{text:Pe.join(":")}}function A(ye){if(ye<0){const Ne=A(-ye);return Ne.suffix||(Ne.suffix=""),Ne.suffix+=" ago",Ne}let Pe="";const Ie=Math.floor(ye/(24*3600));Ie>0&&(Pe=Ie+" d ");const Oe=M(ye-Ie*24*3600);return{text:Pe+Oe.text}}function x(ye,Pe){return c(ye/100,Pe)}function C(ye,Pe){return E(ye,Pe)}function O(ye,Pe){return E(ye*1e3,Pe)}function R(ye,Pe){return(Ie,Oe,Ne,We)=>Pe&&(0,m.KQ)().isSame(Ie,"day")?{text:(0,d.LE)(Ie,{format:Pe,timeZone:We})}:{text:(0,d.LE)(Ie,{format:ye,timeZone:We})}}const L=R("YYYY-MM-DD HH:mm:ss"),N=R("YYYY-MM-DD HH:mm:ss","HH:mm:ss"),F=R("MM/DD/YYYY h:mm:ss a"),K=R("MM/DD/YYYY h:mm:ss a","h:mm:ss a");function B(){return R((0,l.Od)({year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}))}function w(){return R((0,l.Od)({year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),(0,l.Od)({hour:"2-digit",minute:"2-digit",second:"2-digit"}))}function U(ye,Pe,Ie,Oe,Ne){return{text:(0,d.LE)(ye,{format:Ne?l.WC.fullDateMS:l.WC.fullDate,timeZone:Oe})}}function W(ye,Pe,Ie,Oe){return{text:(0,d.fq)(ye,{timeZone:Oe})}}var V=e(26517);const _=()=>[{name:"Misc",formats:[{name:"Number",id:"none",fn:Z("")},{name:"String",id:"string",fn:Se},{name:"short",id:"short",fn:de(1e3,[""," K"," Mil"," Bil"," Tri"," Quadr"," Quint"," Sext"," Sept"])},{name:"SI short",id:"sishort",fn:(0,V.rT)("")},{name:"Percent (0-100)",id:"percent",fn:a},{name:"Percent (0.0-1.0)",id:"percentunit",fn:o},{name:"Humidity (%H)",id:"humidity",fn:Z("%H")},{name:"Decibel",id:"dB",fn:Z("dB")},{name:"Candela (cd)",id:"candela",fn:(0,V.rT)("cd")},{name:"Hexadecimal (0x)",id:"hex0x",fn:r},{name:"Hexadecimal",id:"hex",fn:i},{name:"Scientific notation",id:"sci",fn:f},{name:"Locale format",id:"locale",fn:ue},{name:"Pixels",id:"pixel",fn:Z("px")}]},{name:"Acceleration",formats:[{name:"Meters/sec\xB2",id:"accMS2",fn:Z("m/sec\xB2")},{name:"Feet/sec\xB2",id:"accFS2",fn:Z("f/sec\xB2")},{name:"G unit",id:"accG",fn:Z("g")}]},{name:"Angle",formats:[{name:"Degrees (\xB0)",id:"degree",fn:Z("\xB0")},{name:"Radians",id:"radian",fn:Z("rad")},{name:"Gradian",id:"grad",fn:Z("grad")},{name:"Arc Minutes",id:"arcmin",fn:Z("arcmin")},{name:"Arc Seconds",id:"arcsec",fn:Z("arcsec")}]},{name:"Area",formats:[{name:"Square Meters (m\xB2)",id:"areaM2",fn:Z("m\xB2")},{name:"Square Feet (ft\xB2)",id:"areaF2",fn:Z("ft\xB2")},{name:"Square Miles (mi\xB2)",id:"areaMI2",fn:Z("mi\xB2")},{name:"Acres (ac)",id:"acres",fn:Z("ac")},{name:"Hectares (ha)",id:"hectares",fn:Z("ha")}]},{name:"Computation",formats:[{name:"FLOP/s",id:"flops",fn:(0,V.rT)("FLOPS")},{name:"MFLOP/s",id:"mflops",fn:(0,V.rT)("FLOPS",2)},{name:"GFLOP/s",id:"gflops",fn:(0,V.rT)("FLOPS",3)},{name:"TFLOP/s",id:"tflops",fn:(0,V.rT)("FLOPS",4)},{name:"PFLOP/s",id:"pflops",fn:(0,V.rT)("FLOPS",5)},{name:"EFLOP/s",id:"eflops",fn:(0,V.rT)("FLOPS",6)},{name:"ZFLOP/s",id:"zflops",fn:(0,V.rT)("FLOPS",7)},{name:"YFLOP/s",id:"yflops",fn:(0,V.rT)("FLOPS",8)}]},{name:"Concentration",formats:[{name:"parts-per-million (ppm)",id:"ppm",fn:Z("ppm")},{name:"parts-per-billion (ppb)",id:"conppb",fn:Z("ppb")},{name:"nanogram per cubic meter (ng/m\xB3)",id:"conngm3",fn:Z("ng/m\xB3")},{name:"nanogram per normal cubic meter (ng/Nm\xB3)",id:"conngNm3",fn:Z("ng/Nm\xB3")},{name:"microgram per cubic meter (\u03BCg/m\xB3)",id:"con\u03BCgm3",fn:Z("\u03BCg/m\xB3")},{name:"microgram per normal cubic meter (\u03BCg/Nm\xB3)",id:"con\u03BCgNm3",fn:Z("\u03BCg/Nm\xB3")},{name:"milligram per cubic meter (mg/m\xB3)",id:"conmgm3",fn:Z("mg/m\xB3")},{name:"milligram per normal cubic meter (mg/Nm\xB3)",id:"conmgNm3",fn:Z("mg/Nm\xB3")},{name:"gram per cubic meter (g/m\xB3)",id:"congm3",fn:Z("g/m\xB3")},{name:"gram per normal cubic meter (g/Nm\xB3)",id:"congNm3",fn:Z("g/Nm\xB3")},{name:"milligrams per decilitre (mg/dL)",id:"conmgdL",fn:Z("mg/dL")},{name:"millimoles per litre (mmol/L)",id:"conmmolL",fn:Z("mmol/L")}]},{name:"Currency",formats:[{name:"Dollars ($)",id:"currencyUSD",fn:(0,V.Gl)("$")},{name:"Pounds (\xA3)",id:"currencyGBP",fn:(0,V.Gl)("\xA3")},{name:"Euro (\u20AC)",id:"currencyEUR",fn:(0,V.Gl)("\u20AC")},{name:"Yen (\xA5)",id:"currencyJPY",fn:(0,V.Gl)("\xA5")},{name:"Rubles (\u20BD)",id:"currencyRUB",fn:(0,V.Gl)("\u20BD")},{name:"Hryvnias (\u20B4)",id:"currencyUAH",fn:(0,V.Gl)("\u20B4")},{name:"Real (R$)",id:"currencyBRL",fn:(0,V.Gl)("R$")},{name:"Danish Krone (kr)",id:"currencyDKK",fn:(0,V.Gl)("kr",!0)},{name:"Icelandic Kr\xF3na (kr)",id:"currencyISK",fn:(0,V.Gl)("kr",!0)},{name:"Norwegian Krone (kr)",id:"currencyNOK",fn:(0,V.Gl)("kr",!0)},{name:"Swedish Krona (kr)",id:"currencySEK",fn:(0,V.Gl)("kr",!0)},{name:"Czech koruna (czk)",id:"currencyCZK",fn:(0,V.Gl)("czk")},{name:"Swiss franc (CHF)",id:"currencyCHF",fn:(0,V.Gl)("CHF")},{name:"Polish Z\u0142oty (PLN)",id:"currencyPLN",fn:(0,V.Gl)("PLN")},{name:"Bitcoin (\u0E3F)",id:"currencyBTC",fn:(0,V.Gl)("\u0E3F")},{name:"Milli Bitcoin (\u0E3F)",id:"currencymBTC",fn:(0,V.Gl)("mBTC")},{name:"Micro Bitcoin (\u0E3F)",id:"currency\u03BCBTC",fn:(0,V.Gl)("\u03BCBTC")},{name:"South African Rand (R)",id:"currencyZAR",fn:(0,V.Gl)("R")},{name:"Indian Rupee (\u20B9)",id:"currencyINR",fn:(0,V.Gl)("\u20B9")},{name:"South Korean Won (\u20A9)",id:"currencyKRW",fn:(0,V.Gl)("\u20A9")},{name:"Indonesian Rupiah (Rp)",id:"currencyIDR",fn:(0,V.Gl)("Rp")},{name:"Philippine Peso (PHP)",id:"currencyPHP",fn:(0,V.Gl)("PHP")},{name:"Vietnamese Dong (VND)",id:"currencyVND",fn:(0,V.Gl)("\u0111",!0)},{name:"Turkish Lira (\u20BA)",id:"currencyTRY",fn:(0,V.Gl)("\u20BA",!0)},{name:"Malaysian Ringgit (RM)",id:"currencyMYR",fn:(0,V.Gl)("RM")},{name:"CFP franc (XPF)",id:"currencyXPF",fn:(0,V.Gl)("XPF")},{name:"Bulgarian Lev (BGN)",id:"currencyBGN",fn:(0,V.Gl)("BGN")},{name:"Guaran\xED (\u20B2)",id:"currencyPYG",fn:(0,V.Gl)("\u20B2")},{name:"Uruguay Peso (UYU)",id:"currencyUYU",fn:(0,V.Gl)("UYU")}]},{name:"Data",formats:[{name:"bytes(IEC)",id:"bytes",fn:(0,V.yW)("B")},{name:"bytes(SI)",id:"decbytes",fn:(0,V.rT)("B")},{name:"bits(IEC)",id:"bits",fn:(0,V.yW)("b")},{name:"bits(SI)",id:"decbits",fn:(0,V.rT)("b")},{name:"kibibytes",id:"kbytes",fn:(0,V.yW)("B",1)},{name:"kilobytes",id:"deckbytes",fn:(0,V.rT)("B",1)},{name:"mebibytes",id:"mbytes",fn:(0,V.yW)("B",2)},{name:"megabytes",id:"decmbytes",fn:(0,V.rT)("B",2)},{name:"gibibytes",id:"gbytes",fn:(0,V.yW)("B",3)},{name:"gigabytes",id:"decgbytes",fn:(0,V.rT)("B",3)},{name:"tebibytes",id:"tbytes",fn:(0,V.yW)("B",4)},{name:"terabytes",id:"dectbytes",fn:(0,V.rT)("B",4)},{name:"pebibytes",id:"pbytes",fn:(0,V.yW)("B",5)},{name:"petabytes",id:"decpbytes",fn:(0,V.rT)("B",5)}]},{name:"Data rate",formats:[{name:"packets/sec",id:"pps",fn:(0,V.rT)("p/s")},{name:"bytes/sec(IEC)",id:"binBps",fn:(0,V.yW)("B/s")},{name:"bytes/sec(SI)",id:"Bps",fn:(0,V.rT)("B/s")},{name:"bits/sec(IEC)",id:"binbps",fn:(0,V.yW)("b/s")},{name:"bits/sec(SI)",id:"bps",fn:(0,V.rT)("b/s")},{name:"kibibytes/sec",id:"KiBs",fn:(0,V.yW)("B/s",1)},{name:"kibibits/sec",id:"Kibits",fn:(0,V.yW)("b/s",1)},{name:"kilobytes/sec",id:"KBs",fn:(0,V.rT)("B/s",1)},{name:"kilobits/sec",id:"Kbits",fn:(0,V.rT)("b/s",1)},{name:"mebibytes/sec",id:"MiBs",fn:(0,V.yW)("B/s",2)},{name:"mebibits/sec",id:"Mibits",fn:(0,V.yW)("b/s",2)},{name:"megabytes/sec",id:"MBs",fn:(0,V.rT)("B/s",2)},{name:"megabits/sec",id:"Mbits",fn:(0,V.rT)("b/s",2)},{name:"gibibytes/sec",id:"GiBs",fn:(0,V.yW)("B/s",3)},{name:"gibibits/sec",id:"Gibits",fn:(0,V.yW)("b/s",3)},{name:"gigabytes/sec",id:"GBs",fn:(0,V.rT)("B/s",3)},{name:"gigabits/sec",id:"Gbits",fn:(0,V.rT)("b/s",3)},{name:"tebibytes/sec",id:"TiBs",fn:(0,V.yW)("B/s",4)},{name:"tebibits/sec",id:"Tibits",fn:(0,V.yW)("b/s",4)},{name:"terabytes/sec",id:"TBs",fn:(0,V.rT)("B/s",4)},{name:"terabits/sec",id:"Tbits",fn:(0,V.rT)("b/s",4)},{name:"pebibytes/sec",id:"PiBs",fn:(0,V.yW)("B/s",5)},{name:"pebibits/sec",id:"Pibits",fn:(0,V.yW)("b/s",5)},{name:"petabytes/sec",id:"PBs",fn:(0,V.rT)("B/s",5)},{name:"petabits/sec",id:"Pbits",fn:(0,V.rT)("b/s",5)}]},{name:"Date & time",formats:[{name:"Datetime ISO",id:"dateTimeAsIso",fn:L},{name:"Datetime ISO (No date if today)",id:"dateTimeAsIsoNoDateIfToday",fn:N},{name:"Datetime US",id:"dateTimeAsUS",fn:F},{name:"Datetime US (No date if today)",id:"dateTimeAsUSNoDateIfToday",fn:K},{name:"Datetime local",id:"dateTimeAsLocal",fn:B()},{name:"Datetime local (No date if today)",id:"dateTimeAsLocalNoDateIfToday",fn:w()},{name:"Datetime default",id:"dateTimeAsSystem",fn:U},{name:"From Now",id:"dateTimeFromNow",fn:W}]},{name:"Energy",formats:[{name:"Watt (W)",id:"watt",fn:(0,V.rT)("W")},{name:"Kilowatt (kW)",id:"kwatt",fn:(0,V.rT)("W",1)},{name:"Megawatt (MW)",id:"megwatt",fn:(0,V.rT)("W",2)},{name:"Gigawatt (GW)",id:"gwatt",fn:(0,V.rT)("W",3)},{name:"Milliwatt (mW)",id:"mwatt",fn:(0,V.rT)("W",-1)},{name:"Watt per square meter (W/m\xB2)",id:"Wm2",fn:Z("W/m\xB2")},{name:"Volt-Ampere (VA)",id:"voltamp",fn:(0,V.rT)("VA")},{name:"Kilovolt-Ampere (kVA)",id:"kvoltamp",fn:(0,V.rT)("VA",1)},{name:"Volt-Ampere reactive (VAr)",id:"voltampreact",fn:(0,V.rT)("VAr")},{name:"Kilovolt-Ampere reactive (kVAr)",id:"kvoltampreact",fn:(0,V.rT)("VAr",1)},{name:"Watt-hour (Wh)",id:"watth",fn:(0,V.rT)("Wh")},{name:"Watt-hour per Kilogram (Wh/kg)",id:"watthperkg",fn:(0,V.rT)("Wh/kg")},{name:"Kilowatt-hour (kWh)",id:"kwatth",fn:(0,V.rT)("Wh",1)},{name:"Kilowatt-min (kWm)",id:"kwattm",fn:(0,V.rT)("W-Min",1)},{name:"Megawatt-hour (MWh)",id:"mwatth",fn:(0,V.rT)("Wh",2)},{name:"Ampere-hour (Ah)",id:"amph",fn:(0,V.rT)("Ah")},{name:"Kiloampere-hour (kAh)",id:"kamph",fn:(0,V.rT)("Ah",1)},{name:"Milliampere-hour (mAh)",id:"mamph",fn:(0,V.rT)("Ah",-1)},{name:"Joule (J)",id:"joule",fn:(0,V.rT)("J")},{name:"Electron volt (eV)",id:"ev",fn:(0,V.rT)("eV")},{name:"Ampere (A)",id:"amp",fn:(0,V.rT)("A")},{name:"Kiloampere (kA)",id:"kamp",fn:(0,V.rT)("A",1)},{name:"Milliampere (mA)",id:"mamp",fn:(0,V.rT)("A",-1)},{name:"Volt (V)",id:"volt",fn:(0,V.rT)("V")},{name:"Kilovolt (kV)",id:"kvolt",fn:(0,V.rT)("V",1)},{name:"Millivolt (mV)",id:"mvolt",fn:(0,V.rT)("V",-1)},{name:"Decibel-milliwatt (dBm)",id:"dBm",fn:(0,V.rT)("dBm")},{name:"Milliohm (m\u03A9)",id:"mohm",fn:(0,V.rT)("\u03A9",-1)},{name:"Ohm (\u03A9)",id:"ohm",fn:(0,V.rT)("\u03A9")},{name:"Kiloohm (k\u03A9)",id:"kohm",fn:(0,V.rT)("\u03A9",1)},{name:"Megaohm (M\u03A9)",id:"Mohm",fn:(0,V.rT)("\u03A9",2)},{name:"Farad (F)",id:"farad",fn:(0,V.rT)("F")},{name:"Microfarad (\xB5F)",id:"\xB5farad",fn:(0,V.rT)("F",-2)},{name:"Nanofarad (nF)",id:"nfarad",fn:(0,V.rT)("F",-3)},{name:"Picofarad (pF)",id:"pfarad",fn:(0,V.rT)("F",-4)},{name:"Femtofarad (fF)",id:"ffarad",fn:(0,V.rT)("F",-5)},{name:"Henry (H)",id:"henry",fn:(0,V.rT)("H")},{name:"Millihenry (mH)",id:"mhenry",fn:(0,V.rT)("H",-1)},{name:"Microhenry (\xB5H)",id:"\xB5henry",fn:(0,V.rT)("H",-2)},{name:"Lumens (Lm)",id:"lumens",fn:(0,V.rT)("Lm")}]},{name:"Flow",formats:[{name:"Gallons/min (gpm)",id:"flowgpm",fn:Z("gpm")},{name:"Cubic meters/sec (cms)",id:"flowcms",fn:Z("cms")},{name:"Cubic feet/sec (cfs)",id:"flowcfs",fn:Z("cfs")},{name:"Cubic feet/min (cfm)",id:"flowcfm",fn:Z("cfm")},{name:"Litre/hour",id:"litreh",fn:Z("L/h")},{name:"Litre/min (L/min)",id:"flowlpm",fn:Z("L/min")},{name:"milliLitre/min (mL/min)",id:"flowmlpm",fn:Z("mL/min")},{name:"Lux (lx)",id:"lux",fn:Z("lux")}]},{name:"Force",formats:[{name:"Newton-meters (Nm)",id:"forceNm",fn:(0,V.rT)("Nm")},{name:"Kilonewton-meters (kNm)",id:"forcekNm",fn:(0,V.rT)("Nm",1)},{name:"Newtons (N)",id:"forceN",fn:(0,V.rT)("N")},{name:"Kilonewtons (kN)",id:"forcekN",fn:(0,V.rT)("N",1)}]},{name:"Hash rate",formats:[{name:"hashes/sec",id:"Hs",fn:(0,V.rT)("H/s")},{name:"kilohashes/sec",id:"KHs",fn:(0,V.rT)("H/s",1)},{name:"megahashes/sec",id:"MHs",fn:(0,V.rT)("H/s",2)},{name:"gigahashes/sec",id:"GHs",fn:(0,V.rT)("H/s",3)},{name:"terahashes/sec",id:"THs",fn:(0,V.rT)("H/s",4)},{name:"petahashes/sec",id:"PHs",fn:(0,V.rT)("H/s",5)},{name:"exahashes/sec",id:"EHs",fn:(0,V.rT)("H/s",6)}]},{name:"Mass",formats:[{name:"milligram (mg)",id:"massmg",fn:(0,V.rT)("g",-1)},{name:"gram (g)",id:"massg",fn:(0,V.rT)("g")},{name:"pound (lb)",id:"masslb",fn:Z("lb")},{name:"kilogram (kg)",id:"masskg",fn:(0,V.rT)("g",1)},{name:"metric ton (t)",id:"masst",fn:Z("t")}]},{name:"Length",formats:[{name:"millimeter (mm)",id:"lengthmm",fn:(0,V.rT)("m",-1)},{name:"inch (in)",id:"lengthin",fn:Z("in")},{name:"feet (ft)",id:"lengthft",fn:Z("ft")},{name:"meter (m)",id:"lengthm",fn:(0,V.rT)("m")},{name:"kilometer (km)",id:"lengthkm",fn:(0,V.rT)("m",1)},{name:"mile (mi)",id:"lengthmi",fn:Z("mi")}]},{name:"Pressure",formats:[{name:"Millibars",id:"pressurembar",fn:(0,V.rT)("bar",-1)},{name:"Bars",id:"pressurebar",fn:(0,V.rT)("bar")},{name:"Kilobars",id:"pressurekbar",fn:(0,V.rT)("bar",1)},{name:"Pascals",id:"pressurepa",fn:(0,V.rT)("Pa")},{name:"Hectopascals",id:"pressurehpa",fn:Z("hPa")},{name:"Kilopascals",id:"pressurekpa",fn:Z("kPa")},{name:"Inches of mercury",id:"pressurehg",fn:Z('"Hg')},{name:"PSI",id:"pressurepsi",fn:de(1e3,["psi","ksi","Mpsi"])}]},{name:"Radiation",formats:[{name:"Becquerel (Bq)",id:"radbq",fn:(0,V.rT)("Bq")},{name:"curie (Ci)",id:"radci",fn:(0,V.rT)("Ci")},{name:"Gray (Gy)",id:"radgy",fn:(0,V.rT)("Gy")},{name:"rad",id:"radrad",fn:(0,V.rT)("rad")},{name:"Sievert (Sv)",id:"radsv",fn:(0,V.rT)("Sv")},{name:"milliSievert (mSv)",id:"radmsv",fn:(0,V.rT)("Sv",-1)},{name:"microSievert (\xB5Sv)",id:"radusv",fn:(0,V.rT)("Sv",-2)},{name:"rem",id:"radrem",fn:(0,V.rT)("rem")},{name:"Exposure (C/kg)",id:"radexpckg",fn:(0,V.rT)("C/kg")},{name:"roentgen (R)",id:"radr",fn:(0,V.rT)("R")},{name:"Sievert/hour (Sv/h)",id:"radsvh",fn:(0,V.rT)("Sv/h")},{name:"milliSievert/hour (mSv/h)",id:"radmsvh",fn:(0,V.rT)("Sv/h",-1)},{name:"microSievert/hour (\xB5Sv/h)",id:"radusvh",fn:(0,V.rT)("Sv/h",-2)}]},{name:"Rotational Speed",formats:[{name:"Revolutions per minute (rpm)",id:"rotrpm",fn:Z("rpm")},{name:"Hertz (Hz)",id:"rothz",fn:(0,V.rT)("Hz")},{name:"Kilohertz (kHz)",id:"rotkhz",fn:(0,V.rT)("Hz",1)},{name:"Megahertz (MHz)",id:"rotmhz",fn:(0,V.rT)("Hz",2)},{name:"Gigahertz (GHz)",id:"rotghz",fn:(0,V.rT)("Hz",3)},{name:"Radians per second (rad/s)",id:"rotrads",fn:Z("rad/s")},{name:"Degrees per second (\xB0/s)",id:"rotdegs",fn:Z("\xB0/s")}]},{name:"Temperature",formats:[{name:"Celsius (\xB0C)",id:"celsius",fn:Z("\xB0C")},{name:"Fahrenheit (\xB0F)",id:"fahrenheit",fn:Z("\xB0F")},{name:"Kelvin (K)",id:"kelvin",fn:Z("K")}]},{name:"Time",formats:[{name:"Hertz (1/s)",id:"hertz",fn:(0,V.rT)("Hz")},{name:"nanoseconds (ns)",id:"ns",fn:b},{name:"microseconds (\xB5s)",id:"\xB5s",fn:g},{name:"milliseconds (ms)",id:"ms",fn:P},{name:"seconds (s)",id:"s",fn:c},{name:"minutes (m)",id:"m",fn:y},{name:"hours (h)",id:"h",fn:p},{name:"days (d)",id:"d",fn:v},{name:"duration (ms)",id:"dtdurationms",fn:S},{name:"duration (s)",id:"dtdurations",fn:T},{name:"duration (hh:mm:ss)",id:"dthms",fn:M},{name:"duration (d hh:mm:ss)",id:"dtdhms",fn:A},{name:"Timeticks (s/100)",id:"timeticks",fn:x},{name:"clock (ms)",id:"clockms",fn:C},{name:"clock (s)",id:"clocks",fn:O}]},{name:"Throughput",formats:[{name:"counts/sec (cps)",id:"cps",fn:fe("c/s")},{name:"ops/sec (ops)",id:"ops",fn:fe("ops/s")},{name:"requests/sec (rps)",id:"reqps",fn:fe("req/s")},{name:"reads/sec (rps)",id:"rps",fn:fe("rd/s")},{name:"writes/sec (wps)",id:"wps",fn:fe("wr/s")},{name:"I/O ops/sec (iops)",id:"iops",fn:fe("io/s")},{name:"events/sec (eps)",id:"eps",fn:fe("evt/s")},{name:"messages/sec (mps)",id:"mps",fn:fe("msg/s")},{name:"records/sec (rps)",id:"recps",fn:fe("rec/s")},{name:"rows/sec (rps)",id:"rowsps",fn:fe("rows/s")},{name:"counts/min (cpm)",id:"cpm",fn:fe("c/m")},{name:"ops/min (opm)",id:"opm",fn:fe("ops/m")},{name:"requests/min (rpm)",id:"reqpm",fn:fe("req/m")},{name:"reads/min (rpm)",id:"rpm",fn:fe("rd/m")},{name:"writes/min (wpm)",id:"wpm",fn:fe("wr/m")},{name:"events/min (epm)",id:"epm",fn:fe("evts/m")},{name:"messages/min (mpm)",id:"mpm",fn:fe("msgs/m")},{name:"records/min (rpm)",id:"recpm",fn:fe("rec/m")},{name:"rows/min (rpm)",id:"rowspm",fn:fe("rows/m")}]},{name:"Velocity",formats:[{name:"meters/second (m/s)",id:"velocityms",fn:Z("m/s")},{name:"kilometers/hour (km/h)",id:"velocitykmh",fn:Z("km/h")},{name:"miles/hour (mph)",id:"velocitymph",fn:Z("mph")},{name:"knot (kn)",id:"velocityknot",fn:Z("kn")}]},{name:"Volume",formats:[{name:"millilitre (mL)",id:"mlitre",fn:(0,V.rT)("L",-1)},{name:"litre (L)",id:"litre",fn:(0,V.rT)("L")},{name:"cubic meter",id:"m3",fn:Z("m\xB3")},{name:"Normal cubic meter",id:"Nm3",fn:Z("Nm\xB3")},{name:"cubic decimeter",id:"dm3",fn:Z("dm\xB3")},{name:"gallons",id:"gallons",fn:Z("gal")}]},{name:"Boolean",formats:[{name:"True / False",id:"bool",fn:q("True","False")},{name:"Yes / No",id:"bool_yes_no",fn:q("Yes","No")},{name:"On / Off",id:"bool_on_off",fn:q("On","Off")}]}];function H(ye){return`${ye.prefix??""}${ye.text}${ye.suffix??""}`}let G=[];const j={};let Y=!1;function oe(ye,Pe){if(ye===null)return"";if(ye===Number.NEGATIVE_INFINITY||ye===Number.POSITIVE_INFINITY)return ye.toLocaleString();if(Pe==null&&(Pe=se(ye)),ye===0)return ye.toFixed(Pe);const Ie=Pe?Math.pow(10,Math.max(0,Pe)):1,Oe=String(Math.round(ye*Ie)/Ie);if(Oe.indexOf("e")!==-1||ye===0)return Oe;const Ne=Oe.indexOf("."),We=Ne===-1?0:Oe.length-Ne-1;return We<Pe?(We?Oe:Oe+".")+String(Ie).slice(1,Pe-We+1):Oe}function se(ye){const Pe=Math.abs(ye);let Oe=-Math.floor(Math.log(Pe)/Math.LN10)+1;const Ne=Math.pow(10,-Oe);return Pe/Ne>2.25&&++Oe,ye%1===0&&(Oe=0),Math.max(0,Oe)}function ne(ye,Pe,Ie){return{text:oe(ye,Pe),suffix:ee(Ie,Math.abs(ye)>1)}}function ee(ye,Pe){if(!Pe)return ye;switch(ye){case" min":case" hour":case" day":case" week":case" year":return`${ye}s`;default:return ye}}function Z(ye,Pe){return(Ie,Oe)=>{if(Ie===null)return{text:""};const Ne=oe(Ie,Oe);return ye?Pe?{text:Ne,prefix:ye}:{text:Ne,suffix:" "+ye}:{text:Ne}}}function z(ye){return ye&&ye.startsWith("bool")}function q(ye,Pe){return Ie=>({text:Ie?ye:Pe})}const ie=(ye,Pe)=>Math.log10(Pe)/Math.log10(ye);function de(ye,Pe,Ie=0){return(Oe,Ne)=>{if(Oe==null)return{text:""};if(Oe===Number.NEGATIVE_INFINITY||Oe===Number.POSITIVE_INFINITY||isNaN(Oe))return{text:Oe.toLocaleString()};const We=Oe===0?0:Math.floor(ie(ye,Math.abs(Oe))),Ae=Pe[(0,n.clamp)(Ie+We,0,Pe.length-1)];return{text:oe(Oe/ye**(0,n.clamp)(We,-Ie,Pe.length-Ie-1),Ne),suffix:Ae}}}function ue(ye,Pe){return ye==null?{text:""}:{text:ye.toLocaleString(void 0,{maximumFractionDigits:Pe??void 0})}}function fe(ye){const Ie=de(1e3,["","K","M","B","T"]);return(Oe,Ne,We)=>{if(Oe===null)return{text:""};const Ae=Ie(Oe,Ne,We);return Ae.suffix+=" "+ye,Ae}}function Se(ye){return{text:`${ye}`}}function he(){G=_();for(const ye of G)for(const Pe of ye.formats)j[Pe.id]=Pe.fn;[{from:"farenheit",to:"fahrenheit"}].forEach(ye=>{const Pe=j[ye.to];Pe&&(j[ye.from]=Pe)}),Y=!0}function ce(ye){if(!ye)return Z("");Y||he();const Pe=j[ye];if(!Pe&&ye){let Ie=ye.indexOf(":");if(Ie>0){const Oe=ye.substring(0,Ie),Ne=ye.substring(Ie+1);if(Oe==="prefix")return Z(Ne,!0);if(Oe==="suffix")return Z(Ne,!1);if(Oe==="time")return R(Ne);if(Oe==="si"){const We=(0,V.cL)(Ne.charAt(0)),Ae=We===0?Ne:Ne.substring(1);return(0,V.rT)(Ae,We)}if(Oe==="count")return fe(Ne);if(Oe==="currency")return(0,V.Gl)(Ne);if(Oe==="bool"){if(Ie=Ne.indexOf("/"),Ie>=0){const We=Ne.substring(0,Ie),Ae=Ne.substring(Ie+1);return q(We,Ae)}return q(Ne,"-")}}return Z(ye)}return Pe}function me(){return Y||he(),j}function pe(){return Y||he(),G.map(ye=>({text:ye.name,submenu:ye.formats.map(Pe=>({text:Pe.name,value:Pe.id}))}))}},79178:(Q,I,e)=>{"use strict";e.d(I,{L:()=>o});const n="ArrayVector is deprecated and will be removed in Grafana 11. Please use plain arrays for field.values.";let a=!1;class o extends Array{get buffer(){return this}set buffer(i){this.length=0;const f=i?.length;if(f){let d=65e3,l=Math.ceil(f/d);for(let m=0;m<l;m++)this.push.apply(this,i.slice(m*d,(m+1)*d))}}constructor(i){super(),this.buffer=i??[],a||(console.warn(n),a=!0)}toJSON(){return[...this]}}},36120:(Q,I,e)=>{"use strict";e.d(I,{$:()=>a});var n=e(18008);class a extends n.F{constructor(r){return super(),this.buffer=r.buffer||[],this.capacity=this.buffer.length,this.tail=r.append!=="head",this.index=0,this.add=this.getAddFunction(),r.capacity&&this.setCapacity(r.capacity),new Proxy(this,{get(i,f,d){if(typeof f!="symbol"){const l=+f;if(String(l)===f)return i.get(l)}return Reflect.get(i,f,d)},set(i,f,d,l){if(typeof f!="symbol"){const m=+f;if(String(m)===f)return i.set(m,d),!0}return Reflect.set(i,f,d,l)}})}getAddFunction(){return this.capacity>this.buffer.length?this.tail?r=>{this.buffer.push(r),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:r=>{this.buffer.unshift(r),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:this.tail?r=>{this.buffer[this.index]=r,this.index=(this.index+1)%this.buffer.length}:r=>{let i=this.index-1;i<0&&(i=this.buffer.length-1),this.buffer[i]=r,this.index=i}}setCapacity(r){if(this.capacity===r)return;const i=this.toArray();if(r>this.length)this.buffer=i;else if(r<this.capacity){const f=this.length-r;this.tail?this.buffer=i.slice(f,i.length):this.buffer=i.slice(0,i.length-f)}this.capacity=r,this.index=0,this.add=this.getAddFunction()}setAppendMode(r){const i=r!=="head";i!==this.tail&&(this.buffer=this.toArray().reverse(),this.index=0,this.tail=i,this.add=this.getAddFunction())}reverse(){return this.buffer.reverse()}get(r){return this.buffer[(r+this.index)%this.buffer.length]}set(r,i){this.buffer[(r+this.index)%this.buffer.length]=i}get length(){return this.buffer.length}}},18008:(Q,I,e)=>{"use strict";e.d(I,{E:()=>r,F:()=>a});var n;class a{constructor(){this[n]={}}static{n=Symbol.unscopables}*iterator(){for(let f=0;f<this.length;f++)yield this.get(f)}set(f,d){throw"unsupported operation"}add(f){throw"unsupported operation"}push(...f){for(const d of f)this.add(d);return this.length}[Symbol.iterator](){return this.iterator()}forEach(f){return r(this).forEach(f)}map(f){return r(this).map(f)}filter(f){return r(this).filter(f)}at(f){return this.get(f)}toArray(){const f=new Array(this.length);for(let d=0;d<this.length;d++)f[d]=this.get(d);return f}join(f){return this.toArray().join(f)}toJSON(){return this.toArray()}pop(){throw new Error("Method not implemented.")}concat(...f){throw new Error("Method not implemented.")}reverse(){throw new Error("Method not implemented.")}shift(){throw new Error("Method not implemented.")}sort(f){throw new Error("Method not implemented.")}splice(f,d,...l){throw new Error("Method not implemented.")}unshift(...f){throw new Error("Method not implemented.")}fill(f,d,l){throw new Error("Method not implemented.")}copyWithin(f,d,l){throw new Error("Method not implemented.")}slice(f,d){return this.toArray().slice(f,d)}indexOf(f,d){return this.toArray().indexOf(f,d)}lastIndexOf(f,d){return this.toArray().lastIndexOf(f,d)}every(f,d){return this.toArray().every(f,d)}some(f,d){return this.toArray().some(f,d)}reduce(f,d){throw new Error("Method not implemented.")}reduceRight(f,d){throw new Error("Method not implemented.")}find(f,d){return this.toArray().find(f,d)}findIndex(f,d){return this.toArray().findIndex(f,d)}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.toArray().values()}includes(f,d){return this.toArray().includes(f,d)}flatMap(f,d){return this.toArray().flatMap(f,d)}flat(f){throw new Error("Method not implemented.")}}const o=[];function r(i){return{*[Symbol.iterator](){for(let f=0;f<i.length;f++)yield i.get(f)},forEach(f){for(let d=0;d<i.length;d++)f(i.get(d),d,o)},map(f){const d=[];for(let l=0;l<i.length;l++)d.push(f(i.get(l),l,o));return d},filter(f){const d=[];let l=0;for(const m of this)f(m,l++,o)&&d.push(m);return d}}}},13390:(Q,I,e)=>{"use strict";e.d(I,{X:()=>n});const n={RadioButton:{container:"data-testid radio-button"},Breadcrumbs:{breadcrumb:a=>`data-testid ${a} breadcrumb`},TimePicker:{openButton:"data-testid TimePicker Open Button",overlayContent:"data-testid TimePicker Overlay Content",fromField:"data-testid Time Range from field",toField:"data-testid Time Range to field",applyTimeRange:"data-testid TimePicker submit button",copyTimeRange:"data-testid TimePicker copy button",pasteTimeRange:"data-testid TimePicker paste button",calendar:{label:"data-testid Time Range calendar",openButton:"data-testid Open time range calendar",closeButton:"data-testid Close time range Calendar"},absoluteTimeRangeTitle:"data-testid-absolute-time-range-narrow"},DataSourcePermissions:{form:()=>'form[name="addPermission"]',roleType:"Role to add new permission to",rolePicker:"Built-in role picker",permissionLevel:"Permission Level"},DateTimePicker:{input:"data-testid date-time-input"},DataSource:{TestData:{QueryTab:{scenarioSelectContainer:"Test Data Query scenario select container",scenarioSelect:"Test Data Query scenario select",max:"TestData max",min:"TestData min",noise:"TestData noise",seriesCount:"TestData series count",spread:"TestData spread",startValue:"TestData start value",drop:"TestData drop values"}},DataSourceHttpSettings:{urlInput:"data-testid Datasource HTTP settings url"},Jaeger:{traceIDInput:"Trace ID"},Prometheus:{configPage:{connectionSettings:"Data source connection URL",manageAlerts:"prometheus-alerts-manager",scrapeInterval:"data-testid scrape interval",queryTimeout:"data-testid query timeout",defaultEditor:"data-testid default editor",disableMetricLookup:"disable-metric-lookup",prometheusType:"data-testid prometheus type",prometheusVersion:"data-testid prometheus version",cacheLevel:"data-testid cache level",incrementalQuerying:"prometheus-incremental-querying",queryOverlapWindow:"data-testid query overlap window",disableRecordingRules:"disable-recording-rules",customQueryParameters:"data-testid custom query parameters",httpMethod:"data-testid http method",exemplarsAddButton:"data-testid Add exemplar config button",internalLinkSwitch:"data-testid Internal link switch",codeModeMetricNamesSuggestionLimit:"data-testid code mode metric names suggestion limit"},queryEditor:{explain:"data-testid prometheus explain switch wrapper",editorToggle:"data-testid QueryEditorModeToggle",options:"data-testid prometheus options",legend:"data-testid prometheus legend wrapper",format:"data-testid prometheus format",step:"prometheus-step",type:"data-testid prometheus type",exemplars:"prometheus-exemplars",builder:{metricSelect:"data-testid metric select",hints:"data-testid prometheus hints",metricsExplorer:"data-testid metrics explorer",queryAdvisor:"data-testid query advisor"},code:{queryField:"data-testid prometheus query field",metricsCountInfo:"data-testid metrics count disclaimer",metricsBrowser:{openButton:"data-testid open metrics browser",selectMetric:"data-testid select a metric",metricList:"data-testid metric list",labelNamesFilter:"data-testid label names filter",labelValuesFilter:"data-testid label values filter",useQuery:"data-testid use query",useAsRateQuery:"data-testid use as rate query",validateSelector:"data-testid validate selector",clear:"data-testid clear"}}},exemplarMarker:"data-testid Exemplar marker",variableQueryEditor:{queryType:"data-testid query type",labelnames:{metricRegex:"data-testid label names metric regex"},labelValues:{labelSelect:"data-testid label values label select"},metricNames:{metricRegex:"data-testid metric names metric regex"},varQueryResult:"data-testid variable query result",seriesQuery:"data-testid prometheus series query",classicQuery:"data-testid prometheus classic query"},annotations:{minStep:"prometheus-annotation-min-step",title:"data-testid prometheus annotation title",tags:"data-testid prometheus annotation tags",text:"data-testid prometheus annotation text",seriesValueAsTimestamp:"data-testid prometheus annotation series value as timestamp"}}},Menu:{MenuComponent:a=>`${a} menu`,MenuGroup:a=>`${a} menu group`,MenuItem:a=>`${a} menu item`,SubMenu:{container:"data-testid SubMenu container",icon:"data-testid SubMenu icon"}},Panels:{Panel:{title:a=>`data-testid Panel header ${a}`,content:"data-testid panel content",headerItems:a=>`data-testid Panel header item ${a}`,menuItems:a=>`data-testid Panel menu item ${a}`,menu:a=>`data-testid Panel menu ${a}`,containerByTitle:a=>`${a} panel`,headerCornerInfo:a=>`Panel header ${a}`,status:a=>`data-testid Panel status ${a}`,loadingBar:()=>"Panel loading bar",HoverWidget:{container:"data-testid hover-header-container",dragIcon:"data-testid drag-icon"},PanelDataErrorMessage:"data-testid Panel data error message"},Visualization:{Graph:{container:"Graph container",VisualizationTab:{legendSection:"Legend section"},Legend:{legendItemAlias:a=>`gpl alias ${a}`,showLegendSwitch:"gpl show legend"},xAxis:{labels:()=>"div.flot-x-axis > div.flot-tick-label"}},BarGauge:{value:"Bar gauge value",valueV2:"data-testid Bar gauge value"},PieChart:{svgSlice:"data testid Pie Chart Slice"},Text:{container:()=>".markdown-html"},Table:{header:"table header",footer:"table-footer",body:"data-testid table body"}}},VizLegend:{seriesName:a=>`data-testid VizLegend series ${a}`},Drawer:{General:{title:a=>`Drawer title ${a}`,expand:"Drawer expand",contract:"Drawer contract",close:"data-testid Drawer close",rcContentWrapper:()=>".rc-drawer-content-wrapper",subtitle:"data-testid drawer subtitle"},DashboardSaveDrawer:{saveButton:"data-testid Save dashboard drawer button",saveAsButton:"data-testid Save as dashboard drawer button",saveAsTitleInput:"Save dashboard title field"}},PanelEditor:{General:{content:"data-testid Panel editor content"},OptionsPane:{content:"data-testid Panel editor option pane content",select:"Panel editor option pane select",fieldLabel:a=>`${a} field property editor`,fieldInput:a=>`data-testid Panel editor option pane field input ${a}`},DataPane:{content:"data-testid Panel editor data pane content"},applyButton:"data-testid Apply changes and go back to dashboard",toggleVizPicker:"data-testid toggle-viz-picker",toggleVizOptions:"data-testid toggle-viz-options",toggleTableView:"data-testid toggle-table-view",showZoomField:"Map controls Show zoom control field property editor",showAttributionField:"Map controls Show attribution field property editor",showScaleField:"Map controls Show scale field property editor",showMeasureField:"Map controls Show measure tools field property editor",showDebugField:"Map controls Show debug field property editor",measureButton:"show measure tools"},PanelInspector:{Data:{content:"Panel inspector Data content"},Stats:{content:"Panel inspector Stats content"},Json:{content:"data-testid Panel inspector Json content"},Query:{content:"Panel inspector Query content",refreshButton:"Panel inspector Query refresh button",jsonObjectKeys:()=>".json-formatter-key"}},Tab:{title:a=>`Tab ${a}`,active:()=>'[class*="-activeTabStyle"]'},RefreshPicker:{runButton:"RefreshPicker run button",intervalButton:"RefreshPicker interval button",runButtonV2:"data-testid RefreshPicker run button",intervalButtonV2:"data-testid RefreshPicker interval button"},QueryTab:{content:"Query editor tab content",queryInspectorButton:"Query inspector button",queryHistoryButton:"data-testid query-history-button",addQuery:"data-testid query-tab-add-query",queryGroupTopSection:"data-testid query group top section",addExpression:"data-testid query-tab-add-expression"},QueryHistory:{queryText:"Query text"},QueryEditorRows:{rows:"Query editor row"},QueryEditorRow:{actionButton:a=>`data-testid ${a}`,title:a=>`Query editor row title ${a}`,container:a=>`Query editor row ${a}`},AlertTab:{content:"data-testid Alert editor tab content"},AlertRules:{groupToggle:"data-testid group-collapse-toggle",toggle:"data-testid collapse-toggle",expandedContent:"data-testid expanded-content",previewButton:"data-testid alert-rule preview-button",ruleNameField:"data-testid alert-rule name-field",newFolderButton:"data-testid alert-rule new-folder-button",newFolderNameField:"data-testid alert-rule name-folder-name-field",newFolderNameCreateButton:"data-testid alert-rule name-folder-name-create-button",newEvaluationGroupButton:"data-testid alert-rule new-evaluation-group-button",newEvaluationGroupName:"data-testid alert-rule new-evaluation-group-name",newEvaluationGroupInterval:"data-testid alert-rule new-evaluation-group-interval",newEvaluationGroupCreate:"data-testid alert-rule new-evaluation-group-create-button"},Alert:{alert:a=>`Alert ${a}`,alertV2:a=>`data-testid Alert ${a}`},TransformTab:{content:"data-testid Transform editor tab content",newTransform:a=>`data-testid New transform ${a}`,transformationEditor:a=>`data-testid Transformation editor ${a}`,transformationEditorDebugger:a=>`data-testid Transformation editor debugger ${a}`},Transforms:{card:a=>`data-testid New transform ${a}`,disableTransformationButton:"data-testid Disable transformation button",Reduce:{modeLabel:"data-testid Transform mode label",calculationsLabel:"data-testid Transform calculations label"},SpatialOperations:{actionLabel:"root Action field property editor",locationLabel:"root Location Mode field property editor",location:{autoOption:"Auto location option",coords:{option:"Coords location option",latitudeFieldLabel:"root Latitude field field property editor",longitudeFieldLabel:"root Longitude field field property editor"},geohash:{option:"Geohash location option",geohashFieldLabel:"root Geohash field field property editor"},lookup:{option:"Lookup location option",lookupFieldLabel:"root Lookup field field property editor",gazetteerFieldLabel:"root Gazetteer field property editor"}}},searchInput:"data-testid search transformations",noTransformationsMessage:"data-testid no transformations message",addTransformationButton:"data-testid add transformation button",removeAllTransformationsButton:"data-testid remove all transformations button"},NavBar:{Configuration:{button:"Configuration"},Toggle:{button:"data-testid Toggle menu"},Reporting:{button:"Reporting"}},NavMenu:{Menu:"data-testid navigation mega-menu",item:"data-testid Nav menu item"},NavToolbar:{container:"data-testid Nav toolbar",shareDashboard:"data-testid Share dashboard",markAsFavorite:"data-testid Mark as favorite",editDashboard:{editButton:"data-testid Edit dashboard button",saveButton:"data-testid Save dashboard button",exitButton:"data-testid Exit edit mode button",settingsButton:"data-testid Dashboard settings",addRowButton:"data-testid Add row button",addLibraryPanelButton:"data-testid Add a panel from the panel library button",addVisualizationButton:"data-testid Add new visualization menu item",pastePanelButton:"data-testid Paste panel button",discardChangesButton:"data-testid Discard changes button",discardLibraryPanelButton:"data-testid Discard library panel button",unlinkLibraryPanelButton:"data-testid Unlink library panel button",saveLibraryPanelButton:"data-testid Save library panel button",backToDashboardButton:"data-testid Back to dashboard button"}},PageToolbar:{container:()=>".page-toolbar",item:a=>`${a}`,itemButton:a=>`data-testid ${a}`},QueryEditorToolbarItem:{button:a=>`QueryEditor toolbar item button ${a}`},BackButton:{backArrow:"data-testid Go Back"},OptionsGroup:{group:a=>a?`data-testid Options group ${a}`:"data-testid Options group",toggle:a=>a?`data-testid Options group ${a} toggle`:"data-testid Options group toggle"},PluginVisualization:{item:a=>`Plugin visualization item ${a}`,current:()=>'[class*="-currentVisualizationItem"]'},Select:{option:"data-testid Select option",input:()=>'input[id*="time-options-input"]',singleValue:()=>'div[class*="-singleValue"]'},FieldConfigEditor:{content:"Field config editor content"},OverridesConfigEditor:{content:"Field overrides editor content"},FolderPicker:{container:"Folder picker select container",containerV2:"data-testid Folder picker select container",input:"data-testid folder-picker-input"},ReadonlyFolderPicker:{container:"data-testid Readonly folder picker select container"},DataSourcePicker:{container:"data-testid Data source picker select container",input:()=>'input[id="data-source-picker"]',inputV2:"data-testid Select a data source",dataSourceList:"data-testid Data source list dropdown",advancedModal:{dataSourceList:"data-testid Data source list",builtInDataSourceList:"data-testid Built in data source list"}},TimeZonePicker:{container:"Time zone picker select container",containerV2:"data-testid Time zone picker select container",changeTimeSettingsButton:"data-testid Time zone picker Change time settings button"},WeekStartPicker:{container:"Choose starting day of the week",containerV2:"data-testid Choose starting day of the week",placeholder:"Choose starting day of the week"},TraceViewer:{spanBar:"data-testid SpanBar--wrapper"},QueryField:{container:"data-testid Query field"},QueryBuilder:{queryPatterns:"data-testid Query patterns",labelSelect:"data-testid Select label",inputSelect:"data-testid Select label-input",valueSelect:"data-testid Select value",matchOperatorSelect:"data-testid Select match operator"},ValuePicker:{button:a=>`data-testid Value picker button ${a}`,select:a=>`data-testid Value picker select ${a}`},Search:{section:"Search section",sectionV2:"data-testid Search section",items:"Search items",itemsV2:"data-testid Search items",cards:"data-testid Search cards",collapseFolder:a=>`data-testid Collapse folder ${a}`,expandFolder:a=>`data-testid Expand folder ${a}`,dashboardItem:a=>`${n.Search.dashboardItems} ${a}`,dashboardCard:a=>`data-testid Search card ${a}`,folderHeader:a=>`data-testid Folder header ${a}`,folderContent:a=>`data-testid Folder content ${a}`,dashboardItems:"data-testid Dashboard search item"},DashboardLinks:{container:"data-testid Dashboard link container",dropDown:"data-testid Dashboard link dropdown",link:"data-testid Dashboard link"},LoadingIndicator:{icon:"data-testid Loading indicator"},CallToActionCard:{button:a=>`Call to action button ${a}`,buttonV2:a=>`data-testid Call to action button ${a}`},DataLinksContextMenu:{singleLink:"data-testid Data link"},CodeEditor:{container:"data-testid Code editor container"},ReactMonacoEditor:{editorLazy:"data-testid ReactMonacoEditor editorLazy"},DashboardImportPage:{textarea:"data-testid-import-dashboard-textarea",submit:"data-testid-load-dashboard"},ImportDashboardForm:{name:"data-testid-import-dashboard-title",submit:"data-testid-import-dashboard-submit"},PanelAlertTabContent:{content:"data-testid Unified alert editor tab content"},VisualizationPreview:{card:a=>`data-testid suggestion-${a}`},ColorSwatch:{name:"data-testid-colorswatch"},DashboardRow:{title:a=>`data-testid dashboard-row-title-${a}`},UserProfile:{profileSaveButton:"data-testid-user-profile-save",preferencesSaveButton:"data-testid-shared-prefs-save",orgsTable:"data-testid-user-orgs-table",sessionsTable:"data-testid-user-sessions-table",extensionPointTabs:"data-testid-extension-point-tabs",extensionPointTab:a=>`data-testid-extension-point-tab-${a}`},FileUpload:{inputField:"data-testid-file-upload-input-field",fileNameSpan:"data-testid-file-upload-file-name"},DebugOverlay:{wrapper:"debug-overlay"},OrgRolePicker:{input:"Role"},AnalyticsToolbarButton:{button:"Dashboard insights"},Variables:{variableOption:"data-testid variable-option"},Annotations:{annotationsTypeInput:"data-testid annotations-type-input",annotationsChoosePanelInput:"data-testid choose-panels-input",editor:{testButton:"data-testid annotations-test-button",resultContainer:"data-testid annotations-query-result-container"}},Tooltip:{container:"data-testid tooltip"},ReturnToPrevious:{buttonGroup:"data-testid dismissable button group",backButton:"data-testid back",dismissButton:"data-testid dismiss"},SQLQueryEditor:{selectColumn:"data-testid select-column",selectAggregation:"data-testid select-aggregation",selectAlias:"data-testid select-alias",filterConjunction:"data-testid filter-conjunction",filterField:"data-testid filter-field",filterOperator:"data-testid filter-operator",headerTableSelector:"data-testid header-table-selector",headerFilterSwitch:"data-testid header-filter-switch",headerGroupSwitch:"data-testid header-group-switch",headerOrderSwitch:"data-testid header-order-switch",headerPreviewSwitch:"data-testid header-preview-switch"}}},13544:(Q,I,e)=>{"use strict";e.d(I,{Tp:()=>o});var n=e(13390);const o={pages:{Login:{url:"/login",username:"data-testid Username input field",password:"data-testid Password input field",submit:"data-testid Login button",skip:"data-testid Skip change password button"},Home:{url:"/"},DataSource:{name:"data-testid Data source settings page name input field",delete:"Data source settings page Delete button",readOnly:"data-testid Data source settings page read only message",saveAndTest:"data-testid Data source settings page Save and Test button",alert:"data-testid Data source settings page Alert"},DataSources:{url:"/datasources",dataSources:r=>`Data source list item ${r}`},EditDataSource:{url:r=>`/datasources/edit/${r}`,settings:"Datasource settings page basic settings"},AddDataSource:{url:"/datasources/new",dataSourcePlugins:r=>`Data source plugin item ${r}`,dataSourcePluginsV2:r=>`Add new data source ${r}`},ConfirmModal:{delete:"data-testid Confirm Modal Danger Button"},AddDashboard:{url:"/dashboard/new",itemButton:r=>`data-testid ${r}`,addNewPanel:"data-testid Add new panel",addNewRow:"data-testid Add new row",addNewPanelLibrary:"data-testid Add new panel from panel library"},Dashboard:{url:r=>`/d/${r}`,DashNav:{nav:"Dashboard navigation",navV2:"data-testid Dashboard navigation",publicDashboardTag:"data-testid public dashboard tag",shareButton:"data-testid share-button",scrollContainer:"data-testid Dashboard canvas scroll container",newShareButton:{container:"data-testid new share button",shareLink:"data-testid new share link-button",arrowMenu:"data-testid new share button arrow menu",menu:{container:"data-testid new share button menu",shareInternally:"data-testid new share button share internally"}},playlistControls:{prev:"data-testid playlist previous dashboard button",stop:"data-testid playlist stop dashboard button",next:"data-testid playlist next dashboard button"}},Controls:"data-testid dashboard controls",SubMenu:{submenu:"Dashboard submenu",submenuItem:"data-testid template variable",submenuItemLabels:r=>`data-testid Dashboard template variables submenu Label ${r}`,submenuItemValueDropDownValueLinkTexts:r=>`data-testid Dashboard template variables Variable Value DropDown value link text ${r}`,submenuItemValueDropDownDropDown:"Variable options",submenuItemValueDropDownOptionTexts:r=>`data-testid Dashboard template variables Variable Value DropDown option text ${r}`,Annotations:{annotationsWrapper:"data-testid annotation-wrapper",annotationLabel:r=>`data-testid Dashboard annotations submenu Label ${r}`,annotationToggle:r=>`data-testid Dashboard annotations submenu Toggle ${r}`}},Settings:{Actions:{close:"data-testid dashboard-settings-close"},General:{deleteDashBoard:"data-testid Dashboard settings page delete dashboard button",sectionItems:r=>`Dashboard settings section item ${r}`,saveDashBoard:"Dashboard settings aside actions Save button",saveAsDashBoard:"Dashboard settings aside actions Save As button",timezone:"Time zone picker select container",title:"Tab General"},Annotations:{List:{addAnnotationCTA:n.X.CallToActionCard.button("Add annotation query"),addAnnotationCTAV2:n.X.CallToActionCard.buttonV2("Add annotation query"),annotations:"data-testid list-annotations"},Settings:{name:"data-testid Annotations settings name input"},NewAnnotation:{panelFilterSelect:"data-testid annotations-panel-filter",showInLabel:"data-testid show-in-label",previewInDashboard:"data-testid annotations-preview",delete:"data-testid annotations-delete",apply:"data-testid annotations-apply",enable:"data-testid annotation-enable",hide:"data-testid annotation-hide"}},Variables:{List:{addVariableCTA:n.X.CallToActionCard.button("Add variable"),addVariableCTAV2:n.X.CallToActionCard.buttonV2("Add variable"),newButton:"Variable editor New variable button",table:"Variable editor Table",tableRowNameFields:r=>`Variable editor Table Name field ${r}`,tableRowDefinitionFields:r=>`Variable editor Table Definition field ${r}`,tableRowArrowUpButtons:r=>`Variable editor Table ArrowUp button ${r}`,tableRowArrowDownButtons:r=>`Variable editor Table ArrowDown button ${r}`,tableRowDuplicateButtons:r=>`Variable editor Table Duplicate button ${r}`,tableRowRemoveButtons:r=>`Variable editor Table Remove button ${r}`},Edit:{General:{headerLink:"Variable editor Header link",modeLabelNew:"Variable editor Header mode New",modeLabelEdit:"Variable editor Header mode Edit",generalNameInput:"Variable editor Form Name field",generalNameInputV2:"data-testid Variable editor Form Name field",generalTypeSelect:"Variable editor Form Type select",generalTypeSelectV2:"data-testid Variable editor Form Type select",generalLabelInput:"Variable editor Form Label field",generalLabelInputV2:"data-testid Variable editor Form Label field",generalHideSelect:"Variable editor Form Hide select",generalHideSelectV2:"data-testid Variable editor Form Hide select",selectionOptionsMultiSwitch:"data-testid Variable editor Form Multi switch",selectionOptionsIncludeAllSwitch:"data-testid Variable editor Form IncludeAll switch",selectionOptionsCustomAllInput:"data-testid Variable editor Form IncludeAll field",previewOfValuesOption:"data-testid Variable editor Preview of Values option",submitButton:"data-testid Variable editor Run Query button",applyButton:"data-testid Variable editor Apply button"},QueryVariable:{queryOptionsDataSourceSelect:n.X.DataSourcePicker.inputV2,queryOptionsRefreshSelect:"Variable editor Form Query Refresh select",queryOptionsRefreshSelectV2:"data-testid Variable editor Form Query Refresh select",queryOptionsRegExInput:"Variable editor Form Query RegEx field",queryOptionsRegExInputV2:"data-testid Variable editor Form Query RegEx field",queryOptionsSortSelect:"Variable editor Form Query Sort select",queryOptionsSortSelectV2:"data-testid Variable editor Form Query Sort select",queryOptionsQueryInput:"data-testid Variable editor Form Default Variable Query Editor textarea",valueGroupsTagsEnabledSwitch:"Variable editor Form Query UseTags switch",valueGroupsTagsTagsQueryInput:"Variable editor Form Query TagsQuery field",valueGroupsTagsTagsValuesQueryInput:"Variable editor Form Query TagsValuesQuery field"},ConstantVariable:{constantOptionsQueryInput:"Variable editor Form Constant Query field",constantOptionsQueryInputV2:"data-testid Variable editor Form Constant Query field"},DatasourceVariable:{datasourceSelect:"data-testid datasource variable datasource type"},TextBoxVariable:{textBoxOptionsQueryInput:"Variable editor Form TextBox Query field",textBoxOptionsQueryInputV2:"data-testid Variable editor Form TextBox Query field"},CustomVariable:{customValueInput:"data-testid custom-variable-input"},IntervalVariable:{intervalsValueInput:"data-testid interval variable intervals input",autoEnabledCheckbox:"data-testid interval variable auto value checkbox",stepCountIntervalSelect:"data-testid interval variable step count input",minIntervalInput:"data-testid interval variable mininum interval input"},GroupByVariable:{dataSourceSelect:n.X.DataSourcePicker.inputV2,infoText:"data-testid group by variable info text",modeToggle:"data-testid group by variable mode toggle"},AdHocFiltersVariable:{datasourceSelect:n.X.DataSourcePicker.inputV2,infoText:"data-testid ad-hoc filters variable info text",modeToggle:"data-testid ad-hoc filters variable mode toggle"}}}},Annotations:{marker:"data-testid annotation-marker"},Rows:{Repeated:{ConfigSection:{warningMessage:"data-testid Repeated rows warning message"}}}},Dashboards:{url:"/dashboards",dashboards:r=>`Dashboard search item ${r}`},SaveDashboardAsModal:{newName:"Save dashboard title field",save:"Save dashboard button"},SaveDashboardModal:{save:"Dashboard settings Save Dashboard Modal Save button",saveVariables:"Dashboard settings Save Dashboard Modal Save variables checkbox",saveTimerange:"Dashboard settings Save Dashboard Modal Save timerange checkbox",saveRefresh:"Dashboard settings Save Dashboard Modal Save refresh checkbox"},SharePanelModal:{linkToRenderedImage:"Link to rendered image"},ShareDashboardModal:{PublicDashboard:{Tab:"Tab Public dashboard",WillBePublicCheckbox:"data-testid public dashboard will be public checkbox",LimitedDSCheckbox:"data-testid public dashboard limited datasources checkbox",CostIncreaseCheckbox:"data-testid public dashboard cost may increase checkbox",PauseSwitch:"data-testid public dashboard pause switch",EnableAnnotationsSwitch:"data-testid public dashboard on off switch for annotations",CreateButton:"data-testid public dashboard create button",DeleteButton:"data-testid public dashboard delete button",CopyUrlInput:"data-testid public dashboard copy url input",CopyUrlButton:"data-testid public dashboard copy url button",SettingsDropdown:"data-testid public dashboard settings dropdown",TemplateVariablesWarningAlert:"data-testid public dashboard disabled template variables alert",UnsupportedDataSourcesWarningAlert:"data-testid public dashboard unsupported data sources alert",NoUpsertPermissionsWarningAlert:"data-testid public dashboard no upsert permissions alert",EnableTimeRangeSwitch:"data-testid public dashboard on off switch for time range",EmailSharingConfiguration:{Container:"data-testid email sharing config container",ShareType:"data-testid public dashboard share type",EmailSharingInput:"data-testid public dashboard email sharing input",EmailSharingInviteButton:"data-testid public dashboard email sharing invite button",EmailSharingList:"data-testid public dashboard email sharing list",DeleteEmail:"data-testid public dashboard delete email button",ReshareLink:"data-testid public dashboard reshare link button"}},PublicDashboardScene:{Tab:"Tab Public Dashboard"},SnapshotScene:{url:r=>`/dashboard/snapshot/${r}`,Tab:"Tab Snapshot",PublishSnapshot:"data-testid publish snapshot button",CopyUrlButton:"data-testid snapshot copy url button",CopyUrlInput:"data-testid snapshot copy url input"}},PublicDashboard:{page:"public-dashboard-page",NotAvailable:{container:"public-dashboard-not-available",title:"public-dashboard-title",pausedDescription:"public-dashboard-paused-description"},footer:"public-dashboard-footer"},PublicDashboardScene:{loadingPage:"public-dashboard-scene-loading-page",page:"public-dashboard-scene-page",controls:"public-dashboard-controls"},RequestViewAccess:{form:"request-view-access-form",recipientInput:"request-view-access-recipient-input",submitButton:"request-view-access-submit-button"},PublicDashboardConfirmAccess:{submitButton:"data-testid confirm-access-submit-button"},Explore:{url:"/explore",General:{container:"data-testid Explore",graph:"Explore Graph",table:"Explore Table",scrollView:"data-testid explorer scroll view"},QueryHistory:{container:"data-testid QueryHistory"}},SoloPanel:{url:r=>`/d-solo/${r}`},PluginsList:{page:"Plugins list page",list:"Plugins list",listItem:"Plugins list item",signatureErrorNotice:"data-testid Unsigned plugins notice"},PluginPage:{page:"Plugin page",signatureInfo:"data-testid Plugin signature info",disabledInfo:"data-testid Plugin disabled info"},PlaylistForm:{name:"Playlist name",interval:"Playlist interval",itemDelete:"data-testid playlist-form-delete-item"},BrowseDashboards:{table:{body:"data-testid browse-dashboards-table",row:r=>`data-testid browse dashboards row ${r}`,checkbox:r=>`data-testid ${r} checkbox`},NewFolderForm:{form:"data-testid new folder form",nameInput:"data-testid new-folder-name-input",createButton:"data-testid new-folder-create-button"}},Search:{url:"/?search=openn",FolderView:{url:"/?search=open&layout=folders"}},PublicDashboards:{ListItem:{linkButton:"public-dashboard-link-button",configButton:"public-dashboard-configuration-button",trashcanButton:"public-dashboard-remove-button",pauseSwitch:"data-testid public dashboard pause switch"}},UserListPage:{tabs:{allUsers:"data-testid all-users-tab",orgUsers:"data-testid org-users-tab",anonUserDevices:"data-testid anon-user-devices-tab",publicDashboardsUsers:"data-testid public-dashboards-users-tab",users:"data-testid users-tab"},org:{url:"/org/users"},admin:{url:"/admin/users"},publicDashboards:{container:"data-testid public-dashboards-users-list"},UserListAdminPage:{container:"data-testid user-list-admin-page"},UsersListPage:{container:"data-testid users-list-page"},UserAnonListPage:{container:"data-testid user-anon-list-page"},UsersListPublicDashboardsPage:{container:"data-testid users-list-public-dashboards-page",DashboardsListModal:{listItem:r=>`data-testid dashboards-list-item-${r}`}}},ProfilePage:{url:"/profile"}},components:n.X}},76365:(Q,I,e)=>{"use strict";e.d(I,{S6:()=>s,Jz:()=>g,oA:()=>b,Ik:()=>u});var n=e(11261),a=e(75972),o=e(57875),r=e(5546),i=e(2543);function f(c,y){const p=d(c);return l(p,y,"parents")}function d(c){return c.map(y=>{if(!y.parents?.length)return y;const p={...y,children:[]},v=[{child:p,parent:y.parents[0]}];for(;v.length;){const D=v.shift(),E={...D.parent,children:D.child?[D.child]:[],parents:[]};D.child&&(E.value=D.child.value,D.child.parents=[E]),D.parent.parents?.length&&v.push({child:E,parent:D.parent.parents[0]})}return p})}function l(c,y,p="children"){const v=p==="parents"?"children":"parents",D=[],E=[{previous:void 0,items:c,level:0}];for(;E.length;){const S=E.shift(),T=S.items.flatMap(C=>C.itemIndexes),M={value:S.items.reduce((C,O)=>C+O.value,0),itemIndexes:T,children:[],parents:[],start:0,level:S.level};if(D[S.level]=D[S.level]||[],D[S.level].push(M),S.previous){M[v]=[S.previous];const C=S.previous[p]?.reduce((O,R)=>O+R.value,0)||0;M.start=S.previous.start+C,S.previous[p].push(M)}const A=S.items.flatMap(C=>C[p]||[]),x=(0,i.groupBy)(A,C=>y.getLabel(C.itemIndexes[0]));for(const C of Object.values(x))E.push({previous:M,items:C,level:S.level+1})}return p==="parents"&&(D.reverse(),D.forEach((S,T)=>{S.forEach(M=>{M.level=T})})),D}function m(c,y){const p=[];let v=0,D;const E={};for(let T=0;T<c.data.length;T++){const M=c.getLevel(T),A=T>0?c.getLevel(T-1):void 0;if(p[M]=p[M]||[],A&&A>=M){const C=p[M][p[M].length-1];v=C.start+c.getValue(C.itemIndexes[0])+c.getValueRight(C.itemIndexes[0]),D=C.parents[0]}const x={itemIndexes:[T],value:c.getValue(T)+c.getValueRight(T),valueRight:c.isDiffFlamegraph()?c.getValueRight(T):void 0,start:v,parents:D&&[D],children:[],level:M};E[c.getLabel(T)]?E[c.getLabel(T)].push(x):E[c.getLabel(T)]=[x],D&&D.children.push(x),D=x,p[M].push(x)}const S=new h(y?.collapsingThreshold);return y?.collapsing&&S.addTree(p[0][0]),[p,E,S.getCollapsedMap()]}class s{constructor(y){this.map=new Map,this.map=y||new Map}get(y){return this.map.get(y)}keys(){return this.map.keys()}values(){return this.map.values()}size(){return this.map.size}setCollapsedStatus(y,p){const v=new Map(this.map),D=this.map.get(y),E={...D,collapsed:p};for(const S of D.items)v.set(S,E);return new s(v)}setAllCollapsedStatus(y){const p=new Map(this.map);for(const v of this.map.keys()){const E={...this.map.get(v),collapsed:y};p.set(v,E)}return new s(p)}}class h{constructor(y){this.map=new Map,this.threshold=.99,y!==void 0&&(this.threshold=y)}addTree(y){const p=[y];for(;p.length;){const v=p.shift();v.parents?.length&&this.addItem(v,v.parents[0]),v.children.length&&p.unshift(...v.children)}}addItem(y,p){if(p&&y.value>p.value*this.threshold&&p.children.length===1)if(this.map.has(p)){const v=this.map.get(p);this.map.set(y,v),v.items.push(y)}else{const v={items:[p,y],collapsed:!0};this.map.set(p,v),this.map.set(y,v)}}getCollapsedMap(){return new s(this.map)}}function u(c){return c.missingFields.length?`Data is missing fields: ${c.missingFields.join(", ")}`:c.wrongTypeFields.length?`Data has fields of wrong type: ${c.wrongTypeFields.map(y=>`${y.name} has type ${y.type} but should be ${y.expectedTypes.join(" or ")}`).join(", ")}`:""}function b(c){const y=[["label",[n.PU.string,n.PU.enum]],["level",[n.PU.number]],["value",[n.PU.number]],["self",[n.PU.number]]],p=[],v=[];for(const D of y){const[E,S]=D,T=c.fields.find(M=>M.name===E);if(!T){p.push(E);continue}S.includes(T.type)||v.push({name:E,expectedTypes:S,type:T.type})}if(p.length>0||v.length>0)return{wrongTypeFields:v,missingFields:p}}class g{constructor(y,p,v=(0,a.a)()){this.data=y,this.options=p;const D=b(y);if(D)throw new Error(u(D));if(this.labelField=y.fields.find(S=>S.name==="label"),this.levelField=y.fields.find(S=>S.name==="level"),this.valueField=y.fields.find(S=>S.name==="value"),this.selfField=y.fields.find(S=>S.name==="self"),this.valueRightField=y.fields.find(S=>S.name==="valueRight"),this.selfRightField=y.fields.find(S=>S.name==="selfRight"),(this.valueField||this.selfField)&&!(this.valueField&&this.selfField))throw new Error("Malformed dataFrame: both valueRight and selfRight has to be present if one of them is present.");const E=this.labelField?.config?.type?.enum;E?(this.labelDisplayProcessor=(0,o.J)({field:this.labelField,theme:v}),this.uniqueLabels=E.text||[]):(this.labelDisplayProcessor=S=>({text:S+"",numeric:0}),this.uniqueLabels=[...new Set(this.labelField.values)]),this.valueDisplayProcessor=(0,o.J)({field:this.valueField,theme:v})}isDiffFlamegraph(){return!!(this.valueRightField&&this.selfRightField)}getLabel(y){return this.labelDisplayProcessor(this.labelField.values[y]).text}getLevel(y){return this.levelField.values[y]}getValue(y){return P(this.valueField,y)}getValueRight(y){return P(this.valueRightField,y)}getSelf(y){return P(this.selfField,y)}getSelfRight(y){return P(this.selfRightField,y)}getSelfDisplay(y){return this.valueDisplayProcessor(this.getSelf(y))}getUniqueLabels(){return this.uniqueLabels}getUnitTitle(){switch(this.valueField.config.unit){case r.Zk.Bytes:return"RAM";case r.Zk.Nanoseconds:return"Time"}return"Count"}getLevels(){return this.initLevels(),this.levels}getSandwichLevels(y){const p=this.getNodesWithLabel(y);if(!p?.length)return[[],[]];const v=f(p,this),D=l(p,this);return[v,D]}getNodesWithLabel(y){return this.initLevels(),this.uniqueLabelsMap[y]}getCollapsedMap(){return this.initLevels(),this.collapsedMap}initLevels(){if(!this.levels){const[y,p,v]=m(this,this.options);this.levels=y,this.uniqueLabelsMap=p,this.collapsedMap=v}}}function P(c,y){return c?(typeof y=="number"?[y]:y).reduce((v,D)=>v+c.values[D],0):0}},85194:(Q,I,e)=>{"use strict";e.d(I,{A:()=>Yn});var n=e(32196),a=e(53076),o=e(96540),r=e(49185),i=e(60578),f=e(14578);const d=22*window.devicePixelRatio,l=10*window.devicePixelRatio,m=.5*window.devicePixelRatio,s=20*window.devicePixelRatio,h=.5*window.devicePixelRatio,u=4*window.devicePixelRatio,b=3*window.devicePixelRatio,g=3*window.devicePixelRatio,P=4*window.devicePixelRatio,c=2*window.devicePixelRatio,y=800,p=120;var v=e(64539),D=e(59093),E=e(28122);const T=({data:nt,itemData:yt,onMenuItemClick:Vt,onItemFocus:je,onSandwich:tt,collapseConfig:Dt,onExpandGroup:Ot,onCollapseGroup:Lt,onExpandAllGroups:Gt,onCollapseAllGroups:hn,getExtraContextMenuButtons:mt,collapsing:Bt,allGroupsExpanded:Jt,allGroupsCollapsed:Rn,selectedView:Mt,search:wt})=>{function Ht(){const tn=mt?.(yt,nt.data,{selectedView:Mt,isDiff:nt.isDiffFlamegraph(),search:wt,collapseConfig:Dt})||[];return o.createElement(o.Fragment,null,o.createElement(v.D,{label:"Focus block",icon:"eye",onClick:()=>{je(),Vt()}}),o.createElement(v.D,{label:"Copy function name",icon:"copy",onClick:()=>{navigator.clipboard.writeText(yt.label).then(()=>{Vt()})}}),o.createElement(v.D,{label:"Sandwich view",icon:"gf-show-context",onClick:()=>{tt(),Vt()}}),tn.map(({label:It,icon:Xe,onClick:jn})=>o.createElement(v.D,{label:It,icon:Xe,onClick:()=>jn(),key:It})),Bt&&o.createElement(D.r,{label:"Grouping"},Dt?Dt.collapsed?o.createElement(v.D,{label:"Expand group",icon:"angle-double-down",onClick:()=>{Ot(),Vt()}}):o.createElement(v.D,{label:"Collapse group",icon:"angle-double-up",onClick:()=>{Lt(),Vt()}}):null,!Jt&&o.createElement(v.D,{label:"Expand all groups",icon:"angle-double-down",onClick:()=>{Gt(),Vt()}}),!Rn&&o.createElement(v.D,{label:"Collapse all groups",icon:"angle-double-up",onClick:()=>{hn(),Vt()}})))}return o.createElement("div",{"data-testid":"contextMenu"},o.createElement(E.t,{renderMenuItems:Ht,x:yt.posX+10,y:yt.posY,focusOnOpen:!1}))};var M=e(83195),A=e(40845),x=e(48840),C=e(17464),O=e(69503);const R=({data:nt,item:yt,totalTicks:Vt,position:je,collapseConfig:tt})=>{const Dt=(0,A.of)(K);if(!(yt&&je))return null;let Ot;if(nt.isDiffFlamegraph()){const Lt=N(nt,yt,Vt);Ot=o.createElement(x.j,{className:Dt.tooltipTable,columns:[{id:"label",header:""},{id:"baseline",header:"Baseline"},{id:"comparison",header:"Comparison"},{id:"diff",header:"Diff"}],data:Lt,getRowId:Gt=>Gt.rowId})}else{const Lt=L(nt,yt,Vt);Ot=o.createElement("p",{className:Dt.lastParagraph},Lt.unitTitle,o.createElement("br",null),"Total: ",o.createElement("b",null,Lt.unitValue)," (",Lt.percentValue,"%)",o.createElement("br",null),"Self: ",o.createElement("b",null,Lt.unitSelf)," (",Lt.percentSelf,"%)",o.createElement("br",null),"Samples: ",o.createElement("b",null,Lt.samples))}return o.createElement(C.ZL,null,o.createElement(O.o,{className:Dt.tooltipContainer,position:je,offset:{x:15,y:0}},o.createElement("div",{className:Dt.tooltipContent},o.createElement("p",{className:Dt.tooltipName},nt.getLabel(yt.itemIndexes[0]),tt&&tt.collapsed?o.createElement("span",null,o.createElement("br",null),"and ",tt.items.length," similar items"):""),Ot)))},L=(nt,yt,Vt)=>{const je=nt.valueDisplayProcessor(yt.value),tt=nt.getSelfDisplay(yt.itemIndexes),Dt=Math.round(1e4*(je.numeric/Vt))/100,Ot=Math.round(1e4*(tt.numeric/Vt))/100;let Lt=je.text+je.suffix,Gt=tt.text+tt.suffix;const hn=nt.getUnitTitle();return hn==="Count"&&(je.suffix||(Lt=je.text),tt.suffix||(Gt=tt.text)),{percentValue:Dt,percentSelf:Ot,unitTitle:hn,unitValue:Lt,unitSelf:Gt,samples:je.numeric.toLocaleString()}},N=(nt,yt,Vt)=>{const tt=nt.getLevels()[0][0].valueRight,Dt=Vt-tt,Ot=yt.value-yt.valueRight,Lt=Math.round(1e4*Ot/Dt)/100,Gt=Math.round(1e4*yt.valueRight/tt)/100,hn=(Gt-Lt)/Lt*100,mt=F(nt,nt.valueDisplayProcessor(Ot)),Bt=F(nt,nt.valueDisplayProcessor(yt.valueRight)),Jt=(0,M.j_)("short");return[{rowId:"1",label:"% of total",baseline:Lt+"%",comparison:Gt+"%",diff:Jt(hn).text+"%"},{rowId:"2",label:"Value",baseline:mt,comparison:Bt,diff:F(nt,nt.valueDisplayProcessor(yt.valueRight-Ot))},{rowId:"3",label:"Samples",baseline:Jt(Ot).text,comparison:Jt(yt.valueRight).text,diff:Jt(yt.valueRight-Ot).text}]};function F(nt,yt){let Vt=yt.text+yt.suffix;return nt.getUnitTitle()==="Count"&&(yt.suffix||(Vt=yt.text)),Vt}const K=nt=>({tooltipContainer:(0,n.css)({title:"tooltipContainer",overflow:"hidden"}),tooltipContent:(0,n.css)({title:"tooltipContent",fontSize:nt.typography.bodySmall.fontSize,width:"100%"}),tooltipName:(0,n.css)({title:"tooltipName",marginTop:0,wordBreak:"break-all"}),lastParagraph:(0,n.css)({title:"lastParagraph",marginBottom:0}),name:(0,n.css)({title:"name",marginBottom:"10px"}),tooltipTable:(0,n.css)({title:"tooltipTable",maxWidth:"400px"})}),B=R;var w=e(84140),U=e(5546),W=e(21313);function V(nt,yt=0){let Vt,je,tt,Dt,Ot,Lt,Gt,hn;for(Vt=nt.length&3,je=nt.length-Vt,tt=yt,Ot=3432918353,Lt=461845907,hn=0;hn<je;)Gt=nt.charCodeAt(hn)&255|(nt.charCodeAt(++hn)&255)<<8|(nt.charCodeAt(++hn)&255)<<16|(nt.charCodeAt(++hn)&255)<<24,++hn,Gt=(Gt&65535)*Ot+(((Gt>>>16)*Ot&65535)<<16)&4294967295,Gt=Gt<<15|Gt>>>17,Gt=(Gt&65535)*Lt+(((Gt>>>16)*Lt&65535)<<16)&4294967295,tt^=Gt,tt=tt<<13|tt>>>19,Dt=(tt&65535)*5+(((tt>>>16)*5&65535)<<16)&4294967295,tt=(Dt&65535)+27492+(((Dt>>>16)+58964&65535)<<16);switch(Gt=0,Vt){case 3:Gt^=(nt.charCodeAt(hn+2)&255)<<16;case 2:Gt^=(nt.charCodeAt(hn+1)&255)<<8;case 1:Gt^=nt.charCodeAt(hn)&255;default:Gt=(Gt&65535)*Ot+(((Gt>>>16)*Ot&65535)<<16)&4294967295,Gt=Gt<<15|Gt>>>17,Gt=(Gt&65535)*Lt+(((Gt>>>16)*Lt&65535)<<16)&4294967295,tt^=Gt}return tt^=nt.length,tt^=tt>>>16,tt=(tt&65535)*2246822507+(((tt>>>16)*2246822507&65535)<<16)&4294967295,tt^=tt>>>13,tt=(tt&65535)*3266489909+(((tt>>>16)*3266489909&65535)<<16)&4294967295,tt^=tt>>>16,tt>>>0}const _=[(0,w.A)({h:24,s:69,l:60}),(0,w.A)({h:34,s:65,l:65}),(0,w.A)({h:194,s:52,l:61}),(0,w.A)({h:163,s:45,l:55}),(0,w.A)({h:211,s:48,l:60}),(0,w.A)({h:246,s:40,l:65}),(0,w.A)({h:305,s:63,l:79}),(0,w.A)({h:47,s:100,l:73}),(0,w.A)({r:183,g:219,b:171}),(0,w.A)({r:244,g:213,b:152}),(0,w.A)({r:78,g:146,b:249}),(0,w.A)({r:249,g:186,b:143}),(0,w.A)({r:242,g:145,b:145}),(0,w.A)({r:130,g:181,b:216}),(0,w.A)({r:229,g:168,b:226}),(0,w.A)({r:174,g:162,b:224}),(0,w.A)({r:154,g:196,b:138}),(0,w.A)({r:242,g:201,b:109}),(0,w.A)({r:101,g:197,b:219}),(0,w.A)({r:249,g:147,b:78}),(0,w.A)({r:234,g:100,b:96}),(0,w.A)({r:81,g:149,b:206}),(0,w.A)({r:214,g:131,b:206}),(0,w.A)({r:128,g:110,b:183})],H=oe(1,100,0,1),G=oe(100,100,0,1),j=`linear-gradient(90deg, ${H} 0%, ${G} 100%)`,Y=`linear-gradient(90deg, ${_[0]} 0%, ${_[2]} 30%, ${_[6]} 50%, ${_[7]} 70%, ${_[8]} 100%)`;function oe(nt,yt,Vt,je){const tt=Math.min(1,nt/yt/(je-Vt)),Dt=50-50*tt,Ot=65+7*tt;return(0,w.A)({h:Dt,s:100,l:Ot})}function se(nt,yt){const Vt=de(nt),tt=V(Vt||"",0)%_.length;let Dt=_[tt].clone();return yt.isLight&&(Dt=Dt.brighten(15)),Dt}const ne=["rgb(0, 170, 0)","rgb(148, 142, 142)","rgb(200, 0, 0)"],ee=`linear-gradient(90deg, ${ne[0]} 0%, ${ne[1]} 50%, ${ne[2]} 100%)`,Z=["rgb(26, 133, 255)","rgb(148, 142, 142)","rgb(220, 50, 32)"],z=`linear-gradient(90deg, ${Z[0]} 0%, ${Z[1]} 50%, ${Z[2]} 100%)`;function q(nt,yt,Vt,je,tt){const Dt=tt===U.yU.Default?ne:Z,Ot=(0,W.scaleLinear)().domain([-100,0,100]).range(Dt),Lt=nt-yt,Gt=Vt-je;if(je===0||Gt===0){const Rn=Ot(0);return(0,w.A)(Rn)}const hn=Math.round(1e4*Lt/Gt)/100,Bt=(Math.round(1e4*yt/je)/100-hn)/hn*100,Jt=Ot(Bt);return(0,w.A)(Jt)}const ie=[["phpspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.php+)(?<line_info>.*)$/],["pyspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.py+)(?<line_info>.*)$/],["rbspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.rb+)(?<line_info>.*)$/],["nodespy",/^(\.\/node_modules\/)?(?<packageName>[^/]*)(?<filename>.*\.?(jsx?|tsx?)?):(?<functionName>.*):(?<line_info>.*)$/],["gospy",/^(?<packageName>.*?\/.*?\.|.*?\.|.+)(?<functionName>.*)$/],["javaspy",/^(?<packageName>.+\/)(?<filename>.+\.)(?<functionName>.+)$/],["dotnetspy",/^(?<packageName>.+)\.(.+)\.(.+)\(.*\)$/],["tracing",/^(?<packageName>.+?):.*$/],["pyroscope-rs",/^(?<packageName>[^::]+)/],["ebpfspy",/^(?<packageName>.+)$/],["unknown",/^(?<packageName>.+)$/]];function de(nt){for(const[yt,Vt]of ie){const je=nt.match(Vt);if(je)return je.groups?.packageName||""}}function ue(nt){const{canvasRef:yt,data:Vt,root:je,depth:tt,direction:Dt,wrapperWidth:Ot,rangeMin:Lt,rangeMax:Gt,matchedLabels:hn,textAlign:mt,totalViewTicks:Bt,totalColorTicks:Jt,totalTicksRight:Rn,colorScheme:Mt,focusedItemData:wt,collapsedMap:Ht}=nt,tn=me(yt,Ot,tt),It=(0,A.$j)(),Xe=(0,o.useMemo)(()=>{const ia=(0,w.A)(It.colors.background.secondary);return It.isLight?ia.darken(10).toHexString():ia.lighten(10).toHexString()},[It]),jn=ce(Jt,Rn,Mt,It,Xe,Lt,Gt,hn,wt?wt.item.level:0),Qn=fe(tn,Vt,jn,mt,Ht);(0,o.useEffect)(()=>{if(!tn)return;tn.clearRect(0,0,tn.canvas.width,tn.canvas.height);const ia=new Path2D;he(je,Dt,Vt,Bt,Lt,Gt,Ot,Ht,(wn,sa,La,xa,ga,Ts,Us)=>{Us?ia.rect(sa,La,xa,ga):Qn(wn,sa,La,xa,ga,Ts)}),tn.fillStyle=Xe,tn.fill(ia)},[tn,Vt,je,Ot,Lt,Gt,Bt,Dt,Qn,Ht,Xe])}function fe(nt,yt,Vt,je,tt){return(0,o.useMemo)(()=>nt?(Ot,Lt,Gt,hn,mt,Bt)=>{nt.beginPath(),nt.rect(Lt+h,Gt,hn,mt),nt.fillStyle=Vt(Ot,Bt,!1),nt.stroke(),nt.fill();const Jt=tt.get(Ot);let Rn=Bt;Jt&&Jt.collapsed&&(Rn=`(${Jt.items.length}) `+Bt),hn>=s&&(Jt?(pe(nt,yt,Rn,Ot,hn,je==="left"?Lt+P+c:Lt,Gt,je),Se(nt,Lt,Gt,mt,Ot,Jt)):pe(nt,yt,Rn,Ot,hn,Lt,Gt,je))}:()=>{},[nt,Vt,je,yt,tt])}function Se(nt,yt,Vt,je,tt,Dt){const Ot=yt+P;nt.beginPath(),nt.rect(yt,Vt,Ot-yt+b+g,je),nt.fill(),nt.beginPath(),Dt.collapsed?nt.rect(Ot,Vt+je/4,b,je/2):Dt.items[0]===tt?nt.rect(Ot,Vt+je/2,b,je/2):Dt.items[Dt.items.length-1]===tt?nt.rect(Ot,Vt,b,je/2):nt.rect(Ot,Vt,b,je),nt.fillStyle="#666",nt.fill()}function he(nt,yt,Vt,je,tt,Dt,Ot,Lt,Gt){const hn=[];hn.push({item:nt,levelOffset:0});const mt=Ot*window.devicePixelRatio/je/(Dt-tt);let Bt;for(;hn.length>0;){const{item:Jt,levelOffset:Rn}=hn.shift();let Mt=Jt.value;const wt=Mt*mt<=l,Ht=Mt*mt-(wt?0:h*2),tn=d;if(Ht<m)continue;let It=0,Xe=!1;const jn=Lt.get(Jt),Qn=jn&&jn.collapsed;if(Qn&&Bt===jn.items[0]?(It=yt==="children"?-1:1,Xe=!0):Bt=void 0,!Xe){const wn=ye(Jt.start,je,tt,mt),sa=(Jt.level+Rn)*d;let La=Vt.getLabel(Jt.itemIndexes[0]);Qn&&(Bt=Jt),Gt(Jt,wn,sa,Ht,tn,La,wt)}const ia=yt==="children"?Jt.children:Jt.parents;ia&&hn.unshift(...ia.map(wn=>({item:wn,levelOffset:Rn+It})))}}function ce(nt,yt,Vt,je,tt,Dt,Ot,Lt,Gt){return(0,o.useCallback)(function(mt,Bt,Jt){if(Jt&&!Lt)return tt;const Rn=mt.valueRight!==void 0&&(Vt===U.yU.Default||Vt===U.yU.DiffColorBlind)?q(mt.value,mt.valueRight,nt,yt,Vt):Vt===U.zM.ValueBased?oe(mt.value,nt,Dt,Ot):se(Bt,je);return Lt?Lt.has(Bt)?Rn.toHslString():tt:mt.level>Gt-1?Rn.toHslString():Rn.lighten(15).toHslString()},[nt,yt,Vt,je,Dt,Ot,Lt,Gt,tt])}function me(nt,yt,Vt){const[je,tt]=(0,o.useState)();return(0,o.useEffect)(()=>{if(!(Vt&&nt.current))return;const Dt=nt.current.getContext("2d"),Ot=d*Vt;nt.current.width=Math.round(yt*window.devicePixelRatio),nt.current.height=Math.round(Ot),nt.current.style.width=`${yt}px`,nt.current.style.height=`${Ot/window.devicePixelRatio}px`,Dt.textBaseline="middle",Dt.font=12*window.devicePixelRatio+"px monospace",Dt.strokeStyle="white",tt(Dt)},[nt,tt,yt,Vt]),je}function pe(nt,yt,Vt,je,tt,Dt,Ot,Lt){nt.save(),nt.clip(),nt.fillStyle="#222";const Gt=yt.valueDisplayProcessor(je.value),hn=Gt.suffix?Gt.text+Gt.suffix:Gt.text,mt=nt.measureText(Vt),Bt=tt-u;let Jt=`${Vt} (${hn})`,Rn=Math.max(Dt,0)+u;mt.width>Bt&&(nt.textAlign=Lt,Lt==="right"&&(Jt=Vt,Rn=Dt+tt-u)),nt.fillText(Jt,Rn,Ot+d/2+2),nt.restore()}function ye(nt,yt,Vt,je){return(nt-yt*Vt)*je}const Pe=({data:nt,rangeMin:yt,rangeMax:Vt,matchedLabels:je,setRangeMin:tt,setRangeMax:Dt,onItemFocused:Ot,focusedItemData:Lt,textAlign:Gt,onSandwich:hn,colorScheme:mt,totalProfileTicks:Bt,totalProfileTicksRight:Jt,totalViewTicks:Rn,root:Mt,direction:wt,depth:Ht,showFlameGraphOnly:tn,collapsedMap:It,setCollapsedMap:Xe,collapsing:jn,getExtraContextMenuButtons:Qn,selectedView:ia,search:wn})=>{const sa=Ie(),[La,{width:xa}]=(0,r.A)(),ga=(0,o.useRef)(null),[Ts,Us]=(0,o.useState)(),[Bs,ks]=(0,o.useState)();ue({canvasRef:ga,colorScheme:mt,data:nt,focusedItemData:Lt,root:Mt,direction:wt,depth:Ht,rangeMax:Vt,rangeMin:yt,matchedLabels:je,textAlign:Gt,totalViewTicks:Rn,totalColorTicks:nt.isDiffFlamegraph()?Bt:Rn,totalTicksRight:Jt,wrapperWidth:xa,collapsedMap:It});const Ms=(0,o.useCallback)(Gs=>{Us(void 0);const Br=ga.current.clientWidth/Rn/(Vt-yt),Mr=Oe({x:Gs.nativeEvent.offsetX,y:Gs.nativeEvent.offsetY},Mt,wt,Ht,Br,Rn,yt,It);ks(Mr?{posY:Gs.clientY,posX:Gs.clientX,item:Mr,label:nt.getLabel(Mr.itemIndexes[0])}:void 0)},[nt,yt,Vt,Rn,Mt,wt,Ht,It]),[Dr,_s]=(0,o.useState)(),Ir=(0,o.useCallback)(Gs=>{if(Bs===void 0){Us(void 0),_s(void 0);const Br=ga.current.clientWidth/Rn/(Vt-yt),Mr=Oe({x:Gs.nativeEvent.offsetX,y:Gs.nativeEvent.offsetY},Mt,wt,Ht,Br,Rn,yt,It);Mr&&(_s({x:Gs.clientX,y:Gs.clientY}),Us(Mr))}},[yt,Vt,Rn,Bs,_s,Mt,wt,Ht,It]),Xs=(0,o.useCallback)(()=>{Us(void 0)},[]);return(0,o.useEffect)(()=>{const Gs=Br=>{Br.target instanceof HTMLElement&&Br.target.parentElement?.id!=="flameGraphCanvasContainer_clickOutsideCheck"&&ks(void 0)};return window.addEventListener("click",Gs),()=>window.removeEventListener("click",Gs)},[ks]),o.createElement("div",{className:sa.graph},o.createElement("div",{className:sa.canvasWrapper,id:"flameGraphCanvasContainer_clickOutsideCheck",ref:La},o.createElement("canvas",{ref:ga,"data-testid":"flameGraph",onClick:Ms,onMouseMove:Ir,onMouseLeave:Xs})),o.createElement(B,{position:Dr,item:Ts,data:nt,totalTicks:Rn,collapseConfig:Ts?It.get(Ts):void 0}),!tn&&Bs&&o.createElement(T,{data:nt,itemData:Bs,collapsing:jn,collapseConfig:It.get(Bs.item),onMenuItemClick:()=>{ks(void 0)},onItemFocus:()=>{tt(Bs.item.start/Rn),Dt((Bs.item.start+Bs.item.value)/Rn),Ot(Bs)},onSandwich:()=>{hn(nt.getLabel(Bs.item.itemIndexes[0]))},onExpandGroup:()=>{Xe(It.setCollapsedStatus(Bs.item,!1))},onCollapseGroup:()=>{Xe(It.setCollapsedStatus(Bs.item,!0))},onExpandAllGroups:()=>{Xe(It.setAllCollapsedStatus(!1))},onCollapseAllGroups:()=>{Xe(It.setAllCollapsedStatus(!0))},allGroupsCollapsed:Array.from(It.values()).every(Gs=>Gs.collapsed),allGroupsExpanded:Array.from(It.values()).every(Gs=>!Gs.collapsed),getExtraContextMenuButtons:Qn,selectedView:ia,search:wn}))},Ie=()=>({graph:(0,n.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),canvasContainer:(0,n.css)({label:"canvasContainer",display:"flex"}),canvasWrapper:(0,n.css)({label:"canvasWrapper",cursor:"pointer",flex:1,overflow:"hidden"}),sandwichMarker:(0,n.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerIcon:(0,n.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})}),Oe=(nt,yt,Vt,je,tt,Dt,Ot,Lt)=>{let Gt=yt,hn=Vt==="children"?0:je-1;const mt=Math.floor(nt.y/(d/window.devicePixelRatio));let Bt;for(;Gt;){const Jt=Gt;if(Gt=void 0,hn===mt){Bt=Jt;break}const Rn=Vt==="children"?Jt.children:Jt.parents||[];for(const Mt of Rn){const wt=ye(Mt.start,Dt,Ot,tt),Ht=ye(Mt.start+Mt.value,Dt,Ot,tt);if(wt<=nt.x&&nt.x<Ht){Gt=Mt;const tn=Lt.get(Mt);(!tn||!tn.collapsed||tn.items[0]===Mt)&&(hn=hn+(Vt==="children"?1:-1));break}}}return Bt},Ne=Pe;var We=e(29158);const Ae=o.memo(({data:nt,focusedItem:yt,totalTicks:Vt,sandwichedLabel:je,onFocusPillClick:tt,onSandwichPillClick:Dt})=>{const Ot=(0,A.of)(Ue),Lt=[],Gt=(0,M.j_)("short")(Vt),hn=nt.valueDisplayProcessor(Vt);let mt=hn.text+hn.suffix;const Bt=nt.getUnitTitle();if(Bt==="Count"&&(hn.suffix||(mt=hn.text)),Lt.push(o.createElement("div",{className:Ot.metadataPill,key:"default"},mt," | ",Gt.text,Gt.suffix," samples (",Bt,")")),je&&Lt.push(o.createElement("span",{key:"sandwich"},o.createElement(f.I,{size:"sm",name:"angle-right"}),o.createElement("div",{className:Ot.metadataPill},o.createElement(f.I,{size:"sm",name:"gf-show-context"})," ",o.createElement("span",{className:Ot.metadataPillName},je.substring(je.lastIndexOf("/")+1)),o.createElement(We.K,{className:Ot.pillCloseButton,name:"times",size:"sm",onClick:Dt,tooltip:"Remove sandwich view","aria-label":"Remove sandwich view"})))),yt){const Jt=Math.round(1e4*(yt.item.value/Vt))/100;Lt.push(o.createElement("span",{key:"focus"},o.createElement(f.I,{size:"sm",name:"angle-right"}),o.createElement("div",{className:Ot.metadataPill},o.createElement(f.I,{size:"sm",name:"eye"})," ",Jt,"% of total",o.createElement(We.K,{className:Ot.pillCloseButton,name:"times",size:"sm",onClick:tt,tooltip:"Remove focus","aria-label":"Remove focus"}))))}return o.createElement("div",{className:Ot.metadata},Lt)});Ae.displayName="FlameGraphMetadata";const Ue=nt=>({metadataPill:(0,n.css)({label:"metadataPill",display:"inline-flex",alignItems:"center",background:nt.colors.background.secondary,borderRadius:nt.shape.borderRadius(8),padding:nt.spacing(.5,1),fontSize:nt.typography.bodySmall.fontSize,fontWeight:nt.typography.fontWeightMedium,lineHeight:nt.typography.bodySmall.lineHeight,color:nt.colors.text.secondary}),pillCloseButton:(0,n.css)({label:"pillCloseButton",verticalAlign:"text-bottom",margin:nt.spacing(0,.5)}),metadata:(0,n.css)({margin:"8px 0",textAlign:"center"}),metadataPillName:(0,n.css)({label:"metadataPillName",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginLeft:nt.spacing(.5)})}),Me=Ae,$e=({data:nt,rangeMin:yt,rangeMax:Vt,matchedLabels:je,setRangeMin:tt,setRangeMax:Dt,onItemFocused:Ot,focusedItemData:Lt,textAlign:Gt,onSandwich:hn,sandwichItem:mt,onFocusPillClick:Bt,onSandwichPillClick:Jt,colorScheme:Rn,showFlameGraphOnly:Mt,getExtraContextMenuButtons:wt,collapsing:Ht,selectedView:tn,search:It,collapsedMap:Xe,setCollapsedMap:jn})=>{const Qn=ke(),[ia,wn]=(0,o.useState)(),[sa,La]=(0,o.useState)(),[xa,ga]=(0,o.useState)(0),[Ts,Us]=(0,o.useState)(),[Bs,ks]=(0,o.useState)(0);if((0,o.useEffect)(()=>{if(nt){let _s=nt.getLevels(),Ir=_s.length?_s[0][0].value:0,Xs=_s.length?_s[0][0].valueRight:void 0,Gs=Ir,Br;if(mt){const[Mr,vr]=nt.getSandwichLevels(mt);_s=vr,Br=Mr,Gs=vr[0]?.[0]?.value??0}wn(_s),La(Br),ga(Ir),Us(Xs),ks(Gs)}},[nt,mt]),!ia)return null;const Ms={data:nt,rangeMin:yt,rangeMax:Vt,matchedLabels:je,setRangeMin:tt,setRangeMax:Dt,onItemFocused:Ot,focusedItemData:Lt,textAlign:Gt,onSandwich:hn,colorScheme:Rn,totalProfileTicks:xa,totalProfileTicksRight:Ts,totalViewTicks:Bs,showFlameGraphOnly:Mt,collapsedMap:Xe,setCollapsedMap:jn,getExtraContextMenuButtons:wt,collapsing:Ht,search:It,selectedView:tn},Dr=sa?o.createElement(o.Fragment,null,o.createElement("div",{className:Qn.sandwichCanvasWrapper},o.createElement("div",{className:Qn.sandwichMarker},"Callers",o.createElement(f.I,{className:Qn.sandwichMarkerIcon,name:"arrow-down"})),o.createElement(Ne,{...Ms,root:sa[sa.length-1][0],depth:sa.length,direction:"parents",collapsing:!1})),o.createElement("div",{className:Qn.sandwichCanvasWrapper},o.createElement("div",{className:(0,n.cx)(Qn.sandwichMarker,Qn.sandwichMarkerCalees)},o.createElement(f.I,{className:Qn.sandwichMarkerIcon,name:"arrow-up"}),"Callees"),o.createElement(Ne,{...Ms,root:ia[0][0],depth:ia.length,direction:"children",collapsing:!1}))):o.createElement(Ne,{...Ms,root:ia[0][0],depth:ia.length,direction:"children"});return o.createElement("div",{className:Qn.graph},o.createElement(Me,{data:nt,focusedItem:Lt,sandwichedLabel:mt,totalTicks:Bs,onFocusPillClick:Bt,onSandwichPillClick:Jt}),Dr)},ke=()=>({graph:(0,n.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),sandwichCanvasWrapper:(0,n.css)({label:"sandwichCanvasWrapper",display:"flex",marginBottom:`${d/window.devicePixelRatio}px`}),sandwichMarker:(0,n.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerCalees:(0,n.css)({label:"sandwichMarkerCalees",textAlign:"right"}),sandwichMarkerIcon:(0,n.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})}),Ze=$e;var ot=e(76365),xt=e(75198),ct=e(80292),ft=e(55852),Le=e(10354),re=e(19727),X=e(94354),le=e(38138),be=e(83122);const De=({search:nt,setSearch:yt,selectedView:Vt,setSelectedView:je,containerWidth:tt,onReset:Dt,textAlign:Ot,onTextAlignChange:Lt,showResetButton:Gt,colorScheme:hn,onColorSchemeChange:mt,stickyHeader:Bt,extraHeaderElements:Jt,vertical:Rn,isDiffMode:Mt,setCollapsedMap:wt,collapsedMap:Ht})=>{const tn=(0,A.of)(ht),[It,Xe]=Ve(nt,yt),jn=It!==""?o.createElement(ft.$n,{icon:"times",fill:"text",size:"sm",onClick:()=>{yt(""),Xe("")}},"Clear"):null;return o.createElement("div",{className:(0,n.cx)(tn.header,{[tn.stickyHeader]:Bt})},o.createElement("div",{className:tn.inputContainer},o.createElement(Le.p,{value:It||"",onChange:Qn=>{Xe(Qn.currentTarget.value)},placeholder:"Search...",suffix:jn})),o.createElement("div",{className:tn.rightContainer},Gt&&o.createElement(ft.$n,{variant:"secondary",fill:"outline",size:"sm",icon:"history-alt",tooltip:"Reset focus and sandwich state",onClick:()=>{Dt()},className:tn.buttonSpacing,"aria-label":"Reset focus and sandwich state"}),o.createElement(Te,{value:hn,onChange:mt,isDiffMode:Mt}),o.createElement(re.e,{className:tn.buttonSpacing},o.createElement(ft.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Expand all groups",onClick:()=>{wt(Ht.setAllCollapsedStatus(!1))},"aria-label":"Expand all groups",icon:"angle-double-down",disabled:Vt===U.F8.TopTable}),o.createElement(ft.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Collapse all groups",onClick:()=>{wt(Ht.setAllCollapsedStatus(!0))},"aria-label":"Collapse all groups",icon:"angle-double-up",disabled:Vt===U.F8.TopTable})),o.createElement(X.z,{size:"sm",disabled:Vt===U.F8.TopTable,options:we,value:Ot,onChange:Lt,className:tn.buttonSpacing}),o.createElement(X.z,{size:"sm",options:Ke(tt,Rn),value:Vt,onChange:je}),Jt&&o.createElement("div",{className:tn.extraElements},Jt)))};function Te(nt){const yt=(0,A.of)(ht);let Vt=o.createElement(le.W,null,o.createElement(le.W.Item,{label:"By package name",onClick:()=>nt.onChange(U.zM.PackageBased)}),o.createElement(le.W.Item,{label:"By value",onClick:()=>nt.onChange(U.zM.ValueBased)}));const je={[U.zM.ValueBased]:yt.colorDotByValue,[U.zM.PackageBased]:yt.colorDotByPackage,[U.yU.DiffColorBlind]:yt.colorDotDiffColorBlind,[U.yU.Default]:yt.colorDotDiffDefault}[nt.value]||yt.colorDotByValue;let tt=o.createElement("span",{className:(0,n.cx)(yt.colorDot,je)});return nt.isDiffMode&&(Vt=o.createElement(le.W,null,o.createElement(le.W.Item,{label:"Default (green to red)",onClick:()=>nt.onChange(U.yU.Default)}),o.createElement(le.W.Item,{label:"Color blind (blue to red)",onClick:()=>nt.onChange(U.yU.DiffColorBlind)})),tt=o.createElement("div",{className:(0,n.cx)(yt.colorDotDiff,je)},o.createElement("div",null,"-100% (removed)"),o.createElement("div",null,"0%"),o.createElement("div",null,"+100% (added)"))),o.createElement(be.m,{overlay:Vt},o.createElement(ft.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Change color scheme",onClick:()=>{},className:yt.buttonSpacing,"aria-label":"Change color scheme"},tt))}const we=[{value:"left",description:"Align text left",icon:"align-left"},{value:"right",description:"Align text right",icon:"align-right"}];function Ke(nt,yt){let Vt=[{value:U.F8.TopTable,label:"Top Table",description:"Only show top table"},{value:U.F8.FlameGraph,label:"Flame Graph",description:"Only show flame graph"}];return(nt>=y||yt)&&Vt.push({value:U.F8.Both,label:"Both",description:"Show both the top table and flame graph"}),Vt}function Ve(nt,yt){const[Vt,je]=(0,o.useState)(nt),tt=(0,ct.A)(nt);return(0,xt.A)(()=>{yt(Vt)},250,[Vt]),(0,o.useEffect)(()=>{tt!==nt&&nt!==Vt&&je(nt)},[nt,tt,Vt]),[Vt,je]}const ht=nt=>({header:(0,n.css)({label:"header",display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",top:0,gap:nt.spacing(1),marginTop:nt.spacing(1)}),stickyHeader:(0,n.css)({zIndex:nt.zIndex.navbarFixed,position:"sticky",background:nt.colors.background.primary}),inputContainer:(0,n.css)({label:"inputContainer",flexGrow:1,minWidth:"150px",maxWidth:"350px"}),rightContainer:(0,n.css)({label:"rightContainer",display:"flex",alignItems:"flex-start",flexWrap:"wrap"}),buttonSpacing:(0,n.css)({label:"buttonSpacing",marginRight:nt.spacing(1)}),resetButton:(0,n.css)({label:"resetButton",display:"flex",marginRight:nt.spacing(2)}),resetButtonIconWrapper:(0,n.css)({label:"resetButtonIcon",padding:"0 5px",color:nt.colors.text.disabled}),colorDot:(0,n.css)({label:"colorDot",display:"inline-block",width:"10px",height:"10px",borderRadius:"50%"}),colorDotDiff:(0,n.css)({label:"colorDotDiff",display:"flex",width:"200px",height:"12px",color:"white",fontSize:9,lineHeight:1.3,fontWeight:300,justifyContent:"space-between",padding:"0 2px",borderRadius:"2px"}),colorDotByValue:(0,n.css)({label:"colorDotByValue",background:j}),colorDotByPackage:(0,n.css)({label:"colorDotByPackage",background:Y}),colorDotDiffDefault:(0,n.css)({label:"colorDotDiffDefault",background:ee}),colorDotDiffColorBlind:(0,n.css)({label:"colorDotDiffColorBlind",background:z}),extraElements:(0,n.css)({label:"extraElements",marginLeft:nt.spacing(1)})}),gt=De;var bt=e(70713),St=e(11261),Je=e(25019),rt=e(90708),Rt=e(77093),_t=e(52622);const nn=o.memo(({data:nt,onSymbolClick:yt,search:Vt,matchedLabels:je,onSearch:tt,sandwichItem:Dt,onSandwich:Ot,onTableSort:Lt,colorScheme:Gt})=>{const hn=(0,o.useMemo)(()=>{let Mt={};for(let wt=0;wt<nt.data.length;wt++){const Ht=nt.getValue(wt),tn=nt.getValueRight(wt),It=nt.getSelf(wt),Xe=nt.getLabel(wt);(!je||je.has(Xe))&&(Mt[Xe]=Mt[Xe]||{},Mt[Xe].self=Mt[Xe].self?Mt[Xe].self+It:It,Mt[Xe].total=Mt[Xe].total?Mt[Xe].total+Ht:Ht,Mt[Xe].totalRight=Mt[Xe].totalRight?Mt[Xe].totalRight+tn:tn)}return Mt},[nt,je]),mt=(0,A.of)(fn),Bt=(0,A.$j)(),[Jt,Rn]=(0,o.useState)([{displayName:"Self",desc:!0}]);return o.createElement("div",{className:mt.topTableContainer,"data-testid":"topTable"},o.createElement(bt.Ay,{style:{width:"100%"}},({width:Mt,height:wt})=>{if(Mt<3||wt<3)return null;const Ht=Kt(nt,hn,Mt,yt,tt,Ot,Bt,Gt,Vt,Dt);return o.createElement(Rt.X,{initialSortBy:Jt,onSortByChange:tn=>{tn&&tn.length&&Lt?.(tn[0].displayName+"_"+(tn[0].desc?"desc":"asc")),Rn(tn)},data:Ht,width:Mt,height:wt})}))});nn.displayName="FlameGraphTopTableContainer";function Kt(nt,yt,Vt,je,tt,Dt,Ot,Lt,Gt,hn){const mt=An(Dt,tt,Gt,hn),Bt={type:St.PU.string,name:"Symbol",values:[],config:{custom:{width:Vt-Qt-p*2},links:[{title:"Highlight symbol",url:"",onClick:Mt=>{const Ht=Mt.origin.field.values[Mt.origin.rowIndex];je(Ht)}}]}};let Jt;if(nt.isDiffFlamegraph()){Bt.config.custom.width=Vt-Qt-p*3;const Mt=en("Baseline","percent"),wt=en("Comparison","percent"),Ht=en("Diff","percent");Ht.config.custom.cellOptions.type=_t.ob.ColorText;const[tn,It]=Lt===U.yU.DiffColorBlind?[Z[0],Z[2]]:[ne[0],ne[2]];Ht.config.mappings=[{type:Je.d.ValueToText,options:{[1/0]:{text:"new",color:It}}},{type:Je.d.ValueToText,options:{[-100]:{text:"removed",color:tn}}},{type:Je.d.RangeToText,options:{from:0,to:1/0,result:{color:It}}},{type:Je.d.RangeToText,options:{from:-1/0,to:0,result:{color:tn}}}];const Xe=nt.getLevels(),jn=Xe.length?Xe[0][0].value:0,Qn=Xe.length?Xe[0][0].valueRight:void 0;for(let ia in yt){mt.values.push(null),Bt.values.push(ia);const wn=yt[ia].total,sa=yt[ia].totalRight,La=jn-Qn,xa=Math.round(1e4*wn/La)/100,ga=Math.round(1e4*sa/Qn)/100,Ts=(ga-xa)/xa*100;Ht.values.push(Ts),Mt.values.push(xa),wt.values.push(ga)}Jt={fields:[mt,Bt,Mt,wt,Ht],length:Bt.values.length}}else{const Mt=en("Self",nt.selfField.config.unit),wt=en("Total",nt.valueField.config.unit);for(let Ht in yt)mt.values.push(null),Bt.values.push(Ht),Mt.values.push(yt[Ht].self),wt.values.push(yt[Ht].total);Jt={fields:[mt,Bt,Mt,wt],length:Bt.values.length}}return(0,rt.we)({data:[Jt],fieldConfig:{defaults:{},overrides:[]},replaceVariables:Mt=>Mt,theme:Ot})[0]}function en(nt,yt){const Vt={width:p,align:"auto",inspect:!1,cellOptions:{type:_t.ob.Auto}};return{type:St.PU.number,name:nt,values:[],config:{unit:yt,custom:Vt}}}const Qt=61;function An(nt,yt,Vt,je){const tt={type:_t.ob.Custom,cellComponent:Ot=>o.createElement(un,{frame:Ot.frame,onSandwich:nt,onSearch:yt,search:Vt,sandwichItem:je,rowIndex:Ot.rowIndex})},Dt={filterable:!1,width:Qt,hideHeader:!0,inspect:!1,align:"auto",cellOptions:tt};return{type:St.PU.number,name:"actions",values:[],config:{custom:Dt}}}function un(nt){const yt=Tt(),Vt=nt.frame.fields.find(Dt=>Dt.name==="Symbol")?.values[nt.rowIndex],je=nt.search===Vt,tt=nt.sandwichItem===Vt;return o.createElement("div",{className:yt.actionCellWrapper},o.createElement(We.K,{className:yt.actionCellButton,name:"search",variant:je?"primary":"secondary",tooltip:je?"Clear from search":"Search for symbol","aria-label":je?"Clear from search":"Search for symbol",onClick:()=>{nt.onSearch(je?"":Vt)}}),o.createElement(We.K,{className:yt.actionCellButton,name:"gf-show-context",tooltip:tt?"Remove from sandwich view":"Show in sandwich view",variant:tt?"primary":"secondary","aria-label":tt?"Remove from sandwich view":"Show in sandwich view",onClick:()=>{nt.onSandwich(tt?void 0:Vt)}}))}const fn=nt=>({topTableContainer:(0,n.css)({label:"topTableContainer",padding:nt.spacing(1),backgroundColor:nt.colors.background.secondary,height:"100%"})}),Tt=()=>({actionCellWrapper:(0,n.css)({label:"actionCellWrapper",display:"flex",height:"24px"}),actionCellButton:(0,n.css)({label:"actionCellButton",marginRight:0,width:"24px"})}),$t=nn,Yt=new a.A,Cn=({data:nt,onTableSymbolClick:yt,onViewSelected:Vt,onTextAlignSelected:je,onTableSort:tt,getTheme:Dt,stickyHeader:Ot,extraHeaderElements:Lt,vertical:Gt,showFlameGraphOnly:hn,disableCollapsing:mt,getExtraContextMenuButtons:Bt})=>{const[Jt,Rn]=(0,o.useState)(),[Mt,wt]=(0,o.useState)(0),[Ht,tn]=(0,o.useState)(1),[It,Xe]=(0,o.useState)(""),[jn,Qn]=(0,o.useState)(U.F8.Both),[ia,{width:wn}]=(0,r.A)(),[sa,La]=(0,o.useState)("left"),[xa,ga]=(0,o.useState)(),[Ts,Us]=(0,o.useState)(new ot.S6),Bs=(0,o.useMemo)(()=>Dt(),[Dt]),ks=(0,o.useMemo)(()=>{if(!nt)return;const js=new ot.Jz(nt,{collapsing:!mt},Bs);return Us(js.getCollapsedMap()),js},[nt,Bs,mt]),[Ms,Dr]=Tn(ks),_s=Kn(Bs),Ir=vn(It,ks);(0,o.useEffect)(()=>{wn>0&&wn<y&&jn===U.F8.Both&&!Gt&&Qn(U.F8.FlameGraph)},[jn,Qn,wn,Gt]);const Xs=(0,o.useCallback)(()=>{Rn(void 0),wt(0),tn(1)},[Rn,tn,wt]);function Gs(){ga(void 0)}(0,o.useEffect)(()=>{Xs(),Gs()},[nt,Xs]);const Br=(0,o.useCallback)(js=>{It===js?Xe(""):(yt?.(js),Xe(js),Xs())},[Xe,Xs,yt,It]);if(!ks)return null;const Mr=o.createElement(Ze,{data:ks,rangeMin:Mt,rangeMax:Ht,matchedLabels:Ir,setRangeMin:wt,setRangeMax:tn,onItemFocused:js=>Rn(js),focusedItemData:Jt,textAlign:sa,sandwichItem:xa,onSandwich:js=>{Xs(),ga(js)},onFocusPillClick:Xs,onSandwichPillClick:Gs,colorScheme:Ms,showFlameGraphOnly:hn,collapsing:!mt,getExtraContextMenuButtons:Bt,selectedView:jn,search:It,collapsedMap:Ts,setCollapsedMap:Us}),vr=o.createElement($t,{data:ks,onSymbolClick:Br,search:It,matchedLabels:Ir,sandwichItem:xa,onSandwich:ga,onSearch:Xe,onTableSort:tt,colorScheme:Ms});let fr;return hn||jn===U.F8.FlameGraph?fr=Mr:jn===U.F8.TopTable?fr=o.createElement("div",{className:_s.tableContainer},vr):jn===U.F8.Both&&(Gt?fr=o.createElement("div",null,o.createElement("div",{className:_s.verticalGraphContainer},Mr),o.createElement("div",{className:_s.verticalTableContainer},vr)):fr=o.createElement("div",{className:_s.horizontalContainer},o.createElement("div",{className:_s.horizontalTableContainer},vr),o.createElement("div",{className:_s.horizontalGraphContainer},Mr))),o.createElement(i.D.Provider,{value:Bs},o.createElement("div",{ref:ia,className:_s.container},!hn&&o.createElement(gt,{search:It,setSearch:Xe,selectedView:jn,setSelectedView:js=>{Qn(js),Vt?.(js)},containerWidth:wn,onReset:()=>{Xs(),Gs()},textAlign:sa,onTextAlignChange:js=>{La(js),je?.(js)},showResetButton:!!(Jt||xa),colorScheme:Ms,onColorSchemeChange:Dr,stickyHeader:!!Ot,extraHeaderElements:Lt,vertical:Gt,isDiffMode:ks.isDiffFlamegraph(),setCollapsedMap:Us,collapsedMap:Ts}),o.createElement("div",{className:_s.body},fr)))};function Tn(nt){const yt=nt?.isDiffFlamegraph()?U.yU.Default:U.zM.PackageBased,[Vt,je]=(0,o.useState)(yt);return(0,o.useEffect)(()=>{je(yt)},[yt]),[Vt,je]}function vn(nt,yt){return(0,o.useMemo)(()=>{if(nt&&yt){const Vt=new Set;let je=Yt.filter(yt.getUniqueLabels(),nt);if(je)for(let tt of je)Vt.add(yt.getUniqueLabels()[tt]);return Vt}},[nt,yt])}function Kn(nt){return{container:(0,n.css)({label:"container",overflow:"auto",height:"100%",display:"flex",flex:"1 1 0",flexDirection:"column",minHeight:0,gap:nt.spacing(1)}),body:(0,n.css)({label:"body",flexGrow:1}),tableContainer:(0,n.css)({height:800}),horizontalContainer:(0,n.css)({label:"horizontalContainer",display:"flex",minHeight:0,flexDirection:"row",columnGap:nt.spacing(1),width:"100%"}),horizontalGraphContainer:(0,n.css)({flexBasis:"50%"}),horizontalTableContainer:(0,n.css)({flexBasis:"50%",maxHeight:800}),verticalGraphContainer:(0,n.css)({marginBottom:nt.spacing(1)}),verticalTableContainer:(0,n.css)({height:800})}}const Yn=Cn},5546:(Q,I,e)=>{"use strict";e.d(I,{F8:()=>a,Zk:()=>n,yU:()=>r,zM:()=>o});var n=(i=>(i.Bytes="bytes",i.Short="short",i.Nanoseconds="ns",i))(n||{}),a=(i=>(i.TopTable="topTable",i.FlameGraph="flameGraph",i.Both="both",i))(a||{}),o=(i=>(i.ValueBased="valueBased",i.PackageBased="packageBased",i))(o||{}),r=(i=>(i.Default="default",i.DiffColorBlind="diffColorBlind",i))(r||{})},80822:(Q,I,e)=>{"use strict";e.d(I,{Wn:()=>i,_k:()=>r});var n=e(41260),a=e(11261),o=e(21423);function r(u,b){const g=i({data:u.series},{data:b.series}).data;return{...u,series:g}}function i(u,b){if(!u)return m(b);b.data.forEach(y=>{const p=u.data.find(v=>h(v,y));if(!p){u.data.push(s(y));return}f(p,y)});const g=[...u.errors??[],...b.errors??[]];g.length>0&&(u.errors=g);const P=u.error??b.error;P!=null&&(u.error=P);const c=[...u.traceIds??[],...b.traceIds??[]];return c.length>0&&(u.traceIds=c),u}function f(u,b){const g=Math.max(u.fields.length,b.fields.length);for(let P=0;P<g;P++){if(!u.fields[P])continue;const c=u.fields[P].name?b.fields.find(y=>y.name===u.fields[P].name):b.fields[P];if(c&&(u.fields[P].values=[].concat.apply(c.values,u.fields[P].values),c.nanos)){const y=u.fields[P].nanos?.slice()||[];u.fields[P].nanos=b.fields[P].nanos?.concat(y)}}u.length+=b.length,u.meta={...u.meta,stats:l(u.meta?.stats??[],b.meta?.stats??[])}}const d="Summary: total bytes processed";function l(u,b){const g=u.find(y=>y.displayName===d),P=b.find(y=>y.displayName===d);if(P!=null&&g!=null)return[{value:P.value+g.value,displayName:d,unit:g.unit}];const c=P??g;return c!=null?[c]:[]}function m(u){return{...u,data:u.data.map(s)}}function s(u){return{...u,fields:u.fields.map(b=>({...b,values:b.values}))}}function h(u,b){if(u.refId!==b.refId)return!1;const g=u.meta?.type,P=b.meta?.type;if(g!==P)return!1;if(g===n.m.TimeSeriesMulti){const p=u.fields.find(D=>D.type===a.PU.number),v=b.fields.find(D=>D.type===a.PU.number);return p===void 0||v===void 0?!1:(0,o.ab)(p.labels??{},v.labels??{})}const c=u.meta?.custom?.frameType,y=b.meta?.custom?.frameType;return c==="LabeledTimeValues"&&y==="LabeledTimeValues"?!0:c===y}},80937:(Q,I,e)=>{"use strict";e.d(I,{t:()=>r});var n=e(84555),a=e(32370),o=e(76040);function r(m,s,h,u="="){if(!s||!h)throw new Error("Need label to add to query.");const b=i(m);if(!b.length)return m;const g=f(s,h,u);return d(m,b,g)}function i(m){const s=n.K3.parse(m),h=[];return s.iterate({enter:({to:u,from:b,type:g})=>{if(g.id===n.Fb){const P=(0,o.u)(m.substring(b,u));return h.push({query:P.query,from:b,to:u}),!1}}}),h}function f(m,s,h){const u=s===1/0?"+Inf":s.toString();return{label:m,op:h,value:u}}function d(m,s,h){const u=new a.l;let b="",g=0;for(let P=0;P<s.length;P++){const c=s[P],y=P===s.length-1,p=m.substring(g,c.from),v=y?m.substring(c.to):"";l(c.query.labels,h)||c.query.labels.push(h);const D=u.renderQuery(c.query);b+=p+D+v,g=c.to}return b}function l(m,s){return m.find(h=>h.label===s.label&&h.value===s.value)}},57225:(Q,I,e)=>{"use strict";e.d(I,{L:()=>Vt});var n=e(32196),a=e(96540),o=e(14236),r=e(13544),i=e(14110),f=e(14578),d=e(55852),l=e(40845),m=e(52363);const s=je=>{const{children:tt,storageKey:Dt,defaultValue:Ot}=je,[Lt,Gt]=(0,a.useState)({value:m.A.getObject(je.storageKey,je.defaultValue)});(0,a.useEffect)(()=>{const Bt=Jt=>{Jt.key===Dt&&Gt({value:m.A.getObject(je.storageKey,je.defaultValue)})};return window.addEventListener("storage",Bt),()=>{window.removeEventListener("storage",Bt)}});const hn=Bt=>{try{m.A.setObject(Dt,Bt)}catch(Jt){console.error(Jt)}Gt({value:Bt})},mt=()=>{try{m.A.delete(Dt)}catch(Bt){console.log(Bt)}Gt({value:Ot})};return a.createElement(a.Fragment,null,tt(Lt.value,hn,mt))};function h(je){return typeof je=="object"&&je!==null&&"isCanceled"in je}const u=je=>{let tt=!1;return{promise:new Promise((Ot,Lt)=>{const Gt={isCanceled:!0};je.then(hn=>tt?Lt(Gt):Ot(hn)),je.catch(hn=>Lt(tt?Gt:hn))}),cancel(){tt=!0}}};var b=e(81996),g=e(91793),P=e(3911),c=e(39558),y=e(66864),p=e(60029),v=e(10354),D=e(54438);const E="{}",S="__name__",T=25;function M(je){let tt="";const Dt=[];for(const Ot of je)if((Ot.name===S||Ot.selected)&&Ot.values&&Ot.values.length>0){const Lt=Ot.values.filter(Gt=>Gt.selected).map(Gt=>Gt.name);Lt.length>1?Dt.push(`${Ot.name}=~"${Lt.map(b.Cs).join("|")}"`):Lt.length===1&&(Ot.name===S?tt=Lt[0]:Dt.push(`${Ot.name}="${(0,b.Qn)(Lt[0])}"`))}return[tt,"{",Dt.join(","),"}"].join("")}function A(je,tt,Dt){return je.map(Ot=>{const Lt=tt[Ot.name];if(Lt){let Gt;if(Ot.name===Dt&&Ot.values)Gt=Ot.values;else{const hn=new Set(Ot.values?.filter(mt=>mt.selected).map(mt=>mt.name)||[]);Gt=Lt.map(mt=>({name:mt,selected:hn.has(mt)}))}return{...Ot,loading:!1,values:Gt,hidden:!Lt,facets:Gt.length}}return{...Ot,loading:!1,hidden:!Lt,values:void 0,facets:0}})}const x=(0,P.N)(je=>({wrapper:(0,n.css)({backgroundColor:je.colors.background.secondary,padding:je.spacing(1),width:"100%"}),list:(0,n.css)({marginTop:je.spacing(1),display:"flex",flexWrap:"wrap",maxHeight:"200px",overflow:"auto",alignContent:"flex-start"}),section:(0,n.css)({"& + &":{margin:`${je.spacing(2)} 0`},position:"relative"}),selector:(0,n.css)({fontFamily:je.typography.fontFamilyMonospace,marginBottom:je.spacing(1)}),status:(0,n.css)({padding:je.spacing(.5),color:je.colors.text.secondary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",position:"absolute",width:"50%",right:0,textAlign:"right",opacity:0,[je.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 100ms linear"}}),statusShowing:(0,n.css)({opacity:1}),error:(0,n.css)({color:je.colors.error.main}),valueList:(0,n.css)({marginRight:je.spacing(1),resize:"horizontal"}),valueListWrapper:(0,n.css)({borderLeft:`1px solid ${je.colors.border.medium}`,margin:`${je.spacing(1)} 0`,padding:`${je.spacing(1)} 0 ${je.spacing(1)} ${je.spacing(1)}`}),valueListArea:(0,n.css)({display:"flex",flexWrap:"wrap",marginTop:je.spacing(1)}),valueTitle:(0,n.css)({marginLeft:`-${je.spacing(.5)}`,marginBottom:je.spacing(1)}),validationStatus:(0,n.css)({padding:je.spacing(.5),marginBottom:je.spacing(1),color:je.colors.text.maxContrast,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"})}));class C extends a.Component{constructor(){super(...arguments),this.valueListsRef=a.createRef(),this.state={labels:[],labelSearchTerm:"",metricSearchTerm:"",status:"Ready",error:"",validationStatus:"",valueSearchTerm:""},this.onChangeLabelSearch=tt=>{this.setState({labelSearchTerm:tt.target.value})},this.onChangeMetricSearch=tt=>{this.setState({metricSearchTerm:tt.target.value})},this.onChangeValueSearch=tt=>{this.setState({valueSearchTerm:tt.target.value})},this.onClickRunQuery=()=>{const tt=M(this.state.labels);this.props.onChange(tt)},this.onClickRunRateQuery=()=>{const Dt=`rate(${M(this.state.labels)}[$__rate_interval])`;this.props.onChange(Dt)},this.onClickClear=()=>{this.setState(tt=>({labels:tt.labels.map(Ot=>({...Ot,values:void 0,selected:!1,loading:!1,hidden:!1,facets:void 0})),labelSearchTerm:"",metricSearchTerm:"",status:"",error:"",validationStatus:"",valueSearchTerm:""})),this.props.deleteLastUsedLabels(),this.fetchValues(S,E)},this.onClickLabel=(tt,Dt,Ot)=>{const Lt=this.state.labels.find(mt=>mt.name===tt);if(!Lt)return;const Gt=!Lt.selected;let hn={selected:Gt};if(Lt.values&&!Gt){const mt=Lt.values.map(Bt=>({...Bt,selected:!1}));hn={...hn,facets:0,values:mt}}this.setState({labelSearchTerm:""}),this.updateLabelState(tt,hn,"",()=>this.doFacettingForLabel(tt))},this.onClickValue=(tt,Dt,Ot)=>{const Lt=this.state.labels.find(hn=>hn.name===tt);if(!Lt||!Lt.values)return;this.setState({labelSearchTerm:""});const Gt=Lt.values.map(hn=>({...hn,selected:hn.name===Dt?!hn.selected:hn.selected}));this.updateLabelState(tt,{values:Gt},"",()=>this.doFacetting(tt))},this.onClickMetric=(tt,Dt,Ot)=>{const Lt=this.state.labels.find(mt=>mt.name===tt);if(!Lt||!Lt.values)return;this.setState({metricSearchTerm:""});const Gt=Lt.values.map(mt=>({...mt,selected:mt.name===Dt||mt.selected?!mt.selected:mt.selected})),hn=Gt.some(mt=>mt.selected);this.updateLabelState(tt,{selected:hn,values:Gt},"",()=>this.doFacetting(tt))},this.onClickValidate=()=>{const tt=M(this.state.labels);this.validateSelector(tt)},this.doFacetting=tt=>{const Dt=M(this.state.labels);if(Dt===E){const Ot=this.state.labels.map(Lt=>({...Lt,facets:0,values:void 0,hidden:!1}));this.setState({labels:Ot},()=>{this.state.labels.forEach(Lt=>(Lt.selected||Lt.name===S)&&this.fetchValues(Lt.name,Dt))})}else this.fetchSeries(Dt,tt)}}updateLabelState(tt,Dt,Ot="",Lt){this.setState(Gt=>{const hn=Gt.labels.map(Bt=>Bt.name===tt?{...Bt,...Dt}:Bt),mt=Ot?"":Gt.error;return{labels:hn,status:Ot,error:mt,validationStatus:""}},Lt)}componentDidMount(){const{languageProvider:tt,lastUsedLabels:Dt}=this.props;if(tt){const Ot=Dt;tt.start(this.props.timeRange).then(()=>{let Lt=tt.getLabelKeys();this.fetchValues(S,E);const Gt=Lt.map((hn,mt,Bt)=>({name:hn,selected:Ot.includes(hn),loading:!1}));this.setState({labels:Gt},()=>{this.state.labels.forEach(hn=>{hn.selected&&this.fetchValues(hn.name,E)})})})}}doFacettingForLabel(tt){const Dt=this.state.labels.find(Lt=>Lt.name===tt);if(!Dt)return;const Ot=this.state.labels.filter(Lt=>Lt.selected).map(Lt=>Lt.name);this.props.storeLastUsedLabels(Ot),Dt.selected?Dt.values||this.fetchValues(tt,M(this.state.labels)):this.doFacetting()}async fetchValues(tt,Dt){const{languageProvider:Ot}=this.props;this.updateLabelState(tt,{loading:!0},`Fetching values for ${tt}`);try{let Lt=await Ot.getLabelValues(tt);if(Dt!==M(this.state.labels)){this.updateLabelState(tt,{loading:!1});return}const Gt=[],{metricsMetadata:hn}=Ot;for(const mt of Lt){const Bt={name:mt};if(tt===S&&hn){const Jt=hn[mt];Jt&&(Bt.details=`(${Jt.type}) ${Jt.help}`)}Gt.push(Bt)}this.updateLabelState(tt,{values:Gt,loading:!1})}catch(Lt){console.error(Lt)}}async fetchSeries(tt,Dt){const{languageProvider:Ot}=this.props;Dt&&this.updateLabelState(Dt,{loading:!0},`Facetting labels for ${tt}`);try{const Lt=await Ot.fetchSeriesLabels(tt,!0);if(tt!==M(this.state.labels)){Dt&&this.updateLabelState(Dt,{loading:!1});return}if(Object.keys(Lt).length===0){this.setState({error:`Empty results, no matching label for ${tt}`});return}const Gt=A(this.state.labels,Lt,Dt);this.setState({labels:Gt,error:""}),Dt&&this.updateLabelState(Dt,{loading:!1})}catch(Lt){console.error(Lt)}}async validateSelector(tt){const{languageProvider:Dt}=this.props;this.setState({validationStatus:`Validating selector ${tt}`,error:""});const Ot=await Dt.fetchSeries(tt);this.setState({validationStatus:`Selector is valid (${Ot.length} series found)`})}render(){const{theme:tt}=this.props,{labels:Dt,labelSearchTerm:Ot,metricSearchTerm:Lt,status:Gt,error:hn,validationStatus:mt,valueSearchTerm:Bt}=this.state,Jt=x(tt);if(Dt.length===0)return a.createElement("div",{className:Jt.wrapper},a.createElement(c._,{text:"Loading labels..."}));let Rn=Dt.find(Xe=>Xe.name===S);Rn&&Lt&&(Rn={...Rn,values:Rn.values?.filter(Xe=>Xe.selected||Xe.name.includes(Lt))});let Mt=Dt.filter(Xe=>!Xe.hidden&&Xe.name!==S);Ot&&(Mt=Mt.filter(Xe=>Xe.selected||Xe.name.includes(Ot)));let wt=Mt.filter(Xe=>Xe.selected&&Xe.values);Bt&&(wt=wt.map(Xe=>({...Xe,values:Xe.values?.filter(jn=>jn.selected||jn.name.includes(Bt))})));const Ht=M(this.state.labels),tn=Ht===E,It=Rn?.values?.length||0;return a.createElement("div",{className:Jt.wrapper},a.createElement(y.Gy,{align:"flex-start",spacing:"lg"},a.createElement("div",null,a.createElement("div",{className:Jt.section},a.createElement(p.J,{description:"Once a metric is selected only possible labels are shown."},"1. Select a metric"),a.createElement("div",null,a.createElement(v.p,{onChange:this.onChangeMetricSearch,"aria-label":"Filter expression for metric",value:Lt,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.selectMetric})),a.createElement("div",{role:"list",className:Jt.valueListWrapper,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.metricList},a.createElement(g.Y1,{height:Math.min(450,It*T),itemCount:It,itemSize:T,itemKey:Xe=>Rn.values[Xe].name,width:300,className:Jt.valueList},({index:Xe,style:jn})=>{const Qn=Rn?.values?.[Xe];return Qn?a.createElement("div",{style:jn},a.createElement(D.J,{name:Rn.name,value:Qn?.name,title:Qn.details,active:Qn?.selected,onClick:this.onClickMetric,searchTerm:Lt})):null})))),a.createElement("div",null,a.createElement("div",{className:Jt.section},a.createElement(p.J,{description:"Once label values are selected, only possible label combinations are shown."},"2. Select labels to search in"),a.createElement("div",null,a.createElement(v.p,{onChange:this.onChangeLabelSearch,"aria-label":"Filter expression for label",value:Ot,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelNamesFilter})),a.createElement("div",{className:Jt.list,style:{height:120}},Mt.map(Xe=>a.createElement(D.J,{key:Xe.name,name:Xe.name,loading:Xe.loading,active:Xe.selected,hidden:Xe.hidden,facets:Xe.facets,onClick:this.onClickLabel,searchTerm:Ot})))),a.createElement("div",{className:Jt.section},a.createElement(p.J,{description:"Use the search field to find values across selected labels."},"3. Select (multiple) values for your labels"),a.createElement("div",null,a.createElement(v.p,{onChange:this.onChangeValueSearch,"aria-label":"Filter expression for label values",value:Bt,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelValuesFilter})),a.createElement("div",{className:Jt.valueListArea,ref:this.valueListsRef},wt.map(Xe=>a.createElement("div",{role:"list",key:Xe.name,"aria-label":`Values for ${Xe.name}`,className:Jt.valueListWrapper},a.createElement("div",{className:Jt.valueTitle},a.createElement(D.J,{name:Xe.name,loading:Xe.loading,active:Xe.selected,hidden:Xe.hidden,facets:Xe.facets||Xe.values?.length,onClick:this.onClickLabel})),a.createElement(g.Y1,{height:Math.min(200,T*(Xe.values?.length||0)),itemCount:Xe.values?.length||0,itemSize:28,itemKey:jn=>Xe.values[jn].name,width:200,className:Jt.valueList},({index:jn,style:Qn})=>{const ia=Xe.values?.[jn];return ia?a.createElement("div",{style:Qn},a.createElement(D.J,{name:Xe.name,value:ia?.name,active:ia?.selected,onClick:this.onClickValue,searchTerm:Bt})):null}))))))),a.createElement("div",{className:Jt.section},a.createElement(p.J,null,"4. Resulting selector"),a.createElement("div",{"aria-label":"selector",className:Jt.selector},Ht),mt&&a.createElement("div",{className:Jt.validationStatus},mt),a.createElement(y.Gy,null,a.createElement(d.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useQuery,"aria-label":"Use selector for query button",disabled:tn,onClick:this.onClickRunQuery},"Use query"),a.createElement(d.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useAsRateQuery,"aria-label":"Use selector as metrics button",variant:"secondary",disabled:tn,onClick:this.onClickRunRateQuery},"Use as rate query"),a.createElement(d.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.validateSelector,"aria-label":"Validate submit button",variant:"secondary",disabled:tn,onClick:this.onClickValidate},"Validate selector"),a.createElement(d.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.clear,"aria-label":"Selector clear button",variant:"secondary",onClick:this.onClickClear},"Clear"),a.createElement("div",{className:(0,n.cx)(Jt.status,(Gt||hn)&&Jt.statusShowing)},a.createElement("span",{className:hn?Jt.error:""},hn||Gt)))))}}const O=(0,l.cV)(C);var R=e(84555),L=e(2543),N=e(75357),F=e(39554),K=e(62938),B=e(85828);function w(){const je=new Map;return je.set("expandSuggestionDocs","true"),{onDidChangeValue:tt=>{},onDidChangeTarget:tt=>{},onWillSaveState:tt=>{},get:(tt,Dt,Ot)=>je.get(tt)??Ot,getBoolean:(tt,Dt,Ot)=>{const Lt=je.get(tt);return Lt!==void 0?Lt==="true":Ot},getNumber:(tt,Dt,Ot)=>{const Lt=je.get(tt);return Lt!==void 0?parseInt(Lt,10):Ot},store:(tt,Dt,Ot,Lt)=>{Dt==null?je.delete(tt):je.set(tt,Dt.toString())},remove:(tt,Dt)=>{je.delete(tt)},keys:(tt,Dt)=>Array.from(je.keys()),logStorage:()=>{console.log("logStorage: not implemented")},migrate:()=>Promise.resolve(void 0),isNew:tt=>!0,flush:tt=>Promise.resolve(void 0)}}let U=null;function W(){return U===null&&(U={storageService:w()}),U}var V=e(53076),_=e(32264),H=e(20719);class G extends Error{constructor(tt){super("should never happen")}}const j=new V.A({intraMode:1});function Y(je){let tt=je.getAllMetricNames();if(_.$.featureToggles.prometheusCodeModeMetricNamesSearch&&tt.length>je.metricNamesSuggestionLimit){const{monacoSettings:Dt}=je;Dt.enableAutocompleteSuggestionsUpdate(),Dt.inputInRange?tt=j.filter(tt,Dt.inputInRange)?.slice(0,je.metricNamesSuggestionLimit).map(Ot=>tt[Ot])??[]:tt=tt.slice(0,je.metricNamesSuggestionLimit)}return je.metricNamesToMetrics(tt).map(Dt=>({type:"METRIC_NAME",label:Dt.name,insertText:Dt.name,detail:`${Dt.name} : ${Dt.type}`,documentation:Dt.help}))}const oe=H.AW.map(je=>({type:"FUNCTION",label:je.label,insertText:je.insertText??"",detail:je.detail,documentation:je.documentation}));async function se(je){const tt=Y(je);return[...oe,...tt]}const ne=["$__interval","$__range","$__rate_interval","1m","5m","10m","30m","1h","1d"].map(je=>({type:"DURATION",label:je,insertText:je}));function ee(je){return je.getHistory().slice(0,10).map(Dt=>({type:"HISTORY",label:Dt,insertText:Dt}))}function Z(je,tt){const Dt=[...tt];return je!==void 0&&Dt.push({name:"__name__",value:je,op:"="}),`{${Dt.map(Lt=>`${Lt.name}${Lt.op}"${(0,b.Qn)(Lt.value)}"`).join(",")}}`}async function z(je,tt,Dt){if(je===void 0&&tt.length===0)return Promise.resolve(Dt.getAllLabelNames());{const Ot=Z(je,tt);return await Dt.getSeriesLabels(Ot,tt)}}async function q(je,tt,Dt,Ot,Lt){return(await z(je,Ot,Lt)).map(hn=>({type:"LABEL_NAME",label:hn,insertText:`${hn}${tt}`,triggerOnInsert:Dt}))}async function ie(je,tt,Dt){return q(je,"=",!0,tt,Dt)}async function de(je,tt,Dt){return q(je,"",!1,tt,Dt)}async function ue(je,tt,Dt,Ot){if(je===void 0&&Dt.length===0)return Ot.getLabelValues(tt);{const Lt=Z(je,Dt);return await Ot.getSeriesValues(tt,Lt)}}async function fe(je,tt,Dt,Ot,Lt){return(await ue(je,tt,Ot,Lt)).map(hn=>({type:"LABEL_VALUE",label:hn,insertText:Dt?hn:`"${hn}"`}))}function Se(je,tt){switch(je.type){case"IN_DURATION":return Promise.resolve(ne);case"IN_FUNCTION":return se(tt);case"AT_ROOT":return se(tt);case"EMPTY":{const Dt=Y(tt),Ot=ee(tt);return Promise.resolve([...Ot,...oe,...Dt])}case"IN_LABEL_SELECTOR_NO_LABEL_NAME":return ie(je.metricName,je.otherLabels,tt);case"IN_GROUPING":return de(je.metricName,je.otherLabels,tt);case"IN_LABEL_SELECTOR_WITH_LABEL_NAME":return fe(je.metricName,je.labelName,je.betweenQuotes,je.otherLabels,tt);default:throw new G(je)}}function he(je,tt){switch(tt){case"parent":return je.parent;case"firstChild":return je.firstChild;case"lastChild":return je.lastChild;case"nextSibling":return je.nextSibling;default:throw new G(tt)}}function ce(je,tt){let Dt=je;for(const[Ot,Lt]of tt)if(Dt=he(Dt,Ot),Dt===null||Dt.type.id!==Lt)return null;return Dt}function me(je,tt){return tt.slice(je.from,je.to)}function pe(je){const tt=je.slice(1,je.length-1);if(je.startsWith('"')&&je.endsWith('"'))return tt.replace(/\\"/,'"');if(je.startsWith("'")&&je.endsWith("'"))return tt.replace(/\\'/,"'");if(je.startsWith("`")&&je.endsWith("`"))return tt;throw new Error("FIXME: invalid string literal")}function ye(je,tt){return je.every((Dt,Ot)=>Dt===tt[Ot])}const Pe=0,Ie=[{path:[R.ww,R.Fb],fun:ct},{path:[R.ab],fun:Ze},{path:[R.Dh],fun:ot},{path:[R.LW,R.BG],fun:ke},{path:[Pe,R.df,R.ab],fun:Ze},{path:[Pe,R.BG],fun:ke},{path:[Pe,R.l4],fun:xt},{path:[R.x$],fun:$e}],Oe=new Map([[R.Hl,"="],[R.Ed,"=~"],[R.l3,"!="],[R.$i,"!~"]]);function Ne(je){const tt=je.firstChild;return tt===null?null:Oe.get(tt.type.id)??null}function We(je,tt){if(je.type.id!==R.BG)return null;const Dt=ce(je,[["firstChild",R.IC]]);if(Dt===null)return null;const Ot=ce(Dt,[["nextSibling",R.Lf]]);if(Ot===null)return null;const Lt=Ne(Ot);if(Lt===null)return null;const Gt=ce(je,[["lastChild",R.LW]]);if(Gt===null)return null;const hn=me(Dt,tt),mt=pe(me(Gt,tt));return{name:hn,value:mt,op:Lt}}function Ae(je,tt){return je.type.id!==R.ww?[]:je.getChildren(R.BG).map(Ot=>We(Ot,tt)).filter(re)}function Ue(je){let tt=je.firstChild;const Dt=[];for(;tt!==null;)Dt.push(tt),tt=tt.nextSibling;return Dt}function Me(je,tt){if(je.type.id===tt)return je;const Dt=Ue(je);for(const Ot of Dt){const Lt=Me(Ot,tt);if(Lt!==null)return Lt}return null}function $e(je,tt,Dt){const Ot=ce(je,[["parent",R.hI],["parent",R.Fn]]);if(Ot===null)return null;const Lt=Ot.getChild(R.Dh);if(Lt===null)return null;const Gt=Me(Lt,R.gw);return Gt===null?null:{type:"IN_GROUPING",metricName:me(Gt,tt),otherLabels:[]}}function ke(je,tt,Dt){const Ot=!je.type.isError,Lt=ce(je,[["parent",R.BG]]);if(Lt===null)return null;const Gt=ce(Lt,[["firstChild",R.IC]]);if(Gt===null)return null;const hn=me(Gt,tt),mt=ce(Lt,[["parent",R.ww]]);if(mt===null)return null;const Jt=Ae(mt,tt).filter(wt=>wt.name!==hn),Rn=ce(mt,[["parent",R.Fb],["firstChild",R.gw]]);return Rn===null?{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",labelName:hn,betweenQuotes:Ot,otherLabels:Jt}:{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",metricName:me(Rn,tt),labelName:hn,betweenQuotes:Ot,otherLabels:Jt}}function Ze(je,tt,Dt){return{type:"AT_ROOT"}}function ot(je,tt,Dt){return{type:"IN_FUNCTION"}}function xt(je,tt,Dt){return{type:"IN_DURATION"}}function ct(je,tt,Dt){const Ot=ce(je,[["firstChild",R.BG]]);if(Ot!==null&&!tt.slice(Ot.to,Dt).includes(","))return null;const Lt=ce(je,[["parent",R.Fb],["firstChild",R.gw]]),Gt=Ae(je,tt);return Lt===null?{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",otherLabels:Gt}:{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",metricName:me(Lt,tt),otherLabels:Gt}}function ft(je,tt){const Dt=je.cursorAt(tt);for(;;){if(Dt.from===tt&&Dt.to===tt){const{node:Ot}=Dt;if(Ot.type.isError)return Ot}if(!Dt.next())break}return null}function Le(je,tt){if(je==="")return{type:"EMPTY"};const Dt=R.K3.parse(je),Ot=ft(Dt,tt),Lt=Ot!=null?Ot.cursor():Dt.cursorAt(tt),Gt=Lt.node,hn=[Lt.type.id];for(;Lt.parent();)hn.push(Lt.type.id);for(let mt of Ie)if(ye(mt.path,hn))return mt.fun(Gt,je,tt);return null}function re(je){return je!=null}function X(){return{showWords:!1}}function le(je,tt){switch(je){case"DURATION":return tt.languages.CompletionItemKind.Unit;case"FUNCTION":return tt.languages.CompletionItemKind.Variable;case"HISTORY":return tt.languages.CompletionItemKind.Snippet;case"LABEL_NAME":return tt.languages.CompletionItemKind.Enum;case"LABEL_VALUE":return tt.languages.CompletionItemKind.EnumMember;case"METRIC_NAME":return tt.languages.CompletionItemKind.Constructor;default:throw new G(je)}}function be(je,tt){return{triggerCharacters:["{",",","[","(","=","~"," ",'"'],provideCompletionItems:(Ot,Lt)=>{const Gt=Ot.getWordAtPosition(Lt),hn=Gt!=null?je.Range.lift({startLineNumber:Lt.lineNumber,endLineNumber:Lt.lineNumber,startColumn:Gt.startColumn,endColumn:Gt.endColumn}):je.Range.fromPositions(Lt),mt={column:Lt.column,lineNumber:Lt.lineNumber};if(tt.monacoSettings.setInputInRange(Ot.getValueInRange(hn)),window.getSelection){const Mt=window.getSelection()?.toString();Mt&&Mt.length>0&&(mt.column=mt.column-Mt.length)}const Bt=Ot.getOffsetAt(mt),Jt=Le(Ot.getValue(),Bt);return(Jt!=null?Se(Jt,tt):Promise.resolve([])).then(Mt=>{const wt=Mt.length.toString().length;return{suggestions:Mt.map((tn,It)=>({kind:le(tn.type,je),label:tn.label,insertText:tn.insertText,detail:tn.detail,documentation:tn.documentation,sortText:It.toString().padStart(wt,"0"),range:hn,command:tn.triggerOnInsert?{id:"editor.action.triggerSuggest",title:""}:void 0})),incomplete:tt.monacoSettings.suggestionsIncomplete}})}}}var De=e(91306);const Te=0;function we(je,tt,Dt,Ot){if(!je)return!1;const Lt=Ke(tt,Ot);if(!Lt.length)return!1;let Gt=Lt;if(je!==tt){const hn=Ke(je,Ot);Gt=Lt.flatMap(mt=>hn.filter(Bt=>mt.text===Bt.text)||mt)}return Gt.map(hn=>Ve(je,Dt,hn)).filter(ht)}function Ke(je,tt){const Dt=[];return tt.parse(je).iterate({enter:Lt=>{if(Lt.type.id===Te){const Gt=Lt.node;Dt.push({node:Gt,text:je.substring(Gt.from,Gt.to)})}}}),Dt}function Ve(je,tt,Dt){if(tt.length===1){const Gt=Dt.node.from===Dt.node.to,hn=Gt&&Dt.node.parent?Dt.node.parent:Dt.node,mt=Gt?je.substring(hn.from,hn.to):Dt.text;return{startLineNumber:1,startColumn:hn.from+1,endLineNumber:1,endColumn:hn.to+1,error:mt}}let Ot=0,Lt=0;for(let Gt=0;Gt<tt.length;Gt++){if(Lt=Ot+tt[Gt].length,Dt.node.from>Lt){Ot+=tt[Gt].length+1;continue}return{startLineNumber:Gt+1,startColumn:Dt.node.from-Ot+1,endLineNumber:Gt+1,endColumn:Dt.node.to-Ot+1,error:Dt.text}}return null}function ht(je){return je!==null}const gt={__interval:{text:"1s",value:"1s"},__rate_interval:{text:"1s",value:"1s"},__auto:{text:"1s",value:"1s"},__interval_ms:{text:"1000",value:1e3},__range_ms:{text:"1000",value:1e3},__range_s:{text:"1",value:1},__range:{text:"1s",value:"1s"}},bt={wordPattern:/(-?\d*\.\d\w*)|([^`~!#%^&*()\-=+\[{\]}\\|;:'",.<>\/?\s]+)/g,comments:{lineComment:"#"},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"<",close:">"}],folding:{}},St=["sum","min","max","avg","group","stddev","stdvar","count","count_values","bottomk","topk","quantile"],Je=["abs","absent","ceil","changes","clamp_max","clamp_min","day_of_month","day_of_week","days_in_month","delta","deriv","exp","floor","histogram_quantile","histogram_avg","histogram_count","histogram_sum","histogram_fraction","histogram_stddev","histogram_stdvar","holt_winters","hour","idelta","increase","irate","label_join","label_replace","ln","log2","log10","minute","month","predict_linear","rate","resets","round","scalar","sort","sort_desc","sqrt","time","timestamp","vector","year"],rt=[];for(let je=0,tt=St;je<tt.length;je++){let Dt=tt[je];rt.push(Dt+"_over_time")}const Rt=["on","ignoring","group_right","group_left","by","without"],_t="("+Rt.reduce(function(je,tt){return je+"|"+tt})+")",nn=["+","-","*","/","%","^","==","!=",">","<",">=","<=","and","or","unless"],Kt=["offset"],Qt={ignoreCase:!1,defaultToken:"",tokenPostfix:".promql",keywords:St.concat(Je).concat(rt).concat(Rt).concat(Kt),operators:nn,vectorMatching:_t,symbols:/[=><!~?:&|+\-*\/^%]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,digits:/\d+(_+\d+)*/,octaldigits:/[0-7]+(_+[0-7]+)*/,binarydigits:/[0-1]+(_+[0-1]+)*/,hexdigits:/[[0-9a-fA-F]+(_+[0-9a-fA-F]+)*/,integersuffix:/(ll|LL|u|U|l|L)?(ll|LL|u|U|l|L)?/,floatsuffix:/[fFlL]?/,tokenizer:{root:[[/@vectorMatching\s*(?=\()/,"type","@clauses"],[/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,"tag"],[/(^#.*$)/,"comment"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":"type","@default":"identifier"}}],[/"([^"\\]|\\.)*$/,"string.invalid"],[/'([^'\\]|\\.)*$/,"string.invalid"],[/"/,"string","@string_double"],[/'/,"string","@string_single"],[/`/,"string","@string_backtick"],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"delimiter","@default":""}}],[/\d+[smhdwy]/,"number"],[/\d*\d+[eE]([\-+]?\d+)?(@floatsuffix)/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?(@floatsuffix)/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F](@integersuffix)/,"number.hex"],[/0[0-7']*[0-7](@integersuffix)/,"number.octal"],[/0[bB][0-1']*[0-1](@integersuffix)/,"number.binary"],[/\d[\d']*\d(@integersuffix)/,"number"],[/\d(@integersuffix)/,"number"]],string_double:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],string_single:[[/[^\\']+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/'/,"string","@pop"]],string_backtick:[[/[^\\`$]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/`/,"string","@pop"]],clauses:[[/[^(,)]/,"tag"],[/\)/,"identifier","@pop"]],whitespace:[[/[ \t\r\n]+/,"white"]]}},An={codeLens:!1,contextmenu:!1,fixedOverflowWidgets:!0,folding:!1,fontSize:14,lineDecorationsWidth:8,lineNumbers:"off",minimap:{enabled:!1},overviewRulerBorder:!1,overviewRulerLanes:0,padding:{top:4,bottom:5},renderLineHighlight:"none",scrollbar:{vertical:"hidden",verticalScrollbarSize:8,horizontal:"hidden",horizontalScrollbarSize:0,alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1,suggest:X(),suggestFontSize:12,wordWrap:"on"},un=2,fn=N.promLanguageDefinition.id;let Tt=!1;function $t(je){if(Tt===!1){Tt=!0;const{aliases:tt,extensions:Dt,mimetypes:Ot}=N.promLanguageDefinition;je.languages.register({id:fn,aliases:tt,extensions:Dt,mimetypes:Ot}),je.languages.setMonarchTokensProvider(fn,Qt),je.languages.setLanguageConfiguration(fn,bt)}}const Yt=(je,tt)=>({container:(0,n.css)({borderRadius:je.shape.radius.default,border:`1px solid ${je.components.input.borderColor}`,display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"center",height:"100%"}),placeholder:(0,n.css)({"::after":{content:`'${tt}'`,fontFamily:je.typography.fontFamilyMonospace,opacity:.6}})}),Tn=je=>{const tt=(0,K.A)(),Dt=(0,a.useRef)(W()),Ot=(0,a.useRef)(null),{languageProvider:Lt,history:Gt,onBlur:hn,onRunQuery:mt,initialValue:Bt,placeholder:Jt,onChange:Rn,datasource:Mt}=je,wt=(0,F.A)(Lt),Ht=(0,F.A)(Gt),tn=(0,F.A)(mt),It=(0,F.A)(hn),Xe=(0,F.A)(Rn),jn=(0,a.useRef)(null),Qn=(0,l.$j)(),ia=Yt(Qn,Jt);return(0,a.useEffect)(()=>()=>{jn.current?.()},[]),a.createElement("div",{"data-testid":r.Tp.components.QueryField.container,className:ia.container,ref:Ot},a.createElement(B.m,{overrideServices:Dt.current,options:An,language:"promql",value:Bt,beforeMount:wn=>{$t(wn)},onMount:(wn,sa)=>{const La=wn.createContextKey("isEditorFocused"+tt,!1);wn.onDidBlurEditorWidget(()=>{La.set(!1),It.current(wn.getValue())}),wn.onDidFocusEditorText(()=>{La.set(!0)});const xa=new De.M9({historyProvider:Ht.current,languageProvider:wt.current}),ga=be(sa,xa),Ts={...ga,provideCompletionItems:(Ms,Dr,_s,Ir)=>wn.getModel()?.id!==Ms.id?{suggestions:[]}:ga.provideCompletionItems(Ms,Dr,_s,Ir)},{dispose:Us}=sa.languages.registerCompletionItemProvider(fn,Ts);jn.current=Us;const Bs=()=>{const Ms=Ot.current;if(Ms!==null){const Dr=wn.getContentHeight();Ms.style.height=`${Dr+un}px`,Ms.style.width="100%";const _s=Ms.clientWidth;wn.layout({width:_s,height:Dr})}};wn.onDidContentSizeChange(Bs),Bs();const ks=(0,L.debounce)(()=>{const Ms=wn.getValue();Xe.current(Ms)},wt.current.datasource.getDebounceTimeInMilliseconds());if(wn.getModel()?.onDidChangeContent(()=>{ks()}),wn.addCommand(sa.KeyMod.Shift|sa.KeyCode.Enter,()=>{tn.current(wn.getValue())},"isEditorFocused"+tt),sa.editor.addKeybindingRule({keybinding:sa.KeyMod.CtrlCmd|sa.KeyCode.KeyF,command:null}),wn.addCommand(sa.KeyMod.CtrlCmd|sa.KeyCode.KeyK,function(){e.g.dispatchEvent(new KeyboardEvent("keydown",{key:"k",metaKey:!0}))}),Jt){const Ms=[{range:new sa.Range(1,1,1,1),options:{className:ia.placeholder,isWholeLine:!0}}];let Dr=[];const _s=()=>{const Ir=wn.getModel();if(!Ir)return;const Xs=Ir.getValueLength()===0?Ms:[];Dr=Ir.deltaDecorations(Dr,Xs)};_s(),wn.onDidChangeModelContent(_s),wn.onDidChangeModelContent(Ir=>{const Xs=wn.getModel();if(!Xs)return;const Gs=Xs.getValue(),Mr=(we(Gs,Mt.interpolateString(Gs,gt),Xs.getLinesContent(),R.K3)||[]).map(({error:vr,...fr})=>({message:`${vr?`Error parsing "${vr}"`:"Parse error"}. The query appears to be incorrect and could fail to be executed.`,severity:sa.MarkerSeverity.Error,...fr}));sa.editor.setModelMarkers(Xs,"owner",Mr)})}}}))},vn=je=>a.createElement(a.Suspense,{fallback:null},a.createElement(Tn,{...je})),Kn=je=>{const tt=(0,a.useRef)(null),{onRunQuery:Dt,onChange:Ot,...Lt}=je,Gt=Bt=>{tt.current=Bt,Ot(Bt),Dt()},hn=Bt=>{Ot(Bt)},mt=Bt=>{Ot(Bt)};return a.createElement(vn,{onChange:mt,onRunQuery:Gt,onBlur:hn,...Lt})},Yn="grafana.datasources.prometheus.browser.labels";function nt(je,tt,Dt){return je?"(Disabled)":tt?Dt?"Metrics browser":"(No metrics found)":"Loading metrics..."}class yt extends a.PureComponent{constructor(tt){super(tt),this.refreshHint=()=>{const{datasource:Dt,query:Ot,data:Lt}=this.props,Gt=Dt.getInitHints(),hn=Gt.length>0?Gt[0]:null;if(!Lt||Lt.series.length===0){this.setState({hint:hn});return}const mt=(0,o.ci)(Lt.series[0])?Lt.series.map(o.w3):Lt.series,Bt=Dt.getQueryHints(Ot,mt);let Jt=Bt.length>0?Bt[0]:null;this.setState({hint:Jt??hn})},this.refreshMetrics=async()=>{const{range:Dt,datasource:{languageProvider:Ot}}=this.props;this.languageProviderInitializationPromise=u(Ot.start(Dt));try{const Lt=await this.languageProviderInitializationPromise.promise;await Promise.all(Lt),this.onUpdateLanguage()}catch(Lt){if(!(h(Lt)&&Lt.isCanceled))throw Lt}},this.onChangeLabelBrowser=Dt=>{this.onChangeQuery(Dt,!0),this.setState({labelBrowserVisible:!1})},this.onChangeQuery=(Dt,Ot)=>{const{query:Lt,onChange:Gt,onRunQuery:hn}=this.props;if(Gt){const mt={...Lt,expr:Dt};Gt(mt),Ot&&hn&&hn()}},this.onClickChooserButton=()=>{this.setState(Dt=>({labelBrowserVisible:!Dt.labelBrowserVisible})),(0,i.rR)("user_grafana_prometheus_metrics_browser_clicked",{editorMode:this.state.labelBrowserVisible?"metricViewClosed":"metricViewOpen",app:this.props?.app??""})},this.onClickHintFix=()=>{const{datasource:Dt,query:Ot,onChange:Lt,onRunQuery:Gt}=this.props,{hint:hn}=this.state;hn?.fix?.action&&Lt(Dt.modifyQuery(Ot,hn.fix.action)),Gt()},this.onUpdateLanguage=()=>{const{datasource:{languageProvider:Dt}}=this.props,{metrics:Ot}=Dt;Ot&&this.setState({syntaxLoaded:!0})},this.state={labelBrowserVisible:!1,syntaxLoaded:!1,hint:null}}componentDidMount(){this.props.datasource.languageProvider&&this.refreshMetrics(),this.refreshHint()}componentWillUnmount(){this.languageProviderInitializationPromise&&this.languageProviderInitializationPromise.cancel()}componentDidUpdate(tt){const{data:Dt,datasource:{languageProvider:Ot},range:Lt}=this.props;Ot!==tt.datasource.languageProvider&&this.setState({syntaxLoaded:!1});const Gt=this.rangeChangedToRefresh(Lt,tt.range);(Ot!==tt.datasource.languageProvider||Gt)&&this.refreshMetrics(),Dt&&tt.data&&tt.data.series!==Dt.series&&this.refreshHint()}rangeChangedToRefresh(tt,Dt){if(tt&&Dt){const Ot=(0,b.eN)(tt.from.valueOf())===(0,b.eN)(Dt.from.valueOf()),Lt=(0,b.eN)(tt.to.valueOf())===(0,b.eN)(Dt.to.valueOf());return!(Ot&&Lt)}return!1}render(){const{datasource:tt,datasource:{languageProvider:Dt},query:Ot,ExtraFieldElement:Lt,history:Gt=[],theme:hn}=this.props,{labelBrowserVisible:mt,syntaxLoaded:Bt,hint:Jt}=this.state,Rn=Dt.metrics.length>0,Mt=nt(tt.lookupsDisabled,Bt,Rn),wt=!(Bt&&Rn);return a.createElement(s,{storageKey:Yn,defaultValue:[]},(Ht,tn,It)=>a.createElement(a.Fragment,null,a.createElement("div",{className:"gf-form-inline gf-form-inline--xs-view-flex-column flex-grow-1","data-testid":this.props["data-testid"]},a.createElement("button",{className:"gf-form-label query-keyword pointer",onClick:this.onClickChooserButton,disabled:wt,type:"button","data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.openButton},Mt,a.createElement(f.I,{name:mt?"angle-down":"angle-right"})),a.createElement("div",{className:"flex-grow-1 min-width-15"},a.createElement(Kn,{languageProvider:Dt,history:Gt,onChange:this.onChangeQuery,onRunQuery:this.props.onRunQuery,initialValue:Ot.expr??"",placeholder:"Enter a PromQL query\u2026",datasource:tt}))),mt&&a.createElement("div",{className:"gf-form"},a.createElement(O,{languageProvider:Dt,onChange:this.onChangeLabelBrowser,lastUsedLabels:Ht||[],storeLastUsedLabels:tn,deleteLastUsedLabels:It,timeRange:this.props.range})),Lt,Jt?a.createElement("div",{className:"query-row-break"},a.createElement("div",{className:"prom-query-field-info text-warning"},Jt.label," ",Jt.fix?a.createElement("button",{type:"button",className:(0,n.cx)((0,d.my)(hn),"text-link","muted"),onClick:this.onClickHintFix},Jt.fix.label):null)):null))}}const Vt=(0,l.cV)(yt)},91306:(Q,I,e)=>{"use strict";e.d(I,{M9:()=>o,Ol:()=>a,w0:()=>n});const n="codeModeSuggestionsIncomplete";function a(r){return r.type===n&&"detail"in r&&typeof r.detail=="object"&&r.detail!==null&&"limit"in r.detail&&"datasourceUid"in r.detail}class o{constructor(i){this.languageProvider=i.languageProvider,this.historyProvider=i.historyProvider,this.inputInRange="",this.metricNamesSuggestionLimit=this.languageProvider.datasource.metricNamesAutocompleteSuggestionLimit,this.suggestionsIncomplete=!1,this.getSeriesLabels=this.languageProvider.getSeriesLabels.bind(this.languageProvider),this.getSeriesValues=this.languageProvider.getSeriesValues.bind(this.languageProvider),this.getAllLabelNames=this.languageProvider.getLabelKeys.bind(this.languageProvider),this.getLabelValues=this.languageProvider.getLabelValues.bind(this.languageProvider)}getHistory(){return this.historyProvider.map(i=>i.query.expr).filter(Boolean)}getAllMetricNames(){return this.languageProvider.metrics}metricNamesToMetrics(i){const{metricsMetadata:f}=this.languageProvider;return i.map(l=>{const m=f?.[l];return{name:l,help:m?.help??"",type:m?.type??""}})}enableAutocompleteSuggestionsUpdate(){this.suggestionsIncomplete=!0,dispatchEvent(new CustomEvent(n,{detail:{limit:this.metricNamesSuggestionLimit,datasourceUid:this.languageProvider.datasource.uid}}))}setInputInRange(i){this.inputInRange=i}get monacoSettings(){return{enableAutocompleteSuggestionsUpdate:this.enableAutocompleteSuggestionsUpdate.bind(this),inputInRange:this.inputInRange,setInputInRange:this.setInputInRange.bind(this),suggestionsIncomplete:this.suggestionsIncomplete}}}},4936:(Q,I,e)=>{"use strict";e.d(I,{TT:()=>d,Zh:()=>l,jW:()=>f,k1:()=>r});var n=e(32196),a=e(96540),o=e(72093);const r=30,i=m=>{const{options:s,onOptionsChange:h}=m,u=useTheme2(),b=l(u);return React.createElement(React.Fragment,null,s.access==="direct"&&React.createElement(Alert,{title:"Error",severity:"error"},"Browser access mode in the Prometheus data source is no longer available. Switch to server access mode."),React.createElement(DataSourceDescription,{dataSourceName:"Prometheus",docsLink:"https://grafana.com/docs/grafana/latest/datasources/prometheus/configure-prometheus-data-source/"}),React.createElement("hr",{className:`${b.hrTopSpace} ${b.hrBottomSpace}`}),React.createElement(DataSourceHttpSettingsOverhaul,{options:s,onOptionsChange:h,secureSocksDSProxyEnabled:config.secureSocksDSProxyEnabled}),React.createElement("hr",null),React.createElement(ConfigSection,{className:b.advancedSettings,title:"Advanced settings",description:"Additional settings are optional settings that can be configured for more control over your data source."},React.createElement(AdvancedHttpSettings,{className:b.advancedHTTPSettingsMargin,config:s,onChange:h}),React.createElement(AlertingSettingsOverhaul,{options:s,onOptionsChange:h}),React.createElement(PromSettings,{options:s,onOptionsChange:h})))};function f(m){return a.createElement("a",{href:m||"https://grafana.com/docs/grafana/latest/datasources/prometheus/#configure-the-data-source",target:"_blank",rel:"noopener noreferrer"},"Visit docs for more details here.")}const d=(m,s,h)=>{const u="Value is not valid";return m&&!m.match(s)?a.createElement(o.P,null,h||u):!0};function l(m){return{additionalSettings:(0,n.css)({marginBottom:"25px"}),secondaryGrey:(0,n.css)({color:m.colors.secondary.text,opacity:"65%"}),inlineError:(0,n.css)({margin:"0px 0px 4px 245px"}),switchField:(0,n.css)({alignItems:"center"}),sectionHeaderPadding:(0,n.css)({paddingTop:"32px"}),sectionBottomPadding:(0,n.css)({paddingBottom:"28px"}),subsectionText:(0,n.css)({fontSize:"12px"}),hrBottomSpace:(0,n.css)({marginBottom:"56px"}),hrTopSpace:(0,n.css)({marginTop:"50px"}),textUnderline:(0,n.css)({textDecoration:"underline"}),versionMargin:(0,n.css)({marginBottom:"12px"}),advancedHTTPSettingsMargin:(0,n.css)({margin:"24px 0 8px 0"}),advancedSettings:(0,n.css)({paddingTop:"32px"}),alertingTop:(0,n.css)({marginTop:"40px !important"}),overhaulPageHeading:(0,n.css)({fontWeight:400}),container:(0,n.css)({maxwidth:578})}}},75212:(Q,I,e)=>{"use strict";e.d(I,{gs:()=>Ze,UD:()=>ot});var n=e(2543),a=e(13288),o=e(75505),r=e(81160),i=e(59099),f=e(97716),d=e.n(f),l=e(65879),m=e(43659),s=e(43127),h=e(47232),u=e(37891),b=e(41987),g=e(26657),P=e(72574),c=e(47773),y=e(17172),p=e(32264),v=e(80937),D=e(96540),E=e(13544),S=e(71087),T=e(9e4),M=e(81580),A=e(79458),x=e(51440),C=e(68402),O=e(10354),R=e(80109);function L(re){const X=re.annotation,le=re.onAnnotationChange,be={expr:X.expr,refId:X.name,interval:X.step};return D.createElement(D.Fragment,null,D.createElement(S.D,null,D.createElement(R.$,{...re,query:be,showExplain:!1,onChange:De=>{le({...X,expr:De.expr})}}),D.createElement(T.U,null,D.createElement(M.c,{label:"Min step",tooltip:D.createElement(D.Fragment,null,"An additional lower limit for the step parameter of the Prometheus query and for the"," ",D.createElement("code",null,"$__interval")," and ",D.createElement("code",null,"$__rate_interval")," variables.")},D.createElement(x.D,{type:"text","aria-label":"Set lower limit for the step parameter",placeholder:"auto",minWidth:10,onCommitChange:De=>{le({...X,step:De.currentTarget.value})},defaultValue:be.interval,id:E.Tp.components.DataSource.Prometheus.annotations.minStep})))),D.createElement(C.$,{v:.5}),D.createElement(T.U,null,D.createElement(M.c,{label:"Title",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance."},D.createElement(O.p,{type:"text",placeholder:"{{alertname}}",value:X.titleFormat,onChange:De=>{le({...X,titleFormat:De.currentTarget.value})},"data-testid":E.Tp.components.DataSource.Prometheus.annotations.title})),D.createElement(M.c,{label:"Tags"},D.createElement(O.p,{type:"text",placeholder:"label1,label2",value:X.tagKeys,onChange:De=>{le({...X,tagKeys:De.currentTarget.value})},"data-testid":E.Tp.components.DataSource.Prometheus.annotations.tags})),D.createElement(M.c,{label:"Text",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance."},D.createElement(O.p,{type:"text",placeholder:"{{instance}}",value:X.textFormat,onChange:De=>{le({...X,textFormat:De.currentTarget.value})},"data-testid":E.Tp.components.DataSource.Prometheus.annotations.text})),D.createElement(M.c,{label:"Series value as timestamp",tooltip:"The unit of timestamp is milliseconds. If the unit of the series value is seconds, multiply its range vector by 1000."},D.createElement(A.C,{value:X.useValueForTime,onChange:De=>{le({...X,useValueForTime:De.currentTarget.value})},"data-testid":E.Tp.components.DataSource.Prometheus.annotations.seriesValueAsTimestamp}))))}var N=e(50556),F=e(81996),K=e(32370),B=e(76040),w=e(62183);const U=/^label_names\(\)\s*$/,W=/^label_values\((?:(.+),\s*)?([a-zA-Z_$][a-zA-Z0-9_]*)\)\s*$/,V=/^metrics\((.+)\)\s*$/,_=/^query_result\((.+)\)\s*$/,H=/^label_names\((.+)\)\s*$/;function G(re){if(typeof re!="string")return re;const X={refId:"PrometheusDatasource-VariableQuery",qryType:w.B4.LabelNames},le=re.match(H);if(le)return{...X,qryType:w.B4.LabelNames,match:le[1]};const be=re.match(U);if(be)return{...X,qryType:w.B4.LabelNames};const De=re.match(/^label_values\(/);if(De){const Ke=re.match(W),Ve=Ke?Ke[2]:"",ht=Ke?Ke[1]:"";if(ht){const gt=(0,B.u)(ht);return{...X,qryType:w.B4.LabelValues,label:Ve,metric:gt.query.metric,labelFilters:gt.query.labels}}else return{...X,qryType:w.B4.LabelValues,label:Ve}}const Te=re.match(/^metrics\(/);if(Te){const Ke=re.match(V),Ve=Ke?Ke[1]:"";return{...X,qryType:w.B4.MetricNames,metric:Ve}}const we=re.match(/^query_result\(/);if(we){const Ke=re.match(_),Ve=Ke?Ke[1]:"";return{...X,qryType:w.B4.VarQueryResult,varQuery:Ve}}return!be&&!De&&!Te&&!we?{...X,qryType:w.B4.SeriesQuery,seriesQuery:re}:X}function j(re){switch(re.qryType){case w.B4.LabelNames:return re.match?`label_names(${re.match})`:"label_names()";case w.B4.LabelValues:if(re.metric||re.labelFilters&&re.labelFilters.length!==0){const le={metric:re.metric,labels:re.labelFilters??[],operations:[]};return`label_values(${K.z.renderQuery(le)},${re.label})`}else return`label_values(${re.label})`;case w.B4.MetricNames:return`metrics(${re.metric})`;case w.B4.VarQueryResult:return`query_result(${Y(re.varQuery)})`;case w.B4.SeriesQuery:return re.seriesQuery??"";case w.B4.ClassicQuery:return re.classicQuery??""}return""}function Y(re){return re?re.replace(/[\r\n]+/gm,""):""}class oe{constructor(X,le){this.datasource=X,this.query=le,this.datasource=X,this.query=le,this.range=(0,s.E2)()}process(X){this.range=X;const le=U,be=H,De=/^label_values\((?:(.+),\s*)?([a-zA-Z_][a-zA-Z0-9_]*)\)\s*$/,Te=V,we=_,Ke=this.query.match(le),Ve=this.query.match(be);if(Ve){const Je=`{__name__=~".*${Ve[1]}.*"}`;return this.datasource.languageProvider.getSeriesLabels(Je,[]).then(rt=>rt.map(Rt=>({text:Rt})))}if(Ke)return this.datasource.getTagKeys({filters:[],timeRange:X});const ht=this.query.match(De);if(ht){const Je=ht[1],rt=ht[2];return se(Je)?this.labelValuesQuery(rt,Je):this.labelValuesQuery(rt)}const gt=this.query.match(Te);if(gt)return this.metricNameQuery(gt[1]);const bt=this.query.match(we);return bt?this.queryResultQuery(bt[1]):["label_values()","metrics()","query_result()"].includes(this.query)?Promise.resolve([]):this.metricNameAndLabelsQuery(this.query)}labelValuesQuery(X,le){const be=(0,F.mv)(this.range.from,!1),De=(0,F.mv)(this.range.to,!0),Te={...le&&{"match[]":le},start:be.toString(),end:De.toString()};if(!le||this.datasource.hasLabelsMatchAPISupport()){const we=`/api/v1/label/${X}/values`;return this.datasource.metadataRequest(we,Te).then(Ke=>(0,n.map)(Ke.data.data,Ve=>({text:Ve})))}else return this.datasource.metadataRequest("/api/v1/series",Te).then(Ke=>{const Ve=(0,n.map)(Ke.data.data,ht=>ht[X]||"").filter(ht=>ht!=="");return(0,n.uniq)(Ve).map(ht=>({text:ht,expandable:!0}))})}metricNameQuery(X){const le=(0,F.mv)(this.range.from,!1),be=(0,F.mv)(this.range.to,!0),De={start:le.toString(),end:be.toString()};return this.datasource.metadataRequest("/api/v1/label/__name__/values",De).then(we=>(0,n.chain)(we.data.data).filter(Ke=>new RegExp(X).test(Ke)).map(Ke=>({text:Ke,expandable:!0})).value())}queryResultQuery(X){const le="/api/v1/query",be={query:X,time:(0,F.mv)(this.range.to,!0).toString()};return this.datasource.metadataRequest(le,be).then(De=>{switch(De.data.data.resultType){case"scalar":case"string":return[{text:De.data.data.result[1]||"",expandable:!1}];case"vector":return(0,n.map)(De.data.data.result,Te=>{let we=Te.metric.__name__||"";return delete Te.metric.__name__,we+="{"+(0,n.map)(Te.metric,(Ke,Ve)=>Ve+'="'+Ke+'"').join(",")+"}",we+=" "+Te.value[1]+" "+Te.value[0]*1e3,{text:we,expandable:!0}});default:throw Error(`Unknown/Unhandled result type: [${De.data.data.resultType}]`)}})}metricNameAndLabelsQuery(X){const le=(0,F.mv)(this.range.from,!1),be=(0,F.mv)(this.range.to,!0),De={"match[]":X,start:le.toString(),end:be.toString()},Te="/api/v1/series",we=this;return this.datasource.metadataRequest(Te,De).then(Ke=>(0,n.map)(Ke.data.data,Ve=>({text:we.datasource.getOriginalMetricName(Ve),expandable:!0})))}}function se(re){return re&&re.split(" ").join("")!=="{}"}const ne=20;function ee(re,X,le){const be=[],De=le?.languageProvider?.metricsMetadata;if(re.trim().match(/^\w+_bucket$|^\w+_bucket{.*}$/))be.push({type:"HISTOGRAM_QUANTILE",label:"Selected metric has buckets.",fix:{label:"Consider calculating aggregated quantile by adding histogram_quantile().",action:{type:"ADD_HISTOGRAM_QUANTILE",query:re}}});else if(De&&ie(re)){const we=z(re),{nameMetric:Ke}=q(we,"histogram",De,!1);if(Ke){const ht="Selected metric is a native histogram.";be.push({type:"HISTOGRAM_AVG",label:ht,fix:{label:"Consider calculating the arithmetic average of observed values by adding histogram_avg().",action:{type:"ADD_HISTOGRAM_AVG",query:re}}},{type:"HISTOGRAM_COUNT",label:ht,fix:{label:"Consider calculating the count of observations by adding histogram_count().",action:{type:"ADD_HISTOGRAM_COUNT",query:re}}},{type:"HISTOGRAM_SUM",label:ht,fix:{label:"Consider calculating the sum of observations by adding histogram_sum().",action:{type:"ADD_HISTOGRAM_SUM",query:re}}},{type:"HISTOGRAM_FRACTION",label:ht,fix:{label:"Consider calculating the estimated fraction of observations between the provided lower and upper values by adding histogram_fraction().",action:{type:"ADD_HISTOGRAM_FRACTION",query:re}}},{type:"HISTOGRAM_STDDEV",label:ht,fix:{label:"Consider calculating the estimated standard deviation of observations by adding histogram_stddev().",action:{type:"ADD_HISTOGRAM_STDDEV",query:re}}},{type:"HISTOGRAM_STDVAR",label:ht,fix:{label:"Consider calculating the estimated standard variance of observations by adding histogram_stdvar().",action:{type:"ADD_HISTOGRAM_STDVAR",query:re}}})}}if(re.indexOf("rate(")===-1&&re.indexOf("increase(")===-1){const we=re.match(/\b((?<!:)\w+_(total|sum|count)(?!:))\b/);let Ke=we?we[1]:"",Ve=!1;if(De){const ht=z(re),gt=q(ht,"counter",De,Ve);Ke=gt.nameMetric,Ve=gt.certain}if(Ke){const ht=ie(re);let bt=`Selected metric ${Ve?"is":"looks like"} a counter.`,St;ht?St={label:"Consider calculating rate of counter by adding rate().",action:{type:"ADD_RATE",query:re}}:bt=`${bt} Consider calculating rate of counter by adding rate().`,be.push({type:"APPLY_RATE",label:bt,fix:St})}}if(le&&le.ruleMappings){const we=le.ruleMappings,Ke=Object.keys(we).reduce((Ve,ht)=>re.search(ht)>-1?{...Ve,[ht]:we[ht]}:Ve,{});(0,n.size)(Ke)>0&&be.push({type:"EXPAND_RULES",label:"Query contains recording rules.",fix:{label:"Expand rules",action:{type:"EXPAND_RULES",query:re,options:Ke}}})}return X&&X.length>=ne&&re.trim().match(/^\w+$/)&&be.push({type:"ADD_SUM",label:"Many time series results returned.",fix:{label:"Consider aggregating with sum().",action:{type:"ADD_SUM",query:re,preventSubmit:!0}}}),be}function Z(re){const X=[];return re.lookupsDisabled&&X.push({label:"Labels and metrics lookup was disabled in data source settings.",type:"INFO"}),X}function z(re){return Array.from(re.matchAll(/\$?[a-zA-Z_:][a-zA-Z0-9_:]*/g)).map(([X])=>X).filter(X=>!X.startsWith("$")).flatMap(X=>X.split(":"))}function q(re,X,le,be){return{nameMetric:re.find(Te=>{const we=le[Te];return we&&we.type.toLowerCase()===X?(be=!0,!0):!1})??"",certain:be}}function ie(re){return re.trim().match(/^\w+$|^\w+{.*}$/)}var de=e(20716),ue=e(59809),fe=e(14110);function Se(re,X,le){const{app:be,targets:De}=X;if(be===b.Jk.Explore)for(const Te of De)(0,fe.rR)("grafana_prometheus_query_executed",{app:be,grafana_version:p.$.buildInfo.version,has_data:re.data.some(we=>we.length>0),has_error:re.error!==void 0,expr:Te.expr,format:Te.format,instant:Te.instant,range:Te.range,exemplar:Te.exemplar,hinting:Te.hinting,interval:Te.interval,intervalFactor:Te.intervalFactor,utcOffsetSec:Te.utcOffsetSec,legend:Te.legendFormat,valueWithRefId:Te.valueWithRefId,requestId:X.requestId,showingGraph:Te.showingGraph,showingTable:Te.showingTable,editor_mode:Te.editorMode,simultaneously_sent_query_count:De.length,time_range_from:X?.range?.from?.toISOString(),time_range_to:X?.range?.to?.toISOString(),time_taken:Date.now()-le.getTime()})}var he=e(62467),ce=e(65474),me=e(29505),pe=e(39268),ye=e(14186),Pe=e(21594),Ie=e(21744),Oe=e(29993);const Ne=[{label:"Label names",value:w.B4.LabelNames},{label:"Label values",value:w.B4.LabelValues},{label:"Metrics",value:w.B4.MetricNames},{label:"Query result",value:w.B4.VarQueryResult},{label:"Series query",value:w.B4.SeriesQuery},{label:"Classic query",value:w.B4.ClassicQuery}],We="PrometheusVariableQueryEditor-VariableQuery",Ae=({onChange:re,query:X,datasource:le,range:be})=>{const[De,Te]=(0,D.useState)(void 0),[we,Ke]=(0,D.useState)(""),[Ve,ht]=(0,D.useState)(""),[gt,bt]=(0,D.useState)(""),[St,Je]=(0,D.useState)(""),[rt,Rt]=(0,D.useState)(""),[_t,nn]=(0,D.useState)(""),[Kt,en]=(0,D.useState)([]),[Qt,An]=(0,D.useState)([]);(0,D.useEffect)(()=>{le.languageProvider.start(be)},[]),(0,D.useEffect)(()=>{if(X)if(X.qryType===w.B4.ClassicQuery)Te(X.qryType),nn(X.query??"");else{const nt=Ue(X);ht(nt.match??""),Te(nt.qryType),Ke(nt.label??""),bt(nt.metric??""),An(nt.labelFilters??[]),Je(nt.varQuery??""),Rt(nt.seriesQuery??""),nn(nt.classicQuery??"")}},[X]),(0,D.useEffect)(()=>{if(De!==w.B4.LabelValues)return;const nt=le.getVariables().map(yt=>({label:yt,value:yt}));if(!gt)le.getTagKeys({filters:[]}).then(yt=>{const Vt=yt.map(({text:je})=>({label:je,value:je}));en([...nt,...Vt])});else{const yt=[{label:"__name__",op:"=",value:gt}],Vt=K.z.renderLabels(yt);le.languageProvider.fetchLabelsWithMatch(Vt).then(je=>{const Dt=Object.keys(je).map(Ot=>({label:Ot,value:Ot}));en([...nt,...Dt])})}},[le,De,gt]);const un=(nt,yt)=>{const tt={...{qryType:De,label:we,metric:gt,match:Ve,varQuery:St,seriesQuery:rt,classicQuery:_t,refId:"PrometheusVariableQueryEditor-VariableQuery"},...nt,...yt?{labelFilters:yt}:{labelFilters:Qt}},Dt=j(tt);re({query:Dt,qryType:tt.qryType,refId:We})},fn=nt=>{Te(nt.value),nt.value!==w.B4.SeriesQuery&&un({qryType:nt.value??0})},Tt=nt=>{const yt=nt&&nt.value?nt.value:"";Ke(yt),De===w.B4.LabelValues&&yt&&un({label:yt})},$t=nt=>{bt(nt.metric),An(nt.labels);const yt=nt.metric,Vt=nt.labels??[];De===w.B4.LabelValues&&we&&(yt||Vt)&&un({qryType:De,metric:yt},Vt)},Yt=nt=>{De===w.B4.LabelNames&&un({qryType:De,match:nt})},Cn=nt=>{De===w.B4.MetricNames&&nt&&un({metric:nt})},Tn=nt=>{Je(nt.currentTarget.value)},vn=nt=>{Rt(nt.currentTarget.value)},Kn=nt=>{nn(nt.currentTarget.value)},Yn=(0,D.useCallback)(()=>({metric:gt,labels:Qt,operations:[]}),[gt,Qt]);return D.createElement(D.Fragment,null,D.createElement(pe.C,null,D.createElement(ye.I,{label:"Query type",labelWidth:20,tooltip:D.createElement("div",null,"The Prometheus data source plugin provides the following query types for template variables.")},D.createElement(Pe.l6,{placeholder:"Select query type","aria-label":"Query type",onChange:fn,value:De,options:Ne,width:25,"data-testid":E.Tp.components.DataSource.Prometheus.variableQueryEditor.queryType}))),De===w.B4.LabelValues&&D.createElement(D.Fragment,null,D.createElement(pe.C,null,D.createElement(ye.I,{label:"Label",labelWidth:20,required:!0,"aria-labelledby":"label-select",tooltip:D.createElement("div",null,"Returns a list of label values for the label name in all metrics unless the metric is specified.")},D.createElement(Pe.l6,{"aria-label":"label-select",onChange:Tt,value:we,options:Kt,width:25,allowCustomValue:!0,isClearable:!0,"data-testid":E.Tp.components.DataSource.Prometheus.variableQueryEditor.labelValues.labelSelect}))),D.createElement(Oe.I,{query:Yn(),datasource:le,onChange:$t,variableEditor:!0})),De===w.B4.LabelNames&&D.createElement(pe.C,null,D.createElement(ye.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric regex",tooltip:D.createElement("div",null,"Returns a list of label names, optionally filtering by specified metric regex.")},D.createElement(O.p,{type:"text","aria-label":"Metric regex",placeholder:"Metric regex",value:Ve,onBlur:nt=>{ht(nt.currentTarget.value),Yt(nt.currentTarget.value)},onChange:nt=>{ht(nt.currentTarget.value)},width:25,"data-testid":E.Tp.components.DataSource.Prometheus.variableQueryEditor.labelnames.metricRegex}))),De===w.B4.MetricNames&&D.createElement(pe.C,null,D.createElement(ye.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric selector",tooltip:D.createElement("div",null,"Returns a list of metrics matching the specified metric regex.")},D.createElement(O.p,{type:"text","aria-label":"Metric selector",placeholder:"Metric regex",value:gt,onChange:nt=>{bt(nt.currentTarget.value)},onBlur:nt=>{bt(nt.currentTarget.value),Cn(nt.currentTarget.value)},width:25,"data-testid":E.Tp.components.DataSource.Prometheus.variableQueryEditor.metricNames.metricRegex}))),De===w.B4.VarQueryResult&&D.createElement(pe.C,null,D.createElement(ye.I,{label:"Query",labelWidth:20,tooltip:D.createElement("div",null,"Returns a list of Prometheus query results for the query. This can include Prometheus functions, i.e. sum(go_goroutines).")},D.createElement(Ie.f,{type:"text","aria-label":"Prometheus Query",placeholder:"Prometheus Query",value:St,onChange:Tn,onBlur:()=>{De===w.B4.VarQueryResult&&St&&un({qryType:De})},cols:100,"data-testid":E.Tp.components.DataSource.Prometheus.variableQueryEditor.varQueryResult}))),De===w.B4.SeriesQuery&&D.createElement(pe.C,null,D.createElement(ye.I,{label:"Series Query",labelWidth:20,tooltip:D.createElement("div",null,'Enter a metric with labels, only a metric or only labels, i.e. go_goroutines{instance="localhost:9090"}, go_goroutines, or {instance="localhost:9090"}. Returns a list of time series associated with the entered data.')},D.createElement(O.p,{type:"text","aria-label":"Series Query",placeholder:"Series Query",value:rt,onChange:vn,onBlur:()=>{De===w.B4.SeriesQuery&&rt&&un({qryType:De})},width:100,"data-testid":E.Tp.components.DataSource.Prometheus.variableQueryEditor.seriesQuery}))),De===w.B4.ClassicQuery&&D.createElement(pe.C,null,D.createElement(ye.I,{label:"Classic Query",labelWidth:20,tooltip:D.createElement("div",null,"The original implemetation of the Prometheus variable query editor. Enter a string with the correct query type and parameters as described in these docs. For example, label_values(label, metric).")},D.createElement(O.p,{type:"text","aria-label":"Classic Query",placeholder:"Classic Query",value:_t,onChange:Kn,onBlur:()=>{De===w.B4.ClassicQuery&&_t&&un({qryType:De})},width:100,"data-testid":E.Tp.components.DataSource.Prometheus.variableQueryEditor.classicQuery}))))};function Ue(re){return typeof re=="string"?G(re):re.query?G(re.query):re}class Me extends me.f5{constructor(X,le=(0,P.w)()){super(),this.datasource=X,this.templateSrv=le,this.editor=Ae}query(X){let le;if(typeof X.targets[0]=="string"?le=X.targets[0]:le=X.targets[0].query,!le)return(0,he.of)({data:[]});const be={...X.scopedVars,__interval:{text:this.datasource.interval,value:this.datasource.interval},__interval_ms:{text:l.intervalToMs(this.datasource.interval),value:l.intervalToMs(this.datasource.interval)},...this.datasource.getRangeScopedVars(X.range)},De=this.templateSrv.replace(le,be,this.datasource.interpolateQueryExpr),Te=new oe(this.datasource,De);return(0,ce.H)(Te.process(X.range)).pipe((0,r.T)(Ke=>({data:Ke})))}}const $e="60s",ke=["api/v1/query","api/v1/query_range","api/v1/series","api/v1/labels"],Ze="-Instant";class ot extends g.iy{constructor(X,le=(0,P.w)(),be){super(X),this.templateSrv=le,this.init=async()=>{this.disableRecordingRules||this.loadRules(),this.exemplarsAvailable=await this.areExemplarsAvailable()},this.processAnnotationResponse=(De,Te)=>{const we=(0,c.bE)({data:Te}).data;if(!we||!we.length)return[];const Ke=De.annotation,{tagKeys:Ve="",titleFormat:ht="",textFormat:gt=""}=Ke,bt=l.intervalToSeconds(Ke.step||$e)*1e3,St=Ve.split(","),Je=[];for(const rt of we){if(rt.fields.length===0)continue;const Rt=rt.fields[0],_t=rt.fields[1],nn=_t?.labels||{},Kt=Object.keys(nn).filter(Tt=>St.includes(Tt)).map(Tt=>nn[Tt]),en=[];let Qt=0;_t.values.forEach(Tt=>{let $t,Yt;const Cn=Rt.values[Qt];De.annotation.useValueForTime?($t=Math.floor(parseFloat(Tt)),Yt=1):($t=Math.floor(parseFloat(Cn)),Yt=parseFloat(Tt)),Qt++,en.push([$t,Yt])});const un=en.filter(Tt=>Tt[1]>0).map(Tt=>Tt[0]);let fn=null;for(const Tt of un){if(fn&&(fn.timeEnd??0)+bt>=Tt){fn.timeEnd=Tt;continue}fn&&Je.push(fn),fn={time:Tt,timeEnd:Tt,annotation:Ke,title:(0,m.j)(ht,nn),tags:Kt,text:(0,m.j)(gt,nn)}}fn&&(fn.timeEnd=un[un.length-1],Je.push(fn))}return Je},this.type="prometheus",this.id=X.id,this.url=X.url,this.access=X.access,this.basicAuth=X.basicAuth,this.withCredentials=!!X.withCredentials,this.interval=X.jsonData.timeInterval||"15s",this.queryTimeout=X.jsonData.queryTimeout,this.httpMethod=X.jsonData.httpMethod||"GET",this.exemplarTraceIdDestinations=X.jsonData.exemplarTraceIdDestinations,this.hasIncrementalQuery=X.jsonData.incrementalQuerying??!1,this.ruleMappings={},this.languageProvider=be??new N.Ay(this),this.lookupsDisabled=X.jsonData.disableMetricsLookup??!1,this.customQueryParameters=new URLSearchParams(X.jsonData.customQueryParameters),this.datasourceConfigurationPrometheusFlavor=X.jsonData.prometheusType,this.datasourceConfigurationPrometheusVersion=X.jsonData.prometheusVersion,this.defaultEditor=X.jsonData.defaultEditor,this.disableRecordingRules=X.jsonData.disableRecordingRules??!1,this.variables=new Me(this,this.templateSrv),this.exemplarsAvailable=!0,this.cacheLevel=X.jsonData.cacheLevel??w.fD.Low,this.metricNamesAutocompleteSuggestionLimit=X.jsonData.codeModeMetricNamesSuggestionLimit??N.OP,this.cache=new de.$i({getTargetSignature:this.getPrometheusTargetSignature.bind(this),overlapString:X.jsonData.incrementalQueryOverlapWindow??de.Dr,profileFunction:this.getPrometheusProfileData.bind(this)}),this.annotations={QueryEditor:L}}getQueryDisplayText(X){return X.expr}getPrometheusProfileData(X,le){return{interval:le.interval??X.interval,expr:this.interpolateString(le.expr),datasource:"Prometheus"}}getPrometheusTargetSignature(X,le){return`${this.interpolateString(le.expr)}|${le.interval??X.interval}|${JSON.stringify(X.rangeRaw??"")}|${le.exemplar}`}hasLabelsMatchAPISupport(){return this._isDatasourceVersionGreaterOrEqualTo("2.24.0",w.N1.Prometheus)||this._isDatasourceVersionGreaterOrEqualTo("2.0.0",w.N1.Mimir)||this._isDatasourceVersionGreaterOrEqualTo("1.11.0",w.N1.Cortex)||this._isDatasourceVersionGreaterOrEqualTo("0.18.0",w.N1.Thanos)}_isDatasourceVersionGreaterOrEqualTo(X,le){return!this.datasourceConfigurationPrometheusVersion||!this.datasourceConfigurationPrometheusFlavor?!0:le!==this.datasourceConfigurationPrometheusFlavor?!1:d().gte(this.datasourceConfigurationPrometheusVersion,X)}_addTracingHeaders(X,le){X.headers={},this.access==="proxy"&&(X.headers["X-Dashboard-UID"]=le.dashboardUID,X.headers["X-Panel-Id"]=le.panelId)}directAccessError(){return(0,a.$)(()=>new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode."))}_request(X,le,be={}){if(this.access==="direct")return this.directAccessError();le=le||{};for(const[we,Ke]of this.customQueryParameters)le[we]==null&&(le[we]=Ke);let De=this.url+X;X.startsWith(`/api/datasources/uid/${this.uid}`)&&(De=X);const Te=(0,n.defaults)(be,{url:De,method:this.httpMethod,headers:{}});return Te.method==="GET"?le&&Object.keys(le).length&&(Te.url=Te.url+(Te.url.search(/\?/)>=0?"&":"?")+Object.entries(le).map(([we,Ke])=>`${encodeURIComponent(we)}=${encodeURIComponent(Ke)}`).join("&")):(Te.headers["Content-Type"]="application/x-www-form-urlencoded",Te.data=le),(this.basicAuth||this.withCredentials)&&(Te.withCredentials=!0),this.basicAuth&&(Te.headers.Authorization=this.basicAuth),(0,y.AI)().fetch(Te)}async importFromAbstractQueries(X){return X.map(le=>this.languageProvider.importFromAbstractQuery(le))}async exportToAbstractQueries(X){return X.map(le=>this.languageProvider.exportToAbstractQuery(le))}async metadataRequest(X,le={},be){if(ke.some(De=>X.includes(De)))try{return await(0,o.s)(this._request(`/api/datasources/uid/${this.uid}/resources${X}`,le,{method:this.httpMethod,hideFromInspector:!0,showErrorAlert:!1,...be}))}catch(De){if(this.httpMethod==="POST"&&(0,y.NF)(De)&&(De.status===405||De.status===400))console.warn("Couldn't use configured POST HTTP method for this request. Trying to use GET method instead.");else throw De}return await(0,o.s)(this._request(`/api/datasources/uid/${this.uid}/resources${X}`,le,{method:"GET",hideFromInspector:!0,...be}))}interpolateQueryExpr(X=[],le){if(!le.multi&&!le.includeAll)return ft(X);if(typeof X=="string")return Le(X);const be=X.map(De=>Le(De));return be.length===1?be[0]:"("+be.join("|")+")"}targetContainsTemplate(X){return this.templateSrv.containsTemplate(X.expr)}shouldRunExemplarQuery(X,le){if(X.exemplar){const be=this.languageProvider.histogramMetrics.find(we=>X.expr.includes(we)),De=le.targets.findIndex(we=>we.refId===X.refId),Te=le.targets.slice(0,De).filter(we=>!we.hide);return!!(!be||be&&!Te.some(we=>we.expr.includes(be)))}return!1}processTargetV2(X,le){const be=[],De={...X,exemplar:this.shouldRunExemplarQuery(X,le),requestId:le.panelId+X.refId,utcOffsetSec:le.range.to.utcOffset()*60};return p.$.featureToggles.promQLScope&&(De.scopes=(le.scopes??[]).map(Te=>({name:Te.metadata.name,...Te.spec}))),p.$.featureToggles.groupByVariable&&(De.groupByKeys=le.groupByKeys),X.instant&&X.range?be.push({...De,refId:De.refId,instant:!1},{...De,refId:De.refId+Ze,range:!1}):be.push(De),be}query(X){if(this.access==="direct")return this.directAccessError();let le,be;const De=X.targets.some(Ke=>Ke.instant);this.hasIncrementalQuery&&!De?(be=this.cache.requestInfo(X),le=be.requests[0]):le=X;const Te=le.targets.map(Ke=>this.processTargetV2(Ke,le)),we=new Date;return super.query({...le,targets:Te.flat()}).pipe((0,r.T)(Ke=>{const Ve={...Ke,data:this.cache.procFrames(X,be,Ke.data)};return(0,ue.J3)(Ve,X,{exemplarTraceIdDestinations:this.exemplarTraceIdDestinations})}),(0,i.M)(Ke=>{Se(Ke,X,we)}))}metricFindQuery(X,le){if(!X)return Promise.resolve([]);const be={__interval:{text:this.interval,value:this.interval},__interval_ms:{text:l.intervalToMs(this.interval),value:l.intervalToMs(this.interval)},...this.getRangeScopedVars(le?.range??(0,s.E2)())},De=this.templateSrv.replace(X,be,this.interpolateQueryExpr);return new oe(this,De).process(le?.range??(0,s.E2)())}getRangeScopedVars(X){const le=X.to.diff(X.from),be=Math.round(le/1e3);return{__range_ms:{text:le,value:le},__range_s:{text:be,value:be},__range:{text:be+"s",value:be+"s"}}}async annotationQuery(X){if(this.access==="direct"){const we=new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode.");return Promise.reject(we)}const le=X.annotation,{expr:be=""}=le;if(!be)return Promise.resolve([]);const De=X.annotation.step||$e,Te={expr:be,range:!0,instant:!1,exemplar:!1,interval:De,refId:"X",datasource:this.getRef()};return await(0,o.s)((0,y.AI)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:((0,F.mv)(X.range.from,!1)*1e3).toString(),to:((0,F.mv)(X.range.to,!0)*1e3).toString(),queries:[this.applyTemplateVariables(Te,{})]},requestId:`prom-query-${le.name}`}).pipe((0,r.T)(we=>this.processAnnotationResponse(X,we.data))))}async getTagKeys(X){if(!X||X.filters.length===0)return await this.languageProvider.fetchLabels(X.timeRange,X.queries),this.languageProvider.getLabelKeys().map(Te=>({value:Te,text:Te}));const le=X.filters.map(Te=>({label:Te.key,value:Te.value,op:Te.operator})),be=K.z.renderLabels(le);let De=await this.languageProvider.fetchLabelsWithMatch(be);return Object.keys(De).filter(Te=>!X.filters.find(we=>we.key===Te)).map(Te=>({value:Te,text:Te}))}async getTagValues(X){const le=X.filters.map(we=>({label:we.key,value:we.value,op:we.operator})),be=K.z.renderLabels(le);if(this.hasLabelsMatchAPISupport()){const we=`[${this.uid}][${X.key}]`;return(await this.languageProvider.fetchSeriesValuesWithMatch(X.key,be,we,X.timeRange)).map(Ke=>({value:Ke,text:Ke}))}const De=this.getTimeRangeParams(X.timeRange??(0,s.E2)());return(await this.metadataRequest(`/api/v1/label/${X.key}/values`,De))?.data?.data?.map(we=>({text:we}))??[]}interpolateVariablesInQueries(X,le,be){let De=X;return X&&X.length&&(De=X.map(Te=>{const we=this.templateSrv.replace(Te.expr,le,this.interpolateQueryExpr);return{...Te,...p.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(be)}:{},datasource:this.getRef(),expr:p.$.featureToggles.promQLScope?we:this.enhanceExprWithAdHocFilters(be,we),interval:this.templateSrv.replace(Te.interval,le)}})),De}getQueryHints(X,le){return ee(X.expr??"",le,this)}getInitHints(){return Z(this)}async loadRules(){try{const le=(await this.metadataRequest("/api/v1/rules",{},{showErrorAlert:!1})).data?.data?.groups;le&&(this.ruleMappings=ct(le))}catch(X){console.log("Rules API is experimental. Ignore next error."),console.error(X)}}async areExemplarsAvailable(){try{return(await this.metadataRequest("/api/v1/query_exemplars",{query:"test",start:(0,h.KQ)().subtract(30,"minutes").valueOf().toString(),end:(0,h.KQ)().valueOf().toString()},{showErrorAlert:!1})).data.status==="success"}catch{return!1}}modifyQuery(X,le){let be=X.expr??"";switch(le.type){case"ADD_FILTER":{const{key:De,value:Te}=le.options??{};De&&Te&&(be=(0,v.t)(be,De,Te));break}case"ADD_FILTER_OUT":{const{key:De,value:Te}=le.options??{};De&&Te&&(be=(0,v.t)(be,De,Te,"!="));break}case"ADD_HISTOGRAM_QUANTILE":{be=`histogram_quantile(0.95, sum(rate(${be}[$__rate_interval])) by (le))`;break}case"ADD_HISTOGRAM_AVG":{be=`histogram_avg(rate(${be}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_FRACTION":{be=`histogram_fraction(0,0.2,rate(${be}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_COUNT":{be=`histogram_count(rate(${be}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_SUM":{be=`histogram_sum(rate(${be}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDDEV":{be=`histogram_stddev(rate(${be}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDVAR":{be=`histogram_stdvar(rate(${be}[$__rate_interval]))`;break}case"ADD_RATE":{be=`rate(${be}[$__rate_interval])`;break}case"ADD_SUM":{be=`sum(${be.trim()}) by ($1)`;break}case"EXPAND_RULES":{le.options&&(be=(0,F.P_)(be,le.options));break}default:break}return{...X,expr:be}}getAdjustedInterval(X){return(0,F.Xd)(this.cacheLevel,X)}getTimeRangeParams(X){return{start:(0,F.mv)(X.from,!1).toString(),end:(0,F.mv)(X.to,!0).toString()}}getOriginalMetricName(X){return(0,ue.hF)(X)}generateScopeFilters(X){return X?X.map(le=>({...le,operator:u.n[le.operator]})):[]}enhanceExprWithAdHocFilters(X,le){return!X||X.length===0?le:X.reduce((De,Te)=>{const{key:we,operator:Ke}=Te;let{value:Ve}=Te;return(Ke==="=~"||Ke==="!~")&&(Ve=ft(Ve)),(0,v.t)(De,we,Ve,Ke)},le)}filterQuery(X){return!(X.hide||!X.expr)}applyTemplateVariables(X,le,be){const De={...le};De.__interval={value:"$__interval"},De.__interval_ms={value:"$__interval_ms"};const Te=this.templateSrv.replace(X.expr,De,this.interpolateQueryExpr);return{...X,...p.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(be)}:{},expr:p.$.featureToggles.promQLScope?Te:this.enhanceExprWithAdHocFilters(be,Te),interval:this.templateSrv.replace(X.interval,De),legendFormat:this.templateSrv.replace(X.legendFormat,De)}}getVariables(){return this.templateSrv.getVariables().map(X=>`$${X.name}`)}interpolateString(X,le){return this.templateSrv.replace(X,le,this.interpolateQueryExpr)}getDebounceTimeInMilliseconds(){switch(this.cacheLevel){case w.fD.Medium:return 600;case w.fD.High:return 1200;default:return 350}}getDaysToCacheMetadata(){switch(this.cacheLevel){case w.fD.Medium:return 7;case w.fD.High:return 30;default:return 1}}getCacheDurationInMinutes(){return(0,F.u3)(this.cacheLevel)}getDefaultQuery(X){const le={refId:"A",expr:"",range:!0,instant:!1};return X===b.Jk.UnifiedAlerting?{...le,instant:!0,range:!1}:X===b.Jk.Explore?{...le,instant:!0,range:!0}:le}}function xt(re,X,le,be){const De=Math.floor((X+be)/le)*le-be,Te=Math.floor((re+be)/le)*le-be;return{end:De,start:Te}}function ct(re){return re.reduce((X,le)=>le.rules.filter(be=>be.type==="recording").reduce((be,De)=>({...be,[De.name]:De.query}),X),{})}function ft(re){return typeof re=="string"?re.replace(/\\/g,"\\\\").replace(/'/g,"\\\\'"):re}function Le(re){return typeof re=="string"?re.replace(/\\/g,"\\\\\\\\").replace(/[$^*{}\[\]\'+?.()|]/g,"\\\\$&"):re}},52363:(Q,I,e)=>{"use strict";e.d(I,{A:()=>o});class n{get(i){return window.localStorage[i]}set(i,f){window.localStorage[i]=f}getBool(i,f){return f!==void 0&&!this.exists(i)?f:window.localStorage[i]==="true"}getObject(i,f){let d=f;if(this.exists(i)){const l=window.localStorage[i];try{d=JSON.parse(l)}catch(m){console.error(`Error parsing store object: ${i}. Returning default: ${f}. [${m}]`)}}return d}setObject(i,f){let d;try{d=JSON.stringify(f)}catch(l){throw new Error(`Could not stringify object: ${i}. [${l}]`)}try{this.set(i,d)}catch(l){const m=new Error(`Could not save item in localStorage: ${i}. [${l}]`);throw l instanceof Error&&(m.name=l.name),m}return!0}exists(i){return window.localStorage[i]!==void 0}delete(i){window.localStorage.removeItem(i)}}const o=new n},50556:(Q,I,e)=>{"use strict";e.d(I,{AU:()=>p,Ay:()=>E,OP:()=>g,pK:()=>y,xB:()=>c});var n=e(2543),a=e.n(n),o=e(28848),r=e.n(o),i=e(40187),f=e(43127),d=e(73372),l=e(81996),m=e(20719),s=e(76040),h=e(62183);const u=["job","instance"],b="{}",g=1e4,P=M=>({headers:{"X-Grafana-Cache":`private, max-age=${M}`}});function c(M,A){if(!A[M])return;const{type:x,help:C}=A[M];return`${x.toUpperCase()}: ${C}`}function y(M,A){if(A[M])return A[M].help}function p(M,A){if(A[M])return A[M].type}const v=/(="|!="|=~"|!~"|\{|\[|\(|\+|-|\/|\*|%|\^|\band\b|\bor\b|\bunless\b|==|>=|!=|<=|>|<|=|~|,)/,D=86400;class E extends i.Is{constructor(A,x){super(),this.labelKeys=[],this.request=async(C,O,R={},L)=>{try{return(await this.datasource.metadataRequest(C,R,L)).data.data}catch(N){T(N)||console.error(N)}return O},this.start=async C=>(this.timeRange=C??(0,f.E2)(),this.datasource.lookupsDisabled?[]:(this.metrics=await this.fetchLabelValues("__name__")||[],this.histogramMetrics=(0,l.Rg)(this.metrics).sort(),Promise.all([this.loadMetricsMetadata(),this.fetchLabels()]))),this.fetchLabelValues=async C=>{const O=this.datasource.getAdjustedInterval(this.timeRange),L=`/api/v1/label/${this.datasource.interpolateString(C)}/values`;return await this.request(L,[],O,this.getDefaultCacheHeaders())??[]},this.fetchLabels=async(C,O)=>{C&&(this.timeRange=C);let R="/api/v1/labels";const L=this.datasource.getAdjustedInterval(this.timeRange);this.labelFetchTs=Date.now().valueOf();const N=new URLSearchParams({...L});O?.forEach(K=>{const B=(0,s.u)(K.expr);B.query.metric!==""&&(N.append("match[]",B.query.metric),B.query.binaryQueries&&B.query.binaryQueries.forEach(w=>{N.append("match[]",w.query.metric)}))}),this.datasource.httpMethod==="GET"&&(R+=`?${N.toString()}`);const F=await this.request(R,[],N,this.getDefaultCacheHeaders());return Array.isArray(F)&&(this.labelKeys=F.slice().sort()),[]},this.getSeriesValues=async(C,O)=>this.datasource.hasLabelsMatchAPISupport()?await this.fetchSeriesValuesWithMatch(C,O):(await this.getSeries(O))[C]??[],this.fetchSeriesValuesWithMatch=async(C,O,R,L=this.timeRange)=>{const N=C?this.datasource.interpolateString(C):null,F=O?this.datasource.interpolateString(O):null,B={...this.datasource.getAdjustedInterval(L),...F&&{"match[]":F}};let w={...this.getDefaultCacheHeaders(),...R&&{requestId:R}};return Object.keys(w).length||(w=void 0),await this.request(`/api/v1/label/${N}/values`,[],B,w)??[]},this.getSeriesLabels=async(C,O)=>{let R,L;this.datasource.hasLabelsMatchAPISupport()?(O.push({name:"__name__",value:"",op:"!="}),L=await this.fetchSeriesLabelsMatch(C),R=Object.keys(L)):(L=await this.getSeries(C),R=Object.keys(L));const N=new Set(O.map(F=>F.name));return R.filter(F=>!N.has(F))},this.fetchLabelsWithMatch=async(C,O)=>this.datasource.hasLabelsMatchAPISupport()?this.fetchSeriesLabelsMatch(C,O):this.fetchSeriesLabels(C,O),this.fetchSeriesLabels=async(C,O)=>{const R=this.datasource.interpolateString(C),N={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":R},K=await this.request("/api/v1/series",[],N,this.getDefaultCacheHeaders()),{values:B}=(0,l.P7)(K,O);return B},this.fetchSeriesLabelsMatch=async(C,O)=>{const R=this.datasource.interpolateString(C),N={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":R};return(await this.request("/api/v1/labels",[],N,this.getDefaultCacheHeaders())).reduce((B,w)=>({...B,[w]:""}),{})},this.fetchSeries=async C=>{const O="/api/v1/series",L={...this.datasource.getTimeRangeParams(this.timeRange),"match[]":C};return await this.request(O,{},L,this.getDefaultCacheHeaders())},this.fetchDefaultSeries=(0,n.once)(async()=>{const C=await Promise.all(u.map(O=>this.fetchLabelValues(O)));return u.reduce((O,R,L)=>({...O,[R]:C[L]}),{})}),this.datasource=A,this.histogramMetrics=[],this.timeRange=(0,f.E2)(),this.metrics=[],Object.assign(this,x)}getDefaultCacheHeaders(){if(this.datasource.cacheLevel!==h.fD.None)return P(this.datasource.getCacheDurationInMinutes()*60)}cleanText(A){return A.split(v).pop().trimLeft().replace(/"$/,"").replace(/^"/,"")}get syntax(){return m.Ay}async loadMetricsMetadata(){const A=P(this.datasource.getDaysToCacheMetadata()*D);this.metricsMetadata=(0,l.DX)(await this.request("/api/v1/metadata",{},{},{showErrorAlert:!1,...A}))}getLabelKeys(){return this.labelKeys}importFromAbstractQuery(A){return(0,l.pt)(A)}exportToAbstractQuery(A){const x=A.expr;if(!x||x.length===0)return{refId:A.refId,labelMatchers:[]};const C=r().tokenize(x,m.Ay),O=(0,l.VH)(C),R=S(x,C);return R&&R.length>0&&O.push({name:"__name__",operator:d.D_.Equal,value:R}),{refId:A.refId,labelMatchers:O}}async getSeries(A,x){if(this.datasource.lookupsDisabled)return{};try{return A===b?await this.fetchDefaultSeries():await this.fetchSeriesLabels(A,x)}catch(C){return console.error(C),{}}}async getLabelValues(A){return await this.fetchLabelValues(A)}}function S(M,A){let x="";for(const C of A)if(typeof C=="string"){x=C;break}return x}function T(M){return typeof M=="object"&&M!==null&&"cancelled"in M&&M.cancelled===!0}},81996:(Q,I,e)=>{"use strict";e.d(I,{Cs:()=>O,DX:()=>v,P7:()=>b,P_:()=>y,Qn:()=>C,Rg:()=>u,VH:()=>B,Xd:()=>w,eN:()=>D,ky:()=>V,mv:()=>W,pt:()=>F,u3:()=>U});var n=e(2543),a=e.n(n),o=e(28848),r=e.n(o),i=e(73372),f=e(77678),d=e(85858),l=e(80937),m=e(50556),s=e(95899),h=e(62183);const u=_=>{const H=new Set,G=new RegExp("_bucket($|:)");for(let j=0;j<_.length;j++){const Y=_[j];G.test(Y)&&H.add(Y)}return[...H]};function b(_,H=!1){const G={};_.forEach(Y=>{const{__name__:oe,...se}=Y;H&&(G.__name__=G.__name__||new Set,G.__name__.has(oe)||G.__name__.add(oe)),Object.keys(se).forEach(ne=>{G[ne]||(G[ne]=new Set),G[ne].has(se[ne])||G[ne].add(se[ne])})});const j={};return T(Object.keys(G)).forEach(Y=>{j[Y]=T(Array.from(G[Y]))}),{values:j,keys:Object.keys(j)}}const g=/\{[^}]*?(\}|$)/,P=/\b(\w+)(!?=~?)("[^"\n]*?")(,)?(\s*)?/g;function c(_,H=1){if(!_.match(g)){if(_.match(/^[A-Za-z:][\w:]*$/))return{selector:`{__name__="${_}"}`,labelKeys:["__name__"]};throw new Error("Query must contain a selector: "+_)}const G=_.slice(0,H),j=G.lastIndexOf("{"),Y=G.lastIndexOf("}");if(j===-1)throw new Error("Not inside selector, missing open brace: "+G);if(Y>-1&&Y>j)throw new Error("Not inside selector, previous selector already closed: "+G);const oe=_.slice(H),ne=oe.indexOf("}")+H,ee=oe.indexOf("{"),Z=ee+H;if(ne===-1)throw new Error("Not inside selector, missing closing brace in suffix: "+oe);if(ee>-1&&Z<ne)throw new Error("Not inside selector, next selector opens before this one closed: "+oe);const z=_.slice(j,ne),q={};z.replace(P,(he,ce,me,pe)=>{const ye=_.indexOf(he),Pe=ye+ce.length+me.length+1,Ie=ye+ce.length+me.length+pe.length-1;return(H<Pe||H>Ie)&&(q[ce]={value:pe,operator:me}),""});const de=_.slice(0,j).match(/[A-Za-z:][\w:]*$/);de&&(q.__name__={value:`"${de[0]}"`,operator:"="});const ue=Object.keys(q).sort(),Se=["{",ue.map(he=>`${he}${q[he].operator}${q[he].value}`).join(","),"}"].join("");return{labelKeys:ue,selector:Se}}function y(_,H){const G=se=>new RegExp(`(\\s|\\(|^)(${se})(\\s|$|\\(|\\[|\\{)`,"ig"),j=Object.keys(H).reduce((se,ne)=>{let ee=[],Z=[],z=[];return se.filter(Boolean).forEach((q,ie)=>{q.match(G(ne))&&(ee=q.split(ne),ee.length===2?(z.push(ie),Z.push(...[ee[0],ne,ee[1]].filter(Boolean))):ee.length>2&&(z.push(ie),ee=ee.map(ue=>ue===""?ne:ue),Z.push(...ee)))}),z.forEach(q=>se[q]=""),se=se.filter(Boolean),se.push(...Z),se},[_]);let Y=!1;return j.map((se,ne)=>{if(Y)return Y=!1,"";if(H[se]){const ee=H[se];if(ne+1!==j.length&&j[ne+1].match(P)){Y=!0;const Z=j[ne+1],z=/(\)\{|\}\{|\]\{)/;return p(ee+Z,z)}else return ee}return se}).filter(Boolean).join("")}function p(_,H){const G=_.match(H);if(!G)return _;const j=G.index??0,Y=_.slice(0,j+1),oe=_.slice(j+1),se=[];oe.replace(P,(z,q,ie,de,ue,fe)=>(se.push({key:q,operator:ie,value:de,comma:ue,space:fe}),""));let ne=Y;se.filter(Boolean).forEach(z=>{const q=z.value.slice(1,-1);ne=(0,l.t)(ne,z.key,q,z.operator)});let ee=se.reduce((z,q)=>(z+=`${q.key}${q.operator}${q.value}${q.comma??""}${q.space??""}`,z),"");ee="{"+ee+"}";const Z=oe.replace(ee,"");return ne+Z}function v(_){if(!_)return _;const H={},G={};for(const Y in _){const oe=_[Y][0];H[Y]=oe,oe.type==="histogram"&&(G[`${Y}_bucket`]={type:"counter",help:`Cumulative counters for the observation buckets (${oe.help})`},G[`${Y}_count`]={type:"counter",help:`Count of events that have been observed for the histogram metric (${oe.help})`},G[`${Y}_sum`]={type:"counter",help:`Total sum of all observed values for the histogram metric (${oe.help})`}),oe.type==="summary"&&(G[`${Y}_count`]={type:"counter",help:`Count of events that have been observed for the base metric (${oe.help})`},G[`${Y}_sum`]={type:"counter",help:`Total sum of all observed values for the base metric (${oe.help})`})}const j={};return j.ALERTS={type:"counter",help:"Time series showing pending and firing alerts. The sample value is set to 1 as long as the alert is in the indicated active (pending or firing) state."},{...H,...G,...j}}function D(_){return E(_/1e3)}function E(_){return Math.floor(_/60)}function S(_,H=1){return Math.ceil(_/60)-Math.ceil(_/60)%H}function T(_){return _.slice(0,m.OP)}function M(_){return _&&_.length>=SUGGESTIONS_LIMIT?`, limited to the first ${SUGGESTIONS_LIMIT} received items`:""}const A=/[*+?()|\\.\[\]{}^$]/g;function x(_){return _.replace(A,"\\$&")}function C(_){return _.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function O(_){return C(x(_))}const R={"=":i.D_.Equal,"!=":i.D_.NotEqual,"=~":i.D_.EqualRegEx,"!~":i.D_.NotEqualRegEx},L=(0,n.invert)(R);function N(_){const H=_.labelMatchers.map(G=>{const j=L[G.operator];return j?`${G.name}${j}"${G.value}"`:""}).filter(G=>G!=="").join(", ");return H?`{${H}}`:""}function F(_){return{refId:_.refId,expr:N(_),range:!0}}function K(_){return typeof _.content=="string"?_.content:""}function B(_){const H=[];for(const G of _)if(G instanceof o.Token&&G.type==="context-labels"){let j="",Y="",oe="";const se=Array.isArray(G.content)?G.content:[G.content];for(let ne of se)if(typeof ne=="string"){let ee;ee=ne,(ee==="="||ee==="!="||ee==="=~"||ee==="!~")&&(oe=ee)}else if(ne instanceof o.Token)switch(ne.type){case"label-key":j=K(ne);break;case"label-value":Y=K(ne),Y=Y.substring(1,Y.length-1);const ee=R[oe];ee&&H.push({name:j,operator:ee,value:Y});break}}return H}function w(_,H){if(_===h.fD.None)return{start:W(H.from,!1).toString(),end:W(H.to,!0).toString()};const G=W(H.from,!1),j=(0,f.rs)(G,U(_)*60),Y=W(H.to,!0),oe=S(Y,U(_))*60;if(j===oe){const ee=oe+U(_)*60;return{start:j.toString(),end:ee.toString()}}const se=j.toString(),ne=oe.toString();return{start:se,end:ne}}function U(_){switch(_){case h.fD.Medium:return 10;case h.fD.High:return 60;default:return 1}}function W(_,H){return typeof _=="string"&&(_=d.parse(_,H)),Math.ceil(_.valueOf()/1e3)}function V(_,H){return H===void 0&&(H=s.o6),_.length=Math.min(_.length,H),_}},20719:(Q,I,e)=>{"use strict";e.d(I,{AW:()=>f,Ay:()=>m,n6:()=>l});const n=[{label:"$__interval",sortValue:"$__interval"},{label:"$__rate_interval",sortValue:"$__rate_interval"},{label:"$__range",sortValue:"$__range"},{label:"1m",sortValue:"00:01:00"},{label:"5m",sortValue:"00:05:00"},{label:"10m",sortValue:"00:10:00"},{label:"30m",sortValue:"00:30:00"},{label:"1h",sortValue:"01:00:00"},{label:"1d",sortValue:"24:00:00"}],a=["by","group_left","group_right","ignoring","on","offset","without"],o=null,r=[{label:"acos",insertText:"acos",detail:"acos(v instant-vector)",documentation:"calculates the arccosine of all elements in v"},{label:"acosh",insertText:"acosh",detail:"acosh(v instant-vector)",documentation:"calculates the inverse hyperbolic cosine of all elements in v"},{label:"asin",insertText:"asin",detail:"asin(v instant-vector)",documentation:"calculates the arcsine of all elements in v"},{label:"asinh",insertText:"asinh",detail:"asinh(v instant-vector)",documentation:"calculates the inverse hyperbolic sine of all elements in v"},{label:"atan",insertText:"atan",detail:"atan(v instant-vector)",documentation:"calculates the arctangent of all elements in v"},{label:"atanh",insertText:"atanh",detail:"atanh(v instant-vector)",documentation:"calculates the inverse hyperbolic tangent of all elements in v"},{label:"cos",insertText:"cos",detail:"cos(v instant-vector)",documentation:"calculates the cosine of all elements in v"},{label:"cosh",insertText:"cosh",detail:"cosh(v instant-vector)",documentation:"calculates the hyperbolic cosine of all elements in v"},{label:"sin",insertText:"sin",detail:"sin(v instant-vector)",documentation:"calculates the sine of all elements in v"},{label:"sinh",insertText:"sinh",detail:"sinh(v instant-vector)",documentation:"calculates the hyperbolic sine of all elements in v"},{label:"tan",insertText:"tan",detail:"tan(v instant-vector)",documentation:"calculates the tangent of all elements in v"},{label:"tanh",insertText:"tanh",detail:"tanh(v instant-vector)",documentation:"calculates the hyperbolic tangent of all elements in v"}],f=[...[{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"group",insertText:"group",documentation:"All values in the resulting vector are 1"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"count_values",insertText:"count_values",documentation:"Count number of elements with the same value"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"},{label:"quantile",insertText:"quantile",documentation:"Calculate \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) over dimensions"}],...r,{insertText:"abs",label:"abs",detail:"abs(v instant-vector)",documentation:"Returns the input vector with all sample values converted to their absolute value."},{insertText:"absent",label:"absent",detail:"absent(v instant-vector)",documentation:"Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination."},{insertText:"absent_over_time",label:"absent_over_time",detail:"absent(v range-vector)",documentation:"Returns an empty vector if the range vector passed to it has any elements and a 1-element vector with the value 1 if the range vector passed to it has no elements."},{insertText:"ceil",label:"ceil",detail:"ceil(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` up to the nearest integer."},{insertText:"changes",label:"changes",detail:"changes(v range-vector)",documentation:"For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector."},{insertText:"clamp",label:"clamp",detail:"clamp(v instant-vector, min scalar, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min` and an upper limit of `max`."},{insertText:"clamp_max",label:"clamp_max",detail:"clamp_max(v instant-vector, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have an upper limit of `max`."},{insertText:"clamp_min",label:"clamp_min",detail:"clamp_min(v instant-vector, min scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min`."},{insertText:"count_scalar",label:"count_scalar",detail:"count_scalar(v instant-vector)",documentation:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."},{insertText:"deg",label:"deg",detail:"deg(v instant-vector)",documentation:"Converts radians to degrees for all elements in v"},{insertText:"day_of_month",label:"day_of_month",detail:"day_of_month(v=vector(time()) instant-vector)",documentation:"Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31."},{insertText:"day_of_week",label:"day_of_week",detail:"day_of_week(v=vector(time()) instant-vector)",documentation:"Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc."},{insertText:"day_of_year",label:"day_of_year",detail:"day_of_year(v=vector(time()) instant-vector)",documentation:"Returns the day of the year for each of the given times in UTC. Returned values are from 1 to 365 for non-leap years, and 1 to 366 in leap years."},{insertText:"days_in_month",label:"days_in_month",detail:"days_in_month(v=vector(time()) instant-vector)",documentation:"Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31."},{insertText:"delta",label:"delta",detail:"delta(v range-vector)",documentation:"Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers."},{insertText:"deriv",label:"deriv",detail:"deriv(v range-vector)",documentation:"Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression."},{insertText:"drop_common_labels",label:"drop_common_labels",detail:"drop_common_labels(instant-vector)",documentation:"Drops all labels that have the same name and value across all series in the input vector."},{insertText:"exp",label:"exp",detail:"exp(v instant-vector)",documentation:"Calculates the exponential function for all elements in `v`.\nSpecial cases are:\n* `Exp(+Inf) = +Inf` \n* `Exp(NaN) = NaN`"},{insertText:"floor",label:"floor",detail:"floor(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` down to the nearest integer."},{insertText:"histogram_quantile",label:"histogram_quantile",detail:"histogram_quantile(\u03C6 float, b instant-vector)",documentation:"Calculates the \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels."},{insertText:"holt_winters",label:"holt_winters",detail:"holt_winters(v range-vector, sf scalar, tf scalar)",documentation:"Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{insertText:"hour",label:"hour",detail:"hour(v=vector(time()) instant-vector)",documentation:"Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23."},{insertText:"idelta",label:"idelta",detail:"idelta(v range-vector)",documentation:"Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels."},{insertText:"increase",label:"increase",detail:"increase(v range-vector)",documentation:"Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments."},{insertText:"irate",label:"irate",detail:"irate(v range-vector)",documentation:"Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for."},{insertText:"label_join",label:"label_join",detail:"label_join(v instant-vector, dst_label string, separator string, src_label_1 string, src_label_2 string, ...)",documentation:"For each timeseries in `v`, joins all the values of all the `src_labels` using `separator` and returns the timeseries with the label `dst_label` containing the joined value. There can be any number of `src_labels` in this function."},{insertText:"label_replace",label:"label_replace",detail:"label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)",documentation:"For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn't match then the timeseries is returned unchanged."},{insertText:"ln",label:"ln",detail:"ln(v instant-vector)",documentation:"Calculates the natural logarithm for all elements in `v`.\nSpecial cases are:\n * `ln(+Inf) = +Inf`\n * `ln(0) = -Inf`\n * `ln(x < 0) = NaN`\n * `ln(NaN) = NaN`"},{insertText:"log2",label:"log2",detail:"log2(v instant-vector)",documentation:"Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"log10",label:"log10",detail:"log10(v instant-vector)",documentation:"Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"minute",label:"minute",detail:"minute(v=vector(time()) instant-vector)",documentation:"Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59."},{insertText:"month",label:"month",detail:"month(v=vector(time()) instant-vector)",documentation:"Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc."},{insertText:"pi",label:"pi",detail:"pi()",documentation:"Returns pi"},{insertText:"predict_linear",label:"predict_linear",detail:"predict_linear(v range-vector, t scalar)",documentation:"Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression."},{insertText:"rad",label:"rad",detail:"rad(v instant-vector)",documentation:"Converts degrees to radians for all elements in v"},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period."},{insertText:"resets",label:"resets",detail:"resets(v range-vector)",documentation:"For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset."},{insertText:"round",label:"round",detail:"round(v instant-vector, to_nearest=1 scalar)",documentation:"Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction."},{insertText:"scalar",label:"scalar",detail:"scalar(v instant-vector)",documentation:"Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`."},{insertText:"sgn",label:"sgn",detail:"sgn(v instant-vector)",documentation:"Returns a vector with all sample values converted to their sign, defined as this: 1 if v is positive, -1 if v is negative and 0 if v is equal to zero."},{insertText:"sort",label:"sort",detail:"sort(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in ascending order."},{insertText:"sort_desc",label:"sort_desc",detail:"sort_desc(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in descending order."},{insertText:"sqrt",label:"sqrt",detail:"sqrt(v instant-vector)",documentation:"Calculates the square root of all elements in `v`."},{insertText:"time",label:"time",detail:"time()",documentation:"Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated."},{insertText:"timestamp",label:"timestamp",detail:"timestamp(v instant-vector)",documentation:"Returns the timestamp of each of the samples of the given vector as the number of seconds since January 1, 1970 UTC."},{insertText:"vector",label:"vector",detail:"vector(s scalar)",documentation:"Returns the scalar `s` as a vector with no labels."},{insertText:"year",label:"year",detail:"year(v=vector(time()) instant-vector)",documentation:"Returns the year for each of the given times in UTC."},{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average value of all points in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum value of all points in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum value of all points in the specified interval."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The most recent point value in specified interval."},{insertText:"present_over_time",label:"present_over_time",detail:"present_over_time(range-vector)",documentation:"The value 1 for any series in the specified interval."},{insertText:"histogram_avg",label:"histogram_avg",detail:"histogram_avg(v instant-vector)",documentation:"Returns the arithmetic average of observed values stored in a native histogram. Samples that are not native histograms are ignored and do not show up in the returned vector."},{insertText:"histogram_count",label:"histogram_count",detail:"histogram_count(v instant-vector)",documentation:"Returns the count of observations stored in a native histogram."},{insertText:"histogram_sum",label:"histogram_sum",detail:"histogram_sum(v instant-vector)",documentation:"Returns the sum of observations stored in a native histogram."},{insertText:"histogram_fraction",label:"histogram_fraction",detail:"histogram_fraction(lower scalar, upper scalar, v instant-vector)",documentation:"Returns the estimated fraction of observations between the provided lower and upper values."},{insertText:"histogram_stddev",label:"histogram_stddev",detail:"histogram_stddev(v instant-vector)",documentation:"Returns the estimated standard deviation of observations in a native histogram, based on the geometric mean of the buckets where the observations lie."},{insertText:"histogram_stdvar",label:"histogram_stdvar",detail:"histogram_stdvar(v instant-vector)",documentation:"Returns the estimated standard variance of observations in a native histogram."}],d=f.map(s=>s.label),l={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((by|without)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},function:new RegExp(`\\b(?:${f.map(s=>s.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],idList:{pattern:/\d+(\|\d+)+/,alias:"number"},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:new RegExp(`/[-+*/=%^~]|&&?|\\|?\\||!=?|<(?:=>?|<|>)?|>[>=]?|\\b(?:${a.join("|")})\\b`,"i"),punctuation:/[{};()`,.]/},m=l},32370:(Q,I,e)=>{"use strict";e.d(I,{l:()=>E,z:()=>S});var n=e(20719),a=e(1220),o=e(75161),r=e(38961),i=e(15145);function f(){return[{id:i.jN.HistogramQuantile,name:"Histogram quantile",params:[{name:"Quantile",type:"number",options:[.99,.95,.9,.75,.5,.25]}],defaultParams:[.9],category:i.Ag.Functions,renderer:a.jY,addOperationHandler:a.iZ},d({id:i.jN.HistogramAvg}),d({id:i.jN.HistogramCount}),d({id:i.jN.HistogramSum}),{id:i.jN.HistogramFraction,name:"Histogram fraction",params:[{name:"Lower scalar",type:"number"},{name:"Upper scalar",type:"number"}],defaultParams:[0,.2],category:i.Ag.Functions,renderer:a.jY,addOperationHandler:a.iZ},d({id:i.jN.HistogramStddev}),d({id:i.jN.HistogramStdvar}),{id:i.jN.LabelReplace,name:"Label replace",params:[{name:"Destination label",type:"string"},{name:"Replacement",type:"string"},{name:"Source label",type:"string"},{name:"Regex",type:"string"}],category:i.Ag.Functions,defaultParams:["","$1","","(.*)"],renderer:a.kf,addOperationHandler:a.iZ},{id:i.jN.Ln,name:"Ln",params:[],defaultParams:[],category:i.Ag.Functions,renderer:a.jY,addOperationHandler:a.iZ},l(i.jN.Changes),l(i.jN.Rate,!0),l(i.jN.Irate),l(i.jN.Increase,!0),l(i.jN.Idelta),l(i.jN.Delta),d({id:i.jN.HoltWinters,params:[(0,a.z2)(),{name:"Smoothing Factor",type:"number"},{name:"Trend Factor",type:"number"}],defaultParams:["$__interval",.5,.5],alternativesKey:"range function",category:i.Ag.RangeFunctions,renderer:a.nU,addOperationHandler:h,changeTypeHandler:m}),d({id:i.jN.PredictLinear,params:[(0,a.z2)(),{name:"Seconds from now",type:"number"}],defaultParams:["$__interval",60],alternativesKey:"range function",category:i.Ag.RangeFunctions,renderer:a.nU,addOperationHandler:h,changeTypeHandler:m}),d({id:i.jN.QuantileOverTime,params:[(0,a.z2)(),{name:"Quantile",type:"number"}],defaultParams:["$__interval",.5],alternativesKey:"overtime function",category:i.Ag.RangeFunctions,renderer:a.Kl,addOperationHandler:h,changeTypeHandler:m}),...o.Iu,{id:i.jN.NestedQuery,name:"Binary operation with query",params:[],defaultParams:[],category:i.Ag.BinaryOps,renderer:(M,A,x)=>x,addOperationHandler:u},d({id:i.jN.Abs}),d({id:i.jN.Absent}),d({id:i.jN.Acos,category:i.Ag.Trigonometric}),d({id:i.jN.Acosh,category:i.Ag.Trigonometric}),d({id:i.jN.Asin,category:i.Ag.Trigonometric}),d({id:i.jN.Asinh,category:i.Ag.Trigonometric}),d({id:i.jN.Atan,category:i.Ag.Trigonometric}),d({id:i.jN.Atanh,category:i.Ag.Trigonometric}),d({id:i.jN.Ceil}),d({id:i.jN.Clamp,name:"Clamp",params:[{name:"Minimum Scalar",type:"number"},{name:"Maximum Scalar",type:"number"}],defaultParams:[1,1]}),d({id:i.jN.ClampMax,params:[{name:"Maximum Scalar",type:"number"}],defaultParams:[1]}),d({id:i.jN.ClampMin,params:[{name:"Minimum Scalar",type:"number"}],defaultParams:[1]}),d({id:i.jN.Cos,category:i.Ag.Trigonometric}),d({id:i.jN.Cosh,category:i.Ag.Trigonometric}),d({id:i.jN.DayOfMonth,category:i.Ag.Time}),d({id:i.jN.DayOfWeek,category:i.Ag.Time}),d({id:i.jN.DayOfYear,category:i.Ag.Time}),d({id:i.jN.DaysInMonth,category:i.Ag.Time}),d({id:i.jN.Deg}),l(i.jN.Deriv),d({id:i.jN.Exp}),d({id:i.jN.Floor}),d({id:i.jN.Group}),d({id:i.jN.Hour}),d({id:i.jN.LabelJoin,params:[{name:"Destination Label",type:"string",editor:r.r},{name:"Separator",type:"string"},{name:"Source Label",type:"string",restParam:!0,optional:!0,editor:r.r}],defaultParams:["",",",""],renderer:b,explainHandler:g,addOperationHandler:P}),d({id:i.jN.Log10}),d({id:i.jN.Log2}),d({id:i.jN.Minute}),d({id:i.jN.Month}),d({id:i.jN.Pi,renderer:M=>`${M.id}()`}),d({id:i.jN.Quantile,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:a.jY}),d({id:i.jN.Rad}),l(i.jN.Resets),d({id:i.jN.Round,category:i.Ag.Functions,params:[{name:"To Nearest",type:"number"}],defaultParams:[1]}),d({id:i.jN.Scalar}),d({id:i.jN.Sgn}),d({id:i.jN.Sin,category:i.Ag.Trigonometric}),d({id:i.jN.Sinh,category:i.Ag.Trigonometric}),d({id:i.jN.Sort}),d({id:i.jN.SortDesc}),d({id:i.jN.Sqrt}),d({id:i.jN.Stddev}),d({id:i.jN.Tan,category:i.Ag.Trigonometric}),d({id:i.jN.Tanh,category:i.Ag.Trigonometric}),d({id:i.jN.Time,renderer:M=>`${M.id}()`}),d({id:i.jN.Timestamp}),d({id:i.jN.Vector,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:M=>`${M.id}(${M.params[0]})`}),d({id:i.jN.Year})]}function d(T){return{...T,id:T.id,name:T.name??(0,a.DQ)(T.id),params:T.params??[],defaultParams:T.defaultParams??[],category:T.category??i.Ag.Functions,renderer:T.renderer??(T.params?a.kf:a.jY),addOperationHandler:T.addOperationHandler??a.iZ}}function l(T,M=!1){return{id:T,name:(0,a.DQ)(T),params:[(0,a.z2)(M)],defaultParams:[M?"$__rate_interval":"$__interval"],alternativesKey:"range function",category:i.Ag.RangeFunctions,renderer:s,addOperationHandler:h,changeTypeHandler:m}}function m(T,M){return(T.params[0]==="$__rate_interval"&&M.defaultParams[0]!=="$__rate_interval"||T.params[0]==="$__interval"&&M.defaultParams[0]!=="$__interval")&&(T.params=M.defaultParams),T}function s(T,M,A){let x=(T.params??[])[0]??"5m";return`${M.id}(${A}[${x}])`}function h(T,M,A){const x={id:T.id,params:T.defaultParams};return M.operations.length>0&&A.getOperationDef(M.operations[0].id).addOperationHandler===h?{...M,operations:[x,...M.operations.slice(1)]}:{...M,operations:[x,...M.operations]}}function u(T,M){return{...M,binaryQueries:[...M.binaryQueries??[],{operator:"/",query:M}]}}function b(T,M,A){const x=T.params[0]??"",O=`"${T.params[1]??""}"`;return`${T.id}(${A}, "${x}", ${O}, "${T.params.slice(2).join(O)}")`}function g(T,M){let A=M?.documentation??"no docs";return typeof T.params[1]!="string"&&(A+=" \u{1F6A8}\u{1F6A8}\u{1F6A8} The `separator` must be a string."),A}function P(T,M){const A={id:T.id,params:T.defaultParams};return{...M,operations:[...M.operations,A]}}function c(){return[...(0,a.G3)(i.jN.Sum),...(0,a.G3)(i.jN.Avg),...(0,a.G3)(i.jN.Min),...(0,a.G3)(i.jN.Max),...(0,a.G3)(i.jN.Count),...(0,a.jC)(i.jN.TopK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,a.jC)(i.jN.BottomK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,a.jC)(i.jN.CountValues,{params:[{name:"Identifier",type:"string"}],defaultParams:["count"]}),y(i.jN.SumOverTime),y(i.jN.AvgOverTime),y(i.jN.MinOverTime),y(i.jN.MaxOverTime),y(i.jN.CountOverTime),y(i.jN.LastOverTime),y(i.jN.PresentOverTime),y(i.jN.AbsentOverTime),y(i.jN.StddevOverTime)]}function y(T){return{id:T,name:(0,a.DQ)(T),params:[(0,a.z2)()],defaultParams:["$__interval"],alternativesKey:"overtime function",category:i.Ag.RangeFunctions,renderer:p,addOperationHandler:h}}function p(T,M,A){let x=(T.params??[])[0]??"$__interval";return`${M.id}(${A}[${x}])`}var v=e(83077);class D{constructor(M){this.categories=[],this.operationsRegistry=new v.O(M)}setOperationCategories(M){this.categories=M}getOperationsForCategory(M){return this.operationsRegistry.list().filter(A=>A.category===M&&!A.hideFromList)}getAlternativeOperations(M){return this.operationsRegistry.list().filter(A=>A.alternativesKey&&A.alternativesKey===M)}getCategories(){return this.categories}getOperationDef(M){return this.operationsRegistry.getIfExists(M)}renderOperations(M,A){for(const x of A){const C=this.operationsRegistry.getIfExists(x.id);if(!C)throw new Error(`Could not find operation ${x.id} in the registry`);M=C.renderer(x,C,M)}return M}renderBinaryQueries(M,A){if(A)for(const x of A)M=`${this.renderBinaryQuery(M,x)}`;return M}renderBinaryQuery(M,A){let x=M+` ${A.operator} `;return A.vectorMatches&&(x+=`${A.vectorMatchesType}(${A.vectorMatches}) `),x+this.renderQuery(A.query,!0)}renderLabels(M){if(M.length===0)return"";let A="{";for(const x of M)A!=="{"&&(A+=", "),A+=`${x.label}${x.op}"${x.value}"`;return A+"}"}renderQuery(M,A){let x=`${M.metric??""}${this.renderLabels(M.labels)}`;return x=this.renderOperations(x,M.operations),!A&&this.hasBinaryOp(M)&&M.binaryQueries?.length&&(x=`(${x})`),x=this.renderBinaryQueries(x,M.binaryQueries),A&&(this.hasBinaryOp(M)||M.binaryQueries?.length)&&(x=`(${x})`),x}hasBinaryOp(M){return M.operations.find(A=>this.getOperationDef(A.id)?.category===i.Ag.BinaryOps)!==void 0}}class E extends D{constructor(){super(()=>{const M=[...f(),...c()];for(const A of M){const x=n.AW.find(C=>C.insertText===A.id);x&&(A.documentation=x.documentation)}return M}),this.setOperationCategories([i.Ag.Aggregations,i.Ag.RangeFunctions,i.Ag.Functions,i.Ag.BinaryOps,i.Ag.Trigonometric,i.Ag.Time])}getQueryPatterns(){return[{name:"Rate then sum",type:i.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]},{name:"Rate then sum by(label) then avg",type:i.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:[""]},{id:"avg",params:[]}]},{name:"Histogram quantile on rate",type:i.n5.Histogram,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Histogram quantile on increase",type:i.n5.Histogram,operations:[{id:"increase",params:["$__rate_interval"]},{id:"__max_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Binary Query",type:i.n5.Binary,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}],binaryQueries:[{operator:"/",query:{metric:"",labels:[],operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]}}]}]}}const S=new E},75161:(Q,I,e)=>{"use strict";e.d(I,{AE:()=>r,C8:()=>o,Iu:()=>i});var n=e(1220),a=e(15145);const o=[{id:a.jN.Addition,name:"Add scalar",sign:"+"},{id:a.jN.Subtraction,name:"Subtract scalar",sign:"-"},{id:a.jN.MultiplyBy,name:"Multiply by scalar",sign:"*"},{id:a.jN.DivideBy,name:"Divide by scalar",sign:"/"},{id:a.jN.Modulo,name:"Modulo by scalar",sign:"%"},{id:a.jN.Exponent,name:"Exponent",sign:"^"},{id:a.jN.EqualTo,name:"Equal to",sign:"==",comparison:!0},{id:a.jN.NotEqualTo,name:"Not equal to",sign:"!=",comparison:!0},{id:a.jN.GreaterThan,name:"Greater than",sign:">",comparison:!0},{id:a.jN.LessThan,name:"Less than",sign:"<",comparison:!0},{id:a.jN.GreaterOrEqual,name:"Greater or equal to",sign:">=",comparison:!0},{id:a.jN.LessOrEqual,name:"Less or equal to",sign:"<=",comparison:!0}],r=o.reduce((d,l)=>(d[l.sign]={id:l.id,comparison:l.comparison},d),{}),i=o.map(d=>{const l=[{name:"Value",type:"number"}];let m=[2];return d.comparison&&(l.push({name:"Bool",type:"boolean",description:"If checked comparison will return 0 or 1 for the value rather than filtering."}),m=[2,!1]),{id:d.id,name:d.name,params:l,defaultParams:m,alternativesKey:"binary scalar operations",category:a.Ag.BinaryOps,renderer:f(d.sign),addOperationHandler:n.iZ}});function f(d){return function(m,s,h){let u=m.params[0],b="";return m.params.length===2&&(b=m.params[1]?" bool":""),`${h} ${d}${b} ${u}`}}},38961:(Q,I,e)=>{"use strict";e.d(I,{r:()=>f});var n=e(96540),a=e(50877),o=e(21594),r=e(32370),i=e(1220);function f({onChange:l,index:m,operationId:s,value:h,query:u,datasource:b}){const[g,P]=(0,n.useState)({});return n.createElement(o.l6,{inputId:(0,i.OS)(s,m),autoFocus:h===""?!0:void 0,openMenuOnFocus:!0,onOpenMenu:async()=>{P({isLoading:!0});const c=await d(u,b);P({options:c,isLoading:void 0})},isLoading:g.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:g.options,value:(0,a.z)(h),onChange:c=>l(m,c.value)})}async function d(l,m){let s=l.labels;m.type==="prometheus"&&(s=[{label:"__name__",op:"=",value:l.metric},...l.labels]);const h=r.z.renderLabels(s),u=await m.languageProvider.fetchLabelsWithMatch(h);return Object.keys(u).map(b=>({label:b,value:b}))}},95899:(Q,I,e)=>{"use strict";e.d(I,{dm:()=>ht,o6:()=>Ve});var n=e(32196),a=e(76459),o=e.n(a),r=e(96540),i=e(23257),f=e.n(i),d=e(50877),l=e(13544),m=e(97801),s=e(81580),h=e(32264),u=e(40845),b=e(55852),g=e(14578),P=e(88824),c=e(40276),y=e(21594),p=e(39268),v=e(14186),D=e(2543),E=e(91793),S=e(8887);const T=({children:Je,maxHeight:rt,innerRef:Rt,innerProps:_t})=>{const nn=(0,u.$j)(),Kt=(0,P.J)(nn);return r.createElement("div",{..._t,className:Kt.menu,style:{maxHeight:rt},"aria-label":"Select options menu"},r.createElement(c.E,{scrollRefCallback:Rt,autoHide:!1,autoHeightMax:"inherit",hideHorizontalTrack:!0},Je))};T.displayName="SelectMenu";const M=37,A=7,x=({children:Je,maxHeight:rt,options:Rt,getValue:_t})=>{const nn=(0,u.$j)(),Kt=(0,P.J)(nn),[en]=_t(),An=(en?Rt.findIndex($t=>$t.value===en.value):0)*M;if(!Array.isArray(Je))return null;const fn=((0,D.max)(Rt.map($t=>$t.label?.length))??0)*A,Tt=Math.min(Rt.length*M,rt);return r.createElement(E.Y1,{className:Kt.menu,height:Tt,width:fn,"aria-label":"Select options menu",itemCount:Je.length,itemSize:M,initialScrollOffset:An},({index:$t,style:Yt})=>r.createElement("div",{style:{...Yt,overflow:"hidden"}},Je[$t]))};x.displayName="VirtualizedSelectMenu";const C=({children:Je,data:rt,innerProps:Rt,innerRef:_t,isFocused:nn,isSelected:Kt,renderOptionLabel:en})=>{const Qt=(0,u.$j)(),An=(0,P.J)(Qt),un=rt.icon?(0,S.Uo)(rt.icon):void 0,{onMouseMove:fn,onMouseOver:Tt,...$t}=Rt;return r.createElement("div",{ref:_t,className:(0,n.cx)(An.option,nn&&An.optionFocused,Kt&&An.optionSelected,rt.isDisabled&&An.optionDisabled),...$t,"data-testid":l.Tp.components.Select.option,title:rt.title},un&&r.createElement(g.I,{name:un,className:An.optionIcon}),rt.imgUrl&&r.createElement("img",{className:An.optionImage,src:rt.imgUrl,alt:rt.label||String(rt.value)}),r.createElement("div",{className:An.optionBody},r.createElement("span",null,en?en(rt):Je),rt.description&&r.createElement("div",{className:An.optionDescription},rt.description),rt.component&&r.createElement(rt.component,null)))};C.displayName="SelectMenuOptions";var O=e(81996),R=e(26115),L=e(65307),N=e(37390),F=e(10354),K=e(62930),B=e(60782),w=e(19727),U=e(19384),W=e(15292),V=e(56034),_=e(14110),H=e(50556);async function G(Je,rt,Rt){let _t=!0;const nn=Je.languageProvider.metricsMetadata;nn&&Object.keys(nn).length===0&&(_t=!1);let Kt={},en={},Qt;return Qt=Rt?.map(An=>{const un=j(An,Je),fn=`${An}\xA6${un.description}`;return Kt[An]=un,en[fn]=un,un}),{isLoading:!1,hasMetadata:_t,metrics:Qt??[],metaHaystackDictionary:en,nameHaystackDictionary:Kt,totalMetricCount:Qt?.length??0,filteredMetricCount:Qt?.length??0}}function j(Je,rt){let Rt=(0,H.AU)(Je,rt.languageProvider.metricsMetadata);const _t=(0,H.pK)(Je,rt.languageProvider.metricsMetadata);["histogram","summary"].forEach(en=>{_t?.toLowerCase().includes(en)&&Rt!==en&&(Rt+=` (${en})`)});const nn=Je.match(/^\w+_bucket$|^\w+_bucket{.*}$/);return Rt==="histogram"&&!nn&&(Rt="native histogram"),{value:Je,type:Rt,description:_t}}function Y(Je,rt){const Rt=oe(Je);return!Je.isLoading&&Je.filteredMetricCount!==Rt.length&&rt(we(Rt.length)),ne(Rt,Je.pageNum,Je.resultsPerPage)}function oe(Je){let rt=Je.metrics;return Je.fuzzySearchQuery&&!Je.useBackend&&(Je.fullMetaSearch?rt=Je.metaHaystackOrder.map(Rt=>Je.metaHaystackDictionary[Rt]):rt=Je.nameHaystackOrder.map(Rt=>Je.nameHaystackDictionary[Rt])),Je.selectedTypes.length>0&&(rt=rt.filter((Rt,_t)=>Je.selectedTypes.some(Kt=>Rt.type&&Kt.value?Rt.type.includes(Kt.value):!Rt.type&&Kt.value==="no type"))),Je.includeNullMetadata||(rt=rt.filter(Rt=>Rt.type!==void 0&&Rt.description!==void 0)),rt}function se(Je){if(!Je.metrics.length)return[];const rt=Je.resultsPerPage===0?1:Je.resultsPerPage,Rt=Math.floor(oe(Je).length/rt)+1;return[...Array(Rt).keys()].map(_t=>_t+1)}function ne(Je,rt,Rt){const _t=Rt===0?1:Rt,nn=rt===1?0:(rt-1)*_t,Kt=nn+_t;return Je.slice(nn,Kt)}const ee=(Je,rt,Rt)=>Je<1?1:Je>Rt?Rt:Je??rt;async function Z(Je,rt,Rt){const _t=(0,R.b4)(Je),nn=rt.map(Qt=>`,${Qt.label}="${Qt.value}"`),Kt=`label_values({__name__=~".*${_t}"${rt?nn.join():""}},__name__)`;return await Rt.metricFindQuery(Kt).then(Qt=>Qt.map(An=>j(An.text,Rt)))}function z(Je,rt,Rt,_t){switch(Je){case"grafana_prom_metric_encycopedia_tracking":(0,_.rR)(Je,{metric:Rt,hasMetadata:rt?.hasMetadata,totalMetricCount:rt?.totalMetricCount,fuzzySearchQuery:rt?.fuzzySearchQuery,fullMetaSearch:rt?.fullMetaSearch,selectedTypes:rt?.selectedTypes,useRegexSearch:rt?.useBackend,includeResultsWithoutMetadata:rt?.includeNullMetadata});case"grafana_prom_metric_encycopedia_disable_text_wrap_interaction":(0,_.rR)(Je,{disableTextWrap:rt?.disableTextWrap});case"grafana_prometheus_metric_encyclopedia_open":(0,_.rR)(Je,{query:_t})}}const q=[{value:"counter",description:"A cumulative metric that represents a single monotonically increasing counter whose value can only increase or be reset to zero on restart."},{value:"gauge",description:"A metric that represents a single numerical value that can arbitrarily go up and down."},{value:"histogram",description:"A histogram samples observations (usually things like request durations or response sizes) and counts them in configurable buckets."},{value:"native histogram",description:"Native histograms are different from classic Prometheus histograms in a number of ways: Native histogram bucket boundaries are calculated by a formula that depends on the scale (resolution) of the native histogram, and are not user defined."},{value:"summary",description:"A summary samples observations (usually things like request durations and response sizes) and can calculate configurable quantiles over a sliding time window."},{value:"unknown",description:"These metrics have been given the type unknown in the metadata."},{value:"no type",description:"These metrics have no defined type in the metadata."}],ie={browse:"Search metrics by name",metadataSearchSwitch:"Include description in search",type:"Filter by type",includeNullMetadata:"Include results with no metadata",setUseBackend:"Enable regex search"};function de(Je){const{state:rt,onChangeFullMetaSearch:Rt,onChangeIncludeNullMetadata:_t,onChangeDisableTextWrap:nn,onChangeUseBackend:Kt}=Je,en=(0,u.$j)(),Qt=ue(en);return r.createElement(r.Fragment,null,r.createElement("div",{className:Qt.selectItem},r.createElement(W.d,{"data-testid":Ue.searchWithMetadata,value:rt.fullMetaSearch,disabled:rt.useBackend||!rt.hasMetadata,onChange:()=>Rt()}),r.createElement("div",{className:Qt.selectItemLabel},ie.metadataSearchSwitch)),r.createElement("div",{className:Qt.selectItem},r.createElement(W.d,{value:rt.includeNullMetadata,disabled:!rt.hasMetadata,onChange:()=>_t()}),r.createElement("div",{className:Qt.selectItemLabel},ie.includeNullMetadata)),r.createElement("div",{className:Qt.selectItem},r.createElement(W.d,{value:rt.disableTextWrap,onChange:()=>nn()}),r.createElement("div",{className:Qt.selectItemLabel},"Disable text wrap")),r.createElement("div",{className:Qt.selectItem},r.createElement(W.d,{"data-testid":Ue.setUseBackend,value:rt.useBackend,onChange:()=>Kt()}),r.createElement("div",{className:Qt.selectItemLabel},ie.setUseBackend,"\xA0"),r.createElement(V.m,{content:"Filter metric names by regex search, using an additional call on the Prometheus API.",placement:"bottom-end"},r.createElement(g.I,{name:"info-circle",size:"xs",className:Qt.settingsIcon}))))}function ue(Je){return{settingsIcon:(0,n.css)({color:Je.colors.text.secondary}),selectItem:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",padding:"4px 0"}),selectItemLabel:(0,n.css)({margin:`0 0 0 ${Je.spacing(1)}`,alignSelf:"center",color:Je.colors.text.secondary,fontSize:"12px"})}}var fe=e(67061);function Se({feedbackUrl:Je}){const rt=(0,u.of)(he);return r.createElement(fe.B,null,r.createElement("a",{href:Je,className:rt.link,title:"The metrics explorer is new, please let us know how we can improve it",target:"_blank",rel:"noreferrer noopener"},r.createElement(g.I,{name:"comment-alt-message"})," Give feedback"))}function he(Je){return{link:(0,n.css)({color:Je.colors.text.secondary,fontSize:Je.typography.bodySmall.fontSize,":hover":{color:Je.colors.text.link},margin:"-25px 0 30px 0"})}}var ce=e(4936);function me(Je){const{metrics:rt,onChange:Rt,onClose:_t,query:nn,state:Kt,disableTextWrap:en}=Je,Qt=(0,u.$j)(),An=pe(Qt,en);function un(Tn){Tn.value&&(Rt({...nn,metric:Tn.value}),z("grafana_prom_metric_encycopedia_tracking",Kt,Tn.value),_t())}function fn(Tn){return Kt.fullMetaSearch&&Tn?r.createElement(r.Fragment,null,r.createElement("td",null,$t(Tn.type??"")),r.createElement("td",null,r.createElement(f(),{textToHighlight:Tn.description??"",searchWords:Kt.metaHaystackMatches,autoEscape:!0,highlightClassName:An.matchHighLight}))):r.createElement(r.Fragment,null,r.createElement("td",null,$t(Tn.type??"")),r.createElement("td",null,Tn.description??""))}function Tt(Tn,vn,Kn){return r.createElement(r.Fragment,null,Tn,r.createElement("span",{className:An.tooltipSpace},r.createElement(V.m,{content:r.createElement(r.Fragment,null,"When creating a ",vn,", Prometheus exposes multiple series with the type counter."," ",(0,ce.jW)(Kn)),placement:"bottom-start",interactive:!0},r.createElement(g.I,{name:"info-circle",size:"xs"}))))}function $t(Tn){return Tn?Tn.includes("(summary)")?Tt(Tn,"summary","https://prometheus.io/docs/concepts/metric_types/#summary"):Tn.includes("(histogram)")?Tt(Tn,"histogram","https://prometheus.io/docs/concepts/metric_types/#histogram"):Tn:""}function Yt(){let Tn;return Kt.fuzzySearchQuery||(Tn="There are no metrics found in the data source."),nn.labels.length>0&&(Tn="There are no metrics found. Try to expand your label filters."),(Kt.fuzzySearchQuery||Kt.selectedTypes.length>0)&&(Tn="There are no metrics found. Try to expand your search and filters."),r.createElement("tr",{className:An.noResults},r.createElement("td",{colSpan:3},Tn))}function Cn(Tn){return Tn.useBackend?[Tn.fuzzySearchQuery]:Tn.fullMetaSearch?Tn.metaHaystackMatches:Tn.nameHaystackMatches}return r.createElement("table",{className:An.table},r.createElement("thead",{className:An.stickyHeader},r.createElement("tr",null,r.createElement("th",{className:`${An.nameWidth} ${An.tableHeaderPadding}`},"Name"),Kt.hasMetadata&&r.createElement(r.Fragment,null,r.createElement("th",{className:`${An.typeWidth} ${An.tableHeaderPadding}`},"Type"),r.createElement("th",{className:`${An.descriptionWidth} ${An.tableHeaderPadding}`},"Description")),r.createElement("th",{className:An.selectButtonWidth}," "))),r.createElement("tbody",null,r.createElement(r.Fragment,null,rt.length>0&&rt.map((Tn,vn)=>r.createElement("tr",{key:Tn?.value??vn,className:An.row},r.createElement("td",{className:An.nameOverflow},r.createElement(f(),{textToHighlight:Tn?.value??"",searchWords:Cn(Kt),autoEscape:!0,highlightClassName:An.matchHighLight})),Kt.hasMetadata&&fn(Tn),r.createElement("td",null,r.createElement(b.$n,{size:"md",variant:"secondary",onClick:()=>un(Tn),className:An.centerButton},"Select")))),rt.length===0&&!Kt.isLoading&&Yt())))}const pe=(Je,rt)=>({table:(0,n.css)({tableLayout:rt?void 0:"fixed",borderRadius:Je.shape.radius.default,width:"100%",whiteSpace:rt?"nowrap":"normal",td:{padding:Je.spacing(1)},"td,th":{minWidth:Je.spacing(3),borderBottom:`1px solid ${Je.colors.border.weak}`}}),row:(0,n.css)({label:"row",borderBottom:`1px solid ${Je.colors.border.weak}`,"&:last-child":{borderBottom:0}}),tableHeaderPadding:(0,n.css)({padding:"8px"}),matchHighLight:(0,n.css)({background:"inherit",color:Je.components.textHighlight.text,backgroundColor:Je.components.textHighlight.background}),nameWidth:(0,n.css)({width:rt?void 0:"37.5%"}),nameOverflow:(0,n.css)({overflowWrap:rt?void 0:"anywhere"}),typeWidth:(0,n.css)({width:rt?void 0:"15%"}),descriptionWidth:(0,n.css)({width:rt?void 0:"35%"}),selectButtonWidth:(0,n.css)({width:rt?void 0:"12.5%"}),stickyHeader:(0,n.css)({position:"sticky",top:0,backgroundColor:Je.colors.background.primary}),noResults:(0,n.css)({textAlign:"center",color:Je.colors.text.secondary}),tooltipSpace:(0,n.css)({marginLeft:"4px"}),centerButton:(0,n.css)({display:"block",margin:"auto",border:"none"})});var ye=e(78036);const Pe=(Je,rt)=>({modal:(0,n.css)({width:"85vw",[Je.breakpoints.down("md")]:{width:"100%"},[Je.breakpoints.up("xl")]:{width:"60%"}}),inputWrapper:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),inputItemFirst:(0,n.css)({flexBasis:"40%",paddingRight:"16px",[Je.breakpoints.down("md")]:{paddingRight:"0px",paddingBottom:"16px"}}),inputItem:(0,n.css)({flexGrow:1,flexBasis:"20%",[Je.breakpoints.down("md")]:{minWidth:"100%"}}),selectWrapper:(0,n.css)({marginBottom:Je.spacing(1)}),resultsAmount:(0,n.css)({color:Je.colors.text.secondary,fontSize:"0.85rem",padding:"0 0 4px 0"}),resultsData:(0,n.css)({margin:`4px 0 ${Je.spacing(2)} 0`}),resultsDataCount:(0,n.css)({margin:0}),resultsDataFiltered:(0,n.css)({color:Je.colors.text.secondary,textAlign:"center",border:"solid 1px rgba(204, 204, 220, 0.25)",padding:"7px"}),resultsDataFilteredText:(0,n.css)({display:"inline",verticalAlign:"text-top"}),results:(0,n.css)({height:"calc(80vh - 310px)",overflowY:"scroll"}),resultsFooter:(0,n.css)({marginTop:"24px",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",position:"sticky"}),currentlySelected:(0,n.css)({color:"grey",opacity:"75%",fontSize:"0.75rem"}),loadingSpinner:(0,n.css)({visibility:"hidden"}),visible:(0,n.css)({visibility:"visible"}),settingsBtn:(0,n.css)({float:"right"}),noBorder:(0,n.css)({border:"none"}),resultsPerPageLabel:(0,n.css)({color:Je.colors.text.secondary,opacity:"75%",paddingTop:"5px",fontSize:"0.85rem",marginRight:"8px"}),resultsPerPageWrapper:(0,n.css)({display:"flex"})});var Ie=e(53076);const Oe=new Ie.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1});function Ne(Je,rt,Rt){const[_t,nn,Kt]=Oe.search(Je,rt,0,1e5);let en=[],Qt=new Set;if(_t&&Kt){const An=(un,fn)=>{fn&&Qt.add(un)};for(let un=0;un<Kt.length;un++){let fn=Kt[un];Ie.A.highlight(Je[nn.idx[fn]],nn.ranges[fn],An),en.push(Je[nn.idx[fn]])}Rt([en,[...Qt]])}else rt||Rt([[],[]])}const We=(0,D.debounce)(Ne,300),Ae=Je=>{const{datasource:rt,isOpen:Rt,onClose:_t,onChange:nn,query:Kt,initialMetrics:en}=Je,[Qt,An]=(0,r.useReducer)(Me.reducer,(0,ye.ue)(Kt)),un=(0,u.$j)(),fn=Pe(un,Qt.disableTextWrap),Tt=(0,r.useCallback)(async()=>{An($e(!0));const Yn=await G(rt,Kt,en);An(ke({isLoading:!1,hasMetadata:Yn.hasMetadata,metrics:Yn.metrics,metaHaystackDictionary:Yn.metaHaystackDictionary,nameHaystackDictionary:Yn.nameHaystackDictionary,totalMetricCount:Yn.metrics.length,filteredMetricCount:Yn.metrics.length}))},[Kt,rt,en]);(0,r.useEffect)(()=>{Tt()},[Tt]);const $t=q.map(Yn=>({value:Yn.value,label:Yn.value,description:Yn.description})),Yt=(0,r.useMemo)(()=>o()(async Yn=>{An($e(!0));const nt=await Z(Yn,Kt.labels,rt);An(Ze({metrics:nt,filteredMetricCount:nt.length,isLoading:!1}))},rt.getDebounceTimeInMilliseconds()),[rt,Kt]);function Cn(Yn){An(ft(Yn))}function Tn(Yn){An(Le(Yn))}function vn(Yn,nt){Qt.useBackend&&Yn===""?Tt():Qt.useBackend?Yt(Yn):nt?We(Object.keys(Qt.metaHaystackDictionary),Yn,Tn):We(Object.keys(Qt.nameHaystackDictionary),Yn,Cn)}const Kn=r.createElement(de,{state:Qt,onChangeFullMetaSearch:()=>{const Yn=!Qt.fullMetaSearch;An(re(Yn)),nn({...Kt,fullMetaSearch:Yn}),vn(Qt.fuzzySearchQuery,Yn)},onChangeIncludeNullMetadata:()=>{An(X(!Qt.includeNullMetadata)),nn({...Kt,includeNullMetadata:!Qt.includeNullMetadata})},onChangeDisableTextWrap:()=>{An(De()),nn({...Kt,disableTextWrap:!Qt.disableTextWrap}),z("grafana_prom_metric_encycopedia_disable_text_wrap_interaction",Qt,"")},onChangeUseBackend:()=>{const Yn=!Qt.useBackend;An(be(Yn)),nn({...Kt,useBackend:Yn}),Yn===!1?Tt():Qt.fuzzySearchQuery!==""&&Yt(Qt.fuzzySearchQuery)}});return r.createElement(N.a,{"data-testid":Ue.metricModal,isOpen:Rt,title:"Metrics explorer",onDismiss:_t,"aria-label":"Browse metrics",className:fn.modal},r.createElement(Se,{feedbackUrl:"https://forms.gle/DEMAJHoAMpe3e54CA"}),r.createElement("div",{className:fn.inputWrapper,"data-testid":l.Tp.components.DataSource.Prometheus.queryEditor.builder.metricsExplorer},r.createElement("div",{className:(0,n.cx)(fn.inputItem,fn.inputItemFirst)},r.createElement(F.p,{autoFocus:!0,"data-testid":Ue.searchMetric,placeholder:ie.browse,value:Qt.fuzzySearchQuery,onInput:Yn=>{const nt=Yn.currentTarget.value??"";An(ct(nt)),vn(nt,Qt.fullMetaSearch)}})),Qt.hasMetadata&&r.createElement("div",{className:fn.inputItem},r.createElement(y.KF,{"data-testid":Ue.selectType,inputId:"my-select",options:$t,value:Qt.selectedTypes,placeholder:ie.type,onChange:Yn=>An(le(Yn))})),r.createElement("div",null,r.createElement(K.y,{className:`${fn.loadingSpinner} ${Qt.isLoading?fn.visible:""}`})),r.createElement("div",{className:fn.inputItem},r.createElement(B.G,{"aria-label":"Additional settings",content:Kn,placement:"bottom-end",closeButton:!1},r.createElement(w.e,{className:fn.settingsBtn},r.createElement(b.$n,{variant:"secondary",size:"md",onClick:()=>An(Te()),"data-testid":Ue.showAdditionalSettings,className:fn.noBorder},"Additional Settings"),r.createElement(b.$n,{className:fn.noBorder,variant:"secondary",icon:Qt.showAdditionalSettings?"angle-up":"angle-down"}))))),r.createElement("div",{className:fn.resultsData},Kt.metric&&r.createElement("i",{className:fn.currentlySelected},"Currently selected: ",Kt.metric),Kt.labels.length>0&&r.createElement("div",{className:fn.resultsDataFiltered},r.createElement(g.I,{name:"info-circle",size:"sm"}),r.createElement("div",{className:fn.resultsDataFilteredText},"\xA0These metrics have been pre-filtered by labels chosen in the label filters."))),r.createElement("div",{className:fn.results},Qt.metrics&&r.createElement(me,{metrics:Y(Qt,An),onChange:nn,onClose:_t,query:Kt,state:Qt,disableTextWrap:Qt.disableTextWrap})),r.createElement("div",{className:fn.resultsFooter},r.createElement("div",{className:fn.resultsAmount},"Showing ",Qt.filteredMetricCount," of ",Qt.totalMetricCount," results"),r.createElement(U.d,{currentPage:Qt.pageNum??1,numberOfPages:se(Qt).length,onNavigate:Yn=>{An(xt(Yn??1))}}),r.createElement("div",{className:fn.resultsPerPageWrapper},r.createElement("p",{className:fn.resultsPerPageLabel},"# Results per page\xA0"),r.createElement(F.p,{"data-testid":Ue.resultsPerPage,value:ee(Qt.resultsPerPage,ye.J3,ye.yH),placeholder:"results per page",width:10,title:"The maximum results per page is "+ye.yH,type:"number",onInput:Yn=>{const nt=+Yn.currentTarget.value;isNaN(nt)||nt>=ye.yH||An(ot(nt))}}))))},Ue={metricModal:"metric-modal",searchMetric:"search-metric",searchWithMetadata:"search-with-metadata",selectType:"select-type",metricCard:"metric-card",useMetric:"use-metric",searchPage:"search-page",resultsPerPage:"results-per-page",setUseBackend:"set-use-backend",showAdditionalSettings:"show-additional-settings"},Me=(0,L.Z0)({name:"metrics-modal-state",initialState:(0,ye.ue)(),reducers:{filterMetricsBackend:(Je,rt)=>{Je.metrics=rt.payload.metrics,Je.filteredMetricCount=rt.payload.filteredMetricCount,Je.isLoading=rt.payload.isLoading},buildMetrics:(Je,rt)=>{Je.isLoading=rt.payload.isLoading,Je.metrics=rt.payload.metrics,Je.hasMetadata=rt.payload.hasMetadata,Je.metaHaystackDictionary=rt.payload.metaHaystackDictionary,Je.nameHaystackDictionary=rt.payload.nameHaystackDictionary,Je.totalMetricCount=rt.payload.totalMetricCount,Je.filteredMetricCount=rt.payload.filteredMetricCount},setIsLoading:(Je,rt)=>{Je.isLoading=rt.payload},setFilteredMetricCount:(Je,rt)=>{Je.filteredMetricCount=rt.payload},setResultsPerPage:(Je,rt)=>{Je.resultsPerPage=rt.payload},setPageNum:(Je,rt)=>{Je.pageNum=rt.payload},setFuzzySearchQuery:(Je,rt)=>{Je.fuzzySearchQuery=rt.payload,Je.pageNum=1},setNameHaystack:(Je,rt)=>{Je.nameHaystackOrder=rt.payload[0],Je.nameHaystackMatches=rt.payload[1]},setMetaHaystack:(Je,rt)=>{Je.metaHaystackOrder=rt.payload[0],Je.metaHaystackMatches=rt.payload[1]},setFullMetaSearch:(Je,rt)=>{Je.fullMetaSearch=rt.payload,Je.pageNum=1},setIncludeNullMetadata:(Je,rt)=>{Je.includeNullMetadata=rt.payload,Je.pageNum=1},setSelectedTypes:(Je,rt)=>{Je.selectedTypes=rt.payload,Je.pageNum=1},setUseBackend:(Je,rt)=>{Je.useBackend=rt.payload,Je.fullMetaSearch=!1,Je.pageNum=1},setDisableTextWrap:Je=>{Je.disableTextWrap=!Je.disableTextWrap},showAdditionalSettings:Je=>{Je.showAdditionalSettings=!Je.showAdditionalSettings}}}),{setIsLoading:$e,buildMetrics:ke,filterMetricsBackend:Ze,setResultsPerPage:ot,setPageNum:xt,setFuzzySearchQuery:ct,setNameHaystack:ft,setMetaHaystack:Le,setFullMetaSearch:re,setIncludeNullMetadata:X,setSelectedTypes:le,setUseBackend:be,setDisableTextWrap:De,showAdditionalSettings:Te,setFilteredMetricCount:we}=Me.actions,Ke=" ",Ve=1e3;function ht({datasource:Je,query:rt,onChange:Rt,onGetMetrics:_t,labelsFilters:nn,metricLookupDisabled:Kt,onBlur:en,variableEditor:Qt}){const An=(0,u.of)(gt),[un,fn]=(0,r.useState)({}),Tt=h.$.featureToggles.prometheusMetricEncyclopedia,$t=[{value:"BrowseMetrics",label:"Metrics explorer",description:"Browse and filter all metrics and metadata with a fuzzy search"}],Yt=(0,r.useCallback)((je,tt)=>{const Dt=je.label??je.value;return Dt?Dt.toLowerCase?tt.split(Ke).reduce((Lt,Gt)=>{const hn=Dt.toLowerCase().includes(Gt.toLowerCase());let mt=!1;return Tt&&(mt=Dt==="Metrics explorer"),Lt&&(hn||mt)},!0):!0:!1},[Tt]),Cn=(0,r.useCallback)((je,tt)=>je.__isNew__?je.label:r.createElement(f(),{searchWords:tt.inputValue.split(Ke),textToHighlight:je.label??"",highlightClassName:An.highlight}),[An.highlight]),Tn=(je,tt)=>{const Dt=(0,R.b4)(je);return bt(Dt,tt)},vn=je=>Je.metricFindQuery(Tn(je,nn)).then(Dt=>{const Ot=Dt.length;(0,O.ky)(Dt),Ot>Dt.length?fn({...un,resultsTruncated:!0}):fn({...un,resultsTruncated:!1});const Lt=Dt.map(Gt=>({label:Gt.text,value:Gt.text}));return Tt?[...$t,...Lt]:Lt}),Kn=()=>Promise.resolve([]),Yn=o()(je=>vn(je),Je.getDebounceTimeInMilliseconds()),nt=je=>{const tt=je.data;if(tt.value==="BrowseMetrics"){const Dt=je.isFocused?An.focus:"";return r.createElement("div",{...je.innerProps,ref:je.innerRef,className:`${An.customOptionWidth} metric-encyclopedia-open`,"data-testid":l.Tp.components.Select.option,onKeyDown:Ot=>{Ot.code==="Enter"&&fn({...un,metricsModalOpen:!0})}},r.createElement("div",{className:`${An.customOption} ${Dt} metric-encyclopedia-open`},r.createElement("div",null,r.createElement("div",{className:"metric-encyclopedia-open"},tt.label),r.createElement("div",{className:`${An.customOptionDesc} metric-encyclopedia-open`},tt.description)),r.createElement(b.$n,{fill:"text",size:"sm",variant:"secondary",onClick:()=>fn({...un,metricsModalOpen:!0}),className:"metric-encyclopedia-open"},"Open",r.createElement(g.I,{name:"arrow-right"}))))}return C(je)},yt=({children:je,maxHeight:tt,innerRef:Dt,innerProps:Ot})=>{const Lt=(0,u.$j)(),Gt=(0,P.J)(Lt),hn=!r.isValidElement(je)&&un.resultsTruncated;return r.createElement("div",{...Ot,className:`${Gt.menu} ${An.customMenuContainer}`,style:{maxHeight:Math.round(tt*.9)},"aria-label":"Select options menu"},r.createElement(c.E,{scrollRefCallback:Dt,autoHide:!1,autoHeightMax:"inherit",hideHorizontalTrack:!0,showScrollIndicators:!0},je),hn&&r.createElement("div",{className:An.customMenuFooter},r.createElement("div",null,"Only the top 1000 metrics are displayed in the metric select. Use the metrics explorer to view all metrics.")))},Vt=()=>r.createElement(y.DW,{"data-testid":l.Tp.components.DataSource.Prometheus.queryEditor.builder.metricSelect,isClearable:!!Qt,inputId:"prometheus-metric-select",className:An.select,value:rt.metric?(0,d.z)(rt.metric):void 0,placeholder:"Select metric",allowCustomValue:!0,formatOptionLabel:Cn,filterOption:Yt,minMenuHeight:250,onOpenMenu:async()=>{if(Kt)return;fn({isLoading:!0});const je=await _t(),tt=je.map(Ot=>Ot.value),Dt=je.length;je.length>Ve&&(0,O.ky)(je),fn(Tt?{metrics:[...$t,...je],isLoading:void 0,initialMetrics:tt,resultsTruncated:Dt>je.length}:{metrics:je,isLoading:void 0,resultsTruncated:Dt>je.length})},loadOptions:Kt?Kn:Yn,isLoading:un.isLoading,defaultOptions:un.metrics??Array.from(new Array(25),()=>({value:""})),onChange:je=>{const tt=je?.value;tt?Tt&&tt==="BrowseMetrics"?(z("grafana_prometheus_metric_encyclopedia_open",null,"",rt),fn({...un,metricsModalOpen:!0})):Rt({...rt,metric:tt}):Rt({...rt,metric:""})},components:Tt?{Option:nt,MenuList:yt}:{MenuList:yt},onBlur:en});return r.createElement(r.Fragment,null,Tt&&!Je.lookupsDisabled&&un.metricsModalOpen&&r.createElement(Ae,{datasource:Je,isOpen:un.metricsModalOpen,onClose:()=>fn({...un,metricsModalOpen:!1}),query:rt,onChange:Rt,initialMetrics:un.initialMetrics??[]}),Qt?r.createElement(p.C,null,r.createElement(v.I,{label:"Metric",labelWidth:20,tooltip:r.createElement("div",null,"Optional: returns a list of label values for the label name in the specified metric.")},Vt())):r.createElement(m.B,null,r.createElement(s.c,{label:"Metric"},Vt())))}const gt=Je=>({select:(0,n.css)({minWidth:"125px"}),highlight:(0,n.css)({label:"select__match-highlight",background:"inherit",padding:"inherit",color:Je.colors.warning.contrastText,backgroundColor:Je.colors.warning.main}),customOption:(0,n.css)({padding:"8px",display:"flex",justifyContent:"space-between",cursor:"pointer",":hover":{backgroundColor:Je.colors.emphasize(Je.colors.background.primary,.1)}}),customOptionlabel:(0,n.css)({color:Je.colors.text.primary}),customOptionDesc:(0,n.css)({color:Je.colors.text.secondary,fontSize:Je.typography.size.xs,opacity:"50%"}),focus:(0,n.css)({backgroundColor:Je.colors.emphasize(Je.colors.background.primary,.1)}),customOptionWidth:(0,n.css)({minWidth:"400px"}),customMenuFooter:(0,n.css)({flex:0,display:"flex",justifyContent:"space-between",padding:Je.spacing(1.5),borderTop:`1px solid ${Je.colors.border.weak}`,color:Je.colors.text.secondary}),customMenuContainer:(0,n.css)({display:"flex",flexDirection:"column",background:Je.colors.background.primary,boxShadow:Je.shadows.z3})}),bt=(Je,rt)=>{const Rt=rt?St(rt):[];return`label_values({__name__=~".*${Je}"${Rt?Rt.join(""):""}},__name__)`},St=Je=>Je.map(rt=>`,${rt.label}="${rt.value}"`)},29993:(Q,I,e)=>{"use strict";e.d(I,{I:()=>A});var n=e(96540),a=e(50556),o=e(81996),r=e(32370),i=e(26115),f=e(32196),d=e(2543),l=e(85269),m=e(97801),s=e(81580),h=e(39268),u=e(76892),b=e(76459),g=e.n(b),P=e(50877),c=e(13544),y=e(81392),p=e(3721),v=e(21594);function D({item:C,defaultOp:O,onChange:R,onDelete:L,onGetLabelNames:N,onGetLabelValues:F,invalidLabel:K,invalidValue:B,getLabelValuesAutofillSuggestions:w,debounceDuration:U}){const[W,V]=(0,n.useState)({}),[_,H]=(0,n.useState)(!1),[G,j]=(0,n.useState)(!1),Y=(ee=C.op)=>E.find(Z=>Z.label===ee)?.isMultiValue,oe=ee=>{if(ee){const Z=/\(([^)]+)\)/,z=ee?.match(Z);return z&&z[0].indexOf("|")>0?[ee]:ee.indexOf("|")>0?ee.split("|"):[ee]}return[]},se=g()(ee=>w(ee,C.label),U),ne=C?.value??"";return n.createElement("div",{key:ne,"data-testid":"prometheus-dimensions-filter-item"},n.createElement(y.M,null,n.createElement(v.l6,{placeholder:"Select label","data-testid":c.Tp.components.QueryBuilder.labelSelect,inputId:"prometheus-dimensions-filter-item-key",width:"auto",value:C.label?(0,P.z)(C.label):null,allowCustomValue:!0,onOpenMenu:async()=>{V({isLoadingLabelNames:!0});const ee=await N(C);H(!0),V({labelNames:ee,isLoadingLabelNames:void 0})},onCloseMenu:()=>{H(!1)},isOpen:_,isLoading:W.isLoadingLabelNames??!1,options:W.labelNames,onChange:ee=>{ee.label&&R({...C,op:C.op??O,label:ee.label})},invalid:K}),n.createElement(v.l6,{"data-testid":c.Tp.components.QueryBuilder.matchOperatorSelect,className:"query-segment-operator",value:(0,P.z)(C.op??O),options:E,width:"auto",onChange:ee=>{ee.value!=null&&R({...C,op:ee.value,value:Y(ee.value)?C.value:oe(C?.value)[0]})}}),n.createElement(v.DW,{placeholder:"Select value","data-testid":c.Tp.components.QueryBuilder.valueSelect,inputId:"prometheus-dimensions-filter-item-value",width:"auto",value:Y()?oe(ne).map(P.z):oe(ne).map(P.z)[0],allowCustomValue:!0,formatCreateLabel:ee=>ee,createOptionPosition:C.op?.includes("~")?"first":"last",onOpenMenu:async()=>{V({isLoadingLabelValues:!0});const ee=await F(C);(0,o.ky)(ee),j(!0),V({...W,labelValues:ee,isLoadingLabelValues:void 0})},onCloseMenu:()=>{j(!1)},isOpen:G,defaultOptions:W.labelValues,isMulti:Y(),isLoading:W.isLoadingLabelValues,loadOptions:se,onChange:ee=>{if(ee.value)R({...C,value:ee.value,op:C.op??O});else{const Z=ee.map(z=>z.label).join("|");R({...C,value:Z,op:C.op??O})}},invalid:B}),n.createElement(p.Z,{"aria-label":`remove-${C.label}`,icon:"times",variant:"secondary",onClick:L})))}const E=[{label:"=",value:"=",isMultiValue:!1},{label:"!=",value:"!=",isMultiValue:!1},{label:"=~",value:"=~",isMultiValue:!0},{label:"!~",value:"!~",isMultiValue:!0}],S="Select at least 1 label filter (label and value)";function T({labelsFilters:C,onChange:O,onGetLabelNames:R,onGetLabelValues:L,labelFilterRequired:N,getLabelValuesAutofillSuggestions:F,debounceDuration:K,variableEditor:B}){const w="=",[U,W]=(0,n.useState)([{op:w}]);(0,n.useEffect)(()=>{C.length>0?W(C):W([{op:w}])},[C]);const V=G=>{W(G);const j=G.filter(Y=>Y.label!=null&&Y.value!=null);(0,d.isEqual)(j,C)||O(j)},_=U.some(G=>G.label&&G.value),H=()=>n.createElement(l.o,{items:U,onChange:V,renderItem:(G,j,Y)=>n.createElement(D,{debounceDuration:K,item:G,defaultOp:w,onChange:j,onDelete:Y,onGetLabelNames:R,onGetLabelValues:L,invalidLabel:N&&!G.label,invalidValue:N&&!G.value,getLabelValuesAutofillSuggestions:F})});return n.createElement(n.Fragment,null,B?n.createElement(h.C,null,n.createElement("div",{className:(0,f.cx)((0,f.css)({display:"flex"}))},n.createElement(u.c,{width:20,tooltip:n.createElement("div",null,"Optional: used to filter the metric select for this query type.")},"Label filters"),H())):n.createElement(m.B,null,n.createElement(s.c,{label:"Label filters",error:S,invalid:N&&!_},H())))}var M=e(95899);function A({datasource:C,query:O,onChange:R,onBlur:L,variableEditor:N}){const F=H=>{R({...O,labels:H})},K=(0,n.useCallback)(async H=>{const G=C.getVariables(),j=await H;return[...G.map(Y=>({label:Y,value:Y})),...j.map(Y=>({label:Y.value,value:Y.value,title:Y.description}))]},[C]),B=async H=>{if(!O.metric)return await C.languageProvider.fetchLabels(),C.languageProvider.getLabelKeys().map(oe=>({value:oe}));const G=O.labels.filter(oe=>oe!==H);G.push({label:"__name__",op:"=",value:O.metric});const j=r.z.renderLabels(G);let Y=await C.languageProvider.fetchLabelsWithMatch(j);return Object.keys(Y).filter(oe=>!G.find(se=>se.label===oe)).map(oe=>({value:oe}))},w=(H,G)=>{const j={label:G??"__name__",op:"=~",value:(0,i.b4)(`.*${H}`)},Y=O.labels.filter(ee=>ee.label!==j.label);Y.push(j),O.metric&&Y.push({label:"__name__",op:"=",value:O.metric});const oe=Y.map(ee=>({...ee,label:C.interpolateString(ee.label),value:C.interpolateString(ee.value)})),se=r.z.renderLabels(oe);let ne;return C.hasLabelsMatchAPISupport()?ne=W(j,se):ne=U(j,se),ne.then(ee=>((0,o.ky)(ee),ee))},U=(H,G)=>{if(!H.label)return Promise.resolve([]);const j=C.languageProvider.fetchSeries(G),Y=C.interpolateString(H.label);return j.then(oe=>{const se=new Set;return oe.forEach(ne=>{const ee=ne[Y];se.add(ee)}),Array.from(se).map(ne=>({label:ne,value:ne}))})},W=(H,G)=>{if(!H.label)return Promise.resolve([]);const j=`[${C.uid}][${O.metric}][${H.label}][${H.op}]`;return C.languageProvider.fetchSeriesValuesWithMatch(H.label,G,j).then(Y=>Y.map(oe=>({value:oe,label:oe})))},V=async H=>{if(!H.label)return[];if(!O.metric)return(await C.languageProvider.getLabelValues(H.label)).map(oe=>({value:oe}));const G=O.labels.filter(oe=>oe!==H);G.push({label:"__name__",op:"=",value:O.metric});const j=G.map(oe=>({...oe,label:C.interpolateString(oe.label),value:C.interpolateString(oe.value)})),Y=r.z.renderLabels(j);return C.hasLabelsMatchAPISupport()?W(H,Y):U(H,Y)},_=(0,n.useCallback)(()=>K(x(C,O)),[C,O,K]);return n.createElement(n.Fragment,null,n.createElement(M.dm,{query:O,onChange:R,onGetMetrics:_,datasource:C,labelsFilters:O.labels,metricLookupDisabled:C.lookupsDisabled,onBlur:L||(()=>{}),variableEditor:N}),n.createElement(T,{debounceDuration:C.getDebounceTimeInMilliseconds(),getLabelValuesAutofillSuggestions:w,labelsFilters:O.labels,onChange:F,onGetLabelNames:H=>K(B(H)),onGetLabelValues:H=>K(V(H)),variableEditor:N}))}async function x(C,O){C.languageProvider.metricsMetadata||await C.languageProvider.loadMetricsMetadata(),C.languageProvider.metricsMetadata||(C.languageProvider.metricsMetadata={});let R;if(O.labels.length>0){const L=r.z.renderLabels(O.labels);R=(await C.languageProvider.getSeries(L,!0)).__name__??[]}else R=await C.languageProvider.getLabelValues("__name__")??[];return R.map(L=>({value:L,description:(0,a.xB)(L,C.languageProvider.metricsMetadata)}))}},26432:(Q,I,e)=>{"use strict";e.d(I,{W:()=>m,i:()=>s});var n=e(96540),a=e(67061),o=e(20719),r=e(32370),i=e(76040),f=e(27994),d=e(96625),l=e(3884);const m="Fetch all series matching metric name and label filters.",s=n.memo(({query:h})=>{const u=(0,i.u)(h||"").query,b={grammar:o.Ay,name:"promql"};return n.createElement(a.B,{gap:.5,direction:"column"},n.createElement(f.r,{stepNumber:1,title:n.createElement(l.Z,{query:`${u.metric} ${r.z.renderLabels(u.labels)}`,lang:b})},m),n.createElement(d.k,{stepNumber:2,queryModeller:r.z,query:u,lang:b}))});s.displayName="PromQueryBuilderExplained"},80109:(Q,I,e)=>{"use strict";e.d(I,{$:()=>d});var n=e(32196),a=e(96540),o=e(13544),r=e(40845),i=e(57225),f=e(26432);function d(m){const{query:s,datasource:h,range:u,onRunQuery:b,onChange:g,data:P,app:c,showExplain:y}=m,p=(0,r.of)(l);return a.createElement("div",{"data-testid":o.Tp.components.DataSource.Prometheus.queryEditor.code.queryField,className:p.wrapper},a.createElement(i.L,{datasource:h,query:s,range:u,onRunQuery:b,onChange:g,history:[],data:P,app:c}),y&&a.createElement(f.i,{query:s.expr}))}const l=m=>({wrapper:(0,n.css)({".gf-form":{marginBottom:0}})})},78036:(Q,I,e)=>{"use strict";e.d(I,{J3:()=>n,mt:()=>r,ue:()=>o,yH:()=>a});const n=100,a=1e3;function o(i){return{isLoading:!0,metrics:[],hasMetadata:!0,metaHaystackDictionary:{},metaHaystackMatches:[],metaHaystackOrder:[],nameHaystackDictionary:{},nameHaystackOrder:[],nameHaystackMatches:[],totalMetricCount:0,filteredMetricCount:null,resultsPerPage:n,pageNum:1,fuzzySearchQuery:"",fullMetaSearch:i?.fullMetaSearch??!1,includeNullMetadata:i?.includeNullMetadata??!0,selectedTypes:[],useBackend:i?.useBackend??!1,disableTextWrap:i?.disableTextWrap??!1,showAdditionalSettings:!1}}function r(i){return{useBackend:i?.useBackend??!1,disableTextWrap:i?.disableTextWrap??!1,fullMetaSearch:i?.fullMetaSearch??!1,includeNullMetadata:i.includeNullMetadata??!1}}},1220:(Q,I,e)=>{"use strict";e.d(I,{DQ:()=>g,G3:()=>y,Kl:()=>h,OS:()=>P,iZ:()=>b,jC:()=>p,jY:()=>d,kf:()=>l,nU:()=>s,z2:()=>c});var n=e(2543),a=e.n(n),o=e(55127),r=e.n(o),i=e(38961),f=e(15145);function d(x,C,O){const R=u(x,C,O),L=x.id+"(";return O&&R.push(O),L+R.join(", ")+")"}function l(x,C,O){const R=u(x,C,O),L=x.id+"(";return O&&R.unshift(O),L+R.join(", ")+")"}function m(x,C,O,R){if(C.params.length<2)throw`Cannot render a function with params of length [${C.params.length}]`;let L=(x.params??[])[0]??"5m";const N=u({...x,params:x.params.slice(1)},{...C,params:C.params.slice(1),defaultParams:C.defaultParams.slice(1)},O),F=x.id+"(";return O&&(R?N.push(`${O}[${L}]`):N.unshift(`${O}[${L}]`)),F+N.join(", ")+")"}function s(x,C,O){return m(x,C,O,!1)}function h(x,C,O){return m(x,C,O,!0)}function u(x,C,O){return(x.params??[]).map((R,L)=>C.params[L].type==="string"?'"'+R+'"':R)}function b(x,C){const O={id:x.id,params:x.defaultParams};return{...C,operations:[...C.operations,O]}}function g(x){return(0,n.capitalize)(x.replace(/_/g," "))}function P(x,C){return`operations.${x}.param.${C}`}function c(x=!1){const C=[{label:"$__interval",value:"$__interval"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"1h",value:"1h"},{label:"24h",value:"24h"}];return x&&C.unshift({label:"$__rate_interval",value:"$__rate_interval"}),{name:"Range",type:"string",options:C}}function y(x,C={}){return[{id:x,name:g(x),params:[{name:"By label",type:"string",restParam:!0,optional:!0}],defaultParams:[],alternativesKey:"plain aggregations",category:f.Ag.Aggregations,renderer:d,paramChangedHandler:M(`__${x}_by`),explainHandler:E(x,""),addOperationHandler:b,...C},{id:`__${x}_by`,name:`${g(x)} by`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:i.r}],defaultParams:[""],alternativesKey:"aggregations by",category:f.Ag.Aggregations,renderer:v(x),paramChangedHandler:T(x),explainHandler:E(x,"by"),addOperationHandler:b,hideFromList:!0,...C},{id:`__${x}_without`,name:`${g(x)} without`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:i.r}],defaultParams:[""],alternativesKey:"aggregations by",category:f.Ag.Aggregations,renderer:D(x),paramChangedHandler:T(x),explainHandler:E(x,"without"),addOperationHandler:b,hideFromList:!0,...C}]}function p(x,C,O={}){const R=y(x,O);return R[0].params.unshift(...C.params),R[1].params.unshift(...C.params),R[2].params.unshift(...C.params),R[0].defaultParams=C.defaultParams,R[1].defaultParams=[...C.defaultParams,""],R[2].defaultParams=[...C.defaultParams,""],R[1].renderer=S(x),R[2].renderer=S(x),R}function v(x){return function(O,R,L){return`${x} by(${O.params.join(", ")}) (${L})`}}function D(x){return function(O,R,L){return`${x} without(${O.params.join(", ")}) (${L})`}}function E(x,C){return function(R){const L=R.params.map(F=>`\`${F}\``).join(" and "),N=r()("label",R.params.length);switch(C){case"by":return`Calculates ${x} over dimensions while preserving ${N} ${L}.`;case"without":return`Calculates ${x} over the dimensions ${L}. All other labels are preserved.`;default:return`Calculates ${x} over the dimensions.`}}}function S(x){return function(O,R,L){const N=R.params.findIndex(B=>B.restParam),F=O.params.slice(0,N),K=O.params.slice(N);return`${x} by(${K.join(", ")}) (${F.map((B,w)=>R.params[w].type==="string"?`"${B}"`:B).join(", ")}, ${L})`}}function T(x){return function(O,R,L){return R.params.length<L.params.length?{...R,id:x}:R}}function M(x){return function(O,R,L){return R.params.length===L.params.length?{...R,id:x}:R}}function A(x,C){if(!x.label||!x.op||!x.value||C.length<2)return!1;const O=x.op.toString().startsWith("!");return C.filter(N=>N.label===x.label&&N.value===x.value&&N.op!==x.op).some(N=>!!(O&&N?.op?.toString().startsWith("!")===!1||O===!1&&N?.op?.toString().startsWith("!")))}},76040:(Q,I,e)=>{"use strict";e.d(I,{u:()=>r});var n=e(84555),a=e(75161),o=e(26115);function r(c){const y=(0,o.qk)(c),v=n.K3.parse(y).topNode,E={query:{metric:"",labels:[],operations:[]},errors:[]};try{f(y,v,E)}catch(S){console.error(S),S instanceof Error&&E.errors.push({text:S.message})}return P(E.query)&&(E.errors=[]),i(c)&&(E.errors=[]),E}function i(c){const y={query:{metric:"",labels:[],operations:[]},errors:[]};c=c.replace(/\$__interval/g,"1s"),c=c.replace(/\$__interval_ms/g,"1000"),c=c.replace(/\$__rate_interval/g,"1s"),c=c.replace(/\$__range_ms/g,"1000"),c=c.replace(/\$__range_s/g,"1"),c=c.replace(/\$__range/g,"1s");const v=n.K3.parse(c).topNode;try{f(c,v,y)}catch{return!1}return y.errors.length===0}function f(c,y,p){const v=p.query;switch(y.type.id){case n.gw:{v.metric=(0,o.AA)(c,y);break}case n.BG:{v.labels.push(l(c,y));const D=y.getChild(o.Ql);D&&p.errors.push((0,o.xz)(c,D));break}case n.R6:{s(c,y,p);break}case n.Fn:{h(c,y,p);break}case n.df:{b(c,y,p);break}case o.Ql:{if(d(y))break;p.errors.push((0,o.xz)(c,y));break}default:{y.type.id===n.ek&&p.errors.push((0,o.xz)(c,y));let D=y.firstChild;for(;D;)f(c,D,p),D=D.nextSibling}}}function d(c){return c.prevSibling?.firstChild?.type.id===n.Fb}function l(c,y){const p=(0,o.AA)(c,y.getChild(n.IC)),v=(0,o.AA)(c,y.getChild(n.Lf)),D=(0,o.AA)(c,y.getChild(n.LW)).replace(/"/g,"");return{label:p,op:v,value:D}}const m=["changes","rate","irate","increase","delta"];function s(c,y,p){const v=p.query,D=y.getChild(n.m3),E=(0,o.AA)(c,D),S=y.getChild(n.Dh),T=[];let M="";if(m.includes(E)||E.endsWith("_over_time")){let x=(0,o.AA)(c,y).match(/\[(.+)\]/);x?.[1]&&(M=x[1],T.push(x[1]))}const A={id:E,params:T};if(v.operations.unshift(A),S){if((0,o.AA)(c,S)==="(["+M+"])")return;u(c,S,p,A)}}function h(c,y,p){const v=p.query,D=y.getChild(n.xb);let E=(0,o.AA)(c,D);const S=y.getChild(n.hI),T=[];S&&(S.getChild("By")&&E&&(E=`__${E}_by`),S.getChild(n.xB)&&(E=`__${E}_without`),T.push(...(0,o.R1)(c,S,n.IC)));const M=y.getChild(n.Dh),A={id:E,params:[]};v.operations.unshift(A),u(c,M,p,A),A.params.push(...T)}function u(c,y,p,v){if(y)switch(y.type.id){case n.Dh:{let D=y.firstChild;for(;D;){let E;D.type.id===n.df?E=D:E=D.getChild(n.df),E&&p.errors.push({text:"Query parsing is ambiguous.",from:E.from,to:E.to}),u(c,D,p,v),D=D.nextSibling}break}case n.Po:{v.params.push(parseFloat((0,o.AA)(c,y)));break}case n.LW:{v.params.push((0,o.AA)(c,y).replace(/"/g,""));break}default:f(c,y,p)}}function b(c,y,p){const v=p.query,D=y.firstChild,E=(0,o.AA)(c,D.nextSibling),S=g(c,y.getChild(n.eM)??y.getChild(n.Ue)),T=y.lastChild,M=a.AE[E],A=D.type.id===n.Po,x=T.type.id===n.Po,C=T.type.id===n.df;if(A||f(c,D,p),x)v.operations.push((0,o.rq)(M,c,T,!!S?.isBool));else if(C){const O=(0,o.z9)(T);O?.type.id===n.Po&&v.operations.push((0,o.rq)(M,c,O,!!S?.isBool)),f(c,T,p)}else{v.binaryQueries=v.binaryQueries||[];const O={operator:E,query:{metric:"",labels:[],operations:[]}};S?.isMatcher&&(O.vectorMatchesType=S.matchType,O.vectorMatches=S.matches),v.binaryQueries.push(O),f(c,T,{query:O.query,errors:p.errors})}}function g(c,y){if(y){if(y.getChild("Bool"))return{isBool:!0,isMatcher:!1};{let p="";const v=y.getChild(n.x$);return v&&(p=(0,o.R1)(c,v,n.IC).join(", ")),{isMatcher:!0,isBool:!1,matches:p,matchType:y.getChild(n.On)?"on":"ignoring"}}}}function P(c){return c.labels.length===0&&c.operations.length===0&&!c.metric}},26115:(Q,I,e)=>{"use strict";e.d(I,{AA:()=>l,Ql:()=>n,R1:()=>s,b4:()=>h,qk:()=>i,rq:()=>m,xz:()=>o,z9:()=>a});const n=0;function a(u){return u.firstChild?a(u.firstChild):u}function o(u,b){return{text:l(u,b),from:b.from,to:b.to,parentType:b.parent?.name}}const r=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function i(u){return u.replace(r,(b,g,P,c,y,p,v)=>{const D=c||v;let E=g,S="0";return P&&(E=P,S="1"),y&&(E=y,S="2"),`__V_${S}__`+E+"__V__"+(D?"__F__"+D+"__F__":"")})}const f=[(u,b)=>`$${u}`,(u,b)=>`[[${u}${b?`:${b}`:""}]]`,(u,b)=>`\${${u}${b?`:${b}`:""}}`];function d(u){return u.replace(/__V_(\d)__(.+?)__V__(?:__F__(\w+)__F__)?/g,(b,g,P,c)=>f[parseInt(g,10)](P,c))}function l(u,b){return b?d(u.substring(b.from,b.to)):""}function m(u,b,g,P){const c=[parseFloat(l(b,g))];return u.comparison&&c.push(P),{id:u.id,params:c}}function s(u,b,g){if(b.type.id===g)return[l(u,b)];const P=[];let c=0,y=b.childAfter(c);for(;y;)P.push(...s(u,y,g)),c=y.to,y=b.childAfter(c);return P}const h=u=>u.split(" ").map(g=>`${g}.*`).join("")},27994:(Q,I,e)=>{"use strict";e.d(I,{r:()=>i});var n=e(32196),a=e(96540),o=e(36663),r=e(40845);function i({title:d,stepNumber:l,markdown:m,children:s}){const h=(0,r.of)(f);return a.createElement("div",{className:h.box},l!==void 0&&a.createElement("div",{className:h.stepNumber},l),a.createElement("div",{className:h.boxInner},d&&a.createElement("div",{className:h.header},a.createElement("span",null,d)),a.createElement("div",{className:h.body},m&&a.createElement("div",{dangerouslySetInnerHTML:{__html:(0,o.G)(m)}}),s)))}const f=d=>({box:(0,n.css)({background:d.colors.background.secondary,padding:d.spacing(1),borderRadius:d.shape.radius.default,position:"relative"}),boxInner:(0,n.css)({marginLeft:d.spacing(4)}),stepNumber:(0,n.css)({fontWeight:d.typography.fontWeightMedium,background:d.colors.secondary.main,width:"20px",height:"20px",borderRadius:d.shape.radius.circle,display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"10px",left:"11px",fontSize:d.typography.bodySmall.fontSize}),header:(0,n.css)({paddingBottom:d.spacing(.5),display:"flex",alignItems:"center",fontFamily:d.typography.fontFamilyMonospace}),body:(0,n.css)({color:d.colors.text.secondary,"p:last-child":{margin:0},a:{color:d.colors.text.link,textDecoration:"underline"}})})},96625:(Q,I,e)=>{"use strict";e.d(I,{k:()=>r});var n=e(96540),a=e(27994),o=e(3884);function r({query:i,queryModeller:f,stepNumber:d,lang:l,onMouseEnter:m,onMouseLeave:s}){return n.createElement(n.Fragment,null,i.operations.map((h,u)=>{const b=f.getOperationDef(h.id);if(!b)return`Operation ${h.id} not found`;const g=b.renderer(h,b,"<expr>"),P=b.explainHandler?b.explainHandler(h,b):b.documentation??"no docs";return n.createElement("div",{key:u,onMouseEnter:()=>m?.(h,u),onMouseLeave:()=>s?.(h,u)},n.createElement(a.r,{stepNumber:u+d,title:n.createElement(o.Z,{query:g,lang:l}),markdown:P}))}))}},3884:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>f});var n=e(32196),a=e(28848),o=e.n(a),r=e(96540),i=e(40845);function f({query:l,lang:m,className:s}){const h=(0,i.$j)(),u=d(h),b=o().highlight(l,m.grammar,m.name);return r.createElement("div",{className:(0,n.cx)(u.editorField,"prism-syntax-highlight",s),"aria-label":"selector",dangerouslySetInnerHTML:{__html:b}})}const d=l=>({editorField:(0,n.css)({fontFamily:l.typography.fontFamilyMonospace,fontSize:l.typography.bodySmall.fontSize})})},15145:(Q,I,e)=>{"use strict";e.d(I,{Ag:()=>n,jN:()=>a,n5:()=>o});var n=(r=>(r.Aggregations="Aggregations",r.RangeFunctions="Range functions",r.Functions="Functions",r.BinaryOps="Binary operations",r.Trigonometric="Trigonometric",r.Time="Time Functions",r))(n||{}),a=(r=>(r.Abs="abs",r.Absent="absent",r.AbsentOverTime="absent_over_time",r.Acos="acos",r.Acosh="acosh",r.Asin="asin",r.Asinh="asinh",r.Atan="atan",r.Atanh="atanh",r.Avg="avg",r.AvgOverTime="avg_over_time",r.BottomK="bottomk",r.Ceil="ceil",r.Changes="changes",r.Clamp="clamp",r.ClampMax="clamp_max",r.ClampMin="clamp_min",r.Cos="cos",r.Cosh="cosh",r.Count="count",r.CountOverTime="count_over_time",r.CountScalar="count_scalar",r.CountValues="count_values",r.DayOfMonth="day_of_month",r.DayOfWeek="day_of_week",r.DayOfYear="day_of_year",r.DaysInMonth="days_in_month",r.Deg="deg",r.Delta="delta",r.Deriv="deriv",r.DropCommonLabels="drop_common_labels",r.Exp="exp",r.Floor="floor",r.Group="group",r.HistogramQuantile="histogram_quantile",r.HistogramAvg="histogram_avg",r.HistogramCount="histogram_count",r.HistogramSum="histogram_sum",r.HistogramFraction="histogram_fraction",r.HistogramStddev="histogram_stddev",r.HistogramStdvar="histogram_stdvar",r.HoltWinters="holt_winters",r.Hour="hour",r.Idelta="idelta",r.Increase="increase",r.Irate="irate",r.LabelJoin="label_join",r.LabelReplace="label_replace",r.Last="last",r.LastOverTime="last_over_time",r.Ln="ln",r.Log10="log10",r.Log2="log2",r.Max="max",r.MaxOverTime="max_over_time",r.Min="min",r.MinOverTime="min_over_time",r.Minute="minute",r.Month="month",r.Pi="pi",r.PredictLinear="predict_linear",r.Present="present",r.PresentOverTime="present_over_time",r.Quantile="quantile",r.QuantileOverTime="quantile_over_time",r.Rad="rad",r.Rate="rate",r.Resets="resets",r.Round="round",r.Scalar="scalar",r.Sgn="sgn",r.Sin="sin",r.Sinh="sinh",r.Sort="sort",r.SortDesc="sort_desc",r.Sqrt="sqrt",r.Stddev="stddev",r.StddevOverTime="stddev_over_time",r.Sum="sum",r.SumOverTime="sum_over_time",r.Tan="tan",r.Tanh="tanh",r.Time="time",r.Timestamp="timestamp",r.TopK="topk",r.Vector="vector",r.Year="year",r.Addition="__addition",r.Subtraction="__subtraction",r.MultiplyBy="__multiply_by",r.DivideBy="__divide_by",r.Modulo="__modulo",r.Exponent="__exponent",r.NestedQuery="__nested_query",r.EqualTo="__equal_to",r.NotEqualTo="__not_equal_to",r.GreaterThan="__greater_than",r.LessThan="__less_than",r.GreaterOrEqual="__greater_or_equal",r.LessOrEqual="__less_or_equal",r))(a||{}),o=(r=>(r.Rate="rate",r.Histogram="histogram",r.Binary="binary",r))(o||{})},20716:(Q,I,e)=>{"use strict";e.d(I,{$i:()=>u,Dr:()=>s});var n=e(70416),a=e(47232),o=e(77678),r=e(32631),i=e(32264),f=e(14110),d=e(9631);function l(b,g){let[P]=b,[c]=g,y=P.length,p=P[0],v=P[y-1],D=c.length,E=c[0],S=c[D-1],T;if(y)if(D){if(E>v)T=b.map((M,A)=>b[A].concat(g[A]));else if(S<p)T=g.map((M,A)=>g[A].concat(b[A]));else if(E<=p&&S>=v)T=g;else if(!(E>p&&S<v)){if(E>=p){let M=(0,d.Ls)(E,P);M=P[M]<E?M-1:M,T=b.map((A,x)=>b[x].slice(0,M).concat(g[x]))}else if(S>=p){let M=(0,d.Ls)(S,P);M=P[M]<S?M:M+1,T=g.map((A,x)=>g[x].concat(b[x].slice(M)))}}}else T=b;else D?T=g:T=[[]];return T}function m(b,g,P){let[c,...y]=b,p,v;return c[0]<g&&(p=(0,d.Ls)(g,c),c[p]<g&&p++),c[c.length-1]>P&&(v=(0,d.Ls)(P,c),c[v]>P&&v--),(p!=null||v!=null)&&(c=c.slice(p??0,v),y=y.map(D=>D.slice(p??0,v))),[c,...y]}const s="10m",h=b=>`${b.type}|${b.name}|${JSON.stringify(b.labels??"")}`;class u{constructor(g){this.sendEventsInterval=6e4*10,this.pendingRequestIdsToTargSigs=new Map,this.pendingAccumulatedEvents=new Map,this.cache=new Map,this.sendPendingTrackingEvents=()=>{const c=this.pendingAccumulatedEvents.entries();for(let[y,p]of c)if(!p.sent){const v={datasource:p.datasource.toString(),requestCount:p.requestCount.toString(),savedBytesTotal:p.savedBytesTotal.toString(),initialRequestSize:p.initialRequestSize.toString(),lastRequestSize:p.lastRequestSize.toString(),panelId:p.panelId.toString(),dashId:p.dashId.toString(),expr:p.expr.toString(),refreshIntervalMs:p.refreshIntervalMs.toString(),from:p.from.toString(),queryRangeSeconds:p.queryRangeSeconds.toString()};i.$.featureToggles.prometheusIncrementalQueryInstrumentation?(0,f.rR)("grafana_incremental_queries_profile",v):r.P.api.pushEvent&&r.P.api.pushEvent("incremental query response size",v,"no-interaction",{skipDedupe:!0}),this.pendingAccumulatedEvents.set(y,{...p,sent:!0,requestCount:0,savedBytesTotal:0,initialRequestSize:0,lastRequestSize:0})}};const P=g.overlapString;if((0,n.di)(P)){const c=(0,n.E9)(P);this.overlapWindowMs=(0,n.WT)(c)}else{const c=(0,n.E9)(s);this.overlapWindowMs=(0,n.WT)(c)}(i.$.grafanaJavascriptAgent.enabled||i.$.featureToggles?.prometheusIncrementalQueryInstrumentation)&&g.profileFunction!==void 0?(this.profile(),this.shouldProfile=!0):this.shouldProfile=!1,this.getProfileData=g.profileFunction,this.getTargetSignature=g.getTargetSignature}profile(){typeof PerformanceObserver=="function"&&(this.perfObeserver=new PerformanceObserver(g=>{g.getEntries().forEach(P=>{const c=P,y=typeof c?.transferSize=="number";if(c?.initiatorType==="fetch"&&y){let p=c.name;if(p.includes("/api/ds/query")){let v=p.match(/requestId=([a-z\d]+)/i);if(v){let D=v[1];const E=Math.round(c.transferSize),S=this.pendingRequestIdsToTargSigs.get(D);if(S){const T=this.pendingRequestIdsToTargSigs.entries();for(let[,M]of T)if(M.identity===S.identity&&M.bytes!==null){const A=this.pendingAccumulatedEvents.get(M.identity),x=M.bytes-E;this.pendingAccumulatedEvents.set(M.identity,{datasource:M.datasource??"N/A",requestCount:(A?.requestCount??0)+1,savedBytesTotal:(A?.savedBytesTotal??0)+x,initialRequestSize:M.bytes,lastRequestSize:E,panelId:S.panelId?.toString()??"",dashId:S.dashboardUID??"",expr:S.expr??"",refreshIntervalMs:S.refreshIntervalMs??0,sent:!1,from:S.from??"",queryRangeSeconds:S.queryRangeSeconds??0}),this.pendingRequestIdsToTargSigs.delete(D);return}this.pendingRequestIdsToTargSigs.set(D,{...S,bytes:E})}}}}})}),this.perfObeserver.observe({type:"resource",buffered:!1}),setInterval(this.sendPendingTrackingEvents,this.sendEventsInterval),window.addEventListener("beforeunload",this.sendPendingTrackingEvents))}requestInfo(g){const P=g.range.from.valueOf(),c=g.range.to.valueOf(),y=g.rangeRaw?.to?.toString()==="now";let p=y,v;const D=g.intervalMs,E=new Map;g.targets.forEach(S=>{let T=`${g.dashboardUID}|${g.panelId}|${S.refId}`,M=this.getTargetSignature(g,S);this.shouldProfile&&this.getProfileData&&this.pendingRequestIdsToTargSigs.set(g.requestId,{...this.getProfileData(g,S),identity:T+"|"+M,bytes:null,panelId:g.panelId,dashboardUID:g.dashboardUID??"",from:g.rangeRaw?.from.toString()??"",queryRangeSeconds:g.range.to.diff(g.range.from,"seconds")??"",refreshIntervalMs:D??0}),E.set(T,M)});for(const[S,T]of E){let M=this.cache.get(S);if(M?.sig!==T?p=!1:(v=M?.prevTo??1/0,p=c>v&&P<=v),!p)break}if(p&&v){let S=Math.max(v-this.overlapWindowMs,P);const T=(0,a.KQ)(c),M=(0,a.KQ)((0,o.rs)(S,g.intervalMs));g={...g,range:{...g.range,from:M,to:T}}}else E.forEach((S,T)=>{this.cache.delete(T)});return{requests:[g],targSigs:E,shouldCache:y}}procFrames(g,P,c){if(P?.shouldCache){const y=g.range.from.valueOf(),p=g.range.to.valueOf(),v=new Map;c.forEach(E=>{let S=`${g.dashboardUID}|${g.panelId}|${E.refId}`,T=v.get(S);T||(T=[],v.set(S,T)),T.push(E)});let D=[];v.forEach((E,S)=>{let T=(S?this.cache.get(S)?.frames:null)??[];E.forEach(A=>{if(A.length===0||A.fields.length===0)return;let x=h(A.fields[1]),C=T.find(O=>h(O.fields[1])===x);if(!C)T.push(A);else{let O=C.fields.map(N=>N.values),R=A.fields.map(N=>N.values),L=l(O,R);if(L){for(let N=0;N<L.length;N++)C.fields[N].values=L[N];C.length=C.fields[0].values.length}}});let M=[];T.forEach(A=>{let x=A.fields.map(O=>O.values),C=m(x,y,p);if(C[0].length>0){for(let O=0;O<C.length;O++)A.fields[O].values=C[O];M.push(A)}}),this.cache.set(S,{sig:P.targSigs.get(S),frames:M,prevTo:p}),D.push(...M)}),c=D.map(E=>({...E,fields:E.fields.map(S=>({...S,config:{...S.config},values:S.values.slice()}))}))}return c}}},59809:(Q,I,e)=>{"use strict";e.d(I,{Bm:()=>A,J3:()=>g,L:()=>x,hF:()=>S});var n=e(2543),a=e.n(n),o=e(41987),r=e(41260),i=e(11261),f=e(28240),d=e(52622),l=e(57875),m=e(32264),s=e(19347);const h=/^[+-]?inf(?:inity)?$/i,u=(C,O)=>O.app===o.Jk.Explore&&(C.meta?.custom?.resultType==="vector"||C.meta?.custom?.resultType==="scalar")?!0:O.targets.find(L=>L.refId===C.refId)?.format==="table",b=(C,O)=>C.meta?.type===r.m.HeatmapCells?!1:O.targets.find(L=>L.refId===C.refId)?.format==="heatmap";function g(C,O,R){m.$.featureToggles.prometheusDataplane&&C.data.forEach(Y=>{const oe=O.targets.find(se=>se.refId===Y.refId);oe&&oe.legendFormat==="__auto"&&Y.fields.forEach(se=>{if(se.labels?.__name__&&se.labels?.__name__===se.name){const ne={...se,name:i.Bc};se.config.displayNameFromDS=(0,f.Ct)(ne,Y,C.data)}})});const[L,N]=(0,n.partition)(C.data,Y=>u(Y,O)),F=c(L),[K,B]=(0,n.partition)(N,Y=>Y.meta?.custom?.resultType==="exemplar"),{exemplarTraceIdDestinations:w}=R,U=K.map(Y=>{if(w?.length)for(const oe of w){const se=Y.fields.find(ne=>ne.name===oe.name);if(se){const ne=p(oe);se.config.links=se.config.links?.length?[...se.config.links,...ne]:ne}}return{...Y,meta:{...Y.meta,dataTopic:d.QR.Annotations}}}),[W,V]=(0,n.partition)(B,Y=>b(Y,O));W.forEach(Y=>{if(Y.name==null){let oe=Y.fields.find(se=>se.type===i.PU.number);if(oe){let se=oe.labels?.le;se&&(Y.name=se,oe.config.displayNameFromDS=se)}}});const _=(0,n.groupBy)(W,Y=>Y.refId);let H=[];for(const Y in _){const oe=_[Y],se=(0,n.groupBy)(oe,ne=>{const ee=ne.fields.find(Z=>Z.type===i.PU.number);if(ee?.labels&&P in ee.labels){const{le:Z,...z}=ee?.labels;return Object.values(z).join()}return Object.values(ee?.labels??[]).join()});(0,n.forOwn)(se,(ne,ee)=>{const Z=ne.sort(A);H.push(T(M(Z)))})}const G=V.map(Y=>({...Y,meta:{...Y.meta,preferredVisualisationType:"graph"}})),j=(0,n.flatten)(H);return{...C,data:[...G,...F,...j,...U]}}const P="le";function c(C){if(C.length===0||C.length===1&&C[0].length===0)return C;const O=(0,n.groupBy)(C,"refId"),R=Object.keys(O);return R.map(N=>{const F=y(R.length,N),K=E({data:[],valueName:F}),B=D([]),w=[];O[N].forEach(W=>{const _=W.fields[1]?.labels??{};Object.keys(_).sort().forEach(H=>{if(!w.some(G=>G.name===H)){const G=H===P;w.push({name:H,config:{filterable:!0},type:G?i.PU.number:i.PU.string,values:[]})}})}),O[N].forEach(W=>{const V=W.fields[0]?.values??[],_=W.fields[1]?.values??[];V.forEach(H=>B.values.push(H)),_.forEach(H=>{K.values.push(x(H));const G=W.fields[1].labels??{};w.forEach(j=>j.values.push(v(G,j.name)))})});const U=[B,...w,K];return{refId:N,fields:U,meta:{...O[N][0].meta,preferredVisualisationType:"rawPrometheus"},length:B.values.length}})}function y(C,O=""){return C>1?`Value #${O}`:"Value"}function p(C){const O=[];if(C.datasourceUid){const L=(0,s.l)().getInstanceSettings(C.datasourceUid);L&&O.push({title:C.urlDisplayLabel||`Query with ${L?.name}`,url:"",internal:{query:{query:"${__value.raw}",queryType:"traceql"},datasourceUid:C.datasourceUid,datasourceName:L?.name??"Data source not found"}})}return C.url&&O.push({title:C.urlDisplayLabel||`Go to ${C.url}`,url:C.url,targetBlank:!0}),O}function v(C,O){return C.hasOwnProperty(O)?O===P?x(C[O]):C[O]:""}function D(C,O=!1){return{name:i.LE,type:i.PU.time,config:{},values:C.map(R=>O?R[0]:R[0]*1e3)}}function E({data:C,valueName:O=i.Bc,parseValue:R=!0,labels:L,displayNameFromDS:N}){return{name:O,type:i.PU.number,display:(0,l.J)(),config:{displayNameFromDS:N},labels:L,values:C.map(F=>R?x(F[1]):F[1])}}function S(C){const O=C.__name__||"";delete C.__name__;const R=Object.entries(C).map(L=>`${L[0]}="${L[1]}"`).join(",");return`${O}{${R}}`}function T(C){if(C.length===0||C.length===1&&C[0].length===0)return[];const O=C[0].fields.find(L=>L.type===i.PU.time),R=C.map(L=>{let N=L.fields.find(F=>F.type===i.PU.number);return{...N,name:N.config.displayNameFromDS}});return[{...C[0],meta:{...C[0].meta,type:r.m.HeatmapRows},fields:[O,...R]}]}function M(C){for(let O=C.length-1;O>0;O--){const R=C[O].fields.find(N=>N.type===i.PU.number),L=C[O-1].fields.find(N=>N.type===i.PU.number);if(!R||!L)throw new Error("Prometheus heatmap transform error: data should be a time series");for(let N=0;N<R.values.length;N++){const F=L.values[N]||[0];R.values[N]-=F,R.values[N]<1e-9&&(R.values[N]=0)}}return C}function A(C,O){let R,L;try{R=x(C.fields[1].state?.displayName??C.name??C.fields[1].name),L=x(O.fields[1].state?.displayName??O.name??O.fields[1].name)}catch(N){return console.error(N),0}return R>L?1:R<L?-1:0}function x(C){return h.test(C)?C[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:parseFloat(C)}},62183:(Q,I,e)=>{"use strict";e.d(I,{B4:()=>r,N1:()=>a,fD:()=>n,m_:()=>o});var n=(i=>(i.Low="Low",i.Medium="Medium",i.High="High",i.None="None",i))(n||{}),a=(i=>(i.Cortex="Cortex",i.Mimir="Mimir",i.Prometheus="Prometheus",i.Thanos="Thanos",i))(a||{}),o=(i=>(i.Auto="__auto",i.Verbose="__verbose",i.Custom="__custom",i))(o||{}),r=(i=>(i[i.LabelNames=0]="LabelNames",i[i.LabelValues=1]="LabelValues",i[i.MetricNames=2]="MetricNames",i[i.VarQueryResult=3]="VarQueryResult",i[i.SeriesQuery=4]="SeriesQuery",i[i.ClassicQuery=5]="ClassicQuery",i))(r||{})},27642:(Q,I,e)=>{"use strict";e.d(I,{L:()=>a,y:()=>o});var n=e(32264);function a(r){return{grafana_version:n.$.buildInfo.version,plugin_type:String(r.type),plugin_version:r.info.version,plugin_id:r.id,plugin_name:r.name}}function o(r){return{...a(r.meta),datasource_uid:r.uid}}},44027:(Q,I,e)=>{"use strict";e.d(I,{G:()=>d});var n=e(96540),a=e(92470),o=e(95187),r=e(14110),i=e(27642);const f="grafana_plugin_";function d(){const m=(0,a.Q)();return(0,n.useMemo)(()=>{const s=(0,o.S)(m)?(0,i.y)(m.instanceSettings):(0,i.L)(m.meta);return(h,u)=>{if(!l(h))throw new Error(`Interactions reported in plugins should start with: "${f}".`);return(0,r.rR)(h,{...u,...s})}},[m])}function l(m){return m.startsWith(f)&&m.length>f.length}},61298:(Q,I,e)=>{"use strict";e.d(I,{fX:()=>o,nB:()=>a,n_:()=>n,p6:()=>r});var n=(i=>(i.DashboardView="dashboard-view",i.DataRequest="data-request",i))(n||{});const a=i=>!!i.payload.page,o=i=>!!i.payload.interactionName,r=i=>!!i.payload.experimentId},14110:(Q,I,e)=>{"use strict";e.d(I,{G$:()=>r,Jy:()=>i,Xp:()=>d,rR:()=>f});var n=e(32264),a=e(12131),o=e(63415);const r=l=>{(0,o.x$)().addEvent({type:o.on.MetaAnalytics,payload:l})},i=()=>{const l=a.Ny.getLocation(),m=`${n.$.appSubUrl??""}${l.pathname}${l.search}${l.hash}`;(0,o.x$)().addEvent({type:o.on.Pageview,payload:{page:m}})},f=(l,m)=>{(0,o.x$)().addEvent({type:o.on.Interaction,payload:{interactionName:l,properties:m}})},d=(l,m,s)=>{(0,o.x$)().addEvent({type:o.on.ExperimentView,payload:{experimentId:l,experimentGroup:m,experimentVariant:s}})}},55882:(Q,I,e)=>{"use strict";e.d(I,{s:()=>s});var n=e(96540),a=e(22391),o=e(51527),r=e(13544),i=e(21594),f=e(67061),d=e(98624),l=e(19347),m=e(26657);class s extends n.PureComponent{constructor(u){super(u),this.dataSourceSrv=(0,l.l)(),this.state={},this.onChange=(b,g)=>{if(g.action==="clear"&&this.props.onClear){this.props.onClear();return}const P=this.dataSourceSrv.getInstanceSettings(b.value);P&&(this.props.onChange(P),this.setState({error:void 0}))}}static{this.defaultProps={autoFocus:!1,openMenuOnFocus:!1,placeholder:"Select data source"}}componentDidMount(){const{current:u}=this.props;this.dataSourceSrv.getInstanceSettings(u)||this.setState({error:"Could not find data source "+u})}getCurrentValue(){const{current:u,hideTextValue:b,noDefault:g}=this.props;if(!u&&g)return;const P=this.dataSourceSrv.getInstanceSettings(u);if(P)return{label:P.name.slice(0,37),value:P.uid,imgUrl:P.meta.info.logos.small,hideText:b,meta:P.meta};const c=(0,a.Iz)(u);return c===m.dR.uid||c===m.dR.name?{label:c,value:c,hideText:b}:{label:(c??"no name")+" - not found",value:c??void 0,imgUrl:"",hideText:b}}getDataSourceOptions(){const{alerting:u,tracing:b,metrics:g,mixed:P,dashboard:c,variables:y,annotations:p,pluginId:v,type:D,filter:E,logs:S}=this.props;return this.dataSourceSrv.getList({alerting:u,tracing:b,metrics:g,logs:S,dashboard:c,mixed:P,variables:y,annotations:p,pluginId:v,filter:E,type:D}).map(M=>({value:M.name,label:`${M.name}${M.isDefault?" (default)":""}`,imgUrl:M.meta.info.logos.small,meta:M.meta}))}render(){const{autoFocus:u,onBlur:b,onClear:g,openMenuOnFocus:P,placeholder:c,width:y,inputId:p,disabled:v=!1,isLoading:D=!1}=this.props,{error:E}=this.state,S=this.getDataSourceOptions(),T=this.getCurrentValue(),M=typeof g=="function";return n.createElement("div",{"aria-label":"Data source picker select container","data-testid":r.Tp.components.DataSourcePicker.container},n.createElement(i.l6,{isLoading:D,disabled:v,"aria-label":"Select a data source","data-testid":r.Tp.components.DataSourcePicker.inputV2,inputId:p||"data-source-picker",className:"ds-picker select-container",isMulti:!1,isClearable:M,backspaceRemovesValue:!1,onChange:this.onChange,options:S,autoFocus:u,onBlur:b,width:y,openMenuOnFocus:P,maxMenuHeight:500,placeholder:c,noOptionsMessage:"No datasources found",value:T??null,invalid:!!E||!!this.props.invalid,getOptionLabel:A=>A.meta&&(0,o.x)(A.meta.signature)&&A!==T?n.createElement(f.B,{alignItems:"center",justifyContent:"space-between"},n.createElement("span",null,A.label)," ",n.createElement(d.B,{status:A.meta.signature})):A.label||""}))}}},96937:(Q,I,e)=>{"use strict";e.d(I,{f:()=>n,p:()=>a});let n=()=>{throw new Error("EmbeddedDashboard requires runtime initialization")};function a(o){n=o}},97152:(Q,I,e)=>{"use strict";e.d(I,{a:()=>a,e:()=>o});var n=e(96540);let a=({message:r})=>n.createElement("div",null,"Unable to render data: ",r,".");function o(r){a=r}},24308:(Q,I,e)=>{"use strict";e.d(I,{Y:()=>o,m:()=>a});var n=e(96540);let a=()=>n.createElement("div",null,"PanelRenderer can only be used after Grafana instance has been started.");function o(r){a=r}},46235:(Q,I,e)=>{"use strict";e.d(I,{V:()=>a,l:()=>o});var n=e(96540);let a=({children:r})=>n.createElement("div",null,r);function o(r){a=r}},32264:(Q,I,e)=>{"use strict";e.d(I,{$:()=>s,p:()=>i});var n=e(2543),a=e.n(n),o=e(42994),r=e(97594);class i{constructor(u){this.publicDashboardsEnabled=!0,this.snapshotEnabled=!0,this.datasources={},this.panels={},this.apps={},this.auth={},this.minRefreshInterval="",this.appUrl="",this.appSubUrl="",this.namespace="default",this.windowTitlePrefix="",this.newPanelTitle="",this.externalUserMngLinkUrl="",this.externalUserMngLinkName="",this.externalUserMngInfo="",this.allowOrgCreate=!1,this.feedbackLinksEnabled=!0,this.disableLoginForm=!1,this.defaultDatasource="",this.angularSupportEnabled=!1,this.authProxyEnabled=!1,this.exploreEnabled=!1,this.queryHistoryEnabled=!1,this.helpEnabled=!1,this.profileEnabled=!1,this.newsFeedEnabled=!0,this.ldapEnabled=!1,this.jwtHeaderName="",this.jwtUrlLogin=!1,this.sigV4AuthEnabled=!1,this.azureAuthEnabled=!1,this.secureSocksDSProxyEnabled=!1,this.samlEnabled=!1,this.samlName="",this.autoAssignOrg=!0,this.verifyEmailEnabled=!1,this.oauth={},this.rbacEnabled=!0,this.disableUserSignUp=!1,this.loginHint="",this.passwordHint="",this.loginError=void 0,this.viewersCanEdit=!1,this.editorsCanAdmin=!1,this.disableSanitizeHtml=!1,this.trustedTypesDefaultPolicyEnabled=!1,this.cspReportOnlyEnabled=!1,this.liveEnabled=!0,this.featureToggles={},this.anonymousEnabled=!1,this.anonymousDeviceLimit=void 0,this.licenseInfo={},this.rendererAvailable=!1,this.rendererVersion="",this.rendererDefaultImageWidth=1e3,this.rendererDefaultImageHeight=500,this.rendererDefaultImageScale=1,this.secretsManagerPluginEnabled=!1,this.supportBundlesEnabled=!1,this.http2Enabled=!1,this.grafanaJavascriptAgent={enabled:!1,customEndpoint:"",apiKey:"",errorInstrumentalizationEnabled:!0,consoleInstrumentalizationEnabled:!1,webVitalsInstrumentalizationEnabled:!1},this.pluginCatalogURL="https://grafana.com/grafana/plugins/",this.pluginAdminEnabled=!0,this.pluginAdminExternalManageEnabled=!1,this.pluginCatalogHiddenPlugins=[],this.pluginsCDNBaseURL="",this.expressionsEnabled=!1,this.awsAllowedAuthProviders=[],this.awsAssumeRoleEnabled=!1,this.azure={managedIdentityEnabled:!1,workloadIdentityEnabled:!1,userIdentityEnabled:!1,userIdentityFallbackCredentialsEnabled:!1},this.caching={enabled:!1},this.unifiedAlertingEnabled=!1,this.unifiedAlerting={minInterval:"",alertStateHistoryBackend:void 0,alertStateHistoryPrimary:void 0},this.recordedQueries={enabled:!0},this.featureHighlights={enabled:!1},this.reporting={enabled:!0},this.analytics={enabled:!0},this.googleAnalytics4SendManualPageViews=!1,this.sqlConnectionLimits={maxOpenConns:100,maxIdleConns:100,connMaxLifetime:14400},this.disableFrontendSandboxForPlugins=[],this.bootData=u.bootData;const b={datasources:{},windowTitlePrefix:"Grafana - ",panels:{},newPanelTitle:"Panel Title",playlist_timespan:"1m",unsaved_changes_warning:!0,appUrl:"",appSubUrl:"",buildInfo:{version:"1.0",commit:"1",env:"production"},viewersCanEdit:!1,editorsCanAdmin:!1,disableSanitizeHtml:!1};(0,n.merge)(this,b,u),this.buildInfo=u.buildInfo||b.buildInfo,this.dateFormats&&o.WC.update(this.dateFormats),d(this),f(this),this.featureToggles.disableAngular&&(this.angularSupportEnabled=!1),this.theme2=(0,r.g)(this.bootData.user.theme),this.bootData.user.lightTheme=this.theme2.isLight,this.theme=this.theme2.v1}}function f(h){const u=h.featureToggles,g=window.localStorage.getItem("grafana.featureToggles");if(g){const P=g.split(",");for(const c of P){const[y,p]=c.split("="),v=p==="true"||p==="1";u[y]=v,console.log(`Setting feature toggle ${y} = ${v} via localstorage`)}}}function d(h){if(window.location.href.indexOf("__feature")===-1)return;const u=h.buildInfo.env==="development",b=new Set(["queryServiceFromUI"]);new URLSearchParams(window.location.search).forEach((P,c)=>{if(c.startsWith("__feature.")){const y=h.featureToggles,p=c.substring(10),v=P==="true"||P==="";v!==y[c]&&(u||b.has(p)?(y[p]=v,console.log(`Setting feature toggle ${p} = ${v} via url`)):console.log(`Unable to change feature toggle ${p} via url in production.`))}})}const l=window.grafanaBootData||{settings:{},user:{},navTree:[]},m=l.settings;m.bootData=l;const s=new i(m)},13303:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{CopyPanelEvent:()=>s.ah,DataSourcePicker:()=>O.s,DataSourceWithBackend:()=>E.iy,EchoEventType:()=>i.on,EmbeddedDashboard:()=>F.f,FakeEchoSrv:()=>i.c_,GrafanaBootConfig:()=>P.p,HealthCheckError:()=>E.b1,HealthStatus:()=>E.VQ,HistoryWrapper:()=>m.K9,MetaAnalyticsEventName:()=>c.n_,PanelDataErrorView:()=>M.a,PanelRenderer:()=>T.m,PluginPage:()=>C.V,RefreshEvent:()=>s._,StreamingFrameAction:()=>l.Kh,ThemeChangedEvent:()=>s.E8,TimeRangeUpdatedEvent:()=>s.sR,config:()=>P.$,createDataSourcePluginEventProperties:()=>R.y,createMonitoringLogger:()=>D.DW,createPluginEventProperties:()=>R.L,createQueryRunner:()=>x.d,featureEnabled:()=>v.a,frameToMetricFindValue:()=>S.$h,getAngularLoader:()=>a.E,getAppEvents:()=>s.J7,getBackendSrv:()=>n.AI,getDataSourceSrv:()=>o.l,getEchoSrv:()=>i.x$,getGrafanaLiveSrv:()=>l.oF,getLegacyAngularInjector:()=>d.C,getLocationSrv:()=>r.X,getPluginComponentExtensions:()=>h.Dp,getPluginExtensions:()=>h.O3,getPluginImportUtils:()=>y.o,getPluginLinkExtensions:()=>h.Kf,getRunRequest:()=>x.XJ,getTemplateSrv:()=>f.w,isExperimentViewEvent:()=>c.p6,isExpressionReference:()=>E.s9,isFetchError:()=>n.NF,isInteractionEvent:()=>c.fX,isPageviewEvent:()=>c.nB,isPluginExtensionComponent:()=>g.a,isPluginExtensionLink:()=>g.D,loadPluginCss:()=>y.PL,locationSearchToObject:()=>m.SE,locationService:()=>m.Ny,logDebug:()=>D.MD,logError:()=>D.vV,logInfo:()=>D.fH,logWarning:()=>D.FF,navigationLogger:()=>m.Lc,registerEchoBackend:()=>i.pl,reportExperimentView:()=>p.Xp,reportInteraction:()=>p.rR,reportMetaAnalytics:()=>p.G$,reportPageview:()=>p.Jy,setAngularLoader:()=>a.w,setAppEvents:()=>s.H8,setBackendSrv:()=>n.u5,setDataSourceSrv:()=>o.h,setEchoSrv:()=>i.H2,setEmbeddedDashboard:()=>F.p,setGrafanaLiveSrv:()=>l.S8,setLegacyAngularInjector:()=>d.j,setLocationService:()=>m.vG,setLocationSrv:()=>r.T,setPluginComponentHook:()=>b.A,setPluginExtensionGetter:()=>h.cE,setPluginExtensionsHook:()=>u.Vu,setPluginImportUtils:()=>y.se,setQueryRunnerFactory:()=>x.HC,setReturnToPreviousHook:()=>N._,setRunRequest:()=>x.pC,setTemplateSrv:()=>f.d,toDataQueryError:()=>A.u,toDataQueryResponse:()=>S.bE,usePluginComponent:()=>b.S,usePluginComponentExtensions:()=>u.kr,usePluginComponents:()=>u.f_,usePluginExtensions:()=>u.pc,usePluginInteractionReporter:()=>L.G,usePluginLinkExtensions:()=>u.vl,usePluginLinks:()=>u.Ux,useReturnToPrevious:()=>N.i});var n=e(17172),a=e(7376),o=e(19347),r=e(23509),i=e(63415),f=e(72574),d=e(81634),l=e(78731),m=e(12131),s=e(3591),h=e(4402),u=e(3197),b=e(79396),g=e(80882),P=e(32264),c=e(61298),y=e(89191),p=e(14110),v=e(33378),D=e(34867),E=e(26657),S=e(47773),T=e(24308),M=e(97152),A=e(12091),x=e(63639),C=e(46235),O=e(55882),R=e(27642),L=e(44027),N=e(14778),F=e(96937)},7376:(Q,I,e)=>{"use strict";e.d(I,{E:()=>o,w:()=>a});let n;function a(r){n=r}function o(){return n}},63415:(Q,I,e)=>{"use strict";e.d(I,{H2:()=>o,c_:()=>f,on:()=>n,pl:()=>i,x$:()=>r});var n=(d=>(d.Performance="performance",d.MetaAnalytics="meta-analytics",d.Pageview="pageview",d.Interaction="interaction",d.ExperimentView="experimentview",d.GrafanaJavascriptAgent="grafana-javascript-agent",d))(n||{});let a;function o(d){if(a instanceof f)for(const l of a.buffer)d.addEvent(l.event,l.meta);a=d}function r(){return a||(a=new f),a}const i=d=>{r().addBackend(d)};class f{constructor(){this.buffer=[]}flush(){this.buffer=[]}addBackend(l){}addEvent(l,m){this.buffer.push({event:l,meta:m})}}},12131:(Q,I,e)=>{"use strict";e.d(I,{K9:()=>d,Lc:()=>u,Ny:()=>m,SE:()=>l,vG:()=>s});var n=e(17929),a=e(76885),o=e(95344),r=e(91040),i=e(40621),f=e(32264);class d{constructor(g){this.history=g||n.zR({basename:f.$.appSubUrl??"/"}),this.partial=this.partial.bind(this),this.push=this.push.bind(this),this.replace=this.replace.bind(this),this.getSearch=this.getSearch.bind(this),this.getHistory=this.getHistory.bind(this),this.getLocation=this.getLocation.bind(this)}getHistory(){return this.history}getSearch(){return new URLSearchParams(this.history.location.search)}partial(g,P){const c=this.history.location,y=this.getSearchObject();for(const v in g)g[v]===null||g[v]===void 0?delete y[v]:y[v]=g[v];const p=a.kM.renderUrl(c.pathname,y);P?this.history.replace(p,this.history.location.state):this.history.push(p,this.history.location.state)}push(g){this.history.push(g)}replace(g){this.history.replace(g)}reload(){const g=this.history.location.state?.routeReloadCounter;this.history.replace({...this.history.location,state:{routeReloadCounter:g?g+1:1}})}getLocation(){return this.history.location}getSearchObject(){return l(this.history.location.search)}update(g){if((0,o.l)("LocationSrv","update","partial, push or replace"),g.partial&&g.query)this.partial(g.query,g.partial);else{const P={pathname:g.path};g.query&&(P.search=a.kM.toUrlParams(g.query)),g.replace?this.replace(P):this.push(P)}}}function l(b){let g=typeof b=="number"?String(b):b;return g.length>0?g.startsWith("?")?a.kM.parseKeyValue(g.substring(1)):a.kM.parseKeyValue(g):{}}let m=new d;const s=b=>{throw new Error("locationService can be only overriden in test environment")},h=(0,r.h)("Router"),u=h.logger;(0,i.h)("location",m,h)},23509:(Q,I,e)=>{"use strict";e.d(I,{T:()=>a,X:()=>o});let n;function a(r){n=r}function o(){return n}},63639:(Q,I,e)=>{"use strict";e.d(I,{HC:()=>a,XJ:()=>f,d:()=>o,pC:()=>i});let n;const a=d=>{if(n)throw new Error("Runner should only be set when Grafana is starting.");n=d},o=()=>{if(!n)throw new Error("`createQueryRunner` can only be used after Grafana instance has started.");return n()};let r;function i(d){if(r)throw new Error("runRequest function should only be set once, when Grafana is starting.");r=d}function f(){if(!r)throw new Error("getRunRequest can only be used after Grafana instance has started.");return r}},3591:(Q,I,e)=>{"use strict";e.d(I,{E8:()=>o,H8:()=>d,J7:()=>l,_:()=>a,ah:()=>i,sR:()=>r});var n=e(65463);class a extends n.a{static{this.type="refresh"}}class o extends n.x{static{this.type="theme-changed"}}class r extends n.x{static{this.type="time-range-updated"}}class i extends n.x{static{this.type="copy-panel"}}let f;function d(m){f=m}function l(){return f}},17172:(Q,I,e)=>{"use strict";e.d(I,{AI:()=>r,NF:()=>n,u5:()=>o});function n(i){return typeof i=="object"&&i!==null&&"status"in i&&"data"in i}let a;const o=i=>{a=i},r=()=>a},19347:(Q,I,e)=>{"use strict";e.d(I,{h:()=>a,l:()=>o});let n;function a(r){n=r}function o(){return n}},81634:(Q,I,e)=>{"use strict";e.d(I,{C:()=>o,j:()=>a});let n;const a=r=>{n=r},o=()=>n},78731:(Q,I,e)=>{"use strict";e.d(I,{Kh:()=>n.Kh,S8:()=>o,oF:()=>r});var n=e(9631);let a;const o=i=>{a=i},r=()=>a},4402:(Q,I,e)=>{"use strict";e.d(I,{Dp:()=>d,Kf:()=>f,O3:()=>i,cE:()=>o});var n=e(80882);let a;function o(l){if(a)throw new Error("setPluginExtensionGetter() function should only be called once, when Grafana is starting.");a=l}function r(){if(!a)throw new Error("getPluginExtensionGetter() can only be used after the Grafana instance has started.");return a}const i=l=>r()(l),f=l=>{const{extensions:m}=i(l);return{extensions:m.filter(n.D)}},d=l=>{const{extensions:m}=i(l);return{extensions:m.filter(n.a)}}},79396:(Q,I,e)=>{"use strict";e.d(I,{A:()=>a,S:()=>o});let n;function a(r){if(n)throw new Error("setPluginComponentHook() function should only be called once, when Grafana is starting.");n=r}function o(r){if(!n)throw new Error("setPluginComponentHook(options) can only be used after the Grafana instance has started.");return n(r)}},3197:(Q,I,e)=>{"use strict";e.d(I,{Ux:()=>f,Vu:()=>r,f_:()=>d,kr:()=>m,pc:()=>i,vl:()=>l});var n=e(96540),a=e(80882);let o;function r(s){if(o)throw new Error("setPluginExtensionsHook() function should only be called once, when Grafana is starting.");o=s}function i(s){if(!o)throw new Error("usePluginExtensions(options) can only be used after the Grafana instance has started.");return o(s)}function f(s){const{extensions:h,isLoading:u}=i(s);return(0,n.useMemo)(()=>({links:h.filter(a.D),isLoading:u}),[h,u])}function d(s){const{extensions:h,isLoading:u}=i(s);return(0,n.useMemo)(()=>({components:h.filter(a.a).map(({component:b})=>b),isLoading:u}),[h,u])}function l(s){const{extensions:h,isLoading:u}=i(s);return(0,n.useMemo)(()=>({extensions:h.filter(a.D),isLoading:u}),[h,u])}function m(s){const{extensions:h,isLoading:u}=i(s);return(0,n.useMemo)(()=>({extensions:h.filter(a.a),isLoading:u}),[h,u])}},80882:(Q,I,e)=>{"use strict";e.d(I,{D:()=>a,a:()=>o});var n=e(74135);function a(r){return r?r.type===n.u.link&&("path"in r||"onClick"in r):!1}function o(r){return r?r.type===n.u.component&&"component"in r:!1}},72574:(Q,I,e)=>{"use strict";e.d(I,{d:()=>a,w:()=>o});let n;const a=r=>{n=r},o=()=>n},26657:(Q,I,e)=>{"use strict";e.d(I,{iy:()=>T,dR:()=>p,b1:()=>D,VQ:()=>E,s9:()=>v,ph:()=>A,x7:()=>M});var n=e(62467),a=e(75505),o=e(44240),r=e(63720),i=e(66847),f=e(40187),d=e(22391),l=e(55004),m=e(89667),s=e(92341),h=e(32264),u=e(19347),b=e(78731),g=e(17172),P=e(9631),c=e(47773);function y(x){const{intervalMs:C,maxDataPoints:O,requestId:R,panelId:L,queryCachingTTL:N,range:{from:F,to:K}}=x;if(!x.targets.length)return(0,n.of)({data:[]});const B={intervalMs:C,maxDataPoints:O,queryCachingTTL:N,timeRange:{from:F.valueOf().toString(),to:K.valueOf().toString(),timezone:x.timezone}};return(0,g.AI)().fetch({url:`/api/public/dashboards/${h.$.publicDashboardAccessToken}/panels/${L}/query`,method:"POST",data:B,requestId:R}).pipe((0,r.n)(w=>(0,n.of)((0,c.bE)(w,x.targets))),(0,i.W)(w=>(0,n.of)((0,c.bE)(w))))}const p=Object.freeze({type:"__expr__",uid:"__expr__",name:"Expression"});function v(x){if(!x)return!1;const C=typeof x=="string"?x:x.type;return C===p.type||C===p.name||C==="-100"}class D extends Error{constructor(C,O){super(C),this.details=O,this.name="HealthCheckError"}}var E=(x=>(x.Unknown="UNKNOWN",x.OK="OK",x.Error="ERROR",x))(E||{}),S=(x=>(x.PluginID="X-Plugin-Id",x.DatasourceUID="X-Datasource-Uid",x.DashboardUID="X-Dashboard-Uid",x.PanelID="X-Panel-Id",x.PanelPluginId="X-Panel-Plugin-Id",x.QueryGroupID="X-Query-Group-Id",x.FromExpression="X-Grafana-From-Expr",x.SkipQueryCache="X-Cache-Skip",x))(S||{});class T extends f.mA{constructor(C){super(C),this.streamOptionsProvider=A}query(C){if(h.$.publicDashboardAccessToken)return y(C);const{intervalMs:O,maxDataPoints:R,queryCachingTTL:L,range:N,requestId:F,hideFromInspector:K=!1}=C;let B=C.targets,w=!1;const U=new Set,W=new Set,V=B.map(j=>{let Y=this.getRef(),oe=this.id,se=!0;if(v(j.datasource))return w=!0,{...j,datasource:p};if(j.datasource){const ne=(0,u.l)().getInstanceSettings(j.datasource,C.scopedVars);if(!ne)throw new Error(`Unknown Datasource: ${JSON.stringify(j.datasource)}`);const ee=ne.rawRef??(0,d.p$)(ne),Z=ne.id;(ee.uid!==Y.uid||oe!==Z)&&(Y=ee,oe=Z,se=!1)}return Y.type?.length&&U.add(Y.type),Y.uid?.length&&W.add(Y.uid),{...se?this.applyTemplateVariables(j,C.scopedVars,C.filters):j,datasource:Y,datasourceId:oe,intervalMs:O,maxDataPoints:R,queryCachingTTL:L}});if(!V.length)return(0,n.of)({data:[]});const _={queries:V,from:N?.from.valueOf().toString(),to:N?.to.valueOf().toString()};if(h.$.featureToggles.queryOverLive)return(0,b.oF)().getQueryData({request:C,body:_});const H={};H["X-Plugin-Id"]=Array.from(U).join(", "),H["X-Datasource-Uid"]=Array.from(W).join(", ");let G="/api/ds/query?ds_type="+this.type;return h.$.featureToggles.queryServiceFromUI&&(h.$.featureToggles.queryService||h.$.featureToggles.grafanaAPIServerWithExperimentalAPIs?(!w&&W.size,G=`/apis/query.grafana.app/v0alpha1/namespaces/${h.$.namespace}/query?ds_type=' + this.type`):console.warn("feature toggle queryServiceFromUI also requires the queryService to be running")),w&&(H["X-Grafana-From-Expr"]="true",G+="&expression=true"),F&&(G+=`&requestId=${F}`),C.dashboardUID&&(H["X-Dashboard-Uid"]=C.dashboardUID),C.panelId&&(H["X-Panel-Id"]=`${C.panelId}`),C.panelPluginId&&(H["X-Panel-Plugin-Id"]=`${C.panelPluginId}`),C.queryGroupId&&(H["X-Query-Group-Id"]=`${C.queryGroupId}`),C.skipQueryCache&&(H["X-Cache-Skip"]="true"),(0,g.AI)().fetch({url:G,method:"POST",data:_,requestId:F,hideFromInspector:K,headers:H}).pipe((0,r.n)(j=>{const Y=(0,c.bE)(j,V);return Y.data?.length&&Y.data.find(oe=>oe.meta?.channel)?M(Y,C,this.streamOptionsProvider):(0,n.of)(Y)}),(0,i.W)(j=>(0,n.of)((0,c.bE)(j))))}getRequestHeaders(){const C={};return C["X-Plugin-Id"]=this.type,C["X-Datasource-Uid"]=this.uid,C}interpolateVariablesInQueries(C,O,R){return C.map(L=>this.applyTemplateVariables(L,O,R))}applyTemplateVariables(C,O,R){return C}async getResource(C,O,R){const L=this.getRequestHeaders();return(await(0,a.s)((0,g.AI)().fetch({...R,method:"GET",headers:R?.headers?{...R.headers,...L}:L,params:O??R?.params,url:`/api/datasources/uid/${this.uid}/resources/${C}`}))).data}async postResource(C,O,R){const L=this.getRequestHeaders();return(await(0,a.s)((0,g.AI)().fetch({...R,method:"POST",headers:R?.headers?{...R.headers,...L}:L,data:O??{...O},url:`/api/datasources/uid/${this.uid}/resources/${C}`}))).data}async callHealthCheck(){return(0,a.s)((0,g.AI)().fetch({method:"GET",url:`/api/datasources/uid/${this.uid}/health`,showErrorAlert:!1,headers:this.getRequestHeaders()})).then(C=>C.data).catch(C=>C.data)}async testDatasource(){return this.callHealthCheck().then(C=>C.status==="OK"?{status:"success",message:C.message}:Promise.reject({status:"error",message:C.message,error:new D(C.message,C.details)}))}}function M(x,C,O){const R=(0,b.oF)();if(!R)return(0,n.of)(x);const L=[],N=[];for(const F of x.data){const K=(0,l.DG)(F.meta?.channel);if(K){const B=F;N.push(R.getDataStream({addr:K,buffer:O(C,B),frame:(0,m.Nw)(F)}))}else L.push(F)}return L.length&&N.push((0,n.of)({...x,data:L})),N.length===1?N[0]:(0,o.h)(...N)}const A=(x,C)=>{const O={maxLength:x.maxDataPoints??500,action:P.Kh.Append};return x.rangeRaw?.to==="now"&&(O.maxDelta=x.range.to.valueOf()-x.range.from.valueOf()),O};T=(0,s.Y)(T)},33378:(Q,I,e)=>{"use strict";e.d(I,{a:()=>a});var n=e(32264);const a=o=>{const{enabledFeatures:r}=n.$.licenseInfo;return r&&r[o]}},34867:(Q,I,e)=>{"use strict";e.d(I,{DW:()=>m,FF:()=>i,MD:()=>f,fH:()=>r,l$:()=>l,vV:()=>d});var n=e(32631),a=e(37930),o=e(32264);function r(s,h){o.$.grafanaJavascriptAgent.enabled&&n.P.api.pushLog([s],{level:a.$b.INFO,context:h})}function i(s,h){o.$.grafanaJavascriptAgent.enabled&&n.P.api.pushLog([s],{level:a.$b.WARN,context:h})}function f(s,h){o.$.grafanaJavascriptAgent.enabled&&n.P.api.pushLog([s],{level:a.$b.DEBUG,context:h})}function d(s,h){o.$.grafanaJavascriptAgent.enabled&&n.P.api.pushError(s,{context:h})}function l(s,h,u){o.$.grafanaJavascriptAgent.enabled&&n.P.api.pushMeasurement({type:s,values:h,context:u})}function m(s,h){const u=b=>({source:s,...h,...b});return{logDebug:(b,g)=>f(b,u(g)),logInfo:(b,g)=>r(b,u(g)),logWarning:(b,g)=>i(b,u(g)),logError:(b,g)=>d(b,u(g)),logMeasurement:(b,g,P)=>l(b,g,u(P))}}},89191:(Q,I,e)=>{"use strict";e.d(I,{PL:()=>a,o:()=>i,se:()=>r});var n=e(32264);async function a(f){try{const d=n.$.bootData.user.theme==="light"?f.light:f.dark;return window.System.import(d)}catch(d){console.error(d)}}let o;function r(f){if(o)throw new Error("pluginImportUtils should only be set once, when Grafana is starting.");o=f}function i(){if(!o)throw new Error("pluginImportUtils can only be used after Grafana instance has started.");return o}},47773:(Q,I,e)=>{"use strict";e.d(I,{$h:()=>h,bE:()=>d});var n=e(39070),a=e(89667),o=e(14236),r=e(11261),i=e(12091);const f={severity:"info",text:"Cached response"};function d(u,b){const g={data:[],state:n.Gu.Done},P="traceId"in u?u.traceId:void 0;P!=null&&(g.traceIds=[P]);const c=u;if(c.data?.results){const y=c.data.results,p=b?.length?b.map(E=>E.refId):Object.keys(y),v=l(c),D=[];for(const E of p){const S=y[E];S&&(S.refId=E,D.push(S))}for(const E of D){if(E.error){const S={refId:E.refId,message:E.error,status:E.status};P!=null&&(S.traceId=P),g.error||(g.error={...S}),g.errors?g.errors.push({...S}):g.errors=[{...S}],g.state=n.Gu.Error}if(E.frames?.length){for(let S of E.frames){v&&(S=m(S));const T=(0,a.or)(S);T.refId||(T.refId=E.refId),g.data.push(T)}continue}if(E.series?.length)for(const S of E.series)S.refId||(S.refId=E.refId),g.data.push((0,o.Vc)(S));if(E.tables?.length)for(const S of E.tables)S.refId||(S.refId=E.refId),g.data.push((0,o.Vc)(S))}}return c.status&&c.status!==200&&(g.state!==n.Gu.Error&&(g.state=n.Gu.Error),g.error||(g.error=(0,i.u)(u))),g}function l(u){const b=u?.headers;return!b||!b.get?!1:b.get("X-Cache")==="HIT"}function m(u){return{...u,schema:{...u.schema,fields:[...u.schema?.fields??[]],meta:{...u.schema?.meta,notices:[...u.schema?.meta?.notices??[],f],isCachedResponse:!0}}}}function s(u){const b=d(u);if(b.error?.data?.message)return{status:"error",message:b.error.data.message,details:b.error?.data?.error?{message:b.error.data.error}:void 0};if(b.error?.refId&&b.error?.message)return{status:"error",message:b.error.message};throw u}function h(u){if(!u||!u.length)return[];const b=[];let g=u.fields.find(P=>P.type===r.PU.string);if(g||(g=u.fields.find(P=>P.type!==r.PU.time)),g)for(let P=0;P<g.values.length;P++)b.push({text:""+g.values[P]});return b}},14778:(Q,I,e)=>{"use strict";e.d(I,{_:()=>a,i:()=>o});let n;const a=r=>{n=r},o=()=>n?n():()=>console.error("ReturnToPrevious hook not found")},52622:(Q,I,e)=>{"use strict";e.d(I,{$N:()=>K,$l:()=>W,$m:()=>oe,$p:()=>R,CD:()=>F,D7:()=>l,F8:()=>L,GR:()=>b,J1:()=>d,L4:()=>c,Lt:()=>D,Ly:()=>T,NU:()=>g,Nj:()=>v,ON:()=>E,QH:()=>a,QR:()=>n,RU:()=>r,SV:()=>N,T6:()=>_,TZ:()=>V,WQ:()=>o,Wq:()=>G,Y$:()=>h,aG:()=>f,dx:()=>P,eX:()=>U,fY:()=>se,gs:()=>p,lm:()=>M,ob:()=>H,on:()=>y,qM:()=>Y,q_:()=>i,uH:()=>m,vM:()=>s,vp:()=>Z,wV:()=>x,xB:()=>B,yL:()=>u,yp:()=>O,zT:()=>ne});var n=(z=>(z.AlertStates="alertStates",z.Annotations="annotations",z.Series="series",z))(n||{}),a=(z=>(z.Linear="linear",z.Quad="quad",z))(a||{}),o=(z=>(z.Clamped="clamped",z.Mod="mod",z))(o||{}),r=(z=>(z.Field="field",z.Fixed="fixed",z.Template="template",z))(r||{}),i=(z=>(z.Field="field",z.Fixed="fixed",z.Mapping="mapping",z))(i||{}),f=(z=>(z.Auto="auto",z.Coords="coords",z.Geohash="geohash",z.Lookup="lookup",z))(f||{}),d=(z=>(z.Count="count",z.Size="size",z))(d||{}),l=(z=>(z.auto="auto",z.ge="ge",z.le="le",z.unknown="unknown",z))(l||{}),m=(z=>(z.Ascending="Ascending",z.Descending="Descending",z))(m||{}),s=(z=>(z.Auto="auto",z.Bottom="bottom",z.Hidden="hidden",z.Left="left",z.Right="right",z.Top="top",z))(s||{}),h=(z=>(z.Series="series",z.Text="text",z))(h||{}),u=(z=>(z.Always="always",z.Auto="auto",z.Never="never",z))(u||{}),b=(z=>(z.Bars="bars",z.Line="line",z.Points="points",z))(b||{}),g=(z=>(z.Constant="constant",z.NegativeY="negative-Y",z))(g||{}),P=(z=>(z.Linear="linear",z.Smooth="smooth",z.StepAfter="stepAfter",z.StepBefore="stepBefore",z))(P||{}),c=(z=>(z.Linear="linear",z.Log="log",z.Ordinal="ordinal",z.Symlog="symlog",z))(c||{}),y=(z=>(z.Hue="hue",z.None="none",z.Opacity="opacity",z.Scheme="scheme",z))(y||{}),p=(z=>(z.None="none",z.Normal="normal",z.Percent="percent",z))(p||{}),v=(z=>(z[z.After=1]="After",z[z.Before=-1]="Before",z[z.Center=0]="Center",z))(v||{}),D=(z=>(z[z.Horizontal=0]="Horizontal",z[z.Vertical=1]="Vertical",z))(D||{}),E=(z=>(z[z.Down=-1]="Down",z[z.Left=-1]="Left",z[z.Right=1]="Right",z[z.Up=1]="Up",z))(E||{});const S={dash:[]};var T=(z=>(z.Area="area",z.Dashed="dashed",z.DashedAndArea="dashed+area",z.Line="line",z.LineAndArea="line+area",z.Off="off",z.Series="series",z))(T||{}),M=(z=>(z.Hidden="hidden",z.List="list",z.Table="table",z))(M||{});const A={calcs:[]};var x=(z=>(z.Auto="auto",z.Horizontal="horizontal",z.Vertical="vertical",z))(x||{});const C={timezone:[]};var O=(z=>(z.Background="background",z.BackgroundSolid="background_solid",z.None="none",z.Value="value",z))(O||{}),R=(z=>(z.Area="area",z.Line="line",z.None="none",z))(R||{}),L=(z=>(z.Auto="auto",z.Center="center",z))(L||{}),N=(z=>(z.Auto="auto",z.Name="name",z.None="none",z.Value="value",z.ValueAndName="value_and_name",z))(N||{}),F=(z=>(z.Inverted="inverted",z.SameAsValue="same_as_value",z.Standard="standard",z))(F||{}),K=(z=>(z.Multi="multi",z.None="none",z.Single="single",z))(K||{}),B=(z=>(z.Ascending="asc",z.Descending="desc",z.None="none",z))(B||{});const w={calcs:[]};var U=(z=>(z.Basic="basic",z.Gradient="gradient",z.Lcd="lcd",z))(U||{}),W=(z=>(z.Color="color",z.Hidden="hidden",z.Text="text",z))(W||{}),V=(z=>(z.Auto="auto",z.Left="left",z.Top="top",z))(V||{}),_=(z=>(z.Auto="auto",z.Manual="manual",z))(_||{}),H=(z=>(z.Auto="auto",z.BasicGauge="basic",z.ColorBackground="color-background",z.ColorBackgroundSolid="color-background-solid",z.ColorText="color-text",z.Custom="custom",z.DataLinks="data-links",z.Gauge="gauge",z.GradientGauge="gradient-gauge",z.Image="image",z.JSONView="json-view",z.LcdGauge="lcd-gauge",z.Sparkline="sparkline",z))(H||{}),G=(z=>(z.Basic="basic",z.Gradient="gradient",z))(G||{});const j={fields:[],reducer:[]};var Y=(z=>(z.Auto="auto",z.Lg="lg",z.Md="md",z.Sm="sm",z))(Y||{}),oe=(z=>(z.CSV="csv",z.Date="date",z.Distributed="distributed",z.DoubleQuote="doublequote",z.Glob="glob",z.HTML="html",z.JSON="json",z.Lucene="lucene",z.PercentEncode="percentencode",z.Pipe="pipe",z.QueryParam="queryparam",z.Raw="raw",z.Regex="regex",z.SQLString="sqlstring",z.SingleQuote="singlequote",z.Text="text",z.UriEncode="uriencode",z))(oe||{}),se=(z=>(z.exact="exact",z.none="none",z.numbers="numbers",z.signature="signature",z))(se||{}),ne=(z=>(z.EQ="eq",z.GT="gt",z.GTE="gte",z.LT="lt",z.LTE="lte",z.NEQ="neq",z))(ne||{});const ee={align:"auto",inspect:!1},Z="browser"},33623:(Q,I,e)=>{"use strict";e.d(I,{KQ:()=>o,QB:()=>r});var n=e(52622);const a="11.1.4",o={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:n.wV.Auto,showValue:n.yL.Auto,stacking:n.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},r={fillOpacity:80,gradientMode:n.on.None,lineWidth:1}},16371:(Q,I,e)=>{"use strict";e.d(I,{K:()=>o});var n=e(52622);const a="11.1.4",o={displayMode:n.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:n.TZ.Auto,showUnfilled:!0,sizing:n.T6.Auto,valueMode:n.$l.Color}},37827:(Q,I,e)=>{"use strict";e.d(I,{K:()=>a});const n="11.1.4",a={selectedSeries:0}},44955:(Q,I,e)=>{"use strict";e.d(I,{K:()=>o});var n=e(52622);const a="11.1.4",o={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:n.T6.Auto}},87487:(Q,I,e)=>{"use strict";e.d(I,{KQ:()=>a});const n="11.1.4",a={layers:[]},o={allLayers:!0,id:"zero",lat:0,lon:0,zoom:1};var r=(f=>(f.Details="details",f.None="none",f))(r||{}),i=(f=>(f.Coords="coords",f.Fit="fit",f.Zero="zero",f))(i||{})},96529:(Q,I,e)=>{"use strict";e.d(I,{KQ:()=>f});var n=e(52622);const a="11.1.4";var o=(d=>(d.Opacity="opacity",d.Scheme="scheme",d))(o||{}),r=(d=>(d.Exponential="exponential",d.Linear="linear",d))(r||{}),i=(d=>(d.X="x",d.Xy="xy",d.Y="y",d))(i||{});const f={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:n.yL.Auto,tooltip:{mode:n.$N.Single,yHistogram:!1,showColorScale:!1}}},42226:(Q,I,e)=>{"use strict";e.d(I,{KQ:()=>o,QB:()=>r});var n=e(52622);const a="11.1.4",o={bucketCount:30,bucketOffset:0},r={fillOpacity:80,gradientMode:n.on.None,lineWidth:1}},69383:(Q,I,e)=>{"use strict";e.d(I,{K:()=>a});const n="11.1.4",a={showImage:!0}},65391:(Q,I,e)=>{"use strict";e.d(I,{KQ:()=>f});const n="11.1.4";var a=(d=>(d.Donut="donut",d.Pie="pie",d))(a||{}),o=(d=>(d.Name="name",d.Percent="percent",d.Value="value",d))(o||{}),r=(d=>(d.Percent="percent",d.Value="value",d))(r||{});const i={values:[]},f={displayLabels:[]}},89607:(Q,I,e)=>{"use strict";e.d(I,{K:()=>o});var n=e(52622);const a="11.1.4",o={colorMode:n.yp.Value,graphMode:n.$p.Area,justifyMode:n.F8.Auto,percentChangeColorMode:n.CD.Standard,showPercentChange:!1,textMode:n.SV.Auto,wideLayout:!0}},15821:(Q,I,e)=>{"use strict";e.d(I,{KQ:()=>o,QB:()=>r});var n=e(52622);const a="11.1.4",o={alignValue:"left",mergeValues:!0,rowHeight:.9,showValue:n.yL.Auto},r={fillOpacity:70,lineWidth:0}},64337:(Q,I,e)=>{"use strict";e.d(I,{KQ:()=>o,QB:()=>r});var n=e(52622);const a="11.1.4",o={colWidth:.9,rowHeight:.9,showValue:n.yL.Auto},r={fillOpacity:70,lineWidth:1}},52037:(Q,I,e)=>{"use strict";e.d(I,{K:()=>o});var n=e(52622);const a="11.1.4",o={cellHeight:n.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]}},12183:(Q,I,e)=>{"use strict";e.d(I,{KQ:()=>f});const n="11.1.4";var a=(d=>(d.Code="code",d.HTML="html",d.Markdown="markdown",d))(a||{}),o=(d=>(d.Go="go",d.Html="html",d.Json="json",d.Markdown="markdown",d.Plaintext="plaintext",d.Sql="sql",d.Typescript="typescript",d.Xml="xml",d.Yaml="yaml",d))(o||{});const r="plaintext",i={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},f={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"}},10055:(Q,I,e)=>{"use strict";e.d(I,{KQ:()=>d,QB:()=>f});var n=e(52622);const a="11.1.4";var o=(l=>(l.Auto="auto",l.Manual="manual",l))(o||{}),r=(l=>(l.Lines="lines",l.Points="points",l.PointsAndLines="points+lines",l))(r||{});const i={exclude:[]},f={label:n.yL.Auto,show:"points"},d={series:[]}},73134:(Q,I,e)=>{"use strict";e.d(I,{CO:()=>f,GW:()=>T,OA:()=>v,Ol:()=>u,QB:()=>S,Yb:()=>s,Ye:()=>M,ZG:()=>l,aD:()=>o,bf:()=>r,bt:()=>D,dM:()=>g,lt:()=>c,rw:()=>i,ss:()=>E,yV:()=>y});const n={tags:[]},a={exclude:!1,ids:[]},o={list:[]},r={builtIn:0,enable:!0,hide:!1},i={includeAll:!1,multi:!1,options:[],skipUrlSync:!1};var f=(A=>(A[A.never=0]="never",A[A.onDashboardLoad=1]="onDashboardLoad",A[A.onTimeRangeChanged=2]="onTimeRangeChanged",A))(f||{}),d=(A=>(A[A.dontHide=0]="dontHide",A[A.hideLabel=1]="hideLabel",A[A.hideVariable=2]="hideVariable",A))(d||{}),l=(A=>(A[A.alphabeticalAsc=1]="alphabeticalAsc",A[A.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",A[A.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",A[A.alphabeticalDesc=2]="alphabeticalDesc",A[A.disabled=0]="disabled",A[A.naturalAsc=7]="naturalAsc",A[A.naturalDesc=8]="naturalDesc",A[A.numericalAsc=3]="numericalAsc",A[A.numericalDesc=4]="numericalDesc",A))(l||{});const m={asDropdown:!1,includeVars:!1,keepTime:!1,tags:[],targetBlank:!1};var s=(A=>(A.ContinuousBlPu="continuous-BlPu",A.ContinuousBlYlRd="continuous-BlYlRd",A.ContinuousBlues="continuous-blues",A.ContinuousGrYlRd="continuous-GrYlRd",A.ContinuousGreens="continuous-greens",A.ContinuousPurples="continuous-purples",A.ContinuousRdYlGr="continuous-RdYlGr",A.ContinuousReds="continuous-reds",A.ContinuousYlBl="continuous-YlBl",A.ContinuousYlRd="continuous-YlRd",A.Fixed="fixed",A.PaletteClassic="palette-classic",A.PaletteClassicByName="palette-classic-by-name",A.Shades="shades",A.Thresholds="thresholds",A))(s||{});const h={h:9,w:12,x:0,y:0};var u=(A=>(A.Absolute="absolute",A.Percentage="percentage",A))(u||{});const b={steps:[]};var g=(A=>(A.RangeToText="range",A.RegexToText="regex",A.SpecialValue="special",A.ValueToText="value",A))(g||{}),P=(A=>(A.Empty="empty",A.False="false",A.NaN="nan",A.Null="null",A.NullAndNan="null+nan",A.True="true",A))(P||{});const c={hidden:!1,refresh_intervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],time_options:["5m","15m","1h","6h","12h","24h","2d","7d","30d"]};var y=(A=>(A[A.Crosshair=1]="Crosshair",A[A.Off=0]="Off",A[A.Tooltip=2]="Tooltip",A))(y||{});const p=0,v={links:[],repeatDirection:"h",targets:[],transformations:[],transparent:!1},D={overrides:[]},E={id:""},S={links:[],mappings:[]},T={collapsed:!1,panels:[]},M={editable:!0,fiscalYearStartMonth:0,graphTooltip:0,links:[],panels:[],schemaVersion:39,tags:[],timezone:"browser"}},39651:(Q,I,e)=>{"use strict";e.d(I,{Gu:()=>o,gB:()=>a});var n=e(52622);const a={align:"auto",inspect:!1,cellOptions:{type:n.ob.Auto}};var o=(r=>(r.NotStarted="NotStarted",r.Loading="Loading",r.Streaming="Streaming",r.Done="Done",r.Error="Error",r))(o||{})},79422:(Q,I,e)=>{"use strict";e.d(I,{Ye:()=>o,lt:()=>i,rw:()=>r,zL:()=>a});var n=e(73134),a=(b=>(b[b.dontHide=0]="dontHide",b[b.hideLabel=1]="hideLabel",b[b.hideVariable=2]="hideVariable",b))(a||{});const o=n.Ye,r={...n.rw},i=n.lt,f=n.OA,d=n.GW,l=n.QB,m=n.bt,s=n.ss,h=n.bf,u=n.aD},11807:(Q,I,e)=>{"use strict";e.d(I,{l:()=>s});var n=e(32196),a=e(96540),o=e(73287),r=e(14110),i=e(40845),f=e(29158),d=e(88575),l=e(32372),m=e(94471);function s({rawSql:u,datasourceType:b}){const[g,P]=(0,o.A)(),c=(0,i.of)(h),y=v=>{P(v),(0,r.rR)("grafana_sql_preview_copied",{datasource:b})},p=a.createElement("div",{className:c.labelWrapper},a.createElement("span",{className:c.label},"Preview"),a.createElement(f.K,{tooltip:"Copy to clipboard",onClick:()=>y(u),name:"copy"}));return a.createElement(d.D,{label:p,className:c.grow},a.createElement(l.B,{language:"sql",height:80,value:(0,m.s)(u),monacoOptions:{scrollbar:{vertical:"hidden"},scrollBeyondLastLine:!1},readOnly:!0,showMiniMap:!1}))}function h(u){return{grow:(0,n.css)({flexGrow:1}),label:(0,n.css)({fontSize:12,fontWeight:u.typography.fontWeightMedium}),labelWrapper:(0,n.css)({display:"flex",justifyContent:"space-between",paddingBottom:u.spacing(.5)})}}},94471:(Q,I,e)=>{"use strict";e.d(I,{s:()=>a});var n=e(27633);function a(o){return n.Ay.format(o).replace(/(\$ \{ .* \})|(\$ __)|(\$ \w+)/g,r=>r.replace(/\s/g,""))}},42418:(Q,I,e)=>{"use strict";e.d(I,{F:()=>m});var n=e(32196),a=e(96540),o=e(13544),r=e(40845),i=e(55852),f=e(14578),d=e(90613),l=e(94753);const m=a.forwardRef(({title:u,onRemove:b,children:g,buttonContent:P,elevated:c,bottomSpacing:y,topSpacing:p,className:v,severity:D="error",...E},S)=>{const T=(0,r.$j)(),A=h(T,D,!!u,c,y,p),x={error:"alert",warning:"alert",info:"status",success:"status"},C=E.role||x[D],O=E["aria-label"]||u;return a.createElement("div",{ref:S,className:(0,n.cx)(A.wrapper,v),role:C,"aria-label":O,...E},a.createElement(d.a,{"data-testid":o.Tp.components.Alert.alertV2(D),display:"flex",backgroundColor:D,borderRadius:"default",paddingY:1,paddingX:2,borderStyle:"solid",borderColor:D,alignItems:"stretch",boxShadow:c?"z3":void 0},a.createElement(d.a,{paddingTop:1,paddingRight:2},a.createElement("div",{className:A.icon},a.createElement(f.I,{size:"xl",name:s(D)}))),a.createElement(d.a,{paddingY:1,grow:1},a.createElement(l.E,{color:"primary",weight:"medium"},u),g&&a.createElement("div",{className:A.content},g)),b&&!P&&a.createElement("div",{className:A.close},a.createElement(i.$n,{"aria-label":"Close alert",icon:"times",onClick:b,type:"button",fill:"text",variant:"secondary"})),b&&P&&a.createElement(d.a,{marginLeft:1,display:"flex",alignItems:"center"},a.createElement(i.$n,{"aria-label":"Close alert",variant:"secondary",onClick:b,type:"button"},P))))});m.displayName="Alert";const s=u=>{switch(u){case"error":return"exclamation-circle";case"warning":return"exclamation-triangle";case"info":return"info-circle";case"success":return"check"}},h=(u,b,g,P,c,y)=>{const p=u.colors[b];return{wrapper:(0,n.css)({flexGrow:1,marginBottom:u.spacing(c??2),marginTop:u.spacing(y??0),position:"relative","&:before":{content:'""',position:"absolute",top:0,left:0,bottom:0,right:0,background:u.colors.background.primary,zIndex:-1}}),icon:(0,n.css)({color:p.text}),content:(0,n.css)({color:u.colors.text.primary,paddingTop:g?u.spacing(.5):0,maxHeight:"50vh",overflowY:"auto"}),close:(0,n.css)({position:"relative",color:u.colors.text.secondary,background:"none",display:"flex",top:"-6px",right:"-14px"})}}},28270:(Q,I,e)=>{"use strict";e.d(I,{p:()=>b});var n=e(32196),a=e(2543),o=e(96540),r=e(40845),i=e(88575),f=e(32982);const d=o.memo(()=>{const P=(0,r.of)(l);return o.createElement("div",{className:P.ellipsis},o.createElement("span",{className:P.firstDot},"."),o.createElement("span",{className:P.secondDot},"."),o.createElement("span",{className:P.thirdDot},"."))});d.displayName="EllipsisAnimated";const l=P=>({ellipsis:(0,n.css)({display:"inline"}),firstDot:(0,n.css)({[P.transitions.handleMotion("no-preference","reduce")]:{animation:`${m} 2s linear infinite`}}),secondDot:(0,n.css)({[P.transitions.handleMotion("no-preference","reduce")]:{animation:`${s} 2s linear infinite`}}),thirdDot:(0,n.css)({[P.transitions.handleMotion("no-preference","reduce")]:{animation:`${h} 2s linear infinite`}})}),m=(0,n.keyframes)`
  0% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,s=(0,n.keyframes)`
  0% {
    opacity: 0;
  }
  21% {
    opacity: 0.5;
  }
  22% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,h=(0,n.keyframes)`
  0% {
    opacity: 0;
  }
  43% {
    opacity: 0.5;
  }
  44% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,u=2*1e3;function b(P){const{invalid:c,loading:y,onFinishChange:p,saveErrorMessage:v="Error saving this value",error:D,children:E,disabled:S,...T}=P,[M,A]=o.useState({isLoading:!1,showSuccess:!1,showError:c}),x=(0,o.useRef)(null);o.useEffect(()=>{let N;if(M.showSuccess){const F=M.showError?0:u;N=setTimeout(()=>{A({...M,showSuccess:!1})},F)}return()=>{window.clearTimeout(N)}},[M]);const C=(0,o.useCallback)(N=>{c||(A({...M,isLoading:!0,showSuccess:!1}),p(N).then(()=>{A({isLoading:!1,showSuccess:!0,showError:!1})}).catch(()=>{A({...M,isLoading:!1,showError:!0})}))},[c,M,p]),O=(0,o.useMemo)(()=>(0,a.debounce)(C,600,{leading:!1}),[C]),R=c||M.showError||void 0,L=(0,r.of)(g);return o.createElement(o.Fragment,null,o.createElement(i.D,{...T,loading:y||void 0,invalid:R,disabled:S,error:D||M.showError&&v,ref:x,className:L.widthFitContent},o.cloneElement(E(N=>{O(N)}))),M.isLoading&&o.createElement(f.r,{referenceElement:x.current,placement:"right"},"Saving ",o.createElement(d,null)),M.showSuccess&&o.createElement(f.r,{suffixIcon:"check",referenceElement:x.current,placement:"right"},"Saved!"))}b.displayName="AutoSaveField";const g=()=>({widthFitContent:(0,n.css)({width:"fit-content"})})},39938:(Q,I,e)=>{"use strict";e.d(I,{E:()=>h});var n=e(32196),a=e(96540),o=e(70255),r=e(84140),i=e(40845),f=e(72129),d=e(14578),l=e(56034);const m=a.memo(({icon:g,color:P,text:c,tooltip:y,className:p,...v})=>{const D=(0,i.of)(b,P),E=a.createElement("div",{className:(0,n.cx)(D.wrapper,p),...v},g&&a.createElement(d.I,{name:g,size:"sm"}),c);return y?a.createElement(l.m,{content:y,placement:"auto"},E):E});m.displayName="Badge";const s=({rootProps:g})=>{const P=(0,i.of)(u);return a.createElement(o.A,{width:60,height:22,containerClassName:P.container,...g})},h=(0,f.j)(m,s),u=()=>({container:(0,n.css)({lineHeight:1})}),b=(g,P)=>{let c=g.visualization.getColorByName(P),y="",p="",v="";return g.isDark?(p=(0,r.A)(c).setAlpha(.15).toString(),y=(0,r.A)(c).setAlpha(.25).toString(),v=(0,r.A)(c).lighten(15).toString()):(p=(0,r.A)(c).setAlpha(.15).toString(),y=(0,r.A)(c).setAlpha(.25).toString(),v=(0,r.A)(c).darken(20).toString()),{wrapper:(0,n.css)({display:"inline-flex",padding:"1px 4px",borderRadius:g.shape.radius.default,background:p,border:`1px solid ${y}`,color:v,fontWeight:g.typography.fontWeightRegular,gap:"2px",fontSize:g.typography.bodySmall.fontSize,lineHeight:g.typography.bodySmall.lineHeight,alignItems:"center"})}}},97696:(Q,I,e)=>{"use strict";e.d(I,{xE:()=>E});var n=e(32196),a=e(96540),o=e(84140),r=e(47070),i=e(50082),f=e(58649),d=e(83195),l=e(24293),m=e(8066),s=e(13544),h=e(52622),u=e(29413),b=e(55852),g=e(9286);const P=18,c=50,y=150,p=1.5,v=1,D=10;class E extends a.PureComponent{static{this.defaultProps={lcdCellWidth:12,value:{text:"100",numeric:100},displayMode:h.eX.Gradient,orientation:r.wV.Horizontal,field:{min:0,max:100,thresholds:{mode:i.O.Absolute,steps:[]}},itemSpacing:8,showUnfilled:!0}}render(){const{onClick:K,className:B,theme:w}=this.props,{title:U}=this.props.value,W=M(this.props);return K?a.createElement("button",{type:"button",style:W.wrapper,onClick:K,className:(0,n.cx)((0,b.my)(w),B)},a.createElement("div",{style:W.title},U),this.renderBarAndValue()):a.createElement("div",{style:W.wrapper,className:B},U&&a.createElement("div",{style:W.title},U),this.renderBarAndValue())}renderBarAndValue(){switch(this.props.displayMode){case"lcd":return this.renderRetroBars();case"basic":case"gradient":default:return this.renderBasicAndGradientBars()}}renderBasicAndGradientBars(){const{value:K,showUnfilled:B,valueDisplayMode:w}=this.props,U=O(this.props);return a.createElement("div",{style:U.wrapper},w!==h.$l.Hidden&&a.createElement(g.i,{"data-testid":s.Tp.components.Panels.Visualization.BarGauge.valueV2,value:K,style:U.value}),B&&a.createElement("div",{style:U.emptyBar}),a.createElement("div",{style:U.bar}))}renderRetroBars(){const{display:K,field:B,value:w,itemSpacing:U,alignmentFactors:W,orientation:V,lcdCellWidth:_,text:H,valueDisplayMode:G,theme:j}=this.props,{valueHeight:Y,valueWidth:oe,maxBarHeight:se,maxBarWidth:ne,wrapperWidth:ee,wrapperHeight:Z}=A(this.props),z=B.min??f.tw,q=B.max??f.d1,ie=S(V),de=q-z,ue=ie?se:ne,fe=U,Se=Math.floor(ue/_),he=Math.floor((ue-fe*Se)/Se),ce=L(this.props),pe=N(W||w,ce,oe,Y,V,H),ye={width:`${ee}px`,height:`${Z}px`,display:"flex"};ie?(ye.flexDirection="column-reverse",ye.alignItems="center"):(ye.flexDirection="row",ye.alignItems="center",pe.justifyContent="flex-end");const Pe=[];for(let Ie=0;Ie<Se;Ie++){const Oe=z+de/Se*Ie,Ne=x(Oe,w,K),We={borderRadius:j.shape.radius.default};Ne.isLit?We.backgroundImage=`radial-gradient(${Ne.background} 10%, ${Ne.backgroundShade})`:We.backgroundColor=Ne.background,ie?(We.height=`${he}px`,We.width=`${ne}px`,We.marginTop=`${fe}px`):(We.width=`${he}px`,We.height=`${se}px`,We.marginRight=`${fe}px`),Pe.push(a.createElement("div",{key:Ie.toString(),style:We}))}return a.createElement("div",{style:ye},Pe,G!==h.$l.Hidden&&a.createElement(g.i,{"data-testid":s.Tp.components.Panels.Visualization.BarGauge.valueV2,value:w,style:pe}))}}function S(F){return F===r.wV.Vertical}function T(F){const{height:K,width:B,alignmentFactors:w,orientation:U,text:W,namePlacement:V}=F,_=w?w.title:F.value.title;if(!_)return{fontSize:0,width:0,height:0,placement:"above"};if(S(U)){const ne=W?.titleSize??14;return{fontSize:ne,width:B,height:ne*p,placement:"below"}}if(K>40&&V===h.TZ.Auto||V===h.TZ.Top){if(W?.titleSize)return{fontSize:W?.titleSize,width:0,height:W.titleSize*p,placement:"above"};const ee=Math.max(Math.min(K*.45,c),17);return{fontSize:ee/p,width:0,height:ee,placement:"above"}}const Y=Math.max(K*.6,P)/p,oe=(0,u.kD)(_,Y),se=Math.min(oe.width+15,B*.4);return{fontSize:W?.titleSize??Y,height:0,width:se,placement:"left"}}function M(F){const K={display:"flex",overflow:"hidden",width:"100%"},B=T(F),w={fontSize:`${B.fontSize}px`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"100%",alignItems:"center",alignSelf:"center"};return S(F.orientation)?(K.flexDirection="column-reverse",w.textAlign="center"):B.placement==="above"?K.flexDirection="column":(K.flexDirection="row",w.width=`${B.width}px`,w.textAlign="right",w.paddingRight="10px"),{wrapper:K,title:w}}function A(F){const{height:K,width:B,orientation:w,text:U,alignmentFactors:W,valueDisplayMode:V}=F,_=T(F),H=W??F.value,G=(0,d.cN)(H);let j=0,Y=0,oe=0,se=0,ne=0,ee=0;const Z=U?.valueSize??Math.max(_.fontSize,12),q=(0,u.kD)(G,Z).width+D*2;return S(w)?(U?.valueSize?oe=U.valueSize*v:oe=Math.min(Math.max(K*.1,P),c),se=B,V===h.$l.Hidden&&(oe=0,se=0),j=K-(_.height+oe),Y=B,ne=B,ee=K-_.height):(V===h.$l.Hidden?(oe=0,se=0):(oe=K-_.height,se=Math.max(Math.min(B*.2,y),q)),j=K-_.height,Y=B-se-_.width,_.placement==="above"?(ne=B,ee=K-_.height):(ne=B-_.width,ee=K)),{valueWidth:se,valueHeight:oe,maxBarWidth:Y,maxBarHeight:j,wrapperHeight:ee,wrapperWidth:ne}}function x(F,K,B){if(F===null)return{background:l.F,border:l.F};const w=B?B(F).color:null;return w?K===null||isNaN(K.numeric)||F!==null&&F>K.numeric?{background:(0,o.A)(w).setAlpha(.18).toRgbString(),border:"transparent",isLit:!1}:{background:(0,o.A)(w).setAlpha(.95).toRgbString(),backgroundShade:(0,o.A)(w).setAlpha(.55).toRgbString(),border:(0,o.A)(w).setAlpha(.9).toRgbString(),isLit:!0}:{background:l.F,border:l.F}}function C(F,K,B){const w=Math.min((F-K)/(B-K),1);return isNaN(w)?0:w}function O(F){const{displayMode:K,field:B,value:w,alignmentFactors:U,orientation:W,theme:V,text:_}=F,{valueWidth:H,valueHeight:G,maxBarHeight:j,maxBarWidth:Y}=A(F),oe=B.min??f.tw,se=B.max??f.d1,ne=C(w.numeric,oe,se),ee=L(F),Z=w.color??l.F,q=N(U||w,ee,H,G,W,_),ie=K==="basic",de={display:"flex",flexGrow:1},ue={borderRadius:V.shape.radius.default,position:"relative",zIndex:1},fe={background:V.colors.background.secondary,flexGrow:1,display:"flex",borderRadius:V.shape.radius.default,position:"relative"};if(S(W)){const Se=Math.max(ne*j,1);de.flexDirection="column",de.justifyContent="flex-end",ue.transition="height 1s",ue.height=`${Se}px`,ue.width=`${Y}px`,fe.bottom="-3px",fe.width=`${H}px`,ie?(ue.background=`${(0,o.A)(Z).setAlpha(.35).toRgbString()}`,ue.borderTop=`2px solid ${Z}`):ue.background=R(F,j)}else{const Se=Math.max(ne*Y,1);de.flexDirection="row-reverse",de.justifyContent="flex-end",de.alignItems="stretch",ue.transition="width 1s",ue.height=`${j}px`,ue.width=`${Se}px`,fe.left="-3px",fe.height=`${G}px`,ie?(ue.background=`${(0,o.A)(Z).setAlpha(.35).toRgbString()}`,ue.borderRight=`2px solid ${Z}`):ue.background=R(F,Y)}return{wrapper:de,bar:ue,value:q,emptyBar:fe}}function R(F,K){const{field:B,value:w,orientation:U,theme:W}=F,V=S(U)?"0deg":"90deg",_=B.min,H=B.max;let G="",j=0,Y=(0,m.Hs)(B.color?.mode);if(Y.id===l.Y.Thresholds){const oe=B.thresholds;for(let se=0;se<oe.steps.length;se++){const ne=oe.steps[se],ee=F.theme.visualization.getColorByName(ne.color),Z=oe.mode===i.O.Percentage?ne.value/100:C(ne.value,_,H),z=Z*K,q=Math.round(z-(z-j)/2),ie=oe.mode===i.O.Percentage?_+(H-_)*Z:ne.value;if(G==="")G=`linear-gradient(${V}, ${ee}, ${ee}`;else{if(w.numeric<ie)break;j=z,G+=` ${q}px, ${ee}`}}return G+")"}if(Y.isContinuous&&Y.getColors){const oe=Y.getColors(W);for(let se=0;se<oe.length;se++){const ne=oe[se];if(G==="")G=`linear-gradient(${V}, ${ne} 0px`;else{const Z=se/(oe.length-1)*K;G+=`, ${ne} ${Z}px`}}return G+")"}return w.color??l.F}function L(F){if(F.valueDisplayMode==="text")return F.theme.colors.text.primary;const{value:K}=F;return K.color?K.color:l.F}function N(F,K,B,w,U,W){const V={color:K,height:`${w}px`,width:`${B}px`,display:"flex",alignItems:"center",lineHeight:v};let _=B;const H=(0,d.cN)(F);return S(U)?(V.fontSize=W?.valueSize??(0,u.Vr)(H,_,w,v),V.justifyContent="center"):(V.fontSize=W?.valueSize??(0,u.Vr)(H,_-D*2,w,v),V.justifyContent="flex-end",V.paddingLeft=`${D}px`,V.paddingRight=`${D}px`,_-=D),V}},37494:(Q,I,e)=>{"use strict";e.d(I,{yV:()=>N,yp:()=>C,$p:()=>O,F8:()=>R,SV:()=>L});var n=e(32196),a=e(96540),o=e(55852),r=e(9286),i=e(84140),f=e(11261),d=e(83195),l=e(52622),m=e(24284),s=e(29413),h=e(5926),u=e(14578);const b=({percentChange:F,styles:K})=>{const B=F&&(F>0?"arrow-up":F<0?"arrow-down":void 0);return a.createElement("div",{style:K.containerStyles},B&&a.createElement(u.I,{name:B,height:K.iconSize,width:K.iconSize,viewBox:"6 6 12 12"}),g(F))},g=F=>F?.toLocaleString(void 0,{style:"percent",maximumSignificantDigits:3})??"",P=1.2,c=30,y=500;class p{constructor(K){this.props=K;const{width:B,height:w,value:U,text:W}=K;this.valueColor=U.color??"gray",this.panelPadding=w>100?12:8,this.textValues=A(K),this.justifyCenter=M(K.justifyMode,this.textValues.title),this.valueToAlignTo=this.textValues.valueToAlignTo,this.titleToAlignTo=this.textValues.titleToAlignTo,this.titleFontSize=0,this.valueFontSize=0,this.chartHeight=0,this.chartWidth=0,this.maxTextWidth=B-this.panelPadding*2,this.maxTextHeight=w-this.panelPadding*2,W&&(W.titleSize&&(this.titleFontSize=W.titleSize,this.titleToAlignTo=void 0),W.valueSize&&(this.valueFontSize=W.valueSize,this.valueToAlignTo=""))}getTitleStyles(){const K={fontSize:`${this.titleFontSize}px`,lineHeight:P};return(this.props.colorMode===C.Background||this.props.colorMode===C.BackgroundSolid)&&(K.color=(0,m.mZ)(this.valueColor,this.props.theme.isDark)),K}getValueStyles(){const K={fontSize:this.valueFontSize,fontWeight:y,lineHeight:P,position:"relative",zIndex:1};switch(this.justifyCenter&&(K.textAlign="center"),this.props.colorMode){case C.Value:K.color=this.valueColor;break;case C.Background:case C.BackgroundSolid:K.color=(0,m.mZ)(this.valueColor,this.props.theme.isDark);break;case C.None:K.color=this.props.theme.colors.text.primary;break}return K}getPercentChangeStyles(K,B,w){const W=this.getValueAndTitleContainerStyles(),V=Math.max(this.valueFontSize/2.5,12);let _=Math.max(this.valueFontSize/3,10);const H=this.props.theme.visualization,G=x(K,B,w,H),j={fontSize:V,fontWeight:y,lineHeight:P,position:"relative",display:"flex",alignItems:"center",gap:Math.max(V/3,4),zIndex:1,color:G};switch(this.justifyCenter&&(j.textAlign="center"),W.flexDirection==="column"&&V>12&&(j.marginTop=-(V/4)),W.flexDirection==="row"&&(j.alignItems="baseline",j.lineHeight=P*2.5),this.props.colorMode){case C.Background:case C.BackgroundSolid:j.color=(0,m.mZ)(this.valueColor,this.props.theme.isDark);break}return this.props.textMode===L.None&&(j.fontSize=(0,s.Vr)(g(K),this.maxTextWidth*.8,this.maxTextHeight*.8,P,void 0,y),_=j.fontSize*.8),{containerStyles:j,iconSize:_}}getValueAndTitleContainerStyles(){const K={display:"flex",flexWrap:"wrap"};return this.justifyCenter&&(K.alignItems="center",K.justifyContent="center",K.flexGrow=1,K.gap="0.75ch"),K}getPanelStyles(){const{width:K,height:B,theme:w,colorMode:U,textMode:W}=this.props,V={width:`${K}px`,height:`${B}px`,padding:`${W===L.None?2:this.panelPadding}px`,borderRadius:w.shape.radius.default,position:"relative",display:"flex"},_=w.isDark?1:-.7;switch(U){case C.Background:const H=(0,i.A)(this.valueColor).darken(15*_).spin(8).toRgbString(),G=(0,i.A)(this.valueColor).darken(5*_).spin(-8).toRgbString();V.background=`linear-gradient(120deg, ${H}, ${G})`;break;case C.BackgroundSolid:V.background=(0,i.A)(this.valueColor).toString();break;case C.Value:V.background="transparent";break}return this.justifyCenter&&(V.alignItems="center",V.flexDirection="row"),V}renderChart(){const{sparkline:K,colorMode:B}=this.props;if(!K||K.y?.type!==f.PU.number)return null;let w,U;switch(B){case C.Background:case C.BackgroundSolid:w="rgba(255,255,255,0.4)",U=(0,i.A)(this.valueColor).brighten(40).toRgbString();break;case C.None:case C.Value:default:U=this.valueColor,w=(0,i.A)(this.valueColor).setAlpha(.2).toRgbString();break}const W={custom:{drawStyle:l.GR.Line,lineWidth:1,fillColor:w,lineColor:U}};return a.createElement("div",{style:this.getChartStyles()},a.createElement(h.O,{height:this.chartHeight,width:this.chartWidth,sparkline:K,config:W,theme:this.props.theme}))}getChartStyles(){return{position:"absolute",right:0,bottom:0}}}class v extends p{constructor(K){super(K);const B=this.titleToAlignTo?.length?.3:1;this.valueToAlignTo.length&&(this.valueFontSize=(0,s.Vr)(this.valueToAlignTo,this.maxTextWidth*B,this.maxTextHeight,P,void 0,y)),this.titleToAlignTo?.length&&(this.titleFontSize=(0,s.Vr)(this.titleToAlignTo,this.maxTextWidth*.6,this.maxTextHeight,P,c),this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const K=super.getValueAndTitleContainerStyles();return K.flexDirection="row",K.alignItems="center",K.flexGrow=1,this.justifyCenter||(K.justifyContent="space-between"),K}renderChart(){return null}getPanelStyles(){const K=super.getPanelStyles();return K.alignItems="center",K}}class D extends p{constructor(K){super(K);const{width:B,height:w}=K,U=.5,W=.6,V=1-W,_=.4;this.chartWidth=B,this.chartHeight=w*U,this.titleToAlignTo?.length&&(this.titleFontSize=(0,s.Vr)(this.titleToAlignTo,this.maxTextWidth*W,this.maxTextHeight*_,P,c)),this.valueToAlignTo.length&&(this.valueFontSize=(0,s.Vr)(this.valueToAlignTo,this.maxTextWidth*V,this.maxTextHeight*U,P,void 0,y))}getValueAndTitleContainerStyles(){const K=super.getValueAndTitleContainerStyles();return K.flexDirection="row",K.flexGrow=1,this.justifyCenter||(K.justifyContent="space-between"),K}getPanelStyles(){const K=super.getPanelStyles();return K.flexDirection="row",K.justifyContent="space-between",K}}class E extends p{constructor(K){super(K);const{width:B,height:w}=K,U=.15,W=.25;let V=0;this.chartHeight=w*W,this.chartWidth=B,this.titleToAlignTo?.length&&(this.titleFontSize=(0,s.Vr)(this.titleToAlignTo,this.maxTextWidth,w*U,P,c),V=this.titleFontSize*P),this.valueToAlignTo.length&&(this.valueFontSize=(0,s.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-this.chartHeight-V,P,void 0,y)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize)),this.chartHeight=w-this.titleFontSize*P-this.valueFontSize*P}getValueAndTitleContainerStyles(){const K=super.getValueAndTitleContainerStyles();return K.flexDirection="column",K.justifyContent="center",K}getPanelStyles(){const K=super.getPanelStyles();return K.flexDirection="column",K}}class S extends p{constructor(K){super(K);const{height:B}=K,w=.15;let U=0;this.titleToAlignTo?.length&&(this.titleFontSize=(0,s.Vr)(this.titleToAlignTo,this.maxTextWidth,B*w,P,c),U=this.titleFontSize*P),this.valueToAlignTo.length&&(this.valueFontSize=(0,s.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-U,P,void 0,y)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const K=super.getValueAndTitleContainerStyles();return K.flexDirection="column",K.flexGrow=1,K}renderChart(){return null}getPanelStyles(){const K=super.getPanelStyles();return K.alignItems="center",K}}function T(F){const{width:K,height:B,sparkline:w}=F;return K/B>2.5&&!F.disableWideLayout?B>50&&w&&w.y.values.length>1?new D(F):new v(F):B>100&&w&&w.y.values.length>1?new E(F):new S(F)}function M(F,K){return F===R.Center?!0:(K??"").length===0}function A(F){const{value:K,alignmentFactors:B,count:w}=F;let{textMode:U}=F;const W=B?B.title:K.title,V=(0,d.cN)(B||K);switch(U===L.Auto&&(w??1)===1&&(U=L.Value),U){case L.Name:return{...K,title:void 0,prefix:void 0,suffix:void 0,text:K.title||"",titleToAlignTo:void 0,valueToAlignTo:W??"",tooltip:(0,d.cN)(K)};case L.Value:return{...K,title:void 0,titleToAlignTo:void 0,valueToAlignTo:V,tooltip:K.title};case L.None:return{numeric:K.numeric,color:K.color,title:void 0,text:"",titleToAlignTo:void 0,valueToAlignTo:"1",tooltip:`Name: ${K.title}
Value: ${(0,d.cN)(K)}`};case L.ValueAndName:default:return{...K,titleToAlignTo:W,valueToAlignTo:V}}}function x(F,K,B,w){return K===l.CD.SameAsValue?B.color:F*(K===l.CD.Inverted?-1:1)>0?w.getColorByName("green"):w.getColorByName("red")}var C=(F=>(F.Background="background",F.BackgroundSolid="background_solid",F.None="none",F.Value="value",F))(C||{}),O=(F=>(F.None="none",F.Line="line",F.Area="area",F))(O||{}),R=(F=>(F.Auto="auto",F.Center="center",F))(R||{}),L=(F=>(F.Auto="auto",F.Value="value",F.ValueAndName="value_and_name",F.Name="name",F.None="none",F))(L||{});class N extends a.PureComponent{static{this.defaultProps={justifyMode:"auto"}}render(){const{onClick:K,className:B,hasLinks:w,theme:U}=this.props,W=T(this.props),V=W.getPanelStyles(),_=W.getValueAndTitleContainerStyles(),H=W.getValueStyles(),G=W.getTitleStyles(),j=W.textValues,Y=this.props.value.percentChange,oe=this.props.percentChangeColorMode,se=Y!=null&&!Number.isNaN(Y),ne=w?void 0:j.tooltip;return K?a.createElement("button",{type:"button",className:(0,n.cx)((0,o.my)(U),B),style:V,onClick:K,title:ne},a.createElement("div",{style:_},j.title&&a.createElement("div",{style:G},j.title),a.createElement(r.i,{value:j,style:H})),W.renderChart()):a.createElement("div",{className:B,style:V,title:ne},a.createElement("div",{style:_},j.title&&a.createElement("div",{style:G},j.title),a.createElement(r.i,{value:j,style:H}),se&&a.createElement(b,{percentChange:Y,styles:W.getPercentChangeStyles(Y,oe,H)})),W.renderChart())}}},54438:(Q,I,e)=>{"use strict";e.d(I,{J:()=>d});var n=e(32196),a=e(96540),o=e(23257),r=e.n(o),i=e(40845),f=e(5313);const d=(0,a.forwardRef)(({name:m,value:s,hidden:h,facets:u,onClick:b,className:g,loading:P,searchTerm:c,active:y,style:p,title:v,highlightParts:D,...E},S)=>{const T=(0,i.$j)(),M=l(T),A=c?[c]:[],x=(0,a.useCallback)(O=>{b&&!h&&b(m,s,O)},[b,m,h,s]);let C=s||m;return u&&(C=`${C} (${u})`),a.createElement("button",{key:C,ref:S,onClick:x,style:p,title:v||C,type:"button",role:"option","aria-selected":!!y,className:(0,n.cx)(M.base,y&&M.active,P&&M.loading,h&&M.hidden,g,b&&!h&&M.hover),...E},D!==void 0?a.createElement(f.z,{text:C,highlightClassName:M.matchHighLight,highlightParts:D}):a.createElement(r(),{textToHighlight:C,searchWords:A,autoEscape:!0,highlightClassName:M.matchHighLight}))});d.displayName="Label";const l=m=>({base:(0,n.css)({display:"inline-block",cursor:"pointer",fontSize:m.typography.size.sm,lineHeight:m.typography.bodySmall.lineHeight,backgroundColor:m.colors.background.secondary,color:m.colors.text.primary,whiteSpace:"nowrap",textShadow:"none",padding:m.spacing(.5),borderRadius:m.shape.radius.default,border:"none",marginRight:m.spacing(1),marginBottom:m.spacing(.5)}),loading:(0,n.css)({fontWeight:m.typography.fontWeightMedium,backgroundColor:m.colors.primary.shade,color:m.colors.text.primary,[m.transitions.handleMotion("no-preference","reduce")]:{animation:"pulse 3s ease-out 0s infinite normal forwards"},"@keyframes pulse":{"0%":{color:m.colors.text.primary},"50%":{color:m.colors.text.secondary},"100%":{color:m.colors.text.disabled}}}),active:(0,n.css)({fontWeight:m.typography.fontWeightMedium,backgroundColor:m.colors.primary.main,color:m.colors.primary.contrastText}),matchHighLight:(0,n.css)({background:"inherit",color:m.components.textHighlight.text,backgroundColor:m.components.textHighlight.background}),hidden:(0,n.css)({opacity:.6,cursor:"default",border:"1px solid transparent"}),hover:(0,n.css)({"&:hover":{opacity:.85,cursor:"pointer"}})})},55852:(Q,I,e)=>{"use strict";e.d(I,{$n:()=>s,Ez:()=>p,Jt:()=>u,U_:()=>c,hs:()=>b,my:()=>y,z9:()=>h});var n=e(32196),a=e(96540),o=e(40845),r=e(16797),i=e(87266),f=e(14578),d=e(56034);const l=null,m=null,s=a.forwardRef(({variant:v="primary",size:D="md",fill:E="solid",icon:S,fullWidth:T,children:M,className:A,type:x="button",tooltip:C,disabled:O,tooltipPlacement:R,onClick:L,...N},F)=>{const K=(0,o.$j)(),B=b({theme:K,size:D,variant:v,fill:E,fullWidth:T,iconOnly:!M}),w=(0,n.cx)(B.button,{[B.disabled]:O},A),U=!!C,W=a.createElement("button",{className:w,type:x,onClick:O?void 0:L,...N,"aria-disabled":U&&O,disabled:!U&&O,ref:C?void 0:F},a.createElement(u,{icon:S,size:D,className:B.icon}),M&&a.createElement("span",{className:B.content},M));return C?a.createElement(d.m,{ref:F,content:C,placement:R},W):W});s.displayName="Button";const h=a.forwardRef(({variant:v="primary",size:D="md",fill:E="solid",icon:S,fullWidth:T,children:M,className:A,onBlur:x,onFocus:C,disabled:O,tooltip:R,tooltipPlacement:L,...N},F)=>{const K=(0,o.$j)(),B=b({theme:K,fullWidth:T,size:D,variant:v,fill:E,iconOnly:!M}),w=(0,n.cx)(B.button,{[(0,n.css)(B.disabled,{pointerEvents:"none"})]:O},A),U=a.createElement("a",{className:w,...N,tabIndex:O?-1:0,"aria-disabled":O,ref:R?void 0:F},a.createElement(u,{icon:S,size:D,className:B.icon}),M&&a.createElement("span",{className:B.content},M));return R?a.createElement(d.m,{ref:F,content:R,placement:L},U):U});h.displayName="LinkButton";const u=({icon:v,size:D,className:E,iconType:S})=>v?a.isValidElement(v)?a.cloneElement(v,{className:E,size:D}):a.createElement(f.I,{name:v,size:D,className:E,type:S}):null,b=v=>{const{theme:D,variant:E,fill:S="solid",size:T,iconOnly:M,fullWidth:A}=v,{height:x,padding:C,fontSize:O}=(0,i.SM)(T,D),R=c(D,E,S),L=P(D,E,S),N=(0,r.getFocusStyles)(D),F=D.spacing.gridSize*C-1;return{button:(0,n.css)({label:"button",display:"inline-flex",alignItems:"center",fontSize:O,fontWeight:D.typography.fontWeightMedium,fontFamily:D.typography.fontFamily,padding:`0 ${F}px`,height:D.spacing(x),lineHeight:`${D.spacing.gridSize*x-2}px`,verticalAlign:"middle",cursor:"pointer",borderRadius:D.shape.radius.default,"&:focus":N,"&:focus-visible":N,"&:focus:not(:focus-visible)":(0,r.getMouseFocusStyles)(D),...A&&{flexGrow:1,justifyContent:"center"},...R,":disabled":L,"&[disabled]":L}),disabled:(0,n.css)(L,{"&:hover":(0,n.css)(L)}),img:(0,n.css)({width:"16px",height:"16px",margin:D.spacing(0,1,0,.5)}),icon:M?(0,n.css)({marginRight:D.spacing(-C/2),marginLeft:D.spacing(-C/2)}):(0,n.css)({marginRight:D.spacing(C/2)}),content:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",whiteSpace:"nowrap",overflow:"hidden",height:"100%"})}};function g(v,D,E){let S=D.border,T="transparent",M="transparent";return D.name==="secondary"&&(T=D.border,M=v.colors.emphasize(D.border,.25),S=v.colors.border.strong),E==="outline"?{background:"transparent",color:D.text,border:`1px solid ${S}`,transition:v.transitions.create(["background-color","border-color","color"],{duration:v.transitions.duration.short}),"&:hover":{background:D.transparent,borderColor:v.colors.emphasize(S,.25),color:D.text}}:E==="text"?{background:"transparent",color:D.text,border:"1px solid transparent",transition:v.transitions.create(["background-color","color"],{duration:v.transitions.duration.short}),"&:focus":{outline:"none",textDecoration:"none"},"&:hover":{background:D.transparent,textDecoration:"none"}}:{background:D.main,color:D.contrastText,border:`1px solid ${T}`,transition:v.transitions.create(["background-color","box-shadow","border-color","color"],{duration:v.transitions.duration.short}),"&:hover":{background:D.shade,color:D.contrastText,boxShadow:v.shadows.z1,borderColor:M}}}function P(v,D,E){const S={cursor:"not-allowed",boxShadow:"none",color:v.colors.text.disabled,transition:"none"};return E==="text"?{...S,background:"transparent",border:"1px solid transparent"}:E==="outline"?{...S,background:"transparent",border:`1px solid ${v.colors.border.weak}`}:{...S,background:v.colors.action.disabledBackground,border:"1px solid transparent"}}function c(v,D,E){switch(D){case"secondary":return g(v,v.colors.secondary,E);case"destructive":return g(v,v.colors.error,E);case"success":return g(v,v.colors.success,E);case"primary":default:return g(v,v.colors.primary,E)}}const y=v=>(0,n.css)({background:"transparent",color:v.colors.text.primary,border:"none",padding:0}),p=v=>(0,n.css)({background:"transparent",border:"none",padding:0,fontFamily:"inherit",color:"inherit",height:"100%","&:hover":{background:"transparent",color:"inherit"}})},19727:(Q,I,e)=>{"use strict";e.d(I,{e:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=(0,a.forwardRef)(({className:f,children:d,...l},m)=>{const s=(0,o.of)(i);return a.createElement("div",{ref:m,className:(0,n.cx)("button-group",s.wrapper,f),...l},d)});r.displayName="ButtonGroup";const i=f=>({wrapper:(0,n.css)({display:"flex","> .button-group:not(:first-child) > button, > button:not(:first-child)":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"> .button-group:not(:last-child) > button, > button:not(:last-child)":{borderTopRightRadius:0,borderBottomRightRadius:0,borderRightWidth:0}})})},61458:(Q,I,e)=>{"use strict";e.d(I,{V:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=({className:f,children:d})=>{const l=(0,o.of)(i);return a.createElement("div",{className:(0,n.cx)(l,f)},d)},i=()=>(0,n.css)({display:"flex",button:{flexGrow:1,justifyContent:"center"},"> *":{flexGrow:1},label:{flexGrow:1,textAlign:"center"}})},32012:(Q,I,e)=>{"use strict";e.d(I,{H:()=>m});var n=e(32196),a=e(48470),o=e(96540),r=e(40845),i=e(55852),f=e(58898),d=e(30958),l=e(14578);const m=h=>{const{onChange:u,className:b,loadData:g,icon:P,buttonProps:c,hideDownIcon:y,variant:p,disabled:v,...D}=h,E=(0,r.of)(s),S=(0,r.of)(d.T);let T=h.children;return y||(T=[h.children,o.createElement(l.I,{key:"down-icon",name:"angle-down",className:E.icons.right})]),o.createElement(a.A,{onChange:(0,f.k)(u),loadData:(0,f.W)(g),dropdownClassName:(0,n.cx)(S.dropdown,E.popup),...D,expandIcon:null},o.createElement(i.$n,{icon:P,disabled:v,variant:p,...c??{}},T))};m.displayName="ButtonCascader";const s=h=>({popup:(0,n.css)({label:"popup",zIndex:h.zIndex.dropdown}),icons:{right:(0,n.css)({margin:"1px 0 0 4px"}),left:(0,n.css)({margin:"-1px 4px 0 0"})}})},76442:(Q,I,e)=>{"use strict";e.d(I,{c:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=({message:f,callToActionElement:d,footer:l,className:m})=>{const s=(0,o.of)(i);return a.createElement("div",{className:(0,n.cx)([s.wrapper,m])},f&&a.createElement("div",{className:s.message},f),d,l&&a.createElement("div",{className:s.footer},l))},i=f=>({wrapper:(0,n.css)({label:"call-to-action-card",background:f.colors.background.secondary,borderRadius:f.shape.radius.default,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,padding:f.spacing(3),[f.breakpoints.down("sm")]:{padding:f.spacing(3,1)}}),message:(0,n.css)({marginBottom:f.spacing(3),fontStyle:"italic"}),footer:(0,n.css)({marginTop:f.spacing(3)})})},10860:(Q,I,e)=>{"use strict";e.d(I,{H:()=>S,Z:()=>d});var n=e(32196),a=e(96540),o=e(40845),r=e(16797),i=e(81507);const f=a.createContext(null),d=({disabled:T,href:M,onClick:A,children:x,isSelected:C,isCompact:O,className:R,...L})=>{const N=(0,a.useMemo)(()=>a.Children.toArray(x).some(w=>a.isValidElement(w)&&w.type===l),[x]),F=T||!A&&!M,K=A&&!T?A:void 0,B=(0,o.of)(i.i,T,F,C,O);return a.createElement(i.Q,{disableEvents:T,disableHover:F,isSelected:C,className:(0,n.cx)(B.container,R),...L},a.createElement(f.Provider,{value:{href:M,onClick:K,disabled:T,isSelected:C}},!N&&a.createElement(l,null),x))},l=({children:T,className:M,"aria-label":A})=>{const x=(0,a.useContext)(f),C=(0,o.of)(m),{href:O,onClick:R,isSelected:L}=x??{href:void 0,onClick:void 0,isSelected:void 0};return a.createElement("h2",{className:(0,n.cx)(C.heading,M)},O?a.createElement("a",{href:O,className:C.linkHack,"aria-label":A,onClick:R},T):R?a.createElement("button",{onClick:R,className:C.linkHack,"aria-label":A,type:"button"},T):a.createElement(a.Fragment,null,T),L!==void 0&&a.createElement("input",{"aria-label":"option",type:"radio",checked:L,readOnly:!0}))};l.displayName="Heading";const m=T=>({heading:(0,n.css)({gridArea:"Heading",justifySelf:"start",display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:0,fontSize:T.typography.size.md,letterSpacing:"inherit",lineHeight:T.typography.body.lineHeight,color:T.colors.text.primary,fontWeight:T.typography.fontWeightMedium,"& input[readonly]":{cursor:"inherit"}}),linkHack:(0,n.css)({all:"unset","&::after":{position:"absolute",content:'""',top:0,bottom:0,left:0,right:0,borderRadius:T.shape.radius.default},"&:focus-visible":{outline:"none",outlineOffset:0,boxShadow:"none","&::after":{...(0,r.getFocusStyles)(T),zIndex:1}}})}),s=({children:T,className:M})=>{const A=(0,o.of)(h);return a.createElement("div",{className:(0,n.cx)(A.tagList,M)},T)};s.displayName="Tags";const h=T=>({tagList:(0,n.css)({position:"relative",gridArea:"Tags",alignSelf:"center"})}),u=({children:T,className:M})=>{const A=(0,o.of)(b);return a.createElement("p",{className:(0,n.cx)(A.description,M)},T)};u.displayName="Description";const b=T=>({description:(0,n.css)({width:"100%",gridArea:"Description",margin:T.spacing(1,0,0),color:T.colors.text.secondary,lineHeight:T.typography.body.lineHeight})}),g=({children:T,align:M="start",className:A})=>{const x=(0,o.of)(P);return a.createElement("div",{className:(0,n.cx)(x.media,A,(0,n.css)({alignSelf:M}))},T)};g.displayName="Figure";const P=T=>({media:(0,n.css)({position:"relative",gridArea:"Figure",marginRight:T.spacing(2),width:"40px","> img":{width:"100%"},"&:empty":{display:"none"}})}),c=(0,a.memo)(({children:T,className:M,separator:A="|"})=>{const x=(0,o.of)(y);let C=T;const O=a.Children.toArray(T).filter(Boolean);return O.length?(C=O.map((R,L)=>a.createElement("div",{key:`element_${L}`,className:x.metadataItem},R)),O.length>1&&A&&(C=O.reduce((R,L,N)=>[R,a.createElement("span",{key:`separator_${N}`,className:x.separator},A),L])),a.createElement("div",{className:(0,n.cx)(x.metadata,M)},C)):null});c.displayName="Meta";const y=T=>({metadata:(0,n.css)({gridArea:"Meta",display:"flex",alignItems:"center",width:"100%",fontSize:T.typography.size.sm,color:T.colors.text.secondary,margin:T.spacing(.5,0,0),lineHeight:T.typography.bodySmall.lineHeight,overflowWrap:"anywhere"}),metadataItem:(0,n.css)({zIndex:0}),separator:(0,n.css)({margin:`0 ${T.spacing(1)}`})}),p=({children:T,disabled:M,variant:A,className:x})=>{const C=(0,o.of)(v),R=(0,a.useContext)(f)?.disabled||M,L=A==="primary"?C.actions:C.secondaryActions;return a.createElement("div",{className:(0,n.cx)(L,x)},a.Children.map(T,N=>a.isValidElement(N)?(0,a.cloneElement)(N,{disabled:R,...N.props}):null))},v=T=>({actions:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:T.spacing(1),gridArea:"Actions",marginTop:T.spacing(2)}),secondaryActions:(0,n.css)({alignSelf:"center",color:T.colors.text.secondary,display:"flex",flexDirection:"row",flexWrap:"wrap",gap:T.spacing(1),gridArea:"Secondary",marginTop:T.spacing(2)})}),D=({children:T,disabled:M,className:A})=>a.createElement(p,{variant:"primary",disabled:M,className:A},T);D.displayName="Actions";const E=({children:T,disabled:M,className:A})=>a.createElement(p,{variant:"secondary",disabled:M,className:A},T);E.displayName="SecondaryActions";const S=T=>({inner:(0,n.css)({display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",flexWrap:"wrap"}),...m(T),...y(T),...b(T),...P(T),...v(T),...h(T)});d.Heading=l,d.Tags=s,d.Figure=g,d.Meta=c,d.Actions=D,d.SecondaryActions=E,d.Description=u},81507:(Q,I,e)=>{"use strict";e.d(I,{Q:()=>d,i:()=>l});var n=e(32196),a=e(96540),o=e(40845),r=e(16797);const i=({children:m,href:s})=>{const{inner:h}=(0,o.of)(f);return s?a.createElement("a",{className:h,href:s},m):a.createElement(a.Fragment,null,m)},f=m=>({inner:(0,n.css)({display:"flex",width:"100%",padding:m.spacing(2)})}),d=({children:m,disableEvents:s,disableHover:h,isSelected:u,className:b,href:g,...P})=>{const{oldContainer:c}=(0,o.of)(l,s,h,u);return a.createElement("div",{...P,className:(0,n.cx)(c,b)},a.createElement(i,{href:g},m))},l=(m,s=!1,h=!1,u,b)=>{const g=u!==void 0;return{container:(0,n.css)({display:"grid",position:"relative",gridTemplateColumns:"auto 1fr auto",gridTemplateRows:"1fr auto auto auto",gridAutoColumns:"1fr",gridAutoFlow:"row",gridTemplateAreas:`
        "Figure Heading Tags"
        "Figure Meta Tags"
        "Figure Description Tags"
        "Figure Actions Secondary"`,width:"100%",padding:m.spacing(b?1:2),background:m.colors.background.secondary,borderRadius:m.shape.radius.default,marginBottom:"8px",pointerEvents:s?"none":"auto",[m.transitions.handleMotion("no-preference","reduce")]:{transition:m.transitions.create(["background-color","box-shadow","border-color","color"],{duration:m.transitions.duration.short})},...!h&&{"&:hover":{background:m.colors.emphasize(m.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":r.getFocusStyles(m)},...g&&{cursor:"pointer"},...u&&{outline:`solid 2px ${m.colors.primary.border}`}}),oldContainer:(0,n.css)({display:"flex",width:"100%",background:m.colors.background.secondary,borderRadius:m.shape.radius.default,position:"relative",pointerEvents:s?"none":"auto",marginBottom:m.spacing(1),[m.transitions.handleMotion("no-preference","reduce")]:{transition:m.transitions.create(["background-color","box-shadow","border-color","color"],{duration:m.transitions.duration.short})},...!h&&{"&:hover":{background:m.colors.emphasize(m.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":r.getFocusStyles(m)}})}}},3988:(Q,I,e)=>{"use strict";e.d(I,{v:()=>y});var n=e(32196),a=e(47078),o=e.n(a),r=e(48470),i=e(96540),f=e(40845),d=e(14578),l=e(29158),m=e(10354),s=e(67061),h=e(21594),u=e(58898),b=e(30958);const g=(0,n.css)({"&:focus":{outline:"none"}}),P=" / ";class c extends i.PureComponent{constructor(v){super(v),this.flattenOptions=(T,M=[])=>{let A=[];for(const x of T){const C=[...M];C.push(x),!x.items||x.items.length===0?A.push({singleLabel:C[C.length-1].label,label:C.map(O=>O.label).join(this.props.separator||P),value:C.map(O=>O.value)}):A=[...A,...this.flattenOptions(x.items,C)]}return A},this.getSearchableOptions=o()(T=>this.flattenOptions(T)),this.onChange=(T,M)=>{const A=this.props.hideActiveLevelLabel?"":this.props.displayAllSelectedLevels?M.map(C=>C.label).join(this.props.separator||P):M[M.length-1].label,x={rcValue:{value:T,label:A},focusCascade:!0,activeLabel:A,isSearching:!1,inputValue:A};this.setState(x),this.props.onSelect(M[M.length-1].value)},this.onSelect=T=>{const M=T.value||[],A=this.props.displayAllSelectedLevels?T.label:T.singleLabel||"",x={activeLabel:A,inputValue:A,rcValue:{value:M,label:A},isSearching:!1,focusCascade:!1};this.setState(x),this.props.onSelect(M[M.length-1])},this.onCreateOption=T=>{this.setState({activeLabel:T,inputValue:T,rcValue:[],isSearching:!1}),this.props.onSelect(T)},this.onBlur=()=>{this.setState({isSearching:!1,focusCascade:!1}),this.state.activeLabel===""&&this.setState({rcValue:[]}),this.props.onBlur?.()},this.onBlurCascade=()=>{this.setState({focusCascade:!1}),this.props.onBlur?.()},this.onInputKeyDown=T=>{if(["ArrowDown","ArrowUp","Enter","ArrowLeft","ArrowRight"].includes(T.key))return;const{activeLabel:M}=this.state;this.setState({focusCascade:!1,isSearching:!0,inputValue:M})},this.onSelectInputChange=T=>{this.setState({inputValue:T})};const D=this.getSearchableOptions(v.options),{rcValue:E,activeLabel:S}=this.setInitialValue(D,v.initialValue);this.state={isSearching:!1,focusCascade:!1,rcValue:E,activeLabel:S,inputValue:""}}static{this.defaultProps={changeOnSelect:!0}}setInitialValue(v,D){if(!D)return{rcValue:[],activeLabel:""};for(const E of v){const S=E.value||[];if(S[S.length-1]===D)return{rcValue:S,activeLabel:this.props.displayAllSelectedLevels?E.label:E.singleLabel||""}}return this.props.allowCustomValue?{rcValue:[],activeLabel:D}:{rcValue:[],activeLabel:""}}render(){const{allowCustomValue:v,formatCreateLabel:D,placeholder:E,width:S,changeOnSelect:T,options:M,disabled:A,id:x,isClearable:C,theme:O}=this.props,{focusCascade:R,isSearching:L,rcValue:N,activeLabel:F,inputValue:K}=this.state,B=this.getSearchableOptions(M),w=(0,b.T)(O);return i.createElement("div",null,L?i.createElement(h.l6,{allowCustomValue:v,placeholder:E,autoFocus:!R,onChange:this.onSelect,onBlur:this.onBlur,options:B,onCreateOption:this.onCreateOption,formatCreateLabel:D,width:S,onInputChange:this.onSelectInputChange,disabled:A,inputValue:K,inputId:x}):i.createElement(r.A,{onChange:(0,u.k)(this.onChange),options:M,changeOnSelect:T,value:N.value,fieldNames:{label:"label",value:"value",children:"items"},expandIcon:null,open:this.props.alwaysOpen,disabled:A,dropdownClassName:w.dropdown},i.createElement("div",{className:g},i.createElement(m.p,{autoFocus:this.props.autoFocus,width:S,placeholder:E,onBlur:this.onBlurCascade,value:F,onKeyDown:this.onInputKeyDown,onChange:()=>{},suffix:i.createElement(s.B,{gap:.5},C&&F!==""&&i.createElement(l.K,{name:"times","aria-label":"Clear selection",onClick:U=>{U.preventDefault(),U.stopPropagation(),this.setState({rcValue:[],activeLabel:"",inputValue:""}),this.props.onSelect("")}}),i.createElement(d.I,{name:R?"angle-up":"angle-down"})),disabled:A,id:x}))))}}const y=(0,f.cV)(c)},58898:(Q,I,e)=>{"use strict";e.d(I,{W:()=>a,k:()=>n});const n=i=>(f,d)=>{i&&i(f.map(l=>String(l)),o(d))},a=i=>f=>{i&&i(o(f))},o=i=>i.map(r),r=i=>{const f=i.value?String(i.value):"";return{value:f,label:typeof i.label=="string"?i.label:f}}},30958:(Q,I,e)=>{"use strict";e.d(I,{T:()=>f});var n=e(32196);const a=(0,n.keyframes)({"0%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"}}),o=(0,n.keyframes)({"0%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"}}),r=(0,n.keyframes)({"0%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"}}),i=(0,n.keyframes)({"0%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"}}),f=d=>({dropdown:(0,n.css)({"&.rc-cascader-dropdown":{position:"absolute",zIndex:9999,"&-hidden":{display:"none"}},".rc-cascader":{"&-menus":{overflow:"hidden",background:d.colors.background.canvas,border:`1px solid ${d.colors.border.weak}`,borderRadius:d.shape.radius.default,boxShadow:d.shadows.z3,whiteSpace:"nowrap","&.slide-up-enter, &.slide-up-appear":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:0,animationTimingFunction:"cubic-bezier(0.08, 0.82, 0.17, 1)",animationPlayState:"paused"},"&.slide-up-enter.slide-up-enter-active.rc-cascader-menus-placement, &.slide-up-appear.slide-up-appear-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:a,animationPlayState:"running"},"&-topLeft":{animationName:r,animationPlayState:"running"}},"&.slide-up-leave":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:1,animationTimingFunction:"cubic-bezier(0.6, 0.04, 0.98, 0.34)",animationPlayState:"paused","&.slide-up-leave-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:o,animationPlayState:"running"},"&-topLeft":{animationName:i,animationPlayState:"running"}}}},"&-menu":{display:"inline-block",maxWidth:"50vw",height:"192px",listStyle:"none",margin:0,padding:0,borderRight:`1px solid ${d.colors.border.weak}`,overflow:"auto","&:last-child":{borderRight:0},"&-item":{height:d.spacing(4),lineHeight:d.spacing(4),padding:d.spacing(0,4,0,2),cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",transition:"all 0.3s ease",position:"relative","&:hover":{background:d.colors.action.hover},"&-disabled":{cursor:"not-allowed",color:d.colors.text.disabled,"&:hover":{background:"transparent"},"&:after":{position:"absolute",right:"12px",content:"'loading'",color:d.colors.text.disabled,fontStyle:"italic"}},"&-active":{color:d.colors.text.maxContrast,background:d.colors.background.secondary,"&:hover":{background:d.colors.action.hover}},"&-expand":{position:"relative","&:after":{background:d.colors.background.secondary,content:"''",height:d.spacing(3),mask:"url(../img/icons/unicons/angle-right.svg)",maskType:"luminance",position:"absolute",right:0,top:d.spacing(.5),width:d.spacing(3)}}}}}})})},8866:(Q,I,e)=>{"use strict";e.d(I,{N:()=>a});var n=e(96540);class a extends n.PureComponent{constructor(){super(...arguments),this.myRef=(0,n.createRef)(),this.state={hasEventListener:!1},this.onOutsideClick=r=>{const i=this.myRef.current;(!i||r.target instanceof Node&&!i.contains(r.target))&&this.props.onClick()}}static{this.defaultProps={includeButtonPress:!0,parent:typeof window<"u"?window:void 0,useCapture:!1}}componentDidMount(){this.props.parent.addEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.addEventListener("keyup",this.onOutsideClick,this.props.useCapture)}componentWillUnmount(){this.props.parent.removeEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.removeEventListener("keyup",this.onOutsideClick,this.props.useCapture)}render(){return n.createElement("div",{ref:this.myRef},this.props.children)}}},10534:(Q,I,e)=>{"use strict";e.d(I,{b:()=>m});var n=e(32196),a=e(96540),o=e(76412),r=e(40845),i=e(55852),f=e(14578),d=e(32982);const l=2*1e3;function m({onClipboardCopy:u,onClipboardError:b,children:g,getText:P,icon:c,variant:y,...p}){const v=(0,r.of)(h),[D,E]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let M;return D&&(M=setTimeout(()=>{E(!1)},l)),()=>{window.clearTimeout(M)}},[D]);const S=(0,a.useRef)(null),T=(0,a.useCallback)(async()=>{const M=P();try{await s(M,S),E(!0),u?.(M)}catch(A){b?.(M,A)}},[P,u,b]);return a.createElement(a.Fragment,null,D&&a.createElement(d.r,{placement:"top",referenceElement:S.current},a.createElement(o.x,{i18nKey:"clipboard-button.inline-toast.success"},"Copied")),a.createElement(i.$n,{onClick:T,icon:c,variant:D?"success":y,"aria-label":D?"Copied":void 0,...p,className:(0,n.cx)(v.button,D&&v.successButton,p.className),ref:S},g,D&&a.createElement("div",{className:v.successOverlay},a.createElement(f.I,{name:"check"}))))}const s=async(u,b)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(u);{const g=document.createElement("textarea");b.current?.appendChild(g),g.value=u,g.focus(),g.select(),document.execCommand("copy"),g.remove()}},h=u=>({button:(0,n.css)({position:"relative"}),successButton:(0,n.css)({"> *":(0,n.css)({visibility:"hidden"})}),successOverlay:(0,n.css)({position:"absolute",top:0,bottom:0,right:0,left:0,visibility:"visible"})})},57418:(Q,I,e)=>{"use strict";e.d(I,{M:()=>m});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(40845),f=e(16797),d=e(14578),l=e(62930);const m=({label:h,isOpen:u,onToggle:b,className:g,contentClassName:P,children:c,labelId:y,loading:p=!1,headerDataTestId:v,contentDataTestId:D})=>{const[E,S]=(0,r.useState)(u),T=(0,i.of)(s),M=C=>{C.target instanceof HTMLElement&&C.target.tagName==="A"||(C.preventDefault(),C.stopPropagation(),b?.(!E),S(!E))},{current:A}=(0,r.useRef)((0,a.uniqueId)()),x=y??`collapse-label-${A}`;return r.createElement(r.Fragment,null,r.createElement("div",{onClick:M,className:(0,n.cx)(T.header,g)},r.createElement("button",{type:"button",id:`collapse-button-${A}`,className:T.button,onClick:M,"aria-expanded":E&&!p,"aria-controls":`collapse-content-${A}`,"aria-labelledby":x},p?r.createElement(l.y,{className:T.spinner}):r.createElement(d.I,{name:E?"angle-up":"angle-down",className:T.icon})),r.createElement("div",{className:T.label,id:`collapse-label-${A}`,"data-testid":v},h)),E&&r.createElement("div",{id:`collapse-content-${A}`,className:(0,n.cx)(T.content,P),"data-testid":D},c))},s=h=>({header:(0,n.css)({display:"flex",cursor:"pointer",boxSizing:"border-box",flexDirection:"row-reverse",position:"relative",justifyContent:"space-between",fontSize:h.typography.size.lg,padding:`${h.spacing(.5)} 0`,"&:focus-within":(0,f.getFocusStyles)(h)}),button:(0,n.css)({all:"unset","&:focus-visible":{outline:"none",outlineOffset:"unset",transition:"none",boxShadow:"none"}}),icon:(0,n.css)({color:h.colors.text.secondary}),content:(0,n.css)({padding:`${h.spacing(2)} 0`}),spinner:(0,n.css)({display:"flex",alignItems:"center",width:h.spacing(2)}),label:(0,n.css)({display:"flex"})})},82762:(Q,I,e)=>{"use strict";e.d(I,{S:()=>l,a:()=>d});var n=e(32196),a=e(96540),o=e(40845),r=e(55852),i=e(14578);const f=m=>({collapse:(0,n.css)({label:"collapse",marginBottom:m.spacing(1),backgroundColor:m.colors.background.primary,border:`1px solid ${m.colors.border.weak}`,position:"relative",borderRadius:m.shape.radius.default,width:"100%",display:"flex",flexDirection:"column",flex:"1 1 0"}),collapseBody:(0,n.css)({label:"collapse__body",padding:m.spacing(m.components.panel.padding),paddingTop:0,flex:1,overflow:"hidden",display:"flex",flexDirection:"column"}),bodyContentWrapper:(0,n.css)({label:"bodyContentWrapper",flex:1,overflow:"hidden"}),loader:(0,n.css)({label:"collapse__loader",height:"2px",position:"relative",overflow:"hidden",background:"none",margin:m.spacing(.5)}),loaderActive:(0,n.css)({label:"collapse__loader_active","&:after":{content:"' '",display:"block",width:"25%",top:0,height:"250%",position:"absolute",animation:"loader 2s cubic-bezier(0.17, 0.67, 0.83, 0.67) 500ms",animationIterationCount:100,left:"-25%",background:m.colors.primary.main},"@keyframes loader":{from:{left:"-25%",opacity:.1},to:{left:"100%",opacity:1}}}),header:(0,n.css)({label:"collapse__header",padding:m.spacing(1,2,1,2),display:"flex"}),headerCollapsed:(0,n.css)({label:"collapse__header--collapsed",padding:m.spacing(1,2,1,2)}),headerLabel:(0,n.css)({label:"collapse__header-label",fontWeight:m.typography.fontWeightMedium,marginRight:m.spacing(1),fontSize:m.typography.size.md,display:"flex",flex:"0 0 100%"}),icon:(0,n.css)({label:"collapse__icon",margin:m.spacing(.25,1,0,-1)})}),d=({isOpen:m,onToggle:s,...h})=>{const[u,b]=(0,a.useState)(m);return a.createElement(l,{isOpen:u,collapsible:!0,...h,onToggle:()=>{b(!u),s&&s(!u)}})},l=({isOpen:m,label:s,loading:h,collapsible:u,onToggle:b,className:g,children:P})=>{const c=(0,o.of)(r.my),y=(0,o.of)(f),p=()=>{b&&b(!m)},v=(0,n.cx)([y.collapse,g]),D=h?(0,n.cx)([y.loader,y.loaderActive]):(0,n.cx)([y.loader]),E=u?(0,n.cx)([y.header]):(0,n.cx)([y.headerCollapsed]);return a.createElement("div",{className:v},a.createElement("button",{type:"button",className:(0,n.cx)(c,E),onClick:p},u&&a.createElement(i.I,{className:y.icon,name:m?"angle-down":"angle-right"}),a.createElement("div",{className:(0,n.cx)([y.headerLabel])},s)),m&&a.createElement("div",{className:(0,n.cx)([y.collapseBody])},a.createElement("div",{className:D}),a.createElement("div",{className:y.bodyContentWrapper},P)))};l.displayName="Collapse"},36314:(Q,I,e)=>{"use strict";e.d(I,{A:()=>m});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(84140),f=e(40845),d=e(10354);const l=(0,r.forwardRef)(({color:u,onChange:b,isClearable:g=!1,onClick:P,onBlur:c,disabled:y,buttonAriaLabel:p,...v},D)=>{const[E,S]=(0,r.useState)(u),[T,M]=(0,r.useState)(u),A=(0,r.useMemo)(()=>(0,a.debounce)(b,100),[]);(0,r.useEffect)(()=>{const O=(0,i.A)(u);O.isValid()&&u!==T&&(S(O.toString()),M(u))},[u,T]);const x=O=>{const{value:R}=O.currentTarget;if(S(R),R===""&&g){A(R);return}const L=(0,i.A)(R);L.isValid()&&A(L.toString())},C=O=>{(0,i.A)(E).isValid()||S(u),c?.(O)};return r.createElement(d.p,{...v,value:E,onChange:x,disabled:y,onClick:P,onBlur:C,addonBefore:r.createElement(s,{onClick:P,ariaLabel:p,disabled:y,color:u}),ref:D})});l.displayName="ColorInput";const m=l,s=({color:u,onClick:b,disabled:g,ariaLabel:P})=>{const c=(0,f.of)(h);return r.createElement("button",{type:"button",onClick:b,"aria-label":P,disabled:g||!b,className:(0,n.cx)(c,(0,n.css)({backgroundColor:u}))})},h=u=>(0,n.css)({height:"100%",width:`${u.spacing.gridSize*4}px`,borderRadius:`${u.shape.radius.default} 0 0 ${u.shape.radius.default}`,border:`1px solid ${u.colors.border.medium}`})},83598:(Q,I,e)=>{"use strict";e.d(I,{Dp:()=>b,sk:()=>u});var n=e(32196),a=e(96540),o=e(40845),r=e(3911),i=e(40321),f=e(13840),d=e(95868),l=e(70045),m=e(83876),s=e(70104);const h=(P,c="ColorPicker")=>class extends a.Component{constructor(){super(...arguments),this.pickerTriggerRef=(0,a.createRef)()}static{this.displayName=c}render(){const{theme:p,children:v,onChange:D,color:E}=this.props,S=g(p),T=a.createElement(P,{...this.props,children:null,onChange:D});return a.createElement(d.I,{content:T,hideAfter:300},(M,A,x)=>a.createElement(a.Fragment,null,this.pickerTriggerRef.current&&a.createElement(f.A,{...x,referenceElement:this.pickerTriggerRef.current,wrapperClassName:S.colorPicker,onMouseLeave:A,onMouseEnter:M,onKeyDown:C=>(0,i.Q)(C,A)}),v?v({ref:this.pickerTriggerRef,showColorPicker:M,hideColorPicker:A}):a.createElement(m.q,{ref:this.pickerTriggerRef,onClick:M,onMouseLeave:A,color:p.visualization.getColorByName(E||"#000000"),"aria-label":E})))}},u=(0,o.cV)(h(l.$,"ColorPicker")),b=(0,o.cV)(h(s.o,"SeriesColorPicker")),g=(0,r.N)(P=>({colorPicker:(0,n.css)({position:"absolute",zIndex:P.zIndex.tooltip,color:P.colors.text.primary,maxWidth:"400px",fontSize:P.typography.size.sm})}))},99128:(Q,I,e)=>{"use strict";e.d(I,{i:()=>s});var n=e(32196),a=e(96540),o=e(7612),r=e(65229),i=e(23596),f=e(40845),d=e(8866),l=e(36314),m=e(95151);const s=(0,a.forwardRef)(({value:u="",onChange:b,returnColorAs:g="rgb",...P},c)=>{const[y,p]=(0,a.useState)(u),[v,D]=(0,a.useState)(!1),E=(0,f.$j)(),S=(0,f.of)(h),T=(0,f.of)(m.$);return(0,r.A)(M=>{if(M===u)return;if(!M){b("");return}const A=E.visualization.getColorByName(M);b(g==="rgb"?i.asRgbString(A):i.asHexString(A))},500,[y]),a.createElement(d.N,{onClick:()=>D(!1)},a.createElement("div",{className:S.wrapper},v&&!P.disabled&&a.createElement(o.p9,{"data-testid":"color-popover",color:y,onChange:p,className:(0,n.cx)(T.root,S.picker)}),a.createElement(l.A,{...P,theme:E,color:y,onChange:p,buttonAriaLabel:"Open color picker",onClick:()=>D(!0),onBlur:()=>D(!1),ref:c,isClearable:!0})))});s.displayName="ColorPickerInput";const h=u=>({wrapper:(0,n.css)({position:"relative"}),picker:(0,n.css)({"&.react-colorful":{position:"absolute",width:"100%",zIndex:11,bottom:"36px"}}),inner:(0,n.css)({position:"absolute"})})},70045:(Q,I,e)=>{"use strict";e.d(I,{$:()=>y});var n=e(32196),a=e(85690),o=e(96540),r=e(23596),i=e(40845),f=e(3911),d=e(83876),l=e(2543);function m(v,D){const E=new Array(v.length);for(let S=0;S<v.length;S++){const T=v.length-1-S;E[S]=D(v[T],T,v)}return E}const h=({hue:v,selectedColor:D,onColorSelect:E,...S})=>{const T=(0,l.upperFirst)(v.name),M=(0,i.of)(u);return o.createElement("div",{className:M.colorRow},o.createElement("div",{className:M.colorLabel},T),o.createElement("div",{...S,className:M.swatchRow},m(v.shades,A=>o.createElement(d.q,{key:A.name,"aria-label":A.name,variant:A.primary?d.h.Large:d.h.Small,isSelected:A.name===D,color:A.color,onClick:()=>E(A.name)}))))},u=v=>({colorRow:(0,n.css)({display:"grid",gridTemplateColumns:"25% 1fr",gridColumnGap:v.spacing(2),padding:v.spacing(.5,0),"&:hover":{background:v.colors.background.secondary}}),colorLabel:(0,n.css)({paddingLeft:v.spacing(2),display:"flex",alignItems:"center"}),swatchRow:(0,n.css)({display:"flex",gap:v.spacing(1),alignItems:"center",justifyContent:"space-around",flexDirection:"row"})}),b=({color:v,onChange:D})=>{const E=(0,i.$j)(),S=(0,i.of)(g),T=[];for(const M of E.visualization.hues)T.push(o.createElement(h,{key:M.name,selectedColor:v,hue:M,onColorSelect:D}));return o.createElement(o.Fragment,null,o.createElement("div",{className:S.swatches},T),o.createElement("div",{className:S.extraColors},o.createElement(d.q,{isSelected:v==="transparent",color:"rgba(0,0,0,0)",label:"Transparent",onClick:()=>D("transparent")}),o.createElement(d.q,{isSelected:v==="text",color:E.colors.text.primary,label:"Text color",onClick:()=>D("text")})))},g=v=>({container:(0,n.css)({display:"flex",flexDirection:"column"}),extraColors:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-around",gap:v.spacing(1),padding:v.spacing(1,0)}),swatches:(0,n.css)({display:"grid",flexGrow:1})});var P=e(95151);class c extends o.Component{constructor(D){super(D),this.getTabClassName=E=>{const{activePicker:S}=this.state;return`ColorPickerPopover__tab ${S===E&&"ColorPickerPopover__tab--active"}`},this.handleChange=E=>{const{onChange:S,enableNamedColors:T,theme:M}=this.props;if(T)return S(E);S(r.asHexString(M.visualization.getColorByName(E)))},this.onTabChange=E=>()=>this.setState({activePicker:E}),this.renderPicker=()=>{const{activePicker:E}=this.state,{color:S}=this.props;switch(E){case"spectrum":return o.createElement(P.A,{color:S,onChange:this.handleChange});case"palette":return o.createElement(b,{color:S,onChange:this.handleChange});default:return this.renderCustomPicker(E)}},this.renderCustomPicker=E=>{const{customPickers:S,color:T,theme:M}=this.props;return S?o.createElement(S[E].tabComponent,{color:T,theme:M,onChange:this.handleChange}):null},this.renderCustomPickerTabs=()=>{const{customPickers:E}=this.props;return E?o.createElement(o.Fragment,null,Object.keys(E).map(S=>o.createElement("button",{className:this.getTabClassName(S),onClick:this.onTabChange(S),key:S,type:"button"},E[S].name))):null},this.state={activePicker:"palette"}}render(){const{theme:D}=this.props,E=p(D);return o.createElement(a.n1,{contain:!0,restoreFocus:!0,autoFocus:!0},o.createElement("div",{tabIndex:-1,className:E.colorPickerPopover},o.createElement("div",{className:E.colorPickerPopoverTabs},o.createElement("button",{className:this.getTabClassName("palette"),onClick:this.onTabChange("palette"),type:"button"},"Colors"),o.createElement("button",{className:this.getTabClassName("spectrum"),onClick:this.onTabChange("spectrum"),type:"button"},"Custom"),this.renderCustomPickerTabs()),o.createElement("div",{className:E.colorPickerPopoverContent},this.renderPicker())))}}const y=(0,i.cV)(c);y.displayName="ColorPickerPopover";const p=(0,f.N)(v=>({colorPickerPopover:(0,n.css)({borderRadius:v.shape.radius.default,boxShadow:v.shadows.z3,background:v.colors.background.primary,border:`1px solid ${v.colors.border.weak}`,".ColorPickerPopover__tab":{width:"50%",textAlign:"center",padding:v.spacing(1,0),background:v.colors.background.secondary,color:v.colors.text.secondary,fontSize:v.typography.bodySmall.fontSize,cursor:"pointer",border:"none","&:focus:not(:focus-visible)":{outline:"none",boxShadow:"none"},":focus-visible":{position:"relative"}},".ColorPickerPopover__tab--active":{color:v.colors.text.primary,fontWeight:v.typography.fontWeightMedium,background:v.colors.background.primary}}),colorPickerPopoverContent:(0,n.css)({width:"246px",fontSize:v.typography.bodySmall.fontSize,minHeight:"184px",padding:v.spacing(1),display:"flex",flexDirection:"column"}),colorPickerPopoverTabs:(0,n.css)({display:"flex",width:"100%",borderRadius:`${v.shape.radius.default} ${v.shape.radius.default} 0 0`})}))},83876:(Q,I,e)=>{"use strict";e.d(I,{h:()=>d,q:()=>l});var n=e(32196),a=e(95382),o=e(96540),r=e(84140),i=e(13544),f=e(40845),d=(s=>(s.Small="small",s.Large="large",s))(d||{});const l=o.forwardRef(({color:s,label:h,variant:u="small",isSelected:b,"aria-label":g,...P},c)=>{const y=(0,f.$j)(),{isFocusVisible:p,focusProps:v}=(0,a.o)(),D=m(y,u,s,p,b),E=!!h,S=g||h;return o.createElement("div",{ref:c,className:D.wrapper,"data-testid":i.Tp.components.ColorSwatch.name,...P},E&&o.createElement("span",{className:D.label},h),o.createElement("button",{className:D.swatch,...v,"aria-label":S?`${S} color`:"Pick a color",type:"button"}))}),m=(s,h,u,b,g)=>{const P=(0,r.A)(u),y=h==="small"?"16px":"32px";let p="none";return P.getAlpha()<.1&&(p=`2px solid ${s.colors.border.medium}`),{wrapper:(0,n.css)({display:"flex",alignItems:"center",cursor:"pointer"}),label:(0,n.css)({marginRight:s.spacing(1)}),swatch:(0,n.css)({width:y,height:y,background:`${u}`,border:p,borderRadius:s.shape.radius.circle,outlineOffset:"1px",outline:b?`2px solid  ${s.colors.primary.main}`:"none",boxShadow:g?`inset 0 0 0 2px ${u}, inset 0 0 0 4px ${s.colors.getContrastText(u)}`:"none",[s.transitions.handleMotion("no-preference")]:{transition:s.transitions.create(["transform"],{duration:s.transitions.duration.short})},"&:hover":{transform:"scale(1.1)"},"@media (forced-colors: active)":{forcedColorAdjust:"none"}})}};l.displayName="ColorSwatch"},70104:(Q,I,e)=>{"use strict";e.d(I,{o:()=>f,t:()=>d});var n=e(96540),a=e(40845),o=e(14186),r=e(15292),i=e(70045);const f=l=>{const{yaxis:m,onToggleAxis:s,color:h,...u}=l,b=s?{yaxis:{name:"Y-Axis",tabComponent(){return n.createElement(o.I,{labelWidth:20,label:"Use right y-axis"},n.createElement(r.K,{value:m===2,label:"Use right y-axis",onChange:s}))}}}:void 0;return n.createElement(i.$,{...u,color:h||"#000000",customPickers:b})},d=(0,a.cV)(f)},95151:(Q,I,e)=>{"use strict";e.d(I,{$:()=>s,A:()=>h});var n=e(32196),a=e(96540),o=e(7612),r=e(65229),i=e(84140),f=e(23596),d=e(40845),l=e(36314);const m=({color:u,onChange:b})=>{const[g,P]=(0,a.useState)(u);(0,r.A)(v=>{b(f.asHexString(c.visualization.getColorByName(v)))},500,[g]);const c=(0,d.$j)(),y=(0,d.of)(s),p=(0,a.useMemo)(()=>g.startsWith("rgba")?g:(0,i.A)(c.visualization.getColorByName(u)).toRgbString(),[g,c,u]);return a.createElement("div",{className:y.wrapper},a.createElement(o.p9,{className:y.root,color:p,onChange:P}),a.createElement(l.A,{theme:c,color:p,onChange:P,className:y.colorInput}))},s=u=>({wrapper:(0,n.css)({flexGrow:1}),root:(0,n.css)({"&.react-colorful":{width:"auto"},".react-colorful":{"&__saturation":{borderRadius:`${u.shape.radius.default} ${u.shape.radius.default} 0 0`},"&__alpha":{borderRadius:`0 0 ${u.shape.radius.default} ${u.shape.radius.default}`},"&__alpha, &__hue":{height:u.spacing(2),position:"relative"},"&__pointer":{height:u.spacing(2),width:u.spacing(2)}}}),colorInput:(0,n.css)({marginTop:u.spacing(2)})}),h=m},82702:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(55852);const i=({children:d,className:l,closeOnConfirm:m,confirmText:s="Save",confirmVariant:h="primary",disabled:u=!1,onCancel:b,onClick:g,onConfirm:P,size:c="md"})=>{const y=(0,a.useRef)(null),p=(0,a.useRef)(null),[v,D]=(0,a.useState)(!1),[E,S]=(0,a.useState)(!1),T=(0,o.of)(f);(0,a.useEffect)(()=>{v?(p.current?.focus(),S(!0)):E&&(y.current?.focus(),S(!1))},[E,v]);const M=L=>{L&&L.preventDefault(),D(!0),g?.()},A=L=>{L&&L.preventDefault(),D(!1),y.current?.focus(),b?.()},x=L=>{L&&L.preventDefault(),P?.(),m&&D(!1)},C=(0,n.cx)(l,T.mainButton,{[T.mainButtonHide]:v}),O=(0,n.cx)(T.confirmButton,{[T.confirmButtonHide]:!v}),R=(0,n.cx)(T.confirmButtonContainer,{[T.confirmButtonContainerHide]:!v});return a.createElement("div",{className:T.container},a.createElement("span",{className:C},typeof d=="string"?a.createElement(r.$n,{disabled:u,size:c,fill:"text",onClick:M,ref:y},d):a.cloneElement(d,{disabled:u,onClick:M,ref:y})),a.createElement("div",{className:R},a.createElement("span",{className:O},a.createElement(r.$n,{size:c,variant:h,onClick:x,ref:p},s),a.createElement(r.$n,{size:c,fill:"text",onClick:A},"Cancel"))))};i.displayName="ConfirmButton";const f=d=>({container:(0,n.css)({alignItems:"center",display:"flex",justifyContent:"flex-end",position:"relative"}),mainButton:(0,n.css)({opacity:1,[d.transitions.handleMotion("no-preference")]:{transition:d.transitions.create(["opacity"],{duration:d.transitions.duration.shortest,easing:d.transitions.easing.easeOut})},zIndex:2}),mainButtonHide:(0,n.css)({opacity:0,[d.transitions.handleMotion("no-preference")]:{transition:d.transitions.create(["opacity","visibility"],{duration:d.transitions.duration.shortest,easing:d.transitions.easing.easeIn})},visibility:"hidden",zIndex:0}),confirmButtonContainer:(0,n.css)({overflow:"visible",position:"absolute",pointerEvents:"all",right:0}),confirmButtonContainerHide:(0,n.css)({overflow:"hidden",pointerEvents:"none"}),confirmButton:(0,n.css)({alignItems:"flex-start",background:d.colors.background.primary,display:"flex",opacity:1,transform:"translateX(0)",[d.transitions.handleMotion("no-preference")]:{transition:d.transitions.create(["opacity","transform"],{duration:d.transitions.duration.shortest,easing:d.transitions.easing.easeOut})},zIndex:1}),confirmButtonHide:(0,n.css)({opacity:0,transform:"translateX(100%)",[d.transitions.handleMotion("no-preference")]:{transition:d.transitions.create(["opacity","transform","visibility"],{duration:d.transitions.duration.shortest,easing:d.transitions.easing.easeIn})},visibility:"hidden"})})},91605:(Q,I,e)=>{"use strict";e.d(I,{e:()=>r});var n=e(96540),a=e(55852),o=e(82702);const r=({size:i,disabled:f,onConfirm:d,"aria-label":l,closeOnConfirm:m})=>n.createElement(o.Z,{confirmText:"Delete",confirmVariant:"destructive",size:i||"md",disabled:f,onConfirm:d,closeOnConfirm:m},n.createElement(a.$n,{"aria-label":l,variant:"destructive",icon:"times",size:i||"sm"}))},96374:(Q,I,e)=>{"use strict";e.d(I,{u:()=>h});var n=e(32196),a=e(96540),o=e(49785),r=e(13544),i=e(40845),f=e(55852),d=e(10354),l=e(90613),m=e(67061),s=e(37390);const h=({isOpen:b,title:g,body:P,description:c,confirmText:y,confirmVariant:p="destructive",confirmationText:v,dismissText:D="Cancel",dismissVariant:E="secondary",alternativeText:S,modalClass:T,icon:M="exclamation-triangle",onConfirm:A,onDismiss:x,onAlternative:C,confirmButtonVariant:O="destructive"})=>{const[R,L]=(0,a.useState)(!!v),N=(0,i.of)(u),F=(0,a.useRef)(null),K=U=>{L(v?.toLowerCase().localeCompare(U.currentTarget.value.toLowerCase())!==0)};(0,a.useEffect)(()=>{b&&F.current?.focus()},[b]),(0,a.useEffect)(()=>{b&&L(!!v)},[b,v]);const B=async()=>{L(!0);try{await A()}finally{L(!1)}},{handleSubmit:w}=(0,o.mN)();return a.createElement(s.a,{className:(0,n.cx)(N.modal,T),title:g,icon:M,isOpen:b,onDismiss:x},a.createElement("form",{onSubmit:w(B)},a.createElement("div",{className:N.modalText},P,c?a.createElement("div",{className:N.modalDescription},c):null,v?a.createElement("div",{className:N.modalConfirmationInput},a.createElement(m.B,{alignItems:"flex-start"},a.createElement(l.a,null,a.createElement(d.p,{placeholder:`Type "${v}" to confirm`,onChange:K})))):null),a.createElement(s.a.ButtonRow,null,a.createElement(f.$n,{variant:E,onClick:x,fill:"outline"},D),a.createElement(f.$n,{type:"submit",variant:O,disabled:R,ref:F,"data-testid":r.Tp.pages.ConfirmModal.delete},y),C?a.createElement(f.$n,{variant:"primary",onClick:C},S):null)))},u=b=>({modal:(0,n.css)({width:"500px"}),modalText:(0,n.css)({fontSize:b.typography.h5.fontSize,color:b.colors.text.primary}),modalDescription:(0,n.css)({fontSize:b.typography.body.fontSize}),modalConfirmationInput:(0,n.css)({paddingTop:b.spacing(1)})})},28122:(Q,I,e)=>{"use strict";e.d(I,{t:()=>f});var n=e(96540),a=e(29647),o=e(13544),r=e(38138),i=e(17464);const f=n.memo(({x:d,y:l,onClose:m,focusOnOpen:s=!0,renderMenuItems:h,renderHeader:u})=>{const b=(0,n.useRef)(null),[g,P]=(0,n.useState)({});(0,n.useLayoutEffect)(()=>{const D=b.current;if(D){const E=D.getBoundingClientRect(),S=5,T={right:window.innerWidth<d+E.width,bottom:window.innerHeight<l+E.height+S};P({position:"fixed",left:T.right?d-E.width-S:d-S,top:Math.max(0,T.bottom?l-E.height-S:l+S)})}},[d,l]),(0,a.A)(b,()=>{m?.()});const c=u?.(),y=h?.(),p=D=>{s&&D(0)},v=D=>{D.key==="Escape"&&(D.preventDefault(),D.stopPropagation(),m?.())};return n.createElement(i.ZL,null,n.createElement(r.W,{header:c,ref:b,style:g,ariaLabel:o.Tp.components.Menu.MenuComponent("Context"),onOpen:p,onClick:m,onKeyDown:v},y))});f.displayName="ContextMenu"},51686:(Q,I,e)=>{"use strict";e.d(I,{n:()=>o});var n=e(96540),a=e(28122);const o=({children:r,renderMenuItems:i,focusOnOpen:f=!0})=>{const[d,l]=(0,n.useState)(!1),[m,s]=(0,n.useState)({x:0,y:0});return n.createElement(n.Fragment,null,r({openMenu:h=>{l(!0),s({x:h.pageX,y:h.pageY})}}),d&&n.createElement(a.t,{onClose:()=>l(!1),x:m.x,y:m.y,renderMenuItems:i,focusOnOpen:f}))}},40276:(Q,I,e)=>{"use strict";e.d(I,{E:()=>d,A:()=>l});var n=e(32196),a=e(96540),o=e(62295),r=e(40845);const i=({children:h})=>{const[u,b]=(0,a.useState)(!1),[g,P]=(0,a.useState)(!1),c=(0,a.useRef)(null),y=(0,a.useRef)(null),p=(0,r.of)(f);return(0,a.useEffect)(()=>{const v=new IntersectionObserver(D=>{D.forEach(E=>{E.target===c.current?b(!E.isIntersecting):E.target===y.current&&P(!E.isIntersecting)})});return[c,y].forEach(D=>{D.current&&v.observe(D.current)}),()=>v.disconnect()},[]),a.createElement(a.Fragment,null,a.createElement("div",{className:(0,n.cx)(p.scrollIndicator,p.scrollTopIndicator,{[p.scrollIndicatorVisible]:u})}),a.createElement("div",{className:p.scrollContent},a.createElement("div",{ref:c}),h,a.createElement("div",{ref:y})),a.createElement("div",{className:(0,n.cx)(p.scrollIndicator,p.scrollBottomIndicator,{[p.scrollIndicatorVisible]:g})}))},f=h=>({scrollContent:(0,n.css)({flex:1,position:"relative"}),scrollIndicator:(0,n.css)({height:h.spacing(6),left:0,opacity:0,pointerEvents:"none",position:"absolute",right:0,[h.transitions.handleMotion("no-preference","reduce")]:{transition:h.transitions.create("opacity")},zIndex:1}),scrollTopIndicator:(0,n.css)({background:`linear-gradient(0deg, transparent, ${h.colors.background.canvas})`,top:0}),scrollBottomIndicator:(0,n.css)({background:`linear-gradient(180deg, transparent, ${h.colors.background.canvas})`,bottom:0}),scrollIndicatorVisible:(0,n.css)({opacity:1})}),d=({autoHide:h=!1,autoHideTimeout:u=200,setScrollTop:b,className:g,testId:P,autoHeightMin:c="0",autoHeightMax:y="100%",hideTracksWhenNotNeeded:p=!1,hideHorizontalTrack:v,hideVerticalTrack:D,scrollRefCallback:E,showScrollIndicators:S=!1,updateAfterMountMs:T,scrollTop:M,onScroll:A,children:x,divId:C})=>{const O=(0,a.useRef)(null),R=(0,r.of)(m);(0,a.useEffect)(()=>{O.current&&E&&E(O.current.view)},[O,E]),s(O.current,M),(0,a.useEffect)(()=>{T&&setTimeout(()=>{const W=O.current;W?.update&&W.update()},T)},[T]);function L(W,V,_){return _.style&&V&&(_.style.display="none"),a.createElement("div",{..._,className:W})}const N=(0,a.useCallback)(W=>L("track-horizontal",v,W),[v]),F=(0,a.useCallback)(W=>L("track-vertical",D,W),[D]),K=(0,a.useCallback)(W=>a.createElement("div",{...W,className:"thumb-horizontal"}),[]),B=(0,a.useCallback)(W=>a.createElement("div",{...W,className:"thumb-vertical"}),[]),w=(0,a.useCallback)(W=>(W.style&&W.style.WebkitOverflowScrolling==="touch"&&(W.style.WebkitOverflowScrolling="auto"),a.createElement("div",{...W,className:"scrollbar-view",id:C})),[C]),U=(0,a.useCallback)(()=>{O.current&&b&&b(O.current.getValues())},[b]);return a.createElement(o.Ay,{"data-testid":P,ref:O,className:(0,n.cx)(R.customScrollbar,g,{[R.scrollbarWithScrollIndicators]:S}),onScrollStop:U,autoHeight:!0,autoHide:h,autoHideTimeout:u,hideTracksWhenNotNeeded:p,autoHeightMax:y,autoHeightMin:c,renderTrackHorizontal:N,renderTrackVertical:F,renderThumbHorizontal:K,renderThumbVertical:B,renderView:w,onScroll:A},S?a.createElement(i,null,x):x)},l=d,m=h=>({customScrollbar:(0,n.css)({display:"flex",flexGrow:1,".scrollbar-view":{display:"flex",flexGrow:1,flexDirection:"column"},".track-vertical":{borderRadius:h.shape.borderRadius(2),width:`${h.spacing(1)} !important`,right:0,bottom:h.spacing(.25),top:h.spacing(.25)},".track-horizontal":{borderRadius:h.shape.borderRadius(2),height:`${h.spacing(1)} !important`,right:h.spacing(.25),bottom:h.spacing(.25),left:h.spacing(.25)},".thumb-vertical":{background:h.colors.action.focus,borderRadius:h.shape.borderRadius(2),opacity:0},".thumb-horizontal":{background:h.colors.action.focus,borderRadius:h.shape.borderRadius(2),opacity:0},"&:hover":{".thumb-vertical, .thumb-horizontal":{opacity:1,transition:"opacity 0.3s ease-in-out"}}}),scrollbarWithScrollIndicators:(0,n.css)({".scrollbar-view":{position:"static !important"}})});function s(h,u){(0,a.useEffect)(()=>{h&&u!=null&&h.scrollTop(u)},[u,h])}},14689:(Q,I,e)=>{"use strict";e.d(I,{R:()=>o});var n=e(96540),a=e(55852);function o({link:r,buttonProps:i}){return n.createElement("a",{href:r.href,target:r.target,rel:"noreferrer",onClick:r.onClick?f=>{!(f.ctrlKey||f.metaKey||f.shiftKey)&&r.onClick&&(f.preventDefault(),r.onClick(f))}:void 0},n.createElement(a.$n,{icon:r.target==="_blank"?"external-link-alt":void 0,variant:"primary",size:"sm",...i},r.title))}},64078:(Q,I,e)=>{"use strict";e.d(I,{l:()=>A});var n=e(32196),a=e(34743),o=e(36376),r=e(7315),i=e(28848),f=e.n(i),d=e(96540),l=e(80292),m=e(75226),s=e(29317),h=e(91890),u=e(6709),b=e(41781),g=e(40845),P=e(72307),c=e(40276),y=e(10354),p=e(17464),v=e(43538);class D{getBoundingClientRect(){const O=window.getSelection(),R=O&&O.anchorNode;return R&&R.parentElement?R.parentElement.getBoundingClientRect():{top:0,left:0,bottom:0,right:0,width:0,height:0,x:0,y:0,toJSON:()=>{}}}get clientWidth(){return this.getBoundingClientRect().width}get clientHeight(){return this.getBoundingClientRect().height}}const E=(C,O)=>C-O*Math.floor(C/O),S={builtInVariable:{pattern:/(\${\S+?})/}},T=[(0,b.D)({onlyIn:C=>"type"in C&&C.type==="code_block",getSyntax:()=>"links"},{...f().languages,links:S})],M=C=>({input:(0,y.n)({theme:C,invalid:!1}).input,editor:(0,n.css)({".token.builtInVariable":{color:C.colors.success.text},".token.variable":{color:C.colors.primary.text}}),suggestionsWrapper:(0,n.css)({boxShadow:C.shadows.z2}),wrapperOverrides:(0,n.css)({width:"100%","> .slate-query-field__wrapper":{padding:0,backgroundColor:"transparent",border:"none"}})}),A=(0,d.memo)(({value:C,onChange:O,suggestions:R,placeholder:L="http://your-grafana.com/d/000000010/annotations"})=>{const N=(0,d.useRef)(null),F=(0,g.of)(M),[K,B]=(0,d.useState)(!1),[w,U]=(0,d.useState)(0),[W,V]=(0,d.useState)((0,P.mO)(C)),_=(0,l.A)(W),[H,G]=(0,d.useState)(0),j=[(0,a.cY)(({rects:ie})=>({alignmentAxis:ie.reference.width})),(0,a.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,a.BN)()],{refs:Y,floatingStyles:oe}=(0,o.we)({open:K,placement:"bottom-start",onOpenChange:B,middleware:j,whileElementsMounted:r.ll,strategy:"fixed"}),se=(0,d.useRef)({showingSuggestions:K,suggestions:R,suggestionsIndex:w,linkUrl:W,onChange:O});se.current={showingSuggestions:K,suggestions:R,suggestionsIndex:w,linkUrl:W,onChange:O};const ne=(0,d.useRef)(null);(0,d.useEffect)(()=>{G(x(ne.current,w))},[w]);const ee=d.useCallback((ie,de)=>{if(!se.current.showingSuggestions){if(ie.key==="="||ie.key==="$"||ie.keyCode===32&&ie.ctrlKey){const ue=new D;return Y.setReference(ue),B(!0)}return de()}switch(ie.key){case"Backspace":case"Escape":return B(!1),U(0);case"Enter":return ie.preventDefault(),z(se.current.suggestions[se.current.suggestionsIndex]);case"ArrowDown":case"ArrowUp":ie.preventDefault();const ue=ie.key==="ArrowDown"?1:-1;return U(fe=>E(fe+ue,se.current.suggestions.length));default:return de()}},[]);(0,d.useEffect)(()=>{_&&_.selection.isFocused&&!W.selection.isFocused&&se.current.onChange(m.A.serialize(W))},[W,_]);const Z=d.useCallback(({value:ie})=>{V(ie)},[]),z=(ie,de=N.current)=>{const fe=q()==="$";ie.origin!==h.$0.Template||ie.value===u.c.includeVars?de.insertText(`${fe?"":"$"}{${ie.value}}`):de.insertText(`${fe?"":"$"}{${ie.value}:queryparam}`),V(de.value),B(!1),U(0),se.current.onChange(m.A.serialize(de.value))},q=()=>{const ie=document.getElementById("data-link-input");let de="",ue,fe;return window.getSelection&&(ue=window.getSelection(),ue&&ue.rangeCount>0&&(fe=ue.getRangeAt(0).cloneRange(),fe.collapse(!0),fe.setStart(ie,0),de=fe.toString().slice(-1))),de};return d.createElement("div",{className:F.wrapperOverrides},d.createElement("div",{className:"slate-query-field__wrapper"},d.createElement("div",{id:"data-link-input",className:"slate-query-field"},K&&d.createElement(p.ZL,null,d.createElement("div",{ref:Y.setFloating,style:oe},d.createElement(c.A,{scrollTop:H,autoHeightMax:"300px",setScrollTop:({scrollTop:ie})=>G(ie)},d.createElement(v.k,{activeRef:ne,suggestions:se.current.suggestions,onSuggestionSelect:z,onClose:()=>B(!1),activeIndex:w})))),d.createElement(s.KE,{schema:P.yx,ref:N,placeholder:L,value:se.current.linkUrl,onChange:Z,onKeyDown:(ie,de,ue)=>ee(ie,ue),plugins:T,className:(0,n.cx)(F.editor,F.input,(0,n.css)({padding:"3px 8px"}))}))))});A.displayName="DataLinkInput";function x(C,O){return(C?.clientHeight??0)*O}},43538:(Q,I,e)=>{"use strict";e.d(I,{k:()=>m});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(37151),f=e(40845),d=e(33552);const l=h=>({list:(0,n.css)({borderBottom:`1px solid ${h.colors.border.weak}`,"&:last-child":{border:"none"}}),wrapper:(0,n.css)({background:h.colors.background.primary,width:"250px"}),item:(0,n.css)({background:"none",padding:"2px 8px",userSelect:"none",color:h.colors.text.primary,cursor:"pointer","&:hover":{background:h.colors.action.hover}}),label:(0,n.css)({color:h.colors.text.secondary}),activeItem:(0,n.css)({background:h.colors.background.secondary,"&:hover":{background:h.colors.background.secondary}}),itemValue:(0,n.css)({fontFamily:h.typography.fontFamilyMonospace,fontSize:h.typography.size.sm})}),m=({suggestions:h,...u})=>{const b=(0,r.useRef)(null);(0,i.A)(b,()=>{u.onClose&&u.onClose()});const g=(0,r.useMemo)(()=>(0,a.groupBy)(h,c=>c.origin),[h]),P=(0,f.of)(l);return r.createElement("div",{role:"menu",ref:b,className:P.wrapper},Object.keys(g).map((c,y)=>{const p=y===0?0:Object.keys(g).reduce((v,D,E)=>E>=y?v:v+g[D].length,0);return r.createElement(s,{...u,suggestions:g[c],label:`${(0,a.capitalize)(c)}`,activeIndex:u.activeIndex,activeIndexOffset:p,key:c})}))};m.displayName="DataLinkSuggestions";const s=r.memo(({activeIndex:h,activeIndexOffset:u,label:b,onClose:g,onSuggestionSelect:P,suggestions:c,activeRef:y})=>{const p=(0,f.of)(l);return r.createElement(r.Fragment,null,r.createElement(d.B,{className:p.list,items:c,renderItem:(v,D)=>{const E=D+u===h;return r.createElement("div",{role:"menuitem",tabIndex:0,className:(0,n.cx)(p.item,E&&p.activeItem),ref:E?y:void 0,onClick:()=>{P(v)},title:v.documentation},r.createElement("span",{className:p.itemValue},r.createElement("span",{className:p.label},b)," ",v.label))}}))});s.displayName="DataLinkSuggestionsList"},59796:(Q,I,e)=>{"use strict";e.d(I,{e:()=>l});var n=e(32196),a=e(96540),o=e(13544),r=e(14555),i=e(51686),f=e(59093),d=e(64539);const l=({children:m,links:s,style:h})=>{const u=[{items:(0,r.J)(s),label:"Data links"}],b=u[0].items.length,g=()=>u.map((c,y)=>a.createElement(f.r,{key:`${c.label}${y}`,label:c.label},(c.items||[]).map((p,v)=>a.createElement(d.D,{key:`${c.label}-${y}-${v}}`,url:p.url,label:p.label,target:p.target,icon:p.icon,active:p.active,onClick:p.onClick})))),P=(0,n.css)({cursor:"context-menu"});if(b>1)return a.createElement(i.n,{renderMenuItems:g},({openMenu:c})=>m({openMenu:c,targetClassName:P}));{const c=s()[0];return a.createElement("a",{href:c.href,onClick:c.onClick,target:c.target,title:c.title,style:{...h,overflow:"hidden",display:"flex"},"data-testid":o.Tp.components.DataLinksContextMenu.singleLink},m({}))}}},64919:(Q,I,e)=>{"use strict";e.d(I,{e:()=>v});var n=e(32196),a=e(2543),o=e(96540),r=e(40845),i=e(55852),f=e(37390),d=e(14555),l=e(88575),m=e(10354),s=e(15292),h=e(64078);const u=E=>({listItem:(0,n.css)({marginBottom:E.spacing()}),infoText:(0,n.css)({paddingBottom:E.spacing(2),marginLeft:"66px",color:E.colors.text.secondary})}),b=o.memo(({index:E,value:S,onChange:T,suggestions:M,isLast:A})=>{const x=(0,r.of)(u),C=(L,N)=>{T(E,{...S,url:L},N)},O=L=>{T(E,{...S,title:L.target.value})},R=()=>{T(E,{...S,targetBlank:!S.targetBlank})};return o.createElement("div",{className:x.listItem},o.createElement(l.D,{label:"Title"},o.createElement(m.p,{value:S.title,onChange:O,placeholder:"Show details"})),o.createElement(l.D,{label:"URL",invalid:(0,d.F)(S.url),error:"Data link is an Explore URL in a deprecated format. Please visit the URL to be redirected, and edit this data link to use that URL."},o.createElement(h.l,{value:S.url,onChange:C,suggestions:M})),o.createElement(l.D,{label:"Open in new tab"},o.createElement(s.d,{value:S.targetBlank||!1,onChange:R})),A&&o.createElement("div",{className:x.infoText},"With data links you can reference data variables like series name, labels and values. Type CMD+Space, CTRL+Space, or $ to open variable suggestions."))});b.displayName="DataLinkEditor";const g=({link:E,index:S,getSuggestions:T,onSave:M,onCancel:A})=>{const[x,C]=(0,o.useState)(E);return o.createElement(o.Fragment,null,o.createElement(b,{value:x,index:S,isLast:!1,suggestions:T(),onChange:(O,R)=>{C(R)}}),o.createElement(f.a.ButtonRow,null,o.createElement(i.$n,{variant:"secondary",onClick:()=>A(S),fill:"outline"},"Cancel"),o.createElement(i.$n,{onClick:()=>{M(S,x)}},"Save")))};var P=e(72093),c=e(29158);const y=({link:E,onEdit:S,onRemove:T})=>{const M=(0,r.of)(p),{title:A="",url:x=""}=E,C=A.trim()!=="",O=x.trim()!=="",R=(0,d.F)(x);return o.createElement("div",{className:M.wrapper},o.createElement("div",{className:M.titleWrapper},o.createElement("div",{className:(0,n.cx)(M.url,!O&&M.notConfigured,R&&M.errored)},C?A:"Data link title not provided"),o.createElement("div",{className:M.actionButtons},o.createElement(c.K,{name:"pen",onClick:S,tooltip:"Edit data link title"}),o.createElement(c.K,{name:"times",onClick:T,tooltip:"Remove data link title"}))),o.createElement("div",{className:(0,n.cx)(M.url,!O&&M.notConfigured,R&&M.errored),title:x},O?x:"Data link url not provided"),R&&o.createElement(P.P,null,"Explore data link may not work in the future. Please edit."))},p=E=>({wrapper:(0,n.css)({marginBottom:E.spacing(2),width:"100%","&:last-child":{marginBottom:0},display:"flex",flexDirection:"column"}),titleWrapper:(0,n.css)({label:"data-links-list-item-title",justifyContent:"space-between",display:"flex",width:"100%",alignItems:"center"}),actionButtons:(0,n.css)({marginLeft:E.spacing(1),display:"flex"}),errored:(0,n.css)({color:E.colors.error.text,fontStyle:"italic"}),notConfigured:(0,n.css)({fontStyle:"italic"}),title:(0,n.css)({color:E.colors.text.primary,fontSize:E.typography.size.sm,fontWeight:E.typography.fontWeightMedium}),url:(0,n.css)({color:E.colors.text.secondary,fontSize:E.typography.size.sm,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"90%"})}),v=({links:E,onChange:S,getSuggestions:T,data:M})=>{const[A,x]=(0,o.useState)(null),[C,O]=(0,o.useState)(!1),R=(0,r.of)(D),L=E??[],N=A!==null,F=(U,W)=>{if(C)if(W.title.trim()===""&&W.url.trim()===""){O(!1),x(null);return}else x(null),O(!1);const V=(0,a.cloneDeep)(L);V[U]=W,S(V),x(null)},K=()=>{let U=(0,a.cloneDeep)(L);x(U.length),O(!0)},B=U=>{C&&O(!1),x(null)},w=U=>{const W=(0,a.cloneDeep)(L);W.splice(U,1),S(W)};return o.createElement(o.Fragment,null,L.length>0&&o.createElement("div",{className:R.wrapper},L.map((U,W)=>o.createElement(y,{key:`${U.title}/${W}`,index:W,link:U,onChange:F,onEdit:()=>x(W),onRemove:()=>w(W),data:M}))),N&&A!==null&&o.createElement(f.a,{title:"Edit link",isOpen:!0,closeOnBackdropClick:!1,onDismiss:()=>{B(A)}},o.createElement(g,{index:A,link:C?{title:"",url:""}:L[A],data:M,onSave:F,onCancel:B,getSuggestions:T})),o.createElement(i.$n,{size:"sm",icon:"plus",onClick:K,variant:"secondary"},"Add link"))},D=E=>({wrapper:(0,n.css)({marginBottom:E.spacing(2)})})},79961:(Q,I,e)=>{"use strict";e.d(I,{n:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(14578),i=e(14689);function f({links:l}){const m=(0,o.of)(d);if(l.length===1)return a.createElement(i.R,{link:l[0]});const s=l.filter(u=>u.target==="_blank"),h=l.filter(u=>u.target==="_self");return a.createElement(a.Fragment,null,h.map((u,b)=>a.createElement(i.R,{key:b,link:u})),a.createElement("div",{className:m.wrapper},a.createElement("p",{className:m.externalLinksHeading},"External links"),s.map((u,b)=>a.createElement("a",{key:b,href:u.href,target:u.target,className:m.externalLink},a.createElement(r.I,{name:"external-link-alt"}),u.title))))}const d=l=>({wrapper:(0,n.css)({flexBasis:"150px",width:"100px",marginTop:l.spacing(1)}),externalLinksHeading:(0,n.css)({color:l.colors.text.secondary,fontWeight:l.typography.fontWeightRegular,fontSize:l.typography.size.sm,margin:0}),externalLink:(0,n.css)({color:l.colors.text.link,fontWeight:l.typography.fontWeightRegular,display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&:hover":{textDecoration:"underline"},div:{marginRight:l.spacing(1)}})})},19849:(Q,I,e)=>{"use strict";e.d(I,{i:()=>r});var n=e(96540),a=e(15292),o=e(14186);function r({options:i,onOptionsChange:f}){return n.createElement(n.Fragment,null,n.createElement("h3",{className:"page-heading"},"Alerting"),n.createElement("div",{className:"gf-form-group"},n.createElement("div",{className:"gf-form-inline"},n.createElement("div",{className:"gf-form"},n.createElement(o.I,{labelWidth:29,label:"Manage alert rules in Alerting UI",disabled:i.readOnly,tooltip:"Manage alert rules for this data source. To manage other alerting resources, add an Alertmanager data source."},n.createElement(a.K,{value:i.jsonData.manageAlerts!==!1,onChange:d=>f({...i,jsonData:{...i.jsonData,manageAlerts:d.currentTarget.checked}})}))))))}},28623:(Q,I,e)=>{"use strict";e.d(I,{K:()=>d});var n=e(96540),a=e(55852),o=e(14186),r=e(39268),i=e(10354),f=e(21744);const d=({hasCert:l,label:m,onChange:s,onClick:h,placeholder:u})=>n.createElement(r.C,null,n.createElement(o.I,{label:m,labelWidth:14,disabled:l},l?n.createElement(i.p,{type:"text",value:"configured",width:24}):n.createElement(f.f,{rows:7,onChange:s,placeholder:u,required:!0})),l&&n.createElement(a.$n,{variant:"secondary",onClick:h,style:{marginLeft:4}},"Reset"))},11184:(Q,I,e)=>{"use strict";e.d(I,{P:()=>u});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(40845),f=e(55852),d=e(90090),l=e(14578),m=e(56286);const s=()=>({layout:(0,n.css)({display:"flex",alignItems:"center",marginBottom:"4px","> *":{marginLeft:"4px",marginBottom:0,height:"100%","&:first-child, &:last-child":{marginLeft:0}}})}),h=({header:g,onBlur:P,onChange:c,onRemove:y,onReset:p})=>{const v=(0,i.of)(s);return r.createElement("div",{className:v.layout},r.createElement(d.z,{label:"Header",name:"name",placeholder:"X-Custom-Header",labelWidth:5,value:g.name||"",onChange:D=>c({...g,name:D.target.value}),onBlur:P}),r.createElement(m.L,{label:"Value","aria-label":"Value",name:"value",isConfigured:g.configured,value:g.value,labelWidth:5,inputWidth:g.configured?11:12,placeholder:"Header Value",onReset:()=>p(g.id),onChange:D=>c({...g,value:D.target.value}),onBlur:P}),r.createElement(f.$n,{type:"button","aria-label":"Remove header",variant:"secondary",size:"xs",onClick:D=>y(g.id)},r.createElement(l.I,{name:"trash-alt"})))};h.displayName="CustomHeaderRow";class u extends r.PureComponent{constructor(P){super(P),this.state={headers:[]},this.updateSettings=()=>{const{headers:v}=this.state,D=Object.fromEntries(Object.entries(this.props.dataSourceConfig.jsonData).filter(([S,T])=>!S.startsWith("httpHeaderName"))),E=Object.fromEntries(Object.entries(this.props.dataSourceConfig.secureJsonData||{}).filter(([S,T])=>!S.startsWith("httpHeaderValue")));for(const[S,T]of v.entries())D[`httpHeaderName${S+1}`]=T.name,T.configured||(E[`httpHeaderValue${S+1}`]=T.value);this.props.onChange({...this.props.dataSourceConfig,jsonData:D,secureJsonData:E})},this.onHeaderAdd=()=>{this.setState(v=>({headers:[...v.headers,{id:(0,a.uniqueId)(),name:"",value:"",configured:!1}]}))},this.onHeaderChange=(v,D)=>{this.setState(({headers:E})=>({headers:E.map((S,T)=>v!==T?S:{...D})}))},this.onHeaderReset=v=>{this.setState(({headers:D})=>({headers:D.map((E,S)=>E.id!==v?E:{...E,value:"",configured:!1})}))},this.onHeaderRemove=v=>{this.setState(({headers:D})=>({headers:D.filter(E=>E.id!==v)}),this.updateSettings)};const{jsonData:c,secureJsonData:y,secureJsonFields:p}=this.props.dataSourceConfig;this.state={headers:Object.keys(c).sort().filter(v=>v.startsWith("httpHeaderName")).map((v,D)=>({id:(0,a.uniqueId)(),name:c[v],value:y!==void 0?y[v]:"",configured:p&&p[`httpHeaderValue${D+1}`]||!1}))}}render(){const{headers:P}=this.state,{dataSourceConfig:c}=this.props;return r.createElement("div",{className:"gf-form-group"},r.createElement("div",{className:"gf-form"},r.createElement("h6",null,"Custom HTTP Headers")),r.createElement("div",null,P.map((y,p)=>r.createElement(h,{key:y.id,header:y,onChange:v=>{this.onHeaderChange(p,v)},onBlur:this.updateSettings,onRemove:this.onHeaderRemove,onReset:this.onHeaderReset}))),!c.readOnly&&r.createElement("div",{className:"gf-form"},r.createElement(f.$n,{variant:"secondary",icon:"plus",type:"button",onClick:y=>{this.onHeaderAdd()}},"Add header")))}}var b=null},91409:(Q,I,e)=>{"use strict";e.d(I,{t:()=>M});var n=e(32196),a=e(96540),o=e(13544),r=e(40845),i=e(90090),f=e(38894),d=e(14186),l=e(91634),m=e(14578),s=e(21594),h=e(15292),u=e(79924),b=e(56286);const g=({dataSourceConfig:A,onChange:x})=>{const C=A.secureJsonData?A.secureJsonData.basicAuthPassword:"",O=()=>{x({...A,secureJsonData:{...A.secureJsonData,basicAuthPassword:""},secureJsonFields:{...A.secureJsonFields,basicAuthPassword:!1}})},R=L=>{x({...A,secureJsonData:{...A.secureJsonData,basicAuthPassword:L.currentTarget.value}})};return a.createElement(a.Fragment,null,a.createElement(d.I,{disabled:A.readOnly},a.createElement(i.z,{label:"User",labelWidth:10,inputWidth:18,placeholder:"user",value:A.basicAuthUser,onChange:L=>x({...A,basicAuthUser:L.currentTarget.value})})),a.createElement(d.I,{disabled:A.readOnly},a.createElement(b.L,{isConfigured:!!(A.secureJsonFields&&A.secureJsonFields.basicAuthPassword),value:C||"",inputWidth:18,labelWidth:10,onReset:O,onChange:R})))};var P=e(11184);const c=26,y=({dataSourceConfig:A,onChange:x,showForwardOAuthIdentityOption:C=!0})=>a.createElement(a.Fragment,null,a.createElement("div",{className:"gf-form-inline"},a.createElement(d.I,{label:"TLS Client Auth",labelWidth:c,disabled:A.readOnly},a.createElement(h.K,{id:"http-settings-tls-client-auth",value:A.jsonData.tlsAuth||!1,onChange:O=>x({...A.jsonData,tlsAuth:O.currentTarget.checked})})),a.createElement(d.I,{label:"With CA Cert",tooltip:"Needed for verifying self-signed TLS Certs",labelWidth:c,disabled:A.readOnly},a.createElement(h.K,{id:"http-settings-ca-cert",value:A.jsonData.tlsAuthWithCACert||!1,onChange:O=>x({...A.jsonData,tlsAuthWithCACert:O.currentTarget.checked})}))),a.createElement("div",{className:"gf-form-inline"},a.createElement(d.I,{label:"Skip TLS Verify",labelWidth:c,disabled:A.readOnly},a.createElement(h.K,{id:"http-settings-skip-tls-verify",value:A.jsonData.tlsSkipVerify||!1,onChange:O=>x({...A.jsonData,tlsSkipVerify:O.currentTarget.checked})}))),C&&a.createElement("div",{className:"gf-form-inline"},a.createElement(d.I,{label:"Forward OAuth Identity",tooltip:"Forward the user's upstream OAuth identity to the data source (Their access token gets passed along).",labelWidth:c,disabled:A.readOnly},a.createElement(h.K,{id:"http-settings-forward-oauth",value:A.jsonData.oauthPassThru||!1,onChange:O=>x({...A.jsonData,oauthPassThru:O.currentTarget.checked})}))));var p=e(17081),v=e(95180);const D=[{label:"Server (default)",value:"proxy"},{label:"Browser",value:"direct"}],E={label:"Server (default)",value:"proxy"},S=()=>a.createElement("div",{className:"grafana-info-box m-t-2"},a.createElement("p",null,"Access mode controls how requests to the data source will be handled.",a.createElement("strong",null,"\xA0",a.createElement("i",null,"Server"))," ","should be the preferred way if nothing else is stated."),a.createElement("div",{className:"alert-title"},"Server access mode (Default):"),a.createElement("p",null,"All requests will be made from the browser to Grafana backend/server which in turn will forward the requests to the data source and by that circumvent possible Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the grafana backend/server if you select this access mode."),a.createElement("div",{className:"alert-title"},"Browser access mode:"),a.createElement("p",null,"All requests will be made from the browser directly to the data source and may be subject to Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the browser if you select this access mode.")),T=26,M=A=>{const{defaultUrl:x,dataSourceConfig:C,onChange:O,showAccessOptions:R,sigV4AuthToggleEnabled:L,showForwardOAuthIdentityOption:N,azureAuthSettings:F,renderSigV4Editor:K,secureSocksDSProxyEnabled:B,urlLabel:w,urlDocs:U}=A,[W,V]=(0,a.useState)(!1),[_,H]=(0,a.useState)(!1),G=(0,r.$j)();let j;const Y=(0,a.useCallback)(q=>{const ie=F?.azureAuthSupported&&F.getAzureAuthEnabled(C)||!1;if(H(ie),ie){const de=C.jsonData.oauthPassThru!==void 0?C.jsonData.oauthPassThru:!1;q={...q,jsonData:{...C.jsonData,oauthPassThru:ie?!1:de}}}O({...C,...q})},[F,C,O]);switch(C.access){case"direct":j=a.createElement(a.Fragment,null,"Your access method is ",a.createElement("em",null,"Browser"),", this means the URL needs to be accessible from the browser.",U);break;case"proxy":j=a.createElement(a.Fragment,null,"Your access method is ",a.createElement("em",null,"Server"),", this means the URL needs to be accessible from the grafana backend/server.",U);break;default:j=a.createElement(a.Fragment,null,"Specify a complete HTTP URL (for example http://your_server:8080) ",U)}const oe=a.createElement(s.l6,{"aria-label":"Access",className:"width-20 gf-form-input",options:D,value:D.filter(q=>q.value===C.access)[0]||E,onChange:q=>Y({access:q.value}),disabled:C.readOnly}),se=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(C.url),ne=(0,n.css)({boxShadow:`inset 0 0px 5px ${G.v1.palette.red}`}),ee=(0,n.cx)({"width-20":!0,[ne]:!se}),Z=(0,a.useId)(),z=a.createElement(l.p,{id:Z,className:ee,placeholder:x,value:C.url,"data-testid":o.Tp.components.DataSource.DataSourceHttpSettings.urlInput,onChange:q=>Y({url:q.currentTarget.value}),disabled:C.readOnly});return a.createElement("div",{className:"gf-form-group"},a.createElement(a.Fragment,null,a.createElement("h3",{className:"page-heading"},"HTTP"),a.createElement("div",{className:"gf-form-group"},a.createElement("div",{className:"gf-form"},a.createElement(i.z,{interactive:!!U,label:w??"URL",labelWidth:13,tooltip:j,inputEl:z})),R&&a.createElement(a.Fragment,null,a.createElement("div",{className:"gf-form-inline"},a.createElement("div",{className:"gf-form"},a.createElement(i.z,{label:"Access",labelWidth:13,inputWidth:20,inputEl:oe})),a.createElement("div",{className:"gf-form"},a.createElement("button",{type:"button",className:"gf-form-label query-keyword pointer",onClick:()=>V(q=>!q)},"Help\xA0",a.createElement(m.I,{name:W?"angle-down":"angle-right",style:{marginBottom:0}})))),W&&a.createElement(S,null)),C.access==="proxy"&&a.createElement("div",{className:"gf-form-group"},a.createElement("div",{className:"gf-form"},a.createElement(f.I,{width:13,tooltip:"Grafana proxy deletes forwarded cookies by default. Specify cookies by name that should be forwarded to the data source."},"Allowed cookies"),a.createElement(u.u,{tags:C.jsonData.keepCookies,width:40,onChange:q=>Y({jsonData:{...C.jsonData,keepCookies:q}}),disabled:C.readOnly})),a.createElement("div",{className:"gf-form"},a.createElement(i.z,{label:"Timeout",type:"number",labelWidth:13,inputWidth:20,tooltip:"HTTP request timeout in seconds",placeholder:"Timeout in seconds","aria-label":"Timeout in seconds",value:C.jsonData.timeout,onChange:q=>{Y({jsonData:{...C.jsonData,timeout:parseInt(q.currentTarget.value,10)}})},disabled:C.readOnly}))))),a.createElement(a.Fragment,null,a.createElement("h3",{className:"page-heading"},"Auth"),a.createElement("div",{className:"gf-form-group"},a.createElement("div",{className:"gf-form-inline"},a.createElement(d.I,{label:"Basic auth",labelWidth:T,disabled:C.readOnly},a.createElement(h.K,{id:"http-settings-basic-auth",value:C.basicAuth,onChange:q=>{Y({basicAuth:q.currentTarget.checked})}})),a.createElement(d.I,{label:"With Credentials",tooltip:"Whether credentials such as cookies or auth headers should be sent with cross-site requests.",labelWidth:T,disabled:C.readOnly},a.createElement(h.K,{id:"http-settings-with-credentials",value:C.withCredentials,onChange:q=>{Y({withCredentials:q.currentTarget.checked})}}))),F?.azureAuthSupported&&a.createElement("div",{className:"gf-form-inline"},a.createElement(d.I,{label:"Azure Authentication",tooltip:"Use Azure authentication for Azure endpoint.",labelWidth:T,disabled:C.readOnly},a.createElement(h.K,{id:"http-settings-azure-auth",value:_,onChange:q=>{Y(F.setAzureAuthEnabled(C,q.currentTarget.checked))}}))),L&&a.createElement("div",{className:"gf-form-inline"},a.createElement(d.I,{label:"SigV4 auth",labelWidth:T,disabled:C.readOnly},a.createElement(h.K,{id:"http-settings-sigv4-auth",value:C.jsonData.sigV4Auth||!1,onChange:q=>{Y({jsonData:{...C.jsonData,sigV4Auth:q.currentTarget.checked}})}}))),C.access==="proxy"&&a.createElement(y,{dataSourceConfig:C,onChange:q=>Y({jsonData:q}),showForwardOAuthIdentityOption:_?!1:N})),C.basicAuth&&a.createElement(a.Fragment,null,a.createElement("h6",null,"Basic Auth Details"),a.createElement("div",{className:"gf-form-group"},a.createElement(g,{...A}))),F?.azureAuthSupported&&_&&F.azureSettingsUI&&a.createElement(F.azureSettingsUI,{dataSourceConfig:C,onChange:O}),C.jsonData.sigV4Auth&&L&&K,(C.jsonData.tlsAuth||C.jsonData.tlsAuthWithCACert)&&a.createElement(v.j,{dataSourceConfig:C,onChange:O}),C.access==="proxy"&&a.createElement(P.P,{dataSourceConfig:C,onChange:O})),B&&a.createElement(p.Y,{options:C,onOptionsChange:O}))}},17081:(Q,I,e)=>{"use strict";e.d(I,{Y:()=>r});var n=e(96540),a=e(15292),o=e(14186);function r({options:i,onOptionsChange:f}){return n.createElement(n.Fragment,null,n.createElement("h3",{className:"page-heading"},"Secure Socks Proxy"),n.createElement("div",{className:"gf-form-group"},n.createElement("div",{className:"gf-form-inline"},n.createElement("div",{className:"gf-form"},n.createElement(o.I,{labelWidth:26,label:"Enabled",tooltip:"Connect to this datasource via the secure socks proxy."},n.createElement(a.K,{value:i.jsonData.enableSecureSocksProxy??!1,onChange:d=>f({...i,jsonData:{...i.jsonData,enableSecureSocksProxy:d.currentTarget.checked}})}))))))}},95180:(Q,I,e)=>{"use strict";e.d(I,{j:()=>d});var n=e(32196),a=e(96540),o=e(90090),r=e(14578),i=e(56034),f=e(28623);const d=({dataSourceConfig:l,onChange:m})=>{const s=l.secureJsonFields&&l.secureJsonFields.tlsCACert,h=l.secureJsonFields&&l.secureJsonFields.tlsClientCert,u=l.secureJsonFields&&l.secureJsonFields.tlsClientKey,b=l.jsonData&&l.jsonData.serverName,g=y=>p=>{p.preventDefault();const v={...l.secureJsonFields};v[y]=!1,m({...l,secureJsonFields:v})},P=y=>p=>{const v={...l.secureJsonData};v[y]=p.currentTarget.value,m({...l,secureJsonData:v})},c=y=>{const p={...l.jsonData,serverName:y.currentTarget.value};m({...l,jsonData:p})};return a.createElement("div",{className:"gf-form-group"},a.createElement("div",{className:(0,n.cx)("gf-form",(0,n.css)({alignItems:"baseline"}))},a.createElement("h6",null,"TLS/SSL Auth Details"),a.createElement(i.m,{placement:"right-end",content:"TLS/SSL Certs are encrypted and stored in the Grafana database.",theme:"info"},a.createElement(r.I,{name:"info-circle",size:"xs",style:{marginLeft:"10px"}}))),a.createElement("div",null,l.jsonData.tlsAuthWithCACert&&a.createElement(f.K,{hasCert:!!s,onChange:P("tlsCACert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",label:"CA Cert",onClick:g("tlsCACert")}),l.jsonData.tlsAuth&&a.createElement(a.Fragment,null,a.createElement("div",{className:"gf-form"},a.createElement(o.z,{label:"ServerName",labelWidth:7,inputWidth:30,placeholder:"domain.example.com",value:b&&l.jsonData.serverName,onChange:c})),a.createElement(f.K,{hasCert:!!h,label:"Client Cert",onChange:P("tlsClientCert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",onClick:g("tlsClientCert")}),a.createElement(f.K,{hasCert:!!u,label:"Client Key",placeholder:"Begins with -----BEGIN RSA PRIVATE KEY-----",onChange:P("tlsClientKey"),onClick:g("tlsClientKey")}))))}},56181:(Q,I,e)=>{"use strict";e.d(I,{l:()=>l});var n=e(32196),a=e(96540),o=e(29426),r=e(40845),i=e(8866),f=e(14578),d=e(72265);const l=(0,a.memo)(h=>{const u=(0,r.of)(s),{isOpen:b,onClose:g}=h;return b?a.createElement(i.N,{useCapture:!0,includeButtonPress:!1,onClick:g},a.createElement("div",{className:u.modal,"data-testid":"date-picker"},a.createElement(m,{...h}))):null});l.displayName="DatePicker";const m=(0,a.memo)(({value:h,minDate:u,maxDate:b,onChange:g})=>{const P=(0,r.of)(d.h2);return a.createElement(o.Ay,{className:P.body,tileClassName:P.title,value:h||new Date,minDate:u,maxDate:b,nextLabel:a.createElement(f.I,{name:"angle-right"}),prevLabel:a.createElement(f.I,{name:"angle-left"}),onChange:c=>{c&&!Array.isArray(c)&&g(c)},locale:"en"})});m.displayName="Body";const s=h=>({modal:(0,n.css)({zIndex:h.zIndex.modal,boxShadow:h.shadows.z3,backgroundColor:h.colors.background.primary,border:`1px solid ${h.colors.border.weak}`,borderTopLeftRadius:h.shape.radius.default,borderBottomLeftRadius:h.shape.radius.default,"button:disabled":{color:h.colors.text.disabled}})})},98239:(Q,I,e)=>{"use strict";e.d(I,{l:()=>h});var n=e(32196),a=e(34743),o=e(36376),r=e(7315),i=e(96540),f=e(47232),d=e(40845),l=e(10354),m=e(56181);const s=b=>(0,f.KQ)(b).format("L"),h=({value:b,minDate:g,maxDate:P,onChange:c,closeOnSelect:y,placeholder:p="Date",...v})=>{const[D,E]=(0,i.useState)(!1),S=(0,d.of)(u),T=[(0,a.UU)({crossAxis:!1,boundary:document.body}),(0,a.BN)()],{context:M,refs:A,floatingStyles:x}=(0,o.we)({open:D,placement:"bottom-start",onOpenChange:E,middleware:T,whileElementsMounted:r.ll,strategy:"fixed"}),C=(0,o.kp)(M),O=(0,o.s9)(M),{getReferenceProps:R,getFloatingProps:L}=(0,o.bv)([O,C]);return i.createElement("div",{className:S.container},i.createElement(l.p,{ref:A.setReference,type:"text",autoComplete:"off",placeholder:p,value:b&&s(b),onChange:N=>{N.target.value===""&&c("")},className:S.input,...v,...R()}),i.createElement("div",{className:S.popover,ref:A.setFloating,style:x,...L()},i.createElement(m.l,{isOpen:D,value:b&&typeof b!="string"?b:(0,f.KQ)().toDate(),minDate:g,maxDate:P,onChange:N=>{c(N),y&&E(!1)},onClose:()=>E(!1)})))},u=b=>({container:(0,n.css)({position:"relative"}),input:(0,n.css)({"input[type='date']::-webkit-inner-spin-button, input[type='date']::-webkit-calendar-picker-indicator":{display:"none",WebkitAppearance:"none"}}),popover:(0,n.css)({zIndex:b.zIndex.tooltip})})},63383:(Q,I,e)=>{"use strict";e.d(I,{K:()=>C});var n=e(32196),a=e(34743),o=e(36376),r=e(7315),i=e(18828),f=e(85690),d=e(93225),l=e(96540),m=e(29426),s=e(49045),h=e(72724),u=e(47232),b=e(1933),g=e(13390),P=e(40845),c=e(55852),y=e(14186),p=e(14578),v=e(10354),D=e(67061),E=e(88448),S=e(17464),T=e(66070),M=e(72265),A=e(47619),x=e(99225);const C=({date:N,maxDate:F,minDate:K,label:B,onChange:w,disabledHours:U,disabledMinutes:W,disabledSeconds:V,showSeconds:_=!0,clearable:H=!1})=>{const[G,j]=(0,l.useState)(!1),Y=(0,l.useRef)(null),{overlayProps:oe,underlayProps:se}=(0,d.e)({onClose:()=>j(!1),isDismissable:!0,isOpen:G,shouldCloseOnInteractOutside:he=>{const ce=document.getElementsByClassName(T.i)[0];return!(ce&&ce.contains(he))}},Y),{dialogProps:ne}=(0,i.s)({},Y),ee=(0,P.$j)(),{modalBackdrop:Z}=(0,P.of)(E.o),z=(0,s.A)(`(min-width: ${ee.breakpoints.values.lg}px)`),q=(0,P.of)(L),ie=[(0,a.UU)({crossAxis:!1,boundary:document.body}),(0,a.BN)()],{refs:de,floatingStyles:ue}=(0,o.we)({open:G,placement:"bottom-start",onOpenChange:j,middleware:ie,whileElementsMounted:r.ll,strategy:"fixed"}),fe=(0,l.useCallback)(he=>{j(!1),w(he)},[w]),Se=(0,l.useCallback)(he=>{he.preventDefault(),j(!0)},[j]);return l.createElement("div",{"data-testid":"date-time-picker",style:{position:"relative"}},l.createElement(O,{date:N,onChange:w,isFullscreen:z,onOpen:Se,label:B,ref:de.setReference,showSeconds:_,clearable:H}),G?z?l.createElement(S.ZL,null,l.createElement(f.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},l.createElement("div",{ref:Y,...oe,...ne},l.createElement(R,{date:N,onChange:fe,isFullscreen:!0,onClose:()=>j(!1),maxDate:F,minDate:K,ref:de.setFloating,style:ue,showSeconds:_,disabledHours:U,disabledMinutes:W,disabledSeconds:V})))):l.createElement(S.ZL,null,l.createElement("div",{className:Z,...se}),l.createElement(f.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},l.createElement("div",{ref:Y,...oe,...ne},l.createElement("div",{className:q.modal},l.createElement(R,{date:N,maxDate:F,minDate:K,onChange:fe,isFullscreen:!1,onClose:()=>j(!1),showSeconds:_,disabledHours:U,disabledMinutes:W,disabledSeconds:V}))))):null)},O=l.forwardRef(({date:N,label:F,onChange:K,onOpen:B,showSeconds:w=!0,clearable:U=!1},W)=>{const V=(0,P.of)(L),_=w?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD HH:mm",[H,G]=(0,l.useState)(()=>({value:N?(0,h.LE)(N):U?"":(0,h.LE)((0,u.KQ)()),invalid:!1}));(0,l.useEffect)(()=>{N&&G({invalid:!(0,A.f)((0,h.LE)(N,{format:_})),value:(0,u.Ar)(N)?(0,h.LE)(N,{format:_}):N})},[N,_]);const j=(0,l.useCallback)(ne=>{const ee=!(0,A.f)(ne.currentTarget.value);G({value:ne.currentTarget.value,invalid:ee})},[]),Y=(0,l.useCallback)(()=>{if(!H.invalid&&H.value){const ne=(0,u.oZ)((0,b.O)(),H.value);K(ne)}},[H,K]),oe=(0,l.useCallback)(()=>{G({value:"",invalid:!1}),K()},[K]),se=l.createElement(c.$n,{"aria-label":"Time picker",icon:"calendar-alt",variant:"secondary",onClick:B});return l.createElement(y.I,{label:F,invalid:!!(H.value&&H.invalid),className:V.field},l.createElement(v.p,{onChange:j,addonAfter:se,value:H.value,onBlur:Y,"data-testid":g.X.DateTimePicker.input,placeholder:"Select date/time",ref:W,suffix:U&&H.value&&l.createElement(p.I,{name:"times",className:V.clearIcon,onClick:oe})}))});O.displayName="DateTimeInput";const R=l.forwardRef(({date:N,onClose:F,onChange:K,isFullscreen:B,maxDate:w,minDate:U,style:W,showSeconds:V=!0,disabledHours:_,disabledMinutes:H,disabledSeconds:G},j)=>{const Y=(0,P.of)(M.h2),oe=(0,P.of)(L),[se,ne]=(0,l.useState)(()=>N&&N.isValid()?(0,u.oZ)((0,b.O)(),N):(0,u.oZ)((0,b.O)(),new Date)),[ee,Z]=(0,l.useState)(()=>N&&N.isValid()?(0,x.Q)(N.toDate(),(0,b.O)()):new Date),z=(0,l.useCallback)(de=>{de&&!Array.isArray(de)&&Z(de)},[]),q=(0,l.useCallback)(de=>{ne(de)},[]),ie=()=>{const de=(0,u.KQ)(se);de.set("date",ee.getDate()),de.set("month",ee.getMonth()),de.set("year",ee.getFullYear()),K(de)};return l.createElement("div",{className:(0,n.cx)(oe.container,{[oe.fullScreen]:B}),style:W,ref:j},l.createElement(m.Ay,{next2Label:null,prev2Label:null,value:ee,nextLabel:l.createElement(p.I,{name:"angle-right"}),nextAriaLabel:"Next month",prevLabel:l.createElement(p.I,{name:"angle-left"}),prevAriaLabel:"Previous month",onChange:z,locale:"en",className:Y.body,tileClassName:Y.title,maxDate:w,minDate:U}),l.createElement("div",{className:oe.time},l.createElement(T.R,{showSeconds:V,onChange:q,value:se,disabledHours:_,disabledMinutes:H,disabledSeconds:G})),l.createElement(D.B,null,l.createElement(c.$n,{type:"button",onClick:ie},"Apply"),l.createElement(c.$n,{variant:"secondary",type:"button",onClick:F},"Cancel")))});R.displayName="DateTimeCalendar";const L=N=>({container:(0,n.css)({padding:N.spacing(1),border:`1px ${N.colors.border.weak} solid`,borderRadius:N.shape.radius.default,backgroundColor:N.colors.background.primary,zIndex:N.zIndex.modal}),fullScreen:(0,n.css)({position:"absolute"}),time:(0,n.css)({marginBottom:N.spacing(2)}),modal:(0,n.css)({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:N.zIndex.modal,maxWidth:"280px"}),clearIcon:(0,n.css)({cursor:"pointer"}),field:(0,n.css)({marginBottom:0,width:"100%"})})},5308:(Q,I,e)=>{"use strict";e.d(I,{N:()=>R});var n=e(32196),a=e(34743),o=e(36376),r=e(7315),i=e(18828),f=e(85690),d=e(93225),l=e(96540),m=e(40845),s=e(76412),h=e(55852),u=e(40276),b=e(88575),g=e(14578),P=e(10354),c=e(56034),y=e(42617),p=e(11752),v=e(32432);const D=/^now$|^now\-(\d{1,10})([wdhms])$/,E=B=>({from:A(B.from),to:A(B.to)}),S=B=>{const w=C(B.from),U=C(B.to);return{from:w,to:U,display:`${w} to ${U}`}},T=(B,w=Date.now())=>M(B)?A(B)>Math.ceil(w/1e3)?{isValid:!1,errorMessage:"Can not enter value prior to January 1, 1970."}:{isValid:!0}:{isValid:!1,errorMessage:"Value not in relative time format."},M=B=>D.test(B),A=B=>{const w=D.exec(B);if(!w||w.length!==3)return 0;const[,U,W]=w,V=parseInt(U,10);return isNaN(V)?0:V*x[W]},x={w:604800,d:86400,h:3600,m:60,s:1},C=B=>B<=0?"now":B>=x.w&&B%x.w===0?`now-${B/x.w}w`:B>=x.d&&B%x.d===0?`now-${B/x.d}d`:B>=x.h&&B%x.h===0?`now-${B/x.h}h`:B>=x.m&&B%x.m===0?`now-${B/x.m}m`:`now-${B}s`,O=v.o.filter(B=>M(B.from));function R(B){const{timeRange:w,onChange:U}=B,[W,V]=(0,l.useState)(!1),_=(0,l.useCallback)(()=>V(!1),[]),H=S(w),[G,j]=(0,l.useState)({value:H.from,validation:T(H.from)}),[Y,oe]=(0,l.useState)({value:H.to,validation:T(H.to)}),se=(0,l.useRef)(null),{overlayProps:ne,underlayProps:ee}=(0,d.e)({onClose:()=>V(!1),isDismissable:!0,isOpen:W},se),{dialogProps:Z}=(0,i.s)({},se),z=[(0,a.UU)({crossAxis:!1,boundary:document.body}),(0,a.BN)()],{context:q,refs:ie,floatingStyles:de}=(0,o.we)({open:W,placement:"bottom-start",onOpenChange:V,middleware:z,whileElementsMounted:r.ll,strategy:"fixed"}),ue=(0,o.kp)(q),fe=(0,o.s9)(q),{getReferenceProps:Se,getFloatingProps:he}=(0,o.bv)([fe,ue]),ce=(0,m.of)(F(G.validation.errorMessage,Y.validation.errorMessage)),me=Pe=>{const Ie=E(Pe);Ie&&(_(),j({...G,value:Pe.from}),oe({...Y,value:Pe.to}),U(Ie))},pe=(0,l.useCallback)(Pe=>{Pe.stopPropagation(),Pe.preventDefault(),V(!W)},[W]),ye=Pe=>{if(Pe.preventDefault(),!Y.validation.isValid||!G.validation.isValid)return;const Ie=E({from:G.value,to:Y.value,display:""});Ie&&(U(Ie),V(!1))};return l.createElement("div",{className:ce.container},l.createElement("button",{ref:ie.setReference,className:ce.pickerInput,type:"button",onClick:pe,...Se()},l.createElement("span",{className:ce.clockIcon},l.createElement(g.I,{name:"clock-nine"})),l.createElement("span",null,H.from," to ",H.to),l.createElement("span",{className:ce.caretIcon},l.createElement(g.I,{name:W?"angle-up":"angle-down",size:"lg"}))),W&&l.createElement("div",null,l.createElement("div",{role:"presentation",className:ce.backdrop,...ee}),l.createElement(f.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},l.createElement("div",{ref:se,...ne,...Z},l.createElement("div",{className:ce.content,ref:ie.setFloating,style:de,...he()},l.createElement("div",{className:ce.body},l.createElement(u.A,{className:ce.leftSide,hideHorizontalTrack:!0},l.createElement(p.l,{title:(0,s.t)("time-picker.time-range.example-title","Example time ranges"),options:O,onChange:me,value:H})),l.createElement("div",{className:ce.rightSide},l.createElement("div",{className:ce.title},l.createElement(y.e,null,l.createElement(c.m,{content:l.createElement(L,null),placement:"bottom",theme:"info"},l.createElement("div",null,l.createElement(s.x,{i18nKey:"time-picker.time-range.specify"},"Specify time range ",l.createElement(g.I,{name:"info-circle"})))))),l.createElement(b.D,{label:"From",invalid:!G.validation.isValid,error:G.validation.errorMessage},l.createElement(P.p,{onClick:Pe=>Pe.stopPropagation(),onBlur:()=>j({...G,validation:T(G.value)}),onChange:Pe=>j({...G,value:Pe.currentTarget.value}),value:G.value})),l.createElement(b.D,{label:"To",invalid:!Y.validation.isValid,error:Y.validation.errorMessage},l.createElement(P.p,{onClick:Pe=>Pe.stopPropagation(),onBlur:()=>oe({...Y,validation:T(Y.value)}),onChange:Pe=>oe({...Y,value:Pe.currentTarget.value}),value:Y.value})),l.createElement(h.$n,{"aria-label":"TimePicker submit button",onClick:ye},"Apply time range"))))))))}const L=()=>{const B=(0,m.of)(N);return l.createElement(l.Fragment,null,l.createElement("div",{className:B.supported},"Supported formats: ",l.createElement("code",{className:B.tooltip},"now-[digit]s/m/h/d/w")),l.createElement("div",null,"Example: to select a time range from 10 minutes ago to now"),l.createElement("code",{className:B.tooltip},"From: now-10m To: now"),l.createElement("div",{className:B.link},"For more information see"," ",l.createElement("a",{href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls/"},"docs ",l.createElement(g.I,{name:"external-link-alt"})),"."))},N=B=>({supported:(0,n.css)({marginBottom:B.spacing(1)}),tooltip:(0,n.css)({margin:0}),link:(0,n.css)({marginTop:B.spacing(1)})}),F=(B,w)=>U=>{const W=(0,P.n)({theme:U,invalid:!1}),_=250+K(U,B)+K(U,w);return{backdrop:(0,n.css)({position:"fixed",zIndex:U.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0}),container:(0,n.css)({display:"flex",position:"relative"}),pickerInput:(0,n.cx)(W.input,W.wrapper,(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,paddingLeft:0,lineHeight:`${U.spacing.gridSize*U.components.height.md-2}px`})),caretIcon:(0,n.cx)(W.suffix,(0,n.css)({position:"relative",marginLeft:U.spacing(.5)})),clockIcon:(0,n.cx)(W.prefix,(0,n.css)({position:"relative",marginRight:U.spacing(.5)})),content:(0,n.css)({background:U.colors.background.primary,boxShadow:U.shadows.z3,position:"absolute",zIndex:U.zIndex.modal,width:"500px",top:"100%",borderRadius:U.shape.radius.default,border:`1px solid ${U.colors.border.weak}`,left:0,whiteSpace:"normal"}),body:(0,n.css)({display:"flex",height:`${_}px`}),description:(0,n.css)({color:U.colors.text.secondary,fontSize:U.typography.size.sm}),leftSide:(0,n.css)({width:"50% !important",borderRight:`1px solid ${U.colors.border.medium}`}),rightSide:(0,n.css)({width:"50%",padding:U.spacing(1)}),title:(0,n.css)({marginBottom:U.spacing(1)})}};function K(B,w){return w?w.length>34?B.spacing.gridSize*6.5:B.spacing.gridSize*4:0}},66070:(Q,I,e)=>{"use strict";e.d(I,{R:()=>h,i:()=>s});var n=e(32196),a=e(57389),o=e(96540),r=e(47232),i=e(40845),f=e(16797),d=e(87266),l=e(14578),m=e(78537);const s="time-of-day-picker-panel",h=({minuteStep:g=1,showHour:P=!0,showSeconds:c=!1,onChange:y,value:p,size:v="auto",disabled:D,disabledHours:E,disabledMinutes:S,disabledSeconds:T})=>{const M=(0,i.of)(b);return o.createElement(a.A,{className:(0,n.cx)((0,d.lH)()[v],M.input),popupClassName:(0,n.cx)(M.picker,s),defaultValue:(0,r.AN)(),onChange:A=>{if((0,r.u8)(A))return y((0,r.KQ)(A))},allowEmpty:!1,showSecond:c,value:(0,r.AN)(p),showHour:P,minuteStep:g,inputIcon:o.createElement(u,{wrapperStyle:M.caretWrapper}),disabled:D,disabledHours:E,disabledMinutes:S,disabledSeconds:T})},u=({wrapperStyle:g=""})=>o.createElement("div",{className:g},o.createElement(l.I,{name:"angle-down"})),b=g=>{const P=g.components.input.background,c=g.v1.palette.black,y=g.colors.background.secondary,p=g.shape.radius.default,v=g.components.input.borderColor;return{caretWrapper:(0,n.css)({position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",display:"inline-block",textAlign:"right",color:g.colors.text.secondary}),picker:(0,n.css)({".rc-time-picker-panel-select":{fontSize:"14px",backgroundColor:P,color:g.colors.text.secondary,borderColor:v,li:{outlineWidth:"2px","&.rc-time-picker-panel-select-option-selected":{backgroundColor:"inherit",border:`1px solid ${g.v1.palette.orange}`,borderRadius:p,color:g.colors.text.primary},"&:hover":{background:y,color:g.colors.text.primary},"&.rc-time-picker-panel-select-option-disabled":{color:g.colors.action.disabledText}}},".rc-time-picker-panel-inner":{boxShadow:`0px 4px 4px ${c}`,backgroundColor:P,borderColor:v,borderRadius:p,marginTop:"3px",".rc-time-picker-panel-input-wrap":{marginRight:"2px","&, .rc-time-picker-panel-input":{backgroundColor:P,paddingTop:"2px"}},".rc-time-picker-panel-combobox":{display:"flex"}}}),input:(0,n.css)({".rc-time-picker-input":{backgroundColor:P,borderRadius:p,borderColor:v,color:g.colors.text.primary,height:g.spacing(4),"&:focus":(0,f.getFocusStyles)(g),"&:disabled":{backgroundColor:g.colors.action.disabledBackground,color:g.colors.action.disabledText,border:`1px solid ${g.colors.action.disabledBackground}`,"&:focus":{boxShadow:"none"}}}})}}},54230:(Q,I,e)=>{"use strict";e.d(I,{b:()=>P});var n=e(32196),a=e(96540),o=e(47232),r=e(43127),i=e(13544),f=e(40845),d=e(8866),l=e(14578),m=e(10354),s=e(85068),h=e(3799),u=e(32432),b=e(47619);const g=()=>{},P=({value:y,onChange:p,onChangeTimeZone:v=g,clearable:D,hideTimeZone:E=!0,timeZone:S="browser",placeholder:T="Select time range",isReversed:M=!0,hideQuickRanges:A=!1,disabled:x=!1,showIcon:C=!1})=>{const[O,R]=(0,a.useState)(!1),L=(0,f.of)(c,x),N=w=>{w.stopPropagation(),w.preventDefault(),!x&&R(!O)},F=()=>{R(!1)},K=w=>{F(),p(w)},B=w=>{w.stopPropagation();const U=(0,o.KQ)(null),W=(0,o.KQ)(null);p({from:U,to:W,raw:{from:U,to:W}})};return a.createElement("div",{className:L.container},a.createElement("button",{type:"button",className:L.pickerInput,"data-testid":i.Tp.components.TimePicker.openButton,onClick:N},C&&a.createElement(l.I,{name:"clock-nine",size:"sm",className:L.icon}),a.createElement(h.f,{value:y,timeZone:S,placeholder:T}),!x&&a.createElement("span",{className:L.caretIcon},(0,b.X)(y)&&D&&a.createElement(l.I,{className:L.clearIcon,name:"times",size:"lg",onClick:B}),a.createElement(l.I,{name:O?"angle-up":"angle-down",size:"lg"}))),O&&a.createElement(d.N,{includeButtonPress:!1,onClick:F},a.createElement(s.r,{timeZone:S,value:(0,b.X)(y)?y:(0,r.E2)(),onChange:K,quickOptions:u.o,onChangeTimeZone:v,className:L.content,hideTimeZone:E,isReversed:M,hideQuickRanges:A})))},c=(y,p=!1)=>{const v=(0,m.n)({theme:y,invalid:!1});return{container:(0,n.css)({display:"flex",position:"relative"}),content:(0,n.css)({marginLeft:0,position:"absolute",top:"116%",zIndex:y.zIndex.dropdown}),pickerInput:(0,n.cx)(v.input,p&&v.inputDisabled,v.wrapper,(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,lineHeight:`${y.spacing.gridSize*4-2}px`})),caretIcon:(0,n.cx)(v.suffix,(0,n.css)({position:"relative",top:"-1px",marginLeft:y.spacing(.5)})),clearIcon:(0,n.css)({marginRight:y.spacing(.5),"&:hover":{color:y.colors.text.maxContrast}}),placeholder:(0,n.css)({color:y.colors.text.disabled,opacity:1}),icon:(0,n.css)({marginRight:y.spacing(.5)})}}},15666:(Q,I,e)=>{"use strict";e.d(I,{$6:()=>v,_8:()=>S,xS:()=>E});var n=e(32196),a=e(18828),o=e(85690),r=e(93225),i=e(96540),f=e(65879),d=e(72724),l=e(91410),m=e(85858),s=e(13544),h=e(40845),u=e(76412),b=e(19727),g=e(88448),P=e(27746),c=e(56034),y=e(85068),p=e(32432);function v(x){const[C,O]=(0,i.useState)(!1),{value:R,onMoveBackward:L,onMoveForward:N,onZoom:F,onError:K,timeZone:B,fiscalYearStartMonth:w,timeSyncButton:U,isSynced:W,history:V,onChangeTimeZone:_,onChangeFiscalYearStartMonth:H,hideQuickRanges:G,widthOverride:j,isOnCanvas:Y,onToolbarTimePickerClick:oe}=x,se=ye=>{x.onChange(ye),O(!1)};(0,i.useEffect)(()=>{C&&oe&&oe()},[C,oe]);const ne=()=>{O(ye=>!ye)},ee=()=>{O(!1)},Z=(0,i.createRef)(),z=(0,i.createRef)(),{overlayProps:q,underlayProps:ie}=(0,r.e)({onClose:ee,isDismissable:!0,isOpen:C,shouldCloseOnInteractOutside:ye=>!z.current?.contains(ye)},Z),{dialogProps:de}=(0,a.s)({},Z),ue=(0,h.of)(M),{modalBackdrop:fe}=(0,h.of)(g.o),Se=!f.isRelativeTime(R.raw.from)||!f.isRelativeTime(R.raw.to),he=W?"active":Y?"canvas":"default",me=R?.to?.isBefore(R.from)?"exclamation-triangle":"clock-nine",pe=T(R,B);return i.createElement(b.e,{className:ue.container},Se&&i.createElement(P.I,{"aria-label":(0,u.t)("time-picker.range-picker.backwards-time-aria-label","Move time range backwards"),variant:he,onClick:L,icon:"angle-left",narrow:!0}),i.createElement(c.m,{ref:z,content:i.createElement(E,{timeRange:R,timeZone:B}),placement:"bottom",interactive:!0},i.createElement(P.I,{"data-testid":s.Tp.components.TimePicker.openButton,"aria-label":(0,u.t)("time-picker.range-picker.current-time-selected","Time range selected: {{currentTimeRange}}",{currentTimeRange:pe}),"aria-controls":"TimePickerContent",onClick:ne,icon:me,isOpen:C,variant:he},i.createElement(S,{...x}))),C&&i.createElement("div",{"data-testid":s.Tp.components.TimePicker.overlayContent},i.createElement("div",{role:"presentation",className:(0,n.cx)(fe,ue.backdrop),...ie}),i.createElement(o.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},i.createElement("section",{className:ue.content,ref:Z,...q,...de},i.createElement(y.r,{timeZone:B,fiscalYearStartMonth:w,value:R,onChange:se,quickOptions:p.o,history:V,showHistory:!0,widthOverride:j,onChangeTimeZone:_,onChangeFiscalYearStartMonth:H,hideQuickRanges:G,onError:K})))),U,Se&&i.createElement(P.I,{"aria-label":(0,u.t)("time-picker.range-picker.forwards-time-aria-label","Move time range forwards"),onClick:N,icon:"angle-right",narrow:!0,variant:he}),i.createElement(c.m,{content:D,placement:"bottom"},i.createElement(P.I,{"aria-label":(0,u.t)("time-picker.range-picker.zoom-out-button","Zoom out time range"),onClick:F,icon:"search-minus",variant:he})))}v.displayName="TimeRangePicker";const D=()=>i.createElement(i.Fragment,null,i.createElement(u.x,{i18nKey:"time-picker.range-picker.zoom-out-tooltip"},"Time range zoom out ",i.createElement("br",null)," CTRL+Z")),E=({timeRange:x,timeZone:C})=>{const O=(0,h.of)(A);return i.createElement(i.Fragment,null,(0,d.LE)(x.from,{timeZone:C}),i.createElement("div",{className:"text-center"},i.createElement(u.x,{i18nKey:"time-picker.range-picker.to"},"to")),(0,d.LE)(x.to,{timeZone:C}),i.createElement("div",{className:"text-center"},i.createElement("span",{className:O.utc},(0,l.le)(C))))},S=(0,i.memo)(({hideText:x,value:C,timeZone:O})=>{const R=(0,h.of)(A);return x?null:i.createElement("span",{className:R.container,"aria-live":"polite","aria-atomic":"true"},i.createElement("span",null,T(C,O)),i.createElement("span",{className:R.utc},f.describeTimeRangeAbbreviation(C,O)))});S.displayName="TimePickerButtonLabel";const T=(x,C)=>{const O={to:m.isMathString(x.raw.to)?x.raw.to:x.to,from:m.isMathString(x.raw.from)?x.raw.from:x.from};return f.describeTimeRange(O,C)},M=x=>({container:(0,n.css)({position:"relative",display:"flex",verticalAlign:"middle"}),backdrop:(0,n.css)({display:"none",[x.breakpoints.down("sm")]:{display:"block"}}),content:(0,n.css)({position:"absolute",right:0,top:"116%",zIndex:x.zIndex.dropdown,[x.breakpoints.down("sm")]:{position:"fixed",right:"50%",top:"50%",transform:"translate(50%, -50%)",zIndex:x.zIndex.modal}})}),A=x=>({container:(0,n.css)({display:"flex",alignItems:"center",whiteSpace:"nowrap"}),utc:(0,n.css)({color:x.v1.palette.orange,fontSize:x.typography.size.sm,paddingLeft:"6px",lineHeight:"28px",verticalAlign:"bottom",fontWeight:x.typography.fontWeightMedium})})},72265:(Q,I,e)=>{"use strict";e.d(I,{h2:()=>u,nB:()=>l});var n=e(32196),a=e(96540),o=e(29426),r=e(53531),i=e(40845),f=e(14578),d=e(99225);function l({onChange:b,from:g,to:P,timeZone:c}){const y=m(g,P,new Date,c),p=s(b,c),v=(0,i.of)(u);return a.createElement(o.Ay,{selectRange:!0,next2Label:null,prev2Label:null,className:v.body,tileClassName:v.title,value:y,nextLabel:a.createElement(f.I,{name:"angle-right"}),prevLabel:a.createElement(f.I,{name:"angle-left"}),onChange:p,locale:"en"})}l.displayName="Body";function m(b,g,P=new Date,c){let y=b.isValid()?b.toDate():P,p=g.isValid()?g.toDate():P;return c&&(y=(0,d.Q)(y,c),p=(0,d.Q)(p,c)),y>p?[p,y]:[y,p]}function s(b,g){return(0,a.useCallback)(P=>{if(!Array.isArray(P))return console.error("onCalendarChange: should be run in selectRange={true}");if(P[0]&&P[1]){const c=(0,r.b)(h(P[0]),{timeZone:g}),y=(0,r.b)(h(P[1]),{timeZone:g});b(c,y)}},[b,g])}function h(b){return[b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes(),b.getSeconds()]}const u=b=>{const g=".react-calendar__tile--hasActive:not(.react-calendar__tile--range)";return{title:(0,n.css)({color:b.colors.text.primary,backgroundColor:b.colors.background.primary,fontSize:b.typography.size.md,border:"1px solid transparent","&:hover":{position:"relative"},"&:disabled":{color:b.colors.action.disabledText}}),body:(0,n.css)({zIndex:b.zIndex.modal,backgroundColor:b.colors.background.primary,width:"268px",".react-calendar__navigation":{display:"flex"},".react-calendar__navigation__label, .react-calendar__navigation__arrow, .react-calendar__navigation":{paddingTop:"4px",backgroundColor:"inherit",color:b.colors.text.primary,border:0,fontWeight:b.typography.fontWeightMedium},".react-calendar__month-view__weekdays":{backgroundColor:"inherit",textAlign:"center",color:b.colors.primary.text,abbr:{border:0,textDecoration:"none",cursor:"default",display:"block",padding:"4px 0 4px 0"}},".react-calendar__month-view__days":{backgroundColor:"inherit"},".react-calendar__tile, .react-calendar__tile--now":{marginBottom:"4px",backgroundColor:"inherit",height:"26px"},".react-calendar__navigation__label, .react-calendar__navigation > button:focus, .time-picker-calendar-tile:focus":{outline:0},[`${g}, .react-calendar__tile--active, .react-calendar__tile--active:hover`]:{color:b.colors.primary.contrastText,fontWeight:b.typography.fontWeightMedium,background:b.colors.primary.main,boxShadow:"none",border:"0px"},".react-calendar__tile--rangeEnd, .react-calendar__tile--rangeStart":{padding:0,border:"0px",color:b.colors.primary.contrastText,fontWeight:b.typography.fontWeightMedium,background:b.colors.primary.main,abbr:{backgroundColor:b.colors.primary.main,borderRadius:"100px",display:"block",paddingTop:"2px",height:"26px"}},[`${g}, .react-calendar__tile--rangeStart`]:{borderTopLeftRadius:"20px",borderBottomLeftRadius:"20px"},[`${g}, .react-calendar__tile--rangeEnd`]:{borderTopRightRadius:"20px",borderBottomRightRadius:"20px"}})}}},85068:(Q,I,e)=>{"use strict";e.d(I,{r:()=>ue});var n=e(32196),a=e(96540),o=e(47232),r=e(65879),i=e(13544),f=e(40845),d=e(16797),l=e(76412),m=e(67647),s=e(14578),h=e(2543),u=e(91410),b=e(55852),g=e(88575),P=e(94354),c=e(21594),y=e(20333),p=e(79451),v=e(17624),D=e(67459),E=e(32432);const S=Oe=>{const{timeZone:Ne,fiscalYearStartMonth:We,timestamp:Ae=Date.now(),onChangeTimeZone:Ue,onChangeFiscalYearStartMonth:Me}=Oe,[$e,ke]=(0,a.useState)(!1),[Ze,ot]=(0,a.useState)("tz"),xt=(0,a.useCallback)(Le=>{Le&&Le.stopPropagation(),ke(!$e)},[$e,ke]),ct=(0,f.of)(T);if(!(0,h.isString)(Ne))return null;const ft=(0,u.QZ)(Ne,Ae);return ft?a.createElement("div",null,a.createElement("section",{"aria-label":(0,l.t)("time-picker.footer.time-zone-selection","Time zone selection"),className:ct.container},a.createElement("div",{className:ct.timeZoneContainer},a.createElement("div",{className:ct.timeZone},a.createElement(D.U,{title:ft.name}),a.createElement("div",{className:ct.spacer}),a.createElement(p.E,{info:ft})),a.createElement(v.X,{timeZone:Ne,timestamp:Ae})),a.createElement("div",{className:ct.spacer}),a.createElement(b.$n,{"data-testid":i.Tp.components.TimeZonePicker.changeTimeSettingsButton,variant:"secondary",onClick:xt,size:"sm"},a.createElement(l.x,{i18nKey:"time-picker.footer.change-settings-button"},"Change time settings"))),$e?a.createElement("div",{className:ct.editContainer},a.createElement("div",null,a.createElement(P.z,{value:Ze,options:[{label:(0,l.t)("time-picker.footer.time-zone-option","Time zone"),value:"tz"},{label:(0,l.t)("time-picker.footer.fiscal-year-option","Fiscal year"),value:"fy"}],onChange:ot})),Ze==="tz"?a.createElement("section",{"data-testid":i.Tp.components.TimeZonePicker.containerV2,className:(0,n.cx)(ct.timeZoneContainer,ct.timeSettingContainer)},a.createElement(y.U,{includeInternal:!0,onChange:Le=>{xt(),(0,h.isString)(Le)&&Ue(Le)},onBlur:xt,menuShouldPortal:!1})):a.createElement("section",{"data-testid":i.Tp.components.TimeZonePicker.containerV2,className:(0,n.cx)(ct.timeZoneContainer,ct.timeSettingContainer)},a.createElement(g.D,{className:ct.fiscalYearField,label:(0,l.t)("time-picker.footer.fiscal-year-start","Fiscal year start month")},a.createElement(c.l6,{value:We,menuShouldPortal:!1,options:E.Z,onChange:Le=>{Me&&Me(Le.value??0)}})))):null):null},T=Oe=>({container:(0,n.css)({borderTop:`1px solid ${Oe.colors.border.weak}`,padding:"11px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}),editContainer:(0,n.css)({borderTop:`1px solid ${Oe.colors.border.weak}`,padding:"11px",justifyContent:"space-between",alignItems:"center"}),spacer:(0,n.css)({marginLeft:"7px"}),timeSettingContainer:(0,n.css)({paddingTop:Oe.spacing(1)}),fiscalYearField:(0,n.css)({marginBottom:0}),timeZoneContainer:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexGrow:1}),timeZone:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"baseline",flexGrow:1})});var M=e(42617),A=e(53531),x=e(72724),C=e(10354),O=e(56034),R=e(47619),L=e(18828),N=e(85690),F=e(93225),K=e(59875),B=e(88448),w=e(72265),U=e(67061);function W({onClose:Oe,onApply:Ne}){return a.createElement(U.B,{gap:2,justifyContent:"space-between"},a.createElement(b.$n,{variant:"secondary",onClick:Oe},a.createElement(l.x,{i18nKey:"time-picker.calendar.cancel-button"},"Cancel")),a.createElement(b.$n,{onClick:Ne},a.createElement(l.x,{i18nKey:"time-picker.calendar.apply-button"},"Apply time range")))}W.displayName="Footer";var V=e(29158);function _({onClose:Oe}){return a.createElement(U.B,{justifyContent:"space-between"},a.createElement(M.e,null,a.createElement(l.x,{i18nKey:"time-picker.calendar.select-time"},"Select a time range")),a.createElement(V.K,{"data-testid":i.Tp.components.TimePicker.calendar.closeButton,tooltip:(0,l.t)("time-picker.calendar.close","Close calendar"),name:"times",variant:"secondary",onClick:Oe}))}_.displayName="Header";const H=(Oe,Ne=!1)=>({container:(0,n.css)({top:0,position:"absolute",[`${Ne?"left":"right"}`]:"546px"}),modalContainer:(0,n.css)({label:"modalContainer",margin:"0 auto"}),calendar:(0,n.css)({display:"flex",flexDirection:"column",gap:Oe.spacing(1),padding:Oe.spacing(1),label:"calendar",boxShadow:Oe.shadows.z3,backgroundColor:Oe.colors.background.primary,border:`1px solid ${Oe.colors.border.weak}`,borderRadius:Oe.shape.radius.default}),modal:(0,n.css)({label:"modal",boxShadow:Oe.shadows.z3,left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)",zIndex:Oe.zIndex.modal})});function G(Oe){const Ne=(0,f.$j)(),{modalBackdrop:We}=(0,f.of)(B.o),Ae=H(Ne,Oe.isReversed),{isOpen:Ue,isFullscreen:Me,onClose:$e}=Oe,ke=a.createRef(),{dialogProps:Ze}=(0,L.s)({"aria-label":i.Tp.components.TimePicker.calendar.label},ke),{overlayProps:ot}=(0,F.e)({isDismissable:!0,isOpen:Ue,onClose:$e},ke),xt=!Me;if(!Ue)return null;const ct=a.createElement("section",{className:Ae.calendar,ref:ke,...ot,...Ze,"data-testid":i.Tp.components.TimePicker.calendar.label},a.createElement(_,{...Oe}),a.createElement(w.nB,{...Oe}),xt&&a.createElement(W,{...Oe}));return xt?a.createElement(K.Sf,null,a.createElement("div",{className:We}),a.createElement(N.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},a.createElement("div",{className:Ae.modal},a.createElement("div",{className:Ae.modalContainer},ct)))):a.createElement(N.n1,{contain:!0,restoreFocus:!0,autoFocus:!0},a.createElement("div",{className:Ae.container},ct))}const j=(0,a.memo)(G);G.displayName="TimePickerCalendar";const Y={default:()=>(0,l.t)("time-picker.range-content.default-error",'Please enter a past date or "now"'),range:()=>(0,l.t)("time-picker.range-content.range-error",`"From" can't be after "To"`)},oe=Oe=>{const{value:Ne,isFullscreen:We=!1,timeZone:Ae,onApply:Ue,isReversed:Me,fiscalYearStartMonth:$e,onError:ke}=Oe,[Ze,ot]=ne(Ne.raw.from,Ne.raw.to,Ae),xt=(0,f.of)(Z),[ct,ft]=(0,a.useState)(Ze),[Le,re]=(0,a.useState)(ot),[X,le]=(0,a.useState)(!1),be=(0,a.useId)(),De=(0,a.useId)();(0,a.useEffect)(()=>{const[Rt,_t]=ne(Ne.raw.from,Ne.raw.to,Ae);ft(Rt),re(_t)},[Ne.raw.from,Ne.raw.to,Ae]);const Te=(0,a.useCallback)(Rt=>{Rt.preventDefault(),le(!0)},[le]),we=(0,a.useCallback)(()=>{if(Le.invalid||ct.invalid)return;const Rt={from:ct.value,to:Le.value},_t=r.convertRawToRange(Rt,Ae,$e);Ue(_t)},[ct.invalid,ct.value,Ue,Ae,Le.invalid,Le.value,$e]),Ke=(0,a.useCallback)((Rt,_t)=>{const[nn,Kt]=ne(Rt,_t,Ae);ft(nn),re(Kt)},[Ae]),Ve=Rt=>{Rt.key==="Enter"&&we()},ht=()=>{const Rt={from:ct.value,to:Le.value};navigator.clipboard.writeText(JSON.stringify(Rt))},gt=async()=>{const Rt=await navigator.clipboard.readText();let _t;try{_t=JSON.parse(Rt)}catch{ke&&ke(Rt);return}const[nn,Kt]=ne(_t.from,_t.to,Ae);ft(nn),re(Kt)},bt=r.convertRawToRange({from:"now/fy",to:"now/fy"},Ae,$e),St=(0,l.t)("time-picker.range-content.fiscal-year","Fiscal year"),Je=a.createElement("div",{className:xt.tooltip},r.isFiscal(Ne)?a.createElement(O.m,{content:`${St}: ${bt.from.format("MMM-DD")} - ${bt.to.format("MMM-DD")}`},a.createElement(s.I,{name:"info-circle"})):null),rt=a.createElement(b.$n,{"aria-label":(0,l.t)("time-picker.range-content.open-input-calendar","Open calendar"),"data-testid":i.Tp.components.TimePicker.calendar.openButton,icon:"calendar-alt",variant:"secondary",type:"button",onClick:Te});return a.createElement("div",null,a.createElement("div",{className:xt.fieldContainer},a.createElement(g.D,{label:(0,l.t)("time-picker.range-content.from-input","From"),invalid:ct.invalid,error:ct.errorMessage},a.createElement(C.p,{id:be,onClick:Rt=>Rt.stopPropagation(),onChange:Rt=>Ke(Rt.currentTarget.value,Le.value),addonAfter:rt,onKeyDown:Ve,"data-testid":i.Tp.components.TimePicker.fromField,value:ct.value})),Je),a.createElement("div",{className:xt.fieldContainer},a.createElement(g.D,{label:(0,l.t)("time-picker.range-content.to-input","To"),invalid:Le.invalid,error:Le.errorMessage},a.createElement(C.p,{id:De,onClick:Rt=>Rt.stopPropagation(),onChange:Rt=>Ke(ct.value,Rt.currentTarget.value),addonAfter:rt,onKeyDown:Ve,"data-testid":i.Tp.components.TimePicker.toField,value:Le.value})),Je),a.createElement("div",{className:xt.buttonsContainer},a.createElement(b.$n,{"data-testid":i.Tp.components.TimePicker.copyTimeRange,icon:"copy",variant:"secondary",tooltip:(0,l.t)("time-picker.copy-paste.tooltip-copy","Copy time range to clipboard"),type:"button",onClick:ht}),a.createElement(b.$n,{"data-testid":i.Tp.components.TimePicker.pasteTimeRange,icon:"clipboard-alt",variant:"secondary",tooltip:(0,l.t)("time-picker.copy-paste.tooltip-paste","Paste time range"),type:"button",onClick:gt}),a.createElement(b.$n,{"data-testid":i.Tp.components.TimePicker.applyTimeRange,type:"button",onClick:we},a.createElement(l.x,{i18nKey:"time-picker.range-content.apply-button"},"Apply time range"))),a.createElement(j,{isFullscreen:We,isOpen:X,from:(0,A.b)(ct.value,{timeZone:Ae}),to:(0,A.b)(Le.value,{timeZone:Ae}),onApply:we,onClose:()=>le(!1),onChange:Ke,timeZone:Ae,isReversed:Me}))};function se(Oe,Ne,We){const Ae={from:Oe,to:Ne},Ue=r.convertRawToRange(Ae,We);return!(Ue.from.isSame(Ue.to)||Ue.from.isBefore(Ue.to))}function ne(Oe,Ne,We){const Ae=ee(Oe,We),Ue=ee(Ne,We),Me=!(0,R.f)(Ae,!1,We),$e=!(0,R.f)(Ue,!0,We),ke=se(Ae,Ue,We)&&!$e;return[{value:Ae,invalid:Me||ke,errorMessage:ke&&!Me?Y.range():Y.default()},{value:Ue,invalid:$e,errorMessage:Y.default()}]}function ee(Oe,Ne){return(0,o.Ar)(Oe)?(0,x.LE)(Oe,{timeZone:Ne}):Oe}function Z(Oe){return{fieldContainer:(0,n.css)({display:"flex"}),buttonsContainer:(0,n.css)({display:"flex",gap:Oe.spacing(.5),marginTop:Oe.spacing(1)}),tooltip:(0,n.css)({paddingLeft:Oe.spacing(1),paddingTop:Oe.spacing(3)})}}var z=e(11752);const q=(Oe,Ne)=>r.convertRawToRange({from:Oe.from,to:Oe.to},Ne),ie=(Oe,Ne)=>{const We=(0,x.LE)(Oe.from,{timeZone:Ne}),Ae=(0,x.LE)(Oe.to,{timeZone:Ne});return{from:We,to:Ae,display:`${We} to ${Ae}`}},de=Oe=>{const{quickOptions:Ne=[],isReversed:We,isFullscreen:Ae,hideQuickRanges:Ue,timeZone:Me,fiscalYearStartMonth:$e,value:ke,onChange:Ze,history:ot,showHistory:xt,className:ct,hideTimeZone:ft,onChangeTimeZone:Le,onChangeFiscalYearStartMonth:re}=Oe,X=!ot?.length,le=Ae&&xt||!Ae&&(xt&&!X||!Ue),be=(0,f.of)(pe,We,Ue,le,Ae),De=ce(ot,Me),Te=me(ke.raw,Ne),[we,Ke]=(0,a.useState)(""),Ve=Ne.filter(gt=>gt.display.toLowerCase().includes(we.toLowerCase())),ht=gt=>Ze(q(gt));return a.createElement("div",{id:"TimePickerContent",className:(0,n.cx)(be.container,ct)},a.createElement("div",{className:be.body},(!Ae||!Ue)&&a.createElement("div",{className:be.rightSide},a.createElement("div",{className:be.timeRangeFilter},a.createElement(m.Z,{width:0,value:we,onChange:Ke,placeholder:(0,l.t)("time-picker.content.filter-placeholder","Search quick ranges")})),a.createElement("div",{className:be.scrollContent},!Ae&&a.createElement(fe,{...Oe,historyOptions:De}),!Ue&&a.createElement(z.l,{options:Ve,onChange:ht,value:Te}))),Ae&&a.createElement("div",{className:be.leftSide},a.createElement(Se,{...Oe,historyOptions:De}))),!ft&&Ae&&a.createElement(S,{timeZone:Me,fiscalYearStartMonth:$e,onChangeTimeZone:Le,onChangeFiscalYearStartMonth:re}))},ue=Oe=>{const{widthOverride:Ne}=Oe,We=(0,f.$j)(),Ae=(Ne||window.innerWidth)>=We.breakpoints.values.lg;return a.createElement(de,{...Oe,isFullscreen:Ae})},fe=Oe=>{const{value:Ne,hideQuickRanges:We,onChange:Ae,timeZone:Ue,historyOptions:Me=[],showHistory:$e,onError:ke}=Oe,Ze=(0,f.of)(ye),ot=(0,o.Ar)(Ne.raw.from)||(0,o.Ar)(Ne.raw.to),[xt,ct]=(0,a.useState)(!ot),ft=We?!1:xt,Le=re=>Ae(q(re,Ue));return a.createElement("fieldset",null,a.createElement("div",{className:Ze.header},a.createElement("button",{type:"button",className:Ze.expandButton,onClick:()=>{We||ct(!ft)},"data-testid":i.Tp.components.TimePicker.absoluteTimeRangeTitle,"aria-expanded":!ft,"aria-controls":"expanded-timerange"},a.createElement(M.e,null,a.createElement(l.x,{i18nKey:"time-picker.absolute.title"},"Absolute time range")),!We&&a.createElement(s.I,{name:ft?"angle-down":"angle-up"}))),!ft&&a.createElement("div",{className:Ze.body,id:"expanded-timerange"},a.createElement("div",{className:Ze.form},a.createElement(oe,{value:Ne,onApply:Ae,timeZone:Ue,isFullscreen:!1,onError:ke})),$e&&a.createElement(z.l,{title:(0,l.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:Me,onChange:Le,placeholderEmpty:null})))},Se=Oe=>{const{onChange:Ne,value:We,timeZone:Ae,fiscalYearStartMonth:Ue,isReversed:Me,historyOptions:$e,onError:ke}=Oe,Ze=(0,f.of)(Pe,Oe.hideQuickRanges),ot=xt=>Ne(q(xt,Ae));return a.createElement(a.Fragment,null,a.createElement("div",{className:Ze.container},a.createElement("div",{className:Ze.title,"data-testid":i.Tp.components.TimePicker.absoluteTimeRangeTitle},a.createElement(M.e,null,a.createElement(l.x,{i18nKey:"time-picker.absolute.title"},"Absolute time range"))),a.createElement(oe,{value:We,timeZone:Ae,fiscalYearStartMonth:Ue,onApply:Ne,isFullscreen:!0,isReversed:Me,onError:ke})),Oe.showHistory&&a.createElement("div",{className:Ze.recent},a.createElement(z.l,{title:(0,l.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:$e||[],onChange:ot,placeholderEmpty:a.createElement(he,null)})))},he=(0,a.memo)(()=>{const Oe=(0,f.of)(Ie),Ne=(0,l.t)("time-picker.content.empty-recent-list-info","It looks like you haven't used this time picker before. As soon as you enter some time intervals, recently used intervals will appear here.");return a.createElement("div",{className:Oe.container},a.createElement("div",null,a.createElement("span",null,Ne)),a.createElement(l.x,{i18nKey:"time-picker.content.empty-recent-list-docs"},a.createElement("div",null,a.createElement("a",{className:Oe.link,href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls",target:"_new"},"Read the documentation"),a.createElement("span",null," to find out more about how to enter custom time ranges."))))});function ce(Oe,Ne){return!Array.isArray(Oe)||Oe.length===0?[]:Oe.map(We=>ie(We,Ne))}he.displayName="EmptyRecentList";const me=(Oe,Ne)=>(0,a.useMemo)(()=>{if(r.isRelativeTimeRange(Oe))return Ne.find(We=>We.from===Oe.from&&We.to===Oe.to)},[Oe,Ne]),pe=(Oe,Ne,We,Ae,Ue)=>({container:(0,n.css)({background:Oe.colors.background.primary,boxShadow:Oe.shadows.z3,width:`${Ue?"546px":"262px"}`,borderRadius:Oe.shape.radius.default,border:`1px solid ${Oe.colors.border.weak}`,[`${Ne?"left":"right"}`]:0,display:"flex",flexDirection:"column"}),body:(0,n.css)({display:"flex",flexDirection:"row-reverse",height:`${Ae?"381px":"217px"}`,maxHeight:"100vh"}),leftSide:(0,n.css)({display:"flex",flexDirection:"column",borderRight:`${Ne?"none":`1px solid ${Oe.colors.border.weak}`}`,width:`${We?"100%":"60%"}`,overflow:"auto",scrollbarWidth:"thin",order:Ne?1:0}),rightSide:(0,n.css)({width:`${Ue?"40%":"100%"}; !important`,borderRight:Ne?`1px solid ${Oe.colors.border.weak}`:"none",display:"flex",flexDirection:"column"}),timeRangeFilter:(0,n.css)({padding:Oe.spacing(1)}),spacing:(0,n.css)({marginTop:"16px"}),scrollContent:(0,n.css)({overflowY:"auto",scrollbarWidth:"thin"})}),ye=Oe=>({header:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottom:`1px solid ${Oe.colors.border.weak}`,padding:"7px 9px 7px 9px"}),expandButton:(0,n.css)({backgroundColor:"transparent",border:"none",display:"flex",width:"100%","&:focus-visible":(0,d.getFocusStyles)(Oe)}),body:(0,n.css)({borderBottom:`1px solid ${Oe.colors.border.weak}`}),form:(0,n.css)({padding:"7px 9px 7px 9px"})}),Pe=(Oe,Ne)=>({container:(0,n.css)({paddingTop:"9px",paddingLeft:"11px",paddingRight:Ne?"11px":"20%"}),title:(0,n.css)({marginBottom:"11px"}),recent:(0,n.css)({flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"flex-end",paddingTop:Oe.spacing(1)})}),Ie=Oe=>({container:(0,n.css)({padding:"12px",margin:"12px","a, span":{fontSize:"13px"}}),link:(0,n.css)({color:Oe.colors.text.link})})},42617:(Q,I,e)=>{"use strict";e.d(I,{e:()=>i});var n=e(32196),a=e(96540),o=e(40845);const r=f=>({text:(0,n.css)({fontSize:f.typography.size.md,fontWeight:f.typography.fontWeightMedium,color:f.colors.text.primary,margin:0,display:"flex"})}),i=(0,a.memo)(({children:f})=>{const d=(0,o.of)(r);return a.createElement("h3",{className:d.text},f)});i.displayName="TimePickerTitle"},3799:(Q,I,e)=>{"use strict";e.d(I,{f:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(15666),i=e(47619);const f=(0,a.memo)(function({hideText:m,value:s,timeZone:h="browser",placeholder:u="No time range selected",className:b}){const g=(0,o.of)(d);return m?null:a.createElement("span",{className:b},(0,i.X)(s)?a.createElement(r._8,{value:s,timeZone:h}):a.createElement("span",{className:g.placeholder},u))}),d=l=>({placeholder:(0,n.css)({color:l.colors.text.disabled,opacity:1})})},11752:(Q,I,e)=>{"use strict";e.d(I,{l:()=>b});var n=e(32196),a=e(96540),o=e(40845),r=e(76412),i=e(42617),f=e(62938),d=e(16797);const l=v=>({container:(0,n.css)({display:"flex",alignItems:"center",flexDirection:"row-reverse",justifyContent:"space-between"}),selected:(0,n.css)({background:v.colors.action.selected,fontWeight:v.typography.fontWeightMedium}),radio:(0,n.css)({opacity:0,width:"0 !important","&:focus-visible + label":(0,d.getFocusStyles)(v)}),label:(0,n.css)({cursor:"pointer",flex:1,padding:"7px 9px 7px 9px","&:hover":{background:v.colors.action.hover,cursor:"pointer"}})}),m=(0,a.memo)(({value:v,onSelect:D,selected:E=!1,name:S})=>{const T=(0,o.of)(l),M=(0,f.A)();return a.createElement("li",{className:(0,n.cx)(T.container,E&&T.selected)},a.createElement("input",{className:T.radio,checked:E,name:S,type:"checkbox","data-role":"item",tabIndex:-1,id:M,onChange:()=>D(v)}),a.createElement("label",{className:T.label,htmlFor:M},v.display))});m.displayName="TimeRangeOption";const s=(v,D)=>(v%D+D)%D,h=["ArrowUp","ArrowDown","Home","End","Enter","Tab"],u=({localRef:v,options:D})=>{const[E,S]=(0,a.useState)(0);return(0,a.useEffect)(()=>{const M=v.current?.querySelectorAll('[data-role="item"]')||[],A=Array.from(M).findIndex(C=>C.checked),x=A>=0?A:0;M.forEach((C,O)=>{C.tabIndex=O===x?0:-1}),S(x)},[v,D]),[M=>{const A=v?.current?.querySelectorAll('[data-role="item"]'),x=A?.length??0;h.indexOf(M.key)>-1&&(M.preventDefault(),M.key!=="Tab"&&M.stopPropagation());let C=null;switch(M.key){case"ArrowUp":C=s(E-1,x);break;case"ArrowDown":C=s(E+1,x);break;case"Home":C=0;break;case"End":C=x-1;break;case"Enter":A?.[E]?.click();break;default:break}C!==null&&(S(C),A?.[C]?.focus(),A?.forEach((O,R)=>{O.tabIndex=R===C?0:-1}))}]},b=v=>{const D=(0,o.of)(y),{title:E,options:S,placeholderEmpty:T}=v;return typeof T<"u"&&S.length<=0?a.createElement(a.Fragment,null,T):E?a.createElement("section",{"aria-label":E},a.createElement("fieldset",null,a.createElement("div",{className:D.title},a.createElement(i.e,null,E)),a.createElement(g,{...v}))):a.createElement(g,{...v})},g=({options:v,value:D,onChange:E,title:S})=>{const T=(0,o.of)(p),M=a.useRef(null),[A]=u({localRef:M,options:v});return a.createElement(a.Fragment,null,a.createElement("ul",{role:"presentation",onKeyDown:A,ref:M,"aria-roledescription":(0,r.t)("time-picker.time-range.aria-role","Time range selection")},v.map((x,C)=>a.createElement(m,{key:P(x,C),value:x,selected:c(x,D),onSelect:E,name:S??(0,r.t)("time-picker.time-range.default-title","Time ranges")}))),a.createElement("div",{className:T.grow}))};function P(v,D){return`${v.from}-${v.to}-${D}`}function c(v,D){return!D||!v?!1:D.from===v.from&&D.to===v.to}const y=()=>({title:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 16px 5px 9px"})}),p=()=>({grow:(0,n.css)({flexGrow:1,alignItems:"flex-start"})})},20333:(Q,I,e)=>{"use strict";e.d(I,{U:()=>v});var n=e(2543),a=e(96540),o=e(91410),r=e(76412),i=e(21594),f=e(32196),d=e(40845);const l=A=>{const{children:x,label:C}=A,O=(0,d.of)(m);return C?a.createElement("div",null,a.createElement("div",{className:O.header},a.createElement("span",{className:O.label},C)),x):a.createElement("div",null,x)},m=A=>({header:(0,f.css)({padding:"7px 10px",width:"100%",borderTop:`1px solid ${A.colors.border.weak}`,textTransform:"capitalize"}),label:(0,f.css)({fontSize:A.typography.size.sm,color:A.colors.text.secondary,fontWeight:A.typography.fontWeightMedium})});var s=e(17624),h=e(13544),u=e(14578),b=e(79451),g=e(67459);const P="tz-utc-offset",c=A=>{const{children:x,innerProps:C,innerRef:O,data:R,isSelected:L,isFocused:N}=A,F=(0,d.of)(p),K=Date.now(),B=(0,f.cx)(F.container,N&&F.containerFocused);if(!(0,n.isString)(R.value))return null;const w=(0,o.QZ)(R.value,K);return a.createElement("div",{className:B,...C,ref:O,"data-testid":h.Tp.components.Select.option},a.createElement("div",{className:(0,f.cx)(F.leftColumn,F.row)},a.createElement("div",{className:(0,f.cx)(F.leftColumn,F.wideRow)},a.createElement(g.U,{title:x}),a.createElement("div",{className:F.spacer}),a.createElement(b.E,{info:w})),a.createElement("div",{className:F.rightColumn},a.createElement(s.X,{timeZone:w?.ianaName||R.value,timestamp:K,className:P}),L&&a.createElement("span",null,a.createElement(u.I,{name:"check"})))))},y=A=>{const{children:x,innerProps:C,innerRef:O,data:R,isSelected:L,isFocused:N}=A,F=(0,d.of)(p),K=Date.now(),B=(0,f.cx)(F.container,N&&F.containerFocused);if(!(0,n.isString)(R.value))return null;const w=(0,o.QZ)(R.value,K);return a.createElement("div",{className:B,...C,ref:O,"data-testid":h.Tp.components.Select.option},a.createElement("div",{className:F.body},a.createElement("div",{className:F.row},a.createElement("div",{className:F.leftColumn},a.createElement(g.U,{title:x})),a.createElement("div",{className:F.rightColumn},L&&a.createElement("span",null,a.createElement(u.I,{name:"check"})))),a.createElement("div",{className:F.row},a.createElement("div",{className:F.leftColumn},a.createElement(b.E,{info:w})),a.createElement("div",{className:F.rightColumn},a.createElement(s.X,{timestamp:K,timeZone:w?.ianaName||R.value,className:P})))))},p=A=>({container:(0,f.css)({display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer",padding:"6px 8px 4px","&:hover":{background:A.colors.action.hover}}),containerFocused:(0,f.css)({background:A.colors.action.hover}),body:(0,f.css)({display:"flex",fontWeight:A.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),row:(0,f.css)({display:"flex",flexDirection:"row"}),leftColumn:(0,f.css)({flexGrow:1,textOverflow:"ellipsis"}),rightColumn:(0,f.css)({justifyContent:"flex-end",alignItems:"center"}),wideRow:(0,f.css)({display:"flex",flexDirection:"row",alignItems:"baseline"}),spacer:(0,f.css)({marginLeft:"6px"})}),v=A=>{const{onChange:x,width:C,autoFocus:O=!1,onBlur:R,value:L,includeInternal:N=!1,disabled:F=!1,inputId:K,menuShouldPortal:B=!0,openMenuOnFocus:w=!0}=A,U=D(N),W=E(U,L),V=T(),_=C&&C<=45?y:c,H=(0,a.useCallback)(G=>{if(!G||!(0,n.isString)(G.value))return x(L);x(G.value)},[x,L]);return a.createElement(i.l6,{inputId:K,value:W,placeholder:(0,r.t)("time-picker.zone.select-search-input","Type to search (country, city, abbreviation)"),autoFocus:O,menuShouldPortal:B,openMenuOnFocus:w,width:C,filterOption:V,options:U,onChange:H,onBlur:R,components:{Option:_,Group:l},disabled:F,"aria-label":(0,r.t)("time-picker.zone.select-aria-label","Time zone picker")})},D=A=>{const x=Date.now();return(0,o.U3)(A).map(O=>{const R=O.zones.reduce((L,N)=>{const F=(0,o.QZ)(N,x);return F&&L.push({label:F.name,value:F.zone,searchIndex:M(F,x)}),L},[]);return{label:O.name,options:R}})},E=(A,x)=>(0,a.useMemo)(()=>{if(x===void 0)return;const C=(0,n.toLower)(x);return A.find(R=>R.label?C.startsWith((0,n.toLower)(R.label)):S(C))?.options.find(R=>(0,n.isEmpty)(C)?R.value===o.g$.default:(0,n.toLower)(R.value)===C)},[A,x]),S=A=>{switch(A){case o.g$.default:case o.g$.localBrowserTime:case o.g$.utc:return!0;default:return!1}},T=()=>(0,a.useCallback)((A,x)=>!x||!A.data||!A.data.searchIndex?!0:A.data.searchIndex.indexOf((0,n.toLower)(x))>-1,[]),M=(A,x)=>{const C=[(0,n.toLower)(A.name),(0,n.toLower)(A.abbreviation),(0,n.toLower)((0,s.t)(x,A.zone))];for(const O of A.countries)C.push((0,n.toLower)(O.name)),C.push((0,n.toLower)(O.code));return C.join("|")}},79451:(Q,I,e)=>{"use strict";e.d(I,{E:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=({info:d})=>{const l=(0,o.of)(f),m=i(d);return d?a.createElement("div",{className:l.description},m):null},i=d=>(0,a.useMemo)(()=>{const l=[];if(!d)return"";if(d.name==="Europe/Simferopol")return"Ukraine, EEST";if(d.countries.length>0){const m=d.countries[0];l.push(m.name)}return d.abbreviation&&l.push(d.abbreviation),l.join(", ")},[d]),f=d=>({description:(0,n.css)({fontWeight:"normal",fontSize:d.typography.size.sm,color:d.colors.text.secondary,whiteSpace:"normal",textOverflow:"ellipsis"})})},17624:(Q,I,e)=>{"use strict";e.d(I,{X:()=>d,t:()=>l});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(72724),f=e(40845);const d=s=>{const{timestamp:h,timeZone:u,className:b}=s,g=(0,f.of)(m);return(0,a.isString)(u)?r.createElement(r.Fragment,null,r.createElement("span",{className:(0,n.cx)(g.offset,b)},l(h,u))):null},l=(s,h)=>`UTC${(0,i.LE)(s,{timeZone:h,format:"Z"})}`,m=s=>{const h=(0,n.css)({fontWeight:"normal",fontSize:s.typography.size.sm,color:s.colors.text.secondary,whiteSpace:"normal"});return{offset:(0,n.css)(h,{color:s.colors.text.primary,background:s.colors.background.secondary,padding:"2px 5px",borderRadius:s.shape.radius.default,marginLeft:"4px"})}}},67459:(Q,I,e)=>{"use strict";e.d(I,{U:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=({title:f})=>{const d=(0,o.of)(i);return f?a.createElement("span",{className:d.title},f):null},i=f=>({title:(0,n.css)({fontWeight:f.typography.fontWeightRegular,textOverflow:"ellipsis"})})},15648:(Q,I,e)=>{"use strict";e.d(I,{l:()=>i});var n=e(96540),a=e(13544),o=e(21594);const r=[{value:"",label:"Default"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"},{value:"monday",label:"Monday"}],i=f=>{const{onChange:d,width:l,autoFocus:m=!1,onBlur:s,value:h,disabled:u=!1,inputId:b}=f,g=(0,n.useCallback)(P=>{P.value!==void 0&&d(P.value)},[d]);return n.createElement(o.l6,{inputId:b,value:r.find(P=>P.value===h)?.value,placeholder:a.Tp.components.WeekStartPicker.placeholder,autoFocus:m,openMenuOnFocus:!0,width:l,options:r,onChange:g,onBlur:s,disabled:u})}},32432:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>a,o:()=>n});const n=[{from:"now-5m",to:"now",display:"Last 5 minutes"},{from:"now-15m",to:"now",display:"Last 15 minutes"},{from:"now-30m",to:"now",display:"Last 30 minutes"},{from:"now-1h",to:"now",display:"Last 1 hour"},{from:"now-3h",to:"now",display:"Last 3 hours"},{from:"now-6h",to:"now",display:"Last 6 hours"},{from:"now-12h",to:"now",display:"Last 12 hours"},{from:"now-24h",to:"now",display:"Last 24 hours"},{from:"now-2d",to:"now",display:"Last 2 days"},{from:"now-7d",to:"now",display:"Last 7 days"},{from:"now-30d",to:"now",display:"Last 30 days"},{from:"now-90d",to:"now",display:"Last 90 days"},{from:"now-6M",to:"now",display:"Last 6 months"},{from:"now-1y",to:"now",display:"Last 1 year"},{from:"now-2y",to:"now",display:"Last 2 years"},{from:"now-5y",to:"now",display:"Last 5 years"},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday"},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday"},{from:"now-7d/d",to:"now-7d/d",display:"This day last week"},{from:"now-1w/w",to:"now-1w/w",display:"Previous week"},{from:"now-1M/M",to:"now-1M/M",display:"Previous month"},{from:"now-1Q/fQ",to:"now-1Q/fQ",display:"Previous fiscal quarter"},{from:"now-1y/y",to:"now-1y/y",display:"Previous year"},{from:"now-1y/fy",to:"now-1y/fy",display:"Previous fiscal year"},{from:"now/d",to:"now/d",display:"Today"},{from:"now/d",to:"now",display:"Today so far"},{from:"now/w",to:"now/w",display:"This week"},{from:"now/w",to:"now",display:"This week so far"},{from:"now/M",to:"now/M",display:"This month"},{from:"now/M",to:"now",display:"This month so far"},{from:"now/y",to:"now/y",display:"This year"},{from:"now/y",to:"now",display:"This year so far"},{from:"now/fQ",to:"now",display:"This fiscal quarter so far"},{from:"now/fQ",to:"now/fQ",display:"This fiscal quarter"},{from:"now/fy",to:"now",display:"This fiscal year so far"},{from:"now/fy",to:"now/fy",display:"This fiscal year"}],a=[{label:"January",value:0},{label:"February",value:1},{label:"March",value:2},{label:"April",value:3},{label:"May",value:4},{label:"June",value:5},{label:"July",value:6},{label:"August",value:7},{label:"September",value:8},{label:"October",value:9},{label:"November",value:10},{label:"December",value:11}]},47619:(Q,I,e)=>{"use strict";e.d(I,{X:()=>i,f:()=>r});var n=e(47232),a=e(85858),o=e(53531);function r(f,d,l){return(0,n.Ar)(f)?f.isValid():a.isMathString(f)?a.isValid(f):(0,o.b)(f,{roundUp:d,timeZone:l}).isValid()}function i(f){return a.isValid(f.from)&&a.isValid(f.to)}},99225:(Q,I,e)=>{"use strict";e.d(I,{Q:()=>a});var n=e(91410);function a(o,r){const i=(0,n.HD)(r);if(!i)return o;const f=i.utcOffset(o.getTime()),d=o.getTimezoneOffset(),l=f-d;return new Date(o.getTime()-l*1e3*60)}},25994:(Q,I,e)=>{"use strict";e.d(I,{c:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=({direction:f="horizontal",spacing:d=2})=>{const l=(0,o.of)(i,d);return f==="vertical"?a.createElement("div",{className:l.verticalDivider}):a.createElement("hr",{className:l.horizontalDivider})};r.displayName="Divider";const i=(f,d)=>({horizontalDivider:(0,n.css)({borderTop:`1px solid ${f.colors.border.weak}`,margin:f.spacing(d,0),width:"100%"}),verticalDivider:(0,n.css)({borderRight:`1px solid ${f.colors.border.weak}`,margin:f.spacing(0,d),height:"100%"})})},69144:(Q,I,e)=>{"use strict";e.d(I,{l:()=>a});var n=e(32196);const a=(o,r)=>{const i=r||"middle",f=o.colors.emphasize(o.colors.background.secondary,.15),d=o.colors.primary.border,l=o.spacing(2),m=4,s=200;let h="50%",u="50%";switch(i){case"start":{h="0%",u="0%";break}case"end":{h="100%",u="100%";break}}const b=(0,n.css)({position:"relative","&:before":{content:'""',position:"absolute",transition:o.transitions.create("border-color"),zIndex:1},"&:after":{background:f,content:'""',position:"absolute",transition:o.transitions.create("background"),transform:"translate(-50%, -50%)",borderRadius:o.shape.radius.pill,zIndex:1},"&:hover":{"&:before":{borderColor:d},"&:after":{background:d}}});return{dragHandleVertical:(0,n.cx)(b,(0,n.css)({cursor:"col-resize",width:l,"&:before":{borderRight:"1px solid transparent",height:"100%",left:h,transform:"translateX(-50%)"},"&:after":{left:h,top:"50%",height:s,width:m}})),dragHandleHorizontal:(0,n.cx)(b,(0,n.css)({height:l,cursor:"row-resize","&:before":{borderTop:"1px solid transparent",top:u,transform:"translateY(-50%)",width:"100%"},"&:after":{left:"50%",top:u,height:m,width:s}}))}}},87978:(Q,I,e)=>{"use strict";e.d(I,{_:()=>P});var n=e(32196),a=e(18828),o=e(85690),r=e(93225),i=e(50848),f=e(96540),d=e(13544),l=e(40845),m=e(76412),s=e(40276),h=e(69144),u=e(29158),b=e(94753),g=e(24932);function P({children:S,onClose:T,closeOnMaskClick:M=!0,scrollableContent:A=!0,title:x,subtitle:C,width:O,size:R="md",tabs:L}){const[N,F,K]=c(),B=(0,l.of)(v),w=(0,l.of)(E,R,N??O),U=(0,l.of)(h.l),W=f.useRef(null),{dialogProps:V,titleProps:_}=(0,a.s)({},W),{overlayProps:H}=(0,r.e)({isDismissable:!1,isOpen:!0,onClose:T},W);p();const G=(0,n.cx)(B.drawer,w),j=f.createElement("div",{className:B.content},S);return f.createElement(i.A,{open:!0,onClose:T,placement:"right",getContainer:".main-view",className:B.drawerContent,rootClassName:G,width:"",motion:{motionAppear:!0,motionName:B.drawerMotion},maskClassName:B.mask,maskClosable:M,maskMotion:{motionAppear:!0,motionName:B.maskMotion}},f.createElement(o.n1,{restoreFocus:!0,contain:!0,autoFocus:!0},f.createElement("div",{"aria-label":typeof x=="string"?d.Tp.components.Drawer.General.title(x):d.Tp.components.Drawer.General.title("no title"),className:B.container,...H,...V,ref:W},f.createElement("div",{className:(0,n.cx)(U.dragHandleVertical,B.resizer),onMouseDown:F,onTouchStart:K}),typeof x=="string"&&f.createElement("div",{className:(0,n.cx)(B.header,!!L&&B.headerWithTabs)},f.createElement("div",{className:B.actions},f.createElement(u.K,{name:"times",variant:"secondary",onClick:T,"data-testid":d.Tp.components.Drawer.General.close,tooltip:(0,m.t)("grafana-ui.drawer.close","Close")})),f.createElement("div",{className:B.titleWrapper},f.createElement(b.E,{element:"h3",..._},x),C&&f.createElement("div",{className:B.subtitle,"data-testid":d.Tp.components.Drawer.General.subtitle},C),L&&f.createElement("div",{className:B.tabsWrapper},L))),typeof x!="string"&&x,A?f.createElement(s.E,null,j):j)))}function c(){const[S,T]=(0,f.useState)(void 0),M=(0,f.useCallback)(L=>{T(y(L.clientX))},[]),A=(0,f.useCallback)(L=>{const N=L.touches[0];T(y(N.clientX))},[]),x=(0,f.useCallback)(L=>{document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",x)},[M]),C=(0,f.useCallback)(L=>{document.removeEventListener("touchmove",A),document.removeEventListener("touchend",C)},[A]);function O(L){L.stopPropagation(),L.preventDefault(),document.addEventListener("mousemove",M),document.addEventListener("mouseup",x)}function R(L){L.stopPropagation(),L.preventDefault(),document.addEventListener("touchmove",A),document.addEventListener("touchend",C)}return[S,O,R]}function y(S){let T=document.body.offsetWidth-(S-document.body.offsetLeft);return`${Math.min(T/document.body.clientWidth*100,98).toFixed(2)}vw`}function p(){(0,f.useEffect)(()=>{if(document.body)return document.body.classList.add("body-drawer-open"),()=>{document.body.classList.remove("body-drawer-open")}},[])}const v=S=>({container:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",flex:"1 1 0",minHeight:"100%",position:"relative"}),drawer:(0,n.css)({".main-view &":{top:80},".main-view--search-bar-hidden &":{top:40},".main-view--chrome-hidden &":{top:0},".rc-drawer-content-wrapper":{boxShadow:S.shadows.z3}}),drawerContent:(0,n.css)({backgroundColor:`${S.colors.background.primary} !important`,display:"flex",overflow:"unset !important",flexDirection:"column"}),drawerMotion:(0,n.css)({"&-appear":{transform:"translateX(100%)",transition:"none !important","&-active":{transition:`${S.transitions.create("transform")} !important`,transform:"translateX(0)"}}}),mask:(0,n.css)({backgroundColor:"transparent",position:"fixed","&:before":{backgroundColor:`${S.components.overlay.background} !important`,backdropFilter:"blur(1px)",bottom:0,content:'""',left:0,position:"fixed",right:0,".main-view &":{top:80},".main-view--search-bar-hidden &":{top:40},".main-view--chrome-hidden &":{top:0}}}),maskMotion:(0,n.css)({"&-appear":{opacity:0,"&-active":{opacity:1,transition:S.transitions.create("opacity")}}}),header:(0,n.css)({label:"drawer-header",flexGrow:0,padding:S.spacing(2,2,3),borderBottom:`1px solid ${S.colors.border.weak}`}),headerWithTabs:(0,n.css)({borderBottom:"none"}),actions:(0,n.css)({position:"absolute",right:S.spacing(1),top:S.spacing(1)}),titleWrapper:(0,n.css)({label:"drawer-title",overflowWrap:"break-word"}),subtitle:(0,n.css)({label:"drawer-subtitle",color:S.colors.text.secondary,paddingTop:S.spacing(1)}),content:(0,n.css)({padding:S.spacing(2),height:"100%",flexGrow:1}),tabsWrapper:(0,n.css)({label:"drawer-tabs",paddingLeft:S.spacing(2),margin:S.spacing(1,-1,-3,-3)}),resizer:(0,n.css)({top:0,left:S.spacing(-1),bottom:0,position:"absolute",zIndex:S.zIndex.modal})}),D={sm:{width:"25vw",minWidth:384},md:{width:"50vw",minWidth:568},lg:{width:"75vw",minWidth:744}};function E(S,T,M){let A=M??D[T].width,x=D[T].minWidth;return(0,n.css)({".rc-drawer-content-wrapper":{label:`drawer-content-wrapper-${T}`,width:A,minWidth:x,overflow:"unset",[S.breakpoints.down("md")]:{width:`calc(100% - ${S.spacing(2)}) !important`,minWidth:0}}})}},9261:(Q,I,e)=>{"use strict";e.d(I,{f:()=>u});var n=e(32196),a=e(34743),o=e(36376),r=e(7315),i=e(85690),f=e(96540),d=e(40845),l=e(38138),m=e(64539),s=e(27746);const h=g=>{const{className:P,options:c,value:y,onChange:p,narrow:v,variant:D,...E}=g,S=(0,d.of)(b),[T,M]=(0,f.useState)(!1),A=[(0,a.cY)(0),(0,a.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,a.BN)()],{context:x,refs:C,floatingStyles:O}=(0,o.we)({open:T,placement:"bottom-end",onOpenChange:M,middleware:A,whileElementsMounted:r.ll}),R=(0,o.kp)(x),L=(0,o.s9)(x),{getReferenceProps:N,getFloatingProps:F}=(0,o.bv)([L,R]),K=B=>{p(B),M(!1)};return f.createElement("div",{className:S.wrapper},f.createElement(s.I,{className:P,isOpen:T,narrow:v,variant:D,ref:C.setReference,...N(),...E},y?.label||(y?.value!=null?String(y?.value):null)),T&&f.createElement("div",{className:S.menuWrapper,ref:C.setFloating,...F(),style:O},f.createElement(i.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},f.createElement(l.W,{tabIndex:-1,onClose:()=>M(!1)},c.map(B=>f.createElement(m.D,{key:`${B.value}`,label:B.label??String(B.value),onClick:()=>K(B),active:B.value===y?.value,ariaChecked:B.value===y?.value,ariaLabel:B.ariaLabel||B.label,disabled:B.isDisabled,component:B.component,role:"menuitemradio"}))))))};h.displayName="ButtonSelect";const u=f.memo(h),b=g=>({wrapper:(0,n.css)({position:"relative",display:"inline-flex"}),menuWrapper:(0,n.css)({zIndex:g.zIndex.dropdown})})},83122:(Q,I,e)=>{"use strict";e.d(I,{m:()=>h});var n=e(32196),a=e(34743),o=e(36376),r=e(7315),i=e(96540),f=e(86634),d=e(40845),l=e(67892),m=e(18976),s=e(17464);const h=i.memo(({children:b,overlay:g,placement:P,offset:c,onVisibleChange:y})=>{const[p,v]=(0,i.useState)(!1),D=(0,i.useRef)(null),E=(0,i.useCallback)(B=>{v(B),y?.(B)},[y]),S=[(0,a.cY)({mainAxis:c?.[0]??8,crossAxis:c?.[1]??0}),(0,a.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,a.BN)()],{context:T,refs:M,floatingStyles:A}=(0,o.we)({open:p,placement:(0,m.O)(P),onOpenChange:E,middleware:S,whileElementsMounted:r.ll}),x=(0,o.kp)(T),C=(0,o.s9)(T),{getReferenceProps:O,getFloatingProps:R}=(0,o.bv)([C,x]),L=150,N=(0,d.of)(u,L),F=()=>{E(!1)},K=B=>{B.key==="Tab"&&E(!1)};return i.createElement(i.Fragment,null,i.cloneElement(b,{ref:M.setReference,...O()}),p&&i.createElement(s.ZL,null,i.createElement(o.s3,{context:T},i.createElement("div",{ref:M.setFloating,style:A,onClick:F,onKeyDown:K},i.createElement(f.A,{nodeRef:D,appear:!0,in:!0,timeout:{appear:L,exit:0,enter:0},classNames:N},i.createElement("div",{ref:D},l.renderOrCallToRender(g,{...R()})))))))});h.displayName="Dropdown";const u=(b,g)=>({appear:(0,n.css)({opacity:"0",position:"relative",transformOrigin:"top",[b.transitions.handleMotion("no-preference")]:{transform:"scaleY(0.5)"}}),appearActive:(0,n.css)({opacity:"1",[b.transitions.handleMotion("no-preference")]:{transform:"scaleY(1)",transition:`transform ${g}ms cubic-bezier(0.2, 0, 0.2, 1), opacity ${g}ms cubic-bezier(0.2, 0, 0.2, 1)`}})})},41670:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=({children:f})=>{const d=(0,o.of)(i);return a.createElement("div",{className:d.container},f)},i=f=>({container:(0,n.css)({borderLeft:`3px solid ${f.colors.info.main}`,backgroundColor:`${f.colors.background.secondary}`,padding:f.spacing(2),minWidth:"350px",borderRadius:f.shape.radius.default,marginBottom:f.spacing(4)})})},69529:(Q,I,e)=>{"use strict";e.d(I,{p:()=>D});var n=e(32196),a=e(96540),o=e(8867),r=e(40845),i=e(90613),f=e(67061),d=e(94753),l=e(36348);const m=({width:T="auto",height:M})=>{const A=(0,r.of)(s);return a.createElement(o.default,{src:l,className:A.svg,height:M,width:T})};m.displayName="GrotCTA";const s=T=>({svg:(0,n.css)({"#grot-cta-cactus-1, #grot-cta-cactus-2":{fill:T.isDark?"#58558c":"#c9c5f4"}})});var h=e(22687);const u=-20,b=5,g=-5,P=5,c=({width:T="auto",height:M})=>{const A=(0,a.useRef)(null),x=(0,r.of)(y);return(0,a.useEffect)(()=>{const C=O=>{if(window.matchMedia("(prefers-reduced-motion: reduce").matches)return;const R=A.current?.querySelector("#grot-not-found-arm"),L=A.current?.querySelector("#grot-not-found-magnifier"),{clientX:N,clientY:F}=O,{innerWidth:K,innerHeight:B}=window,w=F/B,U=N/K,W=p(w,u,b),V=p(U,g,P);window.requestAnimationFrame(()=>{R?.setAttribute("style",`transform: rotate(${W}deg) translateX(${V}%)`),L?.setAttribute("style",`transform: rotate(${W}deg) translateX(${V}%)`)})};return window.addEventListener("mousemove",C),()=>{window.removeEventListener("mousemove",C)}},[]),a.createElement(o.default,{innerRef:A,src:h,className:x.svg,height:M,width:T})};c.displayName="GrotNotFound";const y=T=>({svg:(0,n.css)({"#grot-not-found-arm, #grot-not-found-magnifier":{transformOrigin:"center"}})}),p=(T,M,A)=>T*(A-M)+M;var v=e(9886);const D=({button:T,children:M,image:A,message:x,hideImage:C=!1,variant:O,role:R})=>{const L=(0,r.of)(S),N=A??E(O);return a.createElement(i.a,{paddingY:4,display:"flex",direction:"column",alignItems:"center",role:R},a.createElement("div",{className:L.container},!C&&N,a.createElement(f.B,{direction:"column",alignItems:"center"},a.createElement(d.E,{variant:"h4",textAlignment:"center"},x),M&&a.createElement(d.E,{color:"secondary",textAlignment:"center"},M)),T))};function E(T){switch(T){case"call-to-action":return a.createElement(m,{width:300});case"not-found":return a.createElement(c,{width:300});case"completed":return a.createElement(o.default,{src:v,width:300});default:throw new Error(`Unknown variant: ${T}`)}}const S=T=>({container:(0,n.css)({display:"flex",flexDirection:"column",alignItems:"center",gap:T.spacing(4),maxWidth:"600px"})})},66602:(Q,I,e)=>{"use strict";e.d(I,{Xc:()=>d,Xw:()=>f,tH:()=>i});var n=e(96540),a=e(32631),o=e(42418),r=e(52446);class i extends n.PureComponent{constructor(){super(...arguments),this.state={error:null,errorInfo:null}}componentDidCatch(m,s){a.P?.api?.pushError(m),this.setState({error:m,errorInfo:s}),this.props.onError&&this.props.onError(m)}componentDidUpdate(m){const{dependencies:s,onRecover:h}=this.props;if(this.state.error&&s&&m.dependencies){for(let u=0;u<s.length;u++)if(s[u]!==m.dependencies[u]){this.setState({error:null,errorInfo:null}),h&&h();break}}}render(){const{children:m}=this.props,{error:s,errorInfo:h}=this.state;return m({error:s,errorInfo:h})}}class f extends n.PureComponent{static{this.defaultProps={title:"An unexpected error happened",style:"alertbox"}}render(){const{title:m,children:s,style:h,dependencies:u}=this.props;return n.createElement(i,{dependencies:u},({error:b,errorInfo:g})=>g?h==="alertbox"?n.createElement(o.F,{title:m||""},n.createElement("details",{style:{whiteSpace:"pre-wrap"}},b&&b.toString(),n.createElement("br",null),g.componentStack)):n.createElement(r.D,{title:m||"",error:b,errorInfo:g}):s)}}function d(l,m={}){const s=h=>n.createElement(f,{...m},n.createElement(l,{...h}));return s.displayName="WithErrorBoundary",s}},52446:(Q,I,e)=>{"use strict";e.d(I,{D:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=({error:f,errorInfo:d,title:l})=>{const m=(0,o.of)(i);return a.createElement("div",{className:m},a.createElement("h2",null,l),a.createElement("details",{style:{whiteSpace:"pre-wrap"}},f&&f.toString(),a.createElement("br",null),d&&d.componentStack))};r.displayName="ErrorWithStack";const i=()=>(0,n.css)({width:"500px",margin:"64px auto"})},29678:(Q,I,e)=>{"use strict";e.d(I,{y:()=>r});var n=e(96540),a=e(41987),o=e(39938);const r=({featureState:f,tooltip:d})=>{const l=i(f);return n.createElement(o.E,{text:l.text,color:l.color,icon:l.icon,tooltip:d})};function i(f){switch(f){case a.Ay.alpha:return{text:"Alpha",icon:"exclamation-triangle",color:"orange"};case a.Ay.beta:return{text:"Beta",icon:"rocket",color:"blue"};case a.Ay.experimental:return{text:"Experimental",icon:"exclamation-triangle",color:"orange"};case a.Ay.preview:return{text:"Preview",icon:"rocket",color:"blue"};case a.Ay.privatePreview:return{text:"Private preview",icon:"rocket",color:"blue"}}}},37270:(Q,I,e)=>{"use strict";e.d(I,{gH:()=>u,wI:()=>P});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(20978),f=e(47172),d=e(83195),l=e(40845),m=e(42418),s=e(14578),h=e(95950);function u({options:D,children:E,readAs:S,onLoad:T,fileListRenderer:M,onFileRemove:A}){const[x,C]=(0,r.useState)([]),[O,R]=(0,r.useState)([]),L=(0,d.j_)("decbytes")(D?.maxSize?D?.maxSize:0),N=(0,r.useCallback)((Y,oe)=>{C(se=>se.map(ne=>(ne.id===Y.id&&oe(ne),ne)))},[]),F=(0,r.useCallback)((Y,oe,se)=>{let ne=Y.map(p);if(D?.multiple===!1?C(ne):C(ee=>[...ee,...ne]),H(oe),D?.onDrop)D.onDrop(Y,oe,se);else for(const ee of ne){const Z=new FileReader,z=()=>{S?Z[S](ee.file):Z.readAsText(ee.file)};N(ee,q=>{q.abortUpload=()=>{Z.abort()},q.retryUpload=()=>{N(ee,ie=>{ie.error=null,ie.progress=void 0}),z()}}),Z.onabort=()=>{N(ee,q=>{q.error=new DOMException("Aborted")})},Z.onprogress=q=>{N(ee,ie=>{ie.progress=q.loaded})},Z.onload=()=>{T?.(Z.result)},Z.onerror=()=>{N(ee,q=>{q.error=Z.error})},z()}},[T,D,S,N]),K=Y=>{const oe=x.filter(se=>Y.id!==se.id);C(oe),A?.(Y)},{getRootProps:B,getInputProps:w,isDragActive:U}=(0,i.VB)({...D,useFsAccessApi:!1,onDrop:F,accept:g(D?.accept)}),W=(0,l.$j)(),V=v(W,U),_=x.map(Y=>M?M(Y,K):r.createElement(h.I,{key:Y.id,file:Y,removeFile:K})),H=Y=>{let oe=[];Y.map(se=>{se.errors.map(ne=>{oe.findIndex(ee=>ee.code===ne.code&&ee.message===ne.message)===-1&&oe.push(ne)})}),R(oe)},G=Y=>r.createElement("div",{className:V.errorAlert},r.createElement(m.F,{title:"Upload failed",severity:"error",onRemove:j},Y.map(oe=>{switch(oe.code){case f.O4.FileTooLarge:return r.createElement("div",{key:oe.message+oe.code},"File is larger than ",(0,d.cN)(L));default:return r.createElement("div",{key:oe.message+oe.code},oe.message)}}))),j=()=>{R([])};return r.createElement("div",{className:V.container},r.createElement("div",{"data-testid":"dropzone",...B({className:V.dropzone})},r.createElement("input",{...w()}),E??r.createElement(P,{primaryText:c(x,D)})),O.length>0&&G(O),r.createElement("small",{className:(0,n.cx)(V.small,V.acceptContainer)},D?.maxSize&&`Max file size: ${(0,d.cN)(L)}`,D?.maxSize&&D?.accept&&r.createElement("span",{className:V.acceptSeparator},"|"),D?.accept&&y(D.accept)),_)}function b(D){return["txt","json","csv","xls","yml"].some(E=>D.match(E))?"text/plain":"application/octet-stream"}function g(D){return(0,a.isString)(D)?{[b(D)]:[D]}:Array.isArray(D)?D.reduce((E,S)=>{const T=b(S);return E[T]=E[T]?[...E[T],S]:[S],E},{}):D}function P({primaryText:D="Drop file here or click to upload",secondaryText:E=""}){const S=(0,l.$j)(),T=v(S);return r.createElement("div",{className:(0,n.cx)(T.defaultDropZone),"data-testid":"file-drop-zone-default-children"},r.createElement(s.I,{className:(0,n.cx)(T.icon),name:"upload",size:"xl"}),r.createElement("h6",{className:(0,n.cx)(T.primaryText)},D),r.createElement("small",{className:T.small},E))}function c(D,E){return E?.multiple===void 0||E?.multiple?"Upload file":D.length?"Replace file":"Upload file"}function y(D){return(0,a.isString)(D)?`Accepted file type: ${D}`:Array.isArray(D)?`Accepted file types: ${D.join(", ")}`:`Accepted file types: ${Object.values(D).flat().join(", ")}`}function p(D){return{id:(0,a.uniqueId)("file"),file:D,error:null}}function v(D,E){return{container:(0,n.css)({display:"flex",flexDirection:"column",width:"100%",padding:D.spacing(2),borderRadius:D.shape.radius.default,border:`1px dashed ${D.colors.border.strong}`,backgroundColor:E?D.colors.background.secondary:D.colors.background.primary,cursor:"pointer",alignItems:"center",justifyContent:"center"}),dropzone:(0,n.css)({height:"100%",width:"100%",display:"flex",flexDirection:"column"}),defaultDropZone:(0,n.css)({textAlign:"center"}),icon:(0,n.css)({marginBottom:D.spacing(1)}),primaryText:(0,n.css)({marginBottom:D.spacing(1)}),acceptContainer:(0,n.css)({textAlign:"center",margin:0}),acceptSeparator:(0,n.css)({margin:`0 ${D.spacing(1)}`}),small:(0,n.css)({color:D.colors.text.secondary}),errorAlert:(0,n.css)({paddingTop:"10px"})}}},95950:(Q,I,e)=>{"use strict";e.d(I,{I:()=>s});var n=e(32196),a=e(96540),o=e(83195),r=e(40845),i=e(53550),f=e(55852),d=e(14578),l=e(29158);const m="Remove file";function s({file:u,removeFile:b}){const g=(0,r.of)(h),{file:P,progress:c,error:y,abortUpload:p,retryUpload:v}=u,D=()=>y?a.createElement(a.Fragment,null,a.createElement("span",{className:g.error},y.message),v&&a.createElement(l.K,{name:"sync",tooltip:"Retry",tooltipPlacement:"top",onClick:v}),b&&a.createElement(l.K,{className:v?g.marginLeft:"",name:"trash-alt",onClick:()=>b(u),tooltip:m})):c&&P.size>c?a.createElement(a.Fragment,null,a.createElement("progress",{className:g.progressBar,max:P.size,value:c}),a.createElement("span",{className:g.paddingLeft},Math.round(c/P.size*100),"%"),p&&a.createElement(f.$n,{variant:"secondary",type:"button",fill:"text",onClick:p},"Cancel upload")):b&&a.createElement(l.K,{name:"trash-alt",onClick:()=>b(u),tooltip:m,tooltipPlacement:"top"}),E=(0,o.j_)("decbytes")(P.size);return a.createElement("div",{className:g.fileListContainer},a.createElement("span",{className:g.fileNameWrapper},a.createElement(d.I,{name:"file-blank",size:"lg","aria-hidden":!0}),a.createElement("span",{className:g.padding},(0,i.i)(P.name)),a.createElement("span",null,(0,o.cN)(E))),a.createElement("div",{className:g.fileNameWrapper},D()))}function h(u){return{fileListContainer:(0,n.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:u.spacing(2),border:`1px dashed ${u.colors.border.medium}`,backgroundColor:`${u.colors.background.secondary}`,marginTop:u.spacing(1)}),fileNameWrapper:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center"}),padding:(0,n.css)({padding:u.spacing(0,1)}),paddingLeft:(0,n.css)({paddingLeft:u.spacing(2)}),marginLeft:(0,n.css)({marginLeft:u.spacing(1)}),error:(0,n.css)({paddingRight:u.spacing(2),color:u.colors.error.text}),progressBar:(0,n.css)({borderRadius:u.shape.radius.default,height:"4px","::-webkit-progress-bar":{backgroundColor:u.colors.border.weak,borderRadius:u.shape.radius.default},"::-webkit-progress-value":{backgroundColor:u.colors.primary.main,borderRadius:u.shape.radius.default}})}}},92887:(Q,I,e)=>{"use strict";e.d(I,{IB:()=>a.I,gH:()=>n.gH,wI:()=>n.wI});var n=e(37270),a=e(95950)},73546:(Q,I,e)=>{"use strict";e.d(I,{e:()=>s});var n=e(32196),a=e(96540),o=e(62938),r=e(13544),i=e(40845),f=e(16797),d=e(53550),l=e(55852),m=e(14578);const s=({onFileUpload:u,className:b,children:g="Upload file",accept:P="*",size:c="md",showFileName:y})=>{const p=(0,i.of)(h(c)),[v,D]=(0,a.useState)(""),E=(0,o.A)(),S=(0,a.useCallback)(T=>{const M=T.currentTarget?.files?.[0];M&&D(M.name??""),u(T)},[u]);return a.createElement(a.Fragment,null,a.createElement("input",{type:"file",id:E,className:p.fileUpload,onChange:S,multiple:!1,accept:P,"data-testid":r.Tp.components.FileUpload.inputField}),a.createElement("label",{htmlFor:E,className:(0,n.cx)(p.labelWrapper,b)},a.createElement(m.I,{name:"upload",className:p.icon}),g),y&&v&&a.createElement("span",{"aria-label":"File name",className:p.fileName,"data-testid":r.Tp.components.FileUpload.fileNameSpan},(0,d.i)(v)))},h=u=>b=>{const g=(0,l.hs)({theme:b,variant:"primary",size:u,iconOnly:!1}),P=(0,f.getFocusStyles)(b);return{fileUpload:(0,n.css)({height:"0.1px",opacity:"0",overflow:"hidden",position:"absolute",width:"0.1px",zIndex:-1,"&:focus + label":P,"&:focus-visible + label":P}),labelWrapper:g.button,icon:g.icon,fileName:(0,n.css)({marginLeft:b.spacing(.5)})}}},67647:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>d});var n=e(96540),a=e(54479);function o(...l){const m=n.useRef(null);return n.useEffect(()=>{l.forEach(s=>{s&&(typeof s=="function"?s(m.current):s.current=m.current)})},[l]),m}var r=e(55852),i=e(14578),f=e(10354);const d=n.forwardRef(({value:l,width:m,onChange:s,escapeRegex:h=!0,...u},b)=>{const g=n.useRef(null),P=o(b,g),c=l!==""?n.createElement(r.$n,{icon:"times",fill:"text",size:"sm",onClick:y=>{g.current?.focus(),s(""),y.stopPropagation()}},"Clear"):null;return n.createElement(f.p,{prefix:n.createElement(i.I,{name:"search"}),suffix:c,width:m,type:"text",value:h?(0,a.xb)(l??""):l,onChange:y=>s(h?(0,a.jD)(y.currentTarget.value):y.currentTarget.value),...u,ref:P})});d.displayName="FilterInput"},92174:(Q,I,e)=>{"use strict";e.d(I,{m:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(55852),i=e(14578);const f=({label:l,selected:m,onClick:s,icon:h="check"})=>{const u=(0,o.of)(d),b=(0,o.of)(r.my);return a.createElement("button",{type:"button",className:(0,n.cx)(b,u.wrapper,m&&u.selected),onClick:s},a.createElement("span",null,l),m&&a.createElement(i.I,{name:h,className:u.icon}))},d=l=>({wrapper:(0,n.css)({background:l.colors.background.secondary,borderRadius:l.shape.radius.pill,padding:l.spacing(0,2),fontSize:l.typography.bodySmall.fontSize,fontWeight:l.typography.fontWeightMedium,lineHeight:l.typography.bodySmall.lineHeight,color:l.colors.text.secondary,display:"flex",alignItems:"center",height:"32px",position:"relative",border:`1px solid ${l.colors.background.secondary}`,whiteSpace:"nowrap","&:hover":{background:l.colors.action.hover,color:l.colors.text.primary}}),selected:(0,n.css)({color:l.colors.text.primary,background:l.colors.action.selected,"&:hover":{background:l.colors.action.focus}}),icon:(0,n.css)({marginLeft:l.spacing(.5)})})},90090:(Q,I,e)=>{"use strict";e.d(I,{z:()=>r});var n=e(32196),a=e(96540),o=e(38894);const r=({label:f,tooltip:d,labelWidth:l=6,inputWidth:m=12,inputEl:s,className:h,interactive:u,...b})=>{const g=i();return a.createElement("div",{className:(0,n.cx)(g.formField,h)},a.createElement(o.I,{width:l,tooltip:d,interactive:u},f),s||a.createElement("input",{type:"text",className:`gf-form-input ${m?`width-${m}`:""}`,...b,disabled:b.disabled}))};r.displayName="FormField";const i=()=>({formField:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative"})})},38894:(Q,I,e)=>{"use strict";e.d(I,{I:()=>d});var n=e(46942),a=e.n(n),o=e(96540),r=e(14578),i=e(56034);const d=({children:l,isFocused:m,isInvalid:s,className:h,htmlFor:u,tooltip:b,width:g,interactive:P,...c})=>{const y=a()(h,`gf-form-label width-${g||"10"}`,{"gf-form-label--is-focused":m,"gf-form-label--is-invalid":s});return o.createElement("label",{className:y,...c,htmlFor:u},l,b&&o.createElement(i.m,{placement:"top",content:b,theme:"info",interactive:P},o.createElement(r.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})))}},9286:(Q,I,e)=>{"use strict";e.d(I,{i:()=>o});var n=e(96540);function a(r){return r<20?.9:r<26?.8:.6}const o=({value:r,className:i,style:f,...d})=>{const l=(r.prefix??"").length>0,m=(r.suffix??"").length>0;let s;if(f&&f.fontSize&&typeof f.fontSize=="number"){const h=f.fontSize,u=a(h);s={fontSize:h*u}}return n.createElement("div",{className:i,style:f,...d},n.createElement("div",null,l&&n.createElement("span",null,r.prefix),n.createElement("span",null,r.text),m&&n.createElement("span",{style:s},r.suffix)))};o.displayName="FormattedDisplayValue"},10880:(Q,I,e)=>{"use strict";e.d(I,{S:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(16797),i=e(60029);const f=a.forwardRef(({label:l,description:m,value:s,htmlValue:h,onChange:u,disabled:b,className:g,indeterminate:P,invalid:c,...y},p)=>{const v=(0,a.useCallback)(S=>{u&&u(S)},[u]),D=(0,o.of)(d,c),E=P?"mixed":void 0;return a.createElement("label",{className:(0,n.cx)(D.wrapper,g)},a.createElement("div",{className:D.checkboxWrapper},a.createElement("input",{type:"checkbox",className:(0,n.cx)(D.input,P&&D.inputIndeterminate),checked:s,disabled:b,onChange:v,value:h,"aria-checked":E,...y,ref:p}),a.createElement("span",{className:D.checkmark})),l&&a.createElement("span",{className:D.label},l),m&&a.createElement("span",{className:D.description},m))}),d=(l,m=!1)=>{const s=(0,i.f)(l),h=2,u=1,b=g=>m?l.colors.error.border:g;return{wrapper:(0,n.css)({display:"inline-grid",alignItems:"center",columnGap:l.spacing(u),gridAutoRows:"max-content",position:"relative",verticalAlign:"middle"}),input:(0,n.css)({position:"absolute",zIndex:1,top:0,left:0,width:"100% !important",height:"100%",opacity:0,"&:focus + span, &:focus-visible + span":(0,r.getFocusStyles)(l),"&:focus:not(:focus-visible) + span":(0,r.getMouseFocusStyles)(l),"&:checked + span":{background:l.colors.primary.main,border:`1px solid ${b(l.colors.primary.main)}`,"&:hover":{background:l.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"4px",top:0,width:"6px",height:"12px",border:`solid ${l.colors.primary.contrastText}`,borderWidth:"0 3px 3px 0",transform:"rotate(45deg)"}},"&:disabled + span":{backgroundColor:l.colors.action.disabledBackground,cursor:"not-allowed",border:`1px solid ${b(l.colors.action.disabledBackground)}`,"&:hover":{backgroundColor:l.colors.action.disabledBackground},"&:after":{borderColor:l.colors.action.disabledText}}}),inputIndeterminate:(0,n.css)({"&[aria-checked='mixed'] + span":{border:`1px solid ${b(l.colors.primary.main)}`,background:l.colors.primary.main,"&:hover":{background:l.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"2px",right:"2px",top:"calc(50% - 1.5px)",height:"3px",border:`1.5px solid ${l.colors.primary.contrastText}`,backgroundColor:l.colors.primary.contrastText,width:"auto",transform:"none"}},"&:disabled[aria-checked='mixed'] + span":{backgroundColor:l.colors.action.disabledBackground,border:`1px solid ${b(l.colors.error.transparent)}`,"&:after":{borderColor:l.colors.action.disabledText}}}),checkboxWrapper:(0,n.css)({display:"flex",alignItems:"center",gridColumnStart:1,gridRowStart:1}),checkmark:(0,n.css)({position:"relative",zIndex:2,display:"inline-block",width:l.spacing(h),height:l.spacing(h),borderRadius:l.shape.radius.default,background:l.components.input.background,border:`1px solid ${b(l.components.input.borderColor)}`,"&:hover":{cursor:"pointer",borderColor:b(l.components.input.borderHover)}}),label:(0,n.cx)(s.label,(0,n.css)({gridColumnStart:2,gridRowStart:1,position:"relative",zIndex:2,cursor:"pointer",maxWidth:"fit-content",lineHeight:l.typography.bodySmall.lineHeight,marginBottom:0})),description:(0,n.cx)(s.description,(0,n.css)({gridColumnStart:2,gridRowStart:2,lineHeight:l.typography.bodySmall.lineHeight,marginTop:0}))}};f.displayName="Checkbox"},88575:(Q,I,e)=>{"use strict";e.d(I,{D:()=>d});var n=e(32196),a=e(96540),o=e(40845),r=e(67892),i=e(72093),f=e(60029);const d=a.forwardRef(({label:s,description:h,horizontal:u,invalid:b,loading:g,disabled:P,required:c,error:y,children:p,className:v,validationMessageHorizontalOverflow:D,htmlFor:E,...S},T)=>{const M=(0,o.of)(m),A=E??(0,r.getChildId)(p),x=typeof s=="string"?a.createElement(f.J,{htmlFor:A,description:h},`${s}${c?" *":""}`):s,C=l({invalid:b,disabled:P,loading:g});return a.createElement("div",{className:(0,n.cx)(M.field,u&&M.fieldHorizontal,v),...S},x,a.createElement("div",null,a.createElement("div",{ref:T},a.cloneElement(p,C)),b&&y&&!u&&a.createElement("div",{className:(0,n.cx)(M.fieldValidationWrapper,{[M.validationMessageHorizontalOverflow]:!!D})},a.createElement(i.P,null,y))),b&&y&&u&&a.createElement("div",{className:(0,n.cx)(M.fieldValidationWrapper,M.fieldValidationWrapperHorizontal,{[M.validationMessageHorizontalOverflow]:!!D})},a.createElement(i.P,null,y)))});d.displayName="Field";function l(s){for(const h in s)s[h]===void 0&&delete s[h];return s}const m=s=>({field:(0,n.css)({display:"flex",flexDirection:"column",marginBottom:s.spacing(2)}),fieldHorizontal:(0,n.css)({flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),fieldValidationWrapper:(0,n.css)({marginTop:s.spacing(.5)}),fieldValidationWrapperHorizontal:(0,n.css)({flex:"1 1 100%"}),validationMessageHorizontalOverflow:(0,n.css)({width:0,overflowX:"visible","& > *":{whiteSpace:"nowrap"}})})},95984:(Q,I,e)=>{"use strict";e.d(I,{E:()=>a});var n=e(49785);const a=({name:o,control:r,children:i,...f})=>{const{fields:d,append:l,prepend:m,remove:s,swap:h,move:u,insert:b}=(0,n.jz)({control:r,name:o,...f});return i({fields:d,append:l,prepend:m,remove:s,swap:h,move:u,insert:b})}},84167:(Q,I,e)=>{"use strict";e.d(I,{n:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(17408);const i=({label:d,children:l,className:m,...s})=>{const h=(0,o.of)(f);return a.createElement("fieldset",{className:(0,n.cx)(h.wrapper,m),...s},d&&a.createElement(r.s,null,d),l)},f=d=>({wrapper:(0,n.css)({marginBottom:d.spacing(4),"&:last-child":{marginBottom:0}})})},72093:(Q,I,e)=>{"use strict";e.d(I,{P:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(14578);const i=({children:d,horizontal:l,className:m})=>{const s=(0,o.of)(f),h=(0,n.cx)(l?s.horizontal:s.vertical,m);return a.createElement("div",{role:"alert",className:h},a.createElement(r.I,{className:s.fieldValidationMessageIcon,name:"exclamation-triangle"}),d)},f=d=>{const l=`
      font-size: ${d.typography.size.sm};
      font-weight: ${d.typography.fontWeightMedium};
      padding: ${d.spacing(.5,1)};
      color: ${d.colors.error.contrastText};
      background: ${d.colors.error.main};
      border-radius: ${d.shape.radius.default};
      position: relative;
      display: inline-block;
      align-self: flex-start;

      a {
        color: ${d.colors.error.contrastText};
        text-decoration: underline;
      }

      a:hover {
        text-decoration: none;
      }
    `;return{vertical:(0,n.css)(l,{margin:d.spacing(.5,0,0,0),"&:before":{content:'""',position:"absolute",left:"9px",top:"-5px",width:0,height:0,borderWidth:"0 4px 5px 4px",borderColor:`transparent transparent ${d.colors.error.main} transparent`,borderStyle:"solid"}}),horizontal:(0,n.css)(l,{marginLeft:"10px","&:before":{content:'""',position:"absolute",left:"-5px",top:"9px",width:0,height:0,borderWidth:"4px 5px 4px 0",borderColor:"transparent #e02f44 transparent transparent",borderStyle:"solid"}}),fieldValidationMessageIcon:(0,n.css)({marginRight:d.spacing()})}}},51253:(Q,I,e)=>{"use strict";e.d(I,{l:()=>r});var n=e(32196),a=e(96540),o=e(49785);function r({defaultValues:i,onSubmit:f,validateOnMount:d=!1,validateFieldsOnMount:l,children:m,validateOn:s="onSubmit",maxWidth:h=600,...u}){const{handleSubmit:b,trigger:g,formState:P,...c}=(0,o.mN)({mode:s,defaultValues:i});return(0,a.useEffect)(()=>{d&&g(l)},[g,l,d]),a.createElement("form",{className:(0,n.css)({maxWidth:h!=="none"?h+"px":h,width:"100%"}),onSubmit:b(f),...u},m({errors:P.errors,formState:P,trigger:g,...c}))}},14186:(Q,I,e)=>{"use strict";e.d(I,{I:()=>d});var n=e(32196),a=e(96540),o=e(40845),r=e(67892),i=e(72093),f=e(76892);const d=({children:m,label:s,tooltip:h,labelWidth:u="auto",invalid:b,loading:g,disabled:P,required:c,className:y,htmlFor:p,grow:v,shrink:D,error:E,transparent:S,interactive:T,...M})=>{const A=(0,o.$j)(),x=l(A,v,D),C=p??(0,r.getChildId)(m),O=typeof s=="string"?a.createElement(f.c,{interactive:T,width:u,tooltip:h,htmlFor:C,transparent:S},`${s}${c?" *":""}`):s;return a.createElement("div",{className:(0,n.cx)(x.container,y),...M},O,a.createElement("div",{className:x.childContainer},a.cloneElement(m,{invalid:b,disabled:P,loading:g}),b&&E&&a.createElement("div",{className:(0,n.cx)(x.fieldValidationWrapper)},a.createElement(i.P,null,E))))};d.displayName="InlineField";const l=(m,s,h)=>({container:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${s?1:0} ${h?1:0} auto`,margin:`0 ${m.spacing(.5)} ${m.spacing(.5)} 0`}),childContainer:(0,n.css)({flex:`${s?1:0} ${h?1:0} auto`}),fieldValidationWrapper:(0,n.css)({marginTop:m.spacing(.5)})})},39268:(Q,I,e)=>{"use strict";e.d(I,{C:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=({children:f,className:d,...l})=>{const m=(0,o.of)(i);return a.createElement("div",{className:(0,n.cx)(m.container,d),...l},f)},i=f=>({container:(0,n.css)({label:"InlineFieldRow",display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start",rowGap:f.spacing(.5)})})},76892:(Q,I,e)=>{"use strict";e.d(I,{c:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(14578),i=e(56034);const f=({children:l,className:m,tooltip:s,width:h,transparent:u,interactive:b,as:g="label",...P})=>{const c=(0,o.of)(d,u,h);return a.createElement(g,{className:(0,n.cx)(c.label,m),...P},l,s&&a.createElement(i.m,{interactive:b,placement:"top",content:s,theme:"info"},a.createElement(r.I,{tabIndex:0,name:"info-circle",size:"sm",className:c.icon})))},d=(l,m=!1,s)=>({label:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0,padding:l.spacing(0,1),fontWeight:l.typography.fontWeightMedium,fontSize:l.typography.size.sm,backgroundColor:m?"transparent":l.colors.background.secondary,height:l.spacing(l.components.height.md),lineHeight:l.spacing(l.components.height.md),marginRight:l.spacing(.5),borderRadius:l.shape.radius.default,border:"none",width:s?s!=="auto"?`${8*s}px`:s:"100%",color:l.colors.text.primary}),icon:(0,n.css)({color:l.colors.text.secondary,marginLeft:"10px",":hover":{color:l.colors.text.primary}})})},63056:(Q,I,e)=>{"use strict";e.d(I,{e:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=({children:f,className:d,grow:l,...m})=>{const s=(0,o.of)(i,l);return a.createElement("div",{className:(0,n.cx)(s.container,d),...m},f)};r.displayName="InlineSegmentGroup";const i=(f,d)=>({container:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${d?1:0} 0 auto`,marginBottom:f.spacing(.5)})})},60029:(Q,I,e)=>{"use strict";e.d(I,{J:()=>i,f:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(14578);const i=({children:d,description:l,className:m,category:s,...h})=>{const u=(0,o.of)(f),b=s?.map((g,P)=>a.createElement("span",{className:u.categories,key:`${g}/${P}`},a.createElement("span",null,g),a.createElement(r.I,{name:"angle-right",className:u.chevron})));return a.createElement("div",{className:(0,n.cx)(u.label,m)},a.createElement("label",{...h},a.createElement("div",{className:u.labelContent},b,d),l&&a.createElement("span",{className:u.description},l)))},f=d=>({label:(0,n.css)({label:"Label",fontSize:d.typography.size.sm,fontWeight:d.typography.fontWeightMedium,lineHeight:1.25,marginBottom:d.spacing(.5),color:d.colors.text.primary,maxWidth:"480px"}),labelContent:(0,n.css)({display:"flex",alignItems:"center"}),description:(0,n.css)({label:"Label-description",color:d.colors.text.secondary,fontSize:d.typography.size.sm,fontWeight:d.typography.fontWeightRegular,marginTop:d.spacing(.25),display:"block"}),categories:(0,n.css)({label:"Label-categories",display:"inline-flex",alignItems:"center"}),chevron:(0,n.css)({margin:d.spacing(0,.25)})})},91634:(Q,I,e)=>{"use strict";e.d(I,{O:()=>i,p:()=>f});var n=e(46942),a=e.n(n),o=e(96540),r=e(29734),i=(d=>(d.Invalid="invalid",d.Valid="valid",d))(i||{});class f extends o.PureComponent{constructor(){super(...arguments),this.state={error:null},this.validatorAsync=l=>m=>{const s=(0,r.tf)(m.target.value,l);this.setState(h=>({...h,error:s?s[0]:null}))},this.populateEventPropsWithStatus=(l,m)=>{const s={...l};return m&&Object.keys(r.Pw).forEach(h=>{((0,r.K)(h,m)||l[h])&&(s[h]=async u=>{u.persist(),(0,r.K)(h,m)&&await this.validatorAsync(m[h]).apply(this,[u]),l[h]&&l[h].apply(null,[u,this.status])})}),s}}static{this.defaultProps={className:""}}get status(){return this.state.error?"invalid":"valid"}get isInvalid(){return this.status==="invalid"}render(){const{validationEvents:l,className:m,hideErrorMessage:s,inputRef:h,...u}=this.props,{error:b}=this.state,g=a()("gf-form-input",{invalid:this.isInvalid},m),P=this.populateEventPropsWithStatus(u,l);return o.createElement("div",{style:{flexGrow:1}},o.createElement("input",{...P,ref:h,className:g}),b&&!s&&o.createElement("span",null,b))}}},24169:(Q,I,e)=>{"use strict";e.d(I,{A:()=>i,s:()=>r});var n=e(96540),a=e(28581),o=e(14578);const r=f=>{const d=f.selectProps.menuIsOpen;return n.createElement(a.c.IndicatorsContainer,{...f},n.createElement(o.I,{name:d?"angle-up":"angle-down",style:{marginTop:"7px"}}))},i=r},11206:(Q,I,e)=>{"use strict";e.d(I,{A:()=>r,l:()=>o});var n=e(96540),a=e(28581);const o=i=>{const{children:f}=i;return n.createElement(a.c.NoOptionsMessage,{...i},n.createElement("div",{className:"gf-form-select-box__desc-option"},n.createElement("div",{className:"gf-form-select-box__desc-option__body"},f)))},r=o},22209:(Q,I,e)=>{"use strict";e.d(I,{DW:()=>x,l6:()=>A});var n=e(46942),a=e.n(n),o=e(96540),r=e(28581),i=e(46005),f=e(8539),d=e(66963),l=e(60578),m=e(40276),s=e(62235),h=e(23731),u=e(56034),b=e(24169),g=e(11206),P=e(14578);const c=R=>{const{children:L,isSelected:N,data:F}=R;return o.createElement(r.c.Option,{...R},o.createElement("div",{className:"gf-form-select-box__desc-option"},F.imgUrl&&o.createElement("img",{className:"gf-form-select-box__desc-option__img",src:F.imgUrl,alt:""}),o.createElement("div",{className:"gf-form-select-box__desc-option__body"},o.createElement("div",null,L),F.description&&o.createElement("div",{className:"gf-form-select-box__desc-option__desc"},F.description)),N&&o.createElement(P.I,{name:"check","aria-hidden":"true"})))},y=null;var p=e(32196),v=e(3911),D=e(40845);const E=(0,v.N)(R=>({header:(0,p.css)({display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${R.colors.background.secondary}`,"&:hover":{color:R.colors.text.maxContrast}}),label:(0,p.css)({flexGrow:1}),icon:(0,p.css)({paddingRight:"2px"})}));class S extends o.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.onToggleChildren=()=>{this.setState(L=>({expanded:!L.expanded}))}}componentDidMount(){if(this.props.data.expanded)this.setState({expanded:!0});else if(this.props.selectProps&&this.props.selectProps.value){const{value:L}=this.props.selectProps.value;L&&this.props.options.some(N=>N.value===L)&&this.setState({expanded:!0})}}componentDidUpdate(L){L.selectProps.inputValue!==""&&this.setState({expanded:!0})}render(){const{children:L,label:N,theme:F}=this.props,{expanded:K}=this.state,B=E(F);return o.createElement("div",null,o.createElement("div",{className:B.header,onClick:this.onToggleChildren,role:"presentation"},o.createElement("span",{className:B.label},N),o.createElement(P.I,{className:B.icon,name:K?"angle-up":"angle-down"})),K&&L)}}const T=(0,D.cV)(S),M=R=>o.createElement(r.c.MenuList,{...R},o.createElement(m.E,{autoHide:!1,autoHeightMax:"inherit"},R.children));class A extends o.PureComponent{static{this.contextType=l.D}static{this.defaultProps={className:"",isDisabled:!1,isSearchable:!0,isClearable:!1,isMulti:!1,openMenuOnFocus:!1,autoFocus:!1,isLoading:!1,backspaceRemovesValue:!0,maxMenuHeight:300,tabSelectsValue:!0,allowCustomValue:!1,components:{Option:c,SingleValue:s.K,IndicatorsContainer:b.A,MenuList:M,Group:T}}}render(){const{defaultValue:L,getOptionLabel:N,getOptionValue:F,onChange:K,options:B,placeholder:w,width:U,value:W,className:V,isDisabled:_,isLoading:H,isSearchable:G,isClearable:j,backspaceRemovesValue:Y,isMulti:oe,autoFocus:se,openMenuOnFocus:ne,onBlur:ee,maxMenuHeight:Z,noOptionsMessage:z,isOpen:q,components:ie,tooltipContent:de,tabSelectsValue:ue,onCloseMenu:fe,onOpenMenu:Se,allowCustomValue:he,formatCreateLabel:ce,"aria-label":me}=this.props;let pe="";U&&(pe="width-"+U);let ye=i.Ay;const Pe={};he&&(ye=d.A,Pe.formatCreateLabel=ce??(Ne=>Ne));const Ie=a()("gf-form-input","gf-form-input--form-dropdown",pe,V),Oe={...A.defaultProps.components,...ie};return o.createElement(C,{onCloseMenu:fe,onOpenMenu:Se,tooltipContent:de,isOpen:q},(Ne,We)=>o.createElement(ye,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:Ie,components:Oe,defaultValue:L,value:W,getOptionLabel:N,getOptionValue:F,menuShouldScrollIntoView:!1,isSearchable:G,onChange:K,options:B,placeholder:w||"Choose",styles:(0,h.A)(this.context),isDisabled:_,isLoading:H,isClearable:j,autoFocus:se,onBlur:ee,openMenuOnFocus:ne,maxMenuHeight:Z,noOptionsMessage:z,isMulti:oe,backspaceRemovesValue:Y,menuIsOpen:q,onMenuOpen:Ne,onMenuClose:We,tabSelectsValue:ue,"aria-label":me,...Pe}))}}class x extends o.PureComponent{static{this.contextType=l.D}static{this.defaultProps={className:"",components:{},loadingMessage:()=>"Loading...",isDisabled:!1,isClearable:!1,isMulti:!1,isSearchable:!0,backspaceRemovesValue:!0,autoFocus:!1,openMenuOnFocus:!1,maxMenuHeight:300}}render(){const{defaultValue:L,getOptionLabel:N,getOptionValue:F,onChange:K,placeholder:B,width:w,value:U,className:W,loadOptions:V,defaultOptions:_,isLoading:H,loadingMessage:G,noOptionsMessage:j,isDisabled:Y,isSearchable:oe,isClearable:se,backspaceRemovesValue:ne,autoFocus:ee,onBlur:Z,openMenuOnFocus:z,maxMenuHeight:q,isMulti:ie,tooltipContent:de,onCloseMenu:ue,onOpenMenu:fe,isOpen:Se}=this.props;let he="";w&&(he="width-"+w);const ce=a()("gf-form-input","gf-form-input--form-dropdown",he,W);return o.createElement(C,{onCloseMenu:ue,onOpenMenu:fe,tooltipContent:de,isOpen:Se},(me,pe)=>o.createElement(f.A,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:ce,components:{Option:c,SingleValue:s.K,IndicatorsContainer:b.A,NoOptionsMessage:g.A},defaultValue:L,value:U,getOptionLabel:N,getOptionValue:F,menuShouldScrollIntoView:!1,onChange:K,loadOptions:V,isLoading:H,defaultOptions:_,placeholder:B||"Choose",styles:(0,h.A)(this.context),loadingMessage:G,noOptionsMessage:j,isDisabled:Y,isSearchable:oe,isClearable:se,autoFocus:ee,onBlur:Z,openMenuOnFocus:z,maxMenuHeight:q,isMulti:ie,backspaceRemovesValue:ne}))}}class C extends o.PureComponent{constructor(){super(...arguments),this.state={isOpenInternal:!1},this.onOpenMenu=()=>{const{onOpenMenu:L}=this.props;L&&L(),this.setState({isOpenInternal:!0})},this.onCloseMenu=()=>{const{onCloseMenu:L}=this.props;L&&L(),this.setState({isOpenInternal:!1})}}render(){const{children:L,isOpen:N,tooltipContent:F}=this.props,{isOpenInternal:K}=this.state;let B;return(K||N)&&(B=!1),F?o.createElement(u.m,{show:B,content:F,placement:"bottom"},o.createElement("div",null,L(this.onOpenMenu,this.onCloseMenu))):o.createElement("div",null,L(this.onOpenMenu,this.onCloseMenu))}}const O=null},74716:(Q,I,e)=>{"use strict";e.d(I,{d:()=>m});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(40845),f=e(14578),d=e(56034);class l extends r.PureComponent{constructor(){super(...arguments),this.state={id:(0,a.uniqueId)()},this.internalOnChange=u=>{u.stopPropagation(),this.props.onChange(u)}}render(){const{labelClass:u="",switchClass:b="",label:g,checked:P,disabled:c,transparent:y,className:p,theme:v,tooltip:D,tooltipPlacement:E}=this.props,S=s(v),T=this.state.id,M=`gf-form-label ${u} ${y?"gf-form-label--transparent":""} pointer`,A=(0,n.cx)(S.switch,b,{[S.switchTransparent]:y});return r.createElement("div",{className:S.container},r.createElement("label",{htmlFor:T,className:(0,n.cx)("gf-form",S.labelContainer,p)},g&&r.createElement("div",{className:M},g,D&&r.createElement(d.m,{placement:E||"auto",content:D,theme:"info"},r.createElement(f.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}}))),r.createElement("div",{className:A},r.createElement("input",{disabled:c,id:T,type:"checkbox",checked:P,onChange:this.internalOnChange}),r.createElement("span",{className:S.slider}))))}}const m=(0,i.cV)(l),s=h=>{const u=(0,n.css)({background:h.v1.palette.gray1,borderRadius:h.shape.radius.pill,height:"16px",width:"32px",display:"block",position:"relative","&::before":{position:"absolute",content:"''",height:"12px",width:"12px",left:"2px",top:"2px",background:h.components.input.background,transition:"0.4s",borderRadius:h.shape.radius.circle,boxShadow:h.shadows.z1}});return{container:(0,n.css)({display:"flex",flexShrink:0}),labelContainer:(0,n.css)({display:"flex",cursor:"pointer",marginRight:h.spacing(.5)}),switch:(0,n.css)({display:"flex",position:"relative",width:"56px",height:h.spacing(4),background:h.components.input.background,border:`1px solid ${h.components.input.borderColor}`,borderRadius:h.shape.radius.default,alignItems:"center",justifyContent:"center",input:{opacity:0,width:0,height:0},[`input:checked + .${u}`]:{background:h.colors.primary.main},[`input:checked + .${u}::before`]:{transform:"translateX(16px)"}}),switchTransparent:(0,n.css)({background:"transparent",border:0,width:"40px"}),slider:u}}},17408:(Q,I,e)=>{"use strict";e.d(I,{s:()=>i});var n=e(32196),a=e(96540),o=e(40845);const r=f=>({legend:(0,n.css)({fontSize:f.typography.h3.fontSize,fontWeight:f.typography.fontWeightRegular,margin:f.spacing(0,0,2,0)})}),i=({children:f,className:d,...l})=>{const m=(0,o.of)(r);return a.createElement("legend",{className:(0,n.cx)(m.legend,d),...l},f)}},94354:(Q,I,e)=>{"use strict";e.d(I,{z:()=>b});var n=e(32196),a=e(2543),o=e(96540),r=e(8887),i=e(40845),f=e(14578),d=e(13544),l=e(16797),m=e(56034),s=e(87266);const h=o.forwardRef(({children:P,active:c=!1,disabled:y=!1,size:p="md",onChange:v,onClick:D,id:E,name:S=void 0,description:T,fullWidth:M,"aria-label":A},x)=>{const C=(0,i.of)(u,p,M),O=o.createElement("input",{type:"radio",className:C.radio,onChange:v,onClick:D,disabled:y,id:E,checked:c,name:S,"aria-label":A,ref:x});return T?o.createElement("div",{className:C.radioOption,"data-testid":d.Tp.components.RadioButton.container},o.createElement(m.m,{content:T,placement:"bottom"},O),o.createElement("label",{className:C.radioLabel,htmlFor:E,title:T||A},P)):o.createElement("div",{className:C.radioOption,"data-testid":d.Tp.components.RadioButton.container},O,o.createElement("label",{className:C.radioLabel,htmlFor:E,title:T||A},P))});h.displayName="RadioButton";const u=(P,c,y)=>{const{fontSize:p,height:v,padding:D}=(0,s.SM)(c,P),E=P.colors.text.secondary,S=P.colors.text.primary,T=v*P.spacing.gridSize-4-2;return{radioOption:(0,n.css)({display:"flex",justifyContent:"space-between",position:"relative",flex:y?"1 0 0":"none",textAlign:"center"}),radio:(0,n.css)({position:"absolute",opacity:0,zIndex:2,width:"100% !important",height:"100%",cursor:"pointer","&:checked + label":{color:P.colors.text.primary,fontWeight:P.typography.fontWeightMedium,background:P.colors.action.selected,zIndex:1},"&:focus + label, &:focus-visible + label":(0,l.getFocusStyles)(P),"&:focus:not(:focus-visible) + label":(0,l.getMouseFocusStyles)(P),"&:disabled + label":{color:P.colors.text.disabled,cursor:"not-allowed"}}),radioLabel:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",fontSize:p,height:`${T}px`,lineHeight:`${T}px`,color:E,padding:P.spacing(0,D),borderRadius:P.shape.radius.default,background:P.colors.background.primary,cursor:"pointer",userSelect:"none",whiteSpace:"nowrap",flexGrow:1,"&:hover":{color:S}})}};function b({options:P,value:c,onChange:y,onClick:p,disabled:v,disabledOptions:D,size:E="md",id:S,className:T,fullWidth:M=!1,autoFocus:A=!1,"aria-label":x,invalid:C=!1}){const O=(0,o.useCallback)(B=>()=>{y&&y(B.value)},[y]),R=(0,o.useCallback)(B=>()=>{p&&p(B.value)},[p]),L=S??(0,a.uniqueId)("radiogroup-"),N=(0,o.useRef)(L),F=(0,i.of)(g),K=(0,o.useRef)(null);return(0,o.useEffect)(()=>{A&&K.current&&K.current.focus()},[A]),o.createElement("div",{role:"radiogroup","aria-label":x,className:(0,n.cx)(F.radioGroup,M&&F.fullWidth,C&&F.invalid,T)},P.map((B,w)=>{const U=D&&B.value&&D.includes(B.value),W=B.icon?(0,r.Uo)(B.icon):void 0,V=!!(B.imgUrl||B.label||B.component);return o.createElement(h,{size:E,disabled:U||v,active:c===B.value,key:`o.label-${w}`,"aria-label":B.ariaLabel,onChange:O(B),onClick:R(B),id:`option-${B.value}-${L}`,name:N.current,description:B.description,fullWidth:M,ref:c===B.value?K:void 0},W&&o.createElement(f.I,{name:W,className:(0,n.cx)(V&&F.icon)}),B.imgUrl&&o.createElement("img",{src:B.imgUrl,alt:B.label,className:F.img}),B.label," ",B.component?o.createElement(B.component,null):null)}))}b.displayName="RadioButtonGroup";const g=P=>({radioGroup:(0,n.css)({display:"inline-flex",flexDirection:"row",flexWrap:"nowrap",border:`1px solid ${P.components.input.borderColor}`,borderRadius:P.shape.radius.default,padding:"2px"}),fullWidth:(0,n.css)({display:"flex"}),icon:(0,n.css)({marginRight:"6px"}),img:(0,n.css)({width:P.spacing(2),height:P.spacing(2),marginRight:P.spacing(1)}),invalid:(0,n.css)({border:`1px solid ${P.colors.error.border}`})})},5173:(Q,I,e)=>{"use strict";e.d(I,{a:()=>d});var n=e(32196),a=e(2543),o=e(96540),r=e(40845);const i=({id:m,name:s,label:h,checked:u,value:b,disabled:g,description:P,onChange:c})=>{const y=(0,r.of)(f);return o.createElement("label",{title:P,className:y.label},o.createElement("input",{id:m,name:s,type:"radio",checked:u,value:b,disabled:g,className:y.input,onChange:()=>c&&c(m)}),o.createElement("div",null,h,P&&o.createElement("div",{className:y.description},P)))},f=m=>({input:(0,n.css)({position:"relative",appearance:"none",outline:"none",backgroundColor:m.colors.background.canvas,width:`${m.spacing(2)} !important`,height:m.spacing(2),border:`1px solid ${m.colors.border.medium}`,borderRadius:m.shape.radius.circle,margin:"3px 0",":checked":{backgroundColor:m.v1.palette.white,border:`5px solid ${m.colors.primary.main}`},":disabled":{backgroundColor:`${m.colors.action.disabledBackground} !important`,borderColor:m.colors.border.weak},":disabled:checked":{border:`1px solid ${m.colors.border.weak}`},":disabled:checked::after":{content:'""',width:"6px",height:"6px",backgroundColor:m.colors.text.disabled,borderRadius:m.shape.radius.circle,display:"inline-block",position:"absolute",top:"4px",left:"4px"},":focus":{outline:"none !important",boxShadow:`0 0 0 1px ${m.colors.background.canvas}, 0 0 0 3px ${m.colors.primary.main}`}}),label:(0,n.css)({fontSize:m.typography.fontSize,lineHeight:"22px",display:"grid",gridTemplateColumns:`${m.spacing(2)} auto`,gap:m.spacing(1)}),description:(0,n.css)({fontSize:m.typography.size.sm,color:m.colors.text.secondary})});function d({name:m,id:s,options:h,value:u,onChange:b,className:g,disabled:P,disabledOptions:c=[]}){const y=(0,r.of)(l),p=s??(0,a.uniqueId)("radiogroup-list-");return o.createElement("div",{id:s,className:(0,n.cx)(y.container,g),role:"radiogroup"},h.map((v,D)=>{const E=`${p}-${D}`,S=u&&u===v.value,T=P||c.some(A=>A===v.value),M=()=>b&&v.value&&b(v.value);return o.createElement(i,{key:D,id:E,name:m,label:v.label,description:v.description,checked:S,value:v.value,disabled:T,onChange:M})}))}const l=m=>({container:(0,n.css)({display:"grid",gap:m.spacing(1)})})},87266:(Q,I,e)=>{"use strict";e.d(I,{SM:()=>l,Xb:()=>r,g$:()=>i,gm:()=>o,lH:()=>f});var n=e(32196),a=e(16797);const o=m=>(0,n.css)({"&:focus":(0,a.getFocusStyles)(m)}),r=(m,s=!1)=>{const h=s?m.colors.error.border:m.components.input.borderColor,u=s?m.colors.error.shade:m.components.input.borderHover,b=m.components.input.background,g=m.components.input.text,P=m.isDark?"#2e2f35":"#bab4ca";return(0,n.cx)(i(m),(0,n.css)({background:b,lineHeight:m.typography.body.lineHeight,fontSize:m.typography.size.md,color:g,border:`1px solid ${h}`,"&:-webkit-autofill, &:-webkit-autofill:hover":{boxShadow:`inset 0 0 0 1px rgba(255, 255, 255, 0), inset 0 0 0 100px ${b}!important`,WebkitTextFillColor:`${g} !important`,borderColor:P},"&:-webkit-autofill:focus":{boxShadow:`0 0 0 2px ${m.colors.background.primary}, 0 0 0px 4px ${m.colors.primary.main}, inset 0 0 0 1px rgba(255, 255, 255, 0), inset 0 0 0 100px ${b}!important`,WebkitTextFillColor:`${g} !important`},"&:hover":{borderColor:u},"&:focus":{outline:"none"},"&:disabled":{backgroundColor:m.colors.action.disabledBackground,color:m.colors.action.disabledText,border:`1px solid ${m.colors.action.disabledBackground}`,"&:hover":{borderColor:h}},"&::placeholder":{color:m.colors.text.disabled,opacity:1}}))},i=m=>(0,n.css)({padding:m.spacing(0,1,0,1)}),f=()=>({sm:(0,n.css)({width:d("sm")}),md:(0,n.css)({width:d("md")}),lg:(0,n.css)({width:d("lg")}),auto:(0,n.css)({width:d("auto")})}),d=m=>{switch(m){case"sm":return"200px";case"md":return"320px";case"lg":return"580px";case"auto":default:return"auto"}};function l(m,s){switch(m){case"sm":return{padding:1,fontSize:s.typography.size.sm,height:s.components.height.sm};case"lg":return{padding:3,fontSize:s.typography.size.lg,height:s.components.height.lg};case"md":default:return{padding:2,fontSize:s.typography.size.md,height:s.components.height.md}}}},95164:(Q,I,e)=>{"use strict";e.d(I,{_:()=>P});var n=e(34796),a=e.n(n),o=e(96540),r=e(83195),i=e(58649),f=e(50082),d=e(52622),l=e(29413),m=e(55852),s=e(24293),h=e(47737);const u={mode:f.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]};function b(c,y,p,v){const D=p!=null,E=v===d.wV.Vertical?y:c,S=Math.min(E*.15/1.5,20),T=S*1.5,M=D?y-T:y,A=Math.min(M,c);return{showLabel:D,gaugeHeight:A,titleFontSize:S}}function g(c,y,p,v){if(y.color?.mode!==s.Y.Thresholds)return[{value:y.min??i.tw,color:p.color??s.F}];const D=y.thresholds??u,E=D.mode===f.O.Percentage,S=D.steps;let T=y.min??i.tw,M=y.max??i.d1;E&&(T=0,M=100);const A=(0,h.yQ)(T,S),x=(0,h.yQ)(M,S),C=[{value:+T.toFixed(c),color:v.visualization.getColorByName(A.color)}];let O=!0;for(let R=0;R<S.length;R++){const L=S[R];if(O){A===L&&(O=!1);continue}const N=S[R-1];if(C.push({value:L.value,color:v.visualization.getColorByName(N.color)}),L===x)break}return C.push({value:+M.toFixed(c),color:v.visualization.getColorByName(x.color)}),C}class P extends o.PureComponent{constructor(){super(...arguments),this.canvasElement=null,this.renderVisualization=()=>{const{width:y,value:p,height:v,onClick:D,text:E,theme:S,orientation:T}=this.props,M=b(y,v,p.title,T),A=T===d.wV.Vertical?`${M.gaugeHeight}px`:"100%",x=o.createElement("div",{style:{height:`${M.gaugeHeight}px`,width:A},ref:C=>this.canvasElement=C});return o.createElement(o.Fragment,null,D?o.createElement("button",{className:(0,m.my)(S),type:"button",onClick:D},x):x,M.showLabel&&o.createElement("div",{style:{textAlign:"center",fontSize:E?.titleSize??M.titleFontSize,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative",width:A,top:"-4px",cursor:"default"}},p.title))}}static{this.defaultProps={showThresholdMarkers:!0,showThresholdLabels:!1,field:{min:0,max:100,thresholds:u}}}componentDidMount(){this.draw()}componentDidUpdate(){this.draw()}draw(){const{field:y,showThresholdLabels:p,showThresholdMarkers:v,width:D,height:E,theme:S,value:T,orientation:M}=this.props,A=b(D,E,T.title),x=M===d.wV.Vertical?A.gaugeHeight:D,C=Math.min(x,A.gaugeHeight),O=S.colors.background.secondary,R=p?1.5:1,L=Math.min(C/5.5,40)/R,N=L/5,F=(0,r.cN)(T),B=Math.min(x,C*1.3)*.9-((L+(v?N:0)+(p?10:0))*2+10),w=this.props.text?.valueSize??(0,l.Vr)(F,B,C,1,L*1.7),U=Math.max(w/2.5,12);let W=y.min??i.tw,V=y.max??i.d1,_=T.numeric;y.thresholds?.mode===f.O.Percentage&&(W=0,V=100,T.percent===void 0?_=(_-W)/(V-W)*100:_=T.percent*100);const H=y.decimals===void 0?2:y.decimals;v&&(W=+W.toFixed(H),V=+V.toFixed(H));const G={series:{gauges:{gauge:{min:W,max:V,neutralValue:y.custom?.neutral,background:{color:O},border:{color:null},shadow:{show:!1},width:L},frame:{show:!1},label:{show:!1},layout:{margin:0,thresholdWidth:0,vMargin:0},cell:{border:{width:0}},threshold:{values:g(H,y,T,S),label:{show:p,margin:N+1,font:{size:U}},show:v,width:N},value:{color:T.color,formatter:()=>F,font:{size:w,family:S.typography.fontFamily}},show:!0}}},j={data:[[0,_]],label:T.title};try{this.canvasElement&&a().plot(this.canvasElement,[j],G)}catch(Y){console.error("Gauge rendering error",Y,G,T)}}render(){return o.createElement("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",overflow:"hidden"},className:this.props.className},this.renderVisualization())}}},14578:(Q,I,e)=>{"use strict";e.d(I,{I:()=>l});var n=e(32196),a=e(96540),o=e(8867),r=e(8887),i=e(40845),f=e(78318);const d=m=>({icon:(0,n.css)({display:"inline-block",fill:"currentColor",flexShrink:0,label:"Icon",lineHeight:0,verticalAlign:"middle"}),orange:(0,n.css)({fill:m.v1.palette.orange})}),l=a.forwardRef(({size:m="md",type:s="default",name:h,className:u,style:b,title:g="",...P},c)=>{const y=(0,i.of)(d);(0,r.n6)(h)||console.warn("Icon component passed an invalid icon name",h);const p=h==="fa fa-spinner"?"spinner":h,v=(0,f.Wj)(),D=(0,f.cs)(m),E=D,S=h.startsWith("gf-bar-align")?16:h.startsWith("gf-interp")?30:D,T=(0,f.Xi)(p,s),M=`${v}${T}/${p}.svg`,A=(0,n.cx)(y.icon,u,s==="mono"?{[y.orange]:h==="favorite"}:"",p==="spinner"&&"fa-spin");return a.createElement(o.default,{"aria-hidden":P.tabIndex===void 0&&!g&&!P["aria-label"]&&!P["aria-labelledby"]&&!P["aria-describedby"],innerRef:c,src:M,width:S,height:E,title:g,className:A,style:b,...P})});l.displayName="Icon"},78318:(Q,I,e)=>{"use strict";e.d(I,{Wj:()=>i,Xi:()=>a,cs:()=>o});const n=["grafana","favorite","heart-break","heart","panel-add","library-panel","circle-mono"];function a(f,d){return f?.startsWith("gf-")?"custom":n.includes(f)?"mono":d==="default"?"unicons":d==="solid"?"solid":"mono"}function o(f){switch(f){case"xs":return 12;case"sm":return 14;case"md":return 16;case"lg":return 18;case"xl":return 24;case"xxl":return 36;case"xxxl":return 48}}let r;function i(){if(r)return r;const f=typeof window<"u"&&window.__grafana_public_path__;return f?r=f+"img/icons/":r="public/img/icons/",r}},29158:(Q,I,e)=>{"use strict";e.d(I,{K:()=>s});var n=e(32196),a=e(96540),o=e(95344),r=e(23596),i=e(40845),f=e(16797),d=e(55852),l=e(78318),m=e(56034);const s=a.forwardRef((u,b)=>{const{size:g="md",variant:P="secondary"}=u;let c;g==="xxl"||g==="xxxl"?((0,o.l)("IconButton",'size="xxl" and size="xxxl"','size="xl"'),c="xl"):c=g;const y=(0,i.of)(h,c,P);let p,v;if("tooltip"in u){const{tooltip:D}=u;p=typeof D=="string"?D:void 0}else if("ariaLabel"in u||"aria-label"in u){const{ariaLabel:D,["aria-label"]:E}=u;p=E||D,v=b}if("tooltip"in u){const{name:D,iconType:E,className:S,tooltip:T,tooltipPlacement:M,...A}=u;return a.createElement(m.m,{ref:b,content:T,placement:M},a.createElement("button",{...A,ref:v,"aria-label":p,className:(0,n.cx)(y.button,S),type:"button"},a.createElement(d.Jt,{icon:D,size:c,className:y.icon,iconType:E})))}else{const{name:D,iconType:E,className:S,...T}=u;return a.createElement("button",{...T,ref:v,"aria-label":p,className:(0,n.cx)(y.button,S),type:"button"},a.createElement(d.Jt,{icon:D,size:c,className:y.icon,iconType:E}))}});s.displayName="IconButton";const h=(u,b,g)=>{const P=(0,l.cs)(b)+u.spacing.gridSize;let c=u.colors.text.primary;return g==="primary"?c=u.colors.primary.text:g==="destructive"&&(c=u.colors.error.text),{button:(0,n.css)({zIndex:0,position:"relative",margin:`0 ${u.spacing.x0_5} 0 0`,boxShadow:"none",border:"none",display:"inline-flex",background:"transparent",justifyContent:"center",alignItems:"center",padding:0,color:c,"&[disabled], &:disabled":{cursor:"not-allowed",color:u.colors.action.disabledText,opacity:.65},"&:before":{zIndex:-1,position:"absolute",opacity:0,width:`${P}px`,height:`${P}px`,borderRadius:u.shape.radius.default,content:'""',[u.transitions.handleMotion("no-preference","reduce")]:{transitionDuration:"0.2s",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionProperty:"opacity"}},"&:focus, &:focus-visible":(0,f.getFocusStyles)(u),"&:focus:not(:focus-visible)":(0,f.getMouseFocusStyles)(u),"&:hover":{"&:before":{backgroundColor:g==="secondary"?u.colors.action.hover:r.alpha(c,.12),opacity:1}}}),icon:(0,n.css)({verticalAlign:"baseline"})}}},86460:(Q,I,e)=>{"use strict";e.d(I,{e:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(29678),i=e(37166);const f=a.memo(a.forwardRef(({title:l,featureState:m,...s},h)=>{const u=(0,o.of)(d),b=m?a.createElement(a.Fragment,null,a.createElement("div",{className:u.badge},a.createElement(r.y,{featureState:m})),a.createElement("h3",null,l)):a.createElement("h3",null,l);return a.createElement(i.w,{branded:!0,title:b,urlTitle:"Read documentation",ref:h,...s})}));f.displayName="FeatureInfoBox";const d=l=>({badge:(0,n.css)({marginBottom:l.spacing(1)})})},37166:(Q,I,e)=>{"use strict";e.d(I,{w:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(42418),i=e(14578);const f=a.memo(a.forwardRef(({title:l,className:m,children:s,branded:h,url:u,urlTitle:b,onDismiss:g,severity:P="info",...c},y)=>{const p=(0,o.of)(d);return a.createElement(r.F,{severity:P,className:m,...c,ref:y,title:l},a.createElement("div",null,s),u&&a.createElement("a",{href:u,className:(0,n.cx)("external-link",p.docsLink),target:"_blank",rel:"noreferrer"},a.createElement(i.I,{name:"book"})," ",b||"Read more"))}));f.displayName="InfoBox";const d=l=>({docsLink:(0,n.css)({display:"inline-block",marginTop:l.spacing(2)})})},32982:(Q,I,e)=>{"use strict";e.d(I,{r:()=>m});var n=e(32196),a=e(34743),o=e(36376),r=e(7315),i=e(96540),f=e(40845),d=e(14578),l=e(17464);function m({referenceElement:u,children:b,suffixIcon:g,placement:P}){const c=(0,f.of)(s),y=(0,f.$j)(),p=[(0,a.cY)(8),(0,a.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,a.BN)()],{context:v,refs:D,floatingStyles:E}=(0,o.we)({open:!0,placement:P,middleware:p,whileElementsMounted:r.ll,strategy:"fixed"});(0,i.useLayoutEffect)(()=>{D.setReference(u)},[u,D]);const{styles:S}=(0,o.DL)(v,{initial:({side:T})=>({opacity:0,transform:h(T,y)}),duration:y.transitions.duration.shortest});return i.createElement(l.ZL,null,i.createElement("div",{style:{display:"inline-block",...E},ref:D.setFloating,"aria-live":"polite"},i.createElement("span",{className:(0,n.cx)(c.root),style:S},b&&i.createElement("span",null,b),g&&i.createElement(d.I,{name:g}))))}const s=u=>({root:(0,n.css)({...u.typography.bodySmall,willChange:"transform",background:u.components.tooltip.background,color:u.components.tooltip.text,padding:u.spacing(.5,1.5),borderRadius:u.shape.radius.pill,display:"inline-flex",gap:u.spacing(.5),alignItems:"center"})}),h=(u,b)=>{switch(u){case"top":return`translateY(${b.spacing(1)})`;case"bottom":return`translateY(-${b.spacing(1)})`;case"left":return`translateX(${b.spacing(1)})`;case"right":return`translateX(-${b.spacing(1)})`}}},51440:(Q,I,e)=>{"use strict";e.d(I,{D:()=>r});var n=e(96540),a=e(29413),o=e(10354);const r=n.forwardRef((f,d)=>{const{defaultValue:l="",minWidth:m=10,maxWidth:s,onCommitChange:h,onKeyDown:u,onBlur:b,...g}=f,[P,c]=n.useState(l),[y,p]=n.useState(m);return(0,n.useEffect)(()=>{p(i(P.toString(),m,s))},[P,s,m]),n.createElement(o.p,{...g,ref:d,value:P.toString(),onChange:v=>{c(v.currentTarget.value)},width:y,onBlur:v=>{b?b(v):h&&h(v)},onKeyDown:v=>{u?u(v):v.key==="Enter"&&h&&h(v)},"data-testid":"autosize-input"})});function i(f,d,l){if(!f)return d;const s=(0,a.kD)(f.toString(),14).width/8+3;return d&&s<d?d:l&&s>l?l:s}r.displayName="AutoSizeInput"},10354:(Q,I,e)=>{"use strict";e.d(I,{n:()=>m,p:()=>l});var n=e(32196),a=e(96540),o=e(71473),r=e(40845),i=e(3911),f=e(87266),d=e(62930);const l=a.forwardRef((s,h)=>{const{className:u,addonAfter:b,addonBefore:g,prefix:P,suffix:c,invalid:y,loading:p,width:v=0,...D}=s,[E,S]=(0,o.A)(),[T,M]=(0,o.A)(),A=(0,r.$j)(),x=m({theme:A,invalid:!!y,width:v});return a.createElement("div",{className:(0,n.cx)(x.wrapper,u),"data-testid":"input-wrapper"},!!g&&a.createElement("div",{className:x.addon},g),a.createElement("div",{className:x.inputWrapper},P&&a.createElement("div",{className:x.prefix,ref:E},P),a.createElement("input",{ref:h,className:x.input,...D,style:{paddingLeft:P?S.width+12:void 0,paddingRight:c||p?M.width+12:void 0}}),(c||p)&&a.createElement("div",{className:x.suffix,ref:T},p&&a.createElement(d.y,{className:x.loadingIndicator,inline:!0}),c)),!!b&&a.createElement("div",{className:x.addon},b))});l.displayName="Input";const m=(0,i.N)(({theme:s,invalid:h=!1,width:u})=>{const b="28px",g=(0,n.css)({position:"absolute",top:0,zIndex:1,display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0,fontSize:s.typography.size.md,height:"100%",minWidth:b,color:s.colors.text.secondary});return{wrapper:(0,n.cx)((0,n.css)({label:"input-wrapper",display:"flex",width:u?s.spacing(u):"100%",height:s.spacing(s.components.height.md),borderRadius:s.shape.radius.default,"&:hover":{"> .prefix, .suffix, .input":{borderColor:h?s.colors.error.border:s.colors.primary.border},"input[type='number']":{appearance:"textfield"},"input[type='number']::-webkit-inner-spin-button, input[type='number']::-webkit-outer-spin-button":{WebkitAppearance:"inner-spin-button !important",opacity:1}}})),inputWrapper:(0,n.css)({label:"input-inputWrapper",position:"relative",flexGrow:1,zIndex:1,"&:not(:first-child):last-child":{"> input":{borderLeft:"none",borderTopLeftRadius:0,borderBottomLeftRadius:0}},"&:first-child:not(:last-child)":{"> input":{borderRight:"none",borderTopRightRadius:0,borderBottomRightRadius:0}},"&:not(:first-child):not(:last-child)":{"> input":{borderRight:"none",borderTopRightRadius:0,borderBottomRightRadius:0,borderTopLeftRadius:0,borderBottomLeftRadius:0}},input:{"&:not(:first-child)":{paddingLeft:b},"&:not(:last-child)":{paddingRight:b},"&[readonly]":{cursor:"default"}}}),input:(0,n.cx)((0,f.gm)(s),(0,f.Xb)(s,h),(0,n.css)({label:"input-input",position:"relative",zIndex:0,flexGrow:1,borderRadius:s.shape.radius.default,height:"100%",width:"100%"})),inputDisabled:(0,n.css)({backgroundColor:s.colors.action.disabledBackground,color:s.colors.action.disabledText,border:`1px solid ${s.colors.action.disabledBackground}`,"&:focus":{boxShadow:"none"}}),addon:(0,n.css)({label:"input-addon",display:"flex",justifyContent:"center",alignItems:"center",flexGrow:0,flexShrink:0,position:"relative","&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0,"> :last-child":{borderTopRightRadius:0,borderBottomRightRadius:0}},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0,"> :first-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0}},"> *:focus":{zIndex:2}}),prefix:(0,n.cx)(g,(0,n.css)({label:"input-prefix",paddingLeft:s.spacing(1),paddingRight:s.spacing(.5),borderRight:"none",borderTopRightRadius:0,borderBottomRightRadius:0})),suffix:(0,n.cx)(g,(0,n.css)({label:"input-suffix",paddingLeft:s.spacing(1),paddingRight:s.spacing(1),marginBottom:"-2px",borderLeft:"none",borderTopLeftRadius:0,borderBottomLeftRadius:0,right:0})),loadingIndicator:(0,n.css)({"& + *":{marginLeft:s.spacing(.5)}})}})},16504:(Q,I,e)=>{"use strict";e.d(I,{e:()=>a});var n=e(49785);const a=n.xI},48840:(Q,I,e)=>{"use strict";e.d(I,{j:()=>y});var n=e(32196),a=e(2543),o=e(96540),r=e(32885),i=e(39070),f=e(40845),d=e(14578),l=e(19384),m=e(56034),s=e(29158);const h=(0,n.css)({display:"flex",alignItems:"center",height:"100%"});function u({row:E,__rowID:S}){return o.createElement("div",{className:h},o.createElement(s.K,{tooltip:"toggle row expanded","aria-controls":S,name:E.isExpanded?"angle-down":"angle-right","aria-expanded":E.isExpanded,...E.getToggleRowExpandedProps(),size:"lg"}))}function b({isAllRowsExpanded:E,toggleAllRowsExpanded:S}){return o.createElement("div",{className:h},o.createElement(s.K,{"aria-label":E?"Collapse all rows":"Expand all rows",name:E?"table-collapse-all":"table-expand-all",onClick:()=>S(),size:"lg",tooltip:E?"Collapse all rows":"Expand all rows",variant:"secondary"}))}const g="__expander";function P(E,S=!1){return[{id:g,Cell:u,...S&&{Header:b},disableSortBy:!0,width:0},...E.map(T=>({id:T.id,accessor:T.id,Header:T.header||(()=>null),sortType:T.sortType||"alphanumeric",disableSortBy:!T.sortType,width:T.disableGrow?0:void 0,visible:T.visible,...T.cell&&{Cell:T.cell}}))]}const c=E=>{const S=E.colors.emphasize(E.colors.background.primary,.03);return{container:(0,n.css)({display:"flex",gap:E.spacing(2),flexDirection:"column",width:"100%",overflowX:"auto"}),cell:(0,n.css)({padding:E.spacing(1),minWidth:E.spacing(3)}),table:(0,n.css)({borderRadius:E.shape.radius.default,width:"100%"}),disableGrow:(0,n.css)({width:0}),header:(0,n.css)({borderBottom:`1px solid ${E.colors.border.weak}`,minWidth:E.spacing(3),"&, & > button":{position:"relative",whiteSpace:"nowrap",padding:E.spacing(1)},"& > button":{"&:after":{content:'"\\00a0"'},width:"100%",height:"100%",background:"none",border:"none",paddingRight:E.spacing(2.5),textAlign:"left",fontWeight:E.typography.fontWeightMedium}}),row:(0,n.css)({label:"row",borderBottom:`1px solid ${E.colors.border.weak}`,"&:hover":{backgroundColor:S},"&:last-child":{borderBottom:0}}),expandedRow:(0,n.css)({label:"expanded-row-content",borderBottom:"none"}),expandedContentCell:(0,n.css)({borderBottom:`1px solid ${E.colors.border.weak}`,position:"relative",padding:E.spacing(2,2,2,5),"&:before":{content:'""',position:"absolute",width:"1px",top:0,left:"16px",bottom:E.spacing(2),background:E.colors.border.medium}}),expandedContentRow:(0,n.css)({label:"expanded-row-content"}),sortableHeader:(0,n.css)({"&&":{padding:0}})}};function y({className:E,columns:S,data:T,getRowId:M,headerTooltips:A,pageSize:x=0,renderExpandedRow:C,showExpandAll:O=!1,fetchData:R}){const L=(0,f.of)(c),N=(0,o.useMemo)(()=>P(S,O),[S,O]),F=p(),K=(0,o.useCallback)(Y=>`${F}-${Y.id}`.replace(/\s/g,""),[F]),B=[r.useSortBy,r.useExpanded],w=T.length>x,U=x>0;U&&B.push(r.usePagination);const W=(0,r.useTable)({columns:N,data:T,autoResetExpanded:!1,autoResetSortBy:!1,disableMultiSort:!0,manualSortBy:!!R,getRowId:M,initialState:{hiddenColumns:[!C&&g,...N.filter(Y=>!(!Y.visible||Y.visible(T))).map(Y=>Y.id).filter(i.zz)].filter(i.zz)}},...B),{getTableProps:V,getTableBodyProps:_,headerGroups:H,prepareRow:G}=W,{sortBy:j}=W.state;return(0,o.useEffect)(()=>{R&&R({sortBy:j})},[j,R]),(0,o.useEffect)(()=>{U&&W.setPageSize(x)},[U,x,W.setPageSize,W]),o.createElement("div",{className:L.container},o.createElement("table",{...V(),className:(0,n.cx)(L.table,E)},o.createElement("thead",null,H.map(Y=>{const{key:oe,...se}=Y.getHeaderGroupProps();return o.createElement("tr",{key:oe,...se},Y.headers.map(ne=>{const{key:ee,...Z}=ne.getHeaderProps(),z=A?.[ne.id];return o.createElement("th",{key:ee,className:(0,n.cx)(L.header,{[L.disableGrow]:ne.width===0,[L.sortableHeader]:ne.canSort}),...Z,...ne.isSorted&&{"aria-sort":ne.isSortedDesc?"descending":"ascending"}},o.createElement(D,{column:ne,headerTooltip:z}))}))})),o.createElement("tbody",{..._()},(U?W.page:W.rows).map(Y=>{G(Y);const{key:oe,...se}=Y.getRowProps(),ne=K(Y),ee=Y.isExpanded;return o.createElement(o.Fragment,{key:oe},o.createElement("tr",{...se,className:(0,n.cx)(L.row,ee&&L.expandedRow)},Y.cells.map(Z=>{const{key:z,...q}=Z.getCellProps();return o.createElement("td",{className:L.cell,key:z,...q},Z.render("Cell",{__rowID:ne}))})),ee&&C&&o.createElement("tr",{...se,id:ne,className:L.expandedContentRow},o.createElement("td",{className:L.expandedContentCell,colSpan:Y.cells.length},C(Y.original))))}))),U&&w&&o.createElement("span",null,o.createElement(l.d,{currentPage:W.state.pageIndex+1,numberOfPages:W.pageOptions.length,onNavigate:Y=>W.gotoPage(Y-1)})))}const p=()=>(0,o.useMemo)(()=>(0,a.uniqueId)("InteractiveTable"),[]),v=E=>({sortIcon:(0,n.css)({position:"absolute",top:E.spacing(1)}),headerTooltipIcon:(0,n.css)({marginLeft:E.spacing(.5)})});function D({column:{canSort:E,render:S,isSorted:T,isSortedDesc:M,getSortByToggleProps:A},headerTooltip:x}){const C=(0,f.of)(v),{onClick:O}=A(),R=o.createElement(o.Fragment,null,S("Header"),x&&o.createElement(m.m,{theme:"info-alt",content:x.content,placement:"top-end"},o.createElement(d.I,{className:C.headerTooltipIcon,name:x.iconName||"info-circle","data-testid":"header-tooltip-icon"})),T&&o.createElement("span",{"aria-hidden":"true",className:C.sortIcon},o.createElement(d.I,{name:M?"angle-down":"angle-up"})));return E?o.createElement("button",{type:"button",onClick:O},R):R}},24022:(Q,I,e)=>{"use strict";e.d(I,{B:()=>o});var n=e(96540),a=e(44533);class o extends n.PureComponent{constructor(){super(...arguments),this.wrapperRef=(0,n.createRef)(),this.renderJson=()=>{const{json:i,config:f,open:d,onDidRender:l}=this.props,m=this.wrapperRef.current,s=new a.O(i,d,f);m.hasChildNodes()?m.replaceChild(s.render(),m.lastChild):m.appendChild(s.render()),l&&l(s.json)}}static{this.defaultProps={open:3,config:{animateOpen:!0}}}componentDidMount(){this.renderJson()}componentDidUpdate(){this.renderJson()}render(){const{className:i}=this.props;return n.createElement("div",{className:i,ref:this.wrapperRef})}}},44533:(Q,I,e)=>{"use strict";e.d(I,{O:()=>y});var n=e(2543);function a(p){return p.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function o(p){return!!p&&typeof p==="object"}function r(p){if(p===void 0)return"";if(p===null||typeof p=="object"&&!p.constructor)return"Object";const D=/function ([^(]*)/.exec(p.constructor.toString());return D&&D.length>1?D[1]:""}function i(p){return p===null?"null":typeof p}function f(p,v){const D=i(p);return D==="null"||D==="undefined"?D:(D==="string"&&(v='"'+a(v)+'"'),D==="function"?p.toString().replace(/[\r\n]/g,"").replace(/\{.*\}/,"")+"{\u2026}":v)}let d="";function l(p){return o(p)?(d=r(p),Array.isArray(p)&&(d+="["+p.length+"]")):d=f(p,p.toString()),d}function m(p){return`json-formatter-${p}`}function s(p,v,D){const E=document.createElement(p);return v&&E.classList.add(m(v)),D!==void 0&&(D instanceof Node?E.appendChild(D):E.appendChild(document.createTextNode(String(D)))),E}const h=/(^\d{1,4}[\.|\\/|-]\d{1,2}[\.|\\/|-]\d{1,4})(\s*(?:0?[1-9]:[0-5]|1(?=[012])\d:[0-5])\d\s*[ap]m)?$/,u=/\d{2}:\d{2}:\d{2} GMT-\d{4}/,b=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,g=10,P=typeof window<"u"&&window.requestAnimationFrame||(p=>(p(),0)),c={animateOpen:!0,animateClose:!0};class y{constructor(v,D=1,E=c,S){this.json=v,this.open=D,this.config=E,this.key=S,this._isOpen=null,this.element=null,this.skipChildren=!1}get isOpen(){return this._isOpen!==null?this._isOpen:this.open>0}set isOpen(v){this._isOpen=v}get isDate(){return this.type==="string"&&(h.test(this.json)||b.test(this.json)||u.test(this.json))}get isUrl(){return this.type==="string"&&this.json.indexOf("http")===0}get isArray(){return Array.isArray(this.json)}get isObject(){return o(this.json)}get isEmptyObject(){return!this.keys.length&&!this.isArray}get isEmpty(){return this.isEmptyObject||this.keys&&!this.keys.length&&this.isArray}get hasKey(){return typeof this.key<"u"}get constructorName(){return r(this.json)}get type(){return i(this.json)}get keys(){return this.isObject?Object.keys(this.json).map(v=>v||'""'):[]}toggleOpen(){this.isOpen=!this.isOpen,this.element&&(this.isOpen?this.appendChildren(this.config.animateOpen):this.removeChildren(this.config.animateClose),this.element.classList.toggle(m("open")))}openAtDepth(v=1){v<0||(this.open=v,this.isOpen=v!==0,this.element&&(this.removeChildren(!1),v===0?this.element.classList.remove(m("open")):(this.appendChildren(this.config.animateOpen),this.element.classList.add(m("open")))))}isNumberArray(){return this.json.length>0&&this.json.length<4&&((0,n.isNumber)(this.json[0])||(0,n.isNumber)(this.json[1]))}renderArray(){const v=s("span");return v.appendChild(s("span","bracket","[")),this.isNumberArray()?(this.json.forEach((D,E)=>{E>0&&v.appendChild(s("span","array-comma",",")),v.appendChild(s("span","number",D))}),this.skipChildren=!0):v.appendChild(s("span","number",this.json.length)),v.appendChild(s("span","bracket","]")),v}render(v=!1){this.element=s("div","row");const D=s("a","toggler-link"),E=s("span","toggler");if(this.isObject&&D.appendChild(E),this.hasKey&&D.appendChild(s("span","key",`${this.key}:`)),this.isObject){const T=s("span","value"),M=s("span"),A=s("span","constructor-name",this.constructorName);if(M.appendChild(A),this.isArray){const x=this.renderArray();M.appendChild(x)}T.appendChild(M),D.appendChild(T)}else{const T=this.isUrl?s("a"):s("span");T.classList.add(m(this.type)),this.isDate&&T.classList.add(m("date")),this.isUrl&&(T.classList.add(m("url")),T.setAttribute("href",this.json));const M=f(this.json,this.json);T.appendChild(document.createTextNode(M)),D.appendChild(T)}const S=s("div","children");return this.isObject&&S.classList.add(m("object")),this.isArray&&S.classList.add(m("array")),this.isEmpty&&S.classList.add(m("empty")),this.config&&this.config.theme&&this.element.classList.add(m(this.config.theme)),this.isOpen&&this.element.classList.add(m("open")),v||this.element.appendChild(D),this.skipChildren?D.removeChild(E):this.element.appendChild(S),this.isObject&&this.isOpen&&this.appendChildren(),this.isObject&&D.addEventListener("click",this.toggleOpen.bind(this)),this.element}appendChildren(v=!1){const D=this.element&&this.element.querySelector(`div.${m("children")}`);if(!(!D||this.isEmpty))if(v){let E=0;const S=()=>{const T=this.keys[E],M=new y(this.json[T],this.open-1,this.config,T);D.appendChild(M.render()),E+=1,E<this.keys.length&&(E>g?S():P(S))};P(S)}else this.keys.forEach(E=>{const S=new y(this.json[E],this.open-1,this.config,E);D.appendChild(S.render())})}removeChildren(v=!1){const D=this.element&&this.element.querySelector(`div.${m("children")}`);if(v){let E=0;const S=()=>{D&&D.children.length&&(D.removeChild(D.children[0]),E+=1,E>g?S():P(S))};P(S)}else D&&(D.innerHTML="")}}},90613:(Q,I,e)=>{"use strict";e.d(I,{a:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(16795),i=e(55738);const f=(0,a.forwardRef)((s,h)=>{const{children:u,margin:b,marginX:g,marginY:P,marginTop:c,marginBottom:y,marginLeft:p,marginRight:v,padding:D,paddingX:E,paddingY:S,paddingTop:T,paddingBottom:M,paddingLeft:A,paddingRight:x,display:C,backgroundColor:O,grow:R,shrink:L,basis:N,flex:F,borderColor:K,borderStyle:B,borderRadius:w,direction:U,justifyContent:W,alignItems:V,boxShadow:_,element:H,gap:G,width:j,minWidth:Y,maxWidth:oe,height:se,minHeight:ne,maxHeight:ee,...Z}=s,z=(0,o.of)(m,b,g,P,c,y,p,v,D,E,S,T,M,A,x,C,O,R,L,N,F,K,B,w,U,W,V,_,G),q=(0,o.of)(i.E,j,Y,oe,se,ne,ee),ie=H??"div";return a.createElement(ie,{ref:h,className:(0,n.cx)(z.root,q),...Z},u)});f.displayName="Box";const d=(s,h)=>{switch(s){case"error":case"success":case"info":case"warning":return h.colors[s].borderTransparent;default:return s?h.colors.border[s]:void 0}},l=(s,h)=>{switch(s){case"error":case"success":case"info":case"warning":return h.colors[s].transparent;default:return s?h.colors.background[s]:void 0}},m=(s,h,u,b,g,P,c,y,p,v,D,E,S,T,M,A,x,C,O,R,L,N,F,K,B,w,U,W,V)=>({root:(0,n.css)([(0,r.Y)(s,h,_=>({margin:s.spacing(_)})),(0,r.Y)(s,u,_=>({marginLeft:s.spacing(_),marginRight:s.spacing(_)})),(0,r.Y)(s,b,_=>({marginTop:s.spacing(_),marginBottom:s.spacing(_)})),(0,r.Y)(s,g,_=>({marginTop:s.spacing(_)})),(0,r.Y)(s,P,_=>({marginBottom:s.spacing(_)})),(0,r.Y)(s,c,_=>({marginLeft:s.spacing(_)})),(0,r.Y)(s,y,_=>({marginRight:s.spacing(_)})),(0,r.Y)(s,p,_=>({padding:s.spacing(_)})),(0,r.Y)(s,v,_=>({paddingLeft:s.spacing(_),paddingRight:s.spacing(_)})),(0,r.Y)(s,D,_=>({paddingTop:s.spacing(_),paddingBottom:s.spacing(_)})),(0,r.Y)(s,E,_=>({paddingTop:s.spacing(_)})),(0,r.Y)(s,S,_=>({paddingBottom:s.spacing(_)})),(0,r.Y)(s,T,_=>({paddingLeft:s.spacing(_)})),(0,r.Y)(s,M,_=>({paddingRight:s.spacing(_)})),(0,r.Y)(s,A,_=>({display:_})),(0,r.Y)(s,x,_=>({backgroundColor:l(_,s)})),(0,r.Y)(s,B,_=>({flexDirection:_})),(0,r.Y)(s,C,_=>({flexGrow:_})),(0,r.Y)(s,O,_=>({flexShrink:_})),(0,r.Y)(s,R,_=>({flexBasis:_})),(0,r.Y)(s,L,_=>({flex:_})),(0,r.Y)(s,F,_=>({borderStyle:_})),(0,r.Y)(s,N,_=>({borderColor:d(_,s)})),(F||N)&&{borderWidth:"1px"},(0,r.Y)(s,w,_=>({justifyContent:_})),(0,r.Y)(s,U,_=>({alignItems:_})),(0,r.Y)(s,K,_=>({borderRadius:s.shape.radius[_]})),(0,r.Y)(s,W,_=>({boxShadow:s.shadows[_]})),(0,r.Y)(s,V,_=>({gap:s.spacing(_)}))])})},71259:(Q,I,e)=>{"use strict";e.d(I,{x:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(16795);const i=(0,a.forwardRef)((d,l)=>{const{alignItems:m,children:s,gap:h,columns:u,minColumnWidth:b,...g}=d,P=(0,o.of)(f,h,u,b,m);return a.createElement("div",{ref:l,...g,className:P.grid},s)});i.displayName="Grid";const f=(d,l,m,s,h)=>({grid:(0,n.css)([{display:"grid"},(0,r.Y)(d,l,u=>({gap:d.spacing(u)})),s&&(0,r.Y)(d,s,u=>({gridTemplateColumns:`repeat(auto-fill, minmax(${d.spacing(u)}, 1fr))`})),m&&(0,r.Y)(d,m,u=>({gridTemplateColumns:`repeat(${u}, 1fr)`})),(0,r.Y)(d,h,u=>({alignItems:u}))])})},66864:(Q,I,e)=>{"use strict";e.d(I,{Gy:()=>f,PE:()=>i,gW:()=>d,mc:()=>l});var n=e(32196),a=e(96540),o=e(40845),r=(u=>(u[u.Horizontal=0]="Horizontal",u[u.Vertical=1]="Vertical",u))(r||{});const i=({children:u,orientation:b=0,spacing:g="sm",justify:P="flex-start",align:c="normal",wrap:y=!1,width:p="100%",height:v="100%",...D})=>{const E=(0,o.of)(m,b,g,P,c,y);return a.createElement("div",{className:E.layout,style:{width:p,height:v},...D},a.Children.toArray(u).filter(Boolean).map((S,T)=>a.createElement("div",{className:E.childWrapper,key:T},S)))},f=({children:u,spacing:b,justify:g,align:P="center",wrap:c,width:y,height:p})=>a.createElement(i,{spacing:b,justify:g,orientation:0,align:P,width:y,height:p,wrap:c},u),d=({children:u,spacing:b,justify:g,align:P,width:c,height:y})=>a.createElement(i,{spacing:b,justify:g,orientation:1,align:P,width:c,height:y},u),l=({children:u,padding:b,margin:g,grow:P,shrink:c})=>{const y=(0,o.of)(h,b,g);return a.createElement("div",{className:(0,n.cx)(y.wrapper,P!==void 0&&(0,n.css)({flexGrow:P}),c!==void 0&&(0,n.css)({flexShrink:c}))},u)},m=(u,b,g,P,c,y)=>{const p=g!=="none"?u.spacing(s[g]):0,v=b===0&&!y||b===1?0:`-${p}`,D=b===1?"vertical-group":"horizontal-group";return{layout:(0,n.css)({label:D,display:"flex",flexDirection:b===1?"column":"row",flexWrap:y?"wrap":"nowrap",justifyContent:P,alignItems:c,height:"100%",maxWidth:"100%",marginBottom:v}),childWrapper:(0,n.css)({label:"layoutChildrenWrapper",marginBottom:b===0&&!y?0:p,marginRight:b===0?p:0,display:"flex",alignItems:c,"&:last-child":{marginBottom:b===1?0:void 0,marginRight:b===0?0:void 0}})}},s={none:0,xs:.5,sm:1,md:2,lg:3},h=(u,b,g)=>{const P=b&&b!=="none"&&u.spacing(s[b])||0,c=g&&g!=="none"&&u.spacing(s[g])||0;return{wrapper:(0,n.css)({label:"container",margin:c,padding:P})}}},68402:(Q,I,e)=>{"use strict";e.d(I,{$:()=>o});var n=e(96540),a=e(90613);const o=({v:r=0,h:i=0,layout:f})=>n.createElement(a.a,{paddingRight:i,paddingBottom:r,display:f==="inline"?"inline-block":"block"})},67061:(Q,I,e)=>{"use strict";e.d(I,{B:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(16795),i=e(55738);const f=a.forwardRef((l,m)=>{const{gap:s=1,alignItems:h,justifyContent:u,direction:b,wrap:g,children:P,grow:c,shrink:y,basis:p,flex:v,width:D,minWidth:E,maxWidth:S,height:T,minHeight:M,maxHeight:A,...x}=l,C=(0,o.of)(d,s,h,u,b,g,c,y,p,v),O=(0,o.of)(i.E,D,E,S,T,M,A);return a.createElement("div",{ref:m,className:(0,n.cx)(C.flex,O),...x},P)});f.displayName="Stack";const d=(l,m,s,h,u,b,g,P,c,y)=>({flex:(0,n.css)([{display:"flex"},(0,r.Y)(l,u,p=>({flexDirection:p})),(0,r.Y)(l,b,p=>({flexWrap:p})),(0,r.Y)(l,s,p=>({alignItems:p})),(0,r.Y)(l,h,p=>({justifyContent:p})),(0,r.Y)(l,m,p=>({gap:l.spacing(p)})),(0,r.Y)(l,g,p=>({flexGrow:p})),(0,r.Y)(l,P,p=>({flexShrink:p})),(0,r.Y)(l,c,p=>({flexBasis:p})),(0,r.Y)(l,y,p=>({flex:p}))])})},16795:(Q,I,e)=>{"use strict";e.d(I,{Y:()=>a});function n(o,r,i,f){const d=r[f];if(d!=null)return{[o.breakpoints.up(f)]:i(d)}}function a(o,r,i){return r==null?null:typeof r!="object"||!("xs"in r)?i(r):[n(o,r,i,"xs"),n(o,r,i,"sm"),n(o,r,i,"md"),n(o,r,i,"lg"),n(o,r,i,"xl"),n(o,r,i,"xxl")]}},55738:(Q,I,e)=>{"use strict";e.d(I,{E:()=>o});var n=e(32196),a=e(16795);const o=(r,i,f,d,l,m,s)=>(0,n.css)([(0,a.Y)(r,i,h=>({width:r.spacing(h)})),(0,a.Y)(r,f,h=>({minWidth:r.spacing(h)})),(0,a.Y)(r,d,h=>({maxWidth:r.spacing(h)})),(0,a.Y)(r,l,h=>({height:r.spacing(h)})),(0,a.Y)(r,m,h=>({minHeight:r.spacing(h)})),(0,a.Y)(r,s,h=>({maxHeight:r.spacing(h)}))])},50720:(Q,I,e)=>{"use strict";e.d(I,{N:()=>i});var n=e(96540),a=e(54625),o=e(71733),r=e(40672);const i=(0,n.forwardRef)(({href:f,children:d,...l},m)=>{const s=o.I.stripBaseFromUrl(r.sQ.sanitizeUrl(f??""));return n.createElement(a.Link,{ref:m,to:s,...l},d)});i.displayName="Link"},72109:(Q,I,e)=>{"use strict";e.d(I,{Y:()=>s});var n=e(32196),a=e(96540),o=e(40672),r=e(71733),i=e(40845),f=e(14578),d=e(71356),l=e(50720);const m={h1:"xl",h2:"xl",h3:"lg",h4:"lg",h5:"md",h6:"md",body:"md",bodySmall:"xs"},s=(0,a.forwardRef)(({href:u,color:b="link",external:g=!1,inline:P=!0,variant:c="body",weight:y,icon:p,children:v,...D},E)=>{const S=o.sQ.sanitizeUrl(u??""),T=(0,i.$j)(),M=h(T,P,c,y,b),A=p||"external-link-alt";if(g)return a.createElement("a",{href:S,ref:E,...D,target:"_blank",rel:"noreferrer",className:M},v,a.createElement(f.I,{size:m[c]||"md",name:A}));const x=r.I.stripBaseFromUrl(S);return a.createElement(l.N,{ref:E,href:x,...D,className:M},v,p&&a.createElement(f.I,{name:p,size:m[c]||"md"}))});s.displayName="TextLink";const h=(u,b,g,P,c)=>(0,n.css)([g&&{...u.typography[g]},P&&{fontWeight:(0,d.iV)(P,u)},c&&{color:u.colors.text[c]},{alignItems:"center",gap:"0.25em",display:"inline-flex",textDecoration:"none","&:hover":{textDecoration:"underline",color:u.colors.text.link}},b&&{textDecoration:"underline","&:hover":{textDecoration:"none"}}])},85918:(Q,I,e)=>{"use strict";e.d(I,{p:()=>i});var n=e(32196),a=e(96540),o=e(3911);const r=(0,o.N)((f=!1)=>({list:(0,n.css)({listStyleType:"none",margin:0,padding:0}),item:(0,n.css)({display:f&&"inline-block"||"block"})}));class i extends a.PureComponent{constructor(d){super(d)}render(){const{items:d,renderItem:l,getItemKey:m,className:s,inline:h}=this.props,u=r(h);return a.createElement("ul",{className:(0,n.cx)(u.list,s)},d.map((b,g)=>a.createElement("li",{className:u.item,key:m?m(b):g},l(b,g))))}}},1551:(Q,I,e)=>{"use strict";e.d(I,{c:()=>o});var n=e(96540),a=e(85918);class o extends n.PureComponent{render(){return n.createElement(a.p,{inline:!0,...this.props})}}},33552:(Q,I,e)=>{"use strict";e.d(I,{B:()=>o});var n=e(96540),a=e(85918);class o extends n.PureComponent{render(){return n.createElement(a.p,{...this.props})}}},57514:(Q,I,e)=>{"use strict";e.d(I,{G:()=>s});var n=e(32196),a=e(96540),o=e(40845);const r=28,i=2.4,f=500,d=4e3,l=300,m=100/r*100;function s({width:u,delay:b=l,ariaLabel:g="Loading bar"}){const P=Math.min(Math.max(Math.round(u*i),f),d),c=(0,o.of)(h,b,P),y={overflow:"hidden"};return a.createElement("div",{style:y},a.createElement("div",{"aria-label":g,className:c.bar}))}const h=(u,b,g)=>{const P=(0,n.keyframes)({"0%":{transform:"translateX(-100%)"},"85%, 100%":{transform:`translateX(${m}%)`}});return{bar:(0,n.css)({width:r+"%",height:1,background:"linear-gradient(90deg, rgba(110, 159, 255, 0) 0%, #6E9FFF 80.75%, rgba(110, 159, 255, 0) 100%)",transform:"translateX(-100%)",willChange:"transform",[u.transitions.handleMotion("no-preference")]:{animationName:P,animationDelay:`${b}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${g}ms`},[u.transitions.handleMotion("reduce")]:{animationName:P,animationDelay:`${b}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${4*g}ms`}})}}},39558:(Q,I,e)=>{"use strict";e.d(I,{_:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(62930);const i=({text:d,className:l,...m})=>{const s=(0,o.of)(f);return a.createElement("div",{className:(0,n.cx)(s.container,l),...m},d," ",a.createElement(r.y,{inline:!0}))},f=d=>({container:(0,n.css)({marginBottom:d.spacing(4)})})},76218:(Q,I,e)=>{"use strict";e.d(I,{O:()=>r});var n=e(96540),a=e(21594),o=e(64278);const r=({value:i,onChange:f,context:d,item:l})=>{const m=l.settings??{},s=(0,o.sE)(d.data,m?.filter),h=(0,o.m3)(s,i,void 0,void 0,m.baseNameMode),u=(0,n.useCallback)(g=>{if(!(g&&!(0,o.v3)(g.value,s)))return f(g?.value)},[s,f]),b=h.find(g=>g.value===i);return n.createElement(n.Fragment,null,n.createElement(a.l6,{value:b,placeholder:m.placeholderText??"Select field",options:h,onChange:u,noOptionsMessage:m.noFieldsMessage,width:m.width,isClearable:m.isClearable!==!1}))}},9988:(Q,I,e)=>{"use strict";e.d(I,{bx:()=>l,cH:()=>h});var n=e(96540),a=e(11261),o=e(1173),r=e(85200),i=e(4025),f=e(21594);const d=(0,n.memo)(u=>{const{data:b,options:g,onChange:P,id:c}=u,y=m(b),p=s(y,g),v=(0,n.useCallback)(E=>P(E.value),[P]),D=p.find(E=>E.value===g);return n.createElement(f.l6,{inputId:c,value:D,options:p,onChange:v})});d.displayName="FieldTypeMatcherEditor";const l=[{value:a.PU.number,label:"Number",icon:(0,i.lV)(a.PU.number)},{value:a.PU.string,label:"String",icon:(0,i.lV)(a.PU.string)},{value:a.PU.time,label:"Time",icon:(0,i.lV)(a.PU.time)},{value:a.PU.boolean,label:"Boolean",icon:(0,i.lV)(a.PU.boolean)},{value:a.PU.trace,label:"Traces",icon:(0,i.lV)(a.PU.trace)},{value:a.PU.enum,label:"Enum",icon:(0,i.lV)(a.PU.enum)},{value:a.PU.other,label:"Other",icon:(0,i.lV)(a.PU.other)}],m=u=>(0,n.useMemo)(()=>{const b=new Map;for(const g of l)b.set(g.value,0);for(const g of u)for(const P of g.fields){const c=P.type||a.PU.other;let y=b.get(c);y||(y=0),b.set(c,y+1)}return b},[u]),s=(u,b)=>(0,n.useMemo)(()=>{let g=!1;const P=[];for(const c of l){const y=u.get(c.value),p=b===c.value;(y||p)&&P.push({...c,label:`${c.label} (${u.get(c.value)})`}),p&&(g=!0)}return b&&!g&&P.push({value:b,label:`${b} (No matches)`}),P},[u,b]),h={id:o.Ct.byType,component:d,matcher:r.sJ.get(o.Ct.byType),name:"Fields with type",description:"Set properties for fields of a specific type (number, string, boolean)",optionsToLabel:u=>u}},19346:(Q,I,e)=>{"use strict";e.d(I,{N:()=>s,r1:()=>g});var n=e(32196),a=e(96540),o=e(75059),r=e(1173),i=e(85200),f=e(52622),d=e(40845),l=e(10354),m=e(21594);const s=[{label:"==",value:f.zT.EQ},{label:"!=",value:f.zT.NEQ},{label:">",value:f.zT.GT},{label:">=",value:f.zT.GTE},{label:"<",value:f.zT.LT},{label:"<=",value:f.zT.LTE}];function h(P){return P===o.gy.allIsNull||P===o.gy.allIsZero}const u=({options:P,onChange:c})=>{const y=(0,d.of)(b),p=(0,a.useMemo)(()=>o.AS.selectOptions([P?.reducer]),[P?.reducer]),v=(0,a.useCallback)(M=>c({...P,reducer:M.value}),[P,c]),D=(0,a.useCallback)(M=>c({...P,op:M.value}),[P,c]),E=(0,a.useCallback)(M=>{const A=M.currentTarget.valueAsNumber;return c({...P,value:A})},[P,c]),S=P??{},T=h(P.reducer);return a.createElement("div",{className:y.spot},a.createElement(m.l6,{value:p.current,options:p.options,onChange:v,placeholder:"Select field reducer"}),S.reducer&&!T&&a.createElement(a.Fragment,null,a.createElement(m.l6,{value:s.find(M=>M.value===S.op),options:s,onChange:D,"aria-label":"Comparison operator",width:19}),a.createElement(l.p,{type:"number",value:S.value,onChange:E})))},b=P=>({spot:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end",gap:"4px"})}),g={id:r.Ct.byValue,component:u,matcher:i.sJ.get(r.Ct.byValue),name:"Fields with values",description:"Set properties for fields with reducer condition",optionsToLabel:P=>`${P?.reducer} ${P?.op} ${P?.value}`}},74668:(Q,I,e)=>{"use strict";e.d(I,{R:()=>s,X:()=>d});var n=e(96540),a=e(28240),o=e(1173),r=e(85200),i=e(21594);const f=(h,u,b)=>{if(!b)return;let g=h.find(P=>!u.some(c=>P===c));if(g)return g};function d({value:h,data:u,onChange:b,placeholder:g}){const P=(0,n.useMemo)(()=>l(u),[u]),[c,y]=(0,n.useState)({refIds:[],value:void 0}),p=(0,n.useMemo)(()=>P.find(D=>D.value===h)??f(P,c.refIds,c.value),[h,P,c]),v=(0,n.useCallback)(D=>{b(D?.value)},[b]);return(P!==c.refIds||p?.value!==c.value)&&y({refIds:P,value:p?.value}),n.createElement(i.l6,{options:P,onChange:v,isClearable:!0,placeholder:g??"Select query refId",value:p})}function l(h){const u=new Map;for(const g of h){const P=g.refId??"",c=u.get(P)??[];c.length===0&&u.set(P,c),c.push(g)}const b=[];for(const[g,P]of u.entries())b.push({value:g,label:`Query: ${g??"(missing refId)"}`,description:m(P)});return b}function m(h){return`Frames (${h.length}):
    ${h.slice(0,Math.min(3,h.length)).map(u=>(0,a.Ri)(u)).join(", ")} ${h.length>3?"...":""}`}const s={id:o.Ct.byFrameRefID,component:h=>n.createElement(d,{value:h.options,data:h.data,onChange:h.onChange}),matcher:r.sJ.get(o.Ct.byFrameRefID),name:"Fields returned by query",description:"Set properties for fields from a specific query",optionsToLabel:h=>h}},84349:(Q,I,e)=>{"use strict";e.d(I,{g:()=>y});var n=e(83077),a=e(96540),o=e(1173),r=e(85200),i=e(10354);const f=(0,a.memo)(p=>{const{options:v,onChange:D}=p,E=(0,a.useCallback)(S=>D(S.target.value),[D]);return a.createElement(i.p,{placeholder:"Enter regular expression",defaultValue:v,onBlur:E})});f.displayName="FieldNameByRegexMatcherEditor";const d={id:o.Ct.byRegexp,component:f,matcher:r.sJ.get(o.Ct.byRegexp),name:"Fields with name matching regex",description:"Set properties for fields with names matching a regex",optionsToLabel:p=>p};var l=e(21594),m=e(64278);const s=(0,a.memo)(p=>{const{data:v,options:D,onChange:E,id:S}=p,T=(0,m.sE)(v),M=(0,m.m3)(T,D),A=(0,a.useCallback)(C=>{if((0,m.v3)(C.value,T))return E(C.value)},[T,E]),x=M.find(C=>C.value===D);return a.createElement(l.l6,{value:x,options:M,onChange:A,inputId:S})});s.displayName="FieldNameMatcherEditor";const h={id:o.Ct.byName,component:s,matcher:r.sJ.get(o.Ct.byName),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:p=>p},u=(0,a.memo)(p=>{const{data:v,options:D,onChange:E}=p,{readOnly:S,prefix:T}=D,M=(0,m.sE)(v),A=(0,m.m3)(M,void 0),x=(0,a.useCallback)(C=>{if(Array.isArray(C))return E({...D,names:C.reduce((O,R)=>((0,m.v3)(R.value,M)&&O.push(R.value),O),[])})},[M,E,D]);if(S){const C=(D.names??[]).join(", ");return a.createElement(i.p,{value:C,readOnly:!0,disabled:!0,prefix:T})}return a.createElement(l.KF,{value:D.names,options:A,onChange:x})});u.displayName="FieldNameMatcherEditor";const b={id:o.Ct.byNames,component:u,matcher:r.sJ.get(o.Ct.byNames),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:p=>(p.names??[]).join(", "),excludeFromPicker:!0};var g=e(9988),P=e(19346),c=e(74668);const y=new n.O(()=>[h,d,g.cH,c.R,b,P.r1])},64278:(Q,I,e)=>{"use strict";e.d(I,{BP:()=>f,m3:()=>l,sE:()=>d,v3:()=>i});var n=e(96540),a=e(28240),o=e(27310),r=e(4025);function i(m,s){return m?s.display.has(m)||s.raw.has(m):!1}function f(m,s){const h={display:new Set,raw:new Set,fields:new Map};for(const u of m)for(const b of u.fields){if(s&&!s(b))continue;const g=(0,a.Ct)(b,u,m);h.display.add(g),h.fields.set(g,b),b.name&&g!==b.name&&(h.raw.add(b.name),h.fields.set(b.name,b))}return h}function d(m,s){return(0,n.useMemo)(()=>f(m,s),[m,s])}function l(m,s,h,u,b){return(0,n.useMemo)(()=>{let g=!1;const P=[];if(h&&P.push(h),b===o.X4.OnlyBaseNames)for(const c of m.raw)!g&&c===s&&(g=!0),P.push({value:c,label:`${c} (base field name)`});else{for(const c of m.display){!g&&c===s&&(g=!0);const y=m.fields.get(c);(!u||u===y?.type)&&P.push({value:c,label:c,icon:y?(0,r.SS)(y):void 0})}if(b!==o.X4.ExcludeBaseNames)for(const c of m.raw)m.display.has(c)||(!g&&c===s&&(g=!0),P.push({value:c,label:`${c} (base field name)`}))}return s&&!g&&P.push({value:s,label:`${s} (not found)`}),P},[m,s,h,u,b])}},38138:(Q,I,e)=>{"use strict";e.d(I,{W:()=>s});var n=e(32196),a=e(96540),o=e(40845),r=e(90613),i=e(27183),f=e(59093),d=e(64539),l=e(32653);const m=a.forwardRef(({header:u,children:b,ariaLabel:g,onOpen:P,onClose:c,onKeyDown:y,...p},v)=>{const D=(0,o.of)(h),E=(0,a.useRef)(null);(0,a.useImperativeHandle)(v,()=>E.current);const[S]=(0,l.t)({isMenuOpen:!0,localRef:E,onOpen:P,onClose:c,onKeyDown:y});return a.createElement(r.a,{...p,"aria-label":g,backgroundColor:"primary",borderRadius:"default",boxShadow:"z3",display:"inline-block",onKeyDown:S,paddingX:0,paddingY:.5,ref:E,role:"menu",tabIndex:-1},u&&a.createElement("div",{className:(0,n.cx)(D.header,!!b&&a.Children.toArray(b).length>0&&D.headerBorder)},u),b)});m.displayName="Menu";const s=Object.assign(m,{Item:d.D,Divider:i.N,Group:f.r}),h=u=>({header:(0,n.css)({padding:u.spacing(.5,1,1,1)}),headerBorder:(0,n.css)({borderBottom:`1px solid ${u.colors.border.weak}`})})},27183:(Q,I,e)=>{"use strict";e.d(I,{N:()=>r});var n=e(32196),a=e(96540),o=e(40845);function r(){const f=(0,o.of)(i);return a.createElement("div",{className:f.divider})}const i=f=>({divider:(0,n.css)({height:1,backgroundColor:f.colors.border.weak,margin:f.spacing(.5,0)})})},59093:(Q,I,e)=>{"use strict";e.d(I,{r:()=>f});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(40845);const f=({label:l,ariaLabel:m,children:s})=>{const h=(0,i.of)(d),u=`group-label-${(0,a.uniqueId)()}`;return r.createElement("div",{role:"group","aria-labelledby":!m&&l?u:void 0,"aria-label":m},l&&r.createElement("label",{id:u,className:h.groupLabel,"aria-hidden":!0},l),s)};f.displayName="MenuGroup";const d=l=>({groupLabel:(0,n.css)({color:l.colors.text.secondary,fontSize:l.typography.size.sm,padding:l.spacing(.5,1)})})},64539:(Q,I,e)=>{"use strict";e.d(I,{D:()=>u});var n=e(32196),a=e(96540),o=e(40845),r=e(16797),i=e(14578),f=e(67061),d=e(13544),l=e(32653);const m=g=>{if(!g)return!1;const P=g.parentElement.getBoundingClientRect(),c=g.getBoundingClientRect();return c.width!==0&&P.right+c.width+10>window.innerWidth},s=a.memo(({items:g,isOpen:P,close:c,customStyle:y})=>{const p=(0,o.of)(h),v=(0,a.useRef)(null),[D]=(0,l.t)({localRef:v,isMenuOpen:P,close:c}),[E,S]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{P&&v.current&&S(m(v.current))},[P]),a.createElement(a.Fragment,null,a.createElement("div",{className:p.iconWrapper,"aria-hidden":!0,"data-testid":d.Tp.components.Menu.SubMenu.icon},a.createElement(i.I,{name:"angle-right",className:p.icon})),P&&a.createElement("div",{ref:v,className:(0,n.cx)(p.subMenu,{[p.pushLeft]:E}),"data-testid":d.Tp.components.Menu.SubMenu.container,style:y},a.createElement("div",{tabIndex:-1,className:p.itemsWrapper,role:"menu",onKeyDown:D},g)))});s.displayName="SubMenu";const h=g=>({iconWrapper:(0,n.css)({display:"flex",flex:1,justifyContent:"end"}),icon:(0,n.css)({opacity:.7,marginLeft:g.spacing(1),color:g.colors.text.secondary}),itemsWrapper:(0,n.css)({background:g.colors.background.primary,boxShadow:g.shadows.z3,display:"inline-block",borderRadius:g.shape.radius.default}),pushLeft:(0,n.css)({right:"100%",left:"unset"}),subMenu:(0,n.css)({position:"absolute",top:0,left:"100%",zIndex:g.zIndex.dropdown})}),u=a.memo(a.forwardRef((g,P)=>{const{url:c,icon:y,label:p,description:v,ariaLabel:D,ariaChecked:E,target:S,onClick:T,className:M,active:A,disabled:x,destructive:C,childItems:O,role:R,tabIndex:L=-1,customSubMenuContainerStyles:N,shortcut:F,testId:K}=g,B=(0,o.of)(b),[w,U]=(0,a.useState)(A),[W,V]=(0,a.useState)(!1),_=(0,a.useCallback)(()=>{x||(V(!0),U(!0))},[x]),H=(0,a.useCallback)(()=>{x||(V(!1),U(!1))},[x]),G=O&&O.length>0,j=G?"div":c===void 0?"button":"a",Y=(0,n.cx)({[B.item]:!0,[B.active]:w,[B.disabled]:x,[B.destructive]:C&&!x},M),oe={[j==="button"?"disabled":"aria-disabled"]:x,...j==="a"&&x&&{href:void 0,onClick:void 0},...x&&{tabIndex:-1,"data-disabled":x}},se=(0,a.useRef)(null);(0,a.useImperativeHandle)(P,()=>se.current);const ne=z=>{switch(z.key){case"ArrowRight":z.preventDefault(),z.stopPropagation(),G&&(V(!0),U(!0));break;default:break}},ee=()=>{V(!1),U(!1),se?.current?.focus()},Z=!!(F&&F.length>0);return a.createElement(j,{target:S,className:Y,rel:S==="_blank"?"noopener noreferrer":void 0,href:c,onClick:T,onMouseEnter:_,onMouseLeave:H,onKeyDown:ne,role:c?R:R||"menuitem","data-role":"menuitem",ref:se,"data-testid":K,"aria-label":D,"aria-checked":E,tabIndex:L,...oe},a.createElement(f.B,{direction:"row",justifyContent:"flex-start",alignItems:"center"},y&&a.createElement(i.I,{name:y,className:B.icon,"aria-hidden":!0}),a.createElement("span",{className:B.ellipsis},p),a.createElement("div",{className:(0,n.cx)(B.rightWrapper,{[B.withShortcut]:Z})},Z&&a.createElement("div",{className:B.shortcut},a.createElement(i.I,{name:"keyboard",title:"keyboard shortcut"}),F),G&&a.createElement(s,{items:O,isOpen:W,close:ee,customStyle:N}))),v&&a.createElement("div",{className:(0,n.cx)(B.description,B.ellipsis,{[B.descriptionWithIcon]:y!==void 0})},v),g.component?a.createElement(g.component,null):null)}));u.displayName="MenuItem";const b=g=>({item:(0,n.css)({background:"none",cursor:"pointer",whiteSpace:"nowrap",color:g.colors.text.primary,display:"flex",flexDirection:"column",alignItems:"stretch",padding:g.spacing(.5,2),minHeight:g.spacing(4),margin:0,border:"none",width:"100%",position:"relative","&:hover, &:focus-visible":{background:g.colors.action.hover,color:g.colors.text.primary,textDecoration:"none"},"&:focus-visible":(0,r.getFocusStyles)(g)}),active:(0,n.css)({background:g.colors.action.hover}),destructive:(0,n.css)({color:g.colors.error.text,svg:{color:g.colors.error.text},"&:hover, &:focus, &:focus-visible":{background:g.colors.error.main,color:g.colors.error.contrastText,svg:{color:g.colors.error.contrastText}}}),disabled:(0,n.css)({color:g.colors.action.disabledText,label:"menu-item-disabled","&:hover, &:focus, &:focus-visible":{cursor:"not-allowed",background:"none",color:g.colors.action.disabledText}}),icon:(0,n.css)({opacity:.7,color:g.colors.text.secondary}),rightWrapper:(0,n.css)({display:"flex",alignItems:"center",marginLeft:"auto"}),withShortcut:(0,n.css)({minWidth:g.spacing(10.5)}),shortcut:(0,n.css)({display:"flex",alignItems:"center",gap:g.spacing(1),marginLeft:g.spacing(2),color:g.colors.text.secondary,opacity:.7}),description:(0,n.css)({...g.typography.bodySmall,color:g.colors.text.secondary,textAlign:"start"}),descriptionWithIcon:(0,n.css)({marginLeft:g.spacing(3)}),ellipsis:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})})},32653:(Q,I,e)=>{"use strict";e.d(I,{t:()=>i});var n=e(96540),a=e(94701);const o=(f,d)=>(f%d+d)%d,r=-1,i=({localRef:f,isMenuOpen:d,close:l,onOpen:m,onClose:s,onKeyDown:h})=>{const[u,b]=(0,n.useState)(r);return(0,n.useEffect)(()=>{d&&b(0)},[d]),(0,n.useEffect)(()=>{const P=f?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])');P?.[u]?.focus(),P?.forEach((c,y)=>{c.tabIndex=y===u?0:-1})},[f,u]),(0,a.A)(()=>{m?.(b)}),[P=>{const c=f?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])'),y=c?.length??0;switch(P.key){case"ArrowUp":P.preventDefault(),P.stopPropagation(),b(o(u-1,y));break;case"ArrowDown":P.preventDefault(),P.stopPropagation(),b(o(u+1,y));break;case"ArrowLeft":P.preventDefault(),P.stopPropagation(),b(r),l?.();break;case"Home":P.preventDefault(),P.stopPropagation(),b(0);break;case"End":P.preventDefault(),P.stopPropagation(),b(y-1);break;case"Enter":P.preventDefault(),P.stopPropagation(),c?.[u]?.click();break;case"Escape":s?.();break;case"Tab":P.preventDefault(),s?.();break;default:break}h?.(P)}]}},37390:(Q,I,e)=>{"use strict";e.d(I,{a:()=>b});var n=e(32196),a=e(18828),o=e(85690),r=e(93225),i=e(59875),f=e(96540),d=e(40845),l=e(76412),m=e(29158),s=e(67061),h=e(29473),u=e(88448);function b(c){const{title:y,children:p,isOpen:v=!1,closeOnEscape:D=!0,closeOnBackdropClick:E=!0,className:S,contentClassName:T,onDismiss:M,onClickBackdrop:A,trapFocus:x=!0}=c,C=(0,d.of)(u.o),O=(0,f.useRef)(null),{overlayProps:R,underlayProps:L}=(0,r.e)({isKeyboardDismissDisabled:!D,isOpen:v,onClose:M},O),{dialogProps:N,titleProps:F}=(0,a.s)({},O);if(!v)return null;const K=(0,n.cx)(C.modalHeader,typeof y!="string"&&C.modalHeaderWithTabs);return f.createElement(i.Sf,null,f.createElement("div",{role:"presentation",className:C.modalBackdrop,onClick:A||(E?M:void 0),...L}),f.createElement(o.n1,{contain:x,autoFocus:!0,restoreFocus:!0},f.createElement("div",{className:(0,n.cx)(C.modal,S),ref:O,...R,...N},f.createElement("div",{className:K},typeof y=="string"&&f.createElement(P,{...c,title:y,id:F.id}),typeof y!="string"&&y,f.createElement("div",{className:C.modalHeaderClose},f.createElement(m.K,{name:"times",size:"xl",onClick:M,"aria-label":(0,l.t)("grafana-ui.modal.close-tooltip","Close")}))),f.createElement("div",{className:(0,n.cx)(C.modalContent,T)},p))))}function g({leftItems:c,children:y}){const p=(0,d.of)(u.o);return c?f.createElement("div",{className:p.modalButtonRow},f.createElement(s.B,{justifyContent:"space-between"},f.createElement(s.B,{justifyContent:"flex-start",gap:2},c),f.createElement(s.B,{justifyContent:"flex-end",gap:2},y))):f.createElement("div",{className:p.modalButtonRow},f.createElement(s.B,{justifyContent:"flex-end",gap:2,wrap:"wrap"},y))}b.ButtonRow=g;function P({icon:c,iconTooltip:y,title:p,id:v}){return f.createElement(h.r,{icon:c,iconTooltip:y,title:p,id:v})}},29473:(Q,I,e)=>{"use strict";e.d(I,{r:()=>r});var n=e(96540),a=e(40845),o=e(88448);const r=({icon:i,iconTooltip:f,title:d,children:l,id:m})=>{const s=(0,a.of)(o.o);return n.createElement(n.Fragment,null,n.createElement("h2",{className:s.modalHeaderTitle,id:m},d),l)}},95246:(Q,I,e)=>{"use strict";e.d(I,{O:()=>a});var n=e(96540);const a=({children:o})=>n.createElement("div",{className:"share-modal-body"},n.createElement("div",{className:"share-modal-header"},n.createElement("div",{className:"share-modal-content"},o)))},25897:(Q,I,e)=>{"use strict";e.d(I,{J:()=>i});var n=e(96540),a=e(40675),o=e(63021),r=e(29473);const i=({icon:f,title:d,tabs:l,activeTab:m,onChangeTab:s})=>n.createElement(r.r,{icon:f,title:d},n.createElement(o.U,{hideBorder:!0},l.map((h,u)=>n.createElement(a.o,{key:`${h.value}-${u}`,label:h.label,icon:h.icon,suffix:h.tabSuffix,active:h.value===m,onChangeTab:()=>s(h)}))))},71678:(Q,I,e)=>{"use strict";e.d(I,{$s:()=>i,EO:()=>r,YO:()=>o,wE:()=>a});var n=e(96540);const a=n.createContext({component:null,props:{},showModal:()=>{},hideModal:()=>{}});class o extends n.Component{constructor(d){super(d),this.showModal=(l,m)=>{this.setState({component:l,props:m})},this.hideModal=()=>{this.setState({component:null,props:{}})},this.state={component:d.component||null,props:d.props||{},showModal:this.showModal,hideModal:this.hideModal}}render(){return n.createElement(a.Provider,{value:this.state},this.props.children)}}const r=()=>n.createElement(a.Consumer,null,({component:f,props:d})=>f?n.createElement(f,{...d}):null),i=a.Consumer},88448:(Q,I,e)=>{"use strict";e.d(I,{o:()=>a});var n=e(32196);const a=o=>{const r=o.shape.radius.default;return{modal:(0,n.css)({position:"fixed",zIndex:o.zIndex.modal,background:o.colors.background.primary,boxShadow:o.shadows.z3,borderRadius:r,border:`1px solid ${o.colors.border.weak}`,backgroundClip:"padding-box",outline:"none",width:"750px",maxWidth:"100%",left:0,right:0,marginLeft:"auto",marginRight:"auto",top:"10%",maxHeight:"80%",display:"flex",flexDirection:"column"}),modalBackdrop:(0,n.css)({position:"fixed",zIndex:o.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0,backgroundColor:o.components.overlay.background,backdropFilter:"blur(1px)"}),modalHeader:(0,n.css)({label:"modalHeader",display:"flex",alignItems:"center",minHeight:"42px",margin:o.spacing(1,2,0,2)}),modalHeaderWithTabs:(0,n.css)({borderBottom:`1px solid ${o.colors.border.weak}`}),modalHeaderTitle:(0,n.css)({fontSize:o.typography.size.lg,margin:o.spacing(0,4,0,1),display:"flex",alignItems:"center",position:"relative",top:"2px"}),modalHeaderIcon:(0,n.css)({marginRight:o.spacing(2),fontSize:"inherit","&:before":{verticalAlign:"baseline"}}),modalHeaderClose:(0,n.css)({height:"100%",display:"flex",alignItems:"center",color:o.colors.text.secondary,flexGrow:1,justifyContent:"flex-end"}),modalContent:(0,n.css)({overflow:"auto",padding:o.spacing(3),width:"100%"}),modalButtonRow:(0,n.css)({paddingTop:o.spacing(3)})}}},32372:(Q,I,e)=>{"use strict";e.d(I,{B:()=>b});var n=e(32196),a=e(96540),o=e(96915),r=e(13544),i=e(40845),f=e(85828),d=e(19716);function l(P){for(let c=P.length-1;c>0;c--){const y=P.charAt(c);if(y==="$")return{index:c,prefix:P.substring(c)};if(y===" "||y==="	"||y==='"'||y==="'")return{index:c+1,prefix:P.substring(c+1)}}return{index:0,prefix:P}}function m(P,c,y,p){const v=[];for(const D of y)c&&!D.label.startsWith(c)||v.push({...D,kind:s(P,D.kind),range:p,insertText:D.insertText??D.label});return v}function s(P,c){switch(c){case d.q.Method:return P.languages.CompletionItemKind.Method;case d.q.Field:return P.languages.CompletionItemKind.Field;case d.q.Property:return P.languages.CompletionItemKind.Property;case d.q.Constant:return P.languages.CompletionItemKind.Constant;case d.q.Text:return P.languages.CompletionItemKind.Text}return P.languages.CompletionItemKind.Text}function h(P,c,y,p){if(!(!c||!y))return P.languages.registerCompletionItemProvider(c,{triggerCharacters:["$"],provideCompletionItems:(v,D,E)=>{if(v.id!==p)return;const S={startLineNumber:D.lineNumber,endLineNumber:D.lineNumber,startColumn:D.column,endColumn:D.column};if(E.triggerCharacter==="$")return S.startColumn=D.column-1,{suggestions:m(P,"$",y(),S)};const T=v.getValueInRange({startLineNumber:D.lineNumber,startColumn:1,endLineNumber:D.lineNumber,endColumn:D.column}),{index:M,prefix:A}=l(T);S.startColumn=M+1;const x=m(P,A,y(),S);if(x.length)return{suggestions:x}}})}class u extends a.PureComponent{constructor(c){super(c),this.loadCustomLanguage=()=>{const{language:y}=this.props,p=o.l.getIfExists(y);return p?p.init():Promise.resolve()},this.getEditorValue=()=>"",this.onBlur=()=>{const{onBlur:y}=this.props;y&&y(this.getEditorValue())},this.onFocus=()=>{const{onFocus:y}=this.props;y&&y(this.getEditorValue())},this.onSave=()=>{const{onSave:y}=this.props;y&&y(this.getEditorValue())},this.handleBeforeMount=y=>{this.monaco=y;const{onBeforeEditorMount:p}=this.props;p?.(y)},this.handleOnMount=(y,p)=>{const{getSuggestions:v,language:D,onChange:E,onEditorDidMount:S}=this.props;this.modelId=y.getModel()?.id,this.getEditorValue=()=>y.getValue(),v&&this.modelId&&(this.completionCancel=h(p,D,v,this.modelId)),y.onKeyDown(T=>{T.keyCode===p.KeyCode.KeyS&&(T.ctrlKey||T.metaKey)&&(T.preventDefault(),this.onSave())}),E&&y.getModel()?.onDidChangeContent(()=>E(y.getValue())),S&&S(y,p)}}componentWillUnmount(){this.completionCancel&&this.completionCancel.dispose(),this.props.onEditorWillUnmount?.()}componentDidUpdate(c){const{getSuggestions:y,language:p}=this.props,v=c.language!==p;if(c.getSuggestions!==y||v){if(this.completionCancel&&this.completionCancel.dispose(),!this.monaco){console.warn("Monaco instance not loaded yet");return}y&&this.modelId&&(this.completionCancel=h(this.monaco,p,y,this.modelId))}v&&this.loadCustomLanguage()}render(){const{theme:c,language:y,width:p,height:v,showMiniMap:D,showLineNumbers:E,readOnly:S,monacoOptions:T}=this.props,{alwaysConsumeMouseWheel:M,...A}=T??{},x=this.props.value??"",C=x.length>100,O=this.props.containerStyles??g(c).container,R={wordWrap:"off",tabSize:2,codeLens:!1,contextmenu:!1,minimap:{enabled:C&&D,renderCharacters:!1},readOnly:S,lineNumbersMinChars:4,lineDecorationsWidth:1*c.spacing.gridSize,overviewRulerBorder:!1,automaticLayout:!0,padding:{top:.5*c.spacing.gridSize,bottom:.5*c.spacing.gridSize},fixedOverflowWidgets:!0,scrollbar:{alwaysConsumeMouseWheel:M??!1}};return E||(R.glyphMargin=!1,R.folding=!1,R.lineNumbers="off",R.lineNumbersMinChars=0),a.createElement("div",{className:O,onFocus:this.onFocus,onBlur:this.onBlur,"data-testid":r.Tp.components.CodeEditor.container},a.createElement(f.m,{width:p,height:v,language:y,value:x,options:{...R,...A??{}},beforeMount:this.handleBeforeMount,onMount:this.handleOnMount,keepCurrentModel:!0}))}}const b=(0,i.cV)(u),g=P=>({container:(0,n.css)({borderRadius:P.shape.radius.default,border:`1px solid ${P.components.input.borderColor}`})})},85828:(Q,I,e)=>{"use strict";e.d(I,{m:()=>m});var n=e(32196),a=e(96540),o=e(13544),r=e(40845),i=e(16817);const f=h=>{const u=(0,i.A)(async()=>await h);return{...u,dependency:u.value}};var d=e(52446),l=e(39558);const m=h=>{const u=(0,r.of)(s),{loading:b,error:g,dependency:P}=f(Promise.all([e.e(8477),e.e(6556),e.e(8926)]).then(e.bind(e,16556)));if(b)return a.createElement(l._,{text:"Loading editor",className:u.container});if(g)return a.createElement(d.D,{title:"React Monaco Editor failed to load",error:g,errorInfo:{componentStack:g?.stack??""}});const c=P.ReactMonacoEditor;return a.createElement(c,{...h,loading:h.loading??null,wrapperProps:{"data-testid":o.Tp.components.ReactMonacoEditor.editorLazy}})},s=h=>({container:(0,n.css)({marginBottom:"unset",marginLeft:h.spacing(1)})})},19716:(Q,I,e)=>{"use strict";e.d(I,{q:()=>n});var n=(a=>(a.Method="method",a.Field="field",a.Property="property",a.Constant="constant",a.Text="text",a))(n||{})},99544:(Q,I,e)=>{"use strict";e.d(I,{O:()=>a});var n=e(19716);function a(o){const r="${"+o.value+"}",i=o.value===o.label?o.origin:`${o.label} / ${o.origin}`;return{label:r,kind:n.q.Property,detail:i,documentation:o.documentation}}},95247:(Q,I,e)=>{"use strict";e.d(I,{d:()=>s});var n=e(32196),a=e(96540),o=e(13544),r=e(40845),i=e(16797),f=e(14578),d=e(29158),l=e(50720),m=e(15068);const s=a.memo(({title:u,section:b,parent:g,pageIcon:P,onGoBack:c,children:y,titleHref:p,parentHref:v,leftItems:D,isFullscreen:E,className:S,"aria-label":T,buttonOverflowAlignment:M="right",forceShowLeftItems:A=!1})=>{const x=(0,r.of)(h),C=(0,n.cx)("page-toolbar",x.toolbar,{"page-toolbar--fullscreen":E,[x.noPageIcon]:!P},S),O=a.createElement(a.Fragment,null,a.createElement("span",{className:x.truncateText},u),b&&a.createElement("span",{className:x.pre}," / ",b));return a.createElement("nav",{className:C,"aria-label":T},a.createElement("div",{className:x.leftWrapper},P&&!c&&a.createElement("div",{className:x.pageIcon},a.createElement(f.I,{name:P,size:"lg","aria-hidden":!0})),c&&a.createElement("div",{className:x.pageIcon},a.createElement(d.K,{name:"arrow-left",tooltip:"Go back (Esc)",tooltipPlacement:"bottom",size:"xxl","data-testid":o.Tp.components.BackButton.backArrow,onClick:c})),a.createElement("nav",{"aria-label":"Search links",className:x.navElement},g&&v&&a.createElement(a.Fragment,null,a.createElement(l.N,{"aria-label":`Search dashboard in the ${g} folder`,className:(0,n.cx)(x.titleText,x.parentLink,x.titleLink,x.truncateText),href:v},g," ",a.createElement("span",{className:x.parentIcon})),p&&a.createElement("span",{className:(0,n.cx)(x.titleText,x.titleDivider),"aria-hidden":!0},"/")),(u||!!D?.length)&&a.createElement("div",{className:x.titleWrapper},u&&a.createElement("h1",{className:x.h1Styles},p?a.createElement(l.N,{"aria-label":"Search dashboard by name",className:(0,n.cx)(x.titleText,x.titleLink),href:p},O):a.createElement("div",{className:x.titleText},O)),D?.map((R,L)=>a.createElement("div",{className:(0,n.cx)(x.leftActionItem,{[x.forceShowLeftActionItems]:A}),key:L},R))))),a.createElement(m.U,{alignment:M},a.Children.toArray(y).filter(Boolean)))});s.displayName="PageToolbar";const h=u=>{const{spacing:b,typography:g}=u,P=(0,i.getFocusStyles)(u);return{pre:(0,n.css)({whiteSpace:"pre"}),toolbar:(0,n.css)({alignItems:"center",background:u.colors.background.canvas,display:"flex",gap:u.spacing(2),justifyContent:"space-between",padding:u.spacing(1.5,2),[u.breakpoints.down("md")]:{paddingLeft:"53px"}}),noPageIcon:(0,n.css)({[u.breakpoints.down("md")]:{paddingLeft:u.spacing(2)}}),leftWrapper:(0,n.css)({display:"flex",flexWrap:"nowrap",maxWidth:"70%"}),pageIcon:(0,n.css)({display:"none",[u.breakpoints.up("sm")]:{display:"flex",paddingRight:u.spacing(1),alignItems:"center"}}),truncateText:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),titleWrapper:(0,n.css)({display:"flex",margin:0,minWidth:0}),navElement:(0,n.css)({display:"flex",alignItems:"center",minWidth:0}),h1Styles:(0,n.css)({margin:b(0,1,0,0),lineHeight:"inherit",flexGrow:1,minWidth:0}),parentIcon:(0,n.css)({marginLeft:u.spacing(.5)}),titleText:(0,n.css)({display:"flex",fontSize:g.size.lg,margin:0,borderRadius:u.shape.radius.default}),titleLink:(0,n.css)({"&:focus-visible":P}),titleDivider:(0,n.css)({padding:b(0,.5,0,.5),display:"none",[u.breakpoints.up("md")]:{display:"unset"}}),parentLink:(0,n.css)({display:"none",[u.breakpoints.up("md")]:{display:"unset",flex:1}}),leftActionItem:(0,n.css)({display:"none",alignItems:"center",paddingRight:b(.5),[u.breakpoints.up("md")]:{display:"flex"}}),forceShowLeftActionItems:(0,n.css)({display:"flex"})}}},19384:(Q,I,e)=>{"use strict";e.d(I,{d:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(55852),i=e(14578);const f=({currentPage:l,numberOfPages:m,onNavigate:s,hideWhenSinglePage:h,showSmallVersion:u,className:b})=>{const g=(0,o.of)(d),P=u?1:8,c=(0,a.useMemo)(()=>{const y=[...new Array(m).keys()],p=m>P,v=(D,E)=>a.createElement("li",{key:D,className:g.item},a.createElement(r.$n,{size:"sm",variant:E,onClick:()=>s(D)},D));return y.reduce((D,E)=>{const S=E+1,T=S===l?"primary":"secondary",M=P,A=m-P+1,x=A-M,C=S===1||S===m,O=x>-1&&l>=M&&l<=A,R=u?1:3,L=u?0:2;return p?C||l<M&&S<M||x>=0&&l>A&&S>A||x<0&&l>=M&&S>A||O&&S>=l-L&&S<=l+L?D.push(v(S,T)):(S===M&&l<M||S===A&&l>A||O&&(S===l-R||S===l+R))&&D.push(a.createElement("li",{key:S,className:g.item},a.createElement(i.I,{className:g.ellipsis,name:"ellipsis-v"}))):D.push(v(S,T)),D},[])},[l,m,s,P,u,g.ellipsis,g.item]);return h&&m<=1?null:a.createElement("div",{className:(0,n.cx)(g.container,b)},a.createElement("ol",null,a.createElement("li",{className:g.item},a.createElement(r.$n,{"aria-label":"previous page",size:"sm",variant:"secondary",onClick:()=>s(l-1),disabled:l===1},a.createElement(i.I,{name:"angle-left"}))),c,a.createElement("li",{className:g.item},a.createElement(r.$n,{"aria-label":"next page",size:"sm",variant:"secondary",onClick:()=>s(l+1),disabled:l===m},a.createElement(i.I,{name:"angle-right"})))))},d=()=>({container:(0,n.css)({float:"right"}),item:(0,n.css)({display:"inline-block",paddingLeft:"10px",marginBottom:"5px"}),ellipsis:(0,n.css)({transform:"rotate(90deg)"})})},89963:(Q,I,e)=>{"use strict";e.d(I,{I:()=>d});var n=e(32196),a=e(96540),o=e(13544),r=e(40845),i=e(14578),f=e(56034);const d=({onCancel:m,loading:s})=>{const h=(0,r.of)(l);return s?a.createElement(f.m,{content:"Cancel query"},a.createElement(i.I,{className:(0,n.cx)("spin-clockwise",{[h.clickable]:!!m}),name:"sync",size:"sm",onClick:m,"data-testid":o.Tp.components.LoadingIndicator.icon})):null},l=()=>({clickable:(0,n.css)({cursor:"pointer"})})},79041:(Q,I,e)=>{"use strict";e.d(I,{XF:()=>r,d2:()=>i,e4:()=>o});var n=e(96540),a=e(18226);const o=n.createContext({eventsScope:"global",eventBus:new a.o}),r=o.Provider,i=()=>n.useContext(o)},91052:(Q,I,e)=>{"use strict";e.d(I,{NR:()=>F});var n=e(89963),a=e(32196),o=e(96540),r=e(42941),i=e(49185),f=e(39070),d=e(13544),l=e(40845),m=e(16797);function s({children:K,delay:B}){const[w,U]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{window.setTimeout(()=>{U(!0)},B)},[K,B]),o.createElement(o.Fragment,null,w?K:null)}var h=e(14578),u=e(57514),b=e(94753),g=e(56034),P=e(83122),c=e(27746);function y({menu:K,title:B,placement:w="bottom",offset:U,dragClassCancel:W,menuButtonClass:V,onOpenMenu:_}){const H=B?d.Tp.components.Panels.Panel.menu(B):"panel-menu-button",G=(0,o.useCallback)(j=>{j&&_&&_()},[_]);return o.createElement(P.m,{overlay:K,placement:w,offset:U,onVisibleChange:G},o.createElement(c.I,{"aria-label":`Menu for panel with ${B?`title ${B}`:"no title"}`,title:"Menu",icon:"ellipsis-v",iconSize:"md",narrow:!0,"data-testid":H,className:(0,a.cx)(V,W)}))}function p({menu:K,title:B,dragClass:w,children:U,offset:W=-32,onOpenMenu:V}){const _=(0,l.of)(v),H=(0,o.useRef)(null),G=d.Tp.components.Panels.Panel.HoverWidget,j=(0,o.useCallback)(oe=>{H.current?.setPointerCapture(oe.pointerId)},[]),Y=(0,o.useCallback)(oe=>{H.current?.releasePointerCapture(oe.pointerId)},[]);return U===void 0||o.Children.count(U)===0?null:o.createElement("div",{className:(0,a.cx)(_.container,"show-on-hover"),style:{top:W},"data-testid":G.container},w&&o.createElement("div",{className:(0,a.cx)(_.square,_.draggable,w),onPointerDown:j,onPointerUp:Y,ref:H,"data-testid":G.dragIcon},o.createElement(h.I,{name:"expand-arrows",className:_.draggableIcon})),U,K&&o.createElement(y,{menu:K,title:B,placement:"bottom",menuButtonClass:_.menuButton,onOpenMenu:V}))}function v(K){return{container:(0,a.css)({label:"hover-container-widget",[K.transitions.handleMotion("no-preference","reduce")]:{transition:"all .1s linear"},display:"flex",position:"absolute",zIndex:1,right:0,boxSizing:"content-box",alignItems:"center",background:K.colors.background.secondary,color:K.colors.text.primary,border:`1px solid ${K.colors.border.weak}`,borderRadius:K.shape.radius.default,height:K.spacing(4),boxShadow:K.shadows.z1}),square:(0,a.css)({display:"flex",justifyContent:"center",alignItems:"center",width:K.spacing(4),height:"100%"}),draggable:(0,a.css)({cursor:"move",[K.breakpoints.down("md")]:{display:"none"}}),menuButton:(0,a.css)({background:"inherit",border:"none","&:hover":{background:K.colors.secondary.main}}),draggableIcon:(0,a.css)({transform:"rotate(45deg)",color:K.colors.text.secondary,"&:hover":{color:K.colors.text.primary}})}}var D=e(55852);const E=(0,o.forwardRef)(({className:K,children:B,href:w,onClick:U,target:W,title:V,..._},H)=>{const G=(0,l.of)(S);return w?o.createElement("a",{ref:H,href:w,onClick:U,target:W,title:V,className:(0,a.cx)(G.linkItem,K),..._},B):U?o.createElement(D.$n,{ref:H,className:(0,a.cx)(G.item,K),variant:"secondary",fill:"text",onClick:U},B):o.createElement("span",{ref:H,className:(0,a.cx)(G.item,K),..._},B)});E.displayName="TitleItem";const S=K=>{const B=(0,a.css)({color:`${K.colors.text.secondary}`,label:"panel-header-item",cursor:"auto",border:"none",borderRadius:`${K.shape.radius.default}`,padding:`${K.spacing(0,1)}`,height:`${K.spacing(K.components.panel.headerHeight)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,m.getFocusStyles)(K),zIndex:1},"&: focus:not(:focus-visible)":(0,m.getMouseFocusStyles)(K),"&:hover ":{boxShadow:`${K.shadows.z1}`,background:`${K.colors.background.secondary}`,color:`${K.colors.text.primary}`}});return{item:B,linkItem:(0,a.cx)(B,(0,a.css)({cursor:"pointer"}))}};function T({description:K,className:B}){const w=(0,l.of)(M),U=()=>{const W=typeof K=="function"?K():K;return o.createElement("div",{className:"panel-info-content markdown-html"},o.createElement("div",{dangerouslySetInnerHTML:{__html:W}}))};return K!==""?o.createElement(g.m,{interactive:!0,content:U},o.createElement(E,{className:(0,a.cx)(B,w.description)},o.createElement(h.I,{name:"info-circle",size:"md"}))):null}const M=K=>({description:(0,a.css)({code:{whiteSpace:"normal",wordWrap:"break-word"},"pre > code":{display:"block"}})});function A({message:K,onClick:B,ariaLabel:w="status"}){const U=(0,l.of)(x);return o.createElement(c.I,{className:U.buttonStyles,onClick:B,variant:"destructive",icon:"exclamation-triangle",iconSize:"md",tooltip:K||"","aria-label":w,"data-testid":d.Tp.components.Panels.Panel.status("error")})}const x=K=>{const{headerHeight:B,padding:w}=K.components.panel;return{buttonStyles:(0,a.css)({label:"panel-header-state-button",display:"flex",alignItems:"center",justifyContent:"center",padding:K.spacing(w),width:K.spacing(B),height:K.spacing(B),borderRadius:K.shape.radius.default})}};function C({width:K,height:B,children:w,padding:U="md",title:W="",description:V="",displayMode:_="default",titleItems:H,menu:G,dragClass:j,dragClassCancel:Y,hoverHeader:oe=!1,hoverHeaderOffset:se,loadingState:ne,statusMessage:ee,statusMessageOnClick:Z,leftItems:z,actions:q,onCancelQuery:ie,onOpenMenu:de,collapsible:ue=!1,collapsed:fe,onToggleCollapse:Se,onFocus:he,onMouseMove:ce}){const me=(0,l.$j)(),pe=(0,l.of)(N),ye=(0,o.useId)(),Pe=!oe,[Ie,Oe]=(0,r.A)(!0);fe===void 0&&(fe=!Ie);const Ne="show-on-hover",We=_==="transparent",Ae=R(me,Pe),{contentStyle:Ue,innerWidth:Me,innerHeight:$e}=L(U,me,Ae,fe,B,K),ke={height:Ae,cursor:j?"move":"auto"},Ze={width:K,height:fe?void 0:B},[ot,{width:xt}]=(0,i.A)();z&&(q=z);const ct=typeof W=="string"?d.Tp.components.Panels.Panel.title(W):"Panel",ft=o.createElement(o.Fragment,null,!ue&&W&&o.createElement("div",{className:pe.title},o.createElement(b.E,{element:"h2",variant:"h6",truncate:!0,title:typeof W=="string"?W:void 0},W)),ue&&o.createElement("div",{className:pe.title},o.createElement(b.E,{element:"h2",variant:"h6"},o.createElement("button",{type:"button",className:pe.clearButtonStyles,onClick:()=>{Oe(),Se&&Se(!fe)},"aria-expanded":!fe,"aria-controls":fe?void 0:ye},o.createElement(h.I,{name:fe?"angle-right":"angle-down","aria-hidden":!!W,"aria-label":W?void 0:"toggle collapse panel"}),o.createElement(b.E,{variant:"h6",truncate:!0},W)))),o.createElement("div",{className:(0,a.cx)(pe.titleItems,Y),"data-testid":"title-items-container"},o.createElement(T,{description:V,className:Y}),H),ne===f.Gu.Streaming&&o.createElement(g.m,{content:ie?"Stop streaming":"Streaming"},o.createElement(E,{className:Y,"data-testid":"panel-streaming",onClick:ie},o.createElement(h.I,{name:"circle-mono",size:"md",className:pe.streaming}))),ne===f.Gu.Loading&&ie&&o.createElement(s,{delay:2e3},o.createElement(g.m,{content:"Cancel query"},o.createElement(E,{className:(0,a.cx)(Y,pe.pointer),"data-testid":"panel-cancel-query",onClick:ie},o.createElement(h.I,{name:"sync-slash",size:"md"})))),o.createElement("div",{className:pe.rightAligned},q&&o.createElement("div",{className:pe.rightActions},O(q,Le=>Le))));return o.createElement("section",{className:(0,a.cx)(pe.container,{[pe.transparentContainer]:We}),style:Ze,"data-testid":ct,tabIndex:0,onFocus:he,onMouseMove:ce,ref:ot},o.createElement("div",{className:pe.loadingBarContainer},ne===f.Gu.Loading?o.createElement(u.G,{width:xt,ariaLabel:"Panel loading bar"}):null),oe&&o.createElement(o.Fragment,null,o.createElement(p,{menu:G,title:typeof W=="string"?W:void 0,offset:se,dragClass:j,onOpenMenu:de},ft),ee&&o.createElement("div",{className:pe.errorContainerFloating},o.createElement(A,{message:ee,onClick:Z,ariaLabel:"Panel status"}))),Pe&&o.createElement("div",{className:(0,a.cx)(pe.headerContainer,j),style:ke,"data-testid":"header-container"},ee&&o.createElement("div",{className:Y},o.createElement(A,{message:ee,onClick:Z,ariaLabel:"Panel status"})),ft,G&&o.createElement(y,{menu:G,title:typeof W=="string"?W:void 0,placement:"bottom-end",menuButtonClass:(0,a.cx)(pe.menuItem,Y,Ne),onOpenMenu:de})),!fe&&o.createElement("div",{id:ye,"data-testid":d.Tp.components.Panels.Panel.content,className:(0,a.cx)(pe.content,B===void 0&&pe.containNone),style:Ue},typeof w=="function"?w(Me,$e):w))}const O=(K,B)=>{const w=o.Children.toArray(K).filter(Boolean);return w.length>0?B(w):null},R=(K,B)=>B?K.spacing.gridSize*K.components.panel.headerHeight:0,L=(K,B,w,U,W,V)=>{const _=(K==="md"?B.components.panel.padding:0)*B.spacing.gridSize,H=_*2,G=1*2;let j=0;V&&(j=V-H-G);let Y=0;return W&&(Y=W-w-H-G),U&&(Y=w),{contentStyle:{padding:_},innerWidth:j,innerHeight:Y}},N=K=>{const{background:B,borderColor:w,padding:U}=K.components.panel;return{container:(0,a.css)({label:"panel-container",backgroundColor:B,border:`1px solid ${w}`,position:"relative",borderRadius:K.shape.radius.default,height:"100%",display:"flex",flexDirection:"column",".show-on-hover":{opacity:"0",visibility:"hidden"},"&:focus-visible, &:hover":{".show-on-hover":{opacity:"1",visibility:"visible"}},"&:focus-visible":(0,m.getFocusStyles)(K),"&:focus-within:not(:focus)":{".show-on-hover":{visibility:"visible",opacity:"1"}}}),transparentContainer:(0,a.css)({label:"panel-transparent-container",backgroundColor:"transparent",border:"1px solid transparent",boxSizing:"border-box","&:hover":{border:`1px solid ${w}`}}),loadingBarContainer:(0,a.css)({label:"panel-loading-bar-container",position:"absolute",top:0,width:"100%"}),containNone:(0,a.css)({contain:"none"}),content:(0,a.css)({label:"panel-content",flexGrow:1,contain:"size layout"}),headerContainer:(0,a.css)({label:"panel-header",display:"flex",alignItems:"center"}),pointer:(0,a.css)({cursor:"pointer"}),streaming:(0,a.css)({label:"panel-streaming",marginRight:0,color:K.colors.success.text,"&:hover":{color:K.colors.success.text}}),title:(0,a.css)({label:"panel-title",display:"flex",padding:K.spacing(0,U),minWidth:0,"& > h2":{minWidth:0}}),items:(0,a.css)({display:"flex"}),item:(0,a.css)({display:"flex",justifyContent:"center",alignItems:"center"}),hiddenMenu:(0,a.css)({visibility:"hidden"}),menuItem:(0,a.css)({label:"panel-menu",border:"none",background:K.colors.secondary.main,"&:hover":{background:K.colors.secondary.shade}}),errorContainerFloating:(0,a.css)({label:"error-container",position:"absolute",left:0,top:0,zIndex:1}),rightActions:(0,a.css)({display:"flex",padding:K.spacing(0,U),gap:K.spacing(1)}),rightAligned:(0,a.css)({label:"right-aligned-container",marginLeft:"auto",display:"flex",alignItems:"center"}),titleItems:(0,a.css)({display:"flex",height:"100%"}),clearButtonStyles:(0,a.css)({alignItems:"center",display:"flex",gap:K.spacing(.5),background:"transparent",border:"none",padding:0,maxWidth:"100%"})}},F=C;F.LoadingIndicator=n.I,F.TitleItem=E},88895:(Q,I,e)=>{"use strict";e.d(I,{B:()=>n});var n=(a=>(a.ToggleSelection="select",a.AppendToSelection="append",a))(n||{})},52494:(Q,I,e)=>{"use strict";e.d(I,{_:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=({children:f,className:d,...l})=>{const m=(0,o.of)(i);return a.createElement("div",{className:(0,n.cx)(m,d),...l},f)},i=f=>(0,n.css)({backgroundColor:f.components.panel.background,border:`1px solid ${f.components.panel.borderColor}`,borderRadius:f.shape.radius.default})},98624:(Q,I,e)=>{"use strict";e.d(I,{B:()=>r});var n=e(96540),a=e(43429),o=e(39938);const r=({status:f,color:d,...l})=>{const m=i(f);return n.createElement(o.E,{text:m.text,color:m.color,icon:m.icon,tooltip:m.tooltip,...l})};r.displayName="PluginSignatureBadge";function i(f){switch(f||(f=a.Ac.invalid),f){case a.Ac.internal:return{text:"Core",color:"blue",tooltip:"Core plugin that is bundled with Grafana"};case a.Ac.valid:return{text:"Signed",icon:"lock",color:"green",tooltip:"Signed and verified plugin"};case a.Ac.invalid:return{text:"Invalid signature",icon:"exclamation-triangle",color:"red",tooltip:"Invalid plugin signature"};case a.Ac.modified:return{text:"Modified signature",icon:"exclamation-triangle",color:"red",tooltip:"Valid signature but content has been modified"};case a.Ac.missing:return{text:"Missing signature",icon:"exclamation-triangle",color:"red",tooltip:"Missing plugin signature"};default:return{text:"Unsigned",icon:"exclamation-triangle",color:"red",tooltip:"Unsigned external plugin"}}}},17464:(Q,I,e)=>{"use strict";e.d(I,{ZL:()=>r,gF:()=>i,qB:()=>f});var n=e(96540),a=e(40961),o=e(40845);function r(l){const{children:m,className:s,root:h,forwardedRef:u}=l,b=(0,o.$j)(),g=(0,n.useRef)(null),P=h??i();return g.current||(g.current=document.createElement("div"),s&&(g.current.className=s),g.current.style.position="relative",g.current.style.zIndex=`${b.zIndex.portal}`),(0,n.useLayoutEffect)(()=>(g.current&&P.appendChild(g.current),()=>{g.current&&P.removeChild(g.current)}),[P]),a.createPortal(n.createElement("div",{ref:u},m),g.current)}function i(){return window.document.getElementById("grafana-portal-container")??document.body}function f(){return n.createElement("div",{id:"grafana-portal-container"})}const d=n.forwardRef((l,m)=>n.createElement(r,{...l,forwardedRef:m}));d.displayName="RefForwardingPortal"},20084:(Q,I,e)=>{"use strict";e.d(I,{X:()=>E});var n=e(32196),a=e(46942),o=e.n(a),r=e(2543),i=e.n(r),f=e(96540),d=e(75226),l=e(29317),m=e(13544),s=e(80903),h=e(4269),u=e(88295),b=e(74738),g=e(31589),P=e(1020),c=e(99453),y=e(40845),p=e(16797),v=e(72307);class D extends f.PureComponent{constructor(M){super(M),this.lastExecutedValue=null,this.mounted=!1,this.editor=null,this.onChange=(R,L)=>{const N=R.document!==this.state.value.document,F=this.state.value;this.props.onRichValueChange&&this.props.onRichValueChange(R),this.setState({value:R},()=>{if(N){const K=d.A.serialize(F)!==d.A.serialize(R);K&&L&&this.runOnChangeAndRunQuery(),K&&!L&&this.runOnChangeDebounced()}})},this.runOnChange=()=>{const{onChange:R}=this.props,L=d.A.serialize(this.state.value);R&&R(this.cleanText(L))},this.runOnRunQuery=()=>{const{onRunQuery:R}=this.props;R&&(R(),this.lastExecutedValue=this.state.value)},this.runOnChangeAndRunQuery=()=>{this.runOnChange(),this.runOnRunQuery()},this.handleBlur=(R,L,N)=>{const{onBlur:F}=this.props;if(F)F();else{const K=this.lastExecutedValue?d.A.serialize(this.lastExecutedValue):"",B=d.A.serialize(L.value);K!==B&&this.runOnChangeAndRunQuery()}return N()},this.runOnChangeDebounced=(0,r.debounce)(this.runOnChange,500);const{onTypeahead:A,cleanText:x,portalOrigin:C,onWillApplySuggestion:O}=M;this.plugins=[(0,s.Pz)({onTypeahead:A,cleanText:x,portalOrigin:C,onWillApplySuggestion:O}),(0,h.U)({handler:this.runOnChangeAndRunQuery}),(0,u.O)(),(0,b.v)(),(0,g.l)(),(0,P.T)(),(0,c.s)(),...M.additionalPlugins||[]].filter(R=>R),this.state={suggestions:[],typeaheadContext:null,typeaheadPrefix:"",typeaheadText:"",value:(0,v.mO)(M.query||"",M.syntax)}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}componentDidUpdate(M,A){const{query:x,syntax:C,syntaxLoaded:O}=this.props;if(!M.syntaxLoaded&&O&&this.editor){const L=this.editor.insertText(" ").deleteBackward(1);this.onChange(L.value,!0)}const{value:R}=this.state;x!==M.query&&x!==d.A.serialize(R)&&this.setState({value:(0,v.mO)(x||"",C)})}cleanText(M){return M.replace(/[\r]/g,"")}render(){const{disabled:M,theme:A}=this.props,x=o()("slate-query-field__wrapper",{"slate-query-field__wrapper--disabled":M}),C=S(A);return f.createElement("div",{className:(0,n.cx)(x,C.wrapper)},f.createElement("div",{className:"slate-query-field","data-testid":m.Tp.components.QueryField.container},f.createElement(l.KE,{ref:O=>this.editor=O,schema:v.yx,autoCorrect:!1,readOnly:this.props.disabled,onBlur:this.handleBlur,onClick:this.props.onClick,onChange:O=>{this.onChange(O.value,!1)},placeholder:this.props.placeholder,plugins:this.plugins,spellCheck:!1,value:this.state.value})))}}const E=(0,y.cV)(D);E.defaultProps={onBlur:()=>{}};const S=T=>{const M=(0,p.getFocusStyles)(T);return{wrapper:(0,n.css)({"&:focus-within":M})}}},11134:(Q,I,e)=>{"use strict";e.d(I,{cC:()=>s,cb:()=>m});var n=e(91e3),a=e(96540),o=e(70416),r=e(13544),i=e(76412),f=e(19727),d=e(9261),l=e(27746);const m=["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"];class s extends a.PureComponent{constructor(g){super(g),this.onChangeSelect=P=>{const{onIntervalChanged:c}=this.props;c&&P.value!=null&&c(P.value)}}static{this.offOption={label:"Off",value:"",ariaLabel:"Turn off auto refresh"}}static{this.liveOption={label:"Live",value:"LIVE",ariaLabel:"Turn on live streaming"}}static{this.autoOption={label:"Auto",value:"auto",ariaLabel:"Select refresh from the query range"}}static{this.isLive=g=>g===s.liveOption.value}getVariant(){return this.props.isLive||this.props.primary?"primary":this.props.isOnCanvas?"canvas":"default"}render(){const{onRefresh:g,intervals:P,tooltip:c,value:y,text:p,isLoading:v,noIntervalPicker:D,width:E,showAutoInterval:S}=this.props,T=y||"",M=this.getVariant(),A=u({intervals:P,showAutoInterval:S}),x=A.find(({value:U})=>U===T),C=h(s.offOption.value);let O=x||C;O.label===C.label&&(O={value:""});const R=O.ariaLabel,L=(0,i.t)("refresh-picker.aria-label.duration-selected","Choose refresh time interval with current interval {{durationAriaLabel}} selected",{durationAriaLabel:R}),N=(0,i.t)("refresh-picker.aria-label.choose-interval","Auto refresh turned off. Choose refresh time interval"),F=O.value===""?N:L,K=(0,i.t)("refresh-picker.tooltip.interval-selected","Set auto refresh interval"),B=(0,i.t)("refresh-picker.tooltip.turned-off","Auto refresh off"),w=O.value===""?B:K;return a.createElement(f.e,{className:"refresh-picker"},a.createElement(l.I,{"aria-label":p,tooltip:c,onClick:g,variant:M,icon:v?"spinner":"sync",style:E?{width:E}:void 0,"data-testid":r.Tp.components.RefreshPicker.runButtonV2},p),!D&&a.createElement(d.f,{value:O,options:A,onChange:this.onChangeSelect,variant:M,"data-testid":r.Tp.components.RefreshPicker.intervalButtonV2,"aria-label":F,tooltip:w}))}}function h(b){switch(b){case s.liveOption.value:return{label:(0,i.t)("refresh-picker.live-option.label","Live"),value:b,ariaLabel:(0,i.t)("refresh-picker.live-option.aria-label","Turn on live streaming")};case s.offOption.value:return{label:(0,i.t)("refresh-picker.off-option.label","Off"),value:b,ariaLabel:(0,i.t)("refresh-picker.off-option.aria-label","Turn off auto refresh")};case s.autoOption.value:return{label:(0,i.t)("refresh-picker.auto-option.label",s.autoOption.label),value:b,ariaLabel:(0,i.t)("refresh-picker.auto-option.aria-label",s.autoOption.ariaLabel)}}return{label:b,value:b}}function u({intervals:b=m,showAutoInterval:g=!1}={}){const P=b.map(c=>{const y=(0,o.E9)(c),p=(0,n.a)(y);return{label:c,value:c,ariaLabel:p}});return g&&P.unshift(h(s.autoOption.value)),P.unshift(h(s.offOption.value)),P}},44522:(Q,I,e)=>{"use strict";e.d(I,{I:()=>o});var n=e(96540),a=e(40672);function o({component:r,content:i,...f}){return n.createElement(r||"span",{dangerouslySetInnerHTML:{__html:a.sQ.sanitize(i)},...f})}},56286:(Q,I,e)=>{"use strict";e.d(I,{L:()=>l});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(55852),f=e(90090);const d=()=>({noRadiusInput:(0,n.css)({borderBottomRightRadius:"0 !important",borderTopRightRadius:"0 !important"}),noRadiusButton:(0,n.css)({borderBottomLeftRadius:"0 !important",borderTopLeftRadius:"0 !important"})}),l=({label:m="Password",labelWidth:s,inputWidth:h=12,onReset:u,isConfigured:b,tooltip:g,placeholder:P="Password",interactive:c,...y})=>{const p=d();return r.createElement(f.z,{label:m,tooltip:g,interactive:c,labelWidth:s,inputEl:b?r.createElement(r.Fragment,null,r.createElement("input",{type:"text",className:(0,n.cx)(`gf-form-input width-${h}`,p.noRadiusInput),disabled:!0,value:"configured",...(0,a.omit)(y,"value")}),r.createElement(i.$n,{onClick:u,variant:"secondary",type:"button"},"Reset")):r.createElement("input",{type:"password",className:`gf-form-input width-${h}`,placeholder:P,...y})})};l.displayName="SecretFormField"},9226:(Q,I,e)=>{"use strict";e.d(I,{L4:()=>d});var n=e(96540),a=e(55852),o=e(10354),r=e(67061);const i="configured",f="Reset",d=({isConfigured:l,onReset:m,...s})=>n.createElement(r.B,null,!l&&n.createElement(o.p,{...s,type:"password"}),l&&n.createElement(n.Fragment,null,n.createElement(o.p,{...s,type:"text",disabled:!0,value:i}),n.createElement(a.$n,{onClick:m,variant:"secondary"},f)))},49718:(Q,I,e)=>{"use strict";e.d(I,{L:()=>n.L4});var n=e(9226)},58724:(Q,I,e)=>{"use strict";e.d(I,{lp:()=>h});var n=e(32196),a=e(96540),o=e(40845),r=e(55852),i=e(90613),f=e(67061),d=e(21744);const l="configured",m="Reset",s=u=>({configuredStyle:(0,n.css)({minHeight:u.spacing(u.components.height.md),paddingTop:u.spacing(.5),resize:"none"})}),h=({isConfigured:u,onReset:b,...g})=>{const P=(0,o.of)(s);return a.createElement(f.B,null,a.createElement(i.a,null,!u&&a.createElement(d.f,{...g}),u&&a.createElement(d.f,{...g,rows:1,disabled:!0,value:l,className:(0,n.cx)(P.configuredStyle)})),u&&a.createElement(r.$n,{onClick:b,variant:"secondary"},m))}},7968:(Q,I,e)=>{"use strict";e.d(I,{l:()=>n.lp});var n=e(58724)},38401:(Q,I,e)=>{"use strict";e.d(I,{Y:()=>s});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(40845),f=e(76892),d=e(13102),l=e(86997),m=e(2336);function s({options:h,value:u,onChange:b,Component:g,className:P,allowCustomValue:c,allowEmptyValue:y,placeholder:p,disabled:v,inputMinWidth:D,inputPlaceholder:E,onExpandedChange:S,autofocus:T=!1,...M}){const[A,x,C,O]=(0,m.Q)(T,S),R=D?Math.max(D,x):x,L=(0,i.of)(l.m);if(!C){const N=(0,a.isObject)(u)?u.label:u,F=N!=null?String(N):void 0;return r.createElement(A,{disabled:v,Component:g||r.createElement(f.c,{className:(0,n.cx)(L.segment,{[L.queryPlaceholder]:p!==void 0&&!u,[L.disabled]:v},P)},F||p)})}return r.createElement(d.a,{...M,value:u&&!(0,a.isObject)(u)?{value:u}:u,placeholder:E,options:h,width:R,onClickOutside:()=>O(!1),allowCustomValue:c,allowEmptyValue:y,onChange:N=>{O(!1),b(N)}})}},83684:(Q,I,e)=>{"use strict";e.d(I,{s:()=>u});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(41053),f=e(40845),d=e(76412),l=e(76892),m=e(13102),s=e(86997),h=e(2336);function u({value:g,onChange:P,loadOptions:c,reloadOptionsOnChange:y=!1,Component:p,className:v,allowCustomValue:D,allowEmptyValue:E,disabled:S,placeholder:T,inputMinWidth:M,inputPlaceholder:A,autofocus:x=!1,onExpandedChange:C,noOptionMessageHandler:O=b,...R}){const[L,N]=(0,i.A)(c,[c]),[F,K,B,w]=(0,h.Q)(x,C),U=M?Math.max(M,K):K,W=(0,f.of)(s.m);if(!B){const V=(0,a.isObject)(g)?g.label:g,_=V!=null?String(V):void 0;return r.createElement(F,{onClick:y?void 0:N,disabled:S,Component:p||r.createElement(l.c,{className:(0,n.cx)(W.segment,{[W.queryPlaceholder]:T!==void 0&&!g,[W.disabled]:S},v)},_||T)})}return r.createElement(m.a,{...R,value:g&&!(0,a.isObject)(g)?{value:g}:g,placeholder:A,options:L.value??[],loadOptions:y?N:void 0,width:U,noOptionsMessage:O(L),allowCustomValue:D,allowEmptyValue:E,onClickOutside:()=>{w(!1)},onChange:V=>{w(!1),P(V)}})}function b(g){return g.loading?(0,d.t)("grafana-ui.segment-async.loading","Loading options..."):g.error?(0,d.t)("grafana-ui.segment-async.error","Failed to load options"):(0,d.t)("grafana-ui.segment-async.no-options","No options found")}},57752:(Q,I,e)=>{"use strict";e.d(I,{o:()=>s});var n=e(32196),a=e(96540),o=e(37151),r=e(40845),i=e(29413),f=e(76892),d=e(86997),l=e(2336);const m=14;function s({value:h,onChange:u,Component:b,className:g,placeholder:P,inputPlaceholder:c,disabled:y,autofocus:p=!1,onExpandedChange:v,...D}){const E=(0,a.useRef)(null),[S,T]=(0,a.useState)(h),[M,A]=(0,a.useState)((0,i.kD)((h||"").toString(),m).width),[x,,C,O]=(0,l.Q)(p,v),R=(0,r.of)(d.m);if((0,o.A)(E,()=>{O(!1),u(S)}),!C)return a.createElement(x,{disabled:y,Component:b||a.createElement(f.c,{className:(0,n.cx)(R.segment,{[R.queryPlaceholder]:P!==void 0&&!S,[R.disabled]:y},g)},h||P)});const L=(0,n.css)({width:`${Math.max(M+20,32)}px`});return a.createElement("input",{...D,ref:E,autoFocus:!0,className:(0,n.cx)("gf-form gf-form-input",L),value:S,placeholder:c,onChange:N=>{const{width:F}=(0,i.kD)(N.target.value,m);A(F),T(N.target.value)},onBlur:()=>{O(!1),u(S)},onKeyDown:N=>{[13,27].includes(N.keyCode)&&(O(!1),u(S))}})}},64765:(Q,I,e)=>{"use strict";e.d(I,{L:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(39268),i=e(76892);const f=({label:l,htmlFor:m,children:s,fill:h})=>{const u=(0,o.of)(d);return a.createElement(a.Fragment,null,a.createElement(r.C,null,a.createElement(i.c,{htmlFor:m,width:12,className:u.label},l),s,h&&a.createElement("div",{className:u.fill},a.createElement(i.c,null,""))))},d=l=>({label:(0,n.css)({color:l.colors.primary.text}),fill:(0,n.css)({flexGrow:1,marginBottom:l.spacing(.5)})})},13102:(Q,I,e)=>{"use strict";e.d(I,{a:()=>r});var n=e(96540),a=e(40845),o=e(21594);function r({value:i,placeholder:f="",options:d=[],onChange:l,onClickOutside:m,loadOptions:s=void 0,width:h,noOptionsMessage:u="",allowCustomValue:b=!1,allowEmptyValue:g=!1,...P}){const c=(0,n.useRef)(null),y=(0,a.$j)();let p=h>0?h/y.spacing.gridSize:void 0,v,D={};return s?(v=o.DW,D={loadOptions:s,defaultOptions:!0}):v=o.l6,n.createElement("div",{...P,ref:c},n.createElement(v,{width:p,noOptionsMessage:u,placeholder:f,autoFocus:!0,isOpen:!0,onChange:l,options:d,value:i,closeMenuOnSelect:!1,onCloseMenu:()=>{if(c&&c.current){const E=c.current.querySelector('input[id^="react-select-"]');E&&(E.value||g)?l({value:E.value,label:E.value}):m()}},allowCustomValue:b,...D}))}},86997:(Q,I,e)=>{"use strict";e.d(I,{m:()=>a});var n=e(32196);const a=o=>{const r="v1"in o?o.v1.palette:o.palette;return{segment:(0,n.css)({cursor:"pointer",width:"auto"}),queryPlaceholder:(0,n.css)({color:r.gray2}),disabled:(0,n.css)({cursor:"not-allowed",opacity:.65,boxShadow:"none"})}}},2336:(Q,I,e)=>{"use strict";e.d(I,{Q:()=>r});var n=e(96540),a=e(40845),o=e(55852);const r=(i,f)=>{const d=(0,n.useRef)(null),l=(0,a.of)(o.my),[m,s]=(0,n.useState)(i),[h,u]=(0,n.useState)(0),b=P=>{s(P),f&&f(P)};return[({Component:P,onClick:c,disabled:y})=>n.createElement("button",{type:"button",className:l,ref:d,disabled:y,onClick:()=>{b(!0),d&&d.current&&u(d.current.clientWidth*1.25),c?.()}},P),h,m,b]}},5342:(Q,I,e)=>{"use strict";e.d(I,{O:()=>i,p:()=>f});var n=e(96540),a=e(40845),o=e(29158),r=e(88824);const i=({innerProps:d,children:l})=>{const m=(0,a.$j)(),s=(0,r.J)(m);return n.createElement("div",{...d,className:s.multiValueContainer},l)},f=({children:d,innerProps:l})=>{const m=(0,a.$j)(),s=(0,r.J)(m);return n.createElement(o.K,{...l,name:"times",size:"sm",className:s.multiValueRemove,tooltip:"Remove"})}},21594:(Q,I,e)=>{"use strict";e.d(I,{Iv:()=>he,DW:()=>ue,gZ:()=>Se,KF:()=>de,l6:()=>ie,KA:()=>E.K,ip:()=>fe});var n=e(96540),a=e(72635),o=e(46005),r=e(8539),i=e(93943),f=e(66963),d=e(50877),l=e(40845),m=e(14578),s=e(62930),h=e(28581);const u=ce=>{let me;return"data-testid"in ce.selectProps&&ce.selectProps["data-testid"]&&(me=ce.selectProps["data-testid"]+"-input"),n.createElement(h.c.Input,{...ce,"data-testid":me})};function b({selectProps:ce}){const me=ce.menuIsOpen,pe=me?"search":"angle-down",ye=me?"sm":"md";return n.createElement(m.I,{name:pe,size:ye})}var g=e(32196),P=e(10354);const c=n.forwardRef((ce,me)=>{const{children:pe}=ce,ye=(0,l.$j)(),Pe=(0,P.n)({theme:ye,invalid:!1});return n.createElement("div",{className:(0,g.cx)(Pe.suffix,(0,g.css)({position:"relative"})),ref:me},pe)});c.displayName="IndicatorsContainer";var y=e(87266);const p=n.forwardRef(function({focused:me,invalid:pe,disabled:ye,children:Pe,innerProps:Ie,prefix:Oe,...Ne},We){const Ae=(0,l.of)(v,pe,!!Oe);return n.createElement("div",{className:Ae.input,...Ie,ref:We},Oe&&n.createElement("div",{className:(0,g.cx)(Ae.prefix)},Oe),Pe)}),v=(ce,me,pe)=>{const ye=(0,P.n)({theme:ce,invalid:me});return{input:(0,g.cx)((0,y.g$)(ce),(0,g.css)({width:"100%",maxWidth:"100%",display:"flex",flexDirection:"row",alignItems:"center",flexWrap:"wrap",justifyContent:"space-between",paddingRight:0,position:"relative",boxSizing:"border-box"}),pe&&(0,g.css)({paddingLeft:0})),prefix:(0,g.cx)(ye.prefix,(0,g.css)({position:"relative"}))}};var D=e(5342),E=e(4603),S=e(2543),T=e(91793),M=e(8887),A=e(13544),x=e(40276),C=e(88824);const O=({children:ce,maxHeight:me,innerRef:pe,innerProps:ye})=>{const Pe=(0,l.$j)(),Ie=(0,C.J)(Pe);return n.createElement("div",{...ye,className:Ie.menu,style:{maxHeight:me},"aria-label":"Select options menu"},n.createElement(x.E,{scrollRefCallback:pe,autoHide:!1,autoHeightMax:"inherit",hideHorizontalTrack:!0},ce))};O.displayName="SelectMenu";const R=37,L=8,N=8,F=36,K=({children:ce,maxHeight:me,innerRef:pe,options:ye,focusedOption:Pe})=>{const Ie=(0,l.$j)(),Oe=(0,C.J)(Ie),Ne=(0,n.useRef)(null),We=(0,n.useMemo)(()=>ye.flatMap(Ze=>Ze.options?[Ze,...Ze.options]:[Ze]),[ye]),Ae=We.findIndex(Ze=>Ze.value===Pe?.value);if((0,n.useLayoutEffect)(()=>{Ne.current?.scrollToItem(Ae)},[Ae]),!Array.isArray(ce))return null;const Ue=ce.flatMap(Ze=>B(Ze)?[n.cloneElement(Ze,{children:null}),...Ze.props.children]:[Ze]),$e=((0,S.max)(We.map(Ze=>Ze.label?.length))??0)*L+N*2+F,ke=Math.min(Ue.length*R,me);return n.createElement(T.Y1,{outerRef:pe,ref:Ne,className:Oe.menu,height:ke,width:$e,"aria-label":"Select options menu",itemCount:Ue.length,itemSize:R},({index:Ze,style:ot})=>n.createElement("div",{style:{...ot,overflow:"hidden"}},Ue[Ze]))},B=ce=>n.isValidElement(ce)&&Array.isArray(ce.props.children);K.displayName="VirtualizedSelectMenu";const w=({children:ce,data:me,innerProps:pe,innerRef:ye,isFocused:Pe,isSelected:Ie,renderOptionLabel:Oe})=>{const Ne=(0,l.$j)(),We=(0,C.J)(Ne),Ae=me.icon?(0,M.Uo)(me.icon):void 0,{onMouseMove:Ue,onMouseOver:Me,...$e}=pe;return n.createElement("div",{ref:ye,className:(0,g.cx)(We.option,Pe&&We.optionFocused,Ie&&We.optionSelected,me.isDisabled&&We.optionDisabled),...$e,"data-testid":A.Tp.components.Select.option,title:me.title},Ae&&n.createElement(m.I,{name:Ae,className:We.optionIcon}),me.imgUrl&&n.createElement("img",{className:We.optionImage,src:me.imgUrl,alt:me.label||String(me.value)}),n.createElement("div",{className:We.optionBody},n.createElement("span",null,Oe?Oe(me):ce),me.description&&n.createElement("div",{className:We.optionDescription},me.description),me.component&&n.createElement(me.component,null)))};w.displayName="SelectMenuOptions";const U=({children:ce,cx:me,getClassNames:pe,getStyles:ye,Heading:Pe,headingProps:Ie,label:Oe,selectProps:Ne,theme:We})=>{const Ae=(0,l.of)(C.J);return n.createElement("div",{className:Ae.group},n.createElement(Pe,{cx:me,getClassNames:pe,getStyles:ye,selectProps:Ne,theme:We,...Ie},Oe),ce)};var W=e(94753);const V=ce=>{const me=(0,l.of)(C.J);return n.createElement("div",{className:me.groupHeader},n.createElement(W.E,{weight:"bold",variant:"bodySmall",color:"secondary"},ce.children??""))};var _=e(62235);class H extends n.Component{render(){const{children:me}=this.props,{selectProps:pe}=this.props;if(pe&&Array.isArray(me)&&Array.isArray(me[0])&&pe.maxVisibleValues!==void 0&&!(pe.showAllSelectedWhenOpen&&pe.menuIsOpen)){const[ye,...Pe]=me,Ie=ye.slice(0,pe.maxVisibleValues);return this.renderContainer([Ie,...Pe])}return this.renderContainer(me)}renderContainer(me){const{isMulti:pe,theme:ye,selectProps:Pe}=this.props,Ie=this.props.selectProps?.noMultiValueWrap&&!this.props.selectProps?.menuIsOpen,Oe=(0,C.J)(ye),Ne=Pe["data-testid"],We=(0,g.cx)(Oe.valueContainer,{[Oe.valueContainerMulti]:pe&&!Ie,[Oe.valueContainerMultiNoWrap]:pe&&Ie});return n.createElement("div",{"data-testid":Ne,className:We},me)}}const G=(0,l.cV)(H);var j=e(23731);const Y=(ce,me)=>{if(Array.isArray(ce)){const pe=ce.filter(Boolean);return pe?.length?pe:void 0}if(typeof ce=="object")return[ce];if(typeof ce=="string"||typeof ce=="number"){const pe=oe(ce,me);if(pe)return[pe]}},oe=(ce,me)=>{for(const pe of me)if("options"in pe){let ye=oe(ce,pe.options);if(ye)return ye}else if("value"in pe&&pe.value===ce)return pe;return null},se=ce=>ce.map(({description:me,...pe})=>pe),ne=ce=>{const{children:me,innerProps:pe,selectProps:{menuIsOpen:ye,onMenuClose:Pe,onMenuOpen:Ie},isFocused:Oe,isMulti:Ne,getValue:We,innerRef:Ae}=ce,Ue=ce.selectProps;return Ue.renderControl?n.createElement(Ue.renderControl,{isOpen:ye,value:Ne?We():We()[0],ref:Ae,onClick:ye?Pe:Ie,onBlur:Pe,disabled:!!Ue.disabled,invalid:!!Ue.invalid}):n.createElement(p,{ref:Ae,innerProps:pe,prefix:Ue.prefix,focused:Oe,invalid:!!Ue.invalid,disabled:!!Ue.disabled},me)};function ee({allowCustomValue:ce=!1,allowCreateWhileLoading:me=!1,"aria-label":pe,"data-testid":ye,autoFocus:Pe=!1,backspaceRemovesValue:Ie=!0,blurInputOnSelect:Oe,cacheOptions:Ne,className:We,closeMenuOnSelect:Ae=!0,components:Ue,createOptionPosition:Me="last",defaultOptions:$e,defaultValue:ke,disabled:Ze=!1,filterOption:ot,formatCreateLabel:xt,getOptionLabel:ct,getOptionValue:ft,inputValue:Le,invalid:re,isClearable:X=!1,id:le,isLoading:be=!1,isMulti:De=!1,inputId:Te,isOpen:we,isOptionDisabled:Ke,isSearchable:Ve=!0,loadOptions:ht,loadingMessage:gt="Loading options...",maxMenuHeight:bt=300,minMenuHeight:St,maxVisibleValues:Je,menuPlacement:rt="auto",menuPosition:Rt,menuShouldPortal:_t=!0,noOptionsMessage:nn=(0,a.t)("grafana-ui.select.no-options-label","No options found"),onBlur:Kt,onChange:en,onCloseMenu:Qt,onCreateOption:An,onInputChange:un,onKeyDown:fn,onMenuScrollToBottom:Tt,onMenuScrollToTop:$t,onOpenMenu:Yt,onFocus:Cn,openMenuOnFocus:Tn=!1,options:vn=[],placeholder:Kn=(0,a.t)("grafana-ui.select.placeholder","Choose"),prefix:Yn,renderControl:nt,showAllSelectedWhenOpen:yt=!0,tabSelectsValue:Vt=!0,value:je,virtualized:tt=!1,noMultiValueWrap:Dt,width:Ot,isValidNewOption:Lt,formatOptionLabel:Gt,hideSelectedOptions:hn,...mt}){const Bt=(0,l.$j)(),Jt=(0,C.J)(Bt),Rn=(0,n.useRef)(null),[Mt,wt]=(0,n.useState)(!1),Ht=(0,j.z)(Bt,Ot),[tn,It]=(0,n.useState)(!!Le);(0,n.useEffect)(()=>{if(ht&&we&&Rn.current&&Rn.current.controlRef&&rt==="auto"){const xa=window.innerHeight-Rn.current.controlRef.getBoundingClientRect().bottom;wt(xa<bt)}},[bt,rt,ht,we]);const Xe=(0,n.useCallback)((xa,ga)=>{if(De&&xa==null)return en([],ga);en(xa,ga)},[De,en]);let jn=o.Ay;const Qn={};let ia={},wn;if(De&&ht)wn=je;else if(De&&je&&Array.isArray(je)&&!ht)wn=je.map(xa=>{const ga=oe(xa.value??xa,vn);return ga||(typeof xa=="string"?(0,d.z)(xa):xa)});else if(ht){const xa=ke||je;wn=xa?[xa]:[]}else wn=Y(je,vn);const sa={"aria-label":pe,"data-testid":ye,autoFocus:Pe,backspaceRemovesValue:Ie,blurInputOnSelect:Oe,captureMenuScroll:Tt||$t,closeMenuOnSelect:Ae,defaultValue:ke,disabled:Ze,filterOption:tn?ot:null,getOptionLabel:ct,getOptionValue:ft,hideSelectedOptions:hn,inputValue:Le,invalid:re,isClearable:X,id:le,isDisabled:Ze,isLoading:be,isMulti:De,inputId:Te,isOptionDisabled:Ke,isSearchable:Ve,maxMenuHeight:bt,minMenuHeight:St,maxVisibleValues:Je,menuIsOpen:we,menuPlacement:rt==="auto"&&Mt?"top":rt,menuPosition:Rt,menuShouldBlockScroll:!0,menuPortalTarget:_t&&typeof document<"u"?document.body:void 0,menuShouldScrollIntoView:!1,onBlur:Kt,onChange:Xe,onInputChange:(xa,ga)=>{const Ts=un?.(xa,ga)??xa,Us=!!Ts;return Us!==tn&&It(Us),Ts},onKeyDown:fn,onMenuClose:Qt,onMenuOpen:Yt,onMenuScrollToBottom:Tt,onMenuScrollToTop:$t,onFocus:Cn,formatOptionLabel:Gt,openMenuOnFocus:Tn,options:tt?se(vn):vn,placeholder:Kn,prefix:Yn,renderControl:nt,showAllSelectedWhenOpen:yt,tabSelectsValue:Vt,value:De?wn:wn?.[0],noMultiValueWrap:Dt};ce&&(jn=f.A,Qn.allowCreateWhileLoading=me,Qn.formatCreateLabel=xt??Z,Qn.onCreateOption=An,Qn.createOptionPosition=Me,Qn.isValidNewOption=Lt),ht&&(jn=ce?i.A:r.A,ia={loadOptions:ht,cacheOptions:Ne,defaultOptions:$e});const La=tt?K:O;return n.createElement(n.Fragment,null,n.createElement(jn,{ref:Rn,components:{MenuList:La,Group:U,GroupHeading:V,ValueContainer:G,IndicatorsContainer:z,IndicatorSeparator:q,Control:ne,Option:w,ClearIndicator(xa){const{clearValue:ga}=xa;return n.createElement(m.I,{name:"times",role:"button","aria-label":"select-clear-value",className:Jt.singleValueRemove,onMouseDown:Ts=>{Ts.preventDefault(),Ts.stopPropagation(),ga()}})},LoadingIndicator(){return n.createElement(s.y,{inline:!0})},LoadingMessage(){return n.createElement("div",{className:Jt.loadingMessage},gt)},NoOptionsMessage(){return n.createElement("div",{className:Jt.loadingMessage,"aria-label":"No options provided"},nn)},DropdownIndicator:b,SingleValue(xa){return n.createElement(_.K,{...xa,isDisabled:Ze})},SelectContainer:E.K,MultiValueContainer:D.O,MultiValueRemove:Ze?()=>null:D.p,Input:u,...Ue},styles:Ht,className:We,...sa,...Qn,...ia,...mt}))}function Z(ce){return n.createElement("div",{style:{display:"flex",gap:"8px",alignItems:"center"}},n.createElement("div",null,ce),n.createElement("div",{style:{flexGrow:1}}),n.createElement("div",{className:"muted small",style:{display:"flex",gap:"8px",alignItems:"center"}},"Hit enter to add"))}function z(ce){const{showAllSelectedWhenOpen:me,maxVisibleValues:pe,menuIsOpen:ye}=ce.selectProps,Pe=ce.getValue();if(pe!==void 0&&Array.isArray(ce.children)){const Ie=Pe.length;if(Ie>pe&&!(me&&ye)){const Oe=[...ce.children];return Oe.splice(-1,0,n.createElement("span",{key:"excess-values",id:"excess-values"},"(+",Ie-pe,")")),n.createElement(c,{...ce},Oe)}}return n.createElement(c,{...ce})}function q(){return n.createElement(n.Fragment,null)}function ie(ce){return n.createElement(ee,{...ce})}function de(ce){return n.createElement(ee,{...ce,isMulti:!0})}function ue(ce){return n.createElement(ee,{...ce})}function fe(ce){return n.createElement(ee,{virtualized:!0,...ce})}function Se(ce){return n.createElement(ee,{virtualized:!0,...ce})}function he(ce){return n.createElement(ee,{...ce,isMulti:!0})}},4603:(Q,I,e)=>{"use strict";e.d(I,{K:()=>l});var n=e(32196),a=e(96540),o=e(28581),r=e(40845),i=e(16797),f=e(87266),d=e(10354);const l=s=>{const{isDisabled:h,isFocused:u,children:b,selectProps:{invalid:g=!1}}=s,P=(0,r.of)(m,u,h,g);return a.createElement(o.c.SelectContainer,{...s,className:(0,n.cx)(P.wrapper,s.className)},b)},m=(s,h,u,b)=>{const g=(0,d.n)({theme:s,invalid:b});return{wrapper:(0,n.cx)(g.wrapper,(0,f.Xb)(s,b),h&&(0,n.css)((0,i.getFocusStyles)(s)),u&&g.inputDisabled,(0,n.css)({position:"relative",boxSizing:"border-box",flexDirection:"row",flexWrap:"wrap",alignItems:"stretch",justifyContent:"space-between",minHeight:"32px",height:"auto",maxWidth:"100%",padding:0,cursor:u?"not-allowed":"pointer"}))}}},62235:(Q,I,e)=>{"use strict";e.d(I,{K:()=>u});var n=e(32196),a=e(96540),o=e(28581),r=e(8887),i=e(40845);function f(g,P={}){const{duration:c=250,delay:y=250}=P,[p,v]=(0,a.useState)(g),D=(0,a.useRef)();return(0,a.useEffect)(()=>{let E;if(g)E=setTimeout(()=>{D.current=new Date,v(g)},y);else{const S=D.current?Date.now()-D.current.valueOf():0,T=()=>{D.current=void 0,v(g)};S>=c?T():E=setTimeout(T,c-S)}return()=>{E&&(clearTimeout(E),E=void 0)}},[g,c,y]),p}var d=e(14578),l=e(62930),m=e(31511),s=e(72960);const h=g=>({singleValue:(0,n.css)({label:"singleValue",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxSizing:"border-box",maxWidth:"100%",gridArea:"1 / 1 / 2 / 3"}),spinnerWrapper:(0,n.css)({width:"16px",height:"16px",display:"inline-block",marginRight:"10px",position:"relative",verticalAlign:"middle",overflow:"hidden"}),spinnerIcon:(0,n.css)({width:"100%",height:"100%",position:"absolute"}),optionIcon:(0,n.css)({marginRight:g.spacing(1),color:g.colors.text.secondary}),disabled:(0,n.css)({color:g.colors.text.disabled}),isOpen:(0,n.css)({color:g.colors.text.disabled})}),u=g=>{const{children:P,data:c,isDisabled:y}=g,p=(0,i.of)(h),v=f(c.loading||!1,{delay:250,duration:750}),D=c.icon?(0,r.Uo)(c.icon):void 0;return a.createElement(o.c.SingleValue,{...g,className:(0,n.cx)(p.singleValue,y&&p.disabled,g.selectProps.menuIsOpen&&p.isOpen)},c.imgUrl?a.createElement(b,{loading:v,imgUrl:c.imgUrl,styles:p,alt:String(c.label??c.value)}):a.createElement(a.Fragment,null,a.createElement(s.n,{horizontal:!0,size:16,visible:v,duration:150},a.createElement("div",{className:p.spinnerWrapper},a.createElement(l.y,{className:p.spinnerIcon,inline:!0}))),D&&a.createElement(d.I,{name:D,role:"img",className:p.optionIcon})),!c.hideText&&P)},b=g=>a.createElement("div",{className:g.styles.spinnerWrapper},a.createElement(m.A,{duration:150,visible:g.loading},a.createElement(l.y,{className:g.styles.spinnerIcon,inline:!0})),a.createElement(m.A,{duration:150,visible:!g.loading},a.createElement("img",{className:g.styles.spinnerIcon,src:g.imgUrl,alt:g.alt})))},88824:(Q,I,e)=>{"use strict";e.d(I,{J:()=>o});var n=e(32196),a=e(3911);const o=(0,a.N)(r=>({menu:(0,n.css)({label:"grafana-select-menu",background:r.components.dropdown.background,boxShadow:r.shadows.z3,position:"relative",minWidth:"100%",zIndex:1}),option:(0,n.css)({label:"grafana-select-option",padding:"8px",display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer",borderLeft:"2px solid transparent","&:hover":{background:r.colors.action.hover,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${r.colors.primary.border}`}}}),optionIcon:(0,n.css)({marginRight:r.spacing(1)}),optionImage:(0,n.css)({label:"grafana-select-option-image",width:"16px",marginRight:"10px"}),optionDescription:(0,n.css)({label:"grafana-select-option-description",fontWeight:"normal",fontSize:r.typography.size.sm,color:r.colors.text.secondary,whiteSpace:"normal",lineHeight:r.typography.body.lineHeight}),optionBody:(0,n.css)({label:"grafana-select-option-body",display:"flex",fontWeight:r.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),optionFocused:(0,n.css)({label:"grafana-select-option-focused",background:r.colors.action.focus,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${r.colors.primary.border}`}}),optionSelected:(0,n.css)({background:r.colors.action.selected}),optionDisabled:(0,n.css)({label:"grafana-select-option-disabled",backgroundColor:r.colors.action.disabledBackground,color:r.colors.action.disabledText,cursor:"not-allowed"}),singleValue:(0,n.css)({label:"grafana-select-single-value",color:r.components.input.text,gridArea:"1 / 1 / 2 / 3",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxSizing:"border-box",maxWidth:"100%"}),valueContainer:(0,n.css)({label:"grafana-select-value-container",alignItems:"center",display:"grid",position:"relative",boxSizing:"border-box",flex:"1 1 0%",outline:"none",overflow:"hidden"}),valueContainerMulti:(0,n.css)({label:"grafana-select-value-container-multi",flexWrap:"wrap",display:"flex"}),valueContainerMultiNoWrap:(0,n.css)({display:"grid",gridAutoFlow:"column"}),loadingMessage:(0,n.css)({label:"grafana-select-loading-message",padding:r.spacing(1),textAlign:"center",width:"100%"}),multiValueContainer:(0,n.css)({label:"grafana-select-multi-value-container",display:"flex",alignItems:"center",lineHeight:1,background:r.colors.background.secondary,borderRadius:r.shape.radius.default,margin:r.spacing(.25,1,.25,0),padding:r.spacing(.25,0,.25,1),color:r.colors.text.primary,fontSize:r.typography.size.sm,overflow:"hidden",whiteSpace:"nowrap","&:hover":{background:r.colors.emphasize(r.colors.background.secondary)}}),multiValueRemove:(0,n.css)({label:"grafana-select-multi-value-remove",margin:r.spacing(0,.5),cursor:"pointer",svg:{marginBottom:0}}),singleValueRemove:(0,n.css)({cursor:"pointer","&:hover":{color:r.colors.text.primary}}),groupHeader:(0,n.css)({padding:r.spacing(1,1,1,.75),borderLeft:"2px solid transparent"}),group:(0,n.css)({"&:not(:first-child)":{borderTop:`1px solid ${r.colors.border.weak}`},':has(+ [role="option"])':{borderBottom:`1px solid ${r.colors.border.weak}`}})}))},23731:(Q,I,e)=>{"use strict";e.d(I,{A:()=>a,z:()=>o});var n=e(96540);function a(r){return{clearIndicator:()=>({}),container:()=>({}),control:()=>({}),dropdownIndicator:()=>({}),group:()=>({}),groupHeading:()=>({}),indicatorsContainer:()=>({}),indicatorSeparator:()=>({}),input:function(i){return{...i,color:"inherit",margin:0,padding:0,zIndex:1,overflow:"hidden"}},loadingIndicator:()=>({}),loadingMessage:()=>({}),menu:()=>({}),menuList:({maxHeight:i})=>({maxHeight:i}),multiValue:()=>({}),multiValueLabel:()=>({overflow:"hidden",textOverflow:"ellipsis"}),multiValueRemove:()=>({}),noOptionsMessage:()=>({}),option:()=>({}),placeholder:i=>({...i,color:r.colors.text.secondary}),singleValue:()=>({}),valueContainer:()=>({})}}function o(r,i){return(0,n.useMemo)(()=>({...a(r),menuPortal:f=>({...f,zIndex:r.zIndex.portal}),menu:({top:f,bottom:d,position:l})=>({top:f,bottom:d,position:l,minWidth:"100%",zIndex:r.zIndex.dropdown}),container:()=>({width:i?r.spacing(i):"100%",display:i==="auto"?"inline-flex":"flex"}),option:(f,d)=>({...f,opacity:d.isDisabled?.5:1})}),[r,i])}},62883:()=>{"use strict"},67570:(Q,I,e)=>{"use strict";e.d(I,{u:()=>b});var n=e(2543),a=e.n(n),o=e(96540),r=e(13752),i=e(62467),f=e(11150),d=e(96083),l=e(63720),m=e(59099),s=e(54479),h=e(11134);function u(g){return{label:g,value:stringToMs(g)}}class b extends o.PureComponent{constructor(P){super(P),this.propsSubject=new r.B,this.subscription=null}componentDidMount(){this.subscription=this.propsSubject.pipe((0,l.n)(P=>h.cC.isLive(P.interval)?(0,i.of)({}):P.loading?f.t:(0,d.Y)((0,s.dc)(P.interval))),(0,m.M)(()=>this.props.func())).subscribe(),this.propsSubject.next(this.props)}componentDidUpdate(P){h.cC.isLive(P.interval)&&h.cC.isLive(this.props.interval)||(0,n.isEqual)(P,this.props)||this.propsSubject.next(this.props)}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe(),this.propsSubject.unsubscribe()}render(){return null}}},63250:(Q,I,e)=>{"use strict";e.d(I,{I1:()=>y,_$:()=>b,gl:()=>h});var n=e(2543),a=e.n(n),o=e(75059),r=e(47070),i=e(50082),f=e(62398),d=e(24293),l=e(90708),m=e(47737);const s=["reduceOptions","orientation"];function h(p,v,D){let E=p.options;if(p.fieldConfig=p.fieldConfig||{defaults:{},overrides:[]},v==="singlestat"&&D.angular)return u(p,D);for(const S of s)D.hasOwnProperty(S)&&(E[S]=(0,n.cloneDeep)(D[S]));return E}function u(p,v){const D=v.angular,E=o.AS.getIfExists(D.valueName),S={reduceOptions:{calcs:[E?E.id:o.gy.mean]},orientation:r.wV.Horizontal},T={};if(D.format&&(T.unit=D.format),D.tableColumn&&(S.reduceOptions.fields=`/^${D.tableColumn}$/`),D.nullPointMode&&(T.nullValueMode=D.nullPointMode),D.nullText&&(T.noValue=D.nullText),(D.decimals||D.decimals===0)&&(T.decimals=D.decimals),D.thresholds&&D.colors){const A=D.thresholds.split(",").map(C=>Number(C.trim())),x=[];for(const C of D.colors){const O=x.length-1;O>=0?x.push({value:A[O],color:C}):x.push({value:-1/0,color:C})}T.thresholds={mode:i.O.Absolute,steps:x}}const M=(0,f.bh)(D,T.thresholds);return M&&M.length&&(T.mappings=M),D.gauge&&D.gauge.show&&(T.min=D.gauge.minValue,T.max=D.gauge.maxValue),p.fieldConfig.defaults=T,S}function b(p){if(!p.options)return{};const v=parseFloat(p.pluginVersion||"6.1");let D=p.options;v<6.2&&(D=P(D)),v<6.3&&(D=g(D));const{fieldOptions:E}=D;if(v<6.6&&E){if(E&&E.override){const{override:M,...A}=D.fieldOptions;D={...D,fieldOptions:{...A,overrides:[]}}}let S=E?.defaults?.thresholds;S?delete E.defaults.thresholds:(S=E?.thresholds,delete E.thresholds),S&&(E.defaults.thresholds={mode:i.O.Absolute,steps:S});const{defaults:T}=E;T.color&&typeof T.color=="string"&&(T.color={mode:d.Y.Fixed,fixedColor:T.color}),(0,l.BF)(T)}if(v<7&&(p.fieldConfig=p.fieldConfig||{defaults:{},overrides:[]},p.fieldConfig={defaults:E&&E.defaults?{...p.fieldConfig.defaults,...E.defaults}:p.fieldConfig.defaults,overrides:E&&E.overrides?[...p.fieldConfig.overrides,...E.overrides]:p.fieldConfig.overrides},E&&(D.reduceOptions={values:E.values,limit:E.limit,calcs:E.calcs}),delete D.fieldOptions),v<7.1){const S=p.fieldConfig.defaults.title;S!=null&&(p.fieldConfig.defaults.displayName=S,delete p.fieldConfig.defaults.title)}if(v<8){const S=p.fieldConfig?.defaults;let T=S?.unit;T==="percent"?((0,n.isNumber)(S.min)||(S.min=0),(0,n.isNumber)(S.max)||(S.max=100)):T==="percentunit"&&((0,n.isNumber)(S.min)||(S.min=0),(0,n.isNumber)(S.max)||(S.max=1))}return D}function g(p){const{fieldOptions:v}=p;if(!v)return p;const{mappings:D,...E}=p.fieldOptions;let S;return p.thresholds&&(S={mode:i.O.Absolute,steps:c(p.thresholds)}),{...p,fieldOptions:{...E,defaults:{...v.defaults,mappings:D,thresholds:S}}}}function P(p){const{valueOptions:v}=p;if(!v)return p;const D={},E={};if(D.mappings=p.valueMappings,D.thresholds=p.thresholds,D.defaults=E,E.unit=v.unit,E.decimals=v.decimals,v.stat){const T=o.AS.get(v.stat);T&&(D.calcs=[T.id])}E.min=p.minValue,E.max=p.maxValue;const S={...p,fieldOptions:D};return(0,n.omit)(S,"valueMappings","thresholds","valueOptions","minValue","maxValue")}function c(p){if(!p||!p.length)return;const v=p.map(D=>({value:D.value===null?-1/0:D.value,color:D.color}));return(0,m.RU)(v),v[0].value=-1/0,v}function y(p){return(0,f.bh)(p)}},37713:(Q,I,e)=>{"use strict";e.d(I,{I1:()=>n.I1,_$:()=>n._$,gl:()=>n.gl});var n=e(63250)},47097:(Q,I,e)=>{"use strict";e.d(I,{F:()=>h});var n=e(32196),a=e(94659),o=e(9821),r=e(96540),i=e(40845),f=e(80427);const d=u=>{const{value:b,children:g,visible:P,placement:c,tipFormatter:y,...p}=u,v=(0,r.useRef)(null),D=(0,r.useRef)(null),E=(0,i.of)(l);function S(){D.current!==null&&cancelAnimationFrame(D.current)}function T(){D.current=requestAnimationFrame(()=>{v.current?.forceAlign()})}return(0,r.useEffect)(()=>(P?T():S(),S),[b,P]),r.createElement(f.A,{overlayClassName:E.tooltip,placement:c,overlay:y??b,overlayInnerStyle:{minHeight:"auto"},ref:v,visible:P,...p},g)},l=u=>({tooltip:(0,n.css)({position:"absolute",display:"block",visibility:"visible",fontSize:u.typography.bodySmall.fontSize,opacity:.9,padding:3,zIndex:u.zIndex.tooltip})}),m=d;var s=e(24849);const h=({min:u,max:b,onChange:g,onAfterChange:P,orientation:c="horizontal",reverse:y,step:p,formatTooltipResult:v,value:D,tooltipAlwaysVisible:E=!0})=>{const S=(0,r.useCallback)(C=>{g?.(typeof C=="number"?[C,C]:C)},[g]),T=(0,r.useCallback)(C=>{P?.(typeof C=="number"?[C,C]:C)},[P]),M=c==="horizontal",A=(0,i.of)(s.$,M),x=(C,O)=>r.createElement(m,{value:O.value,visible:E||O.dragging,tipFormatter:v?()=>v(O.value):void 0,placement:M?"top":"right"},C);return r.createElement("div",{className:(0,n.cx)(A.container,A.slider)},r.createElement(a.Global,{styles:A.tooltip}),r.createElement(o.A,{min:u,max:b,step:p,defaultValue:D,range:!0,onChange:S,onChangeComplete:T,vertical:!M,reverse:y,handleRender:x}))};h.displayName="RangeSlider"},77014:(Q,I,e)=>{"use strict";e.d(I,{A:()=>l});var n=e(32196),a=e(94659),o=e(9821),r=e(96540),i=e(40845),f=e(10354),d=e(24849);const l=({min:m,max:s,onChange:h,onAfterChange:u,orientation:b="horizontal",reverse:g,step:P,value:c,ariaLabelForHandle:y,marks:p,included:v})=>{const D=b==="horizontal",E=(0,i.of)(d.$,D,!!p),S=o.A,[T,M]=(0,r.useState)(c??m),A=(0,r.useCallback)(N=>{const F=typeof N=="number"?N:N[0];M(F),h?.(F)},[M,h]),x=(0,r.useCallback)(N=>{let F=+N.target.value;Number.isNaN(F)&&(F=0),M(F),h&&h(F),u&&u(F)},[h,u]),C=(0,r.useCallback)(N=>{const F=+N.target.value;F>s?M(s):F<m&&M(m)},[s,m]),O=(0,r.useCallback)(N=>{const F=typeof N=="number"?N:N[0];u?.(F)},[u]),R=D?[]:[E.sliderInputVertical],L=D?[]:[E.sliderInputFieldVertical];return r.createElement("div",{className:(0,n.cx)(E.container,E.slider)},r.createElement(a.Global,{styles:E.tooltip}),r.createElement("div",{className:(0,n.cx)(E.sliderInput,...R)},r.createElement(S,{min:m,max:s,step:P,defaultValue:c,value:T,onChange:A,onChangeComplete:O,vertical:!D,reverse:g,ariaLabelForHandle:y,marks:p,included:v}),r.createElement(f.p,{type:"text",className:(0,n.cx)(E.sliderInputField,...L),value:T,onChange:x,onBlur:C,min:m,max:s})))};l.displayName="Slider"},24849:(Q,I,e)=>{"use strict";e.d(I,{$:()=>r});var n=e(32196),a=e(94659),o=e(12415);const r=(i,f,d=!1)=>{const{spacing:l}=i,m=i.colors.border.strong,s=i.colors.primary.main,h=i.colors.primary.main,b=`box-shadow: 0px 0px 0px 6px ${i.colors.primary.transparent}`;return{container:(0,n.css)({width:"100%",margin:f?"inherit":l(1,3,1,1),paddingBottom:f&&d?i.spacing(1):"inherit",height:f?"auto":"100%"}),slider:(0,n.css)`
      .rc-slider {
        display: flex;
        flex-grow: 1;
        margin-left: 7px; // half the size of the handle to align handle to the left on 0 value
      }
      .rc-slider-mark {
        top: ${i.spacing(1.75)};
      }
      .rc-slider-mark-text {
        color: ${i.colors.text.disabled};
        font-size: ${i.typography.bodySmall.fontSize};
      }
      .rc-slider-mark-text-active {
        color: ${i.colors.text.primary};
      }
      .rc-slider-handle {
        border: none;
        background-color: ${h};
        box-shadow: ${i.shadows.z1};
        cursor: pointer;
        opacity: 1;
      }

      .rc-slider-handle:hover,
      .rc-slider-handle:active,
      .rc-slider-handle-click-focused:focus {
        ${b};
      }

      // The triple class names is needed because that's the specificity used in the source css :(
      .rc-slider-handle-dragging.rc-slider-handle-dragging.rc-slider-handle-dragging,
      .rc-slider-handle:focus-visible {
        box-shadow: 0 0 0 5px ${i.colors.text.primary};
      }

      .rc-slider-dot,
      .rc-slider-dot-active {
        background-color: ${i.colors.text.primary};
        border-color: ${i.colors.text.primary};
      }

      .rc-slider-track {
        background-color: ${s};
      }
      .rc-slider-rail {
        background-color: ${m};
        cursor: pointer;
      }
    `,tooltip:(0,a.css)`
      body {
        .rc-slider-tooltip {
          cursor: grab;
          user-select: none;
          z-index: ${i.zIndex.tooltip};
        }

        .rc-slider-tooltip-inner {
          color: ${i.colors.text.primary};
          background-color: transparent !important;
          border-radius: 0;
          box-shadow: none;
        }

        .rc-slider-tooltip-placement-top .rc-slider-tooltip-arrow {
          display: none;
        }

        .rc-slider-tooltip-placement-top {
          padding: 0;
        }
      }
    `,sliderInput:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",width:"100%"}),sliderInputVertical:(0,n.css)({flexDirection:"column",height:"100%",".rc-slider":{margin:0,order:2}}),sliderInputField:(0,n.css)({marginLeft:i.spacing(3),width:"60px",input:{textAlign:"center"}}),sliderInputFieldVertical:(0,n.css)({margin:`0 0 ${i.spacing(3)} 0`,order:1})}}},5926:(Q,I,e)=>{"use strict";e.d(I,{O:()=>c});var n=e(2543),a=e(96540),o=e(39624),r=e(21423),i=e(11261),f=e(8066),d=e(52622),l=e(81297),m=e(51336),s=e(16895),h=e(73060),u=e(14236),b=e(46294);function g(y,p){const v=y.y.values.length,D={...y.y.config,...p},E=y.x??{name:"",values:[...Array(v).keys()],type:i.PU.number,config:{}};let S={refId:"sparkline",fields:[E,{...y.y,config:D}],length:v};return(0,h.g2)(E.values)||(S=(0,u.ES)(S,0)),(0,b.M)({frame:S,refFieldPseudoMin:y.timeRange?.from.valueOf(),refFieldPseudoMax:y.timeRange?.to.valueOf()})}const P={drawStyle:d.GR.Line,showPoints:d.yL.Auto,axisPlacement:d.vM.Hidden,pointSize:2};class c extends a.PureComponent{constructor(p){super(p);const v=g(p.sparkline,p.config);this.state={data:(0,s.bq)(v,(0,s.ro)(v)),alignedDataFrame:v,configBuilder:this.prepareConfig(v)}}static getDerivedStateFromProps(p,v){const D=g(p.sparkline,p.config),E=(0,o.C)(D);return E?{...v,data:(0,s.bq)(E,(0,s.ro)(E)),alignedDataFrame:E}:{...v}}componentDidUpdate(p,v){const{alignedDataFrame:D}=this.state;if(!D)return;let E=!1;if(p.sparkline!==this.props.sparkline){const S=!(0,r.bW)(this.state.alignedDataFrame,v.alignedDataFrame),T=!(0,n.isEqual)(D.fields[1].state?.range,v.alignedDataFrame.fields[1].state?.range);E=S||T}else E=!(0,n.isEqual)(p.config,this.props.config);E&&this.setState({configBuilder:this.prepareConfig(D)})}getYRange(p){let{min:v,max:D}=this.state.alignedDataFrame.fields[1].state?.range;const E=+this.state.alignedDataFrame.fields[1].config?.noValue;return Number.isNaN(E)||(v=Math.min(v,+E),D=Math.max(D,+E)),v===D?(v===0?D=100:(v=0,D*=2),[v,D]):[Math.max(v,p.config.min??-1/0),Math.min(D,p.config.max??1/0)]}prepareConfig(p){const{theme:v}=this.props,D=new m.e;D.setCursor({show:!1,x:!1,y:!1});const E=p.fields[0];D.addScale({scaleKey:"x",orientation:d.Lt.Horizontal,direction:d.ON.Right,isTime:!1,range:()=>{const{sparkline:S}=this.props;if(S.x){if(S.timeRange&&S.x.type===i.PU.time)return[S.timeRange.from.valueOf(),S.timeRange.to.valueOf()];const T=S.x.values;return[T[0],T[T.length-1]]}return[0,S.y.values.length-1]}}),D.addAxis({scaleKey:"x",theme:v,placement:d.vM.Hidden});for(let S=0;S<p.fields.length;S++){const T=p.fields[S],M=T.config,A={...P,...M.custom};if(T===E||T.type!==i.PU.number)continue;const x=M.unit||"__fixed";D.addScale({scaleKey:x,orientation:d.Lt.Vertical,direction:d.ON.Up,range:()=>this.getYRange(T)}),D.addAxis({scaleKey:x,theme:v,placement:d.vM.Hidden});const C=(0,f.Qi)(T),O=C.getCalculator(T,v)(0,0),R=A.drawStyle===d.GR.Points?d.yL.Always:A.showPoints;D.addSeries({pxAlign:!1,scaleKey:x,theme:v,colorMode:C,thresholds:M.thresholds,drawStyle:A.drawStyle,lineColor:A.lineColor??O,lineWidth:A.lineWidth,lineInterpolation:A.lineInterpolation,showPoints:R,pointSize:A.pointSize,fillOpacity:A.fillOpacity,fillColor:A.fillColor,lineStyle:A.lineStyle,gradientMode:A.gradientMode})}return D}render(){const{data:p,configBuilder:v}=this.state,{width:D,height:E}=this.props;return a.createElement(l.Z,{data:p,config:v,width:D,height:E})}}},62930:(Q,I,e)=>{"use strict";e.d(I,{y:()=>m});var n=e(32196),a=e(96540),o=e(8867),r=e(40845),i=e(4025),f=e(76412),d=e(14578),l=e(78318);const m=({className:u,inline:b=!1,iconClassName:g,style:P,size:c="md"})=>{const y=(0,r.of)(s),p=(0,r.of)(h,c),v=window.matchMedia("(prefers-reduced-motion: reduce)").matches,D=v?"hourglass":"spinner";if(typeof c!="string"||!(0,i.rJ)(c)){const E=(0,l.Wj)(),S="spinner",T=(0,l.Xi)(S,"default"),M=`${E}${T}/${S}.svg`;return a.createElement("div",{"data-testid":"Spinner",style:P,className:(0,n.cx)({[y.inline]:b},p.wrapper,u)},a.createElement(o.default,{src:M,width:c,height:c,className:(0,n.cx)("fa-spin",p.icon,u),style:P}))}return a.createElement("div",{"data-testid":"Spinner",style:P,className:(0,n.cx)({[y.inline]:b},u)},a.createElement(d.I,{className:(0,n.cx)({"fa-spin":!v},g),name:D,size:c,"aria-label":(0,f.t)("grafana-ui.spinner.aria-label","Loading")}))},s=u=>({inline:(0,n.css)({display:"inline-block"})}),h=(u,b)=>({wrapper:(0,n.css)({fontSize:typeof b=="string"?b:`${b}px`}),icon:(0,n.css)({display:"inline-block",fill:"currentColor",flexShrink:0,label:"Icon",lineHeight:0,verticalAlign:"middle"})})},21633:(Q,I,e)=>{"use strict";e.d(I,{h:()=>h});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(40845),f=e(69144);const d=.3,l=new Set(["ArrowUp","ArrowDown"]),m=new Set(["ArrowLeft","ArrowRight"]),s={row:{dim:"width",axis:"clientX",min:"minWidth",max:"maxWidth"},column:{dim:"height",axis:"clientY",min:"minHeight",max:"maxHeight"}};function h(c){const{direction:y,initialSize:p=.5,dragPosition:v="middle",onResizing:D,onSizeChanged:E}=c,S=16,T=(0,r.useRef)(null),M=(0,r.useRef)(null),A=(0,r.useRef)(null),x=(0,r.useRef)(null),C=(0,r.useRef)(null),O=(0,r.useRef)("1fr"),R=(0,r.useRef)(void 0),L=(0,r.useRef)(void 0),N=s[y].dim,F=s[y].axis,K=s[y].min,B=s[y].max;g(x.current,q=>{for(const ie of q){if(!ie.target.isSameNode(x.current)||!M.current)return;const de=M.current.getBoundingClientRect()[N],ue=b(M.current);T.current.ariaValueNow=u(de,ue[K],ue[B])}},500,[B,K,y,N]);const w=(0,r.useRef)(null),U=(0,r.useCallback)(q=>{M.current&&(O.current=M.current.getBoundingClientRect()[N],C.current=x.current.getBoundingClientRect()[N],w.current=q[F],T.current.setPointerCapture(q.pointerId),R.current=b(M.current),L.current=void 0)},[N,F]),W=(0,r.useCallback)(q=>{if(w.current!==null&&O.current!=="1fr"){const ie=q[F]-w.current,de=R.current,ue=(0,a.clamp)(O.current+ie,de[K],de[B]),fe=ue/(C.current-S);M.current.style.flexGrow=`${fe}`,A.current.style.flexGrow=`${1-fe}`,T.current.ariaValueNow=u(ue,de[K],de[B]),D?.(fe,ue)}},[S,F,K,B,D]),V=(0,r.useCallback)(q=>{q.preventDefault(),q.stopPropagation(),T.current.releasePointerCapture(q.pointerId),w.current=null,typeof O.current=="number"&&E?.(parseFloat(M.current.style.flexGrow),O.current)},[E]),_=(0,r.useRef)(new Set),H=(0,r.useRef)(null),G=(0,r.useCallback)(q=>{if(_.current.size===0){H.current=null;return}else if(O.current==="1fr")return;const ue=(q-(H.current??q))*d;let fe=0;y==="row"?(_.current.has("ArrowLeft")&&(fe-=ue),_.current.has("ArrowRight")&&(fe+=ue)):(_.current.has("ArrowUp")&&(fe-=ue),_.current.has("ArrowDown")&&(fe+=ue));const Se=R.current,he=M.current.getBoundingClientRect()[N],ce=(0,a.clamp)(he+fe,Se[K],Se[B]),me=ce/(C.current-S);M.current.style.flexGrow=`${me}`,A.current.style.flexGrow=`${1-me}`,T.current.ariaValueNow=u(ce,Se[K],Se[B]),D?.(me,ce),H.current=q,window.requestAnimationFrame(G)},[y,S,K,B,N,D]),j=(0,r.useCallback)(q=>{if(!M.current||!A.current||!T.current||!x.current)return;if(q.key==="Enter"){L.current===void 0?(L.current=M.current.style.flexGrow,M.current.style.flexGrow="0",A.current.style.flexGrow="1"):(M.current.style.flexGrow=L.current,A.current.style.flexGrow=`${1-parseFloat(L.current)}`,L.current=void 0);return}else if(q.key==="Home"){R.current=b(M.current),C.current=x.current.getBoundingClientRect()[N];const de=R.current[K]/(C.current-S);M.current.style.flexGrow=`${de}`,A.current.style.flexGrow=`${1-de}`,T.current.ariaValueNow="0";return}else if(q.key==="End"){R.current=b(M.current),C.current=x.current.getBoundingClientRect()[N];const de=R.current[B]/(C.current-S);M.current.style.flexGrow=`${de}`,A.current.style.flexGrow=`${1-de}`,T.current.ariaValueNow="100";return}if(!(y==="column"&&l.has(q.key)||y==="row"&&m.has(q.key))||_.current.has(q.key))return;if(L.current=void 0,q.preventDefault(),q.stopPropagation(),O.current=M.current.getBoundingClientRect()[N],C.current=x.current.getBoundingClientRect()[N],R.current=b(M.current),!_.current.has(q.key)){const de=_.current.size===0;_.current.add(q.key),de&&window.requestAnimationFrame(G)}},[y,G,S,B,N,K]),Y=(0,r.useCallback)(q=>{y==="row"&&!m.has(q.key)||y==="column"&&!l.has(q.key)||(_.current.delete(q.key),typeof O.current=="number"&&E?.(parseFloat(M.current.style.flexGrow),O.current))},[y,E]),oe=(0,r.useCallback)(()=>{if(!M.current||!A.current)return;M.current.style.flexGrow="0.5",A.current.style.flexGrow="0.5";const q=b(M.current);R.current=q,O.current=M.current.getBoundingClientRect()[N],T.current.ariaValueNow=`${u(O.current,q[K],q[B])}`},[B,N,K]),se=(0,r.useCallback)(()=>{_.current.size>0&&(_.current.clear(),w.current=null,typeof O.current=="number"&&E?.(parseFloat(M.current.style.flexGrow),O.current))},[E]),ne=(0,i.of)(P,y),ee=(0,i.of)(f.l,v),Z=y==="column"?ee.dragHandleHorizontal:ee.dragHandleVertical,z=(0,r.useId)();return{containerProps:{ref:x,className:ne.container},primaryProps:{ref:M,className:ne.panel,style:{[K]:"min-content",flexGrow:(0,a.clamp)(p??.5,0,1)}},secondaryProps:{ref:A,className:ne.panel,style:{flexGrow:(0,a.clamp)(1-p,0,1),[K]:"min-content"}},splitterProps:{onPointerUp:V,onPointerDown:U,onPointerMove:W,onKeyDown:j,onKeyUp:Y,onDoubleClick:oe,onBlur:se,ref:T,style:{[N]:`${S}px`},role:"separator","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":p*100,"aria-controls":`start-panel-${z}`,"aria-label":"Pane resize widget",tabIndex:0,className:Z}}}function u(c,y,p){return`${(0,a.clamp)((c-y)/(p-y)*100,0,100)}`}function b(c){const y=document.body.style.overflow,p=c.style.width,v=c.style.height,D=c.style.flexGrow;document.body.style.overflow="hidden",c.style.flexGrow="0";const{width:E,height:S}=c.getBoundingClientRect();c.style.flexGrow="100";const{width:T,height:M}=c.getBoundingClientRect();return document.body.style.overflow=y,c.style.width=p,c.style.height=v,c.style.flexGrow=D,{minWidth:E,maxWidth:T,minHeight:S,maxHeight:M}}function g(c,y,p=0,v){const D=(0,a.throttle)(y,p);(0,r.useLayoutEffect)(()=>{if(!c)return;const E=new ResizeObserver(D);return E.observe(c,{box:"device-pixel-content-box"}),()=>E.disconnect()},v)}function P(c,y){return{container:(0,n.css)({display:"flex",flexDirection:y==="row"?"row":"column",width:"100%",flexGrow:1,overflow:"hidden"}),panel:(0,n.css)({display:"flex",position:"relative",flexBasis:0})}}},42734:(Q,I,e)=>{"use strict";e.d(I,{S:()=>f});var n=e(2543),a=e.n(n),o=e(96540),r=e(75059),i=e(21594);class f extends o.PureComponent{constructor(){super(...arguments),this.checkInput=()=>{const{stats:l,allowMultiple:m,defaultStat:s,onChange:h}=this.props,u=r.AS.list(l);if(u.length!==l.length){const b=u.map(P=>P.id),g=(0,n.difference)(l,b);console.warn("Unknown stats",g,l),h(u.map(P=>P.id))}!m&&l.length>1&&(console.warn("Removing extra stat",l),h([l[0]])),s&&l.length<1&&h([s])},this.onSelectionChange=l=>{const{onChange:m}=this.props;Array.isArray(l)?m(l.map(s=>s.value)):m(l&&l.value?[l.value]:[])}}static{this.defaultProps={allowMultiple:!1}}componentDidMount(){this.checkInput()}componentDidUpdate(l){this.checkInput()}render(){const{stats:l,allowMultiple:m,defaultStat:s,placeholder:h,className:u,menuPlacement:b,width:g,inputId:P,filterOptions:c}=this.props,y=r.AS.selectOptions(l,c);return o.createElement(i.l6,{value:y.current,className:u,isClearable:!s,isMulti:m,width:g,isSearchable:!0,options:y.options,placeholder:h,onChange:this.onSelectionChange,menuPlacement:b,inputId:P})}}},15292:(Q,I,e)=>{"use strict";e.d(I,{K:()=>s,d:()=>m});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(95344),f=e(40845),d=e(16797),l=e(14578);const m=r.forwardRef(({value:u,checked:b,onChange:g,id:P,label:c,disabled:y,invalid:p=!1,...v},D)=>{b&&(0,i.l)("Switch","checked prop","value");const E=(0,f.of)(h),S=(0,r.useRef)(P||(0,a.uniqueId)("switch-"));return r.createElement("div",{className:(0,n.cx)(E.switch,p&&E.invalid)},r.createElement("input",{type:"checkbox",disabled:y,checked:u,onChange:T=>{!y&&g?.(T)},id:S.current,...v,ref:D}),r.createElement("label",{htmlFor:S.current,"aria-label":c??"Toggle switch"},r.createElement(l.I,{name:"check",size:"xs"})))});m.displayName="Switch";const s=r.forwardRef(({transparent:u,className:b,showLabel:g,label:P,value:c,id:y,invalid:p,...v},D)=>{const E=(0,f.of)(h,u);return r.createElement("div",{className:(0,n.cx)(E.inlineContainer,b,v.disabled&&E.disabled,p&&E.invalid)},g&&r.createElement("label",{htmlFor:y,className:(0,n.cx)(E.inlineLabel,c&&E.inlineLabelEnabled,"inline-switch-label")},P),r.createElement(m,{...v,id:y,label:P,ref:D,value:c}))});s.displayName="Switch";const h=(u,b)=>({switch:(0,n.css)({width:"32px",height:"16px",position:"relative",lineHeight:1,input:{opacity:0,left:"-100vw",zIndex:-1e3,position:"absolute","&:checked + label":{background:u.colors.primary.main,borderColor:u.colors.primary.main,"&:hover":{background:u.colors.primary.shade},svg:{transform:"translate3d(17px, -50%, 0)",background:u.colors.primary.contrastText,color:u.colors.primary.main}},"&:disabled + label":{background:u.colors.action.disabledBackground,borderColor:u.colors.border.weak,cursor:"not-allowed",svg:{background:u.colors.text.disabled}},"&:disabled:checked + label":{background:u.colors.primary.transparent,svg:{color:u.colors.primary.contrastText}},"&:focus + label, &:focus-visible + label":(0,d.getFocusStyles)(u),"&:focus:not(:focus-visible) + label":(0,d.getMouseFocusStyles)(u)},label:{width:"100%",height:"100%",cursor:"pointer",borderRadius:u.shape.radius.pill,background:u.components.input.background,border:`1px solid ${u.components.input.borderColor}`,transition:"all 0.3s ease","&:hover":{borderColor:u.components.input.borderHover},svg:{position:"absolute",display:"block",color:"transparent",width:"12px",height:"12px",borderRadius:u.shape.radius.circle,background:u.colors.text.secondary,boxShadow:u.shadows.z1,top:"50%",transform:"translate3d(1px, -50%, 0)",transition:"transform 0.2s cubic-bezier(0.19, 1, 0.22, 1)","@media (forced-colors: active)":{border:`1px solid ${u.colors.primary.contrastText}`}}}}),inlineContainer:(0,n.css)({padding:u.spacing(0,1),height:u.spacing(u.components.height.md),display:"inline-flex",alignItems:"center",background:b?"transparent":u.components.input.background,border:`1px solid ${b?"transparent":u.components.input.borderColor}`,borderRadius:u.shape.radius.default,"&:hover":{border:`1px solid ${b?"transparent":u.components.input.borderHover}`,".inline-switch-label":{color:u.colors.text.primary}}}),disabled:(0,n.css)({backgroundColor:"rgba(204, 204, 220, 0.04)",color:"rgba(204, 204, 220, 0.6)",border:"1px solid rgba(204, 204, 220, 0.04)"}),inlineLabel:(0,n.css)({cursor:"pointer",paddingRight:u.spacing(1),color:u.colors.text.secondary,whiteSpace:"nowrap"}),inlineLabelEnabled:(0,n.css)({color:u.colors.text.primary}),invalid:(0,n.css)({"input + label, input:checked + label, input:hover + label":{border:`1px solid ${u.colors.error.border}`}})})},60734:(Q,I,e)=>{"use strict";e.d(I,{q:()=>m});var n=e(32196),a=e(96540),o=e(29158),r=e(63021),i=e(40675),f=e(40980),d=e(40845),l=e(40276);function m({tabs:h,defaultTab:u,closeIconTooltip:b,onClose:g,testId:P}){const[c,y]=(0,a.useState)(h.some(S=>S.value===u)?u:h[0].value),p=(0,d.of)(s),v=(0,d.$j)(),D=S=>{y(S.value)},E=`calc(100% - (${v.components.menuTabs.height}px + ${v.spacing(1)}))`;return a.createElement("div",{className:p.container,"data-testid":P},a.createElement(r.U,{className:p.tabs},h.map(S=>a.createElement(i.o,{key:S.value,label:S.label,active:S.value===c,onChangeTab:()=>D(S),icon:S.icon})),a.createElement(o.K,{className:p.close,onClick:g,name:"times",tooltip:b??"Close"})),a.createElement(l.E,{autoHeightMin:E,autoHeightMax:E},a.createElement(f.J,{className:p.tabContent},h.find(S=>S.value===c)?.content)))}const s=h=>({container:(0,n.css)({height:"100%"}),tabContent:(0,n.css)({padding:h.spacing(2),backgroundColor:h.colors.background.primary,height:"100%"}),close:(0,n.css)({position:"absolute",right:"16px",top:"5px",cursor:"pointer",fontSize:h.typography.size.lg}),tabs:(0,n.css)({paddingTop:h.spacing(1),borderColor:h.colors.border.weak,ul:{marginLeft:h.spacing(2)}})})},92015:(Q,I,e)=>{"use strict";e.d(I,{u:()=>d,d:()=>m});var n=e(96540),a=e(75059),o=e(13544),r=e(32196);const i=s=>{const h=(0,r.css)({width:"100%",listStyle:"none"}),u=(0,r.css)({width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between"});return s.value&&!Array.isArray(s.value)?n.createElement("span",null,s.value):s.value&&Array.isArray(s.value)&&s.value.length>0?n.createElement("ul",{className:h},s.value.map((b,g)=>{const P=Object.keys(b)[0];return n.createElement("li",{className:u,key:g},n.createElement("span",null,P),n.createElement("span",null,b[P]))})):f},f=()=>n.createElement("span",null,"\xA0");function d(s){const{totalColumnsWidth:h,footerGroups:u,isPaginationVisible:b,tableStyles:g}=s,P=o.Tp.components.Panels.Visualization.Table;return n.createElement("div",{style:{position:b?"relative":"absolute",width:h?`${h}px`:"100%",bottom:"0px"}},u.map(c=>{const{key:y,...p}=c.getFooterGroupProps();return n.createElement("div",{className:g.tfoot,...p,key:y,"data-testid":P.footer},c.headers.map(v=>l(v,g)))}))}function l(s,h){const u=s.getHeaderProps();return u?(u.style=u.style??{},u.style.position="absolute",u.style.justifyContent=s.justifyContent,n.createElement("div",{className:h.headerCell,...u},s.render("Footer"))):null}function m(s,h,u){if(h===void 0)return f;if(u){if(h[s]===void 0)return f;const b=a.AS.get(a.gy.count).name;return i({value:[{[b]:String(h[s])}]})}return i({value:h[s]})}},30355:(Q,I,e)=>{"use strict";e.d(I,{a:()=>u,t:()=>h});var n=e(96540),a=e(58563),o=e(14236),r=e(11261),i=e(52622),f=e(40845),d=e(29413),l=e(9286),m=e(5926),s=e(57021);const h={type:i.ob.Sparkline,drawStyle:i.GR.Line,lineInterpolation:i.dx.Smooth,lineWidth:1,fillOpacity:17,gradientMode:i.on.Hue,pointSize:2,barAlignment:i.Nj.Center,showPoints:i.yL.Never,hideValue:!1},u=P=>{const{field:c,innerWidth:y,tableStyles:p,cell:v,cellProps:D,timeRange:E}=P,S=b(v.value),T=(0,f.$j)();if(!S)return n.createElement("div",{...D,className:p.cellContainer},c.config.noValue||"no data");S.x&&!S.x.config.interval&&S.x.values.length>1&&(S.x.config.interval=S.x.values[1]-S.x.values[0]),S.y.values=S.y.values.map(L=>Number.isFinite(L)?L:null);const M=(0,a.AP)(S.y);S.y.config.min=M.min,S.y.config.max=M.max,S.y.state={range:M},S.timeRange=E;const A=g(c),x={color:c.config.color,custom:{...h,...A}},C=c.config.custom?.cellOptions?.hideValue;let O=0,R=null;if(!C){const L=(0,o.LI)(v.value)?v.value.value:null,N=c.display(L),F=(0,s.zi)(c,N,v.row.index);O=(0,d.kD)(`${F.prefix??""}${F.text}${F.suffix??""}`,16).width+T.spacing.gridSize,R=n.createElement(l.i,{style:{width:`${O-T.spacing.gridSize}px`,textAlign:"right",marginRight:T.spacing(1)},value:N})}return n.createElement("div",{...D,className:p.cellContainer},R,n.createElement("div",null,n.createElement(m.O,{width:y-O,height:p.cellHeightInner,sparkline:S,config:x,theme:p.theme})))};function b(P){if(Array.isArray(P))return{y:{name:"test",type:r.PU.number,values:P,config:{}}};if((0,o.ci)(P)){const c=P.fields.find(p=>p.type===r.PU.time),y=P.fields.find(p=>p.type===r.PU.number);if(c&&y)return{x:c,y}}}function g(P){let c=(0,s.bk)(P);if(c.type===i.ob.Auto&&(c={...c,type:i.ob.Sparkline}),c.type===i.ob.Sparkline)return c;throw new Error(`Expected options type ${i.ob.Sparkline} but got ${c.type}`)}},77093:(Q,I,e)=>{"use strict";e.d(I,{X:()=>Pe});var n=e(96540),a=e(32885),o=e(75059),r=e(11261),i=e(19845),f=e(13544),d=e(52622),l=e(40845),m=e(40276),s=e(19384),h=e(92015),u=e(4025),b=e(14578),g=e(32196),P=e(13840),c=e(91793),y=e(83195),p=e(67061),v=e(67647),D=e(9261),E=e(60029),S=e(10880);const T=28,M=T*5,A={Contains:{label:"Contains",value:"Contains",description:"Contains"},"=":{label:"=",value:"=",description:"Equals"},"!=":{label:"!=",value:"!=",description:"Not equals"},">":{label:">",value:">",description:"Greater"},">=":{label:">=",value:">=",description:"Greater or Equal"},"<":{label:"<",value:"<",description:"Less"},"<=":{label:"<=",value:"<=",description:"Less or Equal"},Expression:{label:"Expression",value:"Expression",description:'Bool Expression (Char $ represents the column value in the expression, e.g. "$ >= 10 && $ <= 12")'}},x=Object.values(A),C=A.Contains,O=A.Expression,R=Ie=>{if(Ie=Ie.trim().replace(/\\/g,""),/^(\d{4}-\d{2}-\d{2}|\d{4}\/\d{2}\/\d{2})/.test(Ie)){const We=new Date(Ie);if(!isNaN(We.getTime())){const Ae=(0,y.j_)("dateTimeAsIso");return(0,y.cN)(Ae(We.getTime()))}}const Oe=parseFloat(Ie);if(!isNaN(Oe))return Oe;const Ne=Ie.toLowerCase();return Ne==="true"||Ne==="false"?Ne==="true":Ie},L=({options:Ie,values:Oe,caseSensitive:Ne,showOperators:We,onChange:Ae,searchFilter:Ue,setSearchFilter:Me,operator:$e,setOperator:ke})=>{const Ze=(0,n.useMemo)(()=>new RegExp(Ue,Ne?void 0:"i"),[Ue,Ne]),ot=(0,n.useMemo)(()=>Ie.filter(Ke=>{if(!We||!Ue||$e.value===C.value)return Ke.label===void 0?!1:Ze.test(Ke.label);if($e.value===O.value){if(Ke.value===void 0)return!1;try{const Ve=Ue.replace(/\\/g,""),ht=new Function("$",`'use strict'; return ${Ve};`),gt=R(Ke.value);return ht(gt)}catch{}return!1}else{if(Ke.value===void 0)return!1;const Ve=R(Ke.value),ht=R(Ue);switch($e.value){case"=":return Ve===ht;case"!=":return Ve!==ht;case">":return Ve>ht;case">=":return Ve>=ht;case"<":return Ve<ht;case"<=":return Ve<=ht}return!1}}),[Ie,Ze,We,$e,Ue]),xt=(0,n.useMemo)(()=>ot.filter(Ke=>Oe.includes(Ke)),[ot,Oe]),ct=(0,n.useMemo)(()=>ot.length===xt.length,[ot,xt]),ft=(0,n.useMemo)(()=>xt.length>0&&ot.length>xt.length,[ot,xt]),Le=(0,n.useMemo)(()=>xt.length?`${xt.length} selected`:"Select all",[xt]),re=(0,n.useMemo)(()=>ot.length!==xt.length?"Add all displayed values to the filter":"Remove all displayed values from the filter",[ot,xt]),X=(0,l.of)(N),be=(0,l.$j)().spacing.gridSize,De=(0,n.useMemo)(()=>Math.min(ot.length*T,M)+be,[be,ot.length]),Te=(0,n.useCallback)(Ke=>Ve=>{const ht=Ve.currentTarget.checked?Oe.concat(Ke):Oe.filter(gt=>gt.value!==Ke.value);Ae(ht)},[Ae,Oe]),we=(0,n.useCallback)(()=>{if(ot.length===xt.length){const Ke=Oe.filter(Ve=>!ot.includes(Ve));Ae(Ke)}else{const Ke=[...new Set([...Oe,...ot])];Ae(Ke)}},[Ae,Oe,ot,xt]);return n.createElement(p.B,{direction:"column",gap:.25},!We&&n.createElement(v.Z,{placeholder:"Filter values",onChange:Me,value:Ue}),We&&n.createElement(p.B,{direction:"row",gap:0},n.createElement(D.f,{variant:"canvas",options:x,onChange:ke,value:$e,tooltip:$e.description}),n.createElement(v.Z,{placeholder:"Filter values",onChange:Me,value:Ue})),!ot.length&&n.createElement(E.J,null,"No values"),ot.length&&n.createElement(c.Y1,{height:De,itemCount:ot.length,itemSize:T,width:"100%",className:X.filterList},({index:Ke,style:Ve})=>{const ht=ot[Ke],{value:gt,label:bt}=ht,St=Oe.find(Je=>Je.value===gt)!==void 0;return n.createElement("div",{className:X.filterListRow,style:Ve,title:bt},n.createElement(S.S,{value:St,label:bt,onChange:Te(ht)}))}),ot.length&&n.createElement(p.B,{direction:"column",gap:.25},n.createElement("div",{className:(0,g.cx)(X.selectDivider)}),n.createElement("div",{className:(0,g.cx)(X.filterListRow)},n.createElement(S.S,{value:ct,indeterminate:ft,label:Le,description:re,onChange:we}))))},N=Ie=>({filterList:(0,g.css)({label:"filterList"}),filterListRow:(0,g.css)({label:"filterListRow",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:Ie.spacing(.5),":hover":{backgroundColor:Ie.colors.action.hover}}),selectDivider:(0,g.css)({label:"selectDivider",width:"100%",borderTop:`1px solid ${Ie.colors.border.medium}`,padding:Ie.spacing(.5,2)})});var F=e(8866),K=e(29158),B=e(55852),w=e(57021);const U=({column:{preFilteredRows:Ie,filterValue:Oe,setFilter:Ne},onClose:We,field:Ae,searchFilter:Ue,setSearchFilter:Me,operator:$e,setOperator:ke})=>{const Ze=(0,l.$j)(),ot=(0,n.useMemo)(()=>(0,w.MY)(Ie,Ae),[Ie,Ae]),xt=(0,n.useMemo)(()=>(0,w.Yz)(ot),[ot]),ct=(0,n.useMemo)(()=>(0,w.Sj)(xt,Oe),[xt,Oe]),[ft,Le]=(0,n.useState)(ct),[re,X]=(0,n.useState)(!1),le=(0,n.useCallback)(Ke=>We(),[We]),be=(0,n.useCallback)(Ke=>{const Ve=ft.length?ft:void 0;Ne(Ve),We()},[Ne,ft,We]),De=(0,n.useCallback)(Ke=>{Ne(void 0),We()},[Ne,We]),Te=(0,n.useMemo)(()=>Oe!==void 0,[Oe]),we=(0,l.of)(W);return n.createElement(F.N,{onClick:le,useCapture:!0},n.createElement("div",{className:(0,g.cx)(we.filterContainer),onClick:V},n.createElement(p.B,{direction:"column",gap:3},n.createElement(p.B,{direction:"column",gap:.5},n.createElement(p.B,{justifyContent:"space-between",alignItems:"center"},n.createElement(E.J,{className:we.label},"Filter by values:"),n.createElement(K.K,{name:"text-fields",tooltip:"Match case",style:{color:re?Ze.colors.text.link:Ze.colors.text.disabled},onClick:()=>{X(Ke=>!Ke)}})),n.createElement("div",{className:(0,g.cx)(we.listDivider)}),n.createElement(L,{onChange:Le,values:ft,options:xt,caseSensitive:re,showOperators:!0,searchFilter:Ue,setSearchFilter:Me,operator:$e,setOperator:ke})),n.createElement(p.B,{gap:3},n.createElement(p.B,null,n.createElement(B.$n,{size:"sm",onClick:be},"Ok"),n.createElement(B.$n,{size:"sm",variant:"secondary",onClick:le},"Cancel")),Te&&n.createElement(p.B,null,n.createElement(B.$n,{fill:"text",size:"sm",onClick:De},"Clear filter"))))))},W=Ie=>({filterContainer:(0,g.css)({label:"filterContainer",width:"100%",minWidth:"250px",height:"100%",maxHeight:"400px",backgroundColor:Ie.colors.background.primary,border:`1px solid ${Ie.colors.border.weak}`,padding:Ie.spacing(2),boxShadow:Ie.shadows.z3,borderRadius:Ie.shape.radius.default}),listDivider:(0,g.css)({label:"listDivider",width:"100%",borderTop:`1px solid ${Ie.colors.border.medium}`,padding:Ie.spacing(.5,2)}),label:(0,g.css)({marginBottom:0})}),V=Ie=>{Ie.stopPropagation()},_=({column:Ie,field:Oe,tableStyles:Ne})=>{const We=(0,n.useRef)(null),[Ae,Ue]=(0,n.useState)(!1),Me=(0,l.of)(H),$e=(0,n.useMemo)(()=>!!Ie.filterValue,[Ie.filterValue]),ke=(0,n.useCallback)(()=>Ue(!0),[Ue]),Ze=(0,n.useCallback)(()=>Ue(!1),[Ue]),[ot,xt]=(0,n.useState)(""),[ct,ft]=(0,n.useState)(C);return!Oe||!Oe.config.custom?.filterable?null:n.createElement("button",{className:(0,g.cx)(Ne.headerFilter,$e?Me.filterIconEnabled:Me.filterIconDisabled),ref:We,type:"button",onClick:ke},n.createElement(b.I,{name:"filter"}),Ae&&We.current&&n.createElement(P.A,{content:n.createElement(U,{column:Ie,tableStyles:Ne,field:Oe,onClose:Ze,searchFilter:ot,setSearchFilter:xt,operator:ct,setOperator:ft}),placement:"bottom-start",referenceElement:We.current,show:!0}))},H=Ie=>({filterIconEnabled:(0,g.css)({label:"filterIconEnabled",color:Ie.colors.primary.text}),filterIconDisabled:(0,g.css)({label:"filterIconDisabled",color:Ie.colors.text.disabled})}),G=Ie=>{const{headerGroups:Oe,showTypeIcons:Ne,tableStyles:We}=Ie,Ae=f.Tp.components.Panels.Visualization.Table;return n.createElement("div",{role:"rowgroup",className:We.headerRow},Oe.map(Ue=>{const{key:Me,...$e}=Ue.getHeaderGroupProps();return n.createElement("div",{className:We.thead,...$e,key:Me,"aria-label":Ae.header,role:"row"},Ue.headers.map((ke,Ze)=>j(ke,We,Ne)))}))};function j(Ie,Oe,Ne){const We=Ie.getHeaderProps(),Ae=Ie.field??null,Ue=Ae?.config.custom;Ie.canResize&&(We.style.userSelect=Ie.isResizing?"none":"auto"),We.style.position="absolute",We.style.justifyContent=Ie.justifyContent,We.style.left=Ie.totalLeft;let Me=Ie.render("Header"),$e=Ie.canSort&&n.createElement(n.Fragment,null,n.createElement("button",{...Ie.getSortByToggleProps(),className:Oe.headerCellLabel},Ne&&n.createElement(b.I,{name:(0,u.SS)(Ae),title:Ae?.type,size:"sm",className:Oe.typeIcon}),n.createElement("div",null,Me),Ie.isSorted&&(Ie.isSortedDesc?n.createElement(b.I,{size:"lg",name:"arrow-down",className:Oe.sortIcon}):n.createElement(b.I,{name:"arrow-up",size:"lg",className:Oe.sortIcon}))),Ie.canFilter&&n.createElement(_,{column:Ie,tableStyles:Oe,field:Ae}));return $e&&Ue?.headerComponent?$e=n.createElement(Ue.headerComponent,{field:Ae,defaultContent:$e}):Ue?.headerComponent&&(Me=n.createElement(Ue.headerComponent,{field:Ae,defaultContent:Me})),n.createElement("div",{className:Oe.headerCell,...We,role:"columnheader"},Ie.canSort&&$e,!Ie.canSort&&Me,!Ie.canSort&&Ie.canFilter&&n.createElement(_,{column:Ie,tableStyles:Oe,field:Ae}),Ie.canResize&&n.createElement("div",{...Ie.getResizerProps(),className:Oe.resizeHandle}))}var Y=e(64423),oe=e(56978),se=e(69129),ne=e(79041);function ee({tableStyles:Ie,nestedData:Oe,rowIndex:Ne,width:We,cellHeight:Ae}){const Ue=Oe.values,Me=[],$e=(0,l.$j)(),ke=(0,l.of)(Z);let Ze=Ie.rowHeight+$e.spacing.gridSize;return Ue[Ne].forEach((ot,xt)=>{const ct=!!ot.meta?.custom?.noHeader,ft=Ie.rowHeight*(ot.length+(ct?0:1)),Le={height:ft,paddingLeft:w.jV,position:"absolute",top:Ze};Ze+=ft+$e.spacing.gridSize,Me.push(n.createElement("div",{style:Le,key:`subTable_${Ne}_${xt}`},n.createElement(Pe,{data:ot,width:We-w.jV,height:Ie.rowHeight*(ot.length+1),noHeader:ct,cellHeight:Ae})))}),n.createElement("div",{className:ke.subTables},Me)}const Z=Ie=>({subTables:(0,g.css)({"&:before":{content:'""',position:"absolute",width:"1px",top:Ie.spacing(5),left:Ie.spacing(1),bottom:Ie.spacing(2),background:Ie.colors.border.medium}})});function z(Ie,Oe,Ne){return Ie.values[Oe].reduce((Ue,Me)=>{if(Me.length){const $e=!!Me.meta?.custom?.noHeader;return Ue+Ne.rowHeight*(Me.length+($e?0:1))+8}return Ue},Ne.rowHeight)??Ne.rowHeight}var q=e(49618);const ie=Ie=>{const{data:Oe,rows:Ne,headerHeight:We,footerPaginationEnabled:Ae,rowHeight:Ue,itemCount:Me,pageIndex:$e,tableState:ke,prepareRow:Ze,onCellFilterAdded:ot,width:xt,cellHeight:ct=d.qM.Sm,timeRange:ft,tableStyles:Le,nestedDataField:re,listHeight:X,listRef:le,enableSharedCrosshair:be=!1,initialRowIndex:De=void 0,headerGroups:Te,longestField:we}=Ie,[Ke,Ve]=(0,n.useState)(De);De===void 0&&Ke!==void 0&&Ve(void 0);const ht=(0,l.$j)(),gt=(0,ne.d2)();let bt=null;window.OffscreenCanvas!==void 0&&(bt=new OffscreenCanvas(256,1024).getContext("2d")),bt!=null&&(bt.font=`${ht.typography.fontSize}px ${ht.typography.body.fontFamily}`);const St=(0,n.useMemo)(()=>{const fn=Oe.fields.find(Tt=>Tt.type===r.PU.time);return fn?(0,w.HY)(fn):0},[Oe]),Je=(0,n.useCallback)((fn,Tt)=>{if(!gt||!be||!(0,i.S1)(Tt))return;const $t=Tt.fields.find(Yt=>Yt.type===r.PU.time);gt.eventBus.publish(new se.b_({point:{time:$t.values[fn]}}))},[be,gt]),rt=(0,n.useCallback)(()=>{!gt||!be||gt.eventBus.publish(new se.ql)},[be,gt]),Rt=(0,n.useCallback)(fn=>{if(fn.payload.point?.time&&fn.payload.rowIndex!==void 0){const Tt=Oe.fields.find(Tn=>Tn.type===r.PU.time),$t=Tt.values[fn.payload.rowIndex],Yt=fn.payload.point.time;if((0,w.Iy)(Yt,$t,St)){Ve(fn.payload.rowIndex);return}const Cn=Tt.values.findIndex(Tn=>(0,w.Iy)(Yt,Tn,St));if(Cn!==-1){Ve(Cn);return}Ve(void 0)}},[Oe.fields,St]);(0,n.useEffect)(()=>{if(!gt||!be||!(0,i.S1)(Oe)||Ae)return;const fn=new Y.yU;return fn.add(gt.eventBus.getStream(se.b_).pipe((0,oe.B)(250)).subscribe({next:Tt=>{gt.eventBus!==Tt.origin&&Rt(Tt)}})),fn.add(gt.eventBus.getStream(se.ql).pipe((0,oe.B)(250)).subscribe({next:Tt=>{gt.eventBus!==Tt.origin&&Ve(void 0)}})),()=>{fn.unsubscribe()}},[Oe,be,Ae,Rt,gt]);let _t;if(Ke!==void 0){const fn=Ne.findIndex(Tt=>Tt.index===Ke);fn!==-1&&(_t=We+(fn-1)*Ue)}const nn=(0,n.useCallback)(fn=>ke.pageIndex*ke.pageSize+fn,[ke.pageIndex,ke.pageSize]);let Kt,en;for(const fn of Oe.fields){const Tt=fn.config.custom,$t=Tt!==void 0&&Tt.cellOptions!==void 0;$t&&Tt.cellOptions.type===d.ob.ColorBackground&&Tt.cellOptions.applyToRow&&(Kt=Yt=>{const Cn=fn.display(fn.values.get(Yt));return(0,w.HW)(Le,Tt.cellOptions,Cn)}),$t&&(Tt.cellOptions.type===d.ob.Auto||Tt.cellOptions.type===d.ob.ColorBackground||Tt.cellOptions.type===d.ob.ColorText)&&Tt.cellOptions.wrapText?en=fn:we!==void 0&&(en=we)}const Qt=(0,n.useCallback)(({index:fn,style:Tt,rowHighlightIndex:$t})=>{const Yt=nn(fn),Cn=Ne[Yt];let Tn={};Ze(Cn);const vn=ke.expanded[Cn.id]?(0,g.css)({"&:hover":{background:"inherit"}}):{};if($t!==void 0&&Cn.index===$t&&(Tt={...Tt,backgroundColor:ht.components.table.rowHoverBackground},Tn={"aria-selected":"true"}),Kt){const{bgColor:Kn,textColor:Yn}=Kt(Cn.index);Tt.background=Kn,Tt.color=Yn}if(en){const Kn=Oe.fields.findIndex(yt=>yt.name===en.name),Yn=ht.typography.body.lineHeight*ht.typography.fontSize,nt=(0,w.M2)(en.values[fn],Te[0].headers[Kn],bt,Yn,Le.rowHeight);Tt.height=nt.height}return n.createElement("div",{...Cn.getRowProps({style:Tt,...Tn}),className:(0,g.cx)(Le.row,vn),onMouseEnter:()=>Je(fn,Oe),onMouseLeave:rt},re&&ke.expanded[Cn.id]&&n.createElement(ee,{nestedData:re,tableStyles:Le,rowIndex:Cn.index,width:xt,cellHeight:ct}),Cn.cells.map((Kn,Yn)=>n.createElement(q.n,{key:Yn,tableStyles:Le,cell:Kn,onCellFilterAdded:ot,columnIndex:Yn,columnCount:Cn.cells.length,timeRange:ft,frame:Oe,rowStyled:Kt!==void 0,textWrapped:en!==void 0,height:Number(Tt.height)})))},[ct,Oe,re,ot,Je,rt,Ze,nn,Ne,ke.expanded,Le,en,ht.components.table.rowHoverBackground,ht.typography.fontSize,ht.typography.body.lineHeight,ft,xt,Kt,Te,bt]),An=fn=>{const Tt=nn(fn),$t=Ne[Tt];if(ke.expanded[$t.id]&&re)return z(re,$t.index,Le);if(en){const Yt=Oe.fields.findIndex(Tn=>Tn.name===en.name),Cn=ht.typography.fontSize*ht.typography.body.lineHeight;return(0,w.M2)(en.values[fn],Te[0].headers[Yt],bt,Cn,Le.rowHeight).height}return Le.rowHeight},un=fn=>{const{scrollTop:Tt}=fn.currentTarget;le.current!==null&&le.current.scrollTo(Tt)};return n.createElement(n.Fragment,null,n.createElement(m.A,{onScroll:un,hideHorizontalTrack:!0,scrollTop:_t},n.createElement(c._m,{key:Ue+$e,height:X,itemCount:Me,itemSize:An,width:"100%",ref:le,style:{overflow:void 0}},({index:fn,style:Tt})=>Qt({index:fn,style:Tt,rowHighlightIndex:Ke}))))};function de(Ie,Oe){(0,n.useEffect)(()=>{if(Ie.current&&Oe.current){const Ne=Ie.current.querySelector(".track-vertical"),We=Oe.current.firstChild;We&&Ne&&(Ne.remove(),We instanceof HTMLElement&&(We.querySelector(":scope > .track-vertical")?.remove(),We.append(Ne)))}})}function ue(Ie,Oe,Ne,We){const Ae=JSON.stringify(Object.keys(Ie.expanded));(0,n.useEffect)(()=>{let Ue=0;We||(Number.isFinite(Ie.lastExpandedOrCollapsedIndex)&&(Ue=Ie.lastExpandedOrCollapsedIndex),Ue=Ie.pageIndex===0?Ue-1:Ue-Ie.pageIndex-Ie.pageIndex*Ie.pageSize),Oe.current?.resetAfterIndex(Math.max(Ue,0))},[Ie.lastExpandedOrCollapsedIndex,Ie.pageSize,Ie.pageIndex,Oe,Ne,Ae,We])}var fe=e(28240);function Se({onColumnResize:Ie,onSortByChange:Oe,data:Ne}){return(0,n.useCallback)((We,Ae)=>{switch(Ae.type){case"columnDoneResizing":if(Ie){const Me=We.columnResizing.headerIdWidths[0][0],$e=parseInt(Me,10),ke=Math.round(We.columnResizing.columnWidths[Me]),Ze=Ne.fields[$e];if(!Ze)return We;const ot=(0,fe.Ct)(Ze,Ne);Ie(ot,ke)}case"toggleSortBy":if(Oe){const Ue=[];for(const Me of We.sortBy){const $e=Ne.fields[parseInt(Me.id,10)];$e&&Ue.push({displayName:(0,fe.Ct)($e,Ne),desc:Me.desc})}Oe(Ue)}case"toggleRowExpanded":if(Ae.id)return{...We,lastExpandedOrCollapsedIndex:parseInt(Ae.id,10)}}return We},[Ne,Ie,Oe])}function he(Ie,Oe){const Ne={};if(Ie){Ne.sortBy=[];for(const We of Ie)for(const Ae of Oe)Ae.Header===We.displayName&&Ne.sortBy.push({id:Ae.id,desc:We.desc})}return Ne}var ce=e(69770);const me=150,pe=36,ye="No data",Pe=(0,n.memo)(Ie=>{const{ariaLabel:Oe,data:Ne,height:We,onCellFilterAdded:Ae,width:Ue,columnMinWidth:Me=me,noHeader:$e,resizable:ke=!0,initialSortBy:Ze,footerOptions:ot,showTypeIcons:xt,footerValues:ct,enablePagination:ft,cellHeight:Le=d.qM.Sm,timeRange:re,enableSharedCrosshair:X=!1,initialRowIndex:le=void 0,fieldConfig:be}=Ie,De=(0,n.useRef)(null),Te=(0,n.useRef)(null),we=(0,n.useRef)(null),Ke=(0,l.$j)(),Ve=(0,ce.k)(Ke,Le),ht=$e?0:Ve.rowHeight,[gt,bt]=(0,n.useState)(ct),St=be?.defaults?.noValue??ye,Je=(0,n.useMemo)(()=>{const mt=pe;let Bt=0;if(!gt)return 0;for(const Jt of gt)Array.isArray(Jt)&&Jt.length>Bt&&(Bt=Jt.length);return Bt>1?mt*Bt:mt},[gt]),rt=(0,n.useMemo)(()=>Ne.fields.length?Array(Ne.length).fill(0):[],[Ne]),Rt=!!(ot?.countRows&&ot.reducer&&ot.reducer.length&&ot.reducer[0]===o.gy.count),_t=Ne.fields.find(mt=>mt.type===r.PU.nestedFrames),nn=_t!==void 0,Kt=(0,n.useMemo)(()=>(0,w.GH)(Ne,Ue,Me,nn,gt,Rt),[Ne,Ue,Me,gt,nn,Rt]),en=(0,n.useRef)(),Qt=Se({...Ie,onSortByChange:mt=>{en.current(!1),Ie.onSortByChange&&Ie.onSortByChange(mt)}}),An=!!Ne.meta?.uniqueRowIdFields?.length,un=(0,n.useMemo)(()=>{const mt={columns:Kt,data:rt,disableResizing:!ke,stateReducer:Qt,autoResetPage:!1,initialState:he(Ze,Kt),autoResetFilters:!1,sortTypes:{number:w.Ok,"alphanumeric-insensitive":w.IM}};return An&&(mt.getRowId=(Bt,Jt)=>(0,i.t9)(Ne,Jt),mt.autoResetExpanded=!1),mt},[Ze,Kt,rt,ke,Qt,An,Ne]),{getTableProps:fn,headerGroups:Tt,footerGroups:$t,rows:Yt,prepareRow:Cn,totalColumnsWidth:Tn,page:vn,state:Kn,gotoPage:Yn,setPageSize:nt,pageOptions:yt,toggleAllRowsExpanded:Vt}=(0,a.useTable)(un,a.useFilters,a.useSortBy,a.useAbsoluteLayout,a.useResizeColumns,a.useExpanded,a.usePagination),je=Kn;en.current=Vt,(0,n.useEffect)(()=>{ot||bt(ct)},[ct,ot]),(0,n.useEffect)(()=>{if(!ot)return;if(!ot.show){bt(void 0);return}if(Rt){const Bt=[];Bt[0]=Tt[0]?.headers[0]?.filteredRows.length.toString()??Ne.length.toString(),bt(Bt);return}const mt=(0,w.Ux)(Tt[0].headers,(0,w.XX)(Yt),ot,Ke);bt(mt)},[ot,Ke,Kn.filters,Ne]);let tt=We-(ht+Je);ft&&(tt-=Ve.cellHeight);const Dt=Math.round(tt/Ve.rowHeight)-1;(0,n.useEffect)(()=>{Dt<=0||nt(Dt)},[Dt,nt]),(0,n.useEffect)(()=>{Ne.length/Dt<Kn.pageIndex&&Yn(0)},[Ne]),ue(je,De,Ne,An),de(we,Te);const Ot=(0,n.useCallback)(mt=>{Yn(mt-1)},[Yn]),Lt=ft?vn.length:Yt.length;let Gt=null;if(ft){const mt=Kn.pageIndex*Kn.pageSize+1;let Bt=mt+Kn.pageSize-1;const Jt=Ue<550;Bt>Ne.length&&(Bt=Ne.length),Gt=n.createElement("div",{className:Ve.paginationWrapper},n.createElement(s.d,{currentPage:Kn.pageIndex+1,numberOfPages:yt.length,showSmallVersion:Jt,onNavigate:Ot}),Jt?null:n.createElement("div",{className:Ve.paginationSummary},mt," - ",Bt," of ",Ne.length," rows"))}const hn=(0,w.O4)(be,Ne);return n.createElement("div",{...fn(),className:Ve.table,"aria-label":Oe,role:"table",ref:Te,style:{width:Ue,height:We}},n.createElement(m.E,{hideVerticalTrack:!0},n.createElement("div",{className:Ve.tableContentWrapper(Tn)},!$e&&n.createElement(G,{headerGroups:Tt,showTypeIcons:xt,tableStyles:Ve}),Lt>0?n.createElement("div",{"data-testid":f.Tp.components.Panels.Visualization.Table.body,ref:we},n.createElement(ie,{headerGroups:Tt,data:Ne,rows:Yt,width:Ue,cellHeight:Le,headerHeight:ht,rowHeight:Ve.rowHeight,itemCount:Lt,pageIndex:Kn.pageIndex,listHeight:tt,listRef:De,tableState:Kn,prepareRow:Cn,timeRange:re,onCellFilterAdded:Ae,nestedDataField:_t,tableStyles:Ve,footerPaginationEnabled:!!ft,enableSharedCrosshair:X,initialRowIndex:le,longestField:hn})):n.createElement("div",{style:{height:We-ht,width:Ue},className:Ve.noData},St),gt&&n.createElement(h.u,{isPaginationVisible:!!ft,footerValues:gt,footerGroups:$t,totalColumnsWidth:Tn,tableStyles:Ve}))),Gt)});Pe.displayName="Table"},49618:(Q,I,e)=>{"use strict";e.d(I,{n:()=>a});var n=e(96540);const a=({cell:o,tableStyles:r,onCellFilterAdded:i,timeRange:f,userProps:d,frame:l,rowStyled:m,textWrapped:s,height:h})=>{const u=o.getCellProps(),b=o.column.field;if(!b?.display)return null;u.style&&(u.style.minWidth=u.style.width,u.style.justifyContent=o.column.justifyContent);let g=(typeof o.column.width=="number"?o.column.width:24)-r.cellPadding*2;return n.createElement(n.Fragment,null,o.render("Cell",{field:b,tableStyles:r,onCellFilterAdded:i,cellProps:u,innerWidth:g,timeRange:f,userProps:d,frame:l,rowStyled:m,textWrapped:s,height:h}))}},69770:(Q,I,e)=>{"use strict";e.d(I,{k:()=>a});var n=e(32196);function a(r,i){const f=r.colors.border.weak,d=r.colors.primary.border,l=6,m=o(r,i,l),s=m+2,h=28,u=(b,g,P,c,y,p,v,D)=>(0,n.css)({label:c?"cellContainerOverflow":"cellContainerNoOverflow",padding:`${l}px`,width:"100%",height:`${s-1}px`,wordBreak:v?"break-all":"inherit",display:"flex",...y?{overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}:{},alignItems:"center",borderRight:`1px solid ${f}`,color:D?"inherit":b??void 0,background:D?void 0:g??void 0,backgroundClip:"padding-box","&:last-child:not(:only-child)":{borderRight:"none"},"&:hover":{overflow:c&&!v?"visible":void 0,width:p||!c?"auto":"auto !important",height:(p||c)&&!v?"auto !important":`${s-1}px`,minHeight:`${s-1}px`,wordBreak:p?"break-word":void 0,whiteSpace:p&&c?"normal":"nowrap",boxShadow:c?`0 0 2px ${r.colors.primary.main}`:void 0,background:D?"inherit":P??r.colors.background.primary,zIndex:1,".cellActions":{color:"#FFF",visibility:"visible",opacity:1,width:"auto",background:"rgba(0, 0, 0, 0.6)"}},a:{color:"inherit"},".cellActions":{display:"flex",position:c?void 0:"absolute",top:c?void 0:"1px",right:c?void 0:0,margin:c?r.spacing(0,-.5,0,.5):"auto",visibility:"hidden",opacity:0,width:0,alignItems:"center",height:"100%",padding:r.spacing(1,.5,1,1),background:g?"none":"rgba(0, 0, 0, 0.5)",svg:{color:b}},".cellActionsLeft":{right:"auto !important",left:0},".cellActionsTransparent":{background:"none"}});return{theme:r,cellHeight:m,buildCellContainerStyle:u,cellPadding:l,cellHeightInner:m-l*2,rowHeight:s,table:(0,n.css)({height:"100%",width:"100%",overflow:"auto",display:"flex",flexDirection:"column"}),thead:(0,n.css)({label:"thead",height:`${h}px`,overflowY:"auto",overflowX:"hidden",position:"relative"}),tfoot:(0,n.css)({label:"tfoot",height:`${h}px`,borderTop:`1px solid ${f}`,overflowY:"auto",overflowX:"hidden",position:"relative"}),headerRow:(0,n.css)({label:"row",borderBottom:`1px solid ${f}`}),headerCell:(0,n.css)({height:"100%",padding:`0 ${l}px`,overflow:"hidden",whiteSpace:"nowrap",display:"flex",alignItems:"center",fontWeight:r.typography.fontWeightMedium,"&:last-child":{borderRight:"none"}}),headerCellLabel:(0,n.css)({border:"none",padding:0,background:"inherit",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:r.typography.fontWeightMedium,display:"flex",alignItems:"center",marginRight:r.spacing(.5),"&:hover":{textDecoration:"underline",color:r.colors.text.link}}),cellContainerText:u(void 0,void 0,void 0,!0,!0),cellContainerTextNoOverflow:u(void 0,void 0,void 0,!1,!0),cellContainer:u(void 0,void 0,void 0,!0,!1),cellContainerNoOverflow:u(void 0,void 0,void 0,!1,!1),cellText:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}),sortIcon:(0,n.css)({marginLeft:r.spacing(.5)}),cellLink:(0,n.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",color:r.colors.text.link,fontWeight:r.typography.fontWeightMedium,paddingRight:r.spacing(1.5),"&:hover":{textDecoration:"underline",color:r.colors.text.link}}),cellLinkForColoredCell:(0,n.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",fontWeight:r.typography.fontWeightMedium,textDecoration:"underline"}),imageCellLink:(0,n.css)({cursor:"pointer",overflow:"hidden",height:"100%"}),headerFilter:(0,n.css)({background:"transparent",border:"none",label:"headerFilter",padding:0}),paginationWrapper:(0,n.css)({display:"flex",height:`${m}px`,justifyContent:"center",alignItems:"center",width:"100%",li:{marginBottom:0}}),paginationSummary:(0,n.css)({color:r.colors.text.secondary,fontSize:r.typography.bodySmall.fontSize,display:"flex",justifyContent:"flex-end",padding:r.spacing(0,1,0,2)}),tableContentWrapper:b=>{const g=b!==void 0?`${b}px`:"100%";return(0,n.css)({label:"tableContentWrapper",width:g,display:"flex",flexDirection:"column"})},row:(0,n.css)({label:"row",borderBottom:`1px solid ${f}`,"&:hover":{backgroundColor:r.components.table.rowHoverBackground},"&:last-child":{borderBottom:0}}),imageCell:(0,n.css)({height:"100%"}),resizeHandle:(0,n.css)({label:"resizeHandle",cursor:"col-resize !important",display:"inline-block",background:d,opacity:0,[r.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.2s ease-in-out"},width:"8px",height:"100%",position:"absolute",right:"-4px",borderRadius:r.shape.radius.default,top:0,touchAction:"none","&:hover":{opacity:1}}),typeIcon:(0,n.css)({marginRight:r.spacing(1),color:r.colors.text.secondary}),noData:(0,n.css)({alignItems:"center",display:"flex",height:"100%",justifyContent:"center",width:"100%"}),expanderCell:(0,n.css)({display:"flex",flexDirection:"column",justifyContent:"center",height:`${s}px`,cursor:"pointer"})}}function o(r,i,f){const d=r.typography.fontSize,l=r.typography.body.lineHeight;switch(i){case"md":return 42;case"lg":return 48;case"sm":default:return f*2+d*l}}},88407:(Q,I,e)=>{"use strict";e.d(I,{Zi:()=>a,mc:()=>n});const n="=",a="!="},57021:(Q,I,e)=>{"use strict";e.d(I,{jV:()=>Z,HY:()=>ke,MY:()=>ue,XX:()=>Oe,zi:()=>Me,HW:()=>Ze,bk:()=>We,GH:()=>q,Sj:()=>ce,Ux:()=>Pe,j1:()=>z,O4:()=>xt,M2:()=>ot,Iy:()=>$e,o7:()=>Ae,IM:()=>me,Ok:()=>pe,Yz:()=>Se});var n=e(2543),a=e(47078),o=e.n(a),r=e(84140),i=e(11261),f=e(28240),d=e(14236),l=e(19845),m=e(83195),s=e(75059),h=e(57875),u=e(52622),b=e(24284),g=e(96540),P=e(50082),c=e(58563),y=e(47070),p=e(97696),v=e(59796);const D={mode:P.O.Absolute,steps:[{color:"blue",value:-1/0},{color:"green",value:20}]},E=ct=>{const{field:ft,innerWidth:Le,tableStyles:re,cell:X,cellProps:le,row:be}=ct,De=ft.display(X.value),Te=We(ft);let we=(0,c.xg)(ft,!1);we.thresholds||(we={...we,thresholds:D});let Ke=u.eX.Gradient,Ve;Te.type===u.ob.Gauge&&(Ke=Te.mode??u.eX.Gradient,Ve=Te.valueDisplayMode!==void 0?Te.valueDisplayMode:u.$l.Text);const ht=()=>(0,n.isFunction)(ft.getLinks)?ft.getLinks({valueRowIndex:be.index}):[],gt=!!ht().length,bt=Me(ft,De,X.row.index),St=Je=>{const{openMenu:rt,targetClassName:Rt}=Je;return g.createElement(p.xE,{width:Le,height:re.cellHeightInner,field:we,display:ft.display,text:{valueSize:14},value:De,orientation:y.wV.Horizontal,theme:re.theme,alignmentFactors:bt,onClick:rt,className:Rt,itemSpacing:1,lcdCellWidth:8,displayMode:Ke,valueDisplayMode:Ve})};return g.createElement("div",{...le,className:re.cellContainer},gt&&g.createElement(v.e,{links:ht,style:{display:"flex",width:"100%"}},Je=>St(Je)),!gt&&St({}))};var S=e(90914);const T=ct=>{const{field:ft,row:Le,cellProps:re,tableStyles:X}=ct,le=(0,S.k)(ft,Le);return g.createElement("div",{...re,className:X.cellContainerText},le&&le.map((be,De)=>g.createElement("span",{key:De,className:X.cellLink,onClick:be.onClick},g.createElement("a",{href:be.href,target:be.target},be.title))))};var M=e(32196),A=e(40845),x=e(55852),C=e(29158),O=e(67061),R=e(10534),L=e(87978),N=e(32372);function F({value:ct,onDismiss:ft,mode:Le}){let re=ct;if((0,n.isString)(ct)){const le=ct.trim();if(le[0]==="{"||le[0]==="["||Le==="code")try{ct=JSON.parse(ct),Le="code"}catch{Le="text"}else Le="text"}else re=JSON.stringify(ct,null," ");let X=re;return Le==="code"&&(X=JSON.stringify(ct,null," ")),g.createElement(L._,{onClose:ft,title:"Inspect value"},Le==="code"?g.createElement(N.B,{width:"100%",height:500,language:"json",showLineNumbers:!0,showMiniMap:(X&&X.length)>100,value:X,readOnly:!0}):g.createElement("pre",null,X),g.createElement(R.b,{icon:"copy",getText:()=>X},"Copy to Clipboard"))}var K=e(88407);function B({field:ct,cell:ft,previewMode:Le,showFilters:re,onCellFilterAdded:X}){const[le,be]=(0,g.useState)(!1),De=z(ct)==="flex-end",Te=!!ct.config.custom?.inspect,we={size:"sm",tooltipPlacement:"top"},Ke=(0,g.useCallback)(ht=>{X&&X({key:ct.name,operator:K.mc,value:ft.value})},[ft,ct,X]),Ve=(0,g.useCallback)(ht=>{X&&X({key:ct.name,operator:K.Zi,value:ft.value})},[ft,ct,X]);return g.createElement(g.Fragment,null,g.createElement("div",{className:`cellActions${De?" cellActionsLeft":""}`},g.createElement(O.B,{gap:.5},Te&&g.createElement(C.K,{name:"eye",tooltip:"Inspect value",onClick:()=>{be(!0)},...we}),re&&g.createElement(C.K,{name:"search-plus",onClick:Ke,tooltip:"Filter for value",...we}),re&&g.createElement(C.K,{name:"search-minus",onClick:Ve,tooltip:"Filter out value",...we}))),le&&g.createElement(F,{mode:Le,value:ft.value,onDismiss:()=>{be(!1)}}))}const w=ct=>{const{field:ft,cell:Le,tableStyles:re,row:X,cellProps:le,frame:be,rowStyled:De,textWrapped:Te,height:we}=ct,Ke=!!ft.config.custom?.inspect,Ve=ft.display(Le.value),ht=ct.onCellFilterAdded&&ft.config.filterable,gt=ht&&Le.value!==void 0||Ke,bt=We(ft),St=!!(0,S.k)(ft,X)?.length,Je=(0,A.of)(x.Ez),[rt,Rt]=(0,g.useState)(!1);let _t;const nn=140,Kt=()=>{Rt(!1)},en=()=>{Rt(!0)};if(bt.type===u.ob.Custom){const fn=bt.cellComponent;_t=g.createElement(fn,{field:ft,value:Le.value,rowIndex:X.index,frame:be})}else g.isValidElement(Le.value)?_t=Le.value:_t=(0,m.cN)(Ve);const Qt=typeof _t=="string",An=Ve.text.length<=nn&&/\s/.test(Ve.text),un=U(re,bt,Ve,Ke,Qt,An,Te,De);if(Qt){let fn=le.style?.justifyContent;fn==="flex-end"?le.style={...le.style,textAlign:"right"}:fn==="center"&&(le.style={...le.style,textAlign:"center"})}return we&&(le.style={...le.style,height:we}),Te&&(le.style={...le.style,textWrap:"wrap"}),g.createElement("div",{...le,onMouseEnter:gt?en:void 0,onMouseLeave:gt?Kt:void 0,className:un},!St&&(Qt?`${_t}`:g.createElement("div",{className:re.cellText},_t)),St&&g.createElement(v.e,{links:()=>(0,S.k)(ft,X)||[]},fn=>fn.openMenu?g.createElement("button",{className:(0,M.cx)(Je,W(re,bt,fn.targetClassName)),onClick:fn.openMenu},_t):g.createElement("div",{className:W(re,bt,fn.targetClassName)},_t)),rt&&gt&&g.createElement(B,{...ct,previewMode:"text",showFilters:ht}))};function U(ct,ft,Le,re=!1,X=!1,le=!1,be=!1,De=!1){let Te,we,Ke;const Ve=Ze(ct,ft,Le);return Te=Ve.textColor,we=Ve.bgColor,Ke=Ve.bgHoverColor,ct.buildCellContainerStyle(Te,we,Ke,!re,X,le,be,De)}function W(ct,ft,Le){return ft.type===u.ob.Auto?(0,M.cx)(ct.cellLink,Le):(0,M.cx)(ct.cellLinkForColoredCell,Le)}var V=e(92015),_=e(64136),H=e(27430);function G(ct){const{cell:ft,tableStyles:Le,cellProps:re}=ct;let X="";return ft.value instanceof H.A?X=new _.A().writeGeometry(ft.value,{featureProjection:"EPSG:3857",dataProjection:"EPSG:4326"}):ft.value!=null&&(X=`${ft.value}`),g.createElement("div",{...re,className:Le.cellContainer},g.createElement("div",{className:Le.cellText,style:{fontFamily:"monospace"}},X))}const j=10,Y=ct=>{const{field:ft,cell:Le,tableStyles:re,row:X,cellProps:le}=ct,be=ft.display(Le.value),De=!!(0,S.k)(ft,X)?.length;return g.createElement("div",{...le,className:re.cellContainer},!De&&g.createElement("img",{style:{height:re.cellHeight-j,width:"auto"},src:be.text,className:re.imageCell,alt:""}),De&&g.createElement(v.e,{style:{height:re.cellHeight-j,width:"auto"},links:()=>(0,S.k)(ft,X)||[]},Te=>{const we=g.createElement("img",{style:{height:re.cellHeight-j,width:"auto"},src:be.text,className:re.imageCell,alt:""});return Te.openMenu?g.createElement("div",{onClick:Te.openMenu,role:"button",tabIndex:0,onKeyDown:Ke=>{Ke.key==="Enter"&&Te.openMenu&&Te.openMenu(Ke)}},we):we}))};function oe(ct){const{cell:ft,tableStyles:Le,cellProps:re,field:X,row:le}=ct,be=!!X.config.custom?.inspect,De=(0,M.css)({cursor:"pointer",fontFamily:"monospace"});let Te=ft.value,we=Te;if((0,n.isString)(Te))try{Te=JSON.parse(Te)}catch{}else we=JSON.stringify(Te,null," ");const Ke=!!(0,S.k)(X,le)?.length,Ve=(0,A.of)(x.Ez);return g.createElement("div",{...re,className:be?Le.cellContainerNoOverflow:Le.cellContainer},g.createElement("div",{className:(0,M.cx)(Le.cellText,De)},!Ke&&g.createElement("div",{className:Le.cellText},we),Ke&&g.createElement(v.e,{links:()=>(0,S.k)(X,le)||[]},ht=>ht.openMenu?g.createElement(x.$n,{className:(0,M.cx)(Ve),onClick:ht.openMenu},we):g.createElement(g.Fragment,null,we))),be&&g.createElement(B,{...ct,previewMode:"code"}))}var se=e(14578);function ne({row:ct,tableStyles:ft}){return g.createElement("div",{className:ft.expanderCell,...ct.getToggleRowExpandedProps()},g.createElement(se.I,{"aria-label":ct.isExpanded?"Collapse row":"Expand row",name:ct.isExpanded?"angle-down":"angle-right",size:"lg"}))}var ee=e(30355);const Z=50;function z(ct){if(!ct)return"flex-start";if(ct.config.custom)switch(ct.config.custom.align){case"right":return"flex-end";case"left":return"flex-start";case"center":return"center"}return ct.type===i.PU.number?"flex-end":"flex-start"}function q(ct,ft,Le,re,X,le){const be=[];let De=0;re&&(be.push({Header:()=>null,id:"expander",Cell:ne,width:Z,minWidth:Z,filter:(we,Ke,Ve)=>[],justifyContent:"left",field:ct.fields[0],sortType:"basic"}),ft-=Z);for(const[we,Ke]of ct.fields.entries()){const Ve=Ke.config.custom||{};if(Ve.hidden||Ke.type===i.PU.nestedFrames)continue;Ve.width?ft-=Ve.width:De++;const ht=bt=>{switch(bt){case i.PU.number:case i.PU.frame:return"number";case i.PU.time:return"basic";default:return"alphanumeric-insensitive"}},gt=ie(Ve.cellOptions?.type,Ke);be.push({Cell:gt,id:we.toString(),field:Ke,Header:Ve.hideHeader?"":(0,f.Ct)(Ke,ct),accessor:(bt,St)=>Ke.values[St],sortType:ht(Ke.type),width:Ve.width,minWidth:Ve.minWidth??Le,filter:o()(de(Ke)),justifyContent:z(Ke),Footer:(0,V.d)(we,X,le)})}let Te=ft/De;for(let we=De;we>0;we--)for(const Ke of be)!Ke.width&&Ke.minWidth>Te&&(Ke.width=Ke.minWidth,ft-=Ke.width,De-=1,Te=ft/De);for(const we of be)we.width||(we.width=Te),we.minWidth=50;return be}function ie(ct,ft){switch(ct){case u.ob.Custom:case u.ob.ColorText:case u.ob.ColorBackground:return w;case u.ob.Image:return Y;case u.ob.Gauge:return E;case u.ob.Sparkline:return ee.a;case u.ob.JSONView:return oe;case u.ob.DataLinks:return T}if(ft.type===i.PU.geo)return G;if(ft.type===i.PU.frame){const Le=ft.values[0];return(0,d.ci)(Le)&&(0,l.aH)(Le)?ee.a:oe}return ft.type===i.PU.other?oe:w}function de(ct){return function(ft,Le,re){return ft.length===0||!re||!ct?ft:ft.filter(X=>{if(!X.values.hasOwnProperty(Le))return!1;const le=fe(X,ct);return re.find(be=>be.value===le)!==void 0})}}function ue(ct,ft){if(!ft||ct.length===0)return{};const Le={};for(let re=0;re<ct.length;re++){const X=fe(ct[re],ft);Le[X||"(Blanks)"]=X}return Le}function fe(ct,ft){if(!ft||!ct)return"";const Le=ft.values[ct.index],re=ft.display?ft.display(Le):Le;return ft.display?(0,m.cN)(re):re}function Se(ct){return Object.keys(ct).reduce((ft,Le)=>ft.concat({value:ct[Le],label:Le}),[]).sort(he)}function he(ct,ft){return ct.label===void 0&&ft.label===void 0?0:ct.label===void 0&&ft.label!==void 0?-1:ct.label!==void 0&&ft.label===void 0?1:ct.label<ft.label?-1:ct.label>ft.label?1:0}function ce(ct,ft){return ft?ct.filter(Le=>ft.some(re=>re.value===Le.value)):[]}function me(ct,ft,Le){return String(ct.values[Le]).localeCompare(String(ft.values[Le]),void 0,{sensitivity:"base"})}function pe(ct,ft,Le){const re=ye(ct.values[Le]),X=ye(ft.values[Le]);return re===X?0:re>X?1:-1}function ye(ct){return(0,d.LI)(ct)?ct.value??Number.NEGATIVE_INFINITY:ct==null||ct===""||isNaN(ct)?Number.NEGATIVE_INFINITY:typeof ct=="number"?ct:Number(ct)}function Pe(ct,ft,Le,re){return Ue(ct),ct.map((X,le)=>{if(X?.field?.type!==i.PU.number)return le===0&&Le.reducer&&Le.reducer.length>0?s.AS.get(Le.reducer[0]).name:void 0;let be=(0,n.clone)(X.field);return be.values=ft[X.id],be.state=void 0,X.field=be,Le.fields&&Le.fields.length>0?Le.fields.find(Te=>Te===X?.field?.name)?Ie(X.field,Le.reducer,re):void 0:Ie(X.field,Le.reducer||[],re)})}function Ie(ct,ft,Le){const re=ft[0];if(re===void 0)return"";const X=ct.display??(0,h.J)({field:ct,theme:Le}),le=(0,s.Nw)({field:ct,reducers:ft})[re];return s.AS.get(re).preservesUnits?(0,m.cN)(X(le)):(0,m.cN)({text:le})}function Oe(ct){const ft=[];for(const Le in ct)for(const[re,X]of Object.entries(ct[Le].values))ft[re]===void 0&&(ft[re]=[]),ft[re].push(X);return ft}const Ne={type:u.ob.Auto};function We(ct){return ct.config.custom?.displayMode?Ae(ct.config.custom?.displayMode):ct.config.custom?.cellOptions?ct.config.custom.cellOptions:Ne}function Ae(ct){switch(ct){case"basic":case"gradient-gauge":case"lcd-gauge":let ft=u.eX.Basic;return ct==="gradient-gauge"?ft=u.eX.Gradient:ct==="lcd-gauge"&&(ft=u.eX.Lcd),{type:u.ob.Gauge,mode:ft};case"color-background":case"color-background-solid":let Le=u.Wq.Basic;return ct==="color-background"&&(Le=u.Wq.Gradient),{type:u.ob.ColorBackground,mode:Le};default:return{type:ct}}}function Ue(ct){const ft=ct.findIndex((Le,re)=>Le?.id!==String(re));ft===-1||ct[ft]?.id==="expander"||(ct.splice(ft,0,{id:String(ft)}),Ue(ct))}function Me(ct,ft,Le){let re=ct.state?.alignmentFactors;if(re)return re.text.length<ft.text.length&&(re.text=ft.text),re;{re={...ft};const X=Math.min(ct.values.length,Le+1e3);for(let le=Le+1;le<X;le++)ct.display(ct.values[le]).text.length>re.text.length&&(re.text=ft.text);return ct.state?ct.state.alignmentFactors=re:ct.state={alignmentFactors:re},re}}function $e(ct,ft,Le){return Math.abs(Math.floor(ct)-ft)<Le}function ke(ct){let ft=-Number.MAX_VALUE,Le=Number.MAX_VALUE;if(ct.values.length<2)return 0;for(let re=0;re<ct.values.length;re++){const X=ct.values[re];X>ft&&(ft=X),X<Le&&(Le=X)}return(ft-Le)/ct.values.length}function Ze(ct,ft,Le){const re=ct.theme.isDark?1:-.7;let X,le,be;if(ft.type===u.ob.ColorText)X=Le.color;else if(ft.type===u.ob.ColorBackground){const De=ft.mode??u.Wq.Gradient;if(De===u.Wq.Basic)X=(0,b.mZ)(Le.color,ct.theme.isDark),le=(0,r.A)(Le.color).toRgbString(),be=(0,r.A)(Le.color).setAlpha(1).toRgbString();else if(De===u.Wq.Gradient){const Te=(0,r.A)(Le.color).setAlpha(1).toRgbString(),we=(0,r.A)(Le.color).darken(10*re).spin(5);X=(0,b.mZ)(Le.color,ct.theme.isDark),le=`linear-gradient(120deg, ${we.toRgbString()}, ${Le.color})`,be=`linear-gradient(120deg, ${we.setAlpha(1).toRgbString()}, ${Te})`}}return{textColor:X,bgColor:le,bgHoverColor:be}}function ot(ct,ft,Le,re,X){const le=Number(ft.width??300),be=1.17,De=42;if(Le!==null&&typeof ct=="string"){const Te=ct.split(/\s/),we=[];let Ke="",Ve=0,ht=0;for(let St=0;St<Te.length;St++){const Je=Te[St];let rt=Le.measureText(Ke+" "+Je).width;rt<le?(Ke+=" "+Je,Ve++):(we.push({width:rt,line:Ke}),Ke=Je,Ve=0)}for(let St=0;St<we.length;St++)if(we[St].width>le){let Je=Math.floor(we[St].width/le)-1;ht+=Je}let gt=we.length+ht,bt=38;return gt>5?bt=gt*re*be:bt=gt*re+De,{width:le,height:bt}}return{width:le,height:X}}function xt(ct,ft){let Le;if(ct!==void 0&&ct.defaults.custom!==void 0&&ct.defaults.custom.cellOptions.wrapText){const X=ft.fields.filter(le=>le.type===i.PU.string);if(X.length>=1&&X[0].values.length>0){const le=X[0].values.length;let be=0;if(le<=30)for(const De of X){const Te=De.values[0].length;Te>be&&(be=Te,Le=De)}else for(const De of X){const Te=(0,n.sampleSize)(De.values,3),we=(Te[0]?.length+Te[1]?.length+Te[2]?.length)/3;we>be&&(be=we,Le=De)}}}return Le}},14746:(Q,I,e)=>{"use strict";e.d(I,{b:()=>h});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(72436),f=e(40845),d=e(3911),l=e(14578),m=e(21744);class s extends r.PureComponent{constructor(g){super(g),this.readCSV=(0,a.debounce)(()=>{const{config:y}=this.props,{text:p}=this.state;this.setState({data:(0,i.Jh)(p,{config:y})})},150),this.onTextChange=y=>{this.setState({text:y.target.value})};const{text:P,config:c}=g;this.state={text:P,data:(0,i.Jh)(P,{config:c})}}componentDidUpdate(g,P){const{text:c}=this.state;(c!==P.text||this.props.config!==g.config)&&this.readCSV(),this.props.text!==g.text&&this.props.text!==c&&this.setState({text:this.props.text}),this.state.data!==P.data&&this.props.onSeriesParsed(this.state.data,this.state.text)}render(){const{width:g,height:P,theme:c}=this.props,{data:y}=this.state,p=u(c);return r.createElement("div",{className:p.tableInputCsv},r.createElement(m.f,{style:{width:g,height:P},placeholder:"Enter CSV here...",value:this.state.text,onChange:this.onTextChange,className:p.textarea}),y&&r.createElement("footer",{className:p.footer},y.map((v,D)=>r.createElement("span",{key:D},"Rows:",v.length,", Columns:",v.fields.length," \xA0",r.createElement(l.I,{name:"check-circle"})))))}}const h=(0,f.cV)(s);h.displayName="TableInputCSV";const u=(0,d.N)(b=>({tableInputCsv:(0,n.css)({position:"relative"}),textarea:(0,n.css)({height:"100%",width:"100%"}),footer:(0,n.css)({position:"absolute",bottom:"15px",right:"15px",border:"1px solid #222",background:b.colors.success.main,padding:`1px ${b.spacing(.5)}`,fontSize:"80%"})}))},53402:(Q,I,e)=>{"use strict";e.d(I,{p:()=>i});var n=e(32196),a=e(96540),o=e(83195),r=e(40845);const i=({value:d})=>{const l=(0,r.of)(f);return a.createElement("span",{className:l.counter},(0,o.Hg)(d,0).text)},f=d=>({counter:(0,n.css)({label:"counter",marginLeft:d.spacing(1),borderRadius:d.spacing(3),backgroundColor:d.colors.action.hover,padding:d.spacing(.25,1),color:d.colors.text.secondary,fontWeight:d.typography.fontWeightMedium,fontSize:d.typography.size.sm})})},40675:(Q,I,e)=>{"use strict";e.d(I,{o:()=>m});var n=e(32196),a=e(96540),o=e(13544),r=e(40845),i=e(16797),f=e(55852),d=e(14578),l=e(53402);const m=a.forwardRef(({label:h,active:u,icon:b,onChangeTab:g,counter:P,suffix:c,className:y,href:p,...v},D)=>{const E=(0,r.of)(s),S=(0,r.of)(f.my),T=()=>a.createElement(a.Fragment,null,b&&a.createElement(d.I,{name:b}),h,typeof P=="number"&&a.createElement(l.p,{value:P}),c&&a.createElement(c,{className:E.suffix})),A={className:(0,n.cx)(S,E.link,u?E.activeStyle:E.notActive),...v,onClick:g,"aria-label":v["aria-label"]||o.Tp.components.Tab.title(h),role:"tab","aria-selected":u};return p?a.createElement("div",{className:E.item},a.createElement("a",{...A,href:p,ref:D},T())):a.createElement("div",{className:E.item},a.createElement("button",{...A,type:"button",ref:D},T()))});m.displayName="Tab";const s=h=>({item:(0,n.css)({listStyle:"none",position:"relative",display:"flex",whiteSpace:"nowrap",padding:h.spacing(.5)}),link:(0,n.css)({color:h.colors.text.secondary,padding:h.spacing(1,1.5,.5),borderRadius:h.shape.radius.default,display:"block",height:"100%",svg:{marginRight:h.spacing(1)},"&:focus-visible":(0,i.getFocusStyles)(h),"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"4px",borderRadius:h.shape.radius.default,bottom:0}}),notActive:(0,n.css)({"a:hover, &:hover, &:focus":{color:h.colors.text.primary,"&::before":{backgroundColor:h.colors.action.hover}}}),activeStyle:(0,n.css)({label:"activeTabStyle",color:h.colors.text.primary,overflow:"hidden","&::before":{backgroundImage:h.colors.gradients.brandHorizontal}}),suffix:(0,n.css)({marginLeft:h.spacing(1)})})},40980:(Q,I,e)=>{"use strict";e.d(I,{J:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=({children:f,className:d,...l})=>{const m=(0,o.of)(i);return a.createElement("div",{...l,className:(0,n.cx)(m.tabContent,d)},f)},i=f=>({tabContent:(0,n.css)({background:f.colors.background.primary})})},63021:(Q,I,e)=>{"use strict";e.d(I,{U:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=a.forwardRef(({children:f,className:d,hideBorder:l=!1},m)=>{const s=(0,o.of)(i);return a.createElement("div",{className:(0,n.cx)(s.tabsWrapper,l&&s.noBorder,d),ref:m},a.createElement("div",{className:s.tabs,role:"tablist"},f))}),i=f=>({tabsWrapper:(0,n.css)({borderBottom:`1px solid ${f.colors.border.weak}`,overflowX:"auto"}),noBorder:(0,n.css)({borderBottom:0}),tabs:(0,n.css)({position:"relative",display:"flex",height:`${f.components.menuTabs.height}px`,alignItems:"center"})});r.displayName="TabsBar"},90685:(Q,I,e)=>{"use strict";e.d(I,{s:()=>d});var n=e(32196),a=e(96540),o=e(13544),r=e(40845),i=e(14578),f=e(53402);const d=a.forwardRef(({label:m,active:s,icon:h,counter:u,className:b,suffix:g,onChangeTab:P,href:c,...y},p)=>{const v=(0,r.of)(l),D=()=>a.createElement(a.Fragment,null,h&&a.createElement(i.I,{name:h}),m,typeof u=="number"&&a.createElement(f.p,{value:u}),g&&a.createElement(g,{className:v.suffix})),E=(0,n.cx)(v.link,s&&v.activeStyle);return a.createElement("a",{href:c,className:E,...y,onClick:P,"aria-label":y["aria-label"]||o.Tp.components.Tab.title(m),role:"tab","aria-selected":s,ref:p},D())});d.displayName="Tab";const l=m=>({link:(0,n.css)({padding:"6px 12px",display:"block",height:"100%",cursor:"pointer",position:"relative",color:m.colors.text.primary,svg:{marginRight:m.spacing(1)},"&:hover, &:focus":{textDecoration:"underline"}}),activeStyle:(0,n.css)({label:"activeTabStyle",color:m.colors.text.maxContrast,overflow:"hidden","&::before":{display:"block",content:'" "',position:"absolute",left:0,width:"4px",bottom:"2px",top:"2px",borderRadius:m.shape.radius.default,backgroundImage:"linear-gradient(0deg, #f05a28 30%, #fbca0a 99%)"}}),suffix:(0,n.css)({marginLeft:m.spacing(1)})})},78369:(Q,I,e)=>{"use strict";e.d(I,{v:()=>s});var n=e(32196),a=e(96540),o=e(70255),r=e(40845),i=e(69613),f=e(72129),d=e(14578);const l=(0,a.forwardRef)(({name:b,onClick:g,icon:P,className:c,colorIndex:y,...p},v)=>{const D=(0,r.$j)(),E=u(D,b,y),S=M=>{M.preventDefault(),M.stopPropagation(),g?.(b,M)},T=(0,n.cx)(E.wrapper,c,{[E.hover]:g!==void 0});return g?a.createElement("button",{...p,className:T,onClick:S,ref:v},P&&a.createElement(d.I,{name:P}),b):a.createElement("span",{...p,className:T,ref:v},P&&a.createElement(d.I,{name:P}),b)});l.displayName="Tag";const m=({rootProps:b})=>{const g=(0,r.of)(h);return a.createElement(o.A,{width:60,height:22,containerClassName:g.container,...b})},s=(0,f.j)(l,m),h=()=>({container:(0,n.css)({lineHeight:1})}),u=(b,g,P)=>{let c;return P===void 0?c=(0,i.MC)(g):c=(0,i.yC)(P),{wrapper:(0,n.css)({appearance:"none",borderStyle:"none",fontWeight:b.typography.fontWeightMedium,fontSize:b.typography.size.sm,lineHeight:b.typography.bodySmall.lineHeight,verticalAlign:"baseline",backgroundColor:c.color,color:b.v1.palette.gray98,whiteSpace:"nowrap",textShadow:"none",padding:"3px 6px",borderRadius:b.shape.radius.default}),hover:(0,n.css)({"&:hover":{opacity:.85,cursor:"pointer"}})}}},64149:(Q,I,e)=>{"use strict";e.d(I,{L:()=>l});var n=e(32196),a=e(96540),o=e(40845),r=e(72129),i=e(78369);const f=(0,a.memo)((0,a.forwardRef)(({displayMax:h,tags:u,icon:b,onClick:g,className:P,getAriaLabel:c,getColorIndex:y},p)=>{const v=(0,o.$j)(),D=s(v,!!(h&&h>0)),E=u.length,S=h?u.slice(0,h):u;return a.createElement("ul",{className:(0,n.cx)(D.wrapper,P),"aria-label":"Tags",ref:p},S.map((T,M)=>a.createElement("li",{className:D.li,key:T},a.createElement(i.v,{name:T,icon:b,onClick:g,"aria-label":c?.(T,M),"data-tag-id":M,colorIndex:y?.(T,M)}))),h&&h>0&&E-h>0&&a.createElement("span",{className:D.moreTagsLabel},"+ ",E-h))}));f.displayName="TagList";const d=({rootProps:h})=>{const u=(0,o.of)(m);return a.createElement("div",{className:u.container,...h},a.createElement(i.v.Skeleton,null),a.createElement(i.v.Skeleton,null))},l=(0,r.j)(f,d),m=h=>({container:(0,n.css)({display:"flex",gap:h.spacing(1)})}),s=(h,u)=>({wrapper:(0,n.css)({position:"relative",alignItems:u?"center":"unset",display:"flex",flex:"1 1 auto",flexWrap:"wrap",flexShrink:u?0:1,justifyContent:"flex-end",gap:"6px"}),moreTagsLabel:(0,n.css)({color:h.colors.text.secondary,fontSize:h.typography.size.sm}),li:(0,n.css)({listStyle:"none"})})},79924:(Q,I,e)=>{"use strict";e.d(I,{u:()=>s});var n=e(32196),a=e(96540),o=e(40845),r=e(55852),i=e(10354),f=e(69613),d=e(29158);const l=({name:u,disabled:b,onRemove:g})=>{const{color:P,borderColor:c}=(0,a.useMemo)(()=>(0,f.MC)(u),[u]),y=(0,o.of)(m);return a.createElement("li",{className:y.itemStyle,style:{backgroundColor:P,borderColor:c}},a.createElement("span",{className:y.nameStyle},u),a.createElement(d.K,{name:"times",size:"lg",disabled:b,tooltip:`Remove "${u}" tag`,onClick:()=>g(u),className:y.buttonStyles}))},m=u=>{const b=u.spacing.gridSize*3;return{itemStyle:(0,n.css)({display:"flex",gap:"3px",alignItems:"center",height:`${b}px`,lineHeight:`${b-2}px`,color:"#fff",borderWidth:"1px",borderStyle:"solid",borderRadius:u.shape.radius.default,padding:`0 ${u.spacing(.5)}`,whiteSpace:"nowrap",textShadow:"none",fontWeight:500,fontSize:u.typography.size.sm}),nameStyle:(0,n.css)({maxWidth:"25ch",textOverflow:"ellipsis",overflow:"hidden"}),buttonStyles:(0,n.css)({margin:0,"&:hover::before":{display:"none"}})}},s=({placeholder:u="New tag (enter key to add)",tags:b=[],onChange:g,width:P,className:c,disabled:y,addOnBlur:p,invalid:v,id:D})=>{const[E,S]=(0,a.useState)(""),T=(0,o.of)(h),M=(0,o.$j)(),A=(0,a.useCallback)(L=>{S(L.target.value)},[]),x=L=>{g(b.filter(N=>N!==L))},C=L=>{L?.preventDefault(),b.includes(E)||g(b.concat(E)),S("")},O=()=>{p&&E&&C()},R=L=>{L.key==="Enter"&&E!==""&&C(L)};return a.createElement("div",{className:(0,n.cx)(T.wrapper,c,P?(0,n.css)({width:M.spacing(P)}):"")},a.createElement(i.p,{id:D,disabled:y,placeholder:u,onChange:A,value:E,onKeyDown:R,onBlur:O,invalid:v,suffix:a.createElement(r.$n,{fill:"text",className:T.addButtonStyle,onClick:C,size:"md",disabled:E.length<=0},"Add")}),b?.length>0&&a.createElement("ul",{className:T.tags},b.map(L=>a.createElement(l,{key:L,name:L,onRemove:x,disabled:y}))))},h=u=>({wrapper:(0,n.css)({minHeight:u.spacing(4),display:"flex",flexDirection:"column",gap:u.spacing(1),flexWrap:"wrap"}),tags:(0,n.css)({display:"flex",justifyContent:"flex-start",flexWrap:"wrap",gap:u.spacing(.5)}),addButtonStyle:(0,n.css)({margin:`0 -${u.spacing(1)}`})})},94753:(Q,I,e)=>{"use strict";e.d(I,{E:()=>l});var n=e(32196),a=e(96540),o=e(40845),r=e(65848),i=e(56034);const f=a.forwardRef(({childElement:s,children:h},u)=>{const[b,g]=(0,a.useState)(!1),P=(0,a.useRef)(null);(0,a.useImperativeHandle)(u,()=>P.current);const c=(0,a.useMemo)(()=>new ResizeObserver(p=>{for(const v of p)v.target.clientWidth&&v.target.scrollWidth&&(v.target.scrollWidth>v.target.clientWidth&&g(!0),v.target.scrollWidth<=v.target.clientWidth&&g(!1))}),[]);(0,a.useEffect)(()=>{const{current:p}=P;return p&&c.observe(p),()=>{c.disconnect()}},[g,c]);const y=p=>typeof p=="string"?p:r.renderToStaticMarkup(a.createElement(a.Fragment,null,p)).replace(/(<([^>]+)>)/gi,"");return b?a.createElement(i.m,{ref:P,content:y(h)},s(void 0)):s(P)});f.displayName="TruncatedText";var d=e(71356);const l=a.forwardRef(({element:s="span",variant:h,weight:u,color:b,truncate:g,italic:P,textAlignment:c,children:y,tabular:p,...v},D)=>{const E=(0,o.of)(m,s,h,b,u,g,P,c,p),S=T=>(0,a.createElement)(s,{...v,style:void 0,className:E,ref:T},y);return!g||s==="span"?S(void 0):a.createElement(f,{childElement:S,children:y,ref:D})});l.displayName="Text";const m=(s,h,u,b,g,P,c,y,p)=>(0,n.css)([{margin:0,padding:0,...(0,d.d$)(s,h,u)},u&&{...s.typography[u]},b&&{color:(0,d.vT)(b,s)},g&&{fontWeight:(0,d.iV)(g,s)},P&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},c&&{fontStyle:"italic"},y&&{textAlign:y},p&&{fontFeatureSettings:'"tnum"'}])},71356:(Q,I,e)=>{"use strict";e.d(I,{d$:()=>o,iV:()=>n,vT:()=>a});const n=(r,i)=>{switch(r){case"bold":return i.typography.fontWeightBold;case"medium":return i.typography.fontWeightMedium;case"light":return i.typography.fontWeightLight;case"regular":case void 0:return i.typography.fontWeightRegular}},a=(r,i)=>{switch(r){case"error":return i.colors.error.text;case"success":return i.colors.success.text;case"info":return i.colors.info.text;case"warning":return i.colors.warning.text;default:return r?i.colors.text[r]:void 0}},o=(r,i,f)=>{if(f)return r.typography[f];switch(i){case"span":return;case"h1":return r.typography.h1;case"h2":return r.typography.h2;case"h3":return r.typography.h3;case"h4":return r.typography.h4;case"h5":return r.typography.h5;case"h6":return r.typography.h6;default:return r.typography.body}}},21744:(Q,I,e)=>{"use strict";e.d(I,{f:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(87266);const i=a.forwardRef(({invalid:d,className:l,...m},s)=>{const h=(0,o.of)(f,d);return a.createElement("textarea",{...m,className:(0,n.cx)(h.textarea,l),ref:s})}),f=(d,l=!1)=>({textarea:(0,n.cx)((0,r.Xb)(d),(0,r.gm)(d),(0,n.css)({display:"block",borderRadius:d.shape.radius.default,padding:`${d.spacing.gridSize/4}px ${d.spacing.gridSize}px`,width:"100%",borderColor:l?d.colors.error.border:d.components.input.borderColor}))});i.displayName="TextArea"},60782:(Q,I,e)=>{"use strict";e.d(I,{G:()=>m});var n=e(32196),a=e(34743),o=e(36376),r=e(7315),i=e(96540),f=e(40845),d=e(18976),l=e(29158);const m=i.memo(({children:h,theme:u="info",placement:b="auto",content:g,title:P,closeButton:c=!0,onClose:y,footer:p,fitContent:v=!1,onOpen:D,show:E})=>{const S=(0,i.useRef)(null),T=(0,f.$j)(),M=(0,f.of)(s),A=M[u],[x,C]=(0,i.useState)(E),O=E??x,R=[(0,a.cY)(8),(0,a.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,a.BN)(),(0,a.UE)({element:S})],{context:L,refs:N,floatingStyles:F}=(0,o.we)({open:O,placement:(0,d.O)(b),onOpenChange:W=>{E===void 0&&C(W),W?D?.():y?.()},middleware:R,whileElementsMounted:r.ll,strategy:"fixed"}),K=(0,o.kp)(L),B=(0,o.s9)(L),{getReferenceProps:w,getFloatingProps:U}=(0,o.bv)([B,K]);return i.createElement(i.Fragment,null,i.cloneElement(h,{ref:N.setReference,tabIndex:0,"aria-expanded":O,...w()}),O&&i.createElement(o.s3,{context:L,modal:!1,closeOnFocusOut:!1},i.createElement("div",{"data-testid":"toggletip-content",className:(0,n.cx)(A.container,{[M.fitContent]:v}),ref:N.setFloating,style:F,...U()},i.createElement(o.ie,{strokeWidth:.3,stroke:T.colors.border.weak,className:A.arrow,ref:S,context:L}),!!P&&i.createElement("div",{className:A.header},P),c&&i.createElement("div",{className:A.headerClose},i.createElement(l.K,{"aria-label":"Close",name:"times","data-testid":"toggletip-header-close",onClick:()=>{C(!1),y?.()}})),i.createElement("div",{className:A.body},(typeof g=="string"||i.isValidElement(g))&&g,typeof g=="function"&&g({})),!!p&&i.createElement("div",{className:A.footer},p))))});m.displayName="Toggletip";const s=h=>{const u=(0,d.f)(h,h.colors.background.primary,h.colors.border.weak,h.components.tooltip.text,{topBottom:2,rightLeft:2}),b=(0,d.f)(h,h.colors.error.main,h.colors.error.main,h.colors.error.contrastText,{topBottom:2,rightLeft:2});return{info:u,error:b,fitContent:(0,n.css)({maxWidth:"fit-content"})}}},27746:(Q,I,e)=>{"use strict";e.d(I,{I:()=>s});var n=e(32196),a=e(96540),o=e(8887),r=e(13544),i=e(40845),f=e(16797),d=e(55852),l=e(14578),m=e(56034);const s=(0,a.forwardRef)(({tooltip:g,icon:P,iconSize:c,className:y,children:p,imgSrc:v,imgAlt:D,fullWidth:E,isOpen:S,narrow:T,variant:M="default",iconOnly:A,"aria-label":x,isHighlighted:C,...O},R)=>{const L=(0,i.of)(b),N=(0,n.cx)({[L.button]:!0,[L.buttonFullWidth]:E,[L.narrow]:T},L[M],y),F=(0,n.cx)({[L.content]:!0,[L.contentWithIcon]:!!P,[L.contentWithRightIcon]:S!==void 0}),K=a.createElement("button",{ref:R,className:N,"aria-label":h(x,g),"aria-expanded":S,...O},u(P,c),v&&a.createElement("img",{className:L.img,src:v,alt:D??""}),p&&!A&&a.createElement("div",{className:F},p),S===!1&&a.createElement(l.I,{name:"angle-down"}),S===!0&&a.createElement(l.I,{name:"angle-up"}),C&&a.createElement("div",{className:L.highlight}));return g?a.createElement(m.m,{ref:R,content:g,placement:"bottom"},K):K});s.displayName="ToolbarButton";function h(g,P){return g||(P?r.Tp.components.PageToolbar.item(P):void 0)}function u(g,P){return g?(0,o.n6)(g)?a.createElement(l.I,{name:g,size:`${P||"lg"}`}):g:null}const b=g=>{const P=(0,d.U_)(g,"primary","solid"),c=(0,d.U_)(g,"destructive","solid"),y=(0,n.css)({color:g.colors.text.primary,background:g.colors.secondary.main,"&:hover":{color:g.colors.text.primary,background:g.colors.secondary.shade,border:`1px solid ${g.colors.border.medium}`}});return{button:(0,n.css)({label:"toolbar-button",position:"relative",display:"flex",alignItems:"center",height:g.spacing(g.components.height.md),padding:g.spacing(0,1),borderRadius:g.shape.radius.default,lineHeight:`${g.components.height.md*g.spacing.gridSize-2}px`,fontWeight:g.typography.fontWeightMedium,border:`1px solid ${g.colors.secondary.border}`,whiteSpace:"nowrap",[g.transitions.handleMotion("no-preference","reduce")]:{transition:g.transitions.create(["background","box-shadow","border-color","color"],{duration:g.transitions.duration.short})},"&:focus, &:focus-visible":{...(0,f.getFocusStyles)(g),zIndex:1},"&:focus:not(:focus-visible)":(0,f.getMouseFocusStyles)(g),"&:hover":{boxShadow:g.shadows.z1},"&[disabled], &:disabled":{cursor:"not-allowed",opacity:g.colors.action.disabledOpacity,background:g.colors.action.disabledBackground,boxShadow:"none","&:hover":{color:g.colors.text.disabled,background:g.colors.action.disabledBackground,boxShadow:"none"}}}),default:(0,n.css)({color:g.colors.text.secondary,background:"transparent",border:"1px solid transparent","&:hover":{color:g.colors.text.primary,background:g.colors.background.secondary}}),canvas:y,active:(0,n.cx)(y,(0,n.css)({"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"2px",bottom:0,borderRadius:g.shape.radius.default,backgroundImage:g.colors.gradients.brandHorizontal}})),primary:(0,n.css)(P),destructive:(0,n.css)(c),narrow:(0,n.css)({padding:g.spacing(0,.5)}),img:(0,n.css)({width:"16px",height:"16px",marginRight:g.spacing(1)}),buttonFullWidth:(0,n.css)({flexGrow:1}),content:(0,n.css)({flexGrow:1}),contentWithIcon:(0,n.css)({display:"none",paddingLeft:g.spacing(1),[`@media ${f.mediaUp(g.v1.breakpoints.md)}`]:{display:"block"}}),contentWithRightIcon:(0,n.css)({paddingRight:g.spacing(.5)}),highlight:(0,n.css)({backgroundColor:g.colors.success.main,borderRadius:g.shape.radius.circle,width:"6px",height:"6px",position:"absolute",top:"-3px",right:"-3px",zIndex:1})}}},15068:(Q,I,e)=>{"use strict";e.d(I,{U:()=>m});var n=e(32196),a=e(18828),o=e(85690),r=e(93225),i=e(96540),f=e(40845),d=e(17464),l=e(27746);const m=(0,i.forwardRef)(({alignment:h="left",className:u,children:b,...g},P)=>{const c=i.Children.toArray(b).filter(R=>R!=null),[y,p]=(0,i.useState)(Array(c.length).fill(!1)),v=(0,i.useRef)(null),[D,E]=(0,i.useState)(!1),S=(0,i.useRef)(null),T=(0,i.createRef)(),{overlayProps:M}=(0,r.e)({onClose:()=>E(!1),isDismissable:!0,isOpen:D,shouldCloseOnInteractOutside:R=>{const L=(0,d.gF)();return!S.current?.contains(R)&&!L.contains(R)}},T),{dialogProps:A}=(0,a.s)({},T),x=(0,f.$j)(),C=h==="left"?y.indexOf(!1)-1:y.length,O=s(x,C,h);return(0,i.useLayoutEffect)(()=>{const R=new IntersectionObserver(L=>{L.forEach(N=>{if(N.target instanceof HTMLElement&&N.target.parentNode){const F=Array.prototype.indexOf.call(N.target.parentNode.children,N.target);p(K=>{const B=[...K];return B[F]=N.isIntersecting,B})}})},{threshold:1,root:v.current});return v.current&&Array.from(v.current.children).forEach(L=>{L instanceof HTMLElement&&L!==S.current&&R.observe(L)}),()=>R.disconnect()},[b]),i.createElement("div",{ref:v,className:(0,n.cx)(O.container,u),...g},c.map((R,L)=>i.createElement("div",{key:L,style:{order:L,visibility:y[L]?"visible":"hidden"},className:O.childWrapper},R)),y.includes(!1)&&i.createElement("div",{ref:S,className:O.overflowButton},i.createElement(l.I,{variant:D?"active":"default",tooltip:"Show more items",onClick:()=>E(!D),icon:"ellipsis-v",iconOnly:!0,narrow:!0}),D&&i.createElement(o.n1,{contain:!0,autoFocus:!0},i.createElement("div",{className:O.overflowItems,ref:T,...M,...A},c.map((R,L)=>!y[L]&&R)))))});m.displayName="ToolbarButtonRow";const s=(h,u,b)=>({overflowButton:(0,n.css)({order:u}),overflowItems:(0,n.css)({alignItems:"center",backgroundColor:h.colors.background.primary,borderRadius:h.shape.radius.default,boxShadow:h.shadows.z2,display:"flex",flexWrap:"wrap",gap:h.spacing(1),marginTop:h.spacing(1),maxWidth:"80vw",padding:h.spacing(.5,1),position:"absolute",right:0,top:"100%",width:"max-content",zIndex:h.zIndex.dropdown}),container:(0,n.css)({alignItems:"center",display:"flex",gap:h.spacing(1),justifyContent:b==="left"?"flex-start":"flex-end",minWidth:0,position:"relative"}),childWrapper:(0,n.css)({alignItems:"center",display:"flex",gap:h.spacing(1)})})},13840:(Q,I,e)=>{"use strict";e.d(I,{A:()=>l});var n=e(34743),a=e(36376),o=e(7315),r=e(96540),i=e(40845),f=e(18976),d=e(17464);function l({content:m,show:s,placement:h,className:u,wrapperClassName:b,referenceElement:g,renderArrow:P,...c}){const y=(0,i.$j)(),p=(0,r.useRef)(null),v=[(0,n.cY)(8),(0,n.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,n.BN)()];P&&v.push((0,n.UE)({element:p}));const{context:D,refs:E,floatingStyles:S}=(0,a.we)({open:s,placement:(0,f.O)(h),middleware:v,whileElementsMounted:o.ll,strategy:"fixed"});(0,r.useLayoutEffect)(()=>{E.setReference(g)},[g,E]);const{styles:T}=(0,a.DL)(D,{initial:()=>({opacity:0}),duration:y.transitions.duration.enteringScreen});return s?r.createElement(d.ZL,null,r.createElement("div",{ref:E.setFloating,style:{...S,...T},className:b,...c},r.createElement("div",{className:u},P&&r.createElement(a.ie,{fill:y.colors.border.weak,ref:p,context:D}),typeof m=="string"&&m,r.isValidElement(m)&&r.cloneElement(m),typeof m=="function"&&m({})))):void 0}},95868:(Q,I,e)=>{"use strict";e.d(I,{I:()=>a});var n=e(96540);class a extends n.Component{constructor(){super(...arguments),this.hideTimeout=null,this.state={show:!1},this.showPopper=()=>{this.hideTimeout&&clearTimeout(this.hideTimeout),this.setState({show:!0})},this.hidePopper=()=>{this.hideTimeout=setTimeout(()=>{this.setState({show:!1})},this.props.hideAfter)}}render(){const{children:r,content:i,placement:f="auto"}=this.props,{show:d}=this.state;return r(this.showPopper,this.hidePopper,{show:d,placement:f,content:i})}}},56034:(Q,I,e)=>{"use strict";e.d(I,{m:()=>m});var n=e(34743),a=e(36376),o=e(7315),r=e(96540),i=e(13544),f=e(40845),d=e(18976),l=e(17464);const m=r.forwardRef(({children:h,theme:u,interactive:b,show:g,placement:P,content:c},y)=>{const p=(0,r.useRef)(null),[v,D]=(0,r.useState)(g),E=g??v,S=[(0,n.cY)(8),(0,n.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,n.BN)(),(0,n.UE)({element:p})],{context:T,refs:M,floatingStyles:A}=(0,a.we)({open:E,placement:(0,d.O)(P),onOpenChange:D,middleware:S,whileElementsMounted:o.ll}),x=(0,r.useId)(),C=(0,a.Mk)(T,{delay:{close:b?100:0},move:!1}),O=(0,a.iQ)(T),R=(0,a.s9)(T),{getReferenceProps:L,getFloatingProps:N}=(0,a.bv)([R,C,O]),F=typeof c=="function",B=(0,f.of)(s)[u??"info"],w=(0,r.useCallback)(W=>{M.setReference(W),typeof y=="function"?y(W):y&&(y.current=W)},[y,M]),U="aria-label"in h.props&&h.props["aria-label"]===c;return r.createElement(r.Fragment,null,r.cloneElement(h,{ref:w,tabIndex:0,"aria-describedby":!U&&E?x:void 0,...L()}),E&&r.createElement(l.ZL,null,r.createElement("div",{ref:M.setFloating,style:A,...N()},r.createElement(a.ie,{className:B.arrow,ref:p,context:T}),r.createElement("div",{"data-testid":i.Tp.components.Tooltip.container,id:x,role:"tooltip",className:B.container},typeof c=="string"&&c,r.isValidElement(c)&&r.cloneElement(c),F&&c({})))))});m.displayName="Tooltip";const s=h=>{const u=(0,d.f)(h,h.components.tooltip.background,h.components.tooltip.background,h.components.tooltip.text,{topBottom:.5,rightLeft:1}),b=(0,d.f)(h,h.colors.error.main,h.colors.error.main,h.colors.error.contrastText,{topBottom:.5,rightLeft:1});return{info:u,"info-alt":u,error:b}}},5313:(Q,I,e)=>{"use strict";e.d(I,{z:()=>o});var n=e(96540);function a(r,i){const f=[];return r.forEach(d=>{f.push(d.start,d.end+1)}),f[0]!==0&&f.unshift(0),f[f.length-1]!==i&&f.push(i),f}const o=r=>{let{highlightParts:i,text:f,highlightClassName:d}=r;if(!i?.length)return null;let l=[],m=a(i,f.length),s=i[0].start===0;for(let h=1;h<m.length;h++){let u=m[h-1],b=m[h];l.push((0,n.createElement)(s?"mark":"span",{key:h-1,className:s?d:void 0},f.substring(u,b))),s=!s}return n.createElement("div",null,l)}},2056:(Q,I,e)=>{"use strict";e.d(I,{p:()=>i});var n=e(96540),a=e(83195),o=e(3988);function r(f){return`Custom unit: ${f}`}class i extends n.PureComponent{constructor(){super(...arguments),this.onChange=d=>{this.props.onChange(d.value)}}render(){const{value:d,width:l}=this.props;let m;const h=(0,a.Ke)().map(u=>{const b=u.submenu.map(g=>{const P={label:g.text,value:g.value};return g.value===d&&(m=P),P});return{label:u.text,value:u.text,items:b}});return d&&!m&&(m={value:d,label:d}),n.createElement(o.v,{width:l,initialValue:m&&m.label,allowCustomValue:!0,changeOnSelect:!1,formatCreateLabel:r,options:h,placeholder:"Choose",isClearable:!0,onSelect:this.props.onChange})}}},12942:(Q,I,e)=>{"use strict";e.d(I,{e:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(16795);const i=({src:d,alt:l,width:m,height:s})=>{const h=(0,o.of)(f,m,s);return a.createElement("img",{className:h.image,src:d,alt:l})},f=(d,l=3,m=3)=>({image:(0,n.css)([(0,r.Y)(d,l,s=>({width:d.spacing(s)})),(0,r.Y)(d,m,s=>({height:d.spacing(s)})),{borderRadius:d.shape.radius.circle}])})},99635:(Q,I,e)=>{"use strict";e.d(I,{n:()=>l});var n=e(32196),a=e(96540),o=e(47232),r=e(40845),i=e(56034);const f=h=>{const b=(0,o.KQ)(h).diff((0,o.KQ)(),"hours",!1);return`Active last ${(Math.floor(-b/24)+1)*24}h`},d=h=>{if(!h)return"";const[u,b]=h.split(" ");return`${u?.[0]??""}${b?.[0]??""}`.toUpperCase()},l=({userView:h,className:u,children:b,onClick:g,showTooltip:P=!0})=>{const{user:c,lastActiveAt:y}=h,p=(0,o.KQ)(y).diff((0,o.KQ)(),"minutes",!0)>=-15,v=(0,r.$j)(),D=(0,a.useMemo)(()=>s(v,p),[v,p]),E=a.createElement("button",{type:"button",onClick:g,className:(0,n.cx)(D.container,g&&D.pointer,u),"aria-label":`${c.name} icon`},b?a.createElement("div",{className:(0,n.cx)(D.content,D.textContent)},b):c.avatarUrl?a.createElement("img",{className:D.content,src:c.avatarUrl,alt:`${c.name} avatar`}):a.createElement("div",{className:(0,n.cx)(D.content,D.textContent)},d(c.name)));if(P){const S=a.createElement("div",{className:D.tooltipContainer},a.createElement("div",{className:D.tooltipName},c.name),a.createElement("div",{className:D.tooltipDate},p?a.createElement("div",{className:D.dotContainer},a.createElement("span",null,"Active last 15m"),a.createElement("span",{className:D.dot})):f(y)));return a.createElement(i.m,{content:S},E)}else return E},m=h=>`0 0 0 1px ${h}`,s=(h,u)=>{const b=u?h.colors.primary.main:h.colors.border.medium,g=u?h.colors.primary.text:h.colors.border.strong;return{container:(0,n.css)({padding:0,width:"30px",height:"30px",background:"none",border:"none",borderRadius:h.shape.radius.circle,"& > *":{borderRadius:h.shape.radius.circle}}),content:(0,n.css)({lineHeight:"24px",maxWidth:"100%",border:`3px ${h.colors.background.primary} solid`,boxShadow:m(b),backgroundClip:"padding-box","&:hover":{boxShadow:m(g)}}),textContent:(0,n.css)({background:h.colors.background.primary,padding:0,color:h.colors.text.secondary,textAlign:"center",fontSize:h.typography.size.sm,"&:focus":{boxShadow:m(b)}}),tooltipContainer:(0,n.css)({textAlign:"center",padding:h.spacing(0,1)}),tooltipName:(0,n.css)({fontWeight:h.typography.fontWeightBold}),tooltipDate:(0,n.css)({fontWeight:h.typography.fontWeightRegular}),dotContainer:(0,n.css)({display:"flex",alignItems:"center"}),dot:(0,n.css)({height:"6px",width:"6px",backgroundColor:h.colors.primary.main,borderRadius:h.shape.radius.circle,display:"inline-block",marginLeft:h.spacing(1)}),pointer:(0,n.css)({cursor:"pointer"})}}},51986:(Q,I,e)=>{"use strict";e.d(I,{i:()=>f});var n=e(96540),a=e(13544),o=e(40845),r=e(55852),i=e(21594);function f({"aria-label":d,label:l,icon:m,options:s,onChange:h,variant:u,minWidth:b=16,size:g="sm",isFullWidth:P=!0,menuPlacement:c,fill:y,buttonCss:p}){const[v,D]=(0,n.useState)(!1),E=(0,o.$j)();return n.createElement(n.Fragment,null,!v&&n.createElement(r.$n,{size:g||"sm",className:p,icon:m||"plus",onClick:()=>D(!0),variant:u,fill:y,fullWidth:P,"data-testid":a.Tp.components.ValuePicker.button(d??l)},l),v&&n.createElement("span",{style:{minWidth:E.spacing(b),flexGrow:P?1:void 0}},n.createElement(i.l6,{placeholder:l,options:s,"aria-label":a.Tp.components.ValuePicker.select(d??l),isOpen:!0,onCloseMenu:()=>D(!1),autoFocus:!0,onChange:S=>{D(!1),h(S)},menuPlacement:c})))}},67266:(Q,I,e)=>{"use strict";e.d(I,{KU:()=>d});var n=e(32196),a=e(96540),o=e(49185),r=e(40845),i=e(16797),f=e(40276);const d=({width:s,height:h,legend:u,children:b})=>{const g=(0,r.$j)(),P=(0,r.of)(l),c={display:"flex",width:`${s}px`,height:`${h}px`},[y,p]=(0,o.A)();if(!u)return a.createElement(a.Fragment,null,a.createElement("div",{style:c,className:P.viz},b(s,h)));let{placement:v,maxHeight:D="35%",maxWidth:E="60%"}=u.props;document.body.clientWidth<g.breakpoints.values.lg&&(v="bottom");let S=null;const T={};switch(v){case"bottom":c.flexDirection="column",T.maxHeight=D,p.height&&(S={width:s,height:h-p.height});break;case"right":c.flexDirection="row",T.maxWidth=E,p.width&&(S={width:s-p.width,height:h}),u.props.width&&(T.width=u.props.width,S={width:s-u.props.width,height:h});break}return S?.width===0&&(S.width=s),S?.height===0&&(S.height=h),a.createElement("div",{style:c},a.createElement("div",{className:P.viz},S&&b(S.width,S.height)),a.createElement("div",{style:T,ref:y},a.createElement(f.E,{hideHorizontalTrack:!0},u)))},l=s=>({viz:(0,n.css)({flexGrow:2,borderRadius:s.shape.radius.default,"&:focus-visible":(0,i.getFocusStyles)(s)})}),m=({children:s})=>a.createElement(a.Fragment,null,s);d.Legend=m},94536:(Q,I,e)=>{"use strict";e.d(I,{p:()=>i});var n=e(32196),a=e(96540),o=e(8066),r=e(40845);const i=a.memo(a.forwardRef(({color:d,className:l,gradient:m,lineStyle:s,...h},u)=>{const b=(0,r.$j)(),g=(0,r.of)(f);let P;if(m){const y=o.uf.get(m).getColors?.(b);y?.length?P=`linear-gradient(90deg, ${y.join(", ")})`:P=b.visualization.getColorByName("")}else P=d;let c;return s?.fill==="dot"&&!m?c={backgroundImage:`radial-gradient(circle at 2px 2px, ${d} 2px, transparent 0)`,backgroundSize:"4px 4px",backgroundRepeat:"space"}:s?.fill==="dash"&&!m?c={backgroundImage:`linear-gradient(to right, ${d} 100%, transparent 0%)`,backgroundSize:"6px 4px",backgroundRepeat:"space"}:c={background:P,borderRadius:b.shape.radius.pill},a.createElement("div",{"data-testid":"series-icon",ref:u,className:(0,n.cx)(l,g.forcedColors,g.container),style:c,...h})})),f=d=>({container:(0,n.css)({marginRight:"8px",display:"inline-block",width:"14px",height:"4px"}),forcedColors:(0,n.css)({"@media (forced-colors: active)":{forcedColorAdjust:"none"}})});i.displayName="SeriesIcon"},96516:(Q,I,e)=>{"use strict";e.d(I,{t:()=>A});var n=e(96540),a=e(69129),o=e(52622),r=e(79041),i=e(88895),f=e(32196),d=e(40845),l=e(1551),m=e(33552),s=e(34375);const h=({items:x,itemRenderer:C,onLabelMouseOver:O,onLabelMouseOut:R,onLabelClick:L,placement:N,className:F,readonly:K})=>{const B=(0,d.of)(u);C||(C=U=>n.createElement(s.M,{item:U,onLabelClick:L,onLabelMouseOver:O,onLabelMouseOut:R,readonly:K}));const w=U=>`${U.getItemKey?U.getItemKey():U.label}`;switch(N){case"right":{const U=(W,V)=>n.createElement("span",{className:B.itemRight},C(W,V));return n.createElement("div",{className:(0,f.cx)(B.rightWrapper,F)},n.createElement(m.B,{items:x,renderItem:U,getItemKey:w}))}case"bottom":default:{const U=x.filter(_=>_.yAxis===1),W=x.filter(_=>_.yAxis!==1),V=(_,H)=>n.createElement("span",{className:B.itemBottom},C(_,H));return n.createElement("div",{className:(0,f.cx)(B.bottomWrapper,F)},U.length>0&&n.createElement("div",{className:B.section},n.createElement(l.c,{items:U,renderItem:V,getItemKey:w})),W.length>0&&n.createElement("div",{className:(0,f.cx)(B.section,B.sectionRight)},n.createElement(l.c,{items:W,renderItem:V,getItemKey:w})))}}};h.displayName="VizLegendList";const u=x=>{const C=(0,f.css)({paddingRight:"10px",display:"flex",fontSize:x.typography.bodySmall.fontSize,whiteSpace:"nowrap"});return{itemBottom:C,itemRight:(0,f.cx)(C,(0,f.css)({marginBottom:x.spacing(.5)})),rightWrapper:(0,f.css)({paddingLeft:x.spacing(.5)}),bottomWrapper:(0,f.css)({display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",paddingLeft:x.spacing(.5),gap:"15px 25px"}),section:(0,f.css)({display:"flex"}),sectionRight:(0,f.css)({justifyContent:"flex-end",flexGrow:1,flexBasis:"50%"})}};var b=e(14578),g=e(83195),P=e(16797),c=e(94134);const y=({item:x,onLabelClick:C,onLabelMouseOver:O,onLabelMouseOut:R,className:L,readonly:N})=>{const F=(0,d.of)(p),K=(0,n.useCallback)(U=>{O&&O(x,U)},[x,O]),B=(0,n.useCallback)(U=>{R&&R(x,U)},[x,R]),w=(0,n.useCallback)(U=>{C&&C(x,U)},[x,C]);return n.createElement("tr",{className:(0,f.cx)(F.row,L)},n.createElement("td",null,n.createElement("span",{className:F.itemWrapper},n.createElement(c.R,{color:x.color,seriesName:x.fieldName??x.label,readonly:N,lineStyle:x.lineStyle}),n.createElement("button",{disabled:N,type:"button",title:x.label,onBlur:B,onFocus:K,onMouseOver:K,onMouseOut:B,onClick:N?void 0:w,className:(0,f.cx)(F.label,x.disabled&&F.labelDisabled)},x.label," ",x.yAxis===2&&n.createElement("span",{className:F.yAxisLabel},"(right y-axis)")))),x.getDisplayValues&&x.getDisplayValues().map((U,W)=>n.createElement("td",{className:F.value,key:`${U.title}-${W}`},(0,g.cN)(U))))};y.displayName="LegendTableItem";const p=x=>{const C=P.hoverColor(x.colors.background.primary,x);return{row:(0,f.css)({label:"LegendRow",fontSize:x.v1.typography.size.sm,borderBottom:`1px solid ${x.colors.border.weak}`,td:{padding:x.spacing(.25,1),whiteSpace:"nowrap"},"&:hover":{background:C}}),label:(0,f.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,maxWidth:"600px",textOverflow:"ellipsis",overflow:"hidden",userSelect:"text"}),labelDisabled:(0,f.css)({label:"LegendLabelDisabled",color:x.colors.text.disabled}),itemWrapper:(0,f.css)({display:"flex",whiteSpace:"nowrap",alignItems:"center"}),value:(0,f.css)({textAlign:"right"}),yAxisLabel:(0,f.css)({color:x.colors.text.secondary})}},v="Name",D=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}).compare,E=({items:x,sortBy:C,sortDesc:O,itemRenderer:R,className:L,onToggleSort:N,onLabelClick:F,onLabelMouseOver:K,onLabelMouseOut:B,readonly:w,isSortable:U})=>{const W=(0,d.of)(S),V={};U&&(V[v]="");for(const _ of x)if(_.getDisplayValues)for(const H of _.getDisplayValues())V[H.title??"?"]=H.description??"";if(C!=null){let _=new Map;x.forEach(G=>{if(C!==v&&G.getDisplayValues){const j=G.getDisplayValues().find(oe=>oe.title===C),Y=j==null||Number.isNaN(j.numeric)?-1/0:j.numeric;_.set(G,Y)}});let H=O?-1:1;C===v?x.sort((G,j)=>H*D(G.label,j.label)):x.sort((G,j)=>{const Y=_.get(G)??0,oe=_.get(j)??0;return H*(Y-oe)})}return R||(R=(_,H)=>n.createElement(y,{key:`${_.label}-${H}`,item:_,onLabelClick:F,onLabelMouseOver:K,onLabelMouseOut:B,readonly:w})),n.createElement("table",{className:(0,f.cx)(W.table,L)},n.createElement("thead",null,n.createElement("tr",null,!U&&n.createElement("th",null),Object.keys(V).map(_=>n.createElement("th",{title:V[_],key:_,className:(0,f.cx)(W.header,N&&W.headerSortable,U&&W.nameHeader,{[W.withIcon]:C===_}),onClick:()=>{N&&N(_)}},_,C===_&&n.createElement(b.I,{size:"xs",name:O?"angle-down":"angle-up"}))))),n.createElement("tbody",null,x.map(R)))},S=x=>({table:(0,f.css)({width:"100%","th:first-child":{width:"100%",borderBottom:`1px solid ${x.colors.border.weak}`}}),header:(0,f.css)({color:x.colors.primary.text,fontWeight:x.typography.fontWeightMedium,borderBottom:`1px solid ${x.colors.border.weak}`,padding:x.spacing(.25,1,.25,1),fontSize:x.typography.bodySmall.fontSize,textAlign:"right",whiteSpace:"nowrap"}),nameHeader:(0,f.css)({textAlign:"left",paddingLeft:"30px"}),withIcon:(0,f.css)({paddingRight:"4px"}),headerSortable:(0,f.css)({cursor:"pointer"})});var T=e(29995),M=e(44895);function A({items:x,displayMode:C,sortBy:O,seriesVisibilityChangeBehavior:R=T.K.Isolate,sortDesc:L,onLabelClick:N,onToggleSort:F,placement:K,className:B,itemRenderer:w,readonly:U,isSortable:W}){const{eventBus:V,onToggleSeriesVisibility:_,onToggleLegendSort:H}=(0,r.d2)(),G=(0,n.useCallback)((oe,se)=>{V?.publish({type:a.b_.type,payload:{raw:se,x:0,y:0,dataId:oe.label}})},[V]),j=(0,n.useCallback)((oe,se)=>{V?.publish({type:a.ql.type,payload:{raw:se,x:0,y:0,dataId:oe.label}})},[V]),Y=(0,n.useCallback)((oe,se)=>{N&&N(oe,se),_&&_(oe.fieldName??oe.label,R===T.K.Hide?i.B.AppendToSelection:(0,M.W)(se))},[_,N,R]);switch(C){case o.lm.Table:return n.createElement(E,{className:B,items:x,placement:K,sortBy:O,sortDesc:L,onLabelClick:Y,onToggleSort:F||H,onLabelMouseOver:G,onLabelMouseOut:j,itemRenderer:w,readonly:U,isSortable:W});case o.lm.List:return n.createElement(h,{className:B,items:x,placement:K,onLabelMouseOver:G,onLabelMouseOut:j,onLabelClick:Y,itemRenderer:w,readonly:U});default:return null}}A.displayName="VizLegend"},34375:(Q,I,e)=>{"use strict";e.d(I,{M:()=>h});var n=e(32196),a=e(96540),o=e(13544),r=e(40845),i=e(94134),f=e(2543),d=e(83195),l=e(1551);const m=({stats:b})=>{const g=(0,r.of)(s);return b.length===0?null:a.createElement(l.c,{className:g.list,items:b,renderItem:P=>a.createElement("div",{className:g.item,title:P.description},P.title&&`${(0,f.capitalize)(P.title)}:`," ",(0,d.cN)(P))})},s=()=>({list:(0,n.css)({flexGrow:1,textAlign:"right"}),item:(0,n.css)({marginLeft:"8px"})});m.displayName="VizLegendStatsList";const h=({item:b,onLabelClick:g,onLabelMouseOver:P,onLabelMouseOut:c,className:y,readonly:p})=>{const v=(0,r.of)(u),D=(0,a.useCallback)(T=>{P&&P(b,T)},[b,P]),E=(0,a.useCallback)(T=>{c&&c(b,T)},[b,c]),S=(0,a.useCallback)(T=>{g&&g(b,T)},[b,g]);return a.createElement("div",{className:(0,n.cx)(v.itemWrapper,b.disabled&&v.itemDisabled,y),"data-testid":o.Tp.components.VizLegend.seriesName(b.label)},a.createElement(i.R,{seriesName:b.fieldName??b.label,color:b.color,gradient:b.gradient,readonly:p,lineStyle:b.lineStyle}),a.createElement("button",{disabled:p,type:"button",onBlur:E,onFocus:D,onMouseOver:D,onMouseOut:E,onClick:S,className:v.label},b.label),b.getDisplayValues&&a.createElement(m,{stats:b.getDisplayValues()}))};h.displayName="VizLegendListItem";const u=b=>({label:(0,n.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,userSelect:"text"}),itemDisabled:(0,n.css)({label:"LegendLabelDisabled",color:b.colors.text.disabled}),itemWrapper:(0,n.css)({label:"LegendItemWrapper",display:"flex",whiteSpace:"nowrap",alignItems:"center",flexGrow:1}),value:(0,n.css)({textAlign:"right"}),yAxisLabel:(0,n.css)({color:b.v1.palette.gray2})})},94134:(Q,I,e)=>{"use strict";e.d(I,{R:()=>i});var n=e(96540),a=e(83598),o=e(79041),r=e(94536);const i=n.memo(({seriesName:f,color:d,gradient:l,readonly:m,lineStyle:s})=>{const{onSeriesColorChange:h}=(0,o.d2)(),u=(0,n.useCallback)(b=>h(f,b),[f,h]);return f&&h&&d&&!m?n.createElement(a.Dp,{color:d,onChange:u,enableNamedColors:!0},({ref:b,showColorPicker:g,hideColorPicker:P})=>n.createElement(r.p,{color:d,className:"pointer",ref:b,onClick:g,onMouseLeave:P,lineStyle:s})):n.createElement(r.p,{color:d,gradient:l,lineStyle:s})});i.displayName="VizLegendSeriesIcon"},29995:(Q,I,e)=>{"use strict";e.d(I,{K:()=>n});var n=(a=>(a[a.Isolate=0]="Isolate",a[a.Hide=1]="Hide",a))(n||{})},44895:(Q,I,e)=>{"use strict";e.d(I,{W:()=>a});var n=e(88895);function a(o){return o.ctrlKey||o.metaKey||o.shiftKey?n.B.AppendToSelection:n.B.ToggleSelection}},12509:(Q,I,e)=>{"use strict";e.d(I,{S:()=>f});var n=e(2543),a=e(96540),o=e(47070);const r=(l,m,s,h)=>{const u=i(l,m,h),b=i(m,l,h),g=Math.max(u,b);let P=Math.floor(l/g),c=Math.ceil(h/P);P=Math.ceil(h/c);const y=P-(P*c-h),p=l/y-s+s/y;return{width:l/P-s+s/P,height:m/c-s+s/c,widthOnLastRow:p,xCount:P,yCount:c}};function i(l,m,s){const h=Math.ceil(Math.sqrt(s*l/m));return Math.floor(h*m/l)*h<s?m/Math.ceil(h*m/l):l/h}class f extends a.PureComponent{static{this.defaultProps={itemSpacing:8}}constructor(m){super(m),this.state={values:m.getValues()}}componentDidUpdate(m){const{renderCounter:s,source:h}=this.props;(s!==m.renderCounter||h!==m.source)&&this.setState({values:this.props.getValues()})}getOrientation(){const{orientation:m,width:s,height:h}=this.props;return m===o.wV.Auto?s>h?o.wV.Vertical:o.wV.Horizontal:m}renderGrid(){const{renderValue:m,height:s,width:h,itemSpacing:u,getAlignmentFactors:b,orientation:g}=this.props,{values:P}=this.state,c=r(h,s,u,P.length),y=b?b(P,c.width,c.height):{};let p=0,v=0,D=[];for(let E=0;E<P.length;E++){const S=P[E],M=v===c.yCount-1?c.widthOnLastRow:c.width,A=c.height,x=p*M+u*p,C=v*A+u*v,O={position:"absolute",left:x,top:C,width:`${M}px`,height:`${A}px`};D.push(a.createElement("div",{key:E,style:O},m({value:S,width:M,height:A,alignmentFactors:y,orientation:g,count:P.length}))),p++,p===c.xCount&&(p=0,v++)}return a.createElement("div",{style:{position:"relative"}},D)}render(){const{renderValue:m,height:s,width:h,itemSpacing:u,getAlignmentFactors:b,autoGrid:g,orientation:P,maxVizHeight:c,minVizWidth:y,minVizHeight:p}=this.props,{values:v}=this.state;if(g&&P===o.wV.Auto)return this.renderGrid();const D={display:"flex"},E={display:"flex",overflow:`${y?"auto":"hidden"} ${p?"auto":"hidden"}`};let S=s,T=h;const M=this.getOrientation();switch(M){case o.wV.Horizontal:const x=(s+u)/v.length-u;E.flexDirection="column",E.height=`${s}px`,D.marginBottom=`${u}px`,T=h,S=(0,n.clamp)(x,p??0,c??x);break;case o.wV.Vertical:E.flexDirection="row",E.justifyContent="space-between",D.marginRight=`${u}px`,S=s,T=Math.max(h/v.length-u+u/v.length,y??0)}D.width=`${T}px`,D.height=`${S}px`;const A=b?b(v,T,S):{};return a.createElement("div",{style:E},v.map((x,C)=>a.createElement("div",{key:C,style:d(D,C,v.length)},m({value:x,width:T,height:S,alignmentFactors:A,orientation:M,count:v.length}))))}}function d(l,m,s){return m===s-1?{...l,marginRight:0,marginBottom:0}:l}},3139:(Q,I,e)=>{"use strict";e.d(I,{g:()=>f,o:()=>d});var n=e(32196),a=e(96540),o=e(40845),r=e(94536);const i=l=>({icon:(0,n.css)({marginRight:l.spacing(1),verticalAlign:"middle"}),seriesTable:(0,n.css)({display:"table"}),seriesTableRow:(0,n.css)({display:"table-row",fontSize:l.typography.bodySmall.fontSize}),seriesTableCell:(0,n.css)({display:"table-cell"}),label:(0,n.css)({wordBreak:"break-all"}),value:(0,n.css)({paddingLeft:l.spacing(2),textAlign:"right"}),activeSeries:(0,n.css)({fontWeight:l.typography.fontWeightBold,color:l.colors.text.maxContrast}),timestamp:(0,n.css)({fontWeight:l.typography.fontWeightBold,fontSize:l.typography.bodySmall.fontSize})}),f=({color:l,label:m,value:s,isActive:h})=>{const u=(0,o.of)(i);return a.createElement("div",{"data-testid":"SeriesTableRow",className:(0,n.cx)(u.seriesTableRow,h&&u.activeSeries)},l&&a.createElement("div",{className:u.seriesTableCell},a.createElement(r.p,{color:l,className:u.icon})),m&&a.createElement("div",{className:(0,n.cx)(u.seriesTableCell,u.label)},m),s&&a.createElement("div",{className:(0,n.cx)(u.seriesTableCell,u.value)},s))},d=({timestamp:l,series:m})=>{const s=(0,o.of)(i);return a.createElement(a.Fragment,null,l&&a.createElement("div",{className:s.timestamp,"aria-label":"Timestamp"},l),m.map((h,u)=>a.createElement(f,{isActive:h.isActive,label:h.label,color:h.color,value:h.value,key:`${h.label}-${u}`})))}},75128:(Q,I,e)=>{"use strict";e.d(I,{n:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(17464),i=e(69503);const f=({content:l,position:m,offset:s})=>{const h=(0,o.of)(d);return m?a.createElement(r.ZL,{className:h.portal},a.createElement(i.o,{position:m,offset:s||{x:0,y:0}},l)):null};f.displayName="VizTooltip";const d=()=>({portal:(0,n.css)({position:"absolute",top:0,left:0,pointerEvents:"none",width:"100%",height:"100%"})})},69503:(Q,I,e)=>{"use strict";e.d(I,{o:()=>d});var n=e(32196),a=e(96540),o=e(52908),r=e(40845),i=e(16797),f=e(10875);const d=({position:{x:m,y:s},offset:{x:h,y:u},children:b,allowPointerEvents:g=!1,className:P,...c})=>{const y=(0,a.useRef)(null),[p,v]=(0,a.useState)({width:0,height:0}),{width:D,height:E}=(0,o.A)(),[S,T]=(0,a.useState)({x:m+h,y:s+u}),M=(0,a.useMemo)(()=>new ResizeObserver(x=>{for(let C of x){const O=Math.floor(C.contentRect.width+16),R=Math.floor(C.contentRect.height+2*8);(p.width!==O||p.height!==R)&&v({width:Math.min(O,D),height:Math.min(R,E)})}}),[p,D,E]);(0,a.useLayoutEffect)(()=>(y.current&&M.observe(y.current),()=>{M.disconnect()}),[M]),(0,a.useLayoutEffect)(()=>{if(y&&y.current){const{x,y:C}=(0,f.Ju)(m,s,p.width,p.height,h,u,D,E);T({x,y:C})}},[D,E,m,h,s,u,p]);const A=(0,r.of)(l);return a.createElement("div",{ref:y,style:{position:"fixed",left:0,pointerEvents:g?"auto":"none",top:0,transform:`translate(${S.x}px, ${S.y}px)`,transition:"transform ease-out 0.1s"},"aria-live":"polite","aria-atomic":"true",...c,className:(0,n.cx)(A.wrapper,P)},b)};d.displayName="VizTooltipContainer";const l=m=>({wrapper:(0,n.css)((0,i.getTooltipContainerStyles)(m))})},11389:(Q,I,e)=>{"use strict";e.d(I,{o:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(13471);const i=({items:d,children:l,isPinned:m,scrollable:s=!1,maxHeight:h})=>{const u=(0,o.of)(f),b=s?{maxHeight:h,overflowY:"scroll"}:{};return a.createElement("div",{className:u.wrapper,style:b},d.map(({label:g,value:P,color:c,colorIndicator:y,colorPlacement:p,isActive:v,lineStyle:D},E)=>a.createElement(r.B,{key:E,label:g,value:P,color:c,colorIndicator:y,colorPlacement:p,isActive:v,justify:"space-between",isPinned:m,lineStyle:D,showValueScroll:!s})),l)},f=d=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column",flex:1,gap:4,borderTop:`1px solid ${d.colors.border.medium}`,padding:d.spacing(1)})})},58749:(Q,I,e)=>{"use strict";e.d(I,{S:()=>l});var n=e(32196),a=e(96540),o=e(67061),r=e(14689),i=e(55852),f=e(40845);const d="add-annotation-button",l=({dataLinks:s,annotate:h})=>{const u=(0,f.of)(m),b=()=>{const g={variant:"secondary"};return a.createElement(o.B,{direction:"column",justifyContent:"flex-start"},s.map((P,c)=>a.createElement(r.R,{key:c,link:P,buttonProps:g})))};return a.createElement("div",{className:u.wrapper},s.length>0&&a.createElement("div",{className:u.dataLinks},b()),h!=null&&a.createElement("div",{className:u.addAnnotations},a.createElement(i.$n,{icon:"comment-alt",variant:"secondary",size:"sm",id:d,onClick:h},"Add annotation")))},m=s=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column",flex:1,padding:s.spacing(0)}),dataLinks:(0,n.css)({borderTop:`1px solid ${s.colors.border.medium}`,padding:s.spacing(1)}),addAnnotations:(0,n.css)({borderTop:`1px solid ${s.colors.border.medium}`,padding:s.spacing(1)})})},52415:(Q,I,e)=>{"use strict";e.d(I,{A:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(13471);const i=({item:d,isPinned:l})=>{const m=(0,o.of)(f),{label:s,value:h,color:u,colorIndicator:b}=d;return a.createElement("div",{className:m.wrapper},a.createElement(r.B,{label:s,value:h,color:u,colorIndicator:b,marginRight:"22px",isPinned:l}))},f=d=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column",flex:1,padding:d.spacing(1)})})},13471:(Q,I,e)=>{"use strict";e.d(I,{B:()=>c});var n=e(32196),a=e(96540),o=e(40845),r=e(32982),i=e(56034),f=e(24293),d=e(94536),l=e(79871),m=e(10875),s=(p=>(p[p.Leading=0]="Leading",p[p.Trailing=1]="Trailing",p))(s||{});const h=({color:p=f.F,colorIndicator:v=l.Ev,position:D=0,lineStyle:E})=>{const S=(0,o.of)(u);return v===l.fX.series?a.createElement(d.p,{color:p,lineStyle:E,className:D===0?S.leading:S.trailing}):a.createElement("span",{style:{backgroundColor:p},className:(0,n.cx)(D===0?S.leading:S.trailing,(0,m.L$)(v,S))})},u=p=>({leading:(0,n.css)({marginRight:p.spacing(.5)}),trailing:(0,n.css)({marginLeft:p.spacing(.5)}),value:(0,n.css)({width:"12px",height:"12px",borderRadius:p.shape.radius.default,fontWeight:500,minWidth:"12px"}),hexagon:(0,n.css)({}),pie_1_4:(0,n.css)({}),pie_2_4:(0,n.css)({}),pie_3_4:(0,n.css)({}),marker_sm:(0,n.css)({width:"4px",height:"4px",borderRadius:p.shape.radius.circle,minWidth:"4px"}),marker_md:(0,n.css)({width:"8px",height:"8px",borderRadius:p.shape.radius.circle,minWidth:"8px"}),marker_lg:(0,n.css)({width:"12px",height:"12px",borderRadius:p.shape.radius.circle,minWidth:"12px"})});var b=(p=>(p.label="label",p.value="value",p))(b||{});const g="Copied to clipboard",P=2*1e3,c=({label:p,value:v,color:D,colorIndicator:E,colorPlacement:S=l.lJ.first,justify:T="flex-start",isActive:M=!1,marginRight:A="0px",isPinned:x,lineStyle:C,showValueScroll:O})=>{const R=(0,o.of)(y,T,A),L=O?{maxHeight:55,whiteSpace:"wrap",wordBreak:"break-word",overflowY:"scroll"}:{whiteSpace:"wrap",wordBreak:"break-word"},[N,F]=(0,a.useState)(!1),[K,B]=(0,a.useState)(null),[w,U]=(0,a.useState)(!1),W=(0,a.useRef)(null),V=(0,a.useRef)(null);(0,a.useEffect)(()=>{let Y;return w&&(Y=setTimeout(()=>{U(!1)},P)),()=>{window.clearTimeout(Y)}},[w]);const _=async(Y,oe)=>{if(!(navigator?.clipboard&&window.isSecureContext)){H(Y,oe);return}try{await navigator.clipboard.writeText(Y),B({[`${oe}`]:Y}),U(!0)}catch{B(null)}},H=(Y,oe)=>{const se=document.createElement("textarea");W.current?.appendChild(se),se.value=Y,se.focus(),se.select();try{document.execCommand("copy")&&(B({[`${oe}`]:Y}),U(!0))}catch(ne){console.error("Unable to copy to clipboard",ne)}se.remove()},G=Y=>{Y.currentTarget.offsetWidth<Y.currentTarget.scrollWidth&&F(!0)},j=()=>F(!1);return a.createElement("div",{className:R.contentWrapper},(D||p)&&a.createElement("div",{className:R.valueWrapper},D&&S===l.lJ.first&&a.createElement(h,{color:D,colorIndicator:E,lineStyle:C}),x?a.createElement(a.Fragment,null,a.createElement(i.m,{content:p,interactive:!1,show:N},a.createElement(a.Fragment,null,w&&K?.label&&a.createElement(r.r,{placement:"top",referenceElement:W.current},g),a.createElement("div",{className:(0,n.cx)(R.label,M&&R.activeSeries,navigator?.clipboard&&R.copy),onMouseEnter:G,onMouseLeave:j,onClick:()=>_(p,"label"),ref:W},p)))):a.createElement("div",{className:(0,n.cx)(R.label,M&&R.activeSeries)},p)),a.createElement("div",{className:R.valueWrapper},D&&S===l.lJ.leading&&a.createElement(h,{color:D,colorIndicator:E,position:s.Leading,lineStyle:C}),x?a.createElement(a.Fragment,null,w&&K?.value&&a.createElement(r.r,{placement:"top",referenceElement:V.current},g),a.createElement("div",{className:(0,n.cx)(R.value,M,navigator?.clipboard&&R.copy),style:L,onClick:()=>_(v?v.toString():"","value"),ref:V},v)):a.createElement("div",{className:(0,n.cx)(R.value,M),style:L},v),D&&S===l.lJ.trailing&&a.createElement(h,{color:D,colorIndicator:E,position:s.Trailing,lineStyle:C})))},y=(p,v,D)=>({contentWrapper:(0,n.css)({display:"flex",alignItems:"start",justifyContent:v,marginRight:D}),label:(0,n.css)({color:p.colors.text.secondary,fontWeight:400,textOverflow:"ellipsis",overflow:"hidden",marginRight:p.spacing(2)}),value:(0,n.css)({fontWeight:500,textOverflow:"ellipsis",overflow:"hidden"}),valueWrapper:(0,n.css)({display:"flex",alignItems:"center"}),activeSeries:(0,n.css)({fontWeight:p.typography.fontWeightBold,color:p.colors.text.maxContrast}),copy:(0,n.css)({cursor:"pointer"})})},79871:(Q,I,e)=>{"use strict";e.d(I,{Ev:()=>o,fX:()=>n,lJ:()=>a});var n=(r=>(r.series="series",r.value="value",r.hexagon="hexagon",r.pie_1_4="pie_1_4",r.pie_2_4="pie_2_4",r.pie_3_4="pie_3_4",r.marker_sm="marker_sm",r.marker_md="marker_md",r.marker_lg="marker_lg",r))(n||{}),a=(r=>(r.hidden="hidden",r.first="first",r.leading="leading",r.trailing="trailing",r))(a||{});const o="series"},10875:(Q,I,e)=>{"use strict";e.d(I,{Ju:()=>d,L$:()=>l,cp:()=>u});var n=e(11261),a=e(8066),o=e(83195),r=e(24293),i=e(52622),f=e(79871);const d=(b=0,g=0,P=0,c=0,y=0,p=0,v=0,D=0)=>{let E=b,S=g;const T=Math.max(b+y+P-(v-y),0),M=Math.abs(Math.min(b-y-P-y,0)),A=T>0,x=M>0,C=Math.max(g+p+c-(D-p),0),O=Math.abs(Math.min(g-p-c-p,0)),R=C>0,L=O>0;return A&&x?E=T>M?y:v-y-P:A?E=b-y-P:E=b+y,R&&L?S=C>O?p:D-p-c:R?S=g-p-c:S=g+p,{x:E,y:S}},l=(b,g)=>{switch(b){case f.fX.value:return g.value;case f.fX.hexagon:return g.hexagon;case f.fX.pie_1_4:return g.pie_1_4;case f.fX.pie_2_4:return g.pie_2_4;case f.fX.pie_3_4:return g.pie_3_4;case f.fX.marker_sm:return g.marker_sm;case f.fX.marker_md:return g.marker_md;case f.fX.marker_lg:return g.marker_lg;default:return g.value}},m=(b,g)=>b.numeric-g.numeric,s=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),h=(b,g)=>s.compare(`${b.value}`,`${g.value}`),u=(b,g,P,c,y,p,v=D=>!0)=>{let D=[],E=!0;for(let S=0;S<b.length;S++){const T=b[S];if(T===g||T.type===n.PU.time||!v(T)||T.config.custom?.hideFrom?.tooltip||T.config.custom?.hideFrom?.viz||y===i.$N.Single&&c!==S)continue;let M=P[S];if(M==null)continue;T.type===n.PU.number||T.type===n.PU.boolean||T.type===n.PU.enum||(E=!1);const A=b[S].values[M];if(A==null&&T.config.noValue==null)continue;const x=T.display(A),C=Number.isNaN(x.numeric)?p===i.xB.Descending?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER:x.numeric,O=(0,a.Qi)(T);let R=f.fX.series,L=f.lJ.first;O.isByValue&&(R=f.fX.value,L=f.lJ.trailing),D.push({label:T.state?.displayName??T.name,value:(0,o.cN)(x),color:x.color??r.F,colorIndicator:R,colorPlacement:L,isActive:y===i.$N.Multi&&c===S,numeric:C,lineStyle:T.config.custom?.lineStyle})}if(p!==i.xB.None&&D.length>1){const S=E?m:h,T=p===i.xB.Descending?-1:1;D.sort((M,A)=>T*S(M,A))}return D}},94333:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{Alert:()=>Ve.F,AlertingSettings:()=>tt.i,AsyncMultiSelect:()=>no.Iv,AsyncSelect:()=>no.DW,AsyncVirtualizedSelect:()=>no.gZ,AutoSaveField:()=>oe.p,AutoSizeInput:()=>$o.D,Avatar:()=>zt.e,Badge:()=>qr.E,BarGauge:()=>xt.xE,BarGaugeDisplayMode:()=>ya.eX,BigValue:()=>ke.yV,BigValueColorMode:()=>ke.yp,BigValueGraphMode:()=>ke.$p,BigValueJustifyMode:()=>ke.F8,BigValueTextMode:()=>ke.SV,Box:()=>ks.a,BrowserLabel:()=>Rr.J,Button:()=>ia.$n,ButtonCascader:()=>E.H,ButtonGroup:()=>wn.e,ButtonSelect:()=>No.f,CallToActionCard:()=>nn.c,Card:()=>so.Z,CardContainer:()=>ko.Q,Cascader:()=>D.v,CertificationKey:()=>Lt.K,Checkbox:()=>zo.S,ClickOutsideWrapper:()=>Rt.N,ClipboardButton:()=>v.b,CodeEditor:()=>ie.B,CodeEditorSuggestionItemKind:()=>ue.q,CollapsableSection:()=>bt.M,Collapse:()=>gt.S,ColorPicker:()=>A.sk,ColorPickerInput:()=>x.i,ConfirmButton:()=>s.Z,ConfirmModal:()=>z.u,Container:()=>mo.mc,ContextMenu:()=>Kt.t,ControlledCollapse:()=>gt.a,Counter:()=>Me.p,CustomHeadersSettings:()=>je.P,CustomScrollbar:()=>y.E,DataLinkButton:()=>St.R,DataLinkInput:()=>Tt.l,DataLinksContextMenu:()=>$t.e,DataLinksInlineEditor:()=>fn.e,DataSourceHttpSettings:()=>Vt.t,DatePicker:()=>V.l,DatePickerWithInput:()=>_.l,DateTimePicker:()=>H.K,DeleteButton:()=>h.e,Divider:()=>zn.c,Drawer:()=>Ht._,Dropdown:()=>To.m,EmptySearchResult:()=>O.Z,EmptyState:()=>R.p,ErrorBoundary:()=>nt.tH,ErrorBoundaryAlert:()=>nt.Xw,ErrorWithStack:()=>yt.D,EventBusPlugin:()=>Qs.Ku,EventsCanvas:()=>ps.a,FIXED_UNIT:()=>Hr.s,FadeTransition:()=>hn.A,FeatureBadge:()=>vn.y,FeatureInfoBox:()=>Tn.e,Field:()=>Xs.D,FieldArray:()=>Ar.E,FieldLinkList:()=>Je.n,FieldSet:()=>Br.n,FieldValidationMessage:()=>Mr.P,FileDropzone:()=>Yo.gH,FileDropzoneDefaultChildren:()=>Yo.wI,FileListItem:()=>Yo.IB,FileUpload:()=>si.e,FilterInput:()=>qo.Z,FilterPill:()=>Z.m,Form:()=>Xe.l,FormattedValueDisplay:()=>eo.i,FullWidthButtonContainer:()=>rt.V,Gauge:()=>ot._,Graph:()=>co.T,GraphContextMenu:()=>At.H,GraphContextMenuHeader:()=>At.i,GraphNG:()=>cn.o,GraphSeriesToggler:()=>ht.M,GraphWithLegend:()=>Ur.I,Grid:()=>Dr.x,HorizontalGroup:()=>mo.Gy,Icon:()=>l.I,IconButton:()=>m.K,InfoBox:()=>Cn.w,InlineField:()=>vr.I,InlineFieldRow:()=>to.C,InlineFormLabel:()=>rn.I,InlineLabel:()=>js.c,InlineSegmentGroup:()=>fr.e,InlineSwitch:()=>Co.K,InlineToast:()=>S.r,Input:()=>Io.p,InputControl:()=>Qn.e,InteractiveTable:()=>j.j,JSONFormatter:()=>Kn.B,JsonExplorer:()=>Yn.O,KeyboardPlugin:()=>Qs.Z7,Label:()=>Ir.J,LegacyForms:()=>Js,LegacyInputStatus:()=>a.O,Legend:()=>Gs.s,Link:()=>Ts.N,LinkButton:()=>ia.z9,List:()=>G.B,LoadingBar:()=>M.G,LoadingPlaceholder:()=>T._,Marker:()=>ps.pH,Menu:()=>en.W,MenuGroup:()=>Qt.r,MenuItem:()=>An.D,Modal:()=>Se.a,ModalHeader:()=>he.r,ModalRoot:()=>pe.EO,ModalTabContent:()=>me.O,ModalTabsHeader:()=>ce.J,ModalsContext:()=>pe.wE,ModalsController:()=>pe.$s,ModalsProvider:()=>pe.YO,MultiSelect:()=>no.KF,PageToolbar:()=>ye.d,Pagination:()=>se.d,PanelChrome:()=>X.NR,PanelChromeLoadingIndicator:()=>le.I,PanelContainer:()=>Eo._,PanelContextProvider:()=>be.XF,PanelContextRoot:()=>be.e4,PlotLegend:()=>nr.$,PluginSignatureBadge:()=>oi.B,Popover:()=>g.A,PopoverController:()=>b.I,Portal:()=>c.ZL,PortalContainer:()=>c.qB,QueryField:()=>q.X,RadioButtonGroup:()=>Po.z,RadioButtonList:()=>jr.a,RangeSlider:()=>It.F,ReactMonacoEditor:()=>de.m,RefreshPicker:()=>F.cC,RelativeTimeRangePicker:()=>Ao.N,RenderUserContentAsHTML:()=>$e.I,ScaleDistribution:()=>ya.L4,SecretInput:()=>lo.L,SecretTextArea:()=>Vo.l,SecureSocksProxySettings:()=>Dt.Y,Segment:()=>Bt.Y,SegmentAsync:()=>Jt.s,SegmentInput:()=>Rn.o,SegmentSection:()=>wt.L,SegmentSelect:()=>Mt.a,Select:()=>no.l6,SelectContainer:()=>no.KA,SeriesColorPicker:()=>A.Dp,SeriesColorPickerPopover:()=>C.o,SeriesColorPickerPopoverWithTheme:()=>C.t,SeriesIcon:()=>Yt.p,SeriesTable:()=>Le.o,SeriesTableRow:()=>Le.g,SeriesVisibilityChangeBehavior:()=>Te.K,SeriesVisibilityChangeMode:()=>_r.B,SetInterval:()=>Pe.u,SlideOutTransition:()=>mt.n,Slider:()=>tn.A,Space:()=>_s.$,Sparkline:()=>Ze.O,Spinner:()=>Gt.y,Stack:()=>Ms.B,StatsPicker:()=>N.S,Switch:()=>Co.d,TLSAuthSettings:()=>Ot.j,Tab:()=>We.o,TabContent:()=>Ue.J,TabbedContainer:()=>p.q,Table:()=>Ie.X,TableInputCSV:()=>Oe.b,TabsBar:()=>Ne.U,Tag:()=>ne.v,TagList:()=>ee.L,TagsInput:()=>Y.u,Text:()=>Bs.E,TextArea:()=>So.f,TextLink:()=>Us.Y,TimeOfDayPicker:()=>w.R,TimePickerTooltip:()=>K.xS,TimeRangeInput:()=>ri.b,TimeRangeLabel:()=>B.f,TimeRangePicker:()=>K.$6,TimeSeries:()=>On.Z,TimeZonePicker:()=>U.U,Toggletip:()=>P.G,ToolbarButton:()=>sa.I,ToolbarButtonRow:()=>La.U,Tooltip:()=>u.m,TooltipPlugin:()=>Ds.T,TooltipPlugin2:()=>Qs.xl,UPLOT_AXIS_FONT_SIZE:()=>Ga.pi,UPlotChart:()=>_a.Z,UPlotConfigBuilder:()=>as.e,UnitPicker:()=>L.p,UserIcon:()=>oo.n,ValuePicker:()=>xa.i,VerticalGroup:()=>mo.gW,VerticalTab:()=>Ae.s,VirtualizedSelect:()=>no.ip,VizLayout:()=>De.KU,VizLegend:()=>we.t,VizLegendListItem:()=>Ke.M,VizRepeater:()=>re.S,VizTooltip:()=>ct.n,VizTooltipContainer:()=>ft.o,WeekStartPicker:()=>W.l,WithContextMenu:()=>un.n,XYCanvas:()=>ps._X,ZoomPlugin:()=>Ns.j,buildScaleKey:()=>la.My,clearButtonStyles:()=>ia.my,convertOldAngularValueMapping:()=>_t.I1,defaultIntervals:()=>F.cb,fieldMatchersUI:()=>ga.g,getCardStyles:()=>so.H,getDragStyles:()=>Fn.l,getInputStyles:()=>Io.n,getPortalContainer:()=>c.gF,getSelectStyles:()=>vo.J,graphFieldOptions:()=>ua.t,graphTickFormatter:()=>an.Yn,graphTimeFormat:()=>an.Jc,preparePlotFrame:()=>la.mY,resetSelectStyles:()=>Ko.A,sharedInputStyle:()=>jn.Xb,sharedSingleStatMigrationHandler:()=>_t._$,sharedSingleStatPanelChangedHandler:()=>_t.gl,useGraphNGContext:()=>ha.I,usePanelContext:()=>be.d2,useSplitter:()=>ta.h,variableSuggestionToCodeEditorSuggestion:()=>fe.O,withErrorBoundary:()=>nt.Xc});var n=e(90090),a=e(91634),o=e(24169),r=e(11206),i=e(22209),f=e(74716),d=e(56286),l=e(14578),m=e(29158),s=e(82702),h=e(91605),u=e(56034),b=e(95868),g=e(13840),P=e(60782),c=e(17464),y=e(40276),p=e(60734),v=e(10534),D=e(3988),E=e(32012),S=e(32982),T=e(39558),M=e(57514),A=e(83598),x=e(99128),C=e(70104),O=e(41670),R=e(69529),L=e(2056),N=e(42734),F=e(11134),K=e(15666),B=e(3799),w=e(66070),U=e(20333),W=e(15648),V=e(56181),_=e(98239),H=e(63383),G=e(33552),j=e(48840),Y=e(79924),oe=e(28270),se=e(19384),ne=e(78369),ee=e(64149),Z=e(92174),z=e(96374),q=e(20084),ie=e(32372),de=e(85828),ue=e(19716),fe=e(99544),Se=e(37390),he=e(29473),ce=e(25897),me=e(95246),pe=e(71678),ye=e(95247),Pe=e(67570),Ie=e(77093),Oe=e(14746),Ne=e(63021),We=e(40675),Ae=e(90685),Ue=e(40980),Me=e(53402),$e=e(44522),ke=e(37494),Ze=e(5926),ot=e(95164),xt=e(97696),ct=e(75128),ft=e(69503),Le=e(3139),re=e(12509),X=e(91052),le=e(89963),be=e(79041),De=e(67266),Te=e(29995),we=e(96516),Ke=e(34375),Ve=e(42418),ht=e(84656),gt=e(82762),bt=e(57418),St=e(14689),Je=e(79961),rt=e(61458),Rt=e(8866),_t=e(37713),nn=e(76442),Kt=e(28122),en=e(38138),Qt=e(59093),An=e(64539),un=e(51686),fn=e(64919),Tt=e(64078),$t=e(59796),Yt=e(94536),Cn=e(37166),Tn=e(86460),vn=e(29678),Kn=e(24022),Yn=e(44533),nt=e(66602),yt=e(52446),Vt=e(91409),je=e(11184),tt=e(19849),Dt=e(17081),Ot=e(95180),Lt=e(28623),Gt=e(62930),hn=e(31511),mt=e(72960),Bt=e(38401),Jt=e(83684),Rn=e(57752),Mt=e(13102),wt=e(64765),Ht=e(87978),tn=e(77014),It=e(47097),Xe=e(51253),jn=e(87266),Qn=e(16504),ia=e(55852),wn=e(19727),sa=e(27746),La=e(15068),xa=e(51986),ga=e(84349),Ts=e(50720),Us=e(72109),Bs=e(94753),ks=e(90613),Ms=e(67061),Dr=e(71259),_s=e(68402),Ir=e(60029),Xs=e(88575),Gs=e(17408),Br=e(84167),Mr=e(72093),vr=e(14186),fr=e(63056),js=e(76892),to=e(39268),Ar=e(95984),Ko=e(23731),no=e(21594),vo=e(88824),ao=e(62883),Do=e.n(ao),Xr={};for(const Rs in ao)["default","Icon","IconButton","ConfirmButton","DeleteButton","Tooltip","PopoverController","Popover","Toggletip","Portal","getPortalContainer","PortalContainer","CustomScrollbar","TabbedContainer","ClipboardButton","Cascader","ButtonCascader","InlineToast","LoadingPlaceholder","LoadingBar","ColorPicker","SeriesColorPicker","ColorPickerInput","SeriesColorPickerPopover","SeriesColorPickerPopoverWithTheme","EmptySearchResult","EmptyState","UnitPicker","StatsPicker","RefreshPicker","defaultIntervals","TimeRangePicker","TimePickerTooltip","TimeRangeLabel","TimeOfDayPicker","TimeZonePicker","WeekStartPicker","DatePicker","DatePickerWithInput","DateTimePicker","List","InteractiveTable","TagsInput","AutoSaveField","Pagination","Tag","TagList","FilterPill","ConfirmModal","QueryField","CodeEditor","ReactMonacoEditor","CodeEditorSuggestionItemKind","variableSuggestionToCodeEditorSuggestion","Modal","ModalHeader","ModalTabsHeader","ModalTabContent","ModalsProvider","ModalRoot","ModalsController","ModalsContext","PageToolbar","SetInterval","Table","TableInputCSV","TabsBar","Tab","VerticalTab","TabContent","Counter","RenderUserContentAsHTML","BigValue","BigValueColorMode","BigValueGraphMode","BigValueJustifyMode","BigValueTextMode","Sparkline","Gauge","BarGauge","VizTooltip","VizTooltipContainer","SeriesTable","SeriesTableRow","VizRepeater","PanelChrome","PanelChromeLoadingIndicator","PanelContextProvider","PanelContextRoot","usePanelContext","VizLayout","SeriesVisibilityChangeBehavior","VizLegend","VizLegendListItem","Alert","GraphSeriesToggler","Collapse","ControlledCollapse","CollapsableSection","DataLinkButton","FieldLinkList","FullWidthButtonContainer","ClickOutsideWrapper","CallToActionCard","ContextMenu","Menu","MenuGroup","MenuItem","WithContextMenu","DataLinksInlineEditor","DataLinkInput","DataLinksContextMenu","SeriesIcon","InfoBox","FeatureInfoBox","FeatureBadge","JSONFormatter","JsonExplorer","ErrorBoundary","ErrorBoundaryAlert","withErrorBoundary","ErrorWithStack","DataSourceHttpSettings","CustomHeadersSettings","AlertingSettings","SecureSocksProxySettings","TLSAuthSettings","CertificationKey","Spinner","FadeTransition","SlideOutTransition","Segment","SegmentAsync","SegmentInput","SegmentSelect","SegmentSection","Drawer","Slider","RangeSlider","Form","sharedInputStyle","InputControl","Button","LinkButton","ButtonGroup","clearButtonStyles","ToolbarButton","ToolbarButtonRow","ValuePicker","fieldMatchersUI","Link","TextLink","Text","Box","Stack","Grid","Space","Label","Field","Legend","FieldSet","FieldValidationMessage","InlineField","InlineSegmentGroup","InlineLabel","InlineFieldRow","FieldArray","resetSelectStyles","getSelectStyles","HorizontalGroup","VerticalGroup","Container","Badge","RadioButtonGroup","RadioButtonList","Input","getInputStyles","AutoSizeInput","FilterInput","Switch","InlineSwitch","Checkbox","TextArea","FileUpload","TimeRangeInput","RelativeTimeRangePicker","Card","getCardStyles","CardContainer","FormattedValueDisplay","ButtonSelect","Dropdown","PluginSignatureBadge","UserIcon","Avatar","InlineFormLabel","Divider","getDragStyles","useSplitter","LegacyForms","LegacyInputStatus","ScaleDistribution","BarGaugeDisplayMode","UPlotConfigBuilder","UPLOT_AXIS_FONT_SIZE","UPlotChart","PlotLegend","FIXED_UNIT","BrowserLabel","PanelContainer","Graph","GraphWithLegend","GraphContextMenu","GraphContextMenuHeader","graphTimeFormat","graphTickFormatter","GraphNG","TimeSeries","useGraphNGContext","preparePlotFrame","buildScaleKey","ZoomPlugin","TooltipPlugin","convertOldAngularValueMapping","sharedSingleStatMigrationHandler","sharedSingleStatPanelChangedHandler","AsyncMultiSelect","AsyncSelect","AsyncVirtualizedSelect","MultiSelect","Select","SelectContainer","VirtualizedSelect"].indexOf(Rs)<0&&(Xr[Rs]=()=>ao[Rs]);e.d(I,Xr);var mo=e(66864),qr=e(39938),Po=e(94354),jr=e(5173),Io=e(10354),$o=e(51440),qo=e(67647),lo=e(49718),Vo=e(7968),Co=e(15292),zo=e(10880),So=e(21744),si=e(73546),Yo=e(92887),ri=e(54230),Ao=e(5308),so=e(10860),ko=e(81507),eo=e(9286),No=e(9261),To=e(83122),oi=e(98624),oo=e(99635),zt=e(12942),rn=e(38894),zn=e(25994),Fn=e(69144),ta=e(21633),ua=e(52198),ya=e(52622),as=e(51336),Ga=e(30501),_a=e(81297),nr=e(24182),ps=e(96747),Qs=e(66737),Hr=e(52811),_r=e(88895),Rr=e(54438),Eo=e(52494),co=e(48747),Ur=e(5484),At=e(33083),an=e(65036),cn=e(99755),On=e(18262),ha=e(16998),la=e(65575),Ns=e(76284),Ds=e(90606);const Js={SecretFormField:d.L,FormField:n.z,Select:i.l6,AsyncSelect:i.DW,IndicatorsContainer:o.s,NoOptionsMessage:r.l,Input:a.p,Switch:f.d}},31511:(Q,I,e)=>{"use strict";e.d(I,{A:()=>i});var n=e(32196),a=e(96540),o=e(86634),r=e(40845);function i(d){const{visible:l,children:m,duration:s=250}=d,h=(0,r.of)(f,s),u=(0,a.useRef)(null);return a.createElement(o.A,{in:l,mountOnEnter:!0,unmountOnExit:!0,timeout:s,classNames:h,nodeRef:u},a.cloneElement(m,{ref:u}))}const f=(d,l)=>({enter:(0,n.css)({label:"enter",opacity:0}),enterActive:(0,n.css)({label:"enterActive",opacity:1,[d.transitions.handleMotion("no-preference","reduce")]:{transition:`opacity ${l}ms ease-out`}}),exit:(0,n.css)({label:"exit",opacity:1}),exitActive:(0,n.css)({label:"exitActive",opacity:0,[d.transitions.handleMotion("no-preference","reduce")]:{transition:`opacity ${l}ms ease-out`}})})},72960:(Q,I,e)=>{"use strict";e.d(I,{n:()=>i});var n=e(32196),a=e(96540),o=e(86634),r=e(40845);function i(d){const{visible:l,children:m,duration:s=250,horizontal:h,size:u}=d,b=(0,r.of)(f,s,h?"width":"height",u),g=(0,a.useRef)(null);return a.createElement(o.A,{in:l,mountOnEnter:!0,unmountOnExit:!0,timeout:s,classNames:b,nodeRef:g},a.cloneElement(m,{ref:g}))}const f=(d,l,m,s)=>({enter:(0,n.css)({label:"enter",[`${m}`]:0,opacity:0}),enterActive:(0,n.css)({label:"enterActive",[`${m}`]:`${s}px`,opacity:1,[d.transitions.handleMotion("no-preference")]:{transition:`opacity ${l}ms ease-out, ${m} ${l}ms ease-out`},[d.transitions.handleMotion("reduce")]:{transition:`opacity ${l}ms ease-out`}}),exit:(0,n.css)({label:"exit",[`${m}`]:`${s}px`,opacity:1}),exitActive:(0,n.css)({label:"exitActive",opacity:0,[`${m}`]:0,[d.transitions.handleMotion("no-preference")]:{transition:`opacity ${l}ms ease-out, ${m} ${l}ms ease-out`},[d.transitions.handleMotion("reduce")]:{transition:`opacity ${l}ms ease-out`}})})},81297:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>l});var n=e(96540),a=e(36613),o=e(16895),r=e(7650);function i(m,s){return s.width===m.width&&s.height===m.height}function f(m,s){return s.data===m.data}function d(m,s){return s.config===m.config}class l extends n.Component{constructor(s){super(s),this.plotContainer=(0,n.createRef)(),this.plotCanvasBBox=(0,n.createRef)(),this.state={plot:null}}reinitPlot(){let{width:s,height:h,plotRef:u}=this.props;if(this.state.plot?.destroy(),s===0&&h===0)return;this.props.config.addHook("setSize",P=>{P.over});const b={width:Math.floor(this.props.width),height:Math.floor(this.props.height),...this.props.config.getConfig()};(0,o.uY)("UPlot",!1,"Reinitializing plot",b);const g=new a.A(b,this.props.data,this.plotContainer.current);u&&u(g),this.setState({plot:g})}componentDidMount(){this.reinitPlot()}componentWillUnmount(){this.state.plot?.destroy()}componentDidUpdate(s){let{plot:h}=this.state;i(s,this.props)?d(s,this.props)?f(s,this.props)||h?.setData(this.props.data):this.reinitPlot():h?.setSize({width:Math.floor(this.props.width),height:Math.floor(this.props.height)})}render(){return n.createElement("div",{style:{position:"relative"}},n.createElement("div",{ref:this.plotContainer,"data-testid":"uplot-main-div"}),this.props.children)}}},24182:(Q,I,e)=>{"use strict";e.d(I,{$:()=>s,t:()=>m});var n=e(96540),a=e(28240),o=e(8066),r=e(52622),i=e(40845),f=e(67266),d=e(96516),l=e(16895);function m(h,u){return h.getSeries().some(b=>{const g=b.props.dataFrameFieldIndex;if(!g)return!1;const P=u[g.frameIndex]?.fields[g.fieldIndex];return!(!P||P.config.custom?.hideFrom?.legend)})}const s=n.memo(({data:h,config:u,placement:b,calcs:g,displayMode:P,...c})=>{const y=(0,i.$j)(),p=u.getSeries().map(v=>{const D=v.props,E=D.dataFrameFieldIndex,S=u.getAxisPlacement(v.props.scaleKey);if(!E)return;const T=h[E.frameIndex]?.fields[E.fieldIndex];if(!T||T.config.custom?.hideFrom?.legend)return;const M=(0,a.Ct)(T,h[E.frameIndex],h),x=(0,o.lz)(T,y).color;return{disabled:!(D.show??!0),fieldIndex:E,color:x,label:M,yAxis:S===r.vM.Left||S===r.vM.Bottom?1:2,getDisplayValues:()=>(0,l.UO)(g,T,y),getItemKey:()=>`${M}-${E.frameIndex}-${E.fieldIndex}`,lineStyle:D.lineStyle}}).filter(v=>v!==void 0);return n.createElement(f.KU.Legend,{placement:b,...c},n.createElement(d.t,{placement:b,items:p,displayMode:P,sortBy:c.sortBy,sortDesc:c.sortDesc,isSortable:!0}))});s.displayName="PlotLegend"},52198:(Q,I,e)=>{"use strict";e.d(I,{t:()=>a});var n=e(52622);const a={drawStyle:[{label:"Lines",value:n.GR.Line},{label:"Bars",value:n.GR.Bars},{label:"Points",value:n.GR.Points}],lineInterpolation:[{description:"Linear",value:n.dx.Linear,icon:"gf-interpolation-linear"},{description:"Smooth",value:n.dx.Smooth,icon:"gf-interpolation-smooth"},{description:"Step before",value:n.dx.StepBefore,icon:"gf-interpolation-step-before"},{description:"Step after",value:n.dx.StepAfter,icon:"gf-interpolation-step-after"}],barAlignment:[{description:"Before",value:n.Nj.Before,icon:"gf-bar-alignment-before"},{description:"Center",value:n.Nj.Center,icon:"gf-bar-alignment-center"},{description:"After",value:n.Nj.After,icon:"gf-bar-alignment-after"}],showPoints:[{label:"Auto",value:n.yL.Auto,description:"Show points when the density is low"},{label:"Always",value:n.yL.Always},{label:"Never",value:n.yL.Never}],axisPlacement:[{label:"Auto",value:n.vM.Auto,description:"First field on the left, everything else on the right"},{label:"Left",value:n.vM.Left},{label:"Right",value:n.vM.Right},{label:"Hidden",value:n.vM.Hidden}],fillGradient:[{label:"None",value:n.on.None},{label:"Opacity",value:n.on.Opacity,description:"Enable fill opacity gradient"},{label:"Hue",value:n.on.Hue,description:"Small color hue gradient"},{label:"Scheme",value:n.on.Scheme,description:"Use color scheme to define gradient"}],stacking:[{label:"Off",value:n.gs.None},{label:"Normal",value:n.gs.Normal},{label:"100%",value:n.gs.Percent}],thresholdsDisplayModes:[{label:"Off",value:n.Ly.Off},{label:"As lines",value:n.Ly.Line},{label:"As lines (dashed)",value:n.Ly.Dashed},{label:"As filled regions",value:n.Ly.Area},{label:"As filled regions and lines",value:n.Ly.LineAndArea},{label:"As filled regions and lines (dashed)",value:n.Ly.DashedAndArea}]}},30501:(Q,I,e)=>{"use strict";e.d(I,{Zj:()=>u,pi:()=>m,zH:()=>h});var n=e(83195),a=e(97706),o=e(42994),r=e(72724),i=e(52622),f=e(29413),d=e(52811),l=e(93060);const m=12,s=8;class h extends d.R{merge(c){this.props.size=(0,l.Y)("max",this.props.size,c.size),this.props.label||(this.props.label=c.label),this.props.placement===i.vM.Auto&&(this.props.placement=c.placement)}calculateSpace(c,y,p,v,D){const E=c.axes[y],S=c.scales[E.scale];if(E.side!==2||!S)return 30;const T=40;if(S.time){const M=D/T,A=(v-p)/M,x=b(c,[p],y,T,A);return(0,f.kD)(x[0],m).width+18}return T}calculateAxisSize(c,y,p){const v=c.axes[p];let D=v.ticks.size;if(v.side===2)D+=v.gap+m;else if(y?.length){let E=y.reduce((T,M)=>Math.max(T,(0,f.kD)(M,m).width),0);const S=Math.min(c.width*.4,E);D+=v.gap+v.labelGap+S}return Math.ceil(D)}getConfig(){let{scaleKey:c,label:y,show:p=!0,placement:v=i.vM.Auto,grid:D={show:!0},ticks:E,space:S,filter:T,gap:M=5,formatValue:A,splits:x,values:C,incrs:O,isTime:R,timeZone:L,theme:N,tickLabelRotation:F,size:K,color:B,border:w,decimals:U,distr:W=i.L4.Linear}=this.props;const V=`${m}px ${N.typography.fontFamily}`,_=N.isDark?"rgba(240, 250, 255, 0.09)":"rgba(0, 10, 23, 0.09)";(0,n.j9)(c)&&(x=[0,1]),U===0&&W===i.L4.Linear&&(T=(G,j)=>j.map(Y=>Number.isInteger(Y)?Y:null));let H={scale:c,show:p,stroke:B??N.colors.text.primary,side:g(v),font:V,size:K??((G,j,Y)=>this.calculateAxisSize(G,j,Y)),rotate:F,gap:M,labelGap:0,grid:{show:D.show,stroke:_,width:1/devicePixelRatio},ticks:Object.assign({show:!0,stroke:w?.show?B??N.colors.text.primary:_,width:1/devicePixelRatio,size:4},E),splits:x,values:C,space:S??((G,j,Y,oe,se)=>this.calculateSpace(G,j,Y,oe,se)),filter:T,incrs:O};return w?.show&&(H.border={stroke:B??N.colors.text.primary,width:1/devicePixelRatio,...w}),y!=null&&y.length>0&&(H.label=y,H.labelSize=m+s,H.labelFont=V,H.labelGap=s),C?H.values=C:R?H.values=b:A&&(H.values=(G,j,Y,oe,se)=>{let ne=(0,a.E)((0,a.h)(se,6));return j.map(ee=>A(ee,ne>0?ne:void 0))}),H.timeZone=L,H}}const u={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:28*24*60*60*1e3,year:365*24*60*60*1e3};function b(P,c,y,p,v){const D=P.axes[y],E="timeZone"in D&&typeof D.timeZone=="string"?D.timeZone:void 0,S=P.scales.x,T=(S?.max??0)-(S?.min??0),M=Math.round(u.year/u.day)*u.day,A=Math.round(v/u.day)*u.day;let x=o.WC.interval.year;return v<u.second?x=o.WC.interval.millisecond:v<=u.minute?x=o.WC.interval.second:T<=u.day?x=o.WC.interval.minute:v<=u.day?x=o.WC.interval.hour:T<u.year?x=o.WC.interval.day:A===M?x=o.WC.interval.year:v<=u.year&&(x=o.WC.interval.month),c.map(C=>C==null?"":(0,r.LE)(C,{format:x,timeZone:E}))}function g(P){switch(P){case i.vM.Top:return 0;case i.vM.Right:return 1;case i.vM.Bottom:return 2;case i.vM.Left:}return 3}},51336:(Q,I,e)=>{"use strict";e.d(I,{e:()=>D});var n=e(2543),a=e(36613),o=e(43127),r=e(91410),i=e(52622),f=e(16895),d=e(30501),l=e(93060),m=e(24293),s=e(23596),h=e(52811),u=e(74863);class b extends h.R{getConfig(){const{facets:S,drawStyle:T,pathBuilder:M,pointsBuilder:A,pointsFilter:x,lineInterpolation:C,lineWidth:O,lineStyle:R,barAlignment:L,barWidthFactor:N,barMaxWidth:F,showPoints:K,pointSize:B,scaleKey:w,pxAlign:U,spanNulls:W,show:V=!0}=this.props;let _={},H=this.getLineColor();_.stroke=H,_.width=O,R&&R.fill!=="solid"&&(R.fill==="dot"&&(_.cap="round"),_.dash=R.dash??[10,10]),M!=null?_.paths=M:T===i.GR.Points?_.paths=()=>null:T!=null&&(_.paths=(Y,oe,se,ne)=>P(T,C,L,N,F)(Y,oe,se,ne));const G=typeof H=="string"?H:(Y,oe)=>Y.series[oe]._stroke,j={points:{stroke:G,fill:G,size:!B||B<O?void 0:B,filter:x}};return A!=null?j.points.show=A:T===i.GR.Points?j.points.show=!0:K===i.yL.Auto?T===i.GR.Bars&&(j.points.show=!1):K===i.yL.Never?j.points.show=!1:K===i.yL.Always&&(j.points.show=!0),{scale:w,facets:S,spanGaps:typeof W=="number"?!1:W,value:()=>"",pxAlign:U,show:V,fill:this.getFill(),..._,...j}}getLineColor(){const{lineColor:S,gradientMode:T,colorMode:M,thresholds:A,theme:x,hardMin:C,hardMax:O,softMin:R,softMax:L,dynamicSeriesColor:N}=this.props;return T===i.on.None&&N?(F,K)=>N(K)??S??m.F:T===i.on.Scheme&&M?.id!==m.Y.Fixed?(0,u.pl)(1,x,M,A,C,O,R,L):T===i.on.Hue?(0,u.B5)(S??m.F,1,x):S??m.F}getFill(){const{lineColor:S,fillColor:T,gradientMode:M,fillOpacity:A,colorMode:x,thresholds:C,theme:O,hardMin:R,hardMax:L,softMin:N,softMax:F,dynamicSeriesColor:K}=this.props;if(T)return T;const B=M??i.on.None,w=(A??0)/100;if(B===i.on.None&&K&&w>0)return(U,W)=>{let V=U.series[W]._stroke;return s.alpha(V??"",w)};switch(B){case i.on.Opacity:return(0,u.WO)(T??S,w);case i.on.Hue:return(0,u.B5)(T??S,w,O);case i.on.Scheme:if(x?.id!==m.Y.Fixed)return(0,u.pl)(w,O,x,C,R,L,N,F);default:if(w>0)return s.alpha(S??"",w)}}}let g;function P(E,S,T=i.Nj.Center,M=.6,A=200){const x=a.A.paths;if(g||(g={linear:x.linear(),smooth:x.spline(),stepBefore:x.stepped({align:-1}),stepAfter:x.stepped({align:1})}),E===i.GR.Bars){let C=`bars|${T}|${M}|${A}`;return g[C]||(g[C]=x.bars({size:[M,A],align:T})),g[C]}else if(E===i.GR.Line){if(S===i.dx.StepBefore)return g.stepBefore;if(S===i.dx.StepAfter)return g.stepAfter;if(S===i.dx.Smooth)return g.smooth}return g.linear}var c=e(84140),y=e(50082);function p(E){const S=E.config.mode===i.Ly.Dashed||E.config.mode===i.Ly.DashedAndArea?[10,10]:[];function T(K,B,w,U){let W=K.ctx,V=0;for(let _=0;_<w.length;_++)if(w[_].color==="transparent"){V=_;break}W.lineWidth=2,W.setLineDash(S);for(let _=1;_<w.length;_++){const H=w[_];let G;V>=_&&_>0?G=(0,c.A)(U.visualization.getColorByName(w[_-1].color)):G=(0,c.A)(U.visualization.getColorByName(H.color)),G.getAlpha()===1&&G.setAlpha(.7);let j=Math.round(K.bbox.left),Y=Math.round(K.valToPos(H.value,B,!0)),oe=Math.round(K.bbox.left+K.bbox.width),se=Math.round(K.valToPos(H.value,B,!0));W.beginPath(),W.moveTo(j,Y),W.lineTo(oe,se),W.strokeStyle=G.toString(),W.stroke()}}function M(K,B,w,U){let W=K.ctx,V=(0,u.Z8)(K,B,w.map(_=>{let H=(0,c.A)(U.visualization.getColorByName(_.color));return H.getAlpha()===1&&H.setAlpha(.15),[_.value,H.toString()]}),!0);W.fillStyle=V,W.fillRect(K.bbox.left,K.bbox.top,K.bbox.width,K.bbox.height)}const{scaleKey:A,thresholds:x,theme:C,config:O,hardMin:R,hardMax:L,softMin:N,softMax:F}=E;return K=>{const B=K.ctx,{min:w,max:U}=K.scales.x,{min:W,max:V}=K.scales[A];if(w==null||U==null||W==null||V==null)return;let{steps:_,mode:H}=x;if(H===y.O.Percentage){let[G,j]=(0,u.EJ)(K,A,R,L,N,F),Y=j-G;_=_.map(oe=>({...oe,value:G+Y*(oe.value/100)}))}switch(B.save(),O.mode){case i.Ly.Line:case i.Ly.Dashed:T(K,A,_,C);break;case i.Ly.Area:M(K,A,_,C);break;case i.Ly.LineAndArea:case i.Ly.DashedAndArea:M(K,A,_,C),T(K,A,_,C)}B.restore()}}const v={drag:{setScale:!1},points:{size:(E,S)=>E.series[S].points.size*2,width:(E,S,T)=>T/4},focus:{prox:30}};class D{constructor(S=o.lE){this.uid=Math.random().toString(36).slice(2),this.series=[],this.axes={},this.scales=[],this.bands=[],this.stackingGroups=[],this.hasLeftAxis=!1,this.hooks={},this.tz=void 0,this.mode=1,this.frames=void 0,this.thresholds={},this.padding=void 0,this.prepData=void 0,this.scaleKeys=["",""],this.tzDate=T=>{let M=new Date(T);return this.tz?a.A.tzDate(M,this.tz):M},this.tz=(0,r.QZ)(S,Date.now())?.ianaName}addHook(S,T){(0,f.uY)("UPlotConfigBuilder",!1,"addHook",S),this.hooks[S]||(this.hooks[S]=[]),this.hooks[S].push(T)}addThresholds(S){this.thresholds[S.scaleKey]||(this.thresholds[S.scaleKey]=S,this.addHook("drawClear",p(S)))}addAxis(S){S.placement=S.placement??i.vM.Auto,S.grid=S.grid??{};let T=S.scaleKey;if(T==="x"&&(T+=S.timeZone??""),this.axes[T]){this.axes[T].merge(S);return}S.placement===i.vM.Auto&&(S.placement=this.hasLeftAxis?i.vM.Right:i.vM.Left),S.placement===i.vM.Left&&(this.hasLeftAxis=!0),S.placement===i.vM.Hidden&&(S.grid.show=!1,S.size=0),this.axes[T]=new d.zH(S)}getAxisPlacement(S){return this.axes[S]?.props.placement??i.vM.Left}setCursor(S){this.cursor=(0,n.merge)({},this.cursor,S)}setMode(S){this.mode=S}setSelect(S){this.select=S}addSeries(S){this.series.push(new b(S))}getSeries(){return this.series}addScale(S){const T=this.scales.find(M=>M.props.scaleKey===S.scaleKey);if(T){T.merge(S);return}this.scales.push(new l.G(S))}addBand(S){this.bands.push(S)}setStackingGroups(S){this.stackingGroups=S}getStackingGroups(){return this.stackingGroups}setPrepData(S){this.prepData=T=>(this.frames=T,S(T,this.getStackingGroups()))}setPadding(S){this.padding=S}getConfig(){if(this.cachedConfig)return this.cachedConfig;const S={...f.NN,mode:this.mode,series:[this.mode===2?null:{value:()=>""}]};S.axes=this.ensureNonOverlappingAxes(Object.values(this.axes)).map(M=>M.getConfig()),S.series=[...S.series,...this.series.map(M=>M.getConfig())],S.scales=this.scales.reduce((M,A)=>({...M,...A.getConfig()}),{}),S.hooks=this.hooks,S.select=this.select;const T=(M="")=>(A,x)=>{let C=A.series[x].points._stroke;if(typeof C!="string"){let O=this.frames[0].fields[x];C=O.display(O.values[A.cursor.idxs[x]]).color}return C+M};return S.cursor=(0,n.merge)({},v,{points:{stroke:T("80"),fill:T()}},this.cursor),S.tzDate=this.tzDate,Array.isArray(this.padding)&&(S.padding=this.padding),this.stackingGroups.forEach(M=>{(0,f.Tz)(M).forEach(A=>{this.addBand(A)})}),this.bands.length&&(S.bands=this.bands),this.cachedConfig=S,S}ensureNonOverlappingAxes(S){const T=S.find(x=>x.props.scaleKey==="x"),M=S.filter(x=>x.props.grid?.show===void 0),A=M.findIndex(x=>x.props.placement===i.vM.Left||x.props.placement===i.vM.Right||x.props.placement===i.vM.Bottom&&x!==T);for(let x=0;x<M.length;x++)M[x]===T||x===A?M[x].props.grid.show=!0:M[x].props.grid.show=!1;return S}}},93060:(Q,I,e)=>{"use strict";e.d(I,{G:()=>f,Y:()=>d});var n=e(36613),a=e(77678),o=e(83195),r=e(52622),i=e(52811);class f extends i.R{merge(m){this.props.min=d("min",this.props.min,m.min),this.props.max=d("max",this.props.max,m.max)}getConfig(){let{isTime:m,scaleKey:s,min:h,max:u,softMin:b,softMax:g,range:P,direction:c,orientation:y,centeredZero:p,decimals:v}=this.props;const D=this.props.distribution,E=m?{}:{distr:D===r.L4.Symlog?4:D===r.L4.Log?3:D===r.L4.Ordinal?2:1,log:D===r.L4.Log||D===r.L4.Symlog?this.props.log??2:void 0,asinh:D===r.L4.Symlog?this.props.linearThreshold??1:void 0};if(D===r.L4.Log){let L=this.props.log,N=L===2?Math.log2:Math.log10;h!=null&&(h<=0?h=null:h=L**Math.floor(N(h))),u!=null&&(u<=0?u=null:u=L**Math.ceil(N(u))),b!=null&&(b<=0?b=null:b=L**Math.floor(N(b))),g!=null&&(g<=0?g=null:g=L**Math.ceil(N(g)))}let S=b==null?3:1,T=g==null?3:1;const M={min:{pad:.1,hard:h??-1/0,soft:b||0,mode:S},max:{pad:.1,hard:u??1/0,soft:g||0,mode:T}};let A=b==null&&h!=null,x=g==null&&u!=null,C=A&&x;const O=(L,N,F,K)=>{const B=L.scales[K];let w=[N,F];if(!C&&N==null&&F==null)return w;let U=B.log??10;if(B.distr===1||B.distr===2||B.distr===4){if(p){let W=Math.abs(N),V=Math.abs(F),_=Math.max(W,V);_===0&&(_=80),N=-_,F=_}B.distr===4?w=n.A.rangeAsinh(N,F,U,!0):w=n.A.rangeNum(A?h:N,x?u:F,M)}else B.distr===3&&(w=n.A.rangeLog(h??N,u??F,U,!0));if(v===0)if(B.distr===1||B.distr===2)w[0]=(0,a.rs)(w[0],1),w[1]=(0,a.Uh)(w[1],1);else if(B.distr===3){let W=B.log===2?Math.log2:Math.log10;if(w[0]<=1)w[0]=1;else{let _=Math.floor(W(w[0]));w[0]=U**_}let V=Math.ceil(W(w[1]));w[1]=U**V,w[0]===w[1]&&(w[1]*=U)}else B.distr===4&&(w[0]=(0,a.rs)(w[0],1),w[1]=(0,a.Uh)(w[1],1));return(B.distr===1||B.distr===4)&&(A&&(w[0]=h),x&&(w[1]=u)),w[0]>=w[1]&&(w[0]=B.distr===3?1:0,w[1]=100),w};let R=!m&&!C;return(0,o.j9)(s)&&(R=!1,P=[0,1]),{[s]:{time:m,auto:R,range:P??O,dir:c,ori:y,...E}}}}function d(l,m,s){const h=m!=null,u=s!=null;return h?u?l==="min"?m<s?m:s:m>s?m:s:m:s}},74863:(Q,I,e)=>{"use strict";e.d(I,{B5:()=>m,EJ:()=>b,WO:()=>l,Z8:()=>h,pl:()=>P});var n=e(84140),a=e(23596),o=e(24293),r=e(50082),i=e(52622),f=e(29413);function d(c,y,p){let v=0,D=0,E=0,S=0;return c===3?(D=y.top,S=y.top+y.height):c===2?(v=y.left+y.width,E=y.left):c===1?(D=y.top+y.height,S=y.top):c===0&&(v=y.left,E=y.left+y.width),p.createLinearGradient(v,D,E,S)}function l(c,y){return(p,v)=>{const D=(0,f.Yc)(),E=d(p.scales.x.ori===i.Lt.Horizontal?3:2,p.bbox,D);return E.addColorStop(0,a.alpha(c,y)),E.addColorStop(1,a.alpha(c,0)),E}}function m(c,y,p){return(v,D)=>{const E=(0,f.Yc)(),S=d(v.scales.x.ori===i.Lt.Horizontal?3:2,v.bbox,E),T=(0,n.A)(c).spin(-25).darken(5),M=(0,n.A)(c).saturate(20).spin(20).brighten(10);return p.isDark?(S.addColorStop(0,M.lighten(10).setAlpha(y).toString()),S.addColorStop(1,T.darken(10).setAlpha(y).toString())):(S.addColorStop(0,M.lighten(10).setAlpha(y).toString()),S.addColorStop(1,T.setAlpha(y).toString())),S}}var s=(c=>(c[c.Right=0]="Right",c[c.Up=1]="Up",c[c.Left=2]="Left",c[c.Down=3]="Down",c))(s||{});function h(c,y,p,v=!1){let D=c.scales[y],E=null,S=null;for(let w=0;w<p.length;w++){let U=p[w][0];if((U<=D.min||E==null)&&(E=w),S=w,U>=D.max)break}if(E===S)return p[E][1];let T=p[E][0],M=p[S][0];T===-1/0&&(T=D.min),M===1/0&&(M=D.max);let A=Math.round(c.valToPos(T,y,!0)),x=Math.round(c.valToPos(M,y,!0)),C=A-x;if(C===0)return p[S][1];let O,R,L,N;c.scales.x.ori===i.Lt.Horizontal?(O=L=0,R=A,N=x):(R=N=0,O=A,L=x);let K=(0,f.Yc)().createLinearGradient(O,R,L,N),B;for(let w=E;w<=S;w++){let U=p[w],W=w===E?A:w===S?x:Math.round(c.valToPos(U[0],y,!0)),V=(A-W)/C;v&&w>E&&K.addColorStop(V,B),K.addColorStop(V,B=U[1])}return K}function u(c,y){let p=c.scales[y],v=1/0,D=-1/0;return c.series.forEach((E,S)=>{if(E.show&&E.scale===y)if(E.min==null){let T=c.data[S];for(let M=0;M<T.length;M++)T[M]!=null&&(v=Math.min(v,T[M]),D=Math.max(D,T[M]))}else v=Math.min(v,E.min),D=Math.max(D,E.max)}),D===v&&(v=p.min,D=p.max),[v,D]}function b(c,y,p,v,D,E){let S=p??D??null,T=v??E??null;if(S==null||T==null){let[M,A]=u(c,y);S=S??M??0,T=T??A??100}return[S,T]}function g(c){return c==="transparent"||c[0]==="#"&&c.slice(-2)==="00"}function P(c,y,p,v,D,E,S,T){if(!p)throw Error("Missing colorMode required for color scheme gradients");if(!v)throw Error("Missing thresholds required for color scheme gradients");return(M,A)=>{let x=M.series[A].scale,C="";if(p.id===o.Y.Thresholds)if(v.mode===r.O.Absolute){const O=v.steps.map(R=>[R.value,g(R.color)?"#0000":a.alpha(y.visualization.getColorByName(R.color),c)]);C=h(M,x,O,!0)}else{const[O,R]=b(M,x,D,E,S,T),L=R-O,N=v.steps.map(F=>[O+L*(F.value/100),a.alpha(y.visualization.getColorByName(F.color),c)]);C=h(M,x,N,!0)}else if(p.getColors){const O=p.getColors(y),[R,L]=b(M,x,D,E,S,T),N=L-R,F=O.map((K,B)=>[R+N*(B/(O.length-1)),a.alpha(y.visualization.getColorByName(K),c)]);C=h(M,x,F,!1)}return C}}},78226:(Q,I,e)=>{"use strict";e.d(I,{a:()=>i});var n=e(96540),a=e(1604),o=e(6967),r=e(97620);function i({id:f,events:d,renderEventMarker:l,mapEventToXYCoords:m,config:s}){const h=(0,n.useRef)(),[u,b]=(0,n.useState)(0),g=(0,a.A)();(0,n.useLayoutEffect)(()=>{s.addHook("init",c=>{h.current=c}),s.addHook("draw",()=>{g()&&b(c=>c+1)})},[s,b]);const P=(0,n.useMemo)(()=>{const c=[];if(!h.current||d.length===0)return c;for(let y=0;y<d.length;y++){const p=d[y];for(let v=0;v<p.length;v++){const D=m(p,{fieldIndex:v,frameIndex:y});D&&c.push(n.createElement(o.p,{...D,key:`${f}-marker-${y}-${v}`},l(p,{fieldIndex:v,frameIndex:y})))}}return n.createElement(n.Fragment,null,c)},[d,l,u]);return h.current?n.createElement(r._,{left:h.current.bbox.left/window.devicePixelRatio,top:h.current.bbox.top/window.devicePixelRatio},P):null}},6967:(Q,I,e)=>{"use strict";e.d(I,{p:()=>a});var n=e(96540);const a=({x:o,y:r,children:i})=>n.createElement("div",{style:{position:"absolute",top:`${r}px`,left:`${o}px`}},i)},97620:(Q,I,e)=>{"use strict";e.d(I,{_:()=>o});var n=e(32196),a=e(96540);const o=({children:r,left:i,top:f})=>{const d=(0,a.useMemo)(()=>(0,n.css)({position:"absolute",overflow:"visible",left:`${i}px`,top:`${f}px`}),[i,f]);return a.createElement("div",{className:d},r)}},96747:(Q,I,e)=>{"use strict";e.d(I,{_X:()=>o._,a:()=>n.a,pH:()=>a.p});var n=e(78226),a=e(6967),o=e(97620)},55129:(Q,I,e)=>{"use strict";e.d(I,{M:()=>o});var n=e(52622),a=e(52811);function o(i,f){const d="na",l=`${i.min!==void 0?i.min:d}-${i.max!==void 0?i.max:d}`,m=`${i.custom?.axisSoftMin!==void 0?i.custom.axisSoftMin:d}-${i.custom?.axisSoftMax!==void 0?i.custom.axisSoftMax:d}`,s=`${i.custom?.axisPlacement!==void 0?i.custom?.axisPlacement:n.vM.Auto}`,h=i.unit??a.s,u=i.custom?.scaleDistribution?r(i.custom.scaleDistribution):n.L4.Linear,b=i.custom?.axisLabel?i.custom.axisLabel:d;return`${h}/${l}/${m}/${s}/${u}/${b}/${f}`}function r(i){return i.type===n.L4.Log?`${i.type}${i.log}`:i.type}},68268:(Q,I,e)=>{"use strict";e.d(I,{K:()=>l});var n=e(2543),a=e.n(n),o=e(96540),r=e(64423),i=e(99165),f=e(69129),d=e(26272);const l=({config:m,eventBus:s,frame:h})=>{const u=(0,o.useRef)(h);return u.current=h,(0,o.useLayoutEffect)(()=>{let b=null;const g={point:{time:null},data:u.current};m.addHook("init",S=>{b=S});let P=null;m.addHook("setSeries",(S,T)=>{P=T}),m.addHook("setLegend",()=>{if(!(b.cursor.event==null)){let T=b.cursor.idxs.find(M=>M!=null);if(T==null)E();else{let M=T,A=P,x=b.data[0]??b.data[1][0];g.point.time=x[M],g.rowIndex=M??void 0,g.columnIndex=A??void 0,g.data=u.current;let C=b.cursor.top;g.point.panelRelY=C===0?.001:C>0?C/b.rect.height:1,D()}}});function c(S){const T=S.payload?.point?.time;if(T){const M=b.valToPos(T,"x");b.setCursor({left:M,top:b.rect.height/2})}}const y=new r.yU,p=new f.b_(g).setTags(["uplot"]),v=new f.ql().setTags(["uplot"]);let D=(0,n.throttle)(()=>{s.publish(p)},100),E=(0,n.throttle)(()=>{s.publish(v)},100);return y.add(s.getStream(f.b_).subscribe({next:S=>{s===S.origin||S.tags?.has("uplot")||c(S)}})),y.add(s.getStream(d.kb).subscribe({next:S=>c(S)})),y.add(s.getStream(f.ql).pipe((0,i.c)(50)).subscribe({next:S=>{s===S.origin||S.tags?.has("uplot")||b.cursor._lock||b.setCursor({left:-10,top:-10})}})),()=>{y.unsubscribe()}},[m]),null}},23117:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>l});var n=e(2543),a=e.n(n),o=e(96540);const r=.1,i=2,f=new Set(["ArrowRight","ArrowLeft","ArrowUp","ArrowDown","Shift"," "]),d=m=>{let s=m.root,h=new Set,u=null,b=null;if(!s)return;s.tabIndex=0;const g=(E,S)=>{const{cursor:T}=m;if(T.left===void 0||T.top===void 0)return;const{width:M,height:A}=m.over.style,[x,C]=[Math.floor(parseFloat(M)),Math.floor(parseFloat(A))];m.setCursor({left:(0,n.clamp)(T.left+E,0,x),top:(0,n.clamp)(T.top+S,0,C)})},P=E=>{if(h.size===0||!m){b=null;return}const M=(E-(b??E))*r;let A=0,x=0;h.has("ArrowUp")&&(x-=M),h.has("ArrowDown")&&(x+=M),h.has("ArrowLeft")&&(A-=M),h.has("ArrowRight")&&(A+=M),h.has("Shift")&&(A*=i,x*=i),g(A,x);const{cursor:C}=m;if(h.has(" ")&&C){const O=Number(m.over.style.height.slice(0,-2));m.setSelect({left:C.left<u?C.left:u,top:0,width:Math.abs(C.left-(u??C.left)),height:O},!1)}b=E,window.requestAnimationFrame(P)},c=E=>{if(E.key==="Tab"){m.setCursor({left:-5,top:-5});return}if(!f.has(E.key))return;if(E.preventDefault(),E.stopPropagation(),!h.has(E.key)){const T=h.size===0;h.add(E.key),u=E.key===" "&&u===null?m.cursor.left:u,T&&window.requestAnimationFrame(P)}},y=E=>{f.has(E.key)&&(h.delete(E.key),E.key===" "&&(E.preventDefault(),E.stopPropagation(),m.setSelect(m.select),u=null))},p=()=>{if(!s?.matches(":focus-visible"))return;const E=parseFloat(m.over.style.width),S=parseFloat(m.over.style.height);m.setCursor({left:E/2,top:S/2})},v=()=>{b=null,u=null,h.clear(),m.setSelect({left:0,top:0,width:0,height:0},!1)};s.addEventListener("keydown",c),s.addEventListener("keyup",y),s.addEventListener("focus",p),s.addEventListener("blur",v);const D=()=>{s?.removeEventListener("keydown",c),s?.removeEventListener("keyup",y),s?.removeEventListener("focus",p),s?.removeEventListener("blur",v),s=null};(m.hooks.destroy??=[]).push(D)},l=({config:m})=>((0,o.useLayoutEffect)(()=>m.addHook("init",d),[m]),null)},77455:(Q,I,e)=>{"use strict";e.d(I,{b3:()=>u,xl:()=>y});var n=e(32196),a=e(96540),o=e(40961),r=e(73134),i=e(40845),f=e(17464),d=e(29158);const l=({onClick:v,"aria-label":D,style:E})=>{const S=(0,i.of)(m);return a.createElement(d.K,{"aria-label":D??"Close",className:S,name:"times",onClick:v,style:E})},m=v=>(0,n.css)({position:"absolute",margin:"0px",right:v.spacing(1),top:v.spacing(1.25)}),s=void 0,h=10;var u=(v=>(v[v.xOne=0]="xOne",v[v.xAll=1]="xAll",v[v.xyOne=2]="xyOne",v))(u||{});function b(v,D){return{...v,...D,style:{...v.style,...D.style}}}function g(){return{style:{transform:"",pointerEvents:"none"},isHovering:!1,isPinned:!1,contents:null,plot:null,dismiss:()=>{}}}const P=5,c=v=>v!=null&&!v.ctrlKey&&!v.metaKey,y=({config:v,hoverMode:D,render:E,clientZoom:S=!1,queryZoom:T,onSelectRange:M,maxWidth:A,syncMode:x=r.yV.Off,syncScope:C="global"})=>{const O=(0,a.useRef)(null),R=(0,a.useRef)(null);R.current==null&&(R.current=(0,f.gF)());const[{plot:L,isHovering:N,isPinned:F,contents:K,style:B,dismiss:w},U]=(0,a.useReducer)(b,null,g),W=(0,a.useRef)(),V=(0,i.of)(p,A),_=(0,a.useRef)(E);return _.current=E,(0,a.useLayoutEffect)(()=>{W.current={width:0,height:0,observer:new ResizeObserver(Me=>{let $e=W.current;for(const ke of Me)ke.borderBoxSize?.length>0?($e.width=ke.borderBoxSize[0].inlineSize,$e.height=ke.borderBoxSize[0].blockSize):($e.width=ke.contentRect.width,$e.height=ke.contentRect.height)})};let H=!1,G=!1,j=L,Y=N,oe=!1,se=F,ne=B,ee=!1;const Z=x===r.yV.Tooltip;x!==r.yV.Off&&v.scales[0].props.isTime&&v.setCursor({sync:{key:C,scales:["x",null]}});const z=()=>{Se?Y=ee&&oe&&Z:Y=fe!=null||D===1&&oe};let q=0,ie=0,de=null,ue=L?.cursor.idxs.slice(),fe=null,Se=!1,he=!1,ce=!1;const me=(Me=!1)=>{he||(Y?queueMicrotask(ye):setTimeout(ye,100),he=!0),Me&&(ce=!0)},pe=Me=>{O.current.contains(Me.target)||Pe()},ye=()=>{he=!1,ce&&(ne={pointerEvents:se?"all":"none"},j.cursor._lock=se,se?(document.addEventListener("mousedown",pe,!0),document.addEventListener("keydown",pe,!0)):(document.removeEventListener("mousedown",pe,!0),document.removeEventListener("keydown",pe,!0)),ce=!1);let Me={style:ne,isPinned:se,isHovering:Y,contents:Y||de!=null?_.current(j,ue,fe,se,Pe,de,Se):null,dismiss:Pe};U(Me),de=null},Pe=()=>{let Me=se;se=!1,Y=!1,j.setCursor({left:-10,top:-10}),me(Me)};v.addHook("init",Me=>{U({plot:j=Me}),S&&Me.over.addEventListener("mousedown",$e=>{if(c($e)&&$e.button===0&&$e.shiftKey){G=!0,Me.cursor.drag.x=!1,Me.cursor.drag.y=!0;let ke=Ze=>{Me.cursor.drag.x=!0,Me.cursor.drag.y=!1,document.removeEventListener("mouseup",ke,!0)};document.addEventListener("mouseup",ke,!0)}},!0),Me.over.addEventListener("click",$e=>{if($e.target===Me.over)if($e.ctrlKey||$e.metaKey){let ke;Me.scales.x.ori===0?ke=Me.posToVal(Me.cursor.left,"x"):ke=Me.posToVal(Me.select.top+Me.select.height,"x"),de={from:ke,to:ke},me(!1)}else Y&&fe!=null&&!se&&(se=!0,me(!0))})}),v.addHook("setSelect",Me=>{const $e=Me.scales.x.ori===0;if(!Se&&(S||T!=null))if(c(Me.cursor.event)){if(M!=null){let ke=[];const Ze=!!Me.cursor.drag.y,ot=!!Me.cursor.drag.x;let xt=null,ct=[];ot&&(xt={from:$e?Me.posToVal(Me.select.left,"x"):Me.posToVal(Me.select.top+Me.select.height,"x"),to:$e?Me.posToVal(Me.select.left+Me.select.width,"x"):Me.posToVal(Me.select.top,"x")}),Ze&&v.scales.forEach(ft=>{const Le=ft.props.scaleKey;if(Le!=="x"){let re={from:$e?Me.posToVal(Me.select.top+Me.select.height,Le):Me.posToVal(Me.select.left+Me.select.width,Le),to:$e?Me.posToVal(Me.select.top,Le):Me.posToVal(Me.select.left,Le)};ct.push(re)}}),ot?Ze?ke=ct.map(ft=>({x:xt,y:ft})):ke=[{x:xt}]:Ze&&(ke=ct.map(ft=>({y:ft}))),M(ke)}else if(S&&G){if(Me.select.height>=P){for(let ke in Me.scales)if(ke!=="x"){const Ze=$e?Me.posToVal(Me.select.top,ke):Me.posToVal(Me.select.left+Me.select.width,ke),ot=$e?Me.posToVal(Me.select.top+Me.select.height,ke):Me.posToVal(Me.select.left,ke);Me.setScale(ke,{min:ot,max:Ze})}H=!0}G=!1}else if(T!=null&&Me.select.width>=P){const ke=$e?Me.posToVal(Me.select.left,"x"):Me.posToVal(Me.select.top+Me.select.height,"x"),Ze=$e?Me.posToVal(Me.select.left+Me.select.width,"x"):Me.posToVal(Me.select.top,"x");T({from:ke,to:Ze}),H=!1}}else de={from:$e?Me.posToVal(Me.select.left,"x"):Me.posToVal(Me.select.top+Me.select.height,"x"),to:$e?Me.posToVal(Me.select.left+Me.select.width,"x"):Me.posToVal(Me.select.top,"x")},me(!0);Me.setSelect({left:0,width:0,top:0,height:0},!1)}),(S||T!=null)&&v.setCursor({bind:{dblclick:Me=>()=>{if(!c(Me.cursor.event))return null;if(S&&H){for(let $e in Me.scales)$e!=="x"&&Me.setScale($e,{min:null,max:null});H=!1}else if(T!=null){let $e=Me.scales.x;const ke=$e.min,Ze=$e.max,ot=(Ze-ke)/2;T({from:ke-ot,to:Ze+ot})}return null}}}),v.addHook("setData",Me=>{H=!1,G=!1,Pe()}),v.addHook("setSeries",(Me,$e)=>{fe=$e,Se=Me.cursor.event==null,z(),me()}),v.addHook("setLegend",Me=>{ue=j?.cursor.idxs.slice(),oe=ue.some((ke,Ze)=>Ze>0&&ke!=null),Se=Me.cursor.event==null;let $e=Y;z(),(Y||Y!==$e)&&me()});const Ie=16;let Oe=0,Ne=0;const We=()=>{Y&&!se&&Pe(),Oe=window.innerWidth-Ie,Ne=window.innerHeight-Ie},Ae=()=>{ee=j.rect.bottom<=Ne&&j.rect.top>=0&&j.rect.left>=0&&j.rect.right<=Oe};We(),v.addHook("ready",Ae),v.addHook("setCursor",Me=>{if(Se=Me.cursor.event==null,!Y)return;let{left:$e=-10,top:ke=-10}=Me.cursor;if($e>=0||ke>=0){let Ze=Me.rect.left+$e,ot=Me.rect.top+ke,xt="",{width:ct,height:ft}=W.current;ct+=h,ft+=h,ie!==0?ot+ft<Ne||ot-ft<0?ie=0:ie!==-ft&&(ie=-ft):ot+ft>Ne&&ot-ft>=0&&(ie=-ft),q!==0?Ze+ct<Oe||Ze-ct<0?q=0:q!==-ct&&(q=-ct):Ze+ct>Oe&&Ze-ct>=0&&(q=-ct);const Le=Ze+(q===0?h:-h),re=ot+(ie===0?h:-h);xt=`translateX(${Le}px) ${q===0?"":"translateX(-100%)"} translateY(${re}px) ${ie===0?"":"translateY(-100%)"}`,O.current!=null?O.current.style.transform=xt:(ne.transform=xt,me())}});const Ue=Me=>{Ae(),Y&&!se&&Me.target instanceof HTMLElement&&Me.target.contains(j.root)&&Pe()};return window.addEventListener("resize",We),window.addEventListener("scroll",Ue,!0),()=>{window.removeEventListener("resize",We),window.removeEventListener("scroll",Ue,!0),document.removeEventListener("mousedown",pe,!0),document.removeEventListener("keydown",pe,!0)}},[v]),(0,a.useLayoutEffect)(()=>{const H=W.current;if(O.current!=null){H.observer.observe(O.current);const{width:G,height:j}=O.current.getBoundingClientRect();H.width=G,H.height=j;const Y=L.cursor.event;Y!=null?!(performance.now()-Y.timeStamp>16)&&L.over.dispatchEvent(Y):L.setCursor({left:L.cursor.left,top:L.cursor.top},!0)}else H.width=0,H.height=0},[N]),L&&N?(0,o.createPortal)(a.createElement("div",{className:(0,n.cx)(V.tooltipWrapper,F&&V.pinned),style:B,"aria-live":"polite","aria-atomic":"true",ref:O},F&&a.createElement(l,{onClick:w}),K),R.current):null},p=(v,D)=>({tooltipWrapper:(0,n.css)({top:0,left:0,zIndex:v.zIndex.portal,whiteSpace:"pre",borderRadius:v.shape.radius.default,position:"fixed",background:v.colors.background.primary,border:`1px solid ${v.colors.border.weak}`,boxShadow:v.shadows.z2,userSelect:"text",maxWidth:D??"none"}),pinned:(0,n.css)({boxShadow:v.shadows.z3})})},66737:(Q,I,e)=>{"use strict";e.d(I,{Ku:()=>a.K,Z7:()=>o.Z,xl:()=>n.xl});var n=e(77455),a=e(68268),o=e(23117)},52811:(Q,I,e)=>{"use strict";e.d(I,{R:()=>a,s:()=>n});const n="__fixed";class a{constructor(r){this.props=r}}},16895:(Q,I,e)=>{"use strict";e.d(I,{NN:()=>s,Tz:()=>u,UO:()=>p,bq:()=>g,ro:()=>b,sw:()=>P,uY:()=>D});var n=e(11261),a=e(50311),o=e(75059),r=e(57875),i=e(52622),f=e(40621),d=e(91040),l=e(55129);const m=(E,S,T)=>{let M=S%2?T[0]||T[2]:T[1]||T[3];return T[S]||!M?0:8},s={ms:1,focus:{alpha:1},cursor:{focus:{prox:30}},legend:{show:!1},padding:[m,m,m,m],series:[],hooks:{}};var h=(E=>(E[E.Pos=1]="Pos",E[E.Neg=-1]="Neg",E))(h||{});function u(E){let S=[],{series:T,dir:M}=E,A=T.length-1,x=T.slice().reverse();return x.forEach((C,O)=>{if(O!==A){let R=x[O+1];S.push({series:[C,R],dir:-1*M})}}),S}function b(E){let S=new Map;return E.fields.forEach(({config:T,values:M,type:A},x)=>{if(x===0)return;let{custom:C}=T;if(C==null||C.hideFrom?.viz)return;let{stacking:O}=C;if(O==null)return;let{mode:R,group:L}=O;if(R===i.gs.None)return;let N=C.transform,F=c(N,M),K=C.drawStyle,B=K===i.GR.Bars?C.barAlignment:K===i.GR.Line?C.lineInterpolation:null,w=`${F}|${R}|${L}|${(0,l.M)(T,A)}|${K}|${B}`,U=S.get(w);U==null&&(U={series:[],dir:F},S.set(w,U)),U.series.push(x)}),[...S.values()]}function g(E,S,T){let M=Array(E.fields.length),A=S.length,x=E.length,C=A>0?Array(x).fill(0):[],O=A>0?Array(x).fill(!1):[],R=Array.from({length:A},()=>C.slice()),L=Array.from({length:A},()=>O.slice());if(S.forEach((N,F)=>{let K=L[F];N.series.forEach(B=>{let w=E.fields[B];if(w.config.custom?.hideFrom?.viz)return;let U=w.values;for(let W=0;W<x;W++)U[W]!=null&&(K[W]=!0)})}),E.fields.forEach((N,F)=>{let K=N.values;if(F===0){N.type===n.PU.time?M[0]=(0,a.ks)(N).values:M[0]=K;return}let{custom:B}=N.config;if(!B||B.hideFrom?.viz){M[F]=K;return}if(B.transform===i.NU.Constant){let U=K.findIndex(V=>V!=null),W=K[U];K=Array(K.length).fill(void 0),K[U]=W}else if(K=K.slice(),B.transform===i.NU.NegativeY)for(let U=0;U<K.length;U++)K[U]!=null&&(K[U]*=-1);let w=B.stacking?.mode;if(!w||w===i.gs.None)M[F]=K;else{let U=S.findIndex(H=>H.series.indexOf(F)>-1),W=R[U],V=L[U],_=M[F]=Array(x);for(let H=0;H<x;H++){let G=K[H];G!=null?_[H]=W[H]+=G:_[H]=V[H]?W[H]:G}}}),T){let N=M.map((F,K)=>{let B=S.findIndex(w=>w.series.indexOf(K)>-1);return B!==-1?R[B]:F});T({totals:N})}return E.fields.forEach((N,F)=>{if(F===0||N.config.custom?.hideFrom?.viz)return;if(N.config.custom?.stacking?.mode===i.gs.Percent){let B=S.findIndex(V=>V.series.indexOf(F)>-1),w=R[B],U=S[B],W=M[F];for(let V=0;V<x;V++){let _=W[V];_!=null&&(W[V]=w[V]===0?0:U.dir*(_/w[V]))}}}),M}function P(E,S){let T,M=1,A=1,x=E.data[1][S],C=E.data[1][S];for(let O=1;O<E.data.length;O++){const L=E.data[O][S];L!=null&&(x==null?x=L:L>x&&(x=E.data[O][S],M=O),C==null?C=L:L<C&&(C=E.data[O][S],A=O))}return C==null&&x==null?T=void 0:C!=null&&x!=null?T=(E.valToPos(C,E.series[A].scale)+E.valToPos(x,E.series[M].scale))/2:T=E.valToPos(C||x,E.series[M||A].scale),T!==void 0&&T<0&&(T=E.bbox.height/devicePixelRatio),T}function c(E,S){const T=y(S);return E===i.NU.NegativeY?T?1:-1:T?-1:1}function y(E,S=100){const T=E.length;if(T===0)return!1;let M=0,A=T-1;for(;M<=A&&E[M]==null;)M++;for(;A>=M&&E[A]==null;)A--;let x=0,C=0;if(A>=M){const O=Math.max(1,Math.floor((A-M+1)/S));for(let R=M;R<=A;R+=O){const L=E[R];L!=null&&typeof L=="number"&&(L<0||Object.is(L,-0)?x++:L>0&&C++)}if(x>C)return!0}return!1}const p=(E,S,T)=>{if(!E?.length)return[];const M=O=>O==null?"-":O.toFixed(1),A=S.display??M;let x=null;const C=(0,o.Nw)({field:S,reducers:E});return E.map(O=>{const R=o.AS.get(O);let L=A;return R.id===o.gy.diffperc&&(L=(0,r.J)({field:{...S,config:{...S.config,unit:"percent"}},theme:T})),(R.id===o.gy.count||R.id===o.gy.changeCount||R.id===o.gy.distinctCount)&&(x||(x=(0,r.J)({field:{...S,config:{...S.config,unit:"none"}},theme:T})),L=x),{...L(C[O]),title:R.name,description:R.description}})},v=(0,d.h)("uPlot"),D=v.logger;(0,f.h)("graphng",void 0,v)},48747:(Q,I,e)=>{"use strict";e.d(I,{T:()=>c});var n=e(34796),a=e.n(n),o=e(2543),r=e(96540),i=e(61443),f=e(52622),d=e(75128),l=e(33083),m=e(3139),s=e(65036);const h=({dimensions:p,activeDimensions:v,pos:D,timeZone:E})=>{let S=null;if(v.xAxis===null)return null;v.yAxis&&(S=v.yAxis[0]);const T=v.xAxis[1]?(0,i.WK)(p.xAxis,v.xAxis[0],v.xAxis[1]):D.x,M=(0,s.DU)(p.yAxis.columns,p.xAxis.columns,T,E),A=M.time,x=M.results.map((C,O)=>({color:C.color,label:C.label,value:C.value,isActive:S===O}));return r.createElement(m.o,{series:x,timestamp:A})};h.displayName="MultiModeGraphTooltip";var u=e(83195),b=e(28240);const g=({dimensions:p,activeDimensions:v,timeZone:D})=>{if(v.yAxis===null||v.yAxis[1]===void 0||v.xAxis===null||v.xAxis[1]===void 0)return null;const E=(0,i.WK)(p.xAxis,v.xAxis[0],v.xAxis[1]),S=(0,i.P4)(p.xAxis,v.xAxis[0]),T=S.display?(0,u.cN)(S.display(E)):E,M=(0,i.P4)(p.yAxis,v.yAxis[0]),A=(0,i.WK)(p.yAxis,v.yAxis[0],v.yAxis[1]),x=M.display,C=x(A);return r.createElement(m.o,{series:[{color:C.color,label:(0,b.Ct)(M),value:(0,u.cN)(C)}],timestamp:T})};g.displayName="SingleModeGraphTooltip";const P=({mode:p=f.$N.Single,dimensions:v,activeDimensions:D,pos:E,timeZone:S})=>!D||!D.xAxis?null:p==="single"?r.createElement(g,{dimensions:v,activeDimensions:D,timeZone:S}):r.createElement(h,{dimensions:v,activeDimensions:D,pos:E,timeZone:S});P.displayName="GraphTooltip";class c extends r.PureComponent{constructor(){super(...arguments),this.state={isTooltipVisible:!1,isContextVisible:!1},this.element=null,this.$element=null,this.onPlotSelected=(v,D)=>{const{onHorizontalRegionSelected:E}=this.props;E&&E(D.xaxis.from,D.xaxis.to)},this.onPlotHover=(v,D,E)=>{this.setState({isTooltipVisible:!0,activeItem:E,pos:D})},this.onPlotClick=(v,D,E)=>{this.setState({isContextVisible:!0,isTooltipVisible:!1,contextItem:E,contextPos:D})},this.renderTooltip=()=>{const{children:v,series:D,timeZone:E}=this.props,{pos:S,activeItem:T,isTooltipVisible:M}=this.state;let A;if(!M||!S||D.length===0||(r.Children.forEach(v,B=>{if(A)return;(B&&B.type&&(B.type.displayName||B.type.name))===d.n.displayName&&(A=B)}),!A))return null;const x=A.props,C=x.mode||"single";if(!T&&C==="single")return null;const O=x.tooltipComponent||P,R=T?T.series.seriesIndex:0,L=T?T.dataIndex:void 0,N={xAxis:[R,L],yAxis:T?[T.series.seriesIndex,T.dataIndex]:null},F={dimensions:{xAxis:(0,i.r4)("xAxis",D.map(B=>B.timeField)),yAxis:(0,i.r4)("yAxis",D.map(B=>B.valueField))},activeDimensions:N,pos:S,mode:x.mode||f.$N.Single,timeZone:E},K=r.createElement(O,{...F});return r.cloneElement(A,{content:K,position:{x:S.pageX,y:S.pageY},offset:{x:10,y:10}})},this.renderContextMenu=()=>{const{series:v}=this.props,{contextPos:D,contextItem:E,isContextVisible:S}=this.state;if(!S||!D||!E||v.length===0)return null;const T=E?E.series.seriesIndex:0,M=E?E.dataIndex:void 0,A={xAxis:[T,M],yAxis:E?[E.series.seriesIndex,E.dataIndex]:null},x={xAxis:(0,i.r4)("xAxis",v.map(L=>L.timeField)),yAxis:(0,i.r4)("yAxis",v.map(L=>L.valueField))},C=()=>this.setState({isContextVisible:!1}),O=()=>({datapoint:E.datapoint,dataIndex:E.dataIndex,series:E.series,seriesIndex:E.series.seriesIndex,pageX:D.pageX,pageY:D.pageY}),R={x:D.pageX,y:D.pageY,onClose:C,getContextMenuSource:O,timeZone:this.props.timeZone,dimensions:x,contextDimensions:A};return r.createElement(l.H,{...R})},this.getBarWidth=()=>{const{series:v}=this.props;return Math.min(...v.map(D=>D.timeStep))}}static{this.defaultProps={showLines:!0,showPoints:!1,showBars:!1,isStacked:!1,lineWidth:1}}componentDidUpdate(v,D){v!==this.props&&this.draw()}componentDidMount(){this.draw(),this.element&&(this.$element=a()(this.element),this.$element.bind("plotselected",this.onPlotSelected),this.$element.bind("plothover",this.onPlotHover),this.$element.bind("plotclick",this.onPlotClick))}componentWillUnmount(){this.$element&&this.$element.unbind("plotselected",this.onPlotSelected)}getYAxes(v){return v.length===0?[{show:!0,min:-1,max:1}]:(0,o.uniqBy)(v.map(D=>{const E=D.yAxis?D.yAxis.index:1,S=D.yAxis&&D.yAxis.min&&!isNaN(D.yAxis.min)?D.yAxis.min:null,T=D.yAxis&&D.yAxis.tickDecimals&&!isNaN(D.yAxis.tickDecimals)?D.yAxis.tickDecimals:null;return{show:!0,index:E,position:E===1?"left":"right",min:S,tickDecimals:T}}),D=>D.index)}draw(){if(this.element===null)return;const{width:v,series:D,timeRange:E,showLines:S,showBars:T,showPoints:M,isStacked:A,lineWidth:x,timeZone:C,onHorizontalRegionSelected:O}=this.props;if(!v)return;const R=v/100,L=E.from.valueOf(),N=E.to.valueOf(),F=this.getYAxes(D),K={legend:{show:!1},series:{stack:A,lines:{show:S,lineWidth:x,zero:!1},points:{show:M,fill:1,fillColor:!1,radius:2},bars:{show:T,fill:1,barWidth:T?this.getBarWidth()/1.5:1,zero:!1,lineWidth:x},shadowSize:0},xaxis:{timezone:C,show:!0,mode:"time",min:L,max:N,label:"Datetime",ticks:R,timeformat:(0,s.Jc)(R,L,N),tickFormatter:s.Yn},yaxes:F,grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,hoverable:!0,clickable:!0,color:"#a1a1a1",margin:{left:0,right:0},labelMarginX:0,mouseActiveRadius:30},selection:{mode:O?"x":null,color:"#666"},crosshair:{mode:"x"}};try{a().plot(this.element,D.filter(B=>B.isVisible),K)}catch(B){throw console.error("Graph rendering error",B,K,D),new Error("Error rendering panel")}}render(){const{ariaLabel:v,height:D,width:E,series:S}=this.props,T=S.length===0,M=this.renderTooltip(),A=this.renderContextMenu();return r.createElement("div",{className:"graph-panel","aria-label":v},r.createElement("div",{className:"graph-panel__chart",ref:x=>this.element=x,style:{height:D,width:E},onMouseLeave:()=>{this.setState({isTooltipVisible:!1})}}),T&&r.createElement("div",{className:"datapoints-warning"},"No data"),M,A)}}const y=null},33083:(Q,I,e)=>{"use strict";e.d(I,{H:()=>u,i:()=>b});var n=e(32196),a=e(96540),o=e(61443),r=e(72724),i=e(28122),f=e(9286),d=e(66864),l=e(59093),m=e(64539),s=e(94536),h=e(40845);const u=({getContextMenuSource:P,timeZone:c,itemsGroup:y,dimensions:p,contextDimensions:v,...D})=>{const E=P(),S=y?y.map(A=>({...A,items:A.items?.filter(x=>x.label)})):[],T=()=>{if(!E)return null;let A;if(p?.yAxis&&v?.yAxis?.[1]){const C=(0,o.WK)(p.yAxis,v.yAxis[0],v.yAxis[1]),O=E.series.valueField.display;A=O(C)}const x=(0,r.LE)(E.datapoint[0],{defaultWithMS:E.series.hasMsResolution,timeZone:c});return a.createElement(b,{timestamp:x,seriesColor:E.series.color,displayName:E.series.alias||E.series.label,displayValue:A})},M=()=>S?.map((A,x)=>a.createElement(l.r,{key:`${A.label}${x}`,label:A.label},(A.items||[]).map(C=>a.createElement(m.D,{key:`${C.label}`,url:C.url,label:C.label,target:C.target,icon:C.icon,active:C.active,onClick:C.onClick}))));return a.createElement(i.t,{...D,renderMenuItems:M,renderHeader:T})},b=({timestamp:P,seriesColor:c,displayName:y,displayValue:p})=>{const v=(0,h.of)(g);return a.createElement("div",{className:v.wrapper},a.createElement("strong",null,P),a.createElement(d.Gy,null,a.createElement("div",null,a.createElement(s.p,{color:c}),a.createElement("span",{className:v.displayName},y)),p&&a.createElement(f.i,{value:p})))};function g(P){return{wrapper:(0,n.css)({padding:P.spacing(.5,1),fontSize:P.typography.size.sm,zIndex:P.zIndex.tooltip}),displayName:(0,n.css)({whiteSpace:"nowrap",paddingLeft:P.spacing(.5)})}}},84656:(Q,I,e)=>{"use strict";e.d(I,{M:()=>r});var n=e(2543),a=e.n(n),o=e(96540);class r extends o.Component{constructor(f){super(f),this.onSeriesToggle=this.onSeriesToggle.bind(this),this.state={hiddenSeries:[],toggledSeries:f.series}}componentDidUpdate(f){const{series:d}=this.props;(0,n.isEqual)(f.series,d)||this.setState({hiddenSeries:[],toggledSeries:d})}onSeriesToggle(f,d){const{series:l,onHiddenSeriesChanged:m}=this.props,{hiddenSeries:s}=this.state;if(d.ctrlKey||d.metaKey||d.shiftKey){const g=s.indexOf(f)>-1?s.filter(c=>c!==f):s.concat([f]),P=l.map(c=>({...c,isVisible:g.indexOf(c.label)===-1}));this.setState({hiddenSeries:g,toggledSeries:P},()=>m?m(g):void 0);return}const h=l.map(g=>g.label),u=s.length+1===h.length?[]:(0,n.difference)(h,[f]),b=l.map(g=>({...g,isVisible:u.indexOf(g.label)===-1}));this.setState({hiddenSeries:u,toggledSeries:b},()=>m?m(u):void 0)}render(){const{children:f}=this.props,{toggledSeries:d}=this.state;return f({onSeriesToggle:this.onSeriesToggle,toggledSeries:d})}}},5484:(Q,I,e)=>{"use strict";e.d(I,{I:()=>l});var n=e(32196),a=e(96540),o=e(40276),r=e(96516),i=e(40845),f=e(48747);const d=(s,h=!1,u=!1)=>{const b=s.reduce((P,c)=>P+(c[1]||0),0)===0,g=!s.reduce((P,c)=>P&&c[1]!==null,!0);return h&&g||u&&b},l=s=>{const{series:h,timeRange:u,width:b,height:g,showBars:P,showLines:c,showPoints:y,sortLegendBy:p,sortLegendDesc:v,legendDisplayMode:D,legendVisibility:E,placement:S,onSeriesToggle:T,onToggleSort:M,hideEmpty:A,hideZero:x,isStacked:C,lineWidth:O,onHorizontalRegionSelected:R,timeZone:L,children:N,ariaLabel:F}=s,{graphContainer:K,wrapper:B,legendContainer:w}=(0,i.of)(m,s.placement),U=h.reduce((W,V)=>d(V.data,A,x)?W:W.concat([{label:V.label,color:V.color||"",disabled:!V.isVisible,yAxis:V.yAxis.index,getDisplayValues:()=>V.info||[]}]),[]);return a.createElement("div",{className:B,"aria-label":F},a.createElement("div",{className:K},a.createElement(f.T,{series:h,timeRange:u,timeZone:L,showLines:c,showPoints:y,showBars:P,width:b,height:g,isStacked:C,lineWidth:O,onHorizontalRegionSelected:R},N)),E&&a.createElement("div",{className:w},a.createElement(o.E,{hideHorizontalTrack:!0},a.createElement(r.t,{items:U,displayMode:D,placement:S,sortBy:p,sortDesc:v,onLabelClick:(W,V)=>{T&&T(W.label,V)},onToggleSort:M}))))},m=(s,h)=>({wrapper:(0,n.css)({display:"flex",flexDirection:h==="bottom"?"column":"row"}),graphContainer:(0,n.css)({minHeight:"65%",flexGrow:1}),legendContainer:(0,n.css)({padding:"10px 0",maxHeight:h==="bottom"?"35%":"none"})})},65036:(Q,I,e)=>{"use strict";e.d(I,{DU:()=>f,Jc:()=>l,Yn:()=>d});var n=e(83195),a=e(28240),o=e(72724),r=e(42994);const i=(m,s)=>{let h=0,u=m.values.length-1,b;for(;;){if(h>u)return Math.max(u,0);b=Math.floor((h+u)/2);const g=m.values[b];if(g===s)return b;g&&g<s?h=b+1:u=b-1}},f=(m,s,h,u)=>{let b,g,P,c,y;const p=[];let v,D;for(b=0;b<m.length;b++){g=m[b];const E=s[b];P=i(E,h),c=h-E.values[P],y=E.values[P],(v===void 0||c>=0&&(c<v||v<0)||c<0&&c>v)&&(v=c,D=E.display?(0,n.cN)(E.display(y)):y);const S=g.display(g.values[P]);p.push({value:(0,n.cN)(S),datapointIndex:P,seriesIndex:b,color:S.color,label:(0,a.Ct)(g),time:E.display?(0,n.cN)(E.display(y)):y})}return{results:p,time:D}},d=(m,s)=>(0,o.LE)(m,{format:s?.options?.timeformat,timeZone:s?.options?.timezone}),l=(m,s,h)=>{if(s&&h&&m){const u=h-s,b=u/m/1e3,g=86400010,P=31536e6;return b<=10?r.WC.interval.millisecond:b<=45?r.WC.interval.second:u<=g?r.WC.interval.minute:b<=8e4?r.WC.interval.hour:u<=P?r.WC.interval.day:b<=31536e3?r.WC.interval.month:r.WC.interval.year}return r.WC.interval.minute}},99755:(Q,I,e)=>{"use strict";e.d(I,{o:()=>P});var n=e(96540),a=e(64423),o=e(99165),r=e(85200),i=e(1173),f=e(11261),d=e(69129),l=e(26272),m=e(79041),s=e(67266),h=e(81297),u=e(16895),b=e(65575);function g(c,y,p=[]){for(const v of p)if(typeof v=="function"){if(!v(c,y))return!1}else if(y[v]!==c[v])return!1;return!0}class P extends n.Component{constructor(y){super(y),this.panelContext={},this.subscription=new a.yU,this.getTimeRange=()=>this.props.timeRange;let p=this.prepState(y);p.alignedData=p.config.prepData([p.alignedFrame]),this.state=p,this.plotInstance=n.createRef()}static{this.contextType=m.e4}prepState(y,p=!0){let v=null;const{frames:D,fields:E,preparePlotFrame:S}=y,M=(S||b.mY)(D,E||{x:r.sJ.get(i.Ct.firstTimeField).get({}),y:r.sJ.get(i.Ct.byTypes).get(new Set([f.PU.number,f.PU.enum]))},y.timeRange);if((0,u.uY)("GraphNG",!1,"data aligned",M),M){let A=this.state?.config;p&&(A=y.prepConfig(M,this.props.frames,this.getTimeRange),(0,u.uY)("GraphNG",!1,"config prepared",A)),v={alignedFrame:M,config:A},(0,u.uY)("GraphNG",!1,"data prepared",v.alignedData)}return v}handleCursorUpdate(y){const p=y.payload?.point?.time,v=this.plotInstance.current;if(v&&p){const D=v.valToPos(p,"x");let E;if(D&&(E=(0,u.sw)(v,v.posToIdx(D))),!E||!D)return;v.setCursor({left:D,top:E})}}componentDidMount(){this.panelContext=this.context;const{eventBus:y}=this.panelContext;this.subscription.add(y.getStream(d.b_).pipe((0,o.c)(50)).subscribe({next:p=>{y!==p.origin&&this.handleCursorUpdate(p)}})),this.subscription.add(y.getStream(l.kb).pipe((0,o.c)(50)).subscribe({next:p=>this.handleCursorUpdate(p)})),this.subscription.add(y.getStream(d.ql).pipe((0,o.c)(50)).subscribe({next:()=>{const p=this.plotInstance?.current;p&&!p.cursor._lock&&p.setCursor({left:-10,top:-10})}}))}componentDidUpdate(y){const{frames:p,structureRev:v,timeZone:D,propsToDiff:E}=this.props,S=!g(y,this.props,E);if(p!==y.frames||S||D!==y.timeZone){let T=this.prepState(this.props,!1);T&&((this.state.config===void 0||D!==y.timeZone||v!==y.structureRev||!v||S)&&(T.config=this.props.prepConfig(T.alignedFrame,this.props.frames,this.getTimeRange),(0,u.uY)("GraphNG",!1,"config recreated",T.config)),T.alignedData=T.config.prepData([T.alignedFrame]),this.setState(T))}}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{width:y,height:p,children:v,renderLegend:D}=this.props,{config:E,alignedFrame:S,alignedData:T}=this.state;return E?n.createElement(s.KU,{width:y,height:p,legend:D(E)},(M,A)=>n.createElement(h.Z,{config:E,data:T,width:M,height:A,plotRef:x=>this.plotInstance.current=x},v?v(E,S):null)):null}}},16998:(Q,I,e)=>{"use strict";e.d(I,{I:()=>o});var n=e(96540);const a=n.createContext({}),o=()=>{const{data:r,dimFields:i,mapSeriesIndexToDataFrameFieldIndex:f}=(0,n.useContext)(a),d=(0,n.useCallback)(()=>{const l=i.x;let m=null;for(let s=0;s<r.fields.length;s++)if(l(r.fields[s],r,[r])){m=r.fields[s];break}return m},[r,i]);return{dimFields:i,mapSeriesIndexToDataFrameFieldIndex:f,getXAxisField:d,alignedData:r}}},65575:(Q,I,e)=>{"use strict";e.d(I,{My:()=>b,wX:()=>s,mY:()=>u});var n=e(11261),a=e(73060),o=e(52622),r=e(52811);const i={threshold:(P,c,y)=>P+y,midpoint:(P,c,y)=>(P+c)/2,plusone:(P,c,y)=>P+1};function f(P){if(P.frame.length===0)return P.frame;let c=!0,{frame:y,refFieldName:p,refFieldPseudoMax:v,refFieldPseudoMin:D,insertMode:E}=P;E||(E=i.threshold);const S=s(y,p);if(S==null)return y;S.state={...S.state,nullThresholdApplied:!0};const T=y.fields.map(A=>A.config.custom?.insertNulls||S.config.interval||null),M=new Set(T);if(M.delete(null),M.size===0)return y;if(M.size===1){const A=M.values().next().value;if(A<=0)return y;const x=S.values,C=y.fields.map(R=>R.values),O=d(x,C,A,D,v,E,c);return O===C?y:{...y,length:O[0].length,fields:y.fields.map((R,L)=>({...R,values:O[L]}))}}return y}function d(P,c,y,p=null,v=null,D,E){const S=P.length,T=[];if(p!=null&&p<P[0]){let C=Math.ceil((P[0]-p)/y),O=P[0]-C*y;for(;O<P[0];)T.push(D(O-y,O,y)),O+=y}T.push(P[0]);let M=P[0];for(let C=1;C<S;C++){const O=P[C];for(;O-M>y&&(T.push(D(M,O,y)),M+=y,!!E););T.push(O),M=O}if(v!=null&&v>M)for(;M+y<v;)T.push(D(M,v,y)),M+=y;const A=T.length;if(A===S)return c;const x=[];for(let C of c){let O;if(C!==P){O=Array(A);for(let R=0,L=0;R<A;R++)O[R]=P[L]===T[R]?C[L++]:null}else O=T;x.push(O)}return x}function l(P,c,y){let p,v;for(let D=0;D<c.length;D++)if(c[D]==null)v==null&&p!=null&&(v=D);else{if(v!=null){if(P[D]-p<y)for(;v<D;)c[v++]=void 0;v=null}p=P[D]}return c}function m(P){return P.type===n.PU.number&&P.config.custom?.drawStyle===o.GR.Bars&&!P.config.custom?.hideFrom?.viz}function s(P,c){return P.fields.find(y=>c!=null?y.name===c:y.type===n.PU.time)}function h(P,c){const y=s(P,c);let p=y?.values;for(let v=0;v<P.fields.length;v++){let D=P.fields[v];if(D===y||m(D))continue;let E=D.config.custom?.spanNulls;typeof E=="number"&&E!==-1&&p&&(D.values=l(p,D.values,E))}return P}function u(P,c,y){let p;e:for(let S of P)for(let T of S.fields)if(c.x(T,S,P)){p=T;break e}P=P.map(S=>p?.state?.nullThresholdApplied?S:f({frame:S,refFieldName:p.name,refFieldPseudoMin:y?.from.valueOf(),refFieldPseudoMax:y?.to.valueOf()}));let v=0;P.forEach(S=>{S.fields.forEach(T=>{m(T)&&(T.config.custom={...T.config.custom,spanNulls:-1},v++)})});let D=1/0;v>1&&P.forEach(S=>{if(!S.fields.some(m))return;const T=p.values;for(let M=0;M<T.length;M++)M>0&&(D=Math.min(D,T[M]-T[M-1]))});let E=(0,a.Fd)({frames:P,joinBy:c.x,keep:c.y,keepOriginIndices:!0});return E?(E=h(E,p.name),D!==1/0&&(E.fields.forEach((S,T)=>{let M=S.values;if(T===0){let A=M[M.length-1];M.push(A+D,A+2*D)}else m(S)?M.push(null,null):M.push(void 0,void 0)}),E.length+=2),E):null}function b(P,c){const y="na",p=`${P.min!==void 0?P.min:y}-${P.max!==void 0?P.max:y}`,v=`${P.custom?.axisSoftMin!==void 0?P.custom.axisSoftMin:y}-${P.custom?.axisSoftMax!==void 0?P.custom.axisSoftMax:y}`,D=`${P.custom?.axisPlacement!==void 0?P.custom?.axisPlacement:o.vM.Auto}`,E=P.unit??r.s,S=P.custom?.scaleDistribution?g(P.custom.scaleDistribution):o.L4.Linear,T=P.custom?.axisLabel?P.custom.axisLabel:y;return`${E}/${p}/${v}/${D}/${S}/${T}/${c}`}function g(P){return P.type===o.L4.Log?`${P.type}${P.log}`:P.type}},18262:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>O});var n=e(96540),a=e(79041),o=e(24182),r=e(40845),i=e(99755),f=e(2543),d=e(36613),l=e(11261),m=e(83195),s=e(57875),h=e(8066),u=e(24293),b=e(28240),g=e(94624),P=e(52622),c=e(51336),y=e(74863),p=e(16895),v=e(65575);const D=new Set(["bytes","bits","kbytes","mbytes","gbytes","tbytes","pbytes","binBps","binbps","KiBs","Kibits","MiBs","Mibits","GiBs","Gibits","TiBs","Tibits","PiBs","Pibits"]),E=Array(53);for(let R=0;R<E.length;R++)E[R]=2**R;const S=(R,L=1)=>R==null?"-":R.toFixed(L),T={drawStyle:P.GR.Line,showPoints:P.yL.Auto,axisPlacement:P.vM.Auto},M=({frame:R,theme:L,timeZones:N,getTimeRange:F,sync:K,allFrames:B,renderers:w,tweakScale:U=V=>V,tweakAxis:W=V=>V})=>{const V="__global_",_=new c.e(N[0]);let H;_.setPrepData(ie=>(H=ie[0],(0,p.bq)(ie[0],_.getStackingGroups())));const G=R.fields[0];if(!G)return _;const j="x";let Y="";const oe=G.config.custom?.axisPlacement!==P.vM.Hidden?P.vM.Bottom:P.vM.Hidden,se=G.config.custom?.axisPlacement!==P.vM.Hidden;if(G.type===l.PU.time){_.addScale({scaleKey:j,orientation:P.Lt.Horizontal,direction:P.ON.Right,isTime:!0,range:()=>{const de=F();return[de.from.valueOf(),de.to.valueOf()]}});const ie=N.length>1?(de,ue)=>ue.map((fe,Se)=>Se<2?null:fe):void 0;for(let de=0;de<N.length;de++){const ue=N[de];_.addAxis({scaleKey:j,isTime:!0,placement:oe,show:se,label:G.config.custom?.axisLabel,timeZone:ue,theme:L,grid:{show:de===0&&G.config.custom?.axisGridShow},filter:ie})}N.length>1&&_.addHook("drawAxes",de=>{de.ctx.save(),de.ctx.fillStyle=L.colors.text.primary,de.ctx.textAlign="left",de.ctx.textBaseline="bottom";let ue=0;de.axes.forEach(fe=>{if(fe.side===2){let Se=fe._pos+fe._size;de.ctx.fillText(N[ue],de.bbox.left,Se*d.A.pxRatio),ue++}}),de.ctx.restore()})}else _.addScale({scaleKey:j,orientation:P.Lt.Horizontal,direction:P.ON.Right,range:(ie,de,ue)=>[G.config.min??de,G.config.max??ue]}),_.addAxis({scaleKey:j,placement:oe,show:se,label:G.config.custom?.axisLabel,theme:L,grid:{show:G.config.custom?.axisGridShow},formatValue:(ie,de)=>(0,m.cN)(G.display(ie,de))});let ne=w?.flatMap(ie=>Object.values(ie.fieldMap).filter(de=>ie.indicesOnly.indexOf(de)===-1))??[],ee;for(let ie=1;ie<R.fields.length;ie++){const de=R.fields[ie],ue={...de.config,custom:{...T,...de.config.custom}},fe=ue.custom;if(de===G||de.type!==l.PU.number&&de.type!==l.PU.enum)continue;let Se=de.display??S;de.config.custom?.stacking?.mode===P.gs.Percent&&(Se=(0,s.J)({field:{...de,config:{...de.config,unit:"percentunit"}},theme:L}));const he=(0,v.My)(ue,de.type),ce=(0,h.Qi)(de),pe=(0,h.lz)(de,L).color;if(_.addScale(U({scaleKey:he,orientation:P.Lt.Vertical,direction:P.ON.Up,distribution:fe.scaleDistribution?.type,log:fe.scaleDistribution?.log,linearThreshold:fe.scaleDistribution?.linearThreshold,min:de.config.min,max:de.config.max,softMin:fe.axisSoftMin,softMax:fe.axisSoftMax,centeredZero:fe.axisCenteredZero,range:fe.stacking?.mode===P.gs.Percent?(Ae,Ue,Me)=>(Ue=Ue<0?-1:0,Me=Me>0?1:0,[Ue,Me]):de.type===l.PU.enum?(Ae,Ue,Me)=>[-1,de.config.type.enum.text.length]:void 0,decimals:de.config.decimals},de)),Y||(Y=he),fe.axisPlacement!==P.vM.Hidden){let Ae;fe.axisColorMode===P.Y$.Series&&(ce.isByValue&&de.config.custom?.gradientMode===P.on.Scheme&&ce.id===u.Y.Thresholds?Ae=(0,y.pl)(1,L,ce,de.config.thresholds):Ae=pe);const Ue={border:{show:fe.axisBorderShow||!1,width:1/devicePixelRatio,stroke:Ae||L.colors.text.primary},ticks:{show:fe.axisBorderShow||!1,stroke:Ae||L.colors.text.primary},color:Ae||L.colors.text.primary};let Me,$e,ke;if(D.has(ue.unit))Me=E;else if(de.type===l.PU.enum){let Ze=de.config.type.enum.text;ke=Ze.map((ot,xt)=>xt),$e=Ze}_.addAxis(W({scaleKey:he,label:fe.axisLabel,size:fe.axisWidth,placement:fe.axisPlacement??P.vM.Auto,formatValue:(Ze,ot)=>(0,m.cN)(Se(Ze,ot)),theme:L,grid:{show:fe.axisGridShow},decimals:de.config.decimals,distr:fe.scaleDistribution?.type,splits:ke,values:$e,incrs:Me,...Ue},de))}const ye=fe.drawStyle===P.GR.Points?P.yL.Always:fe.showPoints;let Pe=()=>null;fe.spanNulls!==!0&&(Pe=(Ae,Ue,Me,$e)=>{let ke=[],Ze=Ae.series[Ue];if(!Me&&$e&&$e.length){const[ot,xt]=Ze.idxs,ct=Ae.data[0],ft=Ae.data[Ue],Le=Math.round(Ae.valToPos(ct[ot],"x",!0)),re=Math.round(Ae.valToPos(ct[xt],"x",!0));$e[0][0]===Le&&ke.push(ot);for(let X=0;X<$e.length;X++){let le=$e[X],be=$e[X+1];if(be&&le[1]===be[0]){let De=Ae.posToIdx(le[1],!0);if(ft[De]==null)for(let Te=1;Te<100;Te++){if(ft[De+Te]!=null){De+=Te;break}if(ft[De-Te]!=null){De-=Te;break}}ke.push(De)}}$e[$e.length-1][1]===re&&ke.push(xt)}return ke.length?ke:null});let{fillOpacity:Ie}=fe,Oe=null,Ne=null;if(de.state?.origin){ee||(ee=A(R,B));const Ae=B[de.state.origin.frameIndex],Ue=Ae?.fields[de.state.origin.fieldIndex],Me=(0,b.Ct)(Ue??de,Ae,B);if(ne.indexOf(Me)>=0)Oe=()=>null,Ne=()=>{};else if(fe.transform===P.NU.Constant){const $e=d.A.paths.linear();Oe=(ke,Ze)=>{const ot=ke._data,xt=F();let ct=[xt.from.valueOf(),xt.to.valueOf()],ft=ot[Ze].find(X=>X!=null),Le=[ft,ft],re=ot.slice();return re[0]=ct,re[Ze]=Le,$e({...ke,_data:re},Ze,0,1)}}if(fe.fillBelowTo){const $e=R.fields.find(xt=>fe.fillBelowTo===xt.name||fe.fillBelowTo===xt.config?.displayNameFromDS||fe.fillBelowTo===(0,b.Ct)(xt,R,B)),ke=$e?(0,b.Ct)($e,R,B):fe.fillBelowTo,Ze=ee.get(Me),ot=ee.get(ke);(0,f.isNumber)(ot)&&(0,f.isNumber)(Ze)?(_.addBand({series:[Ze,ot],fill:void 0}),Ie||(Ie=35)):Ie=0}}let We;ce.id===u.Y.Thresholds&&(We=Ae=>(0,h.lz)(H.fields[Ae],L).color),_.addSeries({pathBuilder:Oe,pointsBuilder:Ne,scaleKey:he,showPoints:ye,pointsFilter:Pe,colorMode:ce,fillOpacity:Ie,theme:L,dynamicSeriesColor:We,drawStyle:fe.drawStyle,lineColor:fe.lineColor??pe,lineWidth:fe.lineWidth,lineInterpolation:fe.lineInterpolation,lineStyle:fe.lineStyle,barAlignment:fe.barAlignment,barWidthFactor:fe.barWidthFactor,barMaxWidth:fe.barMaxWidth,pointSize:fe.pointSize,spanNulls:fe.spanNulls||!1,show:!fe.hideFrom?.viz,gradientMode:fe.gradientMode,thresholds:ue.thresholds,hardMin:de.config.min,hardMax:de.config.max,softMin:fe.axisSoftMin,softMax:fe.axisSoftMax,dataFrameFieldIndex:de.state?.origin}),fe.thresholdsStyle&&ue.thresholds&&(fe.thresholdsStyle.mode??P.Ly.Off)!==P.Ly.Off&&_.addThresholds({config:fe.thresholdsStyle,thresholds:ue.thresholds,scaleKey:he,theme:L,hardMin:de.config.min,hardMax:de.config.max,softMin:fe.axisSoftMin,softMax:fe.axisSoftMax})}let Z=(0,p.ro)(R);_.setStackingGroups(Z),w?.forEach(ie=>{ee||(ee=A(R,B));let de={};for(let ue in ie.fieldMap){let fe=ie.fieldMap[ue];de[ue]=ee.get(fe)}ie.init(_,de)}),_.scaleKeys=[j,Y];const z=15;let q={dataIdx:(ie,de,ue,fe)=>{let Se=ie.data[de];if(Se[ue]==null){let he=null,ce=null,me;for(me=ue;he==null&&me-- >0;)Se[me]!=null&&(he=me);for(me=ue;ce==null&&me++<Se.length;)Se[me]!=null&&(ce=me);let pe=ie.data[0],ye=ie.valToPos(fe,"x"),Pe=ce==null?1/0:ie.valToPos(pe[ce],"x"),Ie=he==null?-1/0:ie.valToPos(pe[he],"x"),Oe=ye-Ie,Ne=Pe-ye;Oe<=Ne?Oe<=z&&(ue=he):Ne<=z&&(ue=ce)}return ue}};return K&&K()!==g.y.Off&&(q.sync={key:V,scales:[j,null]}),_.setCursor(q),_};function A(R,L){const N=new Map;return R.fields.forEach((F,K)=>{const B=F.state?.origin;if(B){const w=L[B.frameIndex]?.fields[B.fieldIndex];w&&N.set((0,b.Ct)(w,L[B.frameIndex],L),K)}}),N}const x=["legend","options","theme"];class C extends n.Component{constructor(){super(...arguments),this.prepConfig=(L,N,F)=>{const{sync:K}=this.context,{theme:B,timeZone:w,renderers:U,tweakAxis:W,tweakScale:V}=this.props;return M({frame:L,theme:B,timeZones:Array.isArray(w)?w:[w],getTimeRange:F,sync:K,allFrames:N,renderers:U,tweakScale:V,tweakAxis:W})},this.renderLegend=L=>{const{legend:N,frames:F}=this.props;return!L||N&&!N.showLegend||!(0,o.t)(L,F)?null:n.createElement(o.$,{data:F,config:L,...N})}}static{this.contextType=a.e4}render(){return n.createElement(i.o,{...this.props,prepConfig:this.prepConfig,propsToDiff:x,renderLegend:this.renderLegend})}}const O=(0,r.cV)(C);O.displayName="TimeSeries"},90606:(Q,I,e)=>{"use strict";e.d(I,{T:()=>p});var n=e(32196),a=e(96540),o=e(1604),r=e(94624),i=e(57875),f=e(24293),d=e(28240),l=e(83195),m=e(11261),s=e(14588),h=e(52622),u=e(3139),b=e(17464),g=e(69503),P=e(16895),c=e(40845);const y=10,p=({mode:S=h.$N.Single,sortOrder:T=h.xB.None,sync:M,timeZone:A,config:x,renderTooltip:C,...O})=>{const R=(0,a.useRef)(),L=(0,c.$j)(),[N,F]=(0,a.useState)(null),[K,B]=(0,a.useState)(null),[w,U]=(0,a.useState)([]),[W,V]=(0,a.useState)(null),[_,H]=(0,a.useState)(!1),G=(0,o.A)();let j=null;const Y=(0,c.of)(E);if((0,a.useLayoutEffect)(()=>{let Z;const z=()=>{G()&&(H(!0),R.current?.root.classList.add("plot-active"))},q=()=>{G()&&(V(null),H(!1),R.current?.root.classList.remove("plot-active"))};return x.addHook("syncRect",(ie,de)=>Z=de),x.addHook("init",ie=>{R.current=ie,ie.over.addEventListener("mouseenter",z),ie.over.addEventListener("mouseleave",q),j=ie.root.closest("[tabindex]"),j&&(j.addEventListener("focus",z),j.addEventListener("blur",q)),M&&M()===r.y.Crosshair&&ie.root.classList.add("shared-crosshair")}),x.addHook("setLegend",ie=>{G()&&(B(ie.legend.idx),U(ie.legend.idxs.slice()))}),x.addHook("setCursor",ie=>{if(!Z||!G())return;const{x:de,y:ue}=D(ie,Z);V(de!==void 0&&ue!==void 0?{x:de,y:ue}:null)}),x.addHook("setSeries",(ie,de)=>{G()&&F(de)}),()=>{V(null),R.current&&(R.current.over.removeEventListener("mouseleave",q),R.current.over.removeEventListener("mouseenter",z),j&&(j.removeEventListener("focus",z),j.removeEventListener("blur",q)))}},[x,V,H,B,U]),K===null||!_&&M&&M()===r.y.Crosshair)return null;let oe=O.data.fields[0];if(!oe)return null;const se=oe.display||(0,i.J)({field:oe,timeZone:A,theme:L});let ne=null,ee=se(oe.values[K]).text;if(C)ne=C(O.data,N,K);else{if(S===h.$N.Single&&N!==null){const Z=O.data.fields[N];if(!Z)return null;const z=w?.[N]??K;ee=se(oe.values[z]).text;const ie=(Z.display||(0,i.J)({field:Z,timeZone:A,theme:L}))(Z.values[z]);ne=a.createElement(u.o,{series:[{color:ie.color||f.F,label:(0,d.Ct)(Z,O.data,O.frames),value:ie?(0,l.cN)(ie):null}],timestamp:ee})}if(S===h.$N.Multi){let Z=[];const z=O.data,q=z.fields,ie=[];for(let de=0;de<q.length;de++){const ue=z.fields[de];if(!ue||ue===oe||ue.type===m.PU.time||ue.type!==m.PU.number||ue.config.custom?.hideFrom?.tooltip||ue.config.custom?.hideFrom?.viz)continue;const fe=O.data.fields[de].values[w[de]],Se=ue.display(fe);ie.push(fe),Z.push({color:Se.color||f.F,label:(0,d.Ct)(ue,z,O.frames),value:Se?(0,l.cN)(Se):null,isActive:N===de})}if(T!==h.xB.None){const de=[...Z],ue=s.sortValues(T);Z.sort((fe,Se)=>{const he=de.indexOf(fe),ce=de.indexOf(Se);return ue(ie[he],ie[ce])})}ne=a.createElement(u.o,{series:Z,timestamp:ee})}}return a.createElement(b.ZL,{className:_?Y.tooltipWrapper:void 0},ne&&W&&a.createElement(g.o,{position:{x:W.x,y:W.y},offset:{x:y,y}},ne))};function v({left:S,top:T},M){return S===void 0||T===void 0?!1:S<0||S>M.width||T<0||T>M.height}function D(S,T){let M,A;const x=S.cursor.left||0,C=S.cursor.top||0;if(v(S.cursor,T)){const O=S.posToIdx(x);if(C<0||C>T.height){let R=(0,P.sw)(S,O);R&&(A=T.top+R,x>=0&&x<=T.width&&(M=T.left+S.valToPos(S.data[0][S.posToIdx(x)],S.series[0].scale)))}}else M=T.left+x,A=T.top+C;return{x:M,y:A}}const E=S=>({tooltipWrapper:(0,n.css)({"z-index":S.zIndex.portal+1+" !important"})})},76284:(Q,I,e)=>{"use strict";e.d(I,{j:()=>r});var n=e(96540);const a=5,o=i=>i!=null&&!i.ctrlKey&&!i.metaKey,r=({onZoom:i,config:f,withZoomY:d=!1})=>((0,n.useLayoutEffect)(()=>{let l=!1,m=!1;d&&f.addHook("init",s=>{s.over.addEventListener("mousedown",h=>{if(o(h)&&h.button===0&&h.shiftKey){m=!0,s.cursor.drag.x=!1,s.cursor.drag.y=!0;let u=b=>{s.cursor.drag.x=!0,s.cursor.drag.y=!1,document.removeEventListener("mouseup",u,!0)};document.addEventListener("mouseup",u,!0)}},!0)}),f.addHook("setSelect",s=>{const h=s.scales.x.ori===0;if(o(s.cursor.event)){if(d&&m){if(s.select.height>=a){for(let u in s.scales)if(u!=="x"){const b=h?s.posToVal(s.select.top,u):s.posToVal(s.select.left+s.select.width,u),g=h?s.posToVal(s.select.top+s.select.height,u):s.posToVal(s.select.left,u);s.setScale(u,{min:g,max:b})}l=!0}m=!1}else if(s.select.width>=a){const u=h?s.posToVal(s.select.left,"x"):s.posToVal(s.select.top+s.select.height,"x"),b=h?s.posToVal(s.select.left+s.select.width,"x"):s.posToVal(s.select.top,"x");i({from:u,to:b}),l=!1}}s.setSelect({left:0,width:0,top:0,height:0},!1)}),f.setCursor({bind:{dblclick:s=>()=>{if(!o(s.cursor.event))return null;if(d&&l){for(let h in s.scales)h!=="x"&&s.setScale(h,{min:null,max:null});l=!1}else{let h=s.scales.x;const u=h.min,b=h.max,g=(b-u)/2;i({from:u-g,to:b+g})}return null}}})},[f,i,d]),null)},8984:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{ALERTING_COLOR:()=>r.xj,AxisPlacement:()=>l.vM,BarAlignment:()=>l.Nj,BarValueVisibility:()=>l.TC,BracesPlugin:()=>d.e1,ClearPlugin:()=>d.vJ,ClipboardPlugin:()=>d.sW,DEFAULT_ANNOTATION_COLOR:()=>r.Mk,DOMUtil:()=>r.bk,DrawStyle:()=>l.yg,EventsWithValidation:()=>r.Pw,GlobalStyles:()=>i.kH,GraphGradientMode:()=>l.on,GraphThresholdsStyleMode:()=>l.Ly,IndentationPlugin:()=>d.TA,LegendDisplayMode:()=>l.lm,LineInterpolation:()=>l.dx,NO_DATA_COLOR:()=>r.nO,NewlinePlugin:()=>d.Om,NodeGraphDataFrameFieldNames:()=>r.uc,OK_COLOR:()=>r.Xw,PENDING_COLOR:()=>r.ct,PointVisibility:()=>l.nT,REGION_FILL_ALPHA:()=>r.UJ,ReactUtils:()=>r.zt,RunnerPlugin:()=>d.Ul,SCHEMA:()=>r.yx,ScaleDirection:()=>l.ON,ScaleOrientation:()=>l.Lt,SearchFunctionType:()=>r.Tt,SelectionShortcutsPlugin:()=>d.l9,SlatePrism:()=>d.De,StackingMode:()=>l.gs,SuggestionsPlugin:()=>d.Pz,TableCellDisplayMode:()=>l.ob,ThemeContext:()=>i.Dx,TooltipDisplayMode:()=>l.$N,ansicolor:()=>r.DB,attachDebugger:()=>r.hF,calculateFontSize:()=>r.Vr,colors:()=>r.Tj,commonOptionsBuilder:()=>f.j,createLogger:()=>r.h,fuzzyMatch:()=>r.It,getCanvasContext:()=>r.Yc,getCellLinks:()=>r.kl,getScrollbarWidth:()=>r.XJ,getTagColor:()=>r.yC,getTagColorIndexFromName:()=>r.JF,getTagColorsFromName:()=>r.MC,getTextColorForAlphaBackground:()=>r.mZ,getTextColorForBackground:()=>r.sg,getTheme:()=>i.O4,hasValidationEvent:()=>r.K,isCompactUrl:()=>r.Fr,linkModelToContextMenuItems:()=>r.Jl,makeFragment:()=>r.dF,makeValue:()=>r.mO,measureText:()=>r.kD,mockTheme:()=>i.mG,mockThemeContext:()=>i.fq,regexValidation:()=>r.RP,sortedColors:()=>r.Ih,styleMixins:()=>i.YF,stylesFactory:()=>i.N3,useForceUpdate:()=>r.CH,useStyles:()=>i.IS,useStyles2:()=>i.of,useTheme:()=>i.DP,useTheme2:()=>i.$j,validate:()=>r.tf,withTheme:()=>i.SL,withTheme2:()=>i.cV});var n=e(94333),o={};for(const m in n)m!=="default"&&(o[m]=()=>n[m]);e.d(I,o);var a=e(80186),o={};for(const m in a)["default","Icon","IconButton","ConfirmButton","DeleteButton","Tooltip","PopoverController","Popover","Toggletip","Portal","getPortalContainer","PortalContainer","CustomScrollbar","TabbedContainer","ClipboardButton","Cascader","ButtonCascader","InlineToast","LoadingPlaceholder","LoadingBar","ColorPicker","SeriesColorPicker","ColorPickerInput","SeriesColorPickerPopover","SeriesColorPickerPopoverWithTheme","EmptySearchResult","EmptyState","UnitPicker","StatsPicker","RefreshPicker","defaultIntervals","TimeRangePicker","TimePickerTooltip","TimeRangeLabel","TimeOfDayPicker","TimeZonePicker","WeekStartPicker","DatePicker","DatePickerWithInput","DateTimePicker","List","InteractiveTable","TagsInput","AutoSaveField","Pagination","Tag","TagList","FilterPill","ConfirmModal","QueryField","CodeEditor","ReactMonacoEditor","CodeEditorSuggestionItemKind","variableSuggestionToCodeEditorSuggestion","Modal","ModalHeader","ModalTabsHeader","ModalTabContent","ModalsProvider","ModalRoot","ModalsController","ModalsContext","PageToolbar","SetInterval","Table","TableInputCSV","TabsBar","Tab","VerticalTab","TabContent","Counter","RenderUserContentAsHTML","BigValue","BigValueColorMode","BigValueGraphMode","BigValueJustifyMode","BigValueTextMode","Sparkline","Gauge","BarGauge","VizTooltip","VizTooltipContainer","SeriesTable","SeriesTableRow","VizRepeater","PanelChrome","PanelChromeLoadingIndicator","PanelContextProvider","PanelContextRoot","usePanelContext","VizLayout","SeriesVisibilityChangeBehavior","VizLegend","VizLegendListItem","Alert","GraphSeriesToggler","Collapse","ControlledCollapse","CollapsableSection","DataLinkButton","FieldLinkList","FullWidthButtonContainer","ClickOutsideWrapper","CallToActionCard","ContextMenu","Menu","MenuGroup","MenuItem","WithContextMenu","DataLinksInlineEditor","DataLinkInput","DataLinksContextMenu","SeriesIcon","InfoBox","FeatureInfoBox","FeatureBadge","JSONFormatter","JsonExplorer","ErrorBoundary","ErrorBoundaryAlert","withErrorBoundary","ErrorWithStack","DataSourceHttpSettings","CustomHeadersSettings","AlertingSettings","SecureSocksProxySettings","TLSAuthSettings","CertificationKey","Spinner","FadeTransition","SlideOutTransition","Segment","SegmentAsync","SegmentInput","SegmentSelect","SegmentSection","Drawer","Slider","RangeSlider","Form","sharedInputStyle","InputControl","Button","LinkButton","ButtonGroup","clearButtonStyles","ToolbarButton","ToolbarButtonRow","ValuePicker","fieldMatchersUI","Link","TextLink","Text","Box","Stack","Grid","Space","Label","Field","Legend","FieldSet","FieldValidationMessage","InlineField","InlineSegmentGroup","InlineLabel","InlineFieldRow","FieldArray","resetSelectStyles","getSelectStyles","HorizontalGroup","VerticalGroup","Container","Badge","RadioButtonGroup","RadioButtonList","Input","getInputStyles","AutoSizeInput","FilterInput","Switch","InlineSwitch","Checkbox","TextArea","FileUpload","TimeRangeInput","RelativeTimeRangePicker","Card","getCardStyles","CardContainer","FormattedValueDisplay","ButtonSelect","Dropdown","PluginSignatureBadge","UserIcon","Avatar","InlineFormLabel","Divider","getDragStyles","useSplitter","LegacyForms","LegacyInputStatus","ScaleDistribution","BarGaugeDisplayMode","UPlotConfigBuilder","UPLOT_AXIS_FONT_SIZE","UPlotChart","PlotLegend","FIXED_UNIT","BrowserLabel","PanelContainer","Graph","GraphWithLegend","GraphContextMenu","GraphContextMenuHeader","graphTimeFormat","graphTickFormatter","GraphNG","TimeSeries","useGraphNGContext","preparePlotFrame","buildScaleKey","ZoomPlugin","TooltipPlugin","convertOldAngularValueMapping","sharedSingleStatMigrationHandler","sharedSingleStatPanelChangedHandler","AsyncMultiSelect","AsyncSelect","AsyncVirtualizedSelect","MultiSelect","Select","SelectContainer","VirtualizedSelect","SecretInput","SecretTextArea","FileDropzone","FileDropzoneDefaultChildren","FileListItem","graphFieldOptions","EventsCanvas","Marker","XYCanvas","EventBusPlugin","KeyboardPlugin","TooltipPlugin2","SeriesVisibilityChangeMode"].indexOf(m)<0&&(o[m]=()=>a[m]);e.d(I,o);var r=e(99598),i=e(7918),f=e(42482),d=e(50955),l=e(49149)},38248:(Q,I,e)=>{"use strict";e.d(I,{W:()=>b,r:()=>s});var n=e(96540),a=e(11261),o=e(27310),r=e(52622),i=e(88575),f=e(94354),d=e(10354),l=e(21594),m=e(52198);function s(g,P,c){const y=["Axis"];g.addRadio({path:"axisPlacement",name:"Placement",category:y,defaultValue:m.t.axisPlacement[0].value,settings:{options:m.t.axisPlacement}}).addTextInput({path:"axisLabel",name:"Label",category:y,defaultValue:"",settings:{placeholder:"Optional text",expandTemplateVars:!0},showIf:p=>p.axisPlacement!==r.vM.Hidden,shouldApply:p=>p.type!==a.PU.time&&p.type!==a.PU.string}).addNumberInput({path:"axisWidth",name:"Width",category:y,settings:{placeholder:"Auto"},showIf:p=>p.axisPlacement!==r.vM.Hidden}).addRadio({path:"axisGridShow",name:"Show grid lines",category:y,defaultValue:void 0,settings:{options:[{value:void 0,label:"Auto"},{value:!0,label:"On"},{value:!1,label:"Off"}]},showIf:p=>p.axisPlacement!==r.vM.Hidden}).addRadio({path:"axisColorMode",name:"Color",category:y,defaultValue:r.Y$.Text,settings:{options:[{value:r.Y$.Text,label:"Text"},{value:r.Y$.Series,label:"Series"}]},showIf:p=>p.axisPlacement!==r.vM.Hidden}).addBooleanSwitch({path:"axisBorderShow",name:"Show border",category:y,defaultValue:!1,showIf:p=>p.axisPlacement!==r.vM.Hidden}),g.addCustomEditor({id:"scaleDistribution",path:"scaleDistribution",name:"Scale",category:y,editor:b,override:b,defaultValue:{type:r.L4.Linear},shouldApply:p=>p.type===a.PU.number,process:o.hS}).addBooleanSwitch({path:"axisCenteredZero",name:"Centered zero",category:y,defaultValue:!1,showIf:p=>p.scaleDistribution?.type!==r.L4.Log}).addNumberInput({path:"axisSoftMin",name:"Soft min",defaultValue:P.axisSoftMin,category:y,settings:{placeholder:"See: Standard options > Min"}}).addNumberInput({path:"axisSoftMax",name:"Soft max",defaultValue:P.axisSoftMax,category:y,settings:{placeholder:"See: Standard options > Max"}})}const h=[{label:"Linear",value:r.L4.Linear},{label:"Logarithmic",value:r.L4.Log},{label:"Symlog",value:r.L4.Symlog}],u=[{label:"2",value:2},{label:"10",value:10}],b=({value:g,onChange:P})=>{const c=g?.type??r.L4.Linear,y=g?.log??2;return n.createElement(n.Fragment,null,n.createElement("div",{style:{marginBottom:16}},n.createElement(f.z,{value:c,options:h,onChange:p=>{P({...g,type:p,log:p===r.L4.Linear?void 0:y})}})),(c===r.L4.Log||c===r.L4.Symlog)&&n.createElement(i.D,{label:"Log base"},n.createElement(l.l6,{options:u,value:y,onChange:p=>{P({...g,log:p.value})}})),c===r.L4.Symlog&&n.createElement(i.D,{label:"Linear threshold"},n.createElement(d.p,{placeholder:"1",value:g?.linearThreshold,onChange:p=>{P({...g,linearThreshold:Number(p.currentTarget.value)})}})))}},11404:(Q,I,e)=>{"use strict";e.d(I,{e:()=>d});var n=e(2543),a=e.n(n),o=e(96540),r=e(92174),i=e(67061);const f=({value:l,onChange:m})=>{const s=(0,o.useCallback)(h=>{m({...l,[h]:!l[h]})},[l,m]);return o.createElement(i.B,{gap:.5},Object.keys(l).map(h=>{const u=h;return o.createElement(r.m,{icon:l[u]?"eye-slash":"eye",onClick:()=>s(u),key:u,label:(0,n.startCase)(u),selected:l[u]})}))};function d(l){l.addCustomEditor({id:"hideFrom",name:"Hide in area",category:["Series"],path:"hideFrom",defaultValue:{tooltip:!1,viz:!1,legend:!1},editor:f,override:f,shouldApply:()=>!0,hideFromDefaults:!0,process:m=>m})}},22680:(Q,I,e)=>{"use strict";e.d(I,{H:()=>o});var n=e(69550),a=e(52622);function o(r,i=!0){r.addBooleanSwitch({path:"legend.showLegend",name:"Visibility",category:["Legend"],description:"",defaultValue:!0}).addRadio({path:"legend.displayMode",name:"Mode",category:["Legend"],description:"",defaultValue:a.lm.List,settings:{options:[{value:a.lm.List,label:"List"},{value:a.lm.Table,label:"Table"}]},showIf:f=>f.legend.showLegend}).addRadio({path:"legend.placement",name:"Placement",category:["Legend"],description:"",defaultValue:"bottom",settings:{options:[{value:"bottom",label:"Bottom"},{value:"right",label:"Right"}]},showIf:f=>f.legend.showLegend}).addNumberInput({path:"legend.width",name:"Width",category:["Legend"],settings:{placeholder:"Auto"},showIf:f=>f.legend.showLegend&&f.legend.placement==="right"}),i&&r.addCustomEditor({id:"legend.calcs",path:"legend.calcs",name:"Values",category:["Legend"],description:"Select values or calculations to show in legend",editor:n.D.get("stats-picker").editor,defaultValue:[],settings:{allowMultiple:!0},showIf:f=>f.legend.showLegend!==!1})}},56675:(Q,I,e)=>{"use strict";e.d(I,{I:()=>h,m:()=>s});var n=e(96540),a=e(27310),o=e(11261),r=e(52622),i=e(94354),f=e(29158),d=e(10354),l=e(67061),m=e(52198);const s=({value:u,context:b,onChange:g,item:P})=>n.createElement(l.B,null,n.createElement(i.z,{value:u?.mode||r.gs.None,options:P.settings?.options??[],onChange:c=>{g({...u,mode:c})}}),b.isOverride&&u?.mode&&u?.mode!==r.gs.None&&n.createElement(d.p,{type:"text",placeholder:"Group",suffix:n.createElement(f.K,{name:"question-circle",tooltip:"Name of the stacking group",tooltipPlacement:"top"}),defaultValue:u?.group,onChange:c=>{g({...u,group:c.currentTarget.value.trim()})}}));function h(u,b,g=["Graph styles"]){u.addCustomEditor({id:"stacking",path:"stacking",name:"Stack series",category:g,defaultValue:b,editor:s,override:s,settings:{options:m.t.stacking},process:a.hS,shouldApply:P=>P.type===o.PU.number})}},71242:(Q,I,e)=>{"use strict";e.d(I,{I:()=>n});function n(a,o=!0){o&&a.addNumberInput({path:"text.titleSize",category:["Text size"],name:"Title",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0}),a.addNumberInput({path:"text.valueSize",category:["Text size"],name:"Value",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0})}},89654:(Q,I,e)=>{"use strict";e.d(I,{D:()=>a});var n=e(52622);function a(o,r=!1,i=!1,f){const d=["Tooltip"],l=r?[{value:n.$N.Single,label:"Single"},{value:n.$N.None,label:"Hidden"}]:[{value:n.$N.Single,label:"Single"},{value:n.$N.Multi,label:"All"},{value:n.$N.None,label:"Hidden"}],m=[{value:n.xB.None,label:"None"},{value:n.xB.Ascending,label:"Ascending"},{value:n.xB.Descending,label:"Descending"}];o.addRadio({path:"tooltip.mode",name:"Tooltip mode",category:d,defaultValue:f?.tooltip?.mode??n.$N.Single,settings:{options:l}}).addRadio({path:"tooltip.sort",name:"Values sort order",category:d,defaultValue:f?.tooltip?.sort??n.xB.None,showIf:s=>s.tooltip?.mode===n.$N.Multi,settings:{options:m}}),i&&o.addNumberInput({path:"tooltip.hoverProximity",name:"Hover proximity",description:"How close the cursor must be to a point to trigger the tooltip, in pixels",category:d,settings:{integer:!0}}),o.addNumberInput({path:"tooltip.maxWidth",name:"Max width",category:d,settings:{integer:!0}}).addNumberInput({path:"tooltip.maxHeight",name:"Max height",category:d,defaultValue:void 0,settings:{integer:!0},showIf:s=>s.tooltip?.mode===n.$N.Multi})}},42482:(Q,I,e)=>{"use strict";e.d(I,{j:()=>n});var n={};e.r(n),e.d(n,{ScaleDistributionEditor:()=>a.W,StackingEditor:()=>d.m,addAxisConfig:()=>a.r,addHideFrom:()=>o.e,addLegendOptions:()=>r.H,addStackingConfig:()=>d.I,addTextSizeOptions:()=>f.I,addTooltipOptions:()=>i.D});var a=e(38248),o=e(11404),r=e(22680),i=e(89654),f=e(71242),d=e(56675)},49149:(Q,I,e)=>{"use strict";e.d(I,{$N:()=>n.$N,Lt:()=>n.Lt,Ly:()=>n.Ly,Nj:()=>n.Nj,ON:()=>n.ON,TC:()=>n.yL,dx:()=>n.dx,gs:()=>n.gs,lm:()=>n.lm,nT:()=>n.yL,ob:()=>n.ob,on:()=>n.on,vM:()=>n.vM,yg:()=>n.GR});var n=e(52622)},74738:(Q,I,e)=>{"use strict";e.d(I,{v:()=>n});function n(){return{onKeyDown(a,o,r){const i=o.value;if(i.selection.isExpanded)return r();if(a.key==="k"&&a.ctrlKey){a.preventDefault();const f=i.anchorText.text,d=i.selection.anchor.offset,m=f.length-d;return o.deleteForward(m),!0}return r()}}}},99453:(Q,I,e)=>{"use strict";e.d(I,{s:()=>o});const n=(r,i,f)=>{if(!r.length)return;const d=r.slice(0,-1).join("").length+r.length-1;return r.join(`
`).slice(i,d+f)},a=r=>r?.replace(/[\uFEFF]/g,"");function o(){const r={onCopy(i,f,d){i.preventDefault();const{document:l,selection:m}=f.value,{start:{offset:s},end:{offset:h}}=m,u=l.getLeafBlocksAtRange(m).toArray().map(g=>g.text),b=a(n(u,s,h));return b&&i.clipboardData&&i.clipboardData.setData("Text",b),!0},onPaste(i,f,d){if(i.preventDefault(),i.clipboardData){const m=a(i.clipboardData.getData("Text"))?.split(`
`);if(m&&m.length){f.insertText(m[0]);for(const s of m.slice(1))f.splitBlock().insertText(s)}}return!0}};return{...r,onCut(i,f,d){return r.onCopy(i,f,d),f.deleteAtRange(f.value.selection),!0}}}},1020:(Q,I,e)=>{"use strict";e.d(I,{T:()=>s});var n=e(57746),a=e(82611),o=e(75226);const r=(0,n.Sn)("mod+["),i=(0,n.Sn)("shift+tab"),f=(0,n.Sn)("mod+]"),d="  ",l=(h,u,b)=>{const{startBlock:g,endBlock:P,selection:{start:{offset:c,key:y},end:{offset:p,key:v}}}=u.value;if(o.A.serialize(u.value)==="")return;h.preventDefault();const D=g.getFirstText();D&&c===0&&y===D.key&&p===D.text.length&&v===D.key||!g.equals(P)?m(u,"right"):u.insertText(d)},m=(h,u)=>{const b=h.value.selection,g=h.value.document.getLeafBlocksAtRange(b).toArray();if(u==="left")for(const P of g){const c=P.text.length-P.text.trimLeft().length,y=P.getFirstText().key,p={anchor:{key:y,offset:c,path:[]},focus:{key:y,offset:c,path:[]}};h.deleteBackwardAtRange(a.Q6.create(p),Math.min(d.length,c))}else{const{startText:P}=h.value,c=P.text.slice(0,b.start.offset),y=/^\s*$/.test(c);for(const p of g)h.insertTextByKey(p.getFirstText().key,0,d);y&&h.moveStartBackward(d.length)}};function s(){return{onKeyDown(h,u,b){if(r(h)||i(h))h.preventDefault(),m(u,"left");else if(f(h))h.preventDefault(),m(u,"right");else if(h.key==="Tab")l(h,u,b);else return b();return!0}}}},50955:(Q,I,e)=>{"use strict";e.d(I,{e1:()=>r,vJ:()=>i.v,sW:()=>f.s,TA:()=>d.T,Om:()=>l.O,Ul:()=>m.U,l9:()=>s.l,De:()=>h.D,Pz:()=>u.Pz});var n=e(62938);const a={"[":"]","{":"}","(":")"},o="brace_match";function r(){return{onKeyDown(b,g,P){const{value:c}=g;switch(b.key){case"(":case"{":case"[":{const{start:{offset:y,key:p},end:{offset:v,key:D},focus:{offset:E}}=c.selection,S=c.focusText.text;if(c.selection.isExpanded)return b.preventDefault(),g.insertTextByKey(p,y,b.key).insertTextByKey(D,v+1,a[b.key]).moveEndBackward(1),!0;if(E===S.length||S[E]===" "||Object.values(a).includes(S[E])){b.preventDefault();const T=a[b.key],M={key:`${o}-${(0,n.A)()}`,type:`${o}-${T}`,anchor:{key:p,offset:y,object:"point"},focus:{key:D,offset:v+1,object:"point"},object:"annotation"};return g.insertText(b.key).insertText(T).addAnnotation(M).moveBackward(1),!0}break}case")":case"}":case"]":{const y=c.anchorText.text,p=c.selection.anchor.offset,v=y[p],D=b.key,E=`${o}-${D}`,S=c.annotations.find(T=>T?.type===E&&T.anchor.key===c.anchorText.key);if(S&&v===D&&!c.selection.isExpanded)return b.preventDefault(),g.moveFocusForward(1).removeAnnotation(S).moveAnchorForward(1),!0;break}case"Backspace":{const y=c.anchorText.text,p=c.selection.anchor.offset,v=y[p-1],D=y[p];if(a[v]&&a[v]===D)return b.preventDefault(),g.deleteBackward(1).deleteForward(1).focus(),!0}default:break}return P()}}}var i=e(74738),f=e(99453),d=e(1020),l=e(88295),m=e(4269),s=e(31589),h=e(41781),u=e(80903)},88295:(Q,I,e)=>{"use strict";e.d(I,{O:()=>a});function n(o){let r=o.length-o.trimLeft().length;if(r){let i=o[0];for(;--r;)i+=o[0];return i}return""}function a(){return{onKeyDown(o,r,i){const f=r.value;if(f.selection.isExpanded)return i();if(o.key==="Enter"){o.preventDefault();const{startBlock:d}=f,l=d.text,m=n(l);return r.splitBlock().insertText(m).focus()}return i()}}}},4269:(Q,I,e)=>{"use strict";e.d(I,{U:()=>n});function n({handler:a}){return{onKeyDown(o,r,i){return a&&o.key==="Enter"&&(o.shiftKey||o.ctrlKey)?(o.preventDefault(),a(o),r):i()}}}},31589:(Q,I,e)=>{"use strict";e.d(I,{l:()=>o});var n=e(57746);const a=(0,n.Sn)("mod+l");function o(){return{onKeyDown(r,i,f){if(a(r)){r.preventDefault();const{focusBlock:d,document:l}=i.value;i.moveAnchorToStartOfBlock(),l.getNextBlock(d.key)?i.moveFocusToStartOfNextBlock():i.moveFocusToEndOfText()}else return f();return!0}}}},84694:(Q,I,e)=>{"use strict";e.d(I,{A:()=>a});const a="prism-token"},41781:(Q,I,e)=>{"use strict";e.d(I,{D:()=>u,R:()=>c});var n=e(28848),a=e.n(n),o=e(82611),r=e(84694),i=e(49568),f=e(96540);function d(y){return y.object==="block"&&y.type==="code_block"}function l(y){return"javascript"}function m(y,p,v){const{decoration:D}=y;if(D.type!==r.A)return v();const E=D.data.get("className");return f.createElement("span",{className:E},y.children)}class s extends(0,i.Record)({onlyIn:d,getSyntax:l,renderDecoration:m}){constructor(p){super(p)}}const h=s;function u(y={},p=a().languages){const v=new h(y);return{decorateNode:(D,E,S)=>{if(!v.onlyIn(D))return S();const T=o.eB.create(D),M=v.getSyntax(T),A=p[M];if(!A)return[];const C=T.getTexts().map(N=>N&&N.getText()).join(`
`),O=a().tokenize(C,A),R=c(O),L=E.value.data.set("tokens",R);return E.setData(L),b(v,O,T)},renderDecoration:(D,E,S)=>v.renderDecoration({children:D.children,decoration:D.decoration},E,S)}}function b(y,p,v){const D=v.getTexts(),E=[];let S=0,T=0;return D.forEach(M=>{T=S+M.getText().length;let A=0;function x(C,O){if(typeof C=="string"){if(O){const R=g({text:M,textStart:S,textEnd:T,start:A,end:A+C.length,className:`prism-token token ${O}`,block:v});R&&E.push(R)}A+=C.length}else if(O=`${O} ${C.type}`,C.alias&&(O+=" "+C.alias),typeof C.content=="string"){const R=g({text:M,textStart:S,textEnd:T,start:A,end:A+C.content.length,className:`prism-token token ${O}`,block:v});R&&E.push(R),A+=C.content.length}else for(let R=0;R<C.content.length;R+=1)x(C.content[R],O)}p.forEach(x),S=T+1}),E}function g({text:y,textStart:p,textEnd:v,start:D,end:E,className:S,block:T}){return D>=v||E<=p?null:(D=Math.max(D,p),E=Math.min(E,v),D-=p,E-=p,T.createDecoration({object:"decoration",anchor:{key:y.key,offset:D,object:"point"},focus:{key:y.key,offset:E,object:"point"},type:r.A,data:{className:S}}))}function P(y){return typeof y=="string"?[{content:y,types:[],aliases:[]}]:Array.isArray(y)?y.flatMap(p=>P(p)):y instanceof a().Token?P(y.content).flatMap(p=>{let v=[];return typeof y.alias=="string"?v=[y.alias]:v=y.alias??[],{content:p.content,types:[y.type,...p.types],aliases:[...v,...p.aliases]}}):[]}function c(y){const p=P(y);if(!p.length)return[];const v=p[0];v.prev=null,v.next=p.length>=2?p[1]:null,v.offsets={start:0,end:v.content.length};for(let E=1;E<p.length-1;E++)p[E].prev=p[E-1],p[E].next=p[E+1],p[E].offsets={start:p[E-1].offsets.end,end:p[E-1].offsets.end+p[E].content.length};const D=p[p.length-1];return D.prev=p.length>=2?p[p.length-2]:null,D.next=null,D.offsets={start:p.length>=2?p[p.length-2].offsets.end:0,end:p.length>=2?p[p.length-2].offsets.end+D.content.length:D.content.length},p}},80903:(Q,I,e)=>{"use strict";e.d(I,{Pz:()=>F});var n=e(2543),a=e(96540),o=e(32196),r=e(40961),i=e(91793),f=e(60578),d=e(50774),l=e(49579);const m=w=>w.reduce((U,{items:W,label:V})=>(U.push({label:V,kind:d.I.GroupTitle}),W.reduce((_,H)=>(_.push(H),_),U)),[]),s=w=>w.reduce((U,W)=>U.length<W.label.length?W.label:U,""),h=(w,U,W)=>{const V=(0,l.A)(W,{font:w.typography.fontFamilyMonospace,fontSize:w.typography.bodySmall.fontSize,fontWeight:"normal"}),_=b(V.width,w),H=u(V.height,w),G=g(H,U);return{listWidth:_,listHeight:G,itemHeight:H}},u=(w,U)=>{const W=U.spacing.gridSize*2;return w+W},b=(w,U)=>{const W=U.spacing.gridSize*3;return Math.min(Math.max(w+W,200),800)},g=(w,U)=>{const W=Math.min(U.length,10),V=100,_=W*w;return Math.max(_,V)};var P=e(36663),c=e(40845);const y=(w,U,W)=>({typeaheadItem:(0,o.css)({label:"type-ahead-item",zIndex:11,padding:w.spacing(1,1,1,2),border:w.colors.border.medium,overflowY:"scroll",overflowX:"hidden",outline:"none",background:w.colors.background.secondary,color:w.colors.text.secondary,boxShadow:`0 0 20px ${w.v1.colors.dropdownShadow}`,visibility:W===!0?"visible":"hidden",width:"250px",minHeight:`${U+parseInt(w.spacing(.25),10)}px`,position:"relative",wordBreak:"break-word"})}),p=({item:w,height:U})=>{const W=w&&!!w.documentation,V=w?w.label:"",_=(0,P.G)(w?.documentation),H=(0,c.$j)(),G=y(H,U,W);return a.createElement("div",{className:(0,o.cx)([G.typeaheadItem])},a.createElement("b",null,V),a.createElement("hr",null),a.createElement("div",{dangerouslySetInnerHTML:{__html:_}}))};var v=e(23257),D=e.n(v),E=e(5313);const S=w=>({typeaheadItem:(0,o.css)({border:"none",background:"none",textAlign:"left",label:"type-ahead-item",height:"auto",fontFamily:w.typography.fontFamilyMonospace,padding:w.spacing(1,1,1,2),fontSize:w.typography.bodySmall.fontSize,textOverflow:"ellipsis",overflow:"hidden",zIndex:11,display:"block",whiteSpace:"nowrap",cursor:"pointer",[w.transitions.handleMotion("no-preference","reduce")]:{transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"}}),typeaheadItemSelected:(0,o.css)({label:"type-ahead-item-selected",backgroundColor:w.colors.background.secondary}),typeaheadItemMatch:(0,o.css)({label:"type-ahead-item-match",color:w.v1.palette.yellow,borderBottom:`1px solid ${w.v1.palette.yellow}`,padding:"inherit",background:"inherit"}),typeaheadItemGroupTitle:(0,o.css)({label:"type-ahead-item-group-title",color:w.colors.text.secondary,fontSize:w.typography.bodySmall.fontSize,lineHeight:w.typography.body.lineHeight,padding:w.spacing(1)})}),T=w=>{const U=(0,c.of)(S),{isSelected:W,item:V,prefix:_,style:H,onMouseEnter:G,onMouseLeave:j,onClickItem:Y}=w,oe=W?(0,o.cx)([U.typeaheadItem,U.typeaheadItemSelected]):(0,o.cx)([U.typeaheadItem]),se=(0,o.cx)([U.typeaheadItemMatch]),ne=(0,o.cx)([U.typeaheadItemGroupTitle]),ee=V.label||"";return V.kind===d.I.GroupTitle?a.createElement("li",{className:ne,style:H},a.createElement("span",null,ee)):a.createElement("li",{role:"none"},a.createElement("button",{role:"menuitem",className:oe,style:H,onMouseDown:Y,onMouseEnter:G,onMouseLeave:j,type:"button"},V.highlightParts!==void 0?a.createElement(E.z,{text:ee,highlightClassName:se,highlightParts:V.highlightParts}):a.createElement(D(),{textToHighlight:ee,searchWords:[_??""],autoEscape:!0,highlightClassName:se})))},M=(w,U)=>w-U*Math.floor(w/U);class A extends a.PureComponent{constructor(){super(...arguments),this.listRef=(0,a.createRef)(),this.state={hoveredItem:null,typeaheadIndex:null,allItems:[],listWidth:-1,listHeight:-1,itemHeight:-1},this.componentDidMount=()=>{this.props.menuRef&&this.props.menuRef(this),document.addEventListener("selectionchange",this.handleSelectionChange);const U=m(this.props.groupedItems),W=s(U),{listWidth:V,listHeight:_,itemHeight:H}=h(this.context,U,W);this.setState({listWidth:V,listHeight:_,itemHeight:H,allItems:U})},this.componentWillUnmount=()=>{document.removeEventListener("selectionchange",this.handleSelectionChange)},this.handleSelectionChange=()=>{this.forceUpdate()},this.componentDidUpdate=(U,W)=>{if(this.state.typeaheadIndex!==null&&W.typeaheadIndex!==this.state.typeaheadIndex&&this.listRef&&this.listRef.current){if(this.state.typeaheadIndex===1){this.listRef.current.scrollToItem(0);return}this.listRef.current.scrollToItem(this.state.typeaheadIndex)}if((0,n.isEqual)(U.groupedItems,this.props.groupedItems)===!1){const V=m(this.props.groupedItems),_=s(V),{listWidth:H,listHeight:G,itemHeight:j}=h(this.context,V,_);this.setState({listWidth:H,listHeight:G,itemHeight:j,allItems:V,typeaheadIndex:null})}},this.onMouseEnter=U=>{this.setState({hoveredItem:U})},this.onMouseLeave=()=>{this.setState({hoveredItem:null})},this.moveMenuIndex=U=>{const W=this.state.allItems.length;if(W){const V=this.state.typeaheadIndex||0;let _=M(V+U,W);this.state.allItems[_].kind===d.I.GroupTitle&&(_=M(_+U,W)),this.setState({typeaheadIndex:_});return}},this.insertSuggestion=()=>{this.props.onSelectSuggestion&&this.state.typeaheadIndex!==null&&this.props.onSelectSuggestion(this.state.allItems[this.state.typeaheadIndex])}}static{this.contextType=f.D}get menuPosition(){if(!window.getSelection)return"";const U=window.getSelection(),W=U&&U.anchorNode;if(W&&W.parentElement){const V=W.parentElement.getBoundingClientRect(),_=window.scrollX,H=window.scrollY;return`position: absolute; display: flex; top: ${V.top+H+V.height+6}px; left: ${V.left+_-2}px`}return""}render(){const{prefix:U,isOpen:W=!1,origin:V}=this.props,{allItems:_,listWidth:H,listHeight:G,itemHeight:j,hoveredItem:Y,typeaheadIndex:oe}=this.state,se=C(this.context),ne=Y||oe,ee=_[Y||oe||0];return a.createElement(x,{origin:V,isOpen:W,style:this.menuPosition},a.createElement("ul",{role:"menu",className:se.typeahead,"data-testid":"typeahead"},a.createElement(i.Y1,{ref:this.listRef,itemCount:_.length,itemSize:j,itemKey:Z=>{const z=_&&_[Z];return z?`${Z}-${z.label}`:`${Z}`},width:H,height:G},({index:Z,style:z})=>{const q=_&&_[Z];return q?a.createElement(T,{onClickItem:()=>this.props.onSelectSuggestion?this.props.onSelectSuggestion(q):{},isSelected:oe===null?!1:_[oe]===q,item:q,prefix:U,style:z,onMouseEnter:()=>this.onMouseEnter(Z),onMouseLeave:this.onMouseLeave}):null})),ne&&a.createElement(p,{height:G,item:ee}))}}class x extends a.PureComponent{constructor(U){super(U);const{index:W=0,origin:V="query",style:_}=U;this.node=document.createElement("div"),this.node.setAttribute("style",_),this.node.classList.add("slate-typeahead",`slate-typeahead-${V}-${W}`),document.body.appendChild(this.node)}componentWillUnmount(){document.body.removeChild(this.node)}render(){return this.props.isOpen?(this.node.setAttribute("style",this.props.style),this.node.classList.add("slate-typeahead--open"),r.createPortal(this.props.children,this.node)):(this.node.classList.remove("slate-typeahead--open"),null)}}const C=w=>({typeahead:(0,o.css)({maxHeight:300,overflowY:"auto",strong:{color:w.v1.palette.yellow}})});var O=e(72307),R=e(75071),L=e(84694);const N=250;function F({onTypeahead:w,cleanText:U,onWillApplySuggestion:W,portalOrigin:V}){let _,H={groupedItems:[],typeaheadPrefix:"",typeaheadContext:"",typeaheadText:""};const G=(0,n.debounce)(K,N),j=Y=>{H={...H,...Y}};return{onBlur:(Y,oe,se)=>(H={...H,groupedItems:[]},se()),onClick:(Y,oe,se)=>(H={...H,groupedItems:[]},se()),onKeyDown:(Y,oe,se)=>{const ee=H.groupedItems.length;switch(Y.key){case"Escape":{if(ee)return Y.preventDefault(),H={...H,groupedItems:[]},oe.insertText("");break}case"ArrowDown":case"ArrowUp":if(ee){Y.preventDefault(),_.moveMenuIndex(Y.key==="ArrowDown"?1:-1);return}break;case"Enter":{if(!(Y.shiftKey||Y.ctrlKey)&&ee)return Y.preventDefault(),_.insertSuggestion();break}case"Tab":{if(ee)return Y.preventDefault(),_.insertSuggestion();break}default:{Y.key.length===1&&G(oe,j,w,U);break}}return se()},commands:{selectSuggestion:(Y,oe)=>{const se=H.groupedItems;if(!se||!se.length)return Y;const ne=Y.applyTypeahead(oe);return G(Y,j,w,U),ne},applyTypeahead:(Y,oe)=>{let se=oe.insertText||oe.label;const ne=oe.kind==="function",ee=oe.move||0,Z=ee>0?ee:0,z=ee<0?-ee:0,{typeaheadPrefix:q,typeaheadText:ie,typeaheadContext:de}=H;W&&(se=W(se,{groupedItems:H.groupedItems,typeaheadContext:de,typeaheadPrefix:q,typeaheadText:ie}));const{forward:ue,backward:fe}=B(se,q,ie,ne,oe.deleteBackwards,U);if(se.match(/\n/)){const Se=(0,O.dF)(se);return Y.deleteBackward(fe).deleteForward(ue).insertFragment(Se).focus(),Y}return H={...H,groupedItems:[]},Y.snapshotSelection().deleteBackward(fe).deleteForward(ue).insertText(se).moveForward(Z).moveBackward(z).focus(),Y}},renderEditor(Y,oe,se){if(oe.value.selection.isExpanded)return se();const ne=se();return a.createElement(a.Fragment,null,ne,a.createElement(A,{menuRef:ee=>_=ee,origin:V,prefix:H.typeaheadPrefix,isOpen:!!H.groupedItems.length,groupedItems:H.groupedItems,onSelectSuggestion:oe.selectSuggestion}))}}}const K=async(w,U,W,V)=>{if(!W)return;const{value:_}=w,{selection:H}=_,G=_.document.getClosestBlock(_.focusBlock.key),j=_.selection.start.offset-1,Y=G&&G.getDecorations(w),oe=Y?Y.filter(fe=>fe.start.offset<=j&&fe.end.offset>j&&fe.type===L.A).toArray():[],se=Y&&Y.filter(fe=>fe.end.offset<=j&&fe.type===L.A&&fe.data.get("className").includes("label-key")).last(),ne=se&&_.focusText.text.slice(se.start.offset,se.end.offset),ee=oe.map(fe=>fe.data.get("className")).join(" ").split(" ").filter(fe=>fe.length);let Z=_.focusText.text,z=Z.slice(0,H.focus.offset);oe.length&&(Z=_.focusText.text.slice(oe[0].start.offset,oe[0].end.offset),z=_.focusText.text.slice(oe[0].start.offset,H.focus.offset));const q=z.match(/(?:!?=~?"?|")(.*)/);q?z=q[1]:V&&(z=V(z));const{suggestions:ie,context:de}=await W({prefix:z,text:Z,value:_,wrapperClasses:ee,labelKey:ne||void 0,editor:w}),ue=ie.map(fe=>{if(!fe.items)return fe;const Se=fe.searchFunctionType||(fe.prefixMatch?R.T.Prefix:R.T.Word),he=R.H[Se];let ce={...fe};return z&&(fe.skipFilter||(ce.items=ce.items.filter(me=>(me.filterText||me.label).length>=z.length),ce.items=he(ce.items,z)),ce.items=ce.items.filter(me=>!(me.insertText===z||(me.filterText??me.label)===z))),fe.skipSort||(ce.items=(0,n.sortBy)(ce.items,me=>me.sortText===void 0?me.sortValue!==void 0?me.sortValue:me.label:me.sortText||me.label)),ce}).filter(fe=>fe.items&&fe.items.length);U({groupedItems:ue,typeaheadPrefix:z,typeaheadContext:de,typeaheadText:Z}),w.blur().focus()};function B(w,U,W,V,_,H){const G=_||U.length,j=H?H(W):W,Y=W.indexOf(U),oe=Y>-1?j.length-Y-U.length:j.length-U.length;return{forward:!!(U&&oe>0||w===W)&&!V?oe+Y:0,backward:G}}},17425:(Q,I,e)=>{"use strict";e.d(I,{k:()=>p});var n=e(94659),a=e(96540),o=e(40845);function r(v){return(0,n.css)({".panel-options-group":{borderBottom:`1px solid ${v.colors.border.weak}`},".panel-options-group__header":{padding:v.spacing(1,2,1,1),position:"relative",display:"flex",alignItems:"center",cursor:"pointer",fontWeight:500,color:v.colors.text.primary,"&:hover":{background:v.colors.emphasize(v.colors.background.primary,.03)}},".panel-options-group__icon":{color:v.colors.text.secondary,marginRight:v.spacing(1),padding:v.spacing(0,.9,0,.6)},".panel-options-group__title":{position:"relative"},".panel-options-group__body":{padding:v.spacing(1,2,1,4)}})}function i(v){return(0,n.css)({".card-section":{marginBottom:v.spacing(4)},".card-list":{display:"flex",flexDirection:"row",flexWrap:"wrap",listStyleType:"none"},".card-item":{display:"block",height:"100%",background:v.colors.background.secondary,boxShadow:"none",padding:v.spacing(2),borderRadius:"4px","&:hover":{background:v.colors.emphasize(v.colors.background.secondary,.03)},".label-tag":{marginLeft:v.spacing(1),fontSize:"11px",padding:"2px 6px"}},".card-item-body":{display:"flex",overflow:"hidden"},".card-item-details":{overflow:"hidden"},".card-item-header":{marginBottom:v.spacing(2)},".card-item-type":{color:v.colors.text.secondary,textTransform:"uppercase",fontSize:v.typography.size.sm,fontWeight:v.typography.fontWeightMedium},".card-item-badge":{margin:"6px 0"},".card-item-notice":{fontSize:v.typography.size.sm},".card-item-name":{color:v.colors.text.primary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-label":{marginLeft:v.spacing(1)},".card-item-sub-name":{color:v.colors.text.secondary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-sub-name--header":{color:v.colors.text.secondary,textTransform:"uppercase",marginBottom:v.spacing(2),fontSize:v.typography.size.sm,fontWeight:"bold"},".card-list-layout-grid":{".card-item-type":{display:"inline-block"},".card-item-notice":{fontSize:v.typography.size.sm,display:"inline-block",marginLeft:v.spacing(2)},".card-item-header-action":{float:"right"},".card-item-wrapper":{width:"100%",padding:v.spacing(0,2,2,0)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item-figure":{margin:v.spacing(0,2,2,0),height:"80px",img:{width:"80px"}},".card-item-name":{fontSize:v.typography.h3.fontSize},[v.breakpoints.up("md")]:{".card-item-wrapper":{width:"50%"}},[v.breakpoints.up("lg")]:{".card-item-wrapper":{width:"33.333333%"}},"&.card-list-layout-grid--max-2-col":{[v.breakpoints.up("lg")]:{".card-item-wrapper":{width:"50%"}}}},".card-list-layout-list":{".card-item-wrapper":{padding:0,width:"100%",marginBottom:v.spacing(1)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item":{borderRadius:"2px"},".card-item-header":{float:"right",textAlign:"right"},".card-item-figure":{margin:v.spacing(0,2,0,0),img:{width:"48px"}},".card-item-name":{fontSize:v.typography.h4.fontSize},".card-item-sub-name":{fontSize:v.typography.size.sm},".layout-selector":{marginRight:0}}})}var f=e(16797);function d(v){return(0,n.css)({html:{MsOverflowStyle:"scrollbar",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",height:"100%",fontSize:`${v.typography.htmlFontSize}px`,fontFamily:v.typography.fontFamily,lineHeight:v.typography.body.lineHeight,fontKerning:"normal"},":root":{colorScheme:v.colors.mode},body:{height:"100%",width:"100%",position:"absolute",color:v.colors.text.primary,backgroundColor:v.colors.background.canvas,...l(v.typography.body)},"h1, .h1":l(v.typography.h1),"h2, .h2":l(v.typography.h2),"h3, .h3":l(v.typography.h3),"h4, .h4":l(v.typography.h4),"h5, .h5":l(v.typography.h5),"h6, .h6":l(v.typography.h6),p:{margin:v.spacing(0,0,2)},button:{letterSpacing:v.typography.body.letterSpacing,"&:focus-visible":(0,f.getFocusStyles)(v),"&:focus":{outline:"none"}},small:{fontSize:v.typography.bodySmall.fontSize},"b, strong":{fontWeight:v.typography.fontWeightMedium},em:{fontStyle:"italic",color:v.colors.text.primary},cite:{fontStyle:"normal"},".muted":{color:v.colors.text.secondary},"a.muted:hover, a.muted:focus":{color:v.colors.text.primary},".text-warning":{color:v.colors.warning.text,"&:hover, &:focus":{color:v.colors.emphasize(v.colors.warning.text,.15)}},".text-error":{color:v.colors.error.text,"&:hover, &:focus":{color:v.colors.emphasize(v.colors.error.text,.15)}},".text-success":{color:"$success-text-color","&:hover, &:focus":{color:v.colors.emphasize(v.colors.success.text,.15)}},a:{cursor:"pointer",color:v.colors.text.primary,textDecoration:"none","&:focus":{outline:"none"},"&:focus-visible":(0,f.getFocusStyles)(v),"&:[disabled]":{cursor:"default",pointerEvents:"none !important"}},".text-link":{textDecoration:"underline"},".text-left":{textAlign:"left"},".text-right":{textAlign:"right"},".text-center":{textAlign:"center"},".highlight-search-match":{background:v.components.textHighlight.background,color:v.components.textHighlight.text,padding:0}})}function l(v){return{margin:0,fontSize:v.fontSize,lineHeight:v.lineHeight,fontWeight:v.fontWeight,letterSpacing:v.letterSpacing,fontFamily:v.fontFamily,marginBottom:"0.45em"}}function m(v){return(0,n.css)({"iframe.intercom-borderless-frame":{colorScheme:v.colors.mode}})}function s(v){return(0,n.css)({"input, button, select, textarea":{fontFamily:v.typography.body.fontFamily,fontSize:v.typography.body.fontSize,fontWeight:v.typography.body.fontWeight,lineHeight:v.typography.body.lineHeight},"input, select":{backgroundColor:v.components.input.background,color:v.components.input.text,border:"none",boxShadow:"none"},textarea:{height:"auto"},"input[type='file'], input[type='image'], input[type='submit'], input[type='reset'], input[type='button'], input[type='radio'], input[type='checkbox']":{width:"auto"}})}function h(v){return(0,n.css)({".gf-form-select-box__control":{width:"100%",marginRight:v.spacing(.5),backgroundColor:v.components.input.background,border:`1px solid ${v.components.input.borderColor}`,borderRadius:v.shape.radius.default,color:v.components.input.text,cursor:"default",height:v.spacing(4),outline:"none",overflow:"hidden",position:"relative"},".gf-form-select-box__control--is-focused":{backgroundColor:v.components.input.background,borderColor:v.colors.primary.border,outline:"none",boxShadow:`inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px ${v.colors.primary.border}`},".gf-form-select-box__control--is-disabled":{backgroundColor:v.colors.action.disabledBackground},".gf-form-select-box__control--menu-right":{".gf-form-select-box__menu":{right:0,left:"unset"}},".gf-form-select-box__input":{input:{lineHeight:"inherit"}},".gf-form-select-box__menu":{background:v.colors.background.primary,boxShadow:v.shadows.z3,position:"absolute",zIndex:v.zIndex.dropdown,minWidth:"100%","&-notice--no-options":{backgroundColor:v.components.input.background,padding:"10px"}},".gf-form-select-box__menu-list":{overflowY:"auto",maxHeight:"300px",maxWidth:"600px"},".tag-filter .gf-form-select-box__menu":{width:"100%"},".gf-form-select-box__multi-value":{display:"inline",margin:"0 6px 0 0",cursor:"pointer"},".gf-form-select-box__multi-value__remove":{textAlign:"center",display:"inline-block",marginLeft:"2px",position:"relative"},".gf-form-select-box__multi-value__label":{display:"inline",verticalAlign:"middle"},".gf-form-select-box__option":{borderLeft:"2px solid transparent",whiteSpace:"nowrap",backgroundColor:v.components.input.background,"&.gf-form-select-box__option--is-focused":{color:v.colors.text.primary,background:v.colors.action.hover,borderImage:v.colors.gradients.brandVertical,borderImageSlice:1,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"},"&.gf-form-select-box__option--is-selected":{".fa":{color:v.colors.text.primary}}},".gf-form-select-box__placeholder":{color:v.colors.text.disabled},".gf-form-select-box__control--is-focused .gf-form-select-box__placeholder":{display:"none"},".gf-form-select-box__value-container":{display:"inline-block",padding:"6px 20px 6px 10px",verticalAlign:"middle","> div":{display:"inline-block",verticalAlign:"middle"}},".gf-form-select-box__indicators":{position:"absolute",height:"100%",right:"8px",top:"1px",display:"inline-block",textAlign:"right"},".gf-form-input--form-dropdown":{padding:0,border:0,overflow:"visible",position:"relative"},".gf-form--has-input-icon":{".gf-form-select-box__value-container":{paddingLeft:"30px"}},".gf-form-select-box__desc-option":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%"},".gf-form-select-box__desc-option__body":{display:"flex",flexDirection:"column",flexGrow:1,paddingRight:"10px",fontWeight:v.typography.fontWeightMedium},".gf-form-select-box__desc-option__desc":{fontWeight:"normal",fontSize:v.typography.bodySmall.fontSize,color:v.colors.text.secondary},".gf-form-select-box__desc-option__img":{width:"16px",marginRight:"10px"},".gf-form-select-box__option-group__header":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${v.v1.palette.dark9}`,textTransform:"capitalize",".fa":{paddingRight:"2px"}},".gf-form-select-box-button-select":{height:"auto"},".select-button":{display:"flex",alignItems:"center"}})}function u(v){return(0,n.css)({})}function b(v){const D=v.breakpoints.values.xxl+v.spacing.gridSize*2+v.components.sidemenu.width;return(0,n.css)({".grafana-app":{display:"flex",alignItems:"stretch",position:"absolute",width:"100%",height:"100%",top:0,left:0},".main-view":{position:"relative",display:"flex",flexDirection:"column",flexGrow:1,height:"100%",flex:"1 1 0",minWidth:0},".page-scrollbar-content":{display:"flex",minHeight:"100%",flexDirection:"column",width:"100%",height:"100%"},".page-container":{flexGrow:1,flexBasis:"100%",paddingLeft:v.spacing(2),paddingRight:v.spacing(2),[v.breakpoints.up("sm")]:{margin:v.spacing(0,1)},[v.breakpoints.up("md")]:{margin:v.spacing(0,2)},[`@media (min-width: ${D}px)`]:{maxWidth:`${v.breakpoints.values.xxl}px`,marginLeft:"auto",marginRight:"auto",width:"100%"}},".page-full":{marginLeft:v.spacing(2),paddingLeft:v.spacing(2),paddingRight:v.spacing(2)},".page-body":{padding:v.spacing(1),background:v.components.panel.background,border:`1px solid ${v.components.panel.borderColor}`,marginBottom:"32px",[v.breakpoints.up("md")]:{padding:v.spacing(2)},[v.breakpoints.up("lg")]:{padding:v.spacing(3)}},".page-heading":{fontSize:v.typography.h4.fontSize,marginTop:0,marginBottom:v.spacing(2)},".page-action-bar":{marginBottom:v.spacing(2),display:"flex",alignItems:"flex-start",gap:v.spacing(2)},".page-action-bar--narrow":{marginBottom:0},".page-action-bar__spacer":{width:v.spacing(2),flexGrow:1},".page-sub-heading":{marginBottom:v.spacing(2)},".page-sub-heading-icon":{marginLeft:v.spacing(1),marginTop:v.spacing(.5)},".page-hidden":{display:"none"}})}function g(v){return(0,n.css)({".rc-time-picker-input,.rc-time-picker-panel-input-wrap,.rc-time-picker-panel-inner":{backgroundColor:v.components.input.background,color:v.colors.text.secondary,borderColor:v.components.input.borderColor,fontSize:v.typography.body.fontSize},".rc-time-picker-input":{padding:v.spacing(0,1),height:v.spacing(4)},".rc-time-picker-panel":{width:"176px"},".rc-time-picker-panel-select":{width:"50%","&:only-child":{width:"100%"},".rc-time-picker-panel-select-option-selected":{backgroundColor:v.colors.background.secondary},"li:hover":{backgroundColor:v.colors.background.secondary}},".rc-time-picker-panel-narrow":{maxWidth:"none"}})}var P=e(72129);const c=v=>(0,n.css)({".react-loading-skeleton":P.Q});function y(v){return(0,n.css)({".uplot":{fontFamily:"inherit"},".u-select":{background:"rgba(120, 120, 130, 0.2)"},".u-hz .u-cursor-x, .u-vt .u-cursor-y":{borderRight:"1px dashed rgba(120, 120, 130, 0.5)"},".u-hz .u-cursor-y, .u-vt .u-cursor-x":{borderBottom:"1px dashed rgba(120, 120, 130, 0.5)"},".shared-crosshair:not(.plot-active) .u-cursor-pt":{display:"none !important"}})}function p(){const v=(0,o.$j)();return a.createElement(n.Global,{styles:[d(v),m(v),s(v),b(v),i(v),r(v),u(v),c(v),g(v),y(v),h(v)]})}},40845:(Q,I,e)=>{"use strict";e.d(I,{$j:()=>b,DP:()=>u,IS:()=>g,SL:()=>s,cV:()=>h,fq:()=>c,of:()=>P});var n=e(4146),a=e.n(n),o=e(47078),r=e.n(o),i=e(96540),f=e(60578),d=e(3911);let l=null;const m=new WeakMap,s=y=>{const p=v=>{const D=l||f.D;return i.createElement(D.Consumer,null,E=>i.createElement(y,{...v,theme:E.v1}))};return p.displayName=`WithTheme(${y.displayName})`,a()(p,y),p},h=y=>{const p=v=>{const D=l||f.D;return i.createElement(D.Consumer,null,E=>i.createElement(y,{...v,theme:E}))};return p.displayName=`WithTheme(${y.displayName})`,a()(p,y),p};function u(){return(0,i.useContext)(l||f.D).v1}function b(){return(0,i.useContext)(l||f.D)}function g(y){const p=u();let v=m.get(y);return v||(v=(0,d.N)(y),m.set(y,v)),v(p)}function P(y,...p){const v=b();let D=m.get(y);return D||(D=r()(y,{maxSize:10}),m.set(y,D)),D(v,...p)}const c=y=>(l=i.createContext(y),()=>{l=null})},7918:(Q,I,e)=>{"use strict";e.d(I,{kH:()=>l.k,Dx:()=>n.D,O4:()=>i,mG:()=>f,fq:()=>a.fq,YF:()=>m,N3:()=>d.N,IS:()=>a.IS,of:()=>a.of,DP:()=>a.DP,$j:()=>a.$j,SL:()=>a.SL,cV:()=>a.cV});var n=e(60578),a=e(40845),o=e(75972);let r;const i=(s="dark")=>r?r(s):(0,o.a)({colors:{mode:s}}).v1,f=s=>(r=s,()=>{r=null});var d=e(3911),l=e(17425),m=e(16797)},16797:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{cardChrome:()=>a,focusCss:()=>l,getFocusStyles:()=>s,getMouseFocusStyles:()=>m,getTooltipContainerStyles:()=>h,hoverColor:()=>o,listItem:()=>r,listItemSelected:()=>i,mediaUp:()=>f});var n=e(84140);function a(u){return`
    background: ${u.colors.background.secondary};
    &:hover {
      background: ${o(u.colors.background.secondary,u)};
    }
    box-shadow: ${u.components.panel.boxShadow};
    border-radius: ${u.shape.radius.default};
`}function o(u,b){return b.isDark?(0,n.A)(u).brighten(2).toString():(0,n.A)(u).darken(2).toString()}function r(u){return`
  background: ${u.colors.background.secondary};
  &:hover {
    background: ${o(u.colors.background.secondary,u)};
  }
  box-shadow: ${u.components.panel.boxShadow};
  border-radius: ${u.shape.radius.default};
`}function i(u){return`
    background: ${o(u.colors.background.secondary,u)};
    color: ${u.colors.text.maxContrast};
`}function f(u){return`only screen and (min-width: ${u})`}const d=u=>u.hasOwnProperty("v1"),l=u=>{const b=d(u),g=b?u.colors.background.canvas:u.colors.bodyBg,P=b?u.colors.primary.main:u.colors.formFocusOutline;return`
  outline: 2px dotted transparent;
  outline-offset: 2px;
  box-shadow: 0 0 0 2px ${g}, 0 0 0px 4px ${P};
  transition-property: outline, outline-offset, box-shadow;
  transition-duration: 0.2s;
  transition-timing-function: cubic-bezier(0.19, 1, 0.22, 1);`};function m(u){return{outline:"none",boxShadow:"none"}}function s(u){return{outline:"2px dotted transparent",outlineOffset:"2px",boxShadow:`0 0 0 2px ${u.colors.background.canvas}, 0 0 0px 4px ${u.colors.primary.main}`,transitionTimingFunction:"cubic-bezier(0.19, 1, 0.22, 1)",transitionDuration:"0.2s",transitionProperty:"outline, outline-offset, box-shadow"}}const h=u=>({overflow:"hidden",background:u.colors.background.secondary,boxShadow:u.shadows.z2,maxWidth:"800px",padding:u.spacing(1),borderRadius:u.shape.radius.default,zIndex:u.zIndex.tooltip})},3911:(Q,I,e)=>{"use strict";e.d(I,{N:()=>o});var n=e(47078),a=e.n(n);function o(r){return a()(r)}},50774:(Q,I,e)=>{"use strict";e.d(I,{I:()=>n});var n=(a=>(a.GroupTitle="GroupTitle",a))(n||{})},29621:()=>{"use strict"},4025:(Q,I,e)=>{"use strict";e.d(I,{GO:()=>r,SS:()=>i,Uo:()=>n.Uo,lV:()=>f,rJ:()=>o});var n=e(8887),a=e(11261);const o=d=>["xs","sm","md","lg","xl","xxl","xxxl"].includes(d),r=()=>Object.keys(n.az);function i(d){return f(d?.type)}function f(d){if(d)switch(d){case a.PU.time:return"clock-nine";case a.PU.string:return"font";case a.PU.number:return"calculator-alt";case a.PU.boolean:return"toggle-on";case a.PU.trace:return"info-circle";case a.PU.enum:return"list-ol";case a.PU.geo:return"map-marker";case a.PU.other:return"brackets-curly"}return"question-circle"}},80186:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{CompletionItemKind:()=>i.I,getAvailableIcons:()=>l.GO,getFieldTypeIcon:()=>l.SS,getFieldTypeIconName:()=>l.lV,isIconSize:()=>l.rJ,toIconName:()=>l.Uo});var n=e(64611),a=e.n(n),P={};for(const c in n)c!=="default"&&(P[c]=()=>n[c]);e.d(I,P);var o=e(11866),r=e.n(o),P={};for(const c in o)c!=="default"&&(P[c]=()=>o[c]);e.d(I,P);var i=e(50774),f=e(29621),d=e.n(f),P={};for(const c in f)["default","CompletionItemKind"].indexOf(c)<0&&(P[c]=()=>f[c]);e.d(I,P);var l=e(4025),m=e(19932),s=e.n(m),P={};for(const c in m)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(c)<0&&(P[c]=()=>m[c]);e.d(I,P);var h=e(72389),u=e.n(h),P={};for(const c in h)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(c)<0&&(P[c]=()=>h[c]);e.d(I,P);var b=e(65484),g=e.n(b),P={};for(const c in b)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(c)<0&&(P[c]=()=>b[c]);e.d(I,P)},11866:()=>{"use strict"},65484:()=>{"use strict"},19932:()=>{"use strict"},72389:()=>{"use strict"},64611:()=>{"use strict"},40321:(Q,I,e)=>{"use strict";e.d(I,{Q:()=>n});const n=(a,o)=>{a.key==="Tab"||a.altKey||a.ctrlKey||a.metaKey||(a.stopPropagation(),a.key==="Escape"&&o())}},24284:(Q,I,e)=>{"use strict";e.d(I,{Ih:()=>y,Mk:()=>i,Tj:()=>h,UJ:()=>s,Xw:()=>f,ct:()=>m,mZ:()=>c,nO:()=>l,sg:()=>P,xj:()=>d});var n=e(2543),a=e.n(n),o=e(84140);const r=4,i="rgba(0, 211, 255, 1)",f="rgba(11, 237, 50, 1)",d="rgba(237, 46, 24, 1)",l="rgba(150, 150, 150, 1)",m="rgba(247, 149, 32, 1)",s=.09,h=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"];function u(p){const v=(0,n.map)(p,b),D=(0,n.sortBy)(v,["h"]),E=(0,n.chunk)(D,r),S=(0,n.map)(E,M=>(0,n.sortBy)(M,"l")),T=(0,n.flattenDeep)((0,n.zip)(...S));return(0,n.map)(T,g)}function b(p){return(0,o.A)(p).toHsl()}function g(p){return(0,o.A)(p).toHexString()}function P(p){return(0,o.A)(p).getBrightness()>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}function c(p,v){const D=(0,o.A)(p),E=D.getBrightness();return D.getAlpha()<.3?v?"rgb(247, 248, 250)":"rgb(32, 34, 38)":E>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}let y=u(h)},14555:(Q,I,e)=>{"use strict";e.d(I,{F:()=>a,J:()=>n});const n=o=>o().map(r=>({label:r.title,ariaLabel:r.title,url:r.href,target:r.target,icon:`${r.target==="_blank"?"external-link-alt":"link"}`,onClick:r.onClick})),a=o=>/\/explore\?.*&(left|right)=\[(.*\,){2,}(.*){1}\]/.test(o)},40621:(Q,I,e)=>{"use strict";e.d(I,{h:()=>n});function n(a,o,r){}},53550:(Q,I,e)=>{"use strict";e.d(I,{i:()=>n});function n(a){const r=a.lastIndexOf("."),i=a.substring(r),f=a.substring(0,r);return f.length<16?a:`${f.substring(0,16)}...${i}`}},9830:(Q,I,e)=>{"use strict";e.d(I,{I:()=>o});var n=e(2543),a=e.n(n);function o(r,i){let f=0,d=r.indexOf(i);i=i.replace(/\s/g,"");const l=[];if(d!==-1)return{distance:0,found:!0,ranges:[{start:d,end:d+i.length-1}]};for(const m of i){const s=r.indexOf(m,d);if(s===-1)return{distance:1/0,ranges:[],found:!1};if(d!==-1&&(f+=s-d),d=s+1,l.length===0)l.push({start:s,end:s});else{const h=(0,n.last)(l);s===h.end+1?h.end++:l.push({start:s,end:s})}}return{distance:f,ranges:l,found:!0}}},76412:(Q,I,e)=>{"use strict";e.d(I,{t:()=>d,x:()=>i});var n=e(72635),a=e(96540),o=e(32389);function r(){typeof n.default.options.resources!="object"&&n.default.use(o.r9).init({resources:{},returnEmptyString:!1,lng:"en-US"})}const i=l=>(r(),a.createElement(o.x6,{...l})),f=n.default.t,d=(l,m,s)=>(r(),f(l,m,s))},99598:(Q,I,e)=>{"use strict";e.d(I,{xj:()=>i.xj,Mk:()=>i.Mk,bk:()=>n,Pw:()=>f.Pw,nO:()=>i.nO,uc:()=>p,Xw:()=>i.Xw,ct:()=>i.ct,UJ:()=>i.UJ,zt:()=>r,yx:()=>d.yx,Tt:()=>g.T,DB:()=>P.DB,hF:()=>y.h,Vr:()=>u.Vr,Tj:()=>i.Tj,h:()=>c.h,It:()=>v.I,Yc:()=>u.Yc,kl:()=>h.k,XJ:()=>s.X,yC:()=>m.yC,JF:()=>m.JF,MC:()=>m.MC,mZ:()=>i.mZ,sg:()=>i.sg,K:()=>f.K,Fr:()=>l.F,Jl:()=>l.J,dF:()=>d.dF,mO:()=>d.mO,kD:()=>u.kD,RP:()=>f.RP,Ih:()=>i.Ih,CH:()=>b.C,tf:()=>f.tf});var n={};e.r(n),e.d(n,{getNextCharacter:()=>o,getPreviousCousin:()=>a}),typeof window<"u"&&"Element"in window&&!Element.prototype.closest&&(Element.prototype.closest=function(D){const E=(this.document||this.ownerDocument).querySelectorAll(D);let S=this,T;do{for(T=E.length;--T>=0&&E.item(T)!==S;);S=S.parentElement}while(T<0&&S);return S});function a(D,E){let S=D.parentElement.previousSibling,T;for(;S;){if(T=S.querySelector(E),T)return T;S=S.previousSibling}}function o(D){const E=(D||window).getSelection();if(!E||!E.anchorNode)return null;const S=E.getRangeAt(0),T=E.anchorNode.textContent,M=S.startOffset;return T.slice(M,M+1)}var r=e(67892),i=e(24284),f=e(29734),d=e(72307),l=e(14555),m=e(69613),s=e(5260),h=e(90914),u=e(29413),b=e(69731),g=e(75071),P=e(88838),c=e(91040),y=e(40621),p=(D=>(D.id="id",D.title="title",D.subTitle="subTitle",D.mainStat="mainStat",D.secondaryStat="secondaryStat",D.source="source",D.target="target",D.detail="detail__",D.arc="arc__",D.color="color",D))(p||{}),v=e(9830)},91040:(Q,I,e)=>{"use strict";e.d(I,{h:()=>r});var n=e(2543),a=e.n(n);const o=(0,n.throttle)((...i)=>{console.log(...i)},500),r=i=>{let f=!1;return typeof window<"u"&&(f=window.localStorage.getItem("grafana.debug")==="true"),{logger:(d,l=!1,...m)=>{},enable:()=>f=!0,disable:()=>f=!1,isEnabled:()=>f}}},29413:(Q,I,e)=>{"use strict";e.d(I,{Vr:()=>d,Yc:()=>i,kD:()=>f});let n;const a=new Map,o=500;let r="";function i(){return n||(n=document.createElement("canvas").getContext("2d")),n}function f(l,m,s=400){const h=`${s} ${m}px 'Inter'`,u=l+h,b=a.get(u);if(b)return b;const g=i();r!==h&&(g.font=r=h);const P=g.measureText(l);return a.size===o&&a.clear(),a.set(u,P),P}function d(l,m,s,h,u,b){const g=f(l,14,b),P=m/(g.width+2)*14,c=s/h,y=Math.min(c,P);return Math.min(y,u??y)}},67892:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{getChildId:()=>a,renderOrCallToRender:()=>o});var n=e(96540);function a(r){let i;const f=n.Children.only(r);return"id"in f?.props?i=f.props.id:"inputId"in f.props&&(i=f?.props.inputId),typeof i=="string"?i:void 0}function o(r,i){if(n.isValidElement(r)||typeof r=="string"||typeof r=="number")return r;if(typeof r=="function"&&i)return r(i);throw new Error(`${r} is not a React element nor a function that returns React element`)}},5260:(Q,I,e)=>{"use strict";e.d(I,{X:()=>a});let n=null;function a(){if(n!==null)return n;if(typeof document<"u"){const o=document.createElement("div"),r={width:"100px",height:"100px",position:"absolute",top:"-9999px",overflow:"scroll",MsOverflowStyle:"scrollbar"};Object.keys(r).map(i=>{o.style[i]=r[i]}),document.body.appendChild(o),n=o.offsetWidth-o.clientWidth,document.body.removeChild(o)}else n=0;return n||0}},75071:(Q,I,e)=>{"use strict";e.d(I,{H:()=>f,T:()=>a});var n=e(9830),a=(d=>(d.Word="Word",d.Prefix="Prefix",d.Fuzzy="Fuzzy",d))(a||{});const f={Word:(d,l)=>d.filter(m=>(m.filterText||m.label).includes(l)),Prefix:(d,l)=>d.filter(m=>(m.filterText||m.label).startsWith(l)),Fuzzy:(d,l)=>(l=l.toLowerCase(),d.filter(m=>{const{distance:s,ranges:h,found:u}=(0,n.I)(m.label.toLowerCase(),l);return u?(m.sortValue=s,m.highlightParts=h,!0):!1}))}},72129:(Q,I,e)=>{"use strict";e.d(I,{Q:()=>r,j:()=>i});var n=e(32196),a=e(96540);const r={animationName:(0,n.keyframes)({"0%":{opacity:0},"100%":{opacity:1}}),animationDelay:"100ms",animationTimingFunction:"ease-in",animationDuration:"100ms",animationFillMode:"backwards"},i=(f,d)=>Object.assign(f,{Skeleton:m=>a.createElement(d,{...m,rootProps:{style:r}})})},72307:(Q,I,e)=>{"use strict";e.d(I,{dF:()=>o,mO:()=>r,yx:()=>a});var n=e(82611);const a={document:{nodes:[{match:[{type:"paragraph"},{type:"code_block"},{type:"code_line"}]}]},inlines:{}},o=(i,f)=>{const d=i.split(`
`).map(m=>n.eB.create({type:"code_line",nodes:[n.EY.create(m)]})),l=n.eB.create({data:{syntax:f},type:"code_block",nodes:d});return n.yo.create({nodes:[l]})},r=(i,f)=>{const d=o(i,f);return n.WT.create({document:d})}},90914:(Q,I,e)=>{"use strict";e.d(I,{k:()=>n});const n=(a,o)=>{let r;if(a.getLinks&&(r=a.getLinks({valueRowIndex:o.index})),!!r){for(let i=0;i<r?.length;i++)if(r[i].onClick){const f=r[i].onClick;r[i].onClick=d=>{d.ctrlKey||d.metaKey||d.shiftKey||(d.preventDefault(),f(d,{field:a,rowIndex:o.index}))}}return r}}},69613:(Q,I,e)=>{"use strict";e.d(I,{JF:()=>o,MC:()=>r,yC:()=>i});const n=["#D32D20","#1E72B8","#B240A2","#705DA0","#466803","#497A3C","#3D71AA","#B15415","#890F02","#6E6E6E","#0A437C","#6D1F62","#584477","#4C7A3F","#2F4F4F","#BF1B00","#7662B1","#8A2EB8","#517A00","#000000","#3F6833","#2F575E","#99440A","#AE561A","#0E4AB4","#58140C","#052B51","#511749","#3F2B5B"],a=["#FF7368","#459EE7","#E069CF","#9683C6","#6C8E29","#76AC68","#6AA4E2","#E7823D","#AF3528","#9B9B9B","#3069A2","#934588","#7E6A9D","#88C477","#557575","#E54126","#A694DD","#B054DE","#8FC426","#262626","#658E59","#557D84","#BF6A30","#FF9B53","#3470DA","#7E3A32","#2B5177","#773D6F","#655181"];function o(l=""){const m=f(l.toLowerCase());return Math.abs(m%n.length)}function r(l=""){const m=o(l);return i(m)}function i(l){return{color:n[l],borderColor:a[l]}}function f(l){let m=5381;for(let s=0;s<l.length;s++)m=(m<<5)+m+l.charCodeAt(s);return m}var d={getTagColorsFromName:r}},18976:(Q,I,e)=>{"use strict";e.d(I,{O:()=>a,f:()=>o});var n=e(32196);function a(r){switch(r){case"auto":return"bottom";case"auto-start":return"bottom-start";case"auto-end":return"bottom-end";default:return r??"bottom"}}function o(r,i,f,d,l){return{arrow:(0,n.css)({fill:i}),container:(0,n.css)({backgroundColor:i,borderRadius:r.shape.radius.default,border:`1px solid ${f}`,boxShadow:r.shadows.z2,color:d,fontSize:r.typography.bodySmall.fontSize,padding:r.spacing(l.topBottom,l.rightLeft),[r.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.3s"},zIndex:r.zIndex.tooltip,maxWidth:"400px",overflowWrap:"break-word","&[data-popper-interactive='false']":{pointerEvents:"none"}}),headerClose:(0,n.css)({color:r.colors.text.secondary,position:"absolute",right:r.spacing(1),top:r.spacing(1.5),backgroundColor:"transparent",border:0}),header:(0,n.css)({paddingTop:r.spacing(1),paddingBottom:r.spacing(2)}),body:(0,n.css)({paddingTop:r.spacing(1),paddingBottom:r.spacing(1)}),footer:(0,n.css)({paddingTop:r.spacing(2),paddingBottom:r.spacing(1)})}}},69731:(Q,I,e)=>{"use strict";e.d(I,{C:()=>a});var n=e(96540);function a(){const[o,r]=(0,n.useState)(0);return(0,n.useCallback)(()=>r(i=>i+1),[])}},29734:(Q,I,e)=>{"use strict";e.d(I,{K:()=>o,Pw:()=>n,RP:()=>r,tf:()=>a});var n=(i=>(i.onBlur="onBlur",i.onFocus="onFocus",i.onChange="onChange",i))(n||{});const a=(i,f)=>{const d=f.reduce((l,m)=>m.rule(i)?l:l.concat(m.errorMessage),[]);return d.length>0?d:null},o=(i,f)=>f&&f[i],r=(i,f)=>({rule:d=>!!d.match(i),errorMessage:f||"Value is not valid"})},18681:(Q,I,e)=>{"use strict";e.d(I,{Nz:()=>Ki,J3:()=>$r,Pl:()=>Ei});var n=e(1503),a=e(96540),o=e(71468),r=e(24180),i=e(24160),f=e(12131),d=e(14110),l=e(32264),m=e(66602),s=e(17425),h=e(67061),u=e(71678),b=e(17464),g=e(65191),P=e(99140);const c=a.forwardRef((dt,Pn)=>a.createElement("div",{id:"ngRoot",ref:Pn,dangerouslySetInnerHTML:{__html:"<grafana-app ng-cloak></grafana-app>"}}));c.displayName="AngularRoot";var y=e(95344),p=e(7376),v=e(81634),D=e(17172),E=e(19347),S=e(72574),T=e(10096),M=e(14792),A=e(74856),x=e(71500),C=e(6923);async function O(){if(l.$.angularSupportEnabled){const{AngularApp:dt}=await Promise.all([e.e(9362),e.e(7808),e.e(8888)]).then(e.bind(e,27808)),Pn=new dt;Pn.init(),Pn.bootstrap()}else(0,p.w)({load:(dt,Pn,gn)=>({destroy:()=>{},digest:()=>{},getScope:()=>({})})}),(0,v.j)({get:dt=>{switch(dt){case"backendSrv":return(0,y.l)("getLegacyAngularInjector","backendSrv","use getBackendSrv() in @grafana/runtime"),(0,D.AI)();case"contextSrv":return(0,y.l)("getLegacyAngularInjector","contextSrv"),T.contextSrv;case"dashboardSrv":return(0,y.l)("getLegacyAngularInjector","getDashboardSrv"),(0,M.UA)();case"datasourceSrv":return(0,y.l)("getLegacyAngularInjector","datasourceSrv","use getDataSourceSrv() in @grafana/runtime"),(0,E.l)();case"linkSrv":return(0,y.l)("getLegacyAngularInjector","linkSrv"),(0,C.mQ)();case"validationSrv":return(0,y.l)("getLegacyAngularInjector","validationSrv"),x.P;case"timeSrv":return(0,y.l)("getLegacyAngularInjector","timeSrv"),(0,A.jG)();case"templateSrv":return(0,y.l)("getLegacyAngularInjector","templateSrv","use getTemplateSrv() in @grafana/runtime"),(0,S.w)()}throw"Angular is disabled.  Unable to expose: "+dt}})}var R=e(32196),L=e(46942),N=e.n(L),F=e(40845),K=e(55852),B=e(76888),w=e(60619),U=e(33390),W=e(18828),V=e(85690),_=e(93225),H=e(14578),G=e(57514),j=e(69529),Y=e(8484),oe=e(65178),se=e(35822);const ne=0,ee=dt=>{const Pn=a.useRef(null),gn=a.useRef(null),Jn=a.useRef(dt.items);Jn.current=dt.items;const Zn=(0,se.useVirtual)({size:Jn.current.length,parentRef:gn}),{query:_n,search:Pa,currentRootActionId:Ca,activeIndex:za,options:xs}=(0,n.useKBar)(is=>({search:is.searchQuery,currentRootActionId:is.currentRootActionId,activeIndex:is.activeIndex}));a.useEffect(()=>{const is=fs=>{fs.key==="ArrowUp"||fs.ctrlKey&&fs.key==="p"?(fs.preventDefault(),_n.setActiveIndex(ys=>{let Ps=ys>ne?ys-1:ys;if(typeof Jn.current[Ps]=="string"){if(Ps===0)return ys;Ps-=1}return Ps})):fs.key==="ArrowDown"||fs.ctrlKey&&fs.key==="n"?(fs.preventDefault(),_n.setActiveIndex(ys=>{let Ps=ys<Jn.current.length-1?ys+1:ys;if(typeof Jn.current[Ps]=="string"){if(Ps===Jn.current.length-1)return ys;Ps+=1}return Ps})):fs.key==="Enter"&&(fs.preventDefault(),Pn.current?.click())};return window.addEventListener("keydown",is),()=>window.removeEventListener("keydown",is)},[_n]);const{scrollToIndex:ms}=Zn;a.useEffect(()=>{ms(za,{align:za<=1?"end":"auto"})},[za,ms]),a.useEffect(()=>{_n.setActiveIndex(typeof dt.items[ne]=="string"?ne+1:ne)},[Pa,Ca,dt.items,_n]);const ls=a.useCallback((is,fs)=>{if(typeof fs=="string")return;const ys=fs.url;fs.command?(fs.command.perform(fs),_n.toggle()):ys?is.ctrlKey||is.metaKey||is.shiftKey||_n.toggle():(_n.setSearch(""),_n.setCurrentRootAction(fs.id)),xs.callbacks?.onSelectAction?.(fs)},[_n,xs]),Ws=(0,oe.usePointerMovedSinceMount)();return a.createElement("div",{ref:gn,style:{maxHeight:dt.maxHeight||400,position:"relative",overflow:"auto"}},a.createElement("div",{role:"listbox",id:n.KBAR_LISTBOX,style:{height:`${Zn.totalSize}px`,width:"100%"}},Zn.virtualItems.map(is=>{const fs=Jn.current[is.index],{target:ys,url:Ps}=fs,Lr=typeof fs!="string"&&{onPointerMove:()=>Ws&&za!==is.index&&_n.setActiveIndex(is.index),onPointerDown:()=>_n.setActiveIndex(is.index),onClick:ti=>ls(ti,fs)},Gr=is.index===za,ei={id:(0,n.getListboxItemId)(is.index),role:"option","aria-selected":Gr,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${is.start}px)`},...Lr},Ji=a.cloneElement(dt.onRender({item:fs,active:Gr}),{ref:is.measureRef});return Ps?a.createElement("a",{key:is.index,href:typeof Ps=="function"?Ps(Pa):Ps,target:ys,ref:Gr?Pn:null,...ei},Ji):a.createElement("div",{key:is.index,ref:Gr?Pn:null,...ei},Ji)})))},Z=a.forwardRef(({action:dt,active:Pn,currentRootActionId:gn},Jn)=>{const Zn=a.useMemo(()=>{if(!gn)return dt.ancestors;const za=dt.ancestors.findIndex(xs=>xs.id===gn);return dt.ancestors.slice(za+1)},[dt.ancestors,gn]),_n=(0,F.of)(z);let Pa=dt.name;const Ca=za=>!!(za.command?.perform||za.url);return dt.children.length&&!Ca(dt)&&!Pa.endsWith("...")&&(Pa+="..."),a.createElement("div",{ref:Jn,className:(0,R.cx)(_n.row,Pn&&_n.activeRow)},a.createElement("div",{className:_n.actionContainer},dt.icon,a.createElement("div",{className:_n.textContainer},Zn.map(za=>a.createElement(a.Fragment,{key:za.id},!Ca(za)&&a.createElement(a.Fragment,null,a.createElement("span",{className:_n.breadcrumbAncestor},za.name),a.createElement("span",{className:_n.breadcrumbSeparator},"\u203A")))),a.createElement("span",null,Pa)),dt.subtitle&&a.createElement("span",{className:_n.subtitleText},dt.subtitle)))});Z.displayName="ResultItem";const z=dt=>({row:(0,R.css)({padding:dt.spacing(1,2),display:"flex",alightItems:"center",justifyContent:"space-between",cursor:"pointer",position:"relative",borderRadius:dt.shape.radius.default,margin:dt.spacing(0,1)}),activeRow:(0,R.css)({color:dt.colors.text.maxContrast,background:dt.colors.emphasize(dt.colors.background.primary,.03),"&:before":{display:"block",content:'" "',position:"absolute",left:0,top:0,bottom:0,width:dt.spacing(.5),borderRadius:dt.shape.radius.default,backgroundImage:dt.colors.gradients.brandVertical}}),actionContainer:(0,R.css)({display:"flex",gap:dt.spacing(1),alignItems:"baseline",fontSize:dt.typography.fontSize,width:"100%"}),textContainer:(0,R.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),breadcrumbAncestor:(0,R.css)({color:dt.colors.text.secondary}),breadcrumbSeparator:(0,R.css)({color:dt.colors.text.secondary,marginLeft:dt.spacing(1),marginRight:dt.spacing(1)}),subtitleText:(0,R.css)({...dt.typography.bodySmall,color:dt.colors.text.secondary,display:"block",flexBasis:"20%",flexGrow:1,flexShrink:0,maxWidth:"fit-content",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})});var q=e(76459),ie=e.n(q),de=e(16233),ue=e(62301),fe=e(24439);const Se=6,he=5,ce=4,me=3,pe=2,ye=1,Pe=100,Ie=5,Oe=ie()(We,200);async function Ne(){if(!de.TP.user.isSignedIn)return[];const dt=(await ue.A.getDashboardOpened()).slice(0,Ie),gn=(await(0,fe.getGrafanaSearcher)().search({kind:["dashboard"],limit:Ie,uid:dt})).view.toArray();return gn.sort((Zn,_n)=>{const Pa=dt.indexOf(Zn.uid),Ca=dt.indexOf(_n.uid);return Pa-Ca}),gn.map(Zn=>{const{url:_n,name:Pa}=Zn;return{id:`recent-dashboards${_n}`,name:`${Pa}`,section:(0,Y.t)("command-palette.section.recent-dashboards","Recent dashboards"),priority:Se,url:_n}})}async function We(dt){if(dt.length===0||!de.TP.user.isSignedIn&&!l.$.bootData.settings.anonymousEnabled)return[];const Pn=await(0,fe.getGrafanaSearcher)().search({kind:["dashboard","folder"],query:dt,limit:Pe});return Pn.view.map(Jn=>{const{url:Zn,name:_n,kind:Pa,location:Ca}=Jn;return{id:`go/${Pa}${Zn}`,name:`${_n}`,section:Pa==="dashboard"?(0,Y.t)("command-palette.section.dashboard-search-results","Dashboards"):(0,Y.t)("command-palette.section.folder-search-results","Folders"),priority:ye,url:Zn,subtitle:Pn.view.dataFrame.meta?.custom?.locationInfo[Ca]?.name}})}function Ae(dt,Pn){const[gn,Jn]=(0,a.useState)([]),[Zn,_n]=(0,a.useState)(!1),Pa=(0,a.useRef)(0);return(0,a.useEffect)(()=>{const Ca=Date.now();Pn&&dt.length>0?(_n(!0),Oe(dt).then(za=>{Ca>Pa.current&&(Jn(za),_n(!1),Pa.current=Ca)})):(Jn([]),_n(!1),Pa.current=Ca)},[Pn,dt]),{searchResults:gn,isFetchingSearchResults:Zn}}var Ue=e(31678),Me=e(28215),$e=e(28444),ke=e(28138),Ze=e(38645),ot=e(93522);const xt=dt=>{let Pn=dt.children||[];if(dt.id==="help"){const gn=()=>{ke.A.publish(new $e.S8({component:ot.N}))};dt.children=[...Pn,...(0,Ze.Dd)(),...re(),{id:"keyboard-shortcuts",text:(0,Y.t)("nav.help/keyboard-shortcuts","Keyboard shortcuts"),icon:"keyboard",onClick:gn}]}return dt},ct=(dt,Pn)=>{const gn={...dt},Jn=gn.onClick;return gn.onClick=()=>{(0,d.rR)("grafana_navigation_item_clicked",{path:gn.url??gn.id,menuIsDocked:Pn}),Jn?.()},gn.children&&(gn.children=gn.children.map(Zn=>ct(Zn,Pn))),gn},ft=(dt,Pn)=>!!dt.children?.some(gn=>gn===Pn?!0:ft(gn,Pn)),Le=(dt,Pn,gn)=>{const{id:Jn,parentItem:Zn}=Pn;if(gn==="/")return dt.find(_n=>_n.id===Me.Id);if(Pn.id!=="profile"){for(const _n of dt){const Pa=!!(_n.id&&_n.id===Jn),Ca=_n.text===Pn.text&&_n.url===Pn.url;if(Pa||Ca)return _n;if(_n.children){const za=Le(_n.children,Pn);if(za)return za}}if(Zn)return Le(dt,Zn)}};function re(){const{buildInfo:dt,licenseInfo:Pn}=l.$,gn=Pn.stateInfo?` (${Pn.stateInfo})`:"",Jn=[];return Jn.push({target:"_blank",id:"version",text:`${dt.edition}${gn}`,url:Pn.licenseUrl,icon:"external-link-alt"}),dt.hasUpdate&&Jn.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),Jn}var X=e(2769);function le(dt){return"navModel."+dt.id}function be(dt,Pn=[]){const gn=[];for(let Jn of dt){Jn.id==="help"&&(Jn=xt({...Jn}),delete Jn.url);const{url:Zn,target:_n,text:Pa,isCreateAction:Ca,children:za,onClick:xs,keywords:ms}=Jn,ls=!!za?.length;if(!(Zn||xs||ls))continue;let Ws=Zn;Zn&&(Jn.id==="connections-add-new-connection"||Jn.id==="standalone-plugin-page-/connections/add-new-connection")&&(Ws=Lr=>{const Gr=ms?.find(ei=>ei.toLowerCase().includes(Lr.toLowerCase()));return Gr?`${Zn}?search=${Gr}`:Zn});const is=Ca?(0,Y.t)("command-palette.section.actions","Actions"):(0,Y.t)("command-palette.section.pages","Pages"),fs=Ca?he:ce,ys=Pn.map(Lr=>Lr.text).join(" > "),Ps={id:le(Jn),name:Pa,section:is,url:Ws,target:_n,parent:Pn.length>0&&!Ca?le(Pn[Pn.length-1]):void 0,perform:xs,keywords:ms?.join(" "),priority:fs,subtitle:Ca?void 0:ys};if(gn.push(Ps),za?.length){const Lr=be(za,[...Pn,Jn]);gn.push(...Lr)}}return gn}const De=(dt,Pn)=>{const gn=[{id:"preferences/theme",name:(0,Y.t)("command-palette.action.change-theme","Change theme..."),keywords:"interface color dark light",section:(0,Y.t)("command-palette.section.preferences","Preferences"),priority:me},{id:"preferences/dark-theme",name:(0,Y.t)("command-palette.action.dark-theme","Dark"),keywords:"dark theme",perform:()=>(0,X.K)("dark"),parent:"preferences/theme",priority:me},{id:"preferences/light-theme",name:(0,Y.t)("command-palette.action.light-theme","Light"),keywords:"light theme",perform:()=>(0,X.K)("light"),parent:"preferences/theme",priority:me}],Jn=be(dt);return[...gn,...Pn,...Jn]};var Te=e(74135),we=e(3197);const Ke={};function Ve(){const{extensions:dt}=(0,we.vl)({extensionPointId:Te.S.CommandPalette,context:Ke,limitPerPlugin:3});return(0,a.useMemo)(()=>dt.map(Pn=>({section:Pn.category??"Extensions",priority:pe,id:Pn.id,name:Pn.title,target:Pn.path,perform:()=>Pn.onClick&&Pn.onClick()})),[dt])}function ht(dt){const[Pn,gn]=(0,a.useState)([]),[Jn,Zn]=(0,a.useState)([]),_n=Ve(),Pa=(0,Ue.useSelector)(Ca=>Ca.navBarTree);return(0,a.useEffect)(()=>{const Ca=De(Pa,_n);gn(Ca)},[Pa,_n]),(0,a.useEffect)(()=>{dt||Ne().then(Ca=>Zn(Ca)).catch(Ca=>{console.error("Error loading recent dashboard actions",Ca)})},[dt]),dt?Pn:[...Jn,...Pn]}var gt=e(53076);const bt={name:"none",priority:n.Priority.NORMAL};function St(dt,Pn){return Pn.priority-dt.priority}function Je(){const{search:dt,actions:Pn,rootActionId:gn}=(0,n.useKBar)(ms=>({search:ms.searchQuery,actions:ms.actions,rootActionId:ms.currentRootActionId})),Jn=a.useMemo(()=>Object.keys(Pn).reduce((ms,ls)=>{const Ws=Pn[ls];if(!Ws.parent&&!gn&&ms.push(Ws),Ws.id===gn)for(let is=0;is<Ws.children.length;is++)ms.push(Ws.children[is]);return ms},[]).sort(St),[Pn,gn]),Zn=a.useCallback(ms=>{let ls=[];for(let Ws=0;Ws<ms.length;Ws++)ls.push(ms[Ws]);return function Ws(is,fs=ls){for(let ys=0;ys<is.length;ys++)if(is[ys].children.length>0){let Ps=is[ys].children;for(let Lr=0;Lr<Ps.length;Lr++)fs.push(Ps[Lr]);Ws(is[ys].children,fs)}return fs}(ms)},[]),_n=!dt,Pa=a.useMemo(()=>_n?Jn:Zn(Jn),[Zn,Jn,_n]),Ca=rt(Pa,dt),za=a.useMemo(()=>{let ms={},ls=[],Ws=[];for(let fs=0;fs<Ca.length;fs++){const ys=Ca[fs],Ps=ys.action,Lr=ys.score||n.Priority.NORMAL,Gr={name:typeof Ps.section=="string"?Ps.section:Ps.section?.name||bt.name,priority:typeof Ps.section=="string"?Lr:Ps.section?.priority||0+Lr};ms[Gr.name]||(ms[Gr.name]=[],ls.push(Gr)),ms[Gr.name].push({priority:Ps.priority+Lr,action:Ps})}Ws=ls.sort(St).map(fs=>({name:fs.name,actions:ms[fs.name].sort(St).map(ys=>ys.action)}));let is=[];for(let fs=0;fs<Ws.length;fs++){let ys=Ws[fs];ys.name!==bt.name&&is.push(ys.name);for(let Ps=0;Ps<ys.actions.length;Ps++)is.push(ys.actions[Ps])}return is},[Ca]),xs=a.useMemo(()=>gn,[za]);return a.useMemo(()=>({results:za,rootActionId:xs}),[xs,za])}function rt(dt,Pn){const gn=_t(),Jn=a.useMemo(()=>({filtered:dt,search:Pn}),[dt,Pn]),{filtered:Zn,search:_n}=(0,oe.useThrottledValue)(Jn);return a.useMemo(()=>{if(_n.trim()==="")return Zn.map(za=>({score:0,action:za}));const Pa=Zn.map(({name:za,keywords:xs})=>`${za} ${xs??""}`.toLowerCase()),Ca=[];if(_n.length>Rt){const za=_n.toLowerCase();for(let xs=0;xs<Pa.length;xs++){const ls=Pa[xs].indexOf(za);if(ls>-1){const Ws=ls*-1,is=Zn[xs];Ca.push({score:Ws,action:is})}}}else{const za=gn.split(_n).length,xs=1/0,ms=za<5?4:0,[,ls,Ws]=gn.search(Pa,_n,ms,xs);if(ls&&Ws)for(let is=0;is<Ws.length;is++){const fs=Ws[is],ys=Ws.length-is,Ps=Zn[ls.idx[fs]];Ca.push({score:ys,action:Ps})}}return Ca},[Zn,_n,gn])}const Rt=25;function _t(){const dt=a.useRef();return dt.current||(dt.current=new gt.A({intraMode:0,intraIns:0})),dt.current}function nn(){const dt=(0,F.of)(en),{query:Pn,showing:gn,searchQuery:Jn}=(0,n.useKBar)(ms=>({showing:ms.visualState===n.VisualState.showing,searchQuery:ms.searchQuery})),Zn=ht(Jn);(0,n.useRegisterActions)(Zn,[Zn]);const{searchResults:_n,isFetchingSearchResults:Pa}=Ae(Jn,gn),Ca=(0,a.useRef)(null),{overlayProps:za}=(0,_.e)({isOpen:gn,onClose:()=>Pn.setVisualState(n.VisualState.animatingOut)},Ca),{dialogProps:xs}=(0,W.s)({},Ca);return(0,a.useEffect)(()=>{gn&&(0,d.rR)("command_palette_opened")},[gn]),Zn.length>0?a.createElement(n.KBarPortal,null,a.createElement(n.KBarPositioner,{className:dt.positioner},a.createElement(n.KBarAnimator,{className:dt.animator},a.createElement(V.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},a.createElement("div",{...za,...xs},a.createElement("div",{className:dt.searchContainer},a.createElement(H.I,{name:"search",size:"md"}),a.createElement(n.KBarSearch,{defaultPlaceholder:(0,Y.t)("command-palette.search-box.placeholder","Search or jump to..."),className:dt.search}),a.createElement("div",{className:dt.loadingBarContainer},Pa&&a.createElement(G.G,{width:500,delay:0}))),a.createElement("div",{className:dt.resultsContainer},a.createElement(Kt,{isFetchingSearchResults:Pa,searchResults:_n}))))))):null}const Kt=({isFetchingSearchResults:dt,searchResults:Pn})=>{const{results:gn,rootActionId:Jn}=Je(),Zn=(0,F.of)(en),_n=(0,Y.t)("command-palette.section.dashboard-search-results","Dashboards"),Pa=(0,Y.t)("command-palette.section.folder-search-results","Folders"),Ca=(0,a.useMemo)(()=>Pn.filter(ls=>ls.id.startsWith("go/dashboard")).map(ls=>new n.ActionImpl(ls,{store:{}})),[Pn]),za=(0,a.useMemo)(()=>Pn.filter(ls=>ls.id.startsWith("go/folder")).map(ls=>new n.ActionImpl(ls,{store:{}})),[Pn]),xs=(0,a.useMemo)(()=>{const ls=[...gn];return za.length>0&&(ls.push(Pa),ls.push(...za)),Ca.length>0&&(ls.push(_n),ls.push(...Ca)),ls},[gn,_n,Ca,Pa,za]);return!dt&&xs.length===0?a.createElement(j.p,{variant:"not-found",role:"alert",message:(0,Y.t)("command-palette.empty-state.message","No results found")}):a.createElement(ee,{items:xs,maxHeight:650,onRender:({item:ls,active:Ws})=>{const is=xs[0]===ls;return typeof ls=="string"?a.createElement("div",{className:(0,R.cx)(Zn.sectionHeader,is&&Zn.sectionHeaderFirst)},ls):a.createElement(Z,{action:ls,active:Ws,currentRootActionId:Jn})}})},en=dt=>({positioner:(0,R.css)({zIndex:dt.zIndex.portal,marginTop:"0px",paddingTop:"4px !important","&::before":{content:'""',position:"fixed",top:0,right:0,bottom:0,left:0,background:dt.components.overlay.background,backdropFilter:"blur(1px)"}}),animator:(0,R.css)({maxWidth:dt.breakpoints.values.md,width:"100%",background:dt.colors.background.primary,color:dt.colors.text.primary,borderRadius:dt.shape.radius.default,border:`1px solid ${dt.colors.border.weak}`,overflow:"hidden",boxShadow:dt.shadows.z3}),loadingBarContainer:(0,R.css)({position:"absolute",left:0,right:0,bottom:0}),searchContainer:(0,R.css)({alignItems:"center",background:dt.components.input.background,borderBottom:`1px solid ${dt.colors.border.weak}`,display:"flex",gap:dt.spacing(1),padding:dt.spacing(1,2),position:"relative"}),search:(0,R.css)({fontSize:dt.typography.fontSize,width:"100%",boxSizing:"border-box",outline:"none",border:"none",color:dt.components.input.text}),spinner:(0,R.css)({height:"22px"}),resultsContainer:(0,R.css)({paddingBottom:dt.spacing(1)}),sectionHeader:(0,R.css)({padding:dt.spacing(1.5,2,2,2),fontSize:dt.typography.bodySmall.fontSize,fontWeight:dt.typography.fontWeightMedium,color:dt.colors.text.secondary,borderTop:`1px solid ${dt.colors.border.weak}`,marginTop:dt.spacing(1)}),sectionHeaderFirst:(0,R.css)({paddingBottom:dt.spacing(1),borderTop:"none",marginTop:0})});var Qt=e(59875),An=e(86634),un=e(13544),fn=e(29158),Tt=e(40276),$t=e(78685),Yt=e(8887),Cn=e(94753),Tn=e(18759);const vn=({children:dt})=>{const Pn=(0,F.of)(Kn);return a.createElement(a.Fragment,null,dt,a.createElement("span",{className:Pn.highlight}))},Kn=dt=>({highlight:(0,R.css)({backgroundColor:dt.colors.success.main,borderRadius:dt.shape.radius.circle,width:"6px",height:"6px",display:"inline-block;",position:"absolute",top:"50%",transform:"translateY(-50%)"})});var Yn=e(50720);function nt({children:dt,isActive:Pn,onClick:gn,target:Jn,url:Zn}){const _n=(0,F.$j)(),Pa=yt(_n,Pn),Ca=!Jn&&Zn.startsWith("/")?Yn.N:"a",za=a.createElement("div",{className:Pa.linkContent},dt,Jn==="_blank"&&a.createElement(H.I,{"data-testid":"external-link-icon",name:"external-link-alt"}));return a.createElement(Ca,{"data-testid":un.Tp.components.NavMenu.item,className:(0,R.cx)(Pa.container,{[Pa.containerActive]:Pn}),href:Zn,target:Jn,onClick:gn,...Pn&&{"aria-current":"page"}},za)}nt.displayName="MegaMenuItemText";const yt=(dt,Pn)=>({container:(0,R.css)({alignItems:"center",color:Pn?dt.colors.text.primary:dt.colors.text.secondary,height:"100%",position:"relative",width:"100%","&:hover, &:focus-visible":{color:dt.colors.text.primary,textDecoration:"underline"},"&:focus-visible":{boxShadow:"none",outline:`2px solid ${dt.colors.primary.main}`,outlineOffset:"-2px",transition:"none"}}),containerActive:(0,R.css)({backgroundColor:dt.colors.background.secondary,borderTopRightRadius:dt.shape.radius.default,borderBottomRightRadius:dt.shape.radius.default,position:"relative","&::before":{backgroundImage:dt.colors.gradients.brandVertical,borderRadius:dt.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:dt.spacing(.5)}}),linkContent:(0,R.css)({alignItems:"center",display:"flex",gap:"0.5rem",height:"100%",width:"100%"})}),Vt=2;function je({link:dt,activeItem:Pn,level:gn=0,onClick:Jn}){const{chrome:Zn}=(0,B.Il)(),Pa=Zn.useState().megaMenuDocked,Ca=(0,r.zy)(),za=dt.highlightText?vn:a.Fragment,xs=ft(dt,Pn),ms=dt===Pn||gn===Vt&&xs,[ls,Ws]=(0,$t.A)(`grafana.navigation.expanded[${dt.text}]`,!!xs),is=gn<Vt&&!!(Dt(dt)||dt.emptyMessage),fs=(0,a.useRef)(null),ys=(0,F.of)(tt);if((0,a.useEffect)(()=>{xs&&Ws(!0)},[xs,Ca,Pa,Ws]),(0,a.useEffect)(()=>{ms&&fs.current&&Ot(fs.current)&&fs.current.scrollIntoView({block:"center"})},[ms]),!dt.url)return null;let Ps=null;return dt.icon?Ps=a.createElement(H.I,{className:ys.icon,name:(0,Yt.Uo)(dt.icon)??"link",size:"lg"}):dt.img&&(Ps=a.createElement(h.B,{width:3,justifyContent:"center"},a.createElement("img",{className:ys.img,src:dt.img,alt:""}))),a.createElement("li",{ref:fs,className:ys.listItem},a.createElement("div",{className:(0,R.cx)(ys.menuItem,{[ys.menuItemWithIcon]:!!(gn===0&&Ps)})},gn!==0&&a.createElement(Tn.T,{level:gn===Vt?gn-1:gn,spacing:3}),gn===Vt&&a.createElement("div",{className:ys.itemConnector}),a.createElement("div",{className:ys.collapseButtonWrapper},is&&a.createElement(fn.K,{"aria-label":`${ls?"Collapse":"Expand"} section ${dt.text}`,className:ys.collapseButton,onClick:()=>Ws(!ls),name:ls?"angle-down":"angle-right",size:"md",variant:"secondary"})),a.createElement("div",{className:ys.collapsibleSectionWrapper},a.createElement(nt,{isActive:ms,onClick:()=>{dt.onClick?.(),Jn?.()},target:dt.target,url:dt.url},a.createElement("div",{className:(0,R.cx)(ys.labelWrapper,{[ys.hasActiveChild]:xs,[ys.labelWrapperWithIcon]:!!(gn===0&&Ps)})},gn===0&&Ps&&a.createElement(za,null,Ps),a.createElement(Cn.E,{truncate:!0},dt.text))))),is&&ls&&a.createElement("ul",{className:ys.children},Dt(dt)?dt.children.filter(Lr=>!Lr.isCreateAction).map(Lr=>a.createElement(je,{key:`${dt.text}-${Lr.text}`,link:Lr,activeItem:Pn,onClick:Jn,level:gn+1})):a.createElement("div",{className:ys.emptyMessage,"aria-live":"polite"},dt.emptyMessage)))}const tt=dt=>({icon:(0,R.css)({width:dt.spacing(3)}),img:(0,R.css)({height:dt.spacing(2),width:dt.spacing(2)}),listItem:(0,R.css)({flex:1,maxWidth:"100%"}),menuItem:(0,R.css)({display:"flex",alignItems:"center",gap:dt.spacing(1),height:dt.spacing(4),paddingLeft:dt.spacing(.5),position:"relative"}),menuItemWithIcon:(0,R.css)({paddingLeft:dt.spacing(0)}),collapseButtonWrapper:(0,R.css)({display:"flex",justifyContent:"center",width:dt.spacing(3),flexShrink:0}),itemConnector:(0,R.css)({position:"relative",height:"100%",width:dt.spacing(1.5),"&::before":{borderLeft:`1px solid ${dt.colors.border.medium}`,content:'""',height:"100%",right:0,position:"absolute",transform:"translateX(50%)"}}),collapseButton:(0,R.css)({margin:0}),collapsibleSectionWrapper:(0,R.css)({alignItems:"center",display:"flex",flex:1,height:"100%",minWidth:0}),labelWrapper:(0,R.css)({display:"flex",alignItems:"center",gap:dt.spacing(2),minWidth:0,paddingLeft:dt.spacing(1)}),labelWrapperWithIcon:(0,R.css)({paddingLeft:dt.spacing(.5)}),hasActiveChild:(0,R.css)({color:dt.colors.text.primary}),children:(0,R.css)({display:"flex",listStyleType:"none",flexDirection:"column"}),emptyMessage:(0,R.css)({color:dt.colors.text.secondary,fontStyle:"italic",padding:dt.spacing(1,1.5,1,7)})});function Dt(dt){return!!(dt.children&&dt.children.length>0)}function Ot(dt){const Pn=dt.getBoundingClientRect();return Pn.bottom<0||Pn.top>=window.innerHeight}const Lt="300px",Gt=a.memo((0,a.forwardRef)(({onClose:dt,...Pn},gn)=>{const Jn=(0,Ue.useSelector)(ls=>ls.navBarTree),Zn=(0,F.of)(hn),_n=(0,r.zy)(),{chrome:Pa}=(0,B.Il)(),Ca=Pa.useState(),za=Jn.filter(ls=>ls.id!=="profile"&&ls.id!=="help").map(ls=>ct(ls,Ca.megaMenuDocked)),xs=Le(za,Ca.sectionNav.node,_n.pathname),ms=()=>{Pa.setMegaMenuDocked(!Ca.megaMenuDocked),Ca.megaMenuDocked&&Pa.setMegaMenuOpen(!1),setTimeout(()=>{document.getElementById(Ca.megaMenuDocked?"mega-menu-toggle":"dock-menu-button")?.focus()})};return a.createElement("div",{"data-testid":un.Tp.components.NavMenu.Menu,ref:gn,...Pn},a.createElement("div",{className:Zn.mobileHeader},a.createElement(H.I,{name:"bars",size:"xl"}),a.createElement(fn.K,{tooltip:(0,Y.t)("navigation.megamenu.close","Close menu"),name:"times",onClick:dt,size:"xl",variant:"secondary"})),a.createElement("nav",{className:Zn.content},a.createElement(Tt.E,{showScrollIndicators:!0,hideHorizontalTrack:!0},a.createElement("ul",{className:Zn.itemList,"aria-label":(0,Y.t)("navigation.megamenu.list-label","Navigation")},za.map((ls,Ws)=>a.createElement(h.B,{key:ls.text,direction:Ws===0?"row-reverse":"row",alignItems:"center"},Ws===0&&a.createElement(fn.K,{id:"dock-menu-button",className:Zn.dockMenuButton,tooltip:Ca.megaMenuDocked?(0,Y.t)("navigation.megamenu.undock","Undock menu"):(0,Y.t)("navigation.megamenu.dock","Dock menu"),name:"web-section-alt",onClick:ms,variant:"secondary"}),a.createElement(je,{link:ls,onClick:Ca.megaMenuDocked?void 0:dt,activeItem:xs})))))))}));Gt.displayName="MegaMenu";const hn=dt=>({content:(0,R.css)({display:"flex",flexDirection:"column",height:"100%",minHeight:0,position:"relative"}),mobileHeader:(0,R.css)({display:"flex",justifyContent:"space-between",padding:dt.spacing(1,1,1,2),borderBottom:`1px solid ${dt.colors.border.weak}`,[dt.breakpoints.up("md")]:{display:"none"}}),itemList:(0,R.css)({boxSizing:"border-box",display:"flex",flexDirection:"column",listStyleType:"none",padding:dt.spacing(1,1,2,1),[dt.breakpoints.up("md")]:{width:Lt}}),dockMenuButton:(0,R.css)({display:"none",[dt.breakpoints.up("xl")]:{display:"inline-flex"}})});var mt=e(13390),Bt=e(27746);function Jt({href:dt,isCurrent:Pn,text:gn,index:Jn,flexGrow:Zn}){const _n=(0,F.of)(Rn),Pa=()=>{(0,d.rR)("grafana_breadcrumb_clicked",{url:dt})};return a.createElement("li",{className:_n.breadcrumbWrapper,style:{flexGrow:Zn}},Pn?a.createElement("span",{"data-testid":mt.X.Breadcrumbs.breadcrumb(gn),className:_n.breadcrumb,"aria-current":"page",title:gn},gn):a.createElement(a.Fragment,null,a.createElement("a",{onClick:Pa,"data-testid":mt.X.Breadcrumbs.breadcrumb(gn),className:(0,R.cx)(_n.breadcrumb,_n.breadcrumbLink),title:gn,href:dt},gn),a.createElement("div",{className:_n.separator,"aria-hidden":!0},a.createElement(H.I,{name:"angle-right"}))))}const Rn=dt=>({breadcrumb:(0,R.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",padding:dt.spacing(0,.5),whiteSpace:"nowrap",color:dt.colors.text.secondary}),breadcrumbLink:(0,R.css)({color:dt.colors.text.primary,"&:hover":{textDecoration:"underline"}}),breadcrumbWrapper:(0,R.css)({alignItems:"center",color:dt.colors.text.primary,display:"flex",flex:1,minWidth:0,maxWidth:"max-content",[dt.breakpoints.down("sm")]:{display:"none","&:nth-last-child(2)":{display:"flex",minWidth:"40px"},"&:last-child":{display:"flex"}}}),separator:(0,R.css)({color:dt.colors.text.secondary})});function Mt({breadcrumbs:dt,className:Pn}){const gn=(0,F.of)(Ht);return a.createElement("nav",{"aria-label":"Breadcrumbs",className:Pn},a.createElement("ol",{className:gn.breadcrumbs},dt.map((Jn,Zn)=>a.createElement(Jt,{...Jn,isCurrent:Zn===dt.length-1,key:Zn,index:Zn,flexGrow:wt(Zn,dt.length)}))))}function wt(dt,Pn){return Pn<5&&dt>0&&dt<Pn-2||Pn>6&&dt>1&&dt<Pn-3?4:10}const Ht=dt=>({breadcrumbs:(0,R.css)({display:"flex",alignItems:"center",flexWrap:"nowrap",overflow:"hidden"})});var tn=e(3984),It=e(57571),Xe=e(10804);const jn="mega-menu-toggle";function Qn({actions:dt,searchBarHidden:Pn,sectionNav:gn,pageNav:Jn,onToggleMegaMenu:Zn,onToggleSearchBar:_n,onToggleKioskMode:Pa}){const{chrome:Ca}=(0,B.Il)(),za=Ca.useState(),xs=(0,Ue.useSelector)(Ws=>Ws.navIndex)[Me.Id],ms=(0,F.of)(ia),ls=(0,tn.Z)(gn,Jn,xs);return a.createElement("div",{"data-testid":mt.X.NavToolbar.container,className:ms.pageToolbar},a.createElement("div",{className:ms.menuButton},a.createElement(fn.K,{id:jn,name:"bars",tooltip:za.megaMenuOpen?(0,Y.t)("navigation.toolbar.close-menu","Close menu"):(0,Y.t)("navigation.toolbar.open-menu","Open menu"),tooltipPlacement:"bottom",size:"xl",onClick:Zn,"data-testid":mt.X.NavBar.Toggle.button})),a.createElement(Mt,{breadcrumbs:ls,className:ms.breadcrumbsWrapper}),a.createElement("div",{className:ms.actions},dt,Pn&&a.createElement(Bt.I,{onClick:Pa,narrow:!0,title:(0,Y.t)("navigation.toolbar.enable-kiosk","Enable kiosk mode"),icon:"monitor"}),dt&&a.createElement(Xe.K,null),a.createElement(Bt.I,{onClick:_n,narrow:!0,title:(0,Y.t)("navigation.toolbar.toggle-search-bar","Toggle top search bar")},a.createElement(H.I,{name:Pn?"angle-down":"angle-up",size:"xl"}))))}const ia=dt=>({breadcrumbsWrapper:(0,R.css)({display:"flex",overflow:"hidden",[dt.breakpoints.down("sm")]:{minWidth:"50%"}}),pageToolbar:(0,R.css)({height:It.l,display:"flex",padding:dt.spacing(0,1,0,2),alignItems:"center",borderBottom:`1px solid ${dt.colors.border.weak}`}),menuButton:(0,R.css)({display:"flex",alignItems:"center",marginRight:dt.spacing(1)}),actions:(0,R.css)({label:"NavToolbar-actions",display:"flex",alignItems:"center",flexWrap:"nowrap",justifyContent:"flex-end",paddingLeft:dt.spacing(1),flexGrow:1,gap:dt.spacing(1),minWidth:0,".body-drawer-open &":{display:"none"}})});function wn({}){const dt=(0,F.$j)(),{chrome:Pn}=(0,B.Il)(),gn=Pn.useState(),Jn=gn.searchBarHidden||gn.kioskMode===Ue.KioskMode.TV,Zn=(0,a.useRef)(null),_n=(0,a.useRef)(null),Pa=dt.transitions.duration.shortest,Ca=(0,F.of)(La,Pa),za=gn.megaMenuOpen&&!gn.megaMenuDocked,xs=()=>Pn.setMegaMenuOpen(!1),{overlayProps:ms,underlayProps:ls}=(0,_.e)({isDismissable:!0,isOpen:!0,onClose:xs,shouldCloseOnInteractOutside:fs=>!document.getElementById(jn)?.contains(fs)},Zn),{dialogProps:Ws}=(0,W.s)({},Zn),is=(0,F.of)(sa,Jn);return a.createElement("div",{className:is.wrapper},a.createElement(Qt.Sf,null,a.createElement(An.A,{nodeRef:Zn,in:za,unmountOnExit:!0,classNames:Ca.overlay,timeout:{enter:Pa,exit:0}},a.createElement(V.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},a.createElement(Gt,{className:is.menu,onClose:xs,ref:Zn,...ms,...Ws}))),a.createElement(An.A,{nodeRef:_n,in:za,unmountOnExit:!0,classNames:Ca.backdrop,timeout:{enter:Pa,exit:0}},a.createElement("div",{ref:_n,className:is.backdrop,...ls}))))}const sa=(dt,Pn)=>{const gn=Pn?It.l:It.l*2;return{backdrop:(0,R.css)({backdropFilter:"blur(1px)",backgroundColor:dt.components.overlay.background,bottom:0,left:0,position:"fixed",right:0,top:Pn?0:It.l,zIndex:dt.zIndex.modalBackdrop,[dt.breakpoints.up("md")]:{top:gn}}),menu:(0,R.css)({display:"flex",bottom:0,flexDirection:"column",left:0,right:0,zIndex:dt.zIndex.modal,position:"fixed",top:Pn?0:It.l,backgroundColor:dt.colors.background.primary,boxSizing:"content-box",flex:"1 1 0",[dt.breakpoints.up("md")]:{right:"unset",borderRight:`1px solid ${dt.colors.border.weak}`,top:gn}}),wrapper:(0,R.css)({position:"fixed",display:"grid",gridAutoFlow:"column",height:"100%",zIndex:dt.zIndex.sidemenu})}},La=(dt,Pn)=>{const gn={[dt.transitions.handleMotion("no-preference")]:{transitionDuration:`${Pn}ms`,transitionTimingFunction:dt.transitions.easing.easeInOut},[dt.breakpoints.down("md")]:{overflow:"hidden"}},Jn={...gn,transitionProperty:"box-shadow, width",".scrollbar-view":{overflow:"hidden !important"}},Zn={...gn,transitionProperty:"opacity"},_n={width:"100%",[dt.breakpoints.up("md")]:{boxShadow:dt.shadows.z3,width:Lt}},Pa={boxShadow:"none",width:0},Ca={opacity:1},za={opacity:0};return{backdrop:{enter:(0,R.css)(za),enterActive:(0,R.css)(Zn,Ca),enterDone:(0,R.css)(Ca)},overlay:{enter:(0,R.css)(Pa),enterActive:(0,R.css)(Jn,_n),enterDone:(0,R.css)(_n)}}};var xa=e(70944),ga=e(19727);const Ts=({label:dt,onClick:Pn,onDismiss:gn})=>{const Jn=(0,F.of)(Us);return a.createElement(ga.e,{className:Jn.buttonGroup},a.createElement(K.$n,{icon:"angle-left",size:"sm",variant:"primary",fill:"outline",onClick:Pn,title:dt,className:Jn.mainDismissableButton,"data-testid":un.Tp.components.ReturnToPrevious.backButton},dt),a.createElement(K.$n,{icon:"times","aria-label":(0,Y.t)("return-to-previous.dismissable-button","Close"),variant:"primary",fill:"outline",size:"sm",onClick:gn,"data-testid":un.Tp.components.ReturnToPrevious.dismissButton}))},Us=dt=>({mainDismissableButton:(0,R.css)({width:"100%","> span":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"270px",display:"inline-block"}}),buttonGroup:(0,R.css)({width:"fit-content",backgroundColor:dt.colors.background.secondary})});Ts.displayName="DismissableButton";const Bs=({href:dt,title:Pn})=>{const gn=(0,F.of)(ks),{chrome:Jn}=(0,B.Il)(),Zn=(0,a.useCallback)(()=>{f.Ny.push(dt),Jn.clearReturnToPrevious("clicked")},[dt,Jn]),_n=(0,a.useCallback)(()=>{Jn.clearReturnToPrevious("dismissed")},[Jn]);return a.createElement("div",{className:gn.returnToPrevious,"data-testid":un.Tp.components.ReturnToPrevious.buttonGroup},a.createElement(Ts,{label:(0,Y.t)("return-to-previous.button.label","Back to {{title}}",{title:Pn}),onClick:Zn,onDismiss:_n}))},ks=dt=>({returnToPrevious:(0,R.css)({label:"return-to-previous",display:"flex",justifyContent:"center",left:"50%",transform:"translateX(-50%)",zIndex:dt.zIndex.tooltip,position:"fixed",bottom:dt.spacing.x4,boxShadow:dt.shadows.z3})});Bs.displayName="ReturnToPrevious";var Ms=e(2543),Dr=e(40672),_s=e(71733),Ir=e(83122),Xs=e(2913),Gs=e(19361),Br=e(42941),Mr=e(87978),vr=e(62372),fr=e(49185),js=e(69386),to=e(4172);function Ar({feedUrl:dt}){const Pn=(0,F.of)(Ko),{state:gn,getNews:Jn}=(0,to.n)(dt),[Zn,_n]=(0,fr.A)();return(0,a.useEffect)(()=>{Jn()},[Jn]),gn.error?a.createElement("div",{className:Pn.innerWrapper},gn.error&&gn.error.message):a.createElement("div",{ref:Zn},gn.loading?a.createElement(a.Fragment,null,a.createElement(js.K.Skeleton,{showImage:!0,width:_n.width}),a.createElement(js.K.Skeleton,{showImage:!0,width:_n.width}),a.createElement(js.K.Skeleton,{showImage:!0,width:_n.width}),a.createElement(js.K.Skeleton,{showImage:!0,width:_n.width}),a.createElement(js.K.Skeleton,{showImage:!0,width:_n.width})):a.createElement(a.Fragment,null,_n.width>0&&gn.value?.map((Pa,Ca)=>a.createElement(js.K,{key:Ca,index:Ca,showImage:!0,width:_n.width,data:gn.value}))),a.createElement("div",{className:Pn.grot},a.createElement("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog"},a.createElement("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"}))))}const Ko=dt=>({innerWrapper:(0,R.css)({width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}),grot:(0,R.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:dt.spacing(5,0),img:{width:"186px",height:"186px"}})});function no({className:dt}){const[Pn,gn]=(0,Br.A)(!1),Jn=(0,F.of)(vo);return a.createElement(a.Fragment,null,a.createElement(Bt.I,{className:dt,onClick:gn,iconOnly:!0,icon:"rss","aria-label":"News"}),Pn&&a.createElement(Mr._,{title:a.createElement("div",{className:Jn.title},a.createElement(Cn.E,{element:"h2"},(0,Y.t)("news.title","Latest from the blog")),a.createElement("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog",className:Jn.grot},a.createElement("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"})),a.createElement("div",{className:Jn.actions},a.createElement(fn.K,{name:"times",variant:"secondary",onClick:gn,"data-testid":un.Tp.components.Drawer.General.close,tooltip:(0,Y.t)("news.drawer.close","Close Drawer")}))),onClose:gn,size:"md"},a.createElement(Ar,{feedUrl:vr.$})))}const vo=dt=>({title:(0,R.css)({display:"flex",alignItems:"center",justifyContent:"center",gap:dt.spacing(2),borderBottom:`1px solid ${dt.colors.border.weak}`}),grot:(0,R.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:dt.spacing(2,0),img:{width:"75px",height:"75px"}}),actions:(0,R.css)({position:"absolute",right:dt.spacing(1),top:dt.spacing(2)})});var ao=e(32931),Do=e(51986);function Xr({orgs:dt,onSelectChange:Pn}){const gn=(0,F.of)(mo);return a.createElement(Do.i,{"aria-label":"Change organization",variant:"secondary",buttonCss:gn.buttonCss,size:"md",label:"",fill:"text",isFullWidth:!1,options:dt.map(Jn=>({label:Jn.name,description:Jn.role,value:Jn})),onChange:Pn,icon:"building"})}const mo=dt=>({buttonCss:(0,R.css)({color:dt.colors.text.secondary,"&:hover":{color:dt.colors.text.primary}})});var qr=e(21594);function Po({orgs:dt,onSelectChange:Pn}){const gn=(0,F.of)(jr),{orgName:Jn,orgId:Zn,orgRole:_n}=de.TP.user,[Pa,Ca]=(0,a.useState)(()=>({label:Jn,value:{role:_n,orgId:Zn,name:Jn},description:_n})),za=xs=>{Ca(xs),Pn(xs)};return a.createElement(qr.l6,{"aria-label":"Change organization",width:"auto",value:Pa,prefix:a.createElement(H.I,{className:"prefix-icon",name:"building"}),className:gn.select,options:dt.map(xs=>({label:xs.name,description:xs.role,value:xs})),onChange:za})}const jr=dt=>({select:(0,R.css)({border:"none",background:"none",color:dt.colors.text.secondary,"&:hover":{color:dt.colors.text.primary,"& .prefix-icon":(0,R.css)({color:dt.colors.text.primary})}})});function Io(){const dt=(0,F.$j)(),Pn=(0,Ue.useDispatch)(),gn=(0,Ue.useSelector)(za=>za.organization.userOrgs),Jn=za=>{za.value&&((0,ao.bA)(za.value.orgId),f.Ny.push(`/?orgId=${za.value.orgId}`),window.location.reload())};(0,a.useEffect)(()=>{de.TP.isSignedIn&&Pn((0,ao.wV)())},[Pn]);const Zn=dt.breakpoints.values.sm,[_n,Pa]=(0,a.useState)(!window.matchMedia(`(min-width: ${Zn}px)`).matches);if((0,w.Y)({breakpoint:Zn,onChange:za=>{Pa(!za.matches)}}),gn?.length<=1)return null;const Ca=_n?Xr:Po;return a.createElement(Ca,{orgs:gn,onSelectChange:Jn})}var $o=e(38138);function qo(dt){const Pn=[];for(const gn of dt)gn.isCreateAction&&Pn.push(gn),gn.children&&Pn.push(...qo(gn.children));return Pn}const lo=({})=>{const dt=(0,F.of)(Vo),Pn=(0,F.$j)(),gn=(0,Ue.useSelector)(ms=>ms.navBarTree),Jn=Pn.breakpoints.values.sm,[Zn,_n]=(0,a.useState)(!1),[Pa,Ca]=(0,a.useState)(!window.matchMedia(`(min-width: ${Jn}px)`).matches),za=(0,a.useMemo)(()=>qo(gn),[gn]);(0,w.Y)({breakpoint:Jn,onChange:ms=>{Ca(!ms.matches)}});const xs=()=>a.createElement($o.W,null,za.map((ms,ls)=>a.createElement($o.W.Item,{key:ls,url:ms.url,label:ms.text,onClick:()=>(0,d.rR)("grafana_menu_item_clicked",{url:ms.url,from:"quickadd"})})));return za.length>0?a.createElement(a.Fragment,null,a.createElement(Ir.m,{overlay:xs,placement:"bottom-end",onVisibleChange:_n},a.createElement(Bt.I,{iconOnly:!0,icon:Pa?"plus-circle":"plus",isOpen:Pa?void 0:Zn,"aria-label":"New"})),a.createElement(Xe.K,{className:dt.separator})):null},Vo=dt=>({buttonContent:(0,R.css)({alignItems:"center",display:"flex"}),buttonText:(0,R.css)({[dt.breakpoints.down("md")]:{display:"none"}}),separator:(0,R.css)({[dt.breakpoints.down("sm")]:{display:"none"}})});function Co(){const dt=(0,r.zy)(),Pn=(0,F.of)(zo);let gn=Dr.sQ.sanitizeUrl(_s.I.getUrlForPartial(dt,{forceLogin:"true"}));return gn.startsWith("//")&&(gn=gn.replace(/\/+/g,"/")),a.createElement("a",{className:Pn.link,href:gn,target:"_self"},"Sign in")}const zo=dt=>({link:(0,R.css)({paddingRight:dt.spacing(1),whiteSpace:"nowrap","&:hover":{textDecoration:"underline"}})});var So=e(64539);function si({node:dt}){const Pn=(0,F.of)(Yo),gn=ct((0,Ms.cloneDeep)(dt),!1);return gn?a.createElement($o.W,{header:a.createElement("div",{onClick:Jn=>Jn.stopPropagation(),className:Pn.header},a.createElement("div",null,gn.text),gn.subTitle&&a.createElement("div",{className:Pn.subTitle},gn.subTitle))},gn.children?.map(Jn=>Jn.url?a.createElement(So.D,{url:Jn.url,label:Jn.text,icon:Jn.icon,target:Jn.target,key:Jn.id}):a.createElement(So.D,{icon:Jn.icon,onClick:Jn.onClick,label:Jn.text,key:Jn.id}))):null}const Yo=dt=>({header:(0,R.css)({fontSize:dt.typography.h5.fontSize,fontWeight:dt.typography.h5.fontWeight,padding:dt.spacing(.5,1),whiteSpace:"nowrap"}),subTitle:(0,R.css)({color:dt.colors.text.secondary,fontSize:dt.typography.bodySmall.fontSize})});var ri=e(10354),Ao=e(16797),so=e(63917);function ko(){const dt=(0,F.$j)(),{query:Pn}=(0,n.useKBar)(Pa=>({kbarSearchQuery:Pa.searchQuery,kbarIsOpen:Pa.visualState===n.VisualState.showing})),gn=dt.breakpoints.values.sm,[Jn,Zn]=(0,a.useState)(!window.matchMedia(`(min-width: ${gn}px)`).matches);(0,w.Y)({breakpoint:gn,onChange:Pa=>{Zn(!Pa.matches)}});const _n=()=>{Pn.toggle()};return Jn?a.createElement(Bt.I,{iconOnly:!0,icon:"search","aria-label":(0,Y.t)("nav.search.placeholderCommandPalette","Search or jump to..."),onClick:_n}):a.createElement(eo,{onClick:_n})}function eo({onClick:dt}){const Pn=(0,F.of)(No),gn=(0,a.useMemo)(()=>(0,so.gn)(),[]);return a.createElement("div",{className:Pn.wrapper},a.createElement("div",{className:Pn.inputWrapper},a.createElement("div",{className:Pn.prefix},a.createElement(H.I,{name:"search"})),a.createElement("button",{className:Pn.fakeInput,onClick:dt},(0,Y.t)("nav.search.placeholderCommandPalette","Search or jump to...")),a.createElement("div",{className:Pn.suffix},a.createElement(H.I,{name:"keyboard"}),a.createElement(Cn.E,{variant:"bodySmall"},gn,"+k"))))}const No=dt=>{const Pn=(0,ri.n)({theme:dt});return{wrapper:Pn.wrapper,inputWrapper:Pn.inputWrapper,prefix:Pn.prefix,suffix:(0,R.css)([Pn.suffix,{display:"flex",gap:dt.spacing(.5)}]),fakeInput:(0,R.css)([Pn.input,{textAlign:"left",paddingLeft:28,color:dt.colors.text.disabled,"&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,R.css)`
          ${(0,Ao.focusCss)(dt)}
        `}]),button:(0,R.css)({width:"100%",textAlign:"center","> *":{width:"100%",textAlign:"center",justifyContent:"center",gap:"1ch"}})}};function To({children:dt,align:Pn="left"}){const gn=(0,F.of)(oi),Zn=(0,F.$j)().breakpoints.values.sm,[_n,Pa]=(0,a.useState)(!window.matchMedia(`(min-width: ${Zn}px)`).matches);return(0,w.Y)({breakpoint:Zn,onChange:Ca=>{Pa(!Ca.matches)}}),_n?a.createElement(a.Fragment,null,dt):a.createElement("div",{"data-testid":"wrapper",className:(0,R.cx)(gn.wrapper,{[gn[Pn]]:Pn==="right"})},dt)}const oi=dt=>({wrapper:(0,R.css)({display:"flex",gap:dt.spacing(.5),alignItems:"center"}),right:(0,R.css)({justifyContent:"flex-end"}),left:(0,R.css)({}),center:(0,R.css)({})}),oo=a.memo(function(){const Pn=(0,F.of)(zt),gn=(0,Ue.useSelector)(za=>za.navIndex),Jn=(0,r.zy)(),Zn=(0,Ms.cloneDeep)(gn.help),_n=Zn?xt(Zn):void 0,Pa=gn.profile;let Ca=Xs.config.appSubUrl||"/";return!Xs.config.bootData.user.isSignedIn&&!Xs.config.anonymousEnabled&&(Ca=Dr.sQ.sanitizeUrl(_s.I.getUrlForPartial(Jn,{forceLogin:"true"}))),a.createElement("div",{className:Pn.layout},a.createElement(To,null,a.createElement("a",{className:Pn.logo,href:Ca,title:"Go to home"},a.createElement(Gs.M.MenuLogo,{className:Pn.img})),a.createElement(Io,null)),a.createElement(To,null,a.createElement(ko,null)),a.createElement(To,{align:"right"},a.createElement(lo,null),_n&&a.createElement(Ir.m,{overlay:()=>a.createElement(si,{node:_n}),placement:"bottom-end"},a.createElement(Bt.I,{iconOnly:!0,icon:"question-circle","aria-label":"Help"})),Xs.config.newsFeedEnabled&&a.createElement(no,null),!T.contextSrv.user.isSignedIn&&a.createElement(Co,null),Pa&&a.createElement(Ir.m,{overlay:()=>a.createElement(si,{node:Pa}),placement:"bottom-end"},a.createElement(Bt.I,{className:Pn.profileButton,imgSrc:T.contextSrv.user.gravatarUrl,imgAlt:"User avatar","aria-label":"Profile"}))))}),zt=dt=>({layout:(0,R.css)({height:It.l,display:"flex",gap:dt.spacing(1),alignItems:"center",padding:dt.spacing(0,1,0,2),borderBottom:`1px solid ${dt.colors.border.weak}`,justifyContent:"space-between",[dt.breakpoints.up("sm")]:{gridTemplateColumns:"1.5fr minmax(240px, 1fr) 1.5fr",display:"grid",justifyContent:"flex-start"}}),img:(0,R.css)({height:dt.spacing(3),width:dt.spacing(3)}),logo:(0,R.css)({display:"flex"}),profileButton:(0,R.css)({padding:dt.spacing(0,.25),img:{borderRadius:dt.shape.radius.circle,height:"24px",marginRight:0,width:"24px"}})});function rn({children:dt}){const{chrome:Pn}=(0,B.Il)(),gn=Pn.useState(),Jn=gn.searchBarHidden||gn.kioskMode===Ue.KioskMode.TV,Zn=(0,F.$j)(),_n=(0,F.of)(zn),Pa=Zn.breakpoints.values.xl,Ca=U.A.getBool(xa.hE,!0);(0,w.Y)({breakpoint:Pa,onChange:fs=>{Ca&&(Pn.setMegaMenuDocked(fs.matches,!1),Pn.setMegaMenuOpen(fs.matches?U.A.getBool(xa.k0,gn.megaMenuOpen):!1))}});const za=(0,R.cx)({[_n.content]:!0,[_n.contentNoSearchBar]:Jn,[_n.contentChromeless]:gn.chromeless}),xs=()=>{Pn.setMegaMenuOpen(!gn.megaMenuOpen)},{pathname:ms,search:ls}=f.Ny.getLocation(),Ws=ms+ls,is=gn.returnToPrevious&&Ws!==gn.returnToPrevious.href;return(0,a.useEffect)(()=>{gn.returnToPrevious&&Ws===gn.returnToPrevious.href&&Pn.clearReturnToPrevious("auto_dismissed")},[Pn,Ws]),(0,a.useEffect)(()=>{const fs=(0,f.SE)(ls);Pn.setKioskModeFromUrl(fs.kiosk)},[Pn,ls]),a.createElement("div",{className:N()("main-view",{"main-view--search-bar-hidden":Jn&&!gn.chromeless,"main-view--chrome-hidden":gn.chromeless})},!gn.chromeless&&a.createElement(a.Fragment,null,a.createElement(K.z9,{className:_n.skipLink,href:"#pageContent"},"Skip to main content"),a.createElement("header",{className:(0,R.cx)(_n.topNav)},!Jn&&a.createElement(oo,null),a.createElement(Qn,{searchBarHidden:Jn,sectionNav:gn.sectionNav.node,pageNav:gn.pageNav,actions:gn.actions,onToggleSearchBar:Pn.onToggleSearchBar,onToggleMegaMenu:xs,onToggleKioskMode:Pn.onToggleKioskMode}))),a.createElement("div",{className:za},a.createElement("div",{className:_n.panes},!gn.chromeless&&gn.megaMenuDocked&&gn.megaMenuOpen&&a.createElement(Gt,{className:_n.dockedMegaMenu,onClose:()=>Pn.setMegaMenuOpen(!1)}),a.createElement("main",{className:_n.pageContainer,id:"pageContent"},dt))),!gn.chromeless&&!gn.megaMenuDocked&&a.createElement(wn,null),!gn.chromeless&&a.createElement(nn,null),is&&gn.returnToPrevious&&a.createElement(Bs,{href:gn.returnToPrevious.href,title:gn.returnToPrevious.title}))}const zn=dt=>({content:(0,R.css)({display:"flex",flexDirection:"column",paddingTop:It.l*2,flexGrow:1,height:"100%"}),contentNoSearchBar:(0,R.css)({paddingTop:It.l}),contentChromeless:(0,R.css)({paddingTop:0}),dockedMegaMenu:(0,R.css)({background:dt.colors.background.primary,borderRight:`1px solid ${dt.colors.border.weak}`,display:"none",zIndex:dt.zIndex.navbarFixed,[dt.breakpoints.up("xl")]:{display:"block"}}),topNav:(0,R.css)({display:"flex",position:"fixed",zIndex:dt.zIndex.navbarFixed,left:0,right:0,background:dt.colors.background.primary,flexDirection:"column"}),panes:(0,R.css)({label:"page-panes",display:"flex",height:"100%",width:"100%",flexGrow:1,minHeight:0,flexDirection:"column",[dt.breakpoints.up("md")]:{flexDirection:"row"}}),pageContainer:(0,R.css)({label:"page-container",display:"flex",flexDirection:"column",flexGrow:1,minHeight:0,minWidth:0,overflow:"auto","@media print":{overflow:"visible"},"@page":{margin:0,size:"auto",padding:0}}),skipLink:(0,R.css)({position:"absolute",top:-1e3,":focus":{left:dt.spacing(1),top:dt.spacing(1),zIndex:dt.zIndex.portal}})});var Fn=e(26272),ta=e(82467),ua=e(16001),ya=e(3169),as=e(94701),Ga=e(42418);function _a({appNotification:dt,onClearNotification:Pn}){const gn=(0,F.of)(nr);(0,as.A)(()=>{setTimeout(()=>{Pn(dt.id)},Ue.timeoutMap[dt.severity])});const Jn=dt.component||dt.text||dt.traceId;return a.createElement(Ga.F,{severity:dt.severity,title:dt.title,onRemove:()=>Pn(dt.id),elevated:!0},Jn&&a.createElement("div",{className:gn.wrapper},a.createElement("span",null,dt.component||dt.text),dt.traceId&&a.createElement("span",{className:gn.trace},"Trace ID: ",dt.traceId)))}function nr(dt){return{wrapper:(0,R.css)({display:"flex",flexDirection:"column"}),trace:(0,R.css)({fontSize:dt.typography.pxToRem(10)})}}function ps(){const dt=(0,Ue.useSelector)(Zn=>(0,ua.fX)(Zn.appNotifications)),Pn=(0,Ue.useDispatch)(),gn=(0,F.of)(Qs);(0,a.useEffect)(()=>{ke.A.on(Fn.r1.alertWarning,Zn=>Pn((0,ta.dx)((0,ya.q8)(...Zn)))),ke.A.on(Fn.r1.alertSuccess,Zn=>Pn((0,ta.dx)((0,ya.tZ)(...Zn)))),ke.A.on(Fn.r1.alertError,Zn=>Pn((0,ta.dx)((0,ya.gi)(...Zn))))},[Pn]);const Jn=Zn=>{Pn((0,ta.Do)(Zn))};return a.createElement("div",{className:gn.wrapper},a.createElement(h.B,{direction:"column"},dt.map((Zn,_n)=>a.createElement(_a,{key:`${Zn.id}-${_n}`,appNotification:Zn,onClearNotification:Jn}))))}function Qs(dt){return{wrapper:(0,R.css)({label:"app-notifications-list",zIndex:dt.zIndex.portal,minWidth:400,maxWidth:600,position:"fixed",right:6,top:88})}}var Hr=e(96374);function _r(dt){const[Pn,gn]=(0,a.useState)({component:null,props:{}}),Jn=(0,a.useMemo)(()=>{function Zn(Pa,Ca){gn({component:Pa,props:Ca})}function _n(){gn({component:null,props:{}})}return{component:Pn.component,props:{...Pn.props,isOpen:!0,onDismiss:_n},showModal:Zn,hideModal:_n}},[Pn]);return(0,a.useEffect)(()=>{ke.A.subscribe($e.S8,({payload:_n})=>{gn({component:_n.component,props:_n.props})}),ke.A.subscribe($e.bY,_n=>{Rr(_n,gn)});let Zn="";f.Ny.getHistory().listen(_n=>{_n.pathname!==Zn&&gn({component:null,props:{}}),Zn=_n.pathname})},[]),a.createElement(u.wE.Provider,{value:Jn},dt.children)}function Rr({payload:dt},Pn){const{confirmText:gn,onConfirm:Jn=()=>{},onDismiss:Zn,text2:_n,altActionText:Pa,onAltAction:Ca,noText:za,text:xs,text2htmlBind:ms,yesText:ls="Yes",icon:Ws,title:is="Confirm",yesButtonVariant:fs}=dt,ys=()=>Pn({component:null,props:{}}),Ps={confirmText:ls,confirmButtonVariant:fs,confirmationText:gn,icon:Ws,title:is,body:xs,description:_n&&ms?Dr.sQ.sanitize(_n):_n,isOpen:!0,dismissText:za,onConfirm:()=>{Jn(),ys()},onDismiss:()=>{Zn?.(),ys()},onAlternative:Ca?()=>{Ca(),ys()}:void 0,alternativeText:Pa};Pn({component:Hr.u,props:Ps})}var Eo=e(66899),co=e.n(Eo),Ur=e(64388),At=e(52446),an=e(67608);function cn({error:dt,errorInfo:Pn}){const gn=(0,r.zy)(),Jn=dt?.name==="ChunkLoadError",Zn=(0,F.of)(On);return(0,a.useEffect)(()=>{Jn&&gn.search.indexOf("chunkNotFound")===-1&&(window.location.href=_s.I.getUrlForPartial(gn,{chunkNotFound:!0}))},[gn,Jn]),a.createElement(an.Y,{navId:"error",layout:Ur.k.Canvas},a.createElement("div",{className:Zn.container},Jn&&a.createElement("div",null,a.createElement("h2",null,"Unable to find application file"),a.createElement("br",null),a.createElement("h2",{className:"page-heading"},"Grafana has likely been updated. Please try reloading the page."),a.createElement("br",null),a.createElement(K.$n,{size:"md",variant:"secondary",icon:"repeat",onClick:()=>window.location.reload()},"Reload"),a.createElement(At.D,{title:"Error details",error:dt,errorInfo:Pn})),!Jn&&a.createElement(At.D,{title:"An unexpected error happened",error:dt,errorInfo:Pn})))}const On=dt=>({container:(0,R.css)({width:"500px",margin:dt.spacing(8,"auto")})});function ha(){const dt=(0,F.of)(Rs);return a.createElement("div",{className:dt.container,"aria-live":"polite",role:"status","aria-label":(0,Y.t)("bouncing-loader.label","Loading")},a.createElement("div",{className:dt.bounce},a.createElement("img",{alt:"",src:"public/img/grafana_icon.svg",className:dt.logo})))}const la=(0,R.keyframes)({"0%":{opacity:0,animationTimingFunction:"cubic-bezier(0, 0, 0.5, 1)"},"100%":{opacity:1}}),Ns=(0,R.keyframes)({"0%":{opacity:0},"50%":{opacity:1},"100%":{opacity:0}}),Ds=(0,R.keyframes)({"from, to":{transform:"translateY(0px)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"50%":{transform:"translateY(-50px)",animationTimingFunction:"cubic-bezier(0.9, 0, 0.7, 1)"}}),Js=(0,R.keyframes)({"0%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"15%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 0.75)"},"55%":{transform:"scaleX(1.05) scaleY(0.95)",animationTimingFunction:"cubic-bezier(0.9, 0, 1, 1)"},"95%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0, 1)"},"100%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 1)"}}),Rs=dt=>({container:(0,R.css)({opacity:0,[dt.transitions.handleMotion("no-preference")]:{animationName:la,animationIterationCount:1,animationDuration:"0.9s",animationDelay:"0.5s",animationFillMode:"forwards"},[dt.transitions.handleMotion("reduce")]:{animationName:Ns,animationIterationCount:"infinite",animationDuration:"4s",animationDelay:"0.5s"}}),bounce:(0,R.css)({textAlign:"center",[dt.transitions.handleMotion("no-preference")]:{animationName:Ds,animationDuration:"0.9s",animationIterationCount:"infinite"}}),logo:(0,R.css)({display:"inline-block",[dt.transitions.handleMotion("no-preference")]:{animationName:Js,animationDuration:"0.9s",animationIterationCount:"infinite"},width:"60px",height:"60px"})});function Er(){const dt=(0,F.of)(Vs);return a.createElement("div",{className:dt.loadingPage},a.createElement(ha,null))}const Vs=dt=>({loadingPage:(0,R.css)({backgroundColor:dt.colors.background.primary,height:"100%",flexDrection:"column",display:"flex",justifyContent:"center",alignItems:"center"})});function hs(dt){const{chrome:Pn,keybindings:gn}=(0,B.Il)();return Pn.setMatchedRoute(dt.route),(0,a.useLayoutEffect)(()=>{gn.clearAndInitGlobalBindings(dt.route)},[gn,dt.route]),(0,a.useEffect)(()=>(ro(dt.route),yo(),(0,f.Lc)("GrafanaRoute",!1,"Mounted",dt.match),()=>{(0,f.Lc)("GrafanaRoute",!1,"Unmounted",dt.route),ro(dt.route,!0)}),[]),(0,a.useEffect)(()=>{yo(),(0,d.Jy)(),(0,f.Lc)("GrafanaRoute",!1,"Updated",dt)}),(0,f.Lc)("GrafanaRoute",!1,"Rendered",dt.route),a.createElement(m.tH,null,({error:Jn,errorInfo:Zn})=>Jn?a.createElement(cn,{error:Jn,errorInfo:Zn}):a.createElement(a.Suspense,{fallback:a.createElement(Er,null)},a.createElement(dt.route.component,{...dt,queryParams:(0,f.SE)(dt.location.search)})))}function Pr(dt){return dt.pageClass?dt.pageClass.split(" "):[]}function ro(dt,Pn=!1){for(const gn of Pr(dt))Pn?document.body.classList.remove(gn):document.body.classList.add(gn)}function yo(){document.body.classList.remove("sidemenu-open--xs");const dt=document.getElementById("tooltip");dt?.parentElement?.removeChild(dt);const Pn=document.querySelectorAll(".tooltip");for(let gn=0;gn<Pn.length;gn++){const Jn=Pn[gn];Jn.parentElement?.removeChild(Jn)}for(const gn of co().drops)gn.destroy()}var Kr=e(96378),io=e(62625),Ro=e(78731),Qr=e(3911);class uo extends a.PureComponent{constructor(){super(...arguments),this.styles=Mo(l.$.theme2),this.state={},this.initListener=()=>{const Pn=(0,Ro.oF)();Pn&&(this.subscription=Pn.getConnectionState().subscribe({next:gn=>{this.setState({show:!gn})}}))}}componentDidMount(){}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}render(){const{show:Pn}=this.state;return Pn?!de.TP.isSignedIn||!l.$.liveEnabled||de.TP.user.orgRole===io.X.None?null:a.createElement("div",{className:this.styles.foot},a.createElement(Ga.F,{severity:"warning",className:this.styles.warn,title:"connection to server is lost..."})):null}}const Mo=(0,Qr.N)(dt=>({foot:(0,R.css)`
      position: absolute;
      bottom: 0px;
      left: 0px;
      right: 0px;
      z-index: 10000;
      cursor: wait;
      margin: 16px;
    `,warn:(0,R.css)`
      max-width: 400px;
      margin: auto;
    `}));let Jo=[],Lo=[];function $r(dt){Jo.push(dt)}function Ei(dt){Lo.push(dt)}class Ki extends a.Component{constructor(Pn){super(Pn),this.renderRoute=gn=>{const Jn=gn.roles?gn.roles():[];return a.createElement(i.CompatRoute,{exact:gn.exact===void 0?!0:gn.exact,sensitive:gn.sensitive===void 0?!1:gn.sensitive,path:gn.path,key:gn.path,render:Zn=>Jn?.length&&!Jn.some(_n=>de.TP.hasRole(_n))?a.createElement(r.rd,{to:"/"}):a.createElement(hs,{...Zn,route:gn})})},this.state={}}async componentDidMount(){await O(),this.setState({ready:!0}),$(".preloader").remove()}renderRoutes(){return a.createElement(r.dO,null,(0,g.kz)().map(Pn=>this.renderRoute(Pn)))}render(){const{app:Pn}=this.props,{ready:gn}=this.state;(0,f.Lc)("AppWrapper",!1,"rendering");const Jn=Zn=>{(0,d.rR)("command_palette_action_selected",{actionId:Zn.id,actionName:Zn.name})};return a.createElement(o.Provider,{store:P.M_},a.createElement(m.Xw,{style:"page"},a.createElement(B.YE.Provider,{value:Pn.context},a.createElement(Kr.N,{value:l.$.theme2},a.createElement(n.KBarProvider,{actions:[],options:{enableHistory:!0,callbacks:{onSelectAction:Jn}}},a.createElement(r.Ix,{history:f.Ny.getHistory()},a.createElement(i.CompatRouter,null,a.createElement(_r,null,a.createElement(s.k,null),a.createElement("div",{className:"grafana-app"},a.createElement(rn,null,a.createElement(c,null),a.createElement(ps,null),a.createElement(h.B,{gap:0,grow:1,direction:"column"},Lo.map((Zn,_n)=>a.createElement(Zn,{key:_n.toString()})),gn&&this.renderRoutes()),Jo.map((Zn,_n)=>a.createElement(Zn,{key:_n.toString()})))),a.createElement(uo,null),a.createElement(u.EO,null),a.createElement(b.qB,null)))))))))}}},91950:(Q,I,e)=>{"use strict";e.d(I,{A:()=>o,f:()=>i});var n=e(2543),a=e.n(n);class o{constructor(d){if(this.columns=[],this.columnMap={},this.rows=[],this.type="table",d){if(d.columns)for(const l of d.columns)this.addColumn(l);if(d.rows)for(const l of d.rows)this.addRow(l)}}sort(d){d.col===null||d.col===void 0||this.columns.length<=d.col||(this.rows.sort((l,m)=>(l=l[d.col],m=m[d.col],+(l==null)-+(m==null)||+(l>m)||-(l<m))),d.desc&&this.rows.reverse(),this.columns[d.col].sort=!0,this.columns[d.col].desc=d.desc)}addColumn(d){this.columnMap[d.text]||(this.columns.push(d),this.columnMap[d.text]=d)}addRow(d){this.rows.push(d)}}function r(f,d,l){let m=!1;for(let s=0;s<f.length;s++)if(d[s]!==void 0&&l[s]!==void 0){if(d[s]!==l[s])return!1}else(d[s]===void 0||l[s]===void 0)&&(m=!0);return m}function i(f,...d){const l=f||new o;if(arguments.length===1)return l;if(arguments.length===2)return l.columns=d[0].hasOwnProperty("columns")?[...d[0].columns]:[],l.rows=d[0].hasOwnProperty("rows")?[...d[0].rows]:[],l;const m=d.filter(c=>!!c.columns),s={},h=m.slice().reduce((c,y)=>(y.columns.forEach(p=>{const{text:v}=p;s[v]===void 0&&(s[v]=c.length,c.push(p))}),c),[]),u=m.map(c=>c.columns.map(y=>s[y.text])),b=m.reduce((c,y,p)=>{const v=u[p];return y.rows.forEach(D=>{const E=[];v.forEach((S,T)=>{E[S]=D[T]}),c.push(E)}),c},[]),g={},P=b.reduce((c,y,p)=>{if(!g[p]){let v=p+1;for(;v<b.length;){const D=(0,n.findIndex)(b,E=>r(h,y,E),v);if(D>-1){const E=b[D];for(let S=0;S<h.length;S++)y[S]===void 0&&E[S]!==void 0&&(y[S]=E[S]);g[D]=E,v=D+1}else break}c.push(y)}return c},[]);return l.columns=h,l.rows=P,l}},97007:(Q,I,e)=>{"use strict";e.d(I,{N:()=>a});var n=e(65307);const a=(0,n.VP)("core/cleanUpState")},82467:(Q,I,e)=>{"use strict";e.d(I,{Do:()=>n.Do,Vz:()=>a.Vz,YA:()=>a.YA,dx:()=>n.dx});var n=e(16001),a=e(28215)},28138:(Q,I,e)=>{"use strict";e.d(I,{A:()=>o,l:()=>a});var n=e(18226);const a=new n.o,o=a},52487:(Q,I,e)=>{"use strict";e.d(I,{x:()=>B});var n=e(32196),a=e(2543),o=e(96540),r=e(40845),i=e(68402),f=e(90613),d=e(94753),l=e(55852),m=e(9025),s=e(8484),h=e(27677),u=e(43907),b=e(67061),g=e(21594),P=e(25469),c=e(17172);class y extends o.Component{constructor(Y){super(Y),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,a.debounce)(this.search,300,{leading:!0,trailing:!0})}search(Y){return this.setState({isLoading:!0}),(0,a.isNil)(Y)&&(Y=""),(0,c.AI)().get("/api/serviceaccounts/search").then(oe=>oe.serviceAccounts.map(se=>({id:se.id,value:se.id,label:se.login,imgUrl:se.avatarUrl,login:se.login}))).finally(()=>{this.setState({isLoading:!1})})}render(){const{className:Y,onSelected:oe,inputId:se}=this.props,{isLoading:ne}=this.state;return o.createElement("div",{className:"service-account-picker","data-testid":"serviceAccountPicker"},o.createElement(g.DW,{isClearable:!0,className:Y,inputId:se,isLoading:ne,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:oe,placeholder:"Start typing to search for service accounts",noOptionsMessage:"No service accounts found","aria-label":"Service Account picker"}))}}var p=e(98742);class v extends o.Component{constructor(Y){super(Y),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,a.debounce)(this.search,300,{leading:!0,trailing:!0})}search(Y){return this.setState({isLoading:!0}),(0,a.isNil)(Y)&&(Y=""),(0,c.AI)().get(`/api/org/users/lookup?query=${Y}&limit=100`).then(oe=>oe.map(se=>({id:se.userId,value:se.userId,label:se.login,imgUrl:se.avatarUrl,login:se.login}))).finally(()=>{this.setState({isLoading:!1})})}render(){const{className:Y,onSelected:oe,inputId:se}=this.props,{isLoading:ne}=this.state;return o.createElement("div",{className:"user-picker","data-testid":"userPicker"},o.createElement(g.DW,{isClearable:!0,className:Y,inputId:se,isLoading:ne,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:oe,placeholder:"Start typing to search for user",noOptionsMessage:"No users found","aria-label":"User picker"}))}}var D=e(24897),E=(j=>(j.None="None",j.Team="Team",j.User="User",j.ServiceAccount="ServiceAccount",j.BuiltInRole="builtInRole",j))(E||{});const S=({title:j=(0,s.t)("access-control.add-permission.title","Add permission for"),permissions:Y,assignments:oe,onAdd:se,onCancel:ne})=>{const[ee,Z]=(0,o.useState)(E.None),[z,q]=(0,o.useState)(0),[ie,de]=(0,o.useState)(0),[ue,fe]=(0,o.useState)(""),[Se,he]=(0,o.useState)(""),ce=(0,o.useMemo)(()=>{const pe=[];return oe.users&&pe.push({value:E.User,label:(0,s.t)("access-control.add-permission.user-label","User")}),oe.serviceAccounts&&pe.push({value:E.ServiceAccount,label:(0,s.t)("access-control.add-permission.serviceaccount-label","Service Account")}),oe.teams&&pe.push({value:E.Team,label:(0,s.t)("access-control.add-permission.team-label","Team")}),oe.builtInRoles&&pe.push({value:E.BuiltInRole,label:(0,s.t)("access-control.add-permission.role-label","Role")}),pe},[oe]);(0,o.useEffect)(()=>{Y.length>0&&he(Y[0])},[Y]);const me=()=>ee===E.Team&&z>0||ee===E.User&&ie>0||ee===E.ServiceAccount&&ie>0||E.BuiltInRole&&D.XT.hasOwnProperty(ue);return o.createElement("div",{className:"cta-form","aria-label":"Permissions slider"},o.createElement(P.J,{onClick:ne}),o.createElement("h5",null,j),o.createElement("form",{name:"addPermission",onSubmit:pe=>{pe.preventDefault(),se({userId:ie,teamId:z,builtInRole:ue,permission:Se,target:ee})}},o.createElement(b.B,{gap:1,direction:"row"},o.createElement(g.l6,{"aria-label":"Role to add new permission to",value:ee,options:ce,onChange:pe=>Z(pe.value),disabled:ce.length===0,width:"auto"}),ee===E.User&&o.createElement(v,{onSelected:pe=>de(pe?.value||0)}),ee===E.ServiceAccount&&o.createElement(y,{onSelected:pe=>de(pe?.value||0)}),ee===E.Team&&o.createElement(p.e,{onSelected:pe=>q(pe.value?.id||0)}),ee===E.BuiltInRole&&o.createElement(g.l6,{"aria-label":"Built-in role picker",options:Object.values(D.XT).filter(pe=>pe!==D.XT.None).map(pe=>({value:pe,label:pe})),onChange:pe=>fe(pe.value||""),width:"auto"}),o.createElement(g.l6,{"aria-label":"Permission Level",width:"auto",value:Y.find(pe=>pe===Se),options:Y.map(pe=>({label:pe,value:pe})),onChange:pe=>he(pe.value||"")}),o.createElement(l.$n,{type:"submit",disabled:!me()},o.createElement(s.x6,{i18nKey:"access-control.add-permissions.save"},"Save")))))};var T=e(56034),M=e(14578);const A=({item:j,permissionLevels:Y,canSet:oe,onRemove:se,onChange:ne})=>{const ee=(0,r.of)(L);return o.createElement("tr",null,o.createElement("td",null,x(j)),o.createElement("td",null,O(j)),o.createElement("td",null,j.isInherited&&o.createElement("em",{className:"muted no-wrap"},"Inherited from folder")),o.createElement("td",null,o.createElement(g.l6,{disabled:!oe||!j.isManaged,onChange:Z=>ne(j,Z.value),value:Y.find(Z=>Z===j.permission),options:Y.map(Z=>({value:Z,label:Z}))})),o.createElement("td",null,j.warning?o.createElement(T.m,{content:o.createElement(o.Fragment,null,o.createElement(f.a,{marginBottom:1},j.warning),R(j))},o.createElement(M.I,{name:"exclamation-triangle",className:ee.warning})):o.createElement(T.m,{content:R(j)},o.createElement(M.I,{name:"info-circle"}))),o.createElement("td",null,j.isManaged?o.createElement(l.$n,{size:"sm",icon:"times",variant:"destructive",disabled:!oe,onClick:()=>se(j),"aria-label":`Remove permission for ${C(j)}`}):o.createElement(T.m,{content:j.isInherited?"Inherited Permission":"Provisioned Permission"},o.createElement(l.$n,{size:"sm",icon:"lock"}))))},x=j=>j.teamId?o.createElement("img",{className:"filter-table__avatar",src:j.teamAvatarUrl,alt:`Avatar for team ${j.teamId}`}):j.userId?o.createElement("img",{className:"filter-table__avatar",src:j.userAvatarUrl,alt:`Avatar for user ${j.userId}`}):o.createElement(M.I,{size:"xl",name:"shield"}),C=j=>j.userId?j.userLogin:j.teamId?j.team:j.builtInRole,O=j=>j.userId?o.createElement("span",{key:"name"},j.userLogin," "):j.teamId?o.createElement("span",{key:"name"},j.team," "):j.builtInRole?o.createElement("span",{key:"name"},j.builtInRole," "):o.createElement("span",{key:"name"}),R=j=>`Actions: ${[...new Set(j.actions)].sort().join(" ")}`,L=j=>({warning:(0,n.css)({color:j.colors.warning.main})}),N=({title:j,items:Y,compareKey:oe,permissionLevels:se,canSet:ne,onRemove:ee,onChange:Z})=>{const z=(0,o.useMemo)(()=>{const q={};for(let ie of Y){const de=ie[oe];if(!q[de]){q[de]=ie;continue}if(ie.actions.length>q[de].actions.length){q[de]=ie;continue}ie.actions.length===q[de].actions.length&&!ie.isInherited&&(q[de]=ie)}return Object.keys(q).map(ie=>q[ie])},[Y,oe]);return z.length===0?null:o.createElement("div",null,o.createElement("table",{className:"filter-table gf-form-group"},o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",{style:{width:"1%"}}),o.createElement("th",null,j),o.createElement("th",{style:{width:"1%"}}),o.createElement("th",{style:{width:"40%"}},o.createElement(s.x6,{i18nKey:"access-control.permission-list.permission"},"Permission")),o.createElement("th",{style:{width:"1%"}}),o.createElement("th",{style:{width:"1%"}}))),o.createElement("tbody",null,z.map((q,ie)=>o.createElement(A,{item:q,onRemove:ee,onChange:Z,canSet:ne,key:`${ie}-${q.userId}`,permissionLevels:se})))))},F="",K={permissions:[],assignments:{teams:!1,users:!1,serviceAccounts:!1,builtInRoles:!1}},B=({title:j=(0,s.t)("access-control.permissions.title","Permissions"),buttonLabel:Y=(0,s.t)("access-control.permissions.add-label","Add a permission"),emptyLabel:oe=(0,s.t)("access-control.permissions.no-permissions","There are no permissions"),resource:se,resourceId:ne,canSetPermissions:ee,addPermissionTitle:Z,getWarnings:z,epilogue:q})=>{const ie=(0,r.of)(G),[de,ue]=(0,o.useState)(!1),[fe,Se]=(0,o.useState)([]),[he,ce]=(0,o.useState)(K),me=(0,o.useCallback)(async()=>{let ke=await U(se,ne);z&&(ke=z(ke)),Se(ke)},[se,ne,z]);(0,o.useEffect)(()=>{w(se).then(ke=>(ce(ke),me()))},[se,ne,me]);const pe=ke=>{let Ze=null;ke.target===E.User||ke.target===E.ServiceAccount?Ze=W(se,ne,ke.userId,ke.permission):ke.target===E.Team?Ze=V(se,ne,ke.teamId,ke.permission):ke.target===E.BuiltInRole&&(Ze=_(se,ne,ke.builtInRole,ke.permission)),Ze!==null&&Ze.then(me)},ye=ke=>{let Ze=null;ke.userId?Ze=W(se,ne,ke.userId,F):ke.teamId?Ze=V(se,ne,ke.teamId,F):ke.isServiceAccount&&ke.userId?Ze=W(se,ne,ke.userId,F):ke.builtInRole&&(Ze=_(se,ne,ke.builtInRole,F)),Ze!==null&&Ze.then(me)},Pe=(ke,Ze)=>{ke.permission!==Ze&&(ke.userId?pe({permission:Ze,userId:ke.userId,target:E.User}):ke.isServiceAccount?pe({permission:Ze,userId:ke.userId,target:E.User}):ke.teamId?pe({permission:Ze,teamId:ke.teamId,target:E.Team}):ke.builtInRole&&pe({permission:Ze,builtInRole:ke.builtInRole,target:E.BuiltInRole}))},Ie=(0,o.useMemo)(()=>(0,a.sortBy)(fe.filter(ke=>ke.teamId),["team","isManaged"]),[fe]),Oe=(0,o.useMemo)(()=>(0,a.sortBy)(fe.filter(ke=>ke.userId&&!ke.isServiceAccount),["userLogin","isManaged"]),[fe]),Ne=(0,o.useMemo)(()=>(0,a.sortBy)(fe.filter(ke=>ke.userId&&ke.isServiceAccount),["userLogin","isManaged"]),[fe]),We=(0,o.useMemo)(()=>(0,a.sortBy)(fe.filter(ke=>ke.builtInRole),["builtInRole","isManaged"]),[fe]),Ae=(0,s.t)("access-control.permissions.role","Role"),Ue=(0,s.t)("access-control.permissions.user","User"),Me=(0,s.t)("access-control.permissions.serviceaccount","Service Account"),$e=(0,s.t)("access-control.permissions.team","Team");return o.createElement(o.Fragment,null,o.createElement("div",null,ee&&se==="folders"&&o.createElement(o.Fragment,null,o.createElement(s.x6,{i18nKey:"access-control.permissions.permissions-change-warning"},"This will change permissions for this folder and all its descendants. In total, this will affect:"),o.createElement(u.x,{selectedItems:{folder:{[ne]:!0},dashboard:{},panel:{},$all:!1}}),o.createElement(i.$,{v:2})),fe.length===0&&o.createElement(f.a,null,o.createElement(d.E,null,oe)),o.createElement(N,{title:Ae,items:We,compareKey:"builtInRole",permissionLevels:he.permissions,onChange:Pe,onRemove:ye,canSet:ee}),o.createElement(N,{title:Ue,items:Oe,compareKey:"userLogin",permissionLevels:he.permissions,onChange:Pe,onRemove:ye,canSet:ee}),o.createElement(N,{title:Me,items:Ne,compareKey:"userLogin",permissionLevels:he.permissions,onChange:Pe,onRemove:ye,canSet:ee}),o.createElement(N,{title:$e,items:Ie,compareKey:"team",permissionLevels:he.permissions,onChange:Pe,onRemove:ye,canSet:ee}),ee&&o.createElement(o.Fragment,null,o.createElement(l.$n,{className:ie.addPermissionButton,variant:"primary",key:"add-permission",onClick:()=>ue(!0),icon:"plus"},Y),o.createElement(m.a,{in:de},o.createElement(S,{title:Z,onAdd:pe,permissions:he.permissions,assignments:he.assignments,onCancel:()=>ue(!1)})))),q&&q(fe))},w=async j=>{try{return await(0,h.AI)().get(`/api/access-control/${j}/description`)}catch(Y){return console.error("failed to load resource description: ",Y),K}},U=(j,Y)=>(0,h.AI)().get(`/api/access-control/${j}/${Y}`),W=(j,Y,oe,se)=>H(j,Y,"users",oe,se),V=(j,Y,oe,se)=>H(j,Y,"teams",oe,se),_=(j,Y,oe,se)=>H(j,Y,"builtInRoles",oe,se),H=(j,Y,oe,se,ne)=>(0,h.AI)().post(`/api/access-control/${j}/${Y}/${oe}/${se}`,{permission:ne}),G=j=>({breakdown:(0,n.css)({...j.typography.bodySmall,color:j.colors.text.secondary,marginBottom:j.spacing(2)}),addPermissionButton:(0,n.css)({marginBottom:j.spacing(2)})})},9025:(Q,I,e)=>{"use strict";e.d(I,{a:()=>f});var n=e(96540),a=e(22669);const o="200px",r=200,i={transition:`max-height ${r}ms ease-in-out`,overflow:"hidden"},f=({children:d,in:l,maxHeight:m=o,style:s=i})=>{const h=(0,n.useRef)(null),u={exited:{maxHeight:0},entering:{maxHeight:m},entered:{maxHeight:"unset",overflow:"visible"},exiting:{maxHeight:0}};return n.createElement(a.Ay,{in:l,timeout:r,nodeRef:h},b=>n.createElement("div",{style:{...s,...u[b]},ref:h},d))}},70944:(Q,I,e)=>{"use strict";e.d(I,{dk:()=>P,hE:()=>b,k0:()=>g});var n=e(24120),a=e(49426),o=e(64388),r=e(26272),i=e(32264),f=e(14110),d=e(12131),l=e(28138),m=e(8484),s=e(33390);function h(y,p){if(y===p)return!0;if(!(y instanceof Object)||!(p instanceof Object))return!1;const v=Object.keys(y),D=v.length;for(let E=0;E<D;E++)if(!(v[E]in p))return!1;for(let E=0;E<D;E++)if(y[v[E]]!==p[v[E]])return!1;return D===Object.keys(p).length}var u=e(31678);const b="grafana.navigation.docked",g="grafana.navigation.open";class P{constructor(){this.searchBarStorageKey="SearchBar_Hidden",this.routeChangeHandled=!0,this.megaMenuDocked=!!(window.innerWidth>=i.$.theme2.breakpoints.values.xl&&s.A.getBool(b,window.innerWidth>=i.$.theme2.breakpoints.values.xxl)),this.sessionStorageData=window.sessionStorage.getItem("returnToPrevious"),this.returnToPreviousData=this.sessionStorageData?JSON.parse(this.sessionStorageData):void 0,this.state=new a.t({chromeless:!0,sectionNav:{node:{text:(0,m.t)("nav.home.title","Home")},main:{text:""}},searchBarHidden:s.A.getBool(this.searchBarStorageKey,!1),megaMenuOpen:this.megaMenuDocked&&s.A.getBool(g,!0),megaMenuDocked:this.megaMenuDocked,kioskMode:null,layout:o.k.Canvas,returnToPrevious:this.returnToPreviousData}),this.setReturnToPrevious=p=>{const v=this.state.getValue().returnToPrevious;(0,f.rR)("grafana_return_to_previous_button_created",{page:p.href,previousPage:v?.href}),this.update({returnToPrevious:p}),window.sessionStorage.setItem("returnToPrevious",JSON.stringify(p))},this.clearReturnToPrevious=p=>{const v=this.state.getValue().returnToPrevious;v&&(0,f.rR)("grafana_return_to_previous_button_dismissed",{action:p,page:v.href}),this.update({returnToPrevious:void 0}),window.sessionStorage.removeItem("returnToPrevious")},this.setMegaMenuOpen=p=>{const{megaMenuDocked:v}=this.state.getValue();v&&s.A.set(g,p),(0,f.rR)("grafana_mega_menu_open",{state:p}),this.update({megaMenuOpen:p})},this.setMegaMenuDocked=(p,v=!0)=>{v&&s.A.set(b,p),(0,f.rR)("grafana_mega_menu_docked",{state:p}),this.update({megaMenuDocked:p})},this.onToggleSearchBar=()=>{const{searchBarHidden:p,kioskMode:v}=this.state.getValue(),D=!p;s.A.set(this.searchBarStorageKey,D),v&&d.Ny.partial({kiosk:null}),this.update({searchBarHidden:D,kioskMode:null})},this.onToggleKioskMode=()=>{const p=this.getNextKioskMode();this.update({kioskMode:p}),d.Ny.partial({kiosk:this.getKioskUrlValue(p)})}}setMatchedRoute(p){this.currentRoute!==p&&(this.currentRoute=p,this.routeChangeHandled=!1)}update(p){const v=this.state.getValue(),D={...v};this.routeChangeHandled||(D.actions=void 0,D.pageNav=void 0,D.sectionNav={node:{text:(0,m.t)("nav.home.title","Home")},main:{text:""}},D.chromeless=this.currentRoute?.chromeless,D.layout=o.k.Standard,this.routeChangeHandled=!0),Object.assign(D,p),D.chromeless=D.kioskMode===u.KioskMode.Full||this.currentRoute?.chromeless,this.ignoreStateUpdate(D,v)||this.state.next(D)}ignoreStateUpdate(p,v){return!!(h(p,v)||(p.sectionNav!==v.sectionNav||p.pageNav!==v.pageNav)&&p.actions===v.actions&&p.layout===v.layout&&c(p.sectionNav.node,v.sectionNav.node)&&c(p.pageNav,v.pageNav))}useState(){return(0,n.A)(this.state,this.state.getValue())}exitKioskMode(){this.update({kioskMode:void 0}),d.Ny.partial({kiosk:null})}setKioskModeFromUrl(p){let v;switch(p){case"tv":v=u.KioskMode.TV;break;case"1":case!0:v=u.KioskMode.Full}v&&v!==this.state.getValue().kioskMode&&this.update({kioskMode:v})}getKioskUrlValue(p){switch(p){case u.KioskMode.TV:return"tv";case u.KioskMode.Full:return!0;default:return null}}getNextKioskMode(){const{kioskMode:p,searchBarHidden:v}=this.state.getValue();return v||p===u.KioskMode.TV?(l.A.emit(r.r1.alertSuccess,[(0,m.t)("navigation.kiosk.tv-alert","Press ESC to exit kiosk mode")]),u.KioskMode.Full):p?null:u.KioskMode.TV}}function c(y,p){if(y===p)return!0;const v=y?.children?.find(E=>E.active),D=p?.children?.find(E=>E.active);return y?.text===p?.text&&y?.url===p?.url&&v?.url===D?.url&&c(y?.parentItem,p?.parentItem)}},75269:(Q,I,e)=>{"use strict";e.d(I,{H:()=>o});var n=e(96540),a=e(76888);const o=n.memo(({actions:r})=>{const{chrome:i}=(0,a.Il)();return(0,n.useLayoutEffect)(()=>{i.update({actions:r})}),null});o.displayName="TopNavUpdate"},10804:(Q,I,e)=>{"use strict";e.d(I,{K:()=>r});var n=e(32196),a=e(96540),o=e(40845);function r({className:f,leftActionsSeparator:d}){const l=(0,o.of)(i);return d?a.createElement("div",{className:(0,n.cx)(f,l.leftActionsSeparator)}):a.createElement("div",{className:(0,n.cx)(f,l.line)})}const i=f=>({leftActionsSeparator:(0,n.css)({display:"flex",flexGrow:1}),line:(0,n.css)({width:1,backgroundColor:f.colors.border.medium,height:24})})},57571:(Q,I,e)=>{"use strict";e.d(I,{l:()=>n});const n=40},19361:(Q,I,e)=>{"use strict";e.d(I,{M:()=>m});var n=e(32196),a=e(96540),o=e(23596),r=e(40845);const i=({className:s,logo:h})=>a.createElement("img",{className:s,src:`${h||"public/img/grafana_icon.svg"}`,alt:"Grafana"}),f=({className:s,children:h})=>{const u=(0,r.$j)(),b=(0,n.css)({"&:before":{content:'""',position:"fixed",left:0,right:0,bottom:0,top:0,background:`url(public/img/g8_login_${u.isDark?"dark":"light"}.svg)`,backgroundPosition:"top center",backgroundSize:"auto",backgroundRepeat:"no-repeat",opacity:0,transition:"opacity 3s ease-in-out",[u.breakpoints.up("md")]:{backgroundPosition:"center",backgroundSize:"cover"}}});return a.createElement("div",{className:(0,n.cx)(b,s)},h)},d=({className:s})=>a.createElement("img",{className:s,src:"public/img/grafana_icon.svg",alt:"Grafana"}),l=()=>{const s=(0,r.$j)();return(0,n.css)({background:o.alpha(s.colors.background.primary,.7),backgroundSize:"cover"})};class m{static{this.LoginLogo=i}static{this.LoginBackground=f}static{this.MenuLogo=d}static{this.LoginBoxBackground=l}static{this.AppTitle="Grafana"}static{this.LoginTitle="Welcome to Grafana"}static{this.HideEdition=!1}static{this.GetLoginSubTitle=()=>null}}},3984:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>n});function n(a,o,r){const i=[];let f=!1,d;function l(m,s=!1){if(f)return;const h=m.url?.split("?")??["",""];let u=h[0];const b=new URLSearchParams(h[1]);if(b.has("editview")&&(u+=`?editview=${b.get("editview")}`),r&&u===r.url){i.unshift({text:r.text,href:m.url??""}),f=!0;return}const g=u.length>0&&d===u;d=u,!m.hideFromBreadcrumbs&&!(s&&g)&&i.unshift({text:m.text,href:m.url??""}),m.parentItem&&l(m.parentItem)}return o&&l(o),l(a,!0),i}},25469:(Q,I,e)=>{"use strict";e.d(I,{J:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(29158);const i=({onClick:d,"aria-label":l,style:m})=>{const s=(0,o.of)(f);return a.createElement(r.K,{"aria-label":l??"Close",className:s,name:"times",onClick:d,style:m,tooltip:"Close"})},f=d=>(0,n.css)({position:"absolute",right:d.spacing(.5),top:d.spacing(1)})},27921:(Q,I,e)=>{"use strict";e.d(I,{A:()=>a});var n=e(96540);const a=o=>n.lazy(o)},7521:(Q,I,e)=>{"use strict";e.d(I,{A:()=>s});var n=e(32196),a=e(96540),o=e(13544),r=e(14578),i=e(55852),f=e(76442);const d=(0,n.css)({textAlign:"center"}),l=(0,n.css)({maxWidth:"700px",margin:"0 auto"}),s=({title:h,buttonIcon:u,buttonLink:b,buttonTitle:g,buttonDisabled:P,onClick:c,proTip:y,proTipLink:p,proTipLinkTitle:v,proTipTarget:D,infoBox:E,infoBoxTitle:S})=>{const T=()=>a.createElement(a.Fragment,null,y?a.createElement("span",{key:"proTipFooter"},a.createElement(r.I,{name:"rocket"}),a.createElement(a.Fragment,null," ProTip: ",y," "),p&&a.createElement("a",{href:p,target:D,className:"text-link"},v)):"",E?a.createElement("div",{key:"infoBoxHtml",className:`grafana-info-box ${l}`},S&&a.createElement("h5",null,S),a.createElement("div",{dangerouslySetInnerHTML:E})):""),M=T()?"":(0,n.css)({marginBottom:"20px"}),A=b?i.z9:i.$n,x=a.createElement(A,{size:"lg",onClick:c,href:b,icon:u,className:M,"data-testid":o.Tp.components.CallToActionCard.buttonV2(g),disabled:P},g);return a.createElement(f.c,{className:d,message:h,footer:T(),callToActionElement:x})}},38645:(Q,I,e)=>{"use strict";e.d(I,{DH:()=>s,Dd:()=>d,wi:()=>h});var n=e(32196),a=e(96540),o=e(32264),r=e(40845),i=e(14578),f=e(8484);let d=()=>[{target:"_blank",id:"documentation",text:(0,f.t)("nav.help/documentation","Documentation"),icon:"document-info",url:"https://grafana.com/docs/grafana/latest/?utm_source=grafana_footer"},{target:"_blank",id:"support",text:(0,f.t)("nav.help/support","Support"),icon:"question-circle",url:"https://grafana.com/products/enterprise/?utm_source=grafana_footer"},{target:"_blank",id:"community",text:(0,f.t)("nav.help/community","Community"),icon:"comments-alt",url:"https://community.grafana.com/?utm_source=grafana_footer"}];function l(g){return{hasReleaseNotes:!0,isBeta:g.includes("-beta")}}function m(g){const{buildInfo:P,licenseInfo:c}=o.$,y=[],p=c.stateInfo?` (${c.stateInfo})`:"";if(g||y.push({target:"_blank",id:"license",text:`${P.edition}${p}`,url:c.licenseUrl}),P.hideVersion)return y;const{hasReleaseNotes:v}=l(P.version);return y.push({target:"_blank",id:"version",text:P.versionString,url:v?"https://github.com/grafana/grafana/blob/main/CHANGELOG.md":void 0}),P.hasUpdate&&y.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),y}function s(g){d=g}const h=a.memo(({customLinks:g,hideEdition:P})=>{const c=(g||d()).concat(m(P)),y=(0,r.of)(b);return a.createElement("footer",{className:y.footer},a.createElement("div",{className:"text-center"},a.createElement("ul",{className:y.list},c.map((p,v)=>a.createElement("li",{className:y.listItem,key:v},a.createElement(u,{item:p}))))))});h.displayName="Footer";function u({item:g}){const P=g.url?a.createElement("a",{href:g.url,target:g.target,rel:"noopener noreferrer",id:g.id},g.text):g.text;return a.createElement(a.Fragment,null,g.icon&&a.createElement(i.I,{name:g.icon})," ",P)}const b=g=>({footer:(0,n.css)({...g.typography.bodySmall,color:g.colors.text.primary,display:"block",padding:g.spacing(2,0),position:"relative",width:"98%","a:hover":{color:g.colors.text.maxContrast,textDecoration:"underline"},[g.breakpoints.down("md")]:{display:"none"}}),list:(0,n.css)({listStyle:"none"}),listItem:(0,n.css)({display:"inline-block","&:after":{content:"' | '",padding:g.spacing(0,1)},"&:last-child:after":{content:"''",paddingLeft:0}})})},53153:(Q,I,e)=>{"use strict";e.d(I,{S:()=>g});var n=e(96540),a=e(49785),o=e(13544),r=e(32264),i=e(40845),f=e(42418),d=e(88575),l=e(67061),m=e(55852),s=e(56034),h=e(4691),u=e(78361),b=e(35043);const g=({onSubmit:P,onSkip:c,showDefaultPasswordWarning:y})=>{const p=(0,i.of)(h.$),[v,D]=(0,n.useState)(!1),[E,S]=(0,n.useState)(!0),{handleSubmit:T,register:M,getValues:A,formState:{errors:x},watch:C}=(0,a.mN)({defaultValues:{newPassword:"",confirmNew:""}}),O=C("newPassword"),R=L=>{P(L.newPassword)};return n.createElement("form",{onSubmit:T(R)},y&&n.createElement(f.F,{severity:"info",title:"Continuing to use the default password exposes you to security risks."}),n.createElement(d.D,{label:"New password",invalid:!!x.newPassword,error:x?.newPassword?.message},n.createElement(u.s,{onFocus:()=>D(!0),...M("newPassword",{required:"New Password is required",onBlur:()=>S(!1),validate:{strongPasswordValidationRegister:b.DP}}),id:"new-password",autoFocus:!0,autoComplete:"new-password"})),v&&n.createElement(b.zJ,{pristine:E,password:O,strongPasswordValidations:b.NQ}),n.createElement(d.D,{label:"Confirm new password",invalid:!!x.confirmNew,error:x?.confirmNew?.message},n.createElement(u.s,{...M("confirmNew",{required:"Confirmed Password is required",validate:L=>L===A().newPassword||"Passwords must match!"}),id:"confirm-new-password",autoComplete:"new-password"})),n.createElement(l.B,{direction:"column"},n.createElement(m.$n,{type:"submit",className:p.submitButton},"Submit"),!r.$.auth.basicAuthStrongPasswordPolicy&&c&&n.createElement(s.m,{content:"If you skip you will be prompted to change password next time you log in.",placement:"bottom"},n.createElement(m.$n,{fill:"text",onClick:c,type:"button","data-testid":o.Tp.pages.Login.skip},"Skip"))))}},72235:(Q,I,e)=>{"use strict";e.d(I,{l:()=>r});var n=e(32196),a=e(96540),o=e(49785);function r({defaultValues:i,onSubmit:f,validateOnMount:d=!1,validateFieldsOnMount:l,children:m,validateOn:s="onSubmit",maxWidth:h=600,...u}){const{handleSubmit:b,trigger:g,formState:P,...c}=(0,o.mN)({mode:s,defaultValues:i});return(0,a.useEffect)(()=>{d&&g(l)},[g,l,d]),a.createElement("form",{className:(0,n.css)({maxWidth:h!=="none"?h+"px":h,width:"100%"}),onSubmit:b(f),...u},m({errors:P.errors,formState:P,trigger:g,...c}))}},30249:(Q,I,e)=>{"use strict";e.d(I,{o:()=>u});var n=e(96540),a=e(85200),o=e(1173),r=e(11261),i=e(90708),f=e(67266),d=e(81297),l=e(16895),m=e(40458);function s(b,g,P=[]){for(const c of P)if(typeof c=="function"){if(!c(b,g))return!1}else if(g[c]!==b[c])return!1;return!0}const h={x:a.sJ.get(o.Ct.firstTimeField).get({}),y:a.sJ.get(o.Ct.byTypes).get(new Set([r.PU.number,r.PU.enum]))};class u extends n.Component{constructor(g){super(g),this.getTimeRange=()=>this.props.timeRange;let P=this.prepState(g);P.alignedData=P.config.prepData([P.alignedFrame]),this.state=P,this.plotInstance=n.createRef()}prepState(g,P=!0){let c=null;const{frames:y,fields:p=h,preparePlotFrame:v,replaceVariables:D,dataLinkPostProcessor:E}=g,S=v??m.m,T=y.some(A=>A.fields.some(x=>(x.config.links?.length??0)>0)),M=S(y,{...p,y:T?()=>!0:p.y},g.timeRange);if((0,l.uY)("GraphNG",!1,"data aligned",M),M){let A=M;if(T){const C=Array.isArray(this.props.timeZone)?this.props.timeZone[0]:this.props.timeZone;M.fields.forEach(O=>{O.getLinks=(0,i._M)(M,O,{...O.state?.scopedVars,__dataContext:{value:{data:[M],field:O,frame:M,frameIndex:0}}},D,C,E)}),A={...M,fields:M.fields.filter((O,R)=>R===0||p.y(O,M,[M]))}}let x=this.state?.config;P&&(x=g.prepConfig(A,this.props.frames,this.getTimeRange),(0,l.uY)("GraphNG",!1,"config prepared",x)),c={alignedFrame:A,config:x},(0,l.uY)("GraphNG",!1,"data prepared",c.alignedData)}return c}componentDidUpdate(g){const{frames:P,structureRev:c,timeZone:y,cursorSync:p,propsToDiff:v}=this.props,D=!s(g,this.props,v);if(P!==g.frames||D||y!==g.timeZone||p!==g.cursorSync){let E=this.prepState(this.props,!1);E&&((this.state.config===void 0||y!==g.timeZone||p!==g.cursorSync||c!==g.structureRev||!c||D)&&(E.config=this.props.prepConfig(E.alignedFrame,this.props.frames,this.getTimeRange),(0,l.uY)("GraphNG",!1,"config recreated",E.config)),E.alignedData=E.config.prepData([E.alignedFrame]),this.setState(E))}}render(){const{width:g,height:P,children:c,renderLegend:y}=this.props,{config:p,alignedFrame:v,alignedData:D}=this.state;return p?n.createElement(f.KU,{width:g,height:P,legend:y(p)},(E,S)=>n.createElement(d.Z,{config:p,data:D,width:E,height:S,plotRef:T=>this.plotInstance.current=T},c?c(p,v):null)):null}}},40458:(Q,I,e)=>{"use strict";e.d(I,{m:()=>m});var n=e(11261),a=e(73060),o=e(46294);function r(s,h,u){let b,g;for(let P=0;P<h.length;P++)if(h[P]==null)g==null&&b!=null&&(g=P);else{if(g!=null&&b!=null){if(s[P]-b<u)for(;g<P;)h[g++]=void 0;g=null}b=s[P]}return h}var i=e(52622);function f(s){return s.type===n.PU.number&&s.config.custom?.drawStyle===i.GR.Bars&&!s.config.custom?.hideFrom?.viz}function d(s,h){return s.fields.find(u=>h!=null?u.name===h:u.type===n.PU.time)}function l(s,h){const u=d(s,h);let b=u?.values;for(let g=0;g<s.fields.length;g++){let P=s.fields[g];if(P===u||f(P))continue;let c=P.config.custom?.spanNulls;typeof c=="number"&&c!==-1&&b&&(P.values=r(b,P.values,c))}return s}function m(s,h,u){let b;e:for(let y of s)for(let p of y.fields)if(h.x(p,y,s)){b=p;break e}s=s.map(y=>b?.state?.nullThresholdApplied?y:(0,o.M)({frame:y,refFieldName:b.name,refFieldPseudoMin:u?.from.valueOf(),refFieldPseudoMax:u?.to.valueOf()}));let g=s.reduce((y,p)=>y+p.fields.reduce((v,D)=>v+(f(D)?1:0),0),0),P=1/0;g>1&&s.forEach(y=>{if(!y.fields.some(f))return;const p=b.values;for(let v=0;v<p.length;v++)v>0&&(P=Math.min(P,p[v]-p[v-1]))});let c=(0,a.Fd)({frames:s,joinBy:h.x,keep:h.y,keepOriginIndices:!0,keepDisplayNames:!0,nullMode:y=>{if(f(y))return a.WO;let p=y.config.custom?.spanNulls;return p===!0?a.RC:p===-1?a.WO:a.JI}});return c?(c=l(c,b.name),P!==1/0&&(c.fields.forEach((y,p)=>{let v=y.values;if(p===0){let D=v[v.length-1];v.push(D+P,D+2*P)}else f(y)?v.push(null,null):v.push(void 0,void 0)}),c.length+=2),c):null}},18759:(Q,I,e)=>{"use strict";e.d(I,{T:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(16795);function i({children:d,spacing:l,level:m}){const s=(0,o.of)(f,l,m);return a.createElement("span",{className:(0,n.css)(s.indentor)},d)}const f=(d,l,m)=>({indentor:(0,n.css)((0,r.Y)(d,l,s=>({paddingLeft:d.spacing(s*m)})))})},61680:(Q,I,e)=>{"use strict";e.d(I,{b:()=>o});var n=e(96540),a=e(33390);const o=r=>{const{children:i,storageKey:f,defaultValue:d}=r,[l,m]=(0,n.useState)({value:a.A.getObject(r.storageKey,r.defaultValue)});(0,n.useEffect)(()=>{const u=b=>{b.key===f&&m({value:a.A.getObject(r.storageKey,r.defaultValue)})};return window.addEventListener("storage",u),()=>{window.removeEventListener("storage",u)}});const s=u=>{try{a.A.setObject(f,u)}catch(b){console.error(b)}m({value:u})},h=()=>{try{a.A.delete(f)}catch(u){console.log(u)}m({value:d})};return n.createElement(n.Fragment,null,i(l.value,s,h))}},87570:(Q,I,e)=>{"use strict";e.d(I,{A:()=>d});var n=e(96540),a=e(17172),o=e(2913),r=e(8484);const i=()=>!!o.Ay.oauth&&Object.keys(o.Ay.oauth).length>0;class f extends n.PureComponent{constructor(s){super(s),this.changePassword=h=>{const u={newPassword:h,confirmNew:h,oldPassword:"admin"};if(this.props.resetCode){const b={code:this.props.resetCode,newPassword:h,confirmPassword:h};(0,a.AI)().post("/api/user/password/reset",b).then(()=>{this.toGrafana()})}else(0,a.AI)().put("/api/user/password",u).then(()=>{this.toGrafana()}).catch(b=>console.error(b))},this.login=h=>{this.setState({loginErrorMessage:void 0,isLoggingIn:!0}),(0,a.AI)().post("/login",h,{showErrorAlert:!1}).then(u=>{if(this.result=u,h.password!=="admin"||o.Ay.ldapEnabled||o.Ay.authProxyEnabled){this.toGrafana();return}else this.changeView(h.password==="admin")}).catch(u=>{const b=(0,a.NF)(u)?l(u):void 0;this.setState({isLoggingIn:!1,loginErrorMessage:b||(0,r.t)("login.error.unknown","Unknown error occurred")})})},this.changeView=h=>{this.setState({isChangingPassword:!0,showDefaultPasswordWarning:h})},this.toGrafana=()=>{this.result?.redirectUrl?o.Ay.appSubUrl!==""&&!this.result.redirectUrl.startsWith(o.Ay.appSubUrl)?window.location.assign(o.Ay.appSubUrl+this.result.redirectUrl):window.location.assign(this.result.redirectUrl):window.location.assign(o.Ay.appSubUrl+"/")},this.state={isLoggingIn:!1,isChangingPassword:!1,showDefaultPasswordWarning:!1,loginErrorMessage:o.Ay.loginError}}render(){const{children:s}=this.props,{isLoggingIn:h,isChangingPassword:u,showDefaultPasswordWarning:b,loginErrorMessage:g}=this.state,{login:P,toGrafana:c,changePassword:y}=this,{loginHint:p,passwordHint:v,disableLoginForm:D,disableUserSignUp:E}=o.Ay;return n.createElement(n.Fragment,null,s({isOauthEnabled:i(),loginHint:p,passwordHint:v,disableLoginForm:D,disableUserSignUp:E,login:P,isLoggingIn:h,changePassword:y,skipPasswordChange:c,isChangingPassword:u,showDefaultPasswordWarning:b,loginErrorMessage:g}))}}const d=f;function l(m){switch(m.data?.messageId){case"password-auth.empty":case"password-auth.failed":case"password-auth.invalid":return(0,r.t)("login.error.invalid-user-or-password","Invalid username or password");case"login-attempt.blocked":return(0,r.t)("login.error.blocked","You have exceeded the number of login attempts for this user. Please try again later.");default:return m.data?.message}}},4691:(Q,I,e)=>{"use strict";e.d(I,{$:()=>u,Q:()=>h});var n=e(32196),a=e(96540),o=e(49785),r=e(13544),i=e(40845),f=e(88575),d=e(10354),l=e(55852),m=e(8484),s=e(78361);const h=({children:b,onSubmit:g,isLoggingIn:P,passwordHint:c,loginHint:y})=>{const p=(0,i.of)(u),v=(0,a.useId)(),D=(0,a.useId)(),{handleSubmit:E,register:S,formState:{errors:T}}=(0,o.mN)({mode:"onChange"});return a.createElement("div",{className:p.wrapper},a.createElement("form",{onSubmit:E(g)},a.createElement(f.D,{label:(0,m.t)("login.form.username-label","Email or username"),invalid:!!T.user,error:T.user?.message},a.createElement(d.p,{...S("user",{required:(0,m.t)("login.form.username-required","Email or username is required")}),id:v,autoFocus:!0,autoCapitalize:"none",placeholder:y||(0,m.t)("login.form.username-placeholder","email or username"),"data-testid":r.Tp.pages.Login.username})),a.createElement(f.D,{label:(0,m.t)("login.form.password-label","Password"),invalid:!!T.password,error:T.password?.message},a.createElement(s.s,{...S("password",{required:(0,m.t)("login.form.password-required","Password is required")}),id:D,autoComplete:"current-password",placeholder:c||(0,m.t)("login.form.password-placeholder","password")})),a.createElement(l.$n,{type:"submit","data-testid":r.Tp.pages.Login.submit,className:p.submitButton,disabled:P},P?(0,m.t)("login.form.submit-loading-label","Logging in..."):(0,m.t)("login.form.submit-label","Log in")),b))},u=b=>({wrapper:(0,n.css)({width:"100%",paddingBottom:b.spacing(2)}),submitButton:(0,n.css)({justifyContent:"center",width:"100%"})})},20851:(Q,I,e)=>{"use strict";e.d(I,{GU:()=>d,YO:()=>m,qm:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(19361),i=e(38645);const f=({children:s,enterAnimation:h=!0})=>{const u=(0,o.of)(m);return a.createElement("div",{className:(0,n.cx)(u.loginInnerBox,h&&u.enterAnimation)},s)},d=({children:s,branding:h,isChangingPassword:u})=>{const b=(0,o.of)(m),[g,P]=(0,a.useState)(!1),c=h?.loginSubtitle??r.M.GetLoginSubTitle(),y=h?.loginTitle??r.M.LoginTitle,p=h?.loginBoxBackground||r.M.LoginBoxBackground(),v=h?.loginLogo,D=h?.hideEdition??r.M.HideEdition;return(0,a.useEffect)(()=>P(!0),[]),a.createElement(r.M.LoginBackground,{className:(0,n.cx)(b.container,g&&b.loginAnim,h?.loginBackground)},a.createElement("div",{className:b.loginMain},a.createElement("div",{className:(0,n.cx)(b.loginContent,p,"login-content-box")},a.createElement("div",{className:b.loginLogoWrapper},a.createElement(r.M.LoginLogo,{className:b.loginLogo,logo:v}),a.createElement("div",{className:b.titleWrapper},u?a.createElement("h1",{className:b.mainTitle},"Update your password"):a.createElement(a.Fragment,null,a.createElement("h1",{className:b.mainTitle},y),c&&a.createElement("h3",{className:b.subTitle},c)))),a.createElement("div",{className:b.loginOuterBox},s))),h?.hideFooter?a.createElement(a.Fragment,null):a.createElement(i.wi,{hideEdition:D,customLinks:h?.footerLinks}))},l=(0,n.keyframes)`
from{
  opacity: 0;
  transform: translate(-60px, 0px);
}

to{
  opacity: 1;
  transform: translate(0px, 0px);
}`,m=s=>({loginMain:(0,n.css)({flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:"100%"}),container:(0,n.css)({minHeight:"100%",backgroundPosition:"center",backgroundRepeat:"no-repeat",minWidth:"100%",marginLeft:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}),loginAnim:(0,n.css)({"&:before":{opacity:1},".login-content-box":{opacity:1}}),submitButton:(0,n.css)({justifyContent:"center",width:"100%"}),loginLogo:(0,n.css)({width:"100%",maxWidth:60,marginBottom:s.spacing(2),[s.breakpoints.up("sm")]:{maxWidth:100}}),loginLogoWrapper:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",padding:s.spacing(3)}),titleWrapper:(0,n.css)({textAlign:"center"}),mainTitle:(0,n.css)({fontSize:22,[s.breakpoints.up("sm")]:{fontSize:32}}),subTitle:(0,n.css)({fontSize:s.typography.size.md,color:s.colors.text.secondary}),loginContent:(0,n.css)({maxWidth:478,width:"calc(100% - 2rem)",display:"flex",alignItems:"stretch",flexDirection:"column",position:"relative",justifyContent:"flex-start",zIndex:1,minHeight:320,borderRadius:s.shape.radius.default,padding:s.spacing(2,0),opacity:0,[s.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.5s ease-in-out"},[s.breakpoints.up("sm")]:{minHeight:s.spacing(40),justifyContent:"center"}}),loginOuterBox:(0,n.css)({display:"flex",overflowY:"hidden",alignItems:"center",justifyContent:"center"}),loginInnerBox:(0,n.css)({padding:s.spacing(0,2,2,2),display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,maxWidth:415,width:"100%",transform:"translate(0px, 0px)",[s.transitions.handleMotion("no-preference")]:{transition:"0.25s ease"}}),enterAnimation:(0,n.css)({[s.transitions.handleMotion("no-preference")]:{animation:`${l} ease-out 0.2s`}})})},60188:(Q,I,e)=>{"use strict";e.d(I,{Q:()=>f});var n=e(2543),a=e.n(n),o=e(96540),r=e(10354),i=e(88575);class f extends o.PureComponent{constructor(){super(...arguments),this.state={text:"",inputCorrected:!1},this.inputRef=o.createRef(),this.updateValue=()=>{const l=this.inputRef.current?.value;let m=!1,s="";const h=this.props.min,u=this.props.max;let b=l!==""?Number(l):void 0;b&&!Number.isNaN(b)&&(h!=null&&b<h?(s=h.toString(),m=!0):u!=null&&b>u?(s=u.toString(),m=!0):s=l??"",this.setState({text:s,inputCorrected:m})),m&&this.updateValueDebounced(),!Number.isNaN(b)&&b!==this.props.value&&this.props.onChange(b)},this.updateValueDebounced=(0,n.debounce)(this.updateValue,500),this.onChange=l=>{this.setState({text:l.currentTarget.value}),this.updateValueDebounced()},this.onKeyPress=l=>{l.key==="Enter"&&this.updateValue()}}componentDidMount(){this.setState({text:isNaN(this.props.value)?"":`${this.props.value}`})}componentDidUpdate(l){if(this.props.value!==l.value){const m=isNaN(this.props.value)?"":`${this.props.value}`;m!==this.state.text&&this.setState({text:m})}}renderInput(){return o.createElement(r.p,{type:"number",ref:this.inputRef,min:this.props.min,max:this.props.max,step:this.props.step,autoFocus:this.props.autoFocus,value:this.state.text,onChange:this.onChange,onBlur:this.updateValue,onKeyPress:this.onKeyPress,placeholder:this.props.placeholder,disabled:this.props.fieldDisabled,width:this.props.width,suffix:this.props.suffix})}render(){const{inputCorrected:l}=this.state;if(l){let m="",{min:s,max:h}=this.props;return h==null?s!=null&&(m=`< ${s}`):s!=null?m=`${s} < > ${h}`:m=`> ${h}`,o.createElement(i.D,{invalid:l,error:`Out of range ${m}`,validationMessageHorizontalOverflow:!0,style:{direction:"rtl"}},this.renderInput())}return this.renderInput()}}},77268:(Q,I,e)=>{"use strict";e.d(I,{a:()=>d});var n=e(32196),a=e(96540),o=e(40845),r=e(83598),i=e(29158),f=e(83876);const d=({value:m,settings:s,onChange:h,details:u})=>{const b=(0,o.$j)(),g=(0,o.of)(l);return a.createElement(r.sk,{color:m??"",onChange:h,enableNamedColors:s?.enableNamedColors!==!1},({ref:P,showColorPicker:c,hideColorPicker:y})=>a.createElement("div",{className:g.spot},a.createElement("div",{className:g.colorPicker},a.createElement(f.q,{ref:P,onClick:c,onMouseLeave:y,color:m?b.visualization.getColorByName(m):b.components.input.borderColor})),u&&a.createElement(a.Fragment,null,m?a.createElement("span",{className:g.colorText,onClick:c},m):a.createElement("span",{className:g.placeholderText,onClick:c},s?.placeholder??"Select color"),s?.isClearable&&m&&a.createElement(i.K,{name:"times",onClick:()=>h(void 0),tooltip:"Clear settings"}))))},l=m=>({spot:(0,n.css)({cursor:"pointer",color:m.colors.text.primary,background:m.components.input.background,padding:"3px",height:m.v1.spacing.formInputHeight,border:`1px solid ${m.components.input.borderColor}`,display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end","&:hover":{border:`1px solid ${m.components.input.borderHover}`}}),colorPicker:(0,n.css)({padding:`0 ${m.spacing(1)}`}),colorText:(0,n.css)({flexGrow:2}),placeholderText:(0,n.css)({flexGrow:2,color:m.colors.text.secondary})})},72626:(Q,I,e)=>{"use strict";e.d(I,{w:()=>o});var n=e(96540),a=e(60188);const o=({value:r,onChange:i,item:f})=>{const{settings:d}=f,l=(0,n.useCallback)(m=>{i(d?.integer&&m!==void 0?Math.floor(m):m)},[i,d?.integer]);return n.createElement(a.Q,{value:r,min:d?.min,max:d?.max,step:d?.step,placeholder:d?.placeholder,onChange:l})}},33919:(Q,I,e)=>{"use strict";e.d(I,{H:()=>ct,u:()=>ft});var n=e(96540),a=e(69550),o=e(27310),r=e(11261),i=e(50082),f=e(15292),d=e(94354),l=e(20333),m=e(76218),s=e(32196),h=e(2543),u=e(47737),b=e(60578),g=e(24284),P=e(10354),c=e(83598),y=e(29158),p=e(55852),v=e(60029),D=e(3911);const E=[{value:i.O.Absolute,label:"Absolute",description:"Pick thresholds based on the absolute values"},{value:i.O.Percentage,label:"Percentage",description:"Pick threshold based on the percent between min/max"}];class S extends n.PureComponent{constructor(re){super(re),this.onAddThreshold=()=>{const{steps:le}=this.state;let be=0;le.length>1&&(be=le[le.length-1].value+10);let De=g.Tj.filter(Ke=>!le.some(Ve=>Ve.color===Ke))[1];De||(De="#CCCCCC");const Te={value:be,color:De,key:T++},we=[...le,Te];(0,u.RU)(we),this.setState({steps:we},()=>{this.latestThresholdInputRef.current&&this.latestThresholdInputRef.current.focus(),this.onChange()})},this.onRemoveThreshold=le=>{const{steps:be}=this.state;be.length&&le.key!==be[0].key&&this.setState({steps:be.filter(De=>De.key!==le.key)},this.onChange)},this.onChangeThresholdValue=(le,be)=>{const De=le.target.value.replace(/,/g,"."),Te=parseFloat(De),we=isNaN(Te)?"":Te,Ke=this.state.steps.map(Ve=>(Ve.key===be.key&&(Ve={...Ve,value:we}),Ve));Ke.length&&(Ke[0].value=-1/0),(0,u.RU)(Ke),this.setState({steps:Ke})},this.onChangeThresholdColor=(le,be)=>{const{steps:De}=this.state,Te=De.map(we=>(we.key===le.key&&(we={...we,color:be}),we));this.setState({steps:Te},this.onChange)},this.onBlur=()=>{const le=[...this.state.steps];(0,u.RU)(le),this.setState({steps:le},this.onChange)},this.onChange=()=>{this.props.onChange(A(this.props.thresholds,this.state.steps))},this.onModeChanged=le=>{this.props.onChange({...this.props.thresholds,mode:le})};const X=M(re.thresholds.steps);X[0].value=-1/0,this.state={steps:X},this.latestThresholdInputRef=n.createRef()}renderInput(re,X,le){const be=this.props.thresholds.mode===i.O.Percentage,De=`Threshold ${le+1}`;return isFinite(re.value)?n.createElement(P.p,{type:"number",step:"0.0001",key:be.toString(),onChange:Te=>this.onChangeThresholdValue(Te,re),value:re.value,"aria-label":De,ref:le===0?this.latestThresholdInputRef:null,onBlur:this.onBlur,prefix:n.createElement("div",{className:X.inputPrefix},n.createElement("div",{className:X.colorPicker},n.createElement(c.sk,{color:re.color,onChange:Te=>this.onChangeThresholdColor(re,Te),enableNamedColors:!0})),be&&n.createElement("div",{className:X.percentIcon},"%")),suffix:n.createElement(y.K,{className:X.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveThreshold(re),tooltip:`Remove ${De}`})}):n.createElement(P.p,{type:"text",value:"Base","aria-label":De,disabled:!0,prefix:n.createElement("div",{className:X.colorPicker},n.createElement(c.sk,{color:re.color,onChange:Te=>this.onChangeThresholdColor(re,Te),enableNamedColors:!0}))})}render(){const{thresholds:re}=this.props,{steps:X}=this.state;return n.createElement(b.D.Consumer,null,le=>{const be=x(le);return n.createElement("div",{className:be.wrapper},n.createElement(p.$n,{size:"sm",icon:"plus",onClick:()=>this.onAddThreshold(),variant:"secondary",className:be.addButton,fullWidth:!0},"Add threshold"),n.createElement("div",{className:be.thresholds},X.slice(0).reverse().map((De,Te)=>n.createElement("div",{className:be.item,key:`${De.key}`},this.renderInput(De,be,Te)))),n.createElement("div",null,n.createElement(v.J,{description:"Percentage means thresholds relative to min & max"},"Thresholds mode"),n.createElement(d.z,{options:E,onChange:this.onModeChanged,value:re.mode})))})}}let T=100;function M(Le){return(!Le||Le.length===0)&&(Le=[{value:-1/0,color:"green"}]),Le.filter((re,X)=>(0,h.isNumber)(re.value)||X===0).map(re=>({color:re.color,value:re.value===null?-1/0:re.value,key:T++}))}function A(Le,re){return{mode:Le.mode??i.O.Absolute,steps:re.map(le=>{const{key:be,...De}=le;return De})}}const x=(0,D.N)(Le=>({wrapper:(0,s.css)`
      display: flex;
      flex-direction: column;
    `,thresholds:(0,s.css)`
      display: flex;
      flex-direction: column;
      margin-bottom: ${Le.spacing(2)};
    `,item:(0,s.css)`
      margin-bottom: ${Le.spacing(1)};

      &:last-child {
        margin-bottom: 0;
      }
    `,colorPicker:(0,s.css)`
      padding: 0 ${Le.spacing(1)};
    `,addButton:(0,s.css)`
      margin-bottom: ${Le.spacing(1)};
    `,percentIcon:(0,s.css)`
      font-size: ${Le.typography.bodySmall.fontSize};
      color: ${Le.colors.text.secondary};
    `,inputPrefix:(0,s.css)`
      display: flex;
      align-items: center;
    `,trashIcon:(0,s.css)`
      color: ${Le.colors.text.secondary};
      cursor: pointer;
      margin-right: 0;

      &:hover {
        color: ${Le.colors.text};
      }
    `}));class C extends n.PureComponent{constructor(re){super(re)}render(){const{onChange:re}=this.props;let X=this.props.value;return X||(X={mode:i.O.Percentage,steps:[]}),n.createElement(S,{thresholds:X,onChange:re})}}var O=e(25019),R=e(40845),L=e(66864),N=e(14578),F=e(37390),K=e(80744),B=e(25148),w=e(75494),U=e(51986),W=e(21594);function V({mapping:Le,index:re,onChange:X,onRemove:le,onDuplicate:be,showIconPicker:De}){const{key:Te,result:we,id:Ke}=Le,Ve=(0,R.of)(_),ht=(0,n.useRef)(null),gt=(0,n.useCallback)(un=>{const fn={...Le,result:{...Le.result}};un(fn),X(re,fn)},[Le,re,X]);(0,n.useEffect)(()=>{ht.current&&Le.isNew&&(ht.current.focus(),gt(un=>{un.isNew=!1}))},[Le,ht,gt]);const bt=un=>{gt(fn=>{fn.result.color=un})},St=()=>{gt(un=>{un.result.color=void 0})},Je=un=>{gt(fn=>{fn.result.icon=un})},rt=()=>{gt(un=>{un.result.icon=void 0})},Rt=un=>{gt(fn=>{fn.key=un.currentTarget.value})},_t=un=>{gt(fn=>{fn.result.text=un.currentTarget.value})},nn=un=>{gt(fn=>{fn.from=parseFloat(un.currentTarget.value)})},Kt=un=>{gt(fn=>{fn.to=parseFloat(un.currentTarget.value)})},en=un=>{gt(fn=>{fn.pattern=un.currentTarget.value})},Qt=un=>{gt(fn=>{fn.specialMatch=un.value})},An=[{label:"Null",value:O.W.Null,description:"Matches null and undefined values"},{label:"NaN",value:O.W.NaN,description:"Matches against Number.NaN (not a number)"},{label:"Null + NaN",value:O.W.NullAndNaN,description:"Matches null, undefined and NaN"},{label:"True",value:O.W.True,description:"Boolean true values"},{label:"False",value:O.W.False,description:"Boolean false values"},{label:"Empty",value:O.W.Empty,description:"Empty string"}];return n.createElement(w.sx,{key:Ke,draggableId:Ke,index:re},un=>n.createElement("tr",{className:Ve.dragRow,ref:un.innerRef,...un.draggableProps},n.createElement("td",null,n.createElement("div",{className:Ve.dragHandle,...un.dragHandleProps},n.createElement(N.I,{name:"draggabledots",size:"lg"}))),n.createElement("td",{className:Ve.typeColumn},Le.type),n.createElement("td",null,Le.type===O.d.ValueToText&&n.createElement(P.p,{ref:ht,type:"text",value:Te??"",onChange:Rt,placeholder:"Exact value to match"}),Le.type===O.d.RangeToText&&n.createElement("div",{className:Ve.rangeInputWrapper},n.createElement(P.p,{type:"number",value:Le.from??"",placeholder:"Range start",onChange:nn,prefix:"From"}),n.createElement(P.p,{type:"number",value:Le.to??"",placeholder:"Range end",onChange:Kt,prefix:"To"})),Le.type===O.d.RegexToText&&n.createElement(P.p,{type:"text",value:Le.pattern??"",placeholder:"Regular expression",onChange:en}),Le.type===O.d.SpecialValue&&n.createElement(W.l6,{value:An.find(fn=>fn.value===Le.specialMatch),options:An,onChange:Qt})),n.createElement("td",null,n.createElement(P.p,{type:"text",value:we.text??"",onChange:_t,placeholder:"Optional display text"})),n.createElement("td",{className:Ve.textAlignCenter},we.color&&n.createElement(L.Gy,{spacing:"sm",justify:"center"},n.createElement(c.sk,{color:we.color,onChange:bt,enableNamedColors:!0}),n.createElement(y.K,{name:"times",onClick:St,tooltip:"Remove color",tooltipPlacement:"top"})),!we.color&&n.createElement(c.sk,{color:"gray",onChange:bt,enableNamedColors:!0},fn=>n.createElement(p.$n,{variant:"primary",fill:"text",onClick:fn.showColorPicker,ref:fn.ref,size:"sm"},"Set color"))),De&&n.createElement("td",{className:Ve.textAlignCenter},n.createElement(L.Gy,{spacing:"sm",justify:"center"},n.createElement(B.n,{onChange:Je,onClear:rt,value:we.icon,size:K.Iy.SMALL,folderName:K.Iu.Icon,mediaType:K.zu.Icon,color:we.color}),we.icon&&n.createElement(y.K,{name:"times",onClick:rt,tooltip:"Remove icon",tooltipPlacement:"top"}))),n.createElement("td",{className:Ve.textAlignCenter},n.createElement(L.Gy,{spacing:"sm"},n.createElement(y.K,{name:"copy",onClick:()=>be(re),"data-testid":"duplicate-value-mapping","aria-label":"Duplicate value mapping",tooltip:"Duplicate"}),n.createElement(y.K,{name:"trash-alt",onClick:()=>le(re),"data-testid":"remove-value-mapping","aria-label":"Delete value mapping",tooltip:"Delete"})))))}const _=Le=>({dragRow:(0,s.css)({position:"relative"}),dragHandle:(0,s.css)({cursor:"grab","&:focus-visible&:after":{bottom:0,content:'""',left:0,position:"absolute",right:0,top:0,outline:`2px solid ${Le.colors.primary.main}`,outlineOffset:"-2px"}}),rangeInputWrapper:(0,s.css)({display:"flex","> div:first-child":{marginRight:Le.spacing(2)}}),regexInputWrapper:(0,s.css)({display:"flex","> div:first-child":{marginRight:Le.spacing(2)}}),typeColumn:(0,s.css)({textTransform:"capitalize",textAlign:"center",width:"1%"}),textAlignCenter:(0,s.css)({textAlign:"center"})});function H({value:Le,onChange:re,onClose:X,showIconPicker:le}){const be=(0,R.of)(G),[De,Te]=(0,n.useState)([]);(0,n.useEffect)(()=>{Te(ne(Le))},[Le]);const we=Je=>{if(!Le||!Je.destination)return;const rt=[...De],Rt=rt[Je.source.index];rt.splice(Je.source.index,1),rt.splice(Je.destination.index,0,Rt),Te(rt)},Ke=(Je,rt)=>{const Rt=[...De];Rt.splice(Je,1,rt),Te(Rt)},Ve=Je=>{const rt=[...De];rt.splice(Je,1),Te(rt)},ht=[{label:"Value",value:O.d.ValueToText,description:"Match a specific text value"},{label:"Range",value:O.d.RangeToText,description:"Match a numerical range of values"},{label:"Regex",value:O.d.RegexToText,description:"Match a regular expression with replacement"},{label:"Special",value:O.d.SpecialValue,description:"Match on null, NaN, boolean and empty values"}],gt=Je=>{Te([...De,Y({type:Je.value,result:{},isNew:!0})])},bt=Je=>{const rt=oe(De[Je]),Rt=[...De];Rt.splice(Je,0,{...rt});for(let _t=Je;_t<De.length;_t++)Rt[_t].result.index=_t;Te(Rt)},St=()=>{re(se(De)),X()};return(0,n.useEffect)(()=>{Le?.length||gt({value:O.d.ValueToText})},[]),n.createElement(n.Fragment,null,n.createElement("div",{className:be.tableWrap},n.createElement("table",{className:be.editTable},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",{style:{width:"1%"}}),n.createElement("th",{style:{width:"40%",textAlign:"left"},colSpan:2},"Condition"),n.createElement("th",{style:{textAlign:"left"}},"Display text"),n.createElement("th",{style:{width:"10%"}},"Color"),le&&n.createElement("th",{style:{width:"10%"}},"Icon"),n.createElement("th",{style:{width:"1%"}}))),n.createElement(w.JY,{onDragEnd:we},n.createElement(w.gL,{droppableId:"sortable-field-mappings",direction:"vertical"},Je=>n.createElement("tbody",{ref:Je.innerRef,...Je.droppableProps},De.map((rt,Rt)=>n.createElement(V,{key:rt.id,mapping:rt,index:Rt,onChange:Ke,onRemove:Ve,onDuplicate:bt,showIconPicker:le})),Je.placeholder))))),n.createElement(F.a.ButtonRow,{leftItems:n.createElement(U.i,{label:"Add a new mapping",variant:"secondary",size:"md",icon:"plus",menuPlacement:"auto",minWidth:40,options:ht,onChange:gt})},n.createElement(p.$n,{variant:"secondary",fill:"outline",onClick:X},"Cancel"),n.createElement(p.$n,{variant:"primary",onClick:St},"Update")))}const G=Le=>({tableWrap:(0,s.css)`
    max-height: calc(80vh - 170px);
    min-height: 40px;
    overflow: auto;
  `,editTable:(0,s.css)({width:"100%",marginBottom:Le.spacing(2),"thead th":{textAlign:"center"},"tbody tr:hover":{background:Le.colors.action.hover}," th, td":{padding:Le.spacing(1)}})});function j(){return(0,h.uniqueId)("mapping-")}function Y(Le){return{type:O.d.ValueToText,result:{},id:j(),...Le}}function oe(Le){return{...Y(Le),id:j()}}function se(Le){const re=[],X={type:O.d.ValueToText,options:{}};return Le.forEach((le,be)=>{const De={...le.result,index:be};switch((!De.text||De.text.trim().length===0)&&(De.text=void 0),le.type){case O.d.ValueToText:le.key!=null&&(X.options[le.key]=De);break;case O.d.RangeToText:le.from!=null&&le.to!=null&&re.push({type:le.type,options:{from:le.from,to:le.to,result:De}});break;case O.d.RegexToText:le.pattern!=null&&re.push({type:le.type,options:{pattern:le.pattern,result:De}});break;case O.d.SpecialValue:re.push({type:le.type,options:{match:le.specialMatch,result:De}})}}),Object.keys(X.options).length>0&&re.unshift(X),re}function ne(Le){const re=[];if(Le)for(const X of Le)switch(X.type){case O.d.ValueToText:for(const le in X.options)re.push(Y({type:X.type,result:X.options[le],key:le}));break;case O.d.RangeToText:re.push(Y({type:X.type,result:X.options.result,from:X.options.from??0,to:X.options.to??0}));break;case O.d.RegexToText:re.push(Y({type:X.type,result:X.options.result,pattern:X.options.pattern}));break;case O.d.SpecialValue:re.push(Y({type:X.type,result:X.options.result,specialMatch:X.options.match??O.W.Null}))}return re.sort((X,le)=>(X.result.index??0)>(le.result.index??0)?1:-1),re}const ee=n.memo(Le=>{const{value:re,onChange:X,item:le}=Le,be=(0,R.of)(Z),De=le.settings?.icon,[Te,we]=(0,n.useState)(!1),Ke=(0,n.useCallback)(()=>{we(!1)},[we]),Ve=(0,n.useMemo)(()=>ne(re),[re]),ht=(0,n.useCallback)((bt,St)=>{Ve[St].result.color=bt,X(se(Ve))},[Ve,X]),gt=(0,n.useCallback)((bt,St)=>{Ve[St].result.icon=bt,X(se(Ve))},[Ve,X]);return n.createElement(L.gW,null,n.createElement("table",{className:be.compactTable},n.createElement("tbody",null,Ve.map((bt,St)=>n.createElement("tr",{key:St.toString()},n.createElement("td",null,bt.type===O.d.ValueToText&&bt.key,bt.type===O.d.RangeToText&&n.createElement("span",null,"[",bt.from," - ",bt.to,"]"),bt.type===O.d.RegexToText&&bt.pattern,bt.type===O.d.SpecialValue&&bt.specialMatch),n.createElement("td",null,n.createElement(N.I,{name:"arrow-right"})),n.createElement("td",null,bt.result.text),bt.result.color&&n.createElement("td",null,n.createElement(c.sk,{color:bt.result.color,onChange:Je=>ht(Je,St),enableNamedColors:!0})),De&&bt.result.icon&&n.createElement("td",{"data-testid":"iconPicker"},n.createElement(B.n,{onChange:Je=>gt(Je,St),value:bt.result.icon,size:K.Iy.SMALL,folderName:K.Iu.Icon,mediaType:K.zu.Icon,color:bt.result.color})))))),n.createElement(p.$n,{variant:"secondary",size:"sm",fullWidth:!0,onClick:()=>we(!0)},Ve.length>0&&n.createElement("span",null,"Edit value mappings"),Ve.length===0&&n.createElement("span",null,"Add value mappings")),n.createElement(F.a,{isOpen:Te,title:"Value mappings",onDismiss:Ke,className:be.modal,closeOnBackdropClick:!1},n.createElement(H,{value:re,onChange:X,onClose:Ke,showIconPicker:De})))});ee.displayName="ValueMappingsEditor";const Z=Le=>({modal:(0,s.css)({width:"980px"}),compactTable:(0,s.css)({width:"100%","tbody td":{padding:Le.spacing(.5)}})});var z=e(59429);const q=({value:Le,onChange:re,item:X})=>{const{placeholder:le,isClearable:be}=X?.settings??{},De=(0,n.useCallback)(Te=>{re(Te?.value?.uid)},[re]);return n.createElement(z.b,{isClearable:be,defaultOptions:!0,onChange:De,placeholder:le,value:Le})};var ie=e(77268),de=e(8066),ue=e(24293),fe=e(88575);const Se=({value:Le,onChange:re,item:X,id:le})=>{const be=(0,R.$j)(),De=(0,R.of)(ce),Te=(0,de.Hs)(Le?.mode),Ke=(X.settings?.byValueSupport?de.uf.list():de.uf.list().filter(St=>!St.isByValue)).filter(St=>!St.excludeFromPicker).map(St=>{let Je=St.isByValue?" (by value)":"";return{value:St.id,label:`${St.name}${Je}`,description:St.description,isContinuous:St.isContinuous,isByValue:St.isByValue,component(){return n.createElement(he,{mode:St,theme:be})}}}),Ve=St=>{re({...Le,mode:St.value})},ht=St=>{re({...Le,mode:bt,fixedColor:St})},gt=St=>{re({...Le,mode:bt,seriesBy:St})},bt=Le?.mode??ue.Y.Thresholds;if(bt===ue.Y.Fixed||bt===ue.Y.Shades)return n.createElement("div",{className:De.group},n.createElement(W.l6,{minMenuHeight:200,options:Ke,value:bt,onChange:Ve,className:De.select,inputId:le}),n.createElement(ie.a,{value:Le?.fixedColor,onChange:ht}));if(X.settings?.bySeriesSupport&&Te.isByValue){const St=[{label:"Last",value:"last"},{label:"Min",value:"min"},{label:"Max",value:"max"}];return n.createElement(n.Fragment,null,n.createElement("div",{style:{marginBottom:be.spacing(2)}},n.createElement(W.l6,{minMenuHeight:200,options:Ke,value:bt,onChange:Ve,inputId:le})),n.createElement(fe.D,{label:"Color series by"},n.createElement(d.z,{value:Le?.seriesBy??"last",options:St,onChange:gt})))}return n.createElement(W.l6,{minMenuHeight:200,options:Ke,value:bt,onChange:Ve,inputId:le})},he=({mode:Le,theme:re})=>{if(!Le.getColors)return null;const X=Le.getColors(re).map(re.visualization.getColorByName),le={height:"8px",width:"100%",margin:"2px 0",borderRadius:"3px",opacity:1};if(Le.isContinuous)le.background=`linear-gradient(90deg, ${X.join(",")})`;else{let be="",De="";for(let Te=0;Te<X.length;Te++){const we=X[Te];if(be==="")be=`linear-gradient(90deg, ${we} 0%`;else{const Ve=Te/(X.length-1)*100;be+=`, ${De} ${Ve}%, ${we} ${Ve}%`}De=we}le.background=be}return n.createElement("div",{style:le})},ce=Le=>({group:(0,s.css)({display:"flex"}),select:(0,s.css)({marginRight:Le.spacing(1),flexGrow:1})});var me=e(91890),pe=e(64919);const ye=({value:Le,onChange:re,context:X})=>n.createElement(pe.e,{links:Le,onChange:re,data:X.data,getSuggestions:()=>X.getSuggestions?X.getSuggestions(me.uP.Values):[]});class Pe extends n.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:re}=this.props,{settings:X}=re;let le=re.settings?.options||[];X?.getOptions&&(le=await X.getOptions(this.props.context)),this.state.options!==le&&this.setState({isLoading:!1,options:le})}}componentDidMount(){this.updateOptions()}componentDidUpdate(re){const X=re.item?.settings,le=this.props.item?.settings;if(X!==le)this.updateOptions();else if(le?.getOptions){const be=re.context?.data,De=this.props.context?.data;be!==De&&this.updateOptions()}}render(){const{options:re,isLoading:X}=this.state,{value:le,onChange:be,item:De}=this.props,{settings:Te}=De;return n.createElement(W.KF,{isLoading:X,value:le,defaultValue:le,allowCustomValue:Te?.allowCustomValue,onChange:we=>{be(we.map(Ke=>Ke.value).flatMap(Ke=>Ke!==void 0?[Ke]:[]))},options:re})}}var Ie=e(72626);class Oe extends n.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:re}=this.props,{settings:X}=re;let le=re.settings?.options||[];X?.getOptions&&(le=await X.getOptions(this.props.context)),this.state.options!==le&&this.setState({isLoading:!1,options:le})}}componentDidMount(){this.updateOptions()}componentDidUpdate(re){const X=re.item?.settings,le=this.props.item?.settings;if(X!==le)this.updateOptions();else if(le?.getOptions){const be=re.context?.data,De=this.props.context?.data;be!==De&&this.updateOptions()}}render(){const{options:re,isLoading:X}=this.state,{value:le,onChange:be,item:De}=this.props,{settings:Te}=De;let we=re.find(Ke=>Ke.value===le);return!we&&le&&(we={label:`${le}`,value:le}),n.createElement(W.l6,{isLoading:X,value:we,defaultValue:le,allowCustomValue:Te?.allowCustomValue,isClearable:Te?.isClearable,onChange:Ke=>be(Ke?.value),options:re})}}var Ne=e(57602),We=e(42734);const Ae=({value:Le,onChange:re,item:X,id:le})=>n.createElement(We.S,{stats:Le,onChange:re,allowMultiple:!!X.settings?.allowMultiple,defaultStat:X.settings?.defaultStat,inputId:le});var Ue=e(29286),Me=e(32264);class $e extends n.PureComponent{constructor(){super(...arguments),this.state={showAdd:!1},this.onRemoveString=re=>{const{value:X,onChange:le}=this.props,be=[...X];be.splice(re,1),le(be)},this.onValueChange=(re,X)=>{if("key"in re&&re.key!=="Enter")return;const{value:le,onChange:be}=this.props,De=re.currentTarget.value.trim();if(X<0){De&&(re.currentTarget.value="",be([...le,De])),this.setState({showAdd:!1});return}if(!De)return this.onRemoveString(X);const Te=[...le];Te[X]=De,be(Te)}}render(){const{value:re,item:X}=this.props,{showAdd:le}=this.state,be=ke(Me.$.theme2),De=X.settings?.placeholder||"Add text";return n.createElement("div",null,re.map((Te,we)=>n.createElement(P.p,{className:be.textInput,key:`${we}/${Te}`,defaultValue:Te||"",onBlur:Ke=>this.onValueChange(Ke,we),onKeyDown:Ke=>this.onValueChange(Ke,we),suffix:n.createElement(N.I,{className:be.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveString(we)})})),le?n.createElement(P.p,{autoFocus:!0,className:be.textInput,placeholder:De,defaultValue:"",onBlur:Te=>this.onValueChange(Te,-1),onKeyDown:Te=>this.onValueChange(Te,-1),suffix:n.createElement(N.I,{name:"plus-circle"})}):n.createElement(p.$n,{icon:"plus",size:"sm",variant:"secondary",onClick:()=>this.setState({showAdd:!0})},De))}}const ke=(0,D.N)(Le=>({textInput:(0,s.css)({marginBottom:"5px","&:hover":{border:`1px solid ${Le.components.input.borderHover}`}}),trashIcon:(0,s.css)({color:Le.colors.text.secondary,cursor:"pointer","&:hover":{color:Le.colors.text.primary}})}));var Ze=e(2056);function ot({value:Le,onChange:re,item:X}){const le=(0,R.of)(xt);return X?.settings?.isClearable&&Le!=null?n.createElement("div",{className:le.wrapper},n.createElement("span",{className:le.first},n.createElement(Ze.p,{value:Le,onChange:re})),n.createElement(y.K,{name:"times",onClick:()=>re(void 0),tooltip:"Clear unit selection"})):n.createElement(Ze.p,{value:Le,onChange:re})}const xt=Le=>({wrapper:(0,s.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center"}),first:(0,s.css)({marginRight:Le.spacing(1),flexGrow:2})}),ct=()=>{const Le={id:"number",name:"Number",description:"Allows numeric values input",editor:Ie.w},re={id:"slider",name:"Slider",description:"Allows numeric values input",editor:Ne.G},X={id:"text",name:"Text",description:"Allows string values input",editor:Ue.g},le={id:"strings",name:"String array",description:"An array of strings",editor:$e},be={id:"boolean",name:"Boolean",description:"Allows boolean values input",editor(nn){const{id:Kt,...en}=nn;return n.createElement(f.d,{...en,onChange:Qt=>nn.onChange(Qt.currentTarget.checked)})}},De={id:"select",name:"Select",description:"Allows option selection",editor:Oe},Te={id:"multi-select",name:"Multi select",description:"Allows for multiple option selection",editor:Pe},we={id:"radio",name:"Radio",description:"Allows option selection",editor(nn){return n.createElement(d.z,{...nn,options:nn.item.settings?.options})}},Ke={id:"unit",name:"Unit",description:"Allows unit input",editor:ot},Ve={id:"color",name:"Color",description:"Allows color selection",editor(nn){return n.createElement(ie.a,{value:nn.value,onChange:nn.onChange,settings:nn.item.settings,details:!0})}},ht={id:"fieldColor",name:"Field Color",description:"Field color selection",editor:Se},gt={id:"links",name:"Links",description:"Allows defining data links",editor:ye},bt={id:"stats-picker",name:"Stats Picker",editor:Ae,description:""},St={id:"timezone",name:"Time zone",description:"Time zone selection",editor:l.U},Je={id:"field-name",name:"Field name",description:"Allows selecting a field name from a data frame",editor:m.O};return[X,Le,re,be,we,De,Ke,gt,bt,le,St,ht,Ve,Te,Je,{id:"dashboard-uid",name:"Dashboard",description:"Select dashboard",editor:q},{id:"mappings",name:"Mappings",description:"Allows defining value mappings",editor:ee},{id:"thresholds",name:"Thresholds",description:"Allows defining thresholds",editor:C}]},ft=()=>{const Le=["Standard options"],re={id:"displayName",path:"displayName",name:"Display name",description:"Change the field or series name",editor:a.D.get("text").editor,override:a.D.get("text").editor,process:o.AM,settings:{placeholder:"none",expandTemplateVars:!0},shouldApply:()=>!0,category:Le},X={id:"unit",path:"unit",name:"Unit",description:"",editor:a.D.get("unit").editor,override:a.D.get("unit").editor,process:o.OU,settings:{placeholder:"none"},shouldApply:()=>!0,category:Le},le={id:"fieldMinMax",path:"fieldMinMax",name:"Field min/max",description:"Calculate min max per field",editor:a.D.get("boolean").editor,override:a.D.get("boolean").editor,process:o.FM,shouldApply:St=>St.type===r.PU.number,showIf:St=>St.min===void 0||St.max===void 0,category:Le},be={id:"min",path:"min",name:"Min",description:"Leave empty to calculate based on all values",editor:a.D.get("number").editor,override:a.D.get("number").editor,process:o.m0,settings:{placeholder:"auto"},shouldApply:St=>St.type===r.PU.number,category:Le},De={id:"max",path:"max",name:"Max",description:"Leave empty to calculate based on all values",editor:a.D.get("number").editor,override:a.D.get("number").editor,process:o.m0,settings:{placeholder:"auto"},shouldApply:St=>St.type===r.PU.number,category:Le},Te={id:"decimals",path:"decimals",name:"Decimals",editor:a.D.get("number").editor,override:a.D.get("number").editor,process:o.m0,settings:{placeholder:"auto",min:0,max:15,integer:!0},shouldApply:St=>St.type===r.PU.number,category:Le},we={id:"noValue",path:"noValue",name:"No value",description:"What to show when there is no value",editor:a.D.get("text").editor,override:a.D.get("text").editor,process:o.OU,settings:{placeholder:"-"},shouldApply:()=>!0,category:Le},Ke={id:"links",path:"links",name:"Data links",editor:a.D.get("links").editor,override:a.D.get("links").editor,process:o.Ch,settings:{placeholder:"-"},shouldApply:()=>!0,category:["Data links"],getItemsCount:St=>St?St.length:0},Ve={id:"color",path:"color",name:"Color scheme",editor:a.D.get("fieldColor").editor,override:a.D.get("fieldColor").editor,process:o.hS,shouldApply:()=>!0,settings:{byValueSupport:!0,preferThresholdsMode:!0},category:Le},ht={id:"mappings",path:"mappings",name:"Value mappings",description:"Modify the display text based on input value",editor:a.D.get("mappings").editor,override:a.D.get("mappings").editor,process:o.xT,settings:{},defaultValue:[],shouldApply:St=>St.type!==r.PU.time,category:["Value mappings"],getItemsCount:St=>St?St.length:0},gt={id:"thresholds",path:"thresholds",name:"Thresholds",editor:a.D.get("thresholds").editor,override:a.D.get("thresholds").editor,process:o.N7,settings:{},defaultValue:{mode:i.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]},shouldApply:()=>!0,category:["Thresholds"],getItemsCount:St=>St?St.steps.length:0},bt={id:"filterable",path:"filterable",name:"Ad-hoc filterable",hideFromDefaults:!0,editor:a.D.get("boolean").editor,override:a.D.get("boolean").editor,process:o.FM,shouldApply:()=>!0,settings:{},category:Le};return[X,be,De,le,Te,re,Ve,we,Ke,ht,gt,bt]}},57602:(Q,I,e)=>{"use strict";e.d(I,{G:()=>l});var n=e(32196),a=e(94659),o=e(9821),r=e(96540),i=e(40845),f=e(24849),d=e(60188);const l=({value:h,onChange:u,item:b})=>{const g=(0,r.useRef)(null),{settings:P}=b,c=P?.min||0,y=P?.max||100,p=P?.step,v=P?.marks||{[c]:c,[y]:y},D=P?.included,E=P?.ariaLabelForHandle,S=75,T=!0,M=(0,i.$j)(),[A,x]=(0,r.useState)(h??c),[C,O]=(0,r.useState)(S);(0,r.useEffect)(()=>{h!=null&&h!==A&&x(h)},[h,A]),(0,r.useEffect)(()=>{const B=getComputedStyle(g.current),w=B.getPropertyValue("font-weight")||"normal",U=B.getPropertyValue("font-size")||"16px",W=B.getPropertyValue("font-family")||"Arial",V="0",_=4,H=8,G=Math.max((y+(p||0)).toString().length,(y-(p||0)).toString().length)+_,j=V.repeat(G),Y=m(j,`${w} ${U} ${W}`);Y&&O(Y+H*2)},[y,p]);const R=(0,r.useCallback)(B=>{const w=typeof B=="number"?B:B[0];x(w),u&&u(w)},[x,u]),L=(0,r.useCallback)(B=>{let w=B;(Number.isNaN(w)||!w)&&(w=0),x(w),u&&u(w)},[u]),N=(0,f.$)(M,T,!!v),F=s(M,C),K=T?[]:[N.sliderInputVertical];return r.createElement("div",{className:(0,n.cx)(N.container,N.slider)},r.createElement(a.Global,{styles:N.slider}),r.createElement("div",{className:(0,n.cx)(N.sliderInput,...K)},r.createElement(o.A,{min:c,max:y,step:p,defaultValue:h,value:A,onChange:R,vertical:!T,reverse:!1,ariaLabelForHandle:E,marks:v,included:D}),r.createElement("span",{className:F.numberInputWrapper,ref:g},r.createElement(d.Q,{value:A,onChange:L,max:y,min:c,step:p}))))};function m(h,u){const g=document.createElement("canvas").getContext("2d");return g?(g.font=u,g.measureText(h).width):null}const s=(h,u)=>({numberInputWrapper:(0,n.css)({marginLeft:h.spacing(3),maxHeight:"32px",maxWidth:u,minWidth:u,overflow:"visible",width:"100%"})})},29286:(Q,I,e)=>{"use strict";e.d(I,{g:()=>r});var n=e(96540),a=e(21744),o=e(10354);const r=({value:i,onChange:f,item:d,suffix:l})=>{const m=d.settings?.useTextarea?a.f:o.p,s=(0,n.useCallback)(h=>{let u=i??"";"key"in h?h.key==="Enter"&&!d.settings?.useTextarea&&(u=h.currentTarget.value.trim()):u=h.currentTarget.value.trim(),u!==i&&f(u===""?void 0:u)},[i,d.settings?.useTextarea,f]);return n.createElement(m,{placeholder:d.settings?.placeholder,defaultValue:i||"",rows:d.settings?.useTextarea&&d.settings.rows||5,onBlur:s,onKeyDown:s,suffix:l})}},67608:(Q,I,e)=>{"use strict";e.d(I,{Y:()=>V});var n=e(32196),a=e(96540),o=e(64388),r=e(40845),i=e(76888),f=e(32264),d=e(40276);function l(H){return f.$.featureToggles.betterPageScrolling?a.createElement(m,{...H},H.children):a.createElement(d.E,{...H})}function m({children:H,scrollRefCallback:G,scrollTop:j,divId:Y}){const oe=(0,r.of)(s),se=(0,a.useRef)(null);return(0,a.useEffect)(()=>{se.current&&G&&G(se.current)},[se,G]),(0,a.useEffect)(()=>{se.current&&j!=null&&se.current?.scrollTo(0,j)},[j]),a.createElement("div",{ref:se,className:(0,n.cx)(oe.nativeScrollbars,"scrollbar-view"),id:Y},H)}function s(){return{nativeScrollbars:(0,n.css)({label:"native-scroll-container",minHeight:"calc(100% + 0px)",maxHeight:"calc(100% + 0px)",display:"flex",flexDirection:"column",flexGrow:1,overflow:"auto"})}}var h=e(39419);const u=({isLoading:H,children:G,className:j})=>{let Y=j?a.createElement("div",{className:j},G):G;return a.createElement(a.Fragment,null,H?a.createElement(h.A,null):Y)};var b=e(13773),g=e(17172),P=e(94753),c=e(29158),y=e(88575),p=e(10354);const v=({value:H,onEdit:G})=>{const j=(0,r.of)(D),[Y,oe]=(0,a.useState)(H),[se,ne]=(0,a.useState)(!1),[ee,Z]=(0,a.useState)(!1),[z,q]=(0,a.useState)();(0,a.useEffect)(()=>{oe(H)},[H]);const ie=(0,a.useCallback)(async de=>{const ue=de.currentTarget.value;if(!ue)q("Please enter a title");else if(ue===H)q(void 0),ne(!1);else{Z(!0);try{await G(ue),q(void 0),ne(!1)}catch(fe){(0,g.NF)(fe)?q(fe.data.message):fe instanceof Error&&q(fe.message)}Z(!1)}},[G,H]);return se?a.createElement("div",{className:j.inputContainer},a.createElement(y.D,{className:j.field,loading:ee,invalid:!!z,error:z},a.createElement(p.p,{className:j.input,defaultValue:Y,onKeyDown:de=>{de.key==="Enter"&&ie(de)},autoFocus:!0,onBlur:ie,onChange:de=>oe(de.currentTarget.value),onFocus:()=>ne(!0)}))):a.createElement("div",{className:j.textContainer},a.createElement("div",{className:j.textWrapper},a.createElement(P.E,{element:"h1",truncate:!0},Y),a.createElement(c.K,{name:"pen",size:"lg",tooltip:"Edit title",onClick:()=>ne(!0)})))};v.displayName="EditableTitle";const D=H=>({textContainer:(0,n.css)({minWidth:0}),field:(0,n.css)({flex:1,left:`calc(-${H.spacing(1)} - 1px)`,position:"relative",marginBottom:0}),input:(0,n.css)({input:{...H.typography.h1}}),inputContainer:(0,n.css)({display:"flex",flex:1}),textWrapper:(0,n.css)({alignItems:"center",display:"flex",gap:H.spacing(1)})});function E({navItem:H,renderTitle:G,actions:j,info:Y,subTitle:oe,onEditTitle:se}){const ne=(0,r.of)(S),ee=oe??H.subTitle,Z=se?a.createElement(v,{value:H.text,onEdit:se}):a.createElement("div",{className:ne.title},H.img&&a.createElement("img",{className:ne.img,src:H.img,alt:`logo for ${H.text}`}),G?G(H.text):a.createElement("h1",null,H.text));return a.createElement("div",{className:ne.pageHeader},a.createElement("div",{className:ne.topRow},a.createElement("div",{className:ne.titleInfoContainer},Z,Y&&a.createElement(b.Q,{info:Y})),a.createElement("div",{className:ne.actions},j)),ee&&a.createElement("div",{className:ne.subTitle},ee))}const S=H=>({topRow:(0,n.css)({alignItems:"flex-start",display:"flex",flexDirection:"row",flexWrap:"wrap",gap:H.spacing(1,3)}),title:(0,n.css)({display:"flex",flexDirection:"row",maxWidth:"100%",h1:{display:"flex",marginBottom:0}}),actions:(0,n.css)({display:"flex",flexDirection:"row",gap:H.spacing(1)}),titleInfoContainer:(0,n.css)({display:"flex",label:"title-info-container",flex:1,flexWrap:"wrap",gap:H.spacing(1,4),justifyContent:"space-between",maxWidth:"100%",minWidth:"200px"}),pageHeader:(0,n.css)({label:"page-header",display:"flex",flexDirection:"column",gap:H.spacing(1),marginBottom:H.spacing(2)}),subTitle:(0,n.css)({position:"relative",color:H.colors.text.secondary}),img:(0,n.css)({width:"32px",height:"32px",marginRight:H.spacing(2)})});var T=e(63021),M=e(8984),A=e(40675);function x({navItem:H}){const G=(0,r.of)(C);return a.createElement("div",{className:G.tabsWrapper},a.createElement(T.U,null,H.children.map((j,Y)=>{const oe=j.icon?(0,M.toIconName)(j.icon):void 0;return!j.hideFromTabs&&a.createElement(A.o,{label:j.text,active:j.active,key:`${j.url}-${Y}`,icon:oe,counter:j.tabCounter,href:j.url,suffix:j.tabSuffix,onChangeTab:j.onClick})})))}const C=H=>({tabsWrapper:(0,n.css)({paddingBottom:H.spacing(3)})});var O=e(25508),R=e(17422),L=e(99140),N=e(31678);function F(H,G){if(G)return G;if(H&&L.M_)return(0,N.useSelector)((0,O.Mz)(K,j=>(0,R.tc)(j,H??"home")))}function K(H){return H.navIndex}var B=e(28215),w=e(19361),U=e(3984);function W(H,G){const j=(0,N.useSelector)(Y=>Y.navIndex)?.[B.Id];(0,a.useEffect)(()=>{const Y=(H?.node!==H?.main?H?.node:H?.main)??{text:"Grafana"},oe=(0,U.Z)(Y,G,j).map(se=>se.text).reverse();oe[oe.length-1]=w.M.AppTitle,document.title=oe.join(" - ")},[j,H,G])}const V=({navId:H,navModel:G,pageNav:j,renderTitle:Y,onEditTitle:oe,actions:se,subTitle:ne,children:ee,className:Z,info:z,layout:q=o.k.Standard,scrollTop:ie,scrollRef:de,...ue})=>{const fe=(0,r.of)(_),Se=F(H,G),{chrome:he}=(0,i.Il)();W(Se,j);const ce=j??Se?.node;return(0,a.useLayoutEffect)(()=>{Se&&he.update({sectionNav:Se,pageNav:j,layout:q})},[Se,j,he,q]),a.createElement("div",{className:(0,n.cx)(fe.wrapper,Z),...ue},q===o.k.Standard&&a.createElement(l,{divId:"page-scrollbar",autoHeightMin:"100%",scrollTop:ie,scrollRefCallback:de},a.createElement("div",{className:fe.pageInner},ce&&a.createElement(E,{actions:se,onEditTitle:oe,navItem:ce,renderTitle:Y,info:z,subTitle:ne}),j&&j.children&&a.createElement(x,{navItem:j}),a.createElement("div",{className:fe.pageContent},ee))),q===o.k.Canvas&&a.createElement(l,{divId:"page-scrollbar",autoHeightMin:"100%",scrollTop:ie,scrollRefCallback:de},a.createElement("div",{className:fe.canvasContent},ee)),q===o.k.Custom&&ee)};V.Contents=u;const _=H=>({wrapper:(0,n.css)({label:"page-wrapper",height:"100%",display:"flex",flex:"1 1 0",flexDirection:"column",minHeight:0}),pageContent:(0,n.css)({label:"page-content",flexGrow:1}),primaryBg:(0,n.css)({background:H.colors.background.primary}),pageInner:(0,n.css)({label:"page-inner",padding:H.spacing(2),borderBottom:"none",background:H.colors.background.primary,display:"flex",flexDirection:"column",flexGrow:1,margin:H.spacing(0,0,0,0),[H.breakpoints.up("md")]:{padding:H.spacing(4)}}),canvasContent:(0,n.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:H.spacing(2),flexBasis:"100%",flexGrow:1})})},13773:(Q,I,e)=>{"use strict";e.d(I,{Q:()=>r});var n=e(32196),a=e(96540),o=e(40845);function r({info:f}){const d=(0,o.of)(i);return a.createElement("div",{className:d.container},f.map((l,m)=>a.createElement(a.Fragment,{key:m},a.createElement("div",{className:d.infoItem},a.createElement("div",{className:d.label},l.label),l.value),m+1<f.length&&a.createElement("div",{"data-testid":"page-info-separator",className:d.separator}))))}const i=f=>({container:(0,n.css)({display:"flex",flexDirection:"row",gap:f.spacing(1.5),overflow:"auto"}),infoItem:(0,n.css)({...f.typography.bodySmall,display:"flex",flexDirection:"column",gap:f.spacing(.5)}),label:(0,n.css)({color:f.colors.text.secondary}),separator:(0,n.css)({borderLeft:`1px solid ${f.colors.border.weak}`})})},39419:(Q,I,e)=>{"use strict";e.d(I,{A:()=>i});var n=e(96540),a=e(90613),o=e(39558);const i=({pageName:f=""})=>{const d=`Loading ${f}...`;return n.createElement(a.a,{display:"flex",alignItems:"center",direction:"column",justifyContent:"center",paddingTop:10},n.createElement(o._,{text:d}))}},7392:(Q,I,e)=>{"use strict";e.d(I,{L:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(69529),i=e(72109);function f({entity:l="Page"}){const m=(0,o.of)(d);return a.createElement("div",{className:m.container},a.createElement(r.p,{message:`${l} not found`,variant:"not-found"},"We're looking but can't seem to find this ",l.toLowerCase(),". Try returning"," ",a.createElement(i.Y,{href:"/"},"home")," or seeking help on the"," ",a.createElement(i.Y,{href:"https://community.grafana.com",external:!0},"community site.")))}function d(l){return{container:(0,n.css)({padding:l.spacing(8,2,2,2)})}}},68313:(Q,I,e)=>{"use strict";e.d(I,{$:()=>m});var n=e(32196),a=e(96540),o=e(32264),r=e(40845),i=e(55852),f=e(21594),d=e(14578),l=e(17706);const m=({onChange:h,maxMenuHeight:u,isWidget:b=!1})=>{const g=()=>o.$.featureToggles.vizAndWidgetSplit?b?(0,l.nr)():(0,l.if)():(0,l.A4)(),P=(0,a.useMemo)(g,[b]),c=(0,a.useMemo)(()=>P.map(S=>({label:S.name,imgUrl:S.info.logos.small,value:S})).sort((S,T)=>S.label?.localeCompare(T.label)),[P]),[y,p]=(0,a.useState)([]),v=(0,a.useCallback)(S=>{const T=S.filter(M=>M.value).map(M=>M.value);h(T),p(S)},[h]),D=(0,r.of)(s),E={defaultOptions:!0,getOptionLabel:S=>S.label,getOptionValue:S=>S.value,noOptionsMessage:"No Panel types found",placeholder:"Filter by type",maxMenuHeight:u,options:c,value:y,onChange:v};return a.createElement("div",{className:D.container},y.length>0&&a.createElement(i.$n,{size:"xs",icon:"trash-alt",fill:"text",className:D.clear,onClick:()=>v([]),"aria-label":"Clear types"},"Clear types"),a.createElement(f.KF,{...E,prefix:a.createElement(d.I,{name:"filter"}),"aria-label":"Panel Type filter"}))};function s(h){return{container:(0,n.css)`
      label: container;
      position: relative;
      min-width: 180px;
      flex-grow: 1;
    `,clear:(0,n.css)`
      label: clear;
      font-size: ${h.spacing(1.5)};
      position: absolute;
      top: -${h.spacing(4.5)};
      right: 0;
    `}}},78361:(Q,I,e)=>{"use strict";e.d(I,{s:()=>i});var n=e(96540),a=e(13544),o=e(10354),r=e(29158);const i=n.forwardRef((f,d)=>{const[l,m]=(0,n.useState)(!1);return n.createElement(o.p,{...f,type:l?"text":"password","data-testid":a.Tp.pages.Login.password,ref:d,suffix:n.createElement(r.K,{name:l?"eye-slash":"eye","aria-controls":f.id,role:"switch","aria-checked":l,onClick:()=>{m(!l)},tooltip:l?"Hide password":"Show password"})})});i.displayName="PasswordField"},22214:(Q,I,e)=>{"use strict";e.d(I,{j:()=>i});var n=e(32196),a=e(96540),o=e(36663),r=e(40845);const i=a.memo(a.forwardRef(({className:l,children:m,markdown:s,styleOverrides:h,onRemove:u,...b},g)=>{const P=(0,r.of)(c=>d(c,h?.borderTop));return a.createElement("div",{className:(0,n.cx)(P.wrapper,l),...b,ref:g},s&&f(s),m)}));function f(l){const m=(0,o.G)(l);return a.createElement("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:m}})}i.displayName="OperationRowHelp";const d=(l,m)=>{const s=l.shape.radius.default,h=l.colors.background.secondary;return{wrapper:(0,n.css)`
      padding: ${l.spacing(2)};
      border: 2px solid ${h};
      border-top: ${m?m+h:"none"};
      border-radius: 0 0 ${s} ${s};
      position: relative;
      top: -4px;
    `}}},10343:(Q,I,e)=>{"use strict";e.d(I,{A:()=>l,q:()=>d});var n=e(32196),a=e(96540),o=e(13544),r=e(40845),i=e(29158);function f(s){const h=(0,r.of)(m);return a.createElement("div",{className:(0,n.cx)(h.icon,"active"in s&&s.active&&h.active)},a.createElement(i.K,{name:s.icon,tooltip:s.title,className:h.icon,disabled:!!s.disabled,onClick:s.onClick,type:"button","data-testid":s.dataTestId??o.Tp.components.QueryEditorRow.actionButton(s.title),..."active"in s&&{"aria-pressed":s.active}}))}function d(s){return a.createElement(f,{...s})}const l=s=>a.createElement(f,{...s}),m=s=>({icon:(0,n.css)({display:"flex",position:"relative",color:s.colors.text.secondary}),active:(0,n.css)({"&:before":{display:"block",content:'" "',position:"absolute",left:-1,right:2,height:3,borderRadius:s.shape.radius.default,bottom:-8,backgroundImage:s.colors.gradients.brandHorizontal}})})},7788:(Q,I,e)=>{"use strict";e.d(I,{u:()=>g});var n=e(32196),a=e(96540),o=e(75494),r=e(22589),i=e(14110),f=e(40845),d=e(67892),l=e(29158),m=e(67061),s=e(14578),h=e(8484);const u=({actionsElement:c,disabled:y,draggable:p,collapsable:v=!0,dragHandleProps:D,headerElement:E,isContentVisible:S,onRowToggle:T,reportDragMousePosition:M,title:A,id:x,expanderMessages:C})=>{const O=(0,f.of)(b);let R=S?(0,h.t)("query-operation.header.collapse-row","Collapse query row"):(0,h.t)("query-operation.header.expand-row","Expand query row");C!==void 0&&S?R=C.close:C!==void 0&&(R=C?.open);const L=(0,h.t)("query-operation.header.drag-and-drop","Drag and drop to reorder");return a.createElement("div",{className:O.header},a.createElement("div",{className:O.column},v&&a.createElement(l.K,{name:S?"angle-down":"angle-right",tooltip:R,className:O.collapseIcon,onClick:T,"aria-expanded":S,"aria-controls":x}),A&&a.createElement("div",{className:O.titleWrapper,onClick:T,"aria-label":"Query operation row title"},a.createElement("div",{className:(0,n.cx)(O.title,y&&O.disabled)},A)),E),a.createElement(m.B,{gap:1,alignItems:"center"},c,p&&a.createElement("div",{onMouseMove:M,...D},a.createElement(s.I,{title:L,name:"draggabledots",size:"lg",className:O.dragIcon}))))},b=c=>({header:(0,n.css)`
    label: Header;
    padding: ${c.spacing(.5,.5)};
    border-radius: ${c.shape.radius.default};
    background: ${c.colors.background.secondary};
    min-height: ${c.spacing(4)};
    display: grid;
    grid-template-columns: minmax(100px, max-content) min-content;
    align-items: center;
    justify-content: space-between;
    white-space: nowrap;

    &:focus {
      outline: none;
    }
  `,column:(0,n.css)`
    label: Column;
    display: flex;
    align-items: center;
  `,dragIcon:(0,n.css)`
    cursor: grab;
    color: ${c.colors.text.disabled};
    margin: ${c.spacing(0,.5)};
    &:hover {
      color: ${c.colors.text};
    }
  `,collapseIcon:(0,n.css)`
    margin-left: ${c.spacing(.5)};
    color: ${c.colors.text.disabled};
    }
  `,titleWrapper:(0,n.css)`
    display: flex;
    align-items: center;
    flex-grow: 1;
    cursor: pointer;
    overflow: hidden;
    margin-right: ${c.spacing(.5)};
  `,title:(0,n.css)`
    font-weight: ${c.typography.fontWeightBold};
    color: ${c.colors.text.link};
    margin-left: ${c.spacing(.5)};
    overflow: hidden;
    text-overflow: ellipsis;
  `,disabled:(0,n.css)`
    color: ${c.colors.text.disabled};
  `});u.displayName="QueryOperationRowHeader";function g({children:c,actions:y,title:p,headerElement:v,onClose:D,onOpen:E,isOpen:S,disabled:T,draggable:M,collapsable:A,index:x,id:C,expanderMessages:O}){const[R,L]=(0,a.useState)(S!==void 0?S:!0),N=(0,f.of)(P),F=(0,a.useCallback)(()=>{L(!R)},[R,L]);(0,a.useEffect)(()=>{typeof S=="boolean"&&L(S)},[S]);const K=(0,a.useCallback)(W=>{if(W.defaultPrevented){const V=W.currentTarget.getBoundingClientRect(),_=W.clientX-V.left,H=W.clientY-V.top;(0,i.rR)("query_row_reorder_drag_position",{x:_/V.width,y:H/V.height,width:V.width,height:V.height})}},[]);(0,r.A)(()=>{R?E&&E():D&&D()},[R]);const B={isOpen:R,onOpen:()=>{L(!0)},onClose:()=>{L(!1)}},w=y&&d.renderOrCallToRender(y,B),U=v&&d.renderOrCallToRender(v,B);return M?a.createElement(o.sx,{draggableId:C,index:x},W=>a.createElement(a.Fragment,null,a.createElement("div",{ref:W.innerRef,className:N.wrapper,...W.draggableProps},a.createElement("div",null,a.createElement(u,{id:C,actionsElement:w,disabled:T,draggable:!0,collapsable:A,dragHandleProps:W.dragHandleProps,headerElement:U,isContentVisible:R,onRowToggle:F,reportDragMousePosition:K,title:p,expanderMessages:O})),R&&a.createElement("div",{className:N.content},c)))):a.createElement("div",{className:N.wrapper},a.createElement(u,{id:C,actionsElement:w,disabled:T,draggable:!1,collapsable:A,headerElement:U,isContentVisible:R,onRowToggle:F,reportDragMousePosition:K,title:p,expanderMessages:O}),R&&a.createElement("div",{className:N.content},c))}const P=c=>({wrapper:(0,n.css)`
      margin-bottom: ${c.spacing(2)};
    `,content:(0,n.css)`
      margin-top: ${c.spacing(.5)};
      margin-left: ${c.spacing(3)};
    `});g.displayName="QueryOperationRow"},37425:(Q,I,e)=>{"use strict";e.d(I,{n:()=>Se});var n=e(96540),a=e(40845),o=e(8866),r=e(17464),i=e(32196),f=e(62930),d=e(14578),l=e(56034),m=e(10354),s=e(87266),h=e(16797),u=e(88824);const b=(0,n.forwardRef)(({children:he,iconName:ce},me)=>{const pe=(0,a.of)(g);return n.createElement("div",{className:pe.container,ref:me},ce&&n.createElement(d.I,{name:ce,size:"xs"}),he)});b.displayName="ValueContainer";const g=he=>{const{prefix:ce}=(0,m.n)({theme:he}),{multiValueContainer:me}=(0,u.J)(he);return{container:(0,i.cx)(ce,me,(0,i.css)`
        position: relative;
        padding: ${he.spacing(.5,1,.5,1)};

        svg {
          margin-right: ${he.spacing(.5)};
        }
      `)}},P=360,c=300,y=320,p=360,v=320,D=360,E=p+D,S=he=>he.stopPropagation(),T=({appliedRoles:he,basicRole:ce,disabled:me,isFocused:pe,query:ye,showBasicRole:Pe,width:Ie,isLoading:Oe,onOpen:Ne,onClose:We,onQueryChange:Ae,...Ue})=>{const Me=(0,a.of)(A,!1,!!pe,!!me,!1,Ie),$e=(0,n.useRef)(null);(0,n.useEffect)(()=>{pe&&$e.current?.focus()});const ke=ot=>{const xt=ot.target?.value;Ae(xt)},Ze=Pe&&ce!=="None";return pe?n.createElement("div",{className:Me.wrapper},Ze&&n.createElement(b,null,ce),he.map(ot=>n.createElement(b,{key:ot.uid},ot.group+":"+(ot.displayName||ot.name))),!me&&n.createElement("input",{...Ue,className:Me.input,ref:$e,onMouseDown:S,onChange:ke,"data-testid":"role-picker-input",placeholder:pe?"Select role":"",value:ye}),n.createElement("div",{className:Me.suffix},n.createElement(d.I,{name:"angle-up",className:Me.dropdownIndicator,onMouseDown:We}))):n.createElement("div",{className:(0,i.cx)(Me.wrapper,Me.selectedRoles),onMouseDown:Ne},Ze&&n.createElement(b,null,ce),n.createElement(M,{appliedRoles:he,numberOfRoles:he.length,showBuiltInRole:Ze}),Oe&&n.createElement("div",{className:Me.spinner},n.createElement(f.y,{size:16,inline:!0})))};T.displayName="RolePickerInput";const M=({showBuiltInRole:he,numberOfRoles:ce,appliedRoles:me})=>{const pe=(0,a.of)(ye=>x(ye));return n.createElement(n.Fragment,null,ce?n.createElement(l.m,{content:n.createElement("div",{className:pe.tooltip},me?.map(ye=>n.createElement("p",{key:ye.uid},ye.group+":"+(ye.displayName||ye.name))))},n.createElement(b,null,`${he?"+":""}${ce} role${ce>1?"s":""}`)):!he&&n.createElement(b,null,"No roles assigned"))},A=(he,ce,me,pe,ye,Pe)=>{const Ie=(0,m.n)({theme:he,invalid:ce});return{wrapper:(0,i.cx)(Ie.wrapper,(0,s.Xb)(he,ce),me&&(0,i.css)`
          ${h.focusCss(he.v1)}
        `,pe&&Ie.inputDisabled,(0,i.css)({minWidth:Pe||P+"px",width:Pe,minHeight:"32px",height:"auto",flexDirection:"row",paddingRight:he.spacing(1),maxWidth:"100%",alignItems:"center",display:"flex",flexWrap:"wrap",justifyContent:"flex-start",position:"relative",boxSizing:"border-box",cursor:"default"}),ye&&(0,i.css)`
          padding-left: 0;
        `),input:(0,i.cx)((0,s.Xb)(he,ce),(0,i.css)`
        max-width: 120px;
        border: none;
        cursor: ${me?"default":"pointer"};
      `),suffix:Ie.suffix,dropdownIndicator:(0,i.css)`
      cursor: pointer;
    `,selectedRoles:(0,i.css)`
      display: flex;
      align-items: center;
      cursor: ${pe?"not-allowed":"pointer"};
    `,tooltip:(0,i.css)`
      p {
        margin-bottom: ${he.spacing(.5)};
      }
    `,spinner:(0,i.css)({display:"flex",flexGrow:1,justifyContent:"flex-end"})}},x=he=>({tooltip:(0,i.css)`
    p {
      margin-bottom: ${he.spacing(.5)};
    }
  `});var C=e(72109),O=e(40276),R=e(67061),L=e(55852),N=e(5173),F=e(31678);const K=he=>({hideScrollBar:(0,i.css)({".scrollbar-view":{"&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"}}),menuWrapper:(0,i.css)({display:"flex",maxHeight:"650px",position:"absolute",zIndex:he.zIndex.dropdown,overflow:"hidden",minWidth:"auto"}),menu:(0,i.css)({minWidth:`${y}px`,maxWidth:`${p}px`,"& > div":{paddingTop:he.spacing(1)}}),menuLeft:(0,i.css)({flexDirection:"row-reverse"}),subMenu:(0,i.css)({height:"100%",minWidth:`${v}px`,maxWidth:`${D}px`,display:"flex",flexDirection:"column",borderLeft:`1px solid ${he.components.input.borderColor}`,"& > div":{paddingTop:he.spacing(1)}}),subMenuLeft:(0,i.css)({borderRight:`1px solid ${he.components.input.borderColor}`,borderLeft:"unset"}),groupHeader:(0,i.css)({padding:he.spacing(0,4.5),display:"flex",alignItems:"center",color:he.colors.text.primary,fontWeight:he.typography.fontWeightBold}),container:(0,i.css)({padding:he.spacing(1),border:`1px ${he.colors.border.weak} solid`,borderRadius:he.shape.radius.default,backgroundColor:he.colors.background.primary,zIndex:he.zIndex.modal}),menuSection:(0,i.css)({marginBottom:he.spacing(2)}),menuOptionCheckbox:(0,i.css)({display:"flex",margin:he.spacing(0,1,0,.25)}),menuButtonRow:(0,i.css)({backgroundColor:he.colors.background.primary,padding:he.spacing(1)}),menuOptionBody:(0,i.css)({fontWeight:he.typography.fontWeightRegular,padding:he.spacing(0,1.5,0,0)}),menuOptionDisabled:(0,i.css)({color:he.colors.text.disabled,cursor:"not-allowed"}),menuOptionExpand:(0,i.css)({position:"absolute",right:he.spacing(2.5),color:he.colors.text.disabled,"&:after":{content:'">"'}}),menuOptionInfoSign:(0,i.css)({color:he.colors.text.disabled}),basicRoleSelector:(0,i.css)({margin:he.spacing(1,1.25,1,1.5)}),subMenuPortal:(0,i.css)({height:"100%","> div":{height:"100%"}}),subMenuButtonRow:(0,i.css)({backgroundColor:he.colors.background.primary,padding:he.spacing(1)}),checkboxPartiallyChecked:(0,i.css)({input:{"&:checked + span":{"&:after":{borderWidth:"0 3px 0px 0",transform:"rotate(90deg)"}}}}),loadingSpinner:(0,i.css)({marginLeft:he.spacing(1)})}),B=Object.values(F.OrgRole).map(he=>({label:he===F.OrgRole.None?"No basic role":he,value:he})),w=({value:he,onChange:ce,disabled:me,disabledMesssage:pe,tooltipMessage:ye})=>{const Pe=(0,a.of)(K),Ie=(0,a.$j)();return n.createElement(n.Fragment,null,n.createElement("div",{className:Pe.groupHeader},n.createElement("span",{style:{marginRight:Ie.spacing(1)}},"Basic roles"),me&&pe&&n.createElement(l.m,{placement:"right-end",interactive:!0,content:n.createElement("div",null,pe)},n.createElement(d.I,{name:"question-circle"})),!me&&ye&&n.createElement(l.m,{placement:"right-end",interactive:!0,content:ye},n.createElement(d.I,{name:"info-circle",size:"xs"}))),n.createElement(N.a,{name:"Basic Role Selector",className:Pe.basicRoleSelector,options:B,value:he,onChange:ce,disabled:me}))};var U=e(10880);const W=(0,n.memo)(n.forwardRef(({name:he,value:ce,isFocused:me,isSelected:pe,partiallySelected:ye,disabled:Pe,onChange:Ie,onClick:Oe,onOpenSubMenu:Ne,onCloseSubMenu:We,children:Ae,root:Ue},Me)=>{const $e=(0,a.$j)(),ke=(0,u.J)($e),Ze=(0,a.of)(K),ot=(0,i.cx)(ke.option,me&&ke.optionFocused,Pe&&Ze.menuOptionDisabled),xt=re=>{Pe||ce&&Ie(ce)},ct=re=>{Oe&&Oe(ce)},ft=()=>{Ne&&Ne(ce)},Le=()=>{We&&We()};return n.createElement("div",{onMouseEnter:ft,onMouseLeave:Le},n.createElement("div",{ref:Me,className:ot,"aria-label":"Role picker option",onClick:ct},n.createElement(U.S,{value:pe,className:(0,i.cx)(Ze.menuOptionCheckbox,{[Ze.checkboxPartiallyChecked]:ye}),onChange:xt,disabled:Pe}),n.createElement("div",{className:(0,i.cx)(ke.optionBody,Ze.menuOptionBody)},n.createElement("span",null,he),n.createElement("span",{className:Ze.menuOptionExpand})),Ue&&Ae&&n.createElement(r.ZL,{className:Ze.subMenuPortal,root:Ue},Ae)))}));W.displayName="RoleMenuGroupOption";const V=n.forwardRef(({data:he,isFocused:ce,isSelected:me,disabled:pe,onChange:ye,hideDescription:Pe},Ie)=>{const Oe=(0,a.$j)(),Ne=(0,u.J)(Oe),We=(0,a.of)(K),Ae=(0,i.cx)(Ne.option,ce&&Ne.optionFocused,pe&&We.menuOptionDisabled),Ue=Me=>{pe||(Me.preventDefault(),Me.stopPropagation(),ye(he))};return n.createElement("div",{ref:Ie,className:Ae,"aria-label":"Role picker option",onClick:Ue},n.createElement(U.S,{value:me,className:We.menuOptionCheckbox,onChange:Ue,disabled:pe}),n.createElement("div",{className:(0,i.cx)(Ne.optionBody,We.menuOptionBody)},n.createElement("span",null,he.displayName||he.name),!Pe&&he.description&&n.createElement("div",{className:Ne.optionDescription},he.description)),he.description&&n.createElement(l.m,{content:he.description},n.createElement(d.I,{name:"info-circle",className:We.menuOptionInfoSign})))});V.displayName="RoleMenuOption";var _=e(3246);const H=({options:he,selectedOptions:ce,disabledOptions:me,onSelect:pe,onClear:ye,showOnLeft:Pe})=>{const Ie=(0,a.$j)(),Oe=(0,u.J)(Ie),Ne=(0,a.of)(K),We=async()=>{ye&&ye()};return n.createElement("div",{className:(0,i.cx)(Ne.subMenu,{[Ne.subMenuLeft]:Pe}),"aria-label":"Role picker submenu"},n.createElement(O.E,{autoHide:!1,autoHeightMax:`${c}px`,hideHorizontalTrack:!0},n.createElement("div",{className:Oe.optionBody},he.map((Ae,Ue)=>n.createElement(V,{data:Ae,key:Ue,isSelected:!!(Ae.uid&&(ce.find(Me=>Me.uid===Ae.uid)||me?.find(Me=>Me.uid===Ae.uid))),disabled:!!(Ae.uid&&me?.find(Me=>Me.uid===Ae.uid))||(0,_.W)(Ae),onChange:pe,hideDescription:!0})))),n.createElement("div",{className:Ne.subMenuButtonRow},n.createElement(R.B,{justifyContent:"flex-end"},n.createElement(L.$n,{size:"sm",fill:"text",onClick:We},"Clear"))))},G=n.forwardRef(({roles:he,renderedName:ce,showGroups:me,optionGroups:pe,onGroupChange:ye,groupSelected:Pe,groupPartiallySelected:Ie,subMenuNode:Oe,selectedOptions:Ne,onRoleChange:We,onClearSubMenu:Ae,showOnLeftSubMenu:Ue},Me)=>{const[$e,ke]=(0,n.useState)(!1),[Ze,ot]=(0,n.useState)(""),xt=(0,a.$j)(),ct=(0,u.J)(xt),ft=(0,a.of)(K),Le=(0,n.useCallback)(X=>{ot(X),ke(!0)},[]),re=(0,n.useCallback)(()=>{ke(!1),ot("")},[]);return n.createElement("div",null,he.length>0&&n.createElement("div",{className:ft.menuSection},n.createElement("div",{className:ft.groupHeader},ce),n.createElement("div",{className:ct.optionBody}),me&&pe?.length?pe.map(X=>n.createElement(W,{key:X.value,name:X.name,value:X.value,isSelected:Pe(X.value)||Ie(X.value),partiallySelected:Ie(X.value),disabled:X.options?.every(_.W),onChange:ye,onOpenSubMenu:Le,onCloseSubMenu:re,root:Oe,isFocused:$e&&Ze===X.value},$e&&Ze===X.value&&n.createElement(H,{options:X.options,selectedOptions:Ne,onSelect:We,onClear:()=>Ae(Ze),showOnLeft:Ue}))):he.map(X=>n.createElement(V,{data:X,key:X.uid,isSelected:!!(X.uid&&Ne.find(le=>le.uid===X.uid)),disabled:(0,_.W)(X),onChange:We,hideDescription:!0}))))});G.displayName="RoleMenuGroupsSection";var j=(he=>(he.fixed="fixed",he.custom="custom",he.plugin="plugin",he))(j||{});const Y={ldap:"LDAP",current:"Current org"},oe=n.createElement(n.Fragment,null,'You can now select the "No basic role" option and add permissions to your custom needs. You can find more information in\xA0',n.createElement(C.Y,{href:"https://grafana.com/docs/grafana/latest/administration/roles-and-permissions/#organization-roles",variant:"bodySmall",external:!0},"our documentation"),"."),se=({basicRole:he,options:ce,appliedRoles:me,showGroups:pe,basicRoleDisabled:ye,disabledMessage:Pe,showBasicRole:Ie,onSelect:Oe,onBasicRoleSelect:Ne,onUpdate:We,updateDisabled:Ae,offset:Ue,menuLeft:Me,apply:$e})=>{const[ke,Ze]=(0,n.useState)(me),[ot,xt]=(0,n.useState)(he),[ct,ft]=(0,n.useState)({}),Le=(0,n.useRef)(null),re=(0,a.$j)(),X=(0,u.J)(re),le=(0,a.of)(K);(0,n.useEffect)(()=>{Oe(ke)},[ke,Oe]),(0,n.useEffect)(()=>{Ne&&ot&&Ne(ot)},[ot,Ne]),(0,n.useEffect)(()=>{const St=ce.filter(ne).sort(ue),Je=ce.filter(ee).sort(ue),rt=ce.filter(Z).sort(ue),Rt={fixed:z(Je).sort((_t,nn)=>_t.name.localeCompare(nn.name)),custom:z(St).sort((_t,nn)=>_t.name.localeCompare(nn.name)),plugin:z(rt).sort((_t,nn)=>_t.name.localeCompare(nn.name))};ft({fixed:{groupType:"fixed",optionGroup:Rt.fixed,renderedName:"Fixed roles",roles:Je},custom:{groupType:"custom",optionGroup:Rt.custom,renderedName:"Custom roles",roles:St},plugin:{groupType:"plugin",optionGroup:Rt.plugin,renderedName:"Plugin roles",roles:rt}})},[ce]);const be=St=>{const Je=[];for(const rt of ke)q(rt)===St&&Je.push(rt);return Je},De=(St,Je)=>{const rt=be(Je),Rt=ct[St]?.optionGroup.find(_t=>_t.value===Je);return rt.length>0&&rt.length>=Rt.options.length},Te=(St,Je)=>{const rt=be(Je),Rt=ct[St]?.optionGroup.find(_t=>_t.value===Je);return rt.length>0&&rt.length<Rt.options.length},we=St=>{ke.find(Je=>Je.uid===St.uid)?Ze(ke.filter(Je=>Je.uid!==St.uid)):Ze([...ke,St])},Ke=(St,Je)=>{const rt=ct[St]?.optionGroup.find(Rt=>Rt.value===Je);if(rt)if(De(St,Je)||Te(St,Je))Ze(ke.filter(Rt=>!rt.options.find(_t=>Rt.uid===_t.uid)));else{const Rt=rt.options.filter(nn=>nn.delegatable),_t=ke.filter(nn=>!rt.options.find(Kt=>nn.uid===Kt.uid));Ze([..._t,...Rt])}},Ve=St=>{xt(St)},ht=async()=>{Ze([])},gt=St=>{const Je=ke.filter(rt=>q(rt)!==St);Ze(Je)},bt=()=>{We(ke,ot)};return n.createElement("div",{className:(0,i.cx)(X.menu,le.menuWrapper,{[le.menuLeft]:Me},(0,i.css)({top:`${Ue.vertical}px`,left:Me?"unset":`${Ue.horizontal}px`,right:Me?`${Ue.horizontal}px`:"unset"}))},n.createElement("div",{className:le.menu,"aria-label":"Role picker menu"},n.createElement(O.E,{autoHide:!1,autoHeightMax:`${c}px`,hideHorizontalTrack:!0,hideVerticalTrack:!0,className:(0,i.cx)(le.hideScrollBar)},Ie&&n.createElement("div",{className:le.menuSection},n.createElement(w,{value:ot,onChange:Ve,disabled:ye,disabledMesssage:Pe,tooltipMessage:oe})),Object.entries(ct).map(([St,Je])=>n.createElement(G,{key:St,roles:Je.roles,renderedName:Je.renderedName,showGroups:pe,optionGroups:Je.optionGroup,groupSelected:rt=>De(Je.groupType,rt),groupPartiallySelected:rt=>Te(Je.groupType,rt),onGroupChange:rt=>Ke(Je.groupType,rt),subMenuNode:Le?.current,selectedOptions:ke,onRoleChange:we,onClearSubMenu:gt,showOnLeftSubMenu:Me}))),n.createElement("div",{className:le.menuButtonRow},n.createElement(R.B,{justifyContent:"flex-end"},n.createElement(L.$n,{size:"sm",fill:"text",onClick:ht,disabled:Ae},"Clear all"),n.createElement(L.$n,{size:"sm",onClick:bt,disabled:Ae},$e?"Apply":"Update")))),n.createElement("div",{ref:Le}))},ne=he=>!he.name?.startsWith("fixed:")&&!he.name.startsWith("plugins:"),ee=he=>he.name?.startsWith("fixed:"),Z=he=>he.name?.startsWith("plugins:"),z=he=>{const ce={};return he.forEach(pe=>{const ye=q(pe),Pe=ie(pe);ce[ye]||(ce[ye]={name:Pe,roles:[]}),ce[ye].roles.push(pe)}),Object.entries(ce).map(([pe,ye])=>({name:Y[pe]||fe(ye.name),value:pe,options:ye.roles.sort(ue)}))},q=he=>{const ce=de(he),me=ie(he);return`${ce}:${me}`},ie=he=>he.group||"Other",de=he=>{const ce=he.name.indexOf(":");return ce<0?"unknown":he.name.substring(0,ce)},ue=(he,ce)=>he.name.localeCompare(ce.name),fe=he=>he.slice(0,1).toUpperCase()+he.slice(1),Se=({basicRole:he,appliedRoles:ce,roleOptions:me,disabled:pe,isLoading:ye,basicRoleDisabled:Pe,basicRoleDisabledMessage:Ie,showBasicRole:Oe,onRolesChange:Ne,onBasicRoleChange:We,canUpdateRoles:Ae=!0,apply:Ue=!1,maxWidth:Me=P,width:$e})=>{const[ke,Ze]=(0,n.useState)(!1),[ot,xt]=(0,n.useState)(ce),[ct,ft]=(0,n.useState)(he),[Le,re]=(0,n.useState)(""),[X,le]=(0,n.useState)({vertical:0,horizontal:0}),[be,De]=(0,n.useState)(!1),Te=(0,n.useRef)(null),we=(0,a.$j)(),Ke=typeof $e=="number"?we.spacing($e):$e;(0,n.useEffect)(()=>{ft(he),xt(ce)},[ce,he,We]);const Ve=(0,n.useCallback)(()=>{const{horizontal:Kt,vertical:en,menuToLeft:Qt}=ht();Kt&&en&&(le({horizontal:Kt,vertical:en}),De(Qt))},[]);(0,n.useEffect)(()=>{ke&&Ve()},[ke,ot,Ve]);const ht=()=>{const Kt=Te?.current?.getBoundingClientRect();if(!Kt)return{};const{bottom:en,top:Qt,left:An,right:un}=Kt;let fn=An,Tt=!1;const $t=window.innerHeight-en;let Yt=en+5,Cn=!1;return $t<c+20&&(Yt=Qt-c-50),Qt<c+50&&(Yt=Qt,fn=un+5,Cn=!0),fn+E>window.innerWidth&&(fn=window.innerWidth-(Cn?An:un),Tt=!0),{horizontal:fn,vertical:Yt,menuToLeft:Tt}},gt=(0,n.useCallback)(Kt=>{pe||(Kt.preventDefault(),Kt.stopPropagation(),Ve(),Ze(!0))},[pe,Ve]),bt=(0,n.useCallback)(()=>{Ze(!1),re(""),xt(ce),ft(he)},[ce,he]),St=()=>ke&&bt(),Je=Kt=>{re(Kt||"")},rt=Kt=>{xt(Kt)},Rt=Kt=>{ft(Kt)},_t=(Kt,en)=>{We&&en&&en!==he&&We(en),Ae&&Ne(Kt),re(""),Ze(!1)},nn=()=>{const Kt=me.map(en=>({...en,delegatable:Ae&&en.delegatable}));return Le&&Le.trim()!==""?Kt.filter(en=>en.name?.toLowerCase().includes(Le.toLowerCase())):Kt};return n.createElement("div",{"data-testid":"role-picker",style:{position:"relative",maxWidth:Ke||Me,width:Ke},ref:Te},n.createElement(o.N,{onClick:St,useCapture:!1},n.createElement(T,{basicRole:ct,appliedRoles:ot,query:Le,onQueryChange:Je,onOpen:gt,onClose:bt,isFocused:ke,disabled:pe,showBasicRole:Oe,width:Ke,isLoading:ye}),ke&&n.createElement(r.ZL,null,n.createElement("div",{onClick:Kt=>Kt.stopPropagation()},n.createElement(se,{options:nn(),basicRole:ct,appliedRoles:ce,onBasicRoleSelect:Rt,onSelect:rt,onUpdate:_t,showGroups:Le.length===0||Le.trim()==="",basicRoleDisabled:Pe,disabledMessage:Ie,showBasicRole:Oe,updateDisabled:Pe&&!Ae,apply:Ue,offset:X,menuLeft:be})))))}},89062:(Q,I,e)=>{"use strict";e.d(I,{y:()=>d});var n=e(96540),a=e(41053),o=e(10096),r=e(31678),i=e(37425),f=e(85927);const d=({basicRole:l,roles:m,userId:s,orgId:h,onBasicRoleChange:u,roleOptions:b,disabled:g,basicRoleDisabled:P,basicRoleDisabledMessage:c,apply:y=!1,onApplyRoles:p,pendingRoles:v,maxWidth:D,width:E,isLoading:S})=>{const[{loading:T,value:M=m||[]},A]=(0,a.A)(async()=>{try{if(m)return m;if(y&&v?.length)return v;if(o.contextSrv.hasPermission(r.AccessControlAction.ActionUserRolesList)&&s>0)return await(0,f.Xh)(s,h)}catch{console.error("Error loading options")}return[]},[h,s,v,m]);(0,n.useEffect)(()=>{h&&A()},[A,h]);const x=async O=>{y?p&&p(O,s,h):(await(0,f.eA)(O,s,h),await A())},C=o.contextSrv.hasPermission(r.AccessControlAction.ActionUserRolesAdd)&&o.contextSrv.hasPermission(r.AccessControlAction.ActionUserRolesRemove);return n.createElement(i.n,{appliedRoles:M,basicRole:l,onRolesChange:x,onBasicRoleChange:u,roleOptions:b,isLoading:T||S,disabled:g,basicRoleDisabled:P,basicRoleDisabledMessage:c,showBasicRole:!0,apply:y,canUpdateRoles:C,maxWidth:D,width:E})}},85927:(Q,I,e)=>{"use strict";e.d(I,{G3:()=>d,RL:()=>o,Xh:()=>r,eA:()=>i,xN:()=>f});var n=e(17172),a=e(3246);const o=async l=>{let m="/api/access-control/roles?delegatable=true";l&&(m+=`&targetOrgId=${l}`);const s=await(0,n.AI)().get(m);return!s||!s.length?[]:s.map(a.c)},r=async(l,m)=>{let s=`/api/access-control/users/${l}/roles`;m&&(s+=`?targetOrgId=${m}`);try{const h=await(0,n.AI)().get(s);return!h||!h.length?[]:h.map(a.c)}catch(h){return(0,n.NF)(h)&&(h.isHandled=!0),[]}},i=(l,m,s)=>{let h=`/api/access-control/users/${m}/roles`;s&&(h+=`?targetOrgId=${s}`);const u=l.flatMap(b=>b.uid);return(0,n.AI)().put(h,{orgId:s,roleUids:u})},f=async(l,m)=>{let s=`/api/access-control/teams/${l}/roles`;m&&(s+=`?targetOrgId=${m}`);try{const h=await(0,n.AI)().get(s);return!h||!h.length?[]:h.map(a.c)}catch(h){return(0,n.NF)(h)&&(h.isHandled=!0),[]}},d=(l,m,s)=>{let h=`/api/access-control/teams/${m}/roles`;s&&(h+=`?targetOrgId=${s}`);const u=l.flatMap(b=>b.uid);return(0,n.AI)().put(h,{orgId:s,roleUids:u})}},3246:(Q,I,e)=>{"use strict";e.d(I,{W:()=>n,c:()=>a});const n=o=>o.delegatable!==void 0&&!o.delegatable,a=o=>{const r="fixed:";if(!o.displayName&&o.name.startsWith(r)){let i="";i=o.name.replace(r,"").replace(/:/g," "),o.displayName=i}return o}},47694:(Q,I,e)=>{"use strict";e.d(I,{y:()=>s});var n=e(96540),a=e(8867),o=e(40672),r=e(62938);const i=2,f=5,d=g=>{const P=g.match(new RegExp('<style type="text/css">([\\s\\S]*?)<\\/style>'));return P?P[0]:null},l=g=>g.match(new RegExp(`<svg.*id\\s*=\\s*(['"])(.*?)\\1`))?.[i],m=g=>{let P=l(g);if(!P){P=`x${(0,r.A)()}`;const y=g.indexOf("<svg")+f;g=g.substring(0,y)+`id="${P}" `+g.substring(y)}let c=d(g);if(c){let y=c.replace(/(#(.*?))?\./g,`#${P} .`);g=g.replace(c,y)}return g},s=g=>{const{cleanStyle:P,...c}=g;return n.createElement(a.default,{...c,cacheRequests:!0,preProcessor:P?b:u})};let h=new Map;function u(g){let P=h.get(g);return P||(P=o.sQ.sanitizeSVGContent(g),h.set(g,P)),P}function b(g){let P=h.get(g);return P||(P=o.sQ.sanitizeSVGContent(g),P.indexOf('<style type="text/css">')>-1&&(P=m(P)),h.set(g,P)),P}},59429:(Q,I,e)=>{"use strict";e.d(I,{b:()=>s});var n=e(76459),a=e.n(n),o=e(96540),r=e(21594),i=e(27677),f=e(28676);const d=(h="General",u)=>`${h}/${u}`;async function l(h=""){return i.IB.search({type:"dash-db",query:h,limit:100}).then(u=>u.map(b=>({value:{uid:b.uid,title:b.title,folderTitle:b.folderTitle,folderUid:b.folderUid},label:d(b?.folderTitle,b.title)})))}const m=a()(l,250,{leading:!0}),s=({value:h,onChange:u,placeholder:b="Select dashboard",noOptionsMessage:g="No dashboards found",...P})=>{const[c,y]=(0,o.useState)();(0,o.useEffect)(()=>{!h||h===c?.value?.uid||(async()=>{const v=await(0,f.n)().getDashboardDTO(h);v.dashboard&&y({value:{uid:v.dashboard.uid,title:v.dashboard.title,folderTitle:v.meta.folderTitle,folderUid:v.meta.folderUid},label:d(v.meta?.folderTitle,v.dashboard.title)})})()},[h]);const p=(0,o.useCallback)(v=>{y(v),u?.(v?.value)},[u,y]);return o.createElement(r.DW,{loadOptions:m,onChange:p,placeholder:b,noOptionsMessage:g,value:c,defaultOptions:!0,...P})}},36607:(Q,I,e)=>{"use strict";e.d(I,{d:()=>ie});var n=e(96540),a=e(32264),o=e(32196),r=e(34743),i=e(36376),f=e(7315),d=e(76459),l=e.n(d),m=e(40845),s=e(10354),h=e(14578),u=e(42418),b=e(57514),g=e(8484),P=e(55314),c=e(24439),y=e(40957),p=e(31678),v=e(70255),D=e(91793),E=e(10022),S=e(29158),T=e(94753),M=e(18759),A=e(37690);const x=40,C="md",O=(ue,fe)=>`${ue}-${fe||"root"}`;function R({items:ue,focusedItemIndex:fe,foldersAreOpenable:Se,idPrefix:he,selectedFolder:ce,onFolderExpand:me,onFolderSelect:pe,isItemLoaded:ye,requestLoadMore:Pe}){const Ie=(0,n.useRef)(null),Oe=(0,m.of)(F),Ne=(0,n.useMemo)(()=>({items:ue,focusedItemIndex:fe,foldersAreOpenable:Se,selectedFolder:ce,onFolderExpand:me,onFolderSelect:pe,idPrefix:he}),[ue,fe,Se,ce,me,pe,he]),We=(0,n.useCallback)(Ue=>ye(Ue),[ye]),Ae=(0,n.useCallback)((Ue,Me)=>{const{parentUID:$e}=ue[Ue];Pe($e)},[Pe,ue]);return n.createElement("div",{className:Oe.table,role:"tree"},ue.length>0?n.createElement(E.A,{ref:Ie,itemCount:ue.length,isItemLoaded:We,loadMoreItems:Ae},({onItemsRendered:Ue,ref:Me})=>n.createElement(D.Y1,{ref:Me,height:x*Math.min(6.5,ue.length),width:"100%",itemData:Ne,itemSize:x,itemCount:ue.length,onItemsRendered:Ue},N)):n.createElement("div",{className:Oe.emptyMessage},n.createElement(g.x6,{i18nKey:"browse-dashboards.folder-picker.empty-message"},"No folders found")))}const L=[100,200,130,160,150];function N({index:ue,style:fe,data:Se}){const{items:he,focusedItemIndex:ce,foldersAreOpenable:me,selectedFolder:pe,onFolderExpand:ye,onFolderSelect:Pe,idPrefix:Ie}=Se,{item:Oe,isOpen:Ne,level:We,parentUID:Ae}=he[ue],Ue=(0,n.useRef)(null),Me=(0,n.useId)(),$e=(0,p.useSelector)(A.ku),ke=(0,p.useSelector)(A.Am),Ze=(Oe.uid?ke[Oe.uid]:$e)?.items??[];let ot=[];Oe.uid&&(ot=(Ae?ke[Ae]:$e)?.items??[]);const xt=(0,m.of)(F),ct=(0,n.useCallback)(Le=>{Le.preventDefault(),Le.stopPropagation(),Oe.uid&&ye(Oe.uid,!Ne)},[Oe.uid,Ne,ye]),ft=(0,n.useCallback)(()=>{Oe.kind==="folder"&&Pe(Oe)},[Oe,Pe]);return Oe.kind==="ui"&&Oe.uiKind==="pagination-placeholder"?n.createElement("span",{style:fe,className:xt.row},n.createElement(M.T,{level:We,spacing:2}),n.createElement(v.A,{width:L[ue%L.length]})):Oe.kind!=="folder"?null:n.createElement("div",{ref:Ue,style:fe,className:(0,o.cx)(xt.row,{[xt.rowFocused]:ue===ce,[xt.rowSelected]:Oe.uid===pe}),tabIndex:-1,onClick:ft,"aria-expanded":Ne,"aria-selected":Oe.uid===pe,"aria-labelledby":Me,"aria-level":We+1,role:"treeitem","aria-owns":Ze.length>0?Ze.map(Le=>O(Ie,Le.uid)).join(" "):void 0,"aria-setsize":Ze.length,"aria-posinset":ot.findIndex(Le=>Le.uid===Oe.uid)+1,id:O(Ie,Oe.uid)},n.createElement("div",{className:xt.rowBody},n.createElement(M.T,{level:We,spacing:2}),me?n.createElement(S.K,{size:C,onMouseDown:ct,tabIndex:-1,"aria-label":Ne?`Collapse folder ${Oe.title}`:`Expand folder ${Oe.title}`,name:Ne?"angle-down":"angle-right"}):n.createElement("span",{className:xt.folderButtonSpacer}),n.createElement("label",{className:xt.label,id:Me},n.createElement(T.E,{truncate:!0},Oe.title))))}const F=ue=>{const fe=(0,o.css)({height:x,display:"flex",position:"relative",alignItems:"center",flexGrow:1,gap:ue.spacing(.5),overflow:"hidden",padding:ue.spacing(0,1)});return{table:(0,o.css)({background:ue.components.input.background}),emptyMessage:(0,o.css)({padding:ue.spacing(1),textAlign:"center",width:"100%"}),folderButtonSpacer:(0,o.css)({paddingLeft:ue.spacing(.5)}),row:(0,o.css)({display:"flex",position:"relative",alignItems:"center",":not(:first-child)":{borderTop:`solid 1px ${ue.colors.border.weak}`}}),rowFocused:(0,o.css)({backgroundColor:ue.colors.background.secondary}),rowSelected:(0,o.css)({"&::before":{display:"block",content:'""',position:"absolute",left:0,bottom:0,top:0,width:4,borderRadius:ue.shape.radius.default,backgroundImage:ue.colors.gradients.brandVertical}}),rowBody:fe,label:(0,o.css)({lineHeight:x+"px",flexGrow:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","&:hover":{textDecoration:"underline",cursor:"pointer"}})}};var K=e(16797);function B({handleClearSelection:ue,isLoading:fe,invalid:Se,label:he,...ce},me){const pe=(0,m.$j)(),ye=U(pe,Se),Pe=Ie=>{(Ie.key==="Enter"||Ie.key===" ")&&ue?.(Ie)};return n.createElement("div",{className:ye.wrapper},n.createElement("div",{className:ye.inputWrapper},he?n.createElement("div",{className:ye.prefix},n.createElement(h.I,{name:"folder"})):void 0,n.createElement("button",{type:"button",className:(0,o.cx)(ye.fakeInput,he?ye.hasPrefix:void 0),...ce,ref:me},fe?n.createElement(v.A,{width:100}):he?n.createElement(T.E,{truncate:!0},he):n.createElement(T.E,{truncate:!0,color:"secondary"},n.createElement(g.x6,{i18nKey:"browse-dashboards.folder-picker.button-label"},"Select folder")),!fe&&ue&&n.createElement(h.I,{role:"button",tabIndex:0,"aria-label":(0,g.t)("browse-dashboards.folder-picker.clear-selection","Clear selection"),className:ye.clearIcon,name:"times",onClick:ue,onKeyDown:Pe})),n.createElement("div",{className:ye.suffix},n.createElement(h.I,{name:"angle-down"}))))}const w=(0,n.forwardRef)(B),U=(ue,fe=!1)=>{const Se=(0,s.n)({theme:ue,invalid:fe});return{wrapper:Se.wrapper,inputWrapper:Se.inputWrapper,prefix:(0,o.css)([Se.prefix,{pointerEvents:"none",color:ue.colors.text.primary}]),suffix:(0,o.css)([Se.suffix,{pointerEvents:"none"}]),fakeInput:(0,o.css)([Se.input,{textAlign:"left",letterSpacing:"normal","&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,o.css)`
          ${(0,K.focusCss)(ue)}
        `,alignItems:"center",display:"flex",flexWrap:"nowrap",justifyContent:"space-between",paddingRight:28}]),hasPrefix:(0,o.css)({paddingLeft:28}),clearIcon:(0,o.css)({color:ue.colors.text.secondary,cursor:"pointer","&:hover":{color:ue.colors.text.primary},"&:focus:not(:focus-visible)":(0,K.getMouseFocusStyles)(ue),"&:focus-visible":(0,K.getFocusStyles)(ue)})}};var W=e(25508),V=e(92955),_=e(93519),H=e(64756);const G=(0,W.Mz)([ue=>ue,(ue,fe)=>fe],(ue,fe)=>{const Se=new Set,he=[],ce={};let me=!1;for(const pe of fe){if(Se.has(pe.requestId))continue;const ye=P.cU.endpoints.listFolders.select({parentUid:pe.arg.parentUid,page:pe.arg.page,limit:pe.arg.limit,permission:pe.arg.permission})(ue);ye.status==="pending"&&(me=!0);const Pe=ye.originalArgs?.parentUid;Pe?(ce[Pe]||(ce[Pe]=[]),ce[Pe].push(ye)):he.push(ye)}return{isLoading:me,rootPages:he,pagesByParent:ce}});function j(ue){const fe=ue.at(-1),Se=fe?.originalArgs?.page;return fe?.data?[fe.data.length<fe.originalArgs.limit,Se]:[!1,Se]}function Y(ue,fe,Se){const he=(0,H.wA)(),ce=(0,n.useRef)([]),me=(0,H.d4)(Pe=>G(Pe,ce.current)),pe=(0,n.useCallback)(Pe=>{const Ie=Pe?me.pagesByParent[Pe]:me.rootPages,[Oe,Ne]=j(Ie??[]);if(Oe)return;const We={parentUid:Pe,page:(Ne??0)+1,limit:V.md,permission:Se},Ae=he(P.cU.endpoints.listFolders.initiate(We));ce.current=ce.current.concat([Ae])},[me,he,Se]);return(0,n.useEffect)(()=>()=>{for(const Pe of ce.current)Pe.unsubscribe()},[]),{items:(0,n.useMemo)(()=>{if(!ue)return[];function Pe(Oe,Ne,We){const Ae=Ne.flatMap(Me=>(Me.data??[]).flatMap(ke=>{const Ze=fe[ke.uid],ot={isOpen:!!Ze,level:We,item:{kind:"folder",title:ke.title,uid:ke.uid}},xt=Ze&&me.pagesByParent[ke.uid];if(xt){const ct=Pe(ke.uid,xt,We+1);return[ot,...ct]}return ot})),[Ue]=j(Ne);return Ue||Ae.push(...(0,_.T)(V.md,Oe,We)),Ae}const Ie=Pe(void 0,me.rootPages,1);return Ie.unshift(oe),Ie},[me,ue,fe]),isLoading:me.isLoading,requestNextPage:pe}}const oe={isOpen:!0,level:0,item:{kind:"folder",title:"Dashboards",uid:""}};function se({tree:ue,handleCloseOverlay:fe,handleFolderSelect:Se,handleFolderExpand:he,idPrefix:ce,search:me,visible:pe}){const[ye,Pe]=(0,n.useState)(-1),Ie=!!a.$.featureToggles.nestedFolders;(0,n.useEffect)(()=>{pe&&Pe(-1)},[pe]),(0,n.useEffect)(()=>{Pe(0)},[me]),(0,n.useEffect)(()=>{document.getElementById(O(ce,ue[ye]?.item.uid))?.scrollIntoView({block:"nearest",inline:"nearest"})},[ye,ce,ue]);const Oe=(0,n.useCallback)(Ne=>{const We=Ie&&!me;switch(Ne.key){case"ArrowRight":case"ArrowLeft":We&&(Ne.preventDefault(),he(ue[ye].item.uid,Ne.key==="ArrowRight"));break;case"ArrowUp":ye>0&&(Ne.preventDefault(),Pe(ye-1));break;case"ArrowDown":ye<ue.length-1&&(Ne.preventDefault(),Pe(ye+1));break;case"Enter":Ne.preventDefault();const Ae=ue[ye].item;Ae.kind==="folder"&&Se(Ae);break;case"Tab":Ne.stopPropagation(),fe();break;case"Escape":Ne.stopPropagation(),Ne.preventDefault(),fe();break}},[ye,fe,he,Se,Ie,me,ue]);return{focusedItemIndex:ye,handleKeyDown:Oe}}const ne=l()(ee,300);async function ee(ue,fe){const Se=await(0,c.getGrafanaSearcher)().search({query:ue,kind:["folder"],limit:100,permission:fe}),he=Se.view.map(ce=>(0,y.hI)(ce,Se.view));return{...Se,items:he}}function Z({value:ue,invalid:fe,showRootFolder:Se=!0,clearable:he=!1,excludeUIDs:ce,permission:me=p.PermissionLevelString.Edit,onChange:pe}){const ye=(0,m.of)(z),Pe=(0,P.kH)(ue||P.hT),Ie=!!a.$.featureToggles.nestedFolders,[Oe,Ne]=(0,n.useState)(""),[We,Ae]=(0,n.useState)(null),[Ue,Me]=(0,n.useState)(!1),[$e,ke]=(0,n.useState)(!1),[Ze,ot]=(0,n.useState)(!1),[xt,ct]=(0,n.useState)({}),ft=(0,n.useId)(),[Le]=(0,n.useState)(void 0),re=(0,n.useRef)(0),X=!!(Ze&&!(Oe&&We)),{items:le,isLoading:be,requestNextPage:De}=Y(X,xt,me);(0,n.useEffect)(()=>{if(!Oe){Ae(null);return}const $t=Date.now();Me(!0),ne(Oe,me).then(Yt=>{if($t>re.current){const Cn=Yt.view.map(Tn=>(0,y.hI)(Tn,Yt.view));Ae({...Yt,items:Cn}),Me(!1),re.current=$t}})},[Oe,me]);const Te=[(0,r.UU)({crossAxis:!1,boundary:document.body})],{context:we,refs:Ke,floatingStyles:Ve,elements:ht}=(0,i.we)({open:Ze,placement:"bottom",onOpenChange:$t=>{$t&&(Ne(""),ke(!0)),ot($t)},middleware:Te,whileElementsMounted:f.ll}),gt=(0,i.kp)(we),bt=(0,i.s9)(we),{getReferenceProps:St,getFloatingProps:Je}=(0,i.bv)([bt,gt]),rt=(0,n.useCallback)(async($t,Yt)=>{ct(Cn=>({...Cn,[$t]:Yt})),Yt&&!xt[$t]&&De($t)},[De,xt]),Rt=(0,n.useCallback)($t=>{pe&&pe($t.uid,$t.title),ot(!1)},[pe]),_t=(0,n.useCallback)($t=>{$t.preventDefault(),$t.stopPropagation(),pe&&pe(void 0,void 0)},[pe]),nn=(0,n.useCallback)(()=>ot(!1),[ot]),Kt=(0,n.useCallback)($t=>{Oe||De($t)},[Oe,De]),en=(0,n.useMemo)(()=>{let $t=[];return X?$t=le:$t=We?.items.map(Yt=>({isOpen:!1,level:0,item:{kind:"folder",title:Yt.title,uid:Yt.uid}}))??[],(!Se||ce?.length)&&($t=$t.filter(Yt=>!(!Se&&Yt===oe||ce?.includes(Yt.item.uid)))),$t},[le,ce,X,We?.items,Se]),Qt=(0,n.useCallback)($t=>{const Yt=en[$t];if(!Yt)return!1;const Cn=Yt.item;return!(Cn.kind==="ui"&&Cn.uiKind==="pagination-placeholder")},[en]),An=be||Ue,{focusedItemIndex:un,handleKeyDown:fn}=se({tree:en,handleCloseOverlay:nn,handleFolderSelect:Rt,handleFolderExpand:rt,idPrefix:ft,search:Oe,visible:Ze});let Tt=Pe.data?.title;return ue===""&&(Tt="Dashboards"),Ze?n.createElement(n.Fragment,null,n.createElement(s.p,{ref:Ke.setReference,autoFocus:!0,prefix:Tt?n.createElement(h.I,{name:"folder"}):null,placeholder:Tt??(0,g.t)("browse-dashboards.folder-picker.search-placeholder","Search folders"),value:Oe,invalid:fe,className:ye.search,onChange:$t=>Ne($t.currentTarget.value),"aria-autocomplete":"list","aria-expanded":!0,"aria-haspopup":!0,"aria-controls":ft,"aria-owns":ft,"aria-activedescendant":O(ft,en[un]?.item.uid),role:"combobox",suffix:n.createElement(h.I,{name:"search"}),...St(),onKeyDown:fn}),n.createElement("fieldset",{ref:Ke.setFloating,id:ft,className:ye.tableWrapper,style:{...Ve,width:ht.domReference?.clientWidth},...Je()},Le?n.createElement(u.F,{className:ye.error,severity:"warning",title:(0,g.t)("browse-dashboards.folder-picker.error-title","Error loading folders")},Le.message||Le.toString?.()||(0,g.t)("browse-dashboards.folder-picker.unknown-error","Unknown error")):n.createElement("div",null,An&&n.createElement("div",{className:ye.loader},n.createElement(b.G,{width:600})),n.createElement(R,{items:en,selectedFolder:ue,focusedItemIndex:un,onFolderExpand:rt,onFolderSelect:Rt,idPrefix:ft,foldersAreOpenable:Ie&&!(Oe&&We),isItemLoaded:Qt,requestLoadMore:Kt})))):n.createElement(w,{label:Tt,handleClearSelection:he&&ue!==void 0?_t:void 0,invalid:fe,isLoading:Pe.isLoading,autoFocus:$e,ref:Ke.setReference,"aria-label":Tt?(0,g.t)("browse-dashboards.folder-picker.accessible-label","Select folder: {{ label }} currently selected",{label:Tt}):void 0,...St()})}const z=ue=>({button:(0,o.css)({maxWidth:"100%"}),error:(0,o.css)({marginBottom:0}),tableWrapper:(0,o.css)({boxShadow:ue.shadows.z3,position:"relative",zIndex:ue.zIndex.portal}),loader:(0,o.css)({position:"absolute",top:0,left:0,right:0,zIndex:ue.zIndex.portal+1,overflow:"hidden"}),search:(0,o.css)({input:{cursor:"default"}})});var q=e(85242);function ie(ue){const fe=a.$.featureToggles.newFolderPicker||a.$.featureToggles.nestedFolders,{initialTitle:Se,dashboardId:he,enableCreateNew:ce,...me}=ue;return fe?n.createElement(Z,{...me}):n.createElement(de,{...ue})}function de({value:ue,showRootFolder:fe,onChange:Se,initialTitle:he,dashboardId:ce,enableCreateNew:me,inputId:pe,skipInitialLoad:ye}){const Pe=(0,n.useCallback)(Ie=>{Se&&Se(Ie.uid,Ie.title)},[Se]);return n.createElement(q.sR,{onChange:Pe,showRoot:fe,initialFolderUid:ue,initialTitle:he,inputId:pe,skipInitialLoad:ye,dashboardId:ce,enableCreateNew:me})}},85242:(Q,I,e)=>{"use strict";e.d(I,{sR:()=>v});var n=e(32196),a=e(76459),o=e.n(a),r=e(96540),i=e(16817),f=e(26272),d=e(13544),l=e(14110),m=e(40845),s=e(10354),h=e(21594),u=e(28138),b=e(8484),g=e(16233),P=e(11230),c=e(31678);const y="+ Add new",p="-10";function v(T){const{dashboardId:M,allowEmpty:A,onChange:x,filter:C,enableCreateNew:O,inputId:R,onClear:L,enableReset:N,initialFolderUid:F,initialTitle:K="",permissionLevel:B=c.PermissionLevelString.Edit,rootName:w,showRoot:U=!0,skipInitialLoad:W,searchQueryType:V,customAdd:_,folderWarning:H,invalid:G}=T,j=w??"Dashboards",[Y,oe]=(0,r.useState)(null),[se,ne]=(0,r.useState)(!1),[ee,Z]=(0,r.useState)(""),[z,q]=(0,r.useState)(Y?.title??""),ie=(0,m.of)(S),de=typeof L=="function",ue=(0,r.useCallback)(async Ne=>{const We=await(0,P.c0)(Ne,B,V),Ue=D(We,C);return(0,l.rR)("grafana_folder_picker_results_loaded",{results:Ue.length,searchTermLength:Ne.length,enableCreateNew:!!O}),(g.TP.hasPermission(c.AccessControlAction.DashboardsWrite)||g.TP.hasPermission(c.AccessControlAction.DashboardsCreate))&&j?.toLowerCase().startsWith(Ne.toLowerCase())&&U&&Ue.unshift({label:j,value:""}),N&&Ne===""&&K!==""&&!Ue.find($e=>$e.label===K)&&Ue.unshift({label:K,value:F}),O&&_?[...Ue,{value:p,label:y,title:Ne}]:Ue},[N,F,K,B,j,U,V,C,O,_]),fe=(0,r.useMemo)(()=>o()(ue,300,{leading:!0}),[ue]),Se=async()=>{const Ne={label:K,value:void 0},We={label:j,value:""},Ae=await ue("");let Ue=null;F!=null?Ue=Ae.find(Me=>Me.value===F)||null:N&&K?Ue=Ne:F&&(Ue=Ae.find(Me=>Me.id===F)||null),!Ue&&!A&&(g.TP.isEditor?Ue=We:!!M?Ue=Ne:Ue=Ae.length>0?Ae[0]:Ne),!se&&oe(Ue)};(0,r.useEffect)(()=>{Y&&Y.value!==F&&!se&&Y.value&&Y.label&&x({uid:Y.value,title:Y.label})},[Y,F]),(0,i.A)(async()=>{if(W){const Ne=await E({getFolder:P.Ql,folderUid:F,folderName:K});oe(Ne)}await Se()},[W,F,K]),(0,r.useEffect)(()=>{Y&&Y.id===p&&ne(!0)},[Y]);const he=(0,r.useCallback)((Ne,We)=>{if(Ne?.value===p)oe({id:p,title:ee}),q(ee);else{if(Ne||(Ne={value:"",label:j}),We.action==="clear"&&L){L();return}oe(Ne),x({uid:Ne.value,title:Ne.label})}},[x,L,j,ee]),ce=(0,r.useCallback)(async Ne=>{if(H?.warningCondition(Ne))return(0,l.rR)("grafana_folder_picker_folder_created",{status:"failed_condition"}),!1;const We=await(0,P.vV)({title:Ne});let Ae={value:"",label:"Not created"};return We.uid?((0,l.rR)("grafana_folder_picker_folder_created",{status:"success"}),u.A.emit(f.r1.alertSuccess,["Folder Created","OK"]),Ae={value:We.uid,label:We.title},oe(We),he(Ae,{action:"create-option",option:Ae})):((0,l.rR)("grafana_folder_picker_folder_created",{status:"failed"}),u.A.emit(f.r1.alertError,["Folder could not be created"])),Ae},[H,he]),me=(0,r.useCallback)(Ne=>{const We=!!_?.disallowValues;if(Ne.key==="Enter"&&We&&!_?.isAllowedValue(z)){Ne.preventDefault();return}switch(Ne.key){case"Enter":{ce(Y?.title),ne(!1);break}case"Escape":oe({value:"",label:j}),ne(!1)}},[_?.disallowValues,_?.isAllowedValue,z,ce,Y?.title,j]),pe=Ne=>{const We=Ne.currentTarget.value;q(We),oe({id:void 0,title:We})},ye=()=>{oe({value:"",label:j}),ne(!1)},Pe=(Ne,{action:We})=>{We==="input-change"&&Z(Ae=>Ne),We==="menu-close"&&Z(Ae=>Ne)},Ie=()=>H?.warningCondition(z)?r.createElement(H.warningComponent,null):null,Oe=()=>H?.warningCondition(ee)?r.createElement(H.warningComponent,null):null;return se?r.createElement(r.Fragment,null,r.createElement(Ie,null),r.createElement("div",{className:ie.newFolder},"Press enter to create the new folder."),r.createElement(s.p,{width:30,autoFocus:!0,value:z,onChange:pe,onKeyDown:me,placeholder:"Press enter to confirm new folder.",onBlur:ye})):r.createElement("div",{"data-testid":d.Tp.components.FolderPicker.containerV2},r.createElement(Oe,null),r.createElement(h.gZ,{inputId:R,"data-testid":d.Tp.components.FolderPicker.input,loadingMessage:(0,b.t)("folder-picker.loading","Loading folders..."),defaultOptions:!0,defaultValue:Y,inputValue:ee,onInputChange:Pe,value:Y,allowCustomValue:O&&!_,loadOptions:fe,onChange:he,onCreateOption:ce,invalid:G,isClearable:de}))}function D(T,M){return(M?M(T):T).map(x=>({label:x.title,value:x.uid}))}async function E({folderName:T,folderUid:M,getFolder:A}){if(M==null)throw new Error("folderUid is not found.");return T?{label:T,value:M}:{label:(await A(M)).title,value:M}}const S=T=>({newFolder:(0,n.css)({color:T.colors.warning.main,fontSize:T.typography.bodySmall.fontSize,paddingBottom:T.spacing(1)})})},73725:(Q,I,e)=>{"use strict";e.d(I,{r:()=>l});var n=e(96540),a=e(16817),o=e(21594),r=e(14578),i=e(53477),f=e(24439);const d=()=>(0,f.getGrafanaSearcher)().getSortOptions();function l({onChange:m,value:s,placeholder:h,filter:u,getSortOptions:b,isClearable:g}){const P=(0,a.A)(async()=>{const y=await(b??d)();return u?y.filter(p=>u.includes(p.value)):y},[b,u]);if(P.loading)return null;const c=!!(s?.includes("desc")||s?.startsWith("-"));return n.createElement(o.l6,{key:s,width:28,onChange:m,value:P.value?.find(y=>y.value===s)??null,options:P.value,"aria-label":"Sort",placeholder:h??`Sort (Default ${i.r4.label})`,prefix:n.createElement(r.I,{name:c?"sort-amount-down":"sort-amount-up"}),isClearable:g})}},98742:(Q,I,e)=>{"use strict";e.d(I,{e:()=>f});var n=e(2543),a=e.n(n),o=e(96540),r=e(17172),i=e(21594);class f extends o.Component{constructor(l){super(l),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,n.debounce)(this.search,300,{leading:!0,trailing:!0})}componentDidMount(){const{teamId:l}=this.props;l&&(0,r.AI)().get(`/api/teams/${l}`).then(m=>{this.setState({value:{value:m,label:m.name,imgUrl:m.avatarUrl}})})}search(l){return this.setState({isLoading:!0}),(0,n.isNil)(l)&&(l=""),(0,r.AI)().get(`/api/teams/search?perpage=100&page=1&query=${l}`).then(m=>{const s=m.teams.map(h=>({value:h,label:h.name,imgUrl:h.avatarUrl}));return this.setState({isLoading:!1}),s})}render(){const{onSelected:l,className:m}=this.props,{isLoading:s,value:h}=this.state;return o.createElement("div",{className:"user-picker","data-testid":"teamPicker"},o.createElement(i.DW,{isLoading:s,defaultOptions:!0,loadOptions:this.debouncedSearch,value:h,onChange:l,className:m,placeholder:"Select a team",noOptionsMessage:"No teams found","aria-label":"Team picker"}))}}},46334:(Q,I,e)=>{"use strict";e.d(I,{E:()=>r});var n=e(96540),a=e(69613),o=e(14578);class r extends n.Component{constructor(f){super(f)}render(){const{label:f,removeIcon:d,count:l,onClick:m}=this.props,{color:s}=(0,a.MC)(f),h={backgroundColor:s},u=l!==0&&n.createElement("span",{style:{marginLeft:"3px"}},`(${l})`);return n.createElement("span",{className:"label label-tag",style:h},d&&n.createElement(o.I,{onClick:m,name:"times"}),f," ",u)}}},99818:(Q,I,e)=>{"use strict";e.d(I,{$:()=>b});var n=e(32196),a=e(96540),o=e(28581),r=e(54479),i=e(40845),f=e(21594),d=e(14578),l=e(8484),m=e(46334);const s=({data:P,className:c,label:y,isFocused:p,innerProps:v})=>{const D=(0,i.of)(h);return a.createElement("div",{className:(0,n.cx)(D.option,p&&D.optionFocused),"aria-label":"Tag option",...v},a.createElement("div",{className:(0,n.cx)(D.optionInner,c)},typeof y=="string"?a.createElement(m.E,{label:y,removeIcon:!1,count:P.count??0}):y))},h=P=>({option:(0,n.css)({padding:P.spacing(1),whiteSpace:"nowrap",cursor:"pointer",borderLeft:"2px solid transparent","&:hover":{background:P.colors.background.secondary}}),optionFocused:(0,n.css)({background:P.colors.background.secondary,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"}),optionInner:(0,n.css)({position:"relative",textAlign:"left",width:"100%",display:"block",cursor:"pointer",padding:"2px 0"})}),u=(P,c)=>RegExp((0,r.jD)(c),"i").test(P.value),b=({allowCustomValue:P=!1,formatCreateLabel:c,hideValues:y,inputId:p,isClearable:v,onChange:D,placeholder:E,tagOptions:S,tags:T,width:M})=>{const A=(0,i.of)(g),x=T.map(H=>({value:H,label:H,count:0})),[C,O]=(0,a.useState)(x),[R,L]=(0,a.useState)(!1),[N,F]=(0,a.useState)(T),[K,B]=(0,a.useState)(x),w=(0,a.useMemo)(()=>T.join(),[T]),U=(0,a.useCallback)(async()=>(await S()).map(G=>T.includes(G.term)?{value:G.term,label:G.term,count:0}:{value:G.term,label:G.term,count:G.count}),[S,T]),W=(0,a.useCallback)(async()=>{L(!0);const H=await U();P&&K.forEach(G=>H.push(G)),O(H),L(!1)},[P,K,U]);(0,a.useEffect)(()=>{T.length>0&&C.length===0&&W()},[W,C.length,T.length]),(0,a.useEffect)(()=>{T!==N&&(F(T),W())},[W,N,T]);const V=H=>{H.forEach(G=>G.count=0),D((H||[]).map(G=>G.value)),P&&B(H.filter(G=>!T.includes(G)))},_={key:w,onFocus:W,isLoading:R,options:C,allowCreateWhileLoading:!0,allowCustomValue:P,formatCreateLabel:c,defaultOptions:!0,filterOption:u,getOptionLabel:H=>H.label,getOptionValue:H=>H.value,inputId:p,isMulti:!0,onChange:V,loadingMessage:(0,l.t)("tag-filter.loading","Loading..."),noOptionsMessage:(0,l.t)("tag-filter.no-tags","No tags found"),placeholder:E||(0,l.t)("tag-filter.placeholder","Filter by tag"),value:x,width:M,components:{Option:s,MultiValueLabel:()=>null,MultiValueRemove(H){const{data:G}=H;return a.createElement(o.c.MultiValueRemove,{...H},a.createElement(m.E,{key:G.label,label:G.label,removeIcon:!0,count:G.count}))},MultiValueContainer:y?()=>null:o.c.MultiValueContainer}};return a.createElement("div",{className:A.tagFilter},v&&T.length>0&&a.createElement("button",{className:A.clear,onClick:()=>V([])},"Clear tags"),a.createElement(f.KF,{..._,prefix:a.createElement(d.I,{name:"tag-alt"}),"aria-label":"Tag filter"}))};b.displayName="TagFilter";const g=P=>({tagFilter:(0,n.css)`
    position: relative;
    min-width: 180px;
    flex-grow: 1;

    .label-tag {
      margin-left: 6px;
      cursor: pointer;
    }
  `,clear:(0,n.css)`
    background: none;
    border: none;
    text-decoration: underline;
    font-size: 12px;
    padding: none;
    position: absolute;
    top: -17px;
    right: 0;
    cursor: pointer;
    color: ${P.colors.text.secondary};

    &:hover {
      color: ${P.colors.text.primary};
    }
  `})},25573:(Q,I,e)=>{"use strict";e.d(I,{m:()=>u});var n=e(2543),a=e.n(n),o=e(96540),r=e(26272),i=e(65879),f=e(47232),d=e(15666),l=e(76412),m=e(28138),s=e(61680);const h="grafana.dashboard.timepicker.history",u=p=>o.createElement(s.b,{storageKey:h,defaultValue:[]},(v,D)=>{const E=g(v),S=b(E);return o.createElement(d.$6,{...p,history:S,onChange:T=>{P(T,E,D),p.onChange(T)},onError:T=>m.A.emit(r.r1.alertError,[(0,l.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,l.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:T})])})});function b(p){return p.map(v=>i.convertRawToRange(v,"utc",void 0,"YYYY-MM-DD HH:mm:ss"))}function g(p){return p.map(v=>{const D=typeof v.from=="string"?v.from:v.from.toISOString(),E=typeof v.to=="string"?v.to:v.to.toISOString();return{from:D,to:E}})}function P(p,v,D){if(!c(p))return;const E={from:typeof p.raw.from=="string"?p.raw.from:p.raw.from.toISOString(),to:typeof p.raw.to=="string"?p.raw.to:p.raw.to.toISOString()},S=y([E,...v]);D(S)}function c(p){return(0,f.Ar)(p.raw.from)||(0,f.Ar)(p.raw.to)}function y(p){return(0,n.uniqBy)(p,v=>v.from+v.to).slice(0,4)}},82389:(Q,I,e)=>{"use strict";e.d(I,{I:()=>s});var n=e(96540),a=e(24293),o=e(11261),r=e(52622),i=e(67266),f=e(96516),d=e(30249),l=e(28895);const m=["rowHeight","colWidth","showValue","mergeValues","alignValue","tooltip"];class s extends n.Component{constructor(){super(...arguments),this.getValueColor=(u,b,g)=>{const P=this.props.frames[u].fields[b];if(P.display){const c=P.display(g);if(c.color)return c.color}return a.F},this.prepConfig=(u,b,g)=>(0,l.iE)({frame:u,getTimeRange:g,allFrames:this.props.frames,...this.props,timeZones:Array.isArray(this.props.timeZone)?this.props.timeZone:[this.props.timeZone],rowHeight:u.fields.length>2?this.props.rowHeight:1,getValueColor:this.getValueColor,hoverMulti:this.props.tooltip?.mode===r.$N.Multi}),this.renderLegend=u=>{const{legend:b,legendItems:g}=this.props;return!u||!g||!b||b.showLegend===!1?null:n.createElement(i.KU.Legend,{placement:b.placement},n.createElement(f.t,{placement:b.placement,items:g,displayMode:b.displayMode,readonly:!0}))}}render(){return n.createElement(d.o,{...this.props,fields:{x:u=>u.type===o.PU.time,y:u=>u.type===o.PU.number||u.type===o.PU.boolean||u.type===o.PU.string||u.type===o.PU.enum},prepConfig:this.prepConfig,propsToDiff:m,renderLegend:this.renderLegend})}}},28895:(Q,I,e)=>{"use strict";e.d(I,{pm:()=>R,GY:()=>_,c5:()=>H,jY:()=>W,EI:()=>w,iE:()=>N,Qe:()=>B,Or:()=>U});var n=e(24293),a=e(28240),o=e(83195),r=e(11261),i=e(50082),f=e(58563),d=e(47737),l=e(73060),m=e(46294),s=e(39624),h=e(73134),u=e(52622),b=e(51336),g=e(52811),P=e(16895),c=e(36613),y=e(23596),p=e(39758),v=e(4134);const{round:D,min:E,ceil:S}=Math,T=2;let M=6;const A=p.ur;function x(G,j,Y,oe,se){(0,p.mn)(Y,G,A,j,(ne,ee,Z)=>{let z=oe*ee,q=oe*Z;se(ne,z,q)})}function C(G){const{mode:j,numSeries:Y,isDiscrete:oe,hasMappedNull:se,rowHeight:ne=0,colWidth:ee=0,showValue:Z,mergeValues:z=!1,theme:q,label:ie,formatValue:de,alignValue:ue="left",getTimeRange:fe,getValueColor:Se,getFieldConfig:he,hoverMulti:ce}=G;let me,pe;const ye=le=>{pe=Array(Y).fill(null).map(be=>Array(le).fill(null))},Pe=`500 ${Math.round(12*devicePixelRatio)}px ${q.typography.fontFamily}`,Ie=Array(Y).fill(null);let Oe=null;const Ne=[ee,1/0],We=1-Ne[0],Ae=(Ne[1]??1/0)*c.A.pxRatio,Ue=new Map,Me=new Map;function $e(le){Ue.forEach((be,De)=>{le.fillStyle=De,le.fill(be)}),Me.forEach((be,De)=>{le.strokeStyle=De,le.stroke(be)}),Ue.clear(),Me.clear()}function ke(le,be,De,Te,we,Ke,Ve,ht,gt,bt,St,Je,rt){Ve=Math.max(1,Ve);const Rt=Se(bt+1,Je),_t=he(bt),nn=O(_t,Rt);if(pe[bt][St]={x:D(we-De),y:D(Ke-Te),w:Ve,h:ht,sidx:bt+1,didx:St,fillColor:nn},rt){let Kt=nn,en=Ue.get(Kt);if(en==null&&Ue.set(Kt,en=new Path2D),be(en,we,Ke,Ve,ht),gt){let Qt=Rt,An=Me.get(Qt);An==null&&Me.set(Qt,An=new Path2D),be(An,we+gt/2,Ke+gt/2,Ve-gt,ht-gt)}}else le.beginPath(),be(le,we,Ke,Ve,ht),le.fillStyle=nn,le.fill(),gt&&(le.beginPath(),be(le,we+gt/2,Ke+gt/2,Ve-gt,ht-gt),le.strokeStyle=Rt,le.lineWidth=gt,le.stroke())}const Ze=(le,be,De,Te)=>(c.A.orient(le,be,(we,Ke,Ve,ht,gt,bt,St,Je,rt,Rt,_t,nn,Kt,en)=>{let Qt=D((we.width||0)*c.A.pxRatio),An=oe(be),un=An&&se(be);le.ctx.save(),en(le.ctx,le.bbox.left,le.bbox.top,le.bbox.width,le.bbox.height),le.ctx.clip(),x(ne,be-1,Y,_t,(fn,Tt,$t)=>{if(j===R.Changes)for(let Yt=0;Yt<Ve.length;Yt++){let Cn=Ve[Yt];if(Cn!=null||un){let Tn=Math.round(bt(Ke[Yt],ht,Rt,Je)),vn=Yt;for(;++vn<Ve.length&&(Ve[vn]===void 0||z&&Ve[vn]===Cn););let Kn=vn===Ve.length?Je+Rt+Qt:Math.round(bt(Ke[vn],ht,Rt,Je));ke(le.ctx,en,Je,rt,Tn,D(rt+Tt),Kn-Tn,D($t),Qt,fn,Yt,Cn,An),Yt=vn-1}}else if(j===R.Samples){let Yt=bt(Ke[1],ht,Rt,Je)-bt(Ke[0],ht,Rt,Je),Cn=Yt*We,Tn=D(E(Ae,Yt-Cn)-Qt),vn=Tn/2;for(let Kn=De;Kn<=Te;Kn++){let Yn=Ve[Kn];if(Yn!=null||un){let nt=bt(Ke[Kn],ht,Rt,Je);ke(le.ctx,en,Je,rt,D(nt-vn),D(rt+Tt),Tn,D($t),Qt,fn,Kn,Yn,An)}}}}),An&&(le.ctx.lineWidth=Qt,$e(le.ctx)),le.ctx.restore()}),null),ot=de==null||Z===u.yL.Never?!1:(le,be,De,Te)=>(le.ctx.save(),le.ctx.rect(le.bbox.left,le.bbox.top,le.bbox.width,le.bbox.height),le.ctx.clip(),le.ctx.font=Pe,le.ctx.textAlign=j===R.Changes?ue:"center",le.ctx.textBaseline="middle",c.A.orient(le,be,(we,Ke,Ve,ht,gt,bt,St,Je,rt,Rt,_t)=>{let nn=D((we.width||0)*c.A.pxRatio),en=oe(be)&&se(be),Qt=D(St(re[be-1],gt,_t,rt));for(let An=0;An<Ve.length;An++)if(Ve[An]!=null||en){const un=pe[be-1][An];if(!un||un.x>=Rt)continue;let fn=Math.floor(un?.w/M);if(Z===u.yL.Auto&&fn<2)continue;let Tt=de(be,Ve[An]),$t=D(un.x+Je+un.w/2);j===R.Changes&&(ue==="left"?$t=D(un.x+Je+nn+T):ue==="right"&&($t=D(un.x+Je+un.w-nn-T))),le.ctx.fillStyle=q.colors.getContrastText(un.fillColor,3),le.ctx.fillText(Tt.slice(0,fn),$t,Qt)}}),le.ctx.restore(),!1),xt=le=>{let be="";for(let De=32;De<=126;De++)be+=String.fromCharCode(De);M=Math.ceil(le.ctx.measureText(be).width/be.length*c.A.pxRatio),M+=2.5,le.root.querySelectorAll(".u-cursor-pt").forEach(De=>{De.style.borderRadius="0"})},ct=le=>{me=me||new v.C$(0,0,le.bbox.width,le.bbox.height),me.clear(),ye(le.data[0].length),le.series.forEach(be=>{be._paths=null})};function ft(le,be,De=!1){Ie.fill(null),Oe=null,!(le<0)&&me.get(le,0,c.A.pxRatio,1e4,Te=>{le>=Te.x&&le<=Te.x+Te.w&&(be>=Te.y&&be<=Te.y+Te.h?Ie[Te.sidx]=Oe=Te:(ce||De)&&(Ie[Te.sidx]=Te))})}const Le={x:j===R.Changes,y:!1,dataIdx:(le,be)=>{if(be===1){if(me.o.length===0&&me.q==null)for(const we of pe)for(const Ke of we)Ke&&me.add(Ke);let De=le.cursor.left*c.A.pxRatio,Te=le.cursor.top*c.A.pxRatio;ft(De,Te,le.cursor.event==null)}return Ie[be]?.didx},focus:{prox:1e3,dist:(le,be)=>Oe?.sidx===be?0:1/0},points:{fill:"rgba(255,255,255,0.2)",bbox:(le,be)=>{let De=Ie[be],Te=De!=null;return{left:Te?De.x/c.A.pxRatio:-10,top:Te?De.y/c.A.pxRatio:-10,width:Te?De.w/c.A.pxRatio:0,height:Te?De.h/c.A.pxRatio:0}}}},re=Array(Y).fill(0),X=[0,1];return{cursor:Le,xSplits:j===R.Samples?(le,be,De,Te,we,Ke)=>{let Ve=[],ht=le.data[0][1]-le.data[0][0],gt=S(we/ht);for(let bt=0;bt<le.data[0].length;bt+=gt){let St=le.data[0][bt];St>=De&&St<=Te&&Ve.push(St)}return Ve}:null,xRange:le=>{const be=fe();let De=be.from.valueOf(),Te=be.to.valueOf();if(j===R.Samples){let Ve=(le.data[0][1]-le.data[0][0])/2;De<=le.data[0][0]&&(De=le.data[0][0]-Ve);let ht=le.data[0].length-1;Te>=le.data[0][ht]&&(Te=le.data[0][ht]+Ve)}return[De,Te]},ySplits:le=>(x(ne,null,Y,le.bbox.height,(be,De,Te)=>{let we=D(De+Te/2);re[be]=le.posToVal(we/c.A.pxRatio,g.s)}),re),yValues:(le,be)=>be.map((De,Te)=>ie(Te+1)),yRange:X,drawPaths:Ze,drawPoints:ot,init:xt,drawClear:ct}}function O(G,j){if(j[0]==="#"&&j.length===9)return j;const Y=(G.fillOpacity??100)/100;return(0,y.alpha)(j,Y)}var R=(G=>(G.Changes="changes",G.Samples="samples",G))(R||{});const L={lineWidth:0,fillOpacity:80},N=({frame:G,theme:j,timeZones:Y,getTimeRange:oe,mode:se,rowHeight:ne,colWidth:ee,showValue:Z,alignValue:z,mergeValues:q,getValueColor:ie,hoverMulti:de})=>{const ue=new b.e(Y[0]),fe="x",Se=Pe=>{const Ie=Pe.config?.color?.mode;return!(Ie&&Pe.display&&Ie.startsWith("continuous-"))},he=Pe=>Pe.config.mappings?.some(Ie=>Ie.type===h.dM.SpecialValue&&Ie.options.match==="null")||!1,ce=(Pe,Ie)=>{const Oe=G.fields[Pe];return Oe.state?.origin?.fieldIndex!==void 0&&Oe.state?.origin?.frameIndex!==void 0&&ie?ie(Oe.state?.origin?.frameIndex,Oe.state?.origin?.fieldIndex,Ie):n.F},me={mode:se,numSeries:G.fields.length-1,isDiscrete:Pe=>Se(G.fields[Pe]),hasMappedNull:Pe=>he(G.fields[Pe]),mergeValues:q,rowHeight:ne,colWidth:ee,showValue:Z,alignValue:z,theme:j,label:Pe=>(0,a.Ct)(G.fields[Pe],G),getFieldConfig:Pe=>G.fields[Pe].config.custom,getValueColor:ce,getTimeRange:oe,formatValue:(Pe,Ie)=>(0,o.cN)(G.fields[Pe].display(Ie)),hoverMulti:de},pe=C(me);ue.addHook("init",pe.init),ue.addHook("drawClear",pe.drawClear),ue.setPrepData(Pe=>(0,P.bq)(Pe[0],(0,P.ro)(Pe[0]))),ue.setCursor(pe.cursor),ue.addScale({scaleKey:fe,isTime:!0,orientation:u.Lt.Horizontal,direction:u.ON.Right,range:pe.xRange}),ue.addScale({scaleKey:g.s,isTime:!1,orientation:u.Lt.Vertical,direction:u.ON.Up,range:pe.yRange}),ue.addAxis({scaleKey:fe,isTime:!0,splits:pe.xSplits,placement:u.vM.Bottom,timeZone:Y[0],theme:j,grid:{show:!0}}),ue.addAxis({scaleKey:g.s,isTime:!1,placement:u.vM.Left,splits:pe.ySplits,values:pe.yValues,grid:{show:!1},ticks:{show:!1},gap:16,theme:j});let ye=0;for(let Pe=0;Pe<G.fields.length;Pe++){if(Pe===0)continue;const Ie=G.fields[Pe],Oe=Ie.config,Ne={...L,...Oe.custom};Ie.state.seriesIndex=ye++,ue.addSeries({scaleKey:g.s,pathBuilder:pe.drawPaths,pointsBuilder:pe.drawPoints,lineWidth:Ne.lineWidth,fillOpacity:Ne.fillOpacity,theme:j,show:!Ne.hideFrom?.viz,thresholds:Oe.thresholds,dataFrameFieldIndex:Ie.state?.origin})}return ue};function F(G){let j=G.config.custom?.spanNulls;return j?j===!0?1/0:j:-1}function K(G,j){const Y=G.config.thresholds;if(G.type!==r.PU.number||!Y||!Y.steps.length)return;const oe=w(G.config,j);if(oe.length!==Y.steps.length)return;const se=new Map,ne=new Map;for(let z=0;z<oe.length;z++)se.set(Y.steps[z],oe[z].label),ne.set(oe[z].label,oe[z].color);let ee=G.values;const Z=new Array(G.values.length);if(Y.mode===i.O.Percentage){const{min:z,max:q}=(0,f.xg)(G),ie=q-z;ee=ee.map(de=>de==null?de:(de-z)/ie*100)}for(let z=0;z<Z.length;z++){const q=ee[z];q==null?Z[z]=q:Z[z]=se.get((0,d.yQ)(q,Y.steps))}return{...G,config:{...G.config,custom:{...G.config.custom,spanNulls:F(G)}},type:r.PU.string,values:Z,display:z=>({text:String(z),color:ne.get(String(z)),numeric:NaN})}}function B(G,j,Y,oe){if(!G?.length)return{warn:"No data in response"};(0,a.Fm)(G);let se=!1;const ne=[];for(let ee of G){let Z=-1,z=-1;for(let fe=0;fe<ee.fields.length;fe++)if(ee.fields[fe].type===r.PU.time){if(Z===-1)Z=fe;else if(z===-1){z=fe;break}}let q=Z!==-1,ie=!1;if(ee=(0,l.Yj)(ee,Z),z!==-1){let fe={...ee,fields:ee.fields.filter((he,ce)=>ce!==z)},Se={length:ee.length,fields:[ee.fields[z]]};ee=(0,l.Fd)({frames:[fe,Se],keepDisplayNames:!0,nullMode:()=>l.WO}),ee.fields.forEach((he,ce)=>{if(ce>0){let me=he.values;for(let pe=0;pe<me.length;pe++)me[pe]==null&&(me[pe]=null)}}),ie=!0}let de=(0,m.M)({frame:ee,refFieldPseudoMin:Y.from.valueOf(),refFieldPseudoMax:Y.to.valueOf()});de!==ee&&(ie=!0),ee=(0,s.C)(de);const ue=[];for(let fe of ee.fields)if(!fe.config.custom?.hideFrom?.viz)switch(fe.type){case r.PU.time:q=!0,se=!0,ue.push(fe);break;case r.PU.enum:case r.PU.number:if(j&&fe.config.color?.mode===n.Y.Thresholds){const Se=K(fe,oe);if(Se){ue.push(Se),ie=!0;continue}}case r.PU.boolean:case r.PU.string:fe={...fe,config:{...fe.config,custom:{...fe.config.custom,spanNulls:F(fe)}}},ie=!0,ue.push(fe);break;default:ie=!0}q&&ue.length>1&&(se=!0,ie?ne.push({...ee,fields:ue}):ne.push(ee))}return se?ne.length?{frames:ne}:{warn:"No graphable fields"}:{warn:"Data does not have a time field"}}function w(G,j){const Y=[],oe=G.thresholds;if(!oe||!oe.steps.length)return Y;const se=oe.steps,ne=(0,o.j_)(oe.mode===i.O.Percentage?"percent":G.unit??""),ee=Z=>(0,o.cN)(ne(Z,G.decimals??void 0));for(let Z=0;Z<se.length;Z++){let z=se[Z],q=z.value,ie="",de="";q===-1/0&&Z<se.length-1?(q=se[Z+1].value,ie="< "):de="+",Y.push({label:`${ie}${ee(q)}${de}`,color:j.visualization.getColorByName(z.color),yAxis:1})}return Y}function U(G,j,Y){if(!(!G||j.showLegend===!1))return W(V(G),Y)}function W(G,j){if(!G.length)return;const Y=[],oe=G[0].config,se=oe.color?.mode??n.Y.Fixed,ne=oe.thresholds;if(se===n.Y.Thresholds&&ne?.steps&&ne.steps.length>1)return w(oe,j);if(se.startsWith("continuous"))return;const ee=new Map;return G.forEach(Z=>{Z.config.custom?.hideFrom?.legend||Z.values.forEach(z=>{let q=Z.display(z);q.color&&ee.set(q.text,q.color)})}),ee.forEach((Z,z)=>{z.length>0&&Y.push({label:z,color:j.visualization.getColorByName(Z??n.F),yAxis:1})}),Y}function V(G){const j=[];for(const Y of G)for(const oe of Y.fields)oe.type!==r.PU.time&&j.push(oe);return j}function _(G,j){let Y,oe=j+1;if(oe>=G.values.length)return null;const se=G.values[j];for(;Y===void 0;){if(oe>=G.values.length)return null;const ne=G.values[oe];ne===void 0||ne===se?oe++:Y=oe}return Y}function H(G){if(G<0||Number.isNaN(G))return"";let j,Y,oe,se,ne,ee,Z,z;return Z=Math.floor(G/1e3),ee=Math.floor(Z/60),Z=Z%60,ne=Math.floor(ee/60),ee=ee%60,se=Math.floor(ne/24),ne=ne%24,j=Math.floor(se/365),j>0&&(se=se%365),Y=Math.floor(se/30),Y>0&&(se=se%30),oe=Math.floor(se/7),oe>0&&(se=se%7),z=Math.round(G%1e3*1e3)/1e3,(j>0?j+"y "+(Y>0?Y+"mo ":"")+(oe>0?oe+"w ":"")+(se>0?se+"d ":""):Y>0?Y+"mo "+(oe>0?oe+"w ":"")+(se>0?se+"d ":""):oe>0?oe+"w "+(se>0?se+"d ":""):se>0?se+"d "+(ne>0?ne+"h ":""):ne>0?ne+"h "+(ee>0?ee+"m ":""):ee>0?ee+"m "+(Z>0?Z+"s ":""):Z>0?Z+"s "+(z>0?z+"ms ":""):z>0?z+"ms ":"0").trim()}},76323:(Q,I,e)=>{"use strict";e.d(I,{J:()=>i});var n=e(32196),a=e(96540),o=e(14110),r=e(40845);const i=({text:d="PRO",className:l,experimentId:m,eventVariant:s="",...h})=>{const u=(0,r.of)(f);return(0,a.useEffect)(()=>{m&&(0,o.Xp)(m,"test",s)},[m,s]),a.createElement("span",{className:(0,n.cx)(u.badge,l),...h},d)},f=d=>({badge:(0,n.css)`
      margin-left: ${d.spacing(1.25)};
      border-radius: ${d.shape.borderRadius(5)};
      background-color: ${d.colors.success.main};
      padding: ${d.spacing(.25,.75)};
      color: white; // use the same color for both themes
      font-weight: ${d.typography.fontWeightMedium};
      font-size: ${d.typography.pxToRem(10)};
    `})},77454:(Q,I,e)=>{"use strict";e.d(I,{El:()=>m,Iz:()=>d,ep:()=>h});var n=e(32196),a=e(96540),o=e(14110),r=e(40845),i=e(14578),f=e(55852);const d=({featureName:g,className:P,children:c,text:y,featureId:p,eventVariant:v="",size:D="md",...E})=>{const S=(0,r.of)(l,D);return(0,a.useEffect)(()=>{(0,o.Xp)(`feature-highlights-${p}`,"test",v)},[v,p]),a.createElement("div",{className:(0,n.cx)(S.box,P),...E},a.createElement(i.I,{name:"rocket",className:S.icon}),a.createElement("div",{className:S.inner},a.createElement("p",{className:S.text},"You\u2019ve discovered a Pro feature! ",y||`Get the Grafana Pro plan to access ${g}.`),a.createElement(f.z9,{variant:"secondary",size:D,className:S.button,href:"https://grafana.com/profile/org/subscription",target:"__blank",rel:"noopener noreferrer"},"Upgrade")))},l=(g,P)=>{const c=g.shape.borderRadius(2),y=P==="md"?"body":"bodySmall";return{box:(0,n.css)`
      display: flex;
      align-items: center;
      position: relative;
      border-radius: ${c};
      background: ${g.colors.success.transparent};
      padding: ${g.spacing(2)};
      color: ${g.colors.success.text};
      font-size: ${g.typography[y].fontSize};
      text-align: left;
      line-height: 16px;
      margin: ${g.spacing(0,"auto",3,"auto")};
      max-width: ${g.breakpoints.values.xxl}px;
      width: 100%;
    `,inner:(0,n.css)`
      display: flex;
      align-items: center;
      width: 100%;
      justify-content: space-between;
    `,text:(0,n.css)`
      margin: 0;
    `,button:(0,n.css)`
      background-color: ${g.colors.success.main};
      font-weight: ${g.typography.fontWeightLight};
      color: white;

      &:hover {
        background-color: ${g.colors.success.main};
      }

      &:focus-visible {
        box-shadow: none;
        color: ${g.colors.text.primary};
        outline: 2px solid ${g.colors.primary.main};
      }
    `,icon:(0,n.css)`
      margin: ${g.spacing(.5,1,.5,.5)};
    `}},m=({listItems:g,image:P,featureUrl:c,featureName:y,description:p,caption:v,action:D})=>{const E=(0,r.of)(s);return a.createElement("div",{className:E.container},a.createElement("div",{className:E.content},a.createElement("h3",{className:E.title},"Get started with ",y),p&&a.createElement("h6",{className:E.description},p),a.createElement("ul",{className:E.list},g.map((S,T)=>a.createElement("li",{key:T},a.createElement(i.I,{name:"check",size:"xl",className:E.icon})," ",S))),D?.link&&a.createElement(f.z9,{variant:"primary",href:D.link},D.text),D?.onClick&&a.createElement(f.$n,{variant:"primary",onClick:D.onClick},D.text),c&&a.createElement(f.z9,{fill:"text",href:c,className:E.link,target:"_blank",rel:"noreferrer noopener"},"Learn more")),a.createElement("div",{className:E.media},a.createElement("img",{src:b(P),alt:"Feature screenshot"}),v&&a.createElement("p",{className:E.caption},v)))},s=g=>({container:(0,n.css)`
      display: flex;
      justify-content: space-between;
    `,content:(0,n.css)`
      width: 45%;
      margin-right: ${g.spacing(4)};
    `,media:(0,n.css)`
      width: 55%;

      img {
        width: 100%;
      }
    `,title:(0,n.css)`
      color: ${g.colors.text.maxContrast};
    `,description:(0,n.css)`
      color: ${g.colors.text.primary};
      font-weight: ${g.typography.fontWeightLight};
    `,list:(0,n.css)`
      list-style: none;
      margin: ${g.spacing(4,0,2,0)};

      li {
        display: flex;
        align-items: flex-start;
        color: ${g.colors.text.primary};
        padding: ${g.spacing(1,0)};
      }
    `,icon:(0,n.css)`
      color: ${g.colors.success.main};
      margin-right: ${g.spacing(1)};
    `,link:(0,n.css)`
      margin-left: ${g.spacing(2)};
    `,caption:(0,n.css)`
      font-weight: ${g.typography.fontWeightLight};
      margin: ${g.spacing(1,0,0)};
    `}),h=({featureName:g,description:P,featureUrl:c,image:y})=>{const p=(0,r.of)(u);return a.createElement("div",{className:p.container},a.createElement("h3",{className:p.title},"Get started with ",g),P&&a.createElement("h6",{className:p.description},P),a.createElement(f.z9,{fill:"text",href:c,target:"_blank",rel:"noreferrer noopener"},"Learn more"),a.createElement("div",{className:p.media},a.createElement("img",{src:b(y),alt:"Feature screenshot"})))},u=g=>({container:(0,n.css)`
      overflow: auto;
      height: 100%;
    `,title:(0,n.css)`
      color: ${g.colors.text.maxContrast};
    `,description:(0,n.css)`
      color: ${g.colors.text.primary};
      font-weight: ${g.typography.fontWeightLight};
    `,media:(0,n.css)`
      width: 100%;
      margin-top: ${g.spacing(2)};

      img {
        width: 100%;
      }
    `}),b=g=>g.startsWith("http")?g:"/public/img/enterprise/highlights/"+g},35043:(Q,I,e)=>{"use strict";e.d(I,{DP:()=>s,NQ:()=>m,zJ:()=>h});var n=e(32196),a=e(96540),o=e(90613),r=e(40845),i=e(14578),f=e(94753),d=e(2913),l=e(8484);const m=[{message:"At least 12 characters",validation:g=>g.length>=12},{message:"One uppercase letter",validation:g=>/[A-Z]+/.test(g)},{message:"One lowercase letter",validation:g=>/[a-z]+/.test(g)},{message:"One number",validation:g=>/[0-9]+/.test(g)},{message:"One symbol",validation:g=>/[\W]/.test(g)}],s=g=>!d.Ay.auth.basicAuthStrongPasswordPolicy||m.every(P=>P.validation(g))||(0,l.t)("profile.change-password.strong-password-validation-register","Password does not comply with the strong password policy"),h=({strongPasswordValidations:g,password:P,pristine:c})=>a.createElement(o.a,{marginBottom:2},g.map(y=>a.createElement(u,{key:y.message,strongPasswordValidation:y,password:P,pristine:c}))),u=({strongPasswordValidation:g,password:P,pristine:c})=>{const y=(0,r.of)(b),{basicAuthStrongPasswordPolicy:p}=d.Ay.auth;if(!p)return null;const{message:v,validation:D}=g,E=P.length>0&&D(P),S=E||c?"check":"exclamation-triangle",T=E?"secondary":c?"primary":"error";let M;return E?M=y.icon.valid:c?M=y.icon.pending:M=y.icon.error,a.createElement(o.a,{key:v,display:"flex",alignItems:"center",marginTop:1},a.createElement(i.I,{className:(0,n.cx)(y.icon.style,M),name:S}),a.createElement(f.E,{color:T},v))},b=g=>({icon:{style:(0,n.css)({marginRight:g.spacing(1)}),valid:(0,n.css)({color:g.colors.success.text}),pending:(0,n.css)({color:g.colors.secondary.text}),error:(0,n.css)({color:g.colors.error.text})}})},93522:(Q,I,e)=>{"use strict";e.d(I,{N:()=>s});var n=e(32196),a=e(96540),o=e(40845),r=e(37390),i=e(71259),f=e(94753),d=e(8484),l=e(63917);const m=g=>[{category:(0,d.t)("help-modal.shortcuts-category.global","Global"),shortcuts:[{keys:["g","h"],description:(0,d.t)("help-modal.shortcuts-description.go-to-home-dashboard","Go to Home Dashboard")},{keys:["g","d"],description:(0,d.t)("help-modal.shortcuts-description.go-to-dashboards","Go to Dashboards")},{keys:["g","e"],description:(0,d.t)("help-modal.shortcuts-description.go-to-explore","Go to Explore")},{keys:["g","p"],description:(0,d.t)("help-modal.shortcuts-description.go-to-profile","Go to Profile")},{keys:[`${g} + k`],description:(0,d.t)("help-modal.shortcuts-description.open-search","Open search")},{keys:["esc"],description:(0,d.t)("help-modal.shortcuts-description.exit-edit/setting-views","Exit edit/setting views")},{keys:["?"],description:(0,d.t)("help-modal.shortcuts-description.show-all-shortcuts","Show all keyboard shortcuts")},{keys:["c","t"],description:(0,d.t)("help-modal.shortcuts-description.change-theme","Change theme")}]},{category:(0,d.t)("help-modal.shortcuts-category.time-range","Time range"),shortcuts:[{keys:["t","z"],description:(0,d.t)("help-modal.shortcuts-description.zoom-out-time-range","Zoom out time range")},{keys:["t","\u2190"],description:(0,d.t)("help-modal.shortcuts-description.move-time-range-back","Move time range back")},{keys:["t","\u2192"],description:(0,d.t)("help-modal.shortcuts-description.move-time-range-forward","Move time range forward")},{keys:["t","a"],description:(0,d.t)("help-modal.shortcuts-description.make-time-range-permanent","Make time range absolute/permanent")},{keys:["t","c"],description:(0,d.t)("help-modal.shortcuts-description.copy-time-range","Copy time range")},{keys:["t","v"],description:(0,d.t)("help-modal.shortcuts-description.paste-time-range","Paste time range")}]},{category:(0,d.t)("help-modal.shortcuts-category.dashboard","Dashboard"),shortcuts:[{keys:[`${g} + s`],description:(0,d.t)("help-modal.shortcuts-description.save-dashboard","Save dashboard")},{keys:["d","r"],description:(0,d.t)("help-modal.shortcuts-description.refresh-all-panels","Refresh all panels")},{keys:["d","s"],description:(0,d.t)("help-modal.shortcuts-description.dashboard-settings","Dashboard settings")},{keys:["d","v"],description:(0,d.t)("help-modal.shortcuts-description.toggle-active-mode","Toggle in-active / view mode")},{keys:["d","k"],description:(0,d.t)("help-modal.shortcuts-description.toggle-kiosk","Toggle kiosk mode (hides top nav)")},{keys:["d","\u21E7 + e"],description:(0,d.t)("help-modal.shortcuts-description.expand-all-rows","Expand all rows")},{keys:["d","\u21E7 + c"],description:(0,d.t)("help-modal.shortcuts-description.collapse-all-rows","Collapse all rows")},{keys:["d","a"],description:(0,d.t)("help-modal.shortcuts-description.toggle-auto-fit","Toggle auto fit panels (experimental feature)")},{keys:[`${g} + o`],description:(0,d.t)("help-modal.shortcuts-description.toggle-graph-crosshair","Toggle shared graph crosshair")},{keys:["d","l"],description:(0,d.t)("help-modal.shortcuts-description.toggle-all-panel-legends","Toggle all panel legends")},{keys:["d","x"],description:(0,d.t)("help-modal.shortcuts-description.toggle-exemplars","Toggle exemplars in all panel")}]},{category:(0,d.t)("help-modal.shortcuts-category.focused-panel","Focused panel"),shortcuts:[{keys:["e"],description:(0,d.t)("help-modal.shortcuts-description.toggle-panel-edit","Toggle panel edit view")},{keys:["v"],description:(0,d.t)("help-modal.shortcuts-description.toggle-panel-fullscreen","Toggle panel fullscreen view")},{keys:["p","s"],description:(0,d.t)("help-modal.shortcuts-description.open-shared-modal","Open Panel Share Modal")},{keys:["p","d"],description:(0,d.t)("help-modal.shortcuts-description.duplicate-panel","Duplicate Panel")},{keys:["p","r"],description:(0,d.t)("help-modal.shortcuts-description.remove-panel","Remove Panel")},{keys:["p","l"],description:(0,d.t)("help-modal.shortcuts-description.toggle-panel-legend","Toggle panel legend")}]}],s=({onDismiss:g})=>{const P=(0,o.of)(b),c=(0,a.useMemo)(()=>(0,l.gn)(),[]),y=(0,a.useMemo)(()=>m(c),[c]);return a.createElement(r.a,{title:(0,d.t)("help-modal.title","Shortcuts"),isOpen:!0,onDismiss:g,onClickBackdrop:g},a.createElement(i.x,{columns:{xs:1,sm:2},gap:3,tabIndex:0},Object.values(y).map(({category:p,shortcuts:v})=>a.createElement("section",{key:p},a.createElement("table",{className:P.table},a.createElement("caption",null,a.createElement(f.E,{element:"p",variant:"h5"},p)),a.createElement("thead",{className:"sr-only"},a.createElement("tr",null,a.createElement("th",null,"Keys"),a.createElement("th",null,"Description"))),a.createElement("tbody",null,v.map(({keys:D,description:E})=>a.createElement("tr",{key:D.join()},a.createElement("td",{className:P.keys},D.map(S=>a.createElement(h,{key:S},S))),a.createElement("td",null,a.createElement(f.E,{variant:"bodySmall",element:"p"},E))))))))))},h=({children:g})=>{const P=(0,o.of)(b),c=(0,a.useMemo)(()=>u(g),[g]),y=a.createElement("span",{dangerouslySetInnerHTML:{__html:c}});return a.createElement("kbd",{className:P.shortcutTableKey},a.createElement(f.E,{variant:"code"},y))};function u(g){let P,c;if(g.includes("ctrl"))P="ctrl",c="Control";else if(g.includes("esc"))P="esc",c="Escape";else return g;return g.replace(P,`<span class="sr-only">${c}</span><span aria-hidden="true" role="none">${P}</span>`)}function b(g){return{table:(0,n.css)({borderCollapse:"separate",borderSpacing:g.spacing(2),"& caption":{captionSide:"top"}}),keys:(0,n.css)({textAlign:"end",whiteSpace:"nowrap",minWidth:83}),shortcutTableKey:(0,n.css)({display:"inline-block",textAlign:"center",marginRight:g.spacing(.5),padding:"3px 5px",lineHeight:"10px",verticalAlign:"middle",border:`solid 1px ${g.colors.border.medium}`,borderRadius:g.shape.radius.default,color:g.colors.text.primary,backgroundColor:g.colors.background.secondary})}}},2913:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>r,_R:()=>f,config:()=>a.$,yn:()=>d,zj:()=>i});var n=e(43429),a=e(32264);let o=a.$;const r=o,i=()=>o,f=l=>{o={...o,...l}},d=a.$.panels?.debug?.state===n.pn.alpha},15054:(Q,I,e)=>{"use strict";e.d(I,{FG:()=>u,HG:()=>i,IZ:()=>s,MM:()=>g,Pz:()=>r,bJ:()=>d,cV:()=>o,cx:()=>l,dU:()=>a,o9:()=>f,sD:()=>n,tH:()=>m,wV:()=>b});const n=30,a=8,o=24,r="v",i="h",f=4,d=250,l=n*3,m="panel-copy",s=2,h=23763571993,u=40,b="VisualizationSelectPane.ListMode",g="WidgetSelectPane.ListMode"},76888:(Q,I,e)=>{"use strict";e.d(I,{Il:()=>r,YE:()=>o,ni:()=>i});var n=e(96540),a=e(12131);const o=n.createContext(void 0);function r(){const f=(0,n.useContext)(o);if(!f)throw new Error("No GrafanaContext found");return f}function i(){const{chrome:f}=r();return(0,n.useCallback)((d,l)=>{const{pathname:m,search:s}=a.Ny.getLocation();f.setReturnToPrevious({title:d,href:l??m+s})},[f])}},3169:(Q,I,e)=>{"use strict";e.d(I,{_2:()=>u,gi:()=>s,q8:()=>h,tZ:()=>m});var n=e(96540),a=e(62938),o=e(94954),r=e(31678),i=e(82467);const f={title:"",text:"",severity:r.AppNotificationSeverity.Success,icon:"check"},d={title:"",text:"",severity:r.AppNotificationSeverity.Warning,icon:"exclamation-triangle"},l={title:"",text:"",severity:r.AppNotificationSeverity.Error,icon:"exclamation-triangle"},m=(b,g="",P)=>({...f,title:b,text:g,id:(0,a.A)(),timestamp:Date.now(),showing:!0}),s=(b,g="",P,c)=>({...l,text:(0,o.q)(g),title:b,id:(0,a.A)(),traceId:P,component:c,timestamp:Date.now(),showing:!0}),h=(b,g="",P)=>({...d,title:b,text:g,traceId:P,id:(0,a.A)(),timestamp:Date.now(),showing:!0});function u(){const b=(0,r.useDispatch)();return(0,n.useMemo)(()=>({success:(g,P="")=>{b((0,i.dx)(m(g,P)))},warning:(g,P="",c)=>{b((0,i.dx)(h(g,P,c)))},error:(g,P="",c)=>{b((0,i.dx)(s(g,P,c)))}}),[b])}},10096:(Q,I,e)=>{"use strict";e.d(I,{Ef:()=>a.E,contextSrv:()=>o.TP,lE:()=>n.A,rO:()=>r.r});var n=e(28138),a=e(18898),o=e(16233),r=e(31140)},39640:(Q,I,e)=>{"use strict";e.d(I,{$H:()=>m,Ay:()=>s});var n=e(2543),a=e(33390),o=e(38877),r=e(19347);const i=v=>{const D=(0,r.l)().getInstanceSettings(v.datasourceName);return{id:v.ts.toString(),createdAt:v.ts,datasourceName:v.datasourceName,datasourceUid:D?.uid||"",starred:v.starred,comment:v.comment,queries:v.queries}},f=v=>{if(!(0,r.l)().getInstanceSettings({uid:v.datasourceUid}))throw new Error("Datasource not found.");return{ts:v.createdAt,datasourceName:v.datasourceName,starred:v.starred,comment:v.comment,queries:v.queries}};var d=e(75533);const l="grafana.explore.richHistory",m=1e4;class s{async getRichHistory(D){const E=g().map(i),S=D.starred?E.filter(A=>A.starred===!0):E,T=D.from&&D.to?[D.from,D.to]:void 0,M=(0,d.a_)(S,D.sortOrder,D.datasourceFilters,D.search,T);return{richHistory:M,total:M.length}}async addToRichHistory(D){const E=Date.now(),S={id:E.toString(),createdAt:E,...D},T=f(S),M=u(g()),A=T.queries.map(L=>(0,n.omit)(L,["key","refId"])),x=M.length>0&&M[0].queries.map(L=>(0,n.omit)(L,["key","refId"]));if((0,n.isEqual)(A,x)){const L=new Error("Entry already exists");throw L.name=o.m.DuplicatedEntry,L}const{queriesToKeep:C,limitExceeded:O}=b(M),R=[T,...C];try{a.A.setObject(l,R)}catch(L){if(L instanceof Error&&L.name==="QuotaExceededError")p(o.m.StorageFull,`Saving rich history failed: ${L.message}`);else throw L}return O?{warning:{type:o.C.LimitExceeded,message:`Query history reached the limit of ${m}. Old, not-starred items have been removed.`},richHistoryQuery:S}:{richHistoryQuery:S}}async deleteAll(){a.A.delete(l)}async deleteRichHistory(D){const E=parseInt(D,10),T=a.A.getObject(l,[]).filter(M=>M.ts!==E);a.A.setObject(l,T)}async updateStarred(D,E){return h(D,S=>S.starred=E)}async updateComment(D,E){return h(D,S=>S.comment=E)}async getSettings(){return{activeDatasourcesOnly:a.A.getObject(d.mE.activeDatasourcesOnly)??a.A.getObject(d.mE.legacyActiveDatasourceOnly,!1),retentionPeriod:a.A.getObject(d.mE.retentionPeriod,7),starredTabAsFirstTab:a.A.getBool(d.mE.starredTabAsFirstTab,!1),lastUsedDatasourceFilters:a.A.getObject(d.mE.datasourceFilters,[]).map(E=>E.value)}}async updateSettings(D){a.A.set(d.mE.activeDatasourcesOnly,D.activeDatasourcesOnly),a.A.set(d.mE.retentionPeriod,D.retentionPeriod),a.A.set(d.mE.starredTabAsFirstTab,D.starredTabAsFirstTab),a.A.setObject(d.mE.datasourceFilters,(D.lastUsedDatasourceFilters||[]).map(E=>({value:E})))}}function h(v,D){const E=parseInt(v,10),S=a.A.getObject(l,[]),T=(0,n.find)(S,{ts:E});if(!T)throw new Error("Rich history item not found.");return D(T),a.A.setObject(l,S),i(T)}function u(v){const D=a.A.getObject(d.mE.retentionPeriod,7),E=(0,d.wQ)(D,{isLastTs:!1});return v.filter(S=>S.ts>E||S.starred===!0)||[]}function b(v){let D=!1,E=v.length-1;for(;E>=0&&v.length>=m;)v[E].starred||(v.splice(E,1),D=!0),E--;return{queriesToKeep:v,limitExceeded:D}}function g(){const v=a.A.getObject(l,[]);return P(v)}function P(v){return v.map(E=>{const S=E.queries.map((T,M)=>c(E,T,M));return{...E,queries:S}})}function c(v,D,E){const S="ABCDEFGHIJKLMNOPQRSTUVXYZ";return typeof D=="object"?D:y(D)?JSON.parse(D):{expr:D,refId:S[E]}}function y(v){try{JSON.parse(v)}catch{return!1}return!0}function p(v,D){const E=new Error(D);throw E.name=v,E}},38877:(Q,I,e)=>{"use strict";e.d(I,{C:()=>a,m:()=>n});var n=(o=>(o.StorageFull="StorageFull",o.DuplicatedEntry="DuplicatedEntry",o))(n||{}),a=(o=>(o.LimitExceeded="LimitExceeded",o))(a||{})},75533:(Q,I,e)=>{"use strict";e.d(I,{a_:()=>i,mE:()=>h,wQ:()=>f});var n=e(2543),a=e.n(n),o=e(47232),r=e(91650);function i(u,b,g,P,c){const y=l(u,g),p=m(y,P),v=c?d(p,c):p;return s(v,b)}const f=(u,b)=>{let g=b.now;return g||(g=b.tz?(0,o.oZ)(b.tz):(0,o.KQ)()),g.add(-u,"d"),(b.isLastTs?g.endOf("d"):g.startOf("d")).valueOf()};function d(u,b){return u.filter(g=>g.createdAt>b[0]&&g.createdAt<b[1])}function l(u,b){return b.length>0?u.filter(g=>b.includes(g.datasourceName)):u}function m(u,b){return u.filter(g=>g.comment.includes(b)?!0:g.queries.filter(c=>Object.values((0,n.omit)(c,["datasource","key","refId","hide","queryType"])).some(y=>y?.toString().includes(b))).length>0)}const s=(u,b)=>{let g;return b===r.x.Ascending&&(g=(P,c)=>P.createdAt<c.createdAt?-1:P.createdAt>c.createdAt?1:0),b===r.x.Descending&&(g=(P,c)=>P.createdAt<c.createdAt?1:P.createdAt>c.createdAt?-1:0),b===r.x.DatasourceZA&&(g=(P,c)=>P.datasourceName<c.datasourceName?-1:P.datasourceName>c.datasourceName?1:0),b===r.x.DatasourceAZ&&(g=(P,c)=>P.datasourceName<c.datasourceName?1:P.datasourceName>c.datasourceName?-1:0),u.sort(g)},h={retentionPeriod:"grafana.explore.richHistory.retentionPeriod",starredTabAsFirstTab:"grafana.explore.richHistory.starredTabAsFirstTab",legacyActiveDatasourceOnly:"grafana.explore.richHistory.activeDatasourceOnly",activeDatasourcesOnly:"grafana.explore.richHistory.activeDatasourcesOnly",datasourceFilters:"grafana.explore.richHistory.datasourceFilters"}},11401:(Q,I,e)=>{"use strict";e.d(I,{tU:()=>c,a:()=>P,gQ:()=>y});var n=e(32264),a=e(10096),o=e(91650),r=e(39640),i=e(75505),f=e(17172),d=e(19347),l=e(65615);const m=p=>{const v=(0,d.l)().getInstanceSettings({uid:p.datasourceUid});return{id:p.uid,createdAt:p.createdAt*1e3,datasourceName:v?.name||"",datasourceUid:p.datasourceUid,starred:p.starred,comment:p.comment,queries:p.queries}},s=p=>({uid:p.id,createdAt:Math.floor(p.createdAt/1e3),datasourceUid:p.datasourceUid,starred:p.starred,comment:p.comment,queries:p.queries});class h{constructor(){this.preferenceService=new l.W("user")}async addToRichHistory(v){const{result:D}=await(0,f.AI)().post("/api/query-history",{dataSourceUid:v.datasourceUid,queries:v.queries});return{richHistoryQuery:m(D)}}async deleteAll(){throw new Error("not supported")}async deleteRichHistory(v){(0,f.AI)().delete(`/api/query-history/${v}`)}async getRichHistory(v){const D=u(v);let E="query-history-get-all";v.starred&&(E="query-history-get-starred");const T=(await(0,i.s)((0,f.AI)().fetch({method:"GET",url:`/api/query-history?${D}`,requestId:E}))).data,M=(T.result.queryHistory||[]).map(m),A=T.result.totalCount||0;return{richHistory:M,total:A}}async getSettings(){return{activeDatasourcesOnly:!1,lastUsedDatasourceFilters:void 0,retentionPeriod:14,starredTabAsFirstTab:(await this.preferenceService.load()).queryHistory?.homeTab==="starred"}}async updateComment(v,D){const E=await(0,f.AI)().patch(`/api/query-history/${v}`,{comment:D});return m(E.result)}updateSettings(v){return this.preferenceService.patch({queryHistory:{homeTab:v.starredTabAsFirstTab?"starred":"query"}})}async updateStarred(v,D){let E;return D?E=await(0,f.AI)().post(`/api/query-history/star/${v}`):E=await(0,f.AI)().delete(`/api/query-history/star/${v}`),m(E.result)}}function u(p){let v=`${p.datasourceFilters.map(D=>{const E=(0,d.l)().getInstanceSettings(D).uid;return`datasourceUid=${encodeURIComponent(E)}`}).join("&")}`;return p.search&&(v=v+`&searchString=${p.search}`),p.sortOrder&&(v=v+`&sort=${p.sortOrder===o.x.Ascending?"time-asc":"time-desc"}`),p.starred||(v=v+`&to=${p.to}`,v=v+`&from=${p.from}`),v=v+"&limit=100",v=v+`&page=${p.page||1}`,p.starred&&(v=v+`&onlyStarred=${p.starred}`),v}const b=new r.Ay,g=new h,P=()=>n.$.queryHistoryEnabled?g:b,c=()=>b,y=()=>n.$.queryHistoryEnabled?{availableFilters:[o.x.Descending,o.x.Ascending],lastUsedDataSourcesAvailable:!1,clearHistory:!1,onlyActiveDataSource:!1,changeRetention:!1,queryHistoryAvailable:a.contextSrv.isSignedIn}:{availableFilters:[o.x.Descending,o.x.Ascending,o.x.DatasourceAZ,o.x.DatasourceZA],lastUsedDataSourcesAvailable:!0,clearHistory:!0,onlyActiveDataSource:!0,changeRetention:!0,queryHistoryAvailable:!0}},16021:(Q,I,e)=>{"use strict";e.d(I,{u:()=>a});var n=e(96540);function a(o,r){const[i,f]=(0,n.useState)();return(0,n.useEffect)(()=>{const d=o.subscribe(r,f);return()=>d.unsubscribe()},[o,r]),i}},60619:(Q,I,e)=>{"use strict";e.d(I,{Y:()=>a});var n=e(96540);function a({breakpoint:o,onChange:r}){(0,n.useEffect)(()=>{const i=window.matchMedia(`(min-width: ${o}px)`),f=d=>r(d);return i.addEventListener("change",f),()=>i.removeEventListener("change",f)},[o,r])}},25249:(Q,I,e)=>{"use strict";e.d(I,{C:()=>o});var n=e(31678),a=e(17422);const o=r=>{const i=(0,n.useSelector)(f=>f.navIndex);return(0,a.tc)(i,r)}},83277:(Q,I,e)=>{"use strict";e.d(I,{s:()=>r});var n=e(96540),a=e(24180),o=e(12131);function r(){const{search:i}=(0,a.zy)(),f=(0,n.useMemo)(()=>(0,o.SE)(i||""),[i]),d=(0,n.useCallback)((l,m)=>o.Ny.partial(l,m),[]);return[f,d]}},74513:(Q,I,e)=>{"use strict";e.d(I,{MB:()=>o,NY:()=>r,Nm:()=>s,Yj:()=>h,dK:()=>b,d_:()=>i,fY:()=>l,jQ:()=>d,rT:()=>f,rd:()=>u,wi:()=>m});var n=e(2543),a=e.n(n);const o="en-US",r="fr-FR",i="es-ES",f="de-DE",d="pt-BR",l="zh-Hans",m="pseudo-LOCALE",s=o,h=[{code:o,name:"English",loader:{grafana:()=>e.e(9521).then(e.t.bind(e,19521,19))}},{code:r,name:"Fran\xE7ais",loader:{grafana:()=>e.e(5648).then(e.t.bind(e,35648,19))}},{code:i,name:"Espa\xF1ol",loader:{grafana:()=>e.e(680).then(e.t.bind(e,70680,19))}},{code:f,name:"Deutsch",loader:{grafana:()=>e.e(3082).then(e.t.bind(e,23082,19))}},{code:l,name:"\u4E2D\u6587\uFF08\u7B80\u4F53\uFF09",loader:{grafana:()=>e.e(9538).then(e.t.bind(e,29538,19))}},{code:d,name:"Portugu\xEAs Brasileiro",loader:{grafana:()=>e.e(2288).then(e.t.bind(e,12288,19))}}];{const g=e(55905);if(g.keys().includes("app/extensions/locales/localeExtensions")){const{LOCALE_EXTENSIONS:P,ENTERPRISE_I18N_NAMESPACE:c}=g("app/extensions/locales/localeExtensions");for(const y of h){const p=P[y.code];p&&(y.loader[c]=p)}}}const u=h.map(g=>g.code),b=(0,n.uniq)(h.flatMap(g=>Object.keys(g.loader)))},8484:(Q,I,e)=>{"use strict";e.d(I,{x6:()=>h,Xj:()=>b,JL:()=>m,t:()=>u});var n=e(72635),a=e(94997),o=e(96540),r=e(32389),i=e(74513);const f=g=>g.split("-")[0].toLowerCase(),d={type:"backend",init(){},async read(g,P,c){let y=i.Yj.find(D=>D.code===g);if(y||(y=i.Yj.find(D=>f(D.code)===f(g))),!y)return c(new Error(`No message loader available for ${g}`),null);const p=y.loader[P];if(!p)return c(new Error(`No message loader available for ${g} with namespace ${P}`),null);const v=await p();c(null,v)}};let l;async function m(g){const P={partialBundledLanguages:!0,resources:{},returnEmptyString:!1,supportedLngs:i.rd,fallbackLng:i.Nm,ns:i.dK};let c=n.default;if(g==="detect"){c=c.use(a.A);const p={order:["navigator"],caches:[]};P.detection=p}else P.lng=i.rd.includes(g)?g:void 0;return await c.use(d).use(r.r9).init(P),l=n.default.getFixedT(null,i.dK),{language:c.resolvedLanguage}}function s(g){const P=VALID_LANGUAGES.includes(g)?g:void 0;return i18n.changeLanguage(P)}const h=g=>o.createElement(r.x6,{shouldUnescape:!0,ns:i.dK,...g}),u=(g,P,c)=>(l||(console.warn("t() was called before i18n was initialized. This is probably caused by calling t() in the root module scope, instead of lazily on render"),l=n.default.t),l(g,P,c)),b=(g,P={})=>typeof g=="string"?b(new Date(g),P):new Intl.DateTimeFormat(n.default.language,P).format(g)},18898:(Q,I,e)=>{"use strict";e.d(I,{E:()=>a});class n{constructor(){this.panelsRendered=0,this.enabled=void 0}renderingCompleted(){this.panelsRendered+=1,window.panelsRendered=this.panelsRendered}}const a=new n},16001:(Q,I,e)=>{"use strict";e.d(I,{$K:()=>P,Do:()=>s,XC:()=>u,XR:()=>h,dx:()=>m,fX:()=>v,g5:()=>g,oF:()=>b,qN:()=>p});var n=e(65307),a=e(25508),o=e(31678);const r=25,i="notifications",f=`${i}/lastRead`,d={byId:T(),lastRead:Number.parseInt(window.localStorage.getItem(f)??`${Date.now()}`,10)},l=(0,n.Z0)({name:"appNotifications",initialState:d,reducers:{notifyApp:(A,{payload:x})=>{Object.values(A.byId).some(C=>D(x,C)&&C.showing)||(A.byId[x.id]=x,M(A.byId))},hideAppNotification:(A,{payload:x})=>{x in A.byId&&(A.byId[x].showing=!1,M(A.byId))},clearNotification:(A,{payload:x})=>{delete A.byId[x],M(A.byId)},clearAllNotifications:A=>{A.byId={},M(A.byId)},readAllNotifications:(A,{payload:x})=>{A.lastRead=x}}}),{notifyApp:m,hideAppNotification:s,clearNotification:h,clearAllNotifications:u,readAllNotifications:b}=l.actions,g=l.reducer,P=A=>A.lastRead,c=A=>A.byId,y=(0,a.Mz)(c,A=>Object.values(A).sort((x,C)=>C.timestamp-x.timestamp)),p=(0,a.Mz)(y,A=>A.filter(E)),v=(0,a.Mz)(c,A=>Object.values(A).filter(x=>x.showing));function D(A,x){return A.icon===x.icon&&A.severity===x.severity&&A.text===x.text&&A.title===x.title}function E(A){return A.severity===o.AppNotificationSeverity.Warning||A.severity===o.AppNotificationSeverity.Error}function S(A){return typeof A=="object"&&A!==null&&"id"in A&&"icon"in A&&"title"in A&&"text"in A}function T(){const A=window.localStorage.getItem(i);if(!A)return{};const x=JSON.parse(A);return Object.values(x).every(C=>S(C))?x:{}}function M(A){const x=Object.values(A).filter(E).sort((C,O)=>O.timestamp-C.timestamp).slice(0,r).reduce((C,O)=>(C[O.id]={id:O.id,severity:O.severity,icon:O.icon,title:O.title,text:O.text,traceId:O.traceId,timestamp:O.timestamp,showing:!1},C),{});try{window.localStorage.setItem(i,JSON.stringify(x))}catch(C){console.error("Unable to persist notifications to local storage"),console.error(C)}}},91219:(Q,I,e)=>{"use strict";e.d(I,{I_:()=>h,L1:()=>f,TU:()=>s,ci:()=>l,fc:()=>m});var n=e(65307),a=e(32264),o=e(36689);const r=a.$.bootData?.navTree??[];function i(u){return u.map(b=>{const g=b.children&&i(b.children);return{...b,children:g,text:(0,o.C)(b.id)??b.text,subTitle:(0,o.o)(b.id)??b.subTitle,emptyMessage:(0,o.C)(b.emptyMessageId)}})}const f="starred/",d=(0,n.Z0)({name:"navBarTree",initialState:()=>i(a.$.bootData?.navTree??[]),reducers:{setStarred:(u,b)=>{const g=u.find(v=>v.id==="starred"),{id:P,title:c,url:y,isStarred:p}=b.payload;if(g)if(p){g.children||(g.children=[]);const v={id:f+P,text:c,url:y};g.children.push(v),g.children.sort((D,E)=>D.text.localeCompare(E.text))}else{const v=g.children?.findIndex(D=>D.id===f+P)??-1;v>-1&&g?.children?.splice(v,1)}},updateDashboardName:(u,b)=>{const{id:g,title:P,url:c}=b.payload,y=u.find(p=>p.id==="starred");if(y){const p=y.children?.find(v=>v.id===g);p&&(p.text=P,p.url=c,y.children?.sort((v,D)=>v.text.localeCompare(D.text)))}},removePluginFromNavTree:(u,b)=>{const g="plugin-page-"+b.payload.pluginID,P=u.findIndex(c=>c.id===g);P>-1&&u.splice(P,1)}}}),{setStarred:l,removePluginFromNavTree:m,updateDashboardName:s}=d.actions,h=d.reducer},28215:(Q,I,e)=>{"use strict";e.d(I,{Id:()=>f,Im:()=>b,Vz:()=>h,YA:()=>u,_h:()=>P,s2:()=>d});var n=e(65307),a=e(2543),o=e.n(a),r=e(2913),i=e(36689);const f="home";function d(){const c={},y=(0,a.cloneDeep)(r.Ay.bootData.navTree),p=y.find(D=>D.id===f),v=y.filter(D=>D.id!==f);return p&&l(c,[p]),l(c,v,c[f]),c}function l(c,y,p){const v=[];for(const D of y){const E={...D,text:(0,i.C)(D.id)??D.text,subTitle:(0,i.o)(D.id)??D.subTitle,emptyMessage:(0,i.C)(D.emptyMessageId),parentItem:p};E.id&&(c[E.id]=E),E.children&&l(c,E.children,E),v.push(E)}p&&(p.children=v),c["not-found"]={...m("Page not found","404 Error").node},c.error={...m("Page error","An unexpected error").node}}function m(c,y){const p={text:c,subTitle:y,icon:"exclamation-triangle"};return{node:p,main:p}}const s={},h=(0,n.VP)("navIndex/updateNavIndex"),u=(0,n.VP)("navIndex/updateConfigurationSubtitle"),b=(0,n.VP)("navIndex/removeNavIndex"),g=(c,y)=>({...c,parentItem:{...c.parentItem,text:c.parentItem?.text??"",subTitle:y}}),P=(c=s,y)=>{if(h.match(y)){let v=function(S){if(S.children)for(const T of S.children)D[T.id]={...T,parentItem:S};S.parentItem&&v(S.parentItem)};var p=v;const D={},E=y.payload;return v(E),{...c,...D}}else if(u.match(y)){const v=`Organization: ${y.payload}`;return{...c,cfg:{...c.cfg,subTitle:v},datasources:g(c.datasources,v),correlations:g(c.correlations,v),users:g(c.users,v),teams:g(c.teams,v),plugins:g(c.plugins,v),"org-settings":g(c["org-settings"],v),apikeys:g(c.apikeys,v)}}else b.match(y)&&delete c[y.payload];return c}},17422:(Q,I,e)=>{"use strict";e.d(I,{rH:()=>f,tc:()=>i});var n=e(41811),a=e(71101),o=e(28215);const r=()=>{const m={id:"not-found",text:"Page not found",icon:"exclamation-triangle",subTitle:"404 Error",url:"not-found"};return{node:m,main:m}},i=(0,n.A)((m,s,h,u=!1)=>{if(m[s]){const b=m[s],g=u?b:f(b),P=d(g,s);return{node:b,main:P}}return h||r()});function f(m){return m.id===a.Rj?m:m.parentItem&&m.parentItem.id!==o.Id?f(m.parentItem):m}function d(m,s){return m.id===s?{...m,active:!0}:m.children&&m.children.length>0?{...m,children:m.children.map(h=>d(h,s))}:m}const l=m=>`${m.main.text}${m.node.text?": "+m.node.text:""}`},65615:(Q,I,e)=>{"use strict";e.d(I,{W:()=>a});var n=e(27677);class a{constructor(r){this.resourceUri=r}update(r){return n.IB.put(`/api/${this.resourceUri}/preferences`,r)}patch(r){return n.IB.patch(`/api/${this.resourceUri}/preferences`,r)}load(){return n.IB.get(`/api/${this.resourceUri}/preferences`)}}},2619:(Q,I,e)=>{"use strict";e.d(I,{Q:()=>r});var n=e(96540),a=e(13752),o=e(69731);class r{constructor(d){this._subject=new a.B,this._state=d}useState(){return i(this)}get state(){return this._state}setState(d){this._state={...this._state,...d},this._subject.next(this._state)}subscribeToState(d){return this._subject.subscribe(d)}}function i(f){const d=(0,o.C)();return(0,n.useEffect)(()=>{const l=f.subscribeToState({next:d});return()=>l.unsubscribe()},[f,d]),f.state}},27677:(Q,I,e)=>{"use strict";e.d(I,{Mf:()=>Oe,IB:()=>Ne,AI:()=>We});var n=e(56568),a=e(13752),o=e(75505),r=e(88483),i=e(64423),f=e(13288),d=e(65474),l=e(20039),m=e(81160),s=e(69862),h=e(59099),u=e(37748),b=e(66847),g=e(67791),P=e(16126),c=e(41560),y=e(69850),p=e(1005),v=e(62938),D=e(26272),E=e(40187),S=e(95344),T=e(32264),M=e(28138),A=e(2913),x=e(92315),C=e(67027),O=e(28676),R=e(32196),L=e(96540),N=e(40845),F=e(17464),K=e(37166),B=e(55852),w=e(88448);const U=Ae=>{const Ue=(0,N.of)(W),Me=(0,N.$j)(),$e=(0,w.o)(Me),ke=!!Ae.maxConcurrentSessions,Ze=()=>{window.location.reload()};return L.createElement(F.ZL,null,L.createElement("div",{className:$e.modal},L.createElement(K.w,{title:"You have been automatically signed out",severity:"warning",className:Ue.infobox},L.createElement("div",{className:Ue.text},L.createElement("p",null,"Your session token was automatically revoked because you have reached",L.createElement("strong",null,` the maximum number of ${ke?Ae.maxConcurrentSessions:""} concurrent sessions `),"for your account."),L.createElement("p",null,L.createElement("strong",null,"To resume your session, sign in again."),"Contact your administrator or visit the license page to review your quota if you are repeatedly signed out automatically.")),L.createElement(B.$n,{size:"md",variant:"primary",onClick:Ze},"Sign in"))),L.createElement("div",{className:(0,R.cx)($e.modalBackdrop,Ue.backdrop)}))},W=Ae=>({infobox:(0,R.css)`
    margin-bottom: 0;
  `,text:(0,R.css)`
    margin: ${Ae.spacing(1,0,2)};
  `,backdrop:(0,R.css)`
    background-color: ${Ae.colors.background.canvas};
    opacity: 0.8;
  `});var V=e(28444),_=e(2543);const H=Ae=>{const Ue=Ae.method,Me=ee(Ae),$e=Z(Me),ke=z(Ae,$e),Ze=ue(Ae);return{method:Ue,headers:Me,body:ke,credentials:Ze}},G={canParse:()=>!0,parse:Ae=>(Ae.get("accept")||Ae.set("accept","application/json, text/plain, */*"),Ae)},j=Ae=>({canParse:Ue=>(Ue?.method?Ue?.method.toLowerCase():"")===Ae,parse:Ue=>(Ue.get("content-type")||Ue.set("content-type","application/json"),Ue)}),Y=j("post"),oe=j("put"),se=j("patch"),ne=[Y,oe,se,G],ee=Ae=>{const Ue=Ae?.headers?new Headers(Ae.headers):new Headers;return ne.filter(ke=>ke.canParse(Ae)).reduce((ke,Ze)=>Ze.parse(ke),Ue)},Z=Ae=>{if(!Ae)return!1;const Ue=Ae.get("content-type");return!!(Ue&&Ue.toLowerCase()==="application/json")},z=(Ae,Ue)=>Ae&&(!Ae.data||typeof Ae.data=="string"||Ae.data instanceof Blob?Ae.data:Ue?JSON.stringify(Ae.data):new URLSearchParams(Ae.data));async function q(Ae,Ue){if(Ue)switch(Ue){case"arraybuffer":return Ae.arrayBuffer();case"blob":return Ae.blob();case"json":return Ae.headers.get("Content-Length")==="0"?(console.warn(`${Ae.url} returned an invalid JSON`),{}):await Ae.json();case"text":return Ae.text()}const Me=await Ae.text();try{return JSON.parse(Me)}catch{}return Me}function ie(Ae){return Object.keys(Ae).map(Ue=>{const Me=Ae[Ue];return Array.isArray(Me)?Me.map($e=>`${encodeURIComponent(Ue)}=${encodeURIComponent($e)}`).join("&"):`${encodeURIComponent(Ue)}=${encodeURIComponent(Me)}`}).join("&")}const de=Ae=>{const Ue=(0,_.omitBy)(Ae.params,$e=>$e===void 0||$e&&$e.length===0),Me=ie(Ue);return Ae.params&&Me.length?`${Ae.url}?${Me}`:Ae.url},ue=Ae=>Ae&&(Ae.credentials?Ae.credentials:Ae.withCredentials?((0,S.l)("BackendSrvRequest","withCredentials","credentials"),"include"):"same-origin");var fe=e(21969),Se=(Ae=>(Ae[Ae.Pending=0]="Pending",Ae[Ae.InProgress=1]="InProgress",Ae[Ae.Done=2]="Done",Ae))(Se||{});class he{constructor(Ue=!1){this.state={},this.queue=new a.B,this.updates=new a.B,this.add=(Me,$e)=>this.queue.next({id:Me,options:$e,state:0}),this.setInProgress=Me=>this.queue.next({id:Me,state:1}),this.setDone=Me=>this.queue.next({id:Me,state:2}),this.getUpdates=()=>this.updates.asObservable(),this.getUpdate=Me=>{const $e=Object.keys(Me).filter(Ze=>Me[Ze].state===1).length;return{noOfPending:Object.keys(Me).filter(Ze=>Me[Ze].state===0).length,noOfInProgress:$e,state:Me}},this.publishUpdate=(Me,$e)=>{this.printState(Me,$e),this.updates.next(Me)},this.printState=(Me,$e)=>{if(!$e)return;const ke=Object.keys(Me.state).reduce((Ze,ot)=>{const xt={id:ot,state:Me.state[ot].state};return Ze.push(xt),Ze},[]);console.log("FetchQueue noOfStarted",Me.noOfInProgress),console.log("FetchQueue noOfNotStarted",Me.noOfPending),console.log("FetchQueue state",ke)},this.queue.subscribe(Me=>{const{id:$e,state:ke,options:Ze}=Me;if(this.state[$e]||(this.state[$e]={state:0,options:{url:""}}),ke===2){delete this.state[$e];const xt=this.getUpdate(this.state);this.publishUpdate(xt,Ue);return}this.state[$e].state=ke,Ze&&(this.state[$e].options=Ze);const ot=this.getUpdate(this.state);this.publishUpdate(ot,Ue)})}}var ce=e(95864);class me{constructor(Ue,Me,$e){const ke=$e?.http2Enabled?1e3:5;Ue.getUpdates().pipe((0,P.p)(({noOfPending:Ze})=>Ze>0),(0,ce.H)(({state:Ze,noOfInProgress:ot})=>{const xt=Object.keys(Ze).filter(re=>Ze[re].state===Se.Pending&&!(0,fe.dr)(Ze[re].options.url)).reduce((re,X)=>{const le={id:X,options:Ze[X].options};return re.push(le),re},[]),ct=Object.keys(Ze).filter(re=>Ze[re].state===Se.Pending&&(0,fe.dr)(Ze[re].options.url)).reduce((re,X)=>{const le={id:X,options:Ze[X].options};return re.push(le),re},[]),ft=Math.max(ke-ot-xt.length,0),Le=ct.slice(0,ft);return xt.concat(Le)})).subscribe(({id:Ze,options:ot})=>{Me.add(Ze,ot)})}}class pe{constructor(Ue,Me){this.queue=new a.B,this.responses=new a.B,this.add=($e,ke)=>{this.queue.next({id:$e,options:ke})},this.getResponses=$e=>this.responses.asObservable().pipe((0,P.p)(ke=>ke.id===$e)),this.queue.subscribe($e=>{const{id:ke,options:Ze}=$e;Ue.setInProgress(ke),this.responses.next({id:ke,observable:Me(Ze)})})}}var ye=e(16233);const Pe="cancel_all_requests_request_id",Ie="grafana-trace-id";class Oe{constructor(Ue){this.inFlightRequests=new a.B,this.HTTP_REQUEST_CANCELED=-1,this.inspectorStream=new a.B,this._tokenRotationInProgress=null,this.deviceID=null,this.dependencies={fromFetch:l.$,appEvents:M.A,contextSrv:ye.TP,logout:()=>{ye.TP.setLoggedOut()}},Ue&&(this.dependencies={...this.dependencies,...Ue}),this.noBackendCache=!1,this.internalFetch=this.internalFetch.bind(this),this.fetchQueue=new he,this.responseQueue=new pe(this.fetchQueue,this.internalFetch),this.initGrafanaDeviceID(),new me(this.fetchQueue,this.responseQueue,(0,A.zj)())}async initGrafanaDeviceID(){try{const Me=await(await n.Ay.load()).get();this.deviceID=Me.visitorId}catch(Ue){console.error(Ue)}}async request(Ue){return await(0,o.s)(this.fetch(Ue).pipe((0,m.T)(Me=>Me.data)))}fetch(Ue){const Me=(0,v.A)(),$e=this.fetchQueue;return new r.c(ke=>{const Ze=new i.yU;return Ze.add(this.responseQueue.getResponses(Me).subscribe(ot=>{Ze.add(ot.observable.subscribe(ke))})),this.fetchQueue.add(Me,Ue),function(){$e.setDone(Me),Ze.unsubscribe()}})}internalFetch(Ue){Ue.requestId&&this.inFlightRequests.next(Ue.requestId),Ue=this.parseRequestOptions(Ue);const Me=(0,C.r)();return Me!==null&&Me!==""&&T.$.jwtUrlLogin&&T.$.jwtHeaderName&&(Ue.headers=Ue.headers??{},Ue.headers[T.$.jwtHeaderName]=`${Me}`),this.deviceID&&(Ue.headers=Ue.headers??{},Ue.headers["X-Grafana-Device-Id"]=`${this.deviceID}`),this.getFromFetchStream(Ue).pipe(this.handleStreamResponse(Ue),this.handleStreamError(Ue),this.handleStreamCancellation(Ue))}resolveCancelerIfExists(Ue){this.inFlightRequests.next(Ue)}cancelAllInFlightRequests(){this.inFlightRequests.next(Pe)}async datasourceRequest(Ue){return(0,o.s)(this.fetch(Ue))}parseRequestOptions(Ue){const Me=this.dependencies.contextSrv.user?.orgId;return Ue.retry=Ue.retry??0,(0,fe.Lr)(Ue.url)&&(Me&&(Ue.headers=Ue.headers??{},Ue.headers["X-Grafana-Org-Id"]=Me),Ue.url.startsWith("/")&&(Ue.url=Ue.url.substring(1)),Ue.headers?.Authorization&&(Ue.headers["X-DS-Authorization"]=Ue.headers.Authorization,delete Ue.headers.Authorization),this.noBackendCache&&(Ue.headers=Ue.headers??{},Ue.headers["X-Grafana-NoCache"]="true")),Ue.hideFromInspector===void 0&&(Ue.hideFromInspector=(0,fe.Lr)(Ue.url)&&!(0,fe.dr)(Ue.url)),Ue}getFromFetchStream(Ue){const Me=de(Ue),$e=H(Ue);return this.dependencies.fromFetch(Me,$e).pipe((0,s.Z)(async ke=>{const{status:Ze,statusText:ot,ok:xt,headers:ct,url:ft,type:Le,redirected:re}=ke,X=Ue.responseType??(Z(ct)?"json":void 0),le=await q(ke,X);return{status:Ze,statusText:ot,ok:xt,data:le,headers:ct,url:ft,type:Le,redirected:re,config:Ue,traceId:ke.headers.get(Ie)??void 0}}))}showApplicationErrorAlert(Ue){}showSuccessAlert(Ue){const{config:Me}=Ue;if(Me.showSuccessAlert===!1||Me.showSuccessAlert===void 0&&(Me.method==="GET"||(0,fe.dr)(Me.url)||!(0,fe.Lr)(Me.url)))return;const $e=Ue.data;$e?.message&&this.dependencies.appEvents.emit(D.r1.alertSuccess,[$e.message])}showErrorAlert(Ue,Me){if(Ue.showErrorAlert===!1||Ue.showErrorAlert===void 0&&((0,fe.dr)(Ue.url)||!(0,fe.Lr)(Ue.url)))return;let $e="",ke=Me.data.message;ke==="Unexpected error"&&Me.message&&(ke=Me.message),ke.length>80&&($e=ke,ke="Error"),Me.status===422&&($e=Me.data.message,ke="Validation failed"),this.dependencies.appEvents.emit(Me.status<500?D.r1.alertWarning:D.r1.alertError,[ke,$e,Me.data.traceID])}processRequestError(Ue,Me){return Me.data=Me.data??{message:"Unexpected error"},typeof Me.data=="string"&&(Me.data={message:Me.data,error:Me.statusText,response:Me.data}),Me.data&&!Me.data.message&&typeof Me.data.error=="string"&&(Me.data.message=Me.data.error),Me.data.message&&setTimeout(()=>{Me.isHandled||this.showErrorAlert(Ue,Me)},50),this.inspectorStream.next({response:Me,requestId:Ue.requestId}),Me}handleStreamResponse(Ue){return Me=>Me.pipe((0,m.T)($e=>{if(!$e.ok){const{status:ke,statusText:Ze,data:ot}=$e;throw{status:ke,statusText:Ze,data:ot,config:Ue,traceId:$e.headers.get(Ie)??void 0}}return $e}),(0,h.M)($e=>{this.showSuccessAlert($e),this.inspectorStream.next({response:$e,requestId:Ue.requestId})}))}handleStreamError(Ue){const{isSignedIn:Me}=this.dependencies.contextSrv.user;return $e=>$e.pipe((0,u.l)(ke=>ke.pipe((0,s.Z)((Ze,ot)=>{const xt=ot===0&&Ue.retry===0;if(Ze.status===401&&(0,fe.Lr)(Ue.url)&&xt&&Me){if(Ze.data?.error?.id==="ERR_TOKEN_REVOKED")return this.dependencies.appEvents.publish(new V.S8({component:U,props:{maxConcurrentSessions:Ze.data?.error?.maxConcurrentSessions}})),(0,f.$)(()=>Ze);let ct=this.loginPing();return(0,x.m)()&&(0,x.W)()*1e3<Date.now()&&(ct=this.rotateToken()),(0,d.H)(ct).pipe((0,b.W)(ft=>(ft.status===401&&this.dependencies.logout(),(0,f.$)(ft))))}return(0,f.$)(Ze)}))),(0,b.W)(ke=>(0,f.$)(()=>this.processRequestError(Ue,ke))))}handleStreamCancellation(Ue){return Me=>Me.pipe((0,g.Q)(this.inFlightRequests.pipe((0,P.p)($e=>{let ke=!1;return Ue&&Ue.requestId&&Ue.requestId===$e&&(ke=!0),$e===Pe&&(ke=!0),ke}))),(0,c.v)(()=>({type:E.v2.Cancelled,cancelled:!0,data:null,status:this.HTTP_REQUEST_CANCELED,statusText:"Request was aborted",config:Ue})))}getInspectorStream(){return this.inspectorStream}async get(Ue,Me,$e,ke){return this.request({...ke,method:"GET",url:Ue,params:Me,requestId:$e})}async delete(Ue,Me,$e){return this.request({...$e,method:"DELETE",url:Ue,data:Me})}async post(Ue,Me,$e){return this.request({...$e,method:"POST",url:Ue,data:Me})}async patch(Ue,Me,$e){return this.request({...$e,method:"PATCH",url:Ue,data:Me})}async put(Ue,Me,$e){return this.request({...$e,method:"PUT",url:Ue,data:Me})}withNoBackendCache(Ue){return this.noBackendCache=!0,Ue().finally(()=>{this.noBackendCache=!1})}rotateToken(){return this._tokenRotationInProgress?this._tokenRotationInProgress:(this._tokenRotationInProgress=this.fetch({url:"/api/user/auth-tokens/rotate",method:"POST",retry:1}).pipe((0,y.j)(()=>{this._tokenRotationInProgress=null}),(0,p.u)()),this._tokenRotationInProgress)}loginPing(){return this.fetch({url:"/api/login/ping",method:"GET",retry:1})}search(Ue){return this.get("/api/search",Ue)}getDashboardByUid(Ue){return(0,S.l)("backend_srv","getDashboardByUid(uid)","getDashboardAPI().getDashboardDTO(uid)"),(0,O.n)().getDashboardDTO(Ue)}validateDashboard(Ue){return Promise.resolve({isValid:!1,message:"dashboard validation is not supported"})}getPublicDashboardByUid(Ue){return this.get(`/api/public/dashboards/${Ue}`)}getFolderByUid(Ue,Me={}){const $e=new URLSearchParams;return Me.withAccessControl&&$e.set("accesscontrol","true"),this.get(`/api/folders/${Ue}?${$e.toString()}`,void 0,void 0,{showErrorAlert:!1})}}const Ne=new Oe,We=()=>Ne},16233:(Q,I,e)=>{"use strict";e.d(I,{SM:()=>m,TP:()=>u});var n=e(2543),a=e.n(n),o=e(65879),r=e(17172),i=e(33378),f=e(92315),d=e(31678),l=e(2913);const m="auto";class s{constructor(){this.id=0,this.uid="",this.isGrafanaAdmin=!1,this.isSignedIn=!1,this.orgRole="",this.orgId=0,this.orgName="",this.login="",this.externalUserId="",this.orgCount=0,this.timezone="",this.fiscalYearStartMonth=0,this.helpFlags1=0,this.theme="dark",this.hasEditPermissionInFolders=!1,this.email="",this.name="",this.locale="",this.language="",this.weekStart="",this.gravatarUrl="",this.analytics={identifier:""},this.authenticatedBy="",l.Ay.bootData.user&&(0,n.extend)(this,l.Ay.bootData.user)}}class h{constructor(){this.sidemenuSmallBreakpoint=!1,this.tokenRotationJobId=0,l.Ay.bootData||(l.Ay.bootData={user:{},settings:{},navTree:[]}),this.user=new s,this.isSignedIn=this.user.isSignedIn,this.isGrafanaAdmin=this.user.isGrafanaAdmin,this.isEditor=this.hasRole("Editor")||this.hasRole("Admin"),this.hasEditPermissionInFolders=this.user.hasEditPermissionInFolders,this.minRefreshInterval=l.Ay.minRefreshInterval,this.scheduleTokenRotationJob()}async fetchUserPermissions(){try{this.user.permissions=await(0,r.AI)().get("/api/access-control/user/actions",{reloadcache:!0})}catch(P){console.error(P)}}setLoggedOut(){this.cancelTokenRotationJob(),this.user.isSignedIn=!1,this.isSignedIn=!1,window.location.reload()}hasRole(P){return P==="ServerAdmin"?this.isGrafanaAdmin:this.user.orgRole===P}licensedAccessControlEnabled(){return(0,i.a)("accesscontrol")}hasPermissionInMetadata(P,c){return!!c.accessControl?.[P]}hasPermission(P){return!!this.user.permissions?.[P]}isGrafanaVisible(){return document.visibilityState===void 0||document.visibilityState==="visible"}isAllowedInterval(P){return!l.Ay.minRefreshInterval||P===m?!0:o.intervalToMs(P)>=o.intervalToMs(l.Ay.minRefreshInterval)}getValidInterval(P){return this.isAllowedInterval(P)?P:l.Ay.minRefreshInterval}getValidIntervals(P){return this.minRefreshInterval?P.filter(c=>c!=="").filter(this.isAllowedInterval):P}hasAccessToExplore(){return this.hasPermission(d.AccessControlAction.DataSourcesExplore)&&l.Ay.exploreEnabled}evaluatePermission(P){return P.some(c=>this.hasPermission(c))?[]:["Reject"]}scheduleTokenRotationJob(){if(this.canScheduleRotation()){let P=(0,f.W)(),y=(P-Math.floor(Math.random()*19+1))*1e3-Date.now();this.tokenRotationJobId=setTimeout(()=>{if((0,f.W)()>P){this.scheduleTokenRotationJob();return}this.rotateToken().then()},y)}}canScheduleRotation(){return!(!this.isSignedIn||(0,f.W)()===0)}cancelTokenRotationJob(){this.tokenRotationJobId>0&&clearTimeout(this.tokenRotationJobId)}rotateToken(){return fetch(l.Ay.appSubUrl+"/api/user/auth-tokens/rotate",{method:"POST"}).then(P=>{if(P.status===200){this.scheduleTokenRotationJob();return}if(P.status===401){this.setLoggedOut();return}}).catch(P=>{console.error(P)})}}let u=new h;const b=g=>{throw new Error("contextSrv can be only overridden in test environment")}},42614:(Q,I,e)=>{"use strict";e.d(I,{n:()=>a});var n=e(63415);const a=(r,i)=>{(0,n.x$)().addEvent({type:n.on.Performance,payload:{name:r,value:i}})},o=r=>faro?.api?.pushError(r)},62301:(Q,I,e)=>{"use strict";e.d(I,{A:()=>l});var n=e(2543),a=e.n(n),o=e(17172),r=e(2913),i=e(33390);class f{constructor(){}addDashboardImpression(s){const h=this.impressionKey();let u=[];i.A.exists(h)&&(u=JSON.parse(i.A.get(h)),(0,n.isArray)(u)||(u=[])),u=u.filter(b=>s!==b),u.unshift(s),u.length>50&&u.pop(),i.A.set(h,JSON.stringify(u))}async convertToUIDs(){let s=this.getImpressions();const h=(0,n.filter)(s,b=>(0,n.isNumber)(b));if(!h.length)return;const u=await(0,o.AI)().get(`/api/dashboards/ids/${h.join(",")}`);i.A.set(this.impressionKey(),JSON.stringify([...(0,n.filter)(s,b=>(0,n.isString)(b)),...u]))}getImpressions(){const s=i.A.get(this.impressionKey())||"[]";return JSON.parse(s)}async getDashboardOpened(){try{await this.convertToUIDs()}catch{}return(0,n.filter)(this.getImpressions(),h=>(0,n.isString)(h))}impressionKey(){return"dashboard_impressions-"+r.Ay.bootData.user.orgId}}const l=new f},4898:(Q,I,e)=>{"use strict";e.d(I,{R:()=>p});let n={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},a={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},o={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},r={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},i=null;for(let v=1;v<20;++v)n[111+v]="f"+v;for(let v=0;v<=9;++v)n[v+96]=v.toString();function f(v){if(v.type==="keypress"){let D=String.fromCharCode(v.which);return v.shiftKey||(D=D.toLowerCase()),D}return n[v.which]?n[v.which]:a[v.which]?a[v.which]:String.fromCharCode(v.which).toLowerCase()}function d(v,D){return v.sort().join(",")===D.sort().join(",")}function l(v){let D=[];return v.shiftKey&&D.push("shift"),v.altKey&&D.push("alt"),v.ctrlKey&&D.push("ctrl"),v.metaKey&&D.push("meta"),D}function m(v){if(v.preventDefault){v.preventDefault();return}v.returnValue=!1}function s(v){if(v.stopPropagation){v.stopPropagation();return}v.cancelBubble=!0}function h(v){return v==="shift"||v==="ctrl"||v==="alt"||v==="meta"}function u(){if(!i){i={};for(let v in n){const D=parseInt(v,10);D>95&&D<112||n.hasOwnProperty(v)&&(i[n[v]]=v)}}return i}function b(v,D,E){return E||(E=u()[v]?"keydown":"keypress"),E==="keypress"&&D.length&&(E="keydown"),E}function g(v){return v==="+"?["+"]:(v=v.replace(/\+{2}/g,"+plus"),v.split("+"))}function P(v,D){let E,S,T,M=[];for(E=g(v),T=0;T<E.length;++T)S=E[T],r[S]&&(S=r[S]),D&&D!=="keypress"&&o[S]&&(S=o[S],M.push("shift")),h(S)&&M.push(S);if(!S)throw new Error("Unable to get key");return D=b(S,M,D),{key:S,modifiers:M,action:D}}function c(v,D){return v===null||v===document?!1:v===D?!0:c(v.parentNode,D)}class y{constructor(D){this._callbacks={},this._directMap={},this._sequenceLevels={},this._resetTimer=void 0,this._ignoreNextKeyup=!1,this._ignoreNextKeypress=!1,this._nextExpectedAction=!1,this._globalCallbacks={},this._resetSequences=E=>{E=E||{};let S=!1,T;for(T in this._sequenceLevels){if(E[T]){S=!0;continue}this._sequenceLevels[T]=0}S||(this._nextExpectedAction=!1)},this._getMatches=(E,S,T,M,A,x)=>{let C,O,R=[],L=T.type;if(!this._callbacks[E])return[];for(L==="keyup"&&h(E)&&(S=[E]),C=0;C<this._callbacks[E].length;++C)if(O=this._callbacks[E][C],!(!M&&O.seq&&this._sequenceLevels[O.seq]!==O.level)&&L===O.action&&(L==="keypress"&&!T.metaKey&&!T.ctrlKey||d(S,O.modifiers))){let N=!M&&O.combo===A,F=M&&O.seq===M&&O.level===x;(N||F)&&this._callbacks[E].splice(C,1),R.push(O)}return R},this._fireCallback=(E,S,T,M)=>{const A=S.target||S.srcElement;A&&A instanceof HTMLElement&&this.stopCallback(S,A,T,M)||E(S,T)===!1&&(m(S),s(S))},this._handleKey=(E,S,T)=>{let M=this._getMatches(E,S,T),A,x={},C=0,O=!1;for(A=0;A<M.length;++A)M[A].seq&&(C=Math.max(C,M[A].level??0));for(A=0;A<M.length;++A){const L=M[A].seq;if(L){if(M[A].level!==C)continue;O=!0,x[L]=1,this._fireCallback(M[A].callback,T,M[A].combo,L);continue}O||this._fireCallback(M[A].callback,T,M[A].combo)}let R=T.type==="keypress"&&this._ignoreNextKeypress;T.type===this._nextExpectedAction&&!h(E)&&!R&&this._resetSequences(x),this._ignoreNextKeypress=O&&T.type==="keydown"},this._handleKeyEvent=E=>{if(!(E instanceof KeyboardEvent))throw new Error("Didn't get a KeyboardEvent");const S=E;typeof S.which!="number"&&(S.which=S.keyCode);let T=f(S);if(T){if(S.type==="keyup"&&this._ignoreNextKeyup===T){this._ignoreNextKeyup=!1;return}this.handleKey(T,l(S),S)}},this._resetSequenceTimer=()=>{clearTimeout(this._resetTimer),this._resetTimer=setTimeout(this._resetSequences,1e3)},this._bindSequence=(E,S,T,M)=>{this._sequenceLevels[E]=0;const A=C=>()=>{this._nextExpectedAction=C,++this._sequenceLevels[E],this._resetSequenceTimer()},x=C=>{this._fireCallback(T,C,E),M!=="keyup"&&(this._ignoreNextKeyup=f(C)),setTimeout(this._resetSequences,10)};for(let C=0;C<S.length;++C){let R=C+1===S.length?x:A(M||P(S[C+1]).action);this._bindSingle(S[C],R,M,E,C)}},this._bindSingle=(E,S,T,M,A)=>{this._directMap[E+":"+T]=S,E=E.replace(/\s+/g," ");let x=E.split(" "),C;if(x.length>1){this._bindSequence(E,x,S,T);return}C=P(E,T),this._callbacks[C.key]=this._callbacks[C.key]||[];const O={type:C.action,metaKey:!1,ctrlKey:!1};this._getMatches(C.key,C.modifiers,O,M,E,A);const R={callback:S,modifiers:C.modifiers,action:C.action,seq:M,level:A,combo:E};this._callbacks[C.key][M?"unshift":"push"](R)},this._bindMultiple=(E,S,T)=>{for(let M=0;M<E.length;++M)this._bindSingle(E[M],S,T)},this.bind=(E,S,T)=>(E=E instanceof Array?E:[E],this._bindMultiple(E,S,T),self),this.unbind=(E,S)=>this.bind(E,function(){},S),this.bindGlobal=(E,S,T)=>{if(this.bind(E,S,T),E instanceof Array){for(let M=0;M<E.length;M++)this._globalCallbacks[E[M]]=!0;return}this._globalCallbacks[E]=!0},this.unbindGlobal=(E,S)=>{if(this.unbind(E,S),E instanceof Array){for(let T=0;T<E.length;T++)this._globalCallbacks[E[T]]=!1;return}this._globalCallbacks[E]=!1},this.trigger=(E,S)=>{let T=this;return T._directMap[E+":"+S]&&T._directMap[E+":"+S]({},E),T},this.reset=()=>(this._callbacks={},this._directMap={},this),this.stopCallback=(E,S,T,M)=>{if(this._globalCallbacks[T]||M&&this._globalCallbacks[M]||(" "+S.className+" ").indexOf(" mousetrap ")>-1||c(S,this.target))return!1;if("composedPath"in E&&typeof E.composedPath=="function"){let A=E.composedPath()[0];A!==E.target&&A instanceof HTMLElement&&(S=A)}return!!(S.tagName==="INPUT"||S.tagName==="SELECT"||S.tagName==="TEXTAREA"||"isContentEditable"in S&&S.isContentEditable)},this.handleKey=(...E)=>this._handleKey(...E),this.addKeycodes=E=>{for(let S in E)E.hasOwnProperty(S)&&(n[S]=E[S]);i=null},this.target=D,this.target.addEventListener("keypress",E=>{E instanceof KeyboardEvent&&this._handleKeyEvent(E)}),this.target.addEventListener("keydown",E=>{E instanceof KeyboardEvent&&this._handleKeyEvent(E)}),this.target.addEventListener("keyup",E=>{E instanceof KeyboardEvent&&this._handleKeyEvent(E)})}}const p=new y(document)},2769:(Q,I,e)=>{"use strict";e.d(I,{K:()=>d,O:()=>l});var n=e(97594),a=e(3591),o=e(28138),r=e(2913),i=e(10096),f=e(65615);async function d(m,s){const h=r.config.theme2,u=(0,n.g)(m);if(o.A.publish(new a.E8(u)),h.colors.mode!==u.colors.mode){const P=document.createElement("link");P.rel="stylesheet",P.href=r.config.bootData.assets[u.colors.mode],P.onload=()=>{const c=document.getElementsByTagName("link");for(let y=0;y<c.length;y++){const p=c[y];p.href&&p.href.includes(`build/grafana.${h.colors.mode}`)&&p.remove()}},document.head.insertBefore(P,document.head.firstChild)}if(s||!i.contextSrv.isSignedIn)return;const b=new f.W("user"),g=await b.load();await b.update({...g,theme:u.colors.mode})}async function l(m){const s=r.config.theme2;d(s.isDark?"light":"dark",m)}},33390:(Q,I,e)=>{"use strict";e.d(I,{A:()=>o});class n{get(i){return window.localStorage[i]}set(i,f){window.localStorage[i]=f}getBool(i,f){return f!==void 0&&!this.exists(i)?f:window.localStorage[i]==="true"}getObject(i,f){let d=f;if(this.exists(i)){const l=window.localStorage[i];try{d=JSON.parse(l)}catch(m){console.error(`Error parsing store object: ${i}. Returning default: ${f}. [${m}]`)}}return d}setObject(i,f){let d;try{d=JSON.stringify(f)}catch(l){throw new Error(`Could not stringify object: ${i}. [${l}]`)}try{this.set(i,d)}catch(l){const m=new Error(`Could not save item in localStorage: ${i}. [${l}]`);throw l instanceof Error&&(m.name=l.name),m}return!0}exists(i){return window.localStorage[i]!==void 0}delete(i){window.localStorage.removeItem(i)}}const o=new n},31140:(Q,I,e)=>{"use strict";e.d(I,{A:()=>m,r:()=>l});var n=e(2543),a=e.n(n),o=e(54479),r=e(83195);function i(s,h){if(!s)return!1;if(s[0]==="/"){const u=(0,o.dO)(s);return h.match(u)!=null}return s===h}function f(s){return s===0?.001:s/10}function d(s){return s?{colors:[{opacity:0},{opacity:s/10}]}:null}function l(s,h,u){for(let b=0;b<s.length;b++){const g=s[b],P=h.yaxes,c=g.yaxis||1,y=P[c-1],p=(0,r.j_)(y.format);(0,n.isNumber)(h.decimals)?g.updateLegendValues(p,h.decimals):(0,n.isNumber)(y.decimals)?g.updateLegendValues(p,y.decimals+1):g.updateLegendValues(p,null)}}class m{constructor(h){this.datapoints=h.datapoints,this.label=h.alias,this.id=h.alias,this.alias=h.alias,this.aliasEscaped=(0,n.escape)(h.alias),this.color=h.color,this.bars={fillColor:h.color},this.valueFormater=(0,r.j_)("none"),this.stats={},this.legend=!0,this.unit=h.unit,this.dataFrameIndex=h.dataFrameIndex,this.fieldIndex=h.fieldIndex,this.hasMsResolution=this.isMsResolutionNeeded()}applySeriesOverrides(h){this.lines={},this.dashes={dashLength:[]},this.points={},this.yaxis=1,this.zindex=0,this.nullPointMode=null,delete this.stack,delete this.bars.show;for(let u=0;u<h.length;u++){const b=h[u];i(b.alias,this.alias)&&(b.lines!==void 0&&(this.lines.show=b.lines),b.dashes!==void 0&&(this.dashes.show=b.dashes,this.lines.lineWidth=0),b.points!==void 0&&(this.points.show=b.points),b.bars!==void 0&&(this.bars.show=b.bars),b.fill!==void 0&&(this.lines.fill=f(b.fill)),b.fillGradient!==void 0&&(this.lines.fillColor=d(b.fillGradient)),b.stack!==void 0&&(this.stack=b.stack),b.linewidth!==void 0&&(this.lines.lineWidth=this.dashes.show?0:b.linewidth,this.dashes.lineWidth=b.linewidth),b.dashLength!==void 0&&(this.dashes.dashLength[0]=b.dashLength),b.spaceLength!==void 0&&(this.dashes.dashLength[1]=b.spaceLength),b.nullPointMode!==void 0&&(this.nullPointMode=b.nullPointMode),b.pointradius!==void 0&&(this.points.radius=b.pointradius),b.steppedLine!==void 0&&(this.lines.steps=b.steppedLine),b.zindex!==void 0&&(this.zindex=b.zindex),b.fillBelowTo!==void 0&&(this.fillBelowTo=b.fillBelowTo),b.color!==void 0&&this.setColor(b.color),b.transform!==void 0&&(this.transform=b.transform),b.legend!==void 0&&(this.legend=b.legend),b.hideTooltip!==void 0&&(this.hideTooltip=b.hideTooltip),b.yaxis!==void 0&&(this.yaxis=b.yaxis),b.hiddenSeries!==void 0&&(this.hiddenSeries=b.hiddenSeries))}}getFlotPairs(h){const u=[];this.stats.total=0,this.stats.max=-Number.MAX_VALUE,this.stats.min=Number.MAX_VALUE,this.stats.logmin=Number.MAX_VALUE,this.stats.avg=null,this.stats.current=null,this.stats.first=null,this.stats.delta=0,this.stats.diff=null,this.stats.diffperc=0,this.stats.range=null,this.stats.timeStep=Number.MAX_VALUE,this.allIsNull=!0,this.allIsZero=!0;const b=h==="connected",g=h==="null as zero";let P,c,y=0,p,v=0,D=!0;for(let E=0;E<this.datapoints.length;E++){if(c=this.datapoints[E][0],P=this.datapoints[E][1],p!==void 0){const S=P-p;S<this.stats.timeStep&&(this.stats.timeStep=S)}if(p=P,c===null){if(b)continue;g&&(c=0)}c!==null&&((0,n.isNumber)(c)&&(this.stats.total+=c,this.allIsNull=!1,y++),c>this.stats.max&&(this.stats.max=c),c<this.stats.min&&(this.stats.min=c),this.stats.first===null?this.stats.first=c:v>c?(D=!1,E===this.datapoints.length-1&&(this.stats.delta+=c)):(D?this.stats.delta+=c-v:this.stats.delta+=c,D=!0),v=c,c<this.stats.logmin&&c>0&&(this.stats.logmin=c),c!==0&&(this.allIsZero=!1)),u.push([P,c])}return this.stats.max===-Number.MAX_VALUE&&(this.stats.max=null),this.stats.min===Number.MAX_VALUE&&(this.stats.min=null),u.length&&!this.allIsNull&&(this.stats.avg=this.stats.total/y,this.stats.current=u[u.length-1][1],this.stats.current===null&&u.length>1&&(this.stats.current=u[u.length-2][1])),this.stats.max!==null&&this.stats.min!==null&&(this.stats.range=this.stats.max-this.stats.min),this.stats.current!==null&&this.stats.first!==null&&(this.stats.diff=this.stats.current-this.stats.first,this.stats.diffperc=this.stats.diff/this.stats.first),this.stats.count=u.length,u}updateLegendValues(h,u){this.valueFormater=h,this.decimals=u}formatValue(h){return(0,n.isFinite)(h)||(h=null),(0,r.cN)(this.valueFormater(h,this.decimals))}isMsResolutionNeeded(){for(let h=0;h<this.datapoints.length;h++)if(this.datapoints[h][1]!==null&&this.datapoints[h][1]!==void 0){const u=this.datapoints[h][1].toString();if(u.length===13&&u%1e3!==0)return!0}return!1}hideFromLegend(h){return!!(h.hideEmpty&&this.allIsNull||!this.legend||h.hideZero&&this.allIsZero)}setColor(h){this.color=h,this.bars.fillColor=h}}},6262:(Q,I,e)=>{"use strict";e.d(I,{G:()=>r});var n=e(40672),a=e(32264);const o=a.$.bootData.settings.cspReportOnlyEnabled,r={createHTML:(i,f,d)=>o?(console.error("[HTML not sanitized with Trusted Types]",i,f,d),i):i.replace(/<script/gi,"&lt;script"),createScript:i=>i,createScriptURL:(i,f,d)=>o?(console.error("[ScriptURL not sanitized with Trusted Types]",i,f,d),i):n.sQ.sanitizeUrl(i)};a.$.bootData.settings.trustedTypesDefaultPolicyEnabled&&window.trustedTypes&&window.trustedTypes.createPolicy&&window.trustedTypes.createPolicy("default",r)},96378:(Q,I,e)=>{"use strict";e.d(I,{N:()=>l,e:()=>m});var n=e(96540),a=e(70255),o=e(60578),r=e(3591),i=e(32264),f=e(10096),d=e(34295);const l=({children:s,value:h})=>{const[u,b]=(0,n.useState)(h);return(0,n.useEffect)(()=>{const g=f.lE.subscribe(r.E8,P=>{i.$.theme2=P.payload,b(P.payload)});return()=>g.unsubscribe()},[]),n.createElement(o.D.Provider,{value:u},n.createElement(a.z,{baseColor:u.colors.emphasize(u.colors.background.secondary),highlightColor:u.colors.emphasize(u.colors.background.secondary,.1),borderRadius:u.shape.radius.default},s))},m=(s,h)=>function(b){return n.createElement(l,{value:h},n.createElement(s,{...b}))}},67278:(Q,I,e)=>{"use strict";e.d(I,{c:()=>n});class n extends window.Worker{constructor(o,r){const i=o.toString(),f=i.split("/");f.pop();const d=`${f.join("/")}/`,l=`importScripts('${i}');`,m=URL.createObjectURL(new Blob([`__webpack_worker_public_path__ = '${d}'; ${l}`],{type:"application/javascript"}));super(m,r),URL.revokeObjectURL(m)}}},80714:(Q,I,e)=>{"use strict";e.d(I,{F:()=>n});function n(a={}){return{...a,accesscontrol:!0}}},94041:(Q,I,e)=>{"use strict";e.d(I,{b:()=>n});const n=(a,o,r)=>(a.splice(r,0,a.splice(o,1)[0]),a)},92315:(Q,I,e)=>{"use strict";e.d(I,{W:()=>n,m:()=>a});function n(){const o=document.cookie.split("; ").find(i=>i.startsWith("grafana_session_expiry="));if(!o)return 0;let r=o.split("=").at(1);return r?parseInt(r,10):0}function a(){return document.cookie.split("; ").findIndex(o=>o.startsWith("grafana_session_expiry="))>-1}},63917:(Q,I,e)=>{"use strict";e.d(I,{gn:()=>o});function n(){const r=navigator.userAgent.indexOf("MSIE")>-1,i=navigator.userAgent.indexOf("Edge/")>-1||navigator.userAgent.indexOf("Edg/")>-1,f=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,d=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),l=/Edge\/([0-9.]+)/.exec(navigator.userAgent);return r&&parseFloat(/Trident\/([0-9.]+)/.exec(navigator.userAgent)[1])<=7||i&&(l&&parseFloat(l[1])<=16||parseFloat(/Edg\/([0-9.]+)/.exec(navigator.userAgent)[1])<=16)||f&&parseFloat(/Firefox\/([0-9.]+)/.exec(navigator.userAgent)[1])<=64?!1:!(d&&parseFloat(/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1])<=54)}function a(){return/(iPhone|iPad|Mac)/.test(navigator.platform)}function o(){return a()?"\u2318":"ctrl"}},34525:(Q,I,e)=>{"use strict";e.d(I,{TS:()=>o});class n{_linkTo(d,l){l<=0&&d.inputEdges.push(this),l>=0&&d.outputEdges.push(this),d.edges.push(this)}link(d,l){if(!d)throw Error("inputNode is required");if(!l)throw Error("outputNode is required");return this.unlink(),this.inputNode=d,this.outputNode=l,this._linkTo(d,1),this._linkTo(l,-1),this}unlink(){let d;const l=this.inputNode,m=this.outputNode;l&&m&&(d=l.edges.indexOf(this),d>-1&&l.edges.splice(d,1),d=m.edges.indexOf(this),d>-1&&m.edges.splice(d,1),d=l.outputEdges.indexOf(this),d>-1&&l.outputEdges.splice(d,1),d=m.inputEdges.indexOf(this),d>-1&&m.inputEdges.splice(d,1))}}class a{constructor(d){this.name=d,this.edges=[],this.inputEdges=[],this.outputEdges=[]}getEdgeFrom(d){return d?typeof d=="object"?this.inputEdges.find(l=>l.inputNode?.name===d.name):this.inputEdges.find(l=>l.inputNode?.name===d):null}getEdgeTo(d){return d?typeof d=="object"?this.outputEdges.find(l=>l.outputNode?.name===d.name):this.outputEdges.find(l=>l.outputNode?.name===d):null}getOptimizedInputEdges(){const d=[];return this.inputEdges.forEach(l=>{l.inputNode?.inputEdges.map(s=>s.inputNode)?.forEach(s=>{const h=s?.getEdgeTo(this.name);h&&d.push(h)})}),this.inputEdges.filter(l=>d.indexOf(l)===-1)}}class o{constructor(){this.nodes={}}createNode(d){const l=new a(d);return this.nodes[d]=l,l}createNodes(d){const l=[];return d.forEach(m=>{l.push(this.createNode(m))}),l}link(d,l){let m=[],s=[];const h=[],u=[];d instanceof Array?m=d:m=[d],l instanceof Array?s=l:s=[l];for(let g=0;g<m.length;g++){const P=m[g];if(typeof P=="string"){const c=this.getNode(P);if(!c)throw Error(`cannot link input node named ${P} since it doesn't exist in graph`);h.push(c)}else h.push(P)}for(let g=0;g<s.length;g++){const P=s[g];if(typeof P=="string"){const c=this.getNode(P);if(!c)throw Error(`cannot link output node named ${P} since it doesn't exist in graph`);u.push(c)}else u.push(P)}const b=[];return h.forEach(g=>{u.forEach(P=>{b.push(this.createEdge().link(g,P))})}),b}descendants(d){if(!d.length)return new Set;const l=new Set(i(d)?d.map(m=>this.nodes[m]).filter(m=>m!==void 0):d);return this.descendantsRecursive(l)}descendantsRecursive(d,l=new Set){for(const m of d){const s=new Set;for(const{inputNode:h}of m.inputEdges)h&&!l.has(h)&&(l.add(h),s.add(h));this.descendantsRecursive(s,l)}return l}createEdge(){return new n}getNode(d){return this.nodes[d]}}const r=f=>{Object.keys(f.nodes).forEach(d=>{const l=f.nodes[d];let m=l.outputEdges.map(h=>h.outputNode?.name).join(", ");m||(m="<none>");let s=l.inputEdges.map(h=>h.inputNode?.name).join(", ");s||(s="<none>"),console.log(`${l.name}:
 - links to:   ${m}
 - links from: ${s}`)})};function i(f){return f.length>0&&typeof f[0]=="string"}},94954:(Q,I,e)=>{"use strict";e.d(I,{q:()=>a});var n=e(17172);function a(o){if(typeof o=="string")return o;if(o){if(o instanceof Error)return o.message;if((0,n.NF)(o)){if(o.data&&o.data.message)return o.data.message;if(o.statusText)return o.statusText}}return JSON.stringify(o)}},87490:(Q,I,e)=>{"use strict";e.d(I,{HQ:()=>p,Ll:()=>C,MA:()=>A,WP:()=>g,Xe:()=>E,_u:()=>w,bI:()=>T,dY:()=>F,di:()=>R,dr:()=>v,eF:()=>O,o$:()=>D,uE:()=>B,uJ:()=>W,uq:()=>S,w4:()=>M,zT:()=>N,zq:()=>K});var n=e(44329),a=e(62938),o=e(52622),r=e(76885),i=e(41987),f=e(43127),d=e(77789),l=e(65879),m=e(19347),s=e(11134),h=e(33390),u=e(66718);const b={dedupStrategy:o.fY.none},g="0123456789abcdefghijklmnopqrstuvwxyz",P=(0,n.d_)(g,3),c="grafana.explore.datasource",y=V=>`${c}.${V}`,p=V=>h.A.getObject(y(V)),v=(V,_)=>h.A.setObject(y(V),_);function D(){for(;;){const V=P(3);if(!/^\d+$/.test(V))return V}}async function E(V){const{queries:_,dsRef:H,timeRange:G,scopedVars:j,adhocFilters:Y}=V,oe=(await Promise.allSettled(_.filter(ne=>ne.datasource?.uid!==u.Uj).map(async ne=>{const ee=await(0,m.l)().get(ne.datasource||H);return{...ee.interpolateVariablesInQueries?.([ne],j??{},Y)[0]||ne,...!ee.meta.mixed&&{datasource:ee.getRef()}}}))).filter(ne=>ne.status==="fulfilled").map(ne=>ne.value),se=JSON.stringify({[D()]:{range:(0,r.sQ)(G.raw),queries:oe,datasource:H?.uid}});return r.kM.renderUrl("/explore",{panes:se,schemaVersion:1})}function S(V){return`explore_${V}`}function T(V,_,H,G,j,Y,oe){const se=Number.parseInt(V,36),{interval:ne,intervalMs:ee}=U(G,H.minInterval,H.maxDataPoints),Z={app:i.Jk.Explore,timezone:Y||f.lE,startTime:Date.now(),interval:ne,intervalMs:ee,panelId:se,targets:_,range:G,requestId:S(V),rangeRaw:G.raw,scopedVars:{__interval:{text:ne,value:ne},__interval_ms:{text:ee,value:ee},...oe},maxDataPoints:H.maxDataPoints,liveStreaming:H.liveStreaming,skipQueryCache:!0};return{queries:_,request:Z,scanning:j,id:x(),done:!1}}const M=({key:V,..._})=>_,A=(V,_)=>{if(V==null)return"";try{return JSON.stringify(V,null,_)}catch(H){console.error(H)}return""};function x(V=0){return`Q-${(0,a.A)()}-${V}`}async function C(V,_=0,H){let G,j,Y;return H?j=H:V.length>0&&V[V.length-1].datasource?j=V[V.length-1].datasource:(G=await(0,m.l)().get(),Y=G.getDefaultQuery?.(i.Jk.Explore),j=G.getRef()),G||(G=await(0,m.l)().get(j),Y=G.getDefaultQuery?.(i.Jk.Explore)),{...Y,refId:(0,d.M)(V),key:x(_),datasource:j}}const O=(V,_,H=0)=>{const G=x(H),j=V.refId||(0,d.M)(_);return{...V,refId:j,key:G}};async function R(V,_){if(V&&typeof V=="object"&&V.length>0){const H=[];for(let G=0;G<V.length;G++){const j=V[G],Y=x(G);let oe=j.refId;oe||(oe=(0,d.M)(H));let se=!0;if(j.datasource)try{await(0,m.l)().get(j.datasource.uid)}catch{console.error("One of the queries has a datasource that is no longer available and was removed."),se=!1}se&&H.push({...j,refId:oe,key:Y})}return H}try{const H=_??(await(0,m.l)().get()).getRef();return[await C(V??[],void 0,H)]}catch{return[]}}const L=["refId","key","context","datasource"];function N(V){return V&&V.some(_=>Object.entries(_).filter(([G,j])=>L.indexOf(G)===-1).filter(([G,j])=>j).length>0)}const F=V=>V.reduce((H,G,j)=>{const Y=G.datasource?.uid||G.key;return H.concat(`${Y}-${j}`)},[]),K=(V,_,H)=>l.convertRawToRange(_,V,H),B=V=>s.cC.isLive(V)?o.uH.Ascending:o.uH.Descending,w=V=>{V&&V.unsubscribe()};function U(V,_,H){return H?l.calculateInterval(V,H,_):{interval:"1s",intervalMs:1e3}}const W=V=>{if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(V);else{const _=document.createElement("textarea");_.value=V,document.body.appendChild(_),_.select(),document.execCommand("copy"),document.body.removeChild(_)}}},78827:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{default:()=>n});function n(a,o){o=o||{};const r=o.delimiter||".";let i=o.maxDepth||3,f=1;const d={};function l(m,s){Object.entries(m).forEach(([h,u])=>{const b=o?.safe&&Array.isArray(u),P=Object.prototype.toString.call(u)==="[object Object]",c=s?s+r+h:h;if(o?.maxDepth||(i=f+1),!b&&P&&Object.keys(u).length&&f<i)return++f,l(u,c);d[c]=u})}return l(a,null),d}},68576:(Q,I,e)=>{"use strict";e.d(I,{A:()=>d});var n=e(95344),a=e(54479),o=e(65879),r=e(83195);const f={valueFormats:{},intervalRegex:/(\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,intervalsInSeconds:{y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001},regexEscape:l=>((0,n.l)("kbn.ts","kbn.regexEscape()","escapeRegex from @grafana/data"),(0,a.$f)(l)),roundInterval:l=>((0,n.l)("kbn.ts","kbn.roundInterval()","@grafana/data"),o.roundInterval(l)),secondsToHms:l=>((0,n.l)("kbn.ts","kbn.secondsToHms()","@grafana/data"),o.secondsToHms(l)),secondsToHhmmss:l=>{const m=[],s=Math.floor(l/3600),h=Math.floor(l%3600/60),u=Math.floor(l%3600%60);return s>9?m.push(""+s):m.push("0"+s),h>9?m.push(""+h):m.push("0"+h),u>9?m.push(""+u):m.push("0"+u),m.join(":")},toPercent:(l,m)=>Math.floor(l/m*1e4)/100+"%",addSlashes:l=>l.replace(/[\'\"\\0]/g,"\\$&"),describeInterval:l=>((0,n.l)("kbn.ts","kbn.describeInterval()","@grafana/data"),o.describeInterval(l)),intervalToSeconds:l=>((0,n.l)("kbn.ts","rangeUtil.intervalToSeconds()","@grafana/data"),o.intervalToSeconds(l)),intervalToMs:l=>((0,n.l)("kbn.ts","rangeUtil.intervalToMs()","@grafana/data"),o.intervalToMs(l)),calculateInterval:(l,m,s)=>((0,n.l)("kbn.ts","kbn.calculateInterval()","@grafana/data"),o.calculateInterval(l,m,s)),queryColorDot:(l,m)=>'<div class="icon-circle" style="'+["display:inline-block","color:"+l,"font-size:"+m+"px"].join(";")+'"></div>',slugifyForUrl:l=>l.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"),stringToJsRegex:l=>((0,n.l)("kbn.ts","kbn.stringToJsRegex()","@grafana/data"),(0,a.dO)(l)),toFixed:(l,m)=>{if(l===null)return"";const s=m?Math.pow(10,Math.max(0,m)):1,h=String(Math.round(l*s)/s);if(h.indexOf("e")!==-1||l===0)return h;if(m!=null){const u=h.indexOf("."),b=u===-1?0:h.length-u-1;if(b<m)return(b?h:h+".")+String(s).slice(1,m-b+1)}return h},toFixedScaled:(l,m,s,h,u)=>s===null?f.toFixed(l,m)+u:f.toFixed(l,s+h)+u,roundValue:(l,m)=>{if(l===null)return null;const s=Math.pow(10,m),h=(s*l).toFixed(m);return Math.round(parseFloat(h))/s},getUnitFormats:r.Ke};typeof Proxy<"u"?f.valueFormats=new Proxy(f.valueFormats,{get(l,m,s){if(typeof m!="string")throw{message:`Value format ${String(m)} is not a string`};const h=(0,r.j_)(m);return h?(u,b,g,P)=>(0,r.cN)(h(u,b,g,P?"utc":"browser")):Reflect.get(l,m,s)}}):f.valueFormats=(0,r.uH)();const d=f},78160:(Q,I,e)=>{"use strict";e.d(I,{j:()=>a,z:()=>o});var n=e(42614);function a(r){if(!(!performance||!performance.mark))try{performance.mark(`${r}_started`)}catch(i){console.error(`[Metrics] Failed to startMeasure ${r}`,i)}}function o(r){if(!(!performance||!performance.mark))try{const i=`${r}_started`,f=`${r}_completed`,d=`${r}_measured`;performance.mark(f);const l=performance.measure(d,i,f);return(0,n.n)(`${r}_ms`,l.duration),performance.clearMarks(i),performance.clearMarks(f),performance.clearMeasures(d),l}catch(i){console.error(`[Metrics] Failed to stopMeasure ${r}`,i);return}}},36689:(Q,I,e)=>{"use strict";e.d(I,{C:()=>a,o:()=>o});var n=e(8484);function a(r){switch(r){case"home":return(0,n.t)("nav.home.title","Home");case"new":return(0,n.t)("nav.new.title","New");case"create":return(0,n.t)("nav.create.title","Create");case"create-dashboard":return(0,n.t)("nav.create-dashboard.title","Dashboard");case"folder":return(0,n.t)("nav.create-folder.title","Folder");case"import":return(0,n.t)("nav.create-import.title","Import dashboard");case"alert":return(0,n.t)("nav.create-alert.title","New alert rule");case"starred":return(0,n.t)("nav.starred.title","Starred");case"starred-empty":return(0,n.t)("nav.starred-empty.title","Your starred dashboards will appear here");case"dashboards":return(0,n.t)("nav.dashboards.title","Dashboards");case"dashboards/browse":return(0,n.t)("nav.dashboards.title","Dashboards");case"dashboards/playlists":return(0,n.t)("nav.playlists.title","Playlists");case"dashboards/snapshots":return(0,n.t)("nav.snapshots.title","Snapshots");case"dashboards/library-panels":return(0,n.t)("nav.library-panels.title","Library panels");case"reports":return(0,n.t)("nav.reporting.title","Reporting");case"dashboards/public":return(0,n.t)("nav.public.title","Public dashboards");case"dashboards/recentlyDeleted":return(0,n.t)("nav.recentlyDeleted.title","Recently Deleted");case"dashboards/new":return(0,n.t)("nav.new-dashboard.title","New dashboard");case"dashboards/folder/new":return(0,n.t)("nav.new-folder.title","New folder");case"dashboards/import":return(0,n.t)("nav.create-import.title","Import dashboard");case"scenes":return(0,n.t)("nav.scenes.title","Scenes");case"explore":return(0,n.t)("nav.explore.title","Explore");case"alerting":return(0,n.t)("nav.alerting.title","Alerting");case"plugin-page-grafana-oncall-app":return(0,n.t)("nav.oncall.title","OnCall");case"alerting-legacy":return(0,n.t)("nav.alerting-legacy.title","Alerting (legacy)");case"alerting-upgrade":return(0,n.t)("nav.alerting-upgrade.title","Alerting upgrade");case"alert-home":return(0,n.t)("nav.alerting-home.title","Home");case"alert-list":return(0,n.t)("nav.alerting-list.title","Alert rules");case"alert-list-legacy":return(0,n.t)("nav.alert-list-legacy.title","Alert rules");case"receivers":return(0,n.t)("nav.alerting-receivers.title","Contact points");case"am-routes":return(0,n.t)("nav.alerting-am-routes.title","Notification policies");case"channels":return(0,n.t)("nav.alerting-channels.title","Notification channels");case"silences":return(0,n.t)("nav.alerting-silences.title","Silences");case"groups":return(0,n.t)("nav.alerting-groups.title","Groups");case"alerting-admin":return(0,n.t)("nav.alerting-admin.title","Settings");case"cfg":return(0,n.t)("nav.config.title","Administration");case"cfg/general":return(0,n.t)("nav.config-general.title","General");case"cfg/plugins":return(0,n.t)("nav.config-plugins.title","Plugins and data");case"cfg/access":return(0,n.t)("nav.config-access.title","Users and access");case"datasources":return(0,n.t)("nav.datasources.title","Data sources");case"authentication":return(0,n.t)("nav.authentication.title","Authentication");case"licensing":return(0,n.t)("nav.statistics-and-licensing.title","Statistics and licensing");case"recordedQueries":return(0,n.t)("nav.recorded-queries.title","Recorded queries");case"correlations":return(0,n.t)("nav.correlations.title","Correlations");case"users":return(0,n.t)("nav.users.title","Users");case"teams":return(0,n.t)("nav.teams.title","Teams");case"plugins":return(0,n.t)("nav.plugins.title","Plugins");case"org-settings":return(0,n.t)("nav.org-settings.title","Default preferences");case"apikeys":return(0,n.t)("nav.api-keys.title","API keys");case"serviceaccounts":return(0,n.t)("nav.service-accounts.title","Service accounts");case"admin":return(0,n.t)("nav.admin.title","Server admin");case"support-bundles":return(0,n.t)("nav.support-bundles.title","Support bundles");case"global-users":return(0,n.t)("nav.global-users.title","Users");case"global-orgs":return(0,n.t)("nav.global-orgs.title","Organizations");case"server-settings":return(0,n.t)("nav.server-settings.title","Settings");case"storage":return(0,n.t)("nav.storage.title","Storage");case"migrate-to-cloud":return(0,n.t)("nav.migrate-to-cloud.title","Migrate to Grafana Cloud");case"upgrading":return(0,n.t)("nav.upgrading.title","Stats and license");case"monitoring":return(0,n.t)("nav.monitoring.title","Observability");case"infrastructure":return(0,n.t)("nav.infrastructure.title","Infrastructure");case"frontend":return(0,n.t)("nav.frontend.title","Frontend");case"apps":return(0,n.t)("nav.apps.title","Apps");case"alerts-and-incidents":return(0,n.t)("nav.alerts-and-incidents.title","Alerts & IRM");case"testing-and-synthetics":return(0,n.t)("nav.testing-and-synthetics.title","Testing & synthetics");case"plugin-page-grafana-incident-app":return(0,n.t)("nav.incidents.title","Incidents");case"plugin-page-grafana-ml-app":return(0,n.t)("nav.machine-learning.title","Machine learning");case"plugin-page-grafana-slo-app":return(0,n.t)("nav.slo.title","SLO");case"plugin-page-k6-app":return(0,n.t)("nav.k6.title","Performance");case"monitoring":return(0,n.t)("nav.observability.title","Observability");case"plugin-page-grafana-k8s-app":return(0,n.t)("nav.kubernetes.title","Kubernetes");case"plugin-page-grafana-app-observability-app":return(0,n.t)("nav.application.title","Application");case"plugin-page-grafana-pyroscope-app":return(0,n.t)("nav.profiles.title","Profiles");case"plugin-page-grafana-kowalski-app":return(0,n.t)("nav.frontend-app.title","Frontend");case"plugin-page-grafana-synthetic-monitoring-app":return(0,n.t)("nav.synthetics.title","Synthetics");case"help":return(0,n.t)("nav.help.title","Help");case"profile/settings":return(0,n.t)("nav.profile/settings.title","Profile");case"profile/notifications":return(0,n.t)("nav.profile/notifications.title","Notification history");case"profile/password":return(0,n.t)("nav.profile/password.title","Change password");case"sign-out":return(0,n.t)("nav.sign-out.title","Sign out");case"search":return(0,n.t)("nav.search-dashboards.title","Search dashboards");case"connections":return(0,n.t)("nav.connections.title","Connections");case"connections-add-new-connection":return(0,n.t)("nav.add-new-connections.title","Add new connection");case"standalone-plugin-page-/connections/collector":return(0,n.t)("nav.collector.title","Collector");case"connections-datasources":return(0,n.t)("nav.data-sources.title","Data sources");case"standalone-plugin-page-/connections/infrastructure":return(0,n.t)("nav.integrations.title","Integrations");case"standalone-plugin-page-/connections/connect-data":return(0,n.t)("nav.connect-data.title","Connect data");case"standalone-plugin-page-/connections/private-data-source-connections":return(0,n.t)("nav.private-data-source-connections.title","Private data source connect");case"plugin-page-grafana-detect-app":return(0,n.t)("nav.detect.title","Detect");case"plugin-page-grafana-quaderno-app":return(0,n.t)("nav.grafana-quaderno.title","Grafana Quaderno");default:return}}function o(r){switch(r){case"dashboards":return(0,n.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"dashboards/browse":return(0,n.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"manage-folder":return(0,n.t)("nav.manage-folder.subtitle","Manage folder dashboards and permissions");case"dashboards/playlists":return(0,n.t)("nav.playlists.subtitle","Groups of dashboards that are displayed in a sequence");case"dashboards/snapshots":return(0,n.t)("nav.snapshots.subtitle","Interactive, publically available, point-in-time representations of dashboards");case"dashboards/library-panels":return(0,n.t)("nav.library-panels.subtitle","Reusable panels that can be added to multiple dashboards");case"dashboards/recentlyDeleted":return(0,n.t)("nav.recentlyDeleted.subtitle","Any items listed here for more than 30 days will be automatically deleted.");case"alerting":return(0,n.t)("nav.alerting.subtitle","Learn about problems in your systems moments after they occur");case"alerting-upgrade":return(0,n.t)("nav.alerting-upgrade.subtitle","Upgrade your existing legacy alerts and notification channels to the new Grafana Alerting");case"alerting-admin":return(0,n.t)("nav.alerting-admin.subtitle","Manage Alertmanager configurations");case"alert-list":return(0,n.t)("nav.alerting-list.subtitle","Rules that determine whether an alert will fire");case"receivers":return(0,n.t)("nav.alerting-receivers.subtitle","Choose how to notify your contact points when an alert instance fires");case"am-routes":return(0,n.t)("nav.alerting-am-routes.subtitle","Determine how alerts are routed to contact points");case"silences":return(0,n.t)("nav.alerting-silences.subtitle","Stop notifications from one or more alerting rules");case"groups":return(0,n.t)("nav.alerting-groups.subtitle","See grouped alerts from an Alertmanager instance");case"datasources":return(0,n.t)("nav.datasources.subtitle","Add and configure data sources");case"correlations":return(0,n.t)("nav.correlations.subtitle","Add and configure correlations");case"users":return(0,n.t)("nav.users.subtitle","Invite and assign roles to users");case"teams":return(0,n.t)("nav.teams.subtitle","Groups of users that have common dashboard and permission needs");case"plugins":return(0,n.t)("nav.plugins.subtitle","Extend the Grafana experience with plugins");case"org-settings":return(0,n.t)("nav.org-settings.subtitle","Manage preferences across an organization");case"apikeys":return(0,n.t)("nav.api-keys.subtitle","Manage and create API keys that are used to interact with Grafana HTTP APIs");case"serviceaccounts":return(0,n.t)("nav.service-accounts.subtitle","Use service accounts to run automated workloads in Grafana");case"global-users":return(0,n.t)("nav.global-users.subtitle","Manage users in Grafana");case"global-orgs":return(0,n.t)("nav.global-orgs.subtitle","Isolated instances of Grafana running on the same server");case"server-settings":return(0,n.t)("nav.server-settings.subtitle","View the settings defined in your Grafana config");case"storage":return(0,n.t)("nav.storage.subtitle","Manage file storage");case"migrate-to-cloud":return(0,n.t)("nav.migrate-to-cloud.subtitle","Copy configuration from your self-managed installation to a cloud stack");case"support-bundles":return(0,n.t)("nav.support-bundles.subtitle","Download support bundles");case"admin":return(0,n.t)("nav.admin.subtitle","Manage server-wide settings and access to resources such as organizations, users, and licenses");case"cfg/general":return(0,n.t)("nav.config-general.subtitle","Manage default preferences and settings across Grafana");case"cfg/plugins":return(0,n.t)("nav.config-plugins.subtitle","Install plugins and define the relationships between data");case"cfg/access":return(0,n.t)("nav.config-access.subtitle","Configure access for individual users, teams, and service accounts");case"apps":return(0,n.t)("nav.apps.subtitle","App plugins that extend the Grafana experience");case"monitoring":return(0,n.t)("nav.monitoring.subtitle","Out-of-the-box observability solutions");case"infrastructure":return(0,n.t)("nav.infrastructure.subtitle","Understand your infrastructure's health");case"frontend":return(0,n.t)("nav.frontend.subtitle","Gain real user monitoring insights");case"alerts-and-incidents":return(0,n.t)("nav.alerts-and-incidents.subtitle","Alerting and incident management apps");case"testing-and-synthetics":return(0,n.t)("nav.testing-and-synthetics.subtitle","Optimize performance with k6 and Synthetic Monitoring insights");case"connections-add-new-connection":return(0,n.t)("nav.connections.subtitle","Browse and create new connections");case"connections-datasources":return(0,n.t)("nav.data-sources.subtitle","View and manage your connected data source connections");case"connections-private-data-source-connections":return(0,n.t)("nav.private-data-source-connections.subtitle","Query data that lives within a secured network without opening the network to inbound traffic from Grafana Cloud. Learn more in our docs.");default:return}}},28874:(Q,I,e)=>{"use strict";e.d(I,{v:()=>o});var n=e(2543),a=e.n(n);function o(r){return(0,n.isArray)(r)?r.map(o):(0,n.isPlainObject)(r)?Object.keys(r).sort().reduce((i,f)=>{const d=r[f];return d!=null&&(i[f]=o(d)),i},{}):r}},21969:(Q,I,e)=>{"use strict";e.d(I,{Ih:()=>a,Lr:()=>i,U7:()=>o,dr:()=>r,fE:()=>f});var n=e(77789);function a(d){const l=["refId","hide","key","queryType","datasource"];for(const m in d)if(m!=="label"&&!l.includes(m))return!1;return!0}function o(d,l,m){const s={...l,refId:(0,n.M)(d),hide:!1};return!s.datasource&&m&&(s.datasource=m),[...d,s]}function r(d){return d.indexOf("api/datasources/proxy")!==-1||d.indexOf("api/ds/query")!==-1}function i(d){return!d.match(/^http/)}function f(d){return d||void 0}},81523:(Q,I,e)=>{"use strict";e.d(I,{Ax:()=>O,DI:()=>c,Gx:()=>p,IA:()=>M,NC:()=>S,TR:()=>L,U3:()=>T,X1:()=>v,cX:()=>E,ev:()=>x,l0:()=>P,oU:()=>D,rs:()=>y,x8:()=>R,xB:()=>g.x});var n=e(2543),a=e.n(n),o=e(76885),r=e(72724),i=e(19347),f=e(82467),d=e(3169),l=e(8484),m=e(99140),s=e(38877),h=e(75533),u=e(11401),b=e(16233),g=e(91650);async function P(F){const{queries:K,localOverride:B,datasource:w,starred:U,comment:W,showNotif:V}=F,_=V?.quotaExceededError??!0,H=V?.limitExceededWarning??!0,G=V?.otherErrors??!0,j=K&&K.filter(Y=>N(Y));if(j.length>0){let Y=!1,oe=!1,se;try{se=(await(B?(0,u.tU)():(0,u.a)()).addToRichHistory({datasourceUid:w.uid,datasourceName:w.name??"",queries:j,starred:U,comment:W??""})).warning}catch(ne){return ne instanceof Error&&(ne.name===s.m.StorageFull?(Y=!0,_&&(0,m.JD)((0,f.dx)((0,d.gi)(ne.message)))):G&&ne.name!==s.m.DuplicatedEntry&&(0,m.JD)((0,f.dx)((0,d.gi)((0,l.t)("explore.rich-history-utils-notification.update-failed","Rich History update failed"),ne.message)))),{richHistoryStorageFull:Y,limitExceeded:oe}}return se&&se.type===s.C.LimitExceeded&&(oe=!0,H&&(0,m.JD)((0,f.dx)((0,d.q8)(se.message)))),{richHistoryStorageFull:Y,limitExceeded:oe}}return{}}async function c(F){const K={...F,from:F.to===void 0?F.to:(0,h.wQ)(F.to,{isLastTs:!0,tz:b.TP.user?.timezone}),to:F.from===void 0?F.from:(0,h.wQ)(F.from,{isLastTs:!0,tz:b.TP.user?.timezone})};return await(0,u.a)().getRichHistory(K)}async function y(F){await(0,u.a)().updateSettings(F)}async function p(){return await(0,u.a)().getSettings()}async function v(){return(0,u.a)().deleteAll()}async function D(F,K){try{return await(0,u.a)().updateStarred(F,K)}catch(B){B instanceof Error&&(0,m.JD)((0,f.dx)((0,d.gi)((0,l.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),B.message)));return}}async function E(F,K){try{return await(0,u.a)().updateComment(F,K)}catch(B){B instanceof Error&&(0,m.JD)((0,f.dx)((0,d.gi)((0,l.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),B.message)));return}}async function S(F){try{return await(0,u.a)().deleteRichHistory(F),F}catch(K){K instanceof Error&&(0,m.JD)((0,f.dx)((0,d.gi)((0,l.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),K.message)));return}}const T=F=>{const K={range:{from:(0,l.t)("explore.rich-history-utils.default-from","now-1h"),to:(0,l.t)("explore.rich-history-utils.default-to","now")},datasource:F.datasourceName,queries:F.queries},B=(0,o.Pp)(K),w=/.*(?=\/explore)/.exec(`${window.location.href}`)[0];return o.kM.renderUrl(`${w}/explore`,{left:B})},M=F=>{let K;switch(F){case 0:K=(0,l.t)("explore.rich-history-utils.today","today");break;case 1:K=(0,l.t)("explore.rich-history-utils.yesterday","yesterday");break;case 7:K=(0,l.t)("explore.rich-history-utils.a-week-ago","a week ago");break;case 14:K=(0,l.t)("explore.rich-history-utils.two-weeks-ago","two weeks ago");break;default:K=(0,l.t)("explore.rich-history-utils.days-ago","{{num}} days ago",{num:`${F}`})}return K};function A(F){return(0,r.LE)(F,{format:"MMMM D"})}function x(F){const K=(0,n.omit)(F,["key","refId","datasource"]);return JSON.stringify(K)}function C(F,K){let B="";return K===g.x.DatasourceAZ||K===g.x.DatasourceZA?B=F.datasourceName:B=A(F.createdAt),B}function O(F,K){return K?.getQueryDisplayText?K.getQueryDisplayText(F):x(F)}function R(F,K){let B={};return F.forEach(w=>{let U=C(w,K);U in B?B[U]=[...B[U],w]:B[U]=[w]}),B}function L(){return(0,i.l)().getList({mixed:!0}).map(F=>({name:F.name,uid:F.uid}))}function N(F){const K=(0,n.omit)(F,["key","refId","datasource"]);return Object.keys(K).length>0}},91650:(Q,I,e)=>{"use strict";e.d(I,{x:()=>n});var n=(a=>(a.Descending="Descending",a.Ascending="Ascending",a.DatasourceAZ="Datasource A-Z",a.DatasourceZA="Datasource Z-A",a))(n||{})},7030:(Q,I,e)=>{"use strict";e.d(I,{$l:()=>y,VN:()=>c,VP:()=>g,fn:()=>b,fv:()=>P});var n=e(41811),a=e(32264),o=e(17172),r=e(12131),i=e(16401),f=e(82467),d=e(3169),l=e(11982),m=e(99140),s=e(87490);function h(){return`${window.location.protocol}//${window.location.host}${a.$.appSubUrl}`}function u(p){let v=p.replace(h(),"");return v.startsWith("/")?v.substring(1,v.length):v}const b=(0,n.A)(async function(p){try{return(await(0,o.AI)().post("/api/short-urls",{path:u(p)})).url}catch(v){console.error("Error when creating shortened link: ",v),(0,m.JD)((0,f.dx)((0,d.gi)("Error generating shortened link")))}}),g=async p=>{const v=await b(p);v?((0,s.uJ)(v),(0,m.JD)((0,f.dx)((0,d.tZ)("Shortened link copied to clipboard")))):(0,m.JD)((0,f.dx)((0,d.gi)("Error generating shortened link")))},P=async(p,v,D)=>{const E=await c(p,v,D);await g(E)},c=async(p,v,D)=>{const E=r.Ny.getLocation(),S=i.jh.getTimeRange(D??p),T=y(v,S,D);return(0,l.uZ)({uid:p.state.uid,slug:p.state.meta.slug,currentQueryParams:E.search,updateQuery:T,absolute:!0})},y=(p,v,D)=>{const E={};return D&&(E.viewPanel=D.state.key),p.useAbsoluteTimeRange&&(E.from=v.state.value.from.toISOString(),E.to=v.state.value.to.toISOString()),p.theme!=="current"&&(E.theme=p.theme),E}},92247:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{getPrecision:()=>i,getScaledDecimals:()=>a,getStringPrecision:()=>f,grafanaTimeFormat:()=>o,logp:()=>r,tickStep:()=>n});function n(d,l,m){const s=Math.sqrt(50),h=Math.sqrt(10),u=Math.sqrt(2),b=Math.abs(l-d)/Math.max(0,m);let g=Math.pow(10,Math.floor(Math.log(b)/Math.LN10));const P=b/g;return P>=s?g*=10:P>=h?g*=5:P>=u&&(g*=2),l<d?-g:g}function a(d,l){return d-Math.floor(Math.log(l)/Math.LN10)}function o(d,l,m){if(l&&m&&d){const s=m-l,h=s/d/1e3,u=864e5,b=31536e6;return h<=45?"HH:mm:ss":h<=7200||s<=u?"HH:mm":h<=8e4?"MM/DD HH:mm":h<=2419200||s<=b?"MM/DD":"YYYY-MM"}return"HH:mm"}function r(d,l){return Math.log(d)/Math.log(l)}function i(d){const l=d.toString();return f(l)}function f(d){if(isNaN(d))return 0;const l=d.indexOf(".");return l===-1?0:d.length-l-1}},80582:(Q,I,e)=>{"use strict";e.d(I,{Wb:()=>a,Zk:()=>o,zG:()=>r});var n=e(47232);const a=(i,f)=>{const d={from:(0,n.yT)(f.from),to:(0,n.yT)(f.to)},l=(d.to.valueOf()-d.from.valueOf())/2;let m,s;return i===-1?(m=d.to.valueOf()-l,s=d.from.valueOf()-l):i===1?(m=d.to.valueOf()+l,s=d.from.valueOf()+l,m>Date.now()&&d.to.valueOf()<Date.now()&&(m=Date.now(),s=d.from.valueOf())):(m=d.to.valueOf(),s=d.from.valueOf()),{from:s,to:m}},o=(i,f)=>{const d=i.to.valueOf()-i.from.valueOf(),l=i.to.valueOf()-d/2,m=d===0?3e4:d*f,s=l+m/2;return{from:l-m/2,to:s}};async function r(){const i=await navigator.clipboard.readText();let f;try{return f=JSON.parse(i),!f.from||!f.to?{range:i,isError:!0}:{range:f,isError:!1}}catch{return{range:i,isError:!0}}}},94515:(Q,I,e)=>{"use strict";e.d(I,{iU:()=>a});var n=e(47232);function a(i,f){if(!(i.fromDayOfWeek||i.from)&&!(i.toDayOfWeek||i.to))return[];const d={...i};d.from&&!d.to&&(d.to=d.from),!d.from&&d.to&&(d.from=d.to);const l={from:o(d.from),to:o(d.to)};if(!d.fromDayOfWeek&&d.toDayOfWeek&&(d.fromDayOfWeek=d.toDayOfWeek),!d.toDayOfWeek&&d.fromDayOfWeek&&(d.toDayOfWeek=d.fromDayOfWeek),d.fromDayOfWeek&&(l.from.dayOfWeek=Number(d.fromDayOfWeek)),d.toDayOfWeek&&(l.to.dayOfWeek=Number(d.toDayOfWeek)),l.from.dayOfWeek&&l.from.h==null&&l.from.m==null&&(l.from.h=0,l.from.m=0,l.from.s=0),l.to.dayOfWeek&&l.to.h==null&&l.to.m==null&&(l.to.h=23,l.to.m=59,l.to.s=59),!l.from||!l.to)return[];l.from.h==null&&(l.from.h=0),l.to.h==null&&(l.to.h=23);const m=[],s=(0,n.KQ)(f.from).utc();for(s.set("hour",0),s.set("minute",0),s.set("second",0),s.set("millisecond",0),s.add(l.from.h,"hours"),s.add(l.from.m,"minutes"),s.add(l.from.s,"seconds");s.unix()<=f.to.unix();){for(;l.from.dayOfWeek&&l.from.dayOfWeek!==s.isoWeekday();)s.add(24,"hours");if(s.unix()>f.to.unix())break;const h=(0,n.KQ)(s).utc();if(h.hour)if(l.from.h<=l.to.h)h.add(l.to.h-l.from.h,"hours");else if(l.from.h>l.to.h)for(;h.hour()!==l.to.h;)h.add(1,"hours");else for(h.add(24-l.from.h,"hours");h.hour()!==l.to.h;)h.add(1,"hours");for(h.set("minute",l.to.m??0),h.set("second",l.to.s??0);l.to.dayOfWeek&&l.to.dayOfWeek!==h.isoWeekday();)h.add(24,"hours");s.unix()<f.from.unix()&&h.unix()<f.from.unix()||s.unix()>f.to.unix()&&h.unix()>f.to.unix()||m.push({from:s.valueOf(),to:h.valueOf()}),s.add(24,"hours")}return m}function o(i){const f={};if(!i?.length)return f;const d=i.split(":");return d?.length&&(f.h=Math.min(23,Math.max(0,Number(d[0]))),d.length>1&&(f.m=Math.min(60,Math.max(0,Number(d[1]))),d.length>2&&(f.s=Math.min(60,Math.max(0,Number(d[2])))))),f}function r(i){if(!i||i.h==null&&i.m==null&&i.s==null)return"";let f=String(i.h??0).padStart(2,"0")+":"+String(i.m??0).padStart(2,"0");return i.s!=null&&(f+=String(i.s??0).padStart(2,"0")),f}},67027:(Q,I,e)=>{"use strict";e.d(I,{r:()=>a});let n="";const a=()=>{const r=new URLSearchParams(window.location.search).get("auth_token");return r!==null&&r!==""?(n=r,r):n}},60933:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{addExtensionReducers:()=>Ch,init:()=>Mh});var n=e(33378),a=e(32264),o=e(14110),r=e(10096),i=e(6320),f=e(65191),d=e(2272),l=e(31678),m=e(75192),s=e(96540),h=e(21594),u=e(14578);const b="licensedRole",g=[{value:"server_admin",label:"Server admin"},{value:"admin_editor",label:"Admin/editor"},{value:"viewer",label:"Viewer"}],P=({filters:k,onChange:ve,className:Be})=>s.createElement(h.KF,{value:k.find(Qe=>Qe.name===b)?.value,options:g,onChange:Qe=>{ve({name:b,value:Qe})},prefix:s.createElement(u.I,{name:"filter"}),width:64,placeholder:"Filter by licensed role",menuShouldPortal:!0,className:Be}),c=()=>{(0,m.jT)(P)};var y=e(73399),p=e(13280),v=e(95273),D=(k=>(k.Monthly="monthly",k.Weekly="weekly",k.Daily="daily",k.Hourly="hourly",k.Never="never",k.Custom="custom",k.Once="once",k))(D||{}),E=(k=>(k.Hours="hours",k.Days="days",k.Weeks="weeks",k.Months="months",k))(E||{}),S=(k=>(k.Default="",k.SentBy="sent-by",k.None="none",k))(S||{}),T=(k=>(k.Paused="paused",k.Scheduled="scheduled",k.Expired="expired",k.Draft="draft",k.Never="not scheduled",k))(T||{}),M=(k=>(k.PDF="pdf",k.CSV="csv",k.Image="image",k.PDFTables="pdf-tables",k.PDFTablesAppendix="pdf-tables-appendix",k))(M||{});const A=[{value:"landscape",label:"Landscape",icon:"gf-landscape"},{value:"portrait",label:"Portrait",icon:"gf-portrait"}],x=[{value:"grid",label:"Grid",icon:"gf-grid"},{value:"simple",label:"Simple",icon:"gf-layout-simple"}];var C=(k=>(k.SelectDashboard="select-dashboard",k.FormatReport="format-report",k.Schedule="schedule",k.Share="share",k.Confirm="confirm",k))(C||{});const O="last";var R=(k=>(k.Stats="stats",k.Users="users",k.PublicDashboards="public-dashboards",k))(R||{}),L=e(82421),N=(k=>(k.ReportingCreate="reports:create",k.ReportingWrite="reports:write",k.ReportingDelete="reports:delete",k.ReportingRead="reports:read",k.ReportingSend="reports:send",k.ReportingSettingsWrite="reports.settings:write",k.ReportingSettingsRead="reports.settings:read",k.DataSourcesPermissionsRead="datasources.permissions:read",k.DataSourcesPermissionsWrite="datasources.permissions:write",k.DataSourcesCachingWrite="datasources.caching:write",k.LicensingRead="licensing:read",k.LicensingWrite="licensing:write",k.LicensingReportsRead="licensing.reports:read",k.DashboardsInsightsRead="dashboards.insights:read",k.ActionBannersWrite="banners:write",k))(N||{}),F=e(40964),K=(k=>(k.General="general",k.KeyCert="key-cert",k.ConnectToIdP="connect-to-idp",k.AssertionMapping="assertion-mapping",k.SaveAndTest="save-and-test",k))(K||{}),B=e(32196),w=e(49785),U=e(71468),W=e(40845),V=e(56034),_=e(88575),H=e(15292),G=e(10354),j=e(14186);const Y=({value:k,label:ve,placeholder:Be,width:Qe,id:lt,onChange:Ct})=>{const jt=(0,W.of)(oe),pn=yn=>{const Un=yn.currentTarget.value;Ct(Un)};return s.createElement("div",{className:jt.assertionEditorRow},s.createElement(j.I,{label:ve,labelWidth:16,htmlFor:lt},s.createElement(G.p,{width:Qe||30,id:lt,value:k||"",onChange:pn,placeholder:Be})))},oe=k=>({assertionEditorRow:(0,B.css)`
      display: flex;
      margin-bottom: ${k.spacing(1)};
    `,inputLabel:(0,B.css)`
      color: ${k.components.input.text};
      background: ${k.components.input.background};
    `});var se=e(24180),ne=e(84167),ee=e(17408),Z=e(39938),z=e(42418),q=e(20604);function ie(k){return{error:k.authConfig.updateError,warning:k.authConfig.warning}}const de={resetError:q.SH,resetWarning:q.yk},Se=(0,U.connect)(ie,de)(({error:k,warning:ve,resetError:Be,resetWarning:Qe})=>s.createElement("div",null,k&&s.createElement(z.F,{title:k.message,onRemove:()=>Be()},k.errors?.map((lt,Ct)=>s.createElement("div",{key:Ct},lt))),ve&&s.createElement(z.F,{title:ve.message,onRemove:()=>Qe(),severity:"warning"},ve.errors?.map((lt,Ct)=>s.createElement("div",{key:Ct},lt)))));var he=e(37390),ce=e(55852);const me=({confirmRedirect:k,onDiscard:ve,onLocationChange:Be})=>{const[Qe,lt]=(0,s.useState)(!1),[Ct,jt]=(0,s.useState)(null),[pn,yn]=(0,s.useState)(!1);(0,s.useEffect)(()=>{const $n=ca=>{k&&(ca.preventDefault(),ca.returnValue="")};return window.addEventListener("beforeunload",$n),()=>{window.removeEventListener("beforeunload",$n)}},[k]);const Un=$n=>{const ca=window.location.pathname,pa=$n.pathname;if(ca===pa)return!0;const va=Be?.($n);let ma=k&&!pn;return va!==void 0&&(ma=ma&&va),ma?(lt(!0),jt($n),!1):(va&&ve(),!0)},kn=()=>{lt(!1),jt(null)},Vn=()=>{lt(!1),yn(!0),ve()};return s.createElement(s.Fragment,null,s.createElement(se.XG,{when:!0,message:Un}),Ct&&pn&&s.createElement(se.rd,{to:Ct}),s.createElement(pe,{isOpen:Qe,onDiscard:Vn,onBackToForm:kn}))},pe=({onDiscard:k,onBackToForm:ve,isOpen:Be})=>s.createElement(he.a,{isOpen:Be,title:"Leave page?",onDismiss:ve,icon:"exclamation-triangle",className:(0,B.css)`
        width: 500px;
      `},s.createElement("h5",null,"Changes that you made may not be saved."),s.createElement(he.a.ButtonRow,null,s.createElement(ce.$n,{variant:"secondary",onClick:ve,fill:"outline"},"Continue editing"),s.createElement(ce.$n,{variant:"destructive",onClick:k},"Discard unsaved changes")));var ye=e(50720);function Pe({validationResults:k,onStepChange:ve,visitedSteps:Be=[],getNextUrl:Qe,steps:lt,activeStep:Ct=lt[0].id}){const jt=(0,W.of)(Ie),pn=lt[lt.length-1];return s.createElement("ol",{className:jt.container},lt.map(yn=>{const Un=yn.id===pn.id,kn=yn.id===Ct,Vn=Be.includes(yn.id)||Ct===pn.id,$n=!Un&&!k[yn.id].valid,ca=!kn&&!Un&&Vn,pa=ca&&!$n,va=ca&&$n,ma=(0,B.cx)(jt.item,{[jt.active]:kn,[jt.successItem]:pa,[jt.warnItem]:va});return s.createElement("li",{key:yn.id,className:ma},pa&&s.createElement(u.I,{name:"check",size:"xl",className:jt.successItem}),va&&s.createElement(u.I,{name:"exclamation-triangle",className:jt.warnItem}),s.createElement(ye.N,{onClick:kn?void 0:()=>ve(yn.id),href:Qe(yn.id),className:jt.link},yn.name),!Un&&s.createElement("div",{className:jt.divider},"\u2014"))}))}const Ie=k=>({container:(0,B.css)`
      counter-reset: item;
      list-style-type: none;
      width: 100%;
      position: relative;
      display: flex;
      justify-content: center;
      border: 1px solid ${k.colors.border.weak};
      margin: ${k.spacing(4,0)};
    `,item:(0,B.css)`
      color: ${k.colors.text.secondary};
      display: flex;
      align-items: center;
    `,successItem:(0,B.css)`
      a {
        &::before {
          content: '';
        }
      }

      svg {
        color: ${k.colors.success.text};
        margin: ${k.spacing(0,.5,0,-1)};
      }
    `,warnItem:(0,B.css)`
      a::before {
        content: '';
      }
      svg {
        color: ${k.colors.warning.text};
        margin: ${k.spacing(0,1,.5,-.5)};
      }
    `,link:(0,B.css)`
      color: inherit;
      &:hover {
        color: ${k.colors.text.link};
      }

      &::before {
        content: counter(item) '  ';
        counter-increment: item;
      }
    `,active:(0,B.css)`
      font-weight: 500;
      color: ${k.colors.text.maxContrast};

      &::before {
        font-weight: 500;
      }
    `,divider:(0,B.css)`
      padding: ${k.spacing(2)};
    `}),Oe=({error:k,onReset:ve})=>s.createElement("div",null,k&&s.createElement(z.F,{title:k.message,onRemove:ve,severity:"warning"},k.errors?.map((Be,Qe)=>s.createElement("div",{key:Qe},Be))));var Ne=e(12131),We=e(2543);const Ae="/admin/authentication/saml",Ue=a.$.appUrl+"saml/metadata",Me=a.$.appUrl+"saml/acs",$e=a.$.appUrl+"saml/slo";function ke(k){return{enabled:Ze(k.enabled),allowSignUp:Ze(k.allow_sign_up),autoLogin:Ze(k.auto_login),singleLogout:Ze(k.single_logout),allowIdpInitiated:Ze(k.allow_idp_initiated),skipOrgRoleSync:Ze(k.skip_org_role_sync),name:ot(k.name),privateKey:ot(k.private_key),privateKeyPath:ot(k.private_key_path),certificate:ot(k.certificate),certificatePath:ot(k.certificate_path),signatureAlgorithm:ot(k.signature_algorithm),idpMetadata:ot(k.idp_metadata),idpMetadataPath:ot(k.idp_metadata_path),idpMetadataUrl:ot(k.idp_metadata_url),maxIssueDelay:ot(k.max_issue_delay),metadataValidDuration:ot(k.metadata_valid_duration),relayState:ot(k.relay_state),assertionAttributeName:ot(k.assertion_attribute_name),assertionAttributeLogin:ot(k.assertion_attribute_login),assertionAttributeEmail:ot(k.assertion_attribute_email),assertionAttributeGroups:ot(k.assertion_attribute_groups),assertionAttributeRole:ot(k.assertion_attribute_role),assertionAttributeOrg:ot(k.assertion_attribute_org),allowedOrganizations:ot(k.allowed_organizations),orgMapping:ot(k.org_mapping),roleValuesNone:ot(k.role_values_none),roleValuesViewer:ot(k.role_values_viewer),roleValuesEditor:ot(k.role_values_editor),roleValuesAdmin:ot(k.role_values_admin),roleValuesGrafanaAdmin:ot(k.role_values_grafana_admin),nameIdFormat:ot(k.name_id_format)}}function Ze(k){return k==="true"}function ot(k){return k||""}function xt(k){return k?"true":"false"}function ct(k){return{enabled:xt(k.enabled),allow_sign_up:xt(k.allowSignUp),auto_login:xt(k.autoLogin),single_logout:xt(k.singleLogout),allow_idp_initiated:xt(k.allowIdpInitiated),skip_org_role_sync:xt(k.skipOrgRoleSync),name:ot(k.name),private_key:ot(k.privateKey),private_key_path:ot(k.privateKeyPath),certificate:ot(k.certificate),certificate_path:ot(k.certificatePath),signature_algorithm:ot(k.signatureAlgorithm),idp_metadata:ot(k.idpMetadata),idp_metadata_path:ot(k.idpMetadataPath),idp_metadata_url:ot(k.idpMetadataUrl),max_issue_delay:ot(k.maxIssueDelay),metadata_valid_duration:ot(k.metadataValidDuration),relay_state:ot(k.relayState),assertion_attribute_name:ot(k.assertionAttributeName),assertion_attribute_login:ot(k.assertionAttributeLogin),assertion_attribute_email:ot(k.assertionAttributeEmail),assertion_attribute_groups:ot(k.assertionAttributeGroups),assertion_attribute_role:ot(k.assertionAttributeRole),assertion_attribute_org:ot(k.assertionAttributeOrg),allowed_organizations:ot(k.allowedOrganizations),org_mapping:ot(k.orgMapping),role_values_none:ot(k.roleValuesNone),role_values_viewer:ot(k.roleValuesViewer),role_values_editor:ot(k.roleValuesEditor),role_values_admin:ot(k.roleValuesAdmin),role_values_grafana_admin:ot(k.roleValuesGrafanaAdmin),name_id_format:ot(k.nameIdFormat)}}function ft(k){const{keyCertValueType:ve,metadataValueType:Be,signRequests:Qe}=k,{certificate_path:lt,private_key_path:Ct,certificate:jt,private_key:pn,idp_metadata_url:yn,idp_metadata_path:Un,idp_metadata:kn,...Vn}=ct(k),$n={updates:{"auth.saml":Vn},removals:{"auth.saml":[]}};return ve==="path"?(Ct&&!Te(Ct)&&($n.updates["auth.saml"].private_key_path=Ct,$n.updates["auth.saml"].private_key=""),lt&&!Te(lt)&&($n.updates["auth.saml"].certificate_path=lt,$n.updates["auth.saml"].certificate="")):ve==="base64"&&(pn&&!Te(pn)&&($n.updates["auth.saml"].private_key=pn,$n.updates["auth.saml"].private_key_path=""),jt&&!Te(jt)&&($n.updates["auth.saml"].certificate=jt,$n.updates["auth.saml"].certificate_path="")),Qe||($n.updates["auth.saml"].signature_algorithm=""),Be==="url"?($n.updates["auth.saml"].idp_metadata_url=yn,$n.updates["auth.saml"].idp_metadata_path="",$n.updates["auth.saml"].idp_metadata=""):Be==="path"?($n.updates["auth.saml"].idp_metadata_path=Un,$n.updates["auth.saml"].idp_metadata_url="",$n.updates["auth.saml"].idp_metadata=""):Be==="base64"&&($n.updates["auth.saml"].idp_metadata=kn,$n.updates["auth.saml"].idp_metadata_url="",$n.updates["auth.saml"].idp_metadata_path=""),$n}function Le(k,ve){const Be={};return Object.keys(k).forEach(Qe=>{k[Qe]!==ve[Qe]&&(Be[Qe]=k[Qe])}),Be}function re(k){const ve=k?.split(/[,\s]/),Be=[];return ve?.forEach(Qe=>{const lt=Qe.split(":");if(lt.length===3){const Ct=le(lt[2]);Ct&&Be.push({externalOrg:lt[0],orgId:lt[1],role:Ct})}}),Be}function X(k){return k.map(Be=>`${Be.externalOrg}:${Be.orgId}:${Be.role}`).join(",")}function le(k){return k==="Admin"||k==="Editor"||k==="Viewer"?k:null}const be={enabled:"false",skip_org_role_sync:"false"};function De(k){return(0,We.isEqual)(k,be)}function Te(k){return k?/^\*+$/.test(k):!1}function we(k,ve,Be){switch(k){case"privateKey":return ve[k]===Be.private_key&&!!Be.private_key;case"privateKeyPath":return ve[k]===Be.private_key_path&&!!Be.private_key_path;case"certificate":return ve[k]===Be.certificate&&!!Be.certificate;case"certificatePath":return ve[k]===Be.certificate_path&&!!Be.certificate_path;default:return!1}}function Ke(k){return k.idpMetadataPath?"path":k.idpMetadata?"base64":"url"}const Ve=k=>`${Ae}/${k||""}`,ht=k=>{if(!k)return Vs[0];const ve=Vs.findIndex(Be=>Be.id===k);return ve===Vs.length-1?Vs[ve]:Vs[ve+1]},gt=k=>{if(!k||k===Vs[0].id)return;const ve=Vs.findIndex(Be=>Be.id===k);return Vs[ve-1]},bt=k=>{const ve=gt(k);ve&&ve.id!==k&&Ne.Ny.push(Ve(ve.id))},St=(0,s.forwardRef)(({activeStep:k,disabled:ve},Be)=>{const Qe=(0,W.of)(Je),lt=(0,s.useRef)(null),Ct=gt(k),jt=ht(k),pn=jt.id===k;(0,s.useImperativeHandle)(Be,()=>({click:()=>{lt.current?.click()}}));const yn=()=>{lt.current?.click(),bt(k)};return s.createElement("div",{className:Qe.buttonRow},s.createElement("div",{className:Qe.buttonRowInner},s.createElement("div",null,Ct&&s.createElement(ce.$n,{variant:"secondary",onClick:yn},"Previous: ",Ct.name),!pn&&s.createElement(ce.$n,{ref:lt,disabled:ve,type:"submit"},"Next: ",jt.name))))});St.displayName="ButtonRow";const Je=k=>({buttonRow:(0,B.css)`
      display: flex;
      padding: ${k.spacing(2,0,.5,0)};
      border-top: 1px solid ${k.colors.border.weak};
      width: 100%;
      background-color: ${k.colors.background.primary};
      button {
        &:first-of-type {
          margin-right: ${k.spacing(2)};
        }
        &:last-of-type {
          margin-right: 0;
        }
      }
    `,buttonRowInner:(0,B.css)`
      display: flex;
      justify-content: space-between;
      width: 100%;
    `});var rt=e(38138),Rt=e(83122),_t=e(29158),nn=e(96374);const Kt=({enabled:k,isNewConfig:ve,onSave:Be,onSaveAndEnable:Qe,onDisable:lt,onRemove:Ct})=>{const jt=(0,W.of)(en);let pn={text:"Not enabled",color:"blue"};k?pn={text:"Enabled",color:"green",icon:"check"}:ve||(pn={text:"Not enabled",color:"blue"});const[yn,Un]=s.useState(!1),kn=()=>{Ct(),Un(!1),window.location.href="/admin/authentication"},Vn=s.createElement(rt.W,null,s.createElement(rt.W.Item,{label:"Delete",icon:"trash-alt",onClick:()=>{Un(!0)}}));return s.createElement(s.Fragment,null,s.createElement("div",{className:jt.actionBarContainer},s.createElement("div",{className:jt.protocolContainer},s.createElement("span",{className:jt.protocolLabel},"Protocol"),s.createElement("span",null,"SAML 2.0")),!ve&&s.createElement("div",{className:jt.statusContainer},s.createElement("span",{className:jt.statusLabel},"Status"),s.createElement(Z.E,{...pn,className:jt.statusBadge})),!k&&s.createElement(s.Fragment,null,s.createElement(ce.$n,{variant:"secondary",onClick:Be},"Save"),s.createElement(ce.$n,{variant:"primary",onClick:Qe},"Save and enable")),k&&s.createElement(s.Fragment,null,s.createElement(ce.$n,{variant:"primary",onClick:Be},"Save and apply"),s.createElement(V.m,{content:"Disable will disable Grafana to not use SAML auth.",placement:"top"},s.createElement(ce.$n,{variant:"secondary",fill:"outline",onClick:lt},"Disable"))),!ve&&s.createElement(Rt.m,{overlay:Vn,placement:"bottom-start"},s.createElement(_t.K,{tooltip:"More actions",tooltipPlacement:"top",variant:"secondary",name:"ellipsis-v"}))),s.createElement(nn.u,{title:"Delete SAML configuration",body:"Are you sure you want to permanently delete this SAML configuration? All changes made in the UI will be removed.",confirmText:"Delete configuration",confirmationText:k?"delete":"",dismissText:"Back to editing",isOpen:yn,onDismiss:()=>Un(!1),onConfirm:kn}))},en=k=>({actionBarContainer:(0,B.css)`
      display: flex;
      flexdirection: row;
      gap: ${k.spacing(1)};
      align-items: center;
      justify-content: flex-end;
    `,iniFileLabel:(0,B.css)`
      display: flex;
      color: ${k.colors.text.primary};
      justify-content: flex-end;
    `,tooltipContainer:(0,B.css)`
      padding: ${k.spacing(0,1)};
    `,statusContainer:(0,B.css)`
      display: flex;
      flex-direction: column;
      font-size: ${k.typography.bodySmall.fontSize};
      border-left: 1px solid ${k.colors.border.medium};
      padding: ${k.spacing(0,2)};
    `,statusBadge:(0,B.css)`
      span {
        font-size: ${k.typography.size.xs};
      }
    `,statusLabel:(0,B.css)`
      color: ${k.colors.text.secondary};
    `,protocolContainer:(0,B.css)`
      display: flex;
      flex-direction: column;
      font-size: ${k.typography.bodySmall.fontSize};
      padding-right: ${k.spacing(1)};
    `,protocolLabel:(0,B.css)`
      color: ${k.colors.text.secondary};
    `});var Qt=e(17172),An=e(60610),un=e(65307);const fn={assertionAttributeName:"displayName",assertionAttributeLogin:"mail",assertionAttributeEmail:"mail"},Tt={storedSamlSettings:{},samlSettings:{},samlStep:1,activeStep:K.General,signRequests:!1,keyCertValueType:"base64",keyConfigured:!1,certConfigured:!1,metadataValueType:"url",configChanged:!1,showSavedBadge:!1,visitedSteps:[],isUpdated:!1,isLoading:!1,configFoundInIniFile:!1},$t=(0,un.Z0)({name:"samlConfig",initialState:Tt,reducers:{settingsLoaded:(k,ve)=>({...k,samlSettings:ve.payload,configChanged:!1,isLoading:!1}),setStoredSAMLSettings:(k,ve)=>({...k,storedSamlSettings:ve.payload}),setConfigFoundInIniFile:(k,ve)=>({...k,configFoundInIniFile:ve.payload}),settingsUpdated:(k,ve)=>({...k,samlSettings:ve.payload,configChanged:!0}),settingsLoadingBegin:k=>({...k,isLoading:!0}),settingsLoadingEnd:k=>({...k,isLoading:!1}),samlStepChanged:(k,ve)=>({...k,samlStep:ve.payload}),setSignRequests:(k,ve)=>({...k,signRequests:ve.payload}),setKeyCertValueType:(k,ve)=>({...k,keyCertValueType:ve.payload}),setKeyConfigured:(k,ve)=>({...k,keyConfigured:ve.payload}),setCertConfigured:(k,ve)=>({...k,certConfigured:ve.payload}),setMetadataValueType:(k,ve)=>({...k,metadataValueType:ve.payload}),settingsChanged:(k,ve)=>({...k,configChanged:ve.payload}),setError:(k,ve)=>({...k,error:ve.payload}),resetError:k=>({...k,error:void 0}),setShowSavedBadge:(k,ve)=>({...k,showSavedBadge:ve.payload}),addVisitedStep:(k,ve)=>({...k,visitedSteps:[...k.visitedSteps,...ve.payload]}),clearSAMLState:k=>({...k,isUpdated:!1,visitedSteps:[]})}}),{settingsLoaded:Yt,settingsUpdated:Cn,samlStepChanged:Tn,setStoredSAMLSettings:vn,setSignRequests:Kn,setKeyCertValueType:Yn,setKeyConfigured:nt,setCertConfigured:yt,setMetadataValueType:Vt,settingsChanged:je,setShowSavedBadge:tt,setConfigFoundInIniFile:Dt,addVisitedStep:Ot,clearSAMLState:Lt,settingsLoadingBegin:Gt,settingsLoadingEnd:hn,setError:mt,resetError:Bt}=$t.actions,Rn={samlConfig:$t.reducer},Mt=()=>a.$.featureToggles?.ssoSettingsApi&&a.$.featureToggles?.ssoSettingsSAML;async function wt(){return Mt()?tn():Ht()}async function Ht(){const ve=(await(0,Qt.AI)().get("/api/admin/settings"))["auth.saml"]||{};return[ke(ve),ve]}async function tn(){const k=await(0,Qt.AI)().get("/api/v1/sso-settings/saml"),ve=k?k.settings:{},Be=Bs(ve);return[ve,Be]}function It(k,ve){if(Mt()){const Be=ks(k);return jn(Be)}else return Xe(k,ve)}function Xe(k,ve){const Be=ft(k);if(Be.updates){const Qe=Le(Be.updates["auth.saml"],ve);Be.updates["auth.saml"]=Qe}return(0,An.DZ)(Be)}function jn(k){return async ve=>{if(r.contextSrv.hasPermission(l.AccessControlAction.SettingsWrite))try{return await(0,Qt.AI)().put("/api/v1/sso-settings/saml",{provider:"saml",settings:{...k}},{showErrorAlert:!1}),ve(Bt()),!0}catch(Be){if((0,Qt.NF)(Be)){Be.isHandled=!0;const Qe={message:Be.data?.message,errors:Be.data?.errors};return ve(mt(Qe)),!1}}return!1}}function Qn(){return Mt()?ia():wn()}function ia(){return async k=>{if(r.contextSrv.hasPermission(l.AccessControlAction.SettingsWrite))try{return await(0,Qt.AI)().delete("/api/v1/sso-settings/saml",void 0,{showSuccessAlert:!1,showErrorAlert:!1}),k(Bt()),!0}catch(ve){if((0,Qt.NF)(ve)){ve.isHandled=!0;const Be={message:ve.data?.message,errors:ve.data?.errors};return k(mt(Be)),!1}}return!1}}function wn(){const k={removals:{"auth.saml":["enabled","name","single_logout","allow_sign_up","auto_login","certificate","certificate_path","private_key","private_key_path","signature_algorithm","idp_metadata","idp_metadata_path","idp_metadata_url","max_issue_delay","metadata_valid_duration","allow_idp_initiated","relay_state","assertion_attribute_name","assertion_attribute_login","assertion_attribute_email","assertion_attribute_groups","assertion_attribute_role","assertion_attribute_org","allowed_organizations","org_mapping","role_values_none","role_values_viewer","role_values_editor","role_values_admin","role_values_grafana_admin","name_id_format","skip_org_role_sync"]}};return(0,An.DZ)(k)}function sa(k){return Mt()?La(k):xa()}function La(k){return jn({...k,enabled:!0})}function xa(){const k={updates:{"auth.saml":{enabled:"true"}}};return(0,An.DZ)(k)}function ga(k){return Mt()?Ts(k):Us()}function Ts(k){return jn({...k,enabled:!1})}function Us(){const k={updates:{"auth.saml":{enabled:"false"}}};return(0,An.DZ)(k)}function Bs(k){return{enabled:k?.enabled?"true":"false",name:k?.name,allow_sign_up:k?.allowSignUp?"true":"false",auto_login:k?.autoLogin?"true":"false",single_logout:k?.singleLogout?"true":"false",allow_idp_initiated:k?.allowIdpInitiated?"true":"false",skip_org_role_sync:k?.skipOrgRoleSync?"true":"false",private_key:k?.privateKey,private_key_path:k?.privateKeyPath,certificate:k?.certificate,certificate_path:k?.certificatePath,signature_algorithm:k?.signatureAlgorithm,idp_metadata:k?.idpMetadata,idp_metadata_path:k?.idpMetadataPath,idp_metadata_url:k?.idpMetadataUrl,max_issue_delay:k?.maxIssueDelay,metadata_valid_duration:k?.metadataValidDuration,relay_state:k?.relayState,assertion_attribute_name:k?.assertionAttributeName,assertion_attribute_login:k?.assertionAttributeLogin,assertion_attribute_email:k?.assertionAttributeEmail,assertion_attribute_groups:k?.assertionAttributeGroups,assertion_attribute_role:k?.assertionAttributeRole,assertion_attribute_org:k?.assertionAttributeOrg,allowed_organizations:k?.allowedOrganizations,org_mapping:k?.orgMapping,role_values_none:k?.roleValuesNone,role_values_viewer:k?.roleValuesViewer,role_values_editor:k?.roleValuesEditor,role_values_admin:k?.roleValuesAdmin,role_values_grafana_admin:k?.roleValuesGrafanaAdmin,name_id_format:k?.nameIdFormat}}function ks(k){return{enabled:k?.enabled,name:k?.name,allowSignUp:k?.allowSignUp,autoLogin:k?.autoLogin,singleLogout:k?.singleLogout,allowIdpInitiated:k?.allowIdpInitiated,skipOrgRoleSync:k?.skipOrgRoleSync,privateKey:k?.privateKey,privateKeyPath:k?.privateKeyPath,certificate:k?.certificate,certificatePath:k?.certificatePath,signatureAlgorithm:k?.signatureAlgorithm,idpMetadata:k?.idpMetadata,idpMetadataPath:k?.idpMetadataPath,idpMetadataUrl:k?.idpMetadataUrl,maxIssueDelay:k?.maxIssueDelay,metadataValidDuration:k?.metadataValidDuration,relayState:k?.relayState,assertionAttributeName:k?.assertionAttributeName,assertionAttributeLogin:k?.assertionAttributeLogin,assertionAttributeEmail:k?.assertionAttributeEmail,assertionAttributeGroups:k?.assertionAttributeGroups,assertionAttributeRole:k?.assertionAttributeRole,assertionAttributeOrg:k?.assertionAttributeOrg,allowedOrganizations:k?.allowedOrganizations,orgMapping:k?.orgMapping,roleValuesNone:k?.roleValuesNone,roleValuesViewer:k?.roleValuesViewer,roleValuesEditor:k?.roleValuesEditor,roleValuesAdmin:k?.roleValuesAdmin,roleValuesGrafanaAdmin:k?.roleValuesGrafanaAdmin,nameIdFormat:k?.nameIdFormat}}var Ms=e(39547);function Dr(k,ve,Be){fr(Be,k(ve))}function _s(k){const ve={valid:!0,errors:[]};return Dr(Gs,k,ve),Dr(Br,k,ve),Dr(Mr,k,ve),Dr(vr,k,ve),ve}function Ir(k,ve){switch(ve){case SAMLStepKey.General:return!Gs(k).valid;case SAMLStepKey.KeyCert:return!Br(k).valid;case SAMLStepKey.ConnectToIdP:return!Mr(k).valid;case SAMLStepKey.AssertionMapping:return!vr(k).valid;default:return!1}}function Xs(k){const ve={};return Vs.forEach(({id:Be})=>{switch(Be){case K.General:ve[Be]=Gs(k);return;case K.KeyCert:ve[Be]=Br(k);return;case K.ConnectToIdP:ve[Be]=Mr(k);return;case K.AssertionMapping:ve[Be]=vr(k);return}}),ve}function Gs(k){const ve={valid:!0,errors:[]},{allowIdpInitiated:Be,relayState:Qe}=k;return Be===!0&&!Qe&&js(ve,"Relay state should be configured"),Qe&&Qe.length>80&&js(ve,"Relay state should be 80 characters or less"),ve}function Br(k){const ve={valid:!0,errors:[]},{privateKey:Be,privateKeyPath:Qe,certificate:lt,certificatePath:Ct}=k;return!Be&&!Qe&&js(ve,"Private key should be configured"),!lt&&!Ct&&js(ve,"Certificate key should be configured"),Be&&!Be.startsWith("***")&&!Ar(Be)&&js(ve,"Not valid PEM private key"),lt&&!lt.startsWith("***")&&!no(lt)&&js(ve,"Not valid PEM certificate"),ve}function Mr(k){const ve={valid:!0,errors:[]},{idpMetadataUrl:Be,idpMetadataPath:Qe,idpMetadata:lt,metadataValueType:Ct}=k;return(Ct==="base64"&&!lt||Ct==="url"&&!Be||Ct==="path"&&!Qe||!Be&&!Qe&&!lt)&&js(ve,"IdP metadata should be configured"),ve}function vr(k){return{valid:!0,errors:[]}}function fr(k,ve){ve.valid||(k.valid=!1,k.errors?.push(...ve.errors))}function js(k,ve){k.valid=!1,k.errors?.push(ve)}function to(k){return/^([0-9]*(\.[0-9]*)?[smh]+)+$/.test(k)}function Ar(k){try{const ve=atob(k);return Ko(ve)}catch{return!1}}function Ko(k){try{const ve=Ms.pem.decode(k);return!(ve.length>1||ve[0].type!=="PRIVATE KEY")}catch{return!1}}function no(k){try{const ve=atob(k);return vo(ve)}catch{return!1}}function vo(k){try{const ve=Ms.pki.certificateFromPem(k),Be=new Date;return!(ve.validity.notBefore>Be||ve.validity.notAfter<Be)}catch{return!1}}const ao=5e3;function Do(){return async k=>{if(r.contextSrv.hasPermission(l.AccessControlAction.SettingsRead))try{k(Gt());const[ve,Be]=await wt();k(vn(Be)),k(Kn(!!ve.signatureAlgorithm)),k(Yn(ve.privateKeyPath?"path":"base64")),k(nt(!!ve.privateKeyPath||!!ve.privateKey)),k(yt(!!ve.certificatePath||!!ve.certificate)),k(Vt(Ke(ve))),k(Yt(ve))}catch{k(hn())}}}function Xr(k,ve){return async Be=>{Be(Bt());const Qe=_s(k);if(!Qe.valid){Be(mt({message:"Cannot save settings",errors:Qe.errors}));return}await Be(It(k,ve))&&(Be(jr()),Be(Do()))}}function mo(){return async k=>{await k(Qn())&&(k(jr()),k(Do()))}}function qr(k){return async ve=>{await ve(sa(k))&&(ve(jr()),ve(Do()))}}function Po(k){return async ve=>{await ve(ga(k))&&(ve(jr()),ve(Do()))}}function jr(){return async k=>{k(tt(!0)),setTimeout(()=>{k(tt(!1))},ao)}}const Io=k=>{const{samlSettings:ve,storedSamlSettings:Be,isUpdated:Qe,visitedSteps:lt,keyCertValueType:Ct,keyConfigured:jt,certConfigured:pn,signRequests:yn,metadataValueType:Un,showSavedBadge:kn,error:Vn}=k.samlConfig;return{isUpdated:Qe,samlSettings:ve,storedSamlSettings:Be,visitedSteps:lt,keyCertValueType:Ct,keyConfigured:jt,certConfigured:pn,signRequests:yn,metadataValueType:Un,showSavedBadge:kn,error:Vn}},$o={addVisitedStep:Ot,clearSAMLState:Lt,saveSAMLSettings:Xr,enableSAML:qr,disableSAML:Po,resetSAMLSettings:mo,setError:mt,resetError:Bt},qo=(0,U.connect)(Io,$o),lo=({samlSettings:k,storedSamlSettings:ve,keyCertValueType:Be,metadataValueType:Qe,signRequests:lt,activeStep:Ct,addVisitedStep:jt,children:pn,clearSAMLState:yn,confirmRedirect:Un,keyConfigured:kn,certConfigured:Vn,isUpdated:$n,error:ca,resetError:pa,visitedSteps:va,showSavedBadge:ma,label:Ea,className:ts,getFormData:Qa,onSubmit:Ia,saveSAMLSettings:$a,enableSAML:Ys,disableSAML:lr,resetSAMLSettings:ws})=>{const es=(0,W.of)(Vo),Aa=ht(Ct),Fs=(0,se.W6)(),Ls=(0,s.useRef)(null),[$s,ns]=(0,s.useState)(Un||$n);(0,s.useEffect)(()=>{(dl=>{(0,o.rR)("authentication_saml_step",{step:dl}),dl===Vs[Vs.length-1].id?jt(Vs.map(oh=>oh.id)):jt([dl])})(Ct)},[Ct,jt]),(0,s.useEffect)(()=>{ns(Un||$n)},[Un,$n]);const Tr=Wi=>{Wi.preventDefault();const dl=Ve(Aa.id);Ia(),Fs.push(dl)},br=()=>{let Wi={...k,keyCertValueType:Be,signRequests:lt,metadataValueType:Qe,keyConfigured:kn,certConfigured:Vn};if(Qa){const dl=Qa();Wi={...Wi,...dl}}return Wi},Fi=async Wi=>{const dl=br();Wi&&(dl.enabled=!0),$a(dl,ve),(0,o.rR)("authentication_saml_saved",{enabled:dl.enabled}),ns(!1),yn()},cl=()=>{(0,o.rR)("authentication_saml_enabled"),Ys(k)},Zr=()=>{(0,o.rR)("authentication_saml_disabled"),lr(k)},ur=()=>{yn(),(0,o.rR)("authentication_saml_abandoned")},wr=()=>{(0,o.rR)("authentication_saml_removed"),ws()},Uo=Wi=>!Vs.map(oh=>Ve(oh.id)).includes(Wi.pathname),xi=()=>{const Wi=Vs[Vs.length-1].id;Ct!==Wi&&Ls.current?.click()},wp=Xs(br());return s.createElement("form",{onSubmit:Tr,className:es.container},s.createElement(Kt,{enabled:k.enabled,isNewConfig:De(ve),onSave:()=>Fi(),onSaveAndEnable:()=>Fi(!0),onEnable:cl,onDisable:Zr,onRemove:wr}),s.createElement(me,{confirmRedirect:$s,onDiscard:ur,onLocationChange:Uo}),s.createElement("div",{className:es.inner},s.createElement(Pe,{steps:Vs,activeStep:Ct,visitedSteps:va,onStepChange:xi,getNextUrl:Ve,validationResults:wp}),s.createElement(Se,null),s.createElement(Oe,{error:ca,onReset:pa}),s.createElement("div",{className:(0,B.cx)(es.content,ts)},s.createElement(ne.n,{label:s.createElement("div",{className:es.header},Ea&&s.createElement(ee.s,null,Ea),s.createElement("div",null,ma&&s.createElement(Z.E,{text:"Saved",color:"green",icon:"check"})))},pn),s.createElement(St,{ref:Ls,activeStep:Ct}))))},Vo=k=>({container:(0,B.css)`
      display: flex;
      flex-direction: column;
      height: 100%;
      align-content: center;
    `,header:(0,B.css)`
      display: flex;
      justify-content: space-between;
    `,inner:(0,B.css)`
      display: flex;
      justify-content: flex-start;
      flex-direction: column;
      flex: 1 0 auto;
    `,content:(0,B.css)`
      padding-bottom: ${k.spacing(3)};
    `}),Co=qo(lo),zo=[{label:"Default",value:""},{label:"Unspecified",value:"urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified"},{label:"Email address",value:"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"},{label:"Persistent",value:"urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"},{label:"Transient",value:"urn:oasis:names:tc:SAML:2.0:nameid-format:transient"}];function So(k){return{samlSettings:k.samlConfig.samlSettings}}const si={settingsUpdated:Cn},Yo=(0,U.connect)(So,si),ri=({samlSettings:k,settingsUpdated:ve})=>{const Be=(0,W.of)(Ao),{assertionAttributeName:Qe,assertionAttributeLogin:lt,assertionAttributeEmail:Ct,assertionAttributeRole:jt,assertionAttributeGroups:pn,assertionAttributeOrg:yn,roleValuesNone:Un,roleValuesViewer:kn,roleValuesEditor:Vn,roleValuesAdmin:$n,roleValuesGrafanaAdmin:ca,orgMapping:pa,allowedOrganizations:va,nameIdFormat:ma,skipOrgRoleSync:Ea}=k,{handleSubmit:ts,control:Qa,register:Ia,getValues:$a,formState:{isDirty:Ys}}=(0,w.mN)({defaultValues:{assertionAttributeName:Qe,assertionAttributeLogin:lt,assertionAttributeEmail:Ct,assertionAttributeRole:jt,assertionAttributeGroups:pn,assertionAttributeOrg:yn,roleValuesNone:Un,roleValuesViewer:kn,roleValuesEditor:Vn,roleValuesAdmin:$n,roleValuesGrafanaAdmin:ca,orgMapping:pa,allowedOrganizations:va,nameIdFormat:ma||"",skipOrgRoleSync:Ea}}),lr=({...$s})=>{Ys&&ve({...k,...$s})},{orgRole:ws,isGrafanaAdmin:es}=r.contextSrv.user,Aa=es,Fs=ws==="Admin"||Aa,Ls=ws==="Editor"||Fs;return s.createElement(Co,{activeStep:K.AssertionMapping,onSubmit:ts(lr),confirmRedirect:Ys,getFormData:$a,className:Be.wrapper,label:"User mapping"},s.createElement("div",{className:Be.description},"Map SAML assertion attributes to the Grafana user attributes. Assertion attributes support template mappings. Team sync is available if groups attribute is configured."),s.createElement("div",{className:Be.mappingContainer},s.createElement("div",{className:Be.mappingSection},s.createElement("div",{className:Be.mappingHeader},"Assertion attributes mappings",s.createElement(V.m,{content:"Assertion attributes mapping in Grafana takes user information from a SAML response and uses it to create or update a user in its database. It reads attributes\u2014key/value pairs\u2014within the assertion, such as Name, Login handle, and email. Configurations allow for key selection modification.",placement:"top"},s.createElement(u.I,{name:"info-circle",className:Be.icon}))),s.createElement(w.xI,{name:"assertionAttributeName",control:Qa,render:({field:{ref:$s,...ns}})=>s.createElement(Y,{...ns,label:"Name attribute",id:"assertionAttributeName",placeholder:"displayName"})}),s.createElement(w.xI,{name:"assertionAttributeLogin",control:Qa,render:({field:{ref:$s,...ns}})=>s.createElement(Y,{...ns,label:"Login attribute",placeholder:"mail",id:"assertionAttributeLogin"})}),s.createElement(w.xI,{name:"assertionAttributeEmail",control:Qa,render:({field:{ref:$s,...ns}})=>s.createElement(Y,{...ns,label:"Email attribute",placeholder:"mail",id:"assertionAttributeEmail"})}),s.createElement(w.xI,{name:"assertionAttributeGroups",control:Qa,render:({field:{ref:$s,...ns}})=>s.createElement(Y,{...ns,label:"Groups attribute",id:"assertionAttributeGroups"})}),s.createElement(w.xI,{name:"assertionAttributeRole",control:Qa,render:({field:{ref:$s,...ns}})=>s.createElement(Y,{...ns,label:"Role attribute",id:"assertionAttributeRole"})}),Fs&&s.createElement(w.xI,{name:"assertionAttributeOrg",control:Qa,render:({field:{ref:$s,...ns}})=>s.createElement(Y,{...ns,label:"Org attribute",id:"assertionAttributeOrg"})})),s.createElement("div",{className:Be.mappingSection},Ls&&s.createElement(s.Fragment,null,s.createElement("div",{className:Be.mappingHeader},"Role mapping",s.createElement(V.m,{content:"Role mapping syncs user roles from your identity provider to Grafana by configuring role attributes for None, Viewer, Editor, Admin, and Grafana Admin roles. In case there is no match, the default role in Grafana is Viewer.",placement:"top"},s.createElement(u.I,{name:"info-circle",className:Be.icon}))),s.createElement(w.xI,{name:"roleValuesNone",control:Qa,render:({field:{ref:$s,...ns}})=>s.createElement(Y,{...ns,label:"None",width:60,id:"roleValuesNone"})}),s.createElement(w.xI,{name:"roleValuesViewer",control:Qa,render:({field:{ref:$s,...ns}})=>s.createElement(Y,{...ns,label:"Viewer",width:60,id:"roleValuesViewer"})}),s.createElement(w.xI,{name:"roleValuesEditor",control:Qa,render:({field:{ref:$s,...ns}})=>s.createElement(Y,{...ns,label:"Editor",width:60,id:"roleValuesEditor"})})),Fs&&s.createElement(w.xI,{name:"roleValuesAdmin",control:Qa,render:({field:{ref:$s,...ns}})=>s.createElement(Y,{...ns,label:"Admin",width:60,id:"roleValuesAdmin"})}),Aa&&s.createElement(w.xI,{name:"roleValuesGrafanaAdmin",control:Qa,render:({field:{ref:$s,...ns}})=>s.createElement(Y,{...ns,label:"Grafana Admin",width:60,id:"roleValuesGrafanaAdmin"})}),s.createElement(_.D,{label:"Skip organization role sync",description:"Prevent synchronizing for SAML users organization roles from your IdP."},s.createElement(H.d,{...Ia("skipOrgRoleSync"),defaultChecked:Ea,id:"skipOrgRoleSync"}))),Aa&&s.createElement("div",{className:Be.mappingSection},s.createElement("div",{className:Be.mappingHeader},"Org mapping",s.createElement(V.m,{content:"Organization mapping allows you to assign users to particular organization in Grafana depending on attribute value obtained from identity provider. Use the configuration to assign users from your organization to the Grafana organization.",placement:"top"},s.createElement(u.I,{name:"info-circle",className:Be.icon}))),s.createElement(w.xI,{name:"orgMapping",control:Qa,render:({field:{ref:$s,...ns}})=>s.createElement(Y,{...ns,label:"Org mapping",width:60,id:"orgMapping"})}))),s.createElement(_.D,{label:"Allowed organizations",description:"List of comma- or space-separated SAML organization names. User should be a member of at least one organization to log in."},s.createElement(G.p,{...Ia("allowedOrganizations"),id:"allowedOrganizations",width:60})),s.createElement(_.D,{label:"Name identifier format",description:"Name identifier formats control how the users at identity provider are mapped to users in Grafana"},s.createElement(w.xI,{name:"nameIdFormat",control:Qa,render:({field:{ref:$s,onChange:ns,...Tr}})=>s.createElement(h.l6,{...Tr,onChange:br=>{ns(br.value)},width:30,options:zo,"aria-label":"nameIdFormat"})})))},Ao=k=>({wrapper:(0,B.css)`
      width: 100%;
    `,description:(0,B.css)`
      color: ${k.colors.text.secondary};
      margin-bottom: ${k.spacing(2)};
      font-size: ${k.typography.bodySmall.fontSize};
      width: ${k.spacing(80)};
    `,mappingContainer:(0,B.css)`
      background: ${k.colors.background.secondary};
      padding: ${k.spacing(2)};
      margin-bottom: ${k.spacing(4)};
    `,mappingSection:(0,B.css)`
      margin-bottom: ${k.spacing(2)};
    `,mappingHeader:(0,B.css)`
      display: flex;
      margin-bottom: ${k.spacing(2)};
    `,assertionEditorRow:(0,B.css)`
      display: flex;
      margin-bottom: ${k.spacing(1)};
    `,icon:(0,B.css)`
      fill: ${k.colors.secondary.text};
      margin-top: ${k.spacing(.5)};
      margin-left: ${k.spacing(.5)};
    `}),so=Yo(ri);var ko=e(10534),eo=e(94354),No=e(21744),To=e(73546);function oi(k){return{samlSettings:k.samlConfig.samlSettings,metadataValueType:k.samlConfig.metadataValueType}}const oo={settingsUpdated:Cn,setMetadataValueType:Vt},zt=(0,U.connect)(oi,oo),rn=[{label:"URL for metadata",value:"url"},{label:"Base64-encoded content",value:"base64"},{label:"Path to file",value:"path"}],zn=({samlSettings:k,metadataValueType:ve,settingsUpdated:Be,setMetadataValueType:Qe})=>{const lt=(0,W.of)(Fn),{idpMetadataUrl:Ct,idpMetadataPath:jt,idpMetadata:pn,singleLogout:yn}=k,{handleSubmit:Un,control:kn,register:Vn,watch:$n,getValues:ca,setValue:pa,formState:{errors:va,isDirty:ma}}=(0,w.mN)({mode:"onBlur",defaultValues:{idpMetadataUrl:Ct,idpMetadataPath:jt,idpMetadata:pn,metadataValueType:ve||"url"}}),Ea=$n("metadataValueType"),ts=({metadataValueType:Ia,...$a})=>{ma&&(Be({...k,...$a}),Qe(Ia))},Qa=async Ia=>{if(Ia?.currentTarget?.files?.length){const Ys=await Ia.currentTarget.files[0].text(),lr=btoa(Ys);pa("idpMetadata",lr,{shouldDirty:!0})}};return s.createElement(Co,{activeStep:K.ConnectToIdP,onSubmit:Un(ts),confirmRedirect:ma,getFormData:ca,className:lt.wrapper,label:"Connect Grafana with Identity Provider"},s.createElement("div",{className:lt.externalBorder},s.createElement("div",{className:lt.doubleSideContainer},s.createElement("div",{className:lt.internalContainer},s.createElement("div",{className:lt.internalContainerHeader},s.createElement("div",{className:lt.stepNumber},"1"),s.createElement("h4",null,"Configure IdP using Grafana metadata")),s.createElement("div",{className:lt.internalContainerBody},s.createElement("div",{className:lt.description},"To configure your identity provider (IdP) you will need the Grafana metadata URL. All below endpoints must be reachable by your Identity Provider (IdP)."),s.createElement(_.D,{label:"Metadata URL",description:"SP metadata URL / SP Entity ID"},s.createElement("div",{className:lt.inputWithCopyToClipboard},s.createElement(G.p,{width:50,id:"spMetadata",value:Ue,disabled:!0}),s.createElement(ko.b,{className:lt.copyToClipboardButton,variant:"primary",size:"md",icon:"copy",getText:()=>Ue},"Copy"))),s.createElement(_.D,{label:"Assertion Consumer Service URL",description:"Assertion consumer service POST binding URL"},s.createElement("div",{className:lt.inputWithCopyToClipboard},s.createElement(G.p,{width:50,id:"spACS",value:Me,disabled:!0}),s.createElement(ko.b,{className:lt.copyToClipboardButton,variant:"primary",size:"md",icon:"copy",getText:()=>Me},"Copy"))),yn&&s.createElement(_.D,{label:"SLO URL",description:"Logout service redirect binding URL / Logout service POST binding URL"},s.createElement("div",{className:lt.inputWithCopyToClipboard},s.createElement(G.p,{width:50,id:"spSLO",value:$e,disabled:!0}),s.createElement(ko.b,{className:lt.copyToClipboardButton,variant:"primary",size:"md",icon:"copy",getText:()=>$e},"Copy"))))),s.createElement("div",{className:lt.internalContainer},s.createElement("div",{className:lt.internalContainerHeader},s.createElement("div",{className:lt.stepNumber},"2"),s.createElement("h4",null,"Finish configuring Grafana using IdP data")),s.createElement("div",{className:lt.internalContainerBody},s.createElement("div",{className:lt.description},"Visit your IdP's configuration panel, add new app and use metadata from step one to connect with Grafana. You will need to copy your IdP's metadata and provide it below. Test connection and copy assertion labels/values."),s.createElement(_.D,{label:"IdP's metadata ",description:"Must be the same as set-up or required by IdP."},s.createElement(w.xI,{name:"metadataValueType",control:kn,render:({field:{ref:Ia,...$a}})=>s.createElement(eo.z,{...$a,options:rn})})),Ea==="url"&&s.createElement(_.D,{label:"Metadata URL",description:"URL for IdP metadata",invalid:!!va.idpMetadataUrl,error:va.idpMetadataUrl?.message},s.createElement(G.p,{...Vn("idpMetadataUrl",{validate:Ia=>Ea==="url"&&!!Ia||"Required"}),id:"metadataUrl",width:60})),Ea==="base64"&&s.createElement(s.Fragment,null,s.createElement(_.D,{label:"Base64-encoded IdP metadata",invalid:!!va.idpMetadata,error:va.idpMetadata?.message},s.createElement(w.xI,{name:"idpMetadata",control:kn,rules:{validate:Ia=>Ea==="base64"&&!!Ia||"Required"},render:({field:{ref:Ia,...$a}})=>s.createElement(No.f,{...$a,id:"metadataBase64",width:60})})),s.createElement(To.e,{showFileName:!1,onFileUpload:Qa,className:lt.uploadButton})),Ea==="path"&&s.createElement(_.D,{label:"Path to IdP metadata file",invalid:!!va.idpMetadataPath,error:va.idpMetadataPath?.message},s.createElement(G.p,{...Vn("idpMetadataPath",{validate:Ia=>Ea==="path"&&!!Ia||"Required"}),id:"metadataPath",width:60})),s.createElement("div",{className:lt.description},"If you want to test the connection from your IdP's panel make sure to allow IdP initiated login and provide the relay state information.")))),s.createElement("div",{className:lt.internalContainerHeader},s.createElement("div",{className:lt.stepNumber},"3"),s.createElement("h4",null,"Configure assertions, group, group and org mappings in the next step."))))},Fn=k=>({wrapper:(0,B.css)`
      width: 100%;
    `,description:(0,B.css)`
      color: ${k.colors.text.secondary};
      margin-bottom: ${k.spacing(2)};
      font-size: ${k.typography.bodySmall.fontSize};
    `,externalBorder:(0,B.css)`
      border-radius: ${k.shape.borderRadius(1)};
      border: 1px solid ${k.colors.border.medium};
    `,doubleSideContainer:(0,B.css)`
      display: flex;
      flex-direction: row;
      justify-content: space-around;
    `,internalContainer:(0,B.css)`
      flex: 1 1 0;
      border-bottom: 1px solid ${k.colors.border.medium};
      &:first-child {
        border-right: 1px solid ${k.colors.border.medium};
      }
    `,internalContainerHeader:(0,B.css)`
      display: flex;
      justify-content: center;
      border-bottom: 1px solid ${k.colors.border.medium};
      padding: ${k.spacing(2)};
      text-align: center;
      h4 {
        margin-bottom: 0;
      }
    `,internalContainerBody:(0,B.css)`
      padding: ${k.spacing(2)};
    `,stepNumber:(0,B.css)`
      border: 1px solid ${k.colors.background.secondary};
      border-radius: ${k.shape.borderRadius(4)};
      background: ${k.colors.background.secondary};
      color: ${k.colors.text.secondary};
      width: ${k.spacing(3)};
      height: ${k.spacing(3)};
      margin-right: ${k.spacing(1)};
      font-weight: ${k.typography.fontWeightBold};
    `,copyToClipboardButton:(0,B.css)`
      border-top-left-radius: 0px;
      border-bottom-left-radius: 0px;
    `,inputWithCopyToClipboard:(0,B.css)`
      padding: 0;
      display: flex;
    `,uploadButton:(0,B.css)`
      margin-bottom: ${k.spacing(2)};
    `}),ta=zt(zn);var ua=e(67061);const ya=k=>{const{samlSettings:ve}=k.samlConfig;return{samlSettings:ve}},as={settingsUpdated:Cn},nr=(0,U.connect)(ya,as)(({samlSettings:k,settingsUpdated:ve})=>{const{allowSignUp:Be,name:Qe,autoLogin:lt,singleLogout:Ct,allowIdpInitiated:jt,relayState:pn,maxIssueDelay:yn,metadataValidDuration:Un}=k||{},{handleSubmit:kn,register:Vn,watch:$n,getValues:ca,formState:{isDirty:pa,errors:va}}=(0,w.mN)({mode:"onBlur",defaultValues:{allowSignUp:Be,name:Qe,autoLogin:lt,singleLogout:Ct,allowIdpInitiated:jt,relayState:pn,maxIssueDelay:yn,metadataValidDuration:Un}}),ma=$n("allowIdpInitiated"),Ea=Ia=>{pa&&ve({...k,...Ia})},ts=Ia=>!Ia||to(Ia)?!0:"Not a valid duration",Qa=Ia=>ma&&Ia?Ia.length>80?"Relay state needs to be 80 characters or less":!0:"Relay state is required";return s.createElement(Co,{activeStep:K.General,onSubmit:kn(Ea),confirmRedirect:pa,getFormData:ca,label:"General settings"},s.createElement(ua.B,null,s.createElement(_.D,{label:"Display name for this SAML 2.0 integration",description:"Helpful if you use more than one SSO IdP provider or protocol."},s.createElement(G.p,{...Vn("name"),id:"displayName",placeholder:"SAML"}))),s.createElement(_.D,{label:"Allow signup",description:"Whether to allow new Grafana user creation through SAML login. If not enabled, then only existing Grafana users can log in with SAML."},s.createElement(H.d,{...Vn("allowSignUp"),defaultChecked:Be,id:"allowSignup"})),s.createElement(_.D,{label:"Auto login",description:"Attempt to log in with SAML automatically, skipping the login screen."},s.createElement(H.d,{...Vn("autoLogin"),defaultChecked:lt,id:"autoLogin"})),s.createElement(_.D,{label:"Single logout",description:"Allows users to log out from IdP session and applications associated with the current IdP session established via SAML."},s.createElement(H.d,{...Vn("singleLogout"),defaultChecked:Ct,id:"singleLogout"})),s.createElement(_.D,{label:"Identity provider initiated login",description:"Allows users to log in into Grafana directly from identity provider."},s.createElement(H.d,{...Vn("allowIdpInitiated"),defaultChecked:jt,id:"allowIdpInitiated"})),ma&&s.createElement(_.D,{label:"Relay state",description:"Required. Should match relay state configured in IdP and trailing space is required.",required:ma,invalid:ma&&!!va.relayState,error:va.relayState?.message},s.createElement(G.p,{...Vn("relayState",{validate:Qa}),width:60,id:"relayState",defaultValue:pn})),s.createElement(_.D,{label:"Max issue delay",description:"Duration, since the IdP issued a response and Grafana is allowed to process it.",invalid:!!va.maxIssueDelay,error:va.maxIssueDelay?.message},s.createElement(G.p,{...Vn("maxIssueDelay",{validate:ts}),width:24,id:"max_issue_delay",defaultValue:yn,placeholder:"90s"})),s.createElement(_.D,{label:"Metadata valid duration",description:"Duration, for how long Grafana metadata is valid.",invalid:!!va.metadataValidDuration,error:va.metadataValidDuration?.message},s.createElement(G.p,{...Vn("metadataValidDuration",{validate:ts}),defaultValue:Un,width:24,id:"metadataValidDuration",placeholder:"48h"})))}),ps=({isConfigured:k,onReset:ve,...Be})=>{const Qe=(0,W.of)(Qs);return s.createElement("div",{className:Qe.inputWithReset},k&&s.createElement(G.p,{...Be,value:"configured",disabled:!0}),!k&&s.createElement(G.p,{...Be}),k&&s.createElement(ce.$n,{className:Qe.resetButton,variant:"primary",size:"md",onClick:ve},"Reset"))},Qs=k=>({resetButton:(0,B.css)`
      border-top-left-radius: 0px;
      border-bottom-left-radius: 0px;
    `,inputWithReset:(0,B.css)`
      padding: 0;
      display: flex;
    `}),Hr=({isConfigured:k,onReset:ve,onFileUpload:Be,...Qe})=>{const lt=(0,W.of)(_r);return s.createElement("div",{className:lt.inputWithReset},s.createElement("div",{className:lt.textAreaInput},k&&s.createElement(No.f,{...Qe,value:"configured",disabled:!0}),!k&&s.createElement(No.f,{...Qe})),k&&s.createElement(ce.$n,{className:lt.fileUploadButton,variant:"primary",size:"md",onClick:ve},"Reset"),!k&&s.createElement(To.e,{className:lt.fileUploadButton,showFileName:!1,onFileUpload:Be}))},_r=k=>({resetButton:(0,B.css)`
      border-top-left-radius: 0px;
      border-bottom-left-radius: 0px;
    `,fileUploadButton:(0,B.css)`
      margin-left: ${k.spacing(1)};
    `,inputWithReset:(0,B.css)`
      padding: 0;
      display: flex;
    `,textAreaInput:(0,B.css)`
      width: ${k.spacing(60)};
    `});function Rr(k){const{samlSettings:ve,storedSamlSettings:Be,signRequests:Qe,keyCertValueType:lt,keyConfigured:Ct,certConfigured:jt}=k.samlConfig;return{samlSettings:ve,storedSettings:Be,signRequests:Qe,keyCertValueType:lt,keyConfigured:Ct,certConfigured:jt}}const Eo={settingsUpdated:Cn,setSignRequests:Kn,setKeyCertValueType:Yn,setKeyConfigured:nt,setCertConfigured:yt},co=(0,U.connect)(Rr,Eo),Ur=[{label:"Base64-encoded content",value:"base64"},{label:"Path to file",value:"path"}],At=[{label:"RSA-SHA256 (default)",value:"rsa-sha256"},{label:"RSA-SHA512",value:"rsa-sha512"},{label:"RSA-SHA1",value:"rsa-sha1"}],cn=co(({samlSettings:k,storedSettings:ve,signRequests:Be,keyCertValueType:Qe,keyConfigured:lt,certConfigured:Ct,setKeyCertValueType:jt,setSignRequests:pn,setKeyConfigured:yn,setCertConfigured:Un,settingsUpdated:kn})=>{const{privateKey:Vn,privateKeyPath:$n,certificate:ca,certificatePath:pa,signatureAlgorithm:va}=k||{},{handleSubmit:ma,control:Ea,register:ts,watch:Qa,getValues:Ia,setValue:$a,formState:{errors:Ys,isDirty:lr}}=(0,w.mN)({mode:"onBlur",defaultValues:{privateKey:Vn||"",privateKeyPath:$n||"",certificate:ca||"",certificatePath:pa||"",signatureAlgorithm:va||"rsa-sha256",keyCertValueType:Qe,signRequests:Be,keyConfigured:!1,certConfigured:!1}}),ws=Qa("signRequests"),es=Qa("keyCertValueType"),Aa=Ia(),Fs=lt&&we("privateKey",Aa,ve),Ls=lt&&we("privateKeyPath",Aa,ve),$s=Ct&&we("certificate",Aa,ve),ns=Ct&&we("certificatePath",Aa,ve),Tr=ur=>{if(lr){const{signRequests:wr,keyCertValueType:Uo,certConfigured:xi,keyConfigured:wp,...Wi}=ur;kn({...k,...Wi}),pn(wr),jt(Uo)}},br=()=>{const{...ur}=Ia();return{...ur,keyConfigured:lt,certConfigured:Ct}},Fi=ur=>()=>{$a(ur,"",{shouldDirty:!0}),["privateKey","privateKeyPath"].includes(ur)?yn(!1):Un(!1)},cl=ur=>async wr=>{if(wr?.currentTarget?.files?.length){const xi=await wr.currentTarget.files[0].text(),wp=btoa(xi);$a(ur,wp,{shouldDirty:!0})}},Zr=(ur,wr,Uo)=>wr?!0:Qe==="base64"&&Uo==="privateKey"&&ur&&!Ar(ur)?"Not valid PEM key":Qe==="base64"&&Uo==="certificate"&&ur&&!no(ur)?"Not valid PEM certificate":!0;return s.createElement(Co,{activeStep:K.KeyCert,onSubmit:ma(Tr),confirmRedirect:lr,getFormData:br,label:"Key and certificate"},s.createElement(_.D,{label:"Signing and encryption key and certificate (required)",description:`Certificate and private key required to exchange information between the Grafana and the IdP.
          The private key needs to be issued in a PKCS#8 format. Certificate should be valid X.509 certificate.`},s.createElement(w.xI,{name:"keyCertValueType",control:Ea,render:({field:{ref:ur,...wr}})=>s.createElement(eo.z,{...wr,options:Ur})})),es==="base64"&&s.createElement(s.Fragment,null,s.createElement(_.D,{label:"Private key",htmlFor:"privateKey",description:"Base64-encoded private key",invalid:!!Ys.privateKey,error:Ys.privateKey?.message},s.createElement(w.xI,{name:"privateKey",control:Ea,rules:{validate:ur=>Zr(ur,lt,"privateKey")},render:({field:{ref:ur,...wr}})=>s.createElement(Hr,{...wr,id:"privateKey",required:!0,isConfigured:Fs,onReset:Fi("privateKey"),onFileUpload:cl("privateKey")})})),s.createElement(_.D,{label:"Certificate",htmlFor:"certificate",description:"Base64-encoded Grafana X.509 certificate",invalid:!!Ys.certificate,error:Ys.certificate?.message},s.createElement(w.xI,{name:"certificate",control:Ea,rules:{validate:ur=>Zr(ur,Ct,"certificate")},render:({field:{ref:ur,...wr}})=>s.createElement(Hr,{...wr,id:"certificate",required:!0,isConfigured:$s,onReset:Fi("certificate"),onFileUpload:cl("certificate")})}))),es==="path"&&s.createElement(s.Fragment,null,s.createElement(_.D,{label:"Private key",description:"Path to the Grafana private key",invalid:!!Ys.privateKey,error:Ys.privateKey?.message},s.createElement(w.xI,{name:"privateKeyPath",control:Ea,render:({field:{ref:ur,...wr}})=>s.createElement(ps,{...wr,width:60,id:"privateKeyPath",isConfigured:Ls,onReset:Fi("privateKeyPath")})})),s.createElement(_.D,{label:"Certificate",description:"Path to the Grafana X.509 certificate",invalid:!!Ys.certificate,error:Ys.certificate?.message},s.createElement(w.xI,{name:"certificatePath",control:Ea,render:({field:{ref:ur,...wr}})=>s.createElement(ps,{...wr,width:60,id:"certificatePath",isConfigured:ns,onReset:Fi("certificatePath")})}))),s.createElement(_.D,{label:"Sign requests",description:"Sign outgoing requests to IdP"},s.createElement(H.d,{...ts("signRequests"),id:"signRequests"})),ws&&s.createElement(_.D,{label:"Signature algorithm",description:"Signature algorithm used for signing requests to the IdP. Must be the same as set-up or required by IdP."},s.createElement(w.xI,{name:"signatureAlgorithm",control:Ea,render:({field:{ref:ur,...wr}})=>s.createElement(eo.z,{...wr,options:At})})))});var On=e(94753);function ha(k){const{samlSettings:ve,storedSamlSettings:Be,keyCertValueType:Qe,metadataValueType:lt,signRequests:Ct,keyConfigured:jt,certConfigured:pn}=k.samlConfig;return{samlSettings:ve,storedSamlSettings:Be,keyCertValueType:Qe,metadataValueType:lt,signRequests:Ct,keyConfigured:jt,certConfigured:pn}}const la={settingsUpdated:Cn,saveSAMLSettings:Xr},Js=(0,U.connect)(ha,la)(({samlSettings:k,storedSamlSettings:ve,keyCertValueType:Be,metadataValueType:Qe,signRequests:lt,keyConfigured:Ct,certConfigured:jt,settingsUpdated:pn,saveSAMLSettings:yn})=>{const{handleSubmit:Un,getValues:kn,formState:{isDirty:Vn}}=(0,w.mN)(),$n=({enabled:pa})=>{Vn&&pn({...k,enabled:pa})},ca=async()=>{let pa={...k,keyCertValueType:Be,keyConfigured:Ct,certConfigured:jt,signRequests:lt,metadataValueType:Qe,enabled:!0};yn(pa,ve),(0,o.rR)("authentication_saml_saved"),Lt()};return s.createElement(Co,{activeStep:K.SaveAndTest,onSubmit:Un($n),confirmRedirect:Vn,getFormData:kn,label:"Test and enable"},s.createElement(ua.B,{direction:"column",alignItems:"flex-start",gap:2},s.createElement(On.E,null,"If you are ready to apply your SAML configuration use the \u201CSave and enable\u201D button. You will be able to disable the configuration."),s.createElement(ce.$n,{variant:"primary",onClick:ca},"Save and enable")))});function Rs(){const k={id:"saml",type:"SAML",protocol:"SAML 2.0",displayName:"SAML",configPath:"saml/general"};(0,y.registerAuthProvider)(k,Er)}async function Er(){if(r.contextSrv.hasPermission(l.AccessControlAction.SettingsRead)){const[k,ve]=await wt(),Be=De(ve),Qe=Object.keys(k).length===0||Object.keys(ve).length===0;return Be?{configured:!1,enabled:!1,hide:Qe}:{configured:!0,enabled:!!k.enabled,name:k.name,hide:Qe}}return{configured:!1,enabled:!1}}const Vs=[{id:K.General,name:"General settings",component:nr},{id:K.KeyCert,name:"Key and certificate",component:cn},{id:K.ConnectToIdP,name:"Connect Grafana with Identity Provider",component:ta},{id:K.AssertionMapping,name:"User mapping",component:so},{id:K.SaveAndTest,name:"Test and enable",component:Js}];var hs=e(67608),Pr=e(31906);function ro(k,ve){const{isLoading:Be,samlSettings:Qe}=k.samlConfig,{step:lt}=ve.match.params;return{isLoading:Be,samlSettings:Qe,activeStep:lt}}const yo={loadSAMLSettings:Do},Kr=(0,U.connect)(ro,yo),io={text:"Setup SAML single sign on",subTitle:`This guided application will guide you through the configuration
  process of SAML. You will need to follow steps and visit your Identity
  Provider's application to connect it with Grafana (The Service provider).
  This guided application will help you keep track of your progress.`,icon:"shield",id:"SAML"},Qr=Kr(({isLoading:k,samlSettings:ve,activeStep:Be,loadSAMLSettings:Qe})=>{(0,s.useEffect)(()=>{Qe()},[Qe]);const lt=(0,s.useCallback)(()=>{const Ct=Vs.find(({id:jt})=>jt===Be)?.component;return Ct?s.createElement(Ct,null):null},[Be]);return s.createElement(hs.Y,{navId:"authentication",pageNav:io},s.createElement(hs.Y.Contents,null,k||(0,We.isEmpty)(ve)?s.createElement(Pr.a,null):lt()))});var uo=e(18681),Mo=e(76888),Jo=e(65463);class Lo extends Jo.x{static{this.type="page-banner-display"}}var $r=(k=>(k[k.info=0]="info",k[k.warning=1]="warning",k[k.error=2]="error",k))($r||{});function Ei(){const[k,ve]=(0,s.useState)(),Be=Ki(k?.severity),Qe=(0,W.of)(yn=>dt(yn,Be)),{chrome:lt}=(0,Mo.Il)(),Ct=lt.useState();(0,s.useEffect)(function(){const yn=r.lE.subscribe(Lo,Un=>{Ct.chromeless||ve(Un.payload)});return function(){yn.unsubscribe()}},[Ct.chromeless]);const jt=(0,s.useCallback)(()=>{ve(void 0),k?.onClose&&k.onClose()},[k]);if(!k)return null;const pn=k.body;return s.createElement("div",{className:Qe.banner},s.createElement("div",{className:Qe.icon},s.createElement(u.I,{size:"xl",name:Be.icon})),s.createElement("div",{className:Qe.content},s.createElement(pn,{severity:k.severity??$r.info})),k?.onClose&&s.createElement("div",{className:Qe.icon},s.createElement(_t.K,{size:"xl",name:"times",onClick:jt,className:Qe.close,"aria-label":"Close banner",tooltip:"Close"})))}function Ki(k){const ve=(0,W.$j)();return(0,s.useMemo)(()=>{switch(k){case $r.error:return{icon:"exclamation-circle",background:ve.colors.error.main,text:ve.colors.error.contrastText};case $r.warning:return{icon:"exclamation-triangle",background:ve.colors.warning.main,text:ve.colors.warning.contrastText};case $r.info:default:return{icon:"info-circle",background:ve.colors.info.main,text:ve.colors.info.contrastText}}},[ve,k])}function dt(k,ve){return{banner:(0,B.css)`
      flex-grow: 0;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      background-color: ${ve.background};
      border-radius: 2px;
      height: 52px;
    `,icon:(0,B.css)`
      padding: ${k.spacing(0,2)};
      color: ${ve.text};
      display: flex;
    `,content:(0,B.css)`
      flex-grow: 1;
      display: flex;
      align-items: center;
      color: ${ve.text};
    `,close:(0,B.css)`
      color: ${ve.text};
    `}}function Pn(){(0,uo.Pl)(Ei)}var gn=e(17422),Jn=e(74984),Zn=e(77454),_n=e(35538),Pa=e(34258),Ca=e(7521);const za=k=>{const{enableDataSourceCache:ve,dataSource:Be,pageId:Qe}=k,lt=r.contextSrv.hasPermissionInMetadata(N.DataSourcesCachingWrite,Be);return Be.jsonData?.disableGrafanaCache?s.createElement(Ca.A,{title:"Caching cannot be enabled for this data source.",buttonTitle:"Enable",buttonIcon:"database",proTip:"This data source's configuration does not permit caching to be enabled.",buttonDisabled:!0}):s.createElement(Ca.A,{title:"Caching is not enabled for this data source.",buttonTitle:"Enable",buttonIcon:"database",onClick:()=>{ve(Qe)},proTip:"Enabling caching can reduce the amount of redundant requests sent to the data source.",proTipLink:"https://grafana.com/docs/grafana/latest/enterprise/query-caching/",proTipLinkTitle:"Learn more",buttonDisabled:!lt})},xs=k=>{const{cleanCache:ve,dataSource:Be,pageId:Qe}=k,[lt,Ct]=(0,s.useState)(!1),jt=Un=>()=>{Ct(Un)},pn=()=>{ve(Qe),Ct(!1)},yn=r.contextSrv.hasPermissionInMetadata(N.DataSourcesCachingWrite,Be);return s.createElement("div",null,s.createElement(ce.$n,{variant:"destructive",onClick:jt(!0),disabled:!yn},"Clear cache"),s.createElement(nn.u,{isOpen:lt,title:"Clear cache",body:"Warning: This action impacts all cache-enabled data sources. If you are using Memcached, the system clears all data from the Memcached instance. Do you want to continue?",confirmText:"Clear cache",onConfirm:pn,onDismiss:jt(!1)}))};var ms=e(60029);const ls=k=>{const{disableDataSourceCache:ve,dataSource:Be,pageId:Qe}=k,lt=r.contextSrv.hasPermissionInMetadata(N.DataSourcesCachingWrite,Be);return s.createElement(ce.$n,{variant:"destructive",onClick:()=>ve(Qe),disabled:!lt},"Disable")},Ws=k=>{const{updateDataSourceCache:ve,pageId:Be,useDefaultTTL:Qe,setUseDefaultTTL:lt,defaultTTLMs:Ct,ttlQueriesMs:jt,setTtlQueriesMs:pn,ttlResourcesMs:yn,setTtlResourcesMs:Un,loading:kn,enabled:Vn,dataSource:$n,dataSourceID:ca,dataSourceUID:pa}=k,va=r.contextSrv.hasPermissionInMetadata(N.DataSourcesCachingWrite,$n);return s.createElement(ua.B,{direction:"column",alignItems:"flex-start"},s.createElement(_.D,{description:`Enable this to use the default TTL set in Grafana's configuration (${Ct} ms)`,label:"Use default TTL",disabled:kn||!va},s.createElement(H.d,{value:Qe,onChange:()=>{lt(!Qe)}})),s.createElement(_.D,{description:"The time-to-live for a query cache item in milliseconds. Example: 5000",label:"Query TTL",disabled:kn||Qe||!va},s.createElement(G.p,{type:"number",className:"max-width-10",placeholder:"1000",min:0,value:(Qe?Ct:jt)||0,onChange:ma=>{pn(ma.currentTarget.valueAsNumber)}})),s.createElement(_.D,{description:"The time-to-live for resources cache items in milliseconds. Example: 5000",label:s.createElement(ms.J,null,s.createElement("span",null,"Resource TTL"),s.createElement(V.m,{content:s.createElement("div",null,"Resources are dynamic values that Grafana data source plugins retrieve from data sources for use in the query editor. Examples are Splunk namespaces, Prometheus labels, and CloudWatch metric names. Since these values update less frequently, you might prefer a longer cache TTL for Resources than queries. See the ",s.createElement("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/query-caching/"},"docs")," ","for more info.")},s.createElement(u.I,{name:"question-circle"}))),disabled:kn||Qe||!va},s.createElement(G.p,{type:"number",className:"max-width-10",placeholder:"1000",min:0,value:(Qe?Ct:yn)||0,onChange:ma=>{Un(ma.currentTarget.valueAsNumber)}})),s.createElement(ua.B,{gap:2,alignItems:"flex-start",justifyContent:"flex-start"},s.createElement(ls,{...k}),s.createElement(ce.$n,{disabled:kn||!va,onClick:()=>ve(Be,{dataSourceID:ca,dataSourceUID:pa,enabled:Vn,defaultTTLMs:Ct,ttlQueriesMs:jt,ttlResourcesMs:yn,useDefaultTTL:Qe})},"Save")))};var is=e(27677),fs=(k=>(k.LoadDataSourceCache="LOAD_DATA_SOURCE_CACHE",k))(fs||{});const ys=k=>({type:"LOAD_DATA_SOURCE_CACHE",payload:k});function Ps(k){return async ve=>{const Be=await(0,is.AI)().post(`/api/datasources/${k}/cache/enable`,{});ve(ys(Be))}}function Lr(k){return async ve=>{const Be=await(0,is.AI)().post(`/api/datasources/${k}/cache/disable`,{});ve(ys(Be))}}function Gr(k,ve){return async Be=>{const Qe=await(0,is.AI)().post(`/api/datasources/${k}/cache`,ve);Be(ys(Qe))}}function ei(k){return async ve=>{const Be=await(0,is.AI)().get(`/api/datasources/${k}/cache`);ve(ys(Be))}}function Ji(k){return async ve=>{const Be=await(0,is.AI)().post(`/api/datasources/${k}/cache/clean`,{});ve(ys(Be))}}function ti(k,ve){return{...k.dataSourceCache,pageId:ve.uid,dataSource:k.dataSources.dataSource}}const di={disableDataSourceCache:Lr,updateDataSourceCache:Gr,enableDataSourceCache:Ps,loadDataSourceCache:ei,loadDataSource:Pa.ak,cleanCache:Ji,loadDataSourceMeta:Pa.xI},$i=(0,U.connect)(ti,di),Oi=k=>{const[ve,Be]=(0,s.useState)(k.enabled),[Qe,lt]=(0,s.useState)(!0),[Ct,jt]=(0,s.useState)(k.useDefaultTTL),[pn,yn]=(0,s.useState)(k.ttlQueriesMs),[Un,kn]=(0,s.useState)(k.ttlResourcesMs),{pageId:Vn,dataSource:$n,loadDataSource:ca,loadDataSourceCache:pa,loadDataSourceMeta:va,enableDataSourceCache:ma}=k;(0,s.useEffect)(()=>{Be($n.jsonData?.disableGrafanaCache?!1:k.enabled),jt(k.useDefaultTTL),yn(k.ttlQueriesMs),kn(k.ttlResourcesMs),lt(!1)},[k.useDefaultTTL,k.ttlQueriesMs,k.ttlResourcesMs,k.enabled,$n.jsonData?.disableGrafanaCache]),(0,s.useEffect)(()=>{ca(Vn).then(va),pa(Vn)},[pa,ca,va,Vn]);const Ea=r.contextSrv.hasPermissionInMetadata(N.DataSourcesCachingWrite,$n),ts=ve?Ws({...k,loading:Qe,useDefaultTTL:Ct,setUseDefaultTTL:jt,ttlQueriesMs:pn,setTtlQueriesMs:yn,ttlResourcesMs:Un,setTtlResourcesMs:kn}):(0,_n.z5)()?s.createElement(xo,{action:Ea?{text:"Enable caching",onClick:()=>{ma(Vn)}}:void 0}):za(k);return s.createElement(s.Fragment,null,(0,_n.z5)()&&s.createElement(Zn.Iz,{featureId:"query-caching",eventVariant:"trial",featureName:"query caching",text:"Enable query caching for free during your trial of Grafana Pro."}),s.createElement("div",{className:"page-action-bar"},ve&&!(0,_n.z5)()&&s.createElement("h3",{className:"page-sub-heading"},"Caching"),s.createElement("div",{className:"page-action-bar__spacer"}),s.createElement(ua.B,{gap:2,alignItems:"flex-end",justifyContent:"flex-end"},ve&&s.createElement(xs,{...k}))),ts)},xo=({action:k})=>{const ve=(0,W.$j)();return s.createElement(Zn.El,{action:k,listItems:["Load dashboards in less than a second from the cache, even when they include big queries and lots of users are looking at once","Save money and avoid rate limiting by reducing the number of API calls you make to data sources like Splunk, CloudWatch and Github","Author dashboards more smoothly by caching the data used to construct queries, like fields in ServiceNow or metrics available from Datadog"],image:`query-caching-${ve.isLight?"light":"dark"}.png`,featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/query-caching",featureName:"query caching",description:"With query caching, you can load dashboards faster and reduce costly queries to data sources by temporarily storing query results in memory, Redis, or Memcached."})},Vi=$i(Oi),Zo=()=>{const{uid:k}=(0,se.g)(),ve=(0,Jn.$m)("cache"),Be=(0,l.useSelector)(lt=>lt.navIndex),Qe=(0,gn.tc)(Be,`datasource-cache-${k}`,ve);return s.createElement(hs.Y,{navId:"datasources",pageNav:Qe.main},s.createElement(hs.Y.Contents,null,s.createElement(Vi,{uid:k})))};var yi=e(85464);const Ii=({uid:k})=>((0,yi.oU)(k),s.createElement(s.Fragment,null,s.createElement(Zn.Iz,{featureName:"query caching",featureId:"query-caching"}),s.createElement(xo,null))),bi=()=>{const{uid:k}=(0,se.g)(),ve=(0,yi.$m)("cache"),Be=(0,l.useSelector)(lt=>lt.navIndex),Qe=(0,gn.tc)(Be,`datasource-cache-${k}`,ve);return s.createElement(hs.Y,{navId:"datasources",pageNav:Qe.main},s.createElement(hs.Y.Contents,null,s.createElement(Ii,{uid:k})))},$l={enabled:!1,dataSourceID:0,dataSourceUID:"",ttlQueriesMs:0,ttlResourcesMs:0,defaultTTLMs:0,useDefaultTTL:!0},Ai={dataSourceCache:(k=$l,ve)=>{switch(ve.type){case fs.LoadDataSourceCache:return{...ve.payload}}return k}};var Ri=e(31152);const zl=()=>{const{uid:k}=(0,se.g)(),{navId:ve,pageNav:Be}=(0,Ri.n)("cache");return s.createElement(hs.Y,{navId:ve,pageNav:Be},s.createElement(hs.Y.Contents,null,s.createElement(Vi,{uid:k})))},ul=()=>{const{uid:k}=(0,se.g)(),{navId:ve,pageNav:Be}=(0,Ri.n)("cache");return s.createElement(hs.Y,{navId:ve,pageNav:Be},s.createElement(hs.Y.Contents,null,s.createElement(Ii,{uid:k})))};var Di=e(70713),Os=e(47232),_e=e(11261),et=e(39070),st=e(24308),pt=e(52622),Wt=e(91052),Xt=e(37166);const dn="YYYY-MM-DD",In=async(k,ve)=>await(0,Qt.AI)().get(`/api/usage/dashboard/${k}/views/recent?limit=${ve}`,{retry:0}),Hn=async(k,ve)=>await(0,Qt.AI)().get(`/api/usage/dashboard/${k}/views?limit=${ve}`),ra=k=>{const ve=[];for(let Be in k)ve.push(k[Be]);return ve.sort((Be,Qe)=>(0,Os.KQ)(Be.day,dn).valueOf()-(0,Os.KQ)(Qe.day,dn).valueOf()),ve},Ba=async(k,ve)=>{const Be=await(0,Qt.AI)().get(`/api/usage/dashboard/${k}/daily`,{days:ve});return ra(Be)},wa=async(k,ve)=>{const Be=await(0,Qt.AI)().get(`/api/usage/dashboard/${k}/public/daily`,{days:ve});return ra(Be)},Ua=async(k,ve,Be)=>{const Qe=await(0,Qt.AI)().get(`/api/usage/datasource/${k}/daily`,{from:ve,to:Be});return ra(Qe)},Za=async k=>await(0,Qt.AI)().get(`/api/usage/dashboard/${k}/info`);var cs=e(3911);const Ya=(0,cs.N)(k=>{const ve=k.colors.background.secondary;return{tabContent:(0,B.css)`
      height: 100%;
    `,tabsBar:(0,B.css)`
      padding-left: ${k.spacing(2)};
      margin: ${k.spacing(3,-1,-3,-3)};
    `,graphContainer:(0,B.css)`
      margin-top: ${k.spacing(2)};
      background-color: ${ve};
    `,panelContent:(0,B.css)`
      contain: none;
    `,userBoxesContainer:(0,B.css)`
      display: flex;
      margin-top: ${k.spacing(3)};

      > div + div {
        margin-left: ${k.spacing(2)};
      }
    `,userBox:(0,B.css)`
      padding: ${k.spacing(2)};
      flex: 1;
      text-align: center;
      background-color: ${ve};
      border-radius: 3px;

      button,
      img {
        margin: ${k.spacing(0,0,1,0)};
      }
    `,userName:(0,B.css)`
      font-weight: ${k.typography.fontWeightBold};
    `,tableContainer:(0,B.css)`
      margin-top: ${k.spacing(3)};
      background-color: ${ve};
      padding-bottom: ${k.spacing(1)};
      border-radius: 3px;

      [role='cell']:first-child > div {
        padding: 4px;
      }
      [role='columnheader']:first-child {
        height: 33px;
      }
      [role='row']:not(:only-child):nth-child(odd) {
        background-color: ${k.colors.background.primary};
      }
    `,tableHeader:(0,B.css)`
      padding: ${k.spacing(0,2,.5,2)};
      display: flex;
      justify-content: space-between;
      align-items: center;

      h4 {
        margin-bottom: 0px;
        padding: ${k.spacing(3,0)};
      }
    `,userIcon:(0,B.css)`
      margin: 0 0;
      width: 26px;
      height: 26px;
      line-height: 20px;

      & > * {
        width: 26px;
        height: 26px;
        line-height: 20px;
      }
    `}}),Ks=(k,ve)=>({dataSourceUid:ve.uid}),Ge={loadDataSource:Pa.ak,loadDataSourceMeta:Pa.xI},Re=(0,U.connect)(Ks,Ge);class qe extends s.PureComponent{constructor(ve){super(ve),this.state={dailySummaries:[],from:"",to:""}}async componentDidMount(){const{dataSourceUid:ve,loadDataSource:Be,loadDataSourceMeta:Qe}=this.props;if(Be(ve).then(Qe),(0,n.a)("analytics")){let lt=(0,Os.KQ)().subtract(30,"days").format(dn),Ct=(0,Os.KQ)().format(dn);const jt=await Ua(ve,lt,Ct);this.setState({dailySummaries:jt,from:lt,to:Ct})}}buildTimeRange(){const{from:ve,to:Be}=this.state,Qe=(0,Os.KQ)(ve),lt=(0,Os.KQ)(Be).add(24,"hours");return{from:Qe,to:lt,raw:{from:ve,to:Be}}}convertDailySummariesToDataFrame(ve,Be,Qe){const lt=[],Ct=[];return ve.forEach(jt=>{lt.push((0,Os.KQ)(jt.day,dn).valueOf());let pn=jt[Be];Be==="loadDuration"&&(pn=jt.queries?jt.loadDuration/(jt.queries*1e6):0),Ct.push(pn)}),{name:Be,fields:[{name:"Time",type:_e.PU.time,config:{},values:lt},{name:Be,type:Qe,config:{},values:Ct}],length:ve.length}}renderChart(ve,Be){const{dailySummaries:Qe}=this.state,{color:lt,fieldType:Ct,showBars:jt,timeRange:pn,title:yn,valueField:Un,width:kn}=ve,$n={series:[this.convertDailySummariesToDataFrame(Qe,Un,Ct)],state:et.Gu.Done,timeRange:pn},ca={legend:{showLegend:!1,displayMode:pt.lm.Hidden,calcs:[],placement:"bottom"},tooltip:{mode:pt.$N.Multi,sort:pt.xB.Descending}},pa={defaults:{color:{mode:"fixed",fixedColor:lt},custom:{showPoints:pt.yL.Never,drawStyle:jt?pt.GR.Bars:pt.GR.Line,fillOpacity:jt?50:0}},overrides:[]};return s.createElement("div",{className:Be.graphContainer},s.createElement(Wt.NR,{title:yn,width:kn,height:220,displayMode:"transparent",loadingState:$n.state},(va,ma)=>s.createElement(st.m,{title:yn,width:va,height:ma,pluginId:"timeseries",data:$n,fieldConfig:pa,options:ca})))}renderContent(){const{theme:ve}=this.props,Be=Ya(ve),{dailySummaries:Qe}=this.state,lt=this.buildTimeRange();return Qe?.length>0?s.createElement(Di.Ay,{disableHeight:!0},({width:Ct})=>{const jt=[{title:"Queries last 30 days",valueField:"queries",fieldType:_e.PU.number,width:Ct,timeRange:lt,color:"green",showBars:!0,showLines:!1},{title:"Errors last 30 days",valueField:"errors",fieldType:_e.PU.number,width:Ct,timeRange:lt,color:ve.colors.error.border,showBars:!0,showLines:!1},{title:"Average load duration last 30 days (ms)",valueField:"loadDuration",fieldType:_e.PU.number,width:Ct,timeRange:lt,color:ve.colors.primary.border,showBars:!0,showLines:!1}];return s.createElement("main",{style:{width:Ct}},jt.map(pn=>this.renderChart(pn,Be)))}):s.createElement("span",null,"No available data for this data source.")}render(){return(0,n.a)("analytics.writers")&&!(0,n.a)("analytics")?s.createElement(Xt.w,{title:"Feature not available with an expired license",url:"https://grafana.com/docs/grafana/latest/enterprise/license-expiration/",urlTitle:"Read more on license expiration"},s.createElement("span",null,"Data source insights are not available with an expired license. Data will continue to be collected but you need to update your license to see this page.")):s.createElement(s.Fragment,null,(0,_n.z5)()&&s.createElement(Zn.Iz,{featureId:"data-source-insights",eventVariant:"trial",featureName:"data source usage insights",text:"Enable data source usage insights for free during your trial of Grafana Pro."}),this.renderContent())}}const ut=Re((0,W.cV)(qe)),Ft=()=>{const{uid:k}=(0,se.g)(),{navId:ve,pageNav:Be}=(0,Ri.n)("insights");return s.createElement(hs.Y,{navId:ve,pageNav:Be},s.createElement(hs.Y.Contents,null,s.createElement(ut,{uid:k})))},on=({uid:k})=>{(0,yi.oU)(k);const ve=(0,W.$j)();return s.createElement(s.Fragment,null,s.createElement(Zn.Iz,{featureName:"data source usage insights",featureId:"data-source-insights"}),s.createElement(Zn.El,{listItems:["Demonstrate and improve the value of your observability service by keeping track of user engagement","Keep Grafana performant by identifying and fixing slow, error-prone data sources","Clean up your instance by finding and removing unused data sources","Review individual data source usage insights at a glance in the UI, sort search results by usage and errors, or dig into detailed usage logs"],image:`datasource-insights-${ve.isLight?"light":"dark"}.png`,featureName:"data source usage insights",description:"Usage Insights provide detailed information about data source usage, like the number of views, queries, and errors users have experienced. You can use this to improve users\u2019 experience and troubleshoot issues",featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/usage-insights/dashboard-datasource-insights"}))},sn=()=>{const{uid:k}=(0,se.g)(),{navId:ve,pageNav:Be}=(0,Ri.n)("insights");return s.createElement(hs.Y,{navId:ve,pageNav:Be},s.createElement(hs.Y.Contents,null,s.createElement(on,{uid:k})))};var Ln=e(52487),qn=e(91062),na=e(87455),Sa=e(25469),ka=e(98742),Da=e(8484);const ds=["loki"],Xa="X-Prom-Label-Policy";function qs(k){return!!k.basicAuth&&ds.includes(k.type)}function Cs(k){const Be=/\{([^{}]*)\}/.exec(k);return Be&&Be.length>1?Be[1].trim():""}function Ss(k){const Be=/\{{0,1}([^\{\}]*)\}{0,1}/.exec(k);return Be&&Be.length>1?`{ ${Be[1].trim()} }`:""}function fa(k){const Be=/\w+\:\{{0,1}([^\{\}]*)\}{0,1}/.exec(k);return Be&&Be.length>1?Be[1].trim():""}const Fa=k=>k?/^{*\s*(?:\s*\w+\s*(?:=|!=|=~|!~)\s*\"[^\"]+\"\s*,*)+\s*}*$/.test(k.trim()):!1,Na=k=>{const ve=[];return k.length&&k.forEach(Be=>{Number(Be.teamId)&&ve.push(Number(Be.teamId))}),ve},Is=(k,ve)=>{const Be=(0,Da.t)("access-control.permissions.lbac-warning-service-account","Warning: This service account has full data access with no Team LBAC rules applied."),Qe=(0,Da.t)("access-control.permissions.lbac-warning-team","Warning: This team has full data access with no Team LBAC rules applied.");return ve.map(lt=>{if(lt.builtInRole&&lt.permission!=="Admin"){const Ct=(0,Da.t)("access-control.permissions.lbac-warning-basic-role",`Warning: ${lt.builtInRole} may have full data access with no Team LBAC rules applied.`);lt.warning=Ct}else lt.isServiceAccount&&lt.userId?lt.warning=Be:lt.teamId&&!k.includes(lt.teamId)&&(lt.warning=Qe);return{...lt}})},pr=(k,ve)=>{const Be=t("access-control.permissions.lbac-warning-rule","Warning: This team might not have permission to the query the datasource.");return ve.map(Qe=>(Qe.teamId&&!k.includes(Number(Qe.teamId))&&(Qe.warning=Be),{...Qe}))},ir=({onSubmit:k,onClose:ve})=>{const Be=(0,W.of)(fo),{handleSubmit:Qe,register:lt,control:Ct,formState:{errors:jt}}=(0,w.mN)({});return s.createElement("div",{className:"cta-form","aria-label":"Permissions slider"},s.createElement(Sa.J,{onClick:ve}),s.createElement("h5",null,"Create LBAC Rule"),s.createElement("form",{name:"addTeamLBAC",onSubmit:Qe(k)},s.createElement(ua.B,{gap:1,direction:"row"},s.createElement(_.D,{label:"Team"},s.createElement(w.xI,{render:({field:{onChange:pn,ref:yn,...Un}})=>s.createElement(ka.e,{...Un,onSelected:kn=>pn(kn.value?.id)}),control:Ct,name:"team",rules:{required:{value:!0,message:"Required"}}})),s.createElement(_.D,{label:"Rule",invalid:!!jt.rule,error:jt?.rule?.message},s.createElement(G.p,{className:Be.input,type:"text",placeholder:'{label="foo", label2="bar"}',...lt("rule",{required:"Rule is required",validate:pn=>Fa(pn)||"Invalid LBAC rule syntax"}),width:30,invalid:!!jt.rule})),s.createElement(_.D,{label:""},s.createElement(ce.$n,{type:"submit"},s.createElement(Da.x6,{i18nKey:"access-control.add-permissions.save"},"Save"))))))},fo=k=>({input:(0,B.css)({"& input":{fontFamily:k.typography.fontFamilyMonospace}})});var ss=e(91605),wo=e(92762),ui=e(71713);const Sl=({isEditing:k,value:ve,disabled:Be,error:Qe,onChange:lt})=>{const[Ct,jt]=(0,s.useState)(Cs(ve)),pn=(0,W.$j)(),yn=(0,W.of)(_o);return(0,s.useEffect)(()=>{k||jt(Cs(ve))},[k,ve]),s.createElement("div",{className:yn.wrapper},k?s.createElement(s.Fragment,null,s.createElement(G.p,{className:yn.input,value:Ct,onChange:Un=>{const kn=Un.currentTarget.value;jt(kn),lt&&lt(`{ ${kn} }`)},invalid:!!Qe,suffix:Qe&&s.createElement(V.m,{content:Qe},s.createElement(u.I,{name:"exclamation-triangle"}))})):s.createElement("span",{style:{color:Be?pn.colors.text.disabled:"unset"}},s.createElement(wo.Z,{query:ve,language:{grammar:ui.Ay,name:"logql"}})))},_o=k=>({wrapper:(0,B.css)({padding:k.spacing(0,1)}),input:(0,B.css)({"& input":{fontFamily:k.typography.fontFamilyMonospace}})});var Or=e(12942),mi=e(90613);const ii=({team:k,disabled:ve,warning:Be})=>{const Qe=(0,W.of)(Li);return k?!k.name&&!k.avatarUrl?s.createElement("span",{className:Qe.notFound},"Team with id ",k.id," not found"):s.createElement("div",{className:Qe.wrapper},k.avatarUrl&&s.createElement(Or.e,{src:k.avatarUrl,alt:""}),s.createElement("span",{className:(0,B.cx)(Qe.label,{[Qe.disabled]:ve})},k.name),Be&&s.createElement(V.m,{content:s.createElement(mi.a,null,Be)},s.createElement(u.I,{name:"exclamation-triangle",className:Qe.warning}))):s.createElement(s.Fragment,null)},Li=k=>({wrapper:(0,B.css)({display:"flex",alignItems:"center"}),label:(0,B.css)({overflow:"hidden",marginLeft:k.spacing(2),marginRight:k.spacing(2)}),avatar:(0,B.css)({width:"24px",height:"24px"}),notFound:(0,B.css)({color:k.colors.text.secondary}),disabled:(0,B.css)({color:k.colors.text.disabled}),warning:(0,B.css)({color:k.colors.warning.main})}),_c=({teamRules:k,team:ve,disabled:Be,onChange:Qe,warning:lt})=>{const[Ct,jt]=(0,s.useState)({}),[pn,yn]=(0,s.useState)({}),[Un,kn]=(0,s.useState)(k),[Vn,$n]=(0,s.useState)({}),ca=(0,W.of)(ym);if((0,s.useEffect)(()=>{kn(k)},[k]),!k?.length)return null;const pa=(Ia,$a)=>{yn({...pn,[Ia]:$a?Un[Ia]:void 0}),jt({...Ct,[Ia]:$a})},va=(Ia,$a)=>{yn({...pn,[Ia]:$a})},ma=Ia=>{const $a=pn[Ia];if($a){if(!Fa($a)){$n({...Vn,[Ia]:"Invalid LBAC rule syntax"});return}const Ys=Un.map((lr,ws)=>ws===Ia&&$a?$a:lr);Qe(Ys),jt({...Ct,[Ia]:!1})}},Ea=Ia=>{const $a=Un.slice(0,Ia).concat(Un.slice(Ia+1));Qe($a)},ts=()=>{jt({...Ct,[Un.length]:!0}),kn(Un.concat(""))},Qa=Ia=>{pa(Ia,!1),Ia===Un.length-1&&!Un[Ia]&&kn(Un.slice(0,-1))};return s.createElement(s.Fragment,null,s.createElement("tr",{key:`${ve.id}-0`,role:"row"},s.createElement("td",null,s.createElement(ii,{team:ve,warning:lt})),s.createElement("td",null),s.createElement("td",null,s.createElement(Sl,{value:Un[0],isEditing:Ct[0],error:Vn[0],onChange:Ia=>va(0,Ia)})),s.createElement("td",null,Be?s.createElement("div",{className:ca.buttonsCell},s.createElement(ce.$n,{tooltip:"Provisioned rule",size:"sm",icon:"lock"})):s.createElement("div",{className:ca.buttonsCell},Un?.length===1&&!Ct[0]&&s.createElement("div",{className:ca.buttonRight},s.createElement(_t.K,{name:"plus-circle",tooltip:"Add new rule","aria-label":"add team rule",onClick:()=>ts()})),Ct[0]?s.createElement(s.Fragment,null,s.createElement("div",{className:ca.editButton},s.createElement(ce.$n,{size:"sm",variant:"primary",onClick:()=>ma(0)},"Save")),s.createElement("div",{className:ca.editButton},s.createElement(ce.$n,{size:"sm",variant:"secondary",onClick:()=>Qa(0)},"Cancel"))):s.createElement("div",{className:ca.editButton},s.createElement(_t.K,{name:"pen","aria-label":"edit team rule",onClick:()=>pa(0,!0)})),s.createElement("div",{className:ca.buttonRight},s.createElement(ss.e,{"aria-label":"Delete rule",size:"sm",onConfirm:()=>Ea(0)}))))),Un.length>1&&Un.slice(1).map((Ia,$a)=>s.createElement("tr",{key:`${ve.id}-${$a+1}`,role:"row"},s.createElement("td",null),s.createElement("td",{className:ca.ruleOr},"OR"),s.createElement("td",null,s.createElement(Sl,{value:Ia,isEditing:Ct[$a+1],error:Vn[$a+1],onChange:Ys=>va($a+1,Ys)})),s.createElement("td",null,Be?s.createElement("div",{className:ca.buttonsCell},s.createElement(ce.$n,{tooltip:"Provisioned rule",size:"sm",icon:"lock"})):s.createElement("div",{className:ca.buttonsCell},$a===Un?.length-2&&!Ct[$a+1]&&s.createElement("div",{className:ca.buttonRight},s.createElement(_t.K,{name:"plus-circle",tooltip:"Add new rule","aria-label":"add team rule",onClick:()=>ts()})),Ct[$a+1]?s.createElement(s.Fragment,null,s.createElement("div",{className:ca.editButton},s.createElement(ce.$n,{size:"sm",variant:"primary",onClick:()=>ma($a+1)},"Save")),s.createElement("div",{className:ca.editButton},s.createElement(ce.$n,{size:"sm",variant:"secondary",onClick:()=>Qa($a+1)},"Cancel"))):s.createElement("div",{className:ca.editButton},s.createElement(_t.K,{name:"pen","aria-label":"edit team rule",onClick:()=>pa($a+1,!0)})),s.createElement("div",{className:ca.buttonRight},s.createElement(ss.e,{"aria-label":"Delete rule",size:"sm",onConfirm:()=>Ea($a+1)})))))))},ym=k=>({editButton:(0,B.css)({display:"flex",alignItems:"center",marginLeft:k.spacing(2)}),buttonRight:(0,B.css)({display:"flex",alignItems:"center",marginLeft:k.spacing(2),marginRight:k.spacing(.5)}),buttonsCell:(0,B.css)({display:"flex",justifyContent:"end",alignItems:"center"}),ruleOr:(0,B.css)({color:k.colors.text.secondary})}),vc={teamLBACConfig:{rules:[]}},Tl=(0,un.Z0)({name:"teamLBAC",initialState:vc,reducers:{teamLBACLoaded:(k,ve)=>({...k,teamLBACConfig:ve.payload})}}),{teamLBACLoaded:Wd}=Tl.actions,Kd={teamLBAC:Tl.reducer};function $d(k){return async ve=>{const Be=await(0,Qt.AI)().get(`api/datasources/uid/${k}/lbac/teams`);ve(Wd(Be))}}function bm(k,ve){return async Be=>{await(0,Qt.AI)().put(`api/datasources/uid/${k}/lbac/teams`,{...ve}),Be($d(k))}}function Dm(k){return{teamLBACConfig:k.teamLBAC?.teamLBACConfig}}const ml={getTeamLBAC:$d,updateTeamLBACRules:bm},Pm=(0,U.connect)(Dm,ml),Vd=({teamLBACConfig:k,dataSourceConfig:ve,readOnly:Be,onTeamLBACUpdate:Qe,getTeamLBAC:lt,updateTeamLBACRules:Ct,items:jt})=>{const[pn,yn]=(0,s.useState)([]),[Un,kn]=(0,s.useState)(!1),[Vn,$n]=(0,s.useState)(new Set),[ca,pa]=(0,s.useState)(new Set),[va,ma]=(0,s.useState)(new Set),[Ea,ts]=(0,s.useState)(new Set),Qa=(0,s.useMemo)(()=>k?.rules||[],[k?.rules]),Ia=(0,W.of)(Cm);(0,s.useEffect)(()=>{lt(ve.uid)},[ve.uid,lt]),(0,s.useEffect)(()=>{(async()=>{const Fs=Qa.map(Tr=>Tr.teamId);if(!Fs?.length)return;const ns=((await(0,Qt.AI)().get("/api/teams/search",{teamId:Fs}))?.teams).map(Tr=>({id:Tr.id,value:Tr.id,teamId:Tr.id,name:Tr.name,avatarUrl:Tr.avatarUrl}));yn(ns)})()},[Qa]),(0,s.useEffect)(()=>{if(!jt?.length)return;const Aa=new Set(Qa.map(br=>br.teamId)),Fs=new Set(jt.map(br=>br.teamId)),Ls=new Set(jt.filter(br=>br.isServiceAccount).map(br=>br.id)),$s=new Set(jt.filter(br=>typeof br.builtInRole=="string"&&br.builtInRole.trim()!==""&&br.permission!=="Admin").map(br=>br.builtInRole)),ns=new Set([...Fs].filter(br=>br!==void 0&&!Aa.has(br.toString())).map(br=>br?.toString()||"")),Tr=new Set([...Aa].filter(br=>br&&!Fs.has(Number(br))));Tr&&ts(Tr),ns&&ma(ns),Ls&&pa(Ls),$s&&$n($s)},[jt,Qa]);const $a=(0,s.useCallback)(async Aa=>{await Ct(ve.uid,{rules:Aa}),await Qe()},[ve.uid,Qe,Ct]),Ys=async({team:Aa,rule:Fs})=>{let Ls=[];Qa.find(ns=>ns.teamId===Aa.toString())?Ls=Qa.map(ns=>ns.teamId===Aa.toString()?{...ns,rules:[...ns.rules,Ss(Fs)]}:{...ns}):Ls=Qa.concat({teamId:Aa.toString(),rules:[Ss(Fs)]}),await $a(Ls),kn(!1)},lr=async(Aa,Fs)=>{const Ls=[];Qa.forEach($s=>{if($s.teamId===Aa){if(!Fs?.length)return;Ls.push({...$s,rules:Fs})}else Ls.push({...$s})}),await $a(Ls)},ws=r.contextSrv.hasPermission(N.DataSourcesPermissionsWrite)&&!Be,es=Aa=>{if(Aa.userId)return Aa.userLogin;if(Aa.teamId)return Aa.team;if(Aa.builtInRole)return Aa.builtInRole};return s.createElement("div",null,Be&&s.createElement(na.r,null),s.createElement(ua.B,{direction:"column",gap:2},s.createElement(qn.A,{title:"Data Access",description:"Here you can configure access to specific data within the datasource. "},s.createElement(s.Fragment,null,(Ea.size>0||va.size>0||ca.size>0||Vn.size>0)&&Qa.length>0&&s.createElement("div",null,s.createElement(z.F,{title:"Permission warning",severity:"warning"},"Recommended setup is to allow team query permissions only.",s.createElement("ul",{className:Ia.warning},Ea.size>0&&s.createElement("div",null,"Teams cannot query the data source. Add query permissions for the following teams:"),[...Ea].map(Aa=>{const Fs=pn?.find(Ls=>Ls.id?.toString()===Aa)?.name;return s.createElement("li",{className:Ia.warningli,key:Aa},`Team ${Fs}`)}),(va.size>0||ca.size>0)&&s.createElement("div",null,"Teams can query all logs. Add Team LBAC rules for the following teams:"),[...va].map(Aa=>{const Fs=jt?.find(Ls=>Ls.teamId?.toString()===Aa);if(Fs)return s.createElement("li",{className:Ia.warningli,key:Aa},`Team ${es(Fs)}`)}),[...ca].map(Aa=>{const Fs=jt?.find(Ls=>Ls.id===Aa);if(Fs)return s.createElement("li",{className:Ia.warningli,key:Aa},`Service account ${es(Fs)}`)}),Vn.size>0&&s.createElement("div",null,"Role can access all logs with `query`` permission. Remove permission for the following:"),[...Vn].map(Aa=>s.createElement("li",{className:Ia.warningli,key:Aa},`Role ${Aa}`)))))),s.createElement(ua.B,{direction:"column",alignItems:"start",gap:2},s.createElement("h4",null,"Team Label-based access control"),s.createElement("ul",{className:Ia.warning},s.createElement(u.I,{name:"info"})," Note: Feature preview notes for Team LBAC rules will not be applied if the linked Cloud Access Policy has label selectors."),"Here you can configure label-based access control (LBAC) rules for teams, ",s.createElement("br",null),"allowing you to restrict which logs a team can query based on logql.",s.createElement("ul",{className:(0,B.css)({marginLeft:16})},s.createElement("li",null,"Ex: A rule ",s.createElement("code",null,'cluster="us-west-0", namespace=~"dev|prod"'))),ws&&s.createElement(ce.$n,{onClick:()=>kn(!0)},"Create LBAC rule"),Un&&s.createElement(ir,{onSubmit:Ys,onClose:()=>kn(!1)}))),!(0,We.isEmpty)(Qa)&&s.createElement("table",{role:"grid",className:"filter-table gf-form-group","aria-labelledby":"team_lbac_rules"},s.createElement("thead",null,s.createElement("tr",null,s.createElement("th",{style:{width:"30%"}},"Team"),s.createElement("th",{style:{width:"1%"}}),s.createElement("th",null,"Label selector"),s.createElement("th",{style:{width:"1%"}}))),s.createElement("tbody",null,Qa.map((Aa,Fs)=>{const Ls=Aa.rules,$s=Aa.teamId;let ns="";return Ea.has(Aa.teamId)&&(ns="Warning: This team may not have permission to query the datasource."),s.createElement(_c,{key:Fs,teamRules:Ls,disabled:!ws,team:pn.find(Tr=>Tr.id?.toString()===$s)||{id:Number($s),name:"",avatarUrl:""},onChange:Tr=>lr($s,Tr),warning:ns})})))))},Cm=k=>({wrapper:(0,B.css)({display:"flex",flexDirection:"column",overflowX:"auto",overflowY:"hidden",width:"100%"}),sectionHeader:(0,B.css)({marginBottom:k.spacing(2)}),warning:(0,B.css)({fontSize:k.typography.bodySmall.fontSize}),warningli:(0,B.css)({listStyle:"inside"})}),li=Pm(Vd);function Sm(k,ve){const{uid:Be}=ve;return{resourceId:Be,dataSourceConfig:k.dataSources.dataSource,teamLBACConfig:k.teamLBAC?.teamLBACConfig}}const zd={loadDataSource:Pa.ak,loadDataSourceMeta:Pa.xI,updateDataSource:Pa.jB},Hc=(0,U.connect)(Sm,zd)(({resourceId:k,dataSourceConfig:ve,teamLBACConfig:Be,loadDataSource:Qe,loadDataSourceMeta:lt,updateDataSource:Ct})=>{(0,s.useEffect)(()=>{Qe(k)},[k,Qe]);const jt=r.contextSrv.hasPermissionInMetadata(N.DataSourcesPermissionsWrite,ve);(0,s.useEffect)(()=>{Qe(k).then(lt)},[Qe,lt,k]);const pn=()=>{Qe(k)},yn=()=>ca=>{if(!Vn||!Be?.rules?.length)return ca;const pa=Na(Be?.rules);return Is(pa,ca)},{readOnly:Un,hasWriteRights:kn}=(0,yi.u1)(ve.uid),Vn=a.$.featureToggles.teamHttpHeaders&&qs(ve),$n=Un||!jt||!kn;return s.createElement(ua.B,{direction:"column",gap:2},(0,_n.z5)()&&s.createElement(Zn.Iz,{featureId:"data-source-permissions",eventVariant:"trial",featureName:"data source permissions",text:"Enable data source permissions for free during your trial of Grafana Pro."}),s.createElement(Ln.x,{resource:"datasources",resourceId:k,canSetPermissions:jt,getWarnings:Vn?yn():void 0,epilogue:Vn?ca=>s.createElement(li,{dataSourceConfig:ve,readOnly:$n,onTeamLBACUpdate:pn,items:ca}):void 0}))}),fl=()=>{const{uid:k}=(0,se.g)(),{navId:ve,pageNav:Be}=(0,Ri.n)("permissions");return s.createElement(hs.Y,{navId:ve,pageNav:Be},s.createElement(hs.Y.Contents,null,s.createElement(Hc,{uid:k})))},Mm=({uid:k})=>((0,yi.oU)(k),s.createElement(s.Fragment,null,s.createElement(Zn.Iz,{featureName:"data source permissions",featureId:"data-source-permissions"}),s.createElement(zi,null))),zi=({action:k})=>{const ve=(0,W.$j)();return s.createElement(Zn.El,{action:k,featureName:"data source permissions",description:"With data source permissions, you can protect sensitive data by limiting access to this data source to specific users, teams, and roles.",listItems:["Protect sensitive data, like security logs, production databases, and personally-identifiable information","Clean up users\u2019 experience by hiding data sources they don\u2019t need to use","Share Grafana access more freely, knowing that users will not unwittingly see sensitive data"],image:`ds-permissions-${ve.isLight?"light":"dark"}.png`,featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/datasource_permissions"})},_d=Mm,xm=()=>{const{uid:k}=(0,se.g)(),{navId:ve,pageNav:Be}=(0,Ri.n)("permissions");return s.createElement(hs.Y,{navId:ve,pageNav:Be},s.createElement(hs.Y.Contents,null,s.createElement(_d,{uid:k})))};var Pi=e(16233),Fo=e(33390);const kl=({title:k,subTitle:ve,severity:Be,onButtonClick:Qe,buttonText:lt})=>{const Ct=(0,W.IS)(Rm);return s.createElement("div",{className:Ct.container},s.createElement("div",{className:"page-container"},s.createElement(z.F,{title:k,severity:Be,buttonContent:lt,onRemove:Qe},ve)))},Ec=({isLicensingReader:k,children:ve})=>k?s.createElement("a",{href:"/admin/licensing"},ve):s.createElement("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/license-expiration/",target:"_blank",rel:"noreferrer noopener"},ve),Gc=({isLicensingReader:k})=>s.createElement(kl,{title:"Your Grafana Enterprise license has expired",subTitle:s.createElement(s.Fragment,null,s.createElement(Ec,{isLicensingReader:k},"Some features")," have been disabled."),severity:"error"}),Om=({isLicensingReader:k})=>s.createElement(kl,{title:"Your Grafana Enterprise license is invalid",subTitle:s.createElement(s.Fragment,null,s.createElement(Ec,{isLicensingReader:k},"Some features")," have been disabled."),severity:"error"}),yc=({days:k,onCloseWarning:ve,isLicensingReader:Be})=>s.createElement(kl,{onButtonClick:ve,title:"Your Grafana Enterprise license will expire soon",subTitle:s.createElement(s.Fragment,null,k," days remaining, after which"," ",s.createElement(Ec,{isLicensingReader:Be},"Enterprise features will be disabled.")),severity:"info",buttonText:"Dismiss"}),Im=({days:k,onCloseWarning:ve,isLicensingReader:Be})=>s.createElement(kl,{onButtonClick:ve,title:"Your Grafana Enterprise token needs to be renewed",subTitle:s.createElement(s.Fragment,null,"Your license token has ",k," days remaining, after which"," ",s.createElement(Ec,{isLicensingReader:Be},"Enterprise features will be disabled.")),severity:"info",buttonText:"Dismiss"}),Am=({activeUsers:k,maxUsers:ve,slug:Be,onRefreshWarning:Qe})=>s.createElement(kl,{onButtonClick:Qe,title:"You have exceeded the included number of active users",subTitle:s.createElement(s.Fragment,null,"Your Grafana Enterprise license includes ",ve," active users; you currently have ",k," active users. Please"," ",Be?s.createElement("a",{href:"https://grafana.com/orgs/"+Be+"/licenses",target:"_blank",rel:"noreferrer noopener"},"upgrade your license."):"upgrade your license."),severity:"error",buttonText:"Refresh"}),Rm=k=>({container:(0,B.css)`
      position: absolute;
      bottom: 0;
      width: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      z-index: 3;
    `}),Hd=80,Gd=100,Lm=0,jc=1,Zg=2,Xg=3,Qc=4,jd=5,qg=6,Bm=5,Qd=3600,Yd="grafana.licence.warning.dismissUntil",Yc="users",Ml="AWS/Marketplace",Jd=async()=>(0,is.AI)().get("/api/licensing/token"),Zd=async k=>(0,is.AI)().post("/api/licensing/token",{token:k}),Xd=async()=>(0,is.AI)().post("/api/licensing/token/renew",{}),Jc=async()=>(0,is.AI)().get("/api/licensing/refresh-stats");function qd(){(0,uo.J3)(Um)}function Um(){const[k,ve]=(0,s.useState)(!1),[Be,Qe]=(0,s.useState)(a.$.licensing),lt=Fo.A.get(Yd),Ct=lt&&lt>(0,Os.KQ)().valueOf(),jt=Pi.TP.hasPermission(N.LicensingRead),pn=Pi.TP.hasPermission(N.LicensingRead),yn=jt&&wm()&&!Ct,Un=jt&&tu()&&!Ct,kn=au();let Vn=!1,$n=0,ca=0;if(Be.limitBy===Yc){const ma=nu(Be.includedUsers,Be.activeUsers);Vn=kn&&ma&&(jt||pn),$n=Be.activeUsers,ca=Be.includedUsers}if(ru()||Fm())return null;const pa=()=>{const ma=(0,Os.KQ)().add(Bm,"d").valueOf();Fo.A.set(Yd,ma),ve(!0)},va=async()=>{const ma=await Jc().catch(Ea=>null);if(ma){const Ea={...Be,activeUsers:ma.active_users};a.$.licensing=Ea,Qe(Ea)}};if(k)return null;if(Nm())return s.createElement(Om,{isLicensingReader:pn});if(eu())return s.createElement(Gc,{isLicensingReader:pn});if(Vn)return s.createElement(Am,{activeUsers:$n,maxUsers:ca,slug:Be.slug,onRefreshWarning:jt?va:void 0});if(yn){const ma=Ho();return setTimeout(pa,1e3*Qd),s.createElement(yc,{days:ma,onCloseWarning:pa,isLicensingReader:pn})}else if(Un){const ma=bc();return setTimeout(pa,1e3*Qd),s.createElement(Im,{days:ma,onCloseWarning:pa,isLicensingReader:pn})}return null}function Nm(){const{expiry:k,hasLicense:ve}=a.$.licenseInfo;return ve&&!k}function wm(){const{licenseExpiry:k,licenseExpiryWarnDays:ve=30}=a.$.licensing;return k>0&&(0,Os.KQ)(k*1e3)<(0,Os.KQ)().add(ve,"d")}function Ho(){const{licenseExpiry:k}=a.$.licensing;return Math.ceil((k-(0,Os.KQ)().unix())/3600/24)}function eu(){const{licenseExpiry:k}=a.$.licensing;return k>0&&(0,Os.KQ)(k*1e3)<(0,Os.KQ)()}function tu(){const{tokenExpiry:k,tokenExpiryWarnDays:ve=3}=a.$.licensing;return k>0&&(0,Os.KQ)(k*1e3)<(0,Os.KQ)().add(ve,"d")}function bc(){const{tokenExpiry:k}=a.$.licensing;return Math.ceil((k-(0,Os.KQ)().unix())/3600/24)}function nu(k,ve){return k===void 0||ve===void 0?!1:k!==-1&&ve>k}function au(){return!a.$.licensing.usageBilling}function su(){const k=/\/d-solo\//,ve=window.location.pathname;return k.test(ve)}function ru(){return su()}function Fm(){const k=/\/admin\/licensing$/,ve=window.location.pathname;return k.test(ve)}var Wm=e(51372),Zi=e(72724),Km=e(55356);const ou=({orgSlug:k,licenseId:ve})=>{let Be="https://grafana.com/contact";return k&&ve&&(Be=`https://grafana.com/orgs/${k}/tickets?support=licensing&licenseId=${ve}`),s.createElement(ce.z9,{href:Be,target:"_blank",rel:"noopener noreferrer"},"Contact customer support")};var iu=e(81507);const Dc=({title:k,children:ve,footer:Be,state:Qe,status:lt,className:Ct})=>{const jt=(0,W.$j)(),pn=$m(jt,Qe);return s.createElement(iu.Q,{className:(0,B.cx)(pn.container,Ct),disableHover:!0},s.createElement("div",{className:pn.inner},(k||lt)&&s.createElement("div",{className:pn.row},k&&s.createElement("h3",{className:pn.title},k),lt&&s.createElement(Vm,{state:Qe,status:lt})),s.createElement("div",{className:pn.content},ve),Be&&s.createElement("div",{className:pn.footer},Be)))},$m=(0,cs.N)((k,ve)=>({container:(0,B.css)`
      padding: ${k.spacing(2)};
      margin-bottom: 0;
      ${ve&&`border: 1px solid ${k.colors[ve].border}`};
    `,inner:(0,B.css)`
      display: flex;
      flex-direction: column;
      width: 100%;
    `,title:(0,B.css)`
      font-size: ${k.typography.h3.fontSize};
      color: ${k.colors.text.secondary};
      margin-bottom: 0;
    `,row:(0,B.css)`
      display: flex;
      justify-content: space-between;
      width: 100%;
      margin-bottom: ${k.spacing(2)};
      align-items: center;
    `,content:(0,B.css)`
      display: flex;
      flex-direction: column;
      flex: 1 0 auto;
      width: 100%;
    `,footer:(0,B.css)`
      display: flex;
      flex-direction: column;
      align-items: self-start;
      margin-top: ${k.spacing(2)};
    `})),Vm=({state:k,status:ve})=>{const Be=new Map([["warning","bell"],["error","exclamation-triangle"]]),Qe=(0,W.$j)(),lt=xl(Qe,k);return k&&Be.has(k)?s.createElement("div",{role:"alert",className:lt.container},s.createElement(u.I,{name:Be.get(k)}),ve):null},xl=(k,ve)=>({container:(0,B.css)`
      background-color: ${k.colors.background.primary};
      color: ${ve&&k.colors[ve].text};
      padding: ${k.spacing(.5)} ${k.spacing(1)};

      svg {
        margin-right: ${k.spacing(1)};
      }
    `}),zm=({state:k,title:ve,orgSlug:Be,licenseId:Qe})=>{const lt=(0,W.of)(Go);return k?s.createElement(z.F,{title:ve,severity:k,className:lt.container},s.createElement(ou,{orgSlug:Be,licenseId:Qe})):null},Go=k=>({container:(0,B.css)`
      background: ${k.colors.secondary.main};
      margin-bottom: ${k.spacing(3)};
    `}),gl=({content:k,state:ve})=>{const Be=(0,W.$j)(),Qe=km(Be,ve);return s.createElement(s.Fragment,null,k.map(lt=>{if(!lt)return null;const Ct={marginLeft:`${lt.indentLevel||0}em`};return s.createElement("div",{key:lt.name,className:Qe.row},s.createElement("span",{style:Ct},lt.name,lt.tooltip&&s.createElement(V.m,{placement:"top",content:lt.tooltip,theme:"info"},s.createElement(u.I,{name:"info-circle",size:"sm"}))),s.createElement("span",{className:lt.highlight?Qe.highlight:""},lt.value))}))},km=(k,ve)=>({row:(0,B.css)`
      display: flex;
      justify-content: space-between;
      width: 100%;
      margin-bottom: ${k.spacing(2)};
      align-items: center;
      svg {
        margin-left: ${k.spacing(.5)};
        cursor: pointer;
      }
    `,highlight:(0,B.css)`
      background-color: ${k.colors.background.primary};
      color: ${ve&&k.colors[ve].text};
      padding: ${k.spacing(.5)} ${k.spacing(1)};
      margin-right: -${k.spacing(1)};

      svg {
        margin-right: ${k.spacing(1)};
      }
    `}),Zc=({isUploading:k,title:ve,onFileUpload:Be,isDisabled:Qe,licensedUrl:lt})=>{const Ct=_m();return s.createElement(s.Fragment,null,ve&&s.createElement("h2",{className:Ct.title},ve),k?s.createElement(ce.$n,{disabled:!0},"Uploading\u2026"):Qe?s.createElement(ce.$n,{disabled:!0},"Upload a new token"):s.createElement(To.e,{onFileUpload:Be,accept:".jwt"},"Upload a new token"),lt&&s.createElement("p",{className:Ct.instanceUrl},"Instance URL: ",s.createElement("code",null,lt)))},_m=(0,cs.N)(()=>({title:(0,B.css)`
      margin-top: 30px;
      margin-bottom: 20px;
    `,instanceUrl:(0,B.css)`
      margin-top: 10px;
    `})),Hm=(k,ve)=>(ve?`${ve} of `:"")+(k>0?k:"unlimited"),Gm=k=>(0,Os.KQ)(k.exp*1e3)<(0,Os.KQ)(),lu=k=>(0,Os.KQ)(k.exp*1e3)<(0,Os.KQ)().add(a.$.licensing.tokenExpiryWarnDays,"d"),cu=k=>Math.ceil((k.exp-(0,Os.KQ)().unix())/3600/24),Ol=k=>k?Gm(k)?{state:"error",status:"Expired",title:"Token expired",message:"Contact support to renew your token, or visit the Cloud portal to learn more."}:lu(k)?{state:"warning",status:` Expiring in ${cu(k)} day(s)`,title:"Token expires soon",message:`Your token expires in ${cu(k)} day(s). Contact support to renew your token.`}:{state:"",status:"",title:"",message:""}:{state:"",status:"",title:"",message:""},Xc=k=>k.trial_exp&&(0,Os.KQ)(k.trial_exp*1e3)<(0,Os.KQ)(),du=k=>k.trial_exp?Math.ceil((k.trial_exp-(0,Os.KQ)().unix())/3600/24):0,Xi=(k,ve)=>{const{active_users:Be=0,active_anonymous_devices:Qe=0}=k||{};return Be+Math.floor(Qe/(ve?.anonymousRatio||1))},qi=k=>!k||!k.trial||!k.trial_exp?{state:"",status:"",title:"",message:""}:Xc(k)?{state:"error",status:"Expired",title:"Trial expired",message:"Your trial period has expired, please contact sales to purchase a license."}:{state:"info",status:` Trial expiring in ${du(k)} day(s)`,title:"Trial active",message:`Your trial expires in ${du(k)} day(s), please contact sales to purchase a license.`},uu=(k,ve=0)=>100*ve/k,Il=(k,ve)=>{let Be="",Qe="",lt="",Ct="";if(!k)return{state:Be,status:Qe,title:lt,message:Ct};if(k.limit_by===Yc){const jt=Xi(ve,k),pn=k.included_users;let yn=0;typeof jt=="number"&&(yn=uu(pn,jt)),yn>Gd?(Be="error",Qe="Quota exceeded: active users",lt="User limit exceeded",Ct=`There are more than ${pn} active users using Grafana.`,Ct+=" Contact support to increase the quotas."):yn>=Hd&&(Be="warning",yn>=Gd?(Qe="Limit reached",lt="User utilization limit reached",Ct=`You are at your limit of ${pn} active users.`):(Qe="Reaching limit",lt="User utilization reaching limit",Ct=`There are ${jt} active users.`,Ct+=` You are approaching your limit of ${pn} active users.`),Qe+=": active users",Ct+=" Contact support to increase the quotas.")}return{state:Be,status:Qe,title:lt,message:Ct}},mu=({token:k,stats:ve,tokenRenewed:Be,tokenUpdated:Qe,isLoading:lt,licensedUrl:Ct})=>{const[jt,pn]=(0,s.useState)(!1),[yn,Un]=(0,s.useState)(!1),kn=Ol(k).state,Vn=Il(k,ve).state,$n=Pi.TP.hasPermission(N.LicensingWrite),ca=(0,W.of)(jm),pa=Xi(ve,k),va=k?.anonymousRatio||1,ma=Qa=>{const Ia=Qa.currentTarget?.files?.[0];if(Ia){Ne.Ny.partial({tokenUpdated:null,tokenRenewed:null});const $a=new FileReader,Ys=()=>async lr=>{pn(!0);try{await Zd(lr.target.result),Ne.Ny.partial({tokenUpdated:!0}),setTimeout(()=>{location.reload()},1e3)}catch(ws){throw pn(!1),ws}};$a.onload=Ys(),$a.readAsText(Ia)}},Ea=async()=>{Ne.Ny.partial({tokenUpdated:null,tokenRenewed:null}),Un(!0);try{await Xd(),Ne.Ny.partial({tokenRenewed:!0}),setTimeout(()=>{location.reload()},1e3)}catch(Qa){throw Un(!1),Qa}};if(!Pi.TP.hasPermission(N.LicensingRead))return null;if(lt)return s.createElement(Pr.a,{text:"Loading licensing info..."});let ts="You are running Grafana Enterprise without a license. The Enterprise features are disabled.";return k&&![jc,jd].includes(k.status)&&(ts="There is a problem with your Enterprise license token. The Enterprise features are disabled."),!k||![jc,jd].includes(k.status)?s.createElement(s.Fragment,null,s.createElement(Km.UpgradeInfo,{editionNotice:ts}),s.createElement("div",{className:ca.uploadWrapper},s.createElement(Zc,{title:"Have a license?",onFileUpload:ma,isUploading:jt,isDisabled:!$n,licensedUrl:Ct}))):s.createElement("div",null,s.createElement("h2",{className:ca.title},"License details"),s.createElement(qc,{...Il(k,ve),orgSlug:k.slug,licenseId:k.lid}),s.createElement(qc,{...Ol(k),orgSlug:k.slug,licenseId:k.lid}),s.createElement(qc,{...qi(k),orgSlug:k.slug,licenseId:k.lid}),Qe&&s.createElement(z.F,{title:"License token uploaded. Restart Grafana for the changes to take effect.",severity:"success",onRemove:()=>Ne.Ny.partial({tokenUpdated:null})}),Be&&s.createElement(z.F,{title:"License token renewed.",severity:"success",onRemove:()=>Ne.Ny.partial({tokenRenewed:null})}),s.createElement("div",{className:ca.row},s.createElement(Dc,{title:"License",className:ca.licenseCard,footer:s.createElement(ce.z9,{variant:"secondary",href:k.details_url||`${k.iss}/licenses/${k.lid}`,"aria-label":"View details about your license in Grafana Cloud",target:"_blank",rel:"noopener noreferrer"},"License details")},s.createElement(gl,{content:[{name:k.prod?.length<=1?"Product":"Products",value:k.prod?.length<=1?k.prod[0]||"None":s.createElement("ul",null,k.prod?.map(Qa=>s.createElement("li",{key:Qa},Qa)))},k.iss===Ml&&k.account?{name:"AWS Account",value:k.account}:{name:"Company",value:k.company},{name:"License ID",value:k.lid},k.iss===Ml?null:{name:"URL",value:k.sub,tooltip:"License URL is the root URL of your Grafana instance. The license will not work on an instance of Grafana with a different root URL."},{name:"Purchase date",value:(0,Zi.LE)(k.nbf*1e3)},k.iss===Ml?null:{name:"License expires",value:(0,Zi.LE)(k.lexp*1e3),highlight:!!Ol(k)?.state,tooltip:"The license expiration date is the date when the current license is no longer active. As the license expiration date approaches, Grafana Enterprise displays a banner."},k.iss===Ml?null:{name:"Usage billing",value:k.usage_billing?"On":"Off",tooltip:"You can request Grafana Labs to turn on usage billing to allow an unlimited number of active users. When usage billing is enabled, Grafana does not enforce active user limits or display warning banners. Instead, you are charged for active users above the limit, according to your customer contract."}]})),s.createElement(Dc,{...Ol(k),title:"Token",footer:s.createElement("div",{className:ca.row},k.iss!==Ml&&s.createElement(Zc,{onFileUpload:ma,isUploading:jt,isDisabled:!$n}),yn?s.createElement("span",null," (Renewing...)"):s.createElement(ce.$n,{variant:"secondary",onClick:Ea,disabled:!$n},"Renew token"))},s.createElement(s.Fragment,null,kn&&s.createElement(zm,{title:"Contact support to renew your token, or visit the Cloud portal to learn more.",state:kn,orgSlug:k.slug,licenseId:k.lid}),s.createElement("div",{className:ca.message},s.createElement(u.I,{name:"document-info"}),"Read about"," ",s.createElement("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/license/license-expiration/",target:"_blank",rel:"noreferrer noopener"},"license expiration")," ","and"," ",s.createElement("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/license/activate-license/",target:"_blank",rel:"noreferrer noopener"},"license activation"),"."),s.createElement(gl,{content:[{name:"Token ID",value:k.jti},{name:"Token issued",value:(0,Zi.LE)(k.iat*1e3)},{name:"Token expires",value:(0,Zi.LE)(k.exp*1e3),highlight:!!Ol(k)?.state,tooltip:"Grafana automatically updates the token before it expires. If your token is not updating, contact support."}],state:kn}))),s.createElement(Dc,{...Il(k,ve),title:"Utilization",footer:s.createElement("small",{className:ca.footerText},"Utilization of licenced users is determined based on signed-in users' activity in the past 30 days.")},s.createElement(s.Fragment,null,s.createElement("div",{className:ca.message},s.createElement(u.I,{name:"document-info"}),"Read about"," ",s.createElement("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/license/license-restrictions/#active-users-limit",target:"_blank",rel:"noreferrer noopener"},"active user limits")," ","and"," ",s.createElement("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/license/license-restrictions/#concurrent-sessions-limit",target:"_blank",rel:"noreferrer noopener"},"concurrent session limits"),"."),k.limit_by===Yc&&s.createElement(gl,{content:[{name:"Active licensed users",value:Hm(k.included_users,pa),highlight:uu(k.included_users,pa)>=Hd},...a.$.bootData.settings.anonymousEnabled?[{name:"Authenticated users",value:ve?.active_users||0,indentLevel:1},{name:"Anonymous users",value:Math.floor((ve?.active_anonymous_devices||0)/va),tooltip:`For every ${va} anonymous ${va>1?"devices":"device"}, Grafana counts 1 user.`,indentLevel:1}]:[]],state:Vn})))))},jm=k=>({title:(0,B.css)`
      margin: ${k.spacing(4)} 0;
    `,infoText:(0,B.css)`
      font-size: ${k.typography.size.sm};
    `,uploadWrapper:(0,B.css)`
      margin-left: 79px;
    `,row:(0,B.css)`
      display: flex;
      justify-content: space-between;
      width: 100%;
      flex-wrap: wrap;
      gap: ${k.spacing(2)};

      & > div {
        flex: 1 1 340px;
      }
    `,footerText:(0,B.css)`
      margin-bottom: ${k.spacing(2)};
    `,licenseCard:(0,B.css)`
      background: url('/public/img/licensing/card-bg-${k.isLight?"light":"dark"}.svg') center no-repeat;
      background-size: cover;
    `,message:(0,B.css)`
      height: 70px;
      a {
        color: ${k.colors.text.link};

        &:hover {
          text-decoration: underline;
        }
      }

      svg {
        margin-right: ${k.spacing(.5)};
      }
    `}),qc=({state:k,message:ve,title:Be,orgSlug:Qe,licenseId:lt})=>{const Ct=(0,W.of)(Qm);return k?s.createElement(z.F,{title:Be,severity:k||void 0},s.createElement("div",{className:Ct.container},s.createElement("div",null,s.createElement("p",null,ve),s.createElement("a",{className:Ct.link,href:"https://grafana.com/docs/grafana/latest/enterprise/license/license-restrictions/",target:"_blank",rel:"noopener noreferrer"},"Learn about Enterprise licenses")),s.createElement(ou,{orgSlug:Qe,licenseId:lt}))):null},Qm=k=>({container:(0,B.css)`
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      width: 100%;
    `,link:(0,B.css)`
      font-size: ${k.typography.bodySmall.fontSize};
      text-decoration: underline;
      color: ${k.colors.text.secondary};

      &:hover {
        color: ${k.colors.text.primary};
      }
    `}),fu=({queryParams:k})=>{const[ve,Be]=(0,s.useState)(null),[Qe,lt]=(0,s.useState)(null),[Ct,jt]=(0,s.useState)(!1),{tokenUpdated:pn,tokenRenewed:yn}=k;return(0,s.useEffect)(()=>Pi.TP.hasPermission(N.LicensingRead)?(jt(!0),(async()=>{const kn=await Jd().catch(()=>null),Vn=await Jc().catch(()=>null);Be(kn),lt(Vn),jt(!1)})(),qd):void 0,[]),s.createElement(hs.Y,{navId:"licensing"},s.createElement(hs.Y.Contents,null,s.createElement(Wm.ServerStats,null),s.createElement(mu,{token:ve,stats:Qe,tokenUpdated:pn,tokenRenewed:yn,isLoading:Ct,licensedUrl:a.$.licenseInfo?.appUrl})))};var Pc=e(63415),Xo=e(2913),fi=e(27746),gu=e(87978),ed=e(20120),_l=(k=>(k.Test="test",k.Control="control",k))(_l||{});const Cc=k=>"feature-highlights"+(k?`-${k}`:""),pl={isDrawerOpen:!1,drawerTab:R.Stats},pu=(0,un.Z0)({name:"metaAnalytics",initialState:pl,reducers:{setDrawerOpen:(k,ve)=>({...k,isDrawerOpen:ve.payload}),setDrawerTab:(k,ve)=>({...k,drawerTab:ve.payload})}}),{setDrawerOpen:Hl,setDrawerTab:hu}=pu.actions,Ym={metaAnalytics:pu.reducer};var Jm=e(63021),td=e(40675),vu=e(40980),Gl=e(72254),Zm=e(24293);class nd extends s.PureComponent{convertSummariesToDataFrame(ve,Be){const Qe=[],lt=[];return Be.forEach(Ct=>{Qe.push((0,Os.KQ)(Ct.day,dn).valueOf()),lt.push(Ct[ve.name])}),{fields:[{name:"Time",type:_e.PU.time,config:{},values:Qe},{name:ve.name,type:ve.type,config:{displayName:ve.label??ve.name,color:ve.color?{mode:Zm.Y.Fixed,fixedColor:ve.color}:void 0},values:lt}],length:Be.length}}buildTimeRange(){const{dailySummaries:ve}=this.props,Be=(0,Os.KQ)(ve[0].day),Qe=(0,Os.KQ)(ve[ve.length-1].day).add(12,"hours");return{from:Be,to:Qe,raw:{from:Be,to:Qe}}}renderChart(ve){const{dailySummaries:Be,theme:Qe}=this.props,{timeRange:lt,showBars:Ct,title:jt,width:pn,fields:yn,isStacked:Un=!1}=ve,kn=Ya(Qe),Vn=yn.map(va=>this.convertSummariesToDataFrame(va,Be)),$n={series:Vn,state:et.Gu.Done,timeRange:lt},ca={legend:{showLegend:Vn.length>1,displayMode:pt.lm.List,placement:"bottom",calcs:[]},tooltip:{mode:pt.$N.Multi,sort:pt.xB.Descending}},pa={defaults:{custom:{showPoints:pt.yL.Never,drawStyle:Ct?pt.GR.Bars:pt.GR.Line,stacking:Un?{mode:pt.gs.Normal}:void 0,fillOpacity:Ct?50:0}},overrides:[]};return s.createElement("div",{className:kn.graphContainer},s.createElement(Wt.NR,{title:jt,width:pn,height:220,displayMode:"transparent",loadingState:$n.state},(va,ma)=>s.createElement(st.m,{title:jt,width:va,height:ma,pluginId:"timeseries",data:$n,fieldConfig:pa,options:ca})))}}class Xm extends nd{render(){const{dailySummaries:ve,theme:Be}=this.props;if(ve&&ve.length>0){const Qe=this.buildTimeRange();return s.createElement(Di.Ay,{disableHeight:!0},({width:lt})=>lt===0?null:s.createElement("main",{style:{width:lt}},this.renderChart({title:"Daily query count",fields:[{name:"queries",type:_e.PU.number},{name:"cachedQueries",type:_e.PU.number,label:"cached queries"}],width:lt,timeRange:Qe,showBars:!1,showLines:!0}),this.renderChart({title:"Views last 30 days",fields:[{name:"views",type:_e.PU.number}],width:lt,timeRange:Qe,showBars:!0,showLines:!1}),this.renderChart({title:"Errors last 30 days",fields:[{name:"errors",type:_e.PU.number,color:Be.colors.error.border}],width:lt,timeRange:Qe,showBars:!1,showLines:!0})))}return s.createElement("span",null,"No data.")}}const qm={setDrawerOpen:Hl},ef=(0,W.cV)((0,U.connect)(null,qm)(Xm));class tf extends nd{render(){const{dailySummaries:ve,theme:Be}=this.props;if(ve&&ve.length>0){const Qe=this.buildTimeRange();return s.createElement(Di.Ay,{disableHeight:!0},({width:lt})=>lt===0?null:s.createElement("main",{style:{width:lt}},this.renderChart({title:"Daily query count",fields:[{name:"queries",type:_e.PU.number},{name:"cachedQueries",type:_e.PU.number,label:"cached queries"}],width:lt,timeRange:Qe,showBars:!1,showLines:!0}),this.renderChart({title:"Errors last 30 days",fields:[{name:"errors",type:_e.PU.number,color:Be.colors.error.border}],width:lt,timeRange:Qe,showBars:!1,showLines:!0})))}return s.createElement("span",null,"No data.")}}const nf=(0,W.cV)(tf);var Eu=e(90708),Sc=e(99635),yu=e(77093);class af extends nd{constructor(ve){super(ve),this.onOpenVersionHistory=()=>{const{setDrawerOpen:Be}=this.props;Be(!1),Ne.Ny.partial({editview:"versions"})},this.state={dashboardUsersInfo:null}}async componentDidMount(){const{dashboard:ve}=this.props;try{const Be=await Za(ve.id);this.setState({dashboardUsersInfo:Be})}catch(Be){console.log("Error getting dashboard users info",Be)}}formatDate(ve){const Be=ve.diff((0,Os.KQ)().startOf("day"),"days",!0);if(Be<-6)return ve.format("YYYY-MM-DD");if(Be<-1)return ve.locale("en").format("dddd");if(Be<0)return"Yesterday";{const Qe=ve.diff((0,Os.KQ)(),"minutes",!0);return Qe<-60?"Today":Qe<-15?"Last hour":"Currently viewing"}}renderUserBox(ve,Be,Qe){return s.createElement("div",{className:Qe.userBox,"aria-label":"User information box"},s.createElement("h6",{"aria-label":"User box title"},ve),s.createElement(Sc.n,{userView:Be,showTooltip:!1}),s.createElement("div",{className:Qe.userName},Be.user.name),s.createElement("div",null,(0,Os.KQ)(Be.lastActiveAt).format("YYYY-MM-DD")))}renderViewsChart(){const ve=this.buildTimeRange();return s.createElement(Di.Ay,{disableHeight:!0},({width:Be})=>Be===0?null:s.createElement("main",{style:{width:Be}},this.renderChart({title:"Views last 30 days",fields:[{name:"views",type:_e.PU.number}],width:Be,timeRange:ve,showBars:!0,showLines:!1})))}convertUserViewsToDataFrame(ve,Be){const{userViews:Qe}=this.props;if(Qe&&Qe.length>0){const lt=[],Ct=[],jt=[];Qe.forEach(kn=>{lt.push(this.formatDate((0,Os.KQ)(kn.lastActiveAt))),Ct.push(kn.user.name),jt.push(s.createElement(Sc.n,{className:ve.userIcon,userView:kn,showTooltip:!1}))});const pn={displayName:" ",filterable:!1,custom:{width:50,align:"center",minWidth:50,cellOptions:{type:pt.ob.ColorText},inspect:!1}},yn=[{fields:[{name:" ",type:_e.PU.other,config:pn,values:jt},{name:"User",type:_e.PU.string,config:{},values:Ct},{name:"When",type:_e.PU.string,config:{},values:lt}],length:Qe.length}],Un=(0,Eu.we)({data:yn,theme:Be,replaceVariables:kn=>kn,fieldConfig:{}});return Un.length>0?Un[0]:null}else return null}render(){const{dailySummaries:ve,dashboard:Be,theme:Qe,userViews:lt}=this.props,{dashboardUsersInfo:Ct}=this.state,jt=Ya(Qe),pn=this.convertUserViewsToDataFrame(jt,Qe);return s.createElement("div",null,ve&&ve.length>0&&this.renderViewsChart(),s.createElement("div",{className:jt.userBoxesContainer},Ct?.creator&&this.renderUserBox("Created",Ct.creator,jt),Ct?.lastEditor&&this.renderUserBox("Last edited",Ct.lastEditor,jt),lt?.length>0&&this.renderUserBox("Last viewed",lt[0],jt)),lt?.length>0&&s.createElement("div",{className:jt.tableContainer},s.createElement("div",{className:jt.tableHeader},s.createElement("h4",null,"Last 30 dashboard viewers"),Be.meta.showSettings&&s.createElement(ce.$n,{icon:"history",variant:"secondary",onClick:this.onOpenVersionHistory,"aria-label":"Version history button"},"Dashboard version history")),s.createElement(Di.Ay,{disableHeight:!0},({width:yn})=>{if(yn===0)return null;const Un=35*(pn.length+1);return s.createElement("main",{style:{width:yn}},s.createElement(yu.X,{data:pn,height:Un,width:yn,"aria-label":"Recent users table"}))})))}}const sf={setDrawerOpen:Hl},bu=(0,W.cV)((0,U.connect)(null,sf)(af)),rf=30;class of extends s.PureComponent{constructor(ve){super(ve),this.onSelectTab=Be=>{this.props.setDrawerTab(Be.value||R.Stats)},this.state={dailySummaries:[],publicDailySummaries:[],userViews:[]}}async componentDidMount(){const{dashboard:ve}=this.props,Be=[];for(let Qe=0;Qe<30;Qe++)Be.push((0,Os.KQ)(Date.now()).subtract(Qe,"days").format(dn));if(ve?.id&&ve.meta.url){const Qe=await Ba(ve.id,Be),lt=await Hn(ve.id,rf);let Ct=[];(0,Gl.iR)()&&(Ct=await wa(ve.id,Be)),this.setState({dailySummaries:Qe,userViews:lt,publicDailySummaries:Ct})}}renderHeader(ve){const Be=[{label:"Stats",value:R.Stats},{label:"Users and activity",value:R.Users}];return(0,Gl.iR)()&&Be.push({label:"Public dashboards",value:R.PublicDashboards}),s.createElement(Jm.U,{className:ve.tabsBar},Be.map((Qe,lt)=>s.createElement(td.o,{key:`${Qe.value}-${lt}`,label:Qe.label,active:Qe.value===this.props.drawerTab,onChangeTab:()=>this.onSelectTab(Qe)})))}render(){const{dailySummaries:ve,publicDailySummaries:Be,userViews:Qe}=this.state,{dashboard:lt,drawerTab:Ct,setDrawerOpen:jt,theme:pn}=this.props,yn=Ya(pn);return s.createElement(gu._,{scrollableContent:!0,title:`${lt.title} - analytics`,size:"md",onClose:()=>jt(!1),subtitle:this.renderHeader(yn),expandable:!0},s.createElement(vu.J,{className:yn.tabContent},(0,_n.z5)()&&s.createElement(Zn.Iz,{featureId:"dashboard-insights",eventVariant:"trial",featureName:"dashboard usage insights",text:"Get full access to usage insights for free during your trial of Grafana Pro."}),Ct===R.Stats&&s.createElement(nf,{dashboard:lt,dailySummaries:ve}),Ct===R.Users&&s.createElement(bu,{dashboard:lt,dailySummaries:ve,userViews:Qe}),(0,Gl.iR)()&&Ct===R.PublicDashboards&&s.createElement(ef,{dashboard:lt,dailySummaries:Be})))}}function lf(k){return{drawerTab:k.metaAnalytics.drawerTab}}const cf={setDrawerOpen:Hl,setDrawerTab:hu},df=(0,W.cV)((0,U.connect)(lf,cf)(of)),Du=({onClick:k,isHighlighted:ve})=>s.createElement(fi.I,{icon:"info-circle",tooltip:"Dashboard insights",onClick:k,isHighlighted:ve}),uf=({dashboard:k,isDrawerOpen:ve,setDrawerOpen:Be})=>{const Qe=k?.id&&k.meta.url,lt=(0,_n.z5)();return(0,s.useEffect)(()=>{Qe&&lt&&(0,o.Xp)(Cc("dashboard-insights-dot"),_l.Test,"trial")},[Qe,lt]),Qe&&s.createElement(s.Fragment,null,s.createElement(Du,{onClick:()=>{Be(!0),(0,o.rR)("dashboards_toolbar_actions_clicked",{item:"insights"})},isHighlighted:lt}),ve&&s.createElement(df,{dashboard:k}))};function mf(k){return{isDrawerOpen:k.metaAnalytics.isDrawerOpen}}const ff={setDrawerOpen:Hl},ad=({dashboard:k})=>{const ve=k?.id&&k.meta.url,[Be,Qe]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{ve&&(0,o.Xp)(Cc("dashboard-insights-dot"),_l.Test,"")},[ve]),ve&&s.createElement(s.Fragment,null,s.createElement(Du,{isHighlighted:!0,onClick:()=>{Qe(!0)}}),Be&&s.createElement(gf,{dashboard:k,onClose:()=>Qe(!1)}))},Pu=()=>{(0,n.a)("analytics")?r.contextSrv.hasPermission(N.DashboardsInsightsRead)&&(0,ed.fP)({show:()=>!0,component:(0,U.connect)(mf,ff)(uf),index:-1}):a.$.featureToggles.featureHighlights&&(0,ed.fP)({show:()=>!0,component:ad,index:-1})},gf=({onClose:k,dashboard:ve})=>{const Be=(0,W.$j)();return s.createElement(gu._,{onClose:k,title:`${ve?.title} - analytics`,width:"50%"},s.createElement(Zn.Iz,{featureName:"dashboard usage insights",featureId:"dashboard-insights"}),s.createElement(Zn.ep,{featureName:"dashboard usage insights",image:`usage-insights-${Be.isLight?"light":"dark"}.png`,featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/usage-insights/dashboard-datasource-insights",description:"Usage Insights provide detailed information about dashboard usage, like the number of views, queries, and errors users have experienced. You can use this to improve users\u2019 experience and troubleshoot issues."}))};class pf{constructor(ve){this.options=ve,this.buffer=[],this.supportedEvents=[Pc.on.MetaAnalytics],this.addEvent=Be=>{this.buffer.push(Be)},this.flush=()=>{if(this.buffer.length===0)return;const Be=[];for(const Qe of this.buffer)Be.push({type:Qe.type,...Qe.payload,meta:Qe.meta});this.buffer=[],this.options.url&&(0,Qt.AI)().fetch({method:"POST",url:this.options.url,showSuccessAlert:!1,showErrorAlert:!1,data:Be}).toPromise()}}}const hf=({users:k,onClick:ve,limit:Be=4})=>{const Qe=(0,W.of)(vf);if(!k.length)return null;Be=Be>0?Be:4;const lt=k.length>Be,Ct=k.length-Be,jt=Ct>99;return s.createElement("div",{className:Qe.container,"aria-label":"Users indicator container"},lt&&s.createElement(Sc.n,{onClick:ve,userView:{user:{name:"Extra users"},lastActiveAt:""},showTooltip:!1},jt?"...":`+${Ct}`),k.slice(0,lt?Be:Be+1).reverse().map(pn=>s.createElement(Sc.n,{key:pn.user.name,userView:pn})))},vf=k=>({container:(0,B.css)({display:"flex",justifyContent:"center",flexDirection:"row-reverse",marginLeft:k.spacing(1),"& > button":{marginLeft:k.spacing(-1)}}),dots:(0,B.css)({marginBottom:"3px"})});function Ef(k){return ve=>{ve(Hl(!0)),ve(hu(k))}}const ki={openDrawer:Ef},gi=(0,U.connect)(null,ki),_i=4,np=6e4;function yf(k,ve){const Be=Pi.TP.user;In(k,_i+10).then(Qe=>{const lt=Qe.filter(Ct=>Ct.user.id!==Be.id);ve(Ct=>(0,We.isEqual)(lt,Ct)?Ct:lt)})}const Cu=({dashboard:k,openDrawer:ve})=>{const Be=k?.id,[Qe,lt]=(0,s.useState)([]);return(0,s.useEffect)(()=>{if(!Be||!k?.meta.url)return;yf(Be,lt);const Ct=setInterval(()=>yf(Be,lt),np);return()=>{clearInterval(Ct)}},[Be,k]),s.createElement(hf,{users:Qe,limit:_i,onClick:()=>ve(R.Users)})},Su=()=>{Pi.TP.hasPermission(N.DashboardsInsightsRead)&&(0,ed.UP)({show:()=>!0,component:gi(Cu),index:"end"})},bf=()=>{(0,Xo.zj)().analytics?.enabled&&((0,n.a)("analytics")?((0,Pc.pl)(new pf({url:Tu()})),Pi.TP.user.isSignedIn&&(Su(),Pu())):a.$.featureToggles.featureHighlights&&Pu())},Tu=()=>{const k=(0,Xo.zj)().publicDashboardAccessToken;return k!==""?`api/public/ma/events/${k}`:"api/ma/events"},Df=()=>{const{uid:k}=(0,se.g)(),ve=(0,Jn.$m)("insights"),Be=(0,l.useSelector)(lt=>lt.navIndex),Qe=(0,gn.tc)(Be,`datasource-insights-${k}`,ve);return s.createElement(hs.Y,{navId:"datasources",pageNav:Qe.main},s.createElement(hs.Y.Contents,null,s.createElement(ut,{uid:k})))},Pf=()=>{const{uid:k}=(0,se.g)(),ve=(0,yi.$m)("insights"),Be=(0,l.useSelector)(lt=>lt.navIndex),Qe=(0,gn.tc)(Be,`datasource-insights-${k}`,ve);return s.createElement(hs.Y,{navId:"datasources",pageNav:Qe.main},s.createElement(hs.Y.Contents,null,s.createElement(on,{uid:k})))};var Cf=e(36663);function Mu({message:k,variant:ve}){const Be=(0,W.of)(Sf);return s.createElement(mi.a,{display:"flex",backgroundColor:ve,borderRadius:"default",paddingY:1,paddingX:2,alignItems:"stretch"},s.createElement("div",{className:Be.content},s.createElement("div",{dangerouslySetInnerHTML:{__html:(0,Cf.G)(k)}})))}function Sf(k){return{content:(0,B.css)({p:{margin:0},a:{color:k.colors.text.link}})}}var Tf=e(75816),jl=e(75505);function xu({baseURL:k}){async function ve(Be){try{const{data:Qe,...lt}=await(0,jl.s)((0,Qt.AI)().fetch({...Be,url:k+Be.url,showErrorAlert:Be.showErrorAlert,data:Be.body}));return{data:Qe,meta:lt}}catch(Qe){return Be.manageError?Be.manageError(Qe):{error:Qe}}}return ve}const Tc=(0,Tf.xP)({reducerPath:"notificationBannerGeneratedAPI",baseQuery:xu({baseURL:`/apis/banners.grafana.app/v0alpha1/namespaces/${a.$.namespace}`}),tagTypes:["NotificationBannerList"],endpoints:()=>({})}).injectEndpoints({endpoints:k=>({listNotificationBanner:k.query({query:()=>({url:"/notificationbanners"}),providesTags:["NotificationBannerList"]}),createNotificationBanner:k.mutation({query:ve=>({url:"/notificationbanners",method:"POST",body:ve}),invalidatesTags:["NotificationBannerList"]}),getNotificationBanner:k.query({query:ve=>({url:`/notificationbanners/${ve.name}`})}),deleteNotificationBanner:k.mutation({query:ve=>({url:`/notificationbanners/${ve.name}`,method:"DELETE"})}),updateNotificationBanner:k.mutation({query:ve=>({url:`/notificationbanners/${ve.name}`,method:"PATCH",headers:{"Content-Type":"application/merge-patch+json"},body:JSON.stringify(ve.body)}),invalidatesTags:["NotificationBannerList"]})}),overrideExisting:!1}),{useListNotificationBannerQuery:xf,useCreateNotificationBannerMutation:Of,useGetNotificationBannerQuery:ap,useDeleteNotificationBannerMutation:sp,useUpdateNotificationBannerMutation:If}=Tc,sd=Tc.enhanceEndpoints({});function Af(k){const[ve,Be]=Of(),[Qe,lt]=If();return[(0,s.useCallback)(jt=>k?Qe({name:k,body:{metadata:{name:k},spec:jt}}):ve({metadata:{generateName:"banner"},spec:jt}),[ve,k,Qe]),k?lt:Be]}function Ou(){const k=xf();return[k.data?.items?.at(-1),k.isLoading]}function Rf(){const[k]=Ou(),{message:ve,variant:Be,enabled:Qe,endTime:lt,startTime:Ct,visibility:jt}=k?.spec||{message:"",variant:"info"},{isSignedIn:pn}=r.contextSrv.user,yn=(0,Os.AN)().isBetween(Ct,lt,void 0,"[]");return!Qe||!yn||!(jt==="everyone"||jt==="authenticated"&&pn)?null:s.createElement(Mu,{message:ve,variant:Be})}async function Iu(){(0,uo.Pl)(Rf)}var el=e(26272),Au=e(3591),Lf=e(32372),Ru=e(63383);function Bf({message:k,variant:ve}){return s.createElement(ua.B,{direction:"column",width:"100%",gap:2},s.createElement(On.E,{variant:"h3"},s.createElement(Da.x6,{i18nKey:"banner.preview.title"},"Preview")),s.createElement(Mu,{message:k||(0,Da.t)("banner.preview.message.default","Update this preview by modifying the message field."),variant:ve}))}function Uf(k){return k?{...k,startTime:k.startTime?(0,Os.KQ)(k.startTime):(0,Os.KQ)(),endTime:k.endTime?(0,Os.KQ)(k.endTime):void 0}:{enabled:!1,message:"",variant:"info",visibility:"everyone",startTime:(0,Os.KQ)()}}function Nf({banner:k,name:ve}){const[Be,Qe]=Af(ve),{register:lt,control:Ct,handleSubmit:jt,watch:pn,reset:yn,formState:{errors:Un,isDirty:kn},getValues:Vn}=(0,w.mN)({defaultValues:Uf(k)}),[$n,ca,pa]=pn(["startTime","message","variant"]);(0,s.useEffect)(()=>{const ma=(0,Au.J7)();if(Qe.isSuccess){const Ea=Vn();ma.publish({type:el.r1.alertSuccess.name,payload:[(0,Da.t)("banner.api.result.saved","Banner settings saved")]}),yn({...Ea,startTime:Ea.startTime||null,endTime:Ea.endTime||null})}},[Qe.isSuccess,yn,Vn]);const va=async ma=>{(0,o.rR)("grafana_banner_saved",{enabled:ma.enabled,endSelected:!!ma.endTime,daysShown:ma.endTime?ma.startTime&&(0,Os.KQ)(ma.endTime).diff(ma.startTime,"days"):void 0,visibility:ma.visibility,variant:ma.variant});const Ea={...ma,startTime:ma.startTime?ma.startTime.toISOString():null,endTime:ma.endTime?ma.endTime.toISOString():null};Be(Ea)};return s.createElement(ua.B,{direction:"column",gap:2},s.createElement(Bf,{message:ca,variant:pa}),s.createElement("form",{onSubmit:jt(va),style:{maxWidth:650}},s.createElement(ne.n,{label:(0,Da.t)("banner.form.title","Configure banner")},s.createElement(me,{onDiscard:yn,confirmRedirect:kn}),s.createElement(_.D,{label:(0,Da.t)("banner.form.enabled.label","Enabled")},s.createElement(H.d,{...lt("enabled"),label:"Enabled"})),s.createElement(_.D,{label:(0,Da.t)("banner.form.message.label","Message"),description:s.createElement(Da.x6,{i18nKey:"banner.form.message.description"},"Text content of the banner. Supports markdown.")},s.createElement(w.xI,{name:"message",control:Ct,render:({field:{ref:ma,...Ea}})=>s.createElement(Lf.B,{...Ea,height:200,language:"markdown"})})),s.createElement(_.D,{label:(0,Da.t)("banner.form.start.label","Starts at"),description:s.createElement(Da.x6,{i18nKey:"banner.form.start.description"},"The banner will be shown staring from this date/time.")},s.createElement(w.xI,{name:"startTime",control:Ct,render:({field:{ref:ma,value:Ea,...ts}})=>s.createElement(Ru.K,{...ts,date:Ea||void 0,showSeconds:!1,clearable:!0})})),s.createElement(_.D,{label:(0,Da.t)("banner.form.end.label","Ends at"),invalid:!!Un?.endTime,error:Un?.endTime?.message,description:s.createElement(Da.x6,{i18nKey:"banner.form.end.description"},"If no end date is selected, the banner is displayed indefinitely.")},s.createElement(w.xI,{name:"endTime",control:Ct,rules:{validate:ma=>!$n||!ma||ma>$n?!0:(0,Da.t)("banner.form.end.error","End time must be after start time")},render:({field:{ref:ma,value:Ea,...ts}})=>s.createElement(Ru.K,{...ts,date:Ea||void 0,showSeconds:!1,clearable:!0})})),s.createElement(_.D,{label:(0,Da.t)("banner.form.visibility.label","Visibility")},s.createElement(w.xI,{control:Ct,name:"visibility",render:({field:{ref:ma,...Ea}})=>s.createElement(eo.z,{...Ea,options:[{label:(0,Da.t)("banner.form.options.everyone","Everyone"),value:"everyone"},{label:(0,Da.t)("banner.form.options.authenticated","Authenticated users"),value:"authenticated"}]})})),s.createElement(ua.B,null,s.createElement(_.D,{label:(0,Da.t)("banner.form.variant.label","Variant")},s.createElement(w.xI,{name:"variant",control:Ct,render:({field:{ref:ma,onChange:Ea,...ts}})=>s.createElement(h.l6,{...ts,onChange:Qa=>{Ea(Qa.value)},placeholder:"Select banner type",options:[{label:(0,Da.t)("banner.form.options.info","Info"),value:"info"},{label:(0,Da.t)("banner.form.options.warning","Warning"),value:"warning"},{label:(0,Da.t)("banner.form.options.error","Error"),value:"error"}]})}))),s.createElement(ce.$n,{type:"submit",disabled:!kn},s.createElement(Da.x6,{i18nKey:"banner.form.actions.save"},"Save")))))}function Lu(){const[k,ve]=Ou();return s.useEffect(()=>{(0,o.Jy)()},[]),s.createElement(hs.Y,{navId:"banner-settings"},s.createElement(hs.Y.Contents,{isLoading:ve},s.createElement(Nf,{banner:k?.spec,name:k?.metadata.name})))}const wf=()=>{const{uid:k}=(0,se.g)(),ve=(0,Jn.$m)("permissions"),Be=(0,l.useSelector)(lt=>lt.navIndex),Qe=(0,gn.tc)(Be,`datasource-permissions-${k}`,ve);return s.createElement(hs.Y,{navId:"datasources",pageNav:Qe.main},s.createElement(hs.Y.Contents,null,s.createElement(Hc,{uid:k})))},Wf=()=>{const{uid:k}=(0,se.g)(),ve=(0,yi.$m)("permissions"),Be=(0,l.useSelector)(lt=>lt.navIndex),Qe=(0,gn.tc)(Be,`datasource-permissions-${k}`,ve);return s.createElement(hs.Y,{navId:"datasources",pageNav:Qe.main},s.createElement(hs.Y.Contents,null,s.createElement(_d,{uid:k})))};var Ql=e(13544),rd=e(62930),Mc=e(20851),Bu=e(83277),Yl=e(82467),xc=e(3169),Uu=e(72686),Nu=(k=>(k.NOT_FOUND_MAGIC_LINK="publicdashboards.magicLinkNotFound",k.EXPIRED_MAGIC_LINK="publicdashboards.magicLinkExpired",k))(Nu||{}),Kf=(k=>(k.INTERNAL_SERVER_ERROR="publicdashboards.internalServerError",k.INVALID_SESSION="publicdashboards.invalidSession",k.EXPIRED_SESSION="publicdashboards.sessionExpired",k))(Kf||{});const $f={title:"Request access",description:"You'll receive an email with a one-time link."},hl="Something went wrong",Bn="To request access to the dashboard again, enter your email. You'll receive an email with a one-time link.",Vf={"publicdashboards.internalServerError":hl,"publicdashboards.magicLinkNotFound":"This link has expired or already been used","publicdashboards.magicLinkExpired":"This magic link has expired","publicdashboards.invalidSession":"You no longer have access","publicdashboards.sessionExpired":"Your access has expired"},wu=k=>k?{title:Vf[String(k)]||hl,description:Bn}:$f;function tl(k){return typeof k=="object"&&k!=null&&"error"in k}function zf(k){return tl(k)&&(0,Qt.NF)(k.error)}const od=Uu.Sm.injectEndpoints({endpoints:k=>({requestAccess:k.mutation({query:ve=>({url:"/public/dashboards/share/request-access",method:"POST",data:ve})}),confirmAccess:k.mutation({query:({magicLinkToken:ve,accessToken:Be})=>({url:`/public/dashboards/share/${ve}`,method:"POST"}),async onQueryStarted({accessToken:ve},{dispatch:Be,queryFulfilled:Qe}){try{await Qe,Be((0,Yl.dx)((0,xc.tZ)("Access confirmed!"))),window.location.assign(a.$.appSubUrl+`public-dashboards/${ve}`)}catch(lt){if(zf(lt)){const{data:{messageId:Ct}}=lt.error;Ct&&Object.values(Nu).includes(Ct)&&window.location.assign(a.$.appSubUrl+`public-dashboards/${ve}/request-access?error=${Ct}`)}}}}),addRecipient:k.mutation({query:({recipient:ve,uid:Be})=>({url:`/public-dashboards/${Be}/share/recipients`,method:"POST",data:{recipient:ve}}),async onQueryStarted(ve,{dispatch:Be,queryFulfilled:Qe}){await Qe,Be((0,Yl.dx)((0,xc.tZ)("Invite sent!")))},invalidatesTags:(ve,Be,{dashboardUid:Qe})=>[{type:"PublicDashboard",id:Qe}]}),deleteRecipient:k.mutation({query:({uid:ve,recipientUid:Be})=>({url:`/public-dashboards/${ve}/share/recipients/${Be}`,method:"DELETE"}),async onQueryStarted({recipientEmail:ve},{dispatch:Be,queryFulfilled:Qe}){await Qe,Be((0,Yl.dx)((0,xc.tZ)("Access Revoked",`You have successfully revoked access for ${ve}.`)))},invalidatesTags:(ve,Be,{dashboardUid:Qe})=>[{type:"PublicDashboard",id:Qe},"UsersWithActiveSessions","ActiveUserDashboards"]}),reshareAccessToRecipient:k.mutation({query:({uid:ve,recipientUid:Be})=>({url:`/public-dashboards/${ve}/share/recipients/${Be}`,method:"PATCH"}),async onQueryStarted(ve,{dispatch:Be,queryFulfilled:Qe}){await Qe,Be((0,Yl.dx)((0,xc.tZ)("Invite resent!")))}}),getActiveUsers:k.query({query:()=>({url:"/public-dashboards/share/users?status=active"}),providesTags:["UsersWithActiveSessions"]}),getActiveUserDashboards:k.query({query:ve=>({url:`/public-dashboards/share/users/${ve}/dashboards?status=active`}),providesTags:(ve,Be,Qe)=>[{type:"ActiveUserDashboards",id:Qe}]}),revokeAllAccess:k.mutation({query:({email:ve})=>({url:`/public-dashboards/share/users/${ve}`,method:"DELETE"}),async onQueryStarted({email:ve},{dispatch:Be,queryFulfilled:Qe}){await Qe,Be((0,Yl.dx)((0,xc.tZ)("Access Revoked",`${ve}'s access to all public dashboards has been successfully removed.`)))},invalidatesTags:["UsersWithActiveSessions"]})}),overrideExisting:!0}),{useRequestAccessMutation:kf,useGetActiveUserDashboardsQuery:rp,useGetActiveUsersQuery:_f,useConfirmAccessMutation:Oc}=od,Hf=null,id=Ql.Tp.pages.PublicDashboardConfirmAccess;function nl(){const k=(0,W.of)(Gf),{accessToken:ve}=(0,se.g)(),[{magicLinkToken:Be}]=(0,Bu.s)(),[Qe,{isLoading:lt,isSuccess:Ct}]=Oc(),jt=async()=>{await Qe({accessToken:ve,magicLinkToken:String(Be)})};return s.createElement(Mc.GU,{branding:{loginTitle:"Dashboard access",loginSubtitle:"Get access to the dashboard for 30 days. After 30 days, you can request access again to continue viewing the dashboard.",hideFooter:!0}},s.createElement(Mc.qm,null,s.createElement(ce.$n,{"data-testid":id.submitButton,disabled:lt||Ct,type:"submit",className:k.form,onClick:jt},s.createElement("span",null,"Confirm access"),lt&&s.createElement(rd.y,{className:k.loadingSpinner}))))}const Gf=k=>({loadingSpinner:(0,B.css)({marginLeft:k.spacing(1)}),form:(0,B.css)({justifyContent:"center",width:"100%"})}),Fu=(0,B.css)`
  justify-content: center;
  width: 100%;
`,Ic=Ql.Tp.pages.RequestViewAccess,ld=()=>{const k=(0,W.of)(cd),{accessToken:ve}=(0,se.g)(),[{error:Be}]=(0,Bu.s)(),[Qe,{isLoading:lt,isSuccess:Ct}]=kf(),{register:jt,handleSubmit:pn,formState:{errors:yn},reset:Un}=(0,w.mN)({mode:"onSubmit"}),kn=wu(Be?String(Be):void 0),Vn=async $n=>{await Qe({accessToken:ve,email:$n.email}).unwrap(),Un()};return s.createElement(Mc.GU,{branding:{loginTitle:kn.title,loginSubtitle:kn.description,hideFooter:!0}},s.createElement(Mc.qm,null,s.createElement("form",{className:Fu,onSubmit:pn(Vn)},s.createElement(_.D,{label:"Email",error:yn?.email?.message,invalid:!!yn.email},s.createElement(G.p,{"data-testid":Ic.recipientInput,placeholder:"email",autoCapitalize:"none",...jt("email",{required:"Email is required",pattern:{value:Gl._l,message:"Invalid email"}})})),s.createElement(ce.$n,{"data-testid":Ic.submitButton,disabled:Ct,type:"submit",className:Fu},Ct?"Access requested":"Request access"," ",lt&&s.createElement(rd.y,{className:k.loadingSpinner})))))},cd=k=>({loadingSpinner:(0,B.css)`
    margin-left: ${k.spacing(1)};
  `}),jf=ld;var Ac=e(26657),Wu=e(64152),Hi=e(99140),vl=e(19347),Al=e(10880),dd=e(28138),Qf=e(14678),Yf=e(39268),Jf=e(38894),Wo=e(51612);const Ku=k=>{const{onChange:ve,value:Be}=k,Qe=(0,W.of)(op);return s.createElement(Yf.C,{className:Qe.filter},s.createElement(Jf.I,{width:"auto"},"Filter by data source"),s.createElement(j.I,null,s.createElement(Wo.s,{width:30,placeholder:"Select a data source",onChange:lt=>{ve({name:lt.name,id:lt.id,uid:lt.uid})},noDefault:!0,current:Be})),s.createElement(j.I,null,s.createElement(ce.$n,{className:Qe.button,icon:"trash-alt",variant:"secondary",onClick:()=>{ve(void 0)}})))},op=k=>({filter:(0,B.css)`
      margin-bottom: ${a.$.theme.spacing.md};
    `,button:(0,B.css)`
      color: ${k.colors.text.secondary};
    `});var al=e(65879);const ud=({recordedQuery:k,buttons:ve})=>{const Be=(0,W.of)($u),Qe=(0,vl.l)()?.getInstanceSettings(k.queries[0]?.datasource);return s.createElement("div",{className:Be.alert},Qe?.meta&&s.createElement("img",{className:Be.media,src:Qe.meta.info.logos.small,alt:"Query logo"}),s.createElement("div",{className:Be.body},s.createElement("div",{className:Be.info},s.createElement("div",null,s.createElement("h2",{className:Be.heading},k.name),s.createElement("p",{className:Be.description},Zf(k))),s.createElement("div",{className:Be.buttonWrapper},ve.map((lt,Ct)=>s.createElement("div",{key:`button-${Ct}`,className:Be.button},lt))))))},Zf=k=>{const ve=[`Interval: ${(0,al.secondsToHms)(k.interval)}`,`Range: Last ${(0,al.secondsToHms)(k.range)}`],Be=(0,vl.l)()?.getInstanceSettings(k.queries[0]?.datasource);return Be!==void 0&&ve.unshift(Be.name),k.description!==""&&ve.push(`${k.description}`),ve.join(" | ")},$u=k=>{const ve=k.shape.borderRadius();return{info:(0,B.css)`
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      width: 100%;
    `,heading:(0,B.css)`
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      margin-bottom: 0;
      font-size: ${k.typography.size.md};
      letter-spacing: inherit;
      line-height: ${k.typography.body.lineHeight};
      color: ${k.colors.text.primary};
      font-weight: ${k.typography.fontWeightMedium};
    `,description:(0,B.css)`
      width: 100%;
      margin: ${k.spacing(1,0,0)};
      color: ${k.colors.text.secondary};
      line-height: ${k.typography.body.lineHeight};
    `,alert:(0,B.css)`
      flex-grow: 1;
      position: relative;
      border-radius: ${ve};
      display: flex;
      flex-direction: row;
      align-items: center;
      background: ${k.colors.background.secondary};
      box-shadow: ${k.shadows.z1};
      margin-bottom: ${k.spacing(1)};

      &:before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background: ${k.colors.background.primary};
        z-index: -1;
      }
    `,body:(0,B.css)`
      color: ${k.colors.text.secondary};
      padding: ${k.spacing(2)};
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      overflow-wrap: break-word;
      word-break: break-word;
    `,content:(0,B.css)`
      color: ${k.colors.text.secondary};
      padding-top: ${k.spacing(1)};
      margin-left: 26px;
    `,media:(0,B.css)`
      margin-left: ${k.spacing(2)};
      width: 40px;
    `,buttonWrapper:(0,B.css)`
      padding: ${k.spacing(1)};
      background: none;
      display: flex;
      align-items: center;
      margin-right: ${k.spacing()};
    `,button:(0,B.css)`
      margin-left: ${k.spacing()};
    `}},Xf={recordedQueries:[],isLoading:!1,errorRecordedQueryTestResponse:""},Vu=(0,un.Z0)({name:"recorded-queries",initialState:Xf,reducers:{loadRecordedQueries:k=>({...k,isLoading:!0}),endLoadRecordedQueries:k=>({...k,isLoading:!1}),loadedRecordedQueries:(k,ve)=>{const Be=ve.payload;return{...k,recordedQueries:Be}},updateRecordedQueries:(k,ve)=>{const Be=ve.payload,Qe=k.recordedQueries.map(lt=>lt.id===Be.id?Be:lt);return{...k,recordedQueries:Qe}},deleteRecordedQueries:(k,ve)=>{const Be=ve.payload,Qe=k.recordedQueries.filter(lt=>lt.id!==Be.id);return{...k,recordedQueries:Qe}},setPrometheusWriteTarget:(k,ve)=>{const Be=ve.payload;return{...k,prometheusWriteTarget:Be}}}}),{loadRecordedQueries:qf,endLoadRecordedQueries:eg,loadedRecordedQueries:tg,updateRecordedQueries:ng,deleteRecordedQueries:El,setPrometheusWriteTarget:ci}=Vu.actions,md={recordedQueries:Vu.reducer},Bi="api/recording-rules";function fd(){return async k=>{k(qf());try{const ve=await(0,Qt.AI)().get(Bi);k(tg(ve))}finally{k(eg())}}}function gd(k){return async ve=>{await(0,Qt.AI)().put(Bi,k),ve(ng(k))}}function Rl(k){return async ve=>{await(0,Qt.AI)().delete(`${Bi}/${k.id}`),ve(El(k))}}function lp(k){return(0,jl.s)((0,Qt.AI)().fetch({method:"POST",url:Bi,data:k,showErrorAlert:!1}))}function ag(k){return(0,jl.s)((0,Qt.AI)().fetch({method:"POST",url:`${Bi}/test`,data:k,showSuccessAlert:!1,showErrorAlert:!1}))}function zu(){return async k=>{try{const ve=await(0,jl.s)((0,Qt.AI)().fetch({method:"GET",url:`${Bi}/writer`,showSuccessAlert:!1,showErrorAlert:!1}));k(ci(ve.data))}catch(ve){ve.status!==404&&console.error(ve)}}}function sg(k){return(0,jl.s)((0,Qt.AI)().fetch({method:"POST",url:`${Bi}/writer`,data:k,showSuccessAlert:!1,showErrorAlert:!1}))}const ku=k=>k.recordedQueries,rg=k=>k.prometheusWriteTarget,og=k=>({expr:`${k.prom_name}{id="${k.id}", name="${k.name}"}`,legendFormat:"",interval:"",exemplar:!0,datasource:k.dest_data_source_uid});function ig(k){return{recordedQueries:ku(k.recordedQueries)}}const pd={getRecordedQueriesAsync:fd},lg=(0,U.connect)(ig,pd),cg=({onAddQuery:k,getRecordedQueriesAsync:ve,recordedQueries:Be,onChangeDataSource:Qe,filterValue:lt})=>{const[Ct,jt]=(0,s.useState)(!1),[pn,yn]=(0,s.useState)(lt),[Un,kn]=(0,s.useState)([]),Vn=(0,W.of)(Jl);(0,s.useEffect)(()=>{ve()},[Ct,ve]);const $n=(Ea,ts)=>{kn(ts?Un.concat(Ea):Un.filter(Qa=>!(0,We.isEqual)(Qa,Ea)))},ca=()=>{(0,o.rR)("cloud_user_clicked_add_selected_recorded_queries",{recorded_queries_selected:Un.map(ts=>ts.name)});const Ea=(0,vl.l)().getInstanceSettings(Qf.uv);Qe?.(Ea),Un.map(og).forEach(ts=>{k?.(ts)}),jt(!1),kn([]),dd.A.emit(el.r1.alertSuccess,["Selected recorded queries added to the editor. The data source has been changed to mixed."])},pa=dg(Be,pn).map(Ea=>s.createElement(hd,{key:Ea.id,onQueryToggle:$n,recordedQuery:Ea})),va=()=>{jt(!1),kn([])},ma=()=>{(0,o.rR)("cloud_user_clicked_add_recorded_query_button"),jt(!0)};return s.createElement(s.Fragment,null,s.createElement(ce.$n,{icon:"plus",onClick:ma,variant:"secondary",className:Vn.openButton},"Recorded query"),s.createElement(he.a,{isOpen:Ct,title:"Add recorded query",onDismiss:va,className:Vn.modal},s.createElement(Ku,{value:pn?.name,onChange:yn}),s.createElement(z.F,{title:"",severity:"info"},"To create a new Recorded Query, return to the query editor and use the "," ",s.createElement(u.I,{name:"record-audio"})," "," icon in the series bar."),pa.length>0?pa:pn&&s.createElement("div",{className:Vn.noQueries},"No recorded queries available for ",pn?.name),s.createElement("div",{className:Vn.modalButtons},s.createElement(ce.$n,{variant:"secondary",className:Vn.modalButton,onClick:va},"Cancel"),s.createElement(ce.$n,{variant:"primary",className:Vn.modalButton,onClick:ca,disabled:Un.length===0},"Add"))))},hd=({onQueryToggle:k,recordedQuery:ve})=>{const[Be,Qe]=(0,s.useState)(!1);return s.createElement(ud,{recordedQuery:ve,buttons:[s.createElement(Al.S,{name:ve.id,value:Be,key:`${ve.id}-checked`,onChange:()=>{k(ve,!Be),Qe(!Be)}})]})},dg=(k,ve)=>{const Be=(0,vl.l)();return k.filter(Qe=>Qe.active).filter(Qe=>!ve||Qe.queries[0].datasource.uid===ve.uid).sort((Qe,lt)=>{const Ct=Be?.getInstanceSettings(Qe.queries[0]?.datasource),jt=Be?.getInstanceSettings(lt.queries[0]?.datasource),pn=Ct?.meta.name.localeCompare(jt?.meta.name??"");if(pn!==void 0&&pn!==0)return pn;const yn=Ct?.name.localeCompare(jt?.name??"");return yn!==void 0&&yn!==0?yn:Qe.name.localeCompare(lt.name)})},Jl=k=>({modalButtons:(0,B.css)`
      display: flex;
      justify-content: end;
    `,openButton:(0,B.css)`
      margin-left: -8px;
    `,modalButton:(0,B.css)`
      margin-left: ${k.spacing(1)};
    `,modal:(0,B.css)`
      width: 750px;
    `,noQueries:(0,B.css)`
      margin-left: ${k.spacing(1)};
      margin-bottom: ${k.spacing(3)};
    `}),vd=lg(cg);var Rc=e(12470),ug=e(43127),Ed=e(92041),_u=e(51253),mg=e(5308),yd=e(88448),fg=e(10343),Lc=e(20601),Zl=e(24240),Ll=e(87421);const bd=[{label:"30 seconds",value:30},{label:"1 minute",value:60},{label:"5 minutes",value:300},{label:"30 minutes",value:1800},{label:"1 hour",value:3600},{label:"12 hours",value:43200},{label:"24 hours",value:86400},{label:"1 week",value:604800},{label:"1 month",value:2592e3}],Bc=({label:k,description:ve,value:Be,onChange:Qe})=>s.createElement("div",null,s.createElement(_.D,{label:k,description:ve,required:!0},s.createElement(h.l6,{options:bd,onChange:lt=>{Qe(lt.value)},value:Be,"aria-label":`${k}-select`,menuShouldPortal:!0})));function gg(k){return{variables:(0,Ll.UN)(k)}}const pg=(0,U.connect)(gg),Hu=({href:k,trackingSource:ve})=>{const Be=(0,W.of)(Xl);return s.createElement("a",{href:k,className:Be.docsLink,target:"_blank",rel:"noreferrer",onClick:()=>(0,o.rR)("cloud_user_clicked_create_recorded_query_modal_documentation_icon",{source:ve})},s.createElement(u.I,{name:"info-circle"}))},hg=({query:k,queries:ve,dataSource:Be,variables:Qe})=>{const[lt,Ct]=(0,s.useState)(!1),[jt,pn]=(0,s.useState)(),[yn,Un]=(0,s.useState)("info"),[kn,Vn]=(0,s.useState)(""),$n=(0,W.of)(yd.o),ca=(0,W.of)(Xl);(0,s.useEffect)(()=>{(async()=>{r.contextSrv.hasPermission(N.LicensingRead)&&pn(await Jd().catch(()=>{}))})()},[]);const pa=()=>{Vn(""),Un("info"),Ct(!1)},va=async ws=>{try{return await ts(ws,Qa)}catch(es){Un("error"),(0,Qt.NF)(es)&&Vn(es.data.message);return}},ma=async ws=>{const es=await va(ws);es&&lp(es).then(()=>{Un("success"),Vn("Your new recorded query is recording successfully!"),(0,o.rR)("cloud_user_created_recorded_query")}).catch(Aa=>{Un("error"),Vn(Aa.data.message)})},Ea=async ws=>{const es=await va(ws);es&&ag(es).then(Aa=>{Un("info"),Vn(Aa.data.message)}).catch(Aa=>{Un("error"),Vn(Aa.data.message)})},ts=async(ws,es)=>{const Aa={target_ref_id:k?k.refId:"",name:ws.name,description:ws.description,interval:ws.interval,range:ws.range,count:ws.isCount,active:!0},Fs=ve?.map(async Ls=>{const $s=Ls.datasource||Be?.name,ns=await(0,vl.l)().get($s),br=ns.interpolateVariablesInQueries?ns.interpolateVariablesInQueries([Ls],{...es})[0]:Ls;return br.datasourceId=ns?ns.id:-1,br.datasource===void 0&&(Ls.datasource!==void 0&&Ls.datasource!==null?br.datasource=Ls.datasource:ns&&(br.datasource={uid:ns.uid,type:ns.type})),br});return Aa.queries=Fs?await Promise.all(Fs):[],Aa},Qa=Qe?.filter(ws=>ws.hide!==Rc.zL.hideVariable),Ia=s.createElement("h2",{className:$n.modalHeaderTitle},"Create recorded query",s.createElement(Hu,{href:"https://grafana.com/docs/grafana/latest/enterprise/recorded-queries/#create-a-recorded-query",trackingSource:"modal-title"})),$a=yn!=="success"?s.createElement("div",{"aria-label":"Test the recorded query"},s.createElement(u.I,{name:"sync"})):void 0,Ys=yn==="success"?s.createElement(ce.$n,{type:"button",variant:"primary",onClick:pa,"aria-label":"Close recording query button"},"Close"):s.createElement(ce.$n,{type:"button",variant:"secondary",onClick:pa,fill:"outline","aria-label":"Cancel recording query button"},"Cancel"),lr=()=>{switch(yn){case"info":return kn===""?s.createElement(s.Fragment,null):s.createElement(s.Fragment,null,"Results:",s.createElement("pre",null,kn));default:return s.createElement(s.Fragment,null,kn)}};return s.createElement(s.Fragment,null,s.createElement(fg.q,{title:"Create recorded query",icon:"record-audio",onClick:()=>{Ct(!0),(0,o.rR)("cloud_user_clicked_create_recorded_query_icon")}}),s.createElement(he.a,{isOpen:lt,title:Ia,onDismiss:pa,className:ca.modal},s.createElement(_u.l,{onSubmit:ma,validateOn:"all"},({register:ws,errors:es,control:Aa,getValues:Fs})=>s.createElement(s.Fragment,null,s.createElement(_.D,{label:"Name",description:"Give this query a name",invalid:!!es.name,error:es.name?.message,required:!0},s.createElement(G.p,{...ws("name",{required:{value:!0,message:"Name is required"}}),id:"add-recorded-query-name",autoFocus:!0})),s.createElement(_.D,{label:"Description",description:"Provide a description for this query"},s.createElement(G.p,{...ws("description"),id:"add-recorded-query-desc"})),s.createElement("div",{className:ca.timeSelect},s.createElement(w.xI,{name:"interval",control:Aa,defaultValue:bd[0].value,render:({field:{ref:Ls,value:$s,onChange:ns,...Tr}})=>s.createElement(Bc,{label:"Interval",description:"Decide how often to record this query",value:$s,onChange:ns})})),s.createElement("div",{className:ca.timeSelect},s.createElement(w.xI,{name:"range",control:Aa,defaultValue:(0,ug.Cn)().from,render:({field:{ref:Ls,value:$s,onChange:ns,...Tr}})=>{const br=s.createElement(s.Fragment,null,"Select this query's relative time range",s.createElement(Hu,{href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls/#time-units-and-relative-ranges",trackingSource:"time-range"})),Fi=s.createElement(ms.J,{description:br},"Relative Time Range *");return s.createElement(_.D,{label:Fi,invalid:!!es.range,error:es.name?.message,required:!0},s.createElement(mg.N,{timeRange:{from:$s,to:0},onChange:cl=>ns(cl.from)}))}})),Qa?.length>0?s.createElement(_.D,{label:"Template variables",description:"Select a value for each template variable"},s.createElement(s.Fragment,null,Qa.map(Ls=>{const{picker:$s,setValue:ns}=Lc.B.get(Ls.type);return s.createElement(j.I,{label:Ls.name,key:Ls.name,labelWidth:16},s.createElement($s,{onVariableChange:Tr=>{(0,Zl.SP)(Tr)&&!(0,Ed.R)(Tr.current)&&ns(Tr,Tr.current)},variable:Ls,readOnly:!1}))}))):null,s.createElement(_.D,{label:"Count query results",description:s.createElement(s.Fragment,null,"Count the rows returned from this query",s.createElement(Hu,{href:"https://grafana.com/docs/grafana/latest/enterprise/recorded-queries/#create-a-recorded-query",trackingSource:"count-field"}))},s.createElement(H.d,{...ws("isCount"),id:"add-recorded-query-count"})),s.createElement(z.F,{className:ca.testQuery,severity:yn,title:yn==="success"?"Successful":"Test this recorded query",buttonContent:$a,onRemove:yn!=="success"?()=>Ea(Fs()):void 0},lr(),kn==="An unknown issue is preventing the system from processing your query."&&vg(jt)),s.createElement(he.a.ButtonRow,null,Ys,yn!=="success"&&s.createElement(ce.$n,{type:"submit","aria-label":"Start recording query button"},"Start recording query"))))))},vg=k=>{let ve="https://grafana.com/contact";return k&&k.slug&&k.lid&&(ve=`https://grafana.com/orgs/${k.slug}/tickets?support=licensing&licenseId=${k.lid}`),s.createElement(s.Fragment,null,"To submit a support ticket to Grafana Labs, complete the ",s.createElement("a",{href:ve},"Contact Grafana Labs"))},Xl=k=>({modal:(0,B.css)`
      width: 550px;
    `,testQuery:(0,B.css)`
      margin-top: ${k.spacing(3)};
    `,timeSelect:(0,B.css)`
      width: 50%;
    `,docsLink:(0,B.css)`
      margin-left: ${k.spacing(.5)};
    `}),Yr=pg(hg),Uc=()=>{const ve=Hi.M_.getState().recordedQueries.prometheusWriteTarget;return!!ve?.data_source_uid&&!!ve?.remote_write_path};function Jr(){(0,n.a)("recordedqueries")&&a.$?.recordedQueries?.enabled&&(r.contextSrv.user.orgRole!==""&&(0,Hi.JD)(zu()),Wu.d.addExtraRenderAction(ve=>Uc()&&(ve.dataSource?.meta.backend||(0,Ac.s9)(ve.dataSource))?s.createElement(Yr,{...ve}):null),Wu.m.addExtraRenderAction(ve=>Uc()?s.createElement(vd,{...ve}):null))}var Gu=e(39419),cp=e(76442);const dp=()=>{const k=(0,W.of)(up);return s.createElement(cp.c,{className:k.cta,message:"No recorded queries defined",footer:s.createElement("span",{key:"proTipFooter"},s.createElement(u.I,{name:"rocket"}),"ProTip: ","You can record queries from the query editor."),callToActionElement:s.createElement(s.Fragment,null)})},up=k=>({cta:(0,B.css)`
      text-align: center;
    `});function mp(k){return{navModel:(0,gn.tc)(k.navIndex,"recordedQueries"),recordedQueries:ku(k.recordedQueries),isLoading:k.recordedQueries.isLoading}}const fp={getRecordedQueriesAsync:fd,updateRecordedQuery:gd,deleteRecordedQuery:Rl},Fp=(0,U.connect)(mp,fp),Wp=({navModel:k,isLoading:ve,recordedQueries:Be,getRecordedQueriesAsync:Qe,updateRecordedQuery:lt,deleteRecordedQuery:Ct})=>{(0,s.useEffect)(()=>{Qe()},[Qe]);const jt=(0,W.of)(Eg),[pn,yn]=(0,s.useState)(),Un=Be.map(Vn=>{const $n=[s.createElement(ce.$n,{key:"toggle-recorded-query-active",onClick:async()=>{await lt({...Vn,active:!Vn.active})},variant:Vn.active?"secondary":"primary"},Vn.active?"Pause recording":"Resume recording"),s.createElement(ce.$n,{key:"delete-recorded-query","aria-label":"Delete recorded query",onClick:()=>yn(Vn),variant:"destructive"},"Delete")];return s.createElement(ud,{key:Vn.id,recordedQuery:Vn,buttons:$n})}),kn=()=>ve?s.createElement(Gu.A,null):Un.length===0?s.createElement(dp,null):Un;return s.createElement(hs.Y,{navModel:k},s.createElement(hs.Y.Contents,null,s.createElement("div",{className:jt.header},s.createElement(ce.z9,{icon:"cog",href:"/recorded-queries/write-target"},"Edit remote write target")),kn(),pn&&s.createElement(nn.u,{isOpen:!0,icon:"trash-alt",title:"Delete",body:s.createElement("div",null,"Are you sure you want to delete '",pn.name,"'?"),confirmText:"Delete",onDismiss:()=>yn(void 0),onConfirm:async()=>{await Ct(pn),yn(void 0)}})))},Eg=k=>({header:(0,B.css)`
      display: flex;
      justify-content: flex-end;
      margin-bottom: ${k.spacing(1)};
    `,title:(0,B.css)`
      margin-bottom: 0;
      width: 100%;
    `}),yg=Fp(Wp);function gp(k){return{navModel:(0,gn.tc)(k.navIndex,"recordedQueries"),prometheusWriteTarget:rg(k.recordedQueries)}}const pp={getPrometheusWriteTarget:zu},bg=(0,U.connect)(gp,pp),hp=({navModel:k,prometheusWriteTarget:ve,getPrometheusWriteTarget:Be})=>{const[Qe,lt]=(0,s.useState)(),[Ct,jt]=(0,s.useState)(ve?.remote_write_path),pn=(0,W.of)(Ep),{register:yn,handleSubmit:Un}=(0,w.mN)({defaultValues:ve});(0,s.useEffect)(()=>{Be()},[Be]),(0,s.useEffect)(()=>{(async()=>{if(ve){const ca=await(0,vl.l)().getInstanceSettings(ve.data_source_uid);lt(ca)}})()},[ve]);const kn=$n=>{vp(Qe?.uid,$n.remote_write_path)},Vn=s.createElement("span",null,"Select the data source where metrics will be written",s.createElement("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/recorded-queries/#remote-write-target",className:pn.docsLink,target:"_blank",rel:"noreferrer"},s.createElement(u.I,{name:"info-circle"})));return s.createElement(hs.Y,{navModel:k},s.createElement(hs.Y.Contents,null,s.createElement("form",{key:ve?.data_source_uid,onSubmit:Un(kn),style:{maxWidth:"600px"}},s.createElement(_.D,{label:Vn},s.createElement(Wo.s,{onChange:lt,current:Qe?.name,placeholder:"Select a data source",type:"prometheus",noDefault:!0,alerting:!0,"aria-label":"Write target config select data source"})),s.createElement(_.D,{label:"Remote write path"},s.createElement(G.p,{...yn("remote_write_path"),onChange:$n=>jt($n.currentTarget.value),placeholder:"/api/v1/write","aria-label":"Write target config remote write path"})),s.createElement(ce.$n,{disabled:!Ct||!Qe,type:"submit","aria-label":"Write target config save"},"Save"))))};function vp(k,ve){sg({data_source_uid:k,remote_write_path:ve}).then(()=>{dd.A.emit(el.r1.alertSuccess,["Prometheus remote write target created"])}).catch(Be=>{dd.A.emit(el.r1.alertError,[Be.data.message])})}const Ep=k=>({docsLink:(0,B.css)`
      margin-left: ${k.spacing(1)};
    `}),yp=bg(hp);var bp=e(76323),ju=e(1702),Nc=e(22699),Dd=e(58441),Ui=e(76885),Bl=e(74856),Qu=e(24283),Dg=e(25304);const Yu=({dashboard:k,onDismiss:ve})=>{const Be=(0,W.of)(wc),Qe=()=>{const jt=Ui.kM.toUrlParams((0,Dg.z)()),pn=Ui.kM.toUrlParams((0,Bl.jG)().timeRangeForUrl()),yn=k instanceof Qu.H$?k?.state.uid:k?.uid,Un=k instanceof Qu.H$?k?.state.title:k?.title;return`?${jt}&${pn}&db-uid=${yn}&db-name=${Un}`};if(!(0,n.a)("reports.creation"))return s.createElement("div",{className:Be.container},s.createElement(Zn.Iz,{featureName:"reporting",featureId:"reporting-tab"}),s.createElement(Zn.ep,{image:"reporting-email.png",featureName:"reporting",featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/reporting",description:"Reporting allows you to automatically generate PDFs from any of your dashboards and have Grafana email them to interested parties on a schedule."}));function Ct(){(0,o.rR)("dashboards_sharing_report_create_clicked"),ve&&ve()}return s.createElement(s.Fragment,null,(0,_n.z5)()&&s.createElement("div",{className:Be.highlight},s.createElement(Zn.Iz,{featureId:"reporting-tab",eventVariant:"trial",featureName:"reporting",text:"Create unlimited reports during your trial of Grafana Pro."}),s.createElement("h3",null,"Get started with reporting"),s.createElement("h6",null,"Reporting allows you to automatically generate PDFs from any of your dashboards and have Grafana email them to interested parties on a schedule.")),s.createElement(ce.z9,{href:`reports/new/${Qe()}`,onClick:Ct,className:Be.button},"Create report using this dashboard"),(0,_n.z5)()&&s.createElement(ce.z9,{fill:"text",href:"https://grafana.com/docs/grafana/latest/enterprise/reporting"},"Learn more"))},wc=k=>({container:(0,B.css)`
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    `,button:(0,B.css)`
      margin-right: ${k.spacing(2)};
    `,highlight:(0,B.css)`
      margin-bottom: ${k.spacing(3)};

      h6 {
        font-weight: ${k.typography.fontWeightLight};
      }
    `});var Pd=e(17624);const Cd="/public/img/grafana_icon.svg",Sd="https://grafana.com/static/assets/img/grafana_logo_lockup_ltbg.png",Ci="/reports",Ju="api/reports/images/",ql=2,Td={1:{label:"Zoom in",style:{transform:"translateX(-10%)"}},2:{label:"Standard"},3:{label:"Zoom out",style:{width:"100%",left:"91%"}}};var Zu=e(28676),Pg=e(34214),Xu=e(72401);const Md=(k,ve={hour:0,minute:0},Be)=>{const Qe=`${ve.hour}:${ve.minute}:00`,lt=typeof k=="string"?Gi(k):k,Ct=new Date(`${(0,Os.KQ)(lt).format("YYYY/MM/DD")} ${Qe}`),jt=(0,Zi.LE)(Ct.getTime(),{timeZone:Be,format:"Z"});return Cg((0,Os.KQ)(Ct).format())+jt},Cg=k=>k.includes("Z")?k.replace("Z",""):k.slice(0,-6),Gi=k=>k?(0,Os.KQ)(k.split("T")[0]).toDate():"",ec=k=>String(k).length===1?`0${k}`:String(k),tc=k=>{if(!k)return{hour:0,minute:0};const ve=k.match(/T(\d+):(\d+)/);if(ve){const[,Be,Qe]=ve;return{hour:parseInt(Be,10),minute:parseInt(Qe,10)}}return{hour:0,minute:0}},Dp=k=>k?dateTime(k).isBefore(dateTime()):!1,Fc=(k,ve)=>{if(!k)return{time:void 0,date:void 0};const{hour:Be,minute:Qe}=tc(k);return{date:(0,Zi.LE)(k,{format:"MMMM DD, YYYY",timeZone:ve??""}),time:`${ec(Be)}:${ec(Qe)}`}},Sg=k=>{if(!k.from||!k.to)return"Dashboard time range";const ve=parseInt(k.from,10),Be=parseInt(k.to,10);return!isNaN(ve)&&!isNaN(Be)?(0,al.describeTimeRange)({from:(0,Os.KQ)(ve),to:(0,Os.KQ)(Be)}):(0,al.describeTimeRange)(k)},jo=k=>!k||!k.from||!k.to,Tg=k=>[29,30,31].includes(k);var Mg=e(75096);const nc=k=>k?.length?Object.fromEntries(k.map(ve=>{const{getValueForUrl:Be}=Lc.B.get(ve.type),Qe=Be(ve);return[ve.name,Array.isArray(Qe)?Qe:[Qe]]})):{},Pp=k=>{if(!k?.length)return{};const ve=(0,Mg.pY)();return Object.fromEntries(k.map(Be=>{const{name:Qe}=Be.state,lt=ve[Qe],Ct=(Array.isArray(lt)?lt:[lt]).map(jt=>jt?.toString()??"");return[Qe,Ct]}))},Cp=(k,ve,Be)=>!ve||!Object.keys(ve).length?k.map(Qe=>({...Qe,usedInRepeat:Be?.has(Qe.name)})):k.map(Qe=>{const lt=ve[Qe.name];if(!lt||!(0,Zl.SP)(Qe))return Qe;const Ct=lt.map(pn=>Qe.options.find(yn=>yn.value===pn)||{text:pn,value:pn}).filter(Boolean),jt="multi"in Qe&&Qe.multi;return{...Qe,usedInRepeat:Be?.has(Qe.name),current:{...Qe.current,text:jt?Ct.map(pn=>pn?.text):Ct[0].text,value:jt?Ct.map(pn=>pn?.value):Ct[0].value},options:Qe.options.map(pn=>({...pn,selected:typeof pn.value=="string"&&lt.includes(pn.value)}))}}),Sp=()=>{const k="var-",ve=new URLSearchParams(window.location.search),Be={};for(const[Qe,lt]of ve.entries())if(Qe.startsWith(k)){const Ct=Qe.replace(k,"");Be[Ct]=[...Be[Ct]||[],lt]}return Be},xg=k=>k.some(ve=>(0,Zl.P4)(ve)&&ve.refresh===Rc.CO.onTimeRangeChanged),ac=(k,ve,Be)=>{const Qe=vs(k,ve,Be);return Qe&&Qe.usedInRepeat},vs=(k,ve,Be)=>Be.find(Qe=>"current"in Qe&&Qe.current.value?Qe.current.value.length===1&&Qe.current.value[0]===k&&Qe.type===ve:!1),yl=()=>{if(!window.Intl)return"";const k=window.Intl.DateTimeFormat();if(!k.resolvedOptions)return"";const ve=k.resolvedOptions();return ve.timeZone?ve.timeZone:""},sc={from:"",to:"",raw:{from:"",to:""}},qu={id:0,name:"",recipients:"",replyTo:"",message:`Hi, 
Please find attached a PDF status report. If you have any questions, feel free to contact me!
Best,`,dashboardId:void 0,dashboardName:"",dashboards:[{dashboard:void 0,timeRange:sc.raw}],schedule:{frequency:D.Weekly,timeZone:yl()},formats:[M.PDF],scaleFactor:ql,options:{orientation:"landscape",layout:"grid",timeRange:sc.raw},enableDashboardUrl:!0,state:T.Scheduled},pi={reports:[],report:qu,hasFetchedList:!1,hasFetchedSingle:!1,searchQuery:"",reportCount:0,isLoading:!0,isUpdated:!1,visitedSteps:[],settings:{branding:{reportLogoUrl:"",emailLogoUrl:"",emailFooterMode:S.SentBy,emailFooterText:"",emailFooterLink:""}}},xd=(0,un.Z0)({name:"reports",initialState:pi,reducers:{reportsLoaded:(k,ve)=>({...k,reports:ve.payload,reportCount:ve.payload.length,hasFetchedList:!0}),reportLoaded:(k,ve)=>({...k,report:ve.payload,hasFetchedSingle:!0,isLoading:!1}),updateReportProp:(k,ve)=>({...k,isUpdated:!0,report:ve.payload}),clearReportState:k=>({...k,isUpdated:!1,visitedSteps:[],report:qu}),reportLoadingBegin:k=>({...k,isLoading:!0}),reportLoadingEnd:k=>({...k,isLoading:!1}),testEmailSendBegin:k=>({...k,testEmailIsSending:!0}),testEmailSendEnd:k=>({...k,testEmailIsSending:!1}),setLastUid:(k,ve)=>({...k,lastUid:(0,Mg.q4)(ve.payload)}),addVisitedStep:(k,ve)=>({...k,visitedSteps:[...k.visitedSteps,...ve.payload]})}}),{clearReportState:Od,reportLoaded:Id,reportsLoaded:Cr,updateReportProp:sl,reportLoadingBegin:Og,reportLoadingEnd:rc,testEmailSendBegin:Ad,testEmailSendEnd:rl,setLastUid:Ig,addVisitedStep:em}=xd.actions,nm={reports:xd.reducer},bl="api/reports";function Ul(){return async k=>{const ve=await(0,Qt.AI)().get(bl);k(Cr(ve))}}function Rd(k,ve,Be){return async Qe=>{const lt=await(0,Zu.n)().getDashboardDTO(k),Ct=new Pg.G(lt.dashboard,lt.meta),jt=Dl(Ct.panels);if(xg(Ct.templating.list)){const yn=jo(Be)?Ct?.time:Be;(0,Bl.jG)().setTime(yn)}const pn=Cp(Ct.templating.list,ve||nc(Ct.templating.list),jt);await Qe((0,Xu._q)(lt.dashboard.uid,{...Ct,templating:{list:pn}})),Qe(Ig(k))}}function Dl(k,ve=new Set){return k.forEach(Be=>{Be.repeat&&ve.add(Be.repeat),Be.panels&&Dl(Be.panels,ve)}),ve}function Ld(k){return async ve=>{ve(Og());try{const Be=await(0,Qt.AI)().get(`${bl}/${k}`);Be.dashboards||(Be.dashboards=[{dashboard:{uid:Be.dashboardUid,id:Be.dashboardId,name:Be.dashboardName},reportVariables:Be.templateVars,timeRange:Be.options.timeRange}]);for(const Qe of Be.dashboards)Qe.dashboard.uid&&await ve(Rd(Qe.dashboard.uid,Qe.reportVariables,Qe.timeRange));ve(Id(Be))}catch{ve(rc())}}}function Ag(k){return ve=>(ve(Ad()),(0,Qt.AI)().post(`${bl}/test-email/`,k).finally(()=>ve(rl())))}function am(k){return async ve=>{await(0,Qt.AI)().delete(`${bl}/${k}`),ve(Ul())}}function Bd(k){return async()=>{try{await(0,Qt.AI)().post(bl,k)}catch(ve){throw ve}}}function Wc(k,ve){return async Be=>{const Qe=["hour","minute","day"];k={...k,schedule:Object.fromEntries(Object.entries(k.schedule).filter(([lt,Ct])=>!Qe.includes(lt)))},await(0,Qt.AI)().put(`${bl}/${k.id}`,k),ve&&Be(Ul())}}const Rg=k=>(0,We.upperFirst)(k.map(ve=>{switch(ve){case M.CSV:case M.PDF:return ve.toUpperCase();case M.Image:return"embedded image";case M.PDFTablesAppendix:return"PDF tables appendix";case M.PDFTables:return"PDF tables"}}).join(", ")),Ni=(k={})=>{const{time:ve,startDate:Be,endDate:Qe,endTime:lt,timeZone:Ct,frequency:jt,dayOfMonth:pn,workdaysOnly:yn,intervalFrequency:Un,intervalAmount:kn,sendTime:Vn}=k,$n=!ve&&Be?tc(String(Be)):ve,ca=Be&&Vn!=="now"?Md(Be,$n,Ct):"",pa=Qe&&![D.Once,D.Never].includes(jt)?Md(Qe,lt,Ct):"",va={frequency:jt,timeZone:Ct,workdaysOnly:yn,intervalFrequency:Un,intervalAmount:kn?parseInt(kn,10):0,startDate:ca,endDate:pa,dayOfMonth:pn===O?O:""};return Object.fromEntries(Object.entries(va).filter(([ma,Ea])=>Ea))};function oc(k){const ve=["th","st","nd","rd"],Be=k%100;return k+(ve[(Be-20)%10]||ve[Be]||ve[0])}const sm=(k,ve=E.Hours)=>k===D.Custom&&ve===E.Hours,ic=(k,ve=E.Hours)=>[D.Hourly,D.Daily].includes(k)||sm(k,ve);function rm({startDate:k,endDate:ve,intervalFrequency:Be=E.Hours,intervalAmount:Qe=2,frequency:lt,dayOfMonth:Ct,timeZone:jt,workdaysOnly:pn}){if(!k)return"";const yn="en-US",{hour:Un,minute:kn}=tc(k),Vn=ec(kn),$n=ec(Un),ca=(0,Os.KQ)(Gi(k)).locale(yn).format("dddd"),pa=Ct==="last"?"last":oc(Gi(k).getDate());let va,ma;const Ea=(0,Pd.t)(Date.now(),jt),ts=`at ${$n}:${Vn}${Ea?` ${Ea}`:""}`,Qa=pn&&ic(lt,Be)?", Monday to Friday":"";if(ve){const Ia=(0,Os.KQ)(Gi(k)).locale(yn).format("LL"),$a=(0,Os.KQ)(Gi(ve)).locale(yn).format("LL");$a!==Ia?va=`${Ia} - ${$a}`:va=Ia}switch(lt){case D.Monthly:ma=`Monthly on the ${pa} day ${ts}`;break;case D.Weekly:ma=`Every ${ca} ${ts}`;break;case D.Daily:ma=`Daily ${ts}`;break;case D.Hourly:ma=`Hourly at minute ${Vn}`;break;case D.Custom:ma=`Every ${Qe} ${Be}`;break;case D.Once:ma=`Once on ${(0,Os.KQ)(Gi(k)).locale(yn).format("LL")}`;break;case D.Never:ma="Never";break;default:ma=""}return va&&ma?`${ma}, ${va}${Qa}`:(lt===D.Custom&&(ma+=`, ${Be===E.Hours?`from ${$n}:${Vn}${Ea?` ${Ea}`:""}`:`from ${(0,Os.KQ)(Gi(k)).locale(yn).format("LL")}`}`),ma+Qa)}const Lg=new Map([[D.Monthly,"month"],[D.Daily,"day"],[D.Weekly,"week"],[D.Hourly,"hour"]]),om=k=>{const{frequency:ve,intervalFrequency:Be=E.Hours,intervalAmount:Qe="2"}=k;if(ve===D.Never)return"The report will not be sent.";const lt=k.workdaysOnly?", Monday to Friday.":".",Ct=[];if(!k.startDate){Ct.push("The report will be sent immediately after it is saved");const pn=ve===D.Custom?`${Qe} ${Be}`:Lg.get(ve);return pn&&Ct.push(`and will be sent every ${pn}`),Ct.join(" ")+lt}const jt=rm(Ni(k));return jt&&Ct.push(`The report will be sent: ${jt}.`),Ct.join(" ")},Tp=k=>{const ve=pi.report.schedule;return Object.keys(ve).length!==Object.keys(k).length?!0:Object.entries(ve).some(([Be,Qe])=>Qe!==k[Be])},lc=()=>{if(!window.location.search)return null;const k=new URLSearchParams(window.location.search);return{timeRange:{to:k.get("to")||"",from:k.get("from")||""},dashboard:{uid:k.get("db-uid")||"",name:k.get("db-name")||""},variables:Sp()}},Bg=k=>{if(k.id)return k;const ve=lc();if(!ve)return k;const{timeRange:Be,dashboard:Qe,variables:lt}=ve;let Ct=[...initialState.report.dashboards];return Be?.from&&Be?.to&&(Ct[0]={...Ct[0],timeRange:{...Be,raw:Be}}),Qe.name&&Qe.uid&&(Ct[0]={...Ct[0],dashboard:{uid:Qe.uid,name:Qe.name}}),lt&&Object.keys(lt).length&&(Ct[0]={...Ct[0],reportVariables:lt}),{...k,dashboards:Ct}},Si=()=>{const k=new URLSearchParams(window.location.search),ve=k.get("to"),Be=k.get("from");return Be&&ve?{from:Be,to:ve}:null},ji=(k,ve)=>`${Ci}/${k}${ve?"/"+ve:""}`,im=k=>ve=>`${Ci}/${ve}${k?"/"+k:""}`,Ug=k=>Array.isArray(k)?k?.length:!0,lm=k=>{const ve=[{step:C.SelectDashboard,fields:["dashboards"]},{step:C.FormatReport,fields:["formats"]},{step:C.Share,fields:["name","recipients"]}],Be=!k.dashboards?.[0]?.dashboard?.uid;return Wr.reduce((Qe,lt)=>{if(Qe[lt.id]={valid:!0},lt.id===C.SelectDashboard)return Qe[C.SelectDashboard].valid=!Be,Qe;{const Ct=ve.find(jt=>jt.step===lt.id)?.fields;return Ct&&(Qe[lt.id].valid=Ct.every(jt=>k[jt]&&Ug(k[jt]))),Qe}},{})},Nl=(k,ve)=>{const Be=lm(k);return ve?!Be[ve].valid:Object.values(Be).some(Qe=>!Qe.valid)},Kc=({uid:k,name:ve,className:Be})=>{const Qe=(0,W.of)(Qi);return k?s.createElement("a",{href:`${a.$.appUrl}d/${k}`,className:(0,B.cx)(Qe.link,Be),target:"_blank",rel:"noreferrer"},ve||"View dashboard"):null},Qi=k=>({link:(0,B.css)`
      display: inline-block;
      color: ${k.colors.text.link};
      margin-top: ${k.spacing(1)};
      font-size: ${k.typography.bodySmall.fontSize};

      :hover {
        text-decoration: underline;
      }
    `}),$c=k=>{if(!k)return Wr[0];const ve=Wr.findIndex(Be=>Be.id===k);return ve===Wr.length-1?Wr[ve]:Wr[ve+1]},cm=k=>{if(!k||k===Wr[0].id)return;const ve=Wr.findIndex(Be=>Be.id===k);return Wr[ve-1]},Ng=(k,ve)=>{const Be=cm(k);Be&&Be.id!==k&&Ne.Ny.push(ji(Be.id,ve))},Bo=(0,s.forwardRef)(({activeStep:k,disabled:ve,reportId:Be},Qe)=>{const lt=(0,W.of)(bo),Ct=(0,s.useRef)(null),jt=cm(k),pn=$c(k),yn=pn.id===k;return(0,s.useImperativeHandle)(Qe,()=>({click:()=>{Ct.current?.click()}})),s.createElement("div",{className:lt.buttonRow},s.createElement("div",{className:lt.buttonRowInner},s.createElement("div",null,jt&&s.createElement(ce.$n,{variant:"secondary",onClick:()=>Ng(k,Be)},"Previous: ",jt.name),!yn&&s.createElement(ce.$n,{ref:Ct,disabled:ve,type:"submit"},`Next: ${pn.name}`))))});Bo.displayName="ButtonRow";const bo=k=>({buttonRow:(0,B.css)`
      display: flex;
      padding: ${k.spacing(2,0,.5,0)};
      border-top: 1px solid ${k.colors.border.weak};
      width: 100%;
      background-color: ${k.colors.background.primary};
      button {
        &:first-of-type {
          margin-right: ${k.spacing(2)};
        }
        &:last-of-type {
          margin-right: 0;
        }
      }
    `,buttonRowInner:(0,B.css)`
      display: flex;
      justify-content: space-between;
      width: 100%;
    `}),cc=k=>k?k.frequency===D.Never?"Save and exit":k.startDate?"Schedule send":"Send now":"Save report",dm=k=>{const ve=k.state,Be=k.schedule.frequency===D.Never,Qe=Be||[T.Draft,T.Expired,T.Paused].includes(ve),lt=Be||[T.Expired].includes(ve);return{isNever:Be,showPlay:Qe,disableEdit:lt,reportState:ve}},dc=k=>{let ve=T.Scheduled;return k===T.Expired?ve=k:k!==T.Paused&&(ve=T.Paused),ve},wg=k=>{const{report:ve}=k.reports;return{report:ve}},hi={loadReport:Ld,deleteReport:am,updateReport:Wc},Mp=(0,U.connect)(wg,hi),um=({report:k,loadReport:ve,deleteReport:Be,updateReport:Qe,disabled:lt})=>{const Ct=(0,W.of)(go),[jt,pn]=(0,s.useState)(!1),yn=Pi.TP.hasPermission(N.ReportingDelete),Un=Pi.TP.hasPermission(N.ReportingWrite),{showPlay:kn,disableEdit:Vn,reportState:$n}=dm(k),ca=async()=>{const va=dc($n);await Qe({...k,state:va}),k.id&&ve(k.id)},pa=()=>{Be(k.id),pn(!1),Ne.Ny.push(Ci)};return s.createElement("div",{className:Ct.editActions},s.createElement(ce.z9,{href:ji(C.SelectDashboard,k.id),type:"button",disabled:!Un},"Edit report"),s.createElement(ce.$n,{type:"button",variant:"secondary",disabled:Vn||!Un||lt,onClick:ca},kn?$n===T.Draft?cc(k.schedule):"Resume":"Pause"),s.createElement(_t.K,{variant:"destructive","aria-label":"Delete report",tooltip:"Delete",name:"trash-alt",disabled:!yn,onClick:()=>pn(!0)}),s.createElement(nn.u,{isOpen:jt,title:"Delete report",body:"Are you sure you want to delete this report?",confirmText:"Delete",onConfirm:pa,onDismiss:()=>pn(!1)}))},go=k=>({editActions:(0,B.css)`
      display: flex;
      align-items: center;
      justify-content: flex-end;
      width: 100%;
      margin-bottom: ${k.spacing(3)};

      button,
      a {
        margin-left: ${k.spacing(2)};
      }
    `}),Fr=Mp(um),wl=(0,s.forwardRef)(({saveDraft:k,children:ve,existingReport:Be,disabled:Qe,activeStep:lt,onDiscard:Ct,schedule:jt},pn)=>{const yn=(0,W.of)(po),Un=$c(lt),kn=(0,s.useRef)(null),Vn=Un.id===lt,$n=Be?"Update report":cc(jt);return(0,s.useImperativeHandle)(pn,()=>({click:()=>{kn.current?.click()}})),s.createElement("div",{className:yn.container},Vn&&s.createElement(ce.$n,{ref:kn,disabled:Qe,type:"submit"},$n),s.createElement(ce.$n,{variant:"secondary",onClick:k},"Save as draft"),ve,s.createElement(ce.$n,{variant:"destructive",fill:"outline",onClick:Ct},"Discard"))});wl.displayName="PageActions";const po=k=>({container:(0,B.css)`
      display: flex;
      justify-content: flex-end;
      width: 100%;

      & > button,
      & > a {
        margin-right: ${k.spacing(3)};
      }
    `}),ni=k=>{const{report:ve,isUpdated:Be,visitedSteps:Qe}=k.reports;return{existingReport:!!ve.id,isUpdated:Be,report:ve,visitedSteps:Qe}},Pl={addVisitedStep:em,clearReportState:Od,createReport:Bd,updateReport:Wc},Fg=(0,U.connect)(ni,Pl),Vc=({activeStep:k,addVisitedStep:ve,children:Be,clearReportState:Qe,confirmRedirect:lt,createReport:Ct,disabled:jt,editMode:pn,existingReport:yn,getFormData:Un,isUpdated:kn,onSubmit:Vn,report:$n,reportId:ca,updateReport:pa,visitedSteps:va,pageActions:ma})=>{const Ea=(0,W.of)(Wg),ts=$c(k),Qa=(0,se.W6)(),Ia=(0,s.useRef)(null),[$a,Ys]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(Tr=>{Tr===Wr[Wr.length-1].id?ve(Wr.map(br=>br.id)):ve([Tr])})(k)},[k,ve]),(0,s.useEffect)(()=>{$a&&Qa.push(Ci)},[$a,Qa]);const lr=ns=>{ns.preventDefault();const Tr=ji(ts.id,ca);Vn(),Qa.push(Tr)},ws=async()=>{if(Un){const Tr=Un();$n={...$n,...Tr}}Ys(!0),await($n.id?pa:Ct)({...$n,state:T.Draft}),(0,o.rR)("reports_draft_saved",{step:k,state:$n.id?$n.state:"new"}),Qe()},es=()=>{Qe(),(0,o.rR)("reports_report_abandoned",{namePopulated:!!$n.name,recipientsPopulated:!!$n.recipients,replyToPopulated:!!$n.replyTo,numberOfDashboardsSelected:$n.dashboards.length,scheduleCustomized:Tp($n.schedule)})},Aa=ns=>!Wr.map(br=>ji(br.id,ca)).includes(ns.pathname),Fs=()=>{const ns=Wr[Wr.length-1].id;k!==ns&&Ia.current?.click()},Ls=()=>{Qa.push(Ci)},$s=(0,s.useMemo)(()=>lm($n),[$n]);return s.createElement("form",{onSubmit:lr,className:Ea.container},pn?s.createElement(Fr,{disabled:jt}):s.createElement(wl,{saveDraft:ws,existingReport:yn,ref:Ia,activeStep:k,disabled:jt,onDiscard:Ls,schedule:$n.schedule},ma),s.createElement(me,{confirmRedirect:!$a&&!!(lt||kn),onDiscard:es,onLocationChange:Aa}),s.createElement("div",{className:Ea.inner},!pn&&s.createElement(Pe,{activeStep:k,onStepChange:Fs,getNextUrl:im(ca),visitedSteps:va,steps:Wr,validationResults:$s}),s.createElement("div",{className:Ea.content},Be,!pn&&s.createElement(Bo,{ref:Ia,activeStep:k,disabled:jt,reportId:ca}))))},Wg=k=>({container:(0,B.css)`
      display: flex;
      flex-direction: column;
      height: 100%;
      align-content: center;
    `,inner:(0,B.css)`
      display: flex;
      justify-content: flex-start;
      flex-direction: column;
      flex: 1 0 auto;
    `,content:(0,B.css)`
      padding-bottom: ${k.spacing(3)};
      width: min(70%, 800px);
    `}),uc=Fg(Vc),mm=k=>{const{report:ve,isUpdated:Be}=k.reports;return{report:ve,isUpdated:Be}},Kg={createReport:Bd,updateReport:Wc,clearReportState:Od},$g=(0,U.connect)(mm,Kg)(({report:k,createReport:ve,updateReport:Be,clearReportState:Qe,isUpdated:lt,reportId:Ct})=>{const{formats:jt,options:pn,schedule:yn,dashboards:Un}=k,{handleSubmit:kn,formState:{isSubmitSuccessful:Vn}}=(0,w.mN)(),$n=(0,W.of)(fm),ca=!!Ct&&!lt,pa=Nl(k),{time:va,date:ma}=Fc(yn.startDate,yn.timeZone),{time:Ea,date:ts}=Fc(yn.endDate,yn.timeZone);(0,s.useEffect)(()=>{Vn&&Ne.Ny.push(Ci)},[Vn]);const Qa=async()=>{const lr=k.id?Be:ve;if(k.state===T.Draft){const ws=k.schedule.frequency===D.Never?T.Never:T.Scheduled;k={...k,state:ws}}await lr(k),(0,o.rR)("reports_report_submitted",{replyToPopulated:!!k.replyTo,includesDashboardLink:k.enableDashboardUrl,numberOfDashboardsSelected:k.dashboards.length,templateVariablesSelected:k.dashboards.some(ws=>!!ws.reportVariables),orientation:k.options.orientation,layout:k.options.layout,frequency:k.schedule.frequency,sendTime:k.schedule.startDate?"later":"now",endDate:!!k.schedule.endDate}),Qe()},{orientation:Ia,layout:$a}=pi.report.options,Ys=[{title:"Select dashboard",id:C.SelectDashboard,items:(Un||[]).flatMap((lr,ws,es)=>[{title:`Source dashboard${ws===0?"*":""}`,value:lr.dashboard?.uid?s.createElement(Kc,{name:lr.dashboard.name,uid:lr.dashboard?.uid,className:$n.dashboardLink}):"",id:"name",required:!0},{title:"Template variables",value:s.createElement(Vg,{variables:lr.reportVariables,className:$n.title})},{title:"Time range",value:Sg(lr.timeRange)},...es.length>1&&ws!==es.length-1?[{title:"",value:""}]:[]])},{title:"Format report",id:C.FormatReport,items:[{title:"Preferred format*",value:Rg(jt),id:"formats",required:!0},...jt.includes(M.PDF)?[{title:"PDF orientation",value:(0,We.capitalize)(pn.orientation||Ia)},{title:"PDF layout",value:(0,We.capitalize)(pn.layout||$a)},{title:"Scale factor",value:Td[k.scaleFactor||ql].label}]:[]]},{title:"Schedule",id:C.Schedule,items:[{title:"Recurrence",value:(0,We.capitalize)(yn.frequency)},...yn.frequency===D.Custom?[{title:"Repeat every",value:`${yn.intervalAmount} ${yn.intervalFrequency}`}]:[],...yn.frequency!==D.Never?[{title:"Start date",value:ma||"Now"},{title:"Start time",value:va||"Now"},{title:"End date",value:ts},{title:"End time",value:Ea},{title:"Time zone",value:yn.timeZone?(0,Pd.t)(Date.now(),yn.timeZone):""}]:[],...ic(yn.frequency,yn.intervalFrequency)?[{title:"Send Monday to Friday only",value:yn.workdaysOnly?s.createElement(u.I,{name:"check",size:"xl"}):s.createElement(u.I,{name:"minus",size:"xl"})}]:[],{value:om(k.schedule),title:""}]},{title:"Share",id:C.Share,items:[{title:"Report name*",value:k.name,id:"name",required:!0},{title:"Recipients*",value:k.recipients,id:"recipients",required:!0},{title:"Reply-to-email",value:k.replyTo||"none"},{title:"Message",value:k.message||"none"},{title:"Dashboard link",value:k.enableDashboardUrl?s.createElement(u.I,{name:"check",size:"xl"}):s.createElement(u.I,{name:"minus",size:"xl"})}]}];return s.createElement(uc,{activeStep:C.Confirm,confirmRedirect:!Vn&&lt,disabled:pa,editMode:ca,onSubmit:kn(Qa),reportId:Ct},s.createElement(ne.n,{label:ca?"":"5. Confirm"},Ys.map(lr=>{const ws=Nl(k,lr.id);return s.createElement("div",{className:$n.section,key:lr.title},s.createElement("div",{className:$n.sectionHeader},s.createElement("h5",{className:$n.sectionTitle},lr.title),s.createElement(ce.z9,{variant:ws?"primary":"secondary",fill:"text",href:ji(lr.id,Ct),size:"sm"},"Edit")),lr.items.filter(es=>es.value!==void 0).map((es,Aa)=>{const Fs=!!es.required&&(!es.value||Array.isArray(es.value)&&!es.value.length);return es.title?s.createElement("div",{className:$n.row,key:Aa},s.createElement("div",{className:(0,B.cx)($n.title,Fs&&$n.warning)},es.title,":"),s.createElement("div",{className:(0,B.cx)($n.value,es.value==="none"&&!Fs?$n.textMuted:"")},Fs?s.createElement(u.I,{name:"exclamation-triangle",className:$n.warning}):es.value)):s.createElement("div",{className:(0,B.cx)($n.row,$n.textMuted),key:Aa},es.value)}))})))}),fm=k=>({section:(0,B.css)`
      width: 100%;
      padding: ${k.spacing(3,0)};
      margin-bottom: ${k.spacing(3)};
    `,sectionHeader:(0,B.css)`
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: ${k.spacing(1)};
      border: 1px solid ${k.colors.border.weak};
    `,sectionTitle:(0,B.css)`
      margin: 0;
    `,row:(0,B.css)`
      border: 1px solid ${k.colors.border.weak};
      border-top: none;
      display: flex;
      width: 100%;
      padding: ${k.spacing(1)};
    `,warning:(0,B.css)`
      color: ${k.colors.warning.text};
    `,title:(0,B.css)`
      width: 30%;
      color: ${k.colors.text.secondary};
    `,textMuted:(0,B.css)`
      color: ${k.colors.text.secondary};
    `,value:(0,B.css)`
      width: 70%;
      word-break: break-word;
    `,dashboardLink:(0,B.css)`
      color: ${k.colors.text.primary};
      font-size: ${k.typography.body.fontSize};
      margin-top: 0;
    `}),Vg=({variables:k,className:ve})=>{const Be=(0,W.of)(fm);return!k||!Object.keys(k).length?s.createElement("span",{className:Be.textMuted},"none"):s.createElement(s.Fragment,null,Object.entries(k).map(([Qe,lt])=>s.createElement("span",{key:Qe},s.createElement("span",{className:ve},Qe),": ",lt.join(", "),";"," ")))};var Ud=e(77014),mc=e(13344),fc=e(85858);const gm=k=>fc.isValid(k.from)&&fc.isValid(k.to),zg=k=>!k||!gm(k)?{from:"",to:""}:{to:k.to.valueOf().toString(),from:k.from.valueOf().toString()},pm=k=>{const ve=Fl(k.from),Be=Fl(k.to);return gm({from:ve,to:Be})?{from:ve,to:Be,raw:{from:ve,to:Be}}:sc},Fl=k=>{const ve=parseInt(k,10);return isNaN(ve)?k:(0,Os.yT)(ve)},zc=()=>s.createElement(z.F,{severity:"warning",title:"Not supported"},"The value All in template variables used in repeating rows or panels is not supported in PDF"),kc=k=>k?.length?!k.some(ve=>!!ve.dashboard?.uid):!0,ai=r.contextSrv.hasPermission(N.ReportingWrite)||r.contextSrv.hasPermission(N.ReportingCreate),hm=()=>{const k=a.$.rendererVersion;if(k==="")return null;const Be=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/.exec(k);let Qe="";if(Be&&Be.length>1&&(Qe=Be[1]),Qe==="")return 1;let lt=parseInt(Qe,10);return isNaN(lt)&&(lt=1),lt},vm=k=>{const{report:ve}=k.reports;return{report:ve}},kg={updateReportProp:sl},Ti=(0,U.connect)(vm,kg),_g=new Map([["grid","Display the panels in their positions on the dashboard."],["simple","Display one panel per row."]]),Hg=new Map([[M.PDF,{description:"Attach the report as a PDF"}],[M.PDFTablesAppendix,{description:"Include table data as PDF appendix",dependsOn:M.PDF,hide:!Xo.Ay.featureToggles.pdfTables}],[M.Image,{description:"Embed a dashboard image in the email"}],[M.CSV,{description:"Attach a CSV file of table panel data"}],[M.PDFTables,{description:"Attach a separate PDF of table data",hide:!Xo.Ay.featureToggles.pdfTables}]]),ol=({report:k,updateReportProp:ve,reportId:Be})=>{const Qe=(0,W.of)(Nd),{dashboards:lt,formats:Ct,options:jt,name:pn,scaleFactor:yn=ql}=k||{},{handleSubmit:Un,control:kn,register:Vn,watch:$n,getValues:ca,formState:{isDirty:pa}}=(0,w.mN)({defaultValues:{formats:Ct,scaleFactor:yn,options:{layout:jt.layout,orientation:jt.orientation,timeRange:jt.timeRange}}}),va=$n("options.layout"),ma=$n("options.orientation"),Ea=$n("formats"),ts=$n("scaleFactor"),Qa=hm(),Ia=(0,n.a)("reports.email")&&!kc(k.dashboards),$a=(0,s.useMemo)(()=>{const es=k.dashboards.flatMap(Fs=>Fs.dashboard?.uid?(0,Ll.SS)(Fs.dashboard.uid):[]);return ac(mc.To,"query",es)&&Ea.includes(M.PDF)},[k.dashboards,Ea]),Ys=({formats:es,options:Aa,scaleFactor:Fs})=>{pa&&ve({...k,options:{...k.options,...Aa},formats:es,scaleFactor:Fs})},lr=()=>{const{formats:es,options:Aa,scaleFactor:Fs}=ca();return{options:{...k.options,...Aa},formats:es,scaleFactor:Fs}},ws=()=>{if(kc(lt))return;const es={title:pn,scaleFactor:ts};return ma&&(es.orientation=ma),va&&(es.layout=va),Ea&&Ea.includes(M.PDFTablesAppendix)&&(es.includeTables="true"),es.dashboards=JSON.stringify(lt.map(Aa=>{const{from:Fs,to:Ls}=pm(Aa.timeRange).raw||sc.raw;return{dashboard:{uid:Aa.dashboard?.uid},timeRange:{from:Fs.valueOf().toString(),to:Ls.valueOf().toString()},reportVariables:Aa.reportVariables}})),Ui.kM.appendQueryToUrl("api/reports/render/pdfs/",Ui.kM.toUrlParams(es))};return s.createElement(uc,{activeStep:C.FormatReport,onSubmit:Un(Ys),confirmRedirect:pa,getFormData:lr,reportId:Be,pageActions:[s.createElement(ce.z9,{onClick:()=>Ia&&(0,o.rR)("reports_preview_pdf"),icon:"external-link-alt",href:ws(),size:"xs",target:"_blank",rel:"noreferrer noopener",variant:"secondary",disabled:!Ia,key:"preview"},"Preview PDF")]},s.createElement(ne.n,{label:"2. Format report",disabled:!ai},$a&&s.createElement(zc,null),s.createElement(ne.n,null,s.createElement(ua.B,{direction:"column",alignItems:"start"},[...Hg].map(([es,Aa])=>{const{onChange:Fs,...Ls}=Vn("formats");return!Aa.hide&&(!Aa.dependsOn||Ea.includes(Aa.dependsOn))&&s.createElement(Al.S,{...Ls,hidden:Aa.hide||Aa.dependsOn&&Ea.includes(Aa.dependsOn),key:es,htmlValue:es,label:Aa.description,className:(0,B.cx)(Aa.dependsOn&&Qe.subCheckbox),onChange:$s=>{es==="csv"&&$s.currentTarget.checked&&Qa!==null&&Qa<3&&r.lE.emit(el.r1.alertError,["To export CSV files, you must update the Grafana Image Renderer plugin."]),Fs($s)}})}))),(Ea.includes(M.PDF)||Ea.includes(M.PDFTables))&&s.createElement(ne.n,{label:"Style the PDF"},s.createElement(_.D,{label:"Orientation"},s.createElement(w.xI,{name:"options.orientation",control:kn,render:({field:{ref:es,...Aa}})=>s.createElement(eo.z,{...Aa,options:A,size:"md"})})),s.createElement(_.D,{label:"Layout",description:_g.get(va)},s.createElement(w.xI,{name:"options.layout",control:kn,render:({field:{ref:es,...Aa}})=>s.createElement(eo.z,{...Aa,options:x,size:"md"})})),s.createElement(_.D,{label:"Zoom",description:"Zoom in to enlarge text, or zoom out to see more data (like table columns) per panel.",className:Qe.sliderField},s.createElement(w.xI,{name:"scaleFactor",control:kn,render:({field:{ref:es,value:Aa,...Fs}})=>s.createElement(Ud.A,{...Fs,value:Number(Aa),min:1,max:3,step:1,marks:Td,included:!1})})))))},Nd=k=>({sliderField:(0,B.css)`
      max-width: 350px;
      // Hide Slider input
      input {
        display: none;
      }
    `,subCheckbox:(0,B.css)`
      margin-left: ${k.spacing(2)};
    `}),Gg=Ti(ol);var jg=e(68316),J=e(98239),Ee=e(66070),Ce=e(20333);const Fe=k=>{const{report:ve}=k.reports;return{report:ve}},He={updateReportProp:sl},it=(0,U.connect)(Fe,He),vt=[{label:"Once",value:D.Once},{label:"Hourly",value:D.Hourly},{label:"Daily",value:D.Daily},{label:"Weekly",value:D.Weekly},{label:"Monthly",value:D.Monthly},{label:"Custom",value:D.Custom},{label:"Never",value:D.Never}],Nt=[{label:"hours",value:E.Hours},{label:"days",value:E.Days},{label:"weeks",value:E.Weeks},{label:"months",value:E.Months}],kt=k=>k==="now"&&Tg((0,Os.KQ)().toDate().getDate()),ln=it(({report:k,updateReportProp:ve,reportId:Be})=>{const{handleSubmit:Qe,control:lt,watch:Ct,register:jt,setValue:pn,getValues:yn,formState:{isDirty:Un}}=(0,w.mN)(),{frequency:kn,timeZone:Vn,startDate:$n,endDate:ca,dayOfMonth:pa,intervalAmount:va,intervalFrequency:ma}=k.schedule,Ea=kn===D.Never?"":$n,ts=Ea?"later":"now",Qa={startDate:Ea,sendTime:ts,intervalFrequency:E.Hours,intervalAmount:"2",sendOnLastDayOfMonth:pa===O,...k.schedule},Ia=Ct("schedule",Qa)||{},{frequency:$a,startDate:Ys,endDate:lr,intervalFrequency:ws=E.Hours,dayOfMonth:es,sendOnLastDayOfMonth:Aa,sendTime:Fs=ts,workdaysOnly:Ls}=Ia,$s=(0,W.of)(bn),ns=new Date(Ys),Tr=Zr=>{if(Un){const ur=Ni(Zr.schedule);ve({...k,schedule:ur})}},br=()=>({schedule:Ni(yn().schedule)}),Fi=Zr=>{const ur=Aa&&(0,jg.c)(Zr);pn("schedule.sendOnLastDayOfMonth",ur),pn("schedule.dayOfMonth",ur?O:"")},cl=Zr=>{const ur=(0,Os.KQ)(Ys).endOf("month").toDate();pn("schedule.startDate",ur),pn("schedule.dayOfMonth",Zr?O:"")};return s.createElement(uc,{activeStep:C.Schedule,onSubmit:Qe(Tr),confirmRedirect:Un,getFormData:br,reportId:Be},s.createElement(ne.n,{label:"3. Schedule"},s.createElement(_.D,{label:"Frequency"},s.createElement(w.xI,{defaultValue:kn,name:"schedule.frequency",render:({field:{ref:Zr,onChange:ur,...wr}})=>s.createElement(eo.z,{...wr,fullWidth:!0,options:vt,disabled:!ai,onChange:Uo=>{ic(Uo,ws)||pn("schedule.workdaysOnly",!1),ur(Uo)}}),control:lt})),$a!==D.Never&&s.createElement(_.D,{label:"Time"},s.createElement(w.xI,{control:lt,name:"schedule.sendTime",defaultValue:ts,render:({field:{ref:Zr,onChange:ur,...wr}})=>s.createElement(eo.z,{...wr,onChange:Uo=>{Uo!=="now"&&!Ys?pn("schedule.startDate",(0,Os.KQ)().toDate()):Uo==="now"&&pn("schedule.startDate",""),ur(Uo)},options:[{label:"Send now",value:"now"},{label:"Send later",value:"later"}]})})),s.createElement(s.Fragment,null,$a===D.Custom&&s.createElement(ua.B,null,s.createElement(_.D,{label:"Repeat every"},s.createElement(G.p,{type:"number",min:"2",...jt("schedule.intervalAmount"),placeholder:"e.g. 2",defaultValue:va||2,id:"repeat-frequency"})),s.createElement(_.D,{label:" "},s.createElement(w.xI,{control:lt,defaultValue:Nt.find(Zr=>Zr.value===ma)?.value||E.Hours,render:({field:{ref:Zr,onChange:ur,...wr}})=>s.createElement(h.l6,{...wr,onChange:Uo=>ur(Uo.value),options:Nt,width:16,placeholder:"hours","aria-label":"Custom frequency"}),name:"schedule.intervalFrequency"}))),$a===D.Monthly&&(kt(Fs)||Fs==="later")&&s.createElement(_.D,null,s.createElement(w.xI,{control:lt,defaultValue:es===O,render:({field:{onChange:Zr,...ur}})=>s.createElement(Al.S,{...ur,label:"Send on the last day of month",onChange:wr=>{cl(wr.currentTarget.checked),Zr(wr.currentTarget.checked)}}),name:"schedule.sendOnLastDayOfMonth"}))),s.createElement("div",{className:Fs!=="now"&&$a!==D.Never?"":$s.hidden},s.createElement(ua.B,null,s.createElement(_.D,{label:"Start date"},s.createElement(w.xI,{name:"schedule.startDate",control:lt,defaultValue:Gi(Ea),render:({field:{ref:Zr,onChange:ur,...wr}})=>s.createElement(J.l,{...wr,width:16,placeholder:"Select date","aria-label":"Report schedule start date",closeOnSelect:!0,onChange:Uo=>{const xi=new Date(Uo);Fi(xi),ur(xi)}})})),s.createElement(_.D,{label:"Start time"},s.createElement(w.xI,{name:"schedule.time",render:({field:{onChange:Zr,ref:ur,value:wr,...Uo}})=>s.createElement(Ee.R,{...Uo,value:wr,minuteStep:10,disabled:!ai,onChange:xi=>{xi.isValid()&&Zr({hour:xi.hour?.(),minute:xi.minute?.()})}}),defaultValue:tc($n),control:lt})),s.createElement(s.Fragment,null,s.createElement(_.D,{label:"Time zone"},s.createElement(w.xI,{name:"schedule.timeZone",render:({field:{ref:Zr,...ur}})=>s.createElement(Ce.U,{...ur,width:30,disabled:!ai}),defaultValue:Vn||yl(),control:lt}))))),$a===D.Monthly&&!Aa&&(Tg(ns.getDate())||kt(Fs))&&s.createElement("small",{className:$s.warningText},"Note: some months do not have a"," ",oc(kt(Fs)?(0,Os.KQ)().toDate().getDate():ns.getDate())," day and reports will not be sent on those months. Choose an earlier date or"," ",s.createElement("strong",null,'"Send on the last day of month"')," to send a report at the end of each month."),![D.Once,D.Never].includes($a)&&s.createElement(ua.B,null,s.createElement(_.D,{label:"End date"},s.createElement(w.xI,{name:"schedule.endDate",control:lt,defaultValue:Gi(ca),render:({field:{ref:Zr,...ur}})=>s.createElement(J.l,{...ur,width:16,placeholder:"Does not end","aria-label":"Report schedule end date",minDate:new Date(Ys),closeOnSelect:!0})})),lr&&($a===D.Hourly||sm($a,ws))&&s.createElement(_.D,{label:"End time"},s.createElement(w.xI,{name:"schedule.endTime",render:({field:{onChange:Zr,ref:ur,value:wr,...Uo}})=>s.createElement(Ee.R,{...Uo,value:wr,minuteStep:10,disabled:!ai,onChange:xi=>{xi?.isValid()&&Zr({hour:xi.hour?.(),minute:xi.minute?.()})}}),defaultValue:tc(ca),control:lt}))),ic($a,ws)&&s.createElement(_.D,null,s.createElement(Al.S,{...jt("schedule.workdaysOnly"),label:"Send Monday to Friday only",defaultChecked:Ls})),s.createElement(ua.B,{alignItems:"center"},s.createElement(u.I,{name:"calendar-alt"}),om({...Qa,...Ia}))))}),bn=k=>({warningText:(0,B.css)`
      color: ${k.colors.warning.main};
      display: block;
      margin: -${k.spacing(1)} 0 ${k.spacing(3)} 0;
    `,hidden:(0,B.css)`
      display: none;
    `});var Nn=e(54230),mn=e(59429);const Wn=k=>{const{report:ve}=k.reports;return{report:ve,templating:k.templating.keys}},ba={updateReportProp:sl,initVariables:Rd,cleanUpVariables:Xu._m},oa=(0,U.connect)(Wn,ba),da={dashboard:void 0,timeRange:{from:"",to:"",raw:{from:"",to:""}},reportVariables:{}},Xn=({report:k,reportId:ve,updateReportProp:Be,initVariables:Qe,cleanUpVariables:lt})=>{const{handleSubmit:Ct,control:jt,formState:{isDirty:pn},setValue:yn,getValues:Un,watch:kn}=(0,w.mN)({defaultValues:{dashboards:k.dashboards||[da]}}),{fields:Vn,append:$n,remove:ca}=(0,w.jz)({control:jt,name:"dashboards",keyName:"fieldId"}),pa=kn("dashboards"),va=(0,W.of)(Wa);(0,s.useEffect)(()=>{const Ia=lc();if(Ia){const{dashboard:$a,variables:Ys,timeRange:lr}=Ia;Ys&&$a.uid&&Qe($a.uid,Ys,lr),$a.uid&&(yn("dashboards.0.dashboard",$a,{shouldDirty:!0}),lr&&yn("dashboards.0.timeRange",{...lr,raw:lr},{shouldDirty:!0}))}},[Qe,k,yn]);const ma=Ia=>($a,Ys)=>{yn(`dashboards.${Ia}.timeRange`,{from:"",to:""});const lr=Un().dashboards?.map(({dashboard:es})=>es);if(!$a){if(!Ys)return;lr.some(Aa=>Aa?.uid===Ys)||lt(Ys);return}const ws=lr.filter(es=>es?.uid===$a.uid).length>1;if($a.uid&&!ws){const es=k.dashboards?.[Ia],Aa=$a.uid===es?.dashboard?.uid?es?.reportVariables:void 0;Qe($a.uid,Aa)}},Ea=Ia=>{const $a=ts(Ia.dashboards);pn&&Be({...k,dashboards:$a})},ts=Ia=>{const $a=Ia?.filter(({dashboard:Ys})=>Ys?.uid).map(({dashboard:Ys,timeRange:lr})=>{const ws=Ys?.uid;return{dashboard:ws?{uid:ws,name:Ys?.name}:void 0,timeRange:zg(lr?.raw),reportVariables:ws?nc((0,Ll.SS)(ws).filter(es=>es.hide!==Rc.zL.hideVariable)):void 0}});return $a?.length?$a:[da]},Qa=()=>({dashboards:ts(Un().dashboards)});return s.createElement(uc,{activeStep:C.SelectDashboard,onSubmit:Ct(Ea),confirmRedirect:pn,getFormData:Qa,reportId:ve},s.createElement(ne.n,{label:"1. Select dashboard"},s.createElement(s.Fragment,null,Vn.map((Ia,$a)=>{const Ys=pa[$a].dashboard?.uid||"",lr=pa[$a]?.reportVariables,ws=Ys?(0,Ll.SS)(Ys):[],es=Aa=>{xg(ws)&&Qe(Ys,lr,Aa)};return s.createElement("div",{key:Ia.fieldId,className:(0,B.cx)(va.section,pa.length>1&&va.sectionBorder)},s.createElement(Gn,{field:Ia,dashboardUid:Ys,onDashboardChange:ma($a),variables:ws,control:jt,index:$a,setValue:yn,selectedDashboards:pa,onTimeRangeChange:es}),Vn.length>1&&s.createElement(ce.$n,{className:va.removeBtn,variant:"secondary",fill:"outline",icon:"trash-alt",onClick:()=>ca($a)},"Remove dashboard"))}),s.createElement(ce.$n,{type:"button",variant:"secondary",onClick:()=>$n(da)},"+ Add another dashboard"))))},Gn=({field:k,index:ve,onDashboardChange:Be,variables:Qe,control:lt,dashboardUid:Ct,setValue:jt,onTimeRangeChange:pn,selectedDashboards:yn=[]})=>{const Un=pm(k.timeRange),kn=Qe.filter(va=>va.hide!==Rc.zL.hideVariable),Vn=Ct!==void 0&&!!kn.length,$n=yn.filter(({dashboard:va})=>va?.uid===Ct).length>1,ca=yn.findIndex(({dashboard:va})=>va?.uid===Ct),pa=$n&&ca!==ve;return s.createElement(s.Fragment,null,s.createElement(_.D,{label:"Source dashboard",required:!0},s.createElement(s.Fragment,null,s.createElement(w.xI,{name:`dashboards.${ve}.dashboard`,control:lt,render:({field:{onChange:va,ref:ma,value:Ea,...ts}})=>s.createElement(mn.b,{...ts,id:`dashboard-${ve}`,"aria-label":"Source dashboard",isClearable:!0,value:Ea?.uid,disabled:!ai,onChange:Qa=>{va({...Qa,name:Qa?.title}),Be(Qa,Ct)}})}),s.createElement(Kc,{uid:Ct}))),Vn&&s.createElement(_.D,{label:"Template variables",description:pa&&`When adding the same dashboard multiple times in one report, template variables that you selected first
are applied to all instances of that dashboard in the report.`},pa?s.createElement(s.Fragment,null):s.createElement(s.Fragment,null,kn.map(va=>{const{picker:ma,setValue:Ea}=Lc.B.get(va.type);return s.createElement(j.I,{label:va.name,key:va.name,labelWidth:16,disabled:!ai},s.createElement(ma,{variable:va,readOnly:!1,onVariableChange:ts=>{(0,Zl.SP)(ts)&&!(0,Ed.R)(ts.current)&&(Ea(ts,ts.current),jt(`dashboards.${ve}.reportVariables`,nc([ts]),{shouldDirty:!0}))}}))}))),s.createElement(_.D,{label:"Time range",description:"Generate report with the data from specified time range. If custom time range is empty the time range from the report's dashboard is used.",disabled:!ai},s.createElement(w.xI,{control:lt,name:`dashboards.${ve}.timeRange`,defaultValue:Un,render:({field:{ref:va,value:ma,onChange:Ea,...ts}})=>s.createElement(Nn.b,{...ts,value:qa(ma,Un),onChange:Qa=>{Ea(Qa),pn(Qa.raw)},clearable:!0})})))},ea=oa(Xn),qa=(k,ve)=>k?k.raw?k:{...k,raw:k}:ve,Wa=k=>({removeBtn:(0,B.css)`
      margin-bottom: ${k.spacing(2)};
    `,section:(0,B.css)`
      padding-bottom: ${k.spacing(2)};
    `,sectionBorder:(0,B.css)`
      &:not(:last-of-type) {
        border-bottom: 1px solid ${k.colors.border.weak};
        margin-bottom: ${k.spacing(3)};
      }
    `,infoText:(0,B.css)`
      color: ${k.colors.text.secondary};
      font-size: ${k.typography.size.sm};
      font-weight: ${k.typography.fontWeightRegular};
    `});var Ka=e(71678),Ta=e(79924);const aa=k=>k?/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(k):!1,Ha=/[,;\n]/,Ma=(k,ve=Ha)=>k?k.split(ve).filter(Boolean).every(Be=>aa(Be)):!0,Oa=(k="",ve=["png","jpg","gif"])=>{if(!k)return!0;const Be=k.split(".");return ve.includes(Be[Be.length-1])},Hs=({onDismiss:k,onSendTestEmail:ve,emails:Be})=>{const Qe=(0,W.DP)(),lt=ar(Qe),[Ct,jt]=(0,s.useState)(""),[pn,yn]=(0,s.useState)(""),[Un,kn]=(0,s.useState)(!1),[Vn,$n]=(0,s.useState)(!1),ca=ts=>{const{checked:Qa}=ts.target;$n(Qa),Qa?(jt(Be),va(Be)):(ma(),jt(""))},pa=ts=>{jt(ts.currentTarget.value),kn(!1)},va=ts=>Ma(ts)?(ma(),!0):(kn(!0),yn("Invalid email"),!1),ma=()=>{kn(!1),yn("")},Ea=()=>{va(Ct),va(Ct)&&(ve(Ct,Vn),k())};return s.createElement(he.a,{className:lt.modal,isOpen:!0,title:"Send test email",icon:"share-alt",onDismiss:k},s.createElement(s.Fragment,null,s.createElement("div",{className:lt.content},s.createElement(_.D,{label:"Email",disabled:Vn,invalid:Un,error:pn},s.createElement(G.p,{disabled:Vn,name:"email",placeholder:"your.address@company.com",type:"email",value:Ct,onChange:pa})),s.createElement(Al.S,{value:Vn,label:"Use emails from report",onChange:ca})),s.createElement(he.a.ButtonRow,null,s.createElement(ce.$n,{variant:"secondary",onClick:k,fill:"outline"},"Cancel"),s.createElement(ce.$n,{variant:"primary",onClick:Ea},"Send"))))},ar=(0,cs.N)(k=>({modal:(0,B.css)`
      width: 500px;
    `,content:(0,B.css)`
      margin-bottom: ${k.spacing.lg};
    `})),er=k=>{const{testEmailIsSending:ve,report:Be}=k.reports;return{report:Be,testEmailIsSending:ve}},As={updateReportProp:sl,sendTestEmail:Ag},bs=(0,U.connect)(er,As),rs=({report:k,reportId:ve,updateReportProp:Be,sendTestEmail:Qe,testEmailIsSending:lt})=>{const{message:Ct,name:jt,recipients:pn,replyTo:yn,enableDashboardUrl:Un,dashboards:kn}=k,{handleSubmit:Vn,control:$n,register:ca,setError:pa,clearErrors:va,watch:ma,getValues:Ea,formState:{errors:ts,isDirty:Qa}}=(0,w.mN)({mode:"onBlur"}),Ia=(0,W.of)(Zs),$a=r.contextSrv.hasPermission(N.ReportingSend),Ys=ma("name",jt),lr=ma("recipients",pn),ws=!$a||!(0,n.a)("reports.email")||!Ys||!lr||kc(kn),es=(Ls,$s)=>{const ns={...k,...Ea()},Tr=$s?ns.recipients:Ls;return Qe({...ns,recipients:Tr})},Aa=Ls=>{if(Qa){const{name:$s}=Ls;Be({...k,...Ls,name:$s.trim()})}},Fs=()=>{const Ls=Ea(),{name:$s}=Ls;return{...Ls,name:$s.trim()}};return s.createElement(uc,{activeStep:C.Share,onSubmit:Vn(Aa),confirmRedirect:Qa,getFormData:Fs,reportId:ve,pageActions:[s.createElement(Ka.$s,{key:"send-test-email"},({showModal:Ls,hideModal:$s})=>s.createElement(ce.$n,{disabled:ws,size:"xs",variant:"secondary",onClick:ns=>{ns.preventDefault(),Ls(Hs,{onDismiss:$s,onSendTestEmail:es,emails:lr})}},"Send test email"))]},lt&&s.createElement("div",{className:"page-alert-list"},s.createElement(z.F,{title:"Sending test email...",severity:"info",elevated:!0})),s.createElement(ne.n,{label:"4. Share",disabled:!ai},s.createElement(_.D,{label:"Report name",required:!0,invalid:!!ts.name,error:"Name is required"},s.createElement(G.p,{...ca("name"),type:"text",id:"name",defaultValue:jt,placeholder:"System status report"})),s.createElement(_.D,{className:Ia.field,label:"Recipients",required:!0,invalid:!!ts.recipients,error:ts.recipients?.message,description:"Separate multiple emails with a comma or semicolon."},s.createElement(w.xI,{name:"recipients",control:$n,defaultValue:pn,render:({field:{ref:Ls,value:$s,onChange:ns,...Tr}})=>s.createElement(Ta.u,{...Tr,disabled:!ai,invalid:!!ts.recipients,onChange:br=>{const Fi=br.join(";").split(Ha).filter(Boolean).map(Zr=>Zr.trim()),cl=Fi.filter(Zr=>!aa(Zr));cl.length?pa("recipients",{type:"manual",message:`Invalid email${cl.length>1?"s":""}: ${cl.join("; ")}`}):va("recipients"),ns(Fi.filter(Zr=>aa(Zr)).join(";"))},placeholder:"Type in the recipients email addresses and press Enter",tags:$s?$s.split(Ha):[],className:Ia.tagsInput,addOnBlur:!0}),rules:{validate:Ls=>Ma(Ls)||"Invalid email"}})),s.createElement(_.D,{invalid:!!ts.replyTo,error:ts.replyTo?.message,className:Ia.field,label:"Reply-to email address",description:"The address that will appear in the Reply to field of the email"},s.createElement(G.p,{...ca("replyTo",{validate:Ls=>Ma(Ls)||"Invalid email"}),id:"replyTo",placeholder:"your.address@company.com - optional",type:"email",defaultValue:yn})),s.createElement(_.D,{className:Ia.field,label:"Message"},s.createElement(No.f,{...ca("message"),id:"message",placeholder:Ct,rows:10,defaultValue:Ct})),s.createElement(_.D,{className:Ia.field},s.createElement(Al.S,{...ca("enableDashboardUrl"),defaultChecked:Un,label:"Include a dashboard link"}))))},Zs=k=>({field:(0,B.css)`
      &:not(:last-of-type) {
        margin-bottom: ${k.spacing(3)};
      }
    `,tagsInput:(0,B.css)`
      li {
        margin-bottom: ${k.spacing(1)};
        background-color: ${k.colors.background.secondary} !important;
        border-color: ${k.components.input.borderColor} !important;
        color: ${k.colors.text.primary};
      }
    `}),hr=bs(rs);var Vr=e(95246);const gs=()=>s.createElement(Da.x6,{i18nKey:"reporting.errors.action-message"},"Please contact your Grafana administrator to install the plugin."),os=()=>s.createElement(Da.x6,{i18nKey:"reporting.errors.no-renderer-description"},"To generate PDF reports, you must install the"," ",s.createElement("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link"},"Grafana Image Renderer")," ","plugin."),Ja=({variant:k="info"})=>s.createElement(z.F,{title:(0,Da.t)("reporting.errors.no-renderer-title","Image renderer plugin not installed"),severity:k},s.createElement(os,null)," ",s.createElement("br",null),s.createElement(gs,null)),Es=()=>s.createElement(Da.x6,{i18nKey:"reporting.errors.old-renderer-description"},"To generate CSV files, you must update the"," ",s.createElement("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link"},"Grafana Image Renderer")," ","plugin."),sr=()=>s.createElement(z.F,{title:(0,Da.t)("reporting.errors.old-renderer-title","You are using an old version of the image renderer plugin"),severity:"warning"},s.createElement(Es,null)," ",s.createElement("br",null),s.createElement(gs,null)),cr=({message:k})=>s.createElement(Xt.w,{title:"Feature not available with an expired license",url:"https://grafana.com/docs/grafana/latest/enterprise/license-expiration/",urlTitle:"Read more on license expiration"},s.createElement("span",null,k)),xr=(k=window.location.origin)=>{let ve=k+a.$.appSubUrl;return ve.endsWith("/")&&ve.slice(0,-1),ve},dr=(k,ve,Be,Qe,lt)=>{let Ct=`${xr()}/api/reports/render/pdfs`;const jt={orientation:k,layout:ve,scaleFactor:Be},pn={dashboard:{uid:Qe}};Object.keys(lt).length!==0&&(pn.reportVariables=lt);const yn=Si();return yn&&(pn.timeRange=yn),jt.dashboards=JSON.stringify([pn]),Ct=Ui.kM.appendQueryToUrl(Ct,Ui.kM.toUrlParams(jt)),Ct},Nr=({displayQueryVariablesAlert:k,onDismiss:ve,isSnapshot:Be,variables:Qe,dashboardUid:lt})=>{const[Ct,jt]=(0,s.useState)("landscape"),[pn,yn]=(0,s.useState)("grid"),[Un,kn]=(0,s.useState)(ql),Vn=dr(Ct,pn,Un,lt,Qe);function $n(){(0,o.rR)("dashboards_sharing_pdf_save_clicked",{orientation:Ct,layout:pn,scaleFactor:Un})}return a.$.rendererAvailable?(0,n.a)("reports.pdf")?Be?s.createElement("p",{className:"share-modal-info-text"},"Sharing a PDF from a snapshot is not supported."):s.createElement(Vr.O,{icon:"file-alt"},k&&s.createElement(zc,null),s.createElement("p",{className:"share-modal-info-text"},"Save the dashboard as a PDF document."),s.createElement(_.D,{label:"Orientation"},s.createElement(eo.z,{options:A,value:Ct,onChange:jt})),s.createElement(_.D,{label:"Layout"},s.createElement(eo.z,{options:x,value:pn,onChange:yn})),s.createElement(_.D,{label:"Zoom",description:"Increase the number of rows and columns in table panels.",className:(0,B.css)`
          max-width: 350px;
          // Hide Slider input
          input {
            display: none;
          }
        `},s.createElement(Ud.A,{value:Un,min:1,max:3,step:1,marks:Td,onChange:kn,included:!1})),s.createElement(he.a.ButtonRow,null,s.createElement(ce.$n,{variant:"secondary",onClick:ve},"Cancel"),s.createElement(ce.z9,{variant:"primary",href:Vn,target:"_blank",rel:"noreferrer noopener",onClick:$n},"Save as PDF"))):s.createElement(cr,{message:`Rendering a dashboard as a PDF document is not available with your current license.
            To enable this feature, update your license.`}):s.createElement(Ja,null)},zr=({dashboard:k,onDismiss:ve})=>{const Be=(0,s.useMemo)(()=>{const lt=Dl(k.panels),Ct=(0,Ll.SS)(k.uid),jt=vs(mc.To,"query",Ct);return jt&&lt.has(jt.name)},[k]),Qe=(0,s.useMemo)(()=>{const lt=(0,Ll.SS)(k.uid);return nc(lt)},[k.uid]);return s.createElement(Nr,{displayQueryVariablesAlert:Be,isSnapshot:k.isSnapshot(),onDismiss:ve,variables:Qe,dashboardUid:k.uid})};var kr=e(16401);class ja extends kr.Bs{constructor(){super(...arguments),this.tabId=Nc.wr.report}static{this.Component=Va}getTabLabel(){return"Report"}}function Va({model:k}){const{dashboardRef:ve,modalRef:Be}=k.useState(),Qe=ve.resolve();return s.createElement(Yu,{dashboard:Qe,onDismiss:()=>{Be?.resolve()?.onDismiss()}})}class us extends kr.Bs{constructor(){super(...arguments),this.tabId=Nc.wr.pdf}static{this.Component=tr}getTabLabel(){return"PDF"}}function tr({model:k}){const{modalRef:ve,dashboardRef:Be}=k.useState(),Qe=Be.resolve(),lt=(0,s.useMemo)(()=>{const Ct=kr.jh.getVariables(Qe).state.variables;return Pp(Ct)},[Qe]);return s.createElement(Nr,{onDismiss:ve?.resolve().onDismiss,displayQueryVariablesAlert:!1,isSnapshot:!!Qe.state.meta.isSnapshot,variables:lt,dashboardUid:Qe.state.uid})}const zs=Xo.config.featureToggles.featureHighlights,rr={label:"PDF",value:Nc.wr.pdf,component:zr},mr={label:"Report",value:Nc.wr.report,tabSuffix:zs&&!(0,n.a)("reports.creation")||(0,_n.z5)()?()=>(0,bp.J)({experimentId:Cc("reporting-tab-badge")}):void 0,component:Yu};function ho(){Xo.config.reporting?.enabled&&((0,n.a)("reports.creation")?((0,ju.addDashboardShareTab)(rr),(0,Dd.m)(us),Pi.TP.hasPermission(N.ReportingCreate)&&((0,ju.addDashboardShareTab)(mr),(0,Dd.m)(ja))):zs&&((0,ju.addDashboardShareTab)(mr),(0,Dd.m)(ja)))}const Wr=[{id:C.SelectDashboard,name:"Select dashboard",component:ea},{id:C.FormatReport,name:"Format report",component:Gg},{id:C.Schedule,name:"Schedule",component:ln},{id:C.Share,name:"Share",component:hr},{id:C.Confirm,name:"Confirm",component:$g}];var Cl=e(4213),vi=e(72436),il=e(55087),gc=e(20470);const Wl=k=>({dashboard:k.dashboard.getModel()}),Mi={initDashboard:gc.vR},Yi=(0,U.connect)(Wl,Mi);class Kl extends s.Component{constructor(){super(...arguments),this.state={panel:null,notFound:!1}}static{this.contextType=Mo.YE}componentDidMount(){const{match:ve,route:Be}=this.props;this.props.initDashboard({urlSlug:ve.params.slug,urlUid:ve.params.uid,urlType:ve.params.type,routeName:Be.routeName,fixUrl:!1,keybindingSrv:this.context.keybindings})}getPanelId(){return parseInt(this.props.queryParams.panelId??"0",10)}componentDidUpdate(ve){const{dashboard:Be}=this.props;if(Be&&(!ve.dashboard||ve.dashboard.uid!==Be.uid)){const Qe=Be.getPanelByUrlId(this.props.queryParams.panelId);if(!Qe){this.setState({notFound:!0});return}this.setState({panel:Qe}),Qe.getQueryRunner().getData({withTransforms:!0,withFieldConfig:!0}).subscribe({next:lt=>this.onDataUpdate(lt)})}}onDataUpdate(ve){const{panel:Be}=this.state;if(!ve||ve.state!==et.Gu.Done&&ve.state!==et.Gu.Streaming)return;const{dashboard:Qe}=this.props,lt=ve.series,Ct=this.props.queryParams.timezone||Qe?.timezone;let jt={defaults:{},overrides:[]};const pn=(0,Eu.we)({data:lt,theme:a.$.theme2,fieldConfig:Be?.fieldConfig||jt,replaceVariables:Vn=>Vn,timeZone:Ct}),yn=(0,vi._O)([pn[0]],{}),Un=new Blob(["\uFEFF",yn],{type:"text/csv;charset=utf-8"}),kn=`${Be?.getDisplayTitle()}-data-${(0,Zi.LE)(new Date)}.csv`;(0,Cl.saveAs)(Un,kn)}render(){return s.createElement(il.SoloPanel,{dashboard:this.props.dashboard,notFound:this.state.notFound,panel:this.state.panel,panelId:this.getPanelId(),timezone:this.props.queryParams.timezone})}}const Qo=Yi(Kl),pc=({report:k,editMode:ve})=>{const{name:Be,dashboardName:Qe=""}=k;return{text:!k.id&&!ve?"New report":Be||Qe}},wd=({children:k,editMode:ve,isLoading:Be,className:Qe,report:lt,...Ct})=>{(0,s.useEffect)(()=>{document.title=`Reporting: ${ve?"Edit report":"New report"}`},[ve]);const jt=pc({report:lt,editMode:ve});return s.createElement(hs.Y,{navId:"reports-list",pageNav:jt},s.createElement(hs.Y.Contents,null,s.createElement("div",{...Ct},Be?s.createElement(Gu.A,null):a.$.rendererAvailable?k:s.createElement(Ja,{variant:"error"}))))},Kp=(k,ve)=>{const{report:Be,isLoading:Qe}=k.reports,{id:lt,step:Ct}=ve.match.params;return{activeStep:Ct,existingReport:!!Be.id,isLoading:!!(lt&&Qe),report:Be,reportId:lt}},$p={loadReport:Ld},Qg=(0,U.connect)(Kp,$p)(({existingReport:k,isLoading:ve,loadReport:Be,report:Qe,reportId:lt,activeStep:Ct=C.SelectDashboard})=>{(0,s.useEffect)(()=>{lt&&Be(parseInt(lt,10))},[lt,Be]);const jt=(0,s.useCallback)(()=>{const pn=Wr.find(({id:yn})=>yn===Ct)?.component;return pn?s.createElement(pn,{reportId:lt}):null},[Ct,lt]);return s.createElement(wd,{isLoading:ve,editMode:k,report:Qe},ve?s.createElement(Pr.a,null):jt())});var Vp=e(82702);const zp=(k,ve)=>{const Be=["name","recipients"],Qe=lt=>lt.dashboards.some(({dashboard:Ct})=>Ct?.name.toLowerCase().includes(ve.toLowerCase()));return k.filter(lt=>Be.some(Ct=>lt[Ct]?.toLowerCase().includes(ve.toLowerCase()))||Qe(lt))},Ip=k=>new Map([[T.Scheduled,k.colors.success.text],[T.Expired,k.colors.warning.text],[T.Draft,k.colors.text.primary],[T.Never,k.colors.text.primary],[T.Paused,k.colors.text.disabled]]),Ap=({deleteReport:k,updateReport:ve,reports:Be,filter:Qe})=>{const lt=(0,W.$j)(),Ct=(0,W.of)(kp),jt=Un=>{const kn=dc(Un.state);ve({...Un,state:kn},!0)},pn=r.contextSrv.hasPermission(N.ReportingWrite),yn=r.contextSrv.hasPermission(N.ReportingDelete);return s.createElement("div",null,zp(Be,Qe).map(Un=>{const kn=Un.recipients.split(";"),Vn=kn.length,$n=rm(Un.schedule),{isNever:ca,showPlay:pa,disableEdit:va,reportState:ma}=dm(Un),Ea=Ip(lt).get(Un.state);return s.createElement(iu.Q,{key:Un.id,href:`reports/confirm/${Un.id}`,className:Ct.container},s.createElement("div",{className:Ct.info},s.createElement("span",{className:Ct.title},Un.name),s.createElement("span",{className:Ct.dashboards},[...new Set(Un.dashboards.map(({dashboard:ts})=>ts?.name))].join(", "))),s.createElement("div",{className:Ct.recipients},s.createElement(V.m,{content:kn.join(", "),placement:"top"},s.createElement("div",null,`${Vn} recipient${Vn>1?"s":""}`))),s.createElement("div",{className:Ct.schedule},s.createElement("span",{className:(0,B.cx)(Ct.scheduleStatus,(0,B.css)`
                    color: ${Ea};
                  `)},ma.toUpperCase()),!ca&&s.createElement("span",{className:Ct.text},$n)),s.createElement("div",{className:Ct.buttonWrapper},s.createElement(V.m,{content:`${pa?ma===T.Draft?cc(Un.schedule):"Resume":"Pause"} report`,placement:"top"},s.createElement(ce.$n,{type:"button",variant:"secondary",fill:"text",icon:pa?"play":"pause",size:"md",onClick:ts=>{ts.preventDefault(),jt(Un)},disabled:va||!pn||Nl(Un)})),s.createElement(Vp.Z,{confirmText:"Delete",confirmVariant:"destructive",size:"md",disabled:!yn,onConfirm:()=>k(Un)},s.createElement(ce.$n,{type:"button",className:Ct.deleteButton,"aria-label":`Delete report ${Un.name}`,variant:"secondary",icon:"trash-alt",size:"md",fill:"text"}))))}))},kp=k=>({container:(0,B.css)`
    & > a {
        align-items: center;
      },
    `,info:(0,B.css)`
      display: flex;
      flex-direction: column;
      width: 30%;
    `,title:(0,B.css)`
      font-size: ${k.typography.h5.fontSize};
      font-weight: ${k.typography.fontWeightBold};
    `,dashboards:(0,B.css)`
      font-size: ${k.typography.bodySmall.fontSize};
      color: ${k.colors.text.secondary};
    `,recipients:(0,B.css)`
      display: flex;
      width: 25%;
      cursor: pointer;

      &:hover {
        text-decoration: underline;
      },
    `,schedule:(0,B.css)`
      display: flex;
      flex-direction: column;
      width: 40%;
    `,scheduleStatus:(0,B.css)`
      text-transform: uppercase;
    `,buttonWrapper:(0,B.css)`
      display: flex;
      align-items: center;
      width: 5%;
      & > button {
        &[disabled] {
          pointer-events: all;
        },
      },
    `,deleteButton:(0,B.css)`
      &:hover {
        color: ${k.colors.error.text};
    `,text:(0,B.css)`
      color: ${k.colors.text.secondary};
    `}),_p=()=>{const k=(0,W.of)(Hp);return s.createElement(hs.Y,{navId:"reports",subTitle:"Manage automatically generated PDF reports from any dashboards and have Grafana email them to interested parties."},s.createElement("div",{className:k.box},s.createElement(Zn.Iz,{featureName:"reporting",featureId:"reporting"})),s.createElement(hs.Y.Contents,{className:k.contents},s.createElement(Rp,null)),s.createElement("div",{className:k.spacer}))},Rp=({action:k})=>s.createElement(Zn.El,{featureName:"reporting",description:"Reporting allows you to automatically generate PDFs from any of your dashboards and have Grafana email them to interested parties on a schedule.",listItems:["Customize your exact layout and orientation","Personalize with your unique branding","Specify permissions for users across your company","Choose to send a report at custom intervals"],featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/reporting/",image:"reporting-email.png",caption:"Create reports to share your SLO performance, business metrics, cost and utilization metrics or anything else you can express in a Grafana dashboard.",action:k}),Hp=k=>({contents:(0,B.css)`
      &.page-body {
        flex: 0;
      }
    `,spacer:(0,B.css)`
      flex: 1;
    `,box:(0,B.css)`
      ${k.breakpoints.up("sm")} {
        padding: ${k.spacing(0,1)};
      }

      ${k.breakpoints.up("md")} {
        padding: ${k.spacing(0,2)};
      }
    `}),Gp=_p;function jp(k){return{reports:k.reports.reports,hasFetched:k.reports.hasFetchedList,searchQuery:k.reports.searchQuery,reportCount:k.reports.reportCount}}const Qp={getReports:Ul,deleteReport:am,updateReport:Wc},Yp=(0,U.connect)(jp,Qp)(({getReports:k,deleteReport:ve,updateReport:Be,reports:Qe,reportCount:lt,hasFetched:Ct})=>{const[jt,pn]=(0,s.useState)("");(0,s.useEffect)(()=>{k()},[k]);const yn=kn=>{ve(kn.id)},Un=()=>{const{rendererAvailable:kn}=a.$,Vn=hm(),$n=r.contextSrv.hasPermission(N.ReportingCreate),ca=kn&&$n;return(0,n.a)("reports.creation")?s.createElement(s.Fragment,null,!kn&&s.createElement(Ja,{variant:"error"}),kn&&Vn!==null&&Vn<3&&s.createElement(sr,null),(0,_n.z5)()&&s.createElement(Zn.Iz,{featureId:"reporting",eventVariant:"trial",featureName:"reporting",text:"Create unlimited reports during your trial of Grafana Pro."}),lt>0?s.createElement(s.Fragment,null,s.createElement("div",{className:"page-action-bar"},s.createElement("div",{className:"gf-form gf-form--grow"},s.createElement(G.p,{placeholder:"Search reports by report name, dashboard name or recipients",prefix:s.createElement(u.I,{name:"search"}),width:56,onChange:pa=>pn(pa.target.value)}),s.createElement("div",{className:"page-action-bar__spacer"}),s.createElement(ce.z9,{variant:"primary",href:"reports/new",disabled:!ca,icon:"plus"},"Create a new report"))),s.createElement(Ap,{reports:Qe,deleteReport:yn,updateReport:Be,filter:jt})):kn&&((0,_n.z5)()?s.createElement(Rp,{action:{text:"Create report",link:"reports/new"}}):s.createElement(Ca.A,{title:"You haven't created any reports yet.",buttonIcon:"envelope",buttonLink:"reports/new",buttonTitle:"Create a new report",buttonDisabled:!ca,proTip:"",proTipLink:"",proTipLinkTitle:"",proTipTarget:"_blank"}))):s.createElement(s.Fragment,null,s.createElement(cr,{message:`Creating new reports is not available with an expired license.
              Existing reports continue to be processed but you need to update your license to create a new one.`}),lt>0&&s.createElement(Ap,{reports:Qe,deleteReport:yn,updateReport:Be,filter:jt}))};return s.createElement(hs.Y,{navId:"reports-list",subTitle:"Manage automatically generated PDF reports from any dashboards and have Grafana email them to interested parties."},s.createElement(hs.Y.Contents,{isLoading:!Ct},Un()))});var Jp=e(16817),Lp=e(37270),Zp=e(95950),Xp=e(99128);const Yg=k=>k?Jg(k)?"file":k.startsWith("http")||k.startsWith("data:")?"url":k.startsWith("#")||k.startsWith("rgb(")||k.startsWith("rgba(")?"color":"file":"url",Jg=k=>k instanceof File,Bp=k=>Jg(k)?URL.createObjectURL(k):Yg(k)==="file"?`${Ju}${k}`:k,qp=k=>!k||k instanceof File?!0:typeof k=="string"&&k.startsWith("http"),Up=[{label:"Paste URL",value:"url"},{label:"Upload file",value:"file"},{label:"Custom color",value:"color"}];function Fd({name:k,disabled:ve,allowedTypes:Be=["url","file"]}){const{control:Qe,register:lt,getValues:Ct,setValue:jt,watch:pn,formState:{errors:yn}}=(0,w.xW)(),[Un]=(0,s.useState)(Ct()[k]),kn=pn(k,Un),[Vn,$n]=(0,s.useState)(Yg(Ct()[k])),ca=(0,W.of)(eh);return s.createElement(ua.B,{gap:2,direction:"column","data-testid":`resource-picker-${k}`},s.createElement("div",null,s.createElement(eo.z,{options:Up.filter(pa=>Be.includes(pa.value)),onChange:pa=>{$n(pa),Yg(Un)===pa?jt(k,Un):jt(k,"")},disabled:ve,className:ca.buttonGroup,value:Vn})),Vn==="file"&&s.createElement(w.xI,{control:Qe,name:k,render:({field:{onChange:pa,ref:va,...ma}})=>s.createElement("div",{className:(0,B.cx)(ca.dropzone,ve&&ca.disabled)},s.createElement(Lp.gH,{...ma,readAs:"readAsBinaryString",onFileRemove:ve?void 0:()=>jt(k,""),options:{disabled:ve,multiple:!1,accept:{"image/*":[".jpeg",".jpg",".png"]},onDrop:Ea=>{pa(Ea[0])}}}),!Jg(kn)&&kn!==""&&s.createElement(Zp.I,{removeFile:ve?void 0:()=>jt(k,""),file:{file:new File([kn],kn),error:null,id:""}}))}),Vn==="url"&&s.createElement(_.D,{invalid:!!yn[k],error:yn[k]&&String(yn[k]?.message),className:ca.customField},s.createElement(G.p,{...lt(k,{validate:pa=>qp(pa)||"Invalid URL"}),id:k,placeholder:"https://your.site/image.png",disabled:ve})),Vn==="color"&&s.createElement(w.xI,{control:Qe,name:k,render:({field:pa})=>s.createElement("div",{className:ca.pickerContainer},s.createElement(Xp.i,{...pa,id:k,placeholder:"Select color",disabled:ve}))}))}const eh=k=>({pickerContainer:(0,B.css)`
      display: flex;
      position: relative;
    `,dropzone:(0,B.css)`
      & > div {
        & > small:first-of-type {
          display: none;
        }
      }
      // FileListItem
      & > div:nth-of-type(2) {
        & > span {
          & > span:nth-of-type(2) {
            display: none;
          }
        }
      }
    `,colorValue:(0,B.css)`
      margin-left: ${k.spacing(1)};
    `,buttonGroup:(0,B.css)`
      margin-bottom: ${k.spacing(2)};
    `,disabled:(0,B.css)`
      div {
        cursor: not-allowed;
      }
    `,customField:(0,B.css)`
      margin-top: -${k.spacing(2)};
    `}),th=k=>k.startsWith("http")?Oa(k):!0,Np=({url:k,altText:ve,width:Be="200px"})=>{const Qe=(0,W.IS)(nh);return k?s.createElement("div",{className:(0,B.cx)(Qe.wrapper,(0,B.css)`
          width: ${Be};
        `)},th(k)?s.createElement("img",{src:k,className:Qe.img,alt:ve}):"Invalid image"):null},nh=k=>({wrapper:(0,B.css)`
      padding: ${k.spacing.sm};
      border: 1px solid ${k.colors.border3};
      border-radius: ${k.border.radius.sm};
      margin-bottom: ${k.spacing.md};
    `,img:(0,B.css)`
      width: 100%;
    `}),ah=[{label:"Sent By",value:S.SentBy},{label:"None",value:S.None}],sh=()=>{const{register:k,control:ve,watch:Be}=(0,w.xW)(),Qe=Be("reportLogoUrl")||Cd,lt=Be("emailLogoUrl")||Sd,Ct=Be("emailFooterMode"),jt=r.contextSrv.hasPermission(N.ReportingSettingsWrite);return s.createElement(s.Fragment,null,s.createElement(ne.n,{label:"Report branding",disabled:!jt},s.createElement(_.D,{htmlFor:"reportLogoUrl",label:"Company logo URL",description:"The logo will be displayed in the document footer. Supported formats: png, jpg, gif."},s.createElement(Fd,{name:"reportLogoUrl"})),s.createElement(Np,{url:Qe===Cd?Cd:Bp(Qe),width:"60px",altText:"Company logo preview"})),s.createElement(ne.n,{label:"Email branding",disabled:!jt},s.createElement(_.D,{htmlFor:"emailLogoUrl",label:"Company logo URL",description:"The logo will be displayed in the email header. Supported formats: png, jpg, gif."},s.createElement(Fd,{name:"emailLogoUrl"})),s.createElement(Np,{url:lt===Sd?Sd:Bp(lt),altText:"Company logo preview"}),s.createElement(_.D,{label:"Email footer"},s.createElement(w.xI,{name:"emailFooterMode",render:({field:{ref:pn,...yn}})=>s.createElement(eo.z,{...yn,options:ah}),control:ve})),Ct===S.SentBy&&s.createElement(s.Fragment,null,s.createElement(_.D,{label:"Footer link text"},s.createElement(G.p,{...k("emailFooterText"),id:"emailFooterText",placeholder:"Grafana",type:"text"})),s.createElement(_.D,{label:"Footer link URL"},s.createElement(G.p,{...k("emailFooterLink"),id:"emailFooterLink",placeholder:"https://your.site",type:"url"})))))},ae=()=>{const{value:k,loading:ve,error:Be}=(0,Jp.A)(async()=>{const yn=await(0,Qt.AI)().get("/api/reports/settings");return lt(yn.branding),yn}),{handleSubmit:Qe,reset:lt,...Ct}=(0,w.mN)({mode:"onBlur",defaultValues:k?.branding}),jt=yn=>{const Un=new FormData;for(const[kn,Vn]of Object.entries(yn))Vn instanceof File&&(yn={...yn,[kn]:Vn.name},Un.append("files",Vn));return Un.append("config",JSON.stringify({branding:yn})),fetch(`${a.$.appUrl}api/reports/settings`,{method:"POST",body:Un}).then(kn=>{kn.ok?(r.lE.emit(el.r1.alertSuccess,["Successfully saved configuration"]),Ne.Ny.push("/reports")):r.lE.emit(el.r1.alertError,["Error saving configuration",kn.statusText])})};if(Be)return s.createElement(hs.Y,{navId:"reports-settings",subTitle:"Manage report template settings."},s.createElement(z.F,{title:"Error loading settings",severity:"error"}));const pn=r.contextSrv.hasPermission(N.ReportingSettingsWrite);return s.createElement(hs.Y,{navId:"reports-settings",subTitle:"Manage report template settings."},s.createElement(hs.Y.Contents,{isLoading:ve},a.$.rendererAvailable?s.createElement(w.Op,{...Ct,reset:lt,handleSubmit:Qe},s.createElement("form",{onSubmit:Qe(jt),style:{maxWidth:"500px"}},s.createElement(sh,null),s.createElement(ce.$n,{type:"submit",size:"md",variant:"primary",disabled:!pn},"Save"))):s.createElement(Ja,{variant:"error"})))};var te=e(72255),ge=e(15054);function xe({scaleFactor:k}){const ve=(0,W.$j)(),Be=ze(ve,k);return s.createElement("div",{className:Be.footer},s.createElement("div",{className:Be.logo},s.createElement("img",{className:Be.logoImg,src:"public/app/extensions/reports/img/grafana-logo.png",alt:"Report logo"})))}function ze(k,ve){return{footer:(0,B.css)({position:"fixed",bottom:0,height:k.spacing(4*ve),width:"100%"}),pageCount:(0,B.css)({height:"100%",display:"flex",fontWeight:k.typography.fontWeightMedium,fontSize:k.typography.bodySmall.fontSize,justifyContent:"center",alignItems:"center"}),logo:(0,B.css)({position:"absolute",top:k.spacing(.5*ve),right:k.spacing(2+.5*ve)}),logoImg:(0,B.css)({maxWidth:k.spacing(3*ve),maxHeight:k.spacing(3*ve)})}}const Ye=xe;function at({title:k,timeRange:ve,scaleFactor:Be}){const Qe=(0,W.$j)(),lt=Et(Qe,Be),Ct="YYYY-MM-DD HH:mm:ss Z";return s.createElement("div",null,s.createElement("div",{className:lt.subHeader},s.createElement("div",null,k," - Generated on ",fc.parse((0,Os.KQ)(Date.now()))?.format("dddd, MMM DD YYYY")),s.createElement("div",{className:lt.timeRangeBlock},s.createElement("div",null,"Data time range:"," ",fc.parse(ve.from,!0,ve.timeZone,ve.fiscalYearStartMonth)?.format(Ct),s.createElement("br",null),fc.parse(ve.to,!0,ve.timeZone,ve.fiscalYearStartMonth)?.format(Ct)))),s.createElement("div",{className:lt.dashboardTitle},k),s.createElement("hr",{className:lt.divider}))}function Et(k,ve){return{subHeader:(0,B.css)({label:"subheader",display:"flex",fontWeight:k.typography.fontWeightMedium,fontSize:`${.85*ve}rem`}),timeRangeBlock:(0,B.css)({label:"time-range-block",display:"flex",justifyContent:"flex-end",textAlign:"right",flexGrow:1}),dashboardTitle:(0,B.css)({label:"dashboard-title",fontSize:`${1.7*ve}rem`,fontWeight:k.typography.fontWeightMedium}),divider:(0,B.css)({marginTop:0,marginBottom:k.spacing(2*ve)})}}const Pt=at;function Ut(k,ve,Be,Qe){const lt=[],Ct=Math.floor(Be/(ge.sD+ge.dU));let jt=Ct;Qe||(jt=Ct/3);let pn=0,yn={items:[],h:0};lt.push(yn);let Un=0,kn=!1;for(let Vn=0;Vn<k.length;Vn++){const $n=k[Vn],ca=$n instanceof kr.tI,pa={x:0,y:pn,w:ge.cV,h:ca?ve:kn?jt-ve:jt,render:()=>s.createElement($n.Component,{model:$n,key:$n.state.key})};ca&&(k.splice(Vn+1,0,...$n.state.children),Un++),pn>=Ct&&(yn.pageBreakAfter=!0,pn=0,pa.y=0,yn={items:[],h:0},lt.push(yn)),pn+=pa.h,yn.items.push(pa),yn.h=pa.y+pa.h,kn=ca}return lt}function qt(k,ve,Be){const Qe=[],lt=Math.floor(Be/(ge.sD+ge.dU));let Ct=0,jt=!1,pn={items:[],h:0};Qe.push(pn);for(let yn=0;yn<k.length;yn++){const Un=k[yn],kn=Un instanceof kr.tI,Vn=Dn(Un,Ct,lt,ve,jt);kn&&k.splice(yn+1,0,...Un.state.children);const $n=yn<k.length-1?Dn(k[yn+1],Ct,lt,ve,kn):null;let ca=Math.max(pn.h,Vn.y+Vn.h),pa=0;kn&&$n!=null&&(pa=Math.max(pn.h,$n.y-ve+1+$n.h)),(ca>lt||kn&&pa>lt)&&(pn.pageBreakAfter=!0,Ct=Un.state.y*ve,Vn.y=0,pn={items:[],h:0},Qe.push(pn)),pn.items.push(Vn),pn.h=Math.max(pn.h,Vn.y+Vn.h),kn?(jt=!0,Ct+=ve-1):$n!=null&&$n.y!==Vn.y&&(jt=!1)}return Qe}function Dn(k,ve,Be,Qe,lt){const Ct={x:k.state.x,y:k.state.y*Qe-ve,w:k.state.width,h:k.state.height*Qe,render:()=>s.createElement(k.Component,{model:k,key:k.state.key})};return k instanceof kr.tI&&(Ct.h=1),Ct.h>Be&&(lt?Ct.h=Be-1:Ct.h=Be),Ct}function xn(k){return{margin:[ge.dU,ge.dU],containerWidth:k,containerPadding:[0,0],cols:ge.cV,rowHeight:ge.sD,maxRows:1e4}}function Sn(k){const{margin:ve,containerPadding:Be,containerWidth:Qe,cols:lt}=k;return(Qe-ve[0]*(lt-1)-Be[0]*2)/lt}function En(k,ve,Be){return Number.isFinite(k)?Math.round(ve*k+Math.max(0,k-1)*Be):k}function Mn(k,ve,Be,Qe,lt){const{margin:Ct,containerPadding:jt,rowHeight:pn}=k,yn=Sn(k);return{width:En(Qe,yn,Ct[0]),height:En(lt,pn,Ct[1]),top:Math.round((pn+Ct[1])*Be+jt[1]),left:Math.round((yn+Ct[0])*ve+jt[0])}}function Ra(k,ve,Be,Qe,lt){const{margin:Ct,cols:jt,rowHeight:pn,maxRows:yn}=k,Un=Sn(k);let kn=Math.round((Be-Ct[0])/(Un+Ct[0])),Vn=Math.round((ve-Ct[1])/(pn+Ct[1]));return kn=gr(kn,0,jt-Qe),Vn=gr(Vn,0,yn-lt),{x:kn,y:Vn}}function yr(k,ve,Be,Qe,lt,Ct){const{margin:jt,maxRows:pn,cols:yn,rowHeight:Un}=k,kn=Sn(k);let Vn=Math.round((ve+jt[0])/(kn+jt[0])),$n=Math.round((Be+jt[1])/(Un+jt[1])),ca=gr(Vn,0,yn-Qe),pa=gr($n,0,pn-lt);return["sw","w","nw"].indexOf(Ct)!==-1&&(ca=gr(Vn,0,yn)),["nw","n","ne"].indexOf(Ct)!==-1&&(pa=gr($n,0,pn)),{w:ca,h:pa}}function gr(k,ve,Be){return Math.max(Math.min(k,Be),ve)}const Sr=794,or=1122,ll=130,hc=16;function rh({grid:k,title:ve,timeRange:Be}){const[Qe,lt]=(0,s.useState)(!1),{scaleFactor:Ct,isLandscape:jt,isSimple:pn}=uh();mh(k.state.children);const{children:yn}=k.useState();(0,s.useEffect)(()=>(lt(!0),k.activate()),[k]);let Un=Sr,kn=or;jt&&(Un=or,kn=Sr);const Vn=(kn-ll)*Ct,$n=Un*Ct-2*hc,ca=(0,s.useMemo)(()=>pn?Ut(yn,Ct,Vn,jt):qt(yn,Ct,Vn),[yn,Ct,Vn,jt,pn]);return Qe?s.createElement("div",{style:{position:"relative"}},ca.map((pa,va)=>s.createElement("div",{key:va},s.createElement(Pt,{title:ve,timeRange:Be,scaleFactor:Ct}),s.createElement("div",{style:gh(pa,$n)},pa.items.map((ma,Ea)=>s.createElement("div",{key:Ea,style:fh(ma,$n)},ma.render()))),s.createElement(Ye,{scaleFactor:Ct}),pa.pageBreakAfter&&s.createElement(s.Fragment,null,s.createElement("div",{style:{pageBreakAfter:"always",marginBottom:"16px"}}),s.createElement("div",{style:{marginBottom:"16px"}}))))):null}function uh(){const k=(0,se.zy)(),ve=new URLSearchParams(k.search),Be=parseFloat(ve.get("scale")??"");return{scaleFactor:isNaN(Be)?1:Be,isLandscape:ve.get("pdf.landscape")!=="false",isSimple:ve.get("pdf.layout")==="simple"}}function mh(k){for(const ve of k)ve instanceof kr.tI&&ve.state.isCollapsed&&ve.onCollapseToggle()}function fh(k,ve){const Be=xn(ve),Qe=Mn(Be,k.x,k.y,k.w,k.h);return{top:Qe.top,left:Qe.left,width:Qe.width,height:Qe.height,position:"absolute"}}function gh(k,ve){const Be=xn(ve),Qe=Mn(Be,0,0,ge.cV,k.h);return{width:Qe.width,height:Qe.height,position:"relative"}}function ph({match:k,route:ve}){const Be=(0,te.sP)(),{dashboard:Qe,isLoading:lt,loadError:Ct}=Be.useState();return(0,s.useEffect)(()=>(Be.loadDashboard({uid:k.params.uid,route:l.DashboardRoutes.Report}),()=>{Be.clearState()}),[Be,k.params.uid,ve.routeName]),Qe?s.createElement(hh,{model:Qe}):s.createElement("div",null,lt&&s.createElement(Gu.A,null),Ct&&s.createElement("h2",null,Ct))}function hh({model:k}){const[ve,Be]=(0,s.useState)(!1),Qe=k.useState(),lt=Qe.$timeRange.useState(),Ct=(0,W.of)(vh);return(0,s.useEffect)(()=>(Be(!0),k.activate()),[k]),ve?s.createElement("div",{className:Ct.canvas},s.createElement("div",{className:Ct.body},s.createElement(rh,{grid:Qe.body,title:Qe.title,timeRange:lt}))):null}function vh(k){return{canvas:(0,B.css)({label:"canvas",display:"flex",flexDirection:"column",flexBasis:"100%",flexGrow:1,padding:k.spacing(2)}),body:(0,B.css)({label:"body",flexGrow:1,display:"flex",gap:"8px",marginBottom:k.spacing(2)})}}const Eh=ph;var yh=e(16797),wi=e(19361),bh=e(38645),Dh=e(31771);function Ph(){const k=a.$.whitelabeling;if(k){if(wi.M.LoginTitle="Welcome to Grafana Enterprise",k.links.length>0&&(0,bh.DH)(()=>k.links.map(ve=>({...ve,target:"_blank"}))),(0,Dh.Q)(k.publicDashboard),k.appTitle&&(wi.M.AppTitle=k.appTitle),k.loginLogo&&(wi.M.LoginLogo=ve=>s.createElement("img",{className:(0,B.cx)(ve.className,(0,B.css)`
            max-width: 150px;
            max-height: 250px;
            width: auto;
            @media ${yh.mediaUp(a.$.theme.breakpoints.sm)} {
              max-width: 250px;
            }
          `),src:k.loginLogo,alt:"Login logo"}),wi.M.LoginLogo.displayName="BrandingLoginLogo",wi.M.LoginTitle="",wi.M.GetLoginSubTitle=()=>""),k.loginTitle&&(wi.M.LoginTitle=k.loginTitle),k.hideEdition&&(wi.M.HideEdition=k.hideEdition),k.loginSubtitle&&(wi.M.GetLoginSubTitle=()=>k.loginSubtitle),k.menuLogo&&(wi.M.MenuLogo=ve=>s.createElement("img",{className:ve.className,src:k.menuLogo,alt:"Menu logo"}),wi.M.MenuLogo.displayName="BrandingMenuLogo"),k.loginBackground){const ve=(0,B.css)`
      background: ${k.loginBackground};
      background-size: cover;
    `;wi.M.LoginBackground=Be=>s.createElement("div",{className:(0,B.cx)(ve,Be.className)},Be.children),wi.M.LoginBackground.displayName="BrandingLoginBackground"}if(k.loginBoxBackground){const ve=(0,B.css)`
      background: ${k.loginBoxBackground};
      background-size: cover;
    `;wi.M.LoginBoxBackground=()=>ve}}}function Ch(){(0,n.a)("caching")&&(0,d.Co)(Ai),(0,n.a)("reports")&&(0,d.Co)(nm),(0,n.a)("analytics")&&(0,d.Co)(Ym),(0,n.a)("recordedqueries")&&(0,d.Co)(md),(0,n.a)("saml")&&(0,d.Co)(Rn),a.$.featureToggles.teamHttpHeaders&&(0,d.Co)(Kd),a.$.featureToggles.notificationBanner&&(0,n.a)("notificationBanner")&&((0,d.Co)({[sd.reducerPath]:sd.reducer}),(0,d.C3)(sd.middleware))}function Sh(){const k=a.$.featureToggles.featureHighlights;qd(),ho(),bf(),(0,n.a)("saml")&&Rs(),((0,n.a)("whitelabeling")||(0,n.a)("grafanacloud"))&&Ph(),(0,n.a)("recordedqueries")&&a.$.publicDashboardAccessToken===""&&Jr(),(0,n.a)("admin")&&c(),(0,n.a)("publicDashboardsEmailSharing")&&f.jK.push({path:"/public-dashboards/:accessToken/request-access",component:jf,chromeless:!0},{path:"/public-dashboards/:accessToken/confirm-access",component:nl,chromeless:!0}),(0,n.a)("saml")&&f.jK.push({path:"/admin/authentication/saml/:step?",component:Qr});const ve="/datasources/edit/:uid/cache",Be=`${i.b.DataSourcesEdit}/cache`;(0,n.a)("caching")?(f.jK.push({path:ve,component:Zo}),f.jK.push({path:Be,component:zl})):k&&(f.jK.push({path:`${ve}/upgrade`,component:bi}),f.jK.push({path:`${Be}/upgrade`,component:ul}));const Qe="/datasources/edit/:uid/insights",lt=`${i.b.DataSourcesEdit}/insights`;a.$.analytics?.enabled&&((0,n.a)("analytics")?(f.jK.push({path:Qe,component:Df}),f.jK.push({path:lt,component:Ft})):k&&(f.jK.push({path:`${Qe}/upgrade`,component:Pf}),f.jK.push({path:`${lt}/upgrade`,component:sn})));const Ct="/datasources/edit/:uid/permissions",jt=`${i.b.DataSourcesEdit}/permissions`;(0,n.a)("dspermissions.enforcement")?(f.jK.push({path:Ct,component:wf}),f.jK.push({path:jt,component:fl})):k&&(f.jK.push({path:Ct+"/upgrade",component:Wf}),f.jK.push({path:`${jt}/upgrade`,component:xm})),a.$.reporting?.enabled&&((0,n.a)("reports")?(f.jK.push({path:Ci,component:Yp},{path:`${Ci}/settings`,component:ae},{path:"/d-csv/:uid",pageClass:"dashboard-solo",routeName:l.DashboardRoutes.Normal,component:Qo}),a.$.featureToggles.newPDFRendering&&f.jK.push({path:"/d-report/:uid/:slug?",component:Eh})):k&&f.jK.push({path:Ci,component:Gp}),(0,n.a)("reports.creation")&&(f.jK.push({path:`${Ci}/new`,component:Qg}),f.jK.push({path:`${Ci}/:step?/:id?`,component:Qg})));const pn=(0,n.a)("recordedqueries")&&a.$?.recordedQueries?.enabled;r.contextSrv.isEditor&&pn&&f.jK.push({path:"/recorded-queries",component:yg},{path:"/recorded-queries/write-target",component:yp}),a.$.featureToggles.notificationBanner&&(0,n.a)("notificationBanner")&&(f.jK.push({path:"/admin/banner-settings",component:Lu,roles:()=>r.contextSrv.evaluatePermission([N.ActionBannersWrite])}),Iu())}function Th(){Pn(),f.jK.push({path:"/admin/licensing",roles:()=>r.contextSrv.evaluatePermission([N.LicensingRead,l.AccessControlAction.ActionServerStatsRead]),component:fu}),r.contextSrv.isSignedIn&&a.$.licenseInfo.stateInfo!=="Licensed"&&(0,o.Xp)(Cc(),a.$.featureToggles.featureHighlights?_l.Test:_l.Control,"")}function Mh(){Th(),Sh()}},28036:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{ENTERPRISE_I18N_NAMESPACE:()=>a,LOCALE_EXTENSIONS:()=>o});var n=e(74513);const a="grafana-enterprise",o={[n.MB]:()=>e.e(9740).then(e.t.bind(e,29740,19)),[n.NY]:()=>e.e(7179).then(e.t.bind(e,87179,19)),[n.d_]:()=>e.e(6119).then(e.t.bind(e,16119,19)),[n.rT]:()=>e.e(3749).then(e.t.bind(e,23749,19)),[n.fY]:()=>e.e(8249).then(e.t.bind(e,18249,19)),[n.jQ]:()=>e.e(8591).then(e.t.bind(e,28591,19))}},82421:()=>{"use strict"},13280:()=>{"use strict"},40964:()=>{"use strict"},95273:()=>{"use strict"},5133:(Q,I,e)=>{"use strict";e.d(I,{r:()=>f});var n=e(96540),a=e(62625),o=e(21594);const i=Object.values(a.X).filter(d=>d!==a.X.None).map(d=>({label:d,value:d}));function f({value:d,onChange:l,"aria-label":m,inputId:s,autoFocus:h,...u}){return n.createElement(o.l6,{inputId:s,value:d,options:i,onChange:b=>l(b.value??a.X.None),placeholder:"Choose role...","aria-label":m,autoFocus:h,...u})}},51372:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{ServerStats:()=>y});var n=e(32196),a=e(96540),o=e(32264),r=e(40845),i=e(55852),f=e(31678),d=e(16233),l=e(70255),m=e(10860),s=e(67061),h=e(56034),u=e(14578);const b=({content:D,footer:E,isLoading:S})=>{const T=(0,r.of)(g);return a.createElement(m.Z,{className:T.container},D.map((M,A)=>a.createElement(s.B,{key:A,justifyContent:"space-between",alignItems:"center"},a.createElement(s.B,{alignItems:"center"},a.createElement("span",{className:(0,n.cx)({[T.indent]:!!M.indent})},M.name),M.tooltip&&a.createElement(h.m,{content:String(M.tooltip),placement:"auto-start"},a.createElement(u.I,{name:"info-circle",className:T.tooltip}))),S?a.createElement(l.A,{width:60}):a.createElement("span",{className:M.highlight?T.highlight:""},M.value))),E&&a.createElement("div",null,E))},g=D=>({container:(0,n.css)({display:"flex",flexDirection:"column",gap:D.spacing(2),padding:D.spacing(2)}),indent:(0,n.css)({marginLeft:D.spacing(2)}),tooltip:(0,n.css)({color:D.colors.secondary.text}),highlight:(0,n.css)({color:D.colors.warning.text,padding:`${D.spacing(.5)} ${D.spacing(1)}`,marginRight:`-${D.spacing(1)}`})});var P=e(17172);const c=async()=>(0,P.AI)().get("api/admin/stats").catch(D=>(console.error(D),null)),y=()=>{const[D,E]=(0,a.useState)(null),[S,T]=(0,a.useState)(!0),M=(0,r.of)(v),A=d.TP.hasPermission(f.AccessControlAction.DataSourcesRead),x=d.TP.hasPermission(f.AccessControlAction.UsersRead);return(0,a.useEffect)(()=>{d.TP.hasPermission(f.AccessControlAction.ActionServerStatsRead)&&c().then(C=>{E(C),T(!1)})},[]),d.TP.hasPermission(f.AccessControlAction.ActionServerStatsRead)?a.createElement(a.Fragment,null,a.createElement("h2",{className:M.title},"Instance statistics"),!S&&!D?a.createElement("p",{className:M.notFound},"No stats found."):a.createElement("div",{className:M.row},a.createElement(b,{isLoading:S,content:[{name:"Dashboards (starred)",value:`${D?.dashboards} (${D?.stars})`},{name:"Tags",value:D?.tags},{name:"Playlists",value:D?.playlists},{name:"Snapshots",value:D?.snapshots}],footer:a.createElement(i.z9,{href:"/dashboards",variant:"secondary"},"Manage dashboards")}),a.createElement("div",{className:M.doubleRow},a.createElement(b,{isLoading:S,content:[{name:"Data sources",value:D?.datasources}],footer:A&&a.createElement(i.z9,{href:"/datasources",variant:"secondary"},"Manage data sources")}),a.createElement(b,{isLoading:S,content:[{name:"Alerts",value:D?.alerts}],footer:a.createElement(i.z9,{href:"/alerting/list",variant:"secondary"},"Manage alerts")})),a.createElement(b,{isLoading:S,content:[{name:"Organisations",value:D?.orgs},{name:"Users total",value:D?.users},{name:"Active sessions",value:D?.activeSessions},{name:"Active users in last 30 days",value:D?.activeUsers},...p(D,o.$)],footer:x&&a.createElement(i.z9,{href:"/admin/users",variant:"secondary"},"Manage users")}))):null},p=(D,E)=>!E.anonymousEnabled||!D?.activeDevices?[]:E.anonymousDeviceLimit?[{name:"Active anonymous devices",value:`${D.activeDevices} / ${E.anonymousDeviceLimit}`,tooltip:"Detected devices that are not logged in, in last 30 days.",highlight:D.activeDevices>E.anonymousDeviceLimit}]:[{name:"Active anonymous devices",value:`${D.activeDevices}`,tooltip:"Detected devices that are not logged in, in last 30 days."}],v=D=>({title:(0,n.css)({marginBottom:D.spacing(4)}),row:(0,n.css)({display:"flex",justifyContent:"space-between",width:"100%","& > div:not(:last-of-type)":{marginRight:D.spacing(2)},"& > div":{width:"33.3%"}}),doubleRow:(0,n.css)({display:"flex",flexDirection:"column","& > div:first-of-type":{marginBottom:D.spacing(2)}}),notFound:(0,n.css)({fontSize:D.typography.h6.fontSize,textAlign:"center",height:"290px"})})},55356:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{UpgradeInfo:()=>P,UpgradePage:()=>b,default:()=>A});var n=e(32196),a=e(96540),o=e(71468),r=e(40845),i=e(55852),f=e(67608),d=e(17422);const l={fontWeight:500,fontSize:"26px",lineHeight:"123%"},m=x=>{const C=x.isDark?"public/img/licensing/header_dark.svg":"public/img/licensing/header_light.svg",O=x.isDark?x.v1.palette.dark9:x.v1.palette.gray6;return{container:(0,n.css)`
      padding: 36px 79px;
      background: ${x.components.panel.background};
    `,footer:(0,n.css)`
      text-align: center;
      padding: 16px;
      background: ${O};
    `,header:(0,n.css)`
      height: 137px;
      padding: 40px 0 0 79px;
      position: relative;
      background: url('${C}') right;
    `}};function s({header:x,editionNotice:C,subheader:O,children:R}){const L=(0,r.of)(m);return a.createElement(a.Fragment,null,a.createElement("div",{className:L.header},a.createElement("h2",{style:l},x),O&&a.createElement("h3",null,O),a.createElement(h,{size:"128px",style:{boxShadow:"0px 0px 24px rgba(24, 58, 110, 0.45)",background:"#0A1C36",position:"absolute",top:"19px",left:"71%"}},a.createElement("img",{src:"public/img/grafana_icon.svg",alt:"Grafana",width:"80px",style:{position:"absolute",left:"23px",top:"20px"}}))),a.createElement("div",{className:L.container},R),C&&a.createElement("div",{className:L.footer},C))}const h=({size:x,style:C,children:O})=>{const R=(0,r.$j)();return a.createElement("div",{style:{width:x,height:x,position:"absolute",bottom:0,right:0,borderRadius:R.shape.radius.circle,...C}},O)};var u=e(51372);function b({navModel:x}){return a.createElement(f.Y,{navModel:x},a.createElement(f.Y.Contents,null,a.createElement(u.ServerStats,null),a.createElement(P,{editionNotice:`You are running the open-source version of Grafana.
        You have to install the Enterprise edition in order enable Enterprise features.`})))}const g={fontWeight:500,fontSize:"26px",lineHeight:"123%"},P=({editionNotice:x})=>{const C=(0,r.of)(c);return a.createElement(a.Fragment,null,a.createElement("h2",{className:C.title},"Enterprise license"),a.createElement(s,{header:"Grafana Enterprise",subheader:"Get your free trial",editionNotice:x},a.createElement("div",{className:C.column},a.createElement(D,null),a.createElement(v,null))))},c=x=>({column:(0,n.css)`
      display: grid;
      grid-template-columns: 100%;
      column-gap: 20px;
      row-gap: 40px;

      @media (min-width: 1050px) {
        grid-template-columns: 50% 50%;
      }
    `,title:(0,n.css)`
      margin: ${x.spacing(4)} 0;
    `}),y=()=>a.createElement("div",{style:{marginTop:"40px",marginBottom:"30px"}},a.createElement("h2",{style:g},"Get Grafana Enterprise"),a.createElement(p,null),a.createElement("p",{style:{paddingTop:"12px"}},"You can use the trial version for free for 30 days. We will remind you about it five days before the trial period ends.")),p=()=>a.createElement(i.z9,{variant:"primary",size:"lg",href:"https://grafana.com/contact?about=grafana-enterprise&utm_source=grafana-upgrade-page"},"Contact us and get a free trial"),v=()=>a.createElement("div",null,a.createElement("h4",null,"At your service"),a.createElement(S,null,a.createElement(T,{title:"Enterprise Plugins",image:"public/img/licensing/plugin_enterprise.svg"}),a.createElement(T,{title:"Critical SLA: 2 hours",image:"public/img/licensing/sla.svg"}),a.createElement(T,{title:"Unlimited Expert Support",image:"public/img/licensing/customer_support.svg"},"24 x 7 x 365 support via",a.createElement(S,{nested:!0},a.createElement(T,{title:"Email"}),a.createElement(T,{title:"Private Slack channel"}),a.createElement(T,{title:"Phone"}))),a.createElement(T,{title:"Hand-in-hand support",image:"public/img/licensing/handinhand_support.svg"},"in the upgrade process")),a.createElement("div",{style:{marginTop:"20px"}},a.createElement("strong",null,"Also included:"),a.createElement("br",null),"Indemnification, working with Grafana Labs on future prioritization, and training from the core Grafana team."),a.createElement(y,null)),D=()=>a.createElement("div",{style:{paddingRight:"11px"}},a.createElement("h4",null,"Enhanced functionality"),a.createElement(E,null)),E=()=>a.createElement(S,null,a.createElement(T,{title:"Data source permissions"}),a.createElement(T,{title:"Reporting"}),a.createElement(T,{title:"SAML authentication"}),a.createElement(T,{title:"Enhanced LDAP integration"}),a.createElement(T,{title:"Team Sync"},"LDAP, GitHub OAuth, Auth Proxy, Okta"),a.createElement(T,{title:"White labeling"}),a.createElement(T,{title:"Auditing"}),a.createElement(T,{title:"Settings updates at runtime"}),a.createElement(T,{title:"Grafana usage insights"},a.createElement(S,{nested:!0},a.createElement(T,{title:"Sort dashboards by popularity in search"}),a.createElement(T,{title:"Find unused dashboards"}),a.createElement(T,{title:"Dashboard usage stats drawer"}),a.createElement(T,{title:"Dashboard presence indicators"}))),a.createElement(T,{title:"Enterprise plugins"},a.createElement(S,{nested:!0},a.createElement(T,{title:"Oracle"}),a.createElement(T,{title:"Splunk"}),a.createElement(T,{title:"Service Now"}),a.createElement(T,{title:"Dynatrace"}),a.createElement(T,{title:"New Relic"}),a.createElement(T,{title:"DataDog"}),a.createElement(T,{title:"AppDynamics"}),a.createElement(T,{title:"SAP HANA\xAE"}),a.createElement(T,{title:"Gitlab"}),a.createElement(T,{title:"Honeycomb"}),a.createElement(T,{title:"Jira"}),a.createElement(T,{title:"MongoDB"}),a.createElement(T,{title:"Salesforce"}),a.createElement(T,{title:"Snowflake"}),a.createElement(T,{title:"Wavefront"})))),S=({children:x,nested:C})=>{const O=(0,n.css)`
    display: flex;
    flex-direction: column;
    padding-top: 8px;

    > div {
      margin-bottom: ${C?0:8}px;
    }
  `;return a.createElement("div",{className:O},x)},T=({children:x,title:C,image:O})=>{const R=O||"public/img/licensing/checkmark.svg",L=(0,n.css)`
    display: flex;

    > img {
      display: block;
      height: 22px;
      flex-grow: 0;
      padding-right: 12px;
    }
  `,N=(0,n.css)`
    font-weight: 500;
    line-height: 1.7;
  `;return a.createElement("div",{className:L},a.createElement("img",{src:R,alt:""}),a.createElement("div",null,a.createElement("div",{className:N},C),x))},M=x=>({navModel:(0,d.tc)(x.navIndex,"upgrading")}),A=(0,o.connect)(M)(b)},75192:(Q,I,e)=>{"use strict";e.d(I,{PU:()=>U,jT:()=>L});var n=e(32196),a=e(96540),o=e(71468),r=e(13544),i=e(40845),f=e(67647),d=e(94354),l=e(55852),m=e(69529),s=e(67608),h=e(10096),u=e(8484),b=e(31678),g=e(12942),P=e(72109),c=e(67061),y=e(56034),p=e(14578),v=e(94753),D=e(78369),E=e(48840),S=e(19384),T=e(46334),M=e(90613);const A=({units:H,icon:G})=>H?.length?H.length>1?a.createElement(y.m,{placement:"top",content:a.createElement(c.B,{direction:"column"},H?.map(j=>a.createElement("span",{key:j.name},j.name)))},a.createElement(x,{icon:G},H.length)):a.createElement(x,{icon:G},H[0].name):null,x=(0,a.forwardRef)(({children:H,icon:G},j)=>a.createElement(M.a,{ref:j,display:"flex",alignItems:"center",marginRight:1},a.createElement(p.I,{name:G})," ",a.createElement(M.a,{marginLeft:1},H)));x.displayName="TooltipContent";const C=({users:H,showPaging:G,totalPages:j,onChangePage:Y,currentPage:oe,fetchData:se})=>{const ne=(0,a.useMemo)(()=>H.some(z=>z.licensedRole),[H]),ee=(0,a.useMemo)(()=>H.some(z=>z.orgs),[H]),Z=(0,a.useMemo)(()=>[{id:"avatarUrl",header:"",cell:({cell:{value:z}})=>z&&a.createElement(g.e,{src:z,alt:"User avatar"})},{id:"login",header:"Login",cell:({row:{original:z}})=>a.createElement(P.Y,{color:"primary",inline:!1,href:`/admin/users/edit/${z.id}`,title:"Edit user"},z.login),sortType:"string"},{id:"email",header:"Email",cell:({cell:{value:z}})=>z,sortType:"string"},{id:"name",header:"Name",cell:({cell:{value:z}})=>z,sortType:"string"},...ee?[{id:"orgs",header:"Belongs to",cell:({cell:{value:z,row:q}})=>a.createElement(c.B,{alignItems:"center"},a.createElement(A,{units:z,icon:"building"}),q.original.isAdmin&&a.createElement(y.m,{placement:"top",content:"Grafana Admin"},a.createElement(p.I,{name:"shield"}))),sortType:(z,q)=>(z.original.orgs?.length||0)-(q.original.orgs?.length||0)}]:[],...ne?[{id:"licensedRole",header:"Licensed role",cell:({cell:{value:z}})=>z==="None"?a.createElement(v.E,{color:"disabled"},"Not assigned"," ",a.createElement(y.m,{placement:"top",content:"A licensed role will be assigned when this user signs in"},a.createElement(p.I,{name:"question-circle"}))):z,sortType:"string"}]:[],{id:"lastSeenAtAge",header:"Last active",headerTooltip:{content:"Time since user was seen using Grafana",iconName:"question-circle"},cell:({cell:{value:z}})=>a.createElement(a.Fragment,null,z&&a.createElement(a.Fragment,null,z==="10 years"?a.createElement(v.E,{color:"disabled"},"Never"):z)),sortType:(z,q)=>new Date(z.original.lastSeenAt).getTime()-new Date(q.original.lastSeenAt).getTime()},{id:"authLabels",header:"Origin",cell:({cell:{value:z}})=>a.createElement(a.Fragment,null,Array.isArray(z)&&z.length>0&&a.createElement(T.E,{label:z[0],removeIcon:!1,count:0}))},{id:"isDisabled",header:"",cell:({cell:{value:z}})=>a.createElement(a.Fragment,null,z&&a.createElement(D.v,{colorIndex:9,name:"Disabled"}))},{id:"edit",header:"",cell:({row:{original:z}})=>a.createElement(l.z9,{variant:"secondary",size:"sm",icon:"pen",href:`admin/users/edit/${z.id}`,"aria-label":`Edit user ${z.name}`,tooltip:"Edit user"})}],[ne,ee]);return a.createElement(c.B,{direction:"column",gap:2},a.createElement(E.j,{columns:Z,data:H,getRowId:z=>String(z.id),fetchData:se}),G&&a.createElement(c.B,{justifyContent:"flex-end"},a.createElement(S.d,{numberOfPages:j,currentPage:oe,onNavigate:Y})))};var O=e(57334);const R=[],L=H=>{R.push(H)},N=r.Tp.pages.UserListPage.UserListAdminPage,F={fetchUsers:O.hU,changeQuery:O.nM,changePage:O.yd,changeFilter:O.$u,changeSort:O.Vk},K=H=>({users:H.userListAdmin.users,query:H.userListAdmin.query,showPaging:H.userListAdmin.showPaging,totalPages:H.userListAdmin.totalPages,page:H.userListAdmin.page,filters:H.userListAdmin.filters,isLoading:H.userListAdmin.isLoading}),U=(0,o.connect)(K,F)(({fetchUsers:H,query:G,changeQuery:j,users:Y,showPaging:oe,changeFilter:se,filters:ne,totalPages:ee,page:Z,changePage:z,changeSort:q,isLoading:ie})=>{const de=(0,i.of)(V);return(0,a.useEffect)(()=>{H()},[H]),a.createElement(s.Y.Contents,null,a.createElement("div",{className:de.actionBar,"data-testid":N.container},a.createElement("div",{className:de.row},a.createElement(f.Z,{placeholder:"Search user by login, email, or name.",autoFocus:!0,value:G,onChange:j}),a.createElement(d.z,{options:[{label:"All users",value:!1},{label:"Active last 30 days",value:!0}],onChange:ue=>se({name:"activeLast30Days",value:ue}),value:ne.find(ue=>ue.name==="activeLast30Days")?.value,className:de.filter}),R.map((ue,fe)=>a.createElement(ue,{key:fe,filters:ne,onChange:se,className:de.filter})),h.contextSrv.hasPermission(b.AccessControlAction.UsersCreate)&&a.createElement(l.z9,{href:"admin/users/create",variant:"primary"},"New user"))),!ie&&Y.length===0?a.createElement(m.p,{message:(0,u.t)("users.empty-state.message","No users found"),variant:"not-found"}):a.createElement(C,{users:Y,showPaging:oe,totalPages:ee,onChangePage:z,currentPage:Z,fetchData:q}))});function W(){return React.createElement(Page,{navId:"global-users"},React.createElement(U,null))}const V=H=>({filter:(0,n.css)({margin:H.spacing(0,1),[H.breakpoints.down("sm")]:{margin:0}}),actionBar:(0,n.css)({marginBottom:H.spacing(2),display:"flex",alignItems:"flex-start",gap:H.spacing(2),[H.breakpoints.down("sm")]:{flexWrap:"wrap"}}),row:(0,n.css)({display:"flex",alignItems:"flex-start",textAlign:"left",marginBottom:H.spacing(.5),flexGrow:1,[H.breakpoints.down("sm")]:{flexWrap:"wrap",gap:H.spacing(2),width:"100%"}})}),_=null},57334:(Q,I,e)=>{"use strict";e.d(I,{$u:()=>W,A5:()=>Y,Bc:()=>oe,DX:()=>N,JI:()=>R,Jc:()=>F,Kg:()=>L,MV:()=>c,N6:()=>v,P3:()=>S,Pi:()=>T,T$:()=>A,TK:()=>g,VR:()=>x,Vk:()=>_,hG:()=>p,hU:()=>B,is:()=>se,kz:()=>u,ly:()=>P,mI:()=>O,nM:()=>U,nh:()=>E,nr:()=>y,pm:()=>C,xq:()=>G,yd:()=>V});var n=e(2543),a=e.n(n),o=e(72724),r=e(33378),i=e(17172),f=e(12131),d=e(2913),l=e(10096),m=e(80714),s=e(31678),h=e(44672);function u(ne){return async ee=>{try{ee((0,h.D1)(!1)),await ee(b(ne)),await ee(D(ne)),await ee(M(ne)),d.Ay.ldapEnabled&&(0,r.a)("ldapsync")&&await ee(C()),ee((0,h.D1)(!0))}catch(Z){if(console.error(Z),(0,i.NF)(Z)){const z={title:Z.data.message,body:Z.data.error};ee((0,h.PV)(z))}}}}function b(ne){return async ee=>{const Z=await(0,i.AI)().get(`/api/users/${ne}`,(0,m.F)());ee((0,h.G_)(Z))}}function g(ne){return async ee=>{await(0,i.AI)().put(`/api/users/${ne.id}`,ne),ee(u(ne.id))}}function P(ne,ee){return async Z=>{const z={password:ee};await(0,i.AI)().put(`/api/admin/users/${ne}/password`,z),Z(u(ne))}}function c(ne){return async ee=>{await(0,i.AI)().post(`/api/admin/users/${ne}/disable`),f.Ny.push("/admin/users")}}function y(ne){return async ee=>{await(0,i.AI)().post(`/api/admin/users/${ne}/enable`),ee(u(ne))}}function p(ne){return async ee=>{await(0,i.AI)().delete(`/api/admin/users/${ne}`),f.Ny.push("/admin/users")}}function v(ne,ee){return async Z=>{const z={isGrafanaAdmin:ee};await(0,i.AI)().put(`/api/admin/users/${ne}/permissions`,z),Z(u(ne))}}function D(ne){return async ee=>{const Z=await(0,i.AI)().get(`/api/users/${ne}/orgs`);ee((0,h.OF)(Z))}}function E(ne,ee,Z){return async z=>{const q={loginOrEmail:ne.login,role:Z};await(0,i.AI)().post(`/api/orgs/${ee}/users/`,q),z(u(ne.id))}}function S(ne,ee,Z){return async z=>{const q={role:Z};await(0,i.AI)().patch(`/api/orgs/${ee}/users/${ne}`,q),z(u(ne))}}function T(ne,ee){return async Z=>{await(0,i.AI)().delete(`/api/orgs/${ee}/users/${ne}`),Z(u(ne))}}function M(ne){return async ee=>{if(!l.contextSrv.hasPermission(s.AccessControlAction.UsersAuthTokenList))return;const Z=await(0,i.AI)().get(`/api/admin/users/${ne}/auth-tokens`);Z.reverse();const z=Z.map(q=>({id:q.id,isActive:q.isActive,seenAt:(0,o.fq)(q.seenAt),createdAt:q.createdAt,clientIp:q.clientIp,browser:q.browser,browserVersion:q.browserVersion,os:q.os,osVersion:q.osVersion,device:q.device}));ee((0,h.ag)(z))}}function A(ne,ee){return async Z=>{const z={authTokenId:ne};await(0,i.AI)().post(`/api/admin/users/${ee}/revoke-auth-token`,z),Z(M(ee))}}function x(ne){return async ee=>{await(0,i.AI)().post(`/api/admin/users/${ne}/logout`),ee(M(ne))}}function C(){return async ne=>{const ee=l.contextSrv.hasPermission(s.AccessControlAction.LDAPStatusRead);if((0,r.a)("ldapsync")&&ee){const Z=await(0,i.AI)().get("/api/admin/ldap-sync-status");ne((0,h.OR)(Z))}}}function O(ne){return async ee=>{await(0,i.AI)().post(`/api/admin/ldap/sync/${ne}`),ee(u(ne))}}function R(){return async ne=>{if(l.contextSrv.hasPermission(s.AccessControlAction.LDAPStatusRead))try{const ee=await(0,i.AI)().get("/api/admin/ldap/status");ne((0,h.pH)(ee))}catch(ee){if((0,i.NF)(ee)){ee.isHandled=!0;const Z={title:ee.data.message,body:ee.data.error};ne((0,h.V$)(Z))}}}}function L(ne){return async ee=>{try{const Z=await(0,i.AI)().get(`/api/admin/ldap/${encodeURIComponent(ne)}`),{name:z,surname:q,email:ie,login:de,isGrafanaAdmin:ue,isDisabled:fe,roles:Se,teams:he}=Z,ce={info:{name:z,surname:q,email:ie,login:de},permissions:{isGrafanaAdmin:ue,isDisabled:fe},roles:Se,teams:he};ee((0,h.TW)(ce))}catch(Z){if((0,i.NF)(Z)){Z.isHandled=!0;const z={title:Z.data.message,body:Z.data.error};ee((0,h.Vv)()),ee((0,h.Nf)(z))}}}}function N(){return ne=>{ne((0,h.zi)())}}function F(){return ne=>{ne((0,h.zi)()),ne((0,h.Vv)())}}const K=ne=>ne.map(ee=>Array.isArray(ee.value)?ee.value.map(Z=>`${ee.name}=${Z.value}`).join("&"):`${ee.name}=${ee.value}`).join("&");function B(){return async(ne,ee)=>{try{const{perPage:Z,page:z,query:q,filters:ie,sort:de}=ee().userListAdmin;let ue=`/api/users/search?perpage=${Z}&page=${z}&query=${q}&${K(ie)}`;de&&(ue+=`&sort=${de}`);const fe=await(0,i.AI)().get(ue);ne((0,h.Mb)(fe))}catch(Z){(0,h.g4)(),console.error(Z)}}}const w=(0,n.debounce)(ne=>ne(B()),500);function U(ne){return async ee=>{ee((0,h.Cj)()),ee((0,h.L5)(ne)),w(ee)}}function W(ne){return async ee=>{ee((0,h.Cj)()),ee((0,h.jX)(ne)),w(ee)}}function V(ne){return async ee=>{ee((0,h.Cj)()),ee((0,h.EC)(ne)),ee(B())}}function _({sortBy:ne}){const ee=ne.length?`${ne[0].id}-${ne[0].desc?"desc":"asc"}`:void 0;return async(Z,z)=>{z().userListAdmin.sort!==ee&&(Z((0,h.Cj)()),Z((0,h.$u)(ee)),Z(B()))}}const H=ne=>ne.map(ee=>Array.isArray(ee.value)?ee.value.map(Z=>`${ee.name}=${Z.value}`).join("&"):`${ee.name}=${ee.value}`).join("&");function G(){return async(ne,ee)=>{try{const{perPage:Z,page:z,query:q,filters:ie,sort:de}=ee().userListAnonymousDevices;let ue=`/api/anonymous/search?perpage=${Z}&page=${z}&query=${q}&${H(ie)}`;de&&(ue+=`&sort=${de}`);const fe=await(0,i.AI)().get(ue);ne((0,h.o3)(fe))}catch(Z){console.error(Z)}}}const j=(0,n.debounce)(ne=>ne(G()),500);function Y({sortBy:ne}){const ee=ne.length?`${ne[0].id}-${ne[0].desc?"desc":"asc"}`:void 0;return async(Z,z)=>{z().userListAnonymousDevices.sort!==ee&&(Z((0,h.kh)(ee)),Z(G()))}}function oe(ne){return async ee=>{ee((0,h.xx)(ne)),j(ee)}}function se(ne){return async ee=>{ee((0,h.iK)(ne)),ee(G())}}},44672:(Q,I,e)=>{"use strict";e.d(I,{$u:()=>O,Ay:()=>W,Cj:()=>T,D1:()=>y,EC:()=>x,G_:()=>g,L5:()=>A,Mb:()=>S,Nf:()=>m,OF:()=>P,OR:()=>l,PV:()=>p,TW:()=>s,V$:()=>d,Vv:()=>i,ag:()=>c,g4:()=>M,iK:()=>B,jX:()=>C,kh:()=>K,o3:()=>F,pH:()=>f,xx:()=>w,zi:()=>r});var n=e(65307);const a={connectionInfo:[],syncInfo:void 0,user:void 0,connectionError:void 0,userError:void 0},o=(0,n.Z0)({name:"ldap",initialState:a,reducers:{ldapConnectionInfoLoadedAction:(V,_)=>({...V,ldapError:void 0,connectionInfo:_.payload}),ldapFailedAction:(V,_)=>({...V,ldapError:_.payload}),ldapSyncStatusLoadedAction:(V,_)=>({...V,syncInfo:_.payload}),userMappingInfoLoadedAction:(V,_)=>({...V,user:_.payload,userError:void 0}),userMappingInfoFailedAction:(V,_)=>({...V,user:void 0,userError:_.payload}),clearUserMappingInfoAction:(V,_)=>({...V,user:void 0}),clearUserErrorAction:(V,_)=>({...V,userError:void 0})}}),{clearUserErrorAction:r,clearUserMappingInfoAction:i,ldapConnectionInfoLoadedAction:f,ldapFailedAction:d,ldapSyncStatusLoadedAction:l,userMappingInfoFailedAction:m,userMappingInfoLoadedAction:s}=o.actions,h=o.reducer,u={user:void 0,sessions:[],orgs:[],isLoading:!0,error:void 0},b=(0,n.Z0)({name:"userAdmin",initialState:u,reducers:{userProfileLoadedAction:(V,_)=>({...V,user:_.payload}),userOrgsLoadedAction:(V,_)=>({...V,orgs:_.payload}),userSessionsLoadedAction:(V,_)=>({...V,sessions:_.payload}),userAdminPageLoadedAction:(V,_)=>({...V,isLoading:!_.payload}),userAdminPageFailedAction:(V,_)=>({...V,error:_.payload,isLoading:!1})}}),{userProfileLoadedAction:g,userOrgsLoadedAction:P,userSessionsLoadedAction:c,userAdminPageLoadedAction:y,userAdminPageFailedAction:p}=b.actions,v=b.reducer,D={users:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!1}],isLoading:!0},E=(0,n.Z0)({name:"userListAdmin",initialState:D,reducers:{usersFetched:(V,_)=>{const{totalCount:H,perPage:G,...j}=_.payload,Y=Math.ceil(H/G);return{...V,...j,totalPages:Y,perPage:G,showPaging:Y>1,isLoading:!1}},usersFetchBegin:V=>({...V,isLoading:!0}),usersFetchEnd:V=>({...V,isLoading:!1}),queryChanged:(V,_)=>({...V,query:_.payload,page:0}),pageChanged:(V,_)=>({...V,page:_.payload}),sortChanged:(V,_)=>({...V,page:0,sort:_.payload}),filterChanged:(V,_)=>{const{name:H,value:G}=_.payload;return V.filters.some(j=>j.name===H)?{...V,page:0,filters:V.filters.map(j=>j.name===H?{...j,value:G}:j)}:{...V,page:0,filters:[...V.filters,_.payload]}}}}),{usersFetched:S,usersFetchBegin:T,usersFetchEnd:M,queryChanged:A,pageChanged:x,filterChanged:C,sortChanged:O}=E.actions,R=E.reducer,L={devices:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!0}]},N=(0,n.Z0)({name:"userListAnonymousDevices",initialState:L,reducers:{usersAnonymousDevicesFetched:(V,_)=>{const{totalCount:H,perPage:G,...j}=_.payload,Y=Math.ceil(H/G);return{...V,...j,totalPages:Y,perPage:G,showPaging:Y>1}},anonQueryChanged:(V,_)=>({...V,query:_.payload,page:0}),anonPageChanged:(V,_)=>({...V,page:_.payload}),anonUserSortChanged:(V,_)=>({...V,page:0,sort:_.payload}),filterChanged:(V,_)=>{const{name:H,value:G}=_.payload;return V.filters.some(j=>j.name===H)?{...V,page:0,filters:V.filters.map(j=>j.name===H?{...j,value:G}:j)}:{...V,page:0,filters:[...V.filters,_.payload]}}}}),{usersAnonymousDevicesFetched:F,anonUserSortChanged:K,anonPageChanged:B,anonQueryChanged:w}=N.actions,U=N.reducer,W={ldap:h,userAdmin:v,userListAdmin:R,userListAnonymousDevices:U}},35538:(Q,I,e)=>{"use strict";e.d(I,{pL:()=>a,z5:()=>r});var n=e(32264);const a=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function o(){const i=n.$.licenseInfo?.trialExpiry;return!!(i&&i>0)}const r=()=>o()&&n.$.featureToggles.featureHighlights},55907:(Q,I,e)=>{"use strict";e.d(I,{A:()=>v,p:()=>d});var n=e(2543),a=e.n(n),o=e(1062);const r=new o.tI({type:"query",params:[{name:"queryRefId",type:"string",dynamicLookup:!0},{name:"from",type:"string",options:["10s","1m","5m","10m","15m","1h","2h","6h","12h","24h","48h"]},{name:"to",type:"string",options:["now","now-1m","now-5m","now-10m","now-1h"]}],defaultParams:["#A","15m","now","avg"]}),i=[{text:"Query",value:"query"}],f={alerting:1,firing:1,no_data:2,pending:3,ok:4,paused:5,inactive:5};var d=(D=>(D.IsAbove="gt",D.IsBelow="lt",D.IsOutsideRange="outside_range",D.IsWithinRange="within_range",D.HasNoValue="no_value",D))(d||{});const l=[{value:"gt",text:"IS ABOVE"},{value:"lt",text:"IS BELOW"},{value:"outside_range",text:"IS OUTSIDE RANGE"},{value:"within_range",text:"IS WITHIN RANGE"},{value:"no_value",text:"HAS NO VALUE"}],m=[{text:"OR",value:"or"},{text:"AND",value:"and"}],s=[{text:"avg()",value:"avg"},{text:"min()",value:"min"},{text:"max()",value:"max"},{text:"sum()",value:"sum"},{text:"count()",value:"count"},{text:"last()",value:"last"},{text:"median()",value:"median"},{text:"diff()",value:"diff"},{text:"diff_abs()",value:"diff_abs"},{text:"percent_diff()",value:"percent_diff"},{text:"percent_diff_abs()",value:"percent_diff_abs"},{text:"count_non_null()",value:"count_non_null"}],h=[{text:"Alerting",value:"alerting"},{text:"No Data",value:"no_data"},{text:"Keep Last State",value:"keep_state"},{text:"Ok",value:"ok"}],u=[{text:"Alerting",value:"alerting"},{text:"Keep Last State",value:"keep_state"}];function b(D){const E=new o.tI({type:D.type,defaultParams:[]});return new o.kW(D,E)}function g(D){return D.toLowerCase().replace(/_/g,"").split(" ")[0]}function P(D){switch(g(D)){case"normal":case"ok":return{text:"OK",iconClass:"heart",stateClass:"alert-state-ok"};case"alerting":return{text:"ALERTING",iconClass:"heart-break",stateClass:"alert-state-critical"};case"nodata":return{text:"NO DATA",iconClass:"question-circle",stateClass:"alert-state-warning"};case"paused":return{text:"PAUSED",iconClass:"pause",stateClass:"alert-state-paused"};case"pending":return{text:"PENDING",iconClass:"hourglass",stateClass:"alert-state-warning"};case"firing":return{text:"FIRING",iconClass:"fire",stateClass:""};case"inactive":return{text:"INACTIVE",iconClass:"check",stateClass:""};case"error":return{text:"ERROR",iconClass:"heart-break",stateClass:"alert-state-critical"};case"unknown":default:return{text:"UNKNOWN",iconClass:"question-circle",stateClass:".alert-state-paused"}}}function c(D,E){return(0,n.reduce)(D,(S,T)=>(T.metric!==void 0&&T.value!==void 0&&S.push(T.metric+"="+T.value),T.Metric!==void 0&&T.Value!==void 0&&S.push(T.Metric+"="+T.Value),S),[]).join(E)}function y(D){return(0,n.isArray)(D.data)?c(D.data,", "):(0,n.isArray)(D.data.evalMatches)?c(D.data.evalMatches,", "):D.data.error?"Error: "+D.data.error:""}function p(D){return(0,n.isArray)(D)?c(D,", "):(0,n.isArray)(D.evalMatches)?c(D.evalMatches,", "):D.error?"Error: "+D.error:""}const v={alertQueryDef:r,getStateDisplayModel:P,conditionTypes:i,evalFunctions:l,evalOperators:m,noDataModes:h,executionErrorModes:u,reducerTypes:s,createReducerPart:b,getAlertAnnotationInfo:y,getAlertAnnotationText:p,alertStateSortScore:f}},1062:(Q,I,e)=>{"use strict";e.d(I,{Dw:()=>f,Wn:()=>i,kW:()=>r,tI:()=>o});var n=e(2543),a=e.n(n);class o{constructor(s){this.type=s.type,this.params=s.params,this.defaultParams=s.defaultParams,this.renderer=s.renderer,this.category=s.category,this.addStrategy=s.addStrategy}}class r{constructor(s,h){if(this.part=s,this.def=h,!this.def)throw{message:"Could not find query part "+s.type};s.params=s.params||(0,n.clone)(this.def.defaultParams),this.params=s.params,this.text="",this.updateText()}render(s){return this.def.renderer(this,s)}hasMultipleParamsInString(s,h){return s.indexOf(",")===-1?!1:this.def.params[h+1]&&this.def.params[h+1].optional}updateParam(s,h){if(this.hasMultipleParamsInString(s,h)){(0,n.each)(s.split(","),(u,b)=>{this.updateParam(u.trim(),b)});return}s===""&&this.def.params[h].optional?this.params.splice(h,1):this.params[h]=s,this.part.params=this.params,this.updateText()}updateText(){if(this.params.length===0){this.text=this.def.type+"()";return}let s=this.def.type+"(";s+=this.params.join(", "),s+=")",this.text=s}}function i(m,s){const h=m.def.type+"(",u=(0,n.map)(m.params,(b,g)=>{const P=m.def.params[g];return P.type==="time"&&b==="auto"&&(b="$__interval"),P.quote==="single"?"'"+b+"'":P.quote==="double"?'"'+b+'"':b});return s&&u.unshift(s),h+u.join(", ")+")"}function f(m,s){return s+" "+m.params[0]}function d(m,s){return m.params[0]}function l(m,s){return'"'+m.params[0]+'"'}},25027:(Q,I,e)=>{"use strict";e.d(I,{AK:()=>x,Cl:()=>U,Fb:()=>F,IR:()=>A,KF:()=>y,Ke:()=>v,QA:()=>P,Rk:()=>M,Sn:()=>L,Sq:()=>S,U6:()=>B,U7:()=>c,aL:()=>N,fH:()=>u,hJ:()=>K,l$:()=>g,le:()=>h,nf:()=>T,t6:()=>w,vV:()=>b,zs:()=>O});var n=e(2543),a=e.n(n),o=e(47232),r=e(34867),i=e(17172),f=e(32264),d=e(14110),l=e(10096),m=e(28475);const s=7,h={filterByLabel:"filtering alert instances by label",loadedList:"loaded Alert Rules list",leavingRuleGroupEdit:"leaving rule group edit without saving",alertRuleFromPanel:"creating alert rule from panel",alertRuleFromScratch:"creating alert rule from scratch",recordingRuleFromScratch:"creating recording rule from scratch",clickingAlertStateFilters:"clicking alert state filters",cancelSavingAlertRule:"user canceled alert rule creation",successSavingAlertRule:"alert rule saved successfully",unknownMessageFromError:"unknown messageFromError"},{logInfo:u,logError:b,logMeasurement:g}=(0,r.DW)("features.alerting",{module:"Alerting"});function P(W,V,_){return async function(...H){const G=performance.now(),j=await V(...H),Y=performance.now()-G;return g(W,{loadTimesMs:Y},_),j}}function c(W,V,_){return async(...H)=>{const G=performance.now(),j=await V(...H),{namespacesCount:Y,groupsCount:oe,rulesCount:se}=p(j);return g(W,{loadTimeMs:performance.now()-G,namespacesCount:Y,groupsCount:oe,rulesCount:se},_),j}}function y(W){Object.entries(W).forEach(([V,_])=>{const H=_.message??"unknown error",G=String(_.type)??"unknown",j=new Error(H);b(j,{field:V,type:G})})}function p(W){const V=W.length,_=W.flatMap(j=>j.groups).length,H=W.flatMap(j=>j.groups).flatMap(j=>j.rules).length;return{namespacesCount:V,groupsCount:_,rulesCount:H}}function v(W,V,_){return async(...H)=>{const G=performance.now(),j=await V(...H),{namespacesCount:Y,groupsCount:oe,rulesCount:se}=D(j);return g(W,{namespacesCount:Y,groupsCount:oe,rulesCount:se,loadTimeMs:performance.now()-G},_),j}}function D(W){const V=Object.keys(W),_=Object.values(W).flatMap(G=>G),H=_.flatMap(G=>G.rules);return{namespacesCount:V.length,groupsCount:_.length,rulesCount:H.length}}async function E(){try{const{createdAt:W}=await(0,i.AI)().get("/api/user"),V=(0,o.KQ)().subtract(s,"days"),_=(0,o.KQ)(W);return V.isBefore(_)}catch{return!0}}const S=async(W={grafana_version:f.$.buildInfo.version,org_id:l.contextSrv.user.orgId,user_id:l.contextSrv.user.id})=>{await E()||(0,d.rR)("grafana_alerting_navigation",W)},T=W=>{(0,d.rR)("grafana_alerting_rule_creation",W)},M=W=>{(0,d.rR)("grafana_alerting_rule_aborted",W)},A=W=>{(0,d.rR)("grafana_alerting_rule_form_error",W)},x=async W=>{const V={grafana_version:f.$.buildInfo.version,org_id:l.contextSrv.user.orgId,user_id:l.contextSrv.user.id};(0,d.rR)("grafana_alerting_insights",{...V,...W})};function C(W){(0,d.rR)("grafana_alerting_rules_search",{...W})}function O({oldQuery:W,newQuery:V}){try{const _=(0,m.XY)(W),H=(0,m.XY)(V),G=R(_);R(H).filter(oe=>!G.includes(oe)).forEach(oe=>{C({filter:oe,triggeredBy:"typing"})})}catch(_){_ instanceof Error&&b(_)}}function R(W){return Object.entries(W).filter(([V,_])=>!(0,n.isEmpty)(_)).map(([V])=>V)}function L(W){C({filter:W,triggeredBy:"component"})}function N(W){(0,d.rR)("grafana_alerting_rules_list_mode",{...W})}function F(){(0,d.rR)("grafana_alerting_switch_to_simplified_routing")}function K(){(0,d.rR)("grafana_alerting_switch_to_policies_routing")}function B(){(0,d.rR)("grafana_alerting_contact_point_form_edit_input_with_template")}function w(){(0,d.rR)("grafana_alerting_contact_point_form_use_custom_input_in_template")}function U(){(0,d.rR)("grafana_alerting_contact_point_form_use_single_template_in_input")}},79741:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{default:()=>P,defaultPageNav:()=>b});var n=e(96540),a=e(17172),o=e(42418),r=e(66602),i=e(7392),f=e(37959),d=e(5179),l=e(45314),m=e(730),s=e(56361),h=e(18461);const u=c=>{const y=(0,h.uE)(c.match.params),p=n.useMemo(()=>{if(!y)throw new Error("Rule ID is required");return(0,h.qg)(y,!0)},[y]),{loading:v,error:D,result:E}=(0,m.ZU)({ruleIdentifier:p});return D?n.createElement(f.d,{pageNav:b,navId:"alert-list"},n.createElement(g,{error:D})):v?n.createElement(f.d,{pageNav:b,navId:"alert-list",isLoading:!0},n.createElement(n.Fragment,null)):E?n.createElement(d.K,{identifier:p,rule:E},n.createElement(l.Ay,null)):n.createElement(f.d,{pageNav:b,navId:"alert-list"},n.createElement(i.L,{entity:"Rule"}))},b={id:"alert-rule-view",text:""};function g({error:c}){return(0,a.NF)(c)&&c.status===404?n.createElement(i.L,{entity:"Rule"}):n.createElement(o.F,{title:"Something went wrong loading the rule"},(0,s.JZ)(c))}const P=(0,r.Xc)(u,{style:"page"})},79938:(Q,I,e)=>{"use strict";e.d(I,{hK:()=>h});var n=e(2543),a=e.n(n),o=e(57220),r=e(75214),i=e(23662),f=e(49962),d=e(49498),l=e(28220);const m="/api/v1/rule/test/grafana",s="api/prometheus/grafana/api/v1/rules",h=f.H.injectEndpoints({endpoints:u=>({preview:u.mutation({query:({alertQueries:b,condition:g,customLabels:P,folder:c,alertName:y,alertUid:p})=>({url:m,data:{rule:{grafana_alert:{data:b,condition:g,no_data_state:"Alerting",title:y,uid:p??"N/A"},for:"0s",labels:(0,r.x4)(P),annotations:{}},folderUid:c.uid,folderTitle:c.title},method:"POST"})}),prometheusRulesByNamespace:u.query({query:({limitAlerts:b,identifier:g,filter:P,state:c,matcher:y})=>{const p=new URLSearchParams;b&&p.set("limit_alerts",String(b)),g&&((0,i.Mj)(g)||(0,i.X4)(g))&&(p.set("file",g.namespace),p.set("rule_group",g.groupName));const v=(0,d.bZ)(p,P);return{url:s,params:(0,d.Dj)(v,c,y)}},transformResponse:b=>(0,d.lH)(b.data.groups,o.hY)}),prometheusRuleNamespaces:u.query({query:({ruleSourceName:b,namespace:g,groupName:P,ruleName:c,dashboardUid:y,panelId:p})=>{const v={rule_group:P,rule_name:c,dashboard_uid:y,panel_id:p?.toString()};return g&&((0,o.z2)(b)?(0,n.set)(v,"folder_uid",g):(0,n.set)(v,"file",g)),{url:`api/prometheus/${(0,o.w5)(b)}/api/v1/rules`,params:v}},transformResponse:(b,g,P)=>(0,d.lH)(b.data.groups,P.ruleSourceName),providesTags:["CombinedAlertRule"]}),rulerRules:u.query({query:({rulerConfig:b,filter:g})=>{const{path:P,params:c}=(0,l.$o)(b).rules(g);return{url:P,params:c}},providesTags:["CombinedAlertRule"]}),rulerNamespace:u.query({query:({rulerConfig:b,namespace:g})=>{const{path:P,params:c}=(0,l.$o)(b).namespace(g);return{url:P,params:c}}}),rulerRuleGroup:u.query({query:({rulerConfig:b,namespace:g,group:P})=>{const{path:c,params:y}=(0,l.$o)(b).namespaceGroup(g,P);return{url:c,params:y}},providesTags:["CombinedAlertRule"]}),getAlertRule:u.query({query:({uid:b})=>({url:`/api/ruler/${o.hY}/api/v1/rule/${b}`}),providesTags:(b,g,{uid:P})=>[{type:"GrafanaRulerRule",id:P}]}),exportRules:u.query({query:({format:b,folderUid:g,group:P,ruleUid:c})=>({url:"/api/ruler/grafana/api/v1/export/rules",params:{format:b,folderUid:g,group:P,ruleUid:c},responseType:"text"}),keepUnusedDataFor:0}),exportReceiver:u.query({query:({receiverName:b,decrypt:g,format:P})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:P,decrypt:g,name:b},responseType:"text"}),keepUnusedDataFor:0}),exportReceivers:u.query({query:({decrypt:b,format:g})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:g,decrypt:b},responseType:"text"}),keepUnusedDataFor:0}),exportPolicies:u.query({query:({format:b})=>({url:"/api/v1/provisioning/policies/export/",params:{format:b},responseType:"text"}),keepUnusedDataFor:0}),exportModifiedRuleGroup:u.mutation({query:({payload:b,format:g,nameSpaceUID:P})=>({url:`/api/ruler/grafana/api/v1/rules/${P}/export/`,params:{format:g},responseType:"text",data:b,method:"POST"})}),exportMuteTimings:u.query({query:({format:b})=>({url:"/api/v1/provisioning/mute-timings/export/",params:{format:b},responseType:"text"}),keepUnusedDataFor:0}),exportMuteTiming:u.query({query:({format:b,muteTiming:g})=>({url:`/api/v1/provisioning/mute-timings/${g}/export/`,params:{format:b},responseType:"text"}),keepUnusedDataFor:0}),updateRule:u.mutation({query:({payload:b,nameSpaceUID:g})=>({url:`/api/ruler/grafana/api/v1/rules/${g}/`,data:b,method:"POST"}),invalidatesTags:["CombinedAlertRule"]})})})},91540:(Q,I,e)=>{"use strict";e.d(I,{F:()=>r});var n=e(26272),a=e(28138),o=e(49962);const r=o.H.injectEndpoints({endpoints:i=>({getSilences:i.query({query:({datasourceUid:f,ruleMetadata:d,accessControl:l})=>({url:`/api/alertmanager/${f}/api/v2/silences`,params:{ruleMetadata:d,accesscontrol:l}}),providesTags:f=>f?f.map(({id:d})=>({type:"AlertmanagerSilences",id:d})):["AlertmanagerSilences"]}),getSilence:i.query({query:({datasourceUid:f,id:d,ruleMetadata:l,accessControl:m})=>({url:`/api/alertmanager/${f}/api/v2/silence/${d}`,showErrorAlert:!1,params:{ruleMetadata:l,accesscontrol:m}}),providesTags:(f,d,{id:l})=>f?[{type:"AlertmanagerSilences",id:l}]:["AlertmanagerSilences"]}),createSilence:i.mutation({query:({datasourceUid:f,payload:d})=>({url:`/api/alertmanager/${f}/api/v2/silences`,method:"POST",data:d}),invalidatesTags:["AlertmanagerSilences","AlertmanagerAlerts"],onQueryStarted:async(f,{queryFulfilled:d})=>{try{await d,a.A.emit(n.r1.alertSuccess,["Silence created"])}catch{a.A.emit(n.r1.alertError,["Could not create silence"])}}}),expireSilence:i.mutation({query:({datasourceUid:f,silenceId:d})=>({url:`/api/alertmanager/${f}/api/v2/silence/${d}`,method:"DELETE"}),invalidatesTags:["AlertmanagerSilences"]})})})},49962:(Q,I,e)=>{"use strict";e.d(I,{H:()=>f});var n=e(75816),a=e(75505),o=e(17172),r=e(25027);const i=()=>async d=>{try{const l=performance.now(),{data:m,...s}=await(0,a.s)((0,o.AI)().fetch(d));return(0,r.l$)("backendSrvBaseQuery",{loadTimeMs:performance.now()-l},{url:d.url,method:d.method??"GET",responseStatus:s.statusText}),{data:m,meta:s}}catch(l){return{error:l}}},f=(0,n.xP)({reducerPath:"alertingApi",baseQuery:i(),tagTypes:["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus","AlertmanagerAlerts","AlertmanagerSilences","OnCallIntegrations","OrgMigrationState","DataSourceSettings","GrafanaLabels","CombinedAlertRule","GrafanaRulerRule"],endpoints:()=>({})})},32415:(Q,I,e)=>{"use strict";e.d(I,{By:()=>s,VO:()=>m,WS:()=>i,f4:()=>l,nd:()=>d,vk:()=>f});var n=e(75505),a=e(39070),o=e(17172),r=e(57220);async function i(P){try{const c=await(0,n.s)((0,o.AI)().fetch({url:`/api/alertmanager/${(0,r.w5)(P)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}));return{template_files:c.data.template_files??{},template_file_provenances:c.data.template_file_provenances??{},alertmanager_config:c.data.alertmanager_config??{},last_applied:c.data.last_applied,id:c.data.id}}catch(c){if(P===r.hY&&(0,o.NF)(c)&&c.data?.message?.includes("could not find an Alertmanager configuration"))return{template_files:{},alertmanager_config:{}};throw c}}async function f(P,c){await(0,n.s)((0,o.AI)().fetch({method:"POST",url:`/api/alertmanager/${(0,r.w5)(P)}/config/api/v1/alerts`,data:c,showErrorAlert:!1,showSuccessAlert:!1}))}async function d(P){await(0,n.s)((0,o.AI)().fetch({method:"DELETE",url:`/api/alertmanager/${(0,r.w5)(P)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}))}async function l(P){return(await(0,n.s)((0,o.AI)().fetch({url:`/api/alertmanager/${(0,r.w5)(P)}/api/v2/alerts/groups`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function m(P){return(await(0,n.s)((0,o.AI)().fetch({url:`/api/alertmanager/${(0,r.w5)(P)}/api/v2/status`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function s(P,c,y){const p={receivers:c,alert:y};try{const v=await(0,n.s)((0,o.AI)().fetch({method:"POST",data:p,url:`/api/alertmanager/${(0,r.w5)(P)}/config/api/v1/receivers/test`,showErrorAlert:!1,showSuccessAlert:!1}));if(h(v.data))throw new Error(g(v.data))}catch(v){throw(0,o.NF)(v)&&u(v.data)&&h(v.data)?new Error(g(v.data)):v}}function h(P){return P.receivers.some(c=>c.grafana_managed_receiver_configs.some(y=>y.status==="failed"))}function u(P){return(0,a.Gv)(P)&&"receivers"in P&&Array.isArray(P.receivers)?P.receivers.every(b):!1}function b(P){return(0,a.Gv)(P)&&"name"in P&&typeof P.name=="string"&&"grafana_managed_receiver_configs"in P&&Array.isArray(P.grafana_managed_receiver_configs)}function g(P){return P.receivers.flatMap(c=>c.grafana_managed_receiver_configs.filter(y=>y.status==="failed").map(y=>y.error??"Unknown error.")).join("; ")}},82843:(Q,I,e)=>{"use strict";e.d(I,{m:()=>g});var n=e(2543),a=e.n(n),o=e(99140),r=e(25027),i=e(98164),f=e(57220),d=e(56361),l=e(88467),m=e(49962),s=e(32415),h=e(77583);const u=30,b=30*1e3,g=m.H.injectEndpoints({endpoints:P=>({getAlertmanagerAlerts:P.query({query:({amSourceName:c,filter:y,showErrorAlert:p=!0})=>{const v=y?.matchers?.filter(x=>x.name&&x.value).map(x=>`${x.name}${(0,i.MN)(x)}${(0,d.Y9)(x.value)}`),{silenced:D,inhibited:E,unprocessed:S,active:T}=y||{},M=Object.fromEntries(Object.entries({silenced:D,active:T,inhibited:E,unprocessed:S}).filter(([x,C])=>C!==void 0)),A={filter:v};return M&&Object.keys(M).forEach(x=>{A[x]=M[x]}),{url:`/api/alertmanager/${(0,f.w5)(c)}/api/v2/alerts`,params:A,showErrorAlert:p}},providesTags:["AlertmanagerAlerts"]}),getAlertmanagerAlertGroups:P.query({query:({amSourceName:c})=>({url:`/api/alertmanager/${(0,f.w5)(c)}/api/v2/alerts/groups`})}),grafanaNotifiers:P.query({query:()=>({url:"/api/alert-notifiers"})}),getGrafanaAlertingConfiguration:P.query({query:()=>({url:"/api/v1/ngalert/admin_config",showErrorAlert:!1}),providesTags:["AlertingConfiguration"]}),getGrafanaAlertingConfigurationStatus:P.query({query:()=>({url:"/api/v1/ngalert"}),providesTags:["AlertingConfiguration"]}),getExternalAlertmanagers:P.query({query:()=>({url:"/api/v1/ngalert/alertmanagers"}),transformResponse:c=>c.data,providesTags:["AlertmanagerConnectionStatus"]}),updateGrafanaAlertingConfiguration:P.mutation({query:c=>({url:"/api/v1/ngalert/admin_config",method:"POST",data:c,showSuccessAlert:!1}),invalidatesTags:["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus"]}),getAlertmanagerConfigurationHistory:P.query({query:()=>({url:`/api/alertmanager/${(0,f.w5)(f.hY)}/config/history`,params:{limit:u}}),providesTags:["AlertmanagerConfiguration"]}),resetAlertmanagerConfigurationToOldVersion:P.mutation({query:c=>({url:`/api/alertmanager/${(0,f.w5)(f.hY)}/config/history/${c.id}/_activate`,method:"POST"}),invalidatesTags:["AlertmanagerConfiguration"]}),getAlertmanagerConfiguration:P.query({queryFn:async c=>{const y=c===f.hY;if((0,f.AL)(c))return(0,l.$I)((0,s.VO)(c).then(M=>({data:{alertmanager_config:M.config,template_files:{}}})));const{data:v}=await(0,o.JD)(h.L.endpoints.discoverAmFeatures.initiate({amSourceName:c})),D={alertmanager_config:{},template_files:{},template_file_provenances:{}},E=v?.lazyConfigInit??!1,S=(0,r.QA)("unifiedalerting/fetchAmConfig",s.WS,{dataSourceName:c,thunk:"unifiedalerting/fetchAmConfig"}),T=(0,d.i9)(()=>S(c),M=>!!(0,l.CZ)(M)?.includes("alertmanager storage object not found")&&!E,b).then(M=>y?M:(0,n.isEmpty)(M.alertmanager_config)&&(0,n.isEmpty)(M.template_files)?(0,s.VO)(c).then(x=>({alertmanager_config:x.config,template_files:{},template_file_provenances:M.template_file_provenances,last_applied:M.last_applied,id:M.id})):M).then(M=>M??D).then(M=>({data:M})).catch(M=>{if(E&&(0,l.CZ)(M)?.includes("alertmanager storage object not found"))return{data:D};throw M});return(0,l.$I)(T).catch(M=>({error:M,data:void 0}))},providesTags:["AlertmanagerConfiguration"]}),updateAlertmanagerConfiguration:P.mutation({query:({selectedAlertmanager:c,config:y,...p})=>({url:`/api/alertmanager/${(0,f.w5)(c)}/config/api/v1/alerts`,method:"POST",data:y,...p}),invalidatesTags:["AlertmanagerConfiguration"]}),getContactPointsStatus:P.query({query:()=>({url:`/api/alertmanager/${(0,f.w5)(f.hY)}/config/api/v1/receivers`}),transformResponse:c=>{const y=p=>p.startsWith("0001-01-01");return c.map(p=>({...p,integrations:p.integrations.map(v=>{const D=y(v.lastNotifyAttempt);return{...v,lastNotifyAttempt:D?"":v.lastNotifyAttempt,lastNotifyAttemptDuration:D?"":v.lastNotifyAttemptDuration}})}))}}),getContactPointsList:P.query({query:()=>({url:"/api/v1/notifications/receivers"})}),getMuteTimingList:P.query({query:()=>({url:"/api/v1/notifications/time-intervals"})})})})},92240:(Q,I,e)=>{"use strict";e.d(I,{O5:()=>h,_y:()=>s,nD:()=>l});var n=e(75505),a=e(17172),o=e(94822),r=e(55740),i=e(57220),f=e(49498),d=e(28220);async function l(y){if(y===i.hY)return{features:{rulerApiEnabled:!0}};const p=(0,i.oh)(y);if(!p)throw new Error(`Cannot find data source configuration for ${y}`);const{url:v,name:D,type:E}=p;if(!v)throw new Error("The data source url cannot be empty.");if(E!=="prometheus"&&E!=="loki")throw new Error(`The build info request is not available for ${E}. Only 'prometheus' and 'loki' are supported`);return m({name:D,url:v,type:E})}async function m(y){const{url:p,name:v,type:D}=y,E=D==="loki"?void 0:await b(p);if(!(E!==void 0)){if(!await g(v))throw new Error(`Unable to fetch alert rules. Is the ${v} data source properly configured?`);const A=await P(v);return{application:o.N1.Cortex,features:{rulerApiEnabled:A}}}const{features:T}=E.data;return T?{application:o.N1.Mimir,features:{rulerApiEnabled:T?.ruler_config_api==="true"}}:{application:o.N1.Prometheus,features:{rulerApiEnabled:!1}}}async function s(y){if(y===i.hY)return{lazyConfigInit:!1};const p=u(y),{url:v,type:D}=p;if(!v)throw new Error("The data source url cannot be empty.");if(D!=="alertmanager")throw new Error(`Alertmanager feature discovery is not available for ${D}. Only 'alertmanager' type is supported`);return await h(v)}async function h(y){try{return{lazyConfigInit:(await b(y))?.data?.application==="Grafana Mimir"}}catch{return{lazyConfigInit:!1}}}function u(y){const p=(0,i.oh)(y);if(!p)throw new Error(`Cannot find data source configuration for ${y}`);return p}async function b(y){return(await(0,n.s)((0,a.AI)().fetch({url:`${y}/api/v1/status/buildinfo`,showErrorAlert:!1,showSuccessAlert:!1})).catch(v=>{if(!("status"in v&&v.status===404))throw v}))?.data}async function g(y){try{return await(0,f.sA)(y),!0}catch{return!1}}async function P(y){try{return await(0,d.Zp)(y),!0}catch(p){if(c(p))return!1;throw p}}function c(y){return(0,a.NF)(y)?y.data.message?.includes("GetRuleGroup unsupported in rule local store")||y.data.message?.includes("page not found")||y.data.message?.includes(r.UU):y instanceof Error&&y.message?.includes("404 from rules config endpoint")}},77583:(Q,I,e)=>{"use strict";e.d(I,{L:()=>f});var n=e(94822),a=e(25027),o=e(57220),r=e(49962),i=e(92240);const f=r.H.injectEndpoints({endpoints:d=>({discoverAmFeatures:d.query({queryFn:async({amSourceName:l})=>{try{return{data:await(0,i._y)(l)}}catch(m){return{error:m}}}}),discoverDsFeatures:d.query({queryFn:async({rulesSourceName:l})=>{const m=(0,o.Jz)(l);if(!m)return{error:new Error(`Missing data source configuration for ${l}`)};const h=await(0,a.QA)("unifiedalerting/featureDiscoveryApi/discoverDsFeatures",i.nD,{dataSourceName:l,endpoint:"unifiedalerting/featureDiscoveryApi/discoverDsFeatures"})(m.name);return{data:{rulerConfig:h.features.rulerApiEnabled?{dataSourceName:m.name,apiVersion:h.application===n.N1.Cortex?"legacy":"config"}:void 0}}}})})})},68788:(Q,I,e)=>{"use strict";e.d(I,{Es:()=>r,pB:()=>l});var n=e(75505),a=e(17172),o=e(57220);function r(){return(0,a.AI)().get("/api/alert-notifiers")}const i=m=>{const s=m.match(/^(\w+)(\[\d+\])?$/);return s?{type:s[1],index:s[2]}:{type:m,index:void 0}},f=m=>{const s={receivers:{},errorCount:0};m.forEach(u=>{s.receivers[u.name]={active:u.active,notifiers:{},errorCount:0};const b=s.receivers[u.name];u.integrations.forEach(g=>{!!g?.lastNotifyAttemptError&&(b.errorCount+=1);const c=d(g.name);c&&(b.notifiers[c]||(b.notifiers[c]=[]),b.notifiers[c].push(g))})});const h=Object.values(s.receivers).reduce((u,b)=>u+b.errorCount,0);return{...s,errorCount:h}},d=m=>i(m)?.type;async function l(m){try{const s=await(0,n.s)((0,a.AI)().fetch({url:`/api/alertmanager/${(0,o.w5)(m)}/config/api/v1/receivers`,showErrorAlert:!1,showSuccessAlert:!1}));return f(s.data)}catch{return f([])}}},26423:(Q,I,e)=>{"use strict";e.d(I,{Pc:()=>i,WG:()=>d,uz:()=>s});var n=e(17172),a=e(37534),o=e(99494),r=e(49962);const i="grafana_alerting_v2",f=h=>`/api/plugin-proxy/${o.W.OnCall}${h}`,d=r.H.injectEndpoints({endpoints:h=>({grafanaOnCallIntegrations:h.query({query:()=>({url:f("/api/internal/v1/alert_receive_channels/"),params:{filters:!0,integration:[a.FI,"legacy_grafana_alerting"],skip_pagination:!0},showErrorAlert:!1}),transformResponse:u=>l(u)?u.results:u,providesTags:["OnCallIntegrations"]}),validateIntegrationName:h.query({query:u=>({url:f("/api/internal/v1/alert_receive_channels/validate_name/"),params:{verbal_name:u},showErrorAlert:!1})}),createIntegration:h.mutation({query:u=>({url:f("/api/internal/v1/alert_receive_channels/"),data:u,method:"POST",showErrorAlert:!0}),invalidatesTags:["OnCallIntegrations"]}),features:h.query({query:()=>({url:f("/api/internal/v1/features/"),showErrorAlert:!1})}),onCallConfigChecks:h.query({query:()=>({url:f("/api/internal/v1/organization/config-checks/"),showErrorAlert:!1})})})});function l(h){return"results"in h&&Array.isArray(h.results)}const{useGrafanaOnCallIntegrationsQuery:m}=d;function s(h){return(0,n.NF)(h)&&"detail"in h.data}},49498:(Q,I,e)=>{"use strict";e.d(I,{Dj:()=>d,Kw:()=>m,bZ:()=>f,lH:()=>l,sA:()=>h});var n=e(75505),a=e(17172),o=e(57220),r=e(23662);function i(u){const{dataSourceName:b,limitAlerts:g,identifier:P}=u;return{rules:(c,y,p)=>{const v=new URLSearchParams;b===o.hY&&g&&v.set("limit_alerts",String(g)),P&&((0,r.Mj)(P)||(0,r.X4)(P))&&(v.set("file",P.namespace),v.set("rule_group",P.groupName));const D=f(v,c);return{url:`/api/prometheus/${(0,o.w5)(b)}/api/v1/rules`,params:d(D,y,p)}}}}function f(u,b){return b?.dashboardUID&&(u.set("dashboard_uid",b.dashboardUID),b?.panelId&&u.set("panel_id",String(b.panelId))),Object.fromEntries(u)}function d(u,b,g){let P={...u};if(b?.length&&(P={...P,state:b}),g?.length){const c=g.map(y=>JSON.stringify(y));P={...P,matcher:c}}return P}const l=(u,b)=>{const g={};return u.forEach(P=>{P.rules.forEach(c=>{c.query=c.query||""}),g[P.file]?g[P.file].groups.push(P):g[P.file]={dataSourceName:b,name:P.file,groups:[P]}}),Object.values(g)},m=(u=[])=>u?.flatMap(b=>b.groups.flatMap(g=>s(g,b.name)));function s(u,b){return{name:u.name,file:b,rules:u.rules,interval:u.interval}}async function h(u,b,g,P,c,y){if(b?.dashboardUID&&u!==o.hY)throw new Error("Filtering by dashboard UID is only supported for Grafana Managed rules.");const{url:p,params:v}=i({dataSourceName:u,limitAlerts:g,identifier:y}).rules(b,c,P),D=await(0,n.s)((0,a.AI)().fetch({url:p,params:v,showErrorAlert:!1,showSuccessAlert:!1})).catch(E=>{throw"status"in E&&E.status===404?new Error("404 from rule state endpoint. Perhaps ruler API is not enabled?"):E});return l(D.data.data.groups,u)}},28220:(Q,I,e)=>{"use strict";e.d(I,{$o:()=>d,AJ:()=>b,BK:()=>p,E8:()=>l,HO:()=>u,Zp:()=>h,iy:()=>m});var n=e(75505),a=e(39070),o=e(17172),r=e(55740),i=e(57220),f=e(49498);function d(v){const E=`${`/api/ruler/${(0,i.w5)(v.dataSourceName)}`}/api/v1/rules`,S=new URLSearchParams;return S.set("subtype",v.apiVersion==="legacy"?"cortex":"mimir"),{rules:T=>{const M=(0,f.bZ)(S,T);return{path:`${E}`,params:M}},namespace:T=>({path:`${E}/${encodeURIComponent(T)}`,params:Object.fromEntries(S)}),namespaceGroup:(T,M)=>({path:`${E}/${encodeURIComponent(T)}/${encodeURIComponent(M)}`,params:Object.fromEntries(S)})}}async function l(v,D,E){const{path:S,params:T}=d(v).namespace(D);await(0,n.s)((0,o.AI)().fetch({method:"POST",url:S,data:E,showErrorAlert:!1,showSuccessAlert:!1,params:T}))}async function m(v,D){if(D?.dashboardUID&&v.dataSourceName!==i.hY)throw new Error("Filtering by dashboard UID is only supported by Grafana.");const{path:E,params:S}=d(v).rules(D);return g(E,{},S)}async function s(v,D){const{path:E,params:S}=d(v).namespace(D);return(await g(E,{},S))[D]||[]}async function h(v){return g(`/api/ruler/${(0,i.w5)(v)}/api/v1/rules/test/test`,null)}async function u(v,D,E){const{path:S,params:T}=d(v).namespaceGroup(D,E);return g(S,null,T)}async function b(v,D,E){const{path:S,params:T}=d(v).namespaceGroup(D,E);await(0,n.s)((0,o.AI)().fetch({url:S,method:"DELETE",showSuccessAlert:!1,showErrorAlert:!1,params:T}))}async function g(v,D,E){try{return(await(0,n.s)((0,o.AI)().fetch({url:v,showErrorAlert:!1,showSuccessAlert:!1,params:E}))).data}catch(S){if(!P(S))throw S;if(y(S))return D;throw c(S)?{...S,data:{...S.data,message:r.UU}}:S}}function P(v){if(!(0,a.Gv)(v))return!1;const D="data"in v&&v.data!==null&&v.data!==void 0;return"status"in v&&Number.isFinite(v.status)&&D}function c(v){return v.status===404||v.status===500&&v.data.message?.includes("unexpected content type from upstream. expected YAML, got text/html")}function y(v){return v.status===404&&(v.data.message?.includes("group does not exist")||v.data.message?.includes("no rule groups found"))}async function p(v,D){const{path:E,params:S}=d(v).namespace(D);await(0,n.s)((0,o.AI)().fetch({method:"DELETE",url:E,showErrorAlert:!1,showSuccessAlert:!1,params:S}))}},15458:(Q,I,e)=>{"use strict";e.d(I,{R:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(29158);const i=({labelKey:d,value:l,operator:m="=",onRemoveLabel:s})=>{const h=(0,o.of)(f);return a.createElement("div",{className:h.wrapper},d,m,l,!!s&&a.createElement(r.K,{name:"times",size:"xs",onClick:s,tooltip:"Remove label"}))},f=d=>({wrapper:(0,n.css)({padding:d.spacing(.5,1),borderRadius:d.shape.radius.default,border:`solid 1px ${d.colors.border.medium}`,fontSize:d.typography.bodySmall.fontSize,backgroundColor:d.colors.background.secondary,fontWeight:d.typography.fontWeightBold,color:d.colors.text.primary,display:"inline-block",lineHeight:"1.2"})})},69087:(Q,I,e)=>{"use strict";e.d(I,{m:()=>u});var n=e(32196),a=e(2543),o=e.n(a),r=e(55127),i=e.n(r),f=e(96540),d=e(40845),l=e(55852),m=e(69613),s=e(75214),h=e(8406);const u=({labels:P,commonLabels:c={},size:y})=>{const p=(0,d.of)(g,y),[v,D]=(0,f.useState)(!1),E=(0,a.chain)(P).toPairs().reject(s.w0).reject(([M])=>v?!1:M in c).value(),S=Object.keys(c).length,T=S>0;return f.createElement("div",{className:p.wrapper,role:"list","aria-label":"Labels"},E.map(([M,A])=>f.createElement(h.J,{key:M+A,size:y,label:M,value:A,color:b(M)})),!v&&T&&f.createElement(l.$n,{variant:"secondary",fill:"text",onClick:()=>D(!0),tooltip:"Show common labels",tooltipPlacement:"top",size:"sm"},"+",S," common ",i()("label",S)),v&&T&&f.createElement(l.$n,{variant:"secondary",fill:"text",onClick:()=>D(!1),tooltipPlacement:"top",size:"sm"},"Hide common labels"))};function b(P){return(0,m.MC)(P).color}const g=(P,c)=>({wrapper:(0,n.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:c==="md"?P.spacing():P.spacing(.5)})})},37959:(Q,I,e)=>{"use strict";e.d(I,{d:()=>y,y:()=>p});var n=e(96540),a=e(87586),o=e(67608),r=e(70383),i=e(32196),f=e(40845),d=e(14186),l=e(21594),m=e(57220);function s(E){return E.name===m.hY?"Grafana":E.name.slice(0,37)}const h=({disabled:E=!1})=>{const S=(0,f.of)(u),{selectedAlertmanager:T,availableAlertManagers:M,setSelectedAlertmanager:A}=(0,r.VI)(),x=(0,n.useMemo)(()=>M.map(R=>({label:s(R),value:R.name,imgUrl:R.imgUrl,meta:R.meta})),[M]),C=E||x.length===1,O=C?"Alertmanager":"Choose Alertmanager";return n.createElement(d.I,{className:S.field,label:O,disabled:C,"data-testid":"alertmanager-picker"},n.createElement(l.l6,{"aria-label":O,width:29,className:"ds-picker select-container",backspaceRemovesValue:!1,onChange:R=>{R?.value&&A(R.value)},options:x,maxMenuHeight:500,noOptionsMessage:"No datasources found",value:T,getOptionLabel:R=>R.label}))},u=E=>({field:(0,i.css)({margin:0})});var b=e(42418);const g=()=>n.createElement(b.F,{title:"No Alertmanager found",severity:"warning"},"We could not find any external Alertmanagers and you may not have access to the built-in Grafana Alertmanager."),P=()=>n.createElement(b.F,{title:"Selected Alertmanager not found.",severity:"warning"},"The selected Alertmanager no longer exists or you may not have permission to access it. You can select a different Alertmanager from the dropdown."),c=({availableAlertManagers:E})=>{const S=E.length>0;return n.createElement("div",null,S?n.createElement(P,null):n.createElement(g,null))},y=({children:E,isLoading:S,...T})=>n.createElement(o.Y,{...T},n.createElement(o.Y.Contents,{isLoading:S},E)),p=({children:E,accessType:S,...T})=>{const M=v();return n.createElement(r.b9,{accessType:S},n.createElement(y,{...T,actions:n.createElement(h,{disabled:M})},n.createElement(D,null,E)))};function v(){const E=(0,a.A)();return["/edit","/new"].some(T=>E?.pathname?.includes(T))}const D=({children:E})=>{const{availableAlertManagers:S,selectedAlertmanager:T}=(0,r.VI)();return T?n.createElement(n.Fragment,null,E):n.createElement(c,{availableAlertManagers:S})}},71223:(Q,I,e)=>{"use strict";e.d(I,{s:()=>h});var n=e(32196),a=e(96540),o=e(56034),r=e(40845),i=e(72109),f=e(55740),d=e(84396),l=e(16577),m=e(73750);const s=["message","description"],h=({annotationKey:g,value:P,valueLink:c})=>{const y=g,p=f.J3[y]?a.createElement(o.m,{content:g,placement:"top",theme:"info"},a.createElement("span",null,f.J3[y])):g;return a.createElement(d.X,{label:p,horizontal:!0},a.createElement(u,{annotationKey:g,value:P,valueLink:c}))},u=({annotationKey:g,value:P,valueLink:c})=>{const y=(0,r.of)(b),p=s.includes(g),v=P&&P.startsWith("http"),D=a.createElement(l.Y,{input:P,delimiter:["{{","}}"]});return c?a.createElement(i.Y,{href:c,external:!0},P):p?a.createElement(m.L,{className:y.well},D):v?a.createElement(i.Y,{href:P,external:!0},P):a.createElement(a.Fragment,null,D)},b=g=>({well:(0,n.css)({wordBreak:"break-word"})})},84396:(Q,I,e)=>{"use strict";e.d(I,{X:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=({className:f,label:d,horizontal:l,children:m,childrenWrapperClassName:s})=>{const h=(0,o.of)(i);return a.createElement("div",{className:(0,n.cx)(h.field,l?h.fieldHorizontal:h.fieldVertical,f)},a.createElement("div",null,d),a.createElement("div",{className:s},m))},i=f=>({fieldHorizontal:(0,n.css)({flexDirection:"row",[f.breakpoints.down("md")]:{flexDirection:"column"}}),fieldVertical:(0,n.css)({flexDirection:"column"}),field:(0,n.css)({display:"flex",margin:`${f.spacing(2)} 0`,"& > div:first-child":{width:"110px",paddingRight:f.spacing(1),fontSize:f.typography.size.sm,fontWeight:f.typography.fontWeightBold,lineHeight:1.8},"& > div:nth-child(2)":{flex:1,color:f.colors.text.secondary}})})},75591:(Q,I,e)=>{"use strict";e.d(I,{E:()=>m});var n=e(32196),a=e(96540),o=e(13544),r=e(40845),i=e(29158),f=e(19384),d=e(98439),l=e(22620);const m=({cols:h,items:u,isExpandable:b=!1,onCollapse:g,onExpand:P,isExpanded:c,renderExpandedContent:y,testIdGenerator:p,pagination:v,paginationStyles:D,renderPrefixCell:E,renderPrefixHeader:S,footerRow:T,dataTestId:M})=>{const A=(0,r.of)(l.H);if((g||P||c)&&!(g&&P&&c))throw new Error("either all of onCollapse, onExpand, isExpanded must be provided, or none");if((b||y)&&!(b&&y))throw new Error("either both isExpanded and renderExpandedContent must be provided, or neither");const x=(0,r.of)(s(h,b,!!S)),[C,O]=(0,a.useState)([]),R=w=>{c&&g&&P?c(w)?g(w):P(w):O(C.includes(w.id)?C.filter(U=>U!==w.id):[...C,w.id])},L=v?.itemsPerPage??u.length,{page:N,numberOfPages:F,onPageChange:K,pageItems:B}=(0,d.W)(u,1,L);return a.createElement(a.Fragment,null,a.createElement("div",{className:x.container,"data-testid":M??"dynamic-table"},a.createElement("div",{className:x.row,"data-testid":"header"},S&&S(),b&&a.createElement("div",{className:x.cell}),h.map(w=>a.createElement("div",{className:x.cell,key:w.id},w.label))),B.map((w,U)=>{const W=c?c(w):C.includes(w.id);return a.createElement("div",{className:x.row,key:`${w.id}-${U}`,"data-testid":p?.(w,U)??"row"},E&&E(w,U,u),b&&a.createElement("div",{className:(0,n.cx)(x.cell,x.expandCell)},a.createElement(i.K,{tooltip:`${W?"Collapse":"Expand"} row`,"data-testid":o.Tp.components.AlertRules.toggle,name:W?"angle-down":"angle-right",onClick:()=>R(w)})),h.map(V=>a.createElement("div",{className:(0,n.cx)(x.cell,x.bodyCell,V.className),"data-column":V.label,key:`${w.id}-${V.id}`},V.renderCell(w,U))),W&&y&&a.createElement("div",{className:x.expandedContentRow,"data-testid":o.Tp.components.AlertRules.expandedContent},y(w,U,u)))}),T&&a.createElement("div",{className:(0,n.cx)(x.row,x.footerRow)},T)),v&&a.createElement(f.d,{className:(0,n.cx)(A,D),currentPage:N,numberOfPages:F,onNavigate:K,hideWhenSinglePage:!0}))},s=(h,u,b)=>{const g=h.map(P=>P.size?typeof P.size=="number"?`${P.size}fr`:P.size:"auto");return u&&g.unshift("calc(1em + 16px)"),b&&g.unshift("0"),P=>({container:(0,n.css)({border:`1px solid ${P.colors.border.weak}`,borderRadius:P.shape.radius.default,color:P.colors.text.secondary}),row:(0,n.css)({display:"grid",gridTemplateColumns:g.join(" "),gridTemplateRows:"1fr auto","&:nth-child(2n + 1)":{backgroundColor:P.colors.background.secondary},"&:nth-child(2n)":{backgroundColor:P.colors.background.primary},[P.breakpoints.down("sm")]:{gridTemplateColumns:"auto 1fr",gridTemplateAreas:"left right",padding:`0 ${P.spacing(.5)}`,"&:first-child":{display:"none"},"& > *:first-child":{display:b?"none":void 0}}}),footerRow:(0,n.css)({display:"flex",padding:P.spacing(1)}),cell:(0,n.css)({display:"flex",alignItems:"center",padding:P.spacing(1),[P.breakpoints.down("sm")]:{padding:`${P.spacing(1)} 0`,gridTemplateColumns:"1fr"}}),bodyCell:(0,n.css)({overflow:"hidden",[P.breakpoints.down("sm")]:{gridColumnEnd:"right",gridColumnStart:"right","&::before":{content:"attr(data-column)",display:"block",color:P.colors.text.primary}}}),expandCell:(0,n.css)({justifyContent:"center",[P.breakpoints.down("sm")]:{alignItems:"start",gridArea:"left"}}),expandedContentRow:(0,n.css)({gridColumnEnd:g.length+1,gridColumnStart:b?3:2,gridRow:2,padding:`0 ${P.spacing(3)} 0 ${P.spacing(1)}`,position:"relative",[P.breakpoints.down("sm")]:{gridColumnStart:2,borderTop:`1px solid ${P.colors.border.strong}`,gridRow:"auto",padding:`${P.spacing(1)} 0 0 0`}})})}},10562:(Q,I,e)=>{"use strict";e.d(I,{B:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(75591);const i=({renderExpandedContent:d,...l})=>{const m=(0,o.of)(f);return a.createElement(r.E,{renderExpandedContent:d?(s,h,u)=>a.createElement(a.Fragment,null,h!==u.length-1&&a.createElement("div",{className:(0,n.cx)(m.contentGuideline,m.guideline)}),d(s,h,u)):void 0,renderPrefixHeader:()=>a.createElement("div",{className:m.relative},a.createElement("div",{className:(0,n.cx)(m.headerGuideline,m.guideline)})),renderPrefixCell:(s,h,u)=>a.createElement("div",{className:m.relative},a.createElement("div",{className:(0,n.cx)(m.topGuideline,m.guideline)}),h!==u.length-1&&a.createElement("div",{className:(0,n.cx)(m.bottomGuideline,m.guideline)})),...l})},f=d=>({relative:(0,n.css)({position:"relative",height:"100%"}),guideline:(0,n.css)({left:"-19px",borderLeft:`1px solid ${d.colors.border.weak}`,position:"absolute",[d.breakpoints.down("md")]:{display:"none"}}),topGuideline:(0,n.css)({width:"18px",borderBottom:`1px solid ${d.colors.border.medium}`,top:0,bottom:"50%"}),bottomGuideline:(0,n.css)({top:"50%",bottom:0}),contentGuideline:(0,n.css)({top:0,bottom:0,left:"-49px !important"}),headerGuideline:(0,n.css)({top:"-17px",bottom:0})})},35108:(Q,I,e)=>{"use strict";e.d(I,{j:()=>m});var n=e(32196),a=e(46942),o=e.n(a),r=e(96540),i=e(40845),f=e(67061),d=e(95868),l=e(13840);const m=({children:h,header:u,content:b,footer:g,arrow:P,showAfter:c=300,wrapperClassName:y,disabled:p=!1,...v})=>{const D=(0,r.useRef)(null),E=(0,i.of)(s);if(p)return h;const S=r.createElement(f.B,{direction:"column",gap:0,role:"tooltip"},u&&r.createElement("div",{className:E.card.header},u),r.createElement("div",{className:E.card.body},b),g&&r.createElement("div",{className:E.card.footer},g));return r.createElement(d.I,{content:S,hideAfter:100},(T,M,A)=>r.createElement(r.Fragment,null,D.current&&r.createElement(l.A,{...A,...v,wrapperClassName:o()(E.popover,y),onMouseLeave:M,onMouseEnter:T,onFocus:T,onBlur:M,referenceElement:D.current,renderArrow:P}),r.cloneElement(h,{ref:D,onMouseEnter:T,onMouseLeave:M,onFocus:T,onBlur:M,tabIndex:0})))},s=h=>({popover:(0,n.css)({borderRadius:h.shape.radius.default,boxShadow:h.shadows.z3,background:h.colors.background.primary,border:`1px solid ${h.colors.border.medium}`}),card:{body:(0,n.css)({padding:h.spacing(1)}),header:(0,n.css)({padding:h.spacing(1),background:h.colors.background.secondary,borderBottom:`solid 1px ${h.colors.border.medium}`}),footer:(0,n.css)({padding:h.spacing(.5,1),background:h.colors.background.secondary,borderTop:`solid 1px ${h.colors.border.medium}`})}})},93810:(Q,I,e)=>{"use strict";e.d(I,{A:()=>r});var n=e(96540),a=e(42418);const r=()=>n.createElement(a.F,{severity:"info",title:"Alert evaluation currently paused"},"Notifications for this rule will not fire and no alert instances will be created until the rule is un-paused.")},8406:(Q,I,e)=>{"use strict";e.d(I,{J:()=>d});var n=e(32196),a=e(96540),o=e(84140),r=e(40845),i=e(67061),f=e(14578);const d=({label:m,value:s,icon:h,color:u,size:b="md"})=>{const g=(0,r.of)(l,u,b),P=`${m}: ${s}`;return a.createElement("div",{className:g.wrapper,role:"listitem","aria-label":P,"data-testid":"label-value"},a.createElement(i.B,{direction:"row",gap:0,alignItems:"stretch"},a.createElement("div",{className:g.label},a.createElement(i.B,{direction:"row",gap:.5,alignItems:"center"},h&&a.createElement(f.I,{name:h}),m&&a.createElement("span",{className:g.labelText,title:m.toString()},m??""))),s&&a.createElement("div",{className:g.value,title:s.toString()},s)))},l=(m,s,h)=>{const u=s??m.colors.secondary.main,b=m.isDark?(0,o.A)(u).lighten(5).toString():(0,o.A)(u).darken(5).toString(),g=m.isDark?(0,o.A)(u).darken(5).toString():(0,o.A)(u).lighten(5).toString(),P=s?o.A.mostReadable(u,["#000","#fff"]).toString():m.colors.text.primary;let c=m.spacing(.33,1);switch(h){case"sm":c=m.spacing(.2,.6);break;case"xs":c=m.spacing(0,.5);break;default:break}return{wrapper:(0,n.css)({color:P,fontSize:m.typography.bodySmall.fontSize,borderRadius:m.shape.borderRadius(2)}),labelText:(0,n.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"}),label:(0,n.css)({display:"flex",alignItems:"center",color:"inherit",padding:c,background:u,border:`solid 1px ${b}`,borderTopLeftRadius:m.shape.borderRadius(2),borderBottomLeftRadius:m.shape.borderRadius(2)}),value:(0,n.css)({color:"inherit",padding:c,background:g,border:`solid 1px ${b}`,borderLeft:"none",borderTopRightRadius:m.shape.borderRadius(2),borderBottomRightRadius:m.shape.borderRadius(2),whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"})}}},55196:(Q,I,e)=>{"use strict";e.d(I,{P:()=>d});var n=e(32196),a=e(96540),o=e(40845),r=e(94753),i=e(67061),f=e(14578);const d=({children:m,icon:s,color:h="secondary",direction:u="row",...b})=>{const g=(0,o.of)(l),P=typeof b.onClick=="function",c=u==="row",y=c?"center":"flex-start",p=c?.5:0;return a.createElement("div",{className:(0,n.cx)({[g.interactive]:P}),...b},a.createElement(r.E,{variant:"bodySmall",color:h},a.createElement(i.B,{direction:u,alignItems:y,gap:p,wrap:"wrap"},s&&a.createElement(f.I,{size:"xs",name:s}),m)))},l=()=>({interactive:(0,n.css)({cursor:"pointer"})})},90141:(Q,I,e)=>{"use strict";e.d(I,{A:()=>f});var n=e(96540),a=e(55852),o=e(67061),r=e(14578);const f=(0,n.forwardRef)(function(l,m){return n.createElement(a.$n,{variant:"secondary",size:"sm",type:"button","aria-label":"More",ref:m,...l},n.createElement(o.B,{direction:"row",alignItems:"center",gap:0},"More ",n.createElement(r.I,{name:"angle-down"})))})},76156:(Q,I,e)=>{"use strict";e.d(I,{h:()=>r});var n=e(96540),a=e(12210);const o=({children:i,plugin:f,loadingComponent:d,notInstalledFallback:l})=>{const{loading:m,installed:s}=usePluginBridge(f);return m?d??null:s?React.createElement(React.Fragment,null,i):l??null};function r(i,f,d){const l=new URLSearchParams(d).toString();return`/a/${i}${f}`+(l?"?"+l:"")}},48205:(Q,I,e)=>{"use strict";e.d(I,{Yi:()=>i,hk:()=>r,rS:()=>f});var n=e(96540),a=e(42418),o=e(39938),r=(d=>(d.ContactPoint="contact point",d.Template="template",d.MuteTiming="mute timing",d.AlertRule="alert rule",d.RootNotificationPolicy="root notification policy",d))(r||{});const i=({resource:d,...l})=>n.createElement(a.F,{title:`This ${d} cannot be edited through the UI`,severity:"info",...l},"This ",d," has been provisioned, that means it was created by config. Please contact your server admin to update this ",d,"."),f=()=>n.createElement(o.E,{text:"Provisioned",color:"purple"})},82437:(Q,I,e)=>{"use strict";e.d(I,{c:()=>r});var n=e(96540),a=e(94753),o=e(14578);const r=({namespace:i,group:f})=>f?n.createElement(a.E,{element:"h3",variant:"body"},i," ",n.createElement(o.I,{name:"angle-right","aria-label":">"})," ",f):n.createElement(a.E,{element:"h3",variant:"body"},i)},26058:(Q,I,e)=>{"use strict";e.d(I,{h:()=>o});var n=e(32196),a=e(96540);const o=()=>a.createElement("span",{className:(0,n.css)({flex:1})})},65415:(Q,I,e)=>{"use strict";e.d(I,{O:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=(0,a.forwardRef)(({children:f,state:d,size:l="md",muted:m=!1},s)=>{const h=(0,o.of)(i);return a.createElement("span",{className:(0,n.cx)(h.common,h[d],h[l],{[h.muted]:m}),ref:s},f||d)});r.displayName="StateTag";const i=f=>({common:(0,n.css)({display:"inline-block",color:"white",borderRadius:f.shape.radius.default,fontSize:f.typography.size.sm,textTransform:"capitalize",lineHeight:"1.2",textAlign:"center",fontWeight:f.typography.fontWeightBold}),good:(0,n.css)({backgroundColor:f.colors.success.main,border:`solid 1px ${f.colors.success.main}`,color:f.colors.success.contrastText}),warning:(0,n.css)({backgroundColor:f.colors.warning.main,border:`solid 1px ${f.colors.warning.main}`,color:f.colors.warning.contrastText}),bad:(0,n.css)({backgroundColor:f.colors.error.main,border:`solid 1px ${f.colors.error.main}`,color:f.colors.error.contrastText}),neutral:(0,n.css)({backgroundColor:f.colors.secondary.main,border:`solid 1px ${f.colors.secondary.main}`,color:f.colors.secondary.contrastText}),info:(0,n.css)({backgroundColor:f.colors.primary.main,border:`solid 1px ${f.colors.primary.main}`,color:f.colors.primary.contrastText}),md:(0,n.css)({padding:f.spacing(.5,1),minWidth:f.spacing(8)}),sm:(0,n.css)({padding:f.spacing(.3,.5),minWidth:"52px"}),muted:(0,n.css)({opacity:"0.5"})})},16577:(Q,I,e)=>{"use strict";e.d(I,{Y:()=>l});var n=e(32196),a=e(96540),o=e(40845),r=e(39938),i=e(35108),f=e(83225);const d=["$",".",'"'];function l({input:c,delimiter:y=["{{","}}"]}){const p=(0,o.of)(P),[v,D]=y,E=new RegExp(`(?<before>.*?)(${v}(?<token>.*?)${D}|$)`,"gm"),S=c.split(`
`),T=[];return S.forEach((M,A)=>{Array.from(M.matchAll(E)).forEach((C,O)=>{const R=C.groups?.before,L=C.groups?.token?.trim();if(R&&T.push(a.createElement("span",{key:`${A}-${O}-before`},R)),L){const N=g(L),F=N==="variable"?L:"",K=`${v} ${L} ${D}`;T.push(a.createElement(s,{key:`${A}-${O}-token`,content:K,type:N,description:F}))}}),T.push(a.createElement("br",{key:`${A}-newline`}))}),a.createElement("span",{className:p.wrapper},T)}var m=(c=>(c.Variable="variable",c.Function="function",c.Keyword="keyword",c.Unknown="unknown",c))(m||{});function s({content:c,description:y,type:p}){const v=(0,o.of)(P),D=!p;return a.createElement(i.j,{placement:"top-start",disabled:D,content:a.createElement("div",{className:v.hoverTokenItem},a.createElement(r.E,{tabIndex:0,text:a.createElement(a.Fragment,null,p),color:"blue"})," ",y&&a.createElement("code",null,y))},a.createElement("span",null,a.createElement(r.E,{tabIndex:0,className:v.token,text:c,color:"blue"})))}function h(c){return d.some(y=>c.startsWith(y))}function u(c){return f.keywords.some(y=>c.startsWith(y))}function b(c){return f.builtinFunctions.some(y=>c.startsWith(y))}function g(c){let y;return h(c)?y="variable":u(c)?y="keyword":b(c)?y="function":y="unknown",y}const P=c=>({wrapper:(0,n.css)({whiteSpace:"pre-wrap"}),token:(0,n.css)({cursor:"default",fontFamily:c.typography.fontFamilyMonospace}),popover:(0,n.css)({borderRadius:c.shape.radius.default,boxShadow:c.shadows.z3,background:c.colors.background.primary,border:`1px solid ${c.colors.border.medium}`,padding:c.spacing(1)}),hoverTokenItem:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",gap:c.spacing(1)})})},73750:(Q,I,e)=>{"use strict";e.d(I,{L:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=({children:f,className:d})=>{const l=(0,o.of)(i);return a.createElement("div",{className:(0,n.cx)(l.wrapper,d)},f)},i=f=>({wrapper:(0,n.css)({backgroundColor:f.components.panel.background,border:`solid 1px ${f.components.input.borderColor}`,borderRadius:f.shape.radius.default,padding:f.spacing(.5,1),fontFamily:f.typography.fontFamilyMonospace})})},96636:(Q,I,e)=>{"use strict";e.d(I,{d:()=>o});var n=e(96540),a=e(14778);const o=({component:r,title:i="previous page"})=>{const f=(0,a.i)(),d=(0,n.useCallback)(()=>{f(i)},[f,i]);return n.cloneElement(r,{onClick:d})}},53876:(Q,I,e)=>{"use strict";e.d(I,{X:()=>b});var n=e(32196),a=e(96540),o=e(40996),r=e(40845),i=e(14578),f=e(88575),d=e(60029),l=e(67061),m=e(56034),s=e(10354),h=e(25027),u=e(98164);const b=({onFilterChange:P,defaultQueryString:c})=>{const y=(0,r.of)(g),[p,v]=a.useState(c??"");(0,o.A)(()=>{(0,h.fH)(h.le.filterByLabel),P(p)},600,[p]);const D=a.createElement(i.I,{name:"search"}),E=c?(0,u.J$)(c).length===0:!1;return a.createElement(f.D,{className:y.fixMargin,invalid:E||void 0,error:E?"Query must use valid matcher syntax. See the examples in the help tooltip.":null,label:a.createElement(d.J,null,a.createElement(l.B,{gap:.5,alignItems:"center"},a.createElement("span",null,"Search by label"),a.createElement(m.m,{content:a.createElement("div",null,"Filter alerts using label querying without spaces, ex:",a.createElement("pre",null,'{severity="critical", instance=~"cluster-us-.+"}'),"Invalid use of spaces:",a.createElement("pre",null,'{severity= "critical"}'),a.createElement("pre",null,'{severity ="critical"}'),"Valid use of spaces:",a.createElement("pre",null,'{severity=" critical"}'),"Filter alerts using label querying without braces, ex:",a.createElement("pre",null,'severity="critical", instance=~"cluster-us-.+"'))},a.createElement(i.I,{name:"info-circle",size:"sm"}))))},a.createElement(s.p,{placeholder:"Search",value:p,onChange:S=>v(S.currentTarget.value),"data-testid":"search-query-input",prefix:D,className:y.inputWidth}))},g=P=>({fixMargin:(0,n.css)({marginBottom:0}),inputWidth:(0,n.css)({width:340,flexGrow:0})})},56528:(Q,I,e)=>{"use strict";e.d(I,{GX:()=>N,r4:()=>R});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(49785),f=e(39070),d=e(19845),l=e(72724),m=e(40845),s=e(42418),h=e(67061),u=e(55852),b=e(51440),g=e(29158),P=e(98808),c=e(71680),y=e(1712),p=e(34263),v=e(18225),D=e(76658),E=e(66718),S=e(94822),T=e(98439),M=e(35108),A=e(26058),x=e(30423),C=e(81875),O=e(99106);const R=({queries:V=[],query:_,data:H,error:G,warning:j,isAlertCondition:Y,onSetCondition:oe,onUpdateRefId:se,onRemoveExpression:ne,onUpdateExpressionType:ee,onChangeQuery:Z})=>{const z=(0,m.of)(W),q=_?.type,{setError:ie,clearErrors:de}=(0,i.xW)(),ue=(0,r.useCallback)(Oe=>{Oe?ie("queries",{type:"custom",message:Oe}):de("queries")},[ie,de]),fe=H&&Object.values(H).some(Oe=>!!Oe&&Oe.state===f.Gu.Loading),Se=Array.isArray(H?.series)&&!fe,he=H?.series??[],ce=Y??!1,{seriesCount:me,groupedByState:pe}=K(he),ye=(0,r.useCallback)(Oe=>{const Ne=V.filter(We=>Oe.refId!==We.refId).map(We=>({value:We.refId,label:We.refId}));switch(Oe.type){case E.Tz.math:return r.createElement(c.z,{onChange:Z,query:Oe,labelWidth:"auto",onRunQuery:()=>{}});case E.Tz.reduce:return r.createElement(y.Z,{onChange:Z,refIds:Ne,labelWidth:"auto",query:Oe});case E.Tz.resample:return r.createElement(p.C,{onChange:Z,query:Oe,labelWidth:"auto",refIds:Ne});case E.Tz.classic:return r.createElement(P.z,{onChange:Z,query:Oe,refIds:Ne});case E.Tz.threshold:return r.createElement(D.O,{onChange:Z,query:Oe,labelWidth:"auto",refIds:Ne,onError:ue,useHysteresis:!0});case E.Tz.sql:return r.createElement(v.k,{onChange:Z,query:Oe,refIds:Ne});default:return r.createElement(r.Fragment,null,"Expression not supported: ",Oe.type)}},[Z,V,ue]),Ie=E.uQ.find(Oe=>Oe.value===q)?.description??"";return r.createElement("div",{className:(0,n.cx)(z.expression.wrapper,ce&&z.expression.alertCondition,q===E.Tz.classic&&z.expression.classic,q!==E.Tz.classic&&z.expression.nonClassic)},r.createElement("div",{className:z.expression.stack},r.createElement(B,{refId:_.refId,queryType:q,onRemoveExpression:()=>ne(_.refId),onUpdateRefId:Oe=>se(_.refId,Oe),onUpdateExpressionType:Oe=>ee(_.refId,Oe),onSetCondition:oe,query:_,alertCondition:ce}),r.createElement("div",{className:z.expression.body},G&&r.createElement(s.F,{title:"Expression failed",severity:"error"},G.message),j&&r.createElement(s.F,{title:"Expression warning",severity:"warning"},j.message),r.createElement("div",{className:z.expression.description},Ie),ye(_)),Se&&r.createElement(r.Fragment,null,r.createElement(N,{series:he,isAlertCondition:Y}),r.createElement("div",{className:z.footer},r.createElement(h.B,{direction:"row",alignItems:"center"},r.createElement(A.h,null),r.createElement(F,{isCondition:!!Y,firing:pe[S.cF.Firing].length,normal:pe[S.cF.Inactive].length,seriesCount:me}))))))},L=20,N=({series:V,isAlertCondition:_})=>{const{pageItems:H,previousPage:G,nextPage:j,numberOfPages:Y,pageStart:oe,pageEnd:se}=(0,T.W)(V,1,L),ne=(0,m.of)(W),ee=(0,O.PI)(V),Z=!ee&&(0,d.jq)(V),z=Y>1;return r.createElement("div",{className:ne.expression.results},!ee&&Z&&r.createElement("div",null,H.map((q,ie)=>r.createElement(U,{key:(0,a.uniqueId)(),frame:q,index:oe+ie,isAlertCondition:_}))),!ee&&!Z&&H.map((q,ie)=>r.createElement(w,{key:(0,a.uniqueId)(),frame:q,index:oe+ie,isAlertCondition:_})),ee&&r.createElement("div",{className:(0,n.cx)(ne.expression.noData,ne.mutedText)},"No data"),z&&r.createElement("div",{className:ne.pagination.wrapper,"data-testid":"paginate-expression"},r.createElement(h.B,null,r.createElement(u.$n,{variant:"secondary",fill:"outline",onClick:G,icon:"angle-left",size:"sm","aria-label":"previous-page"}),r.createElement(A.h,null),r.createElement("span",{className:ne.mutedText},oe," - ",se," of ",V.length),r.createElement(A.h,null),r.createElement(u.$n,{variant:"secondary",fill:"outline",onClick:j,icon:"angle-right",size:"sm","aria-label":"next-page"}))))},F=({firing:V,normal:_,isCondition:H,seriesCount:G})=>{const{mutedText:j}=(0,m.of)(W);return G===0?r.createElement("span",{className:j},"No series"):H?r.createElement("span",{className:j},`${G} series: ${V} firing, ${_} normal`):r.createElement("span",{className:j},`${G} series`)};function K(V){const _=V.filter(j=>(0,O.Lm)(j)===void 0).length,H={[S.cF.Firing]:V.filter(j=>(0,O.Lm)(j)!==void 0&&(0,O.Lm)(j)!==0),[S.cF.Inactive]:V.filter(j=>(0,O.Lm)(j)===0)},G=V.length-_;return{groupedByState:H,seriesCount:G}}const B=({refId:V,queryType:_,onUpdateRefId:H,onRemoveExpression:G,onSetCondition:j,alertCondition:Y,query:oe})=>{const se=(0,m.of)(W),ne=(0,m.of)(u.my),[ee,Z]=(0,r.useState)(!1),q=ee!==!1&&ee==="refId";return r.createElement("header",{className:se.header.wrapper},r.createElement(h.B,{direction:"row",gap:.5,alignItems:"center"},r.createElement(h.B,{direction:"row",gap:1,alignItems:"center"},!q&&r.createElement("button",{type:"button",className:(0,n.cx)(ne,se.editable),onClick:()=>Z("refId")},r.createElement("div",{className:se.expression.refId},V)),q&&r.createElement(b.D,{autoFocus:!0,defaultValue:V,minWidth:5,onChange:ie=>{H(ie.currentTarget.value),Z(!1)},onFocus:ie=>ie.target.select(),onBlur:ie=>{H(ie.currentTarget.value),Z(!1)}}),r.createElement("div",null,(0,E.NI)(_))),r.createElement(A.h,null),r.createElement(C.a,{onSetCondition:()=>j(oe.refId),isCondition:Y}),r.createElement(g.K,{name:"trash-alt",variant:"secondary",className:se.mutedIcon,onClick:G,tooltip:"Remove expression"})))},w=({frame:V,index:_,isAlertCondition:H})=>{const G=(0,m.of)(W),j=(0,O.Jw)(V)||"Series "+_,Y=(0,O.Lm)(V),oe=(0,O.JQ)(V),se=Object.entries(oe),ne=se.length>0,ee=H&&Y!==0,Z=H&&Y===0,z=`${ne?"":j}${ne?`{${(0,O.h6)(oe)}}`:""}`;return r.createElement("div",{className:G.expression.resultsRow},r.createElement(h.B,{direction:"row",gap:1,alignItems:"center"},r.createElement("div",{className:G.expression.resultLabel,title:z},r.createElement("span",null,ne?"":j),ne&&r.createElement(r.Fragment,null,r.createElement("span",null,"{"),se.map(([q,ie],de)=>r.createElement("span",{key:(0,a.uniqueId)()},r.createElement("span",{className:G.expression.labelKey},q),r.createElement("span",null,"="),r.createElement("span",null,'"'),r.createElement("span",{className:G.expression.labelValue},ie),r.createElement("span",null,'"'),de<se.length-1&&r.createElement("span",null,", "))),r.createElement("span",null,"}"))),r.createElement("div",{className:G.expression.resultValue},Y),ee&&r.createElement(x.C,{state:S.cF.Firing,size:"sm"}),Z&&r.createElement(x.C,{state:S.cF.Inactive,size:"sm"})))},U=({frame:V,index:_})=>{const H=(0,m.of)(W),G=V.fields[1],j=G.labels,oe=G.config?.displayNameFromDS??(j?(0,O.h6)(G.labels??{}):"Series "+_),se=V.fields[0].values,ne=Z=>V.fields[0].values[Z],ee=Z=>V.fields[1].values[Z];return r.createElement("div",{className:H.expression.resultsRow},r.createElement(h.B,{direction:"row",alignItems:"center"},r.createElement("span",{className:(0,n.cx)(H.mutedText,H.expression.resultLabel),title:oe},oe),r.createElement("div",{className:H.expression.resultValue},r.createElement(M.j,{placement:"right",wrapperClassName:H.timeseriesTableWrapper,content:r.createElement("table",{className:H.timeseriesTable},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Timestamp"),r.createElement("th",null,"Value"))),r.createElement("tbody",null,se.map((Z,z)=>r.createElement("tr",{key:z},r.createElement("td",{className:H.mutedText},(0,l.LE)(ne(z))),r.createElement("td",{className:H.expression.resultValue},ee(z))))))},r.createElement("span",null,"Time series data")))))},W=V=>({expression:{wrapper:(0,n.css)({display:"flex",border:`solid 1px ${V.colors.border.medium}`,flex:1,flexBasis:"400px",borderRadius:V.shape.radius.default}),stack:(0,n.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",gap:0,width:"100%",minWidth:"0"}),classic:(0,n.css)({maxWidth:"100%"}),nonClassic:(0,n.css)({maxWidth:"640px"}),alertCondition:(0,n.css)({}),body:(0,n.css)({padding:V.spacing(1),flex:1}),description:(0,n.css)({marginBottom:V.spacing(1),fontSize:V.typography.size.xs,color:V.colors.text.secondary}),refId:(0,n.css)({fontWeight:V.typography.fontWeightBold,color:V.colors.primary.text}),results:(0,n.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",borderTop:`solid 1px ${V.colors.border.medium}`}),noResults:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center"}),resultsRow:(0,n.css)({padding:`${V.spacing(.75)} ${V.spacing(1)}`,"&:nth-child(odd)":{backgroundColor:V.colors.background.secondary},"&:hover":{backgroundColor:V.colors.background.canvas}}),labelKey:(0,n.css)({color:V.isDark?"#73bf69":"#56a64b"}),labelValue:(0,n.css)({color:V.isDark?"#ce9178":"#a31515"}),resultValue:(0,n.css)({textAlign:"right"}),resultLabel:(0,n.css)({flex:1,overflowX:"auto",display:"inline-block",whiteSpace:"nowrap"}),noData:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:V.spacing()})},mutedText:(0,n.css)({color:V.colors.text.secondary,fontSize:"0.9em",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),header:{wrapper:(0,n.css)({background:V.colors.background.secondary,padding:`${V.spacing(.5)} ${V.spacing(1)}`,borderBottom:`solid 1px ${V.colors.border.weak}`})},footer:(0,n.css)({background:V.colors.background.secondary,padding:V.spacing(1),borderTop:`solid 1px ${V.colors.border.weak}`}),draggableIcon:(0,n.css)({cursor:"grab"}),mutedIcon:(0,n.css)({color:V.colors.text.secondary}),editable:(0,n.css)({padding:`${V.spacing(.5)} ${V.spacing(1)}`,border:`solid 1px ${V.colors.border.weak}`,borderRadius:V.shape.radius.default,display:"flex",flexDirection:"row",alignItems:"center",gap:V.spacing(1),cursor:"pointer"}),timeseriesTableWrapper:(0,n.css)({maxHeight:"500px",overflowY:"scroll"}),timeseriesTable:(0,n.css)({tableLayout:"auto",width:"100%",height:"100%","td, th":{padding:V.spacing(1)},td:{background:V.colors.background.primary},th:{background:V.colors.background.secondary},tr:{borderBottom:`1px solid ${V.colors.border.medium}`,"&:last-of-type":{borderBottom:"none"}}}),pagination:{wrapper:(0,n.css)({borderTop:`1px solid ${V.colors.border.medium}`,padding:V.spacing()})}})},81875:(Q,I,e)=>{"use strict";e.d(I,{a:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(39938),i=e(55852);const f=({isCondition:l,onSetCondition:m})=>{const s=(0,o.of)(d);return l?a.createElement(r.E,{key:"condition",color:"green",icon:"check",text:"Alert condition"}):a.createElement("button",{key:"make-condition",type:"button",className:s.actionLink,onClick:()=>m&&m()},"Set as alert condition")},d=l=>{const m=(0,i.my)(l);return{actionLink:(0,n.css)(m,{color:l.colors.text.link,cursor:"pointer","&:hover":{textDecoration:"underline"}})}}},99106:(Q,I,e)=>{"use strict";e.d(I,{EL:()=>m,JQ:()=>d,Jw:()=>i,Lm:()=>f,PI:()=>h,h6:()=>l,wf:()=>s});var n=e(2543),a=e.n(n),o=e(97706),r=e(57220);const i=u=>{const b=u.fields[0];return b?.config?.displayNameFromDS??u.name??b?.labels?.__name__},f=u=>{const b=u.fields[0]?.values[0];return Number.isFinite(b)?(0,o.h)(b,5):b},d=u=>u.fields[0]?.labels??{},l=u=>Object.entries(u).map(([b,g])=>b+"="+g).join(", "),m=u=>{const b=u.name;if((0,r.Eb)(u.rulesSource))return{name:b,parents:[]};try{const g=JSON.parse(b);if(!Array.isArray(g))throw new Error("not a nested Grafana folder");const P=(0,n.last)(g)??b,c=(0,n.dropRight)(g,1);return{name:P,parents:c}}catch{return{name:u.name,parents:[]}}},s=(u,b=[])=>JSON.stringify(b.concat(u)),h=u=>u.every(g=>g.fields.every(P=>P.values.every(c=>c==null)))},83225:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{AlertmanagerTemplateFunction:()=>a,availableAlertManagerFunctions:()=>o,builtinFunctions:()=>i,conf:()=>l,keywords:()=>f,language:()=>d});var n=(m=>(m.Delimiter="delimiter",m.Keyword="keyword",m.Function="type.identifier",m.String="string",m.Variable="variable.name",m.Number="number",m.Comment="comment",m.Operator="operator",m.Identifier="idenfifier",m))(n||{}),a=(m=>(m.toUpper="toUpper",m.toLower="toLower",m.title="title",m.join="join",m.match="match",m.safeHtml="safeHtml",m.reReplaceAll="reReplaceAll",m.stringSlice="stringSlice",m))(a||{});const o=Object.values(a),i=["and","call","html","index","slice","js","len","not","or","print","printf","println","urlquery",...["eq","ne","lt","le","gt","ge"]],f=["define","if","else","end","range","break","continue","template","block","with"],d={defaultToken:"",keywords:f,functions:[...i,...o],operators:["|"],tokenizer:{root:[[/"/,"string","@string"],[/`/,"string","@rawstring"],[/\d*\d+[eE]([\-+]?\d+)?/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F]/,"number.hex"],[/0[0-7']*[0-7]/,"number.octal"],[/0[bB][0-1']*[0-1]/,"number.binary"],[/\d[\d']*/,"number"],[/\d/,"number"],[/[;,.]/,"delimiter"],[/{{-?/,"delimiter"],[/-?}}/,"delimiter"],[/\.([A-Za-z]+)?/,"variable.name"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":{token:"keyword"},"@functions":{token:"type.identifier"},"@default":"idenfifier"}}],[/\/\*.*\*\//,"comment"]],string:[[/[^\\"]+/,"string"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],rawstring:[[/[^\`]/,"string"],[/`/,"string","@pop"]]}},l={comments:{blockComment:["/*","*/"]},brackets:[["{{","}}"],["(",")"]],autoClosingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}]}},37534:(Q,I,e)=>{"use strict";e.d(I,{FI:()=>n,J4:()=>a,p8:()=>r});const n="grafana_alerting";var a=(i=>(i.OnCall="oncall",i))(a||{});const o=(i,f)=>f.includes(i),r=(i,f)=>{if(!i.grafana_managed_receiver_configs)return!1;const d=i.grafana_managed_receiver_configs.length===1,l=o(i.grafana_managed_receiver_configs[0]?.settings?.url??"",f.map(m=>m.integration_url));return d&&l}},74685:(Q,I,e)=>{"use strict";e.d(I,{j:()=>s});var n=e(32196),a=e(96540),o=e(70713),r=e(19845),i=e(40845),f=e(28138),d=e(72519),l=e(56528),m=e(7921);const s=({data:u,thresholds:b,thresholdsType:g})=>{const P=(0,i.of)(h),c=(0,r.jq)(u.series),y=(0,m.yW)(u),p=g?{mode:g}:void 0,v={from:u.timeRange.from.valueOf(),to:u.timeRange.to.valueOf()};return a.createElement("div",{className:P.wrapper},a.createElement(o.Ay,{disableHeight:!0},({width:D})=>a.createElement("div",{style:{width:D}},c?a.createElement(d.y,{statusMessage:y,data:u.series,eventBus:f.A,height:300,width:D,absoluteRange:v,timeZone:"browser",onChangeTime:()=>{},splitOpenFn:()=>{},loadingState:u.state,thresholdsConfig:b,thresholdsStyle:p}):a.createElement("div",{className:P.instantVectorResultWrapper},a.createElement("header",{className:P.title},"Table"),a.createElement(l.GX,{series:u.series})))))},h=u=>({wrapper:(0,n.css)({width:"100%",position:"relative"}),instantVectorResultWrapper:(0,n.css)({border:`solid 1px ${u.colors.border.medium}`,borderRadius:u.shape.radius.default,padding:0,display:"flex",flexDirection:"column",flexWrap:"nowrap"}),title:(0,n.css)({label:"panel-title",padding:u.spacing(),textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:u.typography.h6.fontSize,fontWeight:u.typography.h6.fontWeight})})},7921:(Q,I,e)=>{"use strict";e.d(I,{G0:()=>T,zy:()=>M,lb:()=>A,YG:()=>N,yW:()=>R,an:()=>C,I3:()=>D,xb:()=>S,_u:()=>L,yr:()=>x});var n=e(2543),a=e(19845),o=e(50082),r=e(39070),i=e(52622),f=e(2913),d=e(55907),l=e(69437),m=e(66718),s=e(86590),h=e(41811),u=e(34525);const b=(0,h.A)(g,(F,K)=>v(F[0])===v(K[0]));function g(F){const K=new u.TS,B=F.map(w=>w.refId);return K.createNodes(B),F.forEach(w=>{const U=w.refId;((0,l.f)(w.model)&&w.model.type==="math"?P(w.model.expression??""):[w.model.expression]).forEach(_=>{U&&_&&!(U===_)&&K.link(_,U)})}),K}function P(F){const K=new RegExp(/\$\{(?<var>[a-zA-Z0-9_ ]+?)\}/gm),B=new RegExp(/\$(?<var>[a-zA-Z0-9_]+)/gm),w=Array.from(F.matchAll(K)).map(W=>W.groups?.var),U=Array.from(F.matchAll(B)).map(W=>W.groups?.var);return(0,n.compact)((0,n.uniq)([...w,...U]))}const c=(0,n.memoize)(y,(F,K)=>F+p(K));function y(F,K){const B=K.getNode(F);let w=[];function U(W){const V=W.inputEdges;V.length>0?V.forEach(_=>{_.inputNode&&U(_.inputNode)}):w?.push(W)}return U(B),w.map(W=>W.name)}function p(F){return Object.keys(F.nodes).map(K=>{const B=F.nodes[K];let w=B.outputEdges.map(W=>W.outputNode?.name).join(", "),U=B.inputEdges.map(W=>W.inputNode?.name).join(", ");return`${B.name}:${w}:${U}`}).join(" ")}function v(F){return F.map(K=>{const B=(0,l.f)(K.model)?K.model.type:K.queryType;return K.refId+(K.model.expression??"")+B}).join()}function D(F,K,B){return F.map(w=>{if(K===B||!(0,l.f)(w.model))return w;const U=w.model.type==="math",W=w.model.type==="reduce",V=w.model.type==="resample",_=w.model.type==="classic_conditions",H=w.model.type==="threshold";if(U)return{...w,model:{...w.model,expression:E(w.model.expression??"",K,B)}};if(V||W||H){const G=w.model.expression===K;return{...w,model:{...w.model,expression:G?B:w.model.expression}}}if(_){const G=w.model.conditions?.map(j=>({...j,query:{...j.query,params:j.query.params.map(Y=>Y===K?B:Y)}}));return{...w,model:{...w.model,conditions:G}}}return w})}function E(F,K,B){const w=new RegExp("(\\$"+K+"\\b)|(\\${"+K+"})","gm"),U="${"+B+"}";return F.replace(w,U)}function S(F,K){return F.find(B=>B.refId===K)!==void 0}function T(F){return F.includes("/")||F.includes("\\")?'Cannot contain "/" or "\\" characters':!0}function M(F){if(F.series.length===0)return;const K=(0,a.jq)(F.series);let B;return K&&(B=new Error("You cannot use time series data as an alert condition, consider adding a reduce expression.")),B}function A(F){if(F.errors?.length)return new Error(F.errors[0].message)}function x(F){const B=(F[0]?.meta?.notices??[]).find(w=>w.severity==="warning")?.text;return B?new Error(B):void 0}function C(F,K){const B={},w=[m.Tz.threshold,m.Tz.classic];if(!K)return B;for(const V of F){if(!(0,l.f)(V.model)||!w.includes(V.model.type)||!Array.isArray(V.model.conditions)||V.model.refId!==K)continue;const _=V.model.conditions.some(O);V.model.conditions.forEach(H=>{const G=H.evaluator.params,j=H.query?.params[0]??V.model.expression;if(!j)return;const Y=O(H);try{const oe=b(F),se=c(j,oe);F.filter(ee=>se.includes(ee.refId)).forEach(ee=>{const Z=ee.refId,q=!!(!(0,l.f)(ee?.model)&&Z);Z&&!B[Z]&&(B[Z]={config:{mode:o.O.Absolute,steps:[]},mode:i.Ly.Line}),Z&&q&&!Y&&!_?U(Z,G[0]):Z&&q&&Y&&(W(Z,G,H.evaluator.type),B[Z].mode=i.Ly.LineAndArea)})}catch(oe){console.error("Failed to parse thresholds",oe);return}})}function U(V,_){B[V].config.steps.push({value:-1/0,color:"transparent"},{value:_,color:f.config.theme2.colors.error.main})}function W(V,_,H){H===d.p.IsWithinRange&&B[V].config.steps.push({value:-1/0,color:"transparent"},{value:_[0],color:f.config.theme2.colors.error.main},{value:_[1],color:f.config.theme2.colors.error.main},{value:_[1],color:"transparent"}),H===d.p.IsOutsideRange&&B[V].config.steps.push({value:-1/0,color:f.config.theme2.colors.error.main},{value:_[0],color:f.config.theme2.colors.error.main},{value:_[0],color:"transparent"},{value:_[1],color:f.config.theme2.colors.error.main}),B[V].config.steps.sort((G,j)=>G.value-j.value),B[V].config.steps=B[V].config.steps.filter(G=>G.value!==void 0)}return B}function O(F){return F.evaluator.type===d.p.IsWithinRange||F.evaluator.type===d.p.IsOutsideRange}function R(F){const K="Failed to fetch data";if(F.state!==r.Gu.Error)return;const B=F.errors;return B?.length?B.map(w=>w.message??K).join(", "):F.error?.message??K}function L(F=""){return F==="recording"?s.Z.cloudRecording:s.Z.grafana}function N(F,K){const B=K.filter(V=>!(0,l.f)(V.model)).map(V=>V.refId),w=F.filter(V=>!(0,l.f)(V.model)).map(V=>V.refId),[U,W]=(0,n.xor)(w,B);return[U,W]}},13064:(Q,I,e)=>{"use strict";e.d(I,{C:()=>d});var n=e(87836),a=e(72880),o=e(70416),r=e(47232),i=e(72724),f=e(25968);function d(m,s){if(!m||!s||!(0,o.vd)(m))return;let h;try{h=(0,f.M9)(s)}catch{return}if((0,f.mo)(m))return;const u=Date.parse(m||""),b=(0,n.A)(u,h);return(0,a.Y)(b,new Date)?{humanized:`within ${s}`,fullDate:`within ${s}`}:{humanized:`in ${(0,r.KQ)(b).locale("en").fromNow(!0)}`,fullDate:(0,i.LE)(b,{format:"YYYY-MM-DD HH:mm:ss"})}}function l(m){if(!m)return null;if(!isNullDate(m))return formatDistanceToNowStrict(new Date(m))}},5179:(Q,I,e)=>{"use strict";e.d(I,{K:()=>o,k:()=>r});var n=e(96540);const a=n.createContext(void 0),o=({children:i,rule:f,identifier:d})=>{const l={rule:f,identifier:d};return n.createElement(a.Provider,{value:l},i)},r=()=>{const i=n.useContext(a);if(i===void 0)throw new Error("useAlertRule must be used within a AlertRuleContext");return i}},45314:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>hn,lf:()=>tt});var n=e(32196),a=e(2543),o=e(96540),r=e(67061),i=e(42418),f=e(40980),d=e(72109),l=e(94753),m=e(40845),s=e(55852),h=e(83277),u=e(93810),b=e(6671),g=e(94822),P=e(79741),c=e(85244),y=e(55740),p=e(56361),v=e(23662),D=e(3704),E=e(69087),S=e(37959),T=e(48205),M=e(96636),A=e(99106),x=e(51921);function C(){return o.createElement(i.F,{severity:"info",title:"This rule is part of a federated rule group.",bottomSpacing:0,topSpacing:2},o.createElement(r.B,{direction:"column"},"Federated rule groups are currently an experimental feature.",o.createElement(s.$n,{fill:"text",icon:"book"},o.createElement("a",{href:"https://grafana.com/docs/metrics-enterprise/latest/tenant-management/tenant-federation/#cross-tenant-alerting-and-recording-rule-federation"},"Read documentation"))))}var O=e(14578);function R(){return o.createElement(l.E,{variant:"bodySmall",color:"warning"},o.createElement(r.B,{direction:"row",alignItems:"center",gap:.25,wrap:"nowrap",flex:"0 0 auto"},o.createElement(O.I,{name:"pause",size:"xs"})," Paused"))}var L=e(5179);const N=mt=>{const Bt=(0,m.of)(F,mt);return o.createElement(r.B,{direction:"row",gap:.5},o.createElement("div",{className:Bt.dot}))},F=(mt,Bt)=>{const Jt=mt.spacing(1.25),Rn=`calc(${Jt} / 2.5)`,Mt=Bt.color==="error",wt=Bt.color==="success",Ht=Bt.color==="warning";return{dot:(0,n.css)({width:Jt,height:Jt,borderRadius:"100%",backgroundColor:mt.colors.secondary.main,outline:`solid ${Rn} ${mt.colors.secondary.transparent}`,margin:Rn},wt&&(0,n.css)({backgroundColor:mt.colors.success.main,outlineColor:mt.colors.success.transparent}),Ht&&(0,n.css)({backgroundColor:mt.colors.warning.main,outlineColor:mt.colors.warning.transparent}),Mt&&(0,n.css)({backgroundColor:mt.colors.error.main,outlineColor:mt.colors.error.transparent}))}},K=({health:mt})=>{const Bt=tt(mt),Jt=Bt?"error":"success",Rn=Bt?"Recording error":"Recording";return o.createElement(w,{color:Jt,text:Rn})},B=({state:mt,health:Bt})=>{let Jt,Rn;switch(mt){case g.cF.Inactive:Rn="success",Jt="Normal";break;case g.cF.Firing:Rn="error",Jt="Firing";break;case g.cF.Pending:Rn="warning",Jt="Pending";break}return tt(Bt)&&(Rn="error",Jt="Error"),Bt==="nodata"&&(Rn="warning",Jt="No data"),o.createElement(w,{color:Rn,text:Jt})};function w({color:mt,text:Bt}){return o.createElement(r.B,{direction:"row",gap:.5,wrap:"nowrap",flex:"0 0 auto"},o.createElement(N,{color:mt}),o.createElement(l.E,{variant:"bodySmall",color:mt},Bt))}var U=e(72095),W=e(10534),V=e(55196),_=e(16577),H=(mt=>(mt.GrafanaManagedAlertRule="Grafana-managed alert rule",mt.CloudAlertRule="Cloud alert rule",mt.CloudRecordingRule="Cloud recording rule",mt))(H||{});const G=({rule:mt})=>{const Bt=(0,m.of)(Y);let Jt;(0,v.lT)(mt.rulerRule)?Jt="Grafana-managed alert rule":(0,v.i7)(mt.rulerRule)?Jt="Cloud recording rule":Jt="Cloud alert rule";const Rn=mt.promRule?.evaluationTime,Mt=mt.promRule?.lastEvaluation,wt=(0,o.useCallback)(()=>(0,v.lT)(mt.rulerRule)?mt.rulerRule.grafana_alert.uid:"",[mt.rulerRule]),Ht=(0,v.i7)(mt.rulerRule)?void 0:mt.annotations??[],tn=Number.isFinite(Rn);return o.createElement(r.B,{direction:"column",gap:3},o.createElement("div",{className:Bt.metadataWrapper},o.createElement(V.P,{direction:"column"},"Rule type",o.createElement(l.E,{color:"primary"},Jt)),o.createElement(V.P,{direction:"column"},(0,v.lT)(mt.rulerRule)&&o.createElement(o.Fragment,null,"Rule Identifier",o.createElement(r.B,{direction:"row",alignItems:"center",gap:.5},o.createElement(l.E,{color:"primary"},mt.rulerRule.grafana_alert.uid,o.createElement(W.b,{fill:"text",variant:"secondary",icon:"copy",size:"sm",getText:wt}))))),o.createElement(V.P,{direction:"column"},tn&&o.createElement(o.Fragment,null,"Last evaluation",Mt&&Rn?o.createElement("span",null,o.createElement(l.E,{color:"primary"},(0,U.B)(new Date(Mt))," ago"),", took"," ",o.createElement(l.E,{color:"primary"},Rn,"ms")):null)),o.createElement(V.P,{direction:"column"},!(0,v.i7)(mt.rulerRule)&&o.createElement(o.Fragment,null,"Pending period",o.createElement(l.E,{color:"primary"},mt.rulerRule?.for??"0s"))),(0,v.lT)(mt.rulerRule)&&o.createElement(o.Fragment,null,o.createElement(V.P,{direction:"column"},"Alert state if no data or all values are null",o.createElement(l.E,{color:"primary"},mt.rulerRule.grafana_alert.no_data_state)),o.createElement(V.P,{direction:"column"},"Alert state if execution error or timeout",o.createElement(l.E,{color:"primary"},mt.rulerRule.grafana_alert.exec_err_state)))),Ht&&o.createElement(o.Fragment,null,o.createElement(l.E,{variant:"h4"},"Annotations"),Object.keys(Ht).length===0?o.createElement(l.E,{variant:"bodySmall",color:"secondary",italic:!0},"No annotations"):o.createElement("div",{className:Bt.metadataWrapper},Object.entries(Ht).map(([It,Xe])=>o.createElement(V.P,{direction:"column",key:It},It,o.createElement(j,{value:Xe}))))))};function j({value:mt}){const Bt=mt&&mt.startsWith("http"),Jt=o.createElement(_.Y,{input:mt,delimiter:["{{","}}"]});return Bt?o.createElement(d.Y,{variant:"bodySmall",href:mt,external:!0},mt):o.createElement(l.E,{color:"primary"},Jt)}const Y=mt=>({metadataWrapper:(0,n.css)({display:"grid",gridTemplateColumns:"auto auto",rowGap:mt.spacing(3),columnGap:mt.spacing(12)})});var oe=e(32264),se=e(46013);const ne=(0,o.lazy)(()=>e.e(7409).then(e.bind(e,87409))),ee=(0,o.lazy)(()=>e.e(1121).then(e.bind(e,31121))),Z=({rule:mt})=>{const Bt=oe.$.unifiedAlerting.alertStateHistoryBackend,Jt=oe.$.unifiedAlerting.alertStateHistoryPrimary,Mt=[Bt,Jt].some(tn=>tn===se.Q.Loki)?se.Q.Loki:se.Q.Annotations,wt=mt.grafana_alert.id??"",Ht=mt.grafana_alert.uid;return o.createElement(o.Suspense,{fallback:"Loading..."},Mt===se.Q.Loki&&o.createElement(ee,{ruleUID:Ht}),Mt===se.Q.Annotations&&o.createElement(ne,{alertId:wt}))};var z=e(15054),q=e(99938);const ie=({rule:mt})=>o.createElement(q.s,{rule:mt,pagination:{itemsPerPage:z.FG},enableFiltering:!0});var de=e(24120),ue=e(39070),fe=e(76885),Se=e(65879),he=e(11807),ce=e(66602),me=e(39938),pe=e(69437),ye=e(66718),Pe=e(55907),Ie=e(26058),Oe=e(56528),Ne=e(7921),We=e(74685);function Ae({data:mt,thresholds:Bt}){return mt?o.createElement(We.j,{data:mt,thresholds:Bt?.config,thresholdsType:Bt?.mode}):null}var Ue=e(20382),Me=e(57220),$e=e(63066),ke=e(85828);const Ze=({expression:mt})=>o.createElement(ke.m,{options:{readOnly:!0,minimap:{enabled:!1},scrollBeyondLastColumn:0,scrollBeyondLastLine:!1,lineNumbers:"off",cursorWidth:0,overviewRulerLanes:0},defaultLanguage:"sql",height:80,defaultValue:mt,width:"100%"});function ot(mt){return"rawSql"in mt}const xt=null,ct=o.lazy(()=>e.e(8468).then(e.bind(e,58468))),ft=o.lazy(()=>e.e(7011).then(e.bind(e,67011)));function Le({model:mt,dataSource:Bt}){return Bt.type===Me.ol.Prometheus&&(0,$e.Bu)(mt)?o.createElement(ct,{query:mt.expr}):Bt.type===Me.ol.Loki&&(0,$e.Bu)(mt)?o.createElement(ft,{query:mt.expr??""}):ot(mt)?o.createElement(Ze,{expression:mt.rawSql}):o.createElement("pre",null,o.createElement("code",null,(0,Ue.Bh)(mt)))}var re=e(19073);function X({rule:mt,queries:Bt,condition:Jt,evalDataByQuery:Rn={}}){const Mt=(0,a.keyBy)(Object.values(oe.$.datasources),Xe=>Xe.uid),wt=Bt.filter(Xe=>!(0,pe.f)(Xe.model)),Ht=Bt.filter(Xe=>(0,pe.f)(Xe.model)),tn=(0,m.of)(_t),It=(0,Ne.an)(Bt,Jt);return o.createElement(r.B,{gap:1,direction:"column",flex:"1 1 320px"},o.createElement("div",{className:tn.maxWidthContainer},o.createElement(r.B,{gap:1,wrap:"wrap","data-testid":"queries-container"},wt.map(({model:Xe,relativeTimeRange:jn,refId:Qn,datasourceUid:ia},wn)=>{const sa=Mt[ia];return o.createElement(le,{rule:mt,key:wn,refId:Qn,isAlertCondition:Jt===Qn,model:Xe,relativeTimeRange:jn,dataSource:sa,thresholds:It[Qn],queryData:Rn[Qn]})}))),o.createElement("div",{className:tn.maxWidthContainer},o.createElement(r.B,{gap:1,wrap:"wrap","data-testid":"expressions-container"},Ht.map(({model:Xe,refId:jn,datasourceUid:Qn},ia)=>{const wn=Mt[Qn];return(0,pe.f)(Xe)&&o.createElement(we,{key:ia,refId:jn,isAlertCondition:Jt===jn,model:Xe,dataSource:wn,evalData:Rn[jn]})}))))}function le({refId:mt,rule:Bt,thresholds:Jt,model:Rn,dataSource:Mt,queryData:wt,relativeTimeRange:Ht}){const tn=(0,m.of)(Te),It=(0,pe.f)(Rn),[Xe,jn]=(0,re.mh)(Bt,re.j5.Explore),Qn=Xe&&jn,ia=[];if(Mt){const sa=Mt.name??"[[Data source not found]]",La=Mt.meta.info.logos.small;ia.push(o.createElement(De,{name:sa,imgUrl:La,key:"datasource"}))}Ht&&ia.push(o.createElement(l.E,{color:"secondary",key:"timerange"},(0,Se.secondsToHms)(Ht.from)," to now"));let wn;return!It&&Qn&&(wn=Mt&&be(Mt,Rn)),o.createElement(o.Fragment,null,o.createElement(Ke,{refId:mt,headerItems:ia,exploreLink:wn},o.createElement("div",{className:tn.queryPreviewWrapper},o.createElement(ce.Xw,null,Rn&&Mt&&o.createElement(Le,{model:Rn,dataSource:Mt})))),Mt&&o.createElement(Ae,{data:wt,thresholds:Jt}))}function be(mt,Bt){const{uid:Jt,type:Rn}=mt,{refId:Mt,...wt}=Bt;return fe.kM.renderUrl(`${oe.$.appSubUrl}/explore`,{left:JSON.stringify({datasource:mt.uid,queries:[{refId:"A",...wt,datasource:{type:Rn,uid:Jt}}],range:{from:"now-1h",to:"now"}})})}function De({name:mt,imgUrl:Bt}){const Jt=(0,m.of)(Te);return o.createElement("div",{className:Jt.dataSource,key:"datasource"},o.createElement("img",{src:Bt,width:16,alt:mt}),mt)}const Te=mt=>({queryPreviewWrapper:(0,n.css)({margin:mt.spacing(1)}),contentBox:(0,n.css)({flex:"1 0 100%"}),visualization:(0,n.css)({padding:mt.spacing(1)}),dataSource:(0,n.css)({border:`1px solid ${mt.colors.border.weak}`,borderRadius:mt.shape.radius.default,padding:mt.spacing(.5,1),display:"flex",alignItems:"center",gap:mt.spacing(1)})});function we({refId:mt,model:Bt,evalData:Jt,isAlertCondition:Rn}){function Mt(){switch(Bt.type){case ye.Tz.math:return o.createElement(nn,{model:Bt});case ye.Tz.reduce:return o.createElement(bt,{model:Bt});case ye.Tz.resample:return o.createElement(Je,{model:Bt});case ye.Tz.classic:return o.createElement(ht,{model:Bt});case ye.Tz.threshold:return o.createElement(Rt,{model:Bt});case ye.Tz.sql:return o.createElement(he.l,{rawSql:Bt.expression||"",datasourceType:Bt.datasource?.type});default:return o.createElement(o.Fragment,null,"Expression not supported: ",Bt.type)}}return o.createElement(Ke,{refId:mt,headerItems:[o.createElement(l.E,{color:"secondary",key:"expression-type"},(0,a.startCase)(Bt.type))],isAlertCondition:Rn},Mt(),o.createElement(Ie.h,null),Jt&&o.createElement(Oe.GX,{series:Jt.series,isAlertCondition:Rn}))}function Ke({refId:mt,headerItems:Bt=[],children:Jt,isAlertCondition:Rn,exploreLink:Mt}){const wt=(0,m.of)(Ve);return o.createElement("div",{className:(0,n.cx)(wt.container)},o.createElement("header",{className:wt.header},o.createElement("span",{className:wt.refId},mt),Bt,o.createElement(Ie.h,null),Rn&&o.createElement(me.E,{color:"green",icon:"check",text:"Alert condition"}),Mt&&o.createElement(M.d,{component:o.createElement(s.z9,{size:"md",variant:"secondary",icon:"compass",href:Mt},"View in Explore")})),Jt)}const Ve=mt=>({container:(0,n.css)({flex:"1 0 25%",border:`1px solid ${mt.colors.border.weak}`,maxWidth:"100%",borderRadius:mt.shape.radius.default,display:"flex",flexDirection:"column"}),header:(0,n.css)({display:"flex",alignItems:"center",gap:mt.spacing(1),padding:mt.spacing(1),backgroundColor:mt.colors.background.secondary}),textBlock:(0,n.css)({border:`1px solid ${mt.colors.border.weak}`,padding:mt.spacing(.5,1),backgroundColor:mt.colors.background.primary,borderRadius:mt.shape.radius.default}),refId:(0,n.css)({color:mt.colors.text.link,padding:mt.spacing(.5,1),border:`1px solid ${mt.colors.border.weak}`,borderRadius:mt.shape.radius.default})});function ht({model:mt}){const Bt=(0,m.of)(gt),Jt=(0,a.keyBy)(Pe.A.reducerTypes,wt=>wt.value),Rn=(0,a.keyBy)(Pe.A.evalOperators,wt=>wt.value),Mt=(0,a.keyBy)(Pe.A.evalFunctions,wt=>wt.value);return o.createElement("div",{className:Bt.container},mt.conditions?.map(({query:wt,operator:Ht,reducer:tn,evaluator:It},Xe)=>{const jn=en(It);return o.createElement(o.Fragment,{key:Xe},o.createElement("div",{className:Bt.blue},Xe===0?"WHEN":!!Ht?.type&&Rn[Ht?.type]?.text),o.createElement("div",{className:Bt.bold},tn?.type&&Jt[tn.type]?.text),o.createElement("div",{className:Bt.blue},"OF"),o.createElement("div",{className:Bt.bold},wt.params[0]),o.createElement("div",{className:Bt.blue},Mt[It.type].text),o.createElement("div",{className:Bt.bold},jn?`(${It.params[0]}; ${It.params[1]})`:It.params[0]))}))}const gt=mt=>({container:(0,n.css)({padding:mt.spacing(1),display:"grid",gridTemplateColumns:"repeat(6, max-content)",gap:mt.spacing(0,1)}),...Kt(mt)});function bt({model:mt}){const Bt=(0,m.of)(St),{reducer:Jt,expression:Rn,settings:Mt}=mt,wt=ye.Cu.find(It=>It.value===Jt),Ht=Mt?.mode??ye.Mt.Strict,tn=ye.HZ.find(It=>It.value===Ht);return o.createElement("div",{className:Bt.container},o.createElement("div",{className:Bt.label},"Function"),o.createElement("div",{className:Bt.value},wt?.label),o.createElement("div",{className:Bt.label},"Input"),o.createElement("div",{className:Bt.value},Rn),o.createElement("div",{className:Bt.label},"Mode"),o.createElement("div",{className:Bt.value},tn?.label))}const St=mt=>({container:(0,n.css)({padding:mt.spacing(1),display:"grid",gap:mt.spacing(.5),gridTemplateRows:"1fr 1fr",gridTemplateColumns:"repeat(4, 1fr)","> :nth-child(6)":{gridColumn:"span 3"}}),...Kt(mt)});function Je({model:mt}){const Bt=(0,m.of)(rt),{expression:Jt,window:Rn,downsampler:Mt,upsampler:wt}=mt,Ht=ye.PN.find(It=>It.value===Mt),tn=ye.iX.find(It=>It.value===wt);return o.createElement("div",{className:Bt.container},o.createElement("div",{className:Bt.label},"Input"),o.createElement("div",{className:Bt.value},Jt),o.createElement("div",{className:Bt.label},"Resample to"),o.createElement("div",{className:Bt.value},Rn),o.createElement("div",{className:Bt.label},"Downsample"),o.createElement("div",{className:Bt.value},Ht?.label),o.createElement("div",{className:Bt.label},"Upsample"),o.createElement("div",{className:Bt.value},tn?.label))}const rt=mt=>({container:(0,n.css)({padding:mt.spacing(1),display:"grid",gap:mt.spacing(.5),gridTemplateColumns:"repeat(4, 1fr)",gridTemplateRows:"1fr 1fr"}),...Kt(mt)});function Rt({model:mt}){const Bt=(0,m.of)(_t),{expression:Jt,conditions:Rn}=mt,Mt=Rn&&Rn[0]?.evaluator,wt=ye.zd.find(jn=>jn.value===Mt?.type),Ht=Mt?en(Mt):!1,tn=Rn&&Rn[0]?.unloadEvaluator,It=ye.zd.find(jn=>jn.value===tn?.type),Xe=tn?en(tn):!1;return o.createElement(o.Fragment,null,o.createElement("div",{className:Bt.container},o.createElement("div",{className:Bt.label},"Input"),o.createElement("div",{className:Bt.value},Jt),Mt&&o.createElement(o.Fragment,null,o.createElement("div",{className:Bt.blue},wt?.label),o.createElement("div",{className:Bt.bold},Ht?`(${Mt.params[0]}; ${Mt.params[1]})`:Mt.params[0]))),o.createElement("div",{className:Bt.container},tn&&o.createElement(o.Fragment,null,o.createElement("div",{className:Bt.label},"Stop alerting when "),o.createElement("div",{className:Bt.value},Jt),o.createElement(o.Fragment,null,o.createElement("div",{className:Bt.blue},It?.label),o.createElement("div",{className:Bt.bold},Xe?`(${tn.params[0]}; ${tn.params[1]})`:tn.params[0])))))}const _t=mt=>{const{blue:Bt,bold:Jt,...Rn}=Kt(mt);return{...Rn,maxWidthContainer:(0,n.css)({maxWidth:"100%"}),container:(0,n.css)({padding:mt.spacing(1),display:"flex",gap:mt.spacing(.5)}),blue:(0,n.css)(Bt,{margin:"auto 0"}),bold:(0,n.css)(Jt,{margin:"auto 0"})}};function nn({model:mt}){const Bt=(0,m.of)(_t),{expression:Jt}=mt;return o.createElement("div",{className:Bt.container},o.createElement("div",{className:Bt.label},"Input"),o.createElement("div",{className:Bt.value},Jt))}const Kt=mt=>({blue:(0,n.css)({color:mt.colors.text.link}),bold:(0,n.css)({fontWeight:mt.typography.fontWeightBold}),label:(0,n.css)({display:"flex",alignItems:"center",padding:mt.spacing(.5,1),backgroundColor:mt.colors.background.secondary,fontSize:mt.typography.bodySmall.fontSize,lineHeight:mt.typography.bodySmall.lineHeight,fontWeight:mt.typography.fontWeightBold,borderRadius:mt.shape.radius.default}),value:(0,n.css)({padding:mt.spacing(.5,1),border:`1px solid ${mt.colors.border.weak}`,borderRadius:mt.shape.radius.default})});function en(mt){return mt.type===Pe.p.IsWithinRange||mt.type===Pe.p.IsOutsideRange}var Qt=e(36135),An=e(28318),un=e(1932),fn=e(25968);function Tt(mt){if(!mt)return[];const{namespace:Bt,rulerRule:Jt}=mt,{rulesSource:Rn}=Bt;if((0,v.lT)(Jt)){const Mt=Jt.grafana_alert.data;return $t(Mt,Jt.for,mt.group.interval)}if((0,Me.Eb)(Rn)){const Mt=Cn(Rn,mt);return[Yt(Mt,Rn.uid)]}return[]}function $t(mt,Bt,Jt){const Rn=(0,fn.P8)(Bt)??(0,fn.P8)(Jt??"1m"),Mt=Math.floor(Rn/1e3);return mt.map(wt=>(0,un.jM)(wt,Ht=>{const tn=Ht.relativeTimeRange?.from??0,It=Math.max(Mt*3,tn+Mt*2);Ht.relativeTimeRange={from:It,to:0}}))}function Yt(mt,Bt){return{refId:mt.refId,datasourceUid:Bt,queryType:"",model:mt,relativeTimeRange:{from:360,to:0}}}function Cn(mt,Bt){const Jt="A";switch(mt.type){case"prometheus":return{refId:Jt,expr:Bt.query};case"loki":return{refId:Jt,expr:Bt.query};default:throw new Error(`Query for datasource type ${mt.type} is currently not supported by cloud alert rules.`)}}const Tn=({rule:mt})=>{const Bt=(0,o.useMemo)(()=>new An.t,[]),Jt=(0,de.A)(Bt.get()),Rn=vn(Jt),Mt=(0,o.useMemo)(()=>Tt(mt),[mt]),{allDataSourcesAvailable:wt}=(0,Qt.g)(Mt),Ht=(0,o.useCallback)(()=>{if(Mt.length>0&&wt){let It;mt&&(0,v.lT)(mt.rulerRule)&&(It=mt.rulerRule.grafana_alert.condition),Bt.run(Mt,It??"A")}},[Mt,wt,mt,Bt]);(0,o.useEffect)(()=>{wt&&Ht()},[wt,Ht]),(0,o.useEffect)(()=>()=>Bt.destroy(),[Bt]);const tn=(0,v.YN)(mt.group);return o.createElement(o.Fragment,null,Rn?"Loading...":o.createElement(o.Fragment,null,(0,v.lT)(mt.rulerRule)&&!tn&&o.createElement(X,{rule:mt,condition:mt.rulerRule.grafana_alert.condition,queries:Mt,evalDataByQuery:Jt}),!(0,v.lT)(mt.rulerRule)&&!tn&&Jt&&Object.keys(Jt).length>0&&o.createElement(r.B,{direction:"column",gap:1},Mt.map(It=>o.createElement(le,{key:It.refId,rule:mt,refId:It.refId,model:It.model,dataSource:Object.values(oe.$.datasources).find(Xe=>Xe.uid===It.datasourceUid),queryData:Jt[It.refId],relativeTimeRange:It.relativeTimeRange,isAlertCondition:!1}))),!tn&&!wt&&o.createElement(i.F,{title:"Query not available",severity:"warning"},"Cannot display the query preview. Some of the data sources used in the queries are not available.")))};function vn(mt){return mt?!!Object.values(mt).find(Bt=>Bt.state===ue.Gu.Loading):!0}const Kn=()=>o.createElement(o.Fragment,null,"Routing");var Yn=(mt=>(mt.Query="query",mt.Instances="instances",mt.History="history",mt.Routing="routing",mt.Details="details",mt))(Yn||{});const nt=()=>{const{rule:mt}=(0,L.k)(),{pageNav:Bt,activeTab:Jt}=Lt(mt),[Rn,Mt]=(0,o.useState)(),{annotations:wt,promRule:Ht}=mt,tn=tt(mt.promRule?.health),It=(0,v.Z8)(Ht),Xe=(0,v.YN)(mt.group),jn=(0,v.lT)(mt.rulerRule)&&!!mt.rulerRule.grafana_alert.provenance,Qn=(0,v.lT)(mt.rulerRule)&&(0,v.HH)(mt.rulerRule),ia=tn&&!Qn,wn=(0,v.uo)(mt),sa=wt[y.YH.summary];return o.createElement(S.d,{pageNav:Bt,navId:"alert-list",isLoading:!1,renderTitle:La=>o.createElement(je,{name:La,paused:Qn,state:It?Ht.state:void 0,health:mt.promRule?.health,ruleType:mt.promRule?.type,ruleOrigin:wn}),actions:o.createElement(b.l,{rule:mt,showCopyLinkButton:!0,rulesSource:mt.namespace.rulesSource}),info:yt(mt),subTitle:o.createElement(r.B,{direction:"column"},Qn&&o.createElement(u.A,null),sa,Xe&&o.createElement(C,null),jn&&o.createElement(T.Yi,{resource:T.hk.AlertRule,bottomSpacing:0,topSpacing:2}),ia&&o.createElement(i.F,{title:"Something went wrong when evaluating this alert rule",bottomSpacing:0,topSpacing:2},o.createElement("pre",{style:{marginBottom:0}},o.createElement("code",null,mt.promRule?.lastError??"No error message"))))},o.createElement(r.B,{direction:"column",gap:2},o.createElement(f.J,null,Jt==="query"&&o.createElement(Tn,{rule:mt}),Jt==="instances"&&o.createElement(ie,{rule:mt}),Jt==="history"&&(0,v.lT)(mt.rulerRule)&&o.createElement(Z,{rule:mt.rulerRule}),Jt==="routing"&&o.createElement(Kn,null),Jt==="details"&&o.createElement(G,{rule:mt}))),Rn&&o.createElement(x.Z,{redirectTo:!0,identifier:Rn,isProvisioned:jn,onDismiss:()=>Mt(void 0)}))},yt=mt=>{const{labels:Bt,annotations:Jt,group:Rn}=mt,Mt=[],wt=Jt[y.YH.runbookURL],Ht=Jt[y.YH.dashboardUID],tn=Jt[y.YH.panelID],It=Ht&&tn,Xe=Ht,jn=!(0,a.isEmpty)(Bt),Qn=Rn.interval;return wt&&Mt.push({label:"Runbook",value:o.createElement(d.Y,{variant:"bodySmall",href:wt,external:!0},(0,a.truncate)(wt,{length:42}))}),It?Mt.push({label:"Dashboard and panel",value:o.createElement(M.d,{title:mt.name,component:o.createElement(d.Y,{variant:"bodySmall",href:(0,p.D2)(Ht,tn)},"View panel")})}):Xe&&Mt.push({label:"Dashboard",value:o.createElement(M.d,{title:mt.name,component:o.createElement(d.Y,{title:mt.name,variant:"bodySmall",href:(0,p.JM)(Ht)},"View dashboard")})}),Qn&&Mt.push({label:"Evaluation interval",value:o.createElement(l.E,{color:"primary"},"Every ",Qn)}),jn&&Mt.push({label:"Labels",value:o.createElement(E.m,{labels:Bt,size:"sm"})}),Mt},Vt=mt=>{const Bt=new URLSearchParams([["search",mt.map(([Jt,Rn])=>`${Jt}:"${Rn}"`).join(" ")]]);return(0,D.c)("/alerting/list?"+Bt.toString())},je=({name:mt,paused:Bt=!1,state:Jt,health:Rn,ruleType:Mt,ruleOrigin:wt})=>{const Ht=(0,m.of)(Gt),[tn]=(0,h.s)(),It=Mt===g.JS.Recording,Xe=tn.returnTo?String(tn.returnTo):"/alerting/list";return o.createElement("div",{className:Ht.title},o.createElement(s.z9,{variant:"secondary",icon:"angle-left",href:Xe}),wt&&o.createElement(c.T,{pluginId:wt.pluginId}),o.createElement(l.E,{variant:"h1",truncate:!0},mt),Bt?o.createElement(R,null):o.createElement(o.Fragment,null,Jt&&o.createElement(B,{state:Jt,health:Rn}),It&&o.createElement(K,{health:Rn})))},tt=mt=>mt==="error"||mt==="err";function Dt(){const[mt,Bt]=(0,h.s)(),Jt=mt.tab;return[Ot(Jt)?Jt:"query",wt=>{Bt({tab:wt})}]}function Ot(mt){return typeof mt=="string"&&Object.values(Yn).includes(mt)}function Lt(mt){const[Bt,Jt]=Dt(),{annotations:Rn,promRule:Mt}=mt,wt=Rn[y.YH.summary],Ht=(0,v.Z8)(Mt),tn=Ht?(Mt.alerts??[]).length:void 0,It=(0,A.EL)(mt.namespace).name,Xe=mt.group.name,jn=(0,v.lT)(mt.rulerRule)&&Ht,Qn=(0,v.KB)(mt.promRule);return{pageNav:{...P.defaultPageNav,text:mt.name,subTitle:wt,children:[{text:"Query and conditions",active:Bt==="query",onClick:()=>{Jt("query")}},{text:"Instances",active:Bt==="instances",onClick:()=>{Jt("instances")},tabCounter:tn,hideFromTabs:Qn},{text:"History",active:Bt==="history",onClick:()=>{Jt("history")},hideFromTabs:!jn},{text:"Details",active:Bt==="details",onClick:()=>{Jt("details")}}],parentItem:{text:Xe,url:Vt([["namespace",It],["group",Xe]]),parentItem:{text:It,url:Vt([["namespace",It]])}}},activeTab:Bt}}const Gt=()=>({title:(0,n.css)({display:"flex",alignItems:"center",gap:8,minWidth:0})}),hn=nt},2426:(Q,I,e)=>{"use strict";e.d(I,{D:()=>v});var n=e(96540),a=e(8249),o=e(47232),r=e(74135),i=e(23662),f=e(69087),d=e(75591),l=e(3197),m=e(83122),s=e(29158),h=e(24401),u=e(30973);const b=({rule:E,instance:S,extensionPointId:T})=>{const[M,A]=(0,n.useState)(),x=(0,n.useMemo)(()=>({instance:S,rule:E}),[S,E]),{extensions:C}=(0,l.vl)({context:x,extensionPointId:T,limitPerPlugin:3});if(C.length===0)return null;const O=n.createElement(u.w,{extensions:C,onSelect:A});return n.createElement(n.Fragment,null,n.createElement(m.m,{placement:"bottom-start",overlay:O},n.createElement(s.K,{name:"ellipsis-v","aria-label":"Actions",variant:"secondary"})),!!M&&!!M.path&&n.createElement(h.s,{path:M.path,title:M.title,onDismiss:()=>A(void 0)}))};var g=e(33225),P=e(71223),c=e(84396);const y=({instance:E})=>{const S=(0,g.Hx)(E.annotations),T=(0,g.gO)(S);return n.createElement("div",null,E.value&&n.createElement(c.X,{label:"Value",horizontal:!0},E.value),S.map(([M,A])=>n.createElement(P.s,{key:M,annotationKey:M,value:A,valueLink:T.get(M)})))};var p=e(30423);const v=({rule:E,instances:S,pagination:T,footerRow:M})=>{const A=(0,n.useMemo)(()=>S.length>1?(0,a.yO)(S.map(C=>C.labels)):{},[S]),x=(0,n.useMemo)(()=>S.map(C=>({data:{rule:E,alert:{...C,commonLabels:A}},id:(0,i.RI)(C)})),[A,S,E]);return n.createElement(d.E,{cols:D,isExpandable:!0,items:x,renderExpandedContent:({data:C})=>n.createElement(y,{instance:C.alert}),pagination:T,footerRow:M})},D=[{id:"state",label:"State",renderCell:({data:{alert:{state:E}}})=>n.createElement(p.C,{state:E}),size:"80px"},{id:"labels",label:"Labels",renderCell:({data:{alert:{labels:E,commonLabels:S}}})=>n.createElement(f.m,{labels:E,commonLabels:S,size:"sm"})},{id:"created",label:"Created",renderCell:({data:{alert:{activeAt:E}}})=>n.createElement(n.Fragment,null,E.startsWith("0001")?"-":(0,o.KQ)(E).format("YYYY-MM-DD HH:mm:ss")),size:"150px"},{id:"actions",label:"",renderCell:({data:{alert:E,rule:S}})=>n.createElement(b,{rule:S,instance:E,extensionPointId:r.S.AlertInstanceAction,key:"alert-instance-extension-point"}),size:"40px"}]},30423:(Q,I,e)=>{"use strict";e.d(I,{C:()=>f});var n=e(96540),a=e(56034),o=e(14578),r=e(23662),i=e(65415);const f=n.memo(({state:d,isPaused:l=!1,size:m="md",muted:s=!1})=>l?n.createElement(a.m,{content:"Alert evaluation is currently paused",placement:"top"},n.createElement(i.O,{state:"warning",size:m,muted:s},n.createElement(o.I,{name:"pause",size:"xs"})," Paused")):n.createElement(i.O,{state:(0,r.Wy)(d),size:m,muted:s},(0,r.XI)(d)));f.displayName="AlertStateTag"},51921:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>f});var n=e(96540),a=e(24180),o=e(96374),r=e(55852),i=e(18461);function f({identifier:l,isProvisioned:m,redirectTo:s=!1,onDismiss:h}){const u=(0,a.zy)(),[b,g]=(0,n.useState)(m?"confirm":"redirect");if(b==="redirect"){const P=i.$9(l),c=u.pathname+u.search,y=new URLSearchParams({copyFrom:P,returnTo:s?c:""});return n.createElement(a.rd,{to:"/alerting/new?"+y.toString(),push:!0})}return n.createElement(o.u,{isOpen:b==="confirm",title:"Copy provisioned alert rule",body:n.createElement("div",null,n.createElement("p",null,"The new rule will ",n.createElement("strong",null,"not")," be marked as a provisioned rule."),n.createElement("p",null,"You will need to set a new evaluation group for the copied rule because the original one has been provisioned and cannot be used for rules created in the UI.")),confirmText:"Copy",onConfirm:()=>g("redirect"),onDismiss:h})}const d=n.forwardRef(({text:l,ruleIdentifier:m,isProvisioned:s,className:h},u)=>{const[b,g]=(0,n.useState)(!1);return n.createElement(n.Fragment,null,n.createElement(r.$n,{title:"Copy",className:h,size:"sm",key:"clone",variant:"secondary",icon:"copy",onClick:()=>g(!0),ref:u},l),b&&n.createElement(f,{identifier:m,isProvisioned:s,onDismiss:()=>g(!1)}))});d.displayName="CloneRuleButton"},6671:(Q,I,e)=>{"use strict";e.d(I,{l:()=>fe});var n=e(32196),a=e(96540),o=e(24180),r=e(40845),i=e(55852),f=e(67061),d=e(26272),l=e(38138),m=e(83122),s=e(28138),h=e(1932),u=e(3169),b=e(79938),g=e(23662),P=e(730);const y=({rule:he,onPauseChange:ce})=>{const[me]=b.hK.endpoints.rulerRuleGroup.useLazyQuery(),pe=(0,u._2)(),[ye]=b.hK.endpoints.updateRule.useMutation(),Pe=(0,g.lT)(he.rulerRule)&&(0,g.HH)(he.rulerRule),Ie=Pe?"play":"pause",Oe=Pe?"Resume evaluation":"Pause evaluation",Ne=async We=>{if(!(0,g.lT)(he.rulerRule))return;const Ae=he.rulerRule.grafana_alert.uid,Ue=await me({rulerConfig:P.$q,namespace:he.namespace.uid||he.rulerRule.grafana_alert.namespace_uid,group:he.group.name}).unwrap();if(!Ue){pe.error(`Failed to ${We?"pause":"resume"} the rule. Could not get the target group to update the rule.`);return}const Me=Ue.rules.map(ke=>(0,g.lT)(ke)&&ke.grafana_alert.uid===Ae?(0,h.jM)(ke,Ze=>{Ze.grafana_alert.is_paused=We}):ke),$e={interval:Ue.interval,name:Ue.name,rules:Me};await ye({nameSpaceUID:he.namespace.uid||he.rulerRule.grafana_alert.namespace_uid,payload:$e}).unwrap(),ce?.()};return a.createElement(l.W.Item,{label:Oe,icon:Ie,onClick:()=>{Ne(!Pe)}})};var p=e(90141),v=e(74135),D=e(3197),E=e(94822);function S(he){const ce=T(he),{extensions:me}=(0,D.vl)(ce),pe=(0,g.uo)(he),ye=he.promRule?.type;if(!pe||!ye)return[];const{pluginId:Pe}=pe;return me.filter(Ie=>Ie.pluginId===Pe)}function T(he){return(0,a.useMemo)(()=>{switch(he.promRule?.type){case E.JS.Alerting:return{extensionPointId:v.S.AlertingAlertingRuleAction,context:{name:he.name,namespace:he.namespace.name,group:he.group.name,expression:he.query,labels:he.labels,annotations:he.annotations}};case E.JS.Recording:return{extensionPointId:v.S.AlertingRecordingRuleAction,context:{name:he.name,namespace:he.namespace.name,group:he.group.name,expression:he.query,labels:he.labels}};default:return{extensionPointId:""}}},[he])}var M=e(19073),A=e(56361),x=e(18461),C=e(3704),O=e(56034),R=e(12210),L=e(99494),N=e(76156);const F=({title:he="",severity:ce="",url:me=""})=>{const pe=createBridgeURL(SupportedPlugin.Incident,"/incidents/declare",{title:he,severity:ce,url:me}),{loading:ye,installed:Pe,settings:Ie}=usePluginBridge(SupportedPlugin.Incident);return React.createElement(React.Fragment,null,ye===!0&&React.createElement(Button,{icon:"fire",size:"sm",type:"button",disabled:!0},"Declare Incident"),Pe===!1&&React.createElement(Tooltip,{content:"Grafana Incident is not installed or is not configured correctly"},React.createElement(Button,{icon:"fire",size:"sm",type:"button",disabled:!0},"Declare Incident")),Ie&&React.createElement(LinkButton,{icon:"fire",size:"sm",type:"button",href:pe},"Declare Incident"))},K=({title:he="",severity:ce="",url:me=""})=>{const pe=(0,N.h)(L.W.Incident,"/incidents/declare",{title:he,severity:ce,url:me}),{loading:ye,installed:Pe,settings:Ie}=(0,R._)(L.W.Incident);return a.createElement(a.Fragment,null,ye===!0&&a.createElement(l.W.Item,{label:"Declare incident",icon:"fire",disabled:!0}),Pe===!1&&a.createElement(O.m,{content:"Grafana Incident is not installed or is not configured correctly"},a.createElement(l.W.Item,{label:"Declare incident",icon:"fire",disabled:!0})),Ie&&a.createElement(l.W.Item,{label:"Declare incident",url:pe,icon:"fire"}))},B=({rule:he,identifier:ce,showCopyLinkButton:me,handleSilence:pe,handleDelete:ye,handleDuplicateRule:Pe,onPauseChange:Ie,buttonSize:Oe})=>{const[Ne,We]=(0,M.mh)(he,M.j5.Pause),Ae=Ne&&We,[Ue,Me]=(0,M.mh)(he,M.j5.Delete),$e=Ue&&Me,[ke,Ze]=(0,M.mh)(he,M.j5.Duplicate),ot=ke&&Ze,[xt,ct]=(0,M.mh)(he,M.j5.Silence),ft=xt&&ct,[Le,re]=(0,M.mh)(he,M.j5.ModifyExport),X=Le&&re,le=S(he),be=le.length>0,De=(!(0,A.y$)()||(0,A.ES)())&&(0,g.Z8)(he.promRule)&&he.promRule.state===E.cF.Firing,Te=(0,A.S2)(he.namespace.rulesSource,he),we=[Ae,ft,De,ot].some(Boolean)&&[me,X].some(Boolean),Ke=a.createElement(a.Fragment,null,Ae&&a.createElement(y,{rule:he,onPauseChange:Ie}),ft&&a.createElement(l.W.Item,{label:"Silence notifications",icon:"bell-slash",onClick:pe}),De&&a.createElement(K,{title:he.name,url:""}),ot&&a.createElement(l.W.Item,{label:"Duplicate",icon:"copy",onClick:()=>Pe(ce)}),we&&a.createElement(l.W.Divider,null),Te&&a.createElement(l.W.Item,{label:"Copy link",icon:"share-alt",onClick:()=>w(Te)}),X&&a.createElement(l.W.Item,{label:"Export",icon:"download-alt",childItems:[a.createElement(U,{key:"export-with-modifications",identifier:ce})]}),be&&a.createElement(a.Fragment,null,a.createElement(l.W.Divider,null),le.map(Ve=>a.createElement(l.W.Item,{key:Ve.id,label:Ve.title,icon:Ve.icon,onClick:Ve.onClick}))),$e&&a.createElement(a.Fragment,null,a.createElement(l.W.Divider,null),a.createElement(l.W.Item,{label:"Delete",icon:"trash-alt",destructive:!0,onClick:()=>ye(he)})));return a.createElement(m.m,{overlay:a.createElement(l.W,null,Ke)},a.createElement(p.A,{size:Oe}))};function w(he){navigator.clipboard?.writeText(he).then(()=>{s.A.emit(d.r1.alertSuccess,["URL copied to clipboard"])})}const U=({identifier:he})=>{const ce=location.pathname+location.search,me=(0,C.c)(`/alerting/${encodeURIComponent(x.$9(he))}/modify-export`,{returnTo:ce});return a.createElement(l.W.Item,{key:"with-modifications",label:"With modifications",icon:"file-edit-alt",url:me})},W=B;var V=e(96374),_=e(99140),H=e(23770),G=e(57220);const j=()=>{const[he,ce]=(0,a.useState)(),me=(0,a.useCallback)(()=>{ce(void 0)},[]),pe=(0,a.useCallback)(Ie=>{ce(Ie)},[]),ye=(0,a.useCallback)(Ie=>{if(Ie&&Ie.rulerRule){const Oe=(0,x.P1)((0,G.EV)(Ie.namespace.rulesSource),Ie.namespace.name,Ie.group.name,Ie.rulerRule);(0,_.JD)((0,H.KH)(Oe,{navigateTo:"/alerting/list"})),me()}},[me]);return[(0,a.useMemo)(()=>a.createElement(V.u,{isOpen:!!he,title:"Delete rule",body:"Deleting this rule will permanently remove it from your alert rule list. Are you sure you want to delete this rule?",confirmText:"Yes, delete",icon:"exclamation-triangle",onConfirm:()=>ye(he),onDismiss:me}),[ye,me,he]),pe,me]};var Y=e(75648),oe=e(87978),se=e(98569),ne=e(17272);const Z=({rulerRule:he,onClose:ce})=>{const{uid:me}=he.grafana_alert,pe=(0,ne.Di)();return a.createElement(oe._,{title:"Silence alert rule",subtitle:"Configure silences to stop notifications from a particular alert rule.",onClose:ce,size:"md"},a.createElement(f.B,{direction:"column"},a.createElement(se.G,{ruleUid:me,formValues:pe,alertManagerSourceName:G.hY,onSilenceCreated:ce,onCancel:ce})))};var z=e(14285),q=e(70383),ie=e(31678),de=e(51921);const ue=he=>window.matchMedia(`(max-width: ${he}px)`).matches,fe=({compact:he,showViewButton:ce,showCopyLinkButton:me,rule:pe,rulesSource:ye})=>{const Pe=(0,ie.useDispatch)(),Ie=(0,o.zy)(),Oe=(0,r.of)(Se),[Ne,We]=j(),[Ae,Ue]=(0,a.useState)(!1),[Me,$e]=(0,a.useState)(void 0),{namespace:ke,group:Ze,rulerRule:ot}=pe,{hasActiveFilters:xt}=(0,z.dI)(),ct=Ie.pathname+Ie.search,ft=(0,g.lT)(pe.rulerRule)&&!!pe.rulerRule.grafana_alert.provenance,[Le,re]=(0,M.mh)(pe,M.j5.Update),X=Le&&re,le=[],be=(0,n.cx)({[Oe.compactButton]:he}),De=he?"sm":"md",Te=(0,G.EV)(ye),we=x.UP(Te,pe);if(ce&&le.push(a.createElement(i.z9,{tooltip:he?"View":void 0,tooltipPlacement:"top",className:be,title:"View",size:De,key:"view",variant:"secondary",icon:"eye",href:(0,A.w$)(ye,pe,ct)},!he&&"View")),ot&&X){const Ke=x.P1(Te,ke.name,Ze.name,ot),Ve=(0,C.c)(`/alerting/${encodeURIComponent(x.$9(Ke))}/edit`,{returnTo:ct});le.push(a.createElement(i.z9,{tooltip:he?"Edit":void 0,tooltipPlacement:"top",title:"Edit",className:be,size:De,key:"edit",variant:"secondary",icon:"pen",href:Ve},!he&&"Edit"))}return a.createElement(f.B,{gap:1},le,a.createElement(W,{buttonSize:De,rule:pe,identifier:we,showCopyLinkButton:me,handleDelete:()=>We(pe),handleSilence:()=>Ue(!0),handleDuplicateRule:()=>$e({identifier:we,isProvisioned:ft}),onPauseChange:()=>{const Ke=xt?void 0:Y.Ys+1;Pe((0,H.Lc)({rulesSourceName:G.hY,limitAlerts:Ke}))}}),Ne,(0,g.lT)(pe.rulerRule)&&Ae&&a.createElement(q.b9,{accessType:"instance"},a.createElement(Z,{rulerRule:pe.rulerRule,onClose:()=>Ue(!1)})),Me?.identifier&&a.createElement(de.Z,{identifier:Me.identifier,isProvisioned:Me.isProvisioned,onDismiss:()=>$e(void 0)}))},Se=he=>({compactButton:(0,n.css)({padding:`0 ${he.spacing(2)}`})})},75648:(Q,I,e)=>{"use strict";e.d(I,{Ys:()=>oe,DI:()=>se});var n=e(32196),a=e(96540),o=e(72724),r=e(47232),i=e(40845),f=e(56034),d=e(97814),l=e(33225),m=e(23662),s=e(25968),h=e(69087),u=e(84396),b=e(71223);function g(Z){const z=(0,i.of)(P),{annotations:q}=Z,ie=(0,l.gO)(q);return q.length===0?null:a.createElement("div",{className:z.annotations},q.map(([de,ue])=>a.createElement(b.s,{key:de,annotationKey:de,value:ue,valueLink:ie.get(de)})))}const P=()=>({annotations:(0,n.css)({marginTop:"46px"})});var c=e(40672),y=e(14778),p=e(55852),v=e(67061),D=e(19073),E=e(46013),S=e(55740),T=e(57220),M=e(56361);const x=({rule:Z,rulesSource:z})=>{const{group:q}=Z,{StateHistoryModal:ie,showStateHistoryModal:de}=(0,E.G)(),ue=(0,y.i)(),[fe,Se]=(0,D.mh)(Z,D.j5.Explore),he=[],ce=(0,m.YN)(q);if((0,T.Eb)(z)&&fe&&Se&&!ce&&he.push(a.createElement(p.z9,{size:"sm",key:"explore",variant:"primary",icon:"chart-line",target:"_blank",href:(0,M.Yp)(z,Z.query)},"See graph")),Z.annotations[S.YH.runbookURL]&&he.push(a.createElement(p.z9,{size:"sm",key:"runbook",variant:"primary",icon:"book",target:"_blank",href:c.sQ.sanitizeUrl(Z.annotations[S.YH.runbookURL])},"View runbook")),Z.annotations[S.YH.dashboardUID]){const me=Z.annotations[S.YH.dashboardUID];if(me){he.push(a.createElement(p.z9,{size:"sm",key:"dashboard",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(me)}`,onClick:()=>{ue(Z.name)}},"Go to dashboard"));const pe=Z.annotations[S.YH.panelID];pe&&he.push(a.createElement(p.z9,{size:"sm",key:"panel",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(me)}?viewPanel=${encodeURIComponent(pe)}`,onClick:()=>{ue(Z.name)}},"Go to panel"))}}return(0,m.lT)(Z.rulerRule)&&he.push(a.createElement(a.Fragment,{key:"history"},a.createElement(p.$n,{size:"sm",icon:"history",onClick:()=>(0,m.lT)(Z.rulerRule)&&de(Z.rulerRule)},"Show state history"),ie)),he.length?a.createElement(v.B,null,he):null};var C=e(19347),O=e(66718);function R(Z){const{rulesSource:z,rule:q}=Z,ie=(0,i.of)(L),de=(0,a.useMemo)(()=>{if((0,T.Eb)(z))return[{name:z.name,icon:z.meta.info.logos.small}];if((0,m.lT)(q.rulerRule)){const{data:ue}=q.rulerRule.grafana_alert,fe=ue.reduce((Se,he)=>{const ce=(0,C.l)().getInstanceSettings(he.datasourceUid);return!ce||ce.uid===O.Uj||(Se[ce.name]={name:ce.name,icon:ce.meta.info.logos.small}),Se},{});return Object.values(fe)}return[]},[q,z]);return de.length===0?null:a.createElement(u.X,{label:"Data source"},de.map(({name:ue,icon:fe},Se)=>a.createElement("div",{key:ue},fe&&a.createElement(a.Fragment,null,a.createElement("img",{alt:`${ue} datasource logo`,className:ie.dataSourceIcon,src:fe})," "),ue)))}function L(Z){const z=Z.spacing(2);return{dataSourceIcon:(0,n.css)({width:z,height:z})}}var N=e(28848),F=e(29317),K=e(20719),B=e(41781),w=e(72307),U=e(71713),W=e(73750);const V=({language:Z,expr:z})=>{const q=(0,a.useMemo)(()=>[(0,B.D)({onlyIn:de=>"type"in de&&de.type==="code_block",getSyntax:()=>Z},{...N.languages,[Z]:Z==="logql"?U.Ay:K.n6})],[Z]),ie=(0,a.useMemo)(()=>(0,w.mO)(z),[z]);return a.createElement(F.KE,{"data-testid":"expression-editor",plugins:q,value:ie})},_=({expression:Z,rulesSource:z})=>{const q=(0,i.of)(H);return a.createElement(W.L,{className:(0,n.cx)(q.well,"slate-query-field")},(0,T.Eb)(z)?a.createElement(V,{expr:Z,language:z.type===T.ol.Loki?"logql":"promql"}):Z)},H=Z=>({well:(0,n.css)({fontFamily:Z.typography.fontFamilyMonospace})});function G(Z){const{annotations:z,rulesSource:q,rule:ie}=Z,de=j();return(0,T.Eb)(q)?a.createElement(u.X,{label:"Expression",horizontal:!0,className:(0,n.cx)({[de.exprRow]:!!z.length})},a.createElement(_,{expression:ie.query,rulesSource:q})):null}const j=()=>({exprRow:(0,n.css)({marginBottom:"46px"})});var Y=e(99938);const oe=15,se=({rule:Z})=>{const z=(0,i.of)(ee),{namespace:{rulesSource:q}}=Z,ie=(0,l.Hx)(Z.annotations);return a.createElement("div",null,a.createElement(x,{rule:Z,rulesSource:q}),a.createElement("div",{className:z.wrapper},a.createElement("div",{className:z.leftSide},a.createElement(ne,{rule:Z}),!!Z.labels&&!!Object.keys(Z.labels).length&&a.createElement(u.X,{label:"Labels",horizontal:!0},a.createElement(h.m,{labels:Z.labels})),a.createElement(G,{rulesSource:q,rule:Z,annotations:ie}),a.createElement(g,{annotations:ie})),a.createElement("div",{className:z.rightSide},a.createElement(R,{rulesSource:q,rule:Z}))),a.createElement(u.X,{label:"Instances",horizontal:!0},a.createElement(Y.s,{rule:Z,itemsDisplayLimit:oe})))},ne=({rule:Z})=>{let z,q=Z.group.interval,ie=Z.promRule?.lastEvaluation,de=Z.promRule?.evaluationTime;return(0,m.i7)(Z.rulerRule)||(z=Z.rulerRule?.for??"0s"),a.createElement(a.Fragment,null,q&&a.createElement(u.X,{label:"Evaluate",horizontal:!0},"Every ",q),a.createElement(u.X,{label:"Pending period",horizontal:!0},z),ie&&!(0,s.mo)(ie)&&a.createElement(u.X,{label:"Last evaluation",horizontal:!0},a.createElement(f.m,{placement:"top",content:`${(0,o.LE)(ie,{format:"YYYY-MM-DD HH:mm:ss"})}`,theme:"info"},a.createElement("span",null,`${(0,r.KQ)(ie).locale("en").fromNow(!0)} ago`))),ie&&!(0,s.mo)(ie)&&de!==void 0&&a.createElement(u.X,{label:"Evaluation time",horizontal:!0},a.createElement(f.m,{placement:"top",content:`${de}s`,theme:"info"},a.createElement("span",null,(0,d.g)({timeInMs:de*1e3,humanize:!0})))))},ee=Z=>({wrapper:(0,n.css)({display:"flex",flexDirection:"row",[Z.breakpoints.down("md")]:{flexDirection:"column"}}),leftSide:(0,n.css)({flex:1}),rightSide:(0,n.css)({[Z.breakpoints.up("md")]:{paddingLeft:"90px",width:"300px"}})})},99938:(Q,I,e)=>{"use strict";e.d(I,{s:()=>E});var n=e(32196),a=e(2543),o=e(96540),r=e(40845),i=e(55852),f=e(53876),d=e(78369),l=e(60029),m=e(94354),s=e(94822);const h=({className:M,onStateFilterChange:A,stateFilter:x,filterType:C,itemPerStateStats:O})=>{const R=(0,r.of)(u),L=w=>function(){return O&&O[w]?o.createElement(d.v,{name:O[w].toFixed(0),colorIndex:9,className:R.tag}):null},N=Object.values(s.Gi).map(w=>({label:w,value:w,component:L(w)})),K=[s.cF.Firing,s.cF.Pending].map(w=>({label:(0,a.capitalize)(w),value:w,component:L(w)})),B=C==="grafana"?N:K;return o.createElement("div",{className:M,"data-testid":"alert-instance-state-filter"},o.createElement(l.J,null,"State"),o.createElement(m.z,{options:B,value:x,onChange:A,onClick:w=>{w===x&&A(void 0)}}))};function u(M){return{tag:(0,n.css)({fontSize:"11px",fontWeight:"normal",padding:M.spacing(.25,.5),verticalAlign:"middle",marginLeft:M.spacing(.5)})}}var b=e(98164),g=e(56361),P=e(64861),c=e(57220),y=e(23662),p=e(2426),v=e(92467);function D({stats:M,onClick:A,href:x}){const C=(0,r.of)(T);return o.createElement("div",{className:C.footerRow},o.createElement("div",null,"Showing ",M.visibleItemsCount," out of ",M.totalItemsCount," instances"),o.createElement(i.z9,{size:"sm",variant:"secondary","data-testid":"show-all",onClick:A,href:x},"Show all ",M.totalItemsCount," alert instances"))}function E(M){const{rule:A,itemsDisplayLimit:x=Number.POSITIVE_INFINITY,pagination:C,enableFiltering:O=!1}=M,{promRule:R,namespace:L,instanceTotals:N}=A,[F,K]=(0,o.useState)(),[B,w]=(0,o.useState)(),[U]=(0,o.useState)(Math.floor(Math.random()*100)),W=`queryString-${U}`,V=(0,r.of)(T),_=(0,c.z2)(L.rulesSource)?c.hY:"prometheus",H=(0,o.useMemo)(()=>(0,y.Z8)(R)&&R.alerts?.length?S(F,B,(0,g.Cp)(P.xB.Importance,R.alerts)):[],[R,B,F]);if(!(0,y.Z8)(R))return null;const G=H.slice(0,x),j=(0,a.countBy)(R.alerts,q=>(0,s.lh)(q.state)),Y=(0,a.sum)([N.alerting,N.inactive,N.pending,N.nodata]),oe=Y-G.length,se={totalItemsCount:Y,visibleItemsCount:G.length},ne=(0,g.w$)(L.rulesSource,M.rule,location.pathname+location.search),ee=(0,v.kc)(N),Z=()=>w(void 0),z=oe?o.createElement(D,{stats:se,onClick:O?Z:void 0,href:O?void 0:ne}):void 0;return o.createElement(o.Fragment,null,O&&o.createElement("div",{className:(0,n.cx)(V.flexRow,V.spaceBetween)},o.createElement("div",{className:V.flexRow},o.createElement(f.X,{key:W,defaultQueryString:F,onFilterChange:q=>K(q)}),o.createElement(h,{filterType:_,stateFilter:B,onStateFilterChange:w,itemPerStateStats:j}))),!O&&o.createElement("div",{className:V.stats},ee),o.createElement(p.D,{rule:A,instances:G,pagination:C,footerRow:z}))}function S(M,A,x){let C=[...x];if(M){const O=(0,b.J$)(M||"");C=C.filter(({labels:R})=>(0,b.Av)(R,O))}return A&&(C=C.filter(O=>(0,s.lh)(O.state)===A)),C}const T=M=>({flexRow:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-end",width:"100%",flexWrap:"wrap",marginBottom:M.spacing(1),gap:M.spacing(1)}),spaceBetween:(0,n.css)({justifyContent:"space-between"}),footerRow:(0,n.css)({display:"flex",flexDirection:"column",gap:M.spacing(1),justifyContent:"space-between",alignItems:"center",width:"100%"}),instancesContainer:(0,n.css)({marginBottom:M.spacing(2)}),stats:(0,n.css)({display:"flex",gap:M.spacing(1),padding:M.spacing(1,0)})})},92467:(Q,I,e)=>{"use strict";e.d(I,{M_:()=>h,j7:()=>u,kc:()=>b});var n=e(2543),a=e.n(n),o=e(55127),r=e.n(o),i=e(96540),f=e(67061),d=e(39938),l=e(54317),m=e(94822);const s={recording:0,alerting:0,[m.cF.Pending]:0,[m.cF.Inactive]:0,paused:0,error:0,nodata:0},h=({namespaces:g})=>{const P={...s};g.forEach(({groups:v})=>{v.forEach(D=>{const E=(0,n.omitBy)(D.totals,n.isUndefined);for(let S in E)P[S]+=E[S]})});const c=b(P),y=!!c.length,p=(0,n.sum)(Object.values(P));return c.unshift(i.createElement(i.Fragment,{key:"total"},p," ",r()("rule",p))),i.createElement(f.B,{direction:"row"},y&&i.createElement("div",null,i.createElement(f.B,{gap:.5},c)))},u=({group:g})=>{const P=g.totals,c=g?.interval,y=b(P),p=!!y.length;return i.createElement(f.B,{direction:"row"},p&&i.createElement("div",null,i.createElement(f.B,{gap:.5},y)),c&&i.createElement(i.Fragment,null,i.createElement("div",null,"|"),i.createElement(d.E,{text:c,icon:"clock-nine",color:"blue"})))};function b(g){const P=[];return g[l.$.Alerting]&&P.push(i.createElement(d.E,{color:"red",key:"firing",text:`${g[l.$.Alerting]} firing`})),g.error&&P.push(i.createElement(d.E,{color:"red",key:"errors",text:`${g.error} errors`})),g.nodata&&P.push(i.createElement(d.E,{color:"blue",key:"nodata",text:`${g.nodata} no data`})),g[l.$.Pending]&&P.push(i.createElement(d.E,{color:"orange",key:"pending",text:`${g[l.$.Pending]} pending`})),g[l.$.Normal]&&g.paused&&P.push(i.createElement(d.E,{color:"green",key:"paused",text:`${g[l.$.Normal]} normal (${g.paused} paused)`})),g[l.$.Normal]&&!g.paused&&P.push(i.createElement(d.E,{color:"green",key:"inactive",text:`${g[l.$.Normal]} normal`})),g.recording&&P.push(i.createElement(d.E,{color:"purple",key:"recording",text:`${g.recording} recording`})),P}},80215:(Q,I,e)=>{"use strict";e.d(I,{s:()=>K});var n=e(32196),a=e(96540),o=e(40845),r=e(56034),i=e(15054),f=e(83903),d=e(85244),l=e(55740),m=e(23662),s=e(75591),h=e(10562),u=e(48205),b=e(82437),g=e(16577),P=e(13064),c=e(6671),y=e(32264),p=e(14578),v=e(82775);function D({rule:U}){const W=(0,o.of)(E),{exceedsLimit:V}=(0,a.useMemo)(()=>(0,v.q)(U.group.interval),[U.group.interval]);return V?a.createElement(r.m,{theme:"error",content:a.createElement("div",null,"A minimum evaluation interval of"," ",a.createElement("span",{className:W.globalLimitValue},y.$.unifiedAlerting.minInterval)," has been configured in Grafana and will be used instead of the ",U.group.interval," interval configured for the Rule Group.")},a.createElement(p.I,{name:"stopwatch-slash",className:W.icon})):null}function E(U){return{globalLimitValue:(0,n.css)({fontWeight:U.typography.fontWeightBold}),icon:(0,n.css)({fill:U.colors.warning.text})}}var S=e(75648),T=e(45314);const M=({rule:U})=>{const W=(0,o.of)(A);return(0,T.lf)(U.health)?a.createElement(r.m,{theme:"error",content:U.lastError||"No error message provided."},a.createElement("div",{className:W.warn},a.createElement(p.I,{name:"exclamation-triangle"}),a.createElement("span",null,"error"))):a.createElement(a.Fragment,null,U.health)},A=U=>({warn:(0,n.css)({display:"inline-flex",flexDirection:"row",alignItems:"center",gap:U.spacing(1),color:U.colors.warning.text})});var x=e(70416),C=e(67061),O=e(62930),R=e(94822),L=e(30423);const N=({rule:U,isDeleting:W,isCreating:V,isPaused:_})=>{const H=(0,o.of)(F),{promRule:G}=U,j=(0,a.useMemo)(()=>{if(G&&(0,m.Z8)(G)&&G.alerts?.length&&G.state!==R.cF.Inactive){const Y=G.activeAt?new Date(G.activeAt):(0,m.Om)(G);if(Y)return a.createElement("span",{title:String(Y),className:H.for},"for"," ",(0,x.dU)({start:Y,end:new Date},!1))}return null},[G,H]);return W?a.createElement(C.B,{gap:1},a.createElement(O.y,null),"Deleting"):V?a.createElement(C.B,{gap:1},a.createElement(O.y,null),"Creating"):G&&(0,m.Z8)(G)?a.createElement(C.B,{gap:1},a.createElement(L.C,{state:G.state,isPaused:_}),!_&&j):G&&(0,m.KB)(G)?a.createElement(a.Fragment,null,"Recording rule"):a.createElement(a.Fragment,null,"n/a")},F=U=>({for:(0,n.css)({fontSize:U.typography.bodySmall.fontSize,color:U.colors.text.secondary,whiteSpace:"nowrap",paddingTop:"2px"})}),K=({rules:U,className:W,showGuidelines:V=!1,emptyMessage:_="No rules found.",showGroupColumn:H=!1,showSummaryColumn:G=!1,showNextEvaluationColumn:j=!1})=>{const Y=(0,o.of)(B),oe=(0,n.cx)(Y.wrapper,W,{[Y.wrapperMargin]:V}),se=(0,a.useMemo)(()=>U.map((Z,z)=>({id:`${Z.namespace.name}-${Z.group.name}-${Z.name}-${z}`,data:Z})),[U]),ne=w(G,H,j);if(!U.length)return a.createElement("div",{className:(0,n.cx)(oe,Y.emptyMessage)},_);const ee=V?h.B:s.E;return a.createElement("div",{className:oe,"data-testid":"rules-table"},a.createElement(ee,{cols:ne,isExpandable:!0,items:se,renderExpandedContent:({data:Z})=>a.createElement(S.DI,{rule:Z}),pagination:{itemsPerPage:i.FG},paginationStyles:Y.pagination}))},B=U=>({wrapperMargin:(0,n.css)({[U.breakpoints.up("md")]:{marginLeft:"36px"}}),emptyMessage:(0,n.css)({padding:U.spacing(1)}),wrapper:(0,n.css)({width:"auto",borderRadius:U.shape.radius.default}),pagination:(0,n.css)({display:"flex",margin:0,paddingTop:U.spacing(1),paddingBottom:U.spacing(.25),justifyContent:"center",borderLeft:`1px solid ${U.colors.border.medium}`,borderRight:`1px solid ${U.colors.border.medium}`,borderBottom:`1px solid ${U.colors.border.medium}`})});function w(U,W,V){const{hasRuler:_,rulerRulesLoaded:H}=(0,f.y)();return(0,a.useMemo)(()=>{const G=[{id:"state",label:"State",renderCell:({data:j})=>{const{namespace:Y}=j,{rulesSource:oe}=Y,{promRule:se,rulerRule:ne}=j,ee=!!(_(oe)&&H(oe)&&se&&!ne),Z=!!(_(oe)&&H(oe)&&ne&&!se),z=(0,m.lT)(j.rulerRule)&&(0,m.HH)(j.rulerRule);return a.createElement(N,{rule:j,isDeleting:ee,isCreating:Z,isPaused:z})},size:"165px"},{id:"name",label:"Name",renderCell:({data:j})=>j.name,size:V?4:5},{id:"metadata",label:"",renderCell:({data:j})=>{const Y=j.rulerRule,oe=(0,m.uo)(j);return oe?a.createElement(d.T,{pluginId:oe.pluginId}):(0,m.lT)(Y)&&Y.grafana_alert.provenance?a.createElement(u.rS,null):null},size:"100px"},{id:"warnings",label:"",renderCell:({data:j})=>a.createElement(D,{rule:j}),size:"45px"},{id:"health",label:"Health",renderCell:({data:{promRule:j,group:Y}})=>j?a.createElement(M,{rule:j}):null,size:"75px"}];return U&&G.push({id:"summary",label:"Summary",renderCell:({data:j})=>a.createElement(g.Y,{input:j.annotations[l.YH.summary]??""}),size:V?4:5}),V&&G.push({id:"nextEvaluation",label:"Next evaluation",renderCell:({data:j})=>{const Y=(0,P.C)(j.promRule?.lastEvaluation,j.group.interval);return Y&&a.createElement(r.m,{placement:"top",content:`${Y?.fullDate}`,theme:"info"},a.createElement("span",null,Y?.humanized))},size:2}),W&&G.push({id:"group",label:"Group",renderCell:({data:j})=>{const{namespace:Y,group:oe}=j;return oe.name==="default"?a.createElement(b.c,{namespace:Y.name}):a.createElement(b.c,{namespace:Y.name,group:oe.name})},size:5}),G.push({id:"actions",label:"Actions",renderCell:({data:j})=>a.createElement(c.l,{compact:!0,showViewButton:!0,rule:j,rulesSource:j.namespace.rulesSource}),size:"200px"}),G},[U,W,V,_,H])}},97754:(Q,I,e)=>{"use strict";e.d(I,{y:()=>i});var n=e(96540),a=e(60021),o=e(65415);const r={[a.Or.Active]:"bad",[a.Or.Unprocessed]:"neutral",[a.Or.Suppressed]:"info"},i=({state:f})=>n.createElement(o.O,{state:r[f]},f)},98569:(Q,I,e)=>{"use strict";e.d(I,{G:()=>q,A:()=>de});var n=e(32196),a=e(2543),o=e(96540),r=e(49785),i=e(40996),f=e(70416),d=e(47232),l=e(17172),m=e(12131),s=e(32264),h=e(39558),u=e(42418),b=e(40845),g=e(84167),P=e(88575),c=e(10354),y=e(21744),p=e(67061),v=e(55852),D=e(91540),E=e(55740),S=e(57220),T=e(60021),M=e(19073),A=e(98164),x=e(56361),C=e(25994),O=e(21594),R=e(29158),L=e(79938);const N=({className:ue,required:fe,ruleUid:Se})=>{const he=(0,b.of)(F),ce=(0,r.xW)(),{control:me,register:pe,formState:{errors:ye}}=ce,{fields:Pe=[],append:Ie,remove:Oe}=(0,r.jz)({name:"matchers"}),[Ne,{data:We}]=L.hK.endpoints.getAlertRule.useLazyQuery();return(0,o.useEffect)(()=>{Se&&Ne({uid:Se})},[Ne,Se]),o.createElement("div",{className:ue},o.createElement(P.D,{label:"Refine affected alerts",required:fe},o.createElement("div",null,o.createElement("div",{className:(0,n.cx)(he.matchers,he.indent)},We&&o.createElement("div",null,o.createElement(P.D,{label:"Alert rule",disabled:!0},o.createElement(c.p,{id:"alert-rule-name",defaultValue:We.grafana_alert.title,disabled:!0})),o.createElement(C.c,null)),Pe.map((Ae,Ue)=>o.createElement("div",{className:he.row,key:`${Ae.id}`,"data-testid":"matcher"},o.createElement(P.D,{label:"Label",invalid:!!ye?.matchers?.[Ue]?.name,error:ye?.matchers?.[Ue]?.name?.message},o.createElement(c.p,{...pe(`matchers.${Ue}.name`,{required:{value:fe,message:"Required."}}),defaultValue:Ae.name,placeholder:"label",id:`matcher-${Ue}-label`})),o.createElement(P.D,{label:"Operator"},o.createElement(r.xI,{control:me,render:({field:{onChange:Me,ref:$e,...ke}})=>o.createElement(O.l6,{...ke,onChange:Ze=>Me(Ze.value),className:he.matcherOptions,options:A.xH,"aria-label":"operator",id:`matcher-${Ue}-operator`}),defaultValue:Ae.operator||A.xH[0].value,name:`matchers.${Ue}.operator`,rules:{required:{value:fe,message:"Required."}}})),o.createElement(P.D,{label:"Value",invalid:!!ye?.matchers?.[Ue]?.value,error:ye?.matchers?.[Ue]?.value?.message},o.createElement(c.p,{...pe(`matchers.${Ue}.value`,{required:{value:fe,message:"Required."}}),defaultValue:Ae.value,placeholder:"value",id:`matcher-${Ue}-value`})),(Pe.length>1||!fe)&&o.createElement(R.K,{"aria-label":"Remove matcher",className:he.removeButton,name:"trash-alt",onClick:()=>Oe(Ue)},"Remove")))),o.createElement(v.$n,{className:he.indent,tooltip:"Refine which alert instances are silenced by selecting label matchers",type:"button",icon:"plus",variant:"secondary",onClick:()=>{const Ae={name:"",value:"",operator:T.ho.equal};Ie(Ae)}},"Add matcher"))))},F=ue=>({wrapper:(0,n.css)({marginTop:ue.spacing(2)}),row:(0,n.css)({marginTop:ue.spacing(1),display:"flex",alignItems:"flex-start",flexDirection:"row",backgroundColor:ue.colors.background.secondary,padding:`${ue.spacing(1)} ${ue.spacing(1)} 0 ${ue.spacing(1)}`,"& > * + *":{marginLeft:ue.spacing(2)}}),removeButton:(0,n.css)({marginLeft:ue.spacing(1),marginTop:ue.spacing(2.5)}),matcherOptions:(0,n.css)({minWidth:"140px"}),matchers:(0,n.css)({maxWidth:`${ue.breakpoints.values.sm}px`,margin:`${ue.spacing(1)} 0`,paddingTop:ue.spacing(.5)}),indent:(0,n.css)({marginLeft:ue.spacing(2)})}),K=N;var B=e(54230);const w=()=>{const{control:ue,getValues:fe}=(0,r.xW)(),{field:{onChange:Se,value:he},fieldState:{invalid:ce}}=(0,r.as)({name:"startsAt",control:ue,rules:{validate:Ae=>fe().endsAt>Ae}}),{field:{onChange:me,value:pe},fieldState:{invalid:ye}}=(0,r.as)({name:"endsAt",control:ue,rules:{validate:Ae=>fe().startsAt<Ae}}),{field:{onChange:Pe,value:Ie}}=(0,r.as)({name:"timeZone",control:ue}),Oe=ce||ye,Ne=(0,d.KQ)(he),We=(0,d.KQ)(pe);return o.createElement(P.D,{className:U.timeRange,label:"Silence start and end",error:Oe?"To is before or the same as from":"",invalid:Oe},o.createElement(B.b,{value:{from:Ne,to:We,raw:{from:Ne,to:We}},timeZone:Ie,onChange:Ae=>{Se((0,d.KQ)(Ae.from)),me((0,d.KQ)(Ae.to))},onChangeTimeZone:Ae=>Pe(Ae),hideTimeZone:!1,hideQuickRanges:!0,placeholder:"Select time range"}))},U={timeRange:(0,n.css)({width:"400px"})};var W=e(45214),V=e(39938),_=e(82843),H=e(25968),G=e(69087),j=e(75591),Y=e(97754);const oe=(ue,fe,Se)=>{const[he,ce]=(0,o.useState)();(0,i.A)(ue,fe,[he]),(0,W.A)(()=>{ce(Se)},[Se])},se=({amSourceName:ue,matchers:fe,ruleUid:Se})=>{const he=[...Se?[{name:E.kW,value:Se,operator:T.ho.equal}]:[],...fe].map(A.Wc),ce=_.m.endpoints.getAlertmanagerAlerts.useLazyQuery,me=(0,b.of)(ee),pe=ne(),ye=Se||fe.some(Ae=>Ae.value&&Ae.name),[Pe,{currentData:Ie=[],isFetching:Oe,isError:Ne}]=ce();if(oe(()=>{ye&&Pe({amSourceName:ue,filter:{matchers:he}})},500,[ue,he]),Ne)return o.createElement(u.F,{title:"Preview not available",severity:"error"},"Error occured when generating preview of affected alerts. Are your matchers valid?");const We=Ie.map(Ae=>({id:Ae.fingerprint,data:Ae}));return o.createElement("div",null,o.createElement("h4",{className:me.title},"Affected alert rule instances",We.length>0?o.createElement(V.E,{className:me.badge,color:"blue",text:We.length}):null),!ye&&o.createElement("span",null,"Add a valid matcher to see affected alerts"),Oe&&o.createElement(h._,{text:"Loading affected alert rule instances..."}),!Oe&&!Ne&&ye&&o.createElement("div",{className:me.table},We.length>0?o.createElement(j.E,{items:We,isExpandable:!1,cols:pe,pagination:{itemsPerPage:10}}):o.createElement("span",null,"No firing alert instances found")))};function ne(){const ue=(0,b.of)(ee);return[{id:"state",label:"State",renderCell:function({data:Se}){return o.createElement(Y.y,{state:Se.status.state})},size:"120px",className:ue.stateColumn},{id:"labels",label:"Labels",renderCell:function({data:Se}){return o.createElement(G.m,{labels:Se.labels,size:"sm"})},size:"auto"},{id:"created",label:"Created",renderCell:function({data:Se}){return o.createElement(o.Fragment,null,(0,H.mo)(Se.startsAt)?"-":(0,d.KQ)(Se.startsAt).format("YYYY-MM-DD HH:mm:ss"))},size:"180px"}]}const ee=ue=>({table:(0,n.css)({maxWidth:`${ue.breakpoints.values.lg}px`}),moreMatches:(0,n.css)({marginTop:ue.spacing(1)}),title:(0,n.css)({display:"flex",alignItems:"center"}),badge:(0,n.css)({marginLeft:ue.spacing(1)}),stateColumn:(0,n.css)({display:"flex",alignItems:"center"})});var Z=e(17272);const z=({silenceId:ue,alertManagerSourceName:fe})=>{const{data:Se,isLoading:he,error:ce}=D.F.endpoints.getSilence.useQuery({id:ue,datasourceUid:(0,S.w5)(fe),ruleMetadata:!0,accessControl:!0}),me=Se?.matchers?.find(Oe=>Oe.name===E.kW)?.value,pe=fe===S.hY,ye=(0,o.useMemo)(()=>{if(!Se)return;const Oe=Se.matchers?.filter(Ne=>Ne.name!==E.kW);return(0,Z.Ee)({...Se,matchers:Oe})},[Se]);return ue&&he?o.createElement(h._,{text:"Loading existing silence information..."}):(0,l.NF)(ce)&&ce.status===404?o.createElement(u.F,{title:`Existing silence "${ue}" not found`,severity:"warning"}):(pe?Se?.accessControl?.write:!0)?o.createElement(q,{ruleUid:me,formValues:ye,alertManagerSourceName:fe}):o.createElement(u.F,{title:"You do not have permission to edit/recreate this silence",severity:"error"})},q=({formValues:ue=(0,Z.Di)(),alertManagerSourceName:fe,onSilenceCreated:Se,onCancel:he,ruleUid:ce})=>{const[me,pe]=(0,M.L7)(M.QI.PreviewSilencedInstances),ye=me&&pe,[Pe,{isLoading:Ie}]=D.F.endpoints.createSilence.useMutation(),Oe=(0,r.mN)({defaultValues:ue}),Ne=(0,b.of)(ie),{register:We,handleSubmit:Ae,formState:Ue,watch:Me,setValue:$e,clearErrors:ke}=Oe,[Ze,ot,xt,ct]=Me(["duration","startsAt","endsAt","matchers"]),ft=()=>{m.Ny.push((0,x.nL)("/alerting/silences",fe))},Le=Se||ft,re=he||ft,X=async Te=>{const{id:we,startsAt:Ke,endsAt:Ve,comment:ht,createdBy:gt,matchers:bt}=Te;ce&&bt.push({name:E.kW,value:ce,operator:T.ho.equal});const St=bt.map(A.Wc).filter(rt=>rt.name&&rt.value),Je=(0,a.pickBy)({id:we,startsAt:Ke,endsAt:Ve,comment:ht,createdBy:gt,matchers:St},rt=>!!rt);await Pe({datasourceUid:(0,S.w5)(fe),payload:Je}).unwrap().then(rt=>{Le?.(rt)})},[le,be]=(0,o.useState)(Ze);(0,i.A)(()=>{if((0,f.vd)(ot)&&(0,f.vd)(xt))if(Ze!==le)$e("endsAt",(0,d.KQ)((0,f.Ri)(new Date(ot),(0,f.E9)(Ze))).toISOString()),be(Ze);else{const Te=new Date(ot).valueOf();if(new Date(xt).valueOf()>Te){const Ke=(0,f.dU)({start:new Date(ot),end:new Date(xt)});$e("duration",Ke),be(Ke)}}},700,[ke,Ze,xt,le,$e,ot]);const De=!!(s.$.bootData.user.isSignedIn&&s.$.bootData.user.name);return o.createElement(r.Op,{...Oe},o.createElement("form",{onSubmit:Ae(X)},o.createElement(g.n,{className:Ne.formContainer},o.createElement("div",{className:Ne.silencePeriod},o.createElement(w,null),o.createElement(P.D,{label:"Duration",invalid:!!Ue.errors.duration,error:Ue.errors.duration&&(Ue.errors.duration.type==="required"?"Required field":Ue.errors.duration.message)},o.createElement(c.p,{...We("duration",{validate:Te=>Object.keys((0,f.E9)(Te)).length===0?"Invalid duration. Valid example: 1d 4h (Available units: y, M, w, d, h, m, s)":void 0}),id:"duration"}))),o.createElement(K,{required:!ce,ruleUid:ce}),o.createElement(P.D,{label:"Comment",required:!0,error:Ue.errors.comment?.message,invalid:!!Ue.errors.comment},o.createElement(y.f,{...We("comment",{required:{value:!0,message:"Required."}}),rows:5,placeholder:"Details about the silence",id:"comment"})),!De&&o.createElement(P.D,{label:"Created By",required:!0,error:Ue.errors.createdBy?.message,invalid:!!Ue.errors.createdBy},o.createElement(c.p,{...We("createdBy",{required:{value:!0,message:"Required."}}),placeholder:"Who's creating the silence"})),ye&&o.createElement(se,{amSourceName:fe,matchers:ct,ruleUid:ce})),o.createElement(p.B,{gap:1},Ie&&o.createElement(v.$n,{disabled:!0,icon:"spinner",variant:"primary"},"Saving..."),!Ie&&o.createElement(v.$n,{type:"submit"},"Save silence"),o.createElement(v.z9,{onClick:re,variant:"secondary"},"Cancel"))))},ie=ue=>({formContainer:(0,n.css)({maxWidth:ue.breakpoints.values.md}),alertRule:(0,n.css)({paddingBottom:ue.spacing(2)}),silencePeriod:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:ue.spacing(1),maxWidth:ue.breakpoints.values.sm,paddingTop:ue.spacing(2)})}),de=z},17272:(Q,I,e)=>{"use strict";e.d(I,{Di:()=>s,Ee:()=>m,LP:()=>l});var n=e(70416),a=e(43127),o=e(47232),r=e(32264),i=e(98164),f=e(32642),d=e(60021);const l=h=>{const u={},b=h.get("comment"),g=h.getAll("matcher"),P=(0,f.ou)(g);return P.length&&(u.matchers=P.map(i.MU)),b&&(u.comment=b),u},m=h=>{const u=new Date,g=Date.parse(h.endsAt)<Date.now()?{start:u,end:(0,n.Ri)(u,{hours:2})}:{start:new Date(h.startsAt),end:new Date(h.endsAt)};return{id:h.id,startsAt:g.start.toISOString(),endsAt:g.end.toISOString(),comment:h.comment,createdBy:h.createdBy,duration:(0,n.dU)(g),isRegex:!1,matchers:h.matchers?.map(i.MU)||[],matcherName:"",matcherValue:"",timeZone:a.lE}},s=h=>{const u=new Date,b=(0,n.Ri)(u,{hours:2});return{id:"",startsAt:u.toISOString(),endsAt:b.toISOString(),comment:`created ${(0,o.KQ)().format("YYYY-MM-DD HH:mm")}`,createdBy:r.$.bootData.user.name,duration:"2h",isRegex:!1,matcherName:"",matcherValue:"",timeZone:a.lE,matchers:[{name:"",value:"",operator:d.ho.equal}],...h}}},19073:(Q,I,e)=>{"use strict";e.d(I,{Ej:()=>v,Hl:()=>A,L7:()=>M,QI:()=>b,RY:()=>P,e2:()=>p,iI:()=>T,j5:()=>g,mh:()=>D});var n=e(96540),a=e(16233),o=e(11167),r=e(60021),i=e(31678),f=e(82843),d=e(70383),l=e(75471),m=e(57220),s=e(56361),h=e(23662),u=e(97009),b=(O=>(O.ViewExternalConfiguration="view-external-configuration",O.UpdateExternalConfiguration="update-external-configuration",O.CreateContactPoint="create-contact-point",O.ViewContactPoint="view-contact-point",O.UpdateContactPoint="edit-contact-points",O.DeleteContactPoint="delete-contact-point",O.ExportContactPoint="export-contact-point",O.CreateNotificationTemplate="create-notification-template",O.ViewNotificationTemplate="view-notification-template",O.UpdateNotificationTemplate="edit-notification-template",O.DeleteNotificationTemplate="delete-notification-template",O.DecryptSecrets="decrypt-secrets",O.CreateNotificationPolicy="create-notification-policy",O.ViewNotificationPolicyTree="view-notification-policy-tree",O.UpdateNotificationPolicyTree="update-notification-policy-tree",O.DeleteNotificationPolicy="delete-notification-policy",O.ExportNotificationPolicies="export-notification-policies",O.ViewAutogeneratedPolicyTree="view-autogenerated-policy-tree",O.CreateSilence="create-silence",O.ViewSilence="view-silence",O.UpdateSilence="update-silence",O.PreviewSilencedInstances="preview-silenced-alerts",O.ViewMuteTiming="view-mute-timing",O.CreateMuteTiming="create-mute-timing",O.UpdateMuteTiming="update-mute-timing",O.DeleteMuteTiming="delete-mute-timing",O.ExportMuteTimings="export-mute-timings",O))(b||{}),g=(O=>(O.Duplicate="duplicate-alert-rule",O.View="view-alert-rule",O.Update="update-alert-rule",O.Delete="delete-alert-rule",O.Explore="explore-alert-rule",O.Silence="silence-alert-rule",O.ModifyExport="modify-export-rule",O.Pause="pause-alert-rule",O))(g||{}),P=(O=>(O.CreateAlertRule="create-alert-rule",O.ViewAlertRule="view-alert-rule",O.UpdateAlertRule="update-alert-rule",O.DeleteAlertRule="delete-alert-rule",O.ExportGrafanaManagedRules="export-grafana-managed-rules",O.ReadConfigurationStatus="read-configuration-status",O.CreateExternalAlertRule="create-external-alert-rule",O.ViewExternalAlertRule="view-external-alert-rule",O.UpdateExternalAlertRule="update-external-alert-rule",O.DeleteExternalAlertRule="delete-external-alert-rule",O))(P||{});const c=!0,y=!1,p=()=>({"create-alert-rule":C(c,i.AccessControlAction.AlertingRuleCreate),"view-alert-rule":C(c,i.AccessControlAction.AlertingRuleRead),"update-alert-rule":C(c,i.AccessControlAction.AlertingRuleUpdate),"delete-alert-rule":C(c,i.AccessControlAction.AlertingRuleDelete),"export-grafana-managed-rules":C(c,i.AccessControlAction.AlertingRuleRead),"read-configuration-status":[c,a.TP.hasPermission(i.AccessControlAction.AlertingInstanceRead)||a.TP.hasPermission(i.AccessControlAction.AlertingNotificationsRead)],"create-external-alert-rule":C(c,i.AccessControlAction.AlertingRuleExternalWrite),"view-external-alert-rule":C(c,i.AccessControlAction.AlertingRuleExternalRead),"update-external-alert-rule":C(c,i.AccessControlAction.AlertingRuleExternalWrite),"delete-external-alert-rule":C(c,i.AccessControlAction.AlertingRuleExternalWrite)}),v=O=>p()[O];function D(O,R){const L=S(O);return(0,n.useMemo)(()=>L[R],[L,R])}function E(O,R){const L=S(O);return useMemo(()=>R.map(N=>L[N]),[L,R])}function S(O){const R=O.namespace.rulesSource,L=typeof R=="string"?R:R.name,N=(0,h.lT)(O.rulerRule)&&!!O.rulerRule.grafana_alert.provenance,F=(0,h.YN)(O.group),K=(0,h.lT)(O.rulerRule),B=(0,h.Tm)(O),w=N||F||B,{isEditable:U,isRemovable:W,isRulerAvailable:V=!1,loading:_}=(0,u.g)(L,O.rulerRule),[H,G]=v("export-grafana-managed-rules"),j=_?y:V,Y=w?y:j,oe=B?y:j,se=(0,l.Wd)(L),ne=x(O);return{"duplicate-alert-rule":C(oe,se.create),"view-alert-rule":C(c,se.read),"update-alert-rule":[Y,U??!1],"delete-alert-rule":[Y,W??!1],"explore-alert-rule":C(c,i.AccessControlAction.DataSourcesExplore),"silence-alert-rule":ne,"modify-export-rule":[K,G],"pause-alert-rule":[Y&&K,U??!1]}}function T(){const{selectedAlertmanager:O,hasConfigurationAPI:R,isGrafanaAlertmanager:L}=(0,d.VI)(),N=(0,l.lV)(O),F=(0,l.jy)(O);return{"view-external-configuration":C(c,i.AccessControlAction.AlertingNotificationsExternalRead),"update-external-configuration":C(R,i.AccessControlAction.AlertingNotificationsExternalWrite),"create-contact-point":C(R,N.create),"view-contact-point":C(c,N.read),"edit-contact-points":C(R,N.update),"delete-contact-point":C(R,N.delete),"export-contact-point":C(L,N.read),"create-notification-template":C(R,N.create),"view-notification-template":C(c,N.read),"edit-notification-template":C(R,N.update),"delete-notification-template":C(R,N.delete),"create-notification-policy":C(R,N.create),"view-notification-policy-tree":C(c,N.read),"update-notification-policy-tree":C(R,N.update),"delete-notification-policy":C(R,N.delete),"export-notification-policies":C(L,N.read),"decrypt-secrets":C(L,N.provisioning.readSecrets),"view-autogenerated-policy-tree":[L,(0,s.qc)()],"create-silence":C(c,F.create),"view-silence":C(c,F.read),"update-silence":C(c,F.update),"preview-silenced-alerts":C(c,F.read),"create-mute-timing":C(R,N.create),"view-mute-timing":C(c,N.read),"update-mute-timing":C(R,N.update),"delete-mute-timing":C(R,N.delete),"export-mute-timings":C(L,N.read)}}function M(O){const R=T();return(0,n.useMemo)(()=>R[O],[R,O])}function A(O){const R=T();return(0,n.useMemo)(()=>O.map(L=>R[L]),[R,O])}function x(O){const L=O.namespace.rulesSource===m.hY,{currentData:N,isLoading:F}=f.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery(void 0,{skip:!L}),K=(0,h.lT)(O.rulerRule)?O.rulerRule.grafana_alert.namespace_uid:void 0,{loading:B,folder:w}=(0,o.a)(K);if(!L||F||B||!w)return[!1,!1];const U=N?.alertmanagersChoice===r.nA.External,W=N?.alertmanagersChoice===r.nA.All,V=!U||W,{accessControl:_={}}=w,H=!!(a.TP.hasPermission(i.AccessControlAction.AlertingInstanceCreate)||_[i.AccessControlAction.AlertingSilenceCreate]);return[V,H]}const C=(O,R)=>[O,a.TP.hasPermission(R)]},62190:(Q,I,e)=>{"use strict";e.d(I,{W:()=>o});var n=e(96540),a=e(57220);function o(r){return(0,n.useMemo)(()=>(0,a.sq)(r),[r])}},36135:(Q,I,e)=>{"use strict";e.d(I,{g:()=>r});var n=e(96540),a=e(19347),o=e(26657);function r(i){return{allDataSourcesAvailable:(0,n.useMemo)(()=>i.filter(d=>!(0,o.s9)(d.datasourceUid)).every(d=>!!(0,a.l)().getInstanceSettings(d.datasourceUid)),[i])}}},730:(Q,I,e)=>{"use strict";e.d(I,{$q:()=>E,Ll:()=>D,O3:()=>T,ZU:()=>y,we:()=>g});var n=e(96540),a=e(16817),o=e(31678),r=e(79938),i=e(77583),f=e(23770),d=e(57220),l=e(88467),m=e(18461),s=e(23662),h=e(9518),u=e(61410);function b(M,A){const x=P(A),C=useCombinedRuleNamespaces(A),O=useMemo(()=>{if(!M||!A||C.length===0)return[];const R=[];for(const L of C)for(const N of L.groups)for(const F of N.rules)F.name===M&&R.push(F);return R},[M,A,C]);return{...x,result:O}}function g(M,A,x){const C=(0,d.oh)(A),{dsFeatures:O,isLoadingDsFeatures:R}=T(A),{currentData:L,isLoading:N,error:F}=r.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:A,ruleName:M,namespace:x?.namespace,groupName:x?.groupName}),[K]=r.hK.endpoints.rulerRuleGroup.useLazyQuery(),{loading:B,error:w,value:U}=(0,a.A)(async()=>{if(!C)throw new Error("Unable to obtain data source settings");if(F)throw new Error("Unable to obtain Prometheus rules");const W=L||[],V=[];if(O?.rulerConfig){const G=O.rulerConfig,j=W.map(Y=>Y.groups.map(oe=>({namespace:Y,group:oe}))).flat();await Promise.allSettled(j.map(async Y=>{const oe=await K({rulerConfig:G,namespace:Y.namespace.name,group:Y.group.name}).unwrap();V.push(oe)}))}return W.map(G=>(0,h.O6)(C,G,V)).flatMap(G=>G.groups.flatMap(j=>j.rules))},[C,O,N,F,L,K]);return{loading:R||B,error:w,rules:U}}function P(M,A){const x=useDispatch(),C=useUnifiedAlertingSelector(F=>F.promRules),O=c(M,C),R=useUnifiedAlertingSelector(F=>F.rulerRules),L=c(M,R),{loading:N}=useAsync(async()=>{M&&await x(fetchPromAndRulerRulesAction({rulesSourceName:M,identifier:A}))},[x,M]);return{loading:N,error:O.error??isRulerNotSupportedResponse(L)?void 0:L.error,dispatched:O.dispatched&&L.dispatched}}function c(M,A){if(!M)return initialAsyncRequestState;const x=A[M];return x||initialAsyncRequestState}function y({ruleIdentifier:M}){const{ruleSourceName:A}=M,x=v(M),{dsFeatures:C,isLoadingDsFeatures:O}=T(A),{loading:R,error:L,result:N}=p(M),{currentData:F,isLoading:K,error:B}=r.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:M.ruleSourceName,namespace:N?.namespace,groupName:N?.group,ruleName:N?.ruleName},{skip:!N||R,refetchOnMountOrArgChange:!0}),[w,{currentData:U,isLoading:W,error:V,isUninitialized:_}]=r.hK.endpoints.rulerRuleGroup.useLazyQuery();(0,n.useEffect)(()=>{!C?.rulerConfig||!N||w({rulerConfig:C.rulerConfig,namespace:N.namespace,group:N.group})},[C,w,N]);const H=(0,n.useMemo)(()=>{if(!(!F||!x)&&F.length>0){const G=F.map(j=>(0,h.O6)(x,j,U?[U]:[]));for(const j of G)for(const Y of j.groups)for(const oe of Y.rules){const se=m.UP(A,oe);if(m.LC(se,M))return oe}}},[M,A,F,U,x]);return{loading:O||K||W||_,error:L??B??V,result:H}}function p(M){const{isLoading:A,currentData:x,error:C,isUninitialized:O}=r.hK.endpoints.getAlertRule.useQuery({uid:(0,s.A4)(M)?M.uid:""},{skip:!(0,s.A4)(M),refetchOnMountOrArgChange:!0});return(0,n.useMemo)(()=>(0,s.Mj)(M)||(0,s.X4)(M)?{result:{namespace:M.namespace,group:M.groupName,ruleName:M.ruleName},loading:!1}:(0,s.A4)(M)?A||O?{loading:!0}:C?{loading:!1,error:C}:x?{result:{namespace:x.grafana_alert.namespace_uid,group:x.grafana_alert.rule_group,ruleName:x.grafana_alert.title},loading:!1}:{loading:!1,error:new Error(`Unable to obtain rule location for rule ${M.uid}`)}:{loading:!1,error:new Error("Unsupported rule identifier")},[M,A,O,C,x])}function v(M){return(0,s.A4)(M)?"grafana":(0,d.oh)(M.ruleSourceName)}function D({ruleIdentifier:M}){const A=v(M),{dsFeatures:x,isLoadingDsFeatures:C}=T(M.ruleSourceName),{loading:O,error:R,result:L}=p(M),[N,{currentData:F,isLoading:K,isUninitialized:B,error:w}]=r.hK.endpoints.rulerRuleGroup.useLazyQuery();(0,n.useEffect)(()=>{!x?.rulerConfig||!L||N({rulerConfig:x.rulerConfig,namespace:L.namespace,group:L.group})},[x,N,L]);const U=(0,n.useMemo)(()=>{const{ruleSourceName:W}=M;if(!F||!A||!L)return;const V=F.rules.find(_=>{const H=m.P1(W,L.namespace,L.group,_);return m.LC(H,M)});if(V)return{ruleSourceName:W,group:F,namespace:L.namespace,rule:V}},[M,F,A,L]);return{loading:O||C||K||B,error:R??w,result:U}}const E={dataSourceName:d.hY,apiVersion:"legacy"},S={rulerConfig:E};function T(M){const A=(0,d.z2)(M),{currentData:x,isLoading:C}=i.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:M},{skip:A});return A?{isLoadingDsFeatures:!1,dsFeatures:S}:{isLoadingDsFeatures:C,dsFeatures:x}}},9518:(Q,I,e)=>{"use strict";e.d(I,{Jr:()=>c,NW:()=>E,O6:()=>g,Tj:()=>S,Ug:()=>D,dy:()=>u,kU:()=>R});var n=e(2543),a=e.n(n),o=e(96540),r=e(54317),i=e(94822),f=e(79938),d=e(55740),l=e(57220),m=e(23662),s=e(730),h=e(61410);function u(L,N){const F=(0,h.$)(U=>U.promRules),K=(0,h.$)(U=>U.rulerRules),B=(0,o.useRef)({}),w=(0,o.useMemo)(()=>{if(L){const U=(0,l.Zw)(L);if(!U)throw new Error(`Unknown rules source: ${L}`);return[U]}return(0,l.lS)()},[L]);return(0,o.useMemo)(()=>w.map(U=>{const W=(0,l.Eb)(U)?U.name:U,V=K[W]?.result;let _=F[W]?.result;W===l.hY&&N&&(_=N);const H=B.current[W];if(H&&H.promRules===_&&H.rulerRules===V)return H.result;const G={};Object.entries(V||{}).forEach(([Y,oe])=>{const se={rulesSource:U,name:Y,groups:[]};(0,m.lT)(oe[0].rules[0])&&(se.uid=oe[0].rules[0].grafana_alert.namespace_uid),G[Y]=se,p(se,oe)}),_?.forEach(({name:Y,groups:oe})=>{const se=G[Y]=G[Y]||{rulesSource:U,name:Y,groups:[]};v(se,oe)});const j=Object.values(G);return B.current[W]={promRules:_,rulerRules:V,result:j},j}).flat(),[F,K,w,N])}function b(L,N,F){const K={};return Object.entries(F||{}).forEach(([B,w])=>{const U={rulesSource:L,name:B,groups:[]};K[B]=U,p(U,w)}),N?.forEach(({name:B,groups:w})=>{const U=K[B]=K[B]||{rulesSource:L,name:B,groups:[]};v(U,w)}),Object.values(K)}function g(L,N,F){const K={rulesSource:L,name:N.name,groups:[]};return p(K,F),v(K,N.groups),K.groups.forEach(B=>{B.rules=B.rules.filter(w=>w.promRule)}),K}function P(L,N,F){return p(L,F),v(L,N),L}function c(L){return L.map(N=>{const F={...N,groups:[]};return F.groups.push({name:"default",rules:y(N.groups.flatMap(K=>K.rules)),totals:T(N.groups)}),F})}function y(L){return L.sort((N,F)=>N.name.localeCompare(F.name))}function p(L,N=[]){L.groups=N.map(F=>{const K=F.rules.filter(U=>(0,m.i7)(U)).length,B=F.rules.filter(U=>(0,m.lT)(U)&&U.grafana_alert.is_paused).length,w={name:F.name,interval:F.interval,source_tenants:F.source_tenants,rules:[],totals:{paused:B,recording:K}};return w.rules=F.rules.map(U=>A(U,L,w)),w})}function v(L,N){const F=new Map;L.groups.forEach(K=>F.set(K.name,K)),N.forEach(K=>{let B=F.get(K.name);B||(B={name:K.name,rules:[],totals:S(K)},L.groups.push(B),F.set(K.name,B)),B.totals={...B.totals,...S(K)};const w=new Map;B.rules.forEach(U=>{const W=w.get(U.name);W?W.push(U):w.set(U.name,[U])}),(K.rules??[]).forEach(U=>{const W=x(U,w,L.rulesSource);W?(W.promRule=U,W.instanceTotals=(0,m.Z8)(U)?D(U):{},W.filteredInstanceTotals=(0,m.Z8)(U)?E(U):{}):B.rules.push(M(U,L,B))})})}function D(L){const N=(0,n.countBy)(L.alerts,"state");if(L.totals){const{normal:F,...K}=L.totals;return{...K,inactive:F}}return{alerting:N[r.$.Alerting]||N.firing,pending:N[r.$.Pending],inactive:N[r.$.Normal],nodata:N[r.$.NoData],error:N[r.$.Error]||N.err||void 0}}function E(L){if(L.totalsFiltered){const{normal:N,...F}=L.totalsFiltered;return{...F,inactive:N}}return{}}function S(L){if(L.totals){const{firing:B,...w}=L.totals;return{...w,alerting:B}}const N=(0,n.countBy)(L.rules,B=>(0,m.Z8)(B)&&B.state),F=(0,n.countBy)(L.rules,B=>B.health),K=L.rules.filter(B=>(0,m.KB)(B)).length;return{alerting:N[i.cF.Firing],error:F.error,nodata:F.nodata,inactive:N[i.cF.Inactive],pending:N[i.cF.Pending],recording:K}}function T(L){const N={};return L.forEach(F=>{const K=F.totals;Object.entries(K).forEach(([B,w])=>{N[B]||(N[B]=0),N[B]+=w})}),N}function M(L,N,F){return{name:L.name,query:L.query,labels:L.labels||{},annotations:(0,m.Z8)(L)?L.annotations||{}:{},promRule:L,namespace:N,group:F,instanceTotals:(0,m.Z8)(L)?D(L):{},filteredInstanceTotals:(0,m.Z8)(L)?E(L):{}}}function A(L,N,F){return(0,m.$y)(L)?{name:L.alert,query:L.expr,labels:L.labels||{},annotations:L.annotations||{},rulerRule:L,namespace:N,group:F,instanceTotals:{},filteredInstanceTotals:{}}:(0,m.i7)(L)?{name:L.record,query:L.expr,labels:L.labels||{},annotations:{},rulerRule:L,namespace:N,group:F,instanceTotals:{},filteredInstanceTotals:{}}:{name:L.grafana_alert.title,query:"",labels:L.labels||{},annotations:L.annotations||{},rulerRule:L,namespace:N,group:F,instanceTotals:{},filteredInstanceTotals:{}}}function x(L,N,F){const K=N.get(L.name);if(!K)return;if((0,l.z2)(F))return K[0];const B=K.find(U=>!U.promRule&&C(U,L,!0));if(B)return B;const w=K.find(U=>!U.promRule&&C(U,L,!1));if(w)return w}function C(L,N,F=!0){return L.name===N.name?(0,n.isEqual)([F?O(L.query):"",L.labels,L.annotations],[F?O(N.query):"",N.labels||{},(0,m.Z8)(N)?N.annotations||{}:{}]):!1}function O(L){return L.length>1&&L[0]==="("&&L[L.length-1]===")"&&(L=L.slice(1,-1)),L=L.replace(/\s|\n/g,""),L.split("").sort().join("")}function R(L,N,F){const{currentData:K,isLoading:B,error:w}=f.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:l.hY,dashboardUid:L??void 0,panelId:N},{skip:L===null,pollingInterval:F?d.HH:void 0}),{currentData:U,isLoading:W,error:V}=f.hK.endpoints.rulerRules.useQuery({rulerConfig:s.$q,filter:{dashboardUID:L??void 0,panelId:N}},{pollingInterval:F?d.HH:void 0,skip:L===null}),_=(0,o.useRef)({}),H=(0,l.Zw)(l.hY),G=(0,o.useMemo)(()=>{if(!H)return[];const j=_.current[l.hY];if(j&&j.promRules===K&&j.rulerRules===U)return j.result;const Y={};Object.entries(U||{}).forEach(([se,ne])=>{const ee={rulesSource:H,name:se,groups:[]};(0,m.lT)(ne[0].rules[0])&&(ee.uid=ne[0].rules[0].grafana_alert.namespace_uid),Y[se]=ee,p(ee,ne)}),K?.forEach(({name:se,groups:ne})=>{const ee=Y[se]=Y[se]||{rulesSource:H,name:se,groups:[]};v(ee,ne)});const oe=Object.values(Y);return _.current[l.hY]={promRules:K,rulerRules:U,result:oe},oe},[K,U,H]);return{loading:B||W,error:w??V,result:G}}},14285:(Q,I,e)=>{"use strict";e.d(I,{dI:()=>p,i7:()=>v});var n=e(53076),a=e(1932),o=e(2543),r=e.n(o),i=e(96540),f=e(19347),d=e(94822),l=e(28475),m=e(98164),s=e(55740),h=e(57220),u=e(32642),b=e(23662),g=e(9518),P=e(39964);const c=25,y=1/0;function p(){const[C,O]=(0,P.l)(),R=C.get("search")??"",L=(0,i.useMemo)(()=>(0,l.XY)(R),[R]),N=(0,i.useMemo)(()=>Object.values(L).some(B=>!(0,o.isEmpty)(B)),[L]),F=(0,i.useCallback)(B=>{const w=(0,l.kL)(R,B);O({search:w})},[R,O]),K=(0,i.useCallback)(B=>{O({search:B})},[O]);return(0,i.useEffect)(()=>{const B={dataSource:C.get("dataSource")??void 0,alertState:C.get("alertState")??void 0,ruleType:C.get("ruleType")??void 0,labels:(0,m.J$)(C.get("queryString")??"").map(m.MU)};Object.values(B).some(U=>!(0,o.isEmpty)(U))&&(O({dataSource:void 0,alertState:void 0,ruleType:void 0,queryString:void 0}),F((0,a.jM)(L,U=>{if(U.dataSourceNames??=B.dataSource?[B.dataSource]:[],B.alertState&&(0,d.Si)(B.alertState)&&(U.ruleState??=B.alertState),B.ruleType&&(0,b.nf)(B.ruleType)&&(U.ruleType??=B.ruleType),U.labels.length===0&&B.labels.length>0){const W=B.labels.map(({name:V,operator:_,value:H})=>`${V}${_}${H}`);U.labels.push(...W)}})))},[C,F,L,O]),{filterState:L,hasActiveFilters:N,searchQuery:R,setSearchQuery:K,updateFilters:F}}const v=(C,O)=>(0,i.useMemo)(()=>{const R=D(C,O);return R.forEach(L=>{L.groups.forEach(N=>{N.rules.forEach(F=>{(0,b.Z8)(F.promRule)&&(F.instanceTotals=(0,g.Ug)(F.promRule),F.filteredInstanceTotals=(0,g.NW)(F.promRule))}),N.totals=(0,g.Tj)({rules:N.rules.map(F=>F.promRule).filter(F=>!!F)})})}),R},[C,O]),D=(C,O={dataSourceNames:[],labels:[],freeFormWords:[]})=>{let R=C;const L=O.dataSourceNames;L.length&&(R=R.filter(({rulesSource:F})=>(0,h.Eb)(F)?L.includes(F.name):!0));const N=O.namespace;if(N){const F=R.map(W=>W.name),K=A(N),[B,w,U]=K.search(F,N,T(N),y);w&&U?R=U.map(W=>R[w.idx[W]]):B&&(R=B.map(W=>R[W]))}return R.reduce(E(O),[])},E=C=>(O,R)=>{const L=C.groupName;let N=R.groups;if(L){const F=N.map(W=>W.name),K=A(L),[B,w,U]=K.search(F,L,T(L),y);w&&U?N=U.map(W=>N[w.idx[W]]):B&&(N=B.map(W=>N[W]))}return N=N.reduce(S(C),[]),N.length&&O.push({...R,groups:N}),O},S=C=>{const O=C.ruleName??C.freeFormWords.join(" ");return(R,L)=>{let N=L.rules;if(O){const F=N.map(W=>W.name),K=A(O),[B,w,U]=K.search(F,O,T(O),y);w&&U?N=U.map(W=>N[w.idx[W]]):B&&(N=B.map(W=>N[W]))}return N=N.filter(F=>{const K=F.promRule,B=(0,o.chain)(C).pick(["ruleType","dataSourceNames","ruleHealth","labels","ruleState","dashboardUid","plugins"]).omitBy(o.isEmpty).mapValues(()=>!1).value();if("ruleType"in B&&C.ruleType===K?.type&&(B.ruleType=!0),"plugins"in B&&C.plugins==="hide"&&(B.plugins=!(0,b.Tm)(F)),"dataSourceNames"in B&&((0,b.lT)(F.rulerRule)?x(F.rulerRule,C)&&(B.dataSourceNames=!0):B.dataSourceNames=!0),"ruleHealth"in C&&K){const w=(0,b.f6)(K.health);C.ruleHealth===w&&(B.ruleHealth=!0)}if("labels"in B){const w=(0,o.compact)(C.labels.map(M)),U=w.length>0&&(0,m.Av)(F.labels,w),W=w.length>0&&K&&K.type===d.JS.Alerting&&K.alerts&&K.alerts.some(V=>(0,m.Av)(V.labels,w));(U||W)&&(B.labels=!0)}if("ruleState"in B){const w=F.promRule;w&&(0,b.Z8)(w)&&w.state===C.ruleState&&(B.ruleState=!0)}return"dashboardUid"in B&&F.annotations[s.YH.dashboardUID]===C.dashboardUid&&(B.dashboardUid=!0),Object.values(B).every(w=>w===!0)}),N.length&&R.push({...L,rules:N}),R}};function T(C){return A(C).split(C).length<5?4:0}function M(C){try{return(0,u.qR)(C)}catch{return{name:C,value:"",isRegex:!0,isEqual:!0}}}function A(C){const O=C.length>c;return new n.A({intraMode:O?0:1,interSplit:"\\s+"})}const x=(C,O)=>O.dataSourceNames?.length?!!C.grafana_alert.data.find(R=>{if(!R.datasourceUid)return!1;const L=(0,f.l)().getInstanceSettings(R.datasourceUid);return L?.name&&O?.dataSourceNames?.includes(L.name)}):!0},11167:(Q,I,e)=>{"use strict";e.d(I,{a:()=>f});var n=e(96540),a=e(31678),o=e(23770),r=e(88467),i=e(61410);function f(d){const l=(0,a.useDispatch)(),m=(0,i.$)(s=>s.folders);if((0,n.useEffect)(()=>{d&&l((0,o.Om)(d))},[l,d]),d){const s=m[d]||r.jA;return{folder:s.result,loading:s.loading}}return{loading:!1}}},83903:(Q,I,e)=>{"use strict";e.d(I,{y:()=>r});var n=e(96540),a=e(57220),o=e(61410);function r(){const i=(0,o.$)(l=>l.rulerRules),f=(0,n.useCallback)(l=>{const m=typeof l=="string"?l:l.name;return m===a.hY||!!i[m]?.result},[i]),d=(0,n.useCallback)(l=>{const m=(0,a.EV)(l);return!!i[m]?.result},[i]);return{hasRuler:f,rulerRulesLoaded:d}}},97009:(Q,I,e)=>{"use strict";e.d(I,{g:()=>d});var n=e(16233),a=e(77583),o=e(75471),r=e(23662),i=e(11167),f=e(61410);function d(l,m){const s=(0,f.$)(D=>D.dataSources),{currentData:h,isLoading:u}=a.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:l}),b=m&&(0,r.lT)(m)?m.grafana_alert.namespace_uid:void 0,g=(0,o.Wd)(l),{folder:P,loading:c}=(0,i.a)(b);if(!m)return{isEditable:!1,isRemovable:!1,loading:!1};if((0,r.lT)(m)){if(!b)throw new Error(`Rule ${m.grafana_alert.title} does not have a folder uid, cannot determine if it is editable.`);if(!P)return{isRulerAvailable:!0,isEditable:!1,isRemovable:!1,loading:c};const D=n.TP.hasPermissionInMetadata(g.update,P),E=n.TP.hasPermissionInMetadata(g.delete,P);return{isRulerAvailable:!0,isEditable:D,isRemovable:E,loading:c||u}}const y=!!s[l]?.result?.rulerConfig||!!h?.rulerConfig,p=n.TP.hasPermission(g.update),v=n.TP.hasPermission(g.delete);return{isRulerAvailable:y,isEditable:p&&y,isRemovable:v&&y,loading:u||s[l]?.loading}}},98439:(Q,I,e)=>{"use strict";e.d(I,{W:()=>r});var n=e(2543),a=e.n(n),o=e(96540);function r(i,f=1,d){const[l,m]=(0,o.useState)(f),s=(0,o.useMemo)(()=>(0,n.chunk)(i,d),[i,d]),h=s.length,u=s[l-1]??[],b=(l-1)*d+1,g=(0,n.clamp)(l*d,i.length),P=(0,o.useCallback)(p=>{m((0,n.clamp)(p,1,s.length))},[m,s]),c=(0,o.useCallback)(()=>P(l+1),[l,P]),y=(0,o.useCallback)(()=>P(l-1),[l,P]);return(0,o.useEffect)(()=>m(1),[h]),{page:l,onPageChange:P,numberOfPages:h,pageItems:u,pageStart:b,pageEnd:g,nextPage:c,previousPage:y}}},27747:(Q,I,e)=>{"use strict";e.d(I,{S:()=>a});var n=e(9518);function a({dashboardUID:o,panelId:r,poll:i=!1}){const{result:f,loading:d,error:l}=(0,n.kU)(o,r,i);return{rules:f?f.flatMap(s=>s.groups).flatMap(s=>s.rules):[],errors:l?[l]:[],loading:d}}},12210:(Q,I,e)=>{"use strict";e.d(I,{_:()=>o});var n=e(16817),a=e(27716);function o(r){const{loading:i,error:f,value:d}=(0,n.A)(()=>(0,a.x)(r,{showErrorAlert:!1})),l=d&&!f&&!i,m=d?.enabled;return i&&!d?{loading:!0}:!l||!m?{loading:!1,installed:!1}:{loading:i,installed:!0,settings:d}}},46013:(Q,I,e)=>{"use strict";e.d(I,{G:()=>m,Q:()=>l});var n=e(32196),a=e(96540),o=e(32264),r=e(40845),i=e(37390);const f=(0,a.lazy)(()=>e.e(7409).then(e.bind(e,87409))),d=(0,a.lazy)(()=>e.e(1121).then(e.bind(e,31121)));var l=(h=>(h.Loki="loki",h.Annotations="annotations",h))(l||{});function m(){const[h,u]=(0,a.useState)(!1),[b,g]=(0,a.useState)(),P=(0,r.of)(s),c=o.$.unifiedAlerting.alertStateHistoryBackend,y=o.$.unifiedAlerting.alertStateHistoryPrimary,v=[c,y].some(T=>T==="loki")?"loki":"annotations",D=(0,a.useCallback)(()=>{g(void 0),u(!1)},[]),E=(0,a.useCallback)(T=>{g(T),u(!0)},[]);return{StateHistoryModal:(0,a.useMemo)(()=>b?a.createElement(i.a,{isOpen:h,onDismiss:D,closeOnBackdropClick:!0,closeOnEscape:!0,title:"State history",className:P.modal,contentClassName:P.modalContent},a.createElement(a.Suspense,{fallback:"Loading..."},v==="loki"&&a.createElement(d,{ruleUID:b.grafana_alert.uid}),v==="annotations"&&a.createElement(f,{alertId:b.grafana_alert.id??""}))):null,[b,h,D,v,P]),showStateHistoryModal:E,hideStateHistoryModal:D}}const s=h=>({modal:(0,n.css)({width:"80%",height:"80%",minWidth:"800px"}),modalContent:(0,n.css)({height:"100%",width:"100%",padding:h.spacing(2)})})},39964:(Q,I,e)=>{"use strict";e.d(I,{l:()=>r});var n=e(96540),a=e(24180),o=e(12131);function r(){const{search:i}=(0,a.zy)(),f=(0,n.useMemo)(()=>new URLSearchParams(i),[i]),d=(0,n.useCallback)((l,m)=>{o.Ny.partial(l,m)},[]);return[f,d]}},61410:(Q,I,e)=>{"use strict";e.d(I,{$:()=>o});var n=e(25508),a=e(31678);function o(r,i){return(0,a.useSelector)((0,n.Mz)(f=>f.unifiedAlerting,f=>r(f)),i)}},85244:(Q,I,e)=>{"use strict";e.d(I,{T:()=>f});var n=e(96540),a=e(16817),o=e(39938),r=e(56034),i=e(27716);function f({pluginId:d}){const{value:l}=(0,a.A)(()=>(0,i.x)(d)),m=l?.info.logos?.small,s=m?n.createElement("img",{src:m,alt:l?.name,style:{width:"20px",height:"20px"}}):n.createElement(o.E,{text:d,color:"orange"}),h=l?`This rule is managed by the ${l?.name} plugin`:"This rule is managed by a plugin";return n.createElement(r.m,{content:h},n.createElement("div",null,s))}},28475:(Q,I,e)=>{"use strict";e.d(I,{Jc:()=>_,kL:()=>G,XY:()=>H});var n=e(94822),a=e(23662);const o=1,r=2,i=3,f=4,d=5,l=6,m=7,s=8,h=9,u=10,b=11,g=12,P=13,c=14,y=0,p=1,v=2,D=3,E=4,S=5,T=6,M=7,A=8,x=9;var C=e(2543),O=e(48820);const R=O.U1.deserialize({version:14,states:"!vOQOPOOOxOPO'#CjOOOO'#Cj'#CjOQOPO'#CnOOOO'#Ck'#CkQQOPOOO!sOQO'#C^O!xOPO'#ClO!}OPO,59UOOOO,59Y,59YOOOO-E6i-E6iOOOO,58x,58xOOOO,59W,59WOOOO-E6j-E6j",stateData:"$h~ORUOTUOUUOVUOWUOXUOYUOZUO[UO]UOcPOeQO~OdVOR^XT^XU^XV^XW^XX^XY^XZ^X[^X]^Xc^Xe^X~OSZO~Oc[O~OdVOR^aT^aU^aV^aW^aX^aY^aZ^a[^a]^ac^ae^a~OR~T~U~V~W~Y~Z~[~]~R][ZYXWVUTc~",goto:"|cPPdPPPPPPPPPPPdioPuVRORTQTORYTQWPR]WSSOTRXR",nodeNames:"\u26A0 AlertRuleSearch FilterExpression DataSourceToken FilterValue NameSpaceToken LabelToken GroupToken RuleToken StateToken TypeToken HealthToken DashboardToken PluginsToken FreeFormExpression",maxTerm:21,skippedNodes:[0],repeatNodeCount:2,tokenData:"#<RRRsqr#`rs&lst#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]+n!]#W#`#W#X-Q#X#Z#`#Z#[Ig#[#]!$a#]#`#`#`#a!.s#a#b#`#b#c!7m#c#d#`#d#e!Fk#e#f#`#f#g#$g#g#h#+w#h#i#4q#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#gcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`Q$wcSQqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rQ&VP;=`<%l$rQ&]P;=`;NQ$rR&cP;=`<%l#`R&iP;=`;NQ#`R&orX^(ypq(yqr(yst(ytu(yuv(yvw(ywx(yxy(yyz(yz{(y{|(y|!P(y!P!Q(y!Q![(y![!](y!]#y(y#y#z(y#z$f(y$f$g(y$g#BY(y#BY#BZ(y#BZ$Ch(y$IS$I_(y$I|$JO(y$JT$JU(y$JU$KV(y$KV$KW(y$KW&FU(y&FU&FV(y&FV;'S(y;'S;(d+b;(d;(e+h<%lO(yR(|sX^(ypq(yqr(yrs+Zst(ytu(yuv(yvw(ywx(yxy(yyz(yz{(y{|(y|!P(y!P!Q(y!Q![(y![!](y!]#y(y#y#z(y#z$f(y$f$g(y$g#BY(y#BY#BZ(y#BZ$Ch(y$IS$I_(y$I|$JO(y$JT$JU(y$JU$KV(y$KV$KW(y$KW&FU(y&FU&FV(y&FV;'S(y;'S;(d+b;(d;(e+h<%lO(yR+bOSQePR+eP;=`<%l(yR+kP;=`;NQ(yR+ucSQdPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR-XeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U.j#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R.qfSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h0V#h#i<R#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R0^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#[#`#[#]1o#]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R1veSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#U#`#U#V3X#V$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R3`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#c#`#c#d4q#d$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R4xeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U6Z#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R6beSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#f#`#f#g7s#g$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R7zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#W#`#W#X9]#X$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R9dcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]:o!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R:vcSQ[Pqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR<YeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U=k#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R=reSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h?T#h$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R?[eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#c#`#c#d@m#d$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R@teSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#jBV#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RB^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#f#`#f#gCo#g$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RCveSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#V#`#V#WEX#W$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RE`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#YFq#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RFxcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]HT!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RH[cSQRPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rRIneSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#f#`#f#gKP#g$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RKWeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#c#`#c#dLi#d$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RLpeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#jNR#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RNYeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#d#`#d#e! k#e$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R! rcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!!}!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!#UcSQVPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!$heSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!%y#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!&QeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!'c#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!'jeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a!({#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!)SeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#h#`#h#i!*e#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!*leSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#[#`#[#]!+}#]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!,UcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!-a!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!-hcSQZPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!.zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!0]#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!0deSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#U#`#U#V!1u#V$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!1|eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!3_#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!3feSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a!4w#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!5OcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!6Z!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!6bcSQUPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!7teSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!9V#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!9^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#a#`#a#b!:o#b$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!:veSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!<X#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!<`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h!=q#h$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!=xeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#d#`#d#e!?Z#e$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!?beSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!@s#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!@zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#V#`#V#W!B]#W$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!BdeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!Cu#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!C|cSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!EX!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!E`cSQTPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!FreSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a!HT#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!H[eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#j!Im#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!IteSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#Z#`#Z#[!KV#[$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!K^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#]#`#]#^!Lo#^$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!LveSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#b#`#b#c!NX#c$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!N`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h# q#h$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R# xcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]##T!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R##[cSQ]Pqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR#$neSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#j#&P#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#&WeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a#'i#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#'peSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y#)R#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#)YcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]#*e!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#*lcSQWPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR#,OeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#h#`#h#i#-a#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#-heSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U#.y#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#/QeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#h#`#h#i#0c#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#0jeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y#1{#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#2ScSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]#3_!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#3fcSQXPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR#4xeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#m#`#m#n#6Z#n$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#6beSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#d#`#d#e#7s#e$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#7zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y#9]#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#9dcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]#:o!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#:vcSQYPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$r",tokenizers:[0,1],topRules:{AlertRuleSearch:[0,1]},dialects:{dataSourceFilter:132,nameSpaceFilter:134,labelFilter:136,groupFilter:138,ruleFilter:140,stateFilter:78,typeFilter:142,healthFilter:144,dashboardFilter:146,pluginsFilter:148},tokenPrec:150}),L={[i]:"datasource",[d]:"namespace",[l]:"label",[s]:"rule",[m]:"group",[h]:"state",[u]:"type",[b]:"health",[g]:"dashboard",[P]:"plugins"};var N=(Y=>(Y.dataSource="dataSourceFilter",Y.nameSpace="nameSpaceFilter",Y.label="labelFilter",Y.group="groupFilter",Y.rule="ruleFilter",Y.state="stateFilter",Y.type="typeFilter",Y.health="healthFilter",Y.dashboard="dashboardFilter",Y.plugins="pluginsFilter",Y))(N||{});function F(Y,oe,se){U(Y,oe,ne=>{if(ne.type.id===r){const ee=K(Y,ne);if(ee.type&&ee.value){const Z=se[ee.type];Z&&Z(ee.value)}}else if(ne.type.id===c){const ee=se[c];ee&&ee(B(Y,ne))}})}function K(Y,oe){if(oe.type.id!==r)throw new Error("Invalid node provided. Only FilterExpression nodes are supported");const se=oe.firstChild;if(!se)return{type:void 0,value:void 0};const ne=oe.getChild(f),ee=ne?(0,C.trim)(B(Y,ne),'"'):void 0;return{type:se.type.id,value:ee}}function B(Y,oe){return Y.slice(oe.from,oe.to).trim().replace(/\"/g,"")}function w(Y,oe,se){const ne=[];U(Y,oe,Z=>{Z.type.id===r&&Z.firstChild&&ne.push(Z.firstChild),Z.type.id===c&&ne.push(Z)});let ee=[];return ne.forEach(Z=>{const z=se.findIndex(q=>q.type===Z.type.id);if(z!==-1){if(Z.parent?.type.is(r)){const q=L[Z.type.id],ie=se.splice(z,1)[0];ee.push(`${q}:${W(ie.value)}`)}if(Z.type.is(c)){const q=se.splice(z,1)[0];ee.push(q.value)}}}),se.forEach(Z=>{Z.type===c?ee.push(Z.value):ee.push(`${L[Z.type]}:${W(Z.value)}`)}),ee.join(" ")}function U(Y,oe,se){const ne=oe.join(" ");let Z=R.configure({dialect:ne}).parse(Y).cursor();do se(Z.node);while(Z.next())}function W(Y){return/\s/.test(Y)?`"${Y}"`:Y}const V=[N.dataSource,N.nameSpace,N.label,N.group,N.rule,N.state,N.type,N.health,N.dashboard,N.plugins];var _=(Y=>(Y.Ok="ok",Y.Error="error",Y.NoData="nodata",Y.Unknown="unknown",Y))(_||{});function H(Y){const oe={labels:[],freeFormWords:[],dataSourceNames:[]},se={[i]:ne=>oe.dataSourceNames.push(ne),[d]:ne=>oe.namespace=ne,[m]:ne=>oe.groupName=ne,[s]:ne=>oe.ruleName=ne,[l]:ne=>oe.labels.push(ne),[h]:ne=>oe.ruleState=j(ne),[u]:ne=>(0,a.nf)(ne)?oe.ruleType=ne:void 0,[b]:ne=>oe.ruleHealth=(0,a.f6)(ne),[g]:ne=>oe.dashboardUid=ne,[P]:ne=>oe.plugins=ne==="hide"?ne:void 0,[c]:ne=>oe.freeFormWords.push(ne)};return F(Y,V,se),oe}function G(Y,oe){const se=[];return oe.dataSourceNames&&se.push(...oe.dataSourceNames.map(ne=>({type:i,value:ne}))),oe.namespace&&se.push({type:d,value:oe.namespace}),oe.groupName&&se.push({type:m,value:oe.groupName}),oe.ruleName&&se.push({type:s,value:oe.ruleName}),oe.ruleState&&se.push({type:h,value:oe.ruleState}),oe.ruleType&&se.push({type:u,value:oe.ruleType}),oe.ruleHealth&&se.push({type:b,value:oe.ruleHealth}),oe.labels&&se.push(...oe.labels.map(ne=>({type:l,value:ne}))),oe.dashboardUid&&se.push({type:g,value:oe.dashboardUid}),oe.plugins&&se.push({type:P,value:oe.plugins}),oe.freeFormWords&&se.push(...oe.freeFormWords.map(ne=>({type:c,value:ne}))),w(Y,V,se)}function j(Y){if(Y==="normal")return n.cF.Inactive;if((0,n.Si)(Y))return Y}},28318:(Q,I,e)=>{"use strict";e.d(I,{t:()=>R});var n=e(2543),a=e(39741),o=e(62467),r=e(66847),i=e(1005),f=e(81160),d=e(62938),l=e(39070),m=e(14236),s=e(72495),h=e(65879),u=e(43127),b=e(89667),g=e(19347),P=e(26657),c=e(12091),y=e(27677),p=e(69437),v=e(81583),D=e(72955),E=e(66718);const S={from:21600,to:0},T=(U,W)=>{const V=M(U,W);if(!V)return S;const{from:_,to:H}=x(V,W);return!_.length&&!H.length?S:{from:Math.max(..._),to:Math.min(...H)}},M=(U,W)=>{switch(U.type){case E.Tz.classic:return A(U);case E.Tz.math:case E.Tz.sql:return C(U,W);case E.Tz.resample:case E.Tz.reduce:case E.Tz.threshold:return O(U)}},A=U=>U.conditions?.map(W=>W.query.params[0]),x=(U,W)=>{let V=[],_=[S.to];for(const H of U){const G=W.find(j=>j.refId===H);!G||!G.relativeTimeRange||(V.push(G.relativeTimeRange.from),_.push(G.relativeTimeRange.to))}return{from:V,to:_}},C=(U,W)=>W.filter(V=>V.queryType==="query"&&U.expression?.includes(V.refId)).map(V=>V.refId),O=U=>U.expression?[U.expression]:void 0;class R{constructor(W=(0,y.AI)(),V=(0,g.l)()){this.backendSrv=W,this.dataSourceSrv=V,this.subject=new a.m(1),this.lastResult={}}get(){return this.subject.asObservable()}async run(W,V){const _=N(W,l.Gu.Done),H=[];for(const j of W){const Y=j.model.refId;if((0,p.f)(j.model))continue;const oe=await this.dataSourceSrv.get(j.datasourceUid);oe instanceof P.iy&&oe.filterQuery&&!oe.filterQuery(j.model)&&H.push(Y)}const G=(0,n.reject)(W,j=>H.includes(j.model.refId));if(G.length===0)return this.subject.next(_);this.subscription=L(this.backendSrv,G,V).subscribe({next:j=>{const Y=w(j,(oe,se)=>{const ne=this.lastResult[oe],ee=(0,m.N$)(se,ne);return(0,D.B)(ee,ne)});this.lastResult=Y,this.subject.next(this.lastResult)},error:j=>{this.lastResult=B(this.lastResult,j),this.subject.next(this.lastResult)}})}cancel(){if(!this.subscription)return;this.subscription.unsubscribe();let W=!1;const V=w(this.lastResult,(_,H)=>(H.state===l.Gu.Loading&&(W=!0),{...H,state:l.Gu.Done}));W&&this.subject.next(V)}destroy(){this.subject&&this.subject.complete(),this.cancel()}}const L=(U,W,V)=>{const _=N(W,l.Gu.Loading),H={data:{data:W,condition:V},url:"/api/v1/eval",method:"POST",requestId:(0,d.A)()};return(0,s.k)({whileLoading:_,source:U.fetch(H).pipe(K(_),(0,r.W)(G=>(0,o.of)(B(_,G))),(0,v.N)(U,H.requestId),(0,i.u)())})},N=(U,W)=>U.reduce((V,_)=>(V[_.refId]={state:W,series:[],timeRange:F(_,U)},V),{}),F=(U,W)=>{if((0,p.f)(U.model)){const V=T(U.model,W);return h.relativeToTimeRange(V)}return U.relativeTimeRange?h.relativeToTimeRange(U.relativeTimeRange):(console.warn(`Query with refId: ${U.refId} did not have any relative time range, using default.`),(0,u.E2)())},K=U=>(0,f.T)(W=>{const{data:V}=W,_={};for(const[H,G]of Object.entries(V.results)){const{error:j,status:Y,frames:oe=[]}=G,se=j?[{message:j,refId:H,status:Y}]:[];_[H]={errors:se,timeRange:U[H].timeRange,state:l.Gu.Done,series:oe.map(b.or)}}return _}),B=(U,W)=>{const V=(0,c.u)(W);return w(U,(_,H)=>({...H,state:l.Gu.Error,error:V}))},w=(U,W)=>{const V={};for(const[_,H]of Object.entries(U))V[_]=W(_,H);return V}},70383:(Q,I,e)=>{"use strict";e.d(I,{Kh:()=>b,VI:()=>s,b9:()=>m});var n=e(96540),a=e(33390),o=e(60021),r=e(62190),i=e(39964),f=e(55740),d=e(57220);const l=n.createContext(void 0),m=({children:g,accessType:P,alertmanagerSourceName:c})=>{const[y,p]=(0,i.l)(),v=(0,r.W)(P),D=v.availableInternalDataSources.concat(v.availableExternalDataSources),E=n.useCallback(F=>{h(D,F)&&(F===d.hY?(a.A.delete(f.Oq),p({[f.DD]:void 0})):(a.A.set(f.Oq,F),p({[f.DD]:F})))},[D,p]),S=y.get(f.DD),T=a.A.get(f.Oq),M=d.hY;n.useEffect(()=>{S&&S!==T&&a.A.set(f.Oq,S)},[S,T]);const A=c??S??T??M,x=h(D,A)?A:void 0,C=(0,d.r3)(x)?.jsonData,O=x===d.hY,R=C?b(C):!1,N={selectedAlertmanager:x,hasConfigurationAPI:O||R,isGrafanaAlertmanager:O,selectedAlertmanagerConfig:C,availableAlertManagers:D,setSelectedAlertmanager:E};return n.createElement(l.Provider,{value:N},g)};function s(){const g=n.useContext(l);if(g===void 0)throw new Error("useAlertmanager must be used within a AlertmanagerContext");return g}function h(g,P){return g.map(y=>y.name).includes(P)}const u=[o.Oz.mimir,o.Oz.cortex,void 0];function b(g){return u.includes(g.implementation)}},23770:(Q,I,e)=>{"use strict";e.d(I,{nO:()=>de,$8:()=>ue,KH:()=>G,g6:()=>H,EY:()=>Z,D3:()=>ie,yo:()=>V,wE:()=>U,nV:()=>_,Tp:()=>z,Om:()=>q,JH:()=>se,mF:()=>oe,Lc:()=>B,mB:()=>F,eB:()=>K,HB:()=>w,DC:()=>W,uQ:()=>Se,_$:()=>j,bO:()=>fe,RW:()=>ne,LU:()=>he,DN:()=>ce});var n=e(65307),a=e(2543),o=e(12131),r=e(34867),i=e(94822),f=e(27677),d=e(25027),l=e(79938),m=e(32415),s=e(82843),h=e(17172);function u(me){return(0,h.AI)().get("/api/annotations",{alertId:me}).then(pe=>pe?.sort(b))}function b(me,pe){const ye=(Oe,Ne)=>Oe>Ne?-1:Ne>Oe?1:0,Pe=ye(me.timeEnd,pe.timeEnd);if(Pe)return Pe;const Ie=ye(me.time,pe.time);return Ie||ye(me.id,pe.id)}var g=e(92240),P=e(68788),c=e(49498),y=e(28220),p=e(99106),v=e(86590),D=e(98164),E=e(57220),S=e(56361),T=e(88467),M=e(18461),A=e(63066),x=e(23662);function C(me){const pe=async Ae=>{if((0,x.A4)(Ae)){const Ue=await(0,y.iy)(me);for(const[Me,$e]of Object.entries(Ue))for(const ke of $e){const Ze=ke.rules.find(ot=>(0,x.lT)(ot)&&ot.grafana_alert?.uid===Ae.uid);if(Ze)return{group:ke,ruleSourceName:E.hY,namespace:Me,namespace_uid:(0,x.lT)(Ze)&&Ze.grafana_alert.namespace_uid||void 0,rule:Ze}}}if((0,x.X4)(Ae)){const{ruleSourceName:Ue,namespace:Me,groupName:$e}=Ae,ke=await(0,y.HO)(me,Me,$e);if(!ke)return null;const Ze=ke.rules.find(ot=>{const xt=M.P1(Ue,Me,ke.name,ot);return M.LC(xt,Ae)});return Ze?{group:ke,ruleSourceName:Ue,namespace:Me,rule:Ze}:null}if((0,x.Mj)(Ae))throw new Error("Native prometheus rules can not be edited in grafana.");return null},ye=async Ae=>{const{namespace:Ue,group:Me,rule:$e,namespace_uid:ke}=Ae;if(Me.rules.length===1){await(0,y.AJ)(me,ke||Ue,Me.name);return}await(0,y.E8)(me,ke||Ue,{...Me,rules:Me.rules.filter(Ze=>Ze!==$e)})},Pe=async(Ae,Ue,Me)=>{const{dataSourceName:$e,group:ke,namespace:Ze}=Ae,ot=(0,A.l1)(Ae);if($e&&ke&&Ze){if(Me){const ft=await pe(M.Yd(Me));if(!ft)throw new Error("Rule not found.");if(ft.namespace!==Ze||ft.group.name!==ke)await ye(ft);else{const Le={...ft.group,rules:ft.group.rules.map(re=>re===ft.rule?ot:re),evaluateEvery:Ue};return await(0,y.E8)(me,Ze,Le),M.P1($e,Ze,ke,ot)}}const xt=await(0,y.HO)(me,Ze,ke),ct=xt?{...xt,rules:[...xt.rules,ot]}:{name:ke,rules:[ot]};return await(0,y.E8)(me,Ze,ct),M.P1($e,Ze,ke,ot)}else throw new Error("Data source and location must be specified")},Ie=async(Ae,Ue,Me)=>{const{folder:$e,group:ke}=Ae;if(!$e)throw new Error("Folder must be specified");const Ze=(0,A.Z9)(Ae),ot=$e.uid,xt={name:ke,interval:Ue};if(!Me)return Oe(ot,xt,Ze);const ct=await pe(M.Yd(Me));if(!ct)throw new Error("Rule not found.");const ft=ct.namespace_uid===ot,Le=ct.group.name===Ae.group;return ft&&Le?We(ct,Ze,Ue):Ne(ot,xt,ct,Ze)},Oe=async(Ae,Ue,Me)=>{const $e=await(0,y.HO)(me,Ae,Ue.name);if(!$e)throw new Error(`No group found with name "${Ue.name}"`);const ke={name:Ue.name,interval:Ue.interval,rules:($e.rules??[]).concat(Me)};return await(0,y.E8)(me,Ae,ke),{uid:Me.grafana_alert.uid??"",ruleSourceName:E.hY}},Ne=async(Ae,Ue,Me,$e)=>(O(Me,$e),await Oe(Ae,Ue,$e)),We=async(Ae,Ue,Me)=>{O(Ae,Ue);const $e=Ae.group.rules.map(ke=>(0,x.lT)(ke)&&ke.grafana_alert.uid===Ae.rule.grafana_alert.uid?Ue:ke);return await(0,y.E8)(me,Ae.namespace_uid??"",{name:Ae.group.name,interval:Me,rules:$e}),{uid:Ae.rule.grafana_alert.uid,ruleSourceName:E.hY}};return{findEditableRule:pe,deleteRule:ye,saveLotexRule:Pe,saveGrafanaRule:Ie}}function O(me,pe){if(!(0,x.lT)(me.rule))throw new Error("The rule is not a Grafana managed rule");const ye=me.rule.grafana_alert.uid;pe.grafana_alert.uid=ye}var R=e(25968);function L(me,pe){const Pe=me().unifiedAlerting.dataSources[pe]?.result;if(!Pe)throw new Error(`Data source configuration is not available for "${pe}" data source`);return Pe}function N(me,pe){const ye=L(me,pe);if(!ye.rulerConfig)throw new Error(`Ruler API is not available for ${pe}`);return ye.rulerConfig}const F=(0,n.zD)("unifiedalerting/fetchPromRules",async({rulesSourceName:me,filter:pe,limitAlerts:ye,matcher:Pe,state:Ie,identifier:Oe},Ne)=>{await Ne.dispatch(W({rulesSourceName:me}));const We=(0,d.U7)("unifiedalerting/fetchPromRules",c.sA,{dataSourceName:me,thunk:"unifiedalerting/fetchPromRules"});return await(0,T.$I)(We(me,pe,ye,Pe,Ie,Oe))}),K=(0,n.zD)("unifiedalerting/fetchRulerRules",async({rulesSourceName:me,filter:pe},{dispatch:ye,getState:Pe})=>{await ye(W({rulesSourceName:me}));const Ie=N(Pe,me),Oe=(0,d.Ke)("unifiedalerting/fetchRulerRules",y.iy,{dataSourceName:me,thunk:"unifiedalerting/fetchRulerRules"});return await(0,T.$I)(Oe(Ie,pe))});function B({rulesSourceName:me,identifier:pe,filter:ye,limitAlerts:Pe,matcher:Ie,state:Oe}){return async(Ne,We)=>{await Ne(W({rulesSourceName:me}));const Ae=L(We,me);await Ne(F({rulesSourceName:me,identifier:pe,filter:ye,limitAlerts:Pe,matcher:Ie,state:Oe})),Ae.rulerConfig&&await Ne(K({rulesSourceName:me}))}}function w(me){return(pe,ye)=>{const{rulerRules:Pe}=ye().unifiedAlerting,Ie=Pe[me];(0,a.isEmpty)(Ie?.result)&&!(Ie&&(0,x.$7)(Ie))&&!Ie?.loading&&pe(K({rulesSourceName:me}))}}function U(){return async me=>{const pe=(0,E.gR)().map(ye=>me(W({rulesSourceName:ye})));await Promise.allSettled(pe)}}const W=(0,n.zD)("unifiedalerting/fetchPromBuildinfo",async({rulesSourceName:me})=>(0,T.$I)((async()=>{if(me===E.hY)return{name:E.hY,id:E.hY,rulerConfig:{dataSourceName:E.hY,apiVersion:"legacy"}};const pe=(0,E.Jz)(me);if(!pe)throw new Error(`Missing data source configuration for ${me}`);const{id:ye,name:Pe}=pe,Oe=await(0,d.QA)("unifiedalerting/fetchPromBuildinfo",g.nD,{dataSourceName:me,thunk:"unifiedalerting/fetchPromBuildinfo"})(Pe),Ne=Oe.features.rulerApiEnabled?{dataSourceName:Pe,apiVersion:Oe.application===i.N1.Cortex?"legacy":"config"}:void 0;return{name:Pe,id:ye,rulerConfig:Ne}})()),{condition:({rulesSourceName:me},{getState:pe})=>{const ye=pe().unifiedAlerting.dataSources,Pe=!!ye[me]?.result,Ie=!!ye[me]?.error;return!(Pe||Ie)}});function V(me=!1,pe={}){return async(ye,Pe)=>{const Ie=performance.now();await Promise.allSettled((0,E.gR)().map(async Oe=>{await ye(W({rulesSourceName:Oe}));const{promRules:Ne,rulerRules:We,dataSources:Ae}=Pe().unifiedAlerting,Ue=Ae[Oe].result;if(!Ue)return;const Me=me||!Ne[Oe]?.loading,$e=(me||!We[Oe]?.loading)&&!!Ue.rulerConfig;await Promise.allSettled([Me&&ye(F({rulesSourceName:Oe,...pe})),$e&&ye(K({rulesSourceName:Oe}))])})),(0,r.l$)("unifiedalerting/fetchAllPromAndRulerRulesAction",{loadTimeMs:performance.now()-Ie})}}function _(me=!1){return async(pe,ye)=>{const{promRules:Pe}=ye().unifiedAlerting;(0,E.gR)().map(Ie=>{(me||!Pe[Ie]?.loading)&&pe(F({rulesSourceName:Ie}))})}}function H(me,pe){return async(ye,Pe)=>{(0,T.v5)((async()=>{const Ie=(0,E.EV)(me.rulesSource),Oe=N(Pe,Ie);await(0,y.AJ)(Oe,me.name,pe.name),await ye(B({rulesSourceName:Ie}))})(),{successMessage:"Group deleted"})}}function G(me,pe={}){return async(ye,Pe)=>{await ye(W({rulesSourceName:me.ruleSourceName})),(0,T.v5)((async()=>{const Ie=N(Pe,me.ruleSourceName),Oe=C(Ie),Ne=await Oe.findEditableRule(me);if(!Ne)throw new Error("Rule not found.");await Oe.deleteRule(Ne),await ye(B({rulesSourceName:Ne.ruleSourceName})),pe.navigateTo&&o.Ny.replace(pe.navigateTo)})(),{successMessage:"Rule deleted."})}}const j=(0,n.zD)("unifiedalerting/saveRuleForm",({values:me,existing:pe,redirectOnSave:ye,evaluateEvery:Pe},Ie)=>(0,T.v5)((0,T.$I)((async()=>{const{type:Oe}=me;let Ne;if(Oe===v.Z.cloudAlerting||Oe===v.Z.cloudRecording){if(!me.dataSourceName)throw new Error("The Data source has not been defined.");const We=N(Ie.getState,me.dataSourceName);Ne=await C(We).saveLotexRule(me,Pe,pe),await Ie.dispatch(K({rulesSourceName:me.dataSourceName}))}else if(Oe===v.Z.grafana){const We=N(Ie.getState,E.hY);Ne=await C(We).saveGrafanaRule(me,Pe,pe),Y(me,pe),Ie.dispatch(l.hK.util.invalidateTags([{type:"GrafanaRulerRule",id:Ne.uid}]))}else throw new Error("Unexpected rule form type");if((0,d.fH)(d.le.successSavingAlertRule,{type:Oe,isNew:(!pe).toString()}),ye)o.Ny.push(ye);else{const We=M.$9(Ne);if(!We){o.Ny.push("/alerting/list");return}const Ae=`/alerting/${encodeURIComponent(We)}/edit`;o.Ny.getLocation().pathname!==Ae&&o.Ny.replace(Ae)}})()),{successMessage:pe?`Rule "${me.name}" updated.`:`Rule "${me.name}" saved.`,errorMessage:"Failed to save rule"}));function Y(me,pe){if((0,x.lT)(pe?.rule)){const Pe=!!pe?.rule.grafana_alert?.notification_settings?.receiver,Ie=me.manualRouting,Oe=!Pe&&Ie,Ne=Pe&&!Ie;Oe&&(0,d.Fb)(),Ne&&(0,d.hJ)()}}const oe=(0,n.zD)("unifiedalerting/fetchGrafanaNotifiers",()=>(0,T.$I)((0,P.Es)())),se=(0,n.zD)("unifiedalerting/fetchGrafanaAnnotations",me=>(0,T.$I)(u(me))),ne=(0,n.zD)("unifiedalerting/updateAMConfig",({alertManagerSourceName:me,oldConfig:pe,newConfig:ye,successMessage:Pe,redirectPath:Ie,redirectSearch:Oe},Ne)=>(0,T.v5)((0,T.$I)((async()=>{const We=await Ne.dispatch(s.m.endpoints.getAlertmanagerConfiguration.initiate(me,{forceRefetch:!0})).unwrap(),Ae=(0,a.isEmpty)(We.alertmanager_config)&&(0,a.isEmpty)(We.template_files),Ue=JSON.stringify(We)!==JSON.stringify(pe);if(!Ae&&Ue)throw new Error("A newer Alertmanager configuration is available. Please reload the page and try again to not overwrite recent changes.");if(await(0,m.vk)(me,(0,D.MZ)(ye)),Ne.dispatch(s.m.util.invalidateTags(["AlertmanagerConfiguration"])),Ie){const Me=new URLSearchParams(Oe??"");o.Ny.push((0,S.nL)(Ie,me,Me))}})()),{successMessage:Pe})),ee=(me,pe)=>async ye=>{const Pe=await ye(alertmanagerApi.endpoints.getAlertmanagerConfiguration.initiate(pe)).unwrap();if(!Pe)throw new Error(`Config for ${pe} not found`);if(!Pe.alertmanager_config.receivers?.find(Oe=>Oe.name===me))throw new Error(`Cannot delete receiver ${me}: not found in config.`);const Ie={...Pe,alertmanager_config:{...Pe.alertmanager_config,receivers:Pe.alertmanager_config.receivers.filter(Oe=>Oe.name!==me)}};return ye(ne({newConfig:Ie,oldConfig:Pe,alertManagerSourceName:pe,successMessage:"Contact point deleted."}))},Z=(me,pe)=>async ye=>{const Pe=await ye(s.m.endpoints.getAlertmanagerConfiguration.initiate(pe)).unwrap();if(!Pe)throw new Error(`Config for ${pe} not found`);if(typeof Pe.template_files?.[me]!="string")throw new Error(`Cannot delete template ${me}: not found in config.`);const Ie={...Pe.template_files};delete Ie[me];const Oe={...Pe,alertmanager_config:{...Pe.alertmanager_config,templates:Pe.alertmanager_config.templates?.filter(Ne=>Ne!==me)},template_files:Ie};return ye(ne({newConfig:Oe,oldConfig:Pe,alertManagerSourceName:pe,successMessage:"Template deleted."}))},z=(0,n.zD)("unifiedalerting/fetchFolder",me=>(0,T.$I)(f.IB.getFolderByUid(me,{withAccessControl:!0}))),q=me=>(pe,ye)=>{ye().unifiedAlerting.folders[me]?.dispatched||pe(z(me))},ie=(0,n.zD)("unifiedalerting/fetchAlertGroups",me=>(0,T.$I)((0,m.f4)(me))),de=(0,n.zD)("unifiedalerting/deleteAlertManagerConfig",async(me,pe)=>(0,T.v5)((0,T.$I)((async()=>{await(0,m.nd)(me),await pe.dispatch(s.m.util.invalidateTags(["AlertmanagerConfiguration"]))})()),{errorMessage:"Failed to reset Alertmanager configuration",successMessage:"Alertmanager configuration reset."})),ue=(me,pe)=>async ye=>{const Pe=await ye(s.m.endpoints.getAlertmanagerConfiguration.initiate(me)).unwrap(),Ie=me===E.hY,Oe=(Pe?.alertmanager_config?.mute_time_intervals??[])?.filter(({name:Ae})=>Ae!==pe)??[],Ne=(Pe?.alertmanager_config?.time_intervals??[])?.filter(({name:Ae})=>Ae!==pe)??[],We=Ie?{mute_time_intervals:[...Oe,...Ne]}:{time_intervals:Ne,mute_time_intervals:Oe};if(Pe){const{mute_time_intervals:Ae,...Ue}=Pe?.alertmanager_config??{};(0,T.v5)(ye(ne({alertManagerSourceName:me,oldConfig:Pe,newConfig:{...Pe,alertmanager_config:{...Ue,route:Pe.alertmanager_config.route?(0,D.Dk)(pe,Pe.alertmanager_config?.route):void 0,...We}}})),{successMessage:`Deleted "${pe}" from Alertmanager configuration`,errorMessage:"Failed to delete mute timing"})}},fe=(0,n.zD)("unifiedalerting/testReceivers",({alertManagerSourceName:me,receivers:pe,alert:ye})=>(0,T.v5)((0,T.$I)((0,m.By)(me,pe,ye)),{errorMessage:"Failed to send test alert.",successMessage:"Test alert sent."})),Se=(me,pe)=>me.filter(ye=>{const{forDuration:Pe}=(0,x.jg)(ye,pe),Ie=(0,R.P8)(Pe),Oe=(0,R.P8)(pe);return Ie!==0&&Ie<Oe}),he=(0,n.zD)("unifiedalerting/updateLotexNamespaceAndGroup",async(me,pe)=>(0,T.v5)((0,T.$I)((async()=>{const{rulesSourceName:ye,namespaceName:Pe,groupName:Ie,newNamespaceName:Oe,newGroupName:Ne,groupInterval:We,folderUid:Ae}=me,Ue=N(pe.getState,ye),Me=await(0,y.iy)(Ue);if(!!!Me[Pe])throw new Error(`Namespace "${Pe}" not found.`);const ke=Me[Pe].find(ft=>ft.name===Ie);if(!ke)throw new Error(`Group "${Ie}" not found.`);const Ze=!!Me[Pe].find(ft=>ft.name===Ne);if(Ne!==Ie&&Ze)throw new Error(`Group "${Ne}" already exists in namespace "${Pe}".`);const ot=!!Me[Oe],ct=ye===E.hY?(0,p.wf)(Pe):Pe;if(Oe!==ct&&ot)throw new Error(`Namespace "${Oe}" already exists.`);if(Oe===ct&&Ie===Ne&&We===ke.interval)throw new Error("Nothing changed.");if(We!==ke.interval){const ft=Se(ke.rules,We??"1m");if(ft.length>0)throw new Error(`These alerts belonging to this group will have an invalid 'For' value: ${ft.map(Le=>{const{alertName:re}=(0,x.jg)(Le,We??"");return re}).join(",")}`)}if(Oe!==ct){for(const ft of Me[Pe])await(0,y.E8)(Ue,Oe,ft.name===Ie?{...ft,name:Ne,interval:We}:ft);await(0,y.BK)(Ue,Ae||Pe)}else await(0,y.E8)(Ue,Ae||Pe,{...ke,name:Ne,interval:We}),Ne!==Ie&&await(0,y.AJ)(Ue,Ae||Pe,Ie);await pe.dispatch(K({rulesSourceName:ye}))})()),{errorMessage:"Failed to update namespace / group",successMessage:"Update successful"})),ce=(0,n.zD)("unifiedalerting/updateRulesOrderForGroup",async(me,pe)=>(0,T.v5)((0,T.$I)((async()=>{const{rulesSourceName:ye,namespaceName:Pe,groupName:Ie,newRules:Oe,folderUid:Ne}=me,We=N(pe.getState,ye),Ue=(await(0,y.iy)(We))[Pe].find($e=>$e.name===Ie);if(!Ue)throw new Error(`Group "${Ie}" not found.`);if(Ue.rules.length!==Oe.length){const $e=new Error("Rules count mismatch. Please refresh the page and try again.");throw(0,d.vV)($e,{namespaceName:Pe,groupName:Ie}),$e}const Me={name:Ue.name,interval:Ue.interval,rules:Oe};await(0,y.E8)(We,Ne??Pe,Me),await pe.dispatch(K({rulesSourceName:ye}))})()),{errorMessage:"Failed to update namespace / group",successMessage:"Update successful"}))},22620:(Q,I,e)=>{"use strict";e.d(I,{H:()=>a});var n=e(32196);const a=o=>(0,n.css)({float:"none",display:"flex",justifyContent:"flex-start",margin:o.spacing(2,0)})},99494:(Q,I,e)=>{"use strict";e.d(I,{W:()=>n});var n=(a=>(a.Incident="grafana-incident-app",a.OnCall="grafana-oncall-app",a.MachineLearning="grafana-ml-app",a.Labels="grafana-labels-app",a))(n||{})},86590:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>n});var n=(a=>(a.grafana="grafana",a.cloudAlerting="cloud-alerting",a.cloudRecording="cloud-recording",a))(n||{})},41068:(Q,I,e)=>{"use strict";e.d(I,{y:()=>n});var n=(a=>(a.seconds="s",a.minutes="m",a.hours="h",a.days="d",a.weeks="w",a))(n||{})},75471:(Q,I,e)=>{"use strict";e.d(I,{C0:()=>g,HL:()=>f,Q9:()=>P,VQ:()=>d,Wd:()=>b,jy:()=>h,lV:()=>u,nU:()=>l,q0:()=>c});var n=e(2913),a=e(16233),o=e(31678),r=e(57220);function i(y){return(0,r.z2)(y)?"grafana":"external"}const f={read:{grafana:o.AccessControlAction.AlertingInstanceRead,external:o.AccessControlAction.AlertingInstancesExternalRead},create:{grafana:o.AccessControlAction.AlertingInstanceCreate,external:o.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:o.AccessControlAction.AlertingInstanceUpdate,external:o.AccessControlAction.AlertingInstancesExternalWrite},delete:{grafana:o.AccessControlAction.AlertingInstanceUpdate,external:o.AccessControlAction.AlertingInstancesExternalWrite}},d={read:{grafana:o.AccessControlAction.AlertingNotificationsRead,external:o.AccessControlAction.AlertingNotificationsExternalRead},create:{grafana:o.AccessControlAction.AlertingNotificationsWrite,external:o.AccessControlAction.AlertingNotificationsExternalWrite},update:{grafana:o.AccessControlAction.AlertingNotificationsWrite,external:o.AccessControlAction.AlertingNotificationsExternalWrite},delete:{grafana:o.AccessControlAction.AlertingNotificationsWrite,external:o.AccessControlAction.AlertingNotificationsExternalWrite}},l={read:{grafana:o.AccessControlAction.AlertingSilenceRead,external:o.AccessControlAction.AlertingInstanceRead},create:{grafana:o.AccessControlAction.AlertingSilenceCreate,external:o.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:o.AccessControlAction.AlertingSilenceUpdate,external:o.AccessControlAction.AlertingInstancesExternalWrite}},m={read:o.AccessControlAction.AlertingProvisioningRead,readSecrets:o.AccessControlAction.AlertingProvisioningReadSecrets,write:o.AccessControlAction.AlertingProvisioningWrite},s={read:{grafana:o.AccessControlAction.AlertingRuleRead,external:o.AccessControlAction.AlertingRuleExternalRead},create:{grafana:o.AccessControlAction.AlertingRuleCreate,external:o.AccessControlAction.AlertingRuleExternalWrite},update:{grafana:o.AccessControlAction.AlertingRuleUpdate,external:o.AccessControlAction.AlertingRuleExternalWrite},delete:{grafana:o.AccessControlAction.AlertingRuleDelete,external:o.AccessControlAction.AlertingRuleExternalWrite}};function h(y){const p=i(y);return{read:f.read[p],create:f.create[p],update:f.update[p],delete:f.delete[p]}}function u(y){const p=i(y);return{read:d.read[p],create:d.create[p],update:d.update[p],delete:d.delete[p],provisioning:m}}function b(y){const p=i(y);return{read:s.read[p],create:s.create[p],update:s.update[p],delete:s.delete[p]}}function g(y){return()=>a.TP.evaluatePermission(y)}function P(){return{canCreateGrafanaRules:a.TP.hasPermission(o.AccessControlAction.FoldersRead)&&a.TP.hasPermission(s.create.grafana),canCreateCloudRules:a.TP.hasPermission(o.AccessControlAction.DataSourcesRead)&&a.TP.hasPermission(s.create.external),canEditRules:y=>a.TP.hasPermission(b(y).update)}}function c(){const{unifiedAlertingEnabled:y}=(0,n.zj)(),p=a.TP.hasPermission(b(r.hY).read),v=a.TP.hasPermission(b(r.hY).update);return y&&p&&v}},98164:(Q,I,e)=>{"use strict";e.d(I,{$P:()=>R,Av:()=>D,Dk:()=>l,Dm:()=>x,EU:()=>E,J$:()=>p,LF:()=>A,Lt:()=>m,MN:()=>h,MU:()=>b,MZ:()=>d,NL:()=>y,UL:()=>O,VE:()=>S,Wc:()=>g,mP:()=>L,uH:()=>C,xH:()=>c});var n=e(2543),a=e.n(n),o=e(60021),r=e(82775),i=e(57220),f=e(32642);function d(N){return N.alertmanager_config.receivers||(N.alertmanager_config.receivers=[{name:"default "}]),N.alertmanager_config.route||(N.alertmanager_config.route={receiver:N.alertmanager_config.receivers[0].name}),N.template_files||(N.template_files={}),N}function l(N,F){return{...F,mute_time_intervals:F.mute_time_intervals?.filter(B=>B!==N)??[],routes:F.routes?.map(B=>l(N,B))}}function m(N,F,K){return{...K,mute_time_intervals:K.mute_time_intervals?.map(B=>B===F?N:B),routes:K.routes?.map(B=>m(N,F,B))}}function s(N){return N.map(([F,K,B])=>[F,K,unquoteWithUnescape(B)])}function h(N){return N.isEqual?N.isRegex?o.ho.regex:o.ho.equal:N.isRegex?o.ho.notRegex:o.ho.notEqual}function u(N){switch(N){case o.ho.equal:return{isEqual:!0,isRegex:!1};case o.ho.notEqual:return{isEqual:!1,isRegex:!1};case o.ho.regex:return{isEqual:!0,isRegex:!0};case o.ho.notRegex:return{isEqual:!1,isRegex:!0}}}function b(N){return{name:N.name,value:N.value,operator:h(N)}}function g(N){return{name:N.name,value:N.value,...u(N.operator)}}function P(N){return`{${N.map(b).reduce((B,w)=>{const U=`${w.name}${w.operator}"${w.value}"`;return B?`${B},${U}`:U},"")}}`}const c=[{label:o.ho.equal,description:"Equals",value:o.ho.equal},{label:o.ho.notEqual,description:"Does not equal",value:o.ho.notEqual},{label:o.ho.regex,description:"Matches regex",value:o.ho.regex},{label:o.ho.notRegex,description:"Does not match regex",value:o.ho.notRegex}];function y(N){const F=h(N);return[N.name,F,N.value]}function p(N){const F=/\b([\w.-]+)(=~|!=|!~|=(?="?\w))"?([^"\n,}]*)"?/g,K=[];return N.replace(F,(B,w,U,W)=>{const V=U===o.ho.equal||U===o.ho.regex,_=U===o.ho.regex||U===o.ho.notRegex;return K.push({name:w,value:_?v(W.trim()):W.trim(),isEqual:V,isRegex:_}),""}),K}function v(N){try{return new RegExp(N),N}catch{return""}}function D(N,F){return F.every(({name:K,value:B,isRegex:w,isEqual:U})=>Object.entries(N).some(([W,V])=>{const _=K===W;let H;return U&&!w&&(H=B===V),!U&&!w&&(H=B!==V),U&&w&&(H=new RegExp(B).test(V)),!U&&w&&(H=!new RegExp(B).test(V)),_&&H}))}function E(...N){const F=N.map(p).flat(),K=(0,n.uniqWith)(F,n.isEqual);return P(K)}function S(N){return N===i.hY?"default":"unquote"}function T(){return getAllDataSources().filter(N=>N.type===DataSourceType.Alertmanager)}function M(N){return T().find(F=>N===F.uid)}function A(N){const{times:F,weekdays:K,days_of_month:B,months:w,years:U,location:W}=N,V=x(F,W),_=C(K),H=O(B),G=R(w),j=L(U);return[V,_,H,G,j].join(", ")}function x(N,F){return"Times: "+(N?N?.map(({start_time:K,end_time:B})=>`${K} - ${B} [${F??"UTC"}]`).join(" and "):"All")}function C(N){return"Weekdays: "+(N?.map(F=>{if(F.includes(":"))return F.split(":").map(K=>{const B=K.slice(0,3);return B[0].toLocaleUpperCase()+B.slice(1)}).join("-");{const K=F.slice(0,3);return K[0].toLocaleUpperCase()+K.slice(1)}}).join(", ")??"All")}function O(N){return"Days of the month: "+(N?.join(", ")??"All")}function R(N){return"Months: "+(N?.join(", ")??"All")}function L(N){return"Years: "+(N?.join(", ")??"All")}},33225:(Q,I,e)=>{"use strict";e.d(I,{Hx:()=>i,gO:()=>f});var n=e(96540),a=e(55740),o=e(56361);function r(d){return{dashboardUID:d.find(([l])=>l===a.YH.dashboardUID)?.[1],panelId:d.find(([l])=>l===a.YH.panelID)?.[1]}}function i(d){return(0,n.useMemo)(()=>Object.entries(d||{}).filter(([l,m])=>!!m.trim()),[d])}function f(d){const l=new Map,{panelId:m,dashboardUID:s}=r(d);return s&&l.set(a.YH.dashboardUID,(0,o.JM)(s)),s&&m&&l.set(a.YH.panelID,(0,o.D2)(s,m)),l}},82775:(Q,I,e)=>{"use strict";e.d(I,{k:()=>o,q:()=>r});var n=e(32264),a=e(25968);function o(){return Object.values(n.$.datasources)}function r(i){if(!(0,a.TN)(n.$.unifiedAlerting.minInterval))return{globalLimit:0,exceedsLimit:!1};const f=(0,a.P8)(n.$.unifiedAlerting.minInterval);if(!i||!(0,a.TN)(i))return{globalLimit:f,exceedsLimit:!1};const d=(0,a.P8)(i),l=f>d&&d>0;return{globalLimit:f,exceedsLimit:l}}},55740:(Q,I,e)=>{"use strict";e.d(I,{DD:()=>o,H8:()=>b,HH:()=>a,J3:()=>u,Oq:()=>r,U3:()=>f,UU:()=>n,YH:()=>h,cB:()=>d,kW:()=>P,kl:()=>g,wG:()=>i});const n="ruler not supported",a=2e4,o="alertmanager",r="alerting-alertmanager",i=2e4,f=2e4,d=2e4,l="timeseries",m="table",s="stat";var h=(c=>(c.description="description",c.summary="summary",c.runbookURL="runbook_url",c.alertId="__alertId__",c.dashboardUID="__dashboardUid__",c.panelID="__panelId__",c))(h||{});const u={description:"Description",summary:"Summary",runbook_url:"Runbook URL",__dashboardUid__:"Dashboard UID",__panelId__:"Panel ID",__alertId__:"Alert ID"},b={description:"Description of what the alert rule does.",summary:"Short summary of what happened and why.",runbook_url:"Webpage where you keep your runbook for the alert.",__dashboardUid__:"",__panelId__:"",__alertId__:""},g=[{key:"summary",value:""},{key:"description",value:""},{key:"runbook_url",value:""}],P="__alert_rule_uid__"},57220:(Q,I,e)=>{"use strict";e.d(I,{AL:()=>K,EV:()=>L,Eb:()=>F,Jz:()=>y,Vr:()=>oe,Zw:()=>V,bD:()=>D,cy:()=>A,gR:()=>O,hP:()=>Y,hY:()=>h,iV:()=>S,k5:()=>G,lS:()=>R,oh:()=>U,ol:()=>b,qi:()=>P,r3:()=>W,sq:()=>x,v0:()=>N,v8:()=>c,vv:()=>u,w5:()=>H,y9:()=>j,yc:()=>B,z2:()=>w});var n=e(19347),a=e(16233),o=e(60021),r=e(31678),i=e(94822),f=e(82843),d=e(62190),l=e(70383),m=e(75471),s=e(82775);const h="grafana",u="-- Grafana --";var b=(se=>(se.Alertmanager="alertmanager",se.Loki="loki",se.Prometheus="prometheus",se))(b||{});const g=["loki","prometheus"];function P(){return a.TP.hasPermission(r.AccessControlAction.AlertingRuleExternalRead)?(0,s.k)().filter(se=>g.includes(se.type)&&se.jsonData.manageAlerts!==!1).sort((se,ne)=>se.name.localeCompare(ne.name)):[]}function c(se){return w(se)?"grafana":se.uid??se.id}function y(se){return P().find(ne=>ne.name===se)}function p(){return(0,s.k)().filter(v).sort((se,ne)=>se.name.localeCompare(ne.name))}function v(se){return se.type==="alertmanager"}function D(se){return se.type==="alertmanager"}function E(){return p().filter(se=>se.jsonData.handleGrafanaManagedAlerts)}function S(se){return se.jsonData.handleGrafanaManagedAlerts===!0}const T={name:h,imgUrl:"public/img/grafana_icon.svg",hasConfigurationAPI:!0};function M(){return[T,...p().map(se=>({name:se.name,displayName:se.name,imgUrl:se.meta.info.logos.small,meta:se.meta}))]}function A(se){const ne=(0,d.W)(se),ee=ne.availableExternalDataSources.filter(ie=>ie.handleGrafanaManagedAlerts),Z=ne.availableInternalDataSources,{currentData:z}=f.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery();switch(z?.alertmanagersChoice){case o.nA.Internal:return Z;case o.nA.External:return ee;default:return[...Z,...ee]}}function x(se){const ne=[],ee=[],Z={instance:m.HL.read,notification:m.VQ.read,silence:m.nU.read};if(Object.values(Z).flatMap(ie=>ie.grafana).some(ie=>a.TP.hasPermission(ie))&&ne.push(T),a.TP.hasPermission(Z[se].external)){const ie=p().map(de=>({name:de.name,displayName:de.name,imgUrl:de.meta.info.logos.small,meta:de.meta,hasConfigurationAPI:(0,l.Kh)(de.jsonData),handleGrafanaManagedAlerts:de.jsonData.handleGrafanaManagedAlerts}));ee.push(...ie)}return{availableInternalDataSources:ne,availableExternalDataSources:ee}}function C(se){const ne=U(se);if(!ne)throw new Error(`Data source ${se} not found`);if(ne.type!=="loki"&&ne.type!=="prometheus")throw new Error(`Unexpected data source type ${ne.type}`);return ne}function O(){const se=P().map(ne=>ne.name);return a.TP.hasPermission(r.AccessControlAction.AlertingRuleRead)&&se.push(h),se}function R(){const se=P();return a.TP.hasPermission(r.AccessControlAction.AlertingRuleRead)&&se.push(h),se}function L(se){return F(se)?se.name:se}function N(se){return F(se)?se.uid:h}function F(se){return se!==h}function K(se){return se!==h&&W(se)?.jsonData?.implementation===o.Oz.prometheus}function B(se){return se.readOnly===!0}function w(se){return se===h}function U(se){return(0,s.k)().find(ne=>ne.name===se)}function W(se){return(0,s.k)().filter(v).find(ne=>ne.name===se)}function V(se){return se===h?h:U(se)}function _(se){if(se===h)return h;const ne=U(se);if(!ne)throw new Error(`Datasource "${se}" not found`);return String(ne.id)}function H(se){if(se===h)return h;const ne=U(se);if(!ne)throw new Error(`Datasource "${se}" not found`);return ne.uid}function G(){return(0,n.l)().getList({alerting:!0})[0]}function j(){const se=(0,n.l)().getInstanceSettings("default");return se?.meta.alerting??!1?se:G()}function Y(se){return se.jsonData.manageAlerts!==!1}function oe(se){return w(se)?"grafana":"prometheusType"in se.jsonData?se.jsonData?.prometheusType??i.N1.Prometheus:se.type==="loki"?"loki":i.N1.Prometheus}},75214:(Q,I,e)=>{"use strict";e.d(I,{Dd:()=>a,F2:()=>d,M4:()=>n,lL:()=>i,rm:()=>f,w0:()=>l,x4:()=>r,zm:()=>o});function n(m){return Object.entries(m).map(([s,h])=>`${s}=${h}`).sort()}function a(m){return Object.entries(m).map(([s,h])=>[s,h])}function o(m){const s={};return m.forEach(h=>{s[h[0]]=h[1]}),s}function r(m){const s={};return m.forEach(h=>{h.key&&(s[h.key]=h.value)}),s}const i="__grafana_origin";function f(m){return Object.keys(m).filter(s=>!d(s)).length}function d(m){return m.startsWith("__")&&m.endsWith("__")||m===i}const l=([m,s])=>d(m)},32642:(Q,I,e)=>{"use strict";e.d(I,{Ig:()=>c,J$:()=>h,J9:()=>s,So:()=>d,b2:()=>P,ou:()=>m,qR:()=>f,t8:()=>y});var n=e(2543),a=e.n(n),o=e(60021),r=e(75214);const i=[o.ho.regex,o.ho.notRegex,o.ho.notEqual,o.ho.equal];function f(E){if(E.startsWith("{")&&E.endsWith("}"))throw new Error("this function does not support PromQL-style matcher syntax, call parsePromQLStyleMatcher() instead");const S=i.map(C=>[C,E.indexOf(C)]).filter(([C,O])=>O>-1).sort((C,O)=>C[1]-O[1]);if(!S.length)throw new Error(`Invalid matcher: ${E}`);const[T,M]=S[0],A=E.slice(0,M).trim(),x=E.slice(M+T.length);if(!A)throw new Error(`Invalid matcher: ${E}`);return{name:A,value:x,isRegex:T===o.ho.regex||T===o.ho.notRegex,isEqual:T===o.ho.equal||T===o.ho.regex}}function d(E){return p(E)?l(E):[f(E)]}function l(E){if(!p(E))throw new Error("not a PromQL style matcher");const S=/,(?=(?:[^"]*"[^"]*")*[^"]*$)/,T=E.replace(/^\{/,"").replace(/\}$/,"").trim().split(S);return(0,n.compact)(T).flatMap(f).map(M=>({...M,name:c(M.name),value:c(M.value)}))}function m(E){const S=E.filter(T=>!!T.trim()).map(T=>f(T));return(0,n.uniqBy)(S,T=>T.name)}const s=E=>{const S=Object.entries(E).filter(([M])=>!(0,r.F2)(M)),T=new URLSearchParams;return S.forEach(([M,A])=>T.append("matcher",`${M}=${A}`)),T},h=E=>{let S=[];return E.matchers&&E.matchers.forEach(T=>{const M=d(T).map(v);S=S.concat(M)}),E.object_matchers&&S.push(...E.object_matchers),E.match_re&&Object.entries(E.match_re).forEach(([T,M])=>{S.push([T,o.ho.regex,M])}),E.match&&Object.entries(E.match).forEach(([T,M])=>{S.push([T,o.ho.equal,M])}),S};function u(E){return`"${E.replace(/[\\"]/g,T=>`\\${T}`)}"`}const b=/[\{\}\!\=\~\,\\\"\'\`\s]+/;function g(E){return b.test(E)?u(E):E}const P=({name:E,operator:S,value:T})=>{const M=g(E),A=u(T);return`${M}${S}${A}`};function c(E){return/^"(.*)"$/.test(E)?E.replace(/^"(.*)"$/,"$1").replace(/\\"/g,'"').replace(/\\\\/g,"\\"):E}const y={default:([E,S,T])=>`${E} ${S} ${T||""}`,unquote:([E,S,T])=>{const M=c(E),A=c(T)||'""';return`${M} ${S} ${A}`}};function p(E){return E.startsWith("{")&&E.endsWith("}")}function v(E){const S=D(E);return[E.name,S,E.value]}function D(E){return E.isEqual?E.isRegex?o.ho.regex:o.ho.equal:E.isRegex?o.ho.notRegex:o.ho.notEqual}},56361:(Q,I,e)=>{"use strict";e.d(I,{BK:()=>O,Cp:()=>W,D2:()=>B,ES:()=>H,GD:()=>R,Ht:()=>E,JM:()=>K,JZ:()=>j,KT:()=>M,NH:()=>L,S2:()=>v,Sl:()=>D,Y9:()=>C,Yp:()=>c,bg:()=>y,c$:()=>N,i7:()=>p,i9:()=>w,nL:()=>A,qN:()=>F,qc:()=>_,qy:()=>T,u7:()=>G,w$:()=>P,y$:()=>V});var n=e(2543),a=e.n(n),o=e(61268),r=e(32264),i=e(17172),f=e(16233),d=e(18461),l=e(23662),m=e(64861),s=e(94822),h=e(55740),u=e(57220),b=e(32642),g=e(3704);function P(Y,oe,se){const ne=(0,u.EV)(Y),ee=d.UP(ne,oe),Z=encodeURIComponent(d.$9(ee)),z=encodeURIComponent(ne);return(0,g.c)(`/alerting/${z}/${Z}/view`,se?{returnTo:se}:{})}function c(Y,oe){const{uid:se,type:ne}=Y;return(0,g.c)("/explore",{left:JSON.stringify({datasource:Y.uid,queries:[{refId:"A",datasource:{uid:se,type:ne},expr:oe}],range:{from:"now-1h",to:"now"}})})}function y(Y,oe=""){return(0,g.c)(`/alerting/notifications/receivers/${encodeURIComponent(Y)}/edit`,{alertmanager:oe})}function p(Y,oe=""){return(0,g.c)("/alerting/routes/mute-timing/edit",{muteName:Y,alertmanager:oe})}function v(Y,oe){if((0,u.Eb)(Y))return(0,g.z)(`/alerting/${encodeURIComponent(Y.name)}/${encodeURIComponent((0,d.PH)(oe.name))}/find`);if((0,l.lT)(oe.rulerRule))return(0,g.z)(`/alerting/grafana/${oe.rulerRule.grafana_alert.uid}/view`)}function D(Y){return Y.reduce((oe,{key:se,value:ne})=>(oe[se]=ne,oe),{})}const E=Y=>{const oe=Y.queryString===void 0?void 0:String(Y.queryString),se=Y.alertState===void 0?void 0:String(Y.alertState),ne=Y.dataSource===void 0?void 0:String(Y.dataSource),ee=Y.ruleType===void 0?void 0:String(Y.ruleType),Z=Y.groupBy===void 0?void 0:String(Y.groupBy).split(",");return{queryString:oe,alertState:se,dataSource:ne,groupBy:Z,ruleType:ee}},S=Y=>({queryString:Y.get("queryString")??void 0,contactPoint:Y.get("contactPoint")??void 0}),T=Y=>{const oe=Y.queryString===void 0?void 0:String(Y.queryString),se=Y.silenceState===void 0?void 0:String(Y.silenceState);return{queryString:oe,silenceState:se}};function M(Y){return Object.entries(Y).map(([oe,se])=>({key:oe,value:se}))}function A(Y,oe,se){const ne=new URLSearchParams(se);return oe&&ne.set(h.DD,oe),`${Y}?${ne.toString()}`}const x=Y=>Y.replace(/\"/g,'\\"');function C(Y){return Y.startsWith('"')&&Y.endsWith('"')?x(Y):`"${x(Y)}"`}function O(Y,oe){const se=new URLSearchParams;return se.append("alertmanager",Y),(0,b.J9)(oe).forEach((ee,Z)=>se.append(Z,ee)),(0,g.c)("/alerting/silence/new",se)}function R(Y){return(0,g.c)(`/datasources/edit/${Y}`)}function L(Y){return(0,g.c)(`/dashboards/f/${Y}`)}function N(Y,oe){return(0,g.c)(`/dashboards/f/${Y}/${oe}/alerting`)}function F(Y){return(0,g.c)(`/dashboards/f/${Y}/settings`)}function K(Y){return(0,g.c)(`/d/${encodeURIComponent(Y)}`)}function B(Y,oe){const se=new URLSearchParams({viewPanel:oe});return(0,g.c)(`/d/${encodeURIComponent(Y)}`,se)}function w(Y,oe,se,ne=1e3){const ee=new Date().getTime(),Z=()=>Y().catch(z=>{if(oe(z)&&new Date().getTime()-ee<se)return new Promise(q=>setTimeout(q,ne)).then(Z);throw z});return Z()}const U={[s.Gi.Alerting]:1,[s.cF.Firing]:1,[s.Gi.Error]:1,[s.Gi.Pending]:2,[s.cF.Pending]:2,[s.cF.Inactive]:2,[s.Gi.NoData]:3,[s.Gi.Normal]:4};function W(Y,oe){if(Y===m.xB.Importance)return(0,n.sortBy)(oe,ne=>[U[(0,s.lh)(ne.state)],(0,l.RI)(ne).toLocaleLowerCase()]);if(Y===m.xB.TimeAsc)return(0,n.sortBy)(oe,ne=>[new Date(ne.activeAt)||new Date,(0,l.RI)(ne).toLocaleLowerCase()]);if(Y===m.xB.TimeDesc)return(0,n.sortBy)(oe,ne=>[new Date(ne.activeAt)||new Date,(0,l.RI)(ne).toLocaleLowerCase()]).reverse();const se=(0,n.sortBy)(oe,ne=>(0,l.RI)(ne).toLocaleLowerCase());return Y===m.xB.AlphaDesc&&se.reverse(),se}function V(){return r.$.buildInfo.edition===o.r.OpenSource}function _(){return f.TP.hasRole("Admin")||f.TP.isGrafanaAdmin}function H(){return r.$.buildInfo.env==="development"}function G(Y){return!!(Y&&typeof Y=="object"&&"message"in Y)}function j(Y){return(0,i.NF)(Y)?Y.message?Y.message:"message"in Y.data&&typeof Y.data.message=="string"?Y.data.message:Y.statusText?Y.statusText:String(Y.status)||"Unknown error":G(Y)?Y.message:String(Y)}},88467:(Q,I,e)=>{"use strict";e.d(I,{$I:()=>h,BU:()=>E,CZ:()=>g,J7:()=>m,ML:()=>S,Vf:()=>v,Xw:()=>s,jA:()=>d,p0:()=>P,t4:()=>D,v5:()=>u});var n=e(65307),a=e(26272),o=e(17172),r=e(10096),i=e(25027),f=e(56361);const d=Object.freeze({loading:!1,result:void 0,error:void 0,dispatched:!1});function l(T,M=d,A){if(T.pending.match(A))return{result:M.result,loading:!0,error:M.error,dispatched:!0,requestId:A.meta.requestId};if(T.fulfilled.match(A)){if(M.requestId===void 0||M.requestId===A.meta.requestId)return{...M,result:A.payload,loading:!1,error:void 0}}else if(T.rejected.match(A)&&M.requestId===A.meta.requestId)return{...M,loading:!1,error:A.error};return M}function m(T,M){return(0,n.Z0)({name:T,initialState:d,reducers:{},extraReducers:A=>A.addDefaultCase((x,C)=>l(M,x,C))})}function s(T,M,A){return(0,n.Z0)({name:T,initialState:{},reducers:{},extraReducers:x=>x.addDefaultCase((C,O)=>{if((0,n.$S)(M)(O)){const R=O,L=A(R.meta.arg);return{...C,[L]:l(M,C[L],R)}}return C})})}function h(T){return T.catch(M=>{throw{message:g(M),code:M.statusCode}})}function u(T,M){return T.then(A=>(M.successMessage&&r.lE.emit(a.r1.alertSuccess,[M.successMessage]),A)).catch(A=>{const x=g(A);throw r.lE.emit(a.r1.alertError,[`${M.errorMessage??"Error"}: ${x}`]),A})}const b="Unknown Error";function g(T){if((0,o.NF)(T))if(T.data?.message){let M=T.data?.message;return typeof T.data?.error=="string"&&(M+=`; ${T.data.error}`),M}else{if(Array.isArray(T.data)&&T.data.length&&T.data[0]?.message)return T.data.map(M=>M?.message).filter(M=>!!M).join(" ");if(T.statusText)return T.statusText}return(0,f.u7)(T)?T.message:((0,i.fH)(i.le.unknownMessageFromError,{error:JSON.stringify(T)}),b)}function P(T){return Object.values(T).every(c)}function c(T){return T.dispatched&&!T.loading}function y(T){return Object.values(T).every(p)}function p(T){return T.dispatched&&!T.loading&&!T.error}function v(T){return Object.values(T).some(S)}function D(T){return Object.values(T).some(M=>M.dispatched)}function E(T){return Object.values(T).some(p)}function S(T){return T?T.dispatched&&T.loading:!1}},63066:(Q,I,e)=>{"use strict";e.d(I,{Bu:()=>ne,IJ:()=>x,J6:()=>j,JE:()=>L,Q8:()=>E,QX:()=>B,Qk:()=>w,Rk:()=>ee,T6:()=>A,XI:()=>U,Z9:()=>F,ir:()=>Z,l1:()=>O,mp:()=>G,qO:()=>W});var n=e(2543),a=e.n(n),o=e(43127),r=e(65879),i=e(77789),f=e(32264),d=e(19347),l=e(26657),m=e(16401),s=e(74730),h=e(66718),u=e(94822),b=e(55907),g=e(86590),P=e(75471),c=e(55740),y=e(57220),p=e(56361),v=e(23662),D=e(25968);const E="grafana.alerting.manualRouting",S=(0,D.P8)(f.$.unifiedAlerting?.minInterval??"10s"),T=(0,D.P8)("1m"),A=(0,D.an)((0,n.clamp)(S,T,1/0)),x=()=>{const{canCreateGrafanaRules:z,canCreateCloudRules:q}=(0,P.Q9)();return Object.freeze({name:"",uid:"",labels:[{key:"",value:""}],annotations:c.kl,dataSourceName:null,type:z?g.Z.grafana:q?g.Z.cloudAlerting:void 0,group:"",folder:null,queries:[],recordingRulesQueries:[],condition:"",noDataState:u.Q8.NoData,execErrState:u.Q8.Error,evaluateFor:A,evaluateEvery:A,manualRouting:C(),contactPoints:{},overrideGrouping:!1,overrideTimings:!1,muteTimeIntervals:[],namespace:"",expression:"",forTime:1,forTimeUnit:"m"})},C=()=>f.$.featureToggles.alertingSimplifiedRouting??!1?localStorage.getItem(E)!=="false":!1;function O(z){const{name:q,expression:ie,forTime:de,forTimeUnit:ue,keepFiringForTime:fe,keepFiringForTimeUnit:Se,type:he}=z;if(he===g.Z.cloudAlerting){let ce;return fe&&Se&&(ce=`${fe}${Se}`),{alert:q,for:`${de}${ue}`,keep_firing_for:ce,annotations:(0,p.Sl)(z.annotations||[]),labels:(0,p.Sl)(z.labels||[]),expr:ie}}else if(he===g.Z.cloudRecording)return{record:q,labels:(0,p.Sl)(z.labels||[]),expr:ie};throw new Error(`unexpected rule type: ${he}`)}function R(z,q){const ie=[...(0,p.KT)(z||{})];return q&&ie.push({key:"",value:""}),ie}function L(z){const q=[...z];return c.kl.map(de=>de.key).forEach((de,ue)=>{const fe=q.findIndex(Se=>Se.key===de);if(fe===-1){const Se={key:de,value:""};q.splice(ue,0,Se)}else fe!==ue&&q.splice(ue,0,q.splice(fe,1)[0])}),q}function N(z,q){if(q?.grafana?.selectedContactPoint&&z)return{receiver:q?.grafana?.selectedContactPoint,mute_time_intervals:q?.grafana?.muteTimeIntervals,group_by:q?.grafana?.overrideGrouping?q?.grafana?.groupBy:void 0,group_wait:q?.grafana?.overrideTimings&&q?.grafana?.groupWaitValue?q?.grafana?.groupWaitValue:void 0,group_interval:q?.grafana?.overrideTimings&&q?.grafana?.groupIntervalValue?q?.grafana?.groupIntervalValue:void 0,repeat_interval:q?.grafana?.overrideTimings&&q?.grafana?.repeatIntervalValue?q?.grafana?.repeatIntervalValue:void 0}}function F(z){const{name:q,condition:ie,noDataState:de,execErrState:ue,evaluateFor:fe,queries:Se,isPaused:he,contactPoints:ce,manualRouting:me}=z;if(ie){const pe=N(me,ce);return{grafana_alert:{title:q,condition:ie,no_data_state:de,exec_err_state:ue,data:Se.map(oe),is_paused:!!he,notification_settings:pe},for:fe,annotations:(0,p.Sl)(z.annotations||[]),labels:(0,p.Sl)(z.labels||[])}}throw new Error("Cannot create rule without specifying alert condition")}function K(z){const q=z.notification_settings?{selectedContactPoint:z.notification_settings.receiver,muteTimeIntervals:z.notification_settings.mute_time_intervals??[],overrideGrouping:Array.isArray(z.notification_settings.group_by)&&z.notification_settings.group_by.length>0,overrideTimings:[z.notification_settings.group_wait,z.notification_settings.group_interval,z.notification_settings.repeat_interval].some(Boolean),groupBy:z.notification_settings.group_by||[],groupWaitValue:z.notification_settings.group_wait||"",groupIntervalValue:z.notification_settings.group_interval||"",repeatIntervalValue:z.notification_settings.repeat_interval||""}:void 0;return q?{[y.hY]:q}:void 0}function B(z){const{ruleSourceName:q,namespace:ie,group:de,rule:ue}=z,fe=x();if((0,y.z2)(q))if((0,v.lT)(ue)){const Se=ue.grafana_alert,he=K(Se);return{...fe,name:Se.title,type:g.Z.grafana,group:de.name,evaluateEvery:de.interval||fe.evaluateEvery,evaluateFor:ue.for||"0",noDataState:Se.no_data_state,execErrState:Se.exec_err_state,queries:Se.data,condition:Se.condition,annotations:L(R(ue.annotations,!1)),labels:R(ue.labels,!0),folder:{title:ie,uid:Se.namespace_uid},isPaused:Se.is_paused,contactPoints:he,manualRouting:!!he}}else throw new Error("Unexpected type of rule for grafana rules source");else if((0,v.$y)(ue)){const he={refId:"A",datasourceUid:(0,d.l)().getInstanceSettings(q)?.uid??"",queryType:"",relativeTimeRange:(0,o.Cn)(),expr:ue.expr,model:{refId:"A",hide:!1,expr:ue.expr}},ce=w(ue);return{...fe,...ce,queries:[he],annotations:L(R(ue.annotations,!1)),type:g.Z.cloudAlerting,dataSourceName:q,namespace:ie,group:de.name}}else if((0,v.i7)(ue)){const Se=U(ue);return{...fe,...Se,type:g.Z.cloudRecording,dataSourceName:q,namespace:ie,group:de.name}}else throw new Error("Unexpected type of rule for cloud rules source")}function w(z){const q=x(),[ie,de]=z.for?(0,D.P1)(z.for):[0,"s"],[ue,fe]=z.keep_firing_for?(0,D.P1)(z.keep_firing_for):[q.keepFiringForTime,q.keepFiringForTimeUnit];return{name:z.alert,expression:z.expr,forTime:ie,forTimeUnit:de,keepFiringForTime:ue,keepFiringForTimeUnit:fe,annotations:R(z.annotations,!1),labels:R(z.labels,!0)}}function U(z){return{name:z.record,expression:z.expr,labels:R(z.labels,!0)}}const W=()=>{const z=(0,y.y9)();if(!z)return[..._("A","B")];const q=(0,o.Cn)();return[{refId:"A",datasourceUid:z.uid,queryType:"",relativeTimeRange:q,model:{refId:"A"}},..._("B","C")]},V=z=>{const q=getDefaultRelativeTimeRange();return[{refId:"A",datasourceUid:z[0]?.uid||"",queryType:"",relativeTimeRange:q,model:{refId:"A"}}]},_=(...z)=>{const q=z[0],ie=z[1],de={refId:z[0],type:h.Tz.reduce,datasource:{uid:h.Uj,type:l.dR.type},conditions:[{type:"query",evaluator:{params:[],type:b.p.IsAbove},operator:{type:"and"},query:{params:[q]},reducer:{params:[],type:"last"}}],reducer:"last",expression:"A"},ue={refId:ie,type:h.Tz.threshold,datasource:{uid:h.Uj,type:l.dR.type},conditions:[{type:"query",evaluator:{params:[0],type:b.p.IsAbove},operator:{type:"and"},query:{params:[ie]},reducer:{params:[],type:"last"}}],expression:q};return[{refId:q,datasourceUid:h.Uj,queryType:"",model:de},{refId:ie,datasourceUid:h.Uj,queryType:"",model:ue}]},H=async(z,q,ie,de,ue,fe)=>{const Se=[];for(const he of z){const ce=await(0,d.l)().get(he.datasource?.uid?he.datasource:de),me={uid:ce.uid,type:ce.type},pe=r.relativeToTimeRange(q),{interval:ye,intervalMs:Pe}=Y(pe,fe??ce.interval,ue),Ie={__interval:{text:ye,value:ye},__interval_ms:{text:Pe,value:Pe},...ie},Oe=ce.interpolateVariablesInQueries?ce.interpolateVariablesInQueries([he],Ie)[0]:he;if(me.uid===h.Uj){const Ne={refId:Oe.refId,queryType:"",relativeTimeRange:q,datasourceUid:h.Uj,model:Oe};Se.push(Ne)}else{const Ne=(0,d.l)().getInstanceSettings(me);if(Ne&&Ne.meta.alerting){const We={refId:Oe.refId,queryType:Oe.queryType??"",relativeTimeRange:q,datasourceUid:Ne.uid,model:{...Oe,maxDataPoints:ue,intervalMs:Pe}};Se.push(We)}}}return Se},G=async(z,q)=>{const{targets:ie}=z;if(!z.id||!q.uid)return;const de=r.timeRangeToRelative(r.convertRawToRange(q.time)),ue=await H(ie,de,z.scopedVars||{},z.datasource??void 0,z.maxDataPoints??void 0,z.interval??void 0);if(!ue.length||!ue.find(ce=>ce.datasourceUid!==h.Uj))return;if(!ue.find(ce=>ce.datasourceUid===h.Uj)){const[ce,me]=_((0,i.M)(ue),"-");ue.push(ce);const[pe,ye]=_(ce.refId,(0,i.M)(ue));ue.push(ye)}const{folderTitle:fe,folderUid:Se}=q.meta;return{type:g.Z.grafana,folder:Se&&fe?{uid:Se,title:fe}:void 0,queries:ue,name:z.title,condition:ue[ue.length-1].refId,annotations:[{key:c.YH.dashboardUID,value:q.uid},{key:c.YH.panelID,value:String(z.id)}]}},j=async z=>{if(!z.state.key)return;const q=m.jh.getTimeRange(z),ie=(0,s.un)(z);if(!ie)return;const{queries:de,datasource:ue,maxDataPoints:fe,minInterval:Se}=ie.state,he=(0,s.YQ)(z);if(!he||!he.state.uid)return;const ce=await H(de,r.timeRangeToRelative(r.convertRawToRange(q.state.value.raw)),{__sceneObject:{value:z}},ue,fe,Se);if(!ce.length||!ce.find(Pe=>Pe.datasourceUid!==h.Uj))return;if(!ce.find(Pe=>Pe.datasourceUid===h.Uj)){const[Pe,Ie]=_((0,i.M)(ce),"-");ce.push(Pe);const[Oe,Ne]=_(Pe.refId,(0,i.M)(ce));ce.push(Ne)}const{folderTitle:me,folderUid:pe}=he.state.meta;return{type:g.Z.grafana,folder:pe&&me?{uid:pe,title:me}:void 0,queries:ce,name:z.state.title,condition:ce[ce.length-1].refId,annotations:[{key:c.YH.dashboardUID,value:he.state.uid},{key:c.YH.panelID,value:String((0,s.Cs)(z))}]}};function Y(z,q,ie){return ie?r.calculateInterval(z,ie,q):q&&r.intervalToMs(q)>1e3?{interval:q,intervalMs:r.intervalToMs(q)}:{interval:"1s",intervalMs:1e3}}function oe(z){const q=z.model;return se(q)&&q.instant&&q.range?{...z,model:{...q,range:!0,instant:!1}}:z}function se(z){return"expr"in z&&"instant"in z&&"range"in z}function ne(z){return"expr"in z}const ee=z=>({...z,queries:z.queries?.map(q=>(0,n.omit)(q,"model.hide"))});function Z(z){return ee(B(z))}},18461:(Q,I,e)=>{"use strict";e.d(I,{$9:()=>v,LC:()=>s,Ns:()=>E,P1:()=>f,PH:()=>P,UP:()=>l,VY:()=>M,Yd:()=>m,c:()=>c,qg:()=>y,uE:()=>A,x6:()=>p});var n=e(2543),a=e.n(n),o=e(12131),r=e(57220),i=e(23662);function f(x,C,O,R){return(0,i.lT)(R)?{uid:R.grafana_alert.uid,ruleSourceName:"grafana"}:{ruleSourceName:x,namespace:C,groupName:O,ruleName:(0,i.$y)(R)?R.alert:R.record,rulerRuleHash:E(R)}}function d(x,C,O,R){return{ruleSourceName:x,namespace:C,groupName:O,ruleName:R.name,ruleHash:S(R)}}function l(x,C){const O=C.namespace.name,R=C.group.name;if(C.rulerRule)return f(x,O,R,C.rulerRule);if(C.promRule)return d(x,O,R,C.promRule);throw new Error("Could not create an id for a rule that is missing both `rulerRule` and `promRule`.")}function m(x){return f(x.ruleSourceName,x.namespace,x.group.name,x.rule)}function s(x,C){return(0,i.A4)(x)&&(0,i.A4)(C)?x.uid===C.uid:(0,i.X4)(x)&&(0,i.X4)(C)?x.groupName===C.groupName&&x.namespace===C.namespace&&x.ruleName===C.ruleName&&x.rulerRuleHash===C.rulerRuleHash&&x.ruleSourceName===C.ruleSourceName:(0,i.Mj)(x)&&(0,i.Mj)(C)?x.groupName===C.groupName&&x.namespace===C.namespace&&x.ruleName===C.ruleName&&x.ruleHash===C.ruleHash&&x.ruleSourceName===C.ruleSourceName:!1}const h="cri",u="pri";function b(x){return x.replace(/\$/g,"_DOLLAR_")}function g(x){return x.replace(/\_DOLLAR\_/g,"$")}function P(x){return x.replace(/\//g,"").replace(/\\/g,"")}function c(x){return x.replace(/\x1f/g,"/").replace(/\x1e/g,"\\")}function y(x,C=!1){const R=(C?decodeURIComponent(x):x).split("$");if(R.length===1)return{uid:x,ruleSourceName:"grafana"};if(R.length===6){const[L,N,F,K,B,w]=R.map(g).map(c);if(L===h)return{ruleSourceName:N,namespace:F,groupName:K,ruleName:B,rulerRuleHash:w};if(L===u)return{ruleSourceName:N,namespace:F,groupName:K,ruleName:B,ruleHash:w}}throw new Error(`Failed to parse rule location: ${x}`)}function p(x,C=!1){if(x)try{return y(x,C)}catch{return}}function v(x){return(0,i.A4)(x)?x.uid:(0,i.X4)(x)?[h,x.ruleSourceName,x.namespace,x.groupName,x.ruleName,x.rulerRuleHash].map(String).map(b).map(P).join("$"):[u,x.ruleSourceName,x.namespace,x.groupName,x.ruleName,x.ruleHash].map(String).map(b).map(P).join("$")}function D(x){let C=0;if(x.length===0)return C;for(let O=0;O<x.length;O++){const R=x.charCodeAt(O);C=(C<<5)-C+R,C=C&C}return C}function E(x){if((0,i.i7)(x))return D(JSON.stringify([x.record,x.expr,T(x.labels)])).toString();if((0,i.$y)(x))return D(JSON.stringify([x.alert,x.expr,T(x.annotations),T(x.labels)])).toString();if((0,i.lT)(x))return x.grafana_alert.uid;throw new Error("only recording and alerting ruler rules can be hashed")}function S(x){if((0,i.KB)(x))return D(JSON.stringify([x.type,x.query,T(x.labels)])).toString();if((0,i.Z8)(x))return D(JSON.stringify([x.type,x.query,T(x.annotations),T(x.labels)])).toString();throw new Error("only recording and alerting rules can be hashed")}function T(x){return JSON.stringify(Object.entries(x||{}).sort((C,O)=>C[0].localeCompare(O[0])))}function M(x){return(0,i.A4)(x)?r.hY:x.ruleSourceName}function A(x){const{pathname:C=""}=o.Ny.getLocation(),{id:O}=x;return O?(0,n.nth)(C.split("/"),-2):void 0}},23662:(Q,I,e)=>{"use strict";e.d(I,{$7:()=>p,$y:()=>b,A4:()=>v,HH:()=>c,KB:()=>u,Mj:()=>S,Om:()=>K,RI:()=>y,TU:()=>R,Tm:()=>x,Wy:()=>N,X4:()=>D,XI:()=>C,YN:()=>B,Z8:()=>h,dS:()=>L,f6:()=>T,i7:()=>g,jg:()=>U,lT:()=>P,nf:()=>E,qz:()=>w,uo:()=>M});var n=e(2543),a=e.n(n),o=e(43585),r=e(32264),i=e(94822),f=e(28475),d=e(55740),l=e(57220),m=e(75214),s=e(25968);function h(V){return typeof V=="object"&&V.type===i.JS.Alerting}function u(V){return typeof V=="object"&&V.type===i.JS.Recording}function b(V){return typeof V=="object"&&"alert"in V}function g(V){return typeof V=="object"&&"record"in V}function P(V){return typeof V=="object"&&"grafana_alert"in V}function c(V){return V&&P(V)&&!!V.grafana_alert.is_paused}function y(V){return JSON.stringify(V.labels)}function p(V){return V.error&&V.error?.message?.includes(d.UU)}function v(V){return"uid"in V}function D(V){return"rulerRuleHash"in V}function E(V){return Object.values(i.JS).includes(V)}function S(V){return"ruleHash"in V}function T(V){switch(V){case"ok":return f.Jc.Ok;case"nodata":return f.Jc.NoData;case"error":case"err":return f.Jc.Error;case"unknown":return f.Jc.Unknown;default:return}}function M(V){const _=V.labels[m.lL];if(!_)return;const H=_.match(/^plugin\/(?<pluginId>.+)$/);if(!H?.groups)return;const G=H.groups.pluginId;if(A(G))return{pluginId:G}}function A(V){return!!r.$.apps[V]}function x(V){return!!M(V)}function C(V){return V===i.cF.Inactive?"Normal":(0,n.capitalize)(V)}const O=V=>V.reduce((_,{dataSourceName:H,name:G,groups:j})=>(j.forEach(({name:Y,rules:oe})=>{oe.forEach(se=>{h(se)&&_.push({dataSourceName:H,namespaceName:G,groupName:Y,rule:se})})}),_),[]),R=V=>h(V.promRule)?V.promRule:null,L=V=>V.reduce((_,{rulesSource:H,name:G,groups:j})=>(j.forEach(({name:Y,rules:oe})=>{oe.forEach(se=>{se.promRule&&h(se.promRule)&&_.push({dataSourceName:(0,l.EV)(H),namespaceName:G,groupName:Y,...se})})}),_),[]);function N(V){let _;return Object.values(o.O).includes(V)?_=V:_=(0,i.lh)(V),F[_]}const F={[i.cF.Inactive]:"good",[i.cF.Firing]:"bad",[i.cF.Pending]:"warning",[i.Gi.Alerting]:"bad",[i.Gi.Error]:"bad",[i.Gi.NoData]:"info",[i.Gi.Normal]:"good",[i.Gi.Pending]:"warning",[o.O.NoData]:"info",[o.O.Paused]:"warning",[o.O.Alerting]:"bad",[o.O.OK]:"good",[o.O.Unknown]:"info"};function K(V){return V?.alerts?V.alerts.reduce((_,H)=>{const G=(0,i.lh)(H.state)!==i.Gi.Normal;if(H.activeAt&&G){const j=new Date(H.activeAt);if(_===null||_.getTime()>j.getTime())return j}return _},null):null}function B(V){return Array.isArray(V.source_tenants)}function w(V){return P(V)?V.grafana_alert.title:b(V)?V.alert:g(V)?V.record:""}const U=(V,_)=>{const H={alertName:"",forDuration:"0s",evaluationsToFire:0};return P(V)?{alertName:V.grafana_alert.title,forDuration:V.for,evaluationsToFire:W(V.for,_)}:b(V)?{alertName:V.alert,forDuration:V.for??"0s",evaluationsToFire:W(V.for??"0s",_)}:H},W=(V,_)=>{const H=(0,s.P8)(_),G=(0,s.P8)(V);return G===0&&H!==0?1:H===0||G/H<1?0:Math.ceil(G/H)+1}},25968:(Q,I,e)=>{"use strict";e.d(I,{M9:()=>m,P1:()=>a,P8:()=>h,TN:()=>i,an:()=>s,mo:()=>u,sc:()=>r,yl:()=>b});var n=e(41068);function a(g){const P=g.match(/(\d+)(\w+)/);if(P)return[Number(P[1]),P[2]];throw new Error(`Invalid interval description: ${g}`)}function o(g){const{sec:P,count:c}=describeInterval(g);return P*c}const r=Object.entries(n.y).map(([g,P])=>({label:g[0].toUpperCase()+g.slice(1),value:P}));function i(g){try{return m(g),!0}catch{return!1}}const f={ms:1,s:1e3,m:60*1e3,h:60*60*1e3,d:24*60*60*1e3,w:7*24*60*60*1e3,y:365*24*60*60*1e3},d=new RegExp(/^(?:(?<value>\d+)(?<type>ms|s|m|h|d|w|y))|0$/),l=new Error(`Must be of format "(number)(unit)", for example "1m", or just "0". Available units: ${Object.values(n.y).join(", ")}`);function m(g){let P=g,c=[];function y(v){const D=d.exec(v),E=D?.groups?.value&&D?.groups?.type;if(!D||!E)throw l;D&&D.groups?.value&&D.groups?.type&&(P=P.replace(D[0],""),c.push([Number(D.groups.value),D.groups.type])),P&&y(P)}if(y(g),!c.length)throw l;return c.reduce((v,[D,E])=>{const S=D*f[E];return v+S},0)}function s(g){const P=Math.floor(g/1e3),c=Math.floor(P/60),y=Math.floor(c/60),p=Math.floor(y/24),v=Math.floor(p/7),D=Math.floor(p/365);return g===0?"0s":[[D,"y"],[v%52,"w"],[p%365-7*(v%52),"d"],[y%24,"h"],[c%60,"m"],[P%60,"s"],[g%1e3,"ms"]].filter(([S])=>S>0).map(([S,T])=>S+T).join("")}const h=g=>{try{return m(g)}catch{return 0}},u=g=>g.includes("0001-01-01T00");function b(g){return g%(1e3*60*60)===0?g/(1e3*60*60)+"h":g%(1e3*60)===0?g/(1e3*60)+"m":g%1e3===0?g/1e3+"s":g.toFixed()+"ms"}},3704:(Q,I,e)=>{"use strict";e.d(I,{c:()=>a,z:()=>o});var n=e(32264);function a(r,i){const d=new URLSearchParams(i).toString();return`${n.$.appSubUrl}${r}${d?`?${d}`:""}`}function o(r,i){const d=new URLSearchParams(i).toString();try{return`${new URL(n.$.appSubUrl+r,n.$.appUrl).href}${d?`?${d}`:""}`}catch{return a(r,i)}}},10154:(Q,I,e)=>{"use strict";e.d(I,{Xm:()=>r,rJ:()=>o,vJ:()=>a,vy:()=>i});var n=e(17172);function a(f){return(0,n.AI)().post("/api/annotations",f)}function o(f){return(0,n.AI)().put(`/api/annotations/${f.id}`,f)}function r(f){return(0,n.AI)().delete(`/api/annotations/${f.id}`)}async function i(){return(await(0,n.AI)().get("/api/annotations/tags")).result.tags.map(({tag:d,count:l})=>({term:d,count:l}))}},82241:(Q,I,e)=>{"use strict";e.d(I,{A:()=>S});var n=e(96540),a=e(75505),o=e(39070),r=e(76287),i=e(13544),f=e(68402),d=e(62930),l=e(55852),m=e(42418),s=e(14792),h=e(74856),u=e(34214),b=e(27302),g=e(42493),P=e(28240),c=e(8790),y=e(83195),p=e(56034),v=e(14578),D=e(21594);class E extends n.PureComponent{constructor(M){super(M),this.updateFields=()=>{const A=this.props.response?.panelData,x=A?.series?.[0]??A?.annotations?.[0];if(x&&x.fields){const C=x.fields.map(O=>{const R=(0,P.Ct)(O,x);let L="";for(let N=0;N<x.length;N++){if(N>0&&(L+=", "),N>2){L+="...";break}L+=O.values[N]}return L.length>50&&(L=L.substring(0,50)+"..."),{label:`${R} (${O.type})`,value:R,description:L}});this.setState({fieldNames:C})}},this.onFieldSourceChange=(A,x)=>{const C=this.props.mappings||{},O=C[A]||{};this.props.change({...C,[A]:{...O,source:x.value||c.V.Field}})},this.onFieldNameChange=(A,x)=>{const C=this.props.mappings||{};if(!x){const R={...this.props.mappings};delete R[A],this.props.change(R);return}const O=C[A]||{};this.props.change({...C,[A]:{...O,value:x.value,source:c.V.Field}})},this.state={fieldNames:[]}}componentDidMount(){this.updateFields()}componentDidUpdate(M){M.response!==this.props.response&&this.updateFields()}renderRow(M,A,x){const{fieldNames:C}=this.state;let O=[...C];const R=A.value;let L=C.find(F=>R===F.value);R&&!L&&O.push({label:R,value:R});let N=x?x[M.key]:"";if(N&&M.key.startsWith("time")){const F=(0,y.j_)("dateTimeAsIso");N=(0,y.cN)(F(N))}return N==null&&(N=""),n.createElement("tr",{key:M.key},n.createElement("td",null,M.label||M.key," ",M.help&&n.createElement(p.m,{content:M.help},n.createElement(v.I,{name:"info-circle"}))),n.createElement("td",null,n.createElement(D.l6,{value:L,options:O,placeholder:M.placeholder||M.key,onChange:F=>{this.onFieldNameChange(M.key,F)},noOptionsMessage:"Unknown field names",allowCustomValue:!0,isClearable:!0})),n.createElement("td",null,`${N}`))}render(){const M=this.props.response?.events?.[0],A=this.props.mappings||{};return n.createElement("table",{className:"filter-table"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"Annotation"),n.createElement("th",null,"From"),n.createElement("th",null,"First Value"))),n.createElement("tbody",null,g.kj.map(x=>this.renderRow(x,A[x.key]||{},M))))}}class S extends n.PureComponent{constructor(){super(...arguments),this.state={},this.onRunQuery=async()=>{const{datasource:M,annotation:A}=this.props;if((0,g.E7)(M))return;const x=(0,s.UA)().getCurrent();if(!x)return;this.setState({running:!0});const C=await(0,a.s)((0,b.b)({range:(0,h.jG)().timeRange(),panel:new u.a({}),dashboard:x},M,A));this.setState({running:!1,response:C})},this.onQueryChange=M=>{this.props.onChange({...this.props.annotation,target:M})},this.onMappingChange=M=>{this.props.onChange({...this.props.annotation,mappings:M})},this.onAnnotationChange=M=>{this.props.onChange(M)}}componentDidMount(){this.verifyDataSource()}componentDidUpdate(M){this.props.annotation!==M.annotation&&!(0,g.E7)(this.props.datasource)&&this.verifyDataSource()}verifyDataSource(){const{datasource:M,annotation:A}=this.props,C={...g.CU,...M.annotations}.prepareAnnotation(A);C!==A?this.props.onChange(C):this.onRunQuery()}getStatusSeverity(M){const{events:A,panelData:x}=M;return x?.errors||x?.error?"error":A?.length?"success":"warning"}renderStatusText(M,A){const{events:x,panelData:C}=M;if(A||M?.panelData?.state===o.Gu.Loading||!M)return n.createElement("p",null,"loading...");if(C?.errors)return n.createElement(n.Fragment,null,C.errors.map((R,L)=>n.createElement("p",{key:L},R.message)));if(C?.error)return n.createElement("p",null,C.error.message??"There was an error fetching data");if(!x?.length)return n.createElement("p",null,"No events found");const O=C?.series?.[0]??C?.annotations?.[0];return n.createElement("p",null,x.length," events (from ",O?.fields.length," fields)")}renderStatus(){const{response:M,running:A}=this.state;return M?n.createElement(n.Fragment,null,n.createElement(f.$,{v:2}),n.createElement("div",null,A?n.createElement(d.y,null):n.createElement(l.$n,{"data-testid":i.Tp.components.Annotations.editor.testButton,variant:"secondary",size:"xs",onClick:this.onRunQuery},"Test annotation query")),n.createElement(f.$,{v:2,layout:"block"}),n.createElement(m.F,{"data-testid":i.Tp.components.Annotations.editor.resultContainer,severity:this.getStatusSeverity(M),title:"Query result"},this.renderStatusText(M,A))):null}render(){const{datasource:M,annotation:A,datasourceInstanceSettings:x}=this.props,{response:C}=this.state;let O=M.annotations?.QueryEditor||M.components?.QueryEditor;if(!O)return n.createElement("div",null,"Annotations are not supported. This datasource needs to export a QueryEditor");const R={...M.annotations?.getDefaultQuery?.(),...A.target??{refId:"Anno"}};return n.createElement(n.Fragment,null,n.createElement(r.p,{instanceSettings:x},n.createElement(O,{key:M?.name,query:R,datasource:M,onChange:this.onQueryChange,onRunQuery:this.onRunQuery,data:C?.panelData,range:(0,h.jG)().timeRange(),annotation:A,onAnnotationChange:this.onAnnotationChange})),(0,g.JX)(M)&&n.createElement(n.Fragment,null,this.renderStatus(),n.createElement(E,{response:C,mappings:A.mappings,change:this.onMappingChange})))}}},27302:(Q,I,e)=>{"use strict";e.d(I,{b:()=>s});var n=e(62467),a=e(69862),o=e(81160),r=e(65879),i=e(41987),f=e(39374),d=e(42493);let l=100;function m(){return"AQ"+l++}function s(h,u,b){const g={...d.CU,...u.annotations},P={...g.getDefaultQuery?.(),...b},c=g.prepareAnnotation(P);if(!c)return(0,n.of)({});const y=g.prepareQuery(c);if(!y)return(0,n.of)({});const p=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,v=r.calculateInterval(h.range,p,u.interval),D={__interval:{text:v.interval,value:v.interval},__interval_ms:{text:v.intervalMs.toString(),value:v.intervalMs},__annotation:{text:c.name,value:c}},E={startTime:Date.now(),requestId:m(),range:h.range,maxDataPoints:p,scopedVars:D,...v,app:i.Jk.Dashboard,timezone:h.dashboard.timezone,targets:[{...y,refId:"Anno"}]};return(0,f.BN)(u,E).pipe((0,a.Z)(S=>{const T=S?.series.length?S.series:S.annotations;return T?.length?g.processEvents(c,T).pipe((0,o.T)(M=>({panelData:S,events:M}))):(0,n.of)({panelData:S,events:[]})}))}},42493:(Q,I,e)=>{"use strict";e.d(I,{CU:()=>h,E7:()=>v,JX:()=>p,kj:()=>b});var n=e(2543),a=e.n(n),o=e(62467),r=e(69862),i=e(81160),f=e(57934),d=e(11261),l=e(28240),m=e(8790),s=e(2913);const h={prepareAnnotation:D=>{if((0,n.isString)(D?.query)){const{query:E,...S}=D;return{...S,target:{refId:"annotation_query",query:E},mappings:{}}}return D},prepareQuery:D=>D.target,processEvents:(D,E)=>c(E,D.mappings)};function u(){return D=>D.pipe((0,r.Z)(E=>{if(!E?.length)return(0,o.of)(void 0);if(E.length===1)return(0,o.of)(E[0]);const S={interpolate:T=>T};return(0,o.of)(E).pipe(f.c.mergeTransformer.operator({},S),(0,i.T)(T=>T[0]))}))}const b=[{key:"time",field:D=>D.fields.find(E=>E.type===d.PU.time),placeholder:"time, or the first time field"},{key:"timeEnd",label:"end time",help:"When this field is defined, the annotation will be treated as a range"},{key:"title"},{key:"text",field:D=>D.fields.find(E=>E.type===d.PU.string),placeholder:"text, or the first text field"},{key:"tags",split:",",help:"The results will be split on comma (,)"},{key:"id"}],g=[{key:"color"},{key:"isRegion"},{key:"source"}],P=[...s.config.publicDashboardAccessToken?g:[],...b,{key:"userId"},{key:"login"},{key:"email"},{key:"prevState"},{key:"newState"},{key:"data"},{key:"panelId"},{key:"alertId"},{key:"dashboardId"},{key:"dashboardUID"}];function c(D,E){return(0,o.of)(D).pipe(u(),(0,i.T)(S=>{if(!S?.length)return[];let T=!1,M=!1;const A={};for(const O of S.fields){const R=(0,l.Ct)(O,S);A[R.toLowerCase()]=O}E||(E={});const x=[];for(const O of P){const R=E[O.key]||{};if(R.source===m.V.Skip)continue;const L={key:O.key,split:O.split};if(R.source===m.V.Text)L.text=R.value;else{const N=(R.value||O.key).toLowerCase();L.field=A[N],!L.field&&O.field&&(L.field=O.field(S))}(L.field||L.text)&&(x.push(L),L.key==="time"?T=!0:L.key==="text"&&(M=!0))}if(!T||!M)return console.error("Cannot process annotation fields. No time or text present."),[];const C=[];for(let O=0;O<S.length;O++){const R={type:"default",color:"red"};for(const L of x){let N;if(L.text)N=L.text;else if(L.field&&(N=L.field.values[O],N!==void 0&&L.regex)){const F=L.regex.exec(N);F&&(N=F[1]?F[1]:F[0])}N!=null&&(L.split&&typeof N=="string"&&(N=N.split(",")),R[L.key]=N)}C.push(R)}return C}))}const y=["prometheus","loki","elasticsearch","grafana-opensearch-datasource"];function p(D){const{type:E}=D;return!(E==="datasource"||y.includes(E))}function v(D){const{type:E}=D;return y.includes(E)}},93584:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>s,QB:()=>l,Ri:()=>d,Sf:()=>r,cV:()=>i,h8:()=>f});var n=e(65307);const a={hasFetched:!1,includeExpired:!1,keys:[],keysIncludingExpired:[],searchQuery:"",migrationResult:{total:0,migrated:0,failed:0,failedApikeyIDs:[0],failedDetails:[]}},o=(0,n.Z0)({name:"apiKeys",initialState:a,reducers:{apiKeysLoaded:(h,u)=>{const{keys:b,keysIncludingExpired:g}=u.payload,P=u.payload.keys.length===0&&u.payload.keysIncludingExpired.length>0?!0:h.includeExpired;return{...h,hasFetched:!0,keys:b,keysIncludingExpired:g,includeExpired:P}},setSearchQuery:(h,u)=>({...h,searchQuery:u.payload}),includeExpiredToggled:h=>({...h,includeExpired:!h.includeExpired}),isFetching:h=>({...h,hasFetched:!1}),setMigrationResult:(h,u)=>({...h,migrationResult:u.payload})}}),{apiKeysLoaded:r,includeExpiredToggled:i,isFetching:f,setSearchQuery:d,setMigrationResult:l}=o.actions,s={apiKeys:o.reducer}},2468:(Q,I,e)=>{"use strict";e.d(I,{w:()=>o});var n=e(32264),a=e(17172);class o{constructor(i,f=!0){const d=f?`namespaces/${n.$.namespace}/`:"";this.url=`/apis/${i.group}/${i.version}/${d}${i.resource}`}async create(i){return!i.metadata.name&&!i.metadata.generateName&&(i.metadata.generateName="g"),(0,a.AI)().post(this.url,i)}async get(i){return(0,a.AI)().get(`${this.url}/${i}`)}async subresource(i,f){return(0,a.AI)().get(`${this.url}/${i}/${f}`)}async list(i){const f=i||{};return f.labelSelector=this.parseListOptionsSelector(f?.labelSelector),f.fieldSelector=this.parseListOptionsSelector(f?.fieldSelector),(0,a.AI)().get(this.url,i)}async update(i){return(0,a.AI)().put(`${this.url}/${i.metadata.name}`,i)}async delete(i){return(0,a.AI)().delete(`${this.url}/${i}`)}parseListOptionsSelector(i){return Array.isArray(i)?i.map(f=>{const d=String(f.key),l=f.operator;switch(l){case"=":case"!=":return`${d}${l}${f.value}`;case"in":case"notin":return`${d} ${l} (${f.value.join(",")})`;case"":case"!":return`${l}${d}`;default:return null}}).filter(Boolean).join(","):i}}},73399:(Q,I,e)=>{"use strict";e.d(I,{getAuthProviderStatus:()=>s,getRegisteredAuthProviders:()=>d,initAuthConfig:()=>h,registerAuthProvider:()=>f});var n=e(10096),a=e(27677),o=e(31678);const r=[],i={};function f(b,g){r.find(P=>P.id===b.id)||(r.push(b),g&&(i[b.id]=g))}function d(){return r}function l(b){return r.find(g=>g.id===b)}function m(b){const g=[];for(const[P,c]of Object.entries(b)){const y=r.find(p=>`auth.${p.id}`===P);if(y){const p={...c,providerId:y.id,displayName:c.name||y.displayName};g.push(p)}}return g}async function s(b){if(i[b]){const g=i[b];return g()}return{configured:!1,enabled:!1}}function h(){f({id:"ldap",type:"LDAP",protocol:"LDAP",displayName:"LDAP",configPath:"ldap"},u)}async function u(){if(n.contextSrv.hasPermission(o.AccessControlAction.SettingsRead)){const g=(await(0,a.AI)().get("/api/admin/settings"))["auth.ldap"]||{};return{configured:g.enabled==="true",enabled:g.enabled==="true",hide:g.enabled!=="true"}}return{configured:!1,enabled:!1}}},60610:(Q,I,e)=>{"use strict";e.d(I,{DZ:()=>h,M5:()=>l,TD:()=>m});var n=e(75505),a=e(17172),o=e(32264),r=e(10096),i=e(31678),f=e(73399),d=e(20604);function l(u=!0){return async b=>{if(r.contextSrv.hasPermission(i.AccessControlAction.SettingsRead)){u&&b((0,d.sr)()),b(m());const g=await(0,a.AI)().get("/api/admin/settings");return b((0,d.jA)(g)),await b(s()),u&&b((0,d.MH)()),g}}}function m(u=""){return async b=>{if(!o.$.featureToggles.ssoSettingsApi)return[];const g=await(0,a.AI)().get(`/api/v1/sso-settings${u?`/${u}`:""}`);return b((0,d.Oy)(u?[g]:g)),g}}function s(){return async u=>{const b=(0,f.getRegisteredAuthProviders)(),g={},P=[];for(const y of b)P.push((0,f.getAuthProviderStatus)(y.id));const c=await Promise.all(P);for(let y=0;y<b.length;y++){const p=b[y];g[p.id]=c[y]}u((0,d.TO)(g))}}function h(u){return async b=>{if(r.contextSrv.hasPermission(i.AccessControlAction.SettingsWrite))try{return await(0,n.s)((0,a.AI)().fetch({url:"/api/admin/settings",method:"PUT",data:u,showSuccessAlert:!1,showErrorAlert:!1})),b((0,d.SH)()),!0}catch(g){if(console.log(g),(0,a.NF)(g)){g.isHandled=!0;const P={message:g.data?.message,errors:g.data?.errors};return b((0,d.Nh)(P)),!1}}return!1}}},20604:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>g,MH:()=>d,Nh:()=>l,Oy:()=>u,SH:()=>m,TO:()=>i,jA:()=>r,sr:()=>f,yk:()=>h});var n=e(65307);const a={settings:{},providerStatuses:{},isLoading:!1,providers:[]},o=(0,n.Z0)({name:"authConfig",initialState:a,reducers:{settingsUpdated:(P,c)=>({...P,settings:c.payload}),providerStatusesLoaded:(P,c)=>({...P,providerStatuses:c.payload}),loadingBegin:P=>({...P,isLoading:!0}),loadingEnd:P=>({...P,isLoading:!1}),setError:(P,c)=>({...P,updateError:c.payload}),resetError:P=>({...P,updateError:void 0}),setWarning:(P,c)=>({...P,warning:c.payload}),resetWarning:P=>({...P,warning:void 0}),providersLoaded:(P,c)=>({...P,providers:c.payload})}}),{settingsUpdated:r,providerStatusesLoaded:i,loadingBegin:f,loadingEnd:d,setError:l,resetError:m,setWarning:s,resetWarning:h,providersLoaded:u}=o.actions,g={authConfig:o.reducer}},55314:(Q,I,e)=>{"use strict";e.d(I,{G2:()=>D,Ko:()=>p,Vc:()=>M,aF:()=>S,cU:()=>c,e8:()=>A,hT:()=>g.hT,iB:()=>x,kH:()=>E,uz:()=>v,vZ:()=>y,wt:()=>T});var n=e(75816),a=e(75505),o=e(71733),r=e(39070),i=e(17172),f=e(12131),d=e(82467),l=e(3169),m=e(10096),s=e(28676),h=e(6473),u=e(37690),b=e(92955),g=e(10378);function P({baseURL:C}){async function O(R){try{const{data:L,...N}=await(0,a.s)((0,i.AI)().fetch({...R,url:C+R.url,showErrorAlert:R.showErrorAlert}));return{data:L,meta:N}}catch(L){return R.manageError?R.manageError(L):{error:L}}}return O}const c=(0,n.xP)({tagTypes:["getFolder"],reducerPath:"browseDashboardsAPI",baseQuery:P({baseURL:"/api"}),endpoints:C=>({listFolders:C.query({providesTags:O=>O?.map(R=>({type:"getFolder",id:R.uid}))??[],query:({parentUid:O,limit:R,page:L,permission:N})=>({url:"/folders",params:{parentUid:O,limit:R,page:L,permission:N}})}),getFolder:C.query({providesTags:(O,R,L)=>[{type:"getFolder",id:L}],query:O=>({url:`/folders/${O}`,params:{accesscontrol:!0}})}),newFolder:C.mutation({query:({title:O,parentUid:R})=>({method:"POST",url:"/folders",data:{title:O,parentUid:R}}),onQueryStarted:({parentUid:O},{queryFulfilled:R,dispatch:L})=>{R.then(async({data:N})=>{await m.contextSrv.fetchUserPermissions(),L((0,d.dx)((0,l.tZ)("Folder created"))),L((0,u.bw)({parentUID:O,pageSize:b.md})),f.Ny.push(o.I.stripBaseFromUrl(N.url))})}}),saveFolder:C.mutation({invalidatesTags:["getFolder"],query:({uid:O,title:R,version:L})=>({method:"PUT",url:`/folders/${O}`,data:{title:R,version:L}}),onQueryStarted:({parentUid:O},{queryFulfilled:R,dispatch:L})=>{R.then(()=>{L((0,u.bw)({parentUID:O,pageSize:b.md}))})}}),moveFolder:C.mutation({invalidatesTags:["getFolder"],query:({folder:O,destinationUID:R})=>({url:`/folders/${O.uid}/move`,method:"POST",data:{parentUID:R}}),onQueryStarted:({folder:O,destinationUID:R},{queryFulfilled:L,dispatch:N})=>{const{parentUid:F}=O;L.then(()=>{N((0,u.bw)({parentUID:F,pageSize:b.md})),N((0,u.bw)({parentUID:R,pageSize:b.md}))})}}),deleteFolder:C.mutation({query:({uid:O})=>({url:`/folders/${O}`,method:"DELETE",params:{forceDeleteRules:!1}}),onQueryStarted:({parentUid:O},{queryFulfilled:R,dispatch:L})=>{R.then(()=>{L((0,u.bw)({parentUID:O,pageSize:b.md}))})}}),getAffectedItems:C.query({queryFn:async O=>{const L=Object.keys(O.folder).filter(K=>O.folder[K]).map(K=>(0,i.AI)().get(`/api/folders/${K}/counts`)),N=await Promise.all(L),F={folder:Object.values(O.folder).filter(r.zz).length,dashboard:Object.values(O.dashboard).filter(r.zz).length,libraryPanel:0,alertRule:0};for(const K of N)F.folder+=K.folder??0,F.dashboard+=K.dashboard,F.alertRule+=K.alertrule,F.libraryPanel+=K.librarypanel;return{data:F}}}),moveItems:C.mutation({invalidatesTags:["getFolder"],queryFn:async({selectedItems:O,destinationUID:R},L,N,F)=>{const K=Object.keys(O.dashboard).filter(w=>O.dashboard[w]),B=Object.keys(O.folder).filter(w=>O.folder[w]);for(const w of B)await F({url:`/folders/${w}/move`,method:"POST",data:{parentUID:R}});for(const w of K){const W={dashboard:(await(0,s.n)().getDashboardDTO(w)).dashboard,folderUid:R,overwrite:!1,message:""};await F({url:"/dashboards/db",method:"POST",data:W})}return{data:void 0}},onQueryStarted:({destinationUID:O,selectedItems:R},{queryFulfilled:L,dispatch:N})=>{const F=Object.keys(R.dashboard).filter(B=>R.dashboard[B]),K=Object.keys(R.folder).filter(B=>R.folder[B]);L.then(()=>{N((0,u.bw)({parentUID:O,pageSize:b.md})),N((0,u.Zw)([...K,...F]))})}}),deleteItems:C.mutation({queryFn:async({selectedItems:O},R,L,N)=>{const F=Object.keys(O.dashboard).filter(B=>O.dashboard[B]),K=Object.keys(O.folder).filter(B=>O.folder[B]);for(const B of K)await N({url:`/folders/${B}`,method:"DELETE",params:{forceDeleteRules:!1}});for(const B of F)await N({url:`/dashboards/uid/${B}`,method:"DELETE"});return{data:void 0}},onQueryStarted:({selectedItems:O},{queryFulfilled:R,dispatch:L})=>{const N=Object.keys(O.dashboard).filter(K=>O.dashboard[K]),F=Object.keys(O.folder).filter(K=>O.folder[K]);R.then(()=>{L((0,u.Zw)([...F,...N]))})}}),saveDashboard:C.mutation({query:({dashboard:O,folderUid:R,message:L,overwrite:N,showErrorAlert:F})=>({url:"/dashboards/db",method:"POST",showErrorAlert:F,data:{dashboard:O,folderUid:R,message:L??"",overwrite:!!N}}),onQueryStarted:({folderUid:O},{queryFulfilled:R,dispatch:L})=>{h.t.ignoreNextSave(),R.then(async()=>{await m.contextSrv.fetchUserPermissions(),L((0,u.bw)({parentUID:O,pageSize:b.md}))})}}),importDashboard:C.mutation({query:({dashboard:O,overwrite:R,inputs:L,folderUid:N})=>({method:"POST",url:"/dashboards/import",data:{dashboard:O,overwrite:R,inputs:L,folderUid:N}}),onQueryStarted:({folderUid:O},{queryFulfilled:R,dispatch:L})=>{R.then(async N=>{L((0,u.bw)({parentUID:O,pageSize:b.md}));const F=o.I.stripBaseFromUrl(N.data.importedUrl);f.Ny.push(F)})}})})}),{endpoints:y,useDeleteFolderMutation:p,useDeleteItemsMutation:v,useGetAffectedItemsQuery:D,useGetFolderQuery:E,useMoveFolderMutation:S,useMoveItemsMutation:T,useNewFolderMutation:M,useSaveDashboardMutation:A,useSaveFolderMutation:x}=c},92955:(Q,I,e)=>{"use strict";e.d(I,{aw:()=>h,md:()=>m,uT:()=>s});var n=e(32264),a=e(17172),o=e(53477),r=e(24439),i=e(40957),f=e(10096),d=e(31678),l=e(49952);const m=50;async function s(u,b,g=1,P=m){if(u&&!n.$.featureToggles.nestedFolders)return[];const c=(0,a.AI)();let y=[];f.contextSrv.hasPermission(d.AccessControlAction.FoldersRead)&&(y=await c.get("/api/folders",{parentUid:u,page:g,limit:P}));const p=n.$.appSubUrl??"";return y.map(v=>({kind:"folder",uid:v.uid,title:v.title,parentTitle:b,parentUID:u,url:(0,l.I)(v.uid)?void 0:`${p}/dashboards/f/${v.uid}/`}))}async function h(u,b=1,g=m){const c=await(0,r.getGrafanaSearcher)().search({kind:["dashboard"],query:"*",location:u||"general",from:(b-1)*g,limit:g});return c.view.map(y=>{const p=(0,i.hI)(y,c.view);return p.parentUID===o.TF&&(p.parentUID=void 0),p})}},43907:(Q,I,e)=>{"use strict";e.d(I,{x:()=>l});var n=e(96540),a=e(70255),o=e(94753),r=e(42418),i=e(55314),f=e(8484);function d(m,s,h,u){const b=m+s+h+u,g=[];m&&g.push((0,f.t)("browse-dashboards.counts.folder","{{count}} folder",{count:m})),s&&g.push((0,f.t)("browse-dashboards.counts.dashboard","{{count}} dashboard",{count:s})),h&&g.push((0,f.t)("browse-dashboards.counts.libraryPanel","{{count}} library panel",{count:h})),u&&g.push((0,f.t)("browse-dashboards.counts.alertRule","{{count}} alert rule",{count:u}));let P=(0,f.t)("browse-dashboards.counts.total","{{count}} item",{count:b});return g.length>0&&(P+=`: ${g.join(", ")}`),P}const l=({selectedItems:m})=>{const{data:s,isFetching:h,isLoading:u,error:b}=(0,i.G2)(m);return n.createElement(n.Fragment,null,n.createElement(o.E,{element:"p",color:"secondary"},s&&d(s.folder,s.dashboard,s.libraryPanel,s.alertRule),(h||u)&&n.createElement(a.A,{width:200})),b&&n.createElement(r.F,{severity:"error",title:"Unable to retrieve descendant information"}))}},49952:(Q,I,e)=>{"use strict";e.d(I,{I:()=>o,e:()=>a});var n=e(32264);function a(r,i){return r+i.uid}function o(r){return r===n.$.sharedWithMeFolderUID}},36141:(Q,I,e)=>{"use strict";e.d(I,{Ii:()=>d,Zw:()=>i,bw:()=>f});var n=e(53477),a=e(31678),o=e(92955),r=e(93519);const i=(0,a.createAsyncThunk)("browseDashboards/refreshParents",async(l,{getState:m,dispatch:s})=>{const{browseDashboards:h}=m(),{rootItems:u,childrenByParentUID:b}=h,g=new Set;for(const P of l){const c=(0,r.R)(u?.items??[],b,P);g.add(c?.parentUID)}for(const P of g)s(f({parentUID:P,pageSize:o.md}))}),f=(0,a.createAsyncThunk)("browseDashboards/refetchChildren",async({parentUID:l,pageSize:m})=>{const s=l===n.TF?void 0:l;let h=1,u="folder",b=await(0,o.uT)(s,void 0,h,m),g=b.length<m;if(u==="folder"&&g){u="dashboard",h=1;const P=await(0,o.aw)(s,h,m);g=P.length<m,b=b.concat(P)}return{children:b,lastPageOfKind:g,page:h,kind:u}}),d=(0,a.createAsyncThunk)("browseDashboards/fetchNextChildrenPage",async({parentUID:l,excludeKinds:m=[],pageSize:s},h)=>{const u=!m.includes("dashboard"),b=l===n.TF?void 0:l,g=h.getState().browseDashboards,P=b?g.childrenByParentUID[b]:g.rootItems;let c=1,y;if(P?P.lastFetchedKind==="dashboard"&&!P.lastKindHasMoreItems?console.warn(`fetchNextChildrenPage called for ${b} but that collection is fully loaded`):P.lastFetchedKind==="folder"&&P.lastKindHasMoreItems?(c=P.lastFetchedPage+1,y="folder"):u&&(c=P.lastFetchedKind==="folder"?1:P.lastFetchedPage+1,y="dashboard"):(c=1,y="folder"),!y)return;let p=y==="folder"?await(0,o.uT)(b,void 0,c,s):await(0,o.aw)(b,c,s),v=p.length<s;if(y==="folder"&&v&&u){y="dashboard",c=1;const D=await(0,o.aw)(b,c,s);v=D.length<s,p=p.concat(D)}return{children:p,lastPageOfKind:v,page:c,kind:y}})},37690:(Q,I,e)=>{"use strict";e.d(I,{Am:()=>s,Ii:()=>a.Ii,bw:()=>a.bw,Zw:()=>a.Zw,ku:()=>m,cT:()=>n.cT,wn:()=>n.wn,t$:()=>n.t$,xK:()=>E,eC:()=>c,Ms:()=>v,V6:()=>D,q0:()=>y,QE:()=>p,Zg:()=>S});var n=e(79763),a=e(36141),o=e(96540),r=e(25508),i=e(31678),f=e(92955),d=e(49952),l=e(93519);const m=M=>M.browseDashboards.rootItems,s=M=>M.browseDashboards.childrenByParentUID,h=M=>M.browseDashboards.openFolders,u=M=>M.browseDashboards.selectedItems,b=(0,r.Mz)(m,s,h,(M,A)=>A,(M,A,x,C)=>T(C,M,A,x)),g=(0,r.Mz)(u,M=>Object.values(M).some(A=>Object.values(A).some(x=>x))),P=(0,r.Mz)(u,s,(M,A)=>{const x={dashboard:{...M.dashboard},folder:{...M.folder}};for(const C of Object.keys(M.folder))if(M.folder[C]){const R=A[C];if(R)for(const L of R.items)L.kind==="dashboard"&&(x.dashboard[L.uid]=!1),L.kind==="folder"&&(x.folder[L.uid]=!1)}return x});function c(M){return(0,i.useSelector)(A=>(M?A.browseDashboards.childrenByParentUID[M]:A.browseDashboards.rootItems)?"fulfilled":"pending")}function y(M){return(0,i.useSelector)(A=>b(A,M))}function p(){return(0,i.useSelector)(M=>g(M))}function v(){return(0,i.useSelector)(u)}function D(){return(0,i.useSelector)(M=>M.browseDashboards.childrenByParentUID)}function E(){return(0,i.useSelector)(M=>P(M))}function S(M=[]){const A=(0,i.useDispatch)(),x=(0,o.useRef)(!1);return(0,o.useCallback)(O=>{if(x.current)return Promise.resolve();x.current=!0;const R=A((0,a.Ii)({parentUID:O,excludeKinds:M,pageSize:f.md}));return R.finally(()=>x.current=!1),R},[A,M])}function T(M,A,x,C,O=0,R=[],L=[]){function N(V,_,H){if(R.includes(V.kind)||L.includes(V.uid))return[];const G=T(V.uid,A,x,C,H+1,R,L),j=!!C[V.uid],Y=x[V.uid]?.items.length===0;j&&Y&&!R.includes("empty-folder")&&G.push({isOpen:!1,level:H+1,item:{kind:"ui",uiKind:"empty-folder",uid:V.uid+"empty-folder"},parentUID:_});const oe={item:V,parentUID:_,level:H,isOpen:j},se=[oe,...G];return(0,d.I)(oe.item.uid)&&se.push({item:{kind:"ui",uiKind:"divider",uid:"shared-with-me-divider"},parentUID:_,level:H+1,isOpen:!1}),se}const F=M&&C[M]||O===0,K=M?x[M]:A;let w=((M?F&&K?.items:K?.items)||[]).flatMap(V=>N(V,M,O));const U=R.includes("dashboard")&&K?.lastFetchedKind==="dashboard";return(O===0&&!K||F&&K&&!(K.isFullyLoaded||U))&&(w=w.concat((0,l.T)(f.md,M,O))),w}},79763:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>D,cT:()=>v,wn:()=>y,t$:()=>p});var n={};e.r(n),e.d(n,{fetchNextChildrenPageFulfilled:()=>d,refetchChildrenFulfilled:()=>f,setAllSelection:()=>s,setFolderOpenState:()=>l,setItemSelectionState:()=>m});var a=e(65307),o=e(36141),r=e(49952),i=e(93519);function f(E,S){const{children:T,page:M,kind:A,lastPageOfKind:x}=S.payload,{parentUID:C}=S.meta.arg,O={items:T,lastFetchedKind:A,lastFetchedPage:M,lastKindHasMoreItems:!x,isFullyLoaded:A==="dashboard"&&x};C?E.childrenByParentUID[C]=O:E.rootItems=O}function d(E,S){const T=S.payload;if(!T)return;const{children:M,page:A,kind:x,lastPageOfKind:C}=T,{parentUID:O,excludeKinds:R=[]}=S.meta.arg,F={items:((O?E.childrenByParentUID[O]:E.rootItems)?.items??[]).concat(M),lastFetchedKind:x,lastFetchedPage:A,lastKindHasMoreItems:!C,isFullyLoaded:(R.includes("dashboard")||x==="dashboard")&&C};if(!O){E.rootItems=F;return}if(E.childrenByParentUID[O]=F,E.selectedItems.folder[O])for(const B of M)E.selectedItems[B.kind][B.uid]=!0}function l(E,S){const{folderUID:T,isOpen:M}=S.payload;E.openFolders[T]=M}function m(E,S){const{item:T,isSelected:M}=S.payload;if((0,r.I)(T.uid))return;function A(x,C){if(E.selectedItems[x][C]=M,x!=="folder")return;let O=E.childrenByParentUID[C];for(const R of O?.items??[])A(R.kind,R.uid)}if(A(T.kind,T.uid),!M){let x=T.parentUID;for(;x;){const C=(0,i.R)(E.rootItems?.items??[],E.childrenByParentUID,x);if(!C)break;E.selectedItems[C.kind][C.uid]=!1,x=C.parentUID}}E.selectedItems.$all=E.rootItems?.items?.every(x=>E.selectedItems[x.kind][x.uid])??!1}function s(E,S){const{isSelected:T,folderUID:M}=S.payload;if(!(M&&(0,r.I)(M)))if(E.selectedItems.$all=T,T){let x=function(C){if(C&&(0,r.I)(C))return;const O=C?E.childrenByParentUID[C]:E.rootItems;if(O)for(const R of O.items)(0,r.I)(R.uid)||(E.selectedItems[R.kind][R.uid]=T,R.kind==="folder"&&x(R.uid))};var A=x;x(M)}else for(const x in E.selectedItems){if(!(x==="dashboard"||x==="panel"||x==="folder"))continue;const C=E.selectedItems[x];for(const O in C)C[O]=T}}const{fetchNextChildrenPageFulfilled:h,refetchChildrenFulfilled:u,...b}=n,g={rootItems:void 0,childrenByParentUID:{},openFolders:{},selectedItems:{dashboard:{},folder:{},panel:{},$all:!1}},P=(0,a.Z0)({name:"browseDashboards",initialState:g,reducers:b,extraReducers:E=>{E.addCase(o.Ii.fulfilled,h),E.addCase(o.bw.fulfilled,u)}}),c=P.reducer,{setFolderOpenState:y,setItemSelectionState:p,setAllSelection:v}=P.actions,D={browseDashboards:c}},93519:(Q,I,e)=>{"use strict";e.d(I,{R:()=>n,T:()=>a});function n(o,r,i){for(const f of o)if(f.uid===i)return f;for(const f in r){const d=r[f];if(d){for(const l of d.items)if(l.uid===i)return l}}}function a(o,r,i){return new Array(o).fill(null).map((f,d)=>({parentUID:r,level:i,isOpen:!1,item:{kind:"ui",uiKind:"pagination-placeholder",uid:`${r}-pagination-${d}`}}))}},6320:(Q,I,e)=>{"use strict";e.d(I,{b:()=>a,q:()=>n});const n="connections",a={Base:`/${n}`,DataSources:`/${n}/datasources`,DataSourcesNew:`/${n}/datasources/new`,DataSourcesEdit:`/${n}/datasources/edit/:uid`,DataSourcesDashboards:`/${n}/datasources/edit/:uid/dashboards`,AddNewConnection:`/${n}/add-new-connection`,DataSourcesDetails:`/${n}/datasources/:id`,ConnectDataOutdated:`/${n}/connect-data`,YourConnectionsOutdated:`/${n}/your-connections`}},31152:(Q,I,e)=>{"use strict";e.d(I,{n:()=>l});var n=e(24180),a=e(19347),o=e(17422),r=e(11084),i=e(74984),f=e(83391),d=e(31678);function l(m){const{uid:s}=(0,n.g)(),h=(0,n.zy)(),u=(0,r.xw)(s),b=(0,r.S4)(u.type),g=(0,f.ob)(u.type),P=new URLSearchParams(h.search),c=m||P.get("page"),{plugin:y,loadError:p,loading:v}=(0,r._e)(),D=(0,a.l)()?.getInstanceSettings(s),E=!!(D?.meta?.alerting??!1),S=D?.type==="alertmanager",T=E||S,M=(0,d.useSelector)(O=>O.navIndex),A=c?`datasource-${c}-${s}`:`datasource-settings-${s}`;let x={node:{text:"Data Source Nav Node"},main:{text:"Data Source Nav Node"}};if(p){const O={text:p,subTitle:"Data Source Error",icon:"exclamation-triangle"};x={node:O,main:O}}return(v||!y)&&(x=(0,o.tc)(M,A,(0,i.$m)("settings"))),y&&(x=(0,o.tc)(M,A,(0,i.Vh)((0,i.R4)(u,y),c||"settings"))),{navId:"connections-datasources",pageNav:{...x.main,dataSourcePluginName:g?.name||y?.meta.name||"",active:!0,text:u.name,subTitle:`Type: ${b.name}`,children:(x.main.children||[]).map(O=>({...O,url:O.url?.replace("datasources/edit/","/connections/datasources/edit/")}))},dataSourceHeader:{alertingSupported:T}}}},67023:(Q,I,e)=>{"use strict";e.d(I,{k:()=>i});var n=e(60455),a=e.n(n),o=e(91890),r=e(87490);const i=(f,d,l)=>{let m={},s={};if(f.type===o.CC.Regex&&f.expression){const h=new RegExp(f.expression,"gi"),b=(typeof d=="string"?d:(0,r.MA)(d)).matchAll(h);for(const g of b)g.groups?s=g.groups:s[f.mapValue||l]=g[1]||g[0]}else f.type===o.CC.Logfmt&&(s=a().parse(d));return Object.keys(s).forEach(h=>{const u=typeof s[h]=="string"?s[h]:(0,r.MA)(s[h]);m[h]={value:u}}),m}},40511:(Q,I,e)=>{"use strict";e.d(I,{F0:()=>l,bQ:()=>m,lW:()=>s});var n=e(41053),a=e(75505),o=e(19347),r=e(76888),i=e(18380);const f=({sourceUID:h,targetUID:u,...b})=>{const g=(0,o.l)().getInstanceSettings(h),P=(0,o.l)().getInstanceSettings(u);if((b?.orgId===void 0||b?.orgId===null||b?.orgId===0)&&i.kb.logWarning("Invalid correlation config: Missing org id."),g&&g?.uid!==void 0&&P&&P.uid!==void 0)return{...b,source:g,target:P};i.kb.logWarning("Invalid correlation config: Missing source or target.",{source:JSON.stringify(g),target:JSON.stringify(P)})},d=h=>!!h,l=h=>({...h,correlations:h.correlations.map(f).filter(d)});function m(h){return h.data}const s=()=>{const{backend:h}=(0,r.Il)(),[u,b]=(0,n.A)(D=>(0,a.s)(h.fetch({url:"/api/datasources/correlations",params:{page:D.page},method:"GET",showErrorAlert:!1})).then(m).then(l),[h]),[g,P]=(0,n.A)(({sourceUID:D,...E})=>h.post(`/api/datasources/uid/${D}/correlations`,E).then(S=>{const T=f(S.result);if(T!==void 0)return T;throw new Error("invalid sourceUID")}),[h]),[c,y]=(0,n.A)(({sourceUID:D,uid:E})=>h.delete(`/api/datasources/uid/${D}/correlations/${E}`),[h]),[p,v]=(0,n.A)(({sourceUID:D,uid:E,...S})=>h.patch(`/api/datasources/uid/${D}/correlations/${E}`,S).then(T=>{const M=f(T.result);if(M!==void 0)return M;throw new Error("invalid sourceUID")}),[h]);return{create:{execute:P,...g},update:{execute:v,...p},get:{execute:b,...u},remove:{execute:y,...c}}}},18380:(Q,I,e)=>{"use strict";e.d(I,{$q:()=>h,J6:()=>s,cA:()=>l,kb:()=>g,tZ:()=>b});var n=e(75505),a=e(91890),o=e(17172),r=e(19347),i=e(34867),f=e(9651),d=e(40511);const l=(P,c,y)=>(P.forEach(p=>{const v=p.refId;if(!v)return;let D=y[v];if(D===void 0&&p.meta?.preferredVisualisationType==="rawPrometheus"){const S=(0,f.a)(v);D=y[S]}const E=c.filter(S=>S.source.uid===D);m(p,E)}),P),m=(P,c)=>{P.fields.forEach(y=>{y.config.links=y.config.links?.filter(p=>p.origin!==a.x0.Correlations)||[],c.map(p=>{if(p.config?.field===y.name){const v=p.config?.target||{};y.config.links.push({internal:{query:{...v,datasource:{uid:p.target.uid}},datasourceUid:p.target.uid,datasourceName:p.target.name,transformations:p.config?.transformations},url:"",title:p.label||p.target.name,origin:a.x0.Correlations})}})})},s=async P=>(0,n.s)((0,o.AI)().fetch({url:"/api/datasources/correlations",method:"GET",showErrorAlert:!1,params:{sourceUID:P}})).then(d.bQ).then(d.F0),h=async(P,c)=>(0,o.AI)().post(`/api/datasources/uid/${P}/correlations`,c),u=async P=>P.datasourceInstance?.meta.mixed?await(0,r.l)().get(P.queries[0].datasource):P.datasourceInstance,b=async(P,c)=>Promise.all([u(P),u(c)]).then(y=>y[0]?.name!==void 0&&y[1]?.name!==void 0?`${y[0]?.name} to ${y[1]?.name}`:""),g=(0,i.DW)("features.correlations")},41524:(Q,I,e)=>{"use strict";e.d(I,{W:()=>o});var n=e(11261);function a(){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i="abcdefghijklmnopqrstuvwxyz",f=r.length,d=new Map;return l=>{const m=d.get(l);if(m!=null)return m;const s=[...l].map(h=>h.toLowerCase()&&h!==h.toUpperCase()?i.charAt(Math.floor(Math.random()*f)):h.toUpperCase()&&h!==h.toUpperCase()?r.charAt(Math.floor(Math.random()*f)):h).join("");return d.set(l,s),s}}function o(r,i){if(!(i.labels||i.names||i.values))return r;const f=new Set(["time","value","exemplar","traceid","id","uid","uuid","__name__","le","name"]),d=a();return r.map(l=>{let{schema:m,data:s}=l;if(m&&s){if(i.labels){for(const h of m.fields)if(h.labels){const u={};for(const[b,g]of Object.entries(h.labels))u[b]=d(g);h.labels=u}}if(i.names)for(const h of m.fields)h.name?.length&&!f.has(h.name.toLowerCase())&&(h.name=d(h.name));i.values&&m.fields.forEach((h,u)=>{if(h.type===n.PU.string&&s){const b=s.values[u].map(g=>d(String(g)));s.values[u]=b}})}return{schema:m,data:s}})}},72255:(Q,I,e)=>{"use strict";e.d(I,{m6:()=>T,sP:()=>x});var n=e(71733),a=e(17172),o=e(12131),r=e(32264),i=e(79422),f=e(2619),d=e(33390),l=e(94954),m=e(78160),s=e(17493),h=e(14792),u=e(34214),b=e(41176),g=e(20470),P=e(16833),c=e(31678),y=e(71176),p=e(85445),v=e(27734),D=e(77431);const E=500,S="loadDashboardScene",T="__grafana_home_uid__";class M extends f.Q{constructor(){super(...arguments),this.cache={}}async fetchDashboard({uid:R,route:L,urlFolderUid:N,keepDashboardFromExploreInLocalStorage:F}){const K=d.A.getObject(g.us);if(K)return F||(0,g.yZ)(),K;const B=L===c.DashboardRoutes.Home?T:R,w=this.getFromCache(B);if(w)return w;let U;try{switch(L){case c.DashboardRoutes.New:U=await(0,y.X)(N);break;case c.DashboardRoutes.Home:if(U=await(0,a.AI)().get("/api/dashboards/home"),U.redirectUri)return U;U?.meta&&(U.meta.canSave=!1,U.meta.canShare=!1,U.meta.canStar=!1);break;case c.DashboardRoutes.Public:return await s.np.loadDashboard("public","",R);default:U=await s.np.loadDashboard("db","",R),L===c.DashboardRoutes.Embedded&&(U.meta.isEmbedded=!0)}if(U.meta.url&&L===c.DashboardRoutes.Normal){const W=n.I.stripBaseFromUrl(U.meta.url),V=o.Ny.getLocation().pathname;W!==V&&(o.Ny.replace({...o.Ny.getLocation(),pathname:W}),console.log("not correct url correcting",W,V))}U.meta.folderUid&&await(0,D.Q)(U.meta.folderUid),this.dashboardCache={dashboard:U,ts:Date.now(),cacheKey:B}}catch(W){if((0,a.NF)(W)&&W.cancelled)return null;throw W}return U}async loadSnapshot(R){try{const L=await this.loadSnapshotScene(R);this.setState({dashboard:L,isLoading:!1})}catch(L){this.setState({isLoading:!1,loadError:String(L)})}}async loadSnapshotScene(R){const L=await s.np.loadDashboard("snapshot",R,"");if(L?.dashboard)return(0,p.wM)(L);throw new Error("Snapshot not found")}async loadDashboard(R){try{(0,m.j)(S);const L=await this.loadScene(R);if(!L)return;r.$.featureToggles.preserveDashboardStateWhenNavigating&&R.uid&&(0,v.Gq)(L),r.$.publicDashboardAccessToken&&L.state.controls?.state.hideTimeControls||L.startUrlSync(),this.setState({dashboard:L,isLoading:!1});const N=(0,m.z)(S);(0,P.D)(L,N?.duration),R.route!==c.DashboardRoutes.New&&(0,b.B)({meta:L.state.meta,uid:L.state.uid,title:L.state.title,id:L.state.id})}catch(L){const N=(0,l.q)(L);this.setState({isLoading:!1,loadError:N,dashboard:C(N)})}}async loadScene(R){const L=!!(d.A.getObject(g.us)&&R.keepDashboardFromExploreInLocalStorage===!1);this.setState({isLoading:!0});const N=await this.fetchDashboard(R),F=this.cache[R.uid];if(!L&&F&&F.state.version===N?.dashboard.version)return F;if(N?.dashboard){const K=(0,p.wM)(N);return R.uid&&!L&&(this.cache[R.uid]=K),K}if(N?.redirectUri){const K=n.I.stripBaseFromUrl(N.redirectUri);return o.Ny.replace(K),null}throw new Error("Dashboard not found")}getFromCache(R){const L=this.dashboardCache;return L&&L.cacheKey===R&&Date.now()-L?.ts<E?L.dashboard:null}clearState(){(0,h.UA)().setCurrent(void 0),this.setState({dashboard:void 0,loadError:void 0,isLoading:!1,panelEditor:void 0})}setDashboardCache(R,L){this.dashboardCache={dashboard:L,ts:Date.now(),cacheKey:R}}clearDashboardCache(){this.dashboardCache=void 0}}let A=null;function x(){return A||(A=new M({})),A}function C(O){return(0,p.EH)(new u.G({...i.Ye,title:O,panels:[{fieldConfig:{defaults:{},overrides:[]},gridPos:{h:6,w:12,x:7,y:0},id:1,options:{code:{language:"plaintext",showLineNumbers:!1,showMiniMap:!1},content:`<br/><br/><center><h1>${O}</h1></center>`,mode:"html"},title:"",transparent:!0,type:"text"}]},{canSave:!1,canEdit:!1}))}},77431:(Q,I,e)=>{"use strict";e.d(I,{Q:()=>i});var n=e(82467),a=e(27677),o=e(71101),r=e(99140);async function i(f){try{const d=await a.IB.getFolderByUid(f);r.M_.dispatch((0,n.Vz)((0,o.R4)(d)))}catch(d){console.warn("Error fetching parent folder",f,"for dashboard",d)}}},79280:(Q,I,e)=>{"use strict";e.d(I,{p:()=>l});var n=e(96540),a=e(13544),o=e(90613),r=e(67061),i=e(94753),f=e(55852),d=e(8484);function l(m){return n.createElement(o.a,{alignItems:"center",padding:4},n.createElement(r.B,{direction:"column",alignItems:"center",gap:2},n.createElement(i.E,{element:"h3",textAlignment:"center"},n.createElement(d.x6,{key:"transformations.empty.add-transformation-header"},"Start transforming data")),n.createElement(i.E,{element:"p",textAlignment:"center","data-testid":a.Tp.components.Transforms.noTransformationsMessage},n.createElement(d.x6,{key:"transformations.empty.add-transformation-body"},"Transformations allow data to be changed in various ways before your visualization is shown.",n.createElement("br",null),"This includes joining data together, renaming fields, making calculations, formatting data for display, and more.")),n.createElement(f.$n,{icon:"plus",variant:"primary",size:"md",onClick:m.onShowPicker,"data-testid":a.Tp.components.Transforms.addTransformationButton},"Add transformation")))}},19293:(Q,I,e)=>{"use strict";e.d(I,{i:()=>Jt,L:()=>Rn});var n=e(12131),a=e(32264),o=e(16401),r=e(41507),i=e(60656),f=e(74730),d=e(32196),l=e(96540),m=e(13544),s=e(40845),h=e(63021),u=e(40276),b=e(40980),g=e(66864),P=e(95689),c=e(42418),y=e(39558),p=e(40675),v=e(10096),D=e(80215),E=e(27747),S=e(75471),T=e(56361),M=e(24180),A=e(16817),x=e(76885),C=e(34867),O=e(55852),R=e(25027),L=e(63066);const N=({panel:Mt,className:wt})=>{const Ht=(0,M.zy)(),{loading:tn,value:It}=(0,A.A)(()=>(0,L.J6)(Mt),[Mt]);if(tn)return l.createElement(O.$n,{disabled:!0},"New alert rule");if(!It)return l.createElement(c.F,{severity:"info",title:"No alerting capable query found"},"Cannot create alerts from this panel because no query to an alerting capable datasource is found.");const Xe=async()=>{(0,C.fH)(R.le.alertRuleFromPanel);const jn=await(0,L.J6)(Mt),Qn=x.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(jn),returnTo:Ht.pathname+Ht.search});n.Ny.push(Qn)};return l.createElement(O.$n,{icon:"bell",onClick:Xe,className:wt,"data-testid":"create-alert-rule-button"},"New alert rule")};var F=(Mt=>(Mt.Queries="queries",Mt.Transformations="transformations",Mt.Alert="alert",Mt))(F||{});class K extends o.Bs{constructor(wt){super({}),this.tabId=F.Alert,this.TabComponent=Ht=>U({...Ht,model:this}),this._panelManager=wt}static{this.Component=B}getTabLabel(){return"Alert"}getDashboardUID(){return this.getDashboard().state.uid}getDashboard(){return(0,f.YQ)(this._panelManager)}getLegacyPanelId(){return(0,f.Cs)(this._panelManager.state.panel)}getCanCreateRules(){const wt=(0,S.Wd)("grafana");return this.getDashboard().state.meta.canSave&&v.contextSrv.hasPermission(wt.create)}get panelManager(){return this._panelManager}get panel(){return this._panelManager.state.panel}}function B(Mt){const{model:wt}=Mt,Ht=(0,s.of)(w),{errors:tn,loading:It,rules:Xe}=(0,E.S)({dashboardUID:wt.getDashboardUID(),panelId:wt.getLegacyPanelId()}),jn=tn.length?l.createElement(c.F,{title:"Errors loading rules",severity:"error"},tn.map((wn,sa)=>l.createElement("div",{key:sa},"Failed to load Grafana rules state: ",(0,T.JZ)(wn)))):null;if(It&&!Xe.length)return l.createElement(l.Fragment,null,jn,l.createElement(y._,{text:"Loading rules..."}));const{panel:Qn}=wt,ia=wt.getCanCreateRules();return Xe.length?l.createElement(l.Fragment,null,l.createElement(D.s,{rules:Xe}),ia&&l.createElement(N,{className:Ht.newButton,panel:Qn})):l.createElement("div",{className:Ht.noRulesWrapper},l.createElement("p",null,"There are no alert rules linked to this panel."),ia&&l.createElement(N,{panel:Qn}))}const w=Mt=>({newButton:(0,d.css)({marginTop:Mt.spacing(3)}),noRulesWrapper:(0,d.css)({margin:Mt.spacing(2),backgroundColor:Mt.colors.background.secondary,padding:Mt.spacing(3)})});function U(Mt){const{model:wt}=Mt,{rules:Ht}=(0,E.S)({dashboardUID:wt.getDashboardUID(),panelId:wt.getLegacyPanelId(),poll:!1});return l.createElement(p.o,{key:Mt.key,label:wt.getTabLabel(),icon:"bell",counter:Ht.length,active:Mt.active,onChangeTab:Mt.onChangeTab})}var W=e(41987),V=e(19347),_=e(67061),H=e(21969),G=e(53478),j=e(64152),Y=e(44932),oe=e(37464),se=e(14348),ne=e(7928);class ee extends o.Bs{constructor(wt){super({}),this.tabId=F.Queries,this.icon="database",this.onOpenInspector=()=>{this._panelManager.inspectPanel()},this.onChangeDataSource=async(Ht,tn)=>{this._panelManager.changePanelDataSource(Ht,tn)},this.onQueryOptionsChange=Ht=>{this._panelManager.changeQueryOptions(Ht)},this.onQueriesChange=Ht=>{this._panelManager.changeQueries(Ht)},this.onRunQueries=()=>{this._panelManager.queryRunner.runQueries()},this.addQueryClick=()=>{const Ht=this.getQueries();this.onQueriesChange((0,H.U7)(Ht,this.newQuery()))},this.onAddQuery=Ht=>{const tn=this.getQueries(),It=this._panelManager.state.dsSettings;this.onQueriesChange((0,H.U7)(tn,Ht,{type:It?.type,uid:It?.uid}))},this.onAddExpressionClick=()=>{const Ht=this.getQueries();this.onQueriesChange((0,H.U7)(Ht,G.Ex.newQuery()))},this.TabComponent=Ht=>z({...Ht,model:this}),this._panelManager=wt}static{this.Component=Z}getTabLabel(){return"Queries"}getItemsCount(){return this.getQueries().length}buildQueryOptions(){const wt=this._panelManager,Ht=this._panelManager.state.panel,tn=this._panelManager.queryRunner,It=o.jh.getTimeRange(Ht);let Xe={from:void 0,shift:void 0,hide:void 0};It instanceof ne.v&&(Xe={from:It.state.timeFrom,shift:It.state.timeShift,hide:It.state.hideTimeOverride});let jn=tn.state.queries;return{cacheTimeout:wt.state.dsSettings?.meta.queryOptions?.cacheTimeout?tn.state.cacheTimeout:void 0,queryCachingTTL:wt.state.dsSettings?.cachingConfig?.enabled?tn.state.queryCachingTTL:void 0,dataSource:{default:wt.state.dsSettings?.isDefault,type:wt.state.dsSettings?.type,uid:wt.state.dsSettings?.uid},queries:jn,maxDataPoints:tn.state.maxDataPoints,minInterval:tn.state.minInterval,timeRange:Xe}}getQueries(){return this._panelManager.queryRunner.state.queries}newQuery(){const{dsSettings:wt,datasource:Ht}=this._panelManager.state;let tn;return wt?.meta.mixed?Ht?.meta.mixed?tn=(0,V.l)().getInstanceSettings(a.$.defaultDatasource):tn=Ht:tn=wt,{...Ht?.getDefaultQuery?.(W.Jk.PanelEditor),datasource:{uid:tn?.uid,type:tn?.type}}}isExpressionsSupported(wt){return(wt.meta.alerting||wt.meta.mixed)===!0}renderExtraActions(){return j.m.getAllExtraRenderAction().map((wt,Ht)=>wt({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:Ht})).filter(Boolean)}get queryRunner(){return this._panelManager.queryRunner}get panelManager(){return this._panelManager}}function Z({model:Mt}){const{datasource:wt,dsSettings:Ht}=Mt.panelManager.useState(),{data:tn,queries:It}=Mt.panelManager.queryRunner.useState();if(!wt||!Ht||!tn)return null;const Xe=!(0,se.kN)(Ht.name);return l.createElement("div",{"data-testid":m.Tp.components.QueryTab.content},l.createElement(oe.K,{data:tn,dsSettings:Ht,dataSource:wt,options:Mt.buildQueryOptions(),onDataSourceChange:Mt.onChangeDataSource,onOptionsChange:Mt.onQueryOptionsChange,onOpenQueryInspector:Mt.onOpenInspector}),l.createElement(Y.L,{data:tn,queries:It,dsSettings:Ht,onAddQuery:Mt.onAddQuery,onQueriesChange:Mt.onQueriesChange,onRunQueries:Mt.onRunQueries}),l.createElement(_.B,{gap:2},Xe&&l.createElement(O.$n,{icon:"plus",onClick:Mt.addQueryClick,variant:"secondary","data-testid":m.Tp.components.QueryTab.addQuery},"Add query"),a.$.expressionsEnabled&&Mt.isExpressionsSupported(Ht)&&l.createElement(O.$n,{icon:"plus",onClick:Mt.onAddExpressionClick,variant:"secondary","data-testid":m.Tp.components.QueryTab.addExpression},l.createElement("span",null,"Expression\xA0")),Mt.renderExtraActions()))}function z(Mt){const{model:wt}=Mt,Ht=wt.queryRunner.useState();return l.createElement(p.o,{key:Mt.key,label:wt.getTabLabel(),icon:"database",counter:Ht.queries.length,active:Mt.active,onChangeTab:Mt.onChangeTab})}var q=e(75494),ie=e(19727),de=e(96374),ue=e(57650),fe=e(79280),Se=e(97497),he=e(29158),ce=e(21427),me=e(66879);function pe(Mt){const{isOpen:wt,series:Ht,onClose:tn,onTransformationAdd:It}=Mt,[Xe,jn]=(0,l.useState)({search:"",showIllustrations:!0}),Qn=ga=>jn({...Xe,search:ga.currentTarget.value}),ia=ga=>jn({...Xe,showIllustrations:ga}),wn=ga=>jn({...Xe,selectedFilter:ga}),sa=(0,l.useMemo)(()=>Se.h.list().sort((ga,Ts)=>ga.name>Ts.name?1:Ts.name>ga.name?-1:0),[]),La=sa.filter(ga=>Xe.selectedFilter&&Xe.selectedFilter!==me.e&&!ga.categories?.has(Xe.selectedFilter)?!1:ga.name.toLocaleLowerCase().includes(Xe.search.toLocaleLowerCase())),xa=l.createElement(l.Fragment,null,La.length," / ",sa.length," \xA0\xA0",l.createElement(he.K,{name:"times",onClick:()=>{jn({...Xe,search:""})},tooltip:"Clear search"}));if(wt)return l.createElement(ce.R,{data:Ht,onTransformationAdd:It,xforms:La,search:Xe.search,noTransforms:!1,suffix:Xe.search!==""?xa:l.createElement(l.Fragment,null),selectedFilter:Xe.selectedFilter,onSearchChange:Qn,onSearchKeyDown:()=>{},showIllustrations:Xe.showIllustrations,onShowIllustrationsChange:ia,onSelectedFilterChange:wn,onClose:tn})}class ye extends o.Bs{constructor(wt){super({}),this.tabId=F.Transformations,this.icon="process",this.TabComponent=Ht=>Ne({...Ht,model:this}),this._panelManager=wt}static{this.Component=Pe}getTabLabel(){return"Transformations"}getQueryRunner(){return this._panelManager.queryRunner}getDataTransformer(){return this._panelManager.dataTransformer}onChangeTransformations(wt){this._panelManager.changeTransformations(wt)}get panelManager(){return this._panelManager}}function Pe({model:Mt}){const wt=(0,s.of)(Oe),Ht=Mt.getQueryRunner().useState(),{data:tn,transformations:It}=Mt.getDataTransformer().useState(),Xe=It,[jn,Qn]=(0,l.useState)(!1),[ia,wn]=(0,l.useState)(!1),sa=()=>Qn(!0),La=()=>Qn(!1);if(!tn||!Ht.data)return;const xa=l.createElement(pe,{onClose:La,onTransformationAdd:ga=>{ga.value!==void 0&&(Mt.onChangeTransformations([...Xe,{id:ga.value,options:{}}]),La())},isOpen:jn,series:tn.series});return Xe.length<1?l.createElement(l.Fragment,null,l.createElement(fe.p,{onShowPicker:sa}),xa):l.createElement(l.Fragment,null,l.createElement(Ie,{data:Ht.data,transformations:Xe,model:Mt}),l.createElement(ie.e,null,l.createElement(O.$n,{icon:"plus",variant:"secondary",onClick:sa,"data-testid":m.Tp.components.Transforms.addTransformationButton},"Add another transformation"),l.createElement(O.$n,{"data-testid":m.Tp.components.Transforms.removeAllTransformationsButton,className:wt.removeAll,icon:"times",variant:"secondary",onClick:()=>wn(!0)},"Delete all transformations")),l.createElement(de.u,{isOpen:ia,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>{Mt.onChangeTransformations([]),wn(!1)},onDismiss:()=>wn(!1)}),xa)}function Ie({transformations:Mt,model:wt,data:Ht}){const tn=Mt.map((Xe,jn)=>({id:`${jn} - ${Xe.id}`,transformation:Xe})),It=Xe=>{if(!Xe||!Xe.destination)return;const jn=Xe.source.index,Qn=Xe.destination.index;if(jn===Qn)return;const ia=Array.from(tn),[wn]=ia.splice(jn,1);ia.splice(Qn,0,wn),wt.onChangeTransformations(ia.map(sa=>sa.transformation))};return l.createElement(q.JY,{onDragEnd:It},l.createElement(q.gL,{droppableId:"transformations-list",direction:"vertical"},Xe=>l.createElement("div",{ref:Xe.innerRef,...Xe.droppableProps},l.createElement(ue.A,{onChange:(jn,Qn)=>{const ia=Mt.slice();ia[jn]=Qn,wt.onChangeTransformations(ia)},onRemove:jn=>{const Qn=Mt.slice();Qn.splice(jn,1),wt.onChangeTransformations(Qn)},configs:tn,data:Ht}),Xe.placeholder)))}const Oe=Mt=>({removeAll:(0,d.css)({marginLeft:Mt.spacing(2)})});function Ne(Mt){const{model:wt}=Mt,Ht=wt.getDataTransformer().useState();return l.createElement(p.o,{key:Mt.key,label:wt.getTabLabel(),icon:"process",counter:Ht.transformations.length,active:Mt.active,onChangeTab:Mt.onChangeTab})}class We extends o.Bs{constructor(wt){super({tab:F.Queries,tabs:[]}),this._urlSync=new o.So(this,{keys:["tab"]}),this._initialTabsBuilt=!1,this.onChangeTab=Ht=>{this.setState({tab:Ht.tabId})},this.panelManager=wt,this.addActivationHandler(()=>this.onActivate())}static{this.Component=Ae}getUrlState(){return{tab:this.state.tab}}updateFromUrl(wt){wt.tab&&typeof wt.tab=="string"&&this.setState({tab:wt.tab})}onActivate(){const wt=this.panelManager.state.panel;return this.setupPanelSubscription(wt),this.buildTabs(),this._subs.add(this.panelManager.subscribeToState((Ht,tn)=>{Ht.panel!==tn.panel&&(this.buildTabs(),this.setupPanelSubscription(Ht.panel))})),()=>{this.panelSubscription&&(this.panelSubscription.unsubscribe(),this.panelSubscription=void 0)}}setupPanelSubscription(wt){this.panelSubscription&&(this._initialTabsBuilt=!1,this.panelSubscription.unsubscribe()),this.panelSubscription=wt.subscribeToState(()=>{wt.getPlugin()&&!this._initialTabsBuilt&&(this.buildTabs(),this._initialTabsBuilt=!0)})}buildTabs(){const Ht=this.panelManager.state.panel,tn=this.panelManager.queryRunner,It=[];if(Ht){const Xe=Ht.getPlugin();if(!Xe)return;if(Xe.meta.skipDataQuery){this.setState({tabs:It});return}else tn&&It.push(new ee(this.panelManager)),It.push(new ye(this.panelManager)),(0,P.e)(Xe)&&It.push(new K(this.panelManager))}this.setState({tabs:It})}}function Ae({model:Mt}){const{tab:wt,tabs:Ht}=Mt.useState(),tn=(0,s.of)(Ue);if(!Ht)return;const It=Ht.find(Xe=>Xe.tabId===wt);return l.createElement("div",{className:tn.dataPane,"data-testid":m.Tp.components.PanelEditor.DataPane.content},l.createElement(h.U,{hideBorder:!0,className:tn.tabsBar},Ht.map((Xe,jn)=>l.createElement(Xe.TabComponent,{key:`${Xe.getTabLabel()}-${jn}`,active:Xe.tabId===wt,onChangeTab:()=>Mt.onChangeTab(Xe)}))),l.createElement(u.E,{className:tn.scroll},l.createElement(b.J,{className:tn.tabContent},l.createElement(g.mc,null,It&&l.createElement(It.Component,{model:It})))))}function Ue(Mt){return{dataPane:(0,d.css)({display:"flex",flexDirection:"column",flexGrow:1,minHeight:0,height:"100%",width:"100%"}),tabContent:(0,d.css)({padding:Mt.spacing(2),border:`1px solid ${Mt.colors.border.weak}`,borderLeft:"none",borderBottom:"none",borderTopRightRadius:Mt.shape.radius.default,flexGrow:1}),tabsBar:(0,d.css)({flexShrink:0,paddingLeft:Mt.spacing(2)}),scroll:(0,d.css)({background:Mt.colors.background.primary})}}var Me=e(27746),$e=e(31807),ke=e(54174),Ze=e(40996),ot=e(37390),xt=e(10354),ct=e(14578),ft=e(57767),Le=e(43535);const re=({libraryPanel:Mt,isUnsavedPrompt:wt,onDismiss:Ht,onConfirm:tn,onDiscard:It})=>{const[Xe,jn]=(0,l.useState)(""),Qn=(0,A.A)(async()=>{const ga=await(0,ft.xV)(Mt.state.uid);return ga.length>0?ga.map(Ts=>Ts.title):[]},[Mt.state.uid]),[ia,wn]=(0,l.useState)([]);(0,Ze.A)(()=>Qn.value?wn(Qn.value.filter(ga=>ga.toLowerCase().includes(Xe.toLowerCase()))):wn([]),300,[Qn.value,Xe]);const sa=(0,s.of)(Le.o),La=(0,l.useCallback)(()=>{It()},[It]),xa=wt?"Unsaved library panel changes":"Save library panel";return l.createElement(ot.a,{title:xa,icon:"save",onDismiss:Ht,isOpen:!0},l.createElement("div",null,l.createElement("p",{className:sa.textInfo},"This update will affect ",l.createElement("strong",null,Mt.state._loadedPanel?.meta?.connectedDashboards," ",Mt.state._loadedPanel?.meta?.connectedDashboards===1?"dashboard":"dashboards","."),"The following dashboards using the panel will be affected:"),l.createElement(xt.p,{className:sa.dashboardSearch,prefix:l.createElement(ct.I,{name:"search"}),placeholder:"Search affected dashboards",value:Xe,onChange:ga=>jn(ga.currentTarget.value)}),Qn.loading?l.createElement("p",null,"Loading connected dashboards..."):l.createElement("table",{className:sa.myTable},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",null,"Dashboard name"))),l.createElement("tbody",null,ia.map((ga,Ts)=>l.createElement("tr",{key:`dashrow-${Ts}`},l.createElement("td",null,ga))))),l.createElement(ot.a.ButtonRow,null,l.createElement(O.$n,{variant:"secondary",onClick:Ht,fill:"outline"},"Cancel"),wt&&l.createElement(O.$n,{variant:"destructive",onClick:La},"Discard"),l.createElement(O.$n,{onClick:()=>{tn()}},"Update all"))))};var X=e(21633);function le(Mt){const{paneOptions:wt}=Mt,[Ht,tn]=l.useState({collapsed:!1}),It=(0,l.useCallback)((La,xa)=>{if(La<=0&&xa<=0)return;const ga=xa/La*(1-La);Ht.collapsed&&ga>wt.collapseBelowPixels&&tn({collapsed:!1}),!Ht.collapsed&&ga<wt.collapseBelowPixels&&tn({collapsed:!0})},[Ht,wt.collapseBelowPixels]),Xe=(0,l.useCallback)((La,xa)=>{if(La<=0&&xa<=0)return;const ga=1-La,Ts=Ht.snapSize===0,Us=xa/La,ks=(wt.snapOpenToPixels??Us/2)/Us;Ht.collapsed?tn(Ts?{snapSize:Math.max(ga,ks),collapsed:!1}:{snapSize:0,collapsed:!0}):Ts&&tn({snapSize:ga,collapsed:!1})},[Ht,wt.snapOpenToPixels]),jn=(0,l.useCallback)(()=>{tn({collapsed:!Ht.collapsed})},[Ht.collapsed]),{containerProps:Qn,primaryProps:ia,secondaryProps:wn,splitterProps:sa}=(0,X.h)({...Mt,onResizing:It,onSizeChanged:Xe});return wn.style.overflow="hidden",wn.style.minWidth="unset",wn.style.minHeight="unset",Ht.snapSize?(ia.style={...ia.style,flexGrow:1-Ht.snapSize},wn.style.flexGrow=Ht.snapSize):Ht.snapSize===0&&(ia.style.flexGrow=1,wn.style.flexGrow=0,wn.style.minWidth="unset",wn.style.minHeight="unset",wn.style.overflow="unset"),{containerProps:Qn,primaryProps:ia,secondaryProps:wn,splitterProps:sa,splitterState:Ht,onToggleCollapse:jn}}function be({model:Mt}){const wt=(0,f.YQ)(Mt),{optionsPane:Ht}=Mt.useState(),tn=(0,s.of)(Te),{containerProps:It,primaryProps:Xe,secondaryProps:jn,splitterProps:Qn,splitterState:ia,onToggleCollapse:wn}=le({direction:"row",dragPosition:"end",initialSize:.75,paneOptions:{collapseBelowPixels:250,snapOpenToPixels:400}});return l.createElement(l.Fragment,null,l.createElement($e.c,{dashboard:wt}),l.createElement("div",{...It,"data-testid":m.Tp.components.PanelEditor.General.content},l.createElement("div",{...Xe,className:(0,d.cx)(Xe.className,tn.body)},l.createElement(De,{model:Mt})),l.createElement("div",{...Qn}),l.createElement("div",{...jn,className:(0,d.cx)(jn.className,tn.optionsPane)},ia.collapsed&&l.createElement("div",{className:tn.expandOptionsWrapper},l.createElement(Me.I,{tooltip:"Open options pane",icon:"arrow-to-right",onClick:wn,variant:"canvas",className:tn.rotate180,"aria-label":"Open options pane"})),!ia.collapsed&&l.createElement(Ht.Component,{model:Ht}))))}function De({model:Mt}){const wt=(0,f.YQ)(Mt),{vizManager:Ht,dataPane:tn,showLibraryPanelSaveModal:It,showLibraryPanelUnlinkModal:Xe}=Mt.useState(),{sourcePanel:jn}=Ht.useState(),Qn=(0,f.Yr)(jn.resolve()),{controls:ia,scopes:wn}=wt.useState(),sa=(0,s.of)(Te),{containerProps:La,primaryProps:xa,secondaryProps:ga,splitterProps:Ts,splitterState:Us,onToggleCollapse:Bs}=le({direction:"column",dragPosition:"start",initialSize:.5,paneOptions:{collapseBelowPixels:150}});return La.className=(0,d.cx)(La.className,sa.container),tn||(xa.style.flexGrow=1),l.createElement("div",{className:(0,d.cx)(sa.pageContainer,ia&&!wn&&sa.pageContainerWithControls,wn&&sa.pageContainerWithScopes)},wn&&l.createElement(wn.Component,{model:wn}),ia&&l.createElement("div",{className:(0,d.cx)(sa.controlsWrapper,wn&&sa.controlsWrapperWithScopes)},l.createElement(ia.Component,{model:ia})),l.createElement("div",{...La},l.createElement("div",{...xa},l.createElement(Ht.Component,{model:Ht})),It&&Qn&&l.createElement(re,{libraryPanel:Qn,onDismiss:Mt.onDismissLibraryPanelSaveModal,onConfirm:Mt.onConfirmSaveLibraryPanel,onDiscard:Mt.onDiscard}),Xe&&Qn&&l.createElement(ke.l,{onDismiss:Mt.onDismissUnlinkLibraryPanelModal,onConfirm:Mt.onConfirmUnlinkLibraryPanel,isOpen:!0}),tn&&l.createElement(l.Fragment,null,l.createElement("div",{...Ts}),l.createElement("div",{...ga},Us.collapsed&&l.createElement("div",{className:sa.expandDataPane},l.createElement(O.$n,{tooltip:"Open query pane",icon:"arrow-to-right",onClick:Bs,variant:"secondary",size:"sm",className:sa.openDataPaneButton,"aria-label":"Open query pane"})),!Us.collapsed&&l.createElement(tn.Component,{model:tn})))))}function Te(Mt){return{pageContainer:(0,d.css)({display:"grid",gridTemplateAreas:`
        "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",height:"100%"}),pageContainerWithControls:(0,d.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),pageContainerWithScopes:(0,d.css)({gridTemplateAreas:`
        "scopes controls"
        "panels panels"`,gridTemplateColumns:`${Mt.spacing(32)} 1fr`,gridTemplateRows:"auto 1fr"}),container:(0,d.css)({gridArea:"panels",height:"100%"}),canvasContent:(0,d.css)({label:"canvas-content",display:"flex",flexDirection:"column",flexBasis:"100%",flexGrow:1,minHeight:0,width:"100%"}),body:(0,d.css)({label:"body",flexGrow:1,display:"flex",flexDirection:"column",minHeight:0}),optionsPane:(0,d.css)({flexDirection:"column",borderLeft:`1px solid ${Mt.colors.border.weak}`,background:Mt.colors.background.primary}),expandOptionsWrapper:(0,d.css)({display:"flex",flexDirection:"column",padding:Mt.spacing(2,1)}),expandDataPane:(0,d.css)({display:"flex",flexDirection:"row",padding:Mt.spacing(1),borderTop:`1px solid ${Mt.colors.border.weak}`,borderRight:`1px solid ${Mt.colors.border.weak}`,background:Mt.colors.background.primary,flexGrow:1,justifyContent:"space-around"}),rotate180:(0,d.css)({rotate:"180deg"}),controlsWrapper:(0,d.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls",padding:Mt.spacing(2,0,2,2)}),controlsWrapperWithScopes:(0,d.css)({padding:Mt.spacing(2,0)}),openDataPaneButton:(0,d.css)({width:Mt.spacing(8),justifyContent:"center",svg:{rotate:"-90deg"}})}}var we=e(67647),Ke=e(26443),Ve=e(41394),ht=e(17706),gt=e(22290),bt=e(66211),St=e(15292),Je=e(94354),rt=e(21594),Rt=e(64919),_t=e(21744),nn=e(20214),Kt=e(74410),en=e(48192),Qt=e(74097),An=e(92378),un=e(6923),fn=e(20455),Tt=e(32023);function $t(Mt,wt,Ht){const tn=new en.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),It=Tt.b4.getPanelLinks(wt),Xe=It?.state.rawLinks??[],jn=(0,f.YQ)(wt);return tn.addItem(new Qt.v({title:"Title",value:wt.state.title,popularRank:1,render:function(){return l.createElement(Cn,{vizManager:Mt})},addon:a.$.featureToggles.dashgpt&&l.createElement(Kt.h,{onGenerate:Qn=>Mt.setPanelTitle(Qn),panel:(0,fn.Z6)(wt),dashboard:(0,fn.Uy)(jn)})})).addItem(new Qt.v({title:"Description",value:wt.state.description,render:function(){return l.createElement(Tn,{panel:wt})},addon:a.$.featureToggles.dashgpt&&l.createElement(nn.t,{onGenerate:Qn=>wt.setState({description:Qn}),panel:(0,fn.Z6)(wt)})})).addItem(new Qt.v({title:"Transparent background",render:function(){return l.createElement(St.d,{value:wt.state.displayMode==="transparent",id:"transparent-background",onChange:()=>{wt.setState({displayMode:wt.state.displayMode==="transparent"?"default":"transparent"})}})}})).addCategory(new en.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:Xe?.length}).addItem(new Qt.v({title:"Panel links",render:()=>l.createElement(Yt,{panelLinks:It??void 0})}))).addCategory(new en.C({title:"Repeat options",id:"Repeat options",isOpenDefault:!1}).addItem(new Qt.v({title:"Repeat by variable",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(){return l.createElement(An.U,{id:"repeat-by-variable-select",parent:wt,repeat:Ht,onChange:ia=>{const wn={repeat:ia};ia&&!Mt.state.repeatDirection&&(wn.repeatDirection="h"),Mt.setState(wn)}})}})).addItem(new Qt.v({title:"Repeat direction",showIf:()=>!!Mt.state.repeat,render:function(){const ia=[{label:"Horizontal",value:"h"},{label:"Vertical",value:"v"}];return l.createElement(Je.z,{options:ia,value:Mt.state.repeatDirection??"h",onChange:wn=>Mt.setState({repeatDirection:wn})})}})).addItem(new Qt.v({title:"Max per row",showIf:()=>!!(Mt.state.repeat&&Mt.state.repeatDirection==="h"),render:function(){const ia=[2,3,4,6,8,12].map(wn=>({label:wn.toString(),value:wn}));return l.createElement(rt.l6,{options:ia,value:Mt.state.maxPerRow,onChange:wn=>Mt.setState({maxPerRow:wn.value})})}})))}function Yt({panelLinks:Mt}){const{rawLinks:wt}=Mt?Mt.useState():{rawLinks:[]};return l.createElement(Rt.e,{links:wt,onChange:Ht=>Mt?.setState({rawLinks:Ht}),getSuggestions:un.Fq,data:[]})}function Cn({vizManager:Mt}){const{title:wt}=Mt.state.panel.useState();return l.createElement(xt.p,{"data-testid":"panel-edit-panel-title-input",value:wt,onChange:Ht=>Mt.setPanelTitle(Ht.currentTarget.value)})}function Tn({panel:Mt}){const{description:wt}=Mt.useState();return l.createElement(_t.f,{id:"description-text-area",value:wt,onChange:Ht=>Mt.setState({description:Ht.currentTarget.value})})}const vn=l.memo(({vizManager:Mt,searchQuery:wt,listMode:Ht,data:tn})=>{const{panel:It,sourcePanel:Xe,repeat:jn}=Mt.useState(),Qn=Xe.resolve().parent,{options:ia,fieldConfig:wn,_pluginInstanceState:sa}=It.useState(),La=(0,l.useMemo)(()=>$t(Mt,It,jn),[Mt,It,jn]),xa=(0,l.useMemo)(()=>{const ks=It.getPlugin();if(ks)return(0,bt.Z4)({panel:It,data:tn,plugin:ks,eventBus:It.getPanelContext().eventBus,instanceState:sa})},[It,ia,wn,sa]),ga=(0,l.useMemo)(()=>{if(Qn instanceof i.F)return(0,bt.tN)(Qn)},[Qn]),Ts=(0,l.useMemo)(()=>(0,gt.v)(wn,It.getPlugin()?.fieldConfigRegistry,tn?.series??[],wt,ks=>{It.onFieldConfigChange(ks,!0)}),[wt,It,wn]),Us=wt.length>0,Bs=[];if(Us)Bs.push((0,Ke.Po)([La,...ga?[ga]:[],...xa??[]],Ts,wt));else switch(Ht){case Ke.gs.All:ga&&Bs.push(ga.render()),Bs.push(La.render());for(const ks of xa??[])Bs.push(ks.render());for(const ks of Ts)Bs.push(ks.render());break;case Ke.gs.Overrides:for(const ks of Ts)Bs.push(ks.render());default:break}return Bs});vn.displayName="PanelOptions";var Kn=e(78685),Yn=e(88575),nt=e(15054),yt=e(32696),Vt=e(56707),je=e(86292),tt=e(53543);function Dt({vizManager:Mt,data:wt,onChange:Ht}){const{panel:tn}=Mt.useState(),It=(0,s.of)(Ot),[Xe,jn]=(0,l.useState)(""),Qn=!1,ia=Qn?nt.MM:nt.wV,wn=Qn?yt.__.Widgets:yt.__.Visualizations,sa=(0,l.useMemo)(()=>new tt.R(tn),[tn]),La=(0,l.useMemo)(()=>new Set([yt.__.Widgets,yt.__.Visualizations,yt.__.Suggestions]),[]),[xa,ga]=(0,Kn.A)(ia,wn);(0,l.useEffect)(()=>{xa&&!La.has(xa)&&ga(wn)},[wn,xa,ga,La]);const Ts=[{label:"Visualizations",value:yt.__.Visualizations},{label:"Suggestions",value:yt.__.Suggestions}],Us=Bs=>{Mt.changePluginType(Bs.pluginId),Ht()};return l.createElement("div",{className:It.wrapper},l.createElement(we.Z,{className:It.filter,value:Xe,onChange:jn,autoFocus:!0,placeholder:"Search for..."}),l.createElement(Yn.D,{className:It.customFieldMargin},l.createElement(Je.z,{options:Ts,value:xa,onChange:ga,fullWidth:!0})),l.createElement(u.E,null,xa===yt.__.Visualizations&&l.createElement(je.G,{pluginId:tn.state.pluginId,searchQuery:Xe,onChange:Us}),xa===yt.__.Suggestions&&l.createElement(Vt.a,{onChange:Us,searchQuery:Xe,panel:sa,data:wt})))}const Ot=Mt=>({wrapper:(0,d.css)({display:"flex",flexDirection:"column",flexGrow:1,padding:Mt.spacing(2,1),height:"100%",gap:Mt.spacing(2),border:`1px solid ${Mt.colors.border.weak}`,borderRight:"none",borderBottom:"none",borderTopLeftRadius:Mt.shape.radius.default}),customFieldMargin:(0,d.css)({marginBottom:Mt.spacing(1)}),filter:(0,d.css)({minHeight:Mt.spacing(4)})});class Lt extends o.Bs{constructor(wt){super({searchQuery:"",listMode:Ke.gs.All,...wt}),this.onToggleVizPicker=()=>{this.setState({isVizPickerOpen:!this.state.isVizPickerOpen})},this.onSetSearchQuery=Ht=>{this.setState({searchQuery:Ht})},this.onSetListMode=Ht=>{this.setState({listMode:Ht})}}static{this.Component=({model:wt})=>{const{isVizPickerOpen:Ht,searchQuery:tn,listMode:It}=wt.useState(),Xe=o.jh.getAncestor(wt,Jt).state.vizManager,{pluginId:jn}=Xe.state.panel.useState(),{data:Qn}=o.jh.getData(Xe.state.panel).useState(),ia=(0,s.of)(Gt);return l.createElement(l.Fragment,null,!Ht&&l.createElement(l.Fragment,null,l.createElement("div",{className:ia.top},l.createElement(hn,{pluginId:jn,onOpen:wt.onToggleVizPicker}),l.createElement(we.Z,{className:ia.searchOptions,value:tn,placeholder:"Search options",onChange:wt.onSetSearchQuery})),l.createElement("div",{className:ia.listOfOptions},l.createElement(vn,{vizManager:Xe,searchQuery:tn,listMode:It,data:Qn}))),Ht&&l.createElement(Dt,{vizManager:Xe,onChange:wt.onToggleVizPicker,data:Qn}))}}}function Gt(Mt){return{top:(0,d.css)({display:"flex",flexDirection:"column",padding:Mt.spacing(2,1),gap:Mt.spacing(2)}),listOfOptions:(0,d.css)({display:"flex",flexDirection:"column",flexGrow:"1",overflow:"auto"}),searchOptions:(0,d.css)({minHeight:Mt.spacing(4)}),searchWrapper:(0,d.css)({padding:Mt.spacing(2,2,2,0)}),vizField:(0,d.css)({marginBottom:Mt.spacing(1)}),rotateIcon:(0,d.css)({rotate:"180deg"})}}function hn({pluginId:Mt,onOpen:wt}){const Ht=(0,s.of)(mt);let tn=(0,l.useMemo)(()=>(0,ht.A4)().filter(It=>It.id===Mt)[0],[Mt]);return tn||(tn=(0,Ve.$)(`Panel plugin not found (${Mt})`,!0).meta),l.createElement(_.B,{gap:1},l.createElement(Me.I,{className:Ht.vizButton,tooltip:"Click to change visualization",imgSrc:tn.info.logos.small,onClick:wt,"data-testid":m.Tp.components.PanelEditor.toggleVizPicker,"aria-label":"Change Visualization",variant:"canvas",isOpen:!1,fullWidth:!0},tn.name))}function mt(Mt){return{vizButton:(0,d.css)({textAlign:"left"})}}var Bt=e(89681);class Jt extends o.Bs{constructor(wt){super(wt),this._initialRepeatOptions={},this._discardChanges=!1,this.onDiscard=()=>{this._discardChanges=!0,n.Ny.partial({editPanel:null})},this.onSaveLibraryPanel=()=>{this.setState({showLibraryPanelSaveModal:!0})},this.onConfirmSaveLibraryPanel=()=>{this.state.vizManager.commitChanges(),n.Ny.partial({editPanel:null})},this.onDismissLibraryPanelSaveModal=()=>{this.setState({showLibraryPanelSaveModal:!1})},this.onUnlinkLibraryPanel=()=>{this.setState({showLibraryPanelUnlinkModal:!0})},this.onDismissUnlinkLibraryPanelModal=()=>{this.setState({showLibraryPanelUnlinkModal:!1})},this.onConfirmUnlinkLibraryPanel=()=>{this.state.vizManager.unlinkLibraryPanel(),this.setState({showLibraryPanelUnlinkModal:!1})};const{repeat:Ht,repeatDirection:tn,maxPerRow:It}=wt.vizManager.state;this._initialRepeatOptions={repeat:Ht,repeatDirection:tn,maxPerRow:It},this.addActivationHandler(this._activationHandler.bind(this))}static{this.Component=be}_activationHandler(){const wt=this.state.vizManager,Ht=wt.state.panel;return this._subs.add(wt.subscribeToState((tn,It)=>{tn.panel.state.pluginId!==It.panel.state.pluginId&&this._initDataPane(tn.panel.state.pluginId)})),this._initDataPane(Ht.state.pluginId),()=>{this._discardChanges?this.state.isNewPanel&&(0,f.YQ)(this).removePanel(wt.state.sourcePanel.resolve()):this.commitChanges()}}_initDataPane(wt){const Ht=a.$.panels[wt]?.skipDataQuery;Ht&&this.state.dataPane&&(n.Ny.partial({tab:null},!0),this.setState({dataPane:void 0})),!Ht&&!this.state.dataPane&&this.setState({dataPane:new We(this.state.vizManager)})}getUrlKey(){return this.state.panelId.toString()}getPageNav(wt,Ht){return{text:"Edit panel",parentItem:(0,f.YQ)(this).getPageNav(wt,Ht)}}commitChanges(){const wt=(0,f.YQ)(this);wt.state.isEditing||wt.onEnterEditMode();const It=this.state.vizManager.state.sourcePanel.resolve().parent,Xe=It instanceof i.F,jn=Xe?It.parent:It;if(!Xe){if(!(jn instanceof r.U)){console.error("Unsupported scene object type");return}this.commitChangesToSource(jn)}}commitChangesToSource(wt){let Ht=wt.state.width??1,tn=wt.state.height;const It=this.state.vizManager,Xe=this._initialRepeatOptions.repeatDirection==="h"&&It.state.repeatDirection==="v",jn=this._initialRepeatOptions.repeatDirection==="v"&&It.state.repeatDirection==="h";Xe?Ht=Math.floor(Ht/(wt.state.maxPerRow??1)):jn&&(Ht=24),wt.setState({body:It.state.panel.clone(),repeatDirection:It.state.repeatDirection,variableName:It.state.repeat,maxPerRow:It.state.maxPerRow,width:Ht,height:tn})}}function Rn(Mt,wt=!1){return new Jt({panelId:(0,f.Cs)(Mt),optionsPane:new Lt({}),vizManager:Bt.j.createFor(Mt),isNewPanel:wt})}},89681:(Q,I,e)=>{"use strict";e.d(I,{j:()=>M});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(581),f=e(19347),d=e(32264),l=e(12131),m=e(16401),s=e(40845),h=e(84423),u=e(36974),b=e(47311),g=e(57767),P=e(93117),c=e(13530),y=e(45429),p=e(41507),v=e(60656),D=e(7928),E=e(20455),S=e(74730),T=(x=>(x[x.Fill=0]="Fill",x[x.Fit=1]="Fit",x[x.Exact=2]="Exact",x))(T||{});class M extends m.Bs{constructor(C){super(C),this._cachedPluginOptions={},this._detectPanelModelChanges=(0,a.debounce)(()=>{const{hasChanges:O}=(0,y.yO)((0,E.Z6)(this.state.sourcePanel.resolve()),(0,E.Z6)(this.state.panel));this.setState({isDirty:O})},250),this._handleStateChange=O=>{c.l.isUpdatingPersistedState(O)&&this._detectPanelModelChanges()},this.addActivationHandler(()=>this._onActivate())}static createFor(C){let O={};const R=C.parent instanceof v.F?C.parent.parent:C.parent;if(!(R instanceof p.U))throw console.error("VizPanel is not a child of a dashboard grid item"),new Error("VizPanel is not a child of a dashboard grid item");const{variableName:L,repeatDirection:N,maxPerRow:F}=R.state;O={repeat:L,repeatDirection:N,maxPerRow:F};let K;return R.parent?.state.$variables&&(K=R.parent.state.$variables.clone()),new M({$variables:K,panel:C.clone(),sourcePanel:C.getRef(),...O})}_onActivate(){this.loadDataSource();const C=this.subscribeToEvent(m.bZ,this._handleStateChange);return()=>{C.unsubscribe()}}async loadDataSource(){if(!this.state.panel.state.$data)return;let O=this.queryRunner.state.datasource;try{let R,L;if(O)R=await(0,f.l)().get(O),L=(0,f.l)().getInstanceSettings(O);else{const F=(0,S.YQ)(this).state.uid??"",K=(0,u.CW)(F);K?.datasourceUid!==null&&(L=(0,f.l)().getInstanceSettings({uid:K?.datasourceUid}),L&&(R=await(0,f.l)().get({uid:K?.datasourceUid,type:L.type}),this.queryRunner.setState({datasource:{uid:K?.datasourceUid,type:L.type}})))}R&&L&&(this.setState({datasource:R,dsSettings:L}),(0,b.tw)({type:L.type,uid:L.uid}))}catch(R){const L=await(0,f.l)().get(d.$.defaultDatasource),N=(0,f.l)().getInstanceSettings(d.$.defaultDatasource);L&&N&&(this.setState({datasource:L,dsSettings:N}),this.queryRunner.setState({datasource:{uid:N.uid,type:N.type}})),console.error(R)}}changePluginType(C){const{options:O,fieldConfig:R,pluginId:L,...N}=m.Go.cloneSceneObjectState(this.state.panel.state);let F={defaults:{...R.defaults,custom:{}},overrides:(0,i.aW)(R.overrides,i.nx)};this._cachedPluginOptions[L]={options:O,fieldConfig:R};const K=this._cachedPluginOptions[C]?.options,B=this._cachedPluginOptions[C]?.fieldConfig;B&&(F=(0,i.H9)(F,B));const w=new m.Eb({options:K??{},fieldConfig:F,pluginId:C,...N});if(!this.state.panel.state.$data&&!d.$.panels[C].skipDataQuery){let _=(0,u.CW)((0,S.YQ)(this).state.uid)?.datasourceUid;_||(_=d.$.defaultDatasource),w.setState({$data:new m.Es({$data:new m.dt({datasource:{uid:_},queries:[{refId:"A"}]}),transformations:[]})})}const U=w.getPlugin(),W={title:w.state.title,options:w.state.options,fieldConfig:w.state.fieldConfig,id:1,type:C},V=U?.onPanelTypeChanged?.(W,L,O,R);V&&w.onOptionsChange(V,!0),U?.onPanelMigration&&w.setState({pluginVersion:(0,h.Ar)(U)}),this.setState({panel:w}),this.loadDataSource()}async changePanelDataSource(C,O){const{dsSettings:R}=this.state,L=this.queryRunner,N=R?await(0,f.l)().get({uid:R.uid}):void 0,F=await(0,f.l)().get({uid:C.uid}),K=L.state.queries,B=O||await(0,P.y)(F,C.uid,K,N);L.setState({datasource:{type:C.type,uid:C.uid},queries:B}),O&&L.runQueries(),this.loadDataSource()}changeQueryOptions(C){const O=this.state.panel,R=this.queryRunner,L=O.state.$timeRange,N={},F={};C.maxDataPoints!==R.state.maxDataPoints&&(N.maxDataPoints=C.maxDataPoints??void 0),C.minInterval!==R.state.minInterval&&C.minInterval!==null&&(N.minInterval=C.minInterval),C.timeRange&&(F.timeFrom=C.timeRange.from??void 0,F.timeShift=C.timeRange.shift??void 0,F.hideTimeOverride=C.timeRange.hide),L instanceof D.v?F.timeFrom!==void 0||F.timeShift!==void 0?L.setState(F):O.setState({$timeRange:void 0}):O.setState({$timeRange:new D.v(F)}),C.cacheTimeout!==R?.state.cacheTimeout&&(N.cacheTimeout=C.cacheTimeout),C.queryCachingTTL!==R?.state.queryCachingTTL&&(N.queryCachingTTL=C.queryCachingTTL),R.setState(N),R.runQueries()}changeQueries(C){this.queryRunner.setState({queries:C})}changeTransformations(C){const O=this.dataTransformer;O.setState({transformations:C}),O.reprocessTransformations()}inspectPanel(){const C=this.state.panel,O=(0,S.Cs)(C);l.Ny.partial({inspect:O,inspectTab:"query"})}get queryRunner(){const C=(0,S.un)(this.state.panel);if(!C)throw new Error("Query runner not found");return C}get dataTransformer(){const C=this.state.panel.state.$data;if(!C||!(C instanceof m.Es))throw new Error("Could not find SceneDataTransformer for panel");return C}toggleTableView(){if(this.state.tableView){this.setState({tableView:void 0});return}this.setState({tableView:m.d0.table().setTitle("").setOption("showTypeIcons",!0).setOption("showHeader",!0).setData(this.dataTransformer).build()})}unlinkLibraryPanel(){const C=this.state.sourcePanel.resolve();if(!(C.parent instanceof v.F))throw new Error("VizPanel is not a child of a library panel");const O=C.parent.parent;if(!(O instanceof p.U))throw new Error("Library panel not a child of a grid item");const R=this.state.panel.clone({$data:this.state.$data?.clone()});O.setState({body:R}),this.setState({sourcePanel:R.getRef()})}commitChanges(){const C=this.state.sourcePanel.resolve();this.commitChangesTo(C)}commitChangesTo(C){const O={variableName:this.state.repeat,repeatDirection:this.state.repeatDirection,maxPerRow:this.state.maxPerRow};if(C.parent instanceof p.U&&C.parent.setState({...O,body:this.state.panel.clone()}),C.parent instanceof v.F&&C.parent.parent instanceof p.U){const R=C.parent.clone({panel:this.state.panel.clone()});C.parent.parent.setState({body:R,...O}),(0,g.GX)(R).then(L=>{C.parent instanceof v.F&&R.setPanelFromLibPanel(L)})}}getPanelSaveModel(){const C=this.state.sourcePanel.resolve(),R=C.parent instanceof v.F?C.parent.parent:C.parent;if(!(R instanceof p.U))return{error:"Unsupported panel parent"};const L=R.clone({body:this.state.panel.clone()});return(0,E.ZB)(L)}setPanelTitle(C){this.state.panel.setState({title:C,hoverHeader:C===""})}static{this.Component=({model:C})=>{const{panel:O,tableView:R}=C.useState(),L=(0,s.of)(A),N=R??O,F=N.state.$data;return(0,r.useEffect)(()=>F?.activate(),[F]),r.createElement(r.Fragment,null,r.createElement("div",{className:L.wrapper},r.createElement(N.Component,{model:N})))}}}function A(x){return{wrapper:(0,n.css)({height:"100%",width:"100%",paddingLeft:x.spacing(2)})}}},13530:(Q,I,e)=>{"use strict";e.d(I,{l:()=>g});var n=e(16401),a=e(67278);const o=()=>new a.c(new URL(e.p+e.u(9666),e.b));var r=e(89681),i=e(38477),f=e(33278),d=e(41507),l=e(24283),m=e(60656),s=e(42397),h=e(7928),u=e(20455),b=e(17663);class g{constructor(c){this._dashboard=c}static isUpdatingPersistedState({payload:c}){return Object.keys(c.partialUpdate).length===0?!1:!!(c.changedObject instanceof n.Eb||c.changedObject instanceof d.U||c.changedObject instanceof h.v||c.changedObject instanceof r.j&&(Object.prototype.hasOwnProperty.call(c.partialUpdate,"repeat")||Object.prototype.hasOwnProperty.call(c.partialUpdate,"repeatDirection")||Object.prototype.hasOwnProperty.call(c.partialUpdate,"maxPerRow"))||c.changedObject instanceof n.dt&&!Object.prototype.hasOwnProperty.call(c.partialUpdate,"data")||c.changedObject instanceof n.Es&&!Object.prototype.hasOwnProperty.call(c.partialUpdate,"data")||c.changedObject instanceof s.$||c.changedObject instanceof m.F&&Object.prototype.hasOwnProperty.call(c.partialUpdate,"name")||c.changedObject instanceof n.WM&&(Object.prototype.hasOwnProperty.call(c.partialUpdate,"intervals")||Object.prototype.hasOwnProperty.call(c.partialUpdate,"refresh"))||c.changedObject instanceof n.Gg.K2||c.changedObject instanceof n.kh||c.changedObject instanceof d.U||c.changedObject instanceof n.hy||c.changedObject instanceof l.H$&&Object.keys(c.partialUpdate).some(y=>l.vk.includes(y))||c.changedObject instanceof n.JZ||c.changedObject instanceof f.x&&Object.prototype.hasOwnProperty.call(c.partialUpdate,"hideTimeControls")||c.changedObject instanceof n.Pj||c.changedObject instanceof i.g&&!Object.prototype.hasOwnProperty.call(c.partialUpdate,"data")||c.changedObject instanceof n.Gg.en||(0,b.c7)(c.changedObject))}onStateChanged(c){g.isUpdatingPersistedState(c)&&this.detectSaveModelChanges()}detectSaveModelChanges(){this._changesWorker?.postMessage({changed:(0,u.Uy)(this._dashboard),initial:this._dashboard.getInitialSaveModel()})}hasMetadataChanges(){return this._dashboard.state.meta.folderUid!==this._dashboard.getInitialState()?.meta.folderUid}updateIsDirty(c){const{hasChanges:y}=c;y||this.hasMetadataChanges()?this._dashboard.state.isDirty||this._dashboard.setState({isDirty:!0}):this._dashboard.state.isDirty&&this._dashboard.setState({isDirty:!1})}init(){this._changesWorker=o()}startTrackingChanges(){this._changesWorker||this.init(),this._changesWorker.onmessage=c=>{this.updateIsDirty(c.data)},this._changeTrackerSub=this._dashboard.subscribeToEvent(n.bZ,this.onStateChanged.bind(this))}stopTrackingChanges(){this._changeTrackerSub?.unsubscribe()}terminate(){this.stopTrackingChanges(),this._changesWorker?.terminate(),this._changesWorker=void 0}}},45429:(Q,I,e)=>{"use strict";e.d(I,{Yy:()=>i,yO:()=>m});var n=e(56596);function a(s,h){try{let u=s;for(const b of h)u=u[b];return u}catch{return}}function o(s,h){return typeof s==typeof h&&(typeof s=="string"&&s===h||Array.isArray(s)&&s.length===h.length&&s.every((u,b)=>u===h[b]))}function r(s,h){return s===h||s&&h&&s.selected===h.selected&&o(s.text,h.text)&&o(s.value,h.value)}function i(s,h,u,b,g){const P=s,c=h,y=f(c,P),p=l(c,P,b),v=c.refresh!==P.refresh;u||(c.time=P.time),g||(c.refresh=P.refresh);const D=(0,n.G4)(P,c),E=Object.values(D).reduce((S,T)=>S+T.length,0);return{changedSaveModel:c,initialSaveModel:P,diffs:D,diffCount:E,hasChanges:E>0,hasTimeChanges:y,isNew:c.version===0,hasVariableValueChanges:p,hasRefreshChange:v}}function f(s,h){return s.time?.from!==h.time?.from||s.time?.to!==h.time?.to}function d(s,h){if(s.filters===void 0||h.filters===void 0)throw new Error("AdHoc variable missing filter property");if(s.filters.length!==h.filters.length)return!1;for(let u=0;u<s.filters.length;u++){const b=s.filters[u],g=h.filters[u];if(b.key!==g.key||b.operator!==g.operator||b.value!==g.value)return!1}return!0}function l(s,h,u){const b=h.templating?.list??[],g=s.templating?.list??[];let P=!1;for(const c of g){const y=b.find(({name:p,type:v})=>p===c.name&&v===c.type);if(y&&(y.current&&delete y.current.selected,r(c.current,y.current)?c.type==="adhoc"&&!d(c,y)&&(P=!0):P=!0,!u)){const p=c;p.type==="adhoc"?p.filters=y.filters:(c.current=y.current,c.options=y.options)}}return P}function m(s,h){const u=(0,n.G4)(h,s),b=Object.values(u).reduce((g,P)=>g+P.length,0);return{changedSaveModel:s,initialSaveModel:h,diffs:u,diffCount:b,hasChanges:b>0}}},57109:(Q,I,e)=>{"use strict";e.d(I,{o:()=>s});var n=e(96540),a=e(16401),o=e(87978),r=e(8484),i=e(16678),f=e(32023),d=e(74730),l=e(41507),m=e(60656);class s extends a.Bs{constructor(){super(...arguments),this.onClose=()=>{(0,d.YQ)(this).closeModal()},this.onAddLibraryPanel=u=>{const b=(0,d.YQ)(this),g=b.state.body;if(!(g instanceof a.hy))throw new Error("Trying to add a library panel in a layout that is not SceneGridLayout");const P=f.b4.getNextPanelId(b),c=new m.F({title:"Panel Title",uid:u.uid,name:u.name,panelKey:(0,d.XA)(P)}),y=this.state.panelToReplaceRef?.resolve();if(y){const p=y.parent;if(!(p instanceof l.U))throw new Error("Trying to replace a panel that does not have a DashboardGridItem");p.setState({body:c})}else{const p=new l.U({height:d.sw,width:d.vm,x:0,y:0,body:c,key:`grid-item-${P}`});g.setState({children:[p,...g.state.children]})}this.onClose()}}static{this.Component=({model:u})=>{const b=(0,r.t)("library-panel.add-widget.title","Add panel from panel library");return n.createElement(o._,{title:b,onClose:u.onClose},n.createElement(i.j,{onClick:u.onAddLibraryPanel,variant:i.s.Tight,showPanelFilter:!0}))}}}},91309:(Q,I,e)=>{"use strict";e.d(I,{C:()=>S,S:()=>T});var n=e(65474),a=e(81160),o=e(52622),r=e(43585),i=e(14236),f=e(39070),d=e(32264),l=e(16401),m=e(82467),s=e(3169),h=e(10096),u=e(94954),b=e(79938),g=e(49498),P=e(55740),c=e(57220),y=e(23662),p=e(99140),v=e(31678),D=e(94822),E=e(74730);class S extends l.VE{constructor(A){super({isEnabled:!0,...A,isHidden:!0}),this.hasAlertRules=!0,this.topic=o.QR.AlertStates,this.handleError=x=>{const C=(0,s.gi)("AlertStatesDataLayer",(0,u.q)(x));(0,p.JD)((0,m.dx)(C))}}onEnable(){const A=l.jh.getTimeRange(this);this._timeRangeSub=A.subscribeToState(()=>{this.runWithTimeRange(A)})}onDisable(){this._timeRangeSub?.unsubscribe()}runLayer(){const A=l.jh.getTimeRange(this);this.runWithTimeRange(A)}async runWithTimeRange(A){const x=(0,E.YQ)(this),{uid:C,id:O}=x.state;if(this.querySub&&this.querySub.unsubscribe(),!this.canWork(A))return;const R=async()=>{const F=await(0,p.JD)(b.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:c.hY,dashboardUid:C}));if(F.error)throw new Error("Unexpected alert rules response.");return F.data},N=(0,n.H)(R()).pipe((0,a.T)(F=>(0,g.Kw)(F))).pipe((0,a.T)(F=>{this.hasAlertRules=!1;const K={};return F.forEach(B=>B.rules.forEach(w=>{if((0,y.Z8)(w)&&w.annotations&&w.annotations[P.YH.panelID]){this.hasAlertRules=!0;const U=Number(w.annotations[P.YH.panelID]),W=T(w.state);K[U]?W===r.O.Alerting&&K[U].state!==r.O.Alerting?K[U].state=r.O.Alerting:W===r.O.Pending&&K[U].state!==r.O.Alerting&&K[U].state!==r.O.Pending&&(K[U].state=r.O.Pending):K[U]={state:W,id:Object.keys(K).length,panelId:U,dashboardId:O}}})),Object.values(K)}));this.querySub=N.subscribe({next:F=>{const K=(0,i.Vc)(F);this.publishResults({state:f.Gu.Done,series:[{...K,meta:{...K.meta,dataTopic:o.QR.AlertStates}}],timeRange:A.state.value})},error:F=>{this.handleError(F),this.publishResults({state:f.Gu.Error,series:[],errors:[{message:(0,u.q)(F)}],timeRange:A.state.value})}})}canWork(A){const x=(0,E.YQ)(this),{uid:C}=x.state;return!(!C||d.$.publicDashboardAccessToken||A.state.value.raw.to!=="now"||this.hasAlertRules===!1||!(h.contextSrv.hasPermission(v.AccessControlAction.AlertingRuleRead)&&h.contextSrv.hasPermission(v.AccessControlAction.AlertingRuleExternalRead)))}}function T(M){return M===D.cF.Firing?r.O.Alerting:M===D.cF.Pending?r.O.Pending:r.O.OK}},38477:(Q,I,e)=>{"use strict";e.d(I,{g:()=>d});var n=e(43127),a=e(33948),o=e(52622),r=e(32264),i=e(16401),f=e(90569);class d extends i.tV.g{async resolveDataSource(m){return r.$.publicDashboardAccessToken?new f.X:super.resolveDataSource(m)}processEvents(m,s){if(r.$.publicDashboardAccessToken){const h={series:[],timeRange:(0,n.E2)(),state:s.state},u=(0,a.I)(s.events);return u.meta={...u.meta,dataTopic:o.QR.Annotations},h.annotations=[u],h}else return super.processEvents(m,s)}}},33278:(Q,I,e)=>{"use strict";e.d(I,{x:()=>v});var n=e(32196),a=e(96540),o=e(12470),r=e(13544),i=e(16401),f=e(40845),d=e(67061),l=e(90613),m=e(32264),s=e(15292);function h({panelEditor:S}){const T=S.state.vizManager,{panel:M,tableView:A}=T.useState(),x=m.$.panels[M.state.pluginId]?.skipDataQuery;return a.createElement(a.Fragment,null,!x&&a.createElement(s.K,{label:"Table view",showLabel:!0,id:"table-view",value:!!A,onClick:()=>T.toggleTableView(),"aria-label":"toggle-table-view","data-testid":r.Tp.components.PanelEditor.toggleTableView}))}var u=e(74730),b=e(80997),g=e(56034),P=e(52424),c=e(6923),y=e(4588);function p({links:S,uid:T}){return!S||!T?null:a.createElement(a.Fragment,null,S.map((M,A)=>{const x=(0,c.mQ)().getAnchorInfo(M),C=`${M.title}-$${A}`;if(M.type==="dashboards")return a.createElement(P.aK,{key:C,link:M,linkInfo:x,dashboardUID:T});const O=y.G[M.icon],R=a.createElement(P.Zx,{icon:O,href:(0,b.Jf)(x.href),target:M.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":r.Tp.components.DashboardLinks.link},x.title);return a.createElement("div",{key:C,"data-testid":r.Tp.components.DashboardLinks.container},M.tooltip?a.createElement(g.m,{content:x.tooltip},R):R)}))}class v extends i.Bs{constructor(T){super({variableControls:[],timePicker:T.timePicker??new i.KE({}),refreshPicker:T.refreshPicker??new i.WM({}),...T}),this._variableDependency=new i.Sh(this,{onAnyVariableChanged:this._onAnyVariableChanged.bind(this)}),this._urlSync=new i.So(this,{keys:["_dash.hideTimePicker","_dash.hideVariables","_dash.hideLinks"]})}static{this.Component=D}getUrlState(){return{"_dash.hideTimePicker":this.state.hideTimeControls?"true":void 0,"_dash.hideVariables":this.state.hideVariableControls?"true":void 0,"_dash.hideLinks":this.state.hideLinksControls?"true":void 0}}updateFromUrl(T){const M={};M.hideTimeControls=T["_dash.hideTimePicker"]==="true"||T["_dash.hideTimePicker"]===""||this.state.hideTimeControls,M.hideVariableControls=T["_dash.hideVariables"]==="true"||T["_dash.hideVariables"]===""||this.state.hideVariableControls,M.hideLinksControls=T["_dash.hideLinks"]==="true"||T["_dash.hideLinks"]===""||this.state.hideLinksControls,Object.entries(M).some(([A,x])=>x!==this.state[A])&&this.setState(M)}_onAnyVariableChanged(){(0,u.YQ)(this).state.links?.length>0&&this.forceRender()}hasControls(){const T=i.jh.getVariables(this)?.state.variables.some(R=>R.state.hide!==o.zL.hideVariable),M=i.jh.getDataLayers(this).some(R=>R.state.isEnabled&&!R.state.isHidden),A=(0,u.YQ)(this).state.links?.length>0,x=this.state.hideLinksControls||!A,C=this.state.hideVariableControls||!M&&!T,O=this.state.hideTimeControls;return!(C&&x&&O)}}function D({model:S}){const{variableControls:T,refreshPicker:M,timePicker:A,hideTimeControls:x,hideVariableControls:C,hideLinksControls:O}=S.useState(),R=(0,u.YQ)(S),{links:L,meta:N,editPanel:F}=R.useState(),K=(0,f.of)(E),B=location.search.includes("scene-debugger");return S.hasControls()?a.createElement("div",{"data-testid":r.Tp.pages.Dashboard.Controls,className:(0,n.cx)(K.controls,N.isEmbedded&&K.embedded)},a.createElement(d.B,{grow:1,wrap:"wrap"},!C&&T.map(w=>a.createElement(w.Component,{model:w,key:w.state.key})),a.createElement(l.a,{grow:1}),!O&&!F&&a.createElement(p,{links:L,uid:R.state.uid}),F&&a.createElement(h,{panelEditor:F})),!x&&a.createElement(d.B,{justifyContent:"flex-end"},a.createElement(A.Component,{model:A}),a.createElement(M.Component,{model:M})),B&&a.createElement(i.or,{scene:S,key:"scene-debugger"})):null}function E(S){return{controls:(0,n.css)({display:"flex",alignItems:"flex-start",flex:"100%",gap:S.spacing(1),flexDirection:"row",flexWrap:"nowrap",position:"sticky",top:0,background:S.colors.background.canvas,zIndex:S.zIndex.activePanel,width:"100%",marginLeft:"auto",[S.breakpoints.down("sm")]:{flexDirection:"column-reverse",alignItems:"stretch"}}),embedded:(0,n.css)({background:"unset",position:"unset"})}}},16279:(Q,I,e)=>{"use strict";e.d(I,{s:()=>o});var n=e(96540),a=e(16401);class o extends a.ps{constructor(i){super({...i,name:i.name??"Data layers",annotationLayers:i.annotationLayers??[]}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){return this._subs.add(this.subscribeToState((i,f)=>{i.annotationLayers!==f.annotationLayers&&(this.querySub?.unsubscribe(),this.subscribeToAllLayers(this.getAllLayers()))})),this.subscribeToAllLayers(this.getAllLayers()),()=>{this.querySub?.unsubscribe()}}addAnnotationLayer(i){this.setState({annotationLayers:[...this.state.annotationLayers,i]})}getAllLayers(){const i=[...this.state.annotationLayers];return this.state.alertStatesLayer&&i.push(this.state.alertStatesLayer),i}static{this.Component=({model:i})=>{const{annotationLayers:f}=i.useState();return n.createElement(n.Fragment,null,f.map(d=>n.createElement(d.Component,{model:d,key:d.state.key})))}}}},39820:(Q,I,e)=>{"use strict";e.d(I,{L:()=>i});var n=e(16401),a=e(14348),o=e(74730),r=e(60656);class i extends n.Bs{constructor(d){super(d),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){const d=this.parent;let l,m;if(!(d instanceof n.dt))throw new Error("DashboardDatasourceBehaviour must be attached to a SceneQueryRunner");if(d.state.datasource?.uid!==a.K)return;try{l=(0,o.YQ)(d)}catch{return}const s=d.state.queries.find(c=>c.panelId!==void 0);if(!s)return;const h=s.panelId,u=(0,o.XA)(h),b=(0,o.vL)(l,u);if(!(b instanceof n.Eb))return;const g=(0,o.un)(b);let P;if(g)this.prevRequestId&&this.prevRequestId!==g.state.data?.request?.requestId&&d.runQueries();else if(b.parent instanceof r.F)b.parent.isActive||(P=b.parent.activate()),m=b.parent.subscribeToState((c,y)=>{this.handleLibPanelStateUpdates(c,y,d)});else throw new Error("Could not find SceneQueryRunner for panel");return()=>{this.prevRequestId=g?.state.data?.request?.requestId,m&&m.unsubscribe(),P&&P()}}handleLibPanelStateUpdates(d,l,m){if(d.panel&&d.panel!==l.panel){if(!((0,o.un)(d.panel)instanceof n.dt))throw new Error("Could not find SceneQueryRunner for panel");m.runQueries()}}}},41507:(Q,I,e)=>{"use strict";e.d(I,{U:()=>b});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(32264),f=e(16401),d=e(15054),l=e(74730),m=e(57109),s=e(60656),h=e(7196),u=e(30195);class b extends f.Bs{constructor(y){super(y),this._variableDependency=new f.Sh(this,{variableNames:this.state.variableName?[this.state.variableName]:[],onVariableUpdateCompleted:this._onVariableUpdateCompleted.bind(this)}),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){return this.state.variableName&&(this._subs.add(this.subscribeToState((y,p)=>this._handleGridResize(y,p))),this._performRepeat()),this._subs.add(this.subscribeToState((y,p)=>{y.body!==p.body&&y.body instanceof s.F&&this.setupLibraryPanelChangeSubscription(y.body)})),this.state.body instanceof s.F&&this.setupLibraryPanelChangeSubscription(this.state.body),()=>{this._libPanelSubscription?.unsubscribe(),this._libPanelSubscription=void 0}}setupLibraryPanelChangeSubscription(y){this._libPanelSubscription&&(this._libPanelSubscription.unsubscribe(),this._libPanelSubscription=void 0),this._libPanelSubscription=y.subscribeToState(p=>{p._loadedPanel?.model.repeat&&(this._variableDependency.setVariableNames([p._loadedPanel.model.repeat]),this.setState({variableName:p._loadedPanel.model.repeat,repeatDirection:p._loadedPanel.model.repeatDirection,maxPerRow:p._loadedPanel.model.maxPerRow}),this._performRepeat())})}_onVariableUpdateCompleted(){this.state.variableName&&this._performRepeat()}_handleGridResize(y,p){const v=this.state.repeatedPanels?.length??1,D={};if(y.height!==p.height){if(this.getRepeatDirection()==="v"){const E=Math.ceil(y.height/v);D.itemHeight=E}else{const E=Math.ceil(v/this.getMaxPerRow());D.itemHeight=Math.ceil(y.height/E)}D.itemHeight!==this.state.itemHeight&&this.setState(D)}}_performRepeat(){if(this.state.body instanceof m.o||!this.state.variableName||this._variableDependency.hasDependencyInLoadingState())return;const y=f.jh.lookupVariable(this.state.variableName,this)??new f.yP({name:"_____default_sys_repeat_var_____",options:[],value:"",text:"",query:"A"});if(!(y instanceof f.n8)){console.error("DashboardGridItem: Variable is not a MultiValueVariable");return}const{values:p,texts:v}=(0,l.a7)(y);if((0,a.isEqual)(this._prevRepeatValues,p))return;this._prevRepeatValues=p;const D=this.state.body instanceof s.F?this.state.body.state.panel:this.state.body,E=[];for(let C=0;C<p.length;C++){const O={$variables:new f.Pj({variables:[new f.xc({name:y.state.name,value:p[C],text:String(v[C])})]}),key:`${D.state.key}-clone-${C}`};C>0&&(O.menu=new f.Lw({$behaviors:[h.t0]}));const R=D.clone(O);E.push(R)}const S=this.getRepeatDirection(),T={repeatedPanels:E},M=this.state.itemHeight??10,A=this.state.height,x=this.getMaxPerRow();if(S==="h"){const C=Math.ceil(E.length/x);T.height=C*M}else T.height=E.length*M;if(this.setState(T),A!==this.state.height){const C=f.jh.getLayout(this);C instanceof f.hy&&C.forceRender()}this.publishEvent(new u.d({source:this}),!0)}getMaxPerRow(){return this.state.maxPerRow??4}getRepeatDirection(){return this.state.repeatDirection==="v"?"v":"h"}getClassName(){return this.state.variableName?"panel-repeater-grid-item":""}isRepeated(){return this.state.variableName!==void 0}static{this.Component=({model:y})=>{const{repeatedPanels:p,itemHeight:v,variableName:D,body:E}=y.useState(),S=p?.length??0,T=g(y.getRepeatDirection(),S,y.getMaxPerRow(),v??10);if(!D){if(E instanceof f.Eb)return r.createElement(E.Component,{model:E,key:E.state.key});if(E instanceof s.F)return r.createElement(E.Component,{model:E,key:E.state.key});if(E instanceof m.o)return r.createElement(E.Component,{model:E,key:E.state.key})}return p?r.createElement("div",{className:T},p.map(M=>r.createElement("div",{className:P,key:M.state.key},r.createElement(M.Component,{model:M,key:M.state.key})))):null}}}function g(c,y,p,v){return(0,r.useMemo)(()=>{const D=i.$.theme2,E=v*d.sD*y+(y-1)*d.dU;if(c==="h"){const S=Math.ceil(y/p),T=Math.min(y,p);return(0,n.css)({display:"grid",height:"100%",width:"100%",gridTemplateColumns:`repeat(${T}, 1fr)`,gridTemplateRows:`repeat(${S}, 1fr)`,gridColumnGap:D.spacing(1),gridRowGap:D.spacing(1),[D.breakpoints.down("md")]:{display:"flex",flexDirection:"column",height:E}})}return(0,n.css)({display:"flex",height:"100%",width:"100%",flexDirection:"column",gap:D.spacing(1),[D.breakpoints.down("md")]:{height:E}})},[c,y,p,v])}const P=(0,n.css)({display:"flex",flexGrow:1,position:"relative"})},24283:(Q,I,e)=>{"use strict";e.d(I,{H$:()=>Ya,vk:()=>cs});var n=e(71733),a=e(26272),o=e(41987),r=e(32264),i=e(12131),f=e(16401),d=e(28138),l=e(15054),m=e(17422),s=e(33390),h=e(14792),u=e(34214),b=e(6473),g=e(11230),P=e(80484),c=e(28444),y=e(13530),p=e(96540),v=e(63021),D=e(40675),E=e(87978),S=e(54943),T=e(76459),M=e.n(T),A=e(49785),x=e(13544),C=e(55852),O=e(42418),R=e(67061),L=e(88575),N=e(10354),F=e(21744),K=e(15292),B=e(90613),w=e(60029),U=e(36607),W=e(71500),V=e(17172);function _(Ge){return(0,V.NF)(Ge)&&Ge.data&&Ge.data.status==="version-mismatch"}function H(Ge){return(0,V.NF)(Ge)&&Ge.data&&Ge.data.status==="name-exists"}function G(Ge){return(0,V.NF)(Ge)&&Ge.data&&Ge.data.status==="plugin-dashboard"}function j({cancelButton:Ge,saveButton:Re}){return p.createElement(O.F,{title:"Name already exists",severity:"error"},p.createElement("p",null,"A dashboard with the same name in selected folder already exists. Would you still like to save this dashboard?"),p.createElement(B.a,{paddingTop:2},p.createElement(R.B,{alignItems:"center"},Ge,Re(!0))))}function Y({overwrite:Ge,isLoading:Re,isValid:qe,onSave:ut}){return p.createElement(C.$n,{disabled:!qe||Re,icon:Re?"spinner":void 0,onClick:()=>ut(Ge),variant:Ge?"destructive":"primary","data-testid":x.Tp.components.Drawer.DashboardSaveDrawer.saveButton},Re?"Saving...":Ge?"Save and overwrite":"Save")}var oe=e(41053),se=e(14110),ne=e(3169),ee=e(91219),Z=e(55314),z=e(31678),q=e(36974);function ie(Ge=!1){const Re=(0,z.useDispatch)(),qe=(0,ne._2)(),[ut]=(0,Z.e8)(),[Ft,on]=(0,oe.A)(async(sn,Ln,qn)=>{{const na=await ut({dashboard:Ln,folderUid:qn.folderUid,message:qn.message,overwrite:qn.overwrite,showErrorAlert:!1});if("error"in na)throw na.error;const Sa=na.data;sn.saveCompleted(Ln,Sa,qn.folderUid),d.A.publish(new c.Eu),qe.success("Dashboard saved"),(0,q.ko)(Sa.uid),Ge?(0,se.rR)("grafana_dashboard_copied",{name:Ln.title,url:Sa.url}):(0,se.rR)(`grafana_dashboard_${Sa.uid?"saved":"created"}`,{name:Ln.title,url:Sa.url});const ka=i.Ny.getLocation(),Da=n.I.stripBaseFromUrl(Sa.url);return Da!==ka.pathname&&setTimeout(()=>{sn.stopUrlSync(),i.Ny.push({pathname:Da,search:ka.search}),sn.startUrlSync()}),sn.state.meta.isStarred&&Re((0,ee.TU)({id:Sa.uid,title:sn.state.title,url:Da})),na.data}},[Re,qe]);return{state:Ft,onSaveDashboard:on}}function de({dashboard:Ge,changeInfo:Re}){const{changedSaveModel:qe}=Re,{register:ut,handleSubmit:Ft,setValue:on,formState:sn,getValues:Ln,watch:qn}=(0,A.mN)({mode:"onBlur",defaultValues:{title:Re.isNew?qe.title:`${qe.title} Copy`,description:qe.description??"",folder:{uid:Ge.state.meta.folderUid,title:Ge.state.meta.folderTitle},copyTags:!1}}),{errors:na,isValid:Sa,defaultValues:ka}=sn,Da=qn(),{state:ds,onSaveDashboard:Xa}=ie(!1),qs=async Fa=>{const Na=Ln(),Is=he(qe,Na,Re.isNew);(await Xa(Ge,Is,{overwrite:Fa,folderUid:Na.folder.uid})).status==="success"&&Ge.closeModal()},Cs=p.createElement(C.$n,{variant:"secondary",onClick:()=>Ge.closeModal(),fill:"outline"},"Cancel"),Ss=Fa=>p.createElement(Y,{isValid:Sa,isLoading:ds.loading,onSave:qs,overwrite:Fa});function fa(Fa){return H(Fa)?p.createElement(j,{cancelButton:Cs,saveButton:Ss}):p.createElement(p.Fragment,null,Fa&&p.createElement(O.F,{title:"Failed to save dashboard",severity:"error"},p.createElement("p",null,Fa.message)),p.createElement(R.B,{alignItems:"center"},Cs,Ss(!1)))}return p.createElement("form",{onSubmit:Ft(()=>qs(!1))},p.createElement(L.D,{label:p.createElement(ue,{dashboard:qe,onChange:on}),invalid:!!na.title,error:na.title?.message},p.createElement(N.p,{...ut("title",{required:"Required",validate:Se}),"aria-label":"Save dashboard title field","data-testid":x.Tp.components.Drawer.DashboardSaveDrawer.saveAsTitleInput,onChange:M()(async Fa=>{on("title",Fa.target.value,{shouldValidate:!0})},400)})),p.createElement(L.D,{label:p.createElement(fe,{dashboard:qe,onChange:on}),invalid:!!na.description,error:na.description?.message},p.createElement(F.f,{...ut("description",{required:!1}),"aria-label":"Save dashboard description field",autoFocus:!0})),p.createElement(L.D,{label:"Folder"},p.createElement(U.d,{onChange:(Fa,Na)=>on("folder",{uid:Fa,title:Na}),value:Da.folder?.uid,initialTitle:ka.folder.title,dashboardId:qe.id??void 0,enableCreateNew:!0})),!Re.isNew&&p.createElement(L.D,{label:"Copy tags"},p.createElement(K.d,{...ut("copyTags")})),p.createElement(B.a,{paddingTop:2},fa(ds.error)))}function ue(Ge){return p.createElement(R.B,{justifyContent:"space-between"},p.createElement(w.J,{htmlFor:"description"},"Title"))}function fe(Ge){return p.createElement(R.B,{justifyContent:"space-between"},p.createElement(w.J,{htmlFor:"description"},"Description"))}async function Se(Ge,Re){if(Ge===Re.folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await W.P.validateNewDashboardName(Re.folder.uid??"general",Ge),!0}catch(qe){return qe instanceof Error?qe.message:"Dashboard name is invalid"}}function he(Ge,Re,qe){return{...Ge,id:null,uid:"",title:Re.title,description:Re.description,tags:qe||Re.copyTags?Ge.tags:[]}}var ce=e(10880);function me({dashboard:Ge,drawer:Re,changeInfo:qe}){const{changedSaveModel:ut,hasChanges:Ft}=qe,{state:on,onSaveDashboard:sn}=ie(!1),[Ln,qn]=(0,p.useState)({folderUid:Ge.state.meta.folderUid}),na=async ds=>{(await sn(Ge,ut,{...Ln,overwrite:ds})).status==="success"&&(Ge.closeModal(),Re.state.onSaveSuccess?.())},Sa=p.createElement(C.$n,{variant:"secondary",onClick:()=>Ge.closeModal(),fill:"outline"},"Cancel"),ka=ds=>p.createElement(Y,{isValid:Ft,isLoading:on.loading,onSave:na,overwrite:ds});function Da(ds){return _(ds)?p.createElement(O.F,{title:"Someone else has updated this dashboard",severity:"error"},p.createElement("p",null,"Would you still like to save this dashboard?"),p.createElement(B.a,{paddingTop:2},p.createElement(R.B,{alignItems:"center"},Sa,ka(!0)))):H(ds)?p.createElement(j,{cancelButton:Sa,saveButton:ka}):G(ds)?p.createElement(O.F,{title:"Plugin dashboard",severity:"error"},p.createElement("p",null,"Your changes will be lost when you update the plugin. Use ",p.createElement("strong",null,"Save As")," to create custom version."),p.createElement(B.a,{paddingTop:2},p.createElement(R.B,{alignItems:"center"},Sa,ka(!0)))):p.createElement(p.Fragment,null,ds&&p.createElement(O.F,{title:"Failed to save dashboard",severity:"error"},p.createElement("p",null,ds.message)),p.createElement(R.B,{alignItems:"center"},Sa,ka(!1),!Ft&&p.createElement("div",null,"No changes to save")))}return p.createElement(R.B,{gap:2,direction:"column"},p.createElement(pe,{drawer:Re,changeInfo:qe}),p.createElement(L.D,{label:"Message"},p.createElement(F.f,{"aria-label":"message",value:Ln.message??"",onChange:ds=>{qn({...Ln,message:ds.currentTarget.value})},placeholder:"Add a note to describe your changes (optional).",autoFocus:!0,rows:5})),Da(on.error))}function pe({drawer:Ge,changeInfo:Re}){const{saveVariables:qe=!1,saveTimeRange:ut=!1,saveRefresh:Ft=!1}=Ge.useState(),{hasTimeChanges:on,hasVariableValueChanges:sn,hasRefreshChange:Ln}=Re;return p.createElement(R.B,{direction:"column",alignItems:"flex-start"},on&&p.createElement(ce.S,{id:"save-timerange",checked:ut,onChange:Ge.onToggleSaveTimeRange,label:"Update default time range",description:"Will make current time range the new default","data-testid":x.Tp.pages.SaveDashboardModal.saveTimerange}),Ln&&p.createElement(ce.S,{id:"save-refresh",label:"Update default refresh value",description:"Will make the current refresh the new default",checked:Ft,onChange:Ge.onToggleSaveRefresh,"data-testid":x.Tp.pages.SaveDashboardModal.saveRefresh}),sn&&p.createElement(ce.S,{id:"save-variables",label:"Update default variable values",description:"Will make the current values the new default",checked:qe,onChange:Ge.onToggleSaveVariables,"data-testid":x.Tp.pages.SaveDashboardModal.saveVariables}))}var ye=e(32196),Pe=e(4213),Ie=e.n(Pe),Oe=e(70713),Ne=e(32372),We=e(10534);function Ae({dashboard:Ge,drawer:Re,changeInfo:qe}){const ut=(0,p.useMemo)(()=>JSON.stringify(qe.changedSaveModel,null,2),[qe]),Ft=(0,p.useCallback)(()=>{const on=new Blob([ut],{type:"application/json;charset=utf-8"});(0,Pe.saveAs)(on,qe.changedSaveModel.title+"-"+new Date().getTime()+".json")},[qe.changedSaveModel,ut]);return p.createElement("div",{className:Ue.container},p.createElement(R.B,{direction:"column",gap:2,grow:1},p.createElement("div",null,"This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",p.createElement("br",null),p.createElement("i",null,"See"," ",p.createElement("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer"},"documentation")," ","for more information about provisioning."),p.createElement("br",null)," ",p.createElement("br",null),p.createElement("strong",null,"File path: ")," ",Ge.state.meta.provisionedExternalId),p.createElement(pe,{drawer:Re,changeInfo:qe}),p.createElement("div",{className:Ue.json},p.createElement(Oe.Ay,{disableWidth:!0},({height:on})=>p.createElement(Ne.B,{width:"100%",height:on,language:"json",showLineNumbers:!0,showMiniMap:ut.length>100,value:ut,readOnly:!0}))),p.createElement(B.a,{paddingTop:2},p.createElement(R.B,{gap:2},p.createElement(C.$n,{variant:"secondary",onClick:Re.onClose,fill:"outline"},"Cancel"),p.createElement(We.b,{icon:"copy",getText:()=>ut},"Copy JSON to clipboard"),p.createElement(C.$n,{type:"submit",onClick:Ft},"Save JSON to file")))))}const Ue={container:(0,ye.css)({height:"100%",display:"flex"}),json:(0,ye.css)({flexGrow:1,maxHeight:"800px"})};var Me=e(20455),$e=e(45429);function ke(Ge,Re,qe,ut){const Ft=(0,$e.Yy)(Ge.getInitialSaveModel(),(0,Me.Uy)(Ge),Re,qe,ut),on=Ge.getInitialState()?.meta.folderUid!==Ge.state.meta.folderUid;return{...Ft,hasFolderChanges:on,hasChanges:Ft.hasChanges||on}}class Ze extends f.Bs{constructor(){super(...arguments),this.onClose=()=>{this.state.dashboardRef.resolve().setState({overlay:void 0})},this.onToggleSaveTimeRange=()=>{this.setState({saveTimeRange:!this.state.saveTimeRange})},this.onToggleSaveVariables=()=>{this.setState({saveVariables:!this.state.saveVariables})},this.onToggleSaveRefresh=()=>{this.setState({saveRefresh:!this.state.saveRefresh})}}static{this.Component=({model:Re})=>{const{showDiff:qe,saveAsCopy:ut,saveTimeRange:Ft,saveVariables:on,saveRefresh:sn}=Re.useState(),Ln=ke(Re.state.dashboardRef.resolve(),Ft,on,sn),{changedSaveModel:qn,initialSaveModel:na,diffs:Sa,diffCount:ka,hasFolderChanges:Da}=Ln,ds=ka+(Da?1:0),Xa=Re.state.dashboardRef.resolve(),{meta:qs}=Xa.useState(),{provisioned:Cs,folderTitle:Ss}=qs,fa=p.createElement(v.U,null,p.createElement(D.o,{label:"Details",active:!qe,onChangeTab:()=>Re.setState({showDiff:!1})}),ds>0&&p.createElement(D.o,{label:"Changes",active:qe,onChangeTab:()=>Re.setState({showDiff:!0}),counter:ds}));let Fa="Save dashboard";ut?Fa="Save dashboard copy":Cs&&(Fa="Provisioned dashboard");const Na=()=>qe?p.createElement(S.l,{diff:Sa,oldValue:na,newValue:qn,hasFolderChanges:Da,oldFolder:Xa.getInitialState()?.meta.folderTitle,newFolder:Ss}):ut||Ln.isNew?p.createElement(de,{dashboard:Xa,changeInfo:Ln}):Cs?p.createElement(Ae,{dashboard:Xa,changeInfo:Ln,drawer:Re}):p.createElement(me,{dashboard:Xa,changeInfo:Ln,drawer:Re});return p.createElement(E._,{title:Fa,subtitle:Xa.state.title,onClose:Re.onClose,tabs:fa},Na())}}}var ot=e(85445),xt=e(57714),ct=e(64423),ft=e(18226),Le=e(94624),re=e(72724),X=e(3591),le=e(41507),be=e(13989),De=e(53543),Te=e(74730);class we{constructor(Re){this._scene=Re,this.events=new ft.o,this._subs=new ct.yU;const qe=f.jh.getTimeRange(Re);this.formatDate=this.formatDate.bind(this),this._subs.add(qe.subscribeToState((ut,Ft)=>{ut.value!==Ft.value&&this.events.publish(new X.sR(ut.value))}))}get id(){return this._scene.state.id??null}get uid(){return this._scene.state.uid??null}get title(){return this._scene.state.title}get description(){return this._scene.state.description}get editable(){return this._scene.state.editable}get graphTooltip(){return this._getSyncMode()}get timepicker(){return{refresh_intervals:this._scene.state.controls.state.refreshPicker.state.intervals,hidden:this._scene.state.controls.state.hideTimeControls??!1}}get timezone(){return this.getTimezone()}get weekStart(){return f.jh.getTimeRange(this._scene).state.weekStart}get tags(){return this._scene.state.tags}get links(){return this._scene.state.links}get meta(){return this._scene.state.meta}get time(){const Re=f.jh.getTimeRange(this._scene);return{from:Re.state.from,to:Re.state.to}}get panels(){return Ke(this._scene,qe=>qe instanceof f.Eb).map(qe=>new De.R(qe))}get annotations(){const Re={list:[]};return this._scene.state.$data instanceof f.kh&&(Re.list=(0,be.O)(this._scene.state.$data.state.layers)),Re}getTimezone(){return f.jh.getTimeRange(this._scene).getTimeZone()}sharedTooltipModeEnabled(){return this._getSyncMode()>0}sharedCrosshairModeOnly(){return this._getSyncMode()===1}_getSyncMode(){if(this._scene.state.$behaviors){for(const Re of this._scene.state.$behaviors)if(Re instanceof f.Gg.K2)return Re.state.sync}return Le.y.Off}otherPanelInFullscreen(Re){return!1}formatDate(Re,qe){return(0,re.LE)(Re,{format:qe,timeZone:this.getTimezone()})}getPanelById(Re){const qe=(0,Te.vL)(this._scene,(0,Te.XA)(Re));return qe?new De.R(qe):null}removePanel(Re){const qe=(0,Te.vL)(this._scene,(0,Te.XA)(Re.id));if(!qe){console.error("Trying to remove a panel that was not found in scene",Re);return}const ut=qe.parent;if(!(ut instanceof le.U)){console.error("Trying to remove a panel that is not wrapped in DashboardGridItem");return}const Ft=f.jh.getLayout(qe);if(!(Ft instanceof f.hy)){console.error("Trying to remove a panel in a layout that is not SceneGridLayout ");return}if(Ft===ut.parent&&Ft.setState({children:Ft.state.children.filter(on=>on!==ut)}),ut.parent instanceof f.tI){const on=Ft.clone({children:Ft.state.children.filter(sn=>sn!==ut)});Ft.parent instanceof f.hy&&Ft.parent.setState({children:Ft.parent.state.children.map(sn=>sn===Ft?on:sn)})}}canEditAnnotations(Re){return this._scene.canEditDashboard()?Re?!!this._scene.state.meta.annotationsPermissions?.dashboard.canEdit:!!this._scene.state.meta.annotationsPermissions?.organization.canEdit:!1}panelInitialized(){}destroy(){this.events.removeAllListeners(),this._subs.unsubscribe()}hasUnsavedChanges(){return this._scene.state.isDirty}}function Ke(Ge,Re){let qe=[];return Ge.forEachChild(ut=>{Re(ut)?qe.push(ut):qe=qe.concat(Ke(ut,Re))}),qe}var Ve=e(32023);function ht(Ge){let Re=5381;for(let qe=0;qe<Ge.length;qe++)Re=Re*33^Ge.charCodeAt(qe);return Re>>>0}var gt=e(11982),bt=e(57109),St=e(24180),Je=e(64388),rt=e(40845),Rt=e(40276),_t=e(67608),nn=e(68064),Kt=e(31807);function en({model:Ge}){const{controls:Re,overlay:qe,editview:ut,editPanel:Ft,isEmpty:on,scopes:sn}=Ge.useState(),{isExpanded:Ln}=sn?.useState()??{},qn=(0,rt.of)(Qt),na=(0,St.zy)(),Sa=(0,z.useSelector)(Ss=>Ss.navIndex),ka=Ge.getPageNav(na,Sa),Da=Ge.getBodyToRender(),ds=(0,m.tc)(Sa,"dashboards/browse"),Xa=Re?.hasControls();if(ut)return p.createElement(p.Fragment,null,p.createElement(ut.Component,{model:ut}),qe&&p.createElement(qe.Component,{model:qe}));const qs=p.createElement(nn.A,{dashboard:Ge,canCreate:!!Ge.state.meta.canEdit}),Cs=p.createElement("div",{className:(0,ye.cx)(qn.body,!Xa&&qn.bodyWithoutControls)},p.createElement(Da.Component,{model:Da}));return p.createElement(_t.Y,{navModel:ds,pageNav:ka,layout:Je.k.Custom},Ft&&p.createElement(Ft.Component,{model:Ft}),!Ft&&p.createElement("div",{className:(0,ye.cx)(qn.pageContainer,Xa&&!sn&&qn.pageContainerWithControls,sn&&qn.pageContainerWithScopes,sn&&Ln&&qn.pageContainerWithScopesExpanded)},sn&&p.createElement(sn.Component,{model:sn}),p.createElement(Kt.c,{dashboard:Ge}),Re&&Xa&&p.createElement("div",{className:(0,ye.cx)(qn.controlsWrapper,sn&&!Ln&&qn.controlsWrapperWithScopes)},p.createElement(Re.Component,{model:Re})),p.createElement(Rt.E,{divId:"page-scrollbar",autoHeightMin:"100%",className:qn.scrollbarContainer,testId:x.Tp.pages.Dashboard.DashNav.scrollContainer},p.createElement("div",{className:(0,ye.cx)(qn.canvasContent)},p.createElement(p.Fragment,null,on&&qs),Cs))),qe&&p.createElement(qe.Component,{model:qe}))}function Qt(Ge){return{pageContainer:(0,ye.css)({display:"grid",gridTemplateAreas:`
        "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",height:"100%"}),pageContainerWithControls:(0,ye.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),pageContainerWithScopes:(0,ye.css)({gridTemplateAreas:`
        "scopes controls"
        "panels panels"`,gridTemplateColumns:`${Ge.spacing(32)} 1fr`,gridTemplateRows:"auto 1fr"}),pageContainerWithScopesExpanded:(0,ye.css)({gridTemplateAreas:`
        "scopes controls"
        "scopes panels"`}),scrollbarContainer:(0,ye.css)({gridArea:"panels"}),controlsWrapper:(0,ye.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls",padding:Ge.spacing(2),":empty":{display:"none"}}),controlsWrapperWithScopes:(0,ye.css)({padding:Ge.spacing(2,2,2,0)}),canvasContent:(0,ye.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:Ge.spacing(0,2),flexBasis:"100%",flexGrow:1}),body:(0,ye.css)({label:"body",flexGrow:1,display:"flex",gap:"8px",paddingBottom:Ge.spacing(2),boxSizing:"border-box"}),bodyWithoutControls:(0,ye.css)({paddingTop:Ge.spacing(2)})}}var An=e(65123),un=e(54612),fn=e(16560),Tt=e(29678),$t=e(14578),Yt=e(62930),Cn=e(21594),Tn=e(16233),vn=e(83195),Kn=e(2619),Yn=e(2543),nt=e(89667),yt=e(52622),Vt=e(39070),je=e(68706),tt=e(60656),Dt=e(41524);function Ot(Ge){const Re=[];if(Ge?.series)for(const qe of Ge.series)Re.push((0,nt.Nw)(qe));if(Ge?.annotations)for(const qe of Ge.annotations){const ut=(0,nt.Nw)(qe);ut.schema?.meta||(ut.schema.meta={}),ut.schema.meta.dataTopic=yt.QR.Annotations,Re.push(ut)}return Re}function Lt(Ge,Re){const qe={panelType:Ge.state.pluginId,datasource:"??"},ut=r.$.buildInfo.versionString;let Ft=`| Key | Value |
|--|--|
| Panel | ${qe.panelType} @ ${Ge.state.pluginVersion??ut} |
| Grafana | ${ut} // ${r.$.buildInfo.edition} |
`;return Re&&(Ft+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+Re+"\n```\n</details>"),Ft}async function Gt(Ge,Re,qe){let ut={type:""};const Ft=Ge.parent instanceof tt.F,on=Ft?Ge.parent.parent:Ge.parent,sn=Ge.getRoot();if(Ft)ut={...(0,Me.ZB)(on),...(0,Me.Z6)(Ge)};else if(sn.state.editPanel){const Ss=sn.state.editPanel.state.vizManager.state.sourcePanel.resolve(),fa=Ss.parent instanceof tt.F?Ss.parent.parent:Ss.parent;fa instanceof le.U&&(ut={...(0,Me.ZB)(fa),...(0,Me.Z6)(sn.state.editPanel.state.vizManager.state.panel.clone())})}else ut=(0,Me.ZB)(on);const Ln=(0,Yn.cloneDeep)(Jt),qn={panelType:Ge.state.pluginId,datasource:"??"},na=(0,Te.un)(Ge);if(!na.state.data)return;const Sa=na.state.data,ka=na?.state.datasource,Da=(0,Dt.W)(Ot(Sa),Re),ds=r.$.buildInfo.versionString,Xa=na.state.queries??[],qs=Sa.annotations?Sa.annotations.reduce((Ss,fa)=>fa.length+Ss,0):0,Cs=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${qn.panelType} @ ${ut.pluginVersion??ds}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${Xa.map(Ss=>{const fa=Ss.datasource??ka;return`${Ss.refId}[${fa?.type}]`}).join(", ")}</td>
    </tr>
    ${hn(ut)}
    ${mt(Sa,Da)}
    ${Bt(Sa)}
    <tr>
      <th>Grafana</th>
      <td>${ds} // ${r.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(Ln.panels[0]={...ut,...Ln.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:je.nj.Snapshot,snapshot:Da}]},delete Ln.panels[0].libraryPanel,ut.transformations?.length){const Ss=Ln.panels[Ln.panels.length-1];Ss.title=Ss.title+" (after transformations)";const fa=(0,Yn.cloneDeep)(Ss);fa.id=100,fa.title="Data (before transformations)",fa.gridPos.w=24,fa.targets[0].withTransforms=!1,Ln.panels.push(fa)}return qs>0&&Ln.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:yt.QR.Annotations,refId:"A"}]}),Ln.panels[1].options.content=Cs,Ln.panels[2].options.content=JSON.stringify(ut,null,2),Ln.title=`Debug: ${ut.title} // ${(0,re.LE)(new Date)}`,Ln.tags=["debug",`debug-${qn.panelType}`],Ln.time={from:qe.from.toISOString(),to:qe.to.toISOString()},Ln}function hn(Ge){return Ge.transformations?`<tr>
      <th>Transform</th>
      <td>${Ge.transformations.map(Re=>Re.id).join(", ")}</td>
  </tr>`:""}function mt(Ge,Re){let qe=Ge.series.length??0,ut=0,Ft=0;for(const on of Ge.series)ut+=on.fields.length,Ft+=on.length;return`<tr><th>Data</th><td>${Ge.state!==Vt.Gu.Done?Ge.state:""} ${qe} frames, ${ut} fields, ${Ft} rows </td></tr>`}function Bt(Ge){return Ge.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${Ge.annotations.reduce((Re,qe)=>qe.length+Re,0)}</td>
</tr>`:""}const Jt={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37};var Rn=(Ge=>(Ge[Ge.Support=0]="Support",Ge[Ge.Data=1]="Data",Ge))(Rn||{}),Mt=(Ge=>(Ge[Ge.PanelSnapshot=0]="PanelSnapshot",Ge[Ge.GithubComment=1]="GithubComment",Ge))(Mt||{});class wt extends Kn.Q{constructor(Re){super({panel:Re,panelTitle:f.jh.interpolate(Re,Re.state.title,{},"text"),currentTab:0,showMessage:1,snapshotText:"",markdownText:"",randomize:{},snapshotUpdate:0,options:[{label:"GitHub comment",description:"Copy and paste this message into a GitHub issue or comment",value:1},{label:"Panel support snapshot",description:"Dashboard JSON used to help troubleshoot visualization issues",value:0}]}),this.onCurrentTabChange=qe=>{this.setState({currentTab:qe})},this.onShowMessageChange=qe=>{this.setState({showMessage:qe.value})},this.onGetMarkdownForClipboard=()=>{const{markdownText:qe}=this.state,ut=Math.pow(1024,2)*1.5;return qe.length>ut?(this.setState({error:{title:"Copy to clipboard failed",message:"Snapshot is too large, consider download and attaching a file instead"}}),""):qe},this.onDownloadDashboard=()=>{const{snapshotText:qe,panelTitle:ut}=this.state,Ft=new Blob([qe],{type:"text/plain"}),on=`debug-${ut}-${(0,re.LE)(new Date)}.json.txt`;Ie()(Ft,on)},this.onSetSnapshotText=qe=>{this.setState({snapshotText:qe})},this.onToggleRandomize=qe=>{const{randomize:ut}=this.state;this.setState({randomize:{...ut,[qe]:!ut[qe]}})}}async buildDebugDashboard(){const{panel:Re,randomize:qe,snapshotUpdate:ut}=this.state,Ft=await Gt(Re,qe,f.jh.getTimeRange(Re).state.value),on=JSON.stringify(Ft,null,2),sn=Lt(Re,on),Ln=(0,vn.cN)((0,vn.j_)("bytes")(on?.length??0));let qn;if(Ft)try{qn=(0,ot.wM)({dashboard:Ft,meta:{isEmbedded:!0}}).state.body}catch(na){console.log("Error creating scene:",na)}this.setState({snapshot:Ft,snapshotText:on,markdownText:sn,snapshotSize:Ln,snapshotUpdate:ut+1,scene:qn})}}function Ht({panel:Ge,onClose:Re}){const qe=(0,rt.of)(tn),ut=(0,p.useMemo)(()=>new wt(Ge),[Ge]),Ft=Ge.getPlugin(),{currentTab:on,loading:sn,error:Ln,options:qn,showMessage:na,snapshotSize:Sa,markdownText:ka,snapshotText:Da,randomize:ds,panelTitle:Xa,scene:qs}=ut.useState();if((0,p.useEffect)(()=>{ut.buildDebugDashboard()},[ut,Ft,ds]),!Ft)return null;const Cs=[{label:"Snapshot",value:Rn.Support},{label:"Data",value:Rn.Data}],Ss=r.$.supportBundlesEnabled&&Tn.TP.hasPermission(z.AccessControlAction.ActionSupportBundlesCreate);return p.createElement(E._,{title:"Get help with this panel",size:"lg",onClose:Re,subtitle:p.createElement(R.B,{direction:"column",gap:1},p.createElement(R.B,{direction:"row",gap:1},p.createElement(Tt.y,{featureState:o.Ay.beta}),p.createElement("a",{href:"https://grafana.com/docs/grafana/latest/troubleshooting/",target:"blank",className:"external-link",rel:"noopener noreferrer"},"Troubleshooting docs ",p.createElement($t.I,{name:"external-link-alt"}))),p.createElement("span",{className:"muted"},"To request troubleshooting help, send a snapshot of this panel to Grafana Labs Technical Support. The snapshot contains query response data and panel settings."),Ss&&p.createElement("span",{className:"muted"},"You can also retrieve a support bundle containing information concerning your Grafana instance and configured datasources in the ",p.createElement("a",{href:"/support-bundles"},"support bundles section"),".")),tabs:p.createElement(v.U,null,Cs.map((fa,Fa)=>p.createElement(D.o,{key:`${fa.value}-${Fa}`,label:fa.label,active:fa.value===on,onChangeTab:()=>ut.onCurrentTabChange(fa.value)})))},sn&&p.createElement(Yt.y,null),Ln&&p.createElement(O.F,{title:Ln.title},Ln.message),on===Rn.Data&&p.createElement("div",{className:qe.code},p.createElement("div",{className:qe.opts},p.createElement(L.D,{label:"Template",className:qe.field},p.createElement(Cn.l6,{options:qn,value:na,onChange:ut.onShowMessageChange})),na===Mt.GithubComment?p.createElement(We.b,{icon:"copy",getText:ut.onGetMarkdownForClipboard},"Copy to clipboard"):p.createElement(C.$n,{icon:"download-alt",onClick:ut.onDownloadDashboard},"Download (",Sa,")")),p.createElement(Oe.Ay,{disableWidth:!0},({height:fa})=>p.createElement(Ne.B,{width:"100%",height:fa,language:na===Mt.GithubComment?"markdown":"json",showLineNumbers:!0,showMiniMap:!0,value:na===Mt.GithubComment?ka:Da,readOnly:!1,onBlur:ut.onSetSnapshotText}))),on===Rn.Support&&p.createElement(p.Fragment,null,p.createElement(L.D,{label:"Randomize data",description:"Modify the original data to hide sensitve information.  Note the lengths will stay the same, and duplicate values will be equal."},p.createElement(R.B,null,p.createElement(K.K,{label:"Labels",id:"randomize-labels",showLabel:!0,value:!!ds.labels,onChange:()=>ut.onToggleRandomize("labels")}),p.createElement(K.K,{label:"Field names",id:"randomize-field-names",showLabel:!0,value:!!ds.names,onChange:()=>ut.onToggleRandomize("names")}),p.createElement(K.K,{label:"String values",id:"randomize-string-values",showLabel:!0,value:!!ds.values,onChange:()=>ut.onToggleRandomize("values")}))),p.createElement(L.D,{label:"Support snapshot",description:`Panel: ${Xa}`},p.createElement(R.B,null,p.createElement(C.$n,{icon:"download-alt",onClick:ut.onDownloadDashboard},"Dashboard (",Sa,")"),p.createElement(We.b,{icon:"github",getText:ut.onGetMarkdownForClipboard,title:"Copy a complete GitHub comment to the clipboard"},"Copy to clipboard"))),p.createElement(Oe.Ay,{disableWidth:!0},({height:fa})=>p.createElement("div",{style:{height:fa,overflow:"auto"}},qs&&p.createElement(qs.Component,{model:qs})))))}const tn=Ge=>({code:(0,ye.css)({flexGrow:1,height:"100%",overflow:"scroll"}),field:(0,ye.css)({width:"100%"}),opts:(0,ye.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end","& button":{marginLeft:Ge.spacing(1)}})});var It=e(8484),Xe=e(61453);class jn extends f.Bs{constructor(Re){super({...Re,options:{withTransforms:!0,withFieldConfig:!0}}),this.onOptionsChange=qe=>{this.setState({options:qe})}}getTabLabel(){return(0,It.t)("dashboard.inspect.data-tab","Data")}getTabValue(){return fn.q.Data}static{this.Component=({model:Re})=>{const{options:qe}=Re.useState(),ut=Re.state.panelRef.resolve(),Ft=f.jh.getData(ut),{data:on}=ia(Ft,qe.withTransforms).useState(),sn=f.jh.getTimeRange(ut);return p.createElement(Xe.q,{isLoading:on?.state===Vt.Gu.Loading,data:on?.series,options:qe,hasTransformations:Qn(Ft),timeZone:sn.getTimeZone(),panelPluginId:ut.state.pluginId,dataName:ut.state.title,fieldConfig:ut.state.fieldConfig,onOptionsChange:Re.onOptionsChange})}}}function Qn(Ge){return Ge instanceof f.Es?Ge.state.transformations.length>0:!1}function ia(Ge,Re){return!Re&&Ge instanceof f.Es&&Ge.state.$data?Ge.state.$data:Ge}var wn=e(18803),sa=e(26323),La=e(77938),xa=e(6204),ga=e(89681);class Ts extends f.Bs{constructor(Re){super({...Re,source:"panel-json",jsonText:Us("panel-json",Re.panelRef.resolve())}),this.onChangeSource=qe=>{this.setState({source:qe.value,jsonText:Us(qe.value,this.state.panelRef.resolve())})},this.onApplyChange=()=>{const qe=this.state.panelRef.resolve(),ut=(0,Te.YQ)(qe),Ft=JSON.parse(this.state.jsonText),on=new u.a(Ft),sn=(0,ot.tt)(on),Ln=f.Go.cloneSceneObjectState(sn.state);if(!(qe.parent instanceof le.U)){console.error("Cannot update state of panel",qe,sn);return}this.state.onClose(),ut.state.isEditing||ut.onEnterEditMode(),qe.parent.setState(Ln),(0,xa.B9)(fn.q.JSON,"apply",{panel_type_changed:qe.state.pluginId!==on.type,panel_id_changed:(0,Te.Cs)(qe)!==on.id,panel_grid_pos_changed:Ms(qe.parent.state,Ln),panel_targets_changed:Dr((0,Te.un)(qe),(0,Te.un)(Ln.$data))})},this.onCodeEditorBlur=qe=>{this.setState({jsonText:qe})}}getTabLabel(){return(0,It.t)("dashboard.inspect.json-tab","JSON")}getTabValue(){return fn.q.JSON}getOptions(){const Re=this.state.panelRef.resolve(),qe=Re.state.$data??Re.parent?.state.$data,ut=[{label:(0,It.t)("dashboard.inspect-json.panel-json-label","Panel JSON"),description:(0,It.t)("dashboard.inspect-json.panel-json-description","The model saved in the dashboard JSON that configures how everything works."),value:"panel-json"}];return qe&&(ut.push({label:(0,It.t)("dashboard.inspect-json.panel-data-label","Panel data"),description:(0,It.t)("dashboard.inspect-json.panel-data-description","The raw model passed to the panel visualization"),value:"panel-data"}),ut.push({label:(0,It.t)("dashboard.inspect-json.dataframe-label","DataFrame JSON (from Query)"),description:(0,It.t)("dashboard.inspect-json.dataframe-description","Raw data without transformations and field config applied. "),value:"data-frames"})),ut}isEditable(){if(this.state.source!=="panel-json")return!1;const Re=this.state.panelRef.resolve();return Re.parent instanceof tt.F||Re.parent instanceof le.U&&Re.parent.isRepeated()?!1:(0,Te.YQ)(Re).state.meta.canEdit}static{this.Component=({model:Re})=>{const{source:qe,jsonText:ut}=Re.useState(),Ft=(0,rt.of)(sa.A),on=Re.getOptions();return p.createElement("div",{className:Ft.wrap},p.createElement("div",{className:Ft.toolbar,"data-testid":x.Tp.components.PanelInspector.Json.content},p.createElement(L.D,{label:(0,It.t)("dashboard.inspect-json.select-source","Select source"),className:"flex-grow-1"},p.createElement(Cn.l6,{inputId:"select-source-dropdown",options:on,value:on.find(sn=>sn.value===qe)??on[0].value,onChange:Re.onChangeSource})),Re.isEditable()&&p.createElement(C.$n,{className:Ft.toolbarItem,onClick:Re.onApplyChange},"Apply")),p.createElement("div",{className:Ft.content},p.createElement(Oe.Ay,{disableWidth:!0},({height:sn})=>p.createElement(Ne.B,{width:"100%",height:sn,language:"json",showLineNumbers:!0,showMiniMap:ut.length>100,value:ut,readOnly:!Re.isEditable(),onBlur:Re.onCodeEditorBlur}))))}}}function Us(Ge,Re){let qe={};switch(Ge){case"panel-json":{(0,xa.B9)(fn.q.JSON,"panelData");const ut=Re.parent instanceof tt.F,Ft=ut?Re.parent.parent:Re.parent;if(ut){qe=Bs(Re);break}if(Re.parent instanceof ga.j){qe=Re.parent.getPanelSaveModel();break}Ft instanceof le.U&&(qe=(0,Me.ZB)(Ft));break}case"panel-data":{(0,xa.B9)(fn.q.JSON,"panelJSON");const ut=f.jh.getData(Re);ut.state.data&&(qe=Re.applyFieldConfig(ut.state.data));break}case"data-frames":{(0,xa.B9)(fn.q.JSON,"dataFrame");const ut=f.jh.getData(Re);ut.state.data&&(ut instanceof f.Es&&ut.state.$data?.state.data?qe=(0,wn.B6)(ut.state.$data.state.data):qe=(0,wn.B6)(ut.state.data))}}return(0,La.p)(qe)}function Bs(Ge){if(!(Ge.parent instanceof tt.F))throw"Panel not child of LibraryVizPanel";if(!(Ge.parent.parent instanceof le.U))throw"LibraryPanel not child of DashboardGridItem";const Re=Ge.parent.parent,qe={x:Re.state.x||0,y:Re.state.y||0,h:Re.state.height||0,w:Re.state.width||0},ut=ks(Ge),Ft=(0,Me.Z6)(Ge,qe,!1,Re);return{libraryPanel:{...ut},...Ft}}function ks(Ge){if(!(Ge.parent instanceof tt.F))throw new Error("Panel not a child of LibraryVizPanel");if(!Ge.parent.state._loadedPanel)throw new Error("Library panel not loaded");return Ge.parent.state._loadedPanel}function Ms(Ge,Re){return Ge.x!==Re.x||Ge.y!==Re.y||Ge.width!==Re.width||Ge.height!==Re.height}function Dr(Ge,Re){return Ge===void 0||Re===void 0?!1:!(0,Yn.isEqual)(Ge.state.queries,Re.state.queries)}class _s extends f.Bs{getTabLabel(){return(0,It.t)("dashboard.inspect.meta-tab","Meta data")}getTabValue(){return fn.q.Meta}static{this.Component=({model:Re})=>{const{panelRef:qe,dataSource:ut}=Re.state,Ft=f.jh.getData(qe.resolve()),on=ut.components?.MetadataInspector;return!Ft.state.data||!on?null:p.createElement(on,{datasource:ut,data:Ft.state.data.series})}}}var Ir=e(90820);class Xs extends f.Bs{constructor(){super(...arguments),this.onRefreshQuery=()=>{const Re=(0,Te.un)(this.state.panelRef.resolve());Re&&Re.runQueries()}}getTabLabel(){return(0,It.t)("dashboard.inspect.query-tab","Query")}getTabValue(){return fn.q.Query}static{this.Component=({model:Re})=>{const qe=f.jh.getData(Re.state.panelRef.resolve()).useState();return qe.data?p.createElement(Ir.e,{data:qe.data,onRefreshQuery:Re.onRefreshQuery}):null}}}var Gs=e(32067);class Br extends f.Bs{getTabLabel(){return(0,It.t)("dashboard.inspect.stats-tab","Stats")}getTabValue(){return fn.q.Stats}static{this.Component=({model:Re})=>{const qe=f.jh.getData(Re.state.panelRef.resolve()).useState(),ut=f.jh.getTimeRange(Re.state.panelRef.resolve());return qe.data?p.createElement(Gs.N,{data:qe.data,timeZone:ut.getTimeZone()}):null}}}class Mr extends f.Bs{constructor(Re){super(Re),this.onClose=()=>{const qe=(0,Te.YQ)(this);i.Ny.push((0,gt.uZ)({uid:qe.state.uid,slug:qe.state.meta.slug,currentQueryParams:i.Ny.getLocation().search,updateQuery:{inspect:null,inspectTab:null}}))},this.addActivationHandler(()=>this._activationHandler())}static{this.Component=vr}_activationHandler(){this.buildTabs(0)}async buildTabs(Re){const qe=this.state.panelRef,ut=qe?.resolve()?.getPlugin(),Ft=[];if(ut||(Re<2e3?setTimeout(()=>this.buildTabs(Re+100),100):this.setState({pluginNotLoaded:!0})),qe){if((0,un.$)(ut)){const on=f.jh.getData(qe.resolve());Ft.push(new jn({panelRef:qe})),Ft.push(new Br({panelRef:qe})),Ft.push(new Xs({panelRef:qe}));const sn=await(0,An.BN)(on.state.data);sn&&Ft.push(new _s({panelRef:qe,dataSource:sn}))}Ft.push(new Ts({panelRef:qe,onClose:this.onClose}))}this.setState({tabs:Ft})}getDrawerTitle(){const Re=this.state.panelRef?.resolve();return Re?f.jh.interpolate(Re,`Inspect: ${Re.state.title}`):"Inspect panel"}}function vr({model:Ge}){const{tabs:Re,pluginNotLoaded:qe,panelRef:ut}=Ge.useState(),Ft=(0,St.zy)(),on=new URLSearchParams(Ft.search);if(!Re)return null;const sn=on.get("inspectTab"),Ln=Re.find(na=>na.getTabValue()===sn)??Re[0],qn=ut.resolve();return sn===fn.q.Help?p.createElement(Ht,{panel:qn,onClose:Ge.onClose}):p.createElement(E._,{title:Ge.getDrawerTitle(),onClose:Ge.onClose,size:"md",tabs:p.createElement(v.U,null,Re.map(na=>p.createElement(D.o,{key:na.state.key,label:na.getTabLabel(),active:na===Ln,href:n.I.getUrlForPartial(Ft,{inspectTab:na.getTabValue()})})))},qe&&p.createElement(O.F,{title:"Panel plugin not loaded"},"Make sure the panel you want to inspect is visible and has been displayed before opening inspect."),Ln&&Ln.Component&&p.createElement(Ln.Component,{model:Ln}))}var fr=e(19293),js=e(10096),to=e(22391),Ar=e(19347),Ko=e(38477);class no{constructor(Re){this._scene=Re}getKeys(){return["editIndex"]}getUrlState(){const Re=this._scene.state;return{editIndex:Re.editIndex!==void 0?String(Re.editIndex):void 0}}updateFromUrl(Re){let qe={};typeof Re.editIndex=="string"?qe={editIndex:Number(Re.editIndex)}:qe={editIndex:void 0},Object.keys(qe).length>0&&this._scene.setState(qe)}}var vo=e(16817),ao=e(84167),Do=e(77268),Xr=e(82241),mo=e(51612),qr=e(46502);const Po="New annotation",jr=({annotation:Ge,editIndex:Re,panels:qe,onUpdate:ut,onBackToList:Ft,onDelete:on})=>{const sn=(0,rt.of)(Io),Ln=(0,p.useMemo)(()=>Ge.filter?Ge.filter.exclude?2:1:0,[Ge.filter]),{value:qn}=(0,vo.A)(()=>(0,Ar.l)().get(Ge.datasource),[Ge.datasource]),na=(0,Ar.l)().getInstanceSettings(Ge.datasource),Sa=Na=>{ut({...Ge,name:Na.currentTarget.value},Re)},ka=Na=>{const Is=(0,to.p$)(Na);Ge.datasource?.type!==Is.type?ut({datasource:Is,builtIn:Ge.builtIn,enable:Ge.enable,iconColor:Ge.iconColor,name:Ge.name,hide:Ge.hide,filter:Ge.filter,mappings:Ge.mappings,type:Ge.type},Re):ut({...Ge,datasource:Is},Re)},Da=Na=>{const Is=Na.currentTarget;ut({...Ge,[Is.name]:Is.type==="checkbox"?Is.checked:Is.value},Re)},ds=Na=>{ut({...Ge,iconColor:Na},Re)},Xa=Na=>{let Is=Na.value===0?void 0:{exclude:Na.value===2,ids:Ge.filter?.ids??[]};ut({...Ge,filter:Is},Re)},qs=Na=>{if(!Array.isArray(Na))return;const Is={exclude:Ln===2,ids:[]};Na.forEach(pr=>pr.value&&Is.ids.push(pr.value)),ut({...Ge,filter:Is},Re)},Cs=()=>{on(Re),Ft()},Ss=Ge.name===Po,fa=(Na,Is)=>Na.label&&Is.label?Na.label.toLowerCase().localeCompare(Is.label.toLowerCase()):-1,Fa=(0,p.useMemo)(()=>qe.filter(Na=>r.$.panels[Na.state.pluginId]).map(Na=>({value:(0,Te.Cs)(Na),label:Na.state.title??`Panel ${(0,Te.Cs)(Na)}`,description:Na.state.description,imgUrl:r.$.panels[Na.state.pluginId].info.logos.small})).sort(fa)??[],[qe]);return p.createElement("div",null,p.createElement(ao.n,{className:sn.settingsForm},p.createElement(L.D,{label:"Name"},p.createElement(N.p,{"data-testid":x.Tp.pages.Dashboard.Settings.Annotations.Settings.name,name:"name",id:"name",autoFocus:Ss,value:Ge.name,onChange:Sa})),p.createElement(L.D,{label:"Data source",htmlFor:"data-source-picker"},p.createElement(mo.s,{annotations:!0,variables:!0,current:Ge.datasource,onChange:ka})),p.createElement(L.D,{label:"Enabled",description:"When enabled the annotation query is issued every dashboard refresh"},p.createElement(ce.S,{name:"enable",id:"enable",value:Ge.enable,onChange:Da,"data-testid":x.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.enable})),p.createElement(L.D,{label:"Hidden",description:"Annotation queries can be toggled on or off at the top of the dashboard. With this option checked this toggle will be hidden."},p.createElement(ce.S,{name:"hide",id:"hide",value:Ge.hide,onChange:Da,"data-testid":x.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.hide})),p.createElement(L.D,{label:"Color",description:"Color to use for the annotation event markers"},p.createElement(R.B,null,p.createElement(Do.a,{value:Ge?.iconColor,onChange:ds}))),p.createElement(L.D,{label:"Show in","data-testid":x.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.showInLabel},p.createElement(p.Fragment,null,p.createElement(Cn.l6,{options:qo,value:Ln,onChange:Xa,"data-testid":x.Tp.components.Annotations.annotationsTypeInput}),Ln!==0&&p.createElement(Cn.KF,{options:Fa,value:Fa.filter(Na=>Ge.filter?.ids.includes(Na.value)),onChange:qs,isClearable:!0,placeholder:"Choose panels",width:100,closeMenuOnSelect:!1,className:sn.select,"data-testid":x.Tp.components.Annotations.annotationsChoosePanelInput})))),p.createElement(ao.n,null,p.createElement("h3",{className:"page-heading"},"Query"),qn?.annotations&&na&&p.createElement(Xr.A,{datasource:qn,datasourceInstanceSettings:na,annotation:Ge,onChange:Na=>ut(Na,Re)}),qn&&!qn.annotations&&p.createElement(qr.F,{datasource:qn,annotation:Ge,onChange:Na=>ut(Na,Re)})),p.createElement(R.B,null,!Ge.builtIn&&p.createElement(C.$n,{variant:"destructive",onClick:Cs,"data-testid":x.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.delete},"Delete"),p.createElement(C.$n,{variant:"secondary",onClick:Ft,"data-testid":x.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.apply},"Back to list")))},Io=Ge=>({settingsForm:(0,ye.css)({maxWidth:Ge.spacing(60),marginBottom:Ge.spacing(2)}),select:(0,ye.css)({marginTop:"8px"})});var $o=(Ge=>(Ge[Ge.AllPanels=0]="AllPanels",Ge[Ge.IncludePanels=1]="IncludePanels",Ge[Ge.ExcludePanels=2]="ExcludePanels",Ge))($o||{});const qo=[{label:"All panels",value:0,description:"Send the annotation data to all panels that support annotations"},{label:"Selected panels",value:1,description:"Send the annotations to the explicitly listed panels"},{label:"All panels except",value:2,description:"Do not send annotation data to the following panels"}];var lo=e(29158),Vo=e(91605),Co=e(69529),zo=e(72109),So=e(46991);const si="Add annotation query",Yo=({annotations:Ge,onNew:Re,onEdit:qe,onMove:ut,onDelete:Ft})=>{const on=(0,rt.of)(ri),sn=Ge.length===0||Ge.length===1&&Ge[0].builtIn,Ln=na=>na.enable===!1?p.createElement("em",{className:"muted"},"(Disabled) \xA0 ",na.name):na.builtIn?p.createElement("em",{className:"muted"},na.name," \xA0 (Built-in)"):p.createElement(p.Fragment,null,na.name),qn=(0,Ar.l)();return p.createElement(R.B,{direction:"column"},Ge.length>0&&p.createElement("div",{className:on.table},p.createElement("table",{role:"grid",className:"filter-table filter-table--hover"},p.createElement("thead",null,p.createElement("tr",null,p.createElement("th",null,"Query name"),p.createElement("th",null,"Data source"),p.createElement("th",{colSpan:3}))),p.createElement("tbody",{"data-testid":x.Tp.pages.Dashboard.Settings.Annotations.List.annotations},Ge.map((na,Sa)=>p.createElement("tr",{key:`${na.name}-${Sa}`},na.builtIn?p.createElement("td",{role:"gridcell",style:{width:"90%"},className:"pointer",onClick:()=>qe(Sa)},p.createElement(C.$n,{size:"sm",fill:"text",variant:"secondary"},Ln(na))):p.createElement("td",{role:"gridcell",className:"pointer",onClick:()=>qe(Sa)},p.createElement(C.$n,{size:"sm",fill:"text",variant:"secondary"},Ln(na))),p.createElement("td",{role:"gridcell",className:"pointer",onClick:()=>qe(Sa)},qn.getInstanceSettings(na.datasource)?.name||na.datasource?.uid),p.createElement("td",{role:"gridcell",style:{width:"1%"}},Sa!==0&&p.createElement(lo.K,{name:"arrow-up",onClick:()=>ut(Sa,Ao.UP),tooltip:"Move up"})),p.createElement("td",{role:"gridcell",style:{width:"1%"}},Ge.length>1&&Sa!==Ge.length-1?p.createElement(lo.K,{name:"arrow-down",onClick:()=>ut(Sa,Ao.DOWN),tooltip:"Move down"}):null),p.createElement("td",{role:"gridcell",style:{width:"1%"}},!na.builtIn&&p.createElement(Vo.e,{size:"sm",onConfirm:()=>Ft(Sa),"aria-label":`Delete query with title "${na.name}"`}))))))),sn&&p.createElement(R.B,{direction:"column"},p.createElement(Co.p,{variant:"call-to-action",button:p.createElement(C.$n,{"data-testid":x.Tp.components.CallToActionCard.buttonV2("Add annotation query"),icon:"comment-alt",onClick:Re,size:"lg"},p.createElement(It.x6,{i18nKey:"annotations.empty-state.button-title"},"Add annotation query")),message:(0,It.t)("annotations.empty-state.title","There are no custom annotation queries added yet")},p.createElement(It.x6,{i18nKey:"annotations.empty-state.info-box-content"},p.createElement("p",null,"Annotations provide a way to integrate event data into your graphs. They are visualized as vertical lines and icons on all graph panels. When you hover over an annotation icon you can get event text & tags for the event. You can add annotation events directly from grafana by holding CTRL or CMD + click on graph (or drag region). These will be stored in Grafana's annotation database.")),p.createElement(It.x6,{i18nKey:"annotations.empty-state.info-box-content-2"},"Checkout the"," ",p.createElement(zo.Y,{external:!0,href:"http://docs.grafana.org/reference/annotations/"},"Annotations documentation")," ","for more information."))),!sn&&p.createElement(So.d,{"data-testid":x.Tp.pages.Dashboard.Settings.Annotations.List.addAnnotationCTAV2,onClick:Re},"New query"))},ri=()=>({table:(0,ye.css)({width:"100%",overflowX:"auto"})});var Ao=(Ge=>(Ge[Ge.UP=-1]="UP",Ge[Ge.DOWN=1]="DOWN",Ge))(Ao||{});class so extends f.Bs{constructor(){super(...arguments),this._urlSync=new no(this),this.onNew=()=>{const Re={name:Po,enable:!0,datasource:(0,to.p$)((0,Ar.l)().getInstanceSettings(null)),iconColor:"red"},qe=new Ko.g({query:Re,name:Re.name,isEnabled:!!Re.enable,isHidden:!!Re.hide}),ut=Ve.b4.getDataLayers(this._dashboard);ut.addAnnotationLayer(qe),this.setState({editIndex:ut.state.annotationLayers.length-1})},this.onEdit=Re=>{this.setState({editIndex:Re})},this.onBackToList=()=>{this.setState({editIndex:void 0})},this.onMove=(Re,qe)=>{const ut=Ve.b4.getDataLayers(this._dashboard),Ft=[...ut.state.annotationLayers],[on]=Ft.splice(Re,1);Ft.splice(Re+qe,0,on),ut.setState({annotationLayers:Ft})},this.onDelete=Re=>{const qe=Ve.b4.getDataLayers(this._dashboard),ut=[...qe.state.annotationLayers];ut.splice(Re,1),qe.setState({annotationLayers:ut})},this.onUpdate=(Re,qe)=>{const ut=this.getDataLayer(qe);ut.setState({name:Re.name,isEnabled:!!Re.enable,isHidden:!!Re.hide,query:Re}),ut.runLayer()}}static{this.Component=ko}getUrlKey(){return"annotations"}get _dashboard(){return(0,Te.YQ)(this)}getDataLayer(Re){const ut=Ve.b4.getDataLayers(this._dashboard).state.annotationLayers[Re];if(!(ut instanceof f.tV.g))throw new Error("AnnotationsDataLayer not found at index "+Re);return ut}getDashboard(){return this._dashboard}}function ko({model:Ge}){const Re=Ge.getDashboard(),{annotationLayers:qe}=Ve.b4.getDataLayers(Re).useState(),{navModel:ut,pageNav:Ft}=Pa(Re,Ge.getUrlKey()),{editIndex:on}=Ge.useState(),sn=Ve.b4.getVizPanels(Re),Ln=(0,be.O)(qe);return on!=null&&on<qe.length?p.createElement(eo,{annotationLayer:Ge.getDataLayer(on),pageNav:Ft,panels:sn,editIndex:on,navModel:ut,dashboard:Re,onUpdate:Ge.onUpdate,onBackToList:Ge.onBackToList,onDelete:Ge.onDelete}):p.createElement(_t.Y,{navModel:ut,pageNav:Ft,layout:Je.k.Standard},p.createElement(Kt.c,{dashboard:Re}),p.createElement(Yo,{annotations:Ln,onNew:Ge.onNew,onEdit:Ge.onEdit,onDelete:Ge.onDelete,onMove:Ge.onMove}))}function eo({annotationLayer:Ge,pageNav:Re,navModel:qe,panels:ut,editIndex:Ft,dashboard:on,onUpdate:sn,onBackToList:Ln,onDelete:qn}){const na=Re.children.find(ds=>ds.active);na.parentItem=Re;const{name:Sa,query:ka}=Ge.useState(),Da={text:Sa,parentItem:na};return p.createElement(_t.Y,{navModel:qe,pageNav:Da,layout:Je.k.Standard},p.createElement(Kt.c,{dashboard:on}),p.createElement(jr,{annotation:ka,editIndex:Ft,panels:ut,onUpdate:sn,onBackToList:Ln,onDelete:qn}))}var No=e(14588),To=e(65857),oi=e(6199),oo=e(4588);class zt extends f.Bs{constructor(){super(...arguments),this._urlSync=new no(this),this.onNewLink=()=>{this.links=[...this.links,oo.q],this.setState({editIndex:this.links.length-1})},this.onDelete=Re=>{this.links=[...this.links.slice(0,Re),...this.links.slice(Re+1)],this.setState({editIndex:void 0})},this.onDuplicate=Re=>{this.links=[...this.links,{...Re}]},this.onOrderChange=(Re,qe)=>{this.links=No.moveItemImmutably(this.links,Re,Re+qe)},this.onEdit=Re=>{this.setState({editIndex:Re})},this.onUpdateLink=Re=>{const qe=this.state.editIndex;qe!==void 0&&(this.links=[...this.links.slice(0,qe),Re,...this.links.slice(qe+1)])},this.onGoBack=()=>{this.setState({editIndex:void 0})}}static{this.Component=rn}getUrlKey(){return"links"}get dashboard(){return(0,Te.YQ)(this)}get links(){return this.dashboard.state.links}set links(Re){this.dashboard.setState({links:Re})}}function rn({model:Ge}){const{editIndex:Re}=Ge.useState(),qe=(0,Te.YQ)(Ge),{links:ut}=qe.useState(),{navModel:Ft,pageNav:on}=Pa(qe,Ge.getUrlKey()),sn=Re!==void 0?ut[Re]:void 0;return sn?p.createElement(zn,{pageNav:on,navModel:Ft,link:sn,dashboard:qe,onChange:Ge.onUpdateLink,onGoBack:Ge.onGoBack}):p.createElement(_t.Y,{navModel:Ft,pageNav:on,layout:Je.k.Standard},p.createElement(Kt.c,{dashboard:qe}),p.createElement(oi.X,{links:ut,onNew:Ge.onNewLink,onEdit:Ge.onEdit,onDelete:Ge.onDelete,onDuplicate:Ge.onDuplicate,onOrderChange:Ge.onOrderChange}))}function zn({pageNav:Ge,link:Re,navModel:qe,dashboard:ut,onChange:Ft,onGoBack:on}){const sn=Ge.children.find(qn=>qn.active);sn.parentItem=Ge;const Ln={text:"Edit link",parentItem:sn};return p.createElement(_t.Y,{navModel:qe,pageNav:Ln,layout:Je.k.Standard},p.createElement(Kt.c,{dashboard:ut}),p.createElement(To.d,{link:Re,onUpdate:Ft,onGoBack:on}))}var Fn=e(79924),ta=e(94354),ua=e(57418),ya=e(75590),as=e(81394),Ga=e(27966),_a=e(77431),nr=e(42941),ps=e(96374),Qs=e(37390);function Hr({dashboard:Ge}){const[Re,qe]=(0,nr.A)(!1);return p.createElement(p.Fragment,null,p.createElement(C.$n,{variant:"destructive",onClick:qe,"data-testid":x.Tp.pages.Dashboard.Settings.General.deleteDashBoard},p.createElement(It.x6,{i18nKey:"dashboard-settings.dashboard-delete-button"},"Delete dashboard")),Re&&p.createElement(_r,{dashboard:Ge,onClose:qe}))}function _r({dashboard:Ge,onClose:Re}){const[,qe]=(0,oe.A)(async()=>{Re(),await Ge.deleteDashboard()},[Ge,Re]);return Ge.state.meta.provisioned?p.createElement(Rr,{dashboard:Ge,onClose:Re}):p.createElement(ps.u,{isOpen:!0,body:p.createElement(p.Fragment,null,p.createElement("p",null,"Do you want to delete this dashboard?"),p.createElement("p",null,Ge.state.title)),onConfirm:qe,onDismiss:Re,title:"Delete",icon:"trash-alt",confirmText:"Delete"})}function Rr({dashboard:Ge,onClose:Re}){return p.createElement(Qs.a,{isOpen:!0,title:"Cannot delete provisioned dashboard",icon:"trash-alt",onDismiss:Re},p.createElement("p",null,"This dashboard is managed by Grafana provisioning and cannot be deleted. Remove the dashboard from the config file to delete it."),p.createElement("p",null,p.createElement("i",null,"See"," ",p.createElement("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer"},"documentation")," ","for more information about provisioning."),p.createElement("br",null),"File path: ",Ge.state.meta.provisionedExternalId),p.createElement(Qs.a.ButtonRow,null,p.createElement(C.$n,{variant:"primary",onClick:Re},"OK")))}const Eo=[{label:"Editable",value:!0},{label:"Read-only",value:!1}],co=[{value:0,label:"Default"},{value:1,label:"Shared crosshair"},{value:2,label:"Shared Tooltip"}];class Ur extends f.Bs{constructor(){super(...arguments),this.onTitleChange=Re=>{this._dashboard.setState({title:Re})},this.onDescriptionChange=Re=>{this._dashboard.setState({description:Re})},this.onTagsChange=Re=>{this._dashboard.setState({tags:Re})},this.onFolderChange=async(Re,qe)=>{const ut={...this._dashboard.state.meta,folderUid:Re||this._dashboard.state.meta.folderUid,folderTitle:qe||this._dashboard.state.meta.folderTitle};ut.folderUid&&await(0,_a.Q)(ut.folderUid),this._dashboard.setState({meta:ut})},this.onEditableChange=Re=>{this._dashboard.setState({editable:Re})},this.onTimeZoneChange=Re=>{this.getTimeRange().setState({timeZone:Re})},this.onWeekStartChange=Re=>{this.getTimeRange().setState({weekStart:Re})},this.onRefreshIntervalChange=Re=>{this.getRefreshPicker()?.setState({intervals:Re})},this.onNowDelayChange=Re=>{this.getTimeRange()?.setState({UNSAFE_nowDelay:Re})},this.onHideTimePickerChange=Re=>{this.getDashboardControls()?.setState({hideTimeControls:Re})},this.onLiveNowChange=Re=>{try{const qe=this.getLiveNowTimer();Re?qe.enable():qe.disable()}catch(qe){console.error(qe)}},this.onTooltipChange=Re=>{this.getCursorSync()?.setState({sync:Re})},this.onDeleteDashboard=()=>{}}get _dashboard(){return(0,Te.YQ)(this)}getUrlKey(){return"settings"}getDashboard(){return this._dashboard}getTimeRange(){return f.jh.getTimeRange(this._dashboard)}getRefreshPicker(){return this.getDashboardControls().state.refreshPicker}getCursorSync(){return Ve.b4.getCursorSync(this._dashboard)}getLiveNowTimer(){const Re=f.jh.findObject(this._dashboard,qe=>qe instanceof f.Gg.en);if(Re instanceof f.Gg.en)return Re;throw new Error("LiveNowTimer could not be found")}getDashboardControls(){return this._dashboard.state.controls}static{this.Component=({model:Re})=>{const qe=Re.getDashboard(),{navModel:ut,pageNav:Ft}=Pa(qe,Re.getUrlKey()),{title:on,description:sn,tags:Ln,meta:qn,editable:na}=qe.useState(),{sync:Sa}=Re.getCursorSync()?.useState()||{},{timeZone:ka,weekStart:Da,UNSAFE_nowDelay:ds}=Re.getTimeRange().useState(),{intervals:Xa}=Re.getRefreshPicker().useState(),{hideTimeControls:qs}=Re.getDashboardControls().useState(),{enabled:Cs}=Re.getLiveNowTimer().useState();return p.createElement(_t.Y,{navModel:ut,pageNav:Ft,layout:Je.k.Standard},p.createElement(Kt.c,{dashboard:qe}),p.createElement("div",{style:{maxWidth:"600px"}},p.createElement(B.a,{marginBottom:5},p.createElement(L.D,{label:p.createElement(R.B,{justifyContent:"space-between"},p.createElement(w.J,{htmlFor:"title-input"},p.createElement(It.x6,{i18nKey:"dashboard-settings.general.title-label"},"Title")),r.$.featureToggles.dashgpt&&p.createElement(Ga.Z,{onGenerate:Ss=>Re.onTitleChange(Ss)}))},p.createElement(N.p,{id:"title-input",name:"title",value:on,onChange:Ss=>Re.onTitleChange(Ss.target.value)})),p.createElement(L.D,{label:p.createElement(R.B,{justifyContent:"space-between"},p.createElement(w.J,{htmlFor:"description-input"},(0,It.t)("dashboard-settings.general.description-label","Description")),r.$.featureToggles.dashgpt&&p.createElement(as.V,{onGenerate:Ss=>Re.onDescriptionChange(Ss)}))},p.createElement(F.f,{id:"description-input",name:"description",value:sn,onChange:Ss=>Re.onDescriptionChange(Ss.target.value)})),p.createElement(L.D,{label:(0,It.t)("dashboard-settings.general.tags-label","Tags")},p.createElement(Fn.u,{id:"tags-input",tags:Ln,onChange:Re.onTagsChange,width:40})),p.createElement(L.D,{label:(0,It.t)("dashboard-settings.general.folder-label","Folder")},p.createElement(U.d,{value:qn.folderUid,onChange:Re.onFolderChange,initialTitle:qn.folderTitle,inputId:"dashboard-folder-input",enableCreateNew:!0,skipInitialLoad:!0})),p.createElement(L.D,{label:(0,It.t)("dashboard-settings.general.editable-label","Editable"),description:(0,It.t)("dashboard-settings.general.editable-description","Set to read-only to disable all editing. Reload the dashboard for changes to take effect")},p.createElement(ta.z,{value:na,options:Eo,onChange:Re.onEditableChange}))),p.createElement(ya.p,{onTimeZoneChange:Re.onTimeZoneChange,onWeekStartChange:Re.onWeekStartChange,onRefreshIntervalChange:Re.onRefreshIntervalChange,onNowDelayChange:Re.onNowDelayChange,onHideTimePickerChange:Re.onHideTimePickerChange,onLiveNowChange:Re.onLiveNowChange,refreshIntervals:Xa,timePickerHidden:qs,nowDelay:ds||"",liveNow:Cs,timezone:ka||"",weekStart:Da||""}),p.createElement(ua.M,{label:(0,It.t)("dashboard-settings.general.panel-options-label","Panel options"),isOpen:!0},p.createElement(L.D,{label:(0,It.t)("dashboard-settings.general.panel-options-graph-tooltip-label","Graph tooltip"),description:(0,It.t)("dashboard-settings.general.panel-options-graph-tooltip-description","Controls tooltip and hover highlight behavior across different panels. Reload the dashboard for changes to take effect")},p.createElement(ta.z,{onChange:Re.onTooltipChange,options:co,value:Sa}))),p.createElement(B.a,{marginTop:3},qn.canDelete&&p.createElement(Hr,{dashboard:qe}))))}}}class At extends f.Bs{constructor(Re){super({...Re,jsonText:""}),this.onCodeEditorBlur=qe=>{this.setState({jsonText:qe})},this.onSaveSuccess=qe=>{const ut=JSON.parse(this.state.jsonText),Ft=this.getDashboard();ut.version=qe.version;const on={dashboard:ut,meta:Ft.state.meta},sn=(0,ot.wM)(on),Ln=f.Go.cloneSceneObjectState(sn.state);Ft.pauseTrackingChanges(),Ft.setInitialSaveModel(on.dashboard),Ft.setState(Ln),this.setState({jsonText:this.getJsonText()})},this.addActivationHandler(()=>this.setState({jsonText:this.getJsonText()}))}getUrlKey(){return"json-model"}getDashboard(){return(0,Te.YQ)(this)}getSaveModel(){const Re=this.getDashboard();return(0,Me.Uy)(Re)}getJsonText(){const Re=this.getSaveModel();return(0,La.p)(Re)}static{this.Component=({model:Re})=>{const{state:qe,onSaveDashboard:ut}=ie(!1),[Ft,on]=(0,p.useState)(!1),sn=Re.getDashboard(),{navModel:Ln,pageNav:qn}=Pa(sn,Re.getUrlKey()),na=sn.useState().meta.canSave,{jsonText:Sa}=Re.useState(),ka=async Cs=>{const Ss=await ut(sn,JSON.parse(Re.state.jsonText),{folderUid:sn.state.meta.folderUid,overwrite:Cs});on(!0),Ss.status==="success"?(Re.onSaveSuccess(Ss),on(!1)):on(!0)},Da=Cs=>p.createElement(C.$n,{type:"submit",onClick:()=>{ka(Cs)},variant:Cs?"destructive":"primary"},Cs?"Save and overwrite":p.createElement(It.x6,{i18nKey:"dashboard-settings.json-editor.save-button"},"Save changes")),ds=p.createElement(C.$n,{variant:"secondary",onClick:()=>on(!1),fill:"outline"},"Cancel"),Xa=(0,rt.of)(an);function qs(Cs){if(Cs&&Ft){if(_(Cs))return p.createElement(O.F,{title:"Someone else has updated this dashboard",severity:"error"},p.createElement("p",null,"Would you still like to save this dashboard?"),p.createElement(B.a,{paddingTop:2},p.createElement(R.B,{alignItems:"center"},ds,Da(!0))));if(H(Cs))return p.createElement(j,{saveButton:Da,cancelButton:ds});if(G(Cs))return p.createElement(O.F,{title:"Plugin dashboard",severity:"error"},p.createElement("p",null,"Your changes will be lost when you update the plugin. Use ",p.createElement("strong",null,"Save As")," to create custom version."),p.createElement(B.a,{paddingTop:2},p.createElement(R.B,{alignItems:"center"},Da(!0))))}return p.createElement(p.Fragment,null,Cs&&Ft&&p.createElement(O.F,{title:"Failed to save dashboard",severity:"error"},p.createElement("p",null,Cs.message)),p.createElement(R.B,{alignItems:"center"},Da(!1)))}return p.createElement(_t.Y,{navModel:Ln,pageNav:qn,layout:Je.k.Standard},p.createElement(Kt.c,{dashboard:sn}),p.createElement("div",{className:Xa.wrapper},p.createElement(It.x6,{i18nKey:"dashboard-settings.json-editor.subtitle"},"The JSON model below is the data structure that defines the dashboard. This includes dashboard settings, panel settings, layout, queries, and so on."),p.createElement(Ne.B,{width:"100%",value:Sa,language:"json",showLineNumbers:!0,showMiniMap:!0,containerStyles:Xa.codeEditor,onBlur:Re.onCodeEditorBlur}),na&&p.createElement(B.a,{paddingTop:2},qs(qe.error))))}}}const an=Ge=>({wrapper:(0,ye.css)({display:"flex",height:"100%",flexDirection:"column",gap:Ge.spacing(2)}),codeEditor:(0,ye.css)({flexGrow:1})});var cn=e(52487);class On extends f.Bs{static{this.Component=ha}get _dashboard(){return(0,Te.YQ)(this)}getUrlKey(){return"permissions"}getDashboard(){return this._dashboard}}function ha({model:Ge}){const Re=Ge.getDashboard(),{uid:qe}=Re.useState(),{navModel:ut,pageNav:Ft}=Pa(Re,Ge.getUrlKey()),on=js.contextSrv.hasPermission(z.AccessControlAction.DashboardsPermissionsWrite);return p.createElement(_t.Y,{navModel:ut,pageNav:Ft,layout:Je.k.Standard},p.createElement(Kt.c,{dashboard:Re}),p.createElement(cn.x,{resource:"dashboards",resourceId:qe??"",canSetPermissions:on}))}var la=e(75505),Ns=e(79422),Ds=e(71678),Js=e(39558),Rs=e(8964),Er=e(58975),Vs=e(85140),hs=e(14329),Pr=e(41820),ro=e(85830),yo=e(89458),Kr=e(17663);function io({onChange:Ge,type:Re}){const qe=(0,p.useMemo)(()=>(0,Kr.B$)(),[]),ut=(0,p.useMemo)(()=>qe.find(Ft=>Ft.value===Re)??qe[0],[qe,Re]);return p.createElement(yo.v,{name:"Select variable type",value:ut,options:qe,onChange:Ge,testId:x.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalTypeSelectV2})}function Ro({variable:Ge,onTypeChange:Re,onGoBack:qe,onDelete:ut,onValidateVariableName:Ft}){const on=(0,rt.of)(Qr),[sn,Ln]=(0,p.useState)(null),{name:qn,type:na,label:Sa,description:ka,hide:Da,key:ds}=Ge.useState(),Xa=(0,Kr.bZ)(na)?(0,Kr.CD)(na):void 0,[qs,Cs]=(0,oe.A)(async()=>{await(0,la.s)(Ge.validateAndUpdate())},[Ge]),Ss=ss=>{ss.value&&Re(ss.value)},fa=(0,p.useCallback)(ss=>{const[,wo]=Ft(ss.currentTarget.value,ds);sn!==wo&&Ln(wo)},[ds,sn,Ft]),Fa=ss=>{sn||Ge.setState({name:ss.currentTarget.value})},Na=ss=>Ge.setState({label:ss.currentTarget.value}),Is=ss=>Ge.setState({description:ss.currentTarget.value}),pr=ss=>Ge.setState({hide:ss}),ir=(0,Kr.n_)(Ge),fo=ss=>()=>{(0,se.rR)("Delete variable"),ut(qn),ss()};return p.createElement("form",{"aria-label":"Variable editor Form"},p.createElement(io,{onChange:Ss,type:na}),p.createElement(Er.Y,null,"General"),p.createElement(hs._,{name:"Name",description:"The name of the template variable. (Max. 50 characters)",placeholder:"Variable name",defaultValue:qn??"",onChange:fa,onBlur:Fa,testId:x.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalNameInputV2,maxLength:ro.M.MaxSize,required:!0,invalid:!!sn,error:sn}),p.createElement(hs._,{name:"Label",description:"Optional display name",placeholder:"Label name",defaultValue:Sa??"",onBlur:Na,testId:x.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalLabelInputV2}),p.createElement(Vs.Z,{name:"Description",defaultValue:ka??"",placeholder:"Descriptive text",onBlur:Is,width:52}),p.createElement(Rs.D,{onChange:pr,hide:Da||Ns.rw.hide,type:na}),Xa&&p.createElement(Xa,{variable:Ge,onRunQuery:Cs}),ir&&p.createElement(Pr.j,{options:Ge.getOptionsForSelect()}),p.createElement("div",{className:on.buttonContainer},p.createElement(R.B,{gap:2},p.createElement(Ds.$s,null,({showModal:ss,hideModal:wo})=>p.createElement(C.$n,{variant:"destructive",fill:"outline",onClick:()=>{ss(ps.u,{title:"Delete variable",body:`Are you sure you want to delete: ${qn}?`,confirmText:"Delete variable",onConfirm:fo(wo),onDismiss:wo,isOpen:!0})}},"Delete")),p.createElement(C.$n,{variant:"secondary","data-testid":x.Tp.pages.Dashboard.Settings.Variables.Edit.General.applyButton,onClick:qe},"Back to list"),ir&&p.createElement(C.$n,{disabled:qs.loading,variant:"secondary","data-testid":x.Tp.pages.Dashboard.Settings.Variables.Edit.General.submitButton,onClick:Cs},qs.loading?p.createElement(Js._,{className:on.loadingPlaceHolder,text:"Running query..."}):"Run query"))))}const Qr=Ge=>({buttonContainer:(0,ye.css)({marginTop:Ge.spacing(2)}),loadingPlaceHolder:(0,ye.css)({marginBottom:0})});var uo=e(75494);function Mo({index:Ge,variable:Re,onEdit:qe,onDuplicate:ut,onDelete:Ft}){const on=(0,rt.$j)(),sn=(0,rt.of)(Jo),Ln=(0,Kr.Ao)(Re),qn=Re.state,na=qn.name,[Sa,ka]=(0,p.useState)(!1),Da=Xa=>()=>{ka(Xa)},ds=()=>{(0,se.rR)("Delete variable"),Ft(na)};return p.createElement(uo.sx,{draggableId:JSON.stringify(na),index:Ge},(Xa,qs)=>p.createElement("tr",{ref:Xa.innerRef,...Xa.draggableProps,style:{userSelect:qs.isDragging?"none":"auto",background:qs.isDragging?on.colors.background.secondary:void 0,...Xa.draggableProps.style}},p.createElement("td",{role:"gridcell",className:sn.column},p.createElement(C.$n,{size:"xs",fill:"text",onClick:Cs=>{Cs.preventDefault(),qe(na)},className:sn.nameLink,"data-testid":x.Tp.pages.Dashboard.Settings.Variables.List.tableRowNameFields(qn.name)},qn.name)),p.createElement("td",{role:"gridcell",className:sn.definitionColumn,onClick:Cs=>{Cs.preventDefault(),qe(na)},"data-testid":x.Tp.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(qn.name)},Ln),p.createElement("td",{role:"gridcell",className:sn.column},p.createElement("div",{className:sn.icons},p.createElement(lo.K,{onClick:Cs=>{Cs.preventDefault(),(0,se.rR)("Duplicate variable"),ut(na)},name:"copy",tooltip:"Duplicate variable","data-testid":x.Tp.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(qn.name)}),p.createElement(lo.K,{onClick:Cs=>{Cs.preventDefault(),ka(!0)},name:"trash-alt",tooltip:"Remove variable","data-testid":x.Tp.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(qn.name)}),p.createElement(ps.u,{isOpen:Sa,title:"Delete variable",body:`Are you sure you want to delete: ${qn.name}?`,confirmText:"Delete variable",onConfirm:ds,onDismiss:Da(!1)}),p.createElement("div",{...Xa.dragHandleProps,className:sn.dragHandle},p.createElement($t.I,{name:"draggabledots",size:"lg"}))))))}function Jo(Ge){return{dragHandle:(0,ye.css)({cursor:"grab",marginLeft:Ge.spacing(1)}),column:(0,ye.css)({width:"1%"}),nameLink:(0,ye.css)({cursor:"pointer",color:Ge.colors.primary.text}),definitionColumn:(0,ye.css)({width:"100%",maxWidth:"200px",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),iconPassed:(0,ye.css)({color:Ge.v1.palette.greenBase,marginRight:Ge.spacing(2)}),iconFailed:(0,ye.css)({color:Ge.v1.palette.orange,marginRight:Ge.spacing(2)}),icons:(0,ye.css)({display:"flex",gap:Ge.spacing(2),alignItems:"center"})}}function Lo({variables:Ge,onChangeOrder:Re,onDelete:qe,onDuplicate:ut,onAdd:Ft,onEdit:on}){const sn=(0,rt.of)(Ei),Ln=qn=>{!qn.destination||!qn.source||((0,se.rR)("Variable drag and drop"),Re(qn.source.index,qn.destination.index))};return p.createElement("div",null,p.createElement("div",null,Ge.length===0&&p.createElement($r,{onAdd:Ft}),Ge.length>0&&p.createElement(R.B,{direction:"column",gap:3},p.createElement("div",{className:sn.tableContainer},p.createElement("table",{className:"filter-table filter-table--hover","data-testid":x.Tp.pages.Dashboard.Settings.Variables.List.table,role:"grid"},p.createElement("thead",null,p.createElement("tr",null,p.createElement("th",null,"Variable"),p.createElement("th",null,"Definition"),p.createElement("th",{colSpan:5}))),p.createElement(uo.JY,{onDragEnd:Ln},p.createElement(uo.gL,{droppableId:"variables-list",direction:"vertical"},qn=>p.createElement("tbody",{ref:qn.innerRef,...qn.droppableProps},Ge.map((na,Sa)=>{const ka=na.state;return p.createElement(Mo,{index:Sa,key:`${ka.name}-${Sa}`,variable:na,onDelete:qe,onDuplicate:ut,onEdit:on})}),qn.placeholder))))),p.createElement(R.B,null,p.createElement(C.$n,{"data-testid":x.Tp.pages.Dashboard.Settings.Variables.List.newButton,onClick:Ft,icon:"plus"},"New variable")))))}function $r({onAdd:Ge}){return p.createElement(R.B,{direction:"column"},p.createElement(Co.p,{variant:"call-to-action",button:p.createElement(C.$n,{"data-testid":x.Tp.components.CallToActionCard.buttonV2("Add variable"),icon:"calculator-alt",onClick:Ge,size:"lg"},p.createElement(It.x6,{i18nKey:"variables.empty-state.button-title"},"Add variable")),message:(0,It.t)("variables.empty-state.title","There are no variables added yet")},p.createElement("p",null,p.createElement(It.x6,{i18nKey:"variables.empty-state.info-box-content"},"Variables enable more interactive and dynamic dashboards. Instead of hard-coding things like server or sensor names in your metric queries you can use variables in their place. Variables are shown as list boxes at the top of the dashboard. These drop-down lists make it easy to change the data being displayed in your dashboard.")),p.createElement(It.x6,{i18nKey:"variables.empty-state.info-box-content-2"},"Check out the"," ",p.createElement(zo.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/variables/"},"Templates and variables documentation")," ","for more information.")))}const Ei=()=>({tableContainer:(0,ye.css)({overflow:"scroll",width:"100%"})});class Ki extends f.Bs{constructor(){super(...arguments),this._urlSync=new no(this),this.getVariableIndex=Re=>this.getVariables().findIndex(ut=>ut.state.name===Re),this.replaceEditVariable=Re=>{const qe=this.state.editIndex??-1,{variables:ut}=this.getVariableSet().state;if(!ut[qe]){console.error("Variable not found");return}const on=[...ut.slice(0,qe),Re,...ut.slice(qe+1)];this.getVariableSet().setState({variables:on})},this.onDelete=Re=>{const qe=this.getVariableIndex(Re),{variables:ut}=this.getVariableSet().state;if(qe===-1){console.error("Variable not found");return}const Ft=[...ut.slice(0,qe),...ut.slice(qe+1)];this.getVariableSet().setState({variables:Ft}),this.setState({editIndex:void 0})},this.onDuplicated=Re=>{const qe=this.getVariableIndex(Re),ut=this.getVariableSet().state.variables;if(qe===-1){console.error("Variable not found");return}const Ft=ut[qe];let on=0,sn=`copy_of_${Ft.state.name}`;for(;ut.some(na=>na.state.name===sn);)on++,sn=`copy_of_${Ft.state.name}_${on}`;const Ln=Ft.clone(Ft.state);Ln.setState({name:sn});const qn=[...ut.slice(0,qe+1),Ln,...ut.slice(qe+1)];this.getVariableSet().setState({variables:qn})},this.onOrderChanged=(Re,qe)=>{const ut=this.getVariableSet().state.variables;if(!this.getVariableSet())return;if(Re<0||Re>=ut.length||qe<0||qe>=ut.length){console.error("Invalid index");return}const Ft=[...ut],on=Ft.splice(Re,1);Ft.splice(qe,0,on[0]),this.getVariableSet().setState({variables:Ft})},this.onEdit=Re=>{const qe=this.getVariableIndex(Re);if(qe===-1){console.error("Variable not found");return}this.setState({editIndex:qe})},this.onAdd=()=>{const Re=this.getVariables(),qe=Re.length,ut=(0,Kr.kh)(Re);this.getVariableSet().setState({variables:[...this.getVariables(),ut]}),this.setState({editIndex:qe})},this.onTypeChange=Re=>{const qe=this.state.editIndex??-1,{variables:ut}=this.getVariableSet().state,Ft=ut[qe];if(!Ft){console.error("Variable not found");return}const{name:on,label:sn}=Ft.state,Ln=(0,Kr.No)(Re,{name:on,label:sn});this.replaceEditVariable(Ln)},this.onGoBack=()=>{this.setState({editIndex:void 0})},this.onValidateVariableName=(Re,qe)=>{let ut=null;Kr.cH.test(Re)||(ut="Template names cannot begin with '__', that's reserved for Grafana's global variables"),Kr.mJ.test(Re)||(ut="Only word characters are allowed in variable names");const Ft=this.getVariableSet().getByName(Re)?.state;return Ft&&Ft.key!==qe&&(ut="Variable with the same name already exists"),ut?[!0,ut]:[!1,null]}}static{this.Component=dt}getUrlKey(){return"variables"}getDashboard(){return(0,Te.YQ)(this)}getVariableSet(){return f.jh.getVariables(this.getDashboard())}getVariables(){return this.getVariableSet().state.variables}}function dt({model:Ge}){const Re=Ge.getDashboard(),{navModel:qe,pageNav:ut}=Pa(Re,Ge.getUrlKey()),{onDelete:Ft,onDuplicated:on,onOrderChanged:sn,onEdit:Ln,onTypeChange:qn,onGoBack:na,onAdd:Sa}=Ge,{variables:ka}=Ge.getVariableSet().useState(),{editIndex:Da}=Ge.useState();if(Da!==void 0&&ka[Da]){const ds=ka[Da];if(ds)return p.createElement(Pn,{variable:ds,onTypeChange:qn,onGoBack:na,pageNav:ut,navModel:qe,dashboard:Re,onDelete:Ft,onValidateVariableName:Ge.onValidateVariableName})}return p.createElement(_t.Y,{navModel:qe,pageNav:ut,layout:Je.k.Standard},p.createElement(Kt.c,{dashboard:Re}),p.createElement(Lo,{variables:ka,onDelete:Ft,onDuplicate:on,onChangeOrder:sn,onAdd:Sa,onEdit:Ln}))}function Pn({variable:Ge,pageNav:Re,navModel:qe,dashboard:ut,onTypeChange:Ft,onGoBack:on,onDelete:sn,onValidateVariableName:Ln}){const qn=Re.children.find(ka=>ka.active);qn.parentItem=Re;const{name:na}=Ge.useState(),Sa={text:na,parentItem:qn};return p.createElement(_t.Y,{navModel:qe,pageNav:Sa,layout:Je.k.Standard},p.createElement(Kt.c,{dashboard:ut}),p.createElement(Ro,{variable:Ge,onTypeChange:Ft,onGoBack:on,onDelete:sn,onValidateVariableName:Ln,key:Ge.state.key}))}const gn=10;class Jn extends f.Bs{constructor(Re){super({...Re,versions:[],isLoading:!0,isAppending:!0,viewMode:"list",isNewLatest:!1,diffData:{lhs:"",rhs:""}}),this._limit=gn,this._start=0,this.fetchVersions=(qe=!1)=>{const ut=this._dashboard.state.uid;ut&&(this.setState({isAppending:qe}),xt.wL.getHistoryList(ut,{limit:this._limit,start:this._start}).then(Ft=>{this.setState({isLoading:!1,versions:[...this.state.versions??[],...this.decorateVersions(Ft)]}),this._start+=this._limit}).catch(Ft=>console.log(Ft)).finally(()=>this.setState({isAppending:!1})))},this.getDiff=async()=>{const qe=this.versions.filter(qn=>qn.checked),[ut,Ft]=qe,on=ut.version===this._dashboard.state.version;if(this.setState({isLoading:!0}),!this._dashboard.state.uid)return;const sn=await xt.wL.getDashboardVersion(this._dashboard.state.uid,Ft.version),Ln=await xt.wL.getDashboardVersion(this._dashboard.state.uid,ut.version);this.setState({baseInfo:Ft,isLoading:!1,isNewLatest:on,newInfo:ut,viewMode:"compare",diffData:{lhs:sn.data,rhs:Ln.data}})},this.reset=()=>{this.setState({baseInfo:void 0,diffData:{lhs:"",rhs:""},isNewLatest:!1,newInfo:void 0,versions:this.versions.map(qe=>({...qe,checked:!1})),viewMode:"list"})},this.onCheck=(qe,ut)=>{this.setState({versions:this.versions.map(Ft=>Ft.id===ut?{...Ft,checked:qe.currentTarget.checked}:Ft)})},this.addActivationHandler(()=>{this.fetchVersions()})}static{this.Component=Zn}get _dashboard(){return(0,Te.YQ)(this)}get diffData(){return this.state.diffData??{lhs:"",rhs:""}}get versions(){return this.state.versions??[]}get limit(){return this._limit}get start(){return this._start}getUrlKey(){return"versions"}getDashboard(){return this._dashboard}getTimeRange(){return f.jh.getTimeRange(this._dashboard)}decorateVersions(Re){const qe=this.getTimeRange().getTimeZone();return Re.map(ut=>({...ut,createdDateString:(0,re.LE)(ut.created,{timeZone:qe}),ageString:(0,re.fq)(ut.created,{timeZone:qe}),checked:!1}))}}function Zn({model:Ge}){const Re=Ge.getDashboard(),{isLoading:qe,isAppending:ut,viewMode:Ft,baseInfo:on,newInfo:sn,isNewLatest:Ln}=Ge.useState(),{navModel:qn,pageNav:na}=Pa(Re,Ge.getUrlKey()),Sa=Ge.versions.filter(Cs=>Cs.checked).length===2,ka=Ge.versions.length>1,Da=Ge.versions.length>=Ge.limit,ds=Ge.versions.find(Cs=>Cs.version===1),Xa=p.createElement(p.Fragment,null,p.createElement(xt.me,{onClick:Ge.reset,baseVersion:on?.version,newVersion:sn?.version,isNewLatest:Ln}),qe?p.createElement(_n,{msg:"Fetching changes\u2026"}):p.createElement(xt.Cc,{newInfo:sn,baseInfo:on,isNewLatest:Ln,diffData:Ge.diffData,onRestore:Re.onRestore})),qs=p.createElement(p.Fragment,null,qe?p.createElement(_n,{msg:"Fetching history list\u2026"}):p.createElement(xt.bS,{versions:Ge.versions,onCheck:Ge.onCheck,canCompare:Sa,onRestore:Re.onRestore}),ut&&p.createElement(_n,{msg:"Fetching more entries\u2026"}),ka&&p.createElement(xt.rJ,{hasMore:Da,canCompare:Sa,getVersions:Ge.fetchVersions,getDiff:Ge.getDiff,isLastPage:!!ds}));return p.createElement(_t.Y,{navModel:qn,pageNav:na,layout:Je.k.Standard},p.createElement(Kt.c,{dashboard:Re}),Ft==="compare"?Xa:qs)}const _n=({msg:Ge})=>p.createElement(R.B,null,p.createElement(Yt.y,null),p.createElement("em",null,Ge));function Pa(Ge,Re){const qe=(0,St.zy)(),ut=(0,z.useSelector)(Ln=>Ln.navIndex),Ft=(0,m.tc)(ut,"dashboards/browse"),on=Ge.getPageNav(qe,ut),sn={text:"Settings",url:n.I.getUrlForPartial(qe,{editview:"settings",editIndex:null}),children:[],parentItem:on};return Ge.state.meta.canEdit&&(sn.children.push({text:(0,It.t)("dashboard-settings.general.title","General"),url:n.I.getUrlForPartial(qe,{editview:"settings",editIndex:null}),active:Re==="settings"}),sn.children.push({text:(0,It.t)("dashboard-settings.annotations.title","Annotations"),url:n.I.getUrlForPartial(qe,{editview:"annotations",editIndex:null}),active:Re==="annotations"}),sn.children.push({text:(0,It.t)("dashboard-settings.variables.title","Variables"),url:n.I.getUrlForPartial(qe,{editview:"variables",editIndex:null}),active:Re==="variables"}),sn.children.push({text:(0,It.t)("dashboard-settings.links.title","Links"),url:n.I.getUrlForPartial(qe,{editview:"links",editIndex:null}),active:Re==="links"})),Ge.state.id&&Ge.state.meta.canSave&&sn.children.push({text:(0,It.t)("dashboard-settings.versions.title","Versions"),url:n.I.getUrlForPartial(qe,{editview:"versions",editIndex:null}),active:Re==="versions"}),Ge.state.id&&Ge.state.meta.canAdmin&&js.contextSrv.hasPermission(z.AccessControlAction.DashboardsPermissionsRead)&&sn.children.push({text:(0,It.t)("dashboard-settings.permissions.title","Permissions"),url:n.I.getUrlForPartial(qe,{editview:"permissions",editIndex:null}),active:Re==="permissions"}),sn.children.push({text:(0,It.t)("dashboard-settings.json-editor.title","JSON Model"),url:n.I.getUrlForPartial(qe,{editview:"json-model",editIndex:null}),active:Re==="json-model"}),{navModel:Ft,pageNav:sn}}function Ca(Ge){switch(Ge){case"annotations":return new so({});case"variables":return new Ki({});case"links":return new zt({});case"versions":return new Jn({});case"json-model":return new At({});case"permissions":return new On({});case"settings":default:return new Ur({})}}class za extends f.Bs{constructor(Re){super(Re),this.addActivationHandler(this._activationHandler.bind(this))}_activationHandler(){const Re=this.state.panelRef.resolve(),qe=f.Go.cloneSceneObjectState(Re.state,{key:Re.state.key+"-view",$variables:this.getScopedVariables(Re)}),ut=new f.Eb(qe);return this.setState({body:ut}),()=>{ut.state.$data&&Re.setState({$data:ut.state.$data.clone()})}}getScopedVariables(Re){const qe=xs(Re),ut=[];if(qe&&qe.state.$variables)for(const Ft of qe.state.$variables.state.variables)ut.push(Ft.clone());if(Re.state.$variables)for(const Ft of Re.state.$variables.state.variables)ut.push(Ft.clone());if(ut.length>0)return new f.Pj({variables:ut})}getUrlKey(){return this.state.panelRef.resolve().state.key}static{this.Component=({model:Re})=>{const{body:qe}=Re.useState();return qe?p.createElement(qe.Component,{model:qe}):null}}}function xs(Ge){try{return f.jh.getAncestor(Ge,f.tI)}catch{return}}var ms=e(30195);class ls{constructor(Re){this._scene=Re}getKeys(){return["inspect","viewPanel","editPanel","editview","autofitpanels","kiosk"]}getUrlState(){const Re=this._scene.state;return{inspect:Re.inspectPanelKey,autofitpanels:Re.body instanceof f.hy&&Re.body.state.UNSAFE_fitPanels?"true":void 0,viewPanel:Re.viewPanelScene?.getUrlKey(),editview:Re.editview?.getUrlKey(),editPanel:Re.editPanel?.getUrlKey()||void 0,kiosk:Re.kioskMode===z.KioskMode.Full?"":Re.kioskMode===z.KioskMode.TV?"tv":void 0}}updateFromUrl(Re){const{inspectPanelKey:qe,viewPanelScene:ut,isEditing:Ft,editPanel:on}=this._scene.state,sn={};if(typeof Re.editview=="string"&&this._scene.canEditDashboard()?(sn.editview=Ca(Re.editview),Ft||(this._scene.state.editable?setTimeout(()=>this._scene.onEnterEditMode()):sn.editview=void 0)):Re.hasOwnProperty("editview")&&(sn.editview=void 0),typeof Re.inspect=="string"){let Ln=(0,Te.vL)(this._scene,Re.inspect);if(!Ln){d.A.emit(a.r1.alertError,["Panel not found"]),i.Ny.partial({inspect:null});return}if((0,Te.Yr)(Ln)){this._handleLibraryPanel(Ln,qn=>{if(qn.state.key===void 0)throw new Error("library panel key is undefined");const na=new Mr({$behaviors:[new Ws({panelKey:qn.state.key})]});this._scene.setState({overlay:na,inspectPanelKey:qn.state.key})});return}sn.inspectPanelKey=Re.inspect,sn.overlay=new Mr({$behaviors:[new Ws({panelKey:Re.inspect})]})}else qe&&(sn.inspectPanelKey=void 0,sn.overlay=void 0);if(typeof Re.viewPanel=="string"){const Ln=(0,Te.vL)(this._scene,Re.viewPanel);if(!Ln){if((0,Te.SN)(Re.viewPanel)){this._handleViewRepeatClone(Re.viewPanel);return}d.A.emit(a.r1.alertError,["Panel not found"]),i.Ny.partial({viewPanel:null});return}if((0,Te.Yr)(Ln)){this._handleLibraryPanel(Ln,qn=>this._buildLibraryPanelViewScene(qn));return}sn.viewPanelScene=new za({panelRef:Ln.getRef()})}else ut&&Re.viewPanel===null&&(sn.viewPanelScene=void 0);if(typeof Re.editPanel=="string"){const Ln=(0,Te.vL)(this._scene,Re.editPanel);if(!Ln){console.warn(`Panel ${Re.editPanel} not found`);return}if(this._scene.state.viewPanelScene&&this._scene.setState({viewPanelScene:void 0}),Ft||this._scene.onEnterEditMode(),(0,Te.Yr)(Ln)){this._handleLibraryPanel(Ln,qn=>{this._scene.setState({editPanel:(0,fr.L)(qn)})});return}sn.editPanel=(0,fr.L)(Ln)}else on&&Re.editPanel===null&&(sn.editPanel=void 0);if(this._scene.state.body instanceof f.hy){const Ln=typeof Re.autofitpanels=="string";!!this._scene.state.body.state.UNSAFE_fitPanels!==Ln&&this._scene.state.body.setState({UNSAFE_fitPanels:Ln})}typeof Re.kiosk=="string"&&(Re.kiosk==="true"||Re.kiosk===""?sn.kioskMode=z.KioskMode.Full:Re.kiosk==="tv"&&(sn.kioskMode=z.KioskMode.TV)),Object.keys(sn).length>0&&this._scene.setState(sn)}_buildLibraryPanelViewScene(Re){this._scene.setState({viewPanelScene:new za({panelRef:Re.getRef()})})}_handleLibraryPanel(Re,qe){if(!(Re.parent instanceof tt.F))throw new Error("Panel is not a child of a LibraryVizPanel");const ut=Re.parent;ut.state.isLoaded?qe(Re):(ut.subscribeToState(Ft=>{qe(Ft.panel)}),ut.activate())}_handleViewRepeatClone(Re){this._eventSub||(this._eventSub=this._scene.subscribeToEvent(ms.d,()=>{const qe=(0,Te.vL)(this._scene,Re);qe&&(this._eventSub?.unsubscribe(),this._scene.setState({viewPanelScene:new za({panelRef:qe.getRef()})}))}))}}class Ws extends f.Bs{constructor(Re){super(Re),this._onActivate=()=>{const qe=this.parent;if(!qe||!(qe instanceof Mr))throw new Error("ResolveInspectPanelByKey must be attached to a PanelInspectDrawer");const ut=(0,Te.YQ)(qe);if(!ut)return;const Ft=this.state.panelKey;let on=(0,Te.vL)(ut,Ft);ut.state.editPanel&&(on=ut.state.editPanel.state.vizManager.state.panel),ut.state.viewPanelScene&&ut.state.viewPanelScene.state.body&&(on=ut.state.viewPanelScene.state.body),on&&qe.setState({panelRef:on.getRef()})},this.addActivationHandler(this._onActivate)}}var is=e(79284),fs=e(54625),ys=e(76885),Ps=e(83277),Lr=e(2468);const Gr="scope.grafana.app",ei="v0alpha1",Ji=r.$.namespace??"default",ti=`/apis/${Gr}/${ei}/namespaces/${Ji}/find/scope_node_children`,di=`/apis/${Gr}/${ei}/namespaces/${Ji}/find/scope_dashboard_bindings`,$i=new Lr.w({group:Gr,version:ei,resource:"scopes"}),Oi=new Map;async function xo(Ge,Re){try{return(await(0,V.AI)().get(ti,{parent:Ge,query:Re}))?.items??[]}catch{return[]}}async function Vi(Ge,Re){return(await xo(Ge,Re)).reduce((qe,{metadata:{name:ut},spec:Ft})=>(qe[ut]={name:ut,...Ft,isExpandable:Ft.nodeType==="container",isSelectable:Ft.linkType==="scope",isExpanded:!1,query:"",nodes:{}},qe),{})}async function Zo(Ge){if(Oi.has(Ge))return Oi.get(Ge);const Re=new Promise(async qe=>{const ut={metadata:{name:Ge},spec:{filters:[],title:Ge,type:"",category:"",description:""}};try{const Ft=await $i.get(Ge),on={...ut,metadata:{...ut.metadata,...Ft.metadata},spec:{...ut.spec,...Ft.spec}};qe(on)}catch{Oi.delete(Ge),qe(ut)}});return Oi.set(Ge,Re),Re}async function yi(Ge){return await Promise.all(Ge.map(Zo))}async function Ii(Ge){try{return(await(0,V.AI)().get(di,{scope:Ge.map(({metadata:{name:qe}})=>qe)}))?.items??[]}catch{return[]}}class bi extends f.Bs{static{this.Component=$l}constructor(){super({dashboards:[],filteredDashboards:[],isLoading:!1,searchQuery:""})}async fetchDashboards(Re){if(Re.length===0)return this.setState({dashboards:[],filteredDashboards:[],isLoading:!1});this.setState({isLoading:!0});const qe=await Ii(Re);this.setState({dashboards:qe,filteredDashboards:this.filterDashboards(qe,this.state.searchQuery),isLoading:!1})}changeSearchQuery(Re){this.setState({filteredDashboards:Re?this.filterDashboards(this.state.dashboards,Re):this.state.dashboards,searchQuery:Re??""})}filterDashboards(Re,qe){const ut=qe.toLowerCase();return Re.filter(({spec:{dashboardTitle:Ft}})=>Ft.toLowerCase().includes(ut))}}function $l({model:Ge}){const{filteredDashboards:Re,isLoading:qe}=Ge.useState(),ut=(0,rt.of)(Vl),[Ft]=(0,Ps.s)();return p.createElement(p.Fragment,null,p.createElement("div",{className:ut.searchInputContainer},p.createElement(N.p,{prefix:p.createElement($t.I,{name:"search"}),placeholder:(0,It.t)("scopes.suggestedDashboards.search","Filter"),disabled:qe,"data-testid":"scopes-dashboards-search",onChange:on=>Ge.changeSearchQuery(on.currentTarget.value)})),qe?p.createElement(Js._,{className:ut.loadingIndicator,text:(0,It.t)("scopes.suggestedDashboards.loading","Loading dashboards"),"data-testid":"scopes-dashboards-loading"}):p.createElement(Rt.E,null,Re.map(({spec:{dashboard:on,dashboardTitle:sn}})=>p.createElement(fs.Link,{key:on,to:ys.kM.renderUrl(`/d/${on}/`,Ft),className:ut.dashboardItem,"data-testid":`scopes-dashboards-${on}`},sn))))}const Vl=Ge=>({searchInputContainer:(0,ye.css)({flex:"0 1 auto"}),loadingIndicator:(0,ye.css)({alignSelf:"center"}),dashboardItem:(0,ye.css)({padding:Ge.spacing(1,0),borderBottom:`1px solid ${Ge.colors.border.weak}`,"& :is(:first-child)":{paddingTop:0}})});function Ai({showQuery:Ge,nodes:Re,nodePath:qe,loadingNodeName:ut,scopeNames:Ft,onNodeUpdate:on,onNodeSelectToggle:sn}){const Ln=(0,rt.of)(Ri),qn=qe[qe.length-1],na=Re[qn],Sa=na.nodes,ka=Object.values(Sa),Da=ka.some(({isExpanded:Xa})=>Xa),ds=ka.some(({linkId:Xa})=>Xa&&Ft.includes(Xa));return p.createElement(p.Fragment,null,Ge&&!Da&&p.createElement(N.p,{prefix:p.createElement($t.I,{name:"filter"}),className:Ln.searchInput,disabled:!!ut,placeholder:(0,It.t)("scopes.tree.search","Filter"),defaultValue:na.query,"data-testid":`scopes-tree-${qn}-search`,onChange:(0,Yn.debounce)(Xa=>{on(qe,!0,Xa.target.value)},500)}),p.createElement("div",{role:"tree"},ka.map(Xa=>{const qs=Xa.isSelectable&&Ft.includes(Xa.linkId);if(Da&&!Xa.isExpanded&&!qs)return null;const Cs=[...qe,Xa.name];return p.createElement("div",{key:Xa.name,role:"treeitem","aria-selected":Xa.isExpanded},p.createElement("div",{className:Ln.itemTitle},Xa.isSelectable&&!Xa.isExpanded?p.createElement(ce.S,{checked:qs,disabled:!!ut||ds&&!qs&&na.disableMultiSelect,"data-testid":`scopes-tree-${Xa.name}-checkbox`,onChange:()=>{sn(Cs)}}):null,Xa.isExpandable&&p.createElement(lo.K,{disabled:ds&&!Xa.isExpanded||!!ut,name:Xa.isExpanded?ut===Xa.name?"spinner":"angle-down":"angle-right","aria-label":Xa.isExpanded?(0,It.t)("scopes.tree.collapse","Collapse"):(0,It.t)("scopes.tree.expand","Expand"),"data-testid":`scopes-tree-${Xa.name}-expand`,onClick:()=>{on(Cs,!Xa.isExpanded,Xa.query)}}),p.createElement("span",{"data-testid":`scopes-tree-${Xa.name}-title`},Xa.title)),p.createElement("div",{className:Ln.itemChildren},Xa.isExpanded&&p.createElement(Ai,{showQuery:Ge,nodes:na.nodes,nodePath:Cs,loadingNodeName:ut,scopeNames:Ft,onNodeUpdate:on,onNodeSelectToggle:sn})))})))}const Ri=Ge=>({searchInput:(0,ye.css)({margin:Ge.spacing(1,0)}),itemTitle:(0,ye.css)({alignItems:"center",display:"flex",gap:Ge.spacing(1),fontSize:Ge.typography.pxToRem(14),lineHeight:Ge.typography.pxToRem(22),padding:Ge.spacing(.5,0)}),itemChildren:(0,ye.css)({paddingLeft:Ge.spacing(4)})});function zl({model:Ge}){const Re=(0,rt.of)(ul),{nodes:qe,loadingNodeName:ut,dirtyScopeNames:Ft,isLoadingScopes:on,isAdvancedOpened:sn}=Ge.useState();return sn?p.createElement(E._,{title:(0,It.t)("scopes.advancedSelector.title","Select scopes"),size:"sm",onClose:()=>{Ge.closeAdvancedSelector(),Ge.resetDirtyScopeNames()}},on?p.createElement(Yt.y,{"data-testid":"scopes-advanced-loading"}):p.createElement(Ai,{showQuery:!0,nodes:qe,nodePath:[""],loadingNodeName:ut,scopeNames:Ft,onNodeUpdate:(Ln,qn,na)=>Ge.updateNode(Ln,qn,na),onNodeSelectToggle:Ln=>Ge.toggleNodeSelect(Ln)}),p.createElement("div",{className:Re.buttonGroup},p.createElement(C.$n,{variant:"primary","data-testid":"scopes-advanced-apply",onClick:()=>{Ge.closeAdvancedSelector(),Ge.updateScopes()}},p.createElement(It.x6,{i18nKey:"scopes.advancedSelector.apply"},"Apply")),p.createElement(C.$n,{variant:"secondary","data-testid":"scopes-advanced-cancel",onClick:()=>{Ge.closeAdvancedSelector(),Ge.resetDirtyScopeNames()}},p.createElement(It.x6,{i18nKey:"scopes.advancedSelector.cancel"},"Cancel")))):null}const ul=Ge=>({buttonGroup:(0,ye.css)({display:"flex",gap:Ge.spacing(1),marginTop:Ge.spacing(8)})});var Di=e(60782);function Os({model:Ge}){const Re=(0,rt.of)(_e),{nodes:qe,loadingNodeName:ut,scopes:Ft,dirtyScopeNames:on,isLoadingScopes:sn,isBasicOpened:Ln}=Ge.useState(),{isViewing:qn}=Ge.scopesParent.useState(),na=Ft.map(({spec:{title:Sa}})=>Sa).join(", ");return p.createElement("div",{className:Re.container,"data-testid":"scopes-basic-container"},p.createElement(Di.G,{show:Ln,closeButton:!1,content:p.createElement("div",{className:Re.innerContainer,"data-testid":"scopes-basic-inner-container"},sn?p.createElement(Yt.y,{"data-testid":"scopes-basic-loading"}):p.createElement(Ai,{showQuery:!1,nodes:qe,nodePath:[""],loadingNodeName:ut,scopeNames:on,onNodeUpdate:(Sa,ka,Da)=>Ge.updateNode(Sa,ka,Da),onNodeSelectToggle:Sa=>Ge.toggleNodeSelect(Sa)})),footer:p.createElement("button",{className:Re.openAdvancedButton,"data-testid":"scopes-basic-open-advanced",onClick:()=>Ge.openAdvancedSelector()},p.createElement(It.x6,{i18nKey:"scopes.basicSelector.openAdvanced"},"Open advanced scope selector ",p.createElement($t.I,{name:"arrow-right"}))),onOpen:()=>Ge.openBasicSelector(),onClose:()=>{Ge.closeBasicSelector(),Ge.updateScopes()}},p.createElement(N.p,{readOnly:!0,placeholder:(0,It.t)("scopes.basicSelector.placeholder","Select scopes..."),loading:sn,value:na,"aria-label":(0,It.t)("scopes.basicSelector.placeholder","Select scopes..."),"data-testid":"scopes-basic-input",suffix:Ft.length>0&&!qn?p.createElement(lo.K,{"aria-label":(0,It.t)("scopes.basicSelector.removeAll","Remove all scopes"),name:"times",onClick:()=>Ge.removeAllScopes()}):void 0})))}const _e=Ge=>({container:(0,ye.css)({width:"100%","& > div":(0,ye.css)({padding:0,"& > div":(0,ye.css)({padding:0,margin:0})})}),innerContainer:(0,ye.css)({minWidth:400,padding:Ge.spacing(0,1)}),openAdvancedButton:(0,ye.css)({backgroundColor:Ge.colors.secondary.main,border:"none",borderTop:`1px solid ${Ge.colors.secondary.border}`,display:"block",fontSize:Ge.typography.pxToRem(12),margin:0,padding:Ge.spacing(1.5),textAlign:"right",width:"100%"})});class et extends f.Bs{constructor(){super({nodes:{"":{name:"",nodeType:"container",title:"",isExpandable:!0,isSelectable:!1,isExpanded:!0,query:"",nodes:{}}},loadingNodeName:void 0,scopes:[],dirtyScopeNames:[],isLoadingScopes:!1,isBasicOpened:!1,isAdvancedOpened:!1}),this._urlSync=new f.So(this,{keys:["scopes"]}),this.addActivationHandler(()=>{this.fetchBaseNodes()})}static{this.Component=st}get scopesParent(){return f.jh.getAncestor(this,pt)}getUrlState(){return{scopes:this.getScopeNames()}}updateFromUrl(Re){let qe=Re.scopes??[];qe=Array.isArray(qe)?qe:[qe],this.updateScopes(qe)}fetchBaseNodes(){return this.updateNode([""],!0,"")}async updateNode(Re,qe,ut){let Ft={...this.state.nodes},on=Ft;for(let qn=0;qn<Re.length-1;qn++)on=on[Re[qn]].nodes;const sn=Re[Re.length-1],Ln=on[sn];(qe||Ln.query!==ut)&&(this.setState({loadingNodeName:sn}),Ln.nodes=await Vi(sn,ut)),Ln.isExpanded=qe,Ln.query=ut,this.setState({nodes:Ft,loadingNodeName:void 0})}toggleNodeSelect(Re){let qe=[...this.state.dirtyScopeNames],ut=this.state.nodes;for(let Ln=0;Ln<Re.length-1;Ln++)ut=ut[Re[Ln]].nodes;const Ft=Re[Re.length-1],{linkId:on}=ut[Ft],sn=qe.findIndex(Ln=>Ln===on);if(sn===-1){Zo(on);const Ln=qe.length===0||Object.values(ut).some(({linkId:qn})=>qn===qe[0]);this.setState({dirtyScopeNames:Ln?[...qe,on]:[on]})}else qe.splice(sn,1),this.setState({dirtyScopeNames:qe})}openBasicSelector(){this.scopesParent.state.isViewing||this.setState({isBasicOpened:!0,isAdvancedOpened:!1})}closeBasicSelector(){this.setState({isBasicOpened:!1})}openAdvancedSelector(){this.scopesParent.state.isViewing||this.setState({isBasicOpened:!1,isAdvancedOpened:!0})}closeAdvancedSelector(){this.setState({isAdvancedOpened:!1})}getSelectedScopes(){return this.state.scopes}async updateScopes(Re=this.state.dirtyScopeNames){(0,Yn.isEqual)(Re,this.getScopeNames())||(this.setState({dirtyScopeNames:Re,isLoadingScopes:!0}),this.setState({scopes:await yi(Re),isLoadingScopes:!1}))}resetDirtyScopeNames(){this.setState({dirtyScopeNames:this.getScopeNames()})}removeAllScopes(){this.setState({scopes:[],dirtyScopeNames:[],isLoadingScopes:!1})}enterViewMode(){this.setState({isBasicOpened:!1,isAdvancedOpened:!1})}getScopeNames(){return this.state.scopes.map(({metadata:{name:Re}})=>Re)}}function st({model:Ge}){return p.createElement(p.Fragment,null,p.createElement(Os,{model:Ge}),p.createElement(zl,{model:Ge}))}class pt extends f.Bs{static{this.Component=Wt}constructor(){super({dashboards:new bi,filters:new et,isExpanded:!1,isViewing:!1}),this.addActivationHandler(()=>{this._subs.add(this.state.filters.subscribeToState((Re,qe)=>{Re.scopes!==qe.scopes&&(this.state.isExpanded&&this.state.dashboards.fetchDashboards(Re.scopes),f.jh.getTimeRange(this.parent).onRefresh())})),this._subs.add(this.parent?.subscribeToState(Re=>{const qe="isEditing"in Re?!!Re.isEditing:!1;qe!==this.state.isViewing&&(qe?this.enterViewMode():this.exitViewMode())}))})}getSelectedScopes(){return this.state.filters.getSelectedScopes()}toggleIsExpanded(){const Re=!this.state.isExpanded;Re&&this.state.dashboards.fetchDashboards(this.getSelectedScopes()),this.setState({isExpanded:Re})}enterViewMode(){this.setState({isExpanded:!1,isViewing:!0}),this.state.filters.enterViewMode()}exitViewMode(){this.setState({isViewing:!1})}}function Wt({model:Ge}){const{filters:Re,dashboards:qe,isExpanded:ut,isViewing:Ft}=Ge.useState(),on=(0,rt.of)(Xt);return p.createElement("div",{className:(0,ye.cx)(on.container,ut&&on.containerExpanded)},p.createElement("div",{className:(0,ye.cx)(on.filtersContainer,ut&&on.filtersContainerExpanded)},!Ft&&p.createElement(lo.K,{name:"arrow-to-right",className:(0,ye.cx)(!ut&&on.iconNotExpanded),"aria-label":ut?(0,It.t)("scopes.root.collapse","Collapse scope filters"):(0,It.t)("scopes.root.expand","Expand scope filters"),"data-testid":"scopes-root-expand",onClick:()=>Ge.toggleIsExpanded()}),p.createElement(Re.Component,{model:Re})),ut&&!Ft&&p.createElement("div",{className:on.dashboardsContainer,"data-testid":"scopes-dashboards-container"},p.createElement(qe.Component,{model:qe})))}const Xt=Ge=>({container:(0,ye.css)({display:"flex",flexDirection:"column",gridArea:"scopes"}),containerExpanded:(0,ye.css)({backgroundColor:Ge.colors.background.primary,height:"100%"}),filtersContainer:(0,ye.css)({display:"flex",flex:"0 1 auto",flexDirection:"row",padding:Ge.spacing(2,2,2,2)}),filtersContainerExpanded:(0,ye.css)({borderBottom:`1px solid ${Ge.colors.border.weak}`,padding:Ge.spacing(2)}),iconNotExpanded:(0,ye.css)({transform:"scaleX(-1)"}),dashboardsContainer:(0,ye.css)({display:"flex",flex:"1 1 auto",flexDirection:"column",gap:Ge.spacing(3),overflow:"hidden",padding:Ge.spacing(2)})});var dn=e(69129),In=e(4898);class Hn{constructor(){this._binds=[]}addBinding(Re){In.R.bind(Re.key,qe=>{qe.preventDefault(),qe.stopPropagation(),qe.returnValue=!1,Re.onTrigger()},"keydown"),this._binds.push(Re)}removeAll(){this._binds.forEach(Re=>{In.R.unbind(Re.key,Re.type)}),this._binds=[]}}var ra=e(58441),Ba=e(7196);function wa(Ge){const Re=new Hn;let qe=null;const ut=Ge.canEditDashboard(),Ft=d.A.subscribe(dn.Tp,sn=>{typeof sn.payload.panelId=="string"&&(qe=sn.payload.panelId)});function on(sn,Ln){return()=>{const qn=f.jh.findObject(sn,na=>na.state.key===qe);if(qn&&qn instanceof f.Eb){Ln(qn);return}}}return Re.addBinding({key:"v",onTrigger:on(Ge,sn=>{Ge.state.viewPanelScene||i.Ny.push((0,gt.r7)(sn))})}),Re.addBinding({key:"p s",onTrigger:on(Ge,async sn=>{Ge.showModal(new ra.Z({panelRef:sn.getRef(),dashboardRef:Ge.getRef()}))})}),Re.addBinding({key:"i",onTrigger:on(Ge,async sn=>{i.Ny.push((0,gt.Uu)(sn))})}),Re.addBinding({key:"p x",onTrigger:on(Ge,async sn=>{const Ln=await(0,gt.Lp)(sn);Ln&&i.Ny.push(Ln)})}),Re.addBinding({key:"p l",onTrigger:on(Ge,Ba.vR)}),Re.addBinding({key:"d r",onTrigger:()=>f.jh.getTimeRange(Ge).onRefresh()}),Re.addBinding({key:"t z",onTrigger:()=>{Ua(Ge)}}),Re.addBinding({key:"ctrl+z",onTrigger:()=>{Ua(Ge)}}),Re.addBinding({key:"t left",onTrigger:()=>{Za(Ge,"left")}}),Re.addBinding({key:"t right",onTrigger:()=>{Za(Ge,"right")}}),ut&&(Re.addBinding({key:"e",onTrigger:on(Ge,async sn=>{if(sn.getRoot()instanceof Ya){const qn=(0,Te.Cs)(sn);Ge.state.editPanel||i.Ny.push((0,gt.e0)(qn))}})}),Re.addBinding({key:"d s",onTrigger:Ge.onOpenSettings}),Re.addBinding({key:"mod+s",onTrigger:()=>Ge.openSaveDrawer({})}),Re.addBinding({key:"p r",onTrigger:on(Ge,sn=>{Ge.state.isEditing&&(0,Ba.MI)(Ge,sn)})}),Re.addBinding({key:"p d",onTrigger:on(Ge,sn=>{Ge.state.isEditing&&Ge.duplicatePanel(sn)})})),()=>{Re.removeAll(),Ft.unsubscribe()}}function Ua(Ge){Ve.b4.getTimePicker(Ge)?.onZoom()}function Za(Ge,Re){const qe=Ve.b4.getTimePicker(Ge);qe&&(Re==="left"&&qe.onMoveBackward(),Re==="right"&&qe.onMoveForward())}const cs=["title","description","tags","editable","graphTooltip","links","meta"];class Ya extends f.Bs{constructor(Re){super({title:"Dashboard",meta:{},editable:!0,body:Re.body??new f.G1({children:[]}),links:Re.links??[],scopes:Re.uid&&r.$.featureToggles.scopeFilters?new pt:void 0,...Re}),this._urlSync=new ls(this),this._variableDependency=new Ks(this),this._fromExplore=!1,this.onEnterEditMode=(qe=!1)=>{this._fromExplore=qe,this._initialState=f.Go.cloneSceneObjectState(this.state),this._initialUrlState=i.Ny.getLocation(),this.setState({isEditing:!0}),this.propagateEditModeChange(),this._changeTracker.startTrackingChanges()},this.onRestore=async qe=>{const ut=await xt.wL.restoreDashboard(qe.uid,qe.version);if(!Number.isInteger(ut.version))return!1;const Ft={dashboard:new u.G(qe.data),meta:this.state.meta},on=(0,ot.wM)(Ft),sn=f.Go.cloneSceneObjectState(on.state);return sn.version=ut.version,this.setState(sn),this.exitEditMode({skipConfirm:!0,restoreInitialState:!1}),!0},this.onOpenSettings=()=>{i.Ny.partial({editview:"settings"})},this._changeTracker=new y.l(this),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=en}_activationHandler(){let Re=window.__grafanaSceneContext;window.__grafanaSceneContext=this,this.state.isEditing&&(this._initialUrlState=i.Ny.getLocation(),this._changeTracker.startTrackingChanges()),this.state.meta.isNew&&(this.onEnterEditMode(),this.setState({isDirty:!0})),!this.state.meta.isEmbedded&&this.state.uid&&b.t.watch(this.state.uid);let qe=()=>{};r.$.publicDashboardAccessToken||(qe=wa(this));const ut=new we(this);return(0,h.UA)().setCurrent(ut),()=>{window.__grafanaSceneContext=Re,qe(),this._changeTracker.terminate(),this.stopUrlSync(),ut.destroy(),b.t.leave()}}startUrlSync(){this.state.meta.isEmbedded||(0,f.Is)().initSync(this)}stopUrlSync(){(0,f.Is)().cleanUp(this)}saveCompleted(Re,qe,ut){this._initialSaveModel={...Re,id:qe.id,uid:qe.uid,version:qe.version},this._changeTracker.stopTrackingChanges(),this.setState({version:qe.version,isDirty:!1,uid:qe.uid,id:qe.id,meta:{...this.state.meta,uid:qe.uid,url:qe.url,slug:qe.slug,folderUid:ut,isNew:!1}}),this._changeTracker.startTrackingChanges()}propagateEditModeChange(){this.state.body instanceof f.hy&&(this.state.body.setState({isDraggable:this.state.isEditing,isResizable:this.state.isEditing}),(0,Te.X0)(this.state.body,!0))}exitEditMode({skipConfirm:Re,restoreInitialState:qe}){if(!this.canDiscard()){console.error("Trying to discard back to a state that does not exist, initialState undefined");return}if(!this.state.isDirty||Re){this.exitEditModeConfirmed(qe||this.state.isDirty);return}d.A.publish(new c.bY({title:"Discard changes to dashboard?",text:"You have unsaved changes to this dashboard. Are you sure you want to discard them?",icon:"trash-alt",yesText:"Discard",onConfirm:this.exitEditModeConfirmed.bind(this)}))}exitEditModeConfirmed(Re=!0){this._changeTracker.stopTrackingChanges(),this.stopUrlSync(),i.Ny.replace(n.I.getUrlForPartial(this._initialUrlState,{editPanel:null,editview:null,inspect:null,inspectTab:null})),this._fromExplore&&this.cleanupStateFromExplore(),Re?this.setState({...this._initialState,isEditing:!1}):this.setState({isEditing:!1}),this.startUrlSync(),this.propagateEditModeChange()}cleanupStateFromExplore(){this._fromExplore=!1,this._initialSaveModel?.panels&&(this._initialSaveModel.panels=this._initialSaveModel.panels.slice(1)),this._initialState&&this._initialState.body instanceof f.hy&&this._initialState.body.setState({children:this._initialState.body.state.children.slice(1)})}canDiscard(){return this._initialState!==void 0}pauseTrackingChanges(){this._changeTracker.stopTrackingChanges()}resumeTrackingChanges(){this._changeTracker.startTrackingChanges()}openSaveDrawer({saveAsCopy:Re,onSaveSuccess:qe}){this.state.isEditing&&this.setState({overlay:new Ze({dashboardRef:this.getRef(),saveAsCopy:Re,onSaveSuccess:qe})})}getPageNav(Re,qe){const{meta:ut,viewPanelScene:Ft,editPanel:on}=this.state;let sn={text:this.state.title,url:(0,gt.uZ)({uid:this.state.uid,slug:ut.slug,currentQueryParams:Re.search,updateQuery:{viewPanel:null,inspect:null,editview:null,editPanel:null,tab:null},isHomeDashboard:!ut.url&&!ut.slug&&!ut.isNew})};const{folderUid:Ln}=ut;if(Ln){const qn=(0,m.tc)(qe,`folder-dashboards-${Ln}`).main;qn.id!=="not-found"&&(sn={...sn,parentItem:qn})}return Ft&&(sn={text:"View panel",parentItem:sn,url:(0,gt.r7)(Ft.state.panelRef.resolve())}),on&&(sn={text:"Edit panel",parentItem:sn}),sn}getBodyToRender(){return this.state.viewPanelScene??this.state.body}getInitialState(){return this._initialState}addRow(Re){if(!(this.state.body instanceof f.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const qe=this.state.body,ut=qe.state.children.findIndex(on=>on instanceof f.tI),Ft=qe.state.children.splice(0,ut===-1?qe.state.children.length:ut).map(on=>on.clone());Ft&&Re.setState({children:Ft}),qe.setState({children:[Re,...qe.state.children]})}removeRow(Re,qe=!1){if(!(this.state.body instanceof f.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const ut=this.state.body,Ft=ut.state.children.filter(on=>on.state.key!==Re.state.key);if(!qe){const on=Re.state.children.map(Ln=>Ln.clone()),sn=ut.state.children.findIndex(Ln=>Ln.state.key===Re.state.key);Ft.splice(sn,0,...on)}ut.setState({children:Ft})}addPanel(Re){if(!(this.state.body instanceof f.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const qe=this.state.body,ut=(0,Te.Cs)(Re),Ft=new le.U({height:Te.sw,width:Te.vm,x:0,y:0,body:Re,key:`grid-item-${ut}`});qe.setState({children:[Ft,...qe.state.children]})}createLibraryPanel(Re,qe){if(!(this.state.body instanceof f.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const Ft=Re.state.key,on=new tt.F({title:qe.model?.title??"Panel",uid:qe.uid,name:qe.name,panelKey:Ft??(0,Te.XA)(Ve.b4.getNextPanelId(this))}),sn=Re.parent;if(!(sn instanceof le.U))throw new Error("Trying to replace a panel that doesn't have a parent grid item");sn.setState({body:on})}duplicatePanel(Re){if(!Re.parent)return;const qe=(0,Ve.WZ)(Re),ut=qe?qe.parent:Re.parent;if(!(ut instanceof le.U)){console.error("Trying to duplicate a panel in a layout that is not DashboardGridItem");return}let Ft,on,sn;const Ln=Ve.b4.getNextPanelId(this);if(qe){const na=f.Go.cloneSceneObjectState(ut.state);sn=new le.U({x:na.x,y:na.y,width:na.width,height:na.height,body:new tt.F({title:qe.state.title,uid:qe.state.uid,name:qe.state.name,panelKey:(0,Te.XA)(Ln)})})}else ut instanceof le.U?(Ft=f.Go.cloneSceneObjectState(ut.state.body.state),on=f.jh.getData(ut.state.body).clone()):(Ft=f.Go.cloneSceneObjectState(Re.state),on=f.jh.getData(Re).clone()),delete on.state.data?.alertState,sn=new le.U({x:ut.state.x,y:ut.state.y,height:Te.sw,width:Te.vm,body:new f.Eb({...Ft,$data:on,key:(0,Te.XA)(Ln)})});if(!(this.state.body instanceof f.hy)){console.error("Trying to duplicate a panel in a layout that is not SceneGridLayout ");return}const qn=this.state.body;if(ut.parent instanceof f.tI){const na=ut.parent;na.setState({children:[...na.state.children,sn]}),qn.forceRender();return}qn.setState({children:[...qn.state.children,sn]})}copyPanel(Re){if(!Re.parent)return;let qe=Re.parent;if(Re.parent instanceof tt.F){const Ft=Re.parent;if(!Ft.parent)return;qe=Ft.parent}if(!(qe instanceof le.U))throw console.error("Trying to copy a panel that is not DashboardGridItem child"),new Error("Trying to copy a panel that is not DashboardGridItem child");const ut=(0,Me.ZB)(qe);s.A.set(l.tH,JSON.stringify(ut)),d.A.emit(a.r1.alertSuccess,["Panel copied. Use **Paste panel** toolbar action to paste."])}pastePanel(){if(!(this.state.body instanceof f.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const Re=s.A.get(l.tH),qe=JSON.parse(Re),ut=new u.a(qe),Ft=ut.libraryPanel?(0,ot.Al)(ut):(0,ot.tt)(ut),on=this.state.body;if(!(Ft instanceof le.U))throw new Error("Cannot paste invalid grid item");const sn=Ve.b4.getNextPanelId(this);if(Ft instanceof le.U&&Ft.state.body instanceof tt.F){const Ln=(0,Te.XA)(sn);Ft.state.body.setState({panelKey:Ln});const qn=Ft.state.body.state.panel;qn instanceof f.Eb&&qn.setState({key:Ln})}else Ft instanceof le.U&&Ft.state.body?Ft.state.body.setState({key:(0,Te.XA)(sn)}):Ft instanceof le.U&&Ft.state.body.setState({key:(0,Te.XA)(sn)});Ft.setState({height:Te.sw,width:Te.vm,x:0,y:0,key:`grid-item-${sn}`}),on.setState({children:[Ft,...on.state.children]}),s.A.delete(l.tH)}removePanel(Re){const qe=[],ut=Re.parent instanceof tt.F?Re.parent.parent?.state.key:Re.parent?.state.key;if(!ut)return;let Ft;try{Ft=f.jh.getAncestor(Re,f.tI)}catch{Ft=void 0}if(Ft){Ft.state.children.forEach(sn=>{sn.state.key!==ut&&qe.push(sn)}),Ft.setState({children:qe}),this.state.body.forceRender();return}this.state.body.forEachChild(sn=>{sn.state.key!==ut&&qe.push(sn)});const on=this.state.body;(on instanceof f.hy||on instanceof f.G1)&&on.setState({children:qe})}unlinkLibraryPanel(Re){if(!Re.parent)return;const qe=Re.parent;if(!(qe instanceof le.U)){console.error("Trying to unlinka a lib panel in a layout that is not DashboardGridItem");return}qe?.setState({body:Re.state.panel?.clone()})}showModal(Re){this.setState({overlay:Re})}closeModal(){this.setState({overlay:void 0})}async onStarDashboard(){const{meta:Re,uid:qe}=this.state;if(qe)try{const ut=await(0,h.UA)().starDashboard(qe,!!Re.isStarred);this.setState({meta:{...Re,isStarred:ut}})}catch(ut){console.error("Failed to star dashboard",ut)}}onShowAddLibraryPanelDrawer(Re){this.setState({overlay:new bt.o({panelToReplaceRef:Re})})}onCreateNewRow(){const Re=(0,Te.Ws)(this);return this.addRow(Re),(0,Te.Cs)(Re)}onCreateNewPanel(){this.state.isEditing||this.onEnterEditMode();const Re=(0,Te.O8)(this);return this.addPanel(Re),Re}enrichDataRequest(Re){const qe=(0,Te.YQ)(Re);let ut=(0,Te.xz)(Re);qe.state.isEditing&&qe.state.editPanel&&(ut=qe.state.editPanel.state.vizManager.state.panel);let Ft=0;return ut&&ut.state.key&&((0,Te.SN)(ut.state.key)?Ft=ht(ut?.state.key):Ft=(0,Te.Cs)(ut)),{app:o.Jk.Dashboard,dashboardUID:this.state.uid,panelId:Ft,panelPluginId:ut?.state.pluginId,scopes:this.state.scopes?.getSelectedScopes()}}canEditDashboard(){const{meta:Re}=this.state;return!!(Re.canEdit||Re.canMakeEditable)}getInitialSaveModel(){return this._initialSaveModel}setInitialSaveModel(Re){this._initialSaveModel=Re}async deleteDashboard(){await(0,g.A_)(this.state.uid,!0),this.setState({isDirty:!1}),i.Ny.replace("/")}}class Ks{constructor(Re){this._dashboard=Re,this._emptySet=new Set}getNames(){return this._emptySet}hasDependencyOn(){return!1}variableUpdateCompleted(Re,qe){qe&&d.A.publish(new P.og({refreshAll:!0,panelIds:[]}));const ut=this._dashboard.state.body;if(ut instanceof f.hy){for(const Ft of ut.state.children)if(!(!(Ft instanceof f.tI)||!Ft.state.$behaviors))for(const on of Ft.state.$behaviors)on instanceof is.L&&(on.isWaitingForVariables||on.state.variableName===Re.state.name&&qe)&&on.performRepeat()}}}},60656:(Q,I,e)=>{"use strict";e.d(I,{F:()=>s});var n=e(96540),a=e(16401),o=e(34214),r=e(57767),i=e(96556),f=e(41507),d=e(42397),l=e(7196),m=e(99589);class s extends a.Bs{constructor(g){super({panel:g.panel??h(g.title,g.panelKey),isLoaded:g.isLoaded??!1,...g}),this._onActivate=()=>{this.state.isLoaded||this.loadLibraryPanelFromPanelModel()},this.addActivationHandler(this._onActivate)}static{this.Component=u}setPanelFromLibPanel(g){if(this.state._loadedPanel?.version===g.version)return;const P=new o.a(g.model),c={title:P.title,key:this.state.panelKey,options:P.options??{},fieldConfig:P.fieldConfig,pluginId:P.type,pluginVersion:P.pluginVersion,displayMode:P.transparent?"transparent":void 0,description:P.description,hoverHeader:!P.title&&!P.timeFrom&&!P.timeShift,hoverHeaderOffset:0,$data:(0,i.w)(P),menu:new a.Lw({$behaviors:[l._i]}),titleItems:[new d.$({rawLinks:P.links,menu:new d.m({$behaviors:[l.oV]})}),new m.W]},y=new a.Eb(c);this.setState({panel:y,_loadedPanel:g,isLoaded:!0,name:g.name})}async loadLibraryPanelFromPanelModel(){let g=this.state.panel;try{const P=await(0,r.Yr)(this.state.uid,!0);this.setPanelFromLibPanel(P),this.parent instanceof f.U&&this.parent.setState({variableName:P.model.repeat,repeatDirection:P.model.repeatDirection==="h"?"h":"v",maxPerRow:P.model.maxPerRow})}catch{g.setState({_pluginLoadError:`Unable to load library panel: ${this.state.uid}`})}}}function h(b,g){return new a.Eb({key:g,title:b,menu:new a.Lw({$behaviors:[l._i]})})}function u({model:b}){const{panel:g}=b.useState();return g?n.createElement(g.Component,{model:g}):null}},31807:(Q,I,e)=>{"use strict";e.d(I,{c:()=>H});var n=e(32196),a=e(96540),o=e(13544),r=e(32264),i=e(12131),f=e(40845),d=e(27746),l=e(14578),m=e(39938),s=e(83122),h=e(38138),u=e(55852),b=e(19727),g=e(15068),P=e(75269),c=e(10804),y=e(15054),p=e(10096),v=e(8484),D=e(33390),E=e(14792),S=e(2609),T=e(19293),M=e(41053),A=e(7030),x=e(7758);const C=o.Tp.pages.Dashboard.DashNav.newShareButton.menu;function O({dashboard:ne}){const[ee,Z]=(0,M.A)(async()=>await(0,A.fv)(ne,{useAbsoluteTimeRange:!0,theme:"current"}),[ne]);return a.createElement(h.W,{"data-testid":C.container},a.createElement(h.W.Item,{testId:C.shareInternally,label:"Share internally",description:"Copy link",icon:"building",onClick:Z}))}const R=o.Tp.pages.Dashboard.DashNav.newShareButton;function L({dashboard:ne}){const[ee,Z]=(0,a.useState)(!1),[z,q]=(0,M.A)(async()=>await(0,A.fv)(ne,{useAbsoluteTimeRange:!0,theme:"current"}),[ne]),ie=(0,a.useCallback)(ue=>{ue&&x.c.toolbarShareClick(),Z(ue)},[]),de=()=>a.createElement(O,{dashboard:ne});return a.createElement(b.e,{"data-testid":R.container},a.createElement(u.$n,{"data-testid":R.shareLink,size:"sm",tooltip:"Copy shortened URL",onClick:q},"Share"),a.createElement(s.m,{overlay:de,placement:"bottom-end",onVisibleChange:ie},a.createElement(u.$n,{"data-testid":R.arrowMenu,size:"sm",icon:ee?"angle-up":"angle-down"})))}var N=e(58441),F=e(99246),K=e(40672),B=e(96374),w=e(28138),U=e(28444);function W(ne){return a.createElement(d.I,{key:"button-snapshot","data-testid":"button-snapshot",tooltip:(0,v.t)("dashboard.toolbar.open-original","Open original dashboard"),icon:"link",onClick:()=>V(ne.originalURL)})}const V=ne=>{const ee=ne??"",Z=K.sQ.sanitizeUrl(ee);try{const z=new URL(Z,r.$.appUrl),q=new URL(r.$.appUrl);z.host!==q.host?w.A.publish(new U.S8({component:B.u,props:{title:"Proceed to external site?",modalClass:(0,n.css)({width:"max-content",maxWidth:"80vw"}),body:a.createElement(a.Fragment,null,a.createElement("p",null,"This link connects to an external website at"," ",a.createElement("code",null,ee)),a.createElement("p",null,"Are you sure you'd like to proceed?")),confirmVariant:"primary",confirmText:"Proceed",onConfirm:()=>{window.location.href=z.href}}})):i.Ny.push(Z)}catch(z){console.error("Failed to open original dashboard",z)}};var _=e(60656);const H=a.memo(({dashboard:ne})=>{const ee=(0,a.useId)(),Z=a.createElement(G,{dashboard:ne,key:ee});return a.createElement(P.H,{actions:Z})});H.displayName="NavToolbarActions";function G({dashboard:ne}){const{isEditing:ee,viewPanelScene:Z,isDirty:z,uid:q,meta:ie,editview:de,editPanel:ue,editable:fe}=ne.useState(),{isPlaying:Se}=S._o.useState(),[he,ce]=(0,a.useState)(!1),me=p.contextSrv.hasEditPermissionInFolders,pe=[],ye=(0,f.of)(se),Pe=!!ue,Ie=!!Z,Oe=oe(ue),Ne=Y(ue),We=D.A.exists(y.tH),Ae=!de&&!Ie&&!Pe,Ue=ee&&Ae;Pe||j(pe,F.C.left,"left-actions"),pe.push({group:"icon-actions",condition:q&&!!ie.canStar&&Ae&&!ee,render:()=>{let ot=ie.isStarred?(0,v.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,v.t)("dashboard.toolbar.mark-favorite","Mark as favorite");return a.createElement(d.I,{tooltip:ot,icon:a.createElement(l.I,{name:ie.isStarred?"favorite":"star",size:"lg",type:ie.isStarred?"mono":"default"}),key:"star-dashboard-button","data-testid":o.Tp.components.NavToolbar.markAsFavorite,onClick:()=>{x.c.toolbarFavoritesClick(),ne.onStarDashboard()}})}}),ie.publicDashboardEnabled&&pe.push({group:"icon-actions",condition:q&&!!ie.canStar&&Ae&&!ee,render:()=>a.createElement(m.E,{color:"blue",text:"Public",key:"public-dashboard-button-badge",className:ye.publicBadge,"data-testid":o.Tp.pages.Dashboard.DashNav.publicDashboardTag})});const Me=r.$.buildInfo.env==="development";pe.push({group:"icon-actions",condition:Me&&q&&Ae&&!ee,render:()=>a.createElement(d.I,{key:"view-in-old-dashboard-button",tooltip:"Switch to old dashboard page",icon:"apps",onClick:()=>{i.Ny.partial({scenes:!1})}})}),pe.push({group:"icon-actions",condition:ie.isSnapshot&&!ee,render:()=>a.createElement(W,{key:"go-to-snapshot-origin",originalURL:ne.getInitialSaveModel()?.snapshot?.originalUrl??""})}),!Pe&&!ee&&j(pe,F.C.right,"icon-actions"),pe.push({group:"add-panel",condition:Ue,render:()=>a.createElement(s.m,{key:"add-panel-dropdown",onVisibleChange:ot=>{ce(ot),x.c.toolbarAddClick()},overlay:()=>a.createElement(h.W,null,a.createElement(h.W.Item,{key:"add-visualization",testId:o.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,v.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const ot=ne.onCreateNewPanel();x.c.toolbarAddButtonClicked({item:"add_visualization"}),ne.setState({editPanel:(0,T.L)(ot,!0)})}}),a.createElement(h.W.Item,{key:"add-panel-lib",testId:o.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,v.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{ne.onShowAddLibraryPanelDrawer(),x.c.toolbarAddButtonClicked({item:"add_library_panel"})}}),a.createElement(h.W.Item,{key:"add-row",testId:o.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,v.t)("dashboard.add-menu.row","Row"),onClick:()=>{ne.onCreateNewRow(),x.c.toolbarAddButtonClicked({item:"add_row"})}}),a.createElement(h.W.Item,{key:"paste-panel",disabled:!We,testId:o.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,v.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{ne.pastePanel(),x.c.toolbarAddButtonClicked({item:"paste_panel"})}})),placement:"bottom",offset:[0,6]},a.createElement(u.$n,{key:"add-panel-button",variant:"primary",size:"sm",fill:"outline","data-testid":o.Tp.components.PageToolbar.itemButton("Add button")},a.createElement(v.x6,{i18nKey:"dashboard.toolbar.add"},"Add"),a.createElement(l.I,{name:he?"angle-up":"angle-down",size:"lg"})))}),pe.push({group:"playlist-actions",condition:Se&&Ae&&!ee,render:()=>a.createElement(d.I,{key:"play-list-prev","data-testid":o.Tp.pages.Dashboard.DashNav.playlistControls.prev,tooltip:(0,v.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:()=>S._o.prev()})}),pe.push({group:"playlist-actions",condition:Se&&Ae&&!ee,render:()=>a.createElement(d.I,{key:"play-list-stop",onClick:()=>S._o.stop(),"data-testid":o.Tp.pages.Dashboard.DashNav.playlistControls.stop},a.createElement(v.x6,{i18nKey:"dashboard.toolbar.playlist-stop"},"Stop playlist"))}),pe.push({group:"playlist-actions",condition:Se&&Ae&&!ee,render:()=>a.createElement(d.I,{key:"play-list-next","data-testid":o.Tp.pages.Dashboard.DashNav.playlistControls.next,tooltip:(0,v.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:()=>S._o.next(),narrow:!0})}),pe.push({group:"back-button",condition:(Ie||Pe)&&!Ne,render:()=>a.createElement(u.$n,{onClick:()=>{i.Ny.partial({viewPanel:null,editPanel:null})},tooltip:"",key:"back",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":o.Tp.components.NavToolbar.editDashboard.backToDashboardButton},"Back to dashboard")}),pe.push({group:"back-button",condition:!!de,render:()=>a.createElement(u.$n,{onClick:()=>{i.Ny.partial({editview:null})},tooltip:"",key:"back",fill:"text",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":o.Tp.components.NavToolbar.editDashboard.backToDashboardButton},"Back to dashboard")});const $e=q&&!ee&&!ie.isSnapshot&&!Se;pe.push({group:"main-buttons",condition:!r.$.featureToggles.newDashboardSharingComponent&&$e,render:()=>a.createElement(u.$n,{key:"share-dashboard-button",tooltip:(0,v.t)("dashboard.toolbar.share","Share dashboard"),size:"sm",className:ye.buttonWithExtraMargin,fill:"outline",onClick:()=>{x.c.toolbarShareClick(),ne.showModal(new N.Z({dashboardRef:ne.getRef()}))},"data-testid":o.Tp.components.NavToolbar.shareDashboard},"Share")}),pe.push({group:"main-buttons",condition:!ee&&ne.canEditDashboard()&&!Ie&&!Se&&fe,render:()=>a.createElement(u.$n,{onClick:()=>{ne.onEnterEditMode()},tooltip:"Enter edit mode",key:"edit",className:ye.buttonWithExtraMargin,variant:r.$.featureToggles.newDashboardSharingComponent?"secondary":"primary",size:"sm","data-testid":o.Tp.components.NavToolbar.editDashboard.editButton},"Edit")}),pe.push({group:"main-buttons",condition:!ee&&ne.canEditDashboard()&&!Ie&&!Se&&!fe,render:()=>a.createElement(u.$n,{onClick:()=>{ne.onEnterEditMode(),ne.setState({editable:!0,meta:{...ie,canEdit:!0}})},tooltip:"This dashboard was marked as read only",key:"edit",className:ye.buttonWithExtraMargin,variant:"secondary",size:"sm","data-testid":o.Tp.components.NavToolbar.editDashboard.editButton},"Make editable")}),pe.push({group:"new-share-dashboard-button",condition:r.$.featureToggles.newDashboardSharingComponent&&$e,render:()=>a.createElement(L,{key:"new-share-dashboard-button",dashboard:ne})}),pe.push({group:"settings",condition:ee&&ne.canEditDashboard()&&Ae,render:()=>a.createElement(u.$n,{onClick:()=>{ne.onOpenSettings()},tooltip:"Dashboard settings",fill:"text",size:"sm",key:"settings",variant:"secondary","data-testid":o.Tp.components.NavToolbar.editDashboard.settingsButton},"Settings")}),pe.push({group:"main-buttons",condition:ee&&!ie.isNew&&Ae,render:()=>a.createElement(u.$n,{onClick:()=>ne.exitEditMode({skipConfirm:!1}),tooltip:"Exits edit mode and discards unsaved changes",size:"sm",key:"discard",fill:"text",variant:"primary","data-testid":o.Tp.components.NavToolbar.editDashboard.exitButton},"Exit edit")}),pe.push({group:"main-buttons",condition:Pe&&!Ne&&!de&&!Ie,render:()=>a.createElement(u.$n,{onClick:ue?.onDiscard,tooltip:ue?.state.isNewPanel?"Discard panel":"Discard panel changes",size:"sm",disabled:!Oe||!z,key:"discard",fill:"outline",variant:"destructive","data-testid":o.Tp.components.NavToolbar.editDashboard.discardChangesButton},ue?.state.isNewPanel?"Discard panel":"Discard panel changes")}),pe.push({group:"main-buttons",condition:Pe&&Ne&&!de&&!Ie,render:()=>a.createElement(u.$n,{onClick:ue?.onDiscard,tooltip:"Discard library panel changes",size:"sm",key:"discardLibraryPanel",fill:"outline",variant:"destructive","data-testid":o.Tp.components.NavToolbar.editDashboard.discardChangesButton},"Discard library panel changes")}),pe.push({group:"main-buttons",condition:Pe&&Ne&&!de&&!Ie,render:()=>a.createElement(u.$n,{onClick:ue?.onUnlinkLibraryPanel,tooltip:"Unlink library panel",size:"sm",key:"unlinkLibraryPanel",fill:"outline",variant:"secondary","data-testid":o.Tp.components.NavToolbar.editDashboard.unlinkLibraryPanelButton},"Unlink library panel")}),pe.push({group:"main-buttons",condition:Pe&&Ne&&!de&&!Ie,render:()=>a.createElement(u.$n,{onClick:ue?.onSaveLibraryPanel,tooltip:"Save library panel",size:"sm",key:"saveLibraryPanel",fill:"outline",variant:"primary","data-testid":o.Tp.components.NavToolbar.editDashboard.saveLibraryPanelButton},"Save library panel")}),pe.push({group:"main-buttons",condition:ee&&!Ne&&(ie.canSave||me),render:()=>{if(ie.isNew)return a.createElement(u.$n,{onClick:()=>{x.c.toolbarSaveClick(),ne.openSaveDrawer({})},className:ye.buttonWithExtraMargin,tooltip:"Save changes",key:"save",size:"sm",variant:"primary","data-testid":o.Tp.components.NavToolbar.editDashboard.saveButton},"Save dashboard");if(me&&!ie.canSave&&!ie.canMakeEditable)return a.createElement(u.$n,{onClick:()=>{x.c.toolbarSaveClick(),ne.openSaveDrawer({saveAsCopy:!0})},className:ye.buttonWithExtraMargin,tooltip:"Save as copy",key:"save",size:"sm",variant:z?"primary":"secondary"},"Save as copy");const ot=a.createElement(h.W,null,a.createElement(h.W.Item,{label:"Save",icon:"save",onClick:()=>{x.c.toolbarSaveClick(),ne.openSaveDrawer({})}}),a.createElement(h.W.Item,{label:"Save as copy",icon:"copy",onClick:()=>{x.c.toolbarSaveAsClick(),ne.openSaveDrawer({saveAsCopy:!0})}}));return a.createElement(b.e,{className:ye.buttonWithExtraMargin,key:"save"},a.createElement(u.$n,{onClick:()=>{x.c.toolbarSaveClick(),ne.openSaveDrawer({})},tooltip:"Save changes",size:"sm","data-testid":o.Tp.components.NavToolbar.editDashboard.saveButton,variant:z?"primary":"secondary"},"Save dashboard"),a.createElement(s.m,{overlay:ot},a.createElement(u.$n,{icon:"angle-down",variant:z?"primary":"secondary",size:"sm"})))}});const ke=[];let Ze="";for(const ot of pe)ot.condition&&(Ze&&Ze!==ot.group&&Ze&&ke.push(a.createElement(c.K,{key:`${ot.group}-separator`})),ke.push(ot.render()),Ze=ot.group);return a.createElement(g.U,{alignment:"right"},ke)}function j(ne,ee,Z){if(ee.length>0)for(const z of ee){const q={dashboard:(0,E.UA)().getCurrent()};if(z.show(q)){const ie=z.component;ne.push({group:Z,condition:!0,render:()=>a.createElement(ie,{...q,key:ne.length})})}}}function Y(ne){const[ee,Z]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{if(ne){const z=ne.state.vizManager.subscribeToState(q=>Z(q.sourcePanel.resolve().parent instanceof _.F));return()=>{z.unsubscribe()}}Z(!1)},[ne]),ee}function oe(ne){const[ee,Z]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{if(ne){const z=ne.state.vizManager.subscribeToState(q=>Z(q.isDirty||!1));return()=>{z.unsubscribe()}}Z(!1)},[ne]),ee}function se(ne){return{buttonWithExtraMargin:(0,n.css)({margin:ne.spacing(0,.5)}),publicBadge:(0,n.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})}}},42397:(Q,I,e)=>{"use strict";e.d(I,{$:()=>m,m:()=>h});var n=e(96540),a=e(16401),o=e(91052),r=e(14578),i=e(83122),f=e(27746),d=e(38138),l=e(7196);class m extends a.Bs{static{this.Component=s}}function s({model:b}){const{menu:g,rawLinks:P}=b.useState();if(!(b.parent instanceof a.Eb))throw new Error("VizPanelLinks must be a child of VizPanel");if(!P||P.length===0)return null;if(P.length===1){const c=(0,l.eQ)(b.parent)[0];return n.createElement(o.NR.TitleItem,{href:c.href,onClick:c.onClick,target:c.target,title:c.title},n.createElement(r.I,{name:"external-link-alt",size:"md"}))}return n.createElement(i.m,{overlay:()=>n.createElement(g.Component,{model:g,key:g.state.key})},n.createElement(f.I,{icon:"external-link-alt",iconSize:"md","aria-label":"panel links"}))}class h extends a.Bs{static{this.Component=u}}function u({model:b}){const{links:g}=b.useState();return g?n.createElement(d.W,null,g?.map((P,c)=>n.createElement(d.W.Item,{key:c,label:P.title,url:P.href,target:P.target,onClick:P.onClick}))):null}},7196:(Q,I,e)=>{"use strict";e.d(I,{eQ:()=>me,MI:()=>ye,oV:()=>ce,_i:()=>ue,t0:()=>fe,vR:()=>Ie});var n=e(74135),a=e(1933),o=e(76885),r=e(32264),i=e(4402),f=e(12131),d=e(16401),l=e(28138),m=e(8484),s=e(63066),h=e(22699),u=e(16560),b=e(32349),g=e(75462),P=e(19347),c=e(74730),y=e(75176),p=e(40588),v=e(96540),D=e(56833);class E extends d.Bs{static{this.Component=S}constructor(Ae){super(Ae),this.trail=T(Ae)}}function S({model:We}){return v.createElement(We.trail.Component,{model:We.trail})}function T({metric:We,filters:Ae,dataSourceUid:Ue,timeRange:Me}){return new D.b({$timeRange:Me,metric:We,initialDS:Ue,initialFilters:Ae,embedded:!0})}var M=e(32196),A=e(40845),x=e(87978),C=e(28444);function O(We){const{scene:Ae,title:Ue,onDismiss:Me}=We,$e=(0,A.of)(N);return v.createElement(x._,{title:Ue,onClose:Me,size:"lg"},v.createElement("div",{className:$e.drawerInnerWrapper},v.createElement(Ae.Component,{model:Ae})))}class R extends d.Bs{constructor(Ae){super(Ae)}static Component({model:Ae}){const Ue=Ae.useState();return v.createElement(O,{...Ue})}}function L(We){const Ae={component:O,props:We};appEvents.publish(new ShowModalReactEvent(Ae))}function N(We){return{drawerInnerWrapper:(0,M.css)({display:"flex",padding:We.spacing(2),background:We.isDark?We.colors.background.canvas:We.colors.background.primary,position:"absolute",left:0,right:0,top:0})}}var F=e(76040);function K(We){return We.op==="="}function B(We){return We.state.$timeRange.clone()}function w({metric:We,labelFilters:Ae}){if(Ae.length===0)return We;const Ue=`{${Ae.map(({label:Me,op:$e,value:ke})=>`${Me}${$e}"${ke}"`)}}`;return`${We}${Ue}`}function U(We){return We?.map(Ae=>({key:Ae.label,value:Ae.value,operator:Ae.op}))}function W(We){const Ae=[];return We.forEach(Ue=>{const Me=(0,F.u)(Ue);if(Me.errors.length>0)return;const{metric:$e,labels:ke}=Me.query;Ae.push({metric:$e,labelFilters:ke.filter(K),query:Ue}),Me.query.binaryQueries?.forEach(({query:{metric:Ze,labels:ot}})=>{Ae.push({metric:Ze,labelFilters:ot.filter(K),query:Ue})})}),Ae}async function V(We,Ae,Ue){if(Ae.state.pluginId!=="timeseries")return;const Me=(0,c.un)(Ae);if(Me==null)return;const{queries:$e,datasource:ke,data:Ze}=Me.state;if(ke==null||ke.type!=="prometheus")return;const ot=await(0,P.l)().get(ke);if(ot.interpolateVariablesInQueries==null)return;const xt=ot.interpolateVariablesInQueries($e,{__sceneObject:{value:Ae}},Ze?.request?.filters).filter(Y),ft=W(xt.map(Le=>Le.expr)).map(Le=>({text:w(Le),onClick:j(Le,We,ot)}));ft.length>0&&Ue.push({text:"Explore metrics",iconClassName:"code-branch",subMenu:_(ft)})}function _(We){const Ae=new Set;function Ue({text:Me}){const $e=Ae.size;return Ae.add(Me),Ae.size>$e}return We.filter(Ue)}function H({metric:We,labelFilters:Ae,query:Ue},Me,$e){return{metric:We,filters:U(Ae),dataSourceUid:$e,timeRange:Me}}function G(We,Ae,Ue){const Me=B(Ae),$e=H(We,Me,Ue.uid),ke=new E($e);return ke.trail.addActivationHandler(()=>{ke.trail.state.topScene instanceof y.R&&ke.trail.state.topScene.setActionView("breakdown")}),{scene:ke,title:"Explore metrics"}}function j(We,Ae,Ue){return()=>{const Me=G(We,Ae,Ue),$e=new R({...Me,onDismiss:()=>Ae.closeModal()});(0,p.z)("exploration_started",{cause:"dashboard_panel"}),Ae.showModal($e)}}function Y(We){return"expr"in We}var oe=e(58441),se=e(7758),ne=e(11982),ee=e(24283),Z=e(60656),z=e(42397),q=e(54174);class ie extends d.Bs{constructor(){super(...arguments),this.onDismiss=()=>{(0,c.YQ)(this).closeModal()},this.onConfirm=()=>{const Ae=(0,c.YQ)(this);Ae.unlinkLibraryPanel(this.state.panelRef.resolve()),Ae.closeModal()}}static{this.Component=de}}function de({model:We}){return v.createElement(q.l,{isOpen:!0,onConfirm:()=>{We.onConfirm(),We.onDismiss()},onDismiss:We.onDismiss})}function ue(We,Ae=!1){(async()=>{const Me=We.parent,$e=Me.parent,ke=Me.getPlugin(),Ze=[],ot=[],xt=(0,c.YQ)(Me),{isEmbedded:ct}=xt.state.meta,ft=await Se(Me);if(ct){ft&&We.setState({items:[ft]});return}const Le=!!xt.state.editPanel;Le||Ze.push({text:(0,m.t)("panel.header-menu.view","View"),iconClassName:"eye",shortcut:"v",onClick:()=>se.c.panelMenuItemClicked("view"),href:(0,ne.r7)(Me)}),xt.canEditDashboard()&&xt.state.editable&&!Ae&&!Le&&Ze.push({text:(0,m.t)("panel.header-menu.edit","Edit"),iconClassName:"edit",shortcut:"e",onClick:()=>se.c.panelMenuItemClicked("edit"),href:(0,ne.e0)((0,c.Cs)(Me))}),Ze.push({text:(0,m.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",onClick:()=>{se.c.panelMenuItemClicked("share"),xt.showModal(new oe.Z({panelRef:Me.getRef(),dashboardRef:xt.getRef()}))},shortcut:"p s"}),xt.state.isEditing&&!Ae&&!Le&&ot.push({text:(0,m.t)("panel.header-menu.duplicate","Duplicate"),onClick:()=>{se.c.panelMenuItemClicked("duplicate"),xt.duplicatePanel(Me)},shortcut:"p d"}),Le||ot.push({text:(0,m.t)("panel.header-menu.copy","Copy"),onClick:()=>{se.c.panelMenuItemClicked("copy"),xt.copyPanel(Me)}}),xt.state.isEditing&&!Ae&&!Le&&($e instanceof Z.F?(ot.push({text:(0,m.t)("panel.header-menu.unlink-library-panel","Unlink library panel"),onClick:()=>{se.c.panelMenuItemClicked("unlinkLibraryPanel"),xt.showModal(new ie({panelRef:$e.getRef()}))}}),ot.push({text:(0,m.t)("panel.header-menu.replace-library-panel","Replace library panel"),onClick:()=>{se.c.panelMenuItemClicked("replaceLibraryPanel"),xt.onShowAddLibraryPanelDrawer($e.getRef())}})):ot.push({text:(0,m.t)("panel.header-menu.create-library-panel","Create library panel"),onClick:()=>{se.c.panelMenuItemClicked("createLibraryPanel"),xt.showModal(new oe.Z({panelRef:Me.getRef(),dashboardRef:xt.getRef(),activeTab:h.wr.libraryPanel}))}})),ot.push({text:(0,m.t)("panel.header-menu.new-alert-rule","New alert rule"),onClick:X=>Pe(Me)}),Oe(Me.state.options)&&!Le&&ot.push({text:Me.state.options.legend.showLegend?(0,m.t)("panel.header-menu.hide-legend","Hide legend"):(0,m.t)("panel.header-menu.show-legend","Show legend"),onClick:X=>{X.preventDefault(),Ie(Me)},shortcut:"p l"}),xt.canEditDashboard()&&ke&&!ke.meta.skipDataQuery&&!Ae&&ot.push({text:(0,m.t)("panel.header-menu.get-help","Get help"),onClick:X=>{X.preventDefault(),Ne(Me,u.q.Help)}}),r.$.featureToggles.exploreMetrics&&await V(xt,Me,Ze),ft&&Ze.push(ft),Ze.push(he(ke,Me,xt));const{extensions:re}=(0,i.Kf)({extensionPointId:n.S.DashboardPanelMenu,context:pe(Me,xt),limitPerPlugin:3});re.length>0&&!xt.state.isEditing&&Ze.push({text:"Extensions",iconClassName:"plug",type:"submenu",subMenu:(0,g.N9)(re)}),ot.length&&Ze.push({type:"submenu",text:(0,m.t)("panel.header-menu.more","More..."),iconClassName:"cube",subMenu:ot,onClick:X=>{X.preventDefault()}}),xt.state.isEditing&&!Ae&&!Le&&(Ze.push({text:"",type:"divider"}),Ze.push({text:(0,m.t)("panel.header-menu.remove","Remove"),iconClassName:"trash-alt",onClick:()=>{se.c.panelMenuItemClicked("remove"),ye(xt,Me)},shortcut:"p r"})),We.setState({items:Ze})})()}const fe=We=>ue(We,!0);async function Se(We){const Ae=await(0,ne.Lp)(We);if(Ae)return{text:(0,m.t)("panel.header-menu.explore","Explore"),iconClassName:"compass",shortcut:"p x",onClick:()=>se.c.panelMenuItemClicked("explore"),href:Ae}}function he(We,Ae,Ue){const Me=[];return We&&!We.meta.skipDataQuery&&(Me.push({text:(0,m.t)("panel.header-menu.inspect-data","Data"),href:(0,ne.Uu)(Ae,u.q.Data),onClick:$e=>{$e.preventDefault(),f.Ny.partial({inspect:Ae.state.key,inspectTab:u.q.Data}),se.c.panelMenuInspectClicked(u.q.Data)}}),Ue instanceof ee.H$&&Ue.state.meta.canEdit&&Me.push({text:(0,m.t)("panel.header-menu.query","Query"),href:(0,ne.Uu)(Ae,u.q.Query),onClick:$e=>{$e.preventDefault(),f.Ny.partial({inspect:Ae.state.key,inspectTab:u.q.Query}),se.c.panelMenuInspectClicked(u.q.Query)}})),Me.push({text:(0,m.t)("panel.header-menu.inspect-json","Panel JSON"),href:(0,ne.Uu)(Ae,u.q.JSON),onClick:$e=>{$e.preventDefault(),f.Ny.partial({inspect:Ae.state.key,inspectTab:u.q.JSON}),se.c.panelMenuInspectClicked(u.q.JSON)}}),{text:(0,m.t)("panel.header-menu.inspect","Inspect"),iconClassName:"info-circle",shortcut:"i",href:(0,ne.Uu)(Ae),onClick:$e=>{$e.isDefaultPrevented()||(f.Ny.partial({inspect:Ae.state.key,inspectTab:u.q.Data}),se.c.panelMenuInspectClicked(u.q.Data))},subMenu:Me.length>0?Me:void 0}}function ce(We){if(!(We.parent instanceof z.$))throw new Error("parent of VizPanelLinksMenu must be VizPanelLinks");const Ae=We.parent.parent;if(!(Ae instanceof d.Eb))throw new Error("parent of VizPanelLinks must be VizPanel");We.setState({links:me(Ae)})}function me(We){const Ae=($e,ke)=>d.jh.interpolate(We,$e,ke),Ue=(0,b.CH)(We,Ae);if(!Ue)return[];const Me=Ue.getLinks(Ae);return Me.map($e=>({...$e,onClick:(Ze,ot)=>{se.c.panelLinkClicked({has_multiple_links:Me.length>1}),$e.onClick?.(Ze,ot)}}))}function pe(We,Ae){const Ue=d.jh.getTimeRange(We);let Me=(0,c.un)(We);const $e=Me?.state.queries,ke=(0,c.Cs)(We);let Ze={};if(We.state.$variables&&We.state.$variables.state.variables.forEach(ot=>{ot instanceof d.xc&&(Ze={...Ze,[ot.state.name]:{value:ot.getValue(),text:ot.getValueText()}})}),We.parent?.parent instanceof d.tI){const ot=We.parent.parent;ot.state.$variables&&ot.state.$variables.state.variables.forEach(xt=>{xt instanceof d.xc&&(Ze={...Ze,[xt.state.name]:{value:xt.getValue(),text:xt.getValueText()}})})}return{id:ke,pluginId:We.state.pluginId,title:We.state.title,timeRange:Ue.state.value.raw,timeZone:(0,a.O)({timeZone:Ue.getTimeZone()}),dashboard:{uid:Ae.state.uid,title:Ae.state.title,tags:Ae.state.tags||[]},targets:$e,scopedVars:Ze,data:Me?.state.data}}function ye(We,Ae){l.A.publish(new C.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",yesText:"Remove",onConfirm:()=>We.removePanel(Ae)}))}const Pe=async We=>{se.c.panelMenuItemClicked("create-alert");const Ae=await(0,s.J6)(We),Ue=o.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(Ae),returnTo:location.pathname+location.search});f.Ny.push(Ue),se.c.panelMenuItemClicked("create-alert")};function Ie(We){const Ae=We.state.options;Oe(Ae)&&typeof Ae.legend.showLegend=="boolean"&&We.onOptionsChange({legend:{showLegend:!Ae.legend.showLegend}}),se.c.panelMenuItemClicked("toggleLegend")}function Oe(We){return We!=null&&typeof We=="object"&&"legend"in We}const Ne=(We,Ae)=>{f.Ny.partial({inspect:We.state.key,inspectTab:Ae}),se.c.panelMenuInspectClicked(Ae??u.q.Data)}},99589:(Q,I,e)=>{"use strict";e.d(I,{W:()=>i});var n=e(96540),a=e(16401),o=e(2038),r=e(74730);class i extends a.Bs{constructor(){super({}),this.onActivate=()=>{const l=this.parent;if(!l||!(l instanceof a.Eb))throw new Error("PanelNotices can be used only as title items for VizPanel")},this.addActivationHandler(this.onActivate)}static{this.Component=f}getPanel(){const l=this.parent;return l&&l instanceof a.Eb?l:null}}function f({model:d}){const l=d.getPanel(),s=a.jh.getData(d).useState();if(!l)return null;const h=(0,r.Cs)(l);return s.data?.series?n.createElement(o.Z,{frames:s.data?.series,panelId:h}):null}},7928:(Q,I,e)=>{"use strict";e.d(I,{v:()=>u});var n=e(32196),a=e(96540),o=e(43127),r=e(65879),i=e(85858),f=e(16401),d=e(40845),l=e(56034),m=e(15666),s=e(91052),h=e(14578);class u extends f.XQ{static{this.Component=b}constructor(c={}){super({...c,from:"now-6h",to:"now",value:(0,o.E2)()}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){this._subs.add(this.subscribeToState((c,y)=>{if(c.timeFrom!==y.timeFrom||c.timeShift!==y.timeShift){const{timeInfo:p,timeRange:v}=this.getTimeOverride(this.getAncestorTimeRange().state.value);this.setState({timeInfo:p,value:v})}}))}ancestorTimeRangeChanged(c){const y=this.getTimeOverride(c.value);this.setState({value:y.timeRange,timeInfo:y.timeInfo})}getTimeOverride(c){const{timeFrom:y,timeShift:p}=this.state,v={timeInfo:"",timeRange:c};if(y){const D=f.jh.interpolate(this,this.state.timeFrom),E=r.describeTextRange(D);if(E.invalid)return v.timeInfo="invalid time override",v;r.isRelativeTimeRange(c.raw)&&(v.timeInfo=E.display,v.timeRange={from:i.parse(E.from),to:i.parse(E.to),raw:{from:E.from,to:E.to}})}if(p){const D=f.jh.interpolate(this,this.state.timeShift);if(r.describeTextRange(D).invalid)return v.timeInfo="invalid timeshift",v;const S="-"+D;v.timeInfo+=" timeshift "+S;const T=i.parseDateMath(S,v.timeRange.from,!1),M=i.parseDateMath(S,v.timeRange.to,!0);v.timeRange={from:T,to:M,raw:{from:T,to:M}}}return v}}function b({model:P}){const{timeInfo:c,hideTimeOverride:y}=P.useState(),p=(0,d.of)(g);return!c||y?null:a.createElement(l.m,{content:a.createElement(m.xS,{timeRange:P.state.value,timeZone:P.getTimeZone()})},a.createElement(s.NR.TitleItem,{className:p.timeshift},a.createElement(h.I,{name:"clock-nine",size:"sm"})," ",c))}const g=P=>({timeshift:(0,n.css)({color:P.colors.text.link,gap:P.spacing(.5),whiteSpace:"nowrap"})})},79284:(Q,I,e)=>{"use strict";e.d(I,{L:()=>f});var n=e(2543),a=e.n(n),o=e(16401),r=e(74730),i=e(30195);class f extends o.Bs{constructor(u){super(u),this._variableDependency=new o.Sh(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>{}}),this.isWaitingForVariables=!1,this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.performRepeat()}_getRow(){if(!(this.parent instanceof o.tI))throw new Error("RepeatedRowBehavior: Parent is not a SceneGridRow");return this.parent}_getLayout(){const u=o.jh.getLayout(this);if(!(u instanceof o.hy))throw new Error("RepeatedRowBehavior: Layout is not a SceneGridLayout");return u}performRepeat(){if(this.isWaitingForVariables=this._variableDependency.hasDependencyInLoadingState(),this.isWaitingForVariables)return;const u=o.jh.lookupVariable(this.state.variableName,this.parent?.parent);if(!u){console.error("RepeatedRowBehavior: Variable not found");return}if(!(u instanceof o.n8)){console.error("RepeatedRowBehavior: Variable is not a MultiValueVariable");return}const b=this._getRow(),g=this._getLayout(),{values:P,texts:c}=(0,r.a7)(u);if((0,n.isEqual)(this._prevRepeatValues,P))return;this._prevRepeatValues=P;const y=[],p=b.state.children,v=d(p);let D=0;const E={values:["placeholder"],texts:u.hasAllValue()?["All"]:["None"]},S=P.length?P:E.values,T=c.length?c:E.texts;for(let M=0;M<S.length;M++){const A=[],x=S[M];for(const O of p){const L=(O.state.y??0)+(v+1)*M,N=M>0?`${O.state.key}-clone-${x}`:O.state.key,F=O.clone({key:N,y:L});M>0&&s(F,x),A.push(F),D<L+F.state.height&&(D=L+F.state.height)}const C=this.getRowClone(b,M,x,T[M],v,A);y.push(C)}l(g,y,D,b),this.publishEvent(new i.d({source:this}),!0)}getRowClone(u,b,g,P,c,y){if(b===0)return u.setState({$variables:new o.Pj({variables:[new o.xc({name:this.state.variableName,value:g,text:String(P)})]}),children:y}),u;const p=u.state.y??0;return u.clone({key:`${u.state.key}-clone-${g}`,$variables:new o.Pj({variables:[new o.xc({name:this.state.variableName,value:g,text:String(P)})]}),$behaviors:[],children:y,y:p+c*b+b,actions:void 0})}removeBehavior(){const u=this._getRow(),b=this._getLayout(),g=m(this._getLayout(),this._getRow());b.setState({children:g}),u.setState({$behaviors:u.state.$behaviors.filter(P=>P!==this),$variables:void 0})}}function d(h){let u=0,b=Number.MAX_VALUE;if(h.length===0)return 0;for(const g of h)g.state.y+g.state.height>u&&(u=g.state.y+g.state.height),g.state.y<b&&(b=g.state.y);return u-b}function l(h,u,b,g){const P=m(h,g),c=P.indexOf(g);if(c===-1)throw new Error("RowRepeaterBehavior: Parent row not found in layout children");const y=[...P.slice(0,c),...u,...P.slice(c+1)];if(P.length>c+1){const p=P.slice(c+1),v=p[0].state.y,D=b-v;for(const E of p)if(E.setState({y:E.state.y+D}),E instanceof o.tI)for(const S of E.state.children)S.setState({y:S.state.y+D})}h.setState({children:y})}function m(h,u){return h.state.children.filter(b=>!b.state.key?.startsWith(`${u.state.key}-clone-`))}function s(h,u){h.forEachChild(b=>{b.setState({key:`${b.state.key}-clone-${u}`}),s(b,u)})}},54174:(Q,I,e)=>{"use strict";e.d(I,{l:()=>o});var n=e(96540),a=e(96374);const o=({isOpen:r,onConfirm:i,onDismiss:f})=>n.createElement(a.u,{title:"Do you really want to unlink this panel?",icon:"question-circle",body:`If you unlink this panel, you will be able to edit it without affecting any other dashboards.
            However, once you make a change you will not be able to revert to its original reusable panel.`,confirmText:"Yes, unlink",onConfirm:()=>{i(),f()},onDismiss:f,isOpen:r})},58029:(Q,I,e)=>{"use strict";e.d(I,{u:()=>x});var n=e(32196),a=e(96540),o=e(16401),r=e(72109),i=e(40845),f=e(14578),d=e(28138),l=e(14348),m=e(28444),s=e(74730),h=e(41507),u=e(79284),b=e(71678),g=e(37390),P=e(49785),c=e(13544),y=e(88575),p=e(10354),v=e(42418),D=e(55852),E=e(92378);const S=({repeat:O,title:R,parent:L,warning:N,onUpdate:F,onCancel:K})=>{const[B,w]=(0,a.useState)(O),U=(0,a.useCallback)(H=>w(H),[w]),{handleSubmit:W,register:V}=(0,P.mN)({defaultValues:{title:R}}),_=H=>{F(H.title,B)};return a.createElement("form",{onSubmit:W(_)},a.createElement(y.D,{label:"Title"},a.createElement(p.p,{...V("title"),type:"text"})),a.createElement(y.D,{label:"Repeat for"},a.createElement(E.U,{parent:L,repeat:B,onChange:U})),N&&a.createElement(v.F,{"data-testid":c.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0},N),a.createElement(g.a.ButtonRow,null,a.createElement(D.$n,{type:"button",variant:"secondary",onClick:K,fill:"outline"},"Cancel"),a.createElement(D.$n,{type:"submit"},"Update")))},T=({repeat:O,title:R,parent:L,onDismiss:N,onUpdate:F,warning:K})=>{const B=(0,i.of)(M);return a.createElement(g.a,{isOpen:!0,title:"Row options",onDismiss:N,className:B.modal},a.createElement(S,{parent:L,repeat:O,title:R,onCancel:N,onUpdate:F,warning:K}))},M=()=>({modal:(0,n.css)({label:"RowOptionsModal",width:"500px"})}),A=({repeat:O,title:R,parent:L,onUpdate:N,warning:F})=>{const K=B=>(w,U)=>{N(w,U),B()};return a.createElement(b.$s,null,({showModal:B,hideModal:w})=>a.createElement("button",{type:"button",className:"pointer","aria-label":"Row options",onClick:()=>{B(T,{title:R,repeat:O,parent:L,onDismiss:w,onUpdate:K(w),warning:F})}},a.createElement(f.I,{name:"cog"})))};A.displayName="RowOptionsButton";class x extends o.Bs{constructor(){super(...arguments),this.onUpdate=(R,L)=>{const N=this.getParent();let F;if(N.state.$behaviors)for(let K of N.state.$behaviors)K instanceof u.L&&(F=K);if(L&&!F){const K=new u.L({variableName:L});N.setState({$behaviors:[...N.state.$behaviors??[],K]})}else F&&F.removeBehavior();R!==N.state.title&&N.setState({title:R})},this.onDelete=()=>{d.A.publish(new m.bY({title:"Delete row",text:"Are you sure you want to remove this row and all its panels?",altActionText:"Delete row only",icon:"trash-alt",onConfirm:()=>{this.getDashboard().removeRow(this.getParent(),!0)},onAltAction:()=>{this.getDashboard().removeRow(this.getParent())}}))},this.getWarning=()=>{if(this.getParent().state.children.some(F=>{if(!(F instanceof h.U))return!1;const K=F.state.body;return K instanceof o.Eb?(0,s.un)(K)?.state.datasource?.uid===l.K:!1}))return a.createElement("div",null,a.createElement("p",null,"Panels in this row use the ",l.K," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."),a.createElement(r.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows"},"Learn more"))}}getParent(){if(!(this.parent instanceof o.tI))throw new Error("RowActions must have a SceneGridRow parent");return this.parent}getDashboard(){return(0,s.YQ)(this)}static{this.Component=({model:R})=>{const L=R.getDashboard(),N=R.getParent(),{title:F}=N.useState(),{meta:K,isEditing:B}=L.useState(),w=(0,i.of)(C),U=N.state.$behaviors?.find(W=>W instanceof u.L);return a.createElement(a.Fragment,null,K.canEdit&&B&&a.createElement(a.Fragment,null,a.createElement("div",{className:w.rowActions},a.createElement(A,{title:F,repeat:U instanceof u.L?U.state.variableName:void 0,parent:L,onUpdate:R.onUpdate,warning:R.getWarning()}),a.createElement("button",{type:"button",onClick:R.onDelete,"aria-label":"Delete row"},a.createElement(f.I,{name:"trash-alt"})))))}}}const C=O=>({rowActions:(0,n.css)({color:O.colors.text.secondary,lineHeight:"27px",button:{color:O.colors.text.secondary,paddingLeft:O.spacing(2),background:"transparent",border:"none","&:hover":{color:O.colors.text.maxContrast}}})})},30195:(Q,I,e)=>{"use strict";e.d(I,{d:()=>a});var n=e(65463);class a extends n.x{static{this.type="dashboard-repeats-processed"}}},71176:(Q,I,e)=>{"use strict";e.d(I,{X:()=>r});var n=e(32264),a=e(79422),o=e(31193);async function r(i){let f=a.Ye.templating?.list;if(n.$.featureToggles.newDashboardWithFiltersAndGroupBy){const l=await(0,o.tR)().get();if(l.getTagKeys){const m={type:l.meta.id,uid:l.uid},s={datasource:m,filters:[],name:"Filter",type:"adhoc"},h={datasource:m,name:"Group by",type:"groupby"};f=(f||[]).concat([s,h])}}const d={meta:{canStar:!1,canShare:!1,canDelete:!1,isNew:!0,folderUid:""},dashboard:{...a.Ye,uid:"",title:"New dashboard",panels:[]}};return f&&(d.dashboard.templating={list:f}),i&&(d.meta.folderUid=i),d}},70665:(Q,I,e)=>{"use strict";e.d(I,{x:()=>n});const n={name:"grafana",uid:"grafana"}},13989:(Q,I,e)=>{"use strict";e.d(I,{O:()=>a});var n=e(16401);function a(o){const r=[];for(const i of o){if(!(i instanceof n.tV.g))continue;const f={...i.state.query,enable:!!i.state.isEnabled,hide:!!i.state.isHidden};r.push(f)}return r}},53287:(Q,I,e)=>{"use strict";e.d(I,{C:()=>f});var n=e(32264),a=e(16401),o=e(79422),r=e(73134),i=e(74730);function f(l){const m=[];for(const s of l.state.variables){const h={name:s.state.name,label:s.state.label,description:s.state.description??void 0,skipUrlSync:!!s.state.skipUrlSync,hide:s.state.hide||o.zL.dontHide,type:s.state.type};if(a.Go.isQueryVariable(s)){let u=[];s.state.refresh===r.CO.never&&(u=d(s.state)),m.push({...h,current:{value:s.state.value,text:s.state.text},options:u,query:s.state.query,definition:s.state.definition,datasource:s.state.datasource,sort:s.state.sort,refresh:s.state.refresh,regex:s.state.regex,allValue:s.state.allValue,includeAll:s.state.includeAll,multi:s.state.isMulti,skipUrlSync:s.state.skipUrlSync})}else if(a.Go.isCustomVariable(s))m.push({...h,current:{text:s.state.value,value:s.state.value},options:d(s.state),query:s.state.query,multi:s.state.isMulti,allValue:s.state.allValue,includeAll:s.state.includeAll});else if(a.Go.isDataSourceVariable(s))m.push({...h,current:{value:s.state.value,text:s.state.text},options:[],regex:s.state.regex,refresh:r.CO.onDashboardLoad,query:s.state.pluginId,multi:s.state.isMulti,allValue:s.state.allValue,includeAll:s.state.includeAll});else if(a.Go.isConstantVariable(s))m.push({...h,current:{value:s.state.value,text:s.state.value},query:s.state.value,hide:o.zL.hideVariable});else if(a.Go.isIntervalVariable(s)){const u=(0,i.bx)(s.state.intervals);m.push({...h,current:{text:s.state.value,value:s.state.value},query:u,refresh:s.state.refresh,options:s.state.intervals.map(b=>({value:b,text:b,selected:b===s.state.value})),auto:s.state.autoEnabled,auto_min:s.state.autoMinInterval,auto_count:s.state.autoStepCount})}else if(a.Go.isTextBoxVariable(s)){const u={text:s.state.value,value:s.state.value};m.push({...h,current:u,options:[{...u,selected:!0}],query:s.state.value})}else if(a.Go.isGroupByVariable(s)&&n.$.featureToggles.groupByVariable)m.push({...h,datasource:s.state.datasource,options:s.state.defaultOptions?.map(u=>({text:u.text,value:String(u.value)})),current:{text:s.state.text,value:s.state.value}});else if(a.Go.isAdHocVariable(s))m.push({...h,name:s.state.name,type:"adhoc",datasource:s.state.datasource,baseFilters:s.state.baseFilters,filters:s.state.filters,defaultKeys:s.state.defaultKeys});else throw new Error("Unsupported variable type")}for(const s of m)s.hide===o.zL.dontHide&&delete s.hide,s.skipUrlSync||delete s.skipUrlSync,s.label===""&&delete s.label,s.multi||delete s.multi,s.sort===r.ZG.disabled&&delete s.sort;return m}function d(l){return l.options.map(m=>({value:String(m.value),text:m.label,selected:Array.isArray(l.value)?l.value.includes(m.value):l.value===m.value}))}},85445:(Q,I,e)=>{"use strict";e.d(I,{Al:()=>G,tt:()=>j,EH:()=>_,wM:()=>U});var n=e(2543),a=e(32264),o=e(16401),r=e(34214),i=e(91309),f=e(38477),d=e(33278),l=e(16279),m=e(41507),s=e(74730);class h{constructor(Z,z){this._sceneObject=z,this.state={name:Z,type:"dashboard_macro"}}getValue(Z){const z=(0,s.YQ)(this._sceneObject);switch(Z){case"uid":return z.state.uid||"";case"title":case"name":case"id":default:return z.state.title}}getValueText(){return""}}function u(){const ee=o.Go.registerVariableMacro("__dashboard",h);return()=>ee()}var b=e(24283),g=e(60656),P=e(42397),c=e(7196),y=e(99589),p=e(7928),v=e(79284),D=e(58029),E=e(41987),S=e(69129),T=e(10154),M=e(32023);function A(ee,Z){Z.app=E.Jk.Dashboard,Z.canAddAnnotations=()=>{const z=(0,s.YQ)(ee);return!x(z)||!z.canEditDashboard()?!1:!!z.state.meta.annotationsPermissions?.dashboard.canAdd},Z.canEditAnnotations=z=>{const q=(0,s.YQ)(ee);return q.canEditDashboard()?z?!!q.state.meta.annotationsPermissions?.dashboard.canEdit:!!q.state.meta.annotationsPermissions?.organization.canEdit:!1},Z.canDeleteAnnotations=z=>{const q=(0,s.YQ)(ee);return q.canEditDashboard()?z?!!q.state.meta.annotationsPermissions?.dashboard.canDelete:!!q.state.meta.annotationsPermissions?.organization.canDelete:!1},Z.onAnnotationCreate=async z=>{const q=(0,s.YQ)(ee),ie=z.from!==z.to,de={dashboardUID:q.state.uid,panelId:(0,s.Cs)(ee),isRegion:ie,time:z.from,timeEnd:ie?z.to:0,tags:z.tags,text:z.description};await(0,T.vJ)(de),C(q),Z.eventBus.publish(new S.We(de))},Z.onAnnotationUpdate=async z=>{const q=(0,s.YQ)(ee),ie=z.from!==z.to,de={id:z.id,dashboardUID:q.state.uid,panelId:(0,s.Cs)(ee),isRegion:ie,time:z.from,timeEnd:ie?z.to:0,tags:z.tags,text:z.description};await(0,T.rJ)(de),C(q),Z.eventBus.publish(new S.We(de))},Z.onAnnotationDelete=async z=>{await(0,T.Xm)({id:z}),C((0,s.YQ)(ee)),Z.eventBus.publish(new S.We({id:z}))},Z.onAddAdHocFilter=z=>{const q=(0,s.YQ)(ee),ie=(0,s.un)(ee);if(!ie)return;const de=O(q,ie.state.datasource);R(de,z)},Z.onUpdateData=z=>Promise.resolve(!0)}function x(ee){const Z=M.b4.getDataLayers(ee);for(const z of Z.state.annotationLayers)if(z instanceof o.tV.g&&z.state.isEnabled&&z.state.query.builtIn)return z}function C(ee){const Z=x(ee);Z&&Z.runLayer()}function O(ee,Z){const z=o.jh.getVariables(ee);for(const ie of z.state.variables)if(o.Go.isAdHocVariable(ie)){const de=ie.state.datasource;if(de===Z||de?.uid===Z?.uid)return ie}const q=new o.H9({name:"Filters",datasource:Z,useQueriesAsFilterForOptions:!0});return z.setState({variables:[...z.state.variables,q]}),q}function R(ee,Z){for(const z of ee.state.filters)if(z.key===Z.key){ee.setState({filters:ee.state.filters.map(q=>q.key===Z.key?Z:q)});return}ee.setState({filters:[...ee.state.filters,Z]})}var L=e(96556),N=e(27734),F=e(7758),K=e(84423);function B(ee){return function(z,q){if(q.angularPanelCtrl){z.options={angularOptions:ee.getOptionsToRemember()};return}if((!ee.options||Object.keys(ee.options).length===0)&&(0,n.defaults)(z,ee.getOptionsToRemember()),ee.autoMigrateFrom){const ie=K.NB[ee.autoMigrateFrom]!=null,de=ee.getOptionsToRemember(),ue=ee.autoMigrateFrom;if(q.onPanelTypeChanged){const fe=ie?{angular:de}:de.options;Object.assign(z.options,q.onPanelTypeChanged(z,ue,fe,z.fieldConfig))}}}}var w=e(70665);function U(ee){const Z=new r.G(ee.dashboard,ee.meta),z=_(Z);return z.setInitialSaveModel(ee.dashboard),z}function W(ee){const Z=[];let z=null,q=[];for(const ie of ee)if(ie.type==="row")z?z.id!==ie.id&&(Z.push(V(z,q)),z=ie,q=[]):ie.collapsed?Z.push(V(ie,[])):z=ie;else if(ie.libraryPanel?.uid&&!("model"in ie.libraryPanel)){const de=G(ie);if(!de)continue;z?q.push(de):Z.push(de)}else{ie.snapshotData&&se(ie);const de=j(ie);z?q.push(de):Z.push(de)}return z&&Z.push(V(z,q)),Z}function V(ee,Z){ee.collapsed&&ee.panels&&(Z=ee.panels.map(ie=>{if(ie instanceof r.a||(ie=new r.a(ie)),ie.libraryPanel?.uid&&!("model"in ie.libraryPanel)){const de=G(ie);if(!de)throw new Error("Failed to build grid item for library panel");return de}return j(ie)}));let z,q=Z;return ee.repeat&&(z=[new v.L({variableName:ee.repeat})]),new o.tI({key:(0,s.XA)(ee.id),title:ee.title,y:ee.gridPos.y,isCollapsed:ee.collapsed,children:q,$behaviors:z,actions:new D.u({})})}function _(ee){let Z,z=[],q;if(ee.templating?.list?.length){const ue=ee.templating.list.map(fe=>{try{return H(fe)}catch(Se){return console.error(Se),null}}).filter(fe=>!!fe);Z=new o.Pj({variables:ue})}else Z=new o.Pj({variables:[]});ee.annotations?.list?.length&&!ee.isSnapshot()&&(z=ee.annotations?.list.map(ue=>new f.g({key:(0,n.uniqueId)("annotations-"),query:ue,name:ue.name,isEnabled:!!ue.enable,isHidden:!!ue.hide})));let ie=a.$.unifiedAlertingEnabled;return ie||ee.panels.find(ue=>!!ue.alert)&&(ie=!0),ie&&(q=new i.C({key:"alert-states",name:"Alert States"})),new b.H$({description:ee.description,editable:ee.editable,id:ee.id,isDirty:!1,links:ee.links||[],meta:ee.meta,tags:ee.tags||[],title:ee.title,uid:ee.uid,version:ee.version,body:new o.hy({isLazy:!0,children:W(ee.panels),$behaviors:[ne]}),$timeRange:new o.JZ({from:ee.time.from,to:ee.time.to,fiscalYearStartMonth:ee.fiscalYearStartMonth,timeZone:ee.timezone,weekStart:ee.weekStart,UNSAFE_nowDelay:ee.timepicker?.nowDelay}),$variables:Z,$behaviors:[new o.Gg.K2({sync:ee.graphTooltip}),new o.Gg.Hf,u,Y,new o.Gg.en({enabled:ee.liveNow}),N.zf],$data:new l.s({annotationLayers:z,alertStatesLayer:q}),controls:new d.x({variableControls:[new o.K8({}),new o.i7],timePicker:new o.KE({}),refreshPicker:new o.WM({refresh:ee.refresh,intervals:ee.timepicker.refresh_intervals,withText:!0}),hideTimeControls:ee.timepicker.hidden})})}function H(ee){const Z={name:ee.name,label:ee.label,description:ee.description};if(ee.type==="adhoc")return new o.H9({...Z,description:ee.description,skipUrlSync:ee.skipUrlSync,hide:ee.hide,datasource:ee.datasource,applyMode:"auto",filters:ee.filters??[],baseFilters:ee.baseFilters??[],defaultKeys:ee.defaultKeys,useQueriesAsFilterForOptions:!0});if(ee.type==="custom")return new o.yP({...Z,value:ee.current?.value??"",text:ee.current?.text??"",query:ee.query,isMulti:ee.multi,allValue:ee.allValue||void 0,includeAll:ee.includeAll,defaultToAll:!!ee.includeAll,skipUrlSync:ee.skipUrlSync,hide:ee.hide});if(ee.type==="query")return new o.fS({...Z,value:ee.current?.value??"",text:ee.current?.text??"",query:ee.query,datasource:ee.datasource,sort:ee.sort,refresh:ee.refresh,regex:ee.regex,allValue:ee.allValue||void 0,includeAll:ee.includeAll,defaultToAll:!!ee.includeAll,isMulti:ee.multi,skipUrlSync:ee.skipUrlSync,hide:ee.hide,definition:ee.definition});if(ee.type==="datasource")return new o.mI({...Z,value:ee.current?.value??"",text:ee.current?.text??"",regex:ee.regex,pluginId:ee.query,allValue:ee.allValue||void 0,includeAll:ee.includeAll,defaultToAll:!!ee.includeAll,skipUrlSync:ee.skipUrlSync,isMulti:ee.multi,hide:ee.hide});if(ee.type==="interval"){const z=(0,s.Sm)(ee.query),q=(0,s.pk)(ee,z);return new o.Yj({...Z,value:q,intervals:z,autoEnabled:ee.auto,autoStepCount:ee.auto_count,autoMinInterval:ee.auto_min,refresh:ee.refresh,skipUrlSync:ee.skipUrlSync,hide:ee.hide})}else{if(ee.type==="constant")return new o.x0({...Z,value:ee.query,skipUrlSync:ee.skipUrlSync,hide:ee.hide});if(ee.type==="textbox"){let z;return ee?.current?.value?typeof ee.current.value=="string"?z=ee.current.value:z=ee.current.value[0]:z=ee.query,new o.TS({...Z,value:z,skipUrlSync:ee.skipUrlSync,hide:ee.hide})}else{if(a.$.featureToggles.groupByVariable&&ee.type==="groupby")return new o.ZG({...Z,datasource:ee.datasource,value:ee.current?.value||[],text:ee.current?.text||[],skipUrlSync:ee.skipUrlSync,hide:ee.hide,defaultOptions:ee.options});throw new Error(`Scenes: Unsupported variable type ${ee.type}`)}}}function G(ee){if(!ee.libraryPanel)return null;const Z=new g.F({title:ee.title,uid:ee.libraryPanel.uid,name:ee.libraryPanel.name,panelKey:(0,s.XA)(ee.id)});return new m.U({key:`grid-item-${ee.id}`,y:ee.gridPos.y,x:ee.gridPos.x,width:ee.gridPos.w,height:ee.gridPos.h,itemHeight:ee.gridPos.h,body:Z})}function j(ee){const Z=ee.repeat?{variableName:ee.repeat,repeatDirection:ee.repeatDirection==="h"?"h":"v"}:{},z=[];z.push(new P.$({rawLinks:ee.links,menu:new P.m({$behaviors:[c.oV]})})),z.push(new y.W);const q={key:(0,s.XA)(ee.id),title:ee.title,description:ee.description,pluginId:ee.type,options:ee.options??{},fieldConfig:ee.fieldConfig,pluginVersion:ee.pluginVersion,displayMode:ee.transparent?"transparent":void 0,hoverHeader:!ee.title&&!ee.timeFrom&&!ee.timeShift,hoverHeaderOffset:0,$data:(0,L.w)(ee),titleItems:z,extendPanelContext:A,_UNSAFE_customMigrationHandler:B(ee)};a.$.publicDashboardAccessToken||(q.menu=new o.Lw({$behaviors:[c._i]})),(ee.timeFrom||ee.timeShift)&&(q.$timeRange=new p.v({timeFrom:ee.timeFrom,timeShift:ee.timeShift,hideTimeOverride:ee.hideTimeOverride}));const ie=new o.Eb(q);return new m.U({key:`grid-item-${ee.id}`,x:ee.gridPos.x,y:ee.gridPos.y,width:Z.repeatDirection==="h"?24:ee.gridPos.w,height:ee.gridPos.h,itemHeight:ee.gridPos.h,body:ie,maxPerRow:ee.maxPerRow,...Z})}function Y(ee){ee.subscribeToEvent(o.Kw,Z=>{const{interaction:z}=Z.payload;switch(z){case"panel-status-message-clicked":F.c.panelStatusMessageClicked();break;case"panel-cancel-query-clicked":F.c.panelCancelQueryClicked();break;case"panel-menu-shown":F.c.panelMenuShown();break}})}const oe=ee=>ee.map(Z=>({data:{values:Z.fields.map(z=>z.values).filter(z=>z!==void 0)},schema:{fields:Z.fields.map(z=>({name:z.name,type:z.type,config:z.config}))}})),se=ee=>{ee.snapshotData&&(ee.datasource=w.x,ee.targets=[{refId:ee.snapshotData[0]?.refId??"",datasource:ee.datasource,queryType:"snapshot",snapshot:oe(ee.snapshotData)}],ee.snapshotData=[])};function ne(ee){(0,s.YQ)(ee).setState({isEmpty:ee.state.children.length===0});const Z=ee.subscribeToState((z,q)=>{(z.children.length!==q.children.length||z.children!==q.children)&&(0,s.YQ)(ee).setState({isEmpty:z.children.length===0})});return()=>{Z.unsubscribe()}}},20455:(Q,I,e)=>{"use strict";e.d(I,{Uy:()=>E,Z6:()=>M,ZB:()=>T,c:()=>O});var n=e(2543),a=e.n(n),o=e(92041),r=e(16401),i=e(79422),f=e(73134),d=e(28874),l=e(18803),m=e(79056),s=e(68706),h=e(16279),u=e(41507),b=e(60656),g=e(7928),P=e(79284),c=e(32023),y=e(74730),p=e(70665),v=e(13989),D=e(53287);function E(L,N=!1){const F=L.state,K=F.$timeRange.state,B=F.$data,w=F.$variables,U=F.body;let W=[],V=[];if(U instanceof r.hy){for(const ne of U.state.children)if(ne instanceof u.U&&(ne.state.variableName?W=W.concat(x(ne,F,N)):W.push(T(ne,F,N))),ne instanceof r.tI){if(ne.state.key.indexOf("-clone-")>0&&!N)continue;C(ne,W,F,N)}}let _=[];B instanceof h.s&&(_=(0,v.O)(B.state.annotationLayers)),w instanceof r.Pj&&(V=(0,D.C)(w));const H=F.controls?.state,G=H?.refreshPicker,j=R({refresh_intervals:G?.state.intervals,hidden:H?.hideTimeControls,nowDelay:K.UNSAFE_nowDelay},i.lt),Y=F.$behaviors?.find(ne=>ne instanceof r.Gg.K2)?.state.sync??i.Ye.graphTooltip,oe=F.$behaviors?.find(ne=>ne instanceof r.Gg.en)?.isEnabled||void 0,se={...i.Ye,title:F.title,description:F.description||void 0,uid:F.uid,id:F.id,editable:F.editable,time:{from:K.from,to:K.to},timepicker:j,panels:W,annotations:{list:_},templating:{list:V},version:F.version,timezone:K.timeZone,fiscalYearStartMonth:K.fiscalYearStartMonth,weekStart:K.weekStart,tags:F.tags,links:F.links,graphTooltip:Y,liveNow:oe,schemaVersion:m.O2,refresh:G?.state.refresh};return(0,d.v)(se)}function S(L,N){if(!L.state.panel)throw new Error("Library panel has no panel");return{id:(0,y.Cs)(L.state.panel),title:L.state.title,gridPos:N,libraryPanel:{name:L.state.name,uid:L.state.uid}}}function T(L,N,F=!1){let K,B=0,w=0,U=0,W=0;if(L.state.body instanceof b.F)return B=L.state.x??0,w=L.state.y??0,U=L.state.width??0,W=L.state.itemHeight??L.state.height??0,S(L.state.body,{x:B,y:w,w:U,h:W});let V=L;if(N&&N.editPanel?.state.vizManager&&N.editPanel.state.vizManager.state.sourcePanel.resolve()===L.state.body){const H=L.clone();H.state.body instanceof r.Eb&&(N.editPanel.state.vizManager.commitChangesTo(H.state.body),V=H)}if(!(V.state.body instanceof r.Eb))throw new Error("DashboardGridItem body expected to be VizPanel");if(K=V.state.body,B=V.state.x??0,w=V.state.y??0,U=V.state.width??0,W=V.state.itemHeight??V.state.height??0,!K)throw new Error("Unsupported grid item type");return M(K,{x:B,y:w,h:W,w:U},F,V)}function M(L,N,F=!1,K){const B={id:(0,y.Cs)(L),type:L.state.pluginId,title:L.state.title,description:L.state.description??void 0,gridPos:N,fieldConfig:L.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:L.state.displayMode==="transparent",pluginVersion:L.state.pluginVersion,...A(L,F)};if(L.state.options){const{angularOptions:W,...V}=L.state.options;B.options=V,W&&(0,n.defaults)(B,W)}const w=L.state.$timeRange;w instanceof g.v&&(B.timeFrom=w.state.timeFrom,B.timeShift=w.state.timeShift,B.hideTimeOverride=w.state.hideTimeOverride),K instanceof u.U&&(K.state.variableName&&(B.repeat=K.state.variableName),K.state.maxPerRow&&(B.maxPerRow=K.state.maxPerRow),K.state.repeatDirection&&(B.repeatDirection=K.getRepeatDirection()));const U=c.b4.getPanelLinks(L);return B.links=U?.state.rawLinks??[],B.links.length===0&&delete B.links,B.transformations?.length===0&&delete B.transformations,B.transparent||delete B.transparent,B}function A(L,N=!1){const F=L.state.$data,K={},B=(0,y.un)(L);if(B&&(K.targets=B.state.queries,K.maxDataPoints=B.state.maxDataPoints,K.datasource=B.state.datasource,B.state.cacheTimeout&&(K.cacheTimeout=B.state.cacheTimeout),B.state.queryCachingTTL&&(K.queryCachingTTL=B.state.queryCachingTTL),B.state.minInterval&&(K.interval=B.state.minInterval)),F instanceof r.Es&&(K.transformations=F.state.transformations),F&&N){K.datasource=p.x;let w=(0,l.B6)(F.state.data);F instanceof r.Es&&(w=(0,l.B6)(F.state.$data.state.data)),K.targets=[{refId:"A",datasource:K.datasource,queryType:s.nj.Snapshot,snapshot:w}]}return K}function x(L,N,F=!1){if(F){if(L.state.body instanceof b.F){const{x:K=0,y:B=0,width:w=0,height:U=0}=L.state;return[S(L.state.body,{x:K,y:B,w,h:U})]}if(L.state.repeatedPanels){const K=L.state.itemHeight??10,B=Math.ceil(L.state.repeatedPanels.length/L.getMaxPerRow()),w=Math.ceil(L.state.repeatedPanels.length/B),U=24/w,W=K;return L.state.repeatedPanels.map((_,H)=>{let G=0,j=0;L.state.repeatDirection==="v"?(G=L.state.x,j=H*W):(G=H%w*U,j=L.state.y+Math.floor(H/w)*W);const Y={x:G,y:j,w:U,h:W},oe=_.state.$variables.getByName(L.state.variableName);return{id:(0,y.Cs)(_),type:_.state.pluginId,title:_.state.title,gridPos:Y,options:_.state.options,fieldConfig:_.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:_.state.displayMode==="transparent",scopedVars:{[L.state.variableName]:{text:oe?.state.text,value:oe?.state.value}},...A(_,F)}})}return[]}else return[T(L,N)]}function C(L,N,F,K=!1){const B=!!L.state.isCollapsed,w={type:"row",id:(0,y.Cs)(L),title:L.state.title,gridPos:{x:L.state.x??0,y:L.state.y??0,w:L.state.width??24,h:L.state.height??1},collapsed:B,panels:[]};if(L.state.$behaviors?.length){const W=L.state.$behaviors[0];W instanceof P.L&&(w.repeat=W.state.variableName)}if(K&&L.state.$variables){const V=L.state.$variables.state.variables.reduce((_,H)=>({..._,[H.state.name]:{text:H.state.text,value:H.state.value}}),{});w.scopedVars=V}N.push(w);let U=[];K?L.state.children.forEach(W=>{W instanceof u.U&&(W.state.variableName?U=U.concat(x(W,F,!B)):U.push(T(W,F,!B)))}):U=L.state.children.map(W=>{if(!(W instanceof u.U))throw new Error("Row child expected to be DashboardGridItem");return T(W,F)}),L.state.isCollapsed?w.panels=U:N.push(...U)}function O(L,N,F,K){let B={...F,title:L,time:{from:N.from.toISOString(),to:N.to.toISOString()},links:[]};if(K){const w=F.panels?.find(U=>U.id===(0,y.Cs)(K));w&&(w.gridPos={w:24,x:0,y:0,h:20},B={...B,panels:[w]})}if(B.panels?.forEach(w=>{"links"in w&&(w.links=[])}),B.annotations){const U=(B.annotations.list?.filter(W=>W.enable)||[]).map(W=>({name:W.name,enable:W.enable,iconColor:W.iconColor,type:W.type,builtIn:W.builtIn,hide:W.hide,snapshotData:[]}));B.annotations.list=U}return B.templating&&B.templating.list?.forEach(w=>{"query"in w&&(w.query=""),"options"in w&&(w.options=w.current&&!(0,o.R)(w.current)?[w.current]:[]),"refresh"in w&&(w.refresh=f.CO.never)}),B}function R(L,N){const F={...L};for(const K in N)(0,n.isEqual)(F[K],N[K])&&delete F[K];return F}},46502:(Q,I,e)=>{"use strict";e.d(I,{F:()=>o});var n=e(96540),a=e(7376);class o extends n.PureComponent{constructor(){super(...arguments),this.ref=null}componentWillUnmount(){this.angularComponent&&this.angularComponent.destroy()}componentDidMount(){this.ref&&this.loadAngular()}componentDidUpdate(i){i.datasource!==this.props.datasource&&this.loadAngular(),this.scopeProps&&this.scopeProps.ctrl.currentAnnotation!==this.props.annotation&&(this.scopeProps.ctrl.ignoreNextWatcherFiring=!0,this.scopeProps.ctrl.currentAnnotation=this.props.annotation,this.angularComponent?.digest())}loadAngular(){this.angularComponent&&(this.angularComponent.destroy(),this.scopeProps=void 0);const i=(0,a.E)(),f='<plugin-component type="annotations-query-ctrl"> </plugin-component>',d={ctrl:{currentDatasource:this.props.datasource,currentAnnotation:this.props.annotation,ignoreNextWatcherFiring:!1}};this.angularComponent=i.load(this.ref,d,f),this.angularComponent.digest(),this.angularComponent.getScope().$watch(()=>{if(d.ctrl.ignoreNextWatcherFiring){d.ctrl.ignoreNextWatcherFiring=!1;return}this.props.onChange(d.ctrl.currentAnnotation)}),this.scopeProps=d}render(){return n.createElement("div",{ref:i=>this.ref=i})}}},65857:(Q,I,e)=>{"use strict";e.d(I,{d:()=>u});var n=e(96540),a=e(88575),o=e(10354),r=e(21594),i=e(79924),f=e(57418),d=e(10880),l=e(55852),m=e(4588);const s=[{value:"dashboards",label:"Dashboards"},{value:"link",label:"Link"}],h=Object.keys(m.G).map(b=>({label:b,value:b}));function u({link:b,onUpdate:g,onGoBack:P}){const c=E=>{g({...b,tags:E})},y=E=>{const S={...b,type:E.value};S.type==="dashboards"?(S.url="",S.tooltip=""):S.tags=[],g(S)},p=E=>{g({...b,icon:E.value})},v=E=>{const S=E.currentTarget;g({...b,[S.name]:S.type==="checkbox"?S.checked:S.value})},D=b.title===m.q.title;return n.createElement("div",{style:{maxWidth:"600px"}},n.createElement(a.D,{label:"Title"},n.createElement(o.p,{name:"title",id:"title",value:b.title,onChange:v,autoFocus:D})),n.createElement(a.D,{label:"Type"},n.createElement(r.l6,{inputId:"link-type-input",value:b.type,options:s,onChange:y})),b.type==="dashboards"&&n.createElement(n.Fragment,null,n.createElement(a.D,{label:"With tags"},n.createElement(i.u,{tags:b.tags,onChange:c}))),b.type==="link"&&n.createElement(n.Fragment,null,n.createElement(a.D,{label:"URL"},n.createElement(o.p,{name:"url",value:b.url,onChange:v})),n.createElement(a.D,{label:"Tooltip"},n.createElement(o.p,{name:"tooltip",value:b.tooltip,onChange:v,placeholder:"Open dashboard"})),n.createElement(a.D,{label:"Icon"},n.createElement(r.l6,{value:b.icon,options:h,onChange:p}))),n.createElement(f.M,{label:"Options",isOpen:!0},b.type==="dashboards"&&n.createElement(a.D,null,n.createElement(d.S,{label:"Show as dropdown",name:"asDropdown",value:b.asDropdown,onChange:v})),n.createElement(a.D,null,n.createElement(d.S,{label:"Include current time range",name:"keepTime",value:b.keepTime,onChange:v})),n.createElement(a.D,null,n.createElement(d.S,{label:"Include current template variable values",name:"includeVars",value:b.includeVars,onChange:v})),n.createElement(a.D,null,n.createElement(d.S,{label:"Open link in new tab",name:"targetBlank",value:b.targetBlank,onChange:v}))),n.createElement(l.$n,{variant:"secondary",onClick:P},"Back to list"))}},6199:(Q,I,e)=>{"use strict";e.d(I,{X:()=>b});var n=e(32196),a=e(96540),o=e(40845),r=e(67061),i=e(69529),f=e(55852),d=e(72109),l=e(14578),m=e(64149),s=e(29158),h=e(91605),u=e(8484);function b({links:P,onNew:c,onOrderChange:y,onEdit:p,onDuplicate:v,onDelete:D}){const E=(0,o.of)(g);return P.length===0?a.createElement(r.B,{direction:"column"},a.createElement(i.p,{variant:"call-to-action",button:a.createElement(f.$n,{onClick:c,size:"lg"},a.createElement(u.x6,{i18nKey:"dashboard-links.empty-state.button-title"},"Add dashboard link")),message:(0,u.t)("dashboard-links.empty-state.title","There are no dashboard links added yet")},a.createElement(u.x6,{i18nKey:"dashboard-links.empty-state.info-box-content"},"Dashboard links allow you to place links to other dashboards and web sites directly below the dashboard header."," ",a.createElement(d.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-dashboard-links/"},"Learn more")))):a.createElement(a.Fragment,null,a.createElement("table",{role:"grid",className:"filter-table filter-table--hover"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Type"),a.createElement("th",null,"Info"),a.createElement("th",{colSpan:3}))),a.createElement("tbody",null,P.map((T,M)=>a.createElement("tr",{key:`${T.title}-${M}`},a.createElement("td",{role:"gridcell",className:"pointer",onClick:()=>p(M)},a.createElement(l.I,{name:"external-link-alt"})," \xA0 ",T.type),a.createElement("td",{role:"gridcell",className:"pointer",onClick:()=>p(M)},a.createElement(r.B,null,T.title&&a.createElement("span",{className:E.titleWrapper},T.title),T.type==="link"&&a.createElement("span",{className:E.urlWrapper},T.url),T.type==="dashboards"&&a.createElement(m.L,{tags:T.tags??[]}))),a.createElement("td",{style:{width:"1%"},role:"gridcell"},M!==0&&a.createElement(s.K,{name:"arrow-up",onClick:()=>y(M,-1),tooltip:"Move link up"})),a.createElement("td",{style:{width:"1%"},role:"gridcell"},P.length>1&&M!==P.length-1?a.createElement(s.K,{name:"arrow-down",onClick:()=>y(M,1),tooltip:"Move link down"}):null),a.createElement("td",{style:{width:"1%"},role:"gridcell"},a.createElement(s.K,{name:"copy",onClick:()=>v(T),tooltip:"Copy link"})),a.createElement("td",{style:{width:"1%"},role:"gridcell"},a.createElement(h.e,{"aria-label":`Delete link with title "${T.title}"`,size:"sm",onConfirm:()=>D(M)})))))),a.createElement(f.$n,{className:E.newLinkButton,icon:"plus",onClick:c},"New link"))}const g=P=>({titleWrapper:(0,n.css)({width:"20vw",textOverflow:"ellipsis",overflow:"hidden"}),urlWrapper:(0,n.css)({width:"40vw",textOverflow:"ellipsis",overflow:"hidden"}),newLinkButton:(0,n.css)({marginTop:P.spacing(3)})})},4588:(Q,I,e)=>{"use strict";e.d(I,{G:()=>a,q:()=>n});const n={icon:"external link",title:"New link",tooltip:"",type:"dashboards",url:"",asDropdown:!1,tags:[],targetBlank:!1,keepTime:!1,includeVars:!1},a={"external link":"external-link-alt",dashboard:"apps",question:"question-circle",info:"info-circle",bolt:"bolt",doc:"file-alt",cloud:"cloud"}},27803:(Q,I,e)=>{"use strict";e.d(I,{Q:()=>s});var n=e(96540),a=e(72436),o=e(13544),r=e(88575),i=e(42418),f=e(15292),d=e(32372),l=e(51612),m=e(58975);function s({datasource:h,infoText:u,onDataSourceChange:b,onDefaultKeysChange:g,defaultKeys:P}){const c=(0,n.useCallback)(y=>{const p=(0,a.Jh)(`key,value
`+y)[0],v=[];for(let D=0;D<p.length;D++)v.push({text:p.fields[0].values[D],value:p.fields[1].values[D]});g?.(v)},[g]);return n.createElement(n.Fragment,null,n.createElement(m.Y,null,"Ad-hoc options"),n.createElement(r.D,{label:"Data source",htmlFor:"data-source-picker"},n.createElement(l.s,{current:h,onChange:b,width:30,variables:!0,noDefault:!0})),u?n.createElement(i.F,{title:u,severity:"info","data-testid":o.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.infoText}):null,g&&n.createElement(n.Fragment,null,n.createElement(r.D,{label:"Use static key dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId"},n.createElement(f.d,{"data-testid":o.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.modeToggle,value:P!==void 0,onChange:y=>{g(P===void 0?[]:void 0)}})),P!==void 0&&n.createElement(d.B,{height:300,language:"csv",value:P.map(y=>`${y.text},${y.value}`).join(`
`),onBlur:c,onSave:c,showMiniMap:!1,showLineNumbers:!0})))}},95802:(Q,I,e)=>{"use strict";e.d(I,{d:()=>i});var n=e(96540),a=e(13544),o=e(58975),r=e(14329);function i({onChange:f,constantValue:d}){return n.createElement(n.Fragment,null,n.createElement(o.Y,null,"Constant options"),n.createElement(r._,{defaultValue:d,name:"Value",placeholder:"your metric prefix",onBlur:f,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.ConstantVariable.constantOptionsQueryInputV2,width:30}))}},58711:(Q,I,e)=>{"use strict";e.d(I,{w:()=>f});var n=e(96540),a=e(13544),o=e(58975),r=e(85140),i=e(94618);function f({query:d,multi:l,allValue:m,includeAll:s,onQueryChange:h,onMultiChange:u,onIncludeAllChange:b,onAllValueChange:g}){return n.createElement(n.Fragment,null,n.createElement(o.Y,null,"Custom options"),n.createElement(r.Z,{name:"Values separated by comma",defaultValue:d,placeholder:"1, 10, mykey : myvalue, myvalue, escaped\\,value",onBlur:h,required:!0,width:52,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.CustomVariable.customValueInput}),n.createElement(o.Y,null,"Selection options"),n.createElement(i.B,{multi:l,includeAll:s,allValue:m,onMultiChange:u,onIncludeAllChange:b,onAllValueChange:g}))}},98917:(Q,I,e)=>{"use strict";e.d(I,{y:()=>d});var n=e(96540),a=e(13544),o=e(94618),r=e(58975),i=e(89458),f=e(14329);function d({query:l,regex:m,optionTypes:s,onChange:h,onRegExBlur:u,multi:b,includeAll:g,allValue:P,onMultiChange:c,onIncludeAllChange:y,onAllValueChange:p}){const v=s.find(D=>D.value===l)??s[0];return n.createElement(n.Fragment,null,n.createElement(r.Y,null,"Data source options"),n.createElement(i.v,{name:"Type",value:v,options:s,onChange:h,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.DatasourceVariable.datasourceSelect}),n.createElement(f._,{defaultValue:m,name:"Instance name filter",placeholder:"/.*-(.*)-.*/",onBlur:u,description:n.createElement("div",null,"Regex filter for which data source instances to choose from in the variable value list. Leave empty for all.",n.createElement("br",null),n.createElement("br",null),"Example: ",n.createElement("code",null,"/^prod/"))}),n.createElement(r.Y,null,"Selection options"),n.createElement(o.B,{multi:b,includeAll:g,allValue:P,onMultiChange:c,onIncludeAllChange:y,onAllValueChange:p}))}},49317:(Q,I,e)=>{"use strict";e.d(I,{s:()=>m});var n=e(32196),a=e(96540),o=e(13544),r=e(40845),i=e(99615),f=e(58975),d=e(89458),l=e(14329);function m({intervals:h,onIntervalsChange:u,onAutoEnabledChange:b,onAutoMinIntervalChanged:g,onAutoCountChanged:P,autoEnabled:c,autoMinInterval:y,autoStepCount:p}){const v=[1,2,3,4,5,10,20,30,40,50,100,200,300,400,500].map(S=>({label:`${S}`,value:S})),D=(0,r.of)(s),E=v.find(S=>S.value===p)??v[0];return a.createElement(a.Fragment,null,a.createElement(f.Y,null,"Interval options"),a.createElement(l._,{defaultValue:h,name:"Values",placeholder:"1m,10m,1h,6h,1d,7d",onBlur:u,testId:o.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.intervalsValueInput,width:32,required:!0}),a.createElement(i.c,{value:c,name:"Auto option",description:"Dynamically calculates interval by dividing time range by the count specified",onChange:b,testId:o.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.autoEnabledCheckbox}),c&&a.createElement("div",{className:D.autoFields},a.createElement(d.v,{name:"Step count",description:"How many times the current time range should be divided to calculate the value",value:E,options:v,onChange:P,width:9,testId:o.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.stepCountIntervalSelect}),a.createElement(l._,{value:y,name:"Min interval",description:"The calculated value will not go below this threshold",placeholder:"10s",onChange:g,width:11,testId:o.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.minIntervalInput})))}const s=h=>({autoFields:(0,n.css)({marginTop:h.spacing(2),display:"flex",flexDirection:"column"})})},44890:(Q,I,e)=>{"use strict";e.d(I,{u:()=>x});var n=e(96540),a=e(16817),o=e(13544),r=e(19347),i=e(88575),f=e(39070),d=e(72574),l=e(90613),m=e(94753),s=e(24240);function h({query:C,datasource:O,VariableQueryEditor:R,onLegacyQueryChange:L,onQueryChange:N,timeRange:F}){let K;return typeof C=="string"?K=C||(O.variables?.getDefaultQuery?.()??""):K={...O.variables?.getDefaultQuery?.(),...C},R&&(0,s.VN)(R,O)?n.createElement(l.a,{marginBottom:2},n.createElement(m.E,{element:"h4"},"Query"),n.createElement(l.a,{marginTop:1},n.createElement(R,{key:O.uid,datasource:O,query:K,templateSrv:(0,d.w)(),onChange:L}))):R&&(0,s.CH)(R,O)?n.createElement(l.a,{marginBottom:2},n.createElement(m.E,{element:"h4"},"Query"),n.createElement(l.a,{marginTop:1},n.createElement(R,{key:O.uid,datasource:O,query:K,onChange:N,onRunQuery:()=>{},data:{series:[],state:f.Gu.Done,timeRange:F},range:F,onBlur:()=>{},history:[]}))):null}var u=e(94618),b=e(51612),g=e(70766),P=e(12470),c=e(40845),y=e(94354),p=e(60619);const v=[{label:"On dashboard load",value:P.CO.onDashboardLoad},{label:"On time range change",value:P.CO.onTimeRangeChanged}];function D({onChange:C,refresh:O,testId:R}){const L=(0,c.$j)(),[N,F]=(0,n.useState)(!1);(0,p.Y)({breakpoint:L.breakpoints.values.sm,onChange:B=>{F(!B.matches)}});const K=(0,n.useMemo)(()=>v.find(B=>B.value===O)?.value??v[0].value,[O]);return n.createElement(i.D,{label:"Refresh",description:"When to update the values of this variable","data-testid":R},n.createElement(y.z,{options:v,onChange:C,value:K,size:N?"sm":"md"}))}var E=e(89458);const S=[{label:"Disabled",value:P.ZG.disabled},{label:"Alphabetical (asc)",value:P.ZG.alphabeticalAsc},{label:"Alphabetical (desc)",value:P.ZG.alphabeticalDesc},{label:"Numerical (asc)",value:P.ZG.numericalAsc},{label:"Numerical (desc)",value:P.ZG.numericalDesc},{label:"Alphabetical (case-insensitive, asc)",value:P.ZG.alphabeticalCaseInsensitiveAsc},{label:"Alphabetical (case-insensitive, desc)",value:P.ZG.alphabeticalCaseInsensitiveDesc},{label:"Natural (asc)",value:P.ZG.naturalAsc},{label:"Natural (desc)",value:P.ZG.naturalDesc}];function T({onChange:C,sort:O,testId:R}){const L=(0,n.useMemo)(()=>S.find(N=>N.value===O)??S[0],[O]);return n.createElement(E.v,{name:"Sort",description:"How to sort the values of this variable",value:L,options:S,onChange:C,testId:R,width:25})}var M=e(58975),A=e(85140);function x({datasource:C,onDataSourceChange:O,query:R,onQueryChange:L,onLegacyQueryChange:N,timeRange:F,regex:K,onRegExChange:B,sort:w,onSortChange:U,refresh:W,onRefreshChange:V,isMulti:_,onMultiChange:H,includeAll:G,onIncludeAllChange:j,allValue:Y,onAllValueChange:oe}){const{value:se}=(0,a.A)(async()=>{const Z=await(0,r.l)().get(C??""),z=await(0,g.y)(Z);return{datasource:Z,VariableQueryEditor:z}},[C]),{datasource:ne,VariableQueryEditor:ee}=se??{};return n.createElement(n.Fragment,null,n.createElement(M.Y,null,"Query options"),n.createElement(i.D,{label:"Data source",htmlFor:"data-source-picker"},n.createElement(b.s,{current:C,onChange:O,variables:!0,width:30})),ne&&ee&&n.createElement(h,{onQueryChange:L,onLegacyQueryChange:N,datasource:ne,query:R,VariableQueryEditor:ee,timeRange:F}),n.createElement(A.Z,{defaultValue:K??"",name:"Regex",description:n.createElement("div",null,"Optional, if you want to extract part of a series name or metric node segment.",n.createElement("br",null),"Named capture groups can be used to separate the display text and value (",n.createElement("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/variables/filter-variables-with-regex#filter-and-modify-using-named-text-and-value-capture-groups",target:"__blank"},"see examples"),")."),placeholder:"/.*-(?<text>.*)-(?<value>.*)-.*/",onBlur:B,testId:o.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRegExInputV2,width:52}),n.createElement(T,{testId:o.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsSortSelectV2,onChange:U,sort:w}),n.createElement(D,{testId:o.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRefreshSelectV2,onChange:V,refresh:W}),n.createElement(M.Y,null,"Selection options"),n.createElement(u.B,{multi:!!_,includeAll:!!G,allValue:Y,onMultiChange:H,onIncludeAllChange:j,onAllValueChange:oe}))}},94618:(Q,I,e)=>{"use strict";e.d(I,{B:()=>f});var n=e(96540),a=e(13544),o=e(67061),r=e(99615),i=e(14329);function f({multi:d,includeAll:l,allValue:m,onMultiChange:s,onIncludeAllChange:h,onAllValueChange:u}){return n.createElement(o.B,{direction:"column",gap:2,height:"inherit",alignItems:"start"},n.createElement(r.c,{value:d,name:"Multi-value",description:"Enables multiple values to be selected at the same time",onChange:s,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsMultiSwitch}),n.createElement(r.c,{value:l,name:"Include All option",description:"Enables an option to include all variables",onChange:h,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsIncludeAllSwitch}),l&&n.createElement(i._,{defaultValue:m??"",onBlur:u,name:"Custom all value",placeholder:"blank = auto",testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsCustomAllInput}))}},99615:(Q,I,e)=>{"use strict";e.d(I,{c:()=>r});var n=e(92145),a=e(96540),o=e(10880);function r({value:i,name:f,description:d,onChange:l,ariaLabel:m,testId:s}){const h=(0,n.Bi)();return a.createElement(o.S,{id:h,label:f,description:d,value:i,onChange:l,"aria-label":m,"data-testid":s})}},8964:(Q,I,e)=>{"use strict";e.d(I,{D:()=>f});var n=e(96540),a=e(12470),o=e(88575),r=e(94354);const i=[{label:"Label and value",value:a.zL.dontHide},{label:"Value",value:a.zL.hideLabel},{label:"Nothing",value:a.zL.hideVariable}];function f({onChange:d,hide:l,type:m}){const s=(0,n.useMemo)(()=>i.find(h=>h.value===l)?.value??i[0].value,[l]);return m==="constant"?null:n.createElement(o.D,{label:"Show on dashboard"},n.createElement(r.z,{options:i,onChange:d,value:s}))}},58975:(Q,I,e)=>{"use strict";e.d(I,{Y:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(17408);function i({className:d,...l}){const m=(0,o.of)(f);return a.createElement(r.s,{...l,className:(0,n.cx)(m.legend,d)})}function f(d){return{legend:(0,n.css)({marginTop:d.spacing(3),marginBottom:d.spacing(1)})}}},89458:(Q,I,e)=>{"use strict";e.d(I,{v:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(88575),i=e(21594);function f({name:l,description:m,value:s,options:h,onChange:u,testId:b,width:g}){const P=(0,o.of)(d),c=(0,a.useId)(),y=`variable-select-input-${l}-${c}`;return a.createElement(r.D,{label:l,description:m,htmlFor:y},a.createElement(i.l6,{"data-testid":b,inputId:y,onChange:u,value:s,width:g??30,options:h,className:P.selectContainer}))}function d(l){return{selectContainer:(0,n.css)({marginRight:l.spacing(.5)})}}},85140:(Q,I,e)=>{"use strict";e.d(I,{$:()=>l,Z:()=>d});var n=e(32196),a=e(92145),o=e(96540),r=e(40845),i=e(88575),f=e(21744);function d({value:m,defaultValue:s,name:h,description:u,placeholder:b,onChange:g,onBlur:P,ariaLabel:c,required:y,width:p,testId:v}){const D=(0,r.of)(l),E=(0,a.Bi)();return o.createElement(i.D,{label:h,description:u,htmlFor:E},o.createElement(f.f,{id:E,rows:2,value:m,defaultValue:s,onChange:g,onBlur:P,placeholder:b,required:y,"aria-label":c,cols:p,className:D.textarea,"data-testid":v}))}function l(m){return{textarea:(0,n.css)({whiteSpace:"pre-wrap",minHeight:m.spacing(4),height:"auto",overflow:"auto",padding:`${m.spacing(.75)} ${m.spacing(1)}`,width:"inherit",[m.breakpoints.down("sm")]:{width:"100%"}})}}},14329:(Q,I,e)=>{"use strict";e.d(I,{_:()=>i});var n=e(92145),a=e(96540),o=e(88575),r=e(10354);function i({value:f,defaultValue:d,name:l,placeholder:m="",onChange:s,testId:h,width:u,required:b,onBlur:g,grow:P,description:c,invalid:y,error:p,maxLength:v}){const D=(0,n.Bi)(l);return a.createElement(o.D,{label:l,description:c,invalid:y,error:p,htmlFor:D},a.createElement(r.p,{type:"text",id:D,placeholder:m,value:f,defaultValue:d,onChange:s,onBlur:g,width:P?void 0:u??30,"data-testid":h,maxLength:v,required:b}))}},41820:(Q,I,e)=>{"use strict";e.d(I,{j:()=>l});var n=e(32196),a=e(96540),o=e(13544),r=e(40845),i=e(39268),f=e(76892),d=e(55852);const l=({options:s})=>{const[h,u]=(0,a.useState)(20),[b,g]=(0,a.useState)([]),P=(0,a.useCallback)(y=>{y.preventDefault(),u(h+20)},[h,u]),c=(0,r.of)(m);return(0,a.useEffect)(()=>g(s.slice(0,h)),[h,s]),b.length?a.createElement("div",{style:{display:"flex",flexDirection:"column",marginTop:"16px"}},a.createElement("h5",null,"Preview of values"),a.createElement(i.C,null,b.map((y,p)=>a.createElement(i.C,{key:`${y.value}-${p}`,className:c.optionContainer},a.createElement(f.c,{"data-testid":o.Tp.pages.Dashboard.Settings.Variables.Edit.General.previewOfValuesOption},a.createElement("div",{className:c.label},y.label))))),s.length>h&&a.createElement(i.C,{className:c.optionContainer},a.createElement(d.$n,{onClick:P,variant:"secondary",size:"sm","aria-label":"Variable editor Preview of Values Show More link"},"Show more"))):null};l.displayName="VariableValuesPreview";function m(s){return{wrapper:(0,n.css)({display:"flex",flexDirection:"column",marginTop:s.spacing(2)}),optionContainer:(0,n.css)({marginLeft:s.spacing(.5),marginBottom:s.spacing(.5)}),label:(0,n.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"50vw"})}}},17663:(Q,I,e)=>{"use strict";e.d(I,{cH:()=>ee,mJ:()=>Z,Ao:()=>Y,e4:()=>oe,kh:()=>H,CD:()=>V,No:()=>_,B$:()=>W,n_:()=>j,bZ:()=>B,c7:()=>ne});var n=e(2543),a=e(32264),o=e(19347),r=e(16401),i=e(79422),f=e(74730),d=e(96540),l=e(16817),m=e(27803);function s(z){const{variable:q}=z,{datasource:ie,defaultKeys:de}=q.useState(),{value:ue}=(0,l.A)(async()=>await(0,o.l)().get(ie),[ie]),fe=ue?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.",Se=ce=>{const me={uid:ce.uid,type:ce.type};q.setState({datasource:me})},he=ce=>{q.setState({defaultKeys:ce})};return d.createElement(m.Q,{datasource:ie??void 0,infoText:fe,onDataSourceChange:Se,defaultKeys:de,onDefaultKeysChange:he})}var h=e(95802);function u({variable:z}){const{value:q}=z.useState(),ie=de=>{z.setState({value:de.currentTarget.value})};return d.createElement(h.d,{constantValue:String(q),onChange:ie})}var b=e(58711);function g({variable:z,onRunQuery:q}){const{query:ie,isMulti:de,allValue:ue,includeAll:fe}=z.useState(),Se=pe=>{z.setState({isMulti:pe.currentTarget.checked})},he=pe=>{z.setState({includeAll:pe.currentTarget.checked})},ce=pe=>{z.setState({query:pe.currentTarget.value}),q()},me=pe=>{z.setState({allValue:pe.currentTarget.value})};return d.createElement(b.w,{query:ie??"",multi:!!de,allValue:ue??"",includeAll:!!fe,onMultiChange:Se,onIncludeAllChange:he,onQueryChange:ce,onAllValueChange:me})}var P=e(98917);function c({variable:z,onRunQuery:q}){const{pluginId:ie,regex:de,isMulti:ue,allValue:fe,includeAll:Se}=z.useState(),he=oe(),ce=Ie=>{z.setState({pluginId:Ie.value}),q()},me=Ie=>{z.setState({regex:Ie.currentTarget.value}),q()},pe=Ie=>{z.setState({isMulti:Ie.currentTarget.checked})},ye=Ie=>{z.setState({includeAll:Ie.currentTarget.checked})},Pe=Ie=>{z.setState({allValue:Ie.currentTarget.value})};return d.createElement(P.y,{query:ie,regex:de,multi:ue||!1,allValue:fe,includeAll:Se||!1,optionTypes:he,onChange:ce,onRegExBlur:me,onMultiChange:pe,onIncludeAllChange:ye,onAllValueChange:Pe})}var y=e(72436),p=e(13544),v=e(88575),D=e(42418),E=e(15292),S=e(32372),T=e(51612),M=e(58975);function A({datasource:z,defaultOptions:q,infoText:ie,onDataSourceChange:de,onDefaultOptionsChange:ue}){const fe=(0,d.useCallback)(Se=>{const he=(0,y.Jh)(`key,value
`+Se)[0],ce=[];for(let me=0;me<he.length;me++)ce.push({text:he.fields[0].values[me],value:he.fields[1].values[me]});ue(ce)},[ue]);return d.createElement(d.Fragment,null,d.createElement(M.Y,null,"Group by options"),d.createElement(v.D,{label:"Data source",htmlFor:"data-source-picker"},d.createElement(T.s,{current:z,onChange:de,width:30,variables:!0,noDefault:!0})),ie?d.createElement(D.F,{title:ie,severity:"info","data-testid":p.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.infoText}):null,d.createElement(v.D,{label:"Use static Group By dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId"},d.createElement(E.d,{"data-testid":p.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.modeToggle,value:q!==void 0,onChange:Se=>{ue(q===void 0?[]:void 0)}})),q!==void 0&&d.createElement(S.B,{height:300,language:"csv",value:q.map(Se=>`${Se.text},${Se.value}`).join(`
`),onBlur:fe,onSave:fe,showMiniMap:!1,showLineNumbers:!0}))}function x(z){const{variable:q,onRunQuery:ie}=z,{datasource:de,defaultOptions:ue}=q.useState(),{value:fe}=(0,l.A)(async()=>await(0,o.l)().get(de),[q.state]),Se=fe?.getTagKeys?"Group by dimensions are applied automatically to all queries that target this data source":"This data source does not support group by variable yet.",he=async me=>{const pe={uid:me.uid,type:me.type};q.setState({datasource:pe}),ie()},ce=async me=>{q.setState({defaultOptions:me}),ie()};return d.createElement(A,{defaultOptions:ue,datasource:de??void 0,infoText:de?Se:void 0,onDataSourceChange:he,onDefaultOptionsChange:ce})}var C=e(49317);function O({variable:z,onRunQuery:q}){const{intervals:ie,autoStepCount:de,autoEnabled:ue,autoMinInterval:fe,value:Se}=z.useState(),he=(0,f.bx)(ie),ce=Pe=>{const Ie=(0,f.Sm)(Pe.currentTarget.value),Oe=Ie.includes(Se)?Se:Ie[0];z.setState({intervals:Ie,value:Oe}),q()},me=Pe=>{z.setState({autoStepCount:Pe.value})},pe=Pe=>{z.setState({autoEnabled:Pe.target.checked})},ye=Pe=>{z.setState({autoMinInterval:Pe.currentTarget.value})};return d.createElement(C.s,{intervals:he,autoStepCount:de,autoEnabled:ue,onAutoCountChanged:me,onIntervalsChange:ce,onAutoEnabledChange:pe,onAutoMinIntervalChanged:ye,autoMinInterval:fe})}var R=e(44890);function L({variable:z,onRunQuery:q}){const{datasource:ie,regex:de,sort:ue,refresh:fe,isMulti:Se,includeAll:he,allValue:ce,query:me}=z.useState(),{value:pe}=r.jh.getTimeRange(z).useState(),ye=Me=>{z.setState({regex:Me.currentTarget.value})},Pe=Me=>{z.setState({sort:Me.value})},Ie=Me=>{z.setState({refresh:Me})},Oe=Me=>{z.setState({isMulti:Me.currentTarget.checked})},Ne=Me=>{z.setState({includeAll:Me.currentTarget.checked})},We=Me=>{z.setState({allValue:Me.currentTarget.value})},Ae=Me=>{const $e={uid:Me.uid,type:Me.type};if(z.state.datasource&&z.state.datasource.type!==$e.type){z.setState({datasource:$e,query:"",definition:""});return}z.setState({datasource:$e})},Ue=Me=>{let $e;typeof Me=="string"?$e=Me:Me.hasOwnProperty("query")&&typeof Me.query=="string"?$e=Me.query:$e="",z.setState({query:Me,definition:$e}),q()};return d.createElement(R.u,{datasource:ie??void 0,onDataSourceChange:Ae,query:me,onQueryChange:Ue,onLegacyQueryChange:Ue,timeRange:pe,regex:de,onRegExChange:ye,sort:ue,onSortChange:Pe,refresh:fe,onRefreshChange:Ie,isMulti:!!Se,onMultiChange:Oe,includeAll:!!he,onIncludeAllChange:Ne,allValue:ce??"",onAllValueChange:We})}var N=e(14329);function F({defaultValue:z,value:q,onChange:ie,onBlur:de}){return d.createElement(d.Fragment,null,d.createElement(M.Y,null,"Text options"),d.createElement(N._,{value:q,defaultValue:z,name:"Default value",placeholder:"default value, if any",onChange:ie,onBlur:de,width:30,testId:p.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2}))}function K({variable:z}){const{value:q}=z.useState(),ie=de=>{z.setState({value:de.currentTarget.value})};return d.createElement(F,{defaultValue:q,onBlur:ie})}function B(z){return z!=="system"}const w={custom:{name:"Custom",description:"Define variable values manually",editor:g},query:{name:"Query",description:"Variable values are fetched from a datasource query",editor:L},constant:{name:"Constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share",editor:u},interval:{name:"Interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",editor:O},datasource:{name:"Data source",description:"Enables you to dynamically switch the data source for multiple panels",editor:c},adhoc:{name:"Ad hoc filters",description:"Add key/value filters on the fly",editor:s},groupby:{name:"Group by",description:"Add keys to group by on the fly",editor:x},textbox:{name:"Textbox",description:"Define a textbox variable, where users can enter any arbitrary string",editor:K}},U=["query","custom","textbox","constant","datasource","interval","adhoc","groupby"];function W(){const z=U.map(q=>({label:w[q].name,value:q,description:w[q].description}));return a.$.featureToggles.groupByVariable?z:z.filter(q=>q.value!=="groupby")}function V(z){return w[z].editor}function _(z,q){switch(z){case"custom":return new r.yP(q);case"query":return new r.fS(q);case"constant":return new r.x0({...q,hide:i.zL.hideVariable});case"interval":return new r.Yj(q);case"datasource":return new r.mI(q);case"adhoc":return new r.H9(q);case"groupby":return new r.ZG(q);case"textbox":return new r.TS(q)}}function H(z){const ie=G("query",z);return new r.fS({name:ie})}function G(z,q){let ie=0,de=`${z}${ie}`;for(;q.find(ue=>ue.state.name===de);)de=`${z}${++ie}`;return de}function j(z){return"options"in z.state||"intervals"in z.state}function Y(z){let q="";return z instanceof r.fS?q=z.state.definition||(typeof z.state.query=="string"?z.state.query:""):z instanceof r.mI?q=String(z.state.pluginId):z instanceof r.yP?q=z.state.query:z instanceof r.Yj?q=(0,f.bx)(z.state.intervals):(z instanceof r.TS||z instanceof r.x0)&&(q=String(z.state.value)),q}function oe(){const z=(0,o.l)().getList({metrics:!0,variables:!0}),q=(0,n.chain)(z).uniqBy("meta.id").map(ie=>({label:ie.meta.name,value:ie.meta.id})).value();return q.unshift({label:"",value:""}),q}function se(z){return"type"in z.state&&"getValue"in z}function ne(z){return se(z)?r.Go.isAdHocVariable(z)||r.Go.isConstantVariable(z)||r.Go.isCustomVariable(z)||r.Go.isDataSourceVariable(z)||r.Go.isIntervalVariable(z)||r.Go.isQueryVariable(z)||r.Go.isTextBoxVariable(z)||r.Go.isGroupByVariable(z):!1}const ee=/^(?!__).*$/,Z=/^\w+$/},19626:(Q,I,e)=>{"use strict";e.d(I,{D:()=>u});var n=e(32196),a=e(2543),o=e(96540),r=e(40845),i=e(14578);const f=({diff:g})=>{const P=(0,r.of)(d),c=!(0,a.isUndefined)(g.originalValue)&&!(0,a.isArray)(g.originalValue)&&!(0,a.isObject)(g.originalValue),y=!(0,a.isUndefined)(g.value)&&!(0,a.isArray)(g.value)&&!(0,a.isObject)(g.value);return o.createElement(o.Fragment,null,c&&o.createElement("span",{className:P},String(g.originalValue)),c&&y?o.createElement(i.I,{name:"arrow-right"}):null,y&&o.createElement("span",{className:P},String(g.value)))},d=g=>(0,n.css)({backgroundColor:g.colors.action.hover,borderRadius:g.shape.radius.default,color:g.colors.text.primary,fontSize:g.typography.body.fontSize,margin:g.spacing(0,.5),padding:g.spacing(.25,.5)});var l=e(56596);const m={op:"replace",originalValue:void 0,path:[""],value:void 0,startLineNumber:0,endLineNumber:0},s=({diff:g,title:P})=>{const c=(0,r.of)(h);return g?o.createElement(o.Fragment,null,o.createElement(i.I,{type:"mono",name:"circle",className:c[g.op],size:"xs"})," ",o.createElement("span",{className:c.embolden},P)," ",o.createElement("span",null,(0,l.Fl)(g,g.path.length>1))," ",o.createElement(f,{diff:g})):o.createElement("div",{className:c.withoutDiff},o.createElement(i.I,{type:"mono",name:"circle",className:c.replace,size:"xs"})," ",o.createElement("span",{className:c.embolden},P)," ",o.createElement("span",null,(0,l.Fl)(m,!1)))},h=g=>({embolden:(0,n.css)({fontWeight:g.typography.fontWeightBold}),add:(0,n.css)({color:g.colors.success.main}),replace:(0,n.css)({color:g.colors.success.main}),move:(0,n.css)({color:g.colors.success.main}),copy:(0,n.css)({color:g.colors.success.main}),_get:(0,n.css)({color:g.colors.success.main}),test:(0,n.css)({color:g.colors.success.main}),remove:(0,n.css)({color:g.colors.success.main}),withoutDiff:(0,n.css)({marginBottom:g.spacing(1)})}),u=({diffs:g,title:P})=>{const c=(0,r.of)(b);return g.length===1?o.createElement("div",{className:c.container,"data-testid":"diffGroup"},o.createElement(s,{title:P,diff:g[0]})):o.createElement("div",{className:c.container,"data-testid":"diffGroup"},o.createElement(s,{title:P}),o.createElement("ul",{className:c.list},g.map((y,p)=>o.createElement("li",{className:c.listItem,key:`${(0,a.last)(y.path)}__${p}`},o.createElement("span",null,(0,l.Fl)(y))," ",o.createElement(f,{diff:y})))))},b=g=>({container:(0,n.css)({}),list:(0,n.css)({marginLeft:g.spacing(4)}),listItem:(0,n.css)({marginBottom:g.spacing(1),"&:last-child":{marginBottom:0}})})},22764:(Q,I,e)=>{"use strict";e.d(I,{M:()=>d});var n=e(32196),a=e(96540),o=e(24773),r=e.n(o),i=e(84140),f=e(40845);const d=({oldValue:l,newValue:m,...s})=>{const h=(0,f.$j)(),u={variables:{dark:{diffViewerBackground:h.colors.background.canvas,diffViewerColor:h.colors.text.primary,addedBackground:(0,i.A)(h.v1.palette.greenShade).setAlpha(.3).toString(),addedColor:"white",removedBackground:(0,i.A)(h.v1.palette.redShade).setAlpha(.3).toString(),removedColor:"white",wordAddedBackground:(0,i.A)(h.v1.palette.greenBase).setAlpha(.4).toString(),wordRemovedBackground:(0,i.A)(h.v1.palette.redBase).setAlpha(.4).toString(),addedGutterBackground:(0,i.A)(h.v1.palette.greenShade).setAlpha(.2).toString(),removedGutterBackground:(0,i.A)(h.v1.palette.redShade).setAlpha(.2).toString(),gutterBackground:h.colors.background.primary,gutterBackgroundDark:h.colors.background.primary,highlightBackground:(0,i.A)(h.colors.primary.main).setAlpha(.4).toString(),highlightGutterBackground:(0,i.A)(h.colors.primary.shade).setAlpha(.2).toString(),codeFoldGutterBackground:h.colors.background.secondary,codeFoldBackground:h.colors.background.secondary,emptyLineBackground:h.colors.background.secondary,gutterColor:h.colors.text.disabled,addedGutterColor:h.colors.text.primary,removedGutterColor:h.colors.text.primary,codeFoldContentColor:h.colors.text.disabled,diffViewerTitleBackground:h.colors.background.secondary,diffViewerTitleColor:h.colors.text.disabled,diffViewerTitleBorderColor:h.colors.border.strong}},codeFold:{fontSize:h.typography.bodySmall.fontSize},gutter:{pre:{color:(0,i.A)(h.colors.text.disabled).setAlpha(1).toString(),opacity:.61}}};return a.createElement("div",{className:(0,n.css)({fontSize:h.typography.bodySmall.fontSize,pre:{all:"revert"}})},a.createElement(r(),{styles:u,oldValue:l,newValue:m,splitView:!1,compareMethod:o.DiffMethod.CSS,useDarkTheme:h.isDark,...s}))}},57714:(Q,I,e)=>{"use strict";e.d(I,{Cc:()=>R,me:()=>v,bS:()=>g,rJ:()=>T,wL:()=>o});var n=e(17172);class a{getHistoryList(F,K){return typeof F!="string"?Promise.resolve([]):(0,n.AI)().get(`api/dashboards/uid/${F}/versions`,K)}getDashboardVersion(F,K){return typeof F!="string"?Promise.resolve({}):(0,n.AI)().get(`api/dashboards/uid/${F}/versions/${K}`)}restoreDashboard(F,K){if(typeof F!="string")return Promise.resolve({});const B=`api/dashboards/uid/${F}/restore`;return(0,n.AI)().post(B,{version:K})}}const o=new a;var r=e(32196),i=e(96540),f=e(40845),d=e(10880),l=e(78369),m=e(71678),s=e(55852),h=e(96374),u=e(3169);const b=({hideModal:N,onRestore:F,version:K})=>{const B=(0,u._2)(),w=async()=>{await F(K)?B.success("Dashboard restored",`Restored from version ${K.version}`):B.error("Dashboard restore failed",`Failed to restore from version ${K.version}`),N()};return i.createElement(h.u,{isOpen:!0,title:"Restore Version",icon:"history",onDismiss:N,onConfirm:w,body:i.createElement("p",null,"Are you sure you want to restore the dashboard to version ",K.version,"? All unsaved changes will be lost."),confirmText:`Yes, restore to version ${K.version}`})},g=({versions:N,canCompare:F,onCheck:K,onRestore:B})=>{const w=(0,f.of)(P);return i.createElement("div",{className:w.margin},i.createElement("table",{className:"filter-table"},i.createElement("thead",null,i.createElement("tr",null,i.createElement("th",{className:"width-4"}),i.createElement("th",{className:"width-4"},"Version"),i.createElement("th",{className:"width-14"},"Date"),i.createElement("th",{className:"width-10"},"Updated by"),i.createElement("th",null,"Notes"),i.createElement("th",null))),i.createElement("tbody",null,N.map((U,W)=>i.createElement("tr",{key:U.id},i.createElement("td",null,i.createElement(d.S,{"aria-label":`Toggle selection of version ${U.version}`,className:(0,r.css)({display:"inline"}),checked:U.checked,onChange:V=>K(V,U.id),disabled:!U.checked&&F})),i.createElement("td",null,U.version),i.createElement("td",null,U.createdDateString),i.createElement("td",null,U.createdBy),i.createElement("td",null,U.message),i.createElement("td",{className:"text-right"},W===0?i.createElement(l.v,{name:"Latest",colorIndex:17}):i.createElement(m.$s,null,({showModal:V,hideModal:_})=>i.createElement(s.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{V(b,{version:U,hideModal:_,onRestore:B})}},"Restore"))))))))};function P(N){return{margin:(0,r.css)({marginBottom:N.spacing(4)})}}var c=e(2543),y=e(29158),p=e(14578);const v=({onClick:N=c.noop,baseVersion:F=0,newVersion:K=0,isNewLatest:B=!1})=>{const w=(0,f.of)(D);return i.createElement("h3",{className:w.header},i.createElement(y.K,{name:"arrow-left",size:"xl",onClick:N,tooltip:"Reset version"}),i.createElement("span",null,"Comparing ",F," ",i.createElement(p.I,{name:"arrows-h"})," ",K," ",B&&i.createElement("cite",{className:"muted"},"(Latest)")))},D=N=>({header:(0,r.css)({fontSize:N.typography.h3.fontSize,display:"flex",gap:N.spacing(2),marginBottom:N.spacing(2)})});var E=e(67061),S=e(56034);const T=({hasMore:N,canCompare:F,getVersions:K,getDiff:B,isLastPage:w})=>i.createElement(E.B,null,N&&i.createElement(s.$n,{type:"button",onClick:()=>K(!0),variant:"secondary",disabled:w},"Show more versions"),i.createElement(S.m,{content:"Select two versions to start comparing",placement:"bottom"},i.createElement(s.$n,{type:"button",disabled:!F,onClick:B,icon:"code-branch"},"Compare versions")));var M=e(90613),A=e(57418),x=e(19626),C=e(22764),O=e(56596);const R=({baseInfo:N,newInfo:F,diffData:K,isNewLatest:B,onRestore:w})=>{const U=(0,O.G4)(K.lhs,K.rhs),W=(0,f.of)(L);return i.createElement(E.B,{direction:"column",gap:1},i.createElement(E.B,{justifyContent:"space-between",alignItems:"center"},i.createElement(E.B,{alignItems:"center"},i.createElement("span",{className:(0,r.cx)(W.versionInfo,W.noMarginBottom)},i.createElement("strong",null,"Version ",N.version)," updated by ",N.createdBy," ",N.ageString,N.message),i.createElement(p.I,{name:"arrow-right",size:"sm"}),i.createElement("span",{className:W.versionInfo},i.createElement("strong",null,"Version ",F.version)," updated by ",F.createdBy," ",F.ageString,F.message)),B&&i.createElement(m.$s,null,({showModal:V,hideModal:_})=>i.createElement(s.$n,{variant:"destructive",icon:"history",onClick:()=>{V(b,{version:N,onRestore:w,hideModal:_})}},"Restore to version ",N.version))),Object.entries(U).map(([V,_])=>i.createElement(x.D,{diffs:_,key:V,title:V})),i.createElement(M.a,{paddingTop:2},i.createElement(A.M,{isOpen:!1,label:"View JSON Diff"},i.createElement(C.M,{oldValue:JSON.stringify(K.lhs,null,2),newValue:JSON.stringify(K.rhs,null,2)}))))},L=N=>({versionInfo:(0,r.css)({color:N.colors.text.secondary,fontSize:N.typography.bodySmall.fontSize}),noMarginBottom:(0,r.css)({marginBottom:0})})},56596:(Q,I,e)=>{"use strict";e.d(I,{Fl:()=>f,G4:()=>i});var n=e(16111),a=e(25504),o=e(2543),r=e.n(o);const i=(m,s)=>{const h=(0,n.UD)(m,s),u=a.stringify(m,null,2),b=a.stringify(s,null,2),g=y=>y.map(p=>{let v,D,E=0,S=0;const T=(0,o.tail)(p.path.split("/"));return p.op==="replace"&&b.pointers[p.path]&&(v=(0,o.get)(m,T),D=p.value,E=b.pointers[p.path].value.line,S=b.pointers[p.path].valueEnd.line),p.op==="add"&&b.pointers[p.path]&&(D=p.value,E=b.pointers[p.path].value.line,S=b.pointers[p.path].valueEnd.line),p.op==="remove"&&u.pointers[p.path]&&(v=(0,o.get)(m,T),E=u.pointers[p.path].value.line,S=u.pointers[p.path].valueEnd.line),{op:p.op,value:D,path:T,originalValue:v,startLineNumber:E,endLineNumber:S}}),P=y=>(0,o.sortBy)(y,"startLineNumber"),c=y=>y.reduce((p,v)=>{const D=v.path[0];return p[D]||(p[D]=[]),p[D].push(v),p},{});return(0,o.flow)([g,P,c])(h)},f=(m,s=!0)=>{const h=(0,o.last)(m.path),u=d(h),b=m.op==="remove"?m.originalValue:m.value;let g=l(m.op);return s&&(u?g+=` item ${h}`:(0,o.isArray)(b)&&!(0,o.isEmpty)(b)?g+=` ${b.length} ${h}`:g+=` ${h}`),g},d=m=>!(0,o.isNaN)((0,o.toNumber)(m)),l=m=>m==="add"?"added":m==="remove"?"deleted":"changed"},58441:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>Ve,m:()=>Ke});var n=e(96540),a=e(32264),o=e(16401),r=e(25897),i=e(37390),f=e(40980),d=e(10096),l=e(8484),m=e(72254),s=e(22699),h=e(60656),u=e(7758),b=e(74730),g=e(4213),P=e.n(g),c=e(16817),y=e(70713),p=e(67061),v=e(88575),D=e(15292),E=e(55852),S=e(32372),T=e(10534),M=e(15858),A=e(34214),x=e(20455),C=e(73788);class O extends o.Bs{constructor(bt){super({isSharingExternally:!1,isViewingJSON:!1,...bt}),this.tabId=s.wr.export,this._exporter=new M.M,this.onShareExternallyChange=()=>{this.setState({isSharingExternally:!this.state.isSharingExternally})},this.onViewJSON=()=>{this.setState({isViewingJSON:!this.state.isViewingJSON})}}static{this.Component=R}getTabLabel(){return(0,l.t)("share-modal.tab-title.export","Export")}getClipboardText(){}async getExportableDashboardJson(){const{dashboardRef:bt,isSharingExternally:St}=this.state,Je=(0,x.Uy)(bt.resolve());return St?await this._exporter.makeExportable(new A.G(Je,void 0,{getVariablesFromState:()=>(0,C.E)(window.__grafanaSceneContext)})):Je}async onSaveAsFile(){const bt=await this.getExportableDashboardJson(),St=JSON.stringify(bt,null,2),{isSharingExternally:Je}=this.state,rt=new Blob([St],{type:"application/json;charset=utf-8"}),Rt=new Date().getTime();let _t="dashboard";"title"in bt&&bt.title&&(_t=bt.title),P()(rt,`${_t}-${Rt}.json`),u.c.exportDownloadJsonClicked({externally:Je})}}function R({model:gt}){const{isSharingExternally:bt,isViewingJSON:St,modalRef:Je}=gt.useState(),rt=(0,c.A)(async()=>{if(St){const _t=await gt.getExportableDashboardJson();return JSON.stringify(_t,null,2)}return""},[St]),Rt=(0,l.t)("share-modal.export.share-externally-label","Export for sharing externally");return n.createElement(n.Fragment,null,!St&&n.createElement(n.Fragment,null,n.createElement("p",{className:"share-modal-info-text"},n.createElement(l.x6,{i18nKey:"share-modal.export.info-text"},"Export this dashboard.")),n.createElement(p.B,{gap:2,direction:"column"},n.createElement(v.D,{label:Rt},n.createElement(D.d,{id:"share-externally-toggle",value:bt,onChange:gt.onShareExternallyChange}))),n.createElement(i.a.ButtonRow,null,n.createElement(E.$n,{variant:"secondary",onClick:()=>{Je?.resolve().onDismiss()},fill:"outline"},n.createElement(l.x6,{i18nKey:"share-modal.export.cancel-button"},"Cancel")),n.createElement(E.$n,{variant:"secondary",icon:"brackets-curly",onClick:gt.onViewJSON},n.createElement(l.x6,{i18nKey:"share-modal.export.view-button"},"View JSON")),n.createElement(E.$n,{variant:"primary",icon:"save",onClick:()=>gt.onSaveAsFile()},n.createElement(l.x6,{i18nKey:"share-modal.export.save-button"},"Save to file")))),St&&n.createElement(n.Fragment,null,n.createElement(y.Ay,{disableHeight:!0},({width:_t})=>rt.value?n.createElement(S.B,{value:rt.value??"",language:"json",showMiniMap:!1,height:"500px",width:_t}):rt.loading?n.createElement("div",null,"Loading..."):null),n.createElement(i.a.ButtonRow,null,n.createElement(E.$n,{variant:"secondary",fill:"outline",onClick:gt.onViewJSON,icon:"arrow-left"},n.createElement(l.x6,{i18nKey:"share-modal.export.back-button"},"Back to export config")),n.createElement(T.b,{variant:"secondary",icon:"copy",disabled:rt.loading,getText:()=>rt.value??""},n.createElement(l.x6,{i18nKey:"share-modal.view-json.copy-button"},"Copy to Clipboard")),n.createElement(E.$n,{variant:"primary",icon:"save",disabled:rt.loading,onClick:()=>gt.onSaveAsFile()},n.createElement(l.x6,{i18nKey:"share-modal.export.save-button"},"Save to file")))))}var L=e(86394),N=e(41507);class F extends o.Bs{constructor(){super(...arguments),this.tabId=s.wr.libraryPanel}static{this.Component=K}getTabLabel(){return(0,l.t)("share-modal.tab-title.library-panel","Library panel")}}function K({model:gt}){const{panelRef:bt,dashboardRef:St,modalRef:Je}=gt.useState();if(!bt)return null;const rt=bt.resolve(),Rt=rt.parent;if(Rt instanceof N.U){const _t=St.resolve(),nn=(0,x.ZB)(Rt),Kt=new A.a(nn),en=(0,x.Uy)(_t),Qt=new A.G(en);return n.createElement(L.j,{initialFolderUid:_t.state.meta.folderUid,dashboard:Qt,panel:Kt,onDismiss:()=>{Je?.resolve().onDismiss()},onCreateLibraryPanel:An=>_t.createLibraryPanel(rt,An)})}return null}var B=e(47232),w=e(13544),U=e(84167),W=e(10354),V=e(14578),_=e(42418),H=e(7030),G=e(87895),j=e(11982);class Y extends o.Bs{constructor(bt){super({...bt,useLockedTime:!0,useShortUrl:!1,selectedTheme:"current",shareUrl:"",imageUrl:""}),this.tabId=s.wr.link,this.onToggleLockedTime=()=>{this.setState({useLockedTime:!this.state.useLockedTime}),this.buildUrl()},this.onUrlShorten=()=>{this.setState({useShortUrl:!this.state.useShortUrl}),this.buildUrl()},this.onThemeChange=St=>{this.setState({selectedTheme:St}),this.buildUrl()},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{u.c.shareLinkCopied({currentTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,s.hD)(this.state.panelRef)})},this.addActivationHandler(()=>{this.buildUrl()})}static{this.Component=oe}async buildUrl(){const{panelRef:bt,dashboardRef:St,useLockedTime:Je,useShortUrl:rt,selectedTheme:Rt}=this.state,_t=St.resolve(),nn=bt?.resolve(),Kt={useAbsoluteTimeRange:Je,theme:Rt};let en=await(0,H.VN)(_t,Kt,nn);rt&&(en=await(0,H.fn)(en));const Qt=o.jh.getTimeRange(nn??_t),An=(0,H.$l)(Kt,Qt,nn);let un=An;nn&&(delete un.viewPanel,un.panelId=nn.state.key,un["__feature.dashboardSceneSolo"]=!0);const fn=(0,j.uZ)({uid:_t.state.uid,currentQueryParams:location.search,updateQuery:{...An,panelId:nn?.state.key},absolute:!0,soloRoute:!0,render:!0,timeZone:se(Qt.getTimeZone())});this.setState({shareUrl:en,imageUrl:fn})}getTabLabel(){return(0,l.t)("share-modal.tab-title.link","Link")}}function oe({model:gt}){const bt=gt.useState(),{panelRef:St,dashboardRef:Je}=bt,rt=Je.resolve(),Rt=St?.resolve(),nn=o.jh.getTimeRange(Rt??rt).state.to==="now",{useLockedTime:Kt,useShortUrl:en,selectedTheme:Qt,shareUrl:An,imageUrl:un}=bt,fn=w.Tp.pages.SharePanelModal,Tt=!!rt.state.uid,$t=(0,l.t)("share-modal.link.time-range-label","Lock time range"),Yt=(0,l.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),Cn=(0,l.t)("share-modal.link.shorten-url","Shorten URL"),Tn=(0,l.t)("share-modal.link.link-url","Link URL");return n.createElement(n.Fragment,null,n.createElement("p",{className:"share-modal-info-text"},n.createElement(l.x6,{i18nKey:"share-modal.link.info-text"},"Create a direct link to this dashboard or panel, customized with the options below.")),n.createElement(U.n,null,n.createElement(v.D,{label:$t,description:nn?Yt:""},n.createElement(D.d,{id:"share-current-time-range",value:Kt,onChange:gt.onToggleLockedTime})),n.createElement(G.w,{selectedTheme:Qt,onChange:gt.onThemeChange}),n.createElement(v.D,{label:Cn},n.createElement(D.d,{id:"share-shorten-url",value:en,onChange:gt.onUrlShorten})),n.createElement(v.D,{label:Tn},n.createElement(W.p,{id:"link-url-input",value:An,readOnly:!0,addonAfter:n.createElement(T.b,{icon:"copy",variant:"primary",getText:gt.getShareUrl,onClipboardCopy:gt.onCopy},n.createElement(l.x6,{i18nKey:"share-modal.link.copy-link-button"},"Copy"))}))),Rt&&a.$.rendererAvailable&&n.createElement(n.Fragment,null,Tt&&n.createElement("div",{className:"gf-form"},n.createElement("a",{href:un,target:"_blank",rel:"noreferrer","aria-label":fn.linkToRenderedImage},n.createElement(V.I,{name:"camera"}),"\xA0",n.createElement(l.x6,{i18nKey:"share-modal.link.rendered-image"},"Direct link rendered image"))),!Tt&&n.createElement(_.F,{severity:"info",title:(0,l.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0},n.createElement(l.x6,{i18nKey:"share-modal.link.save-dashboard"},"To render a panel image, you must save the dashboard first."))),Rt&&!a.$.rendererAvailable&&n.createElement(_.F,{severity:"info",title:(0,l.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0},n.createElement(l.x6,{i18nKey:"share-modal.link.render-instructions"},"To render a panel image, you must install the"," ",n.createElement("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link"},"Grafana image renderer plugin"),". Please contact your Grafana administrator to install the plugin.")))}function se(gt){const bt="UTC"+encodeURIComponent((0,B.KQ)().format("Z"));if(gt==="utc")return"UTC";if(gt==="browser"){if(!window.Intl)return bt;const Je=window.Intl.DateTimeFormat().resolvedOptions();return Je.timeZone?Je.timeZone:bt}return gt}var ne=e(35280),ee=e(7928);class Z extends o.Bs{constructor(bt){super(bt),this.tabId=s.wr.embed}static{this.Component=z}getTabLabel(){return(0,l.t)("share-modal.tab-title.panel-embed","Embed")}}function z({model:gt}){const{panelRef:bt,dashboardRef:St}=gt.useState(),Je=bt.resolve(),rt=St.resolve(),{uid:Rt}=rt.useState(),_t=(0,b.Cs)(Je),nn=o.jh.getTimeRange(Je),Kt=nn instanceof ee.v?nn.state.timeFrom:void 0;return n.createElement(ne.D,{panel:{id:_t,timeFrom:Kt},range:nn.state.value,dashboard:{uid:Rt??"",time:nn.state.value},buildIframe:q(rt)})}const q=gt=>(bt,St,Je,rt,Rt)=>{const _t=(0,s.XV)({useCurrentTimeRange:bt,selectedTheme:Je,panel:rt,range:Rt}),nn=_t.get("editPanel")??_t.get("viewPanel")??"";return _t.set("panelId",nn),_t.delete("editPanel"),_t.delete("viewPanel"),_t.set("__feature.dashboardSceneSolo","true"),`<iframe src="${(0,j.uZ)({absolute:!0,soloRoute:!0,uid:gt.state.uid,slug:gt.state.meta.slug,currentQueryParams:_t.toString()})}" width="450" height="200" frameborder="0"></iframe>`};var ie=e(5805),de=e(17172),ue=e(94354),fe=e(69064);const Se=w.Tp.pages.ShareDashboardModal.SnapshotScene,he=()=>{const gt={label:(0,l.t)("share-modal.snapshot.expire-week","1 Week"),value:604800};return[{label:(0,l.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,l.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},gt,{label:(0,l.t)("share-modal.snapshot.expire-never","Never"),value:0}]},ce=()=>he()[2];class me extends o.Bs{constructor(bt){super({...bt,snapshotName:bt.dashboardRef.resolve().state.title,selectedExpireOption:ce()}),this.tabId=s.wr.snapshot,this.onSnasphotNameChange=St=>{this.setState({snapshotName:St.trim()})},this.onExpireChange=St=>{this.setState({selectedExpireOption:he().find(Je=>Je.value===St)})},this.onSnapshotCreate=async(St=!1)=>{const{selectedExpireOption:Je}=this.state,rt=this.prepareSnapshot(),Rt={dashboard:rt,name:rt.title,expires:Je?.value,external:St};try{return await(0,fe.s)().create(Rt)}finally{St?u.c.publishSnapshotClicked({expires:Rt.expires,shareResource:(0,s.hD)(this.state.panelRef)}):u.c.publishSnapshotLocalClicked({expires:Rt.expires,shareResource:(0,s.hD)(this.state.panelRef)})}},this.addActivationHandler(()=>{this._onActivate()})}static{this.Component=pe}_onActivate(){(0,fe.s)().getSharingOptions().then(bt=>{this.isActive&&this.setState({snapshotSharingOptions:bt})})}getTabLabel(){return(0,l.t)("share-modal.tab-title.snapshot","Snapshot")}prepareSnapshot(){const bt=o.jh.getTimeRange(this),{dashboardRef:St,panelRef:Je}=this.state,rt=(0,x.Uy)(St.resolve(),!0);return(0,x.c)(this.state.snapshotName||"",bt.state.value,rt,Je?.resolve())}}function pe({model:gt}){const{snapshotName:bt,selectedExpireOption:St,modalRef:Je,snapshotSharingOptions:rt}=gt.useState(),[Rt,_t]=(0,ie.default)(async(en=!1)=>gt.onSnapshotCreate(en)),[nn,Kt]=(0,ie.default)(async en=>await(0,de.AI)().get(en));return nn.value?n.createElement(l.x6,{i18nKey:"share-modal.snapshot.deleted-message"},"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."):n.createElement(n.Fragment,null,!Rt.value&&n.createElement(n.Fragment,null,n.createElement("div",null,n.createElement("p",{className:"share-modal-info-text"},n.createElement(l.x6,{i18nKey:"share-modal.snapshot.info-text-1"},"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard.")),n.createElement("p",{className:"share-modal-info-text"},n.createElement(l.x6,{i18nKey:"share-modal.snapshot.info-text-2"},"Keep in mind, your snapshot ",n.createElement("em",null,"can be viewed by anyone")," that has the link and can access the URL. Share wisely."))),n.createElement(v.D,{label:(0,l.t)("share-modal.snapshot.name","Snapshot name")},n.createElement(W.p,{id:"snapshot-name-input",width:30,defaultValue:bt,onBlur:en=>gt.onSnasphotNameChange(en.target.value)})),n.createElement(v.D,{label:(0,l.t)("share-modal.snapshot.expire","Expire")},n.createElement(ue.z,{id:"expire-select-input",options:he(),value:St?.value,onChange:gt.onExpireChange})),n.createElement(i.a.ButtonRow,null,n.createElement(E.$n,{variant:"secondary",onClick:()=>{Je?.resolve().onDismiss()},fill:"outline"},n.createElement(l.x6,{i18nKey:"share-modal.snapshot.cancel-button"},"Cancel")),rt?.externalEnabled&&n.createElement(E.$n,{variant:"secondary",disabled:Rt.loading,onClick:()=>_t(!0)},rt?.externalSnapshotName),n.createElement(E.$n,{variant:"primary",disabled:Rt.loading,onClick:()=>_t(),"data-testid":Se.PublishSnapshot},n.createElement(l.x6,{i18nKey:"share-modal.snapshot.local-button"},"Publish Snapshot")))),Rt.value&&n.createElement(n.Fragment,null,n.createElement(v.D,{label:(0,l.t)("share-modal.snapshot.url-label","Snapshot URL")},n.createElement(W.p,{"data-testid":Se.CopyUrlInput,id:"snapshot-url-input",value:Rt.value.url,readOnly:!0,addonAfter:n.createElement(T.b,{"data-testid":Se.CopyUrlButton,icon:"copy",variant:"primary",getText:()=>Rt.value.url},n.createElement(l.x6,{i18nKey:"share-modal.snapshot.copy-link-button"},"Copy"))})),n.createElement("div",{className:"pull-right",style:{padding:"5px"}},n.createElement(l.x6,{i18nKey:"share-modal.snapshot.mistake-message"},"Did you make a mistake? "),"\xA0",n.createElement(E.$n,{fill:"outline",size:"md",variant:"destructive",onClick:()=>{Kt(Rt.value.deleteUrl)}},n.createElement(l.x6,{i18nKey:"share-modal.snapshot.delete-button"},"Delete snapshot.")))))}var ye=e(72686),Pe=e(4785),Ie=e(32196),Oe=e(40845),Ne=e(59037),We=e(31678),Ae=e(96374);class Ue extends o.Bs{static{this.Component=Me}constructor(bt){super({confirmVariant:"destructive",dismissText:"Cancel",dismissVariant:"secondary",icon:"exclamation-triangle",confirmButtonVariant:"destructive",...bt})}onDismiss(){}}function Me({model:gt}){const bt=gt.useState();return n.createElement(Ae.u,{...bt})}var $e=e(26657),ke=e(31204),Ze=e(31193);const ot=async gt=>{let bt=new Set;for(const St of gt)ke.z.has(St)&&await(0,Ze.tR)().get(St)instanceof $e.iy||bt.add(St);return Array.from(bt)};function xt(gt){const bt=new Set,St=gt.state.body;if(!(St instanceof o.hy))return[];for(const Je of St.state.children){if(Je instanceof N.U){const rt=ft(Je);for(const Rt of rt)bt.add(Rt)}if(Je instanceof o.tI){const rt=ct(Je);for(const Rt of rt)bt.add(Rt)}}return Array.from(bt).sort()}function ct(gt){return new Set(gt.state.children.map(St=>ft(St)).flat())}function ft(gt){let bt;if(gt instanceof N.U)if(gt.state.body instanceof h.F)bt=gt.state.body.state.panel;else if(gt.state.body instanceof o.Eb)bt=gt.state.body;else throw new Error("DashboardGridItem body expected to be VizPanel");if(!bt)throw new Error("Unsupported grid item type");const St=bt.state.$data,Je=new Set;if(St instanceof o.dt)for(const rt of St.state.queries)Je.add(rt.datasource?.type??"");if(St instanceof o.Es){const rt=St.state.$data;if(rt instanceof o.dt)for(const Rt of rt.state.queries)Je.add(Rt.datasource?.type??"")}return Array.from(Je)}function Le(gt){const{value:bt}=(0,c.A)(async()=>{const St=xt(gt);return ot(St)},[]);return bt}function re({model:gt,publicDashboard:bt,isGetLoading:St}){const Je=(0,Oe.of)(X),rt=d.contextSrv.hasPermission(We.AccessControlAction.DashboardsPublicWrite),{dashboardRef:Rt}=gt.useState(),_t=Rt.resolve(),{isDirty:nn}=_t.useState(),[Kt]=(0,ye.bN)(),en=(_t.state.$variables?.state.variables.length??0)>0,Qt=Le(_t),un=o.jh.getTimeRange(gt).useState();return n.createElement(Ne.b,{dashboard:_t,publicDashboard:bt,unsupportedDatasources:Qt,onRevoke:()=>{_t.showModal(new Ue({isOpen:!0,title:"Revoke public URL",icon:"trash-alt",confirmText:"Revoke public URL",body:n.createElement("p",{className:Je.description},"Are you sure you want to revoke this URL? The dashboard will no longer be public."),onDismiss:()=>{_t.showModal(new Ve({dashboardRef:Rt,activeTab:"Public Dashboard"}))},onConfirm:()=>{Kt({dashboard:_t,dashboardUid:_t.state.uid,uid:bt.uid}),_t.closeModal()}}))},timeRange:un.value,showSaveChangesAlert:rt&&nn,hasTemplateVariables:en})}const X=gt=>({description:(0,Ie.css)({fontSize:gt.typography.body.fontSize})});var le=e(22234);function be({model:gt}){const{dashboardRef:bt}=gt.useState(),St=bt.resolve(),Je=Le(St),rt=(St.state.$variables?.state.variables.length??0)>0;return n.createElement(le.D,{dashboard:St,unsupportedDatasources:Je,unsupportedTemplateVariables:rt})}class De extends o.Bs{constructor(){super(...arguments),this.tabId=s.wr.publicDashboard}static{this.Component=Te}getTabLabel(){return(0,l.t)("share-modal.tab-title.public-dashboard","Public Dashboard")}}function Te({model:gt}){const{data:bt,isLoading:St}=(0,ye.Bs)(gt.state.dashboardRef.resolve().state.uid);return n.createElement(n.Fragment,null,St?n.createElement(Pe.a,null):(0,m.lI)(bt)?n.createElement(re,{model:gt,publicDashboard:bt,isGetLoading:St}):n.createElement(be,{model:gt}))}const we=[];function Ke(gt){we.push(gt)}class Ve extends o.Bs{constructor(bt){super({activeTab:"link",...bt}),this.onDismiss=()=>{(0,b.YQ)(this).closeModal()},this.onChangeTab=St=>{u.c.sharingTabChanged({item:St.value,shareResource:(0,s.hD)(this.state.panelRef)}),this.setState({activeTab:St.value})},this.addActivationHandler(()=>this.buildTabs())}static{this.Component=ht}buildTabs(){const{dashboardRef:bt,panelRef:St}=this.state,Je=this.getRef(),rt=[new Y({dashboardRef:bt,panelRef:St,modalRef:Je})],Rt=(0,b.YQ)(this);if(St||rt.push(new O({dashboardRef:bt,modalRef:Je})),d.contextSrv.isSignedIn&&a.$.snapshotEnabled&&Rt.canEditDashboard()&&rt.push(new me({panelRef:St,dashboardRef:bt,modalRef:Je})),St){rt.push(new Z({panelRef:St,dashboardRef:bt}));const _t=St.resolve(),nn=_t.parent instanceof h.F;_t instanceof o.Eb&&(nn||rt.push(new F({panelRef:St,dashboardRef:bt,modalRef:Je})))}St||(rt.push(...we.map(_t=>new _t({dashboardRef:bt,modalRef:Je}))),(0,m.iR)()&&rt.push(new De({dashboardRef:bt,modalRef:Je}))),this.setState({tabs:rt})}}function ht({model:gt}){const{panelRef:bt,tabs:St,activeTab:Je}=gt.useState(),rt=bt?(0,l.t)("share-modal.panel.title","Share Panel"):(0,l.t)("share-modal.dashboard.title","Share");if(!St)return;const Rt=St?.map(Kt=>({label:Kt.getTabLabel(),value:Kt.tabId})),_t=n.createElement(r.J,{title:rt,icon:"share-alt",tabs:Rt,activeTab:Je,onChangeTab:gt.onChangeTab}),nn=St.find(Kt=>Kt.tabId===Je);return n.createElement(i.a,{isOpen:!0,title:_t,onDismiss:gt.onDismiss},n.createElement(f.J,null,nn&&n.createElement(nn.Component,{model:nn})))}},53543:(Q,I,e)=>{"use strict";e.d(I,{R:()=>o});var n=e(16401),a=e(74730);class o{constructor(i){this._vizPanel=i}get id(){const i=(0,a.Cs)(this._vizPanel);return isNaN(i)?(console.error("VizPanel key could not be translated to a legacy numeric panel id",this._vizPanel),0):i}get description(){return this._vizPanel.state.description}get type(){return this._vizPanel.state.pluginId}get title(){return this._vizPanel.state.title}get transformations(){return this._vizPanel.state.$data instanceof n.Es?this._vizPanel.state.$data.state.transformations:[]}get targets(){const i=(0,a.un)(this._vizPanel);return i?i.state.queries:[]}get datasource(){return(0,a.un)(this._vizPanel)?.state.datasource}get options(){return this._vizPanel.state.options}get fieldConfig(){return this._vizPanel.state.fieldConfig}get pluginVersion(){return this._vizPanel.state.pluginVersion}}},96556:(Q,I,e)=>{"use strict";e.d(I,{w:()=>r});var n=e(32264),a=e(16401),o=e(39820);function r(i){if(!i.targets?.length||n.$.panels[i.type]?.skipDataQuery)return;let f;return f=new a.dt({datasource:i.datasource??void 0,queries:i.targets,maxDataPoints:i.maxDataPoints??void 0,maxDataPointsFromWidth:!0,cacheTimeout:i.cacheTimeout,queryCachingTTL:i.queryCachingTTL,minInterval:i.interval??void 0,dataLayerFilter:{panelId:i.id},$behaviors:[new o.L({})]}),new a.Es({$data:f,transformations:i.transformations||[]})}},32023:(Q,I,e)=>{"use strict";e.d(I,{WZ:()=>g,b4:()=>P});var n=e(16401),a=e(16279),o=e(41507),r=e(60656),i=e(42397),f=e(74730);function d(c){return c.state.controls?.state.timePicker}function l(c){return c.state.controls?.state.refreshPicker}function m(c){return c.state.titleItems&&Array.isArray(c.state.titleItems)&&c.state.titleItems[0]instanceof i.$?c.state.titleItems[0]:null}function s(c){const y=[];return c.state.body.forEachChild(p=>{if(!(p instanceof o.U)&&!(p instanceof n.tI))throw new Error("Child is not a DashboardGridItem or SceneGridRow, invalid scene");p instanceof o.U?p.state.body instanceof n.Eb&&y.push(p.state.body):p instanceof n.tI&&p.forEachChild(v=>{v instanceof o.U&&v.state.body instanceof n.Eb&&y.push(v.state.body)})}),y}function h(c){const y=n.jh.getData(c);if(!(y instanceof a.s))throw new Error("DashboardDataLayerSet not found");return y}function u(c){const y=c.state.$behaviors?.find(p=>p instanceof n.Gg.K2);if(y instanceof n.Gg.K2)return y}function b(c){let y=0;const p=c.state.body;if(!(p instanceof n.hy))throw new Error("Dashboard body is not a SceneGridLayout");for(const v of p.state.children){if(v instanceof o.U){const D=v.state.body;if(D){const E=D instanceof r.F?(0,f.RQ)(D):(0,f.Cs)(D);E>y&&(y=E)}}if(v instanceof n.tI){const D=(0,f.Cs)(v);D>y&&(y=D);for(const E of v.state.children)if(E instanceof o.U){const S=E.state.body;if(S){const T=S instanceof r.F?(0,f.RQ)(S):(0,f.Cs)(S);T>y&&(y=T)}}}}return y+1}const g=c=>c.parent instanceof r.F?c.parent:c.parent instanceof o.U&&c.parent.state.body instanceof r.F?c.parent.state.body:null,P={getTimePicker:d,getRefreshPicker:l,getPanelLinks:m,getVizPanels:s,getDataLayers:h,getNextPanelId:b,getCursorSync:u}},27734:(Q,I,e)=>{"use strict";e.d(I,{Gq:()=>f,zf:()=>d});var n=e(76885),a=e(12131),o=e(32264),r=e(16401);const i="grafana.dashboard.preservedUrlFiltersState";function f(l){const m=window.sessionStorage.getItem(i);if(m){const s=new URLSearchParams(m),h=a.Ny.getSearch();s.forEach((b,g)=>{h.has(g)&&h.getAll(g).includes(b)||h.append(g,b)});for(const b of Array.from(h.keys()))b.startsWith("var-")&&(l.state.$variables?.getByName(b.replace("var-",""))||h.delete(b));const u=h.toString();u&&a.Ny.replace({search:u})}}function d(l){if(o.$.featureToggles.preserveDashboardStateWhenNavigating)return()=>{if(!l.state.uid)return;const m=Object.fromEntries(Object.entries(new r.g5().getUrlState(l)).filter(([h])=>h.startsWith("var-")||h==="from"||h==="to"||h==="timezone")),s=Object.fromEntries(Object.entries(m).filter(([h,u])=>!(Array.isArray(u)&&u.length===0)));Object.keys(s).length>0?window.sessionStorage.setItem(i,n.kM.renderUrl("",s)):window.sessionStorage.removeItem(i)}}},73788:(Q,I,e)=>{"use strict";e.d(I,{E:()=>o});var n=e(16401),a=e(53287);function o(r){const i=n.jh.getVariables(r);return(0,a.C)(i)}},7758:(Q,I,e)=>{"use strict";e.d(I,{c:()=>o});var n=e(14110);let a=!1;const o={dashboardInitialized:i=>{r("init_dashboard_completed",{...i})},panelMenuShown:i=>{r("panelheader_menu",{...i,item:"menu"})},panelMenuItemClicked:i=>{r("panelheader_menu",{item:i})},panelMenuInspectClicked(i){r("panelheader_menu",{item:"inspect",tab:i})},panelLinkClicked:i=>{r("panelheader_datalink_clicked",i)},panelStatusMessageClicked:i=>{r("panelheader_statusmessage_clicked",i)},panelCancelQueryClicked:i=>{r("panelheader_cancelquery_clicked",i)},sharingTabChanged:i=>{r("sharing_category_clicked",i)},shareLinkCopied:i=>{r("sharing_link_copy_clicked",i)},embedSnippetCopy:i=>{r("sharing_embed_copy_clicked",i)},publishSnapshotClicked:i=>{r("sharing_snapshot_publish_clicked",i)},publishSnapshotLocalClicked:i=>{r("sharing_snapshot_local_clicked",i)},exportDownloadJsonClicked:i=>{r("sharing_export_download_json_clicked",i)},exportCopyJsonClicked:i=>{r("sharing_export_copy_json_clicked",i)},exportSaveJsonClicked:i=>{r("sharing_export_save_json_clicked",i)},exportViewJsonClicked:i=>{r("sharing_export_view_json_clicked",i)},generatePublicDashboardUrlClicked:i=>{r("sharing_public_generate_url_clicked",i)},revokePublicDashboardEmailClicked:i=>{r("sharing_public_email_revoke_clicked",i)},resendPublicDashboardEmailClicked:i=>{r("sharing_public_email_resend_clicked",i)},publicDashboardEmailInviteClicked:i=>{r("sharing_public_email_invite_clicked",i)},publicDashboardShareTypeChange:i=>{r("sharing_public_can_view_clicked",i)},publicDashboardTimeSelectionChanged:i=>{r("sharing_public_time_picker_clicked",i)},publicDashboardAnnotationsSelectionChanged:i=>{r("sharing_public_annotations_clicked",i)},publicDashboardUrlCopied:i=>{r("sharing_public_copy_url_clicked",i)},publicDashboardPauseSharingClicked:i=>{r("sharing_public_pause_clicked",i)},revokePublicDashboardClicked:i=>{r("sharing_public_revoke_clicked",i)},emptyDashboardButtonClicked:i=>{r("emptydashboard_clicked",i)},toolbarAddButtonClicked:i=>{r("toolbar_add_clicked",i)},toolbarFavoritesClick:()=>{r("toolbar_actions_clicked",{item:"favorites"})},toolbarSettingsClick:()=>{r("toolbar_actions_clicked",{item:"settings"})},toolbarRefreshClick:()=>{r("toolbar_actions_clicked",{item:"refresh"})},toolbarTimePickerClick:()=>{r("toolbar_actions_clicked",{item:"time_picker"})},toolbarZoomClick:()=>{r("toolbar_actions_clicked",{item:"zoom_out_time_range"})},toolbarShareClick:()=>{r("toolbar_actions_clicked",{item:"share"})},toolbarSaveClick:()=>{r("toolbar_actions_clicked",{item:"save"})},toolbarSaveAsClick:()=>{r("toolbar_actions_clicked",{item:"save_as"})},toolbarAddClick:()=>{r("toolbar_actions_clicked",{item:"add"})},setScenesContext:()=>(a=!0,()=>{a=!1})},r=(i,f)=>{const d=a?{scenesView:!0}:{};f?(0,n.rR)(`dashboards_${i}`,{...f,...d}):(0,n.rR)(`dashboards_${i}`)}},99246:(Q,I,e)=>{"use strict";e.d(I,{C:()=>n,Y:()=>a});const n={left:[],right:[]};function a(o,r){n[o].push(r)}},11982:(Q,I,e)=>{"use strict";e.d(I,{Lp:()=>b,Uu:()=>u,e0:()=>h,r7:()=>s,uZ:()=>m});var n=e(76885),a=e(71733),o=e(12131),r=e(32264),i=e(16401),f=e(10096),d=e(87490),l=e(74730);function m(g){let P=`/d/${g.uid}`;g.uid||(P="/dashboard/new"),g.soloRoute&&(P=`/d-solo/${g.uid}`),g.slug&&(P+=`/${g.slug}`),g.subPath&&(P+=g.subPath),g.render&&(P="/render"+P,g.updateQuery={...g.updateQuery,width:1e3,height:500,tz:g.timeZone}),g.isHomeDashboard&&(P="/");const c=g.currentQueryParams?(0,o.SE)(g.currentQueryParams):{};if(g.updateQuery)for(const p in g.updateQuery)g.updateQuery[p]===null||g.updateQuery[p]===void 0?delete c[p]:c[p]=g.updateQuery[p];const y=n.kM.renderUrl(P,c);return g.absolute?r.$.appUrl+y.slice(1):y}function s(g){return a.I.getUrlForPartial(o.Ny.getLocation(),{viewPanel:g.state.key,editPanel:void 0})}function h(g){return a.I.getUrlForPartial(o.Ny.getLocation(),{editPanel:g,viewPanel:void 0})}function u(g,P){const c=g.state.key?.replace("-view","");return a.I.getUrlForPartial(o.Ny.getLocation(),{inspect:c,inspectTab:P})}function b(g){const P=g.getPlugin(),c=(0,l.un)(g);if(!f.contextSrv.hasAccessToExplore()||P?.meta.skipDataQuery||!c)return Promise.resolve(void 0);const y=i.jh.getTimeRange(g);return(0,d.Xe)({queries:c.state.queries,dsRef:c.state.datasource,timeRange:y.state.value,scopedVars:{__sceneObject:{value:g}},adhocFilters:c.state.data?.request?.filters})}},74730:(Q,I,e)=>{"use strict";e.d(I,{Cs:()=>P,O8:()=>O,RQ:()=>c,SN:()=>C,Sm:()=>E,Ws:()=>R,X0:()=>v,XA:()=>g,YQ:()=>A,Yr:()=>L,a7:()=>D,bx:()=>S,pk:()=>T,sw:()=>u,un:()=>M,vL:()=>y,vm:()=>b,xz:()=>x});var n=e(22391),a=e(19347),o=e(16401),r=e(81515),i=e(39820),f=e(24283),d=e(60656),l=e(42397),m=e(7196),s=e(58029),h=e(32023);const u=8,b=12;function g(N){return`panel-${N}`}function P(N){return parseInt(N.state.key.replace("panel-",""),10)}function c(N){return parseInt(N.state.panelKey.replace("panel-",""),10)}function y(N,F){if(!F)return null;const K=p(N,F);if(K)return K;const B=parseInt(F,10);return isNaN(B)?null:p(N,g(B))}function p(N,F){if(!F)return null;const K=o.jh.findObject(N,B=>B.state.key===F?!0:(B instanceof o.Eb,!1));if(K){if(K instanceof o.Eb)return K;throw new Error(`Found panel with key ${F} but it was not a VizPanel`)}return null}function v(N,F){N.forEachChild(K=>{K.isActive&&(K.forceRender(),v(K,F))})}function D(N){const{value:F,text:K,options:B}=N.state;return N.hasAllValue()?{values:B.map(w=>w.value),texts:B.map(w=>w.label)}:{values:Array.isArray(F)?F:[F],texts:Array.isArray(K)?K:[K]}}function E(N){const F=N.match(/(["'])(.*?)\1|\w+/g);if(!F)return r.Ez.query?.split(",")??[];const K=new Set,B=F.reduce((w,U)=>{const W=U.replace(/["']+/g,"");return W.startsWith("$__auto_interval_")||w.add(W),w},K);return Array.from(B)}function S(N){return Array.isArray(N)?N.join(","):""}function T(N,F){const K=Array.isArray(N.current.value)?N.current.value[0]:N.current.value;return K.startsWith("$__auto_interval_")?"$__auto":F.includes(K)?K:F[0]}function M(N){if(!N)return;const F=N.state.$data??N.parent?.state.$data;if(F instanceof o.dt)return F;if(F instanceof o.Es)return M(F)}function A(N){const F=N.getRoot();if(F instanceof f.H$)return F;throw new Error("SceneObject root is not a DashboardScene")}function x(N){return N instanceof o.Eb?N:N.parent?x(N.parent):null}function C(N){return N.includes("clone")}function O(N){const F=h.b4.getNextPanelId(N);return new o.Eb({title:"Panel Title",key:g(F),pluginId:"timeseries",titleItems:[new l.$({menu:new l.m({})})],hoverHeaderOffset:0,menu:new o.Lw({$behaviors:[m._i]}),$data:new o.Es({$data:new o.dt({queries:[{refId:"A"}],datasource:(0,n.p$)((0,a.l)().getInstanceSettings(null)),$behaviors:[new i.L({})]}),transformations:[]})})}function R(N){const F=h.b4.getNextPanelId(N);return new o.tI({key:g(F),title:"Row title",actions:new s.u({}),y:0})}function L(N){if(N.parent instanceof d.F)return N.parent}},28676:(Q,I,e)=>{"use strict";e.d(I,{n:()=>l});var n=e(17172),a=e(32264),o=e(2468),r=e(6473);class i{constructor(){}saveDashboard(s){return r.t.ignoreNextSave(),(0,n.AI)().post("/api/dashboards/db/",{dashboard:s.dashboard,message:s.message??"",overwrite:s.overwrite??!1,folderUid:s.folderUid})}deleteDashboard(s,h){return(0,n.AI)().delete(`/api/dashboards/uid/${s}`,{showSuccessAlert:h})}getDashboardDTO(s){return(0,n.AI)().get(`/api/dashboards/uid/${s}`)}}class f{constructor(s){this.legacy=s,this.client=new o.w({group:"dashboard.grafana.app",version:"v0alpha1",resource:"dashboards"})}saveDashboard(s){return this.legacy.saveDashboard(s)}deleteDashboard(s,h){return this.legacy.deleteDashboard(s,h)}async getDashboardDTO(s){const h=await this.client.get(s);return{meta:{...await this.client.subresource(s,"access"),isNew:!1,isFolder:!1,uid:h.metadata.name},dashboard:h.spec}}}let d;function l(){if(!d){const m=new i;d=a.$.featureToggles.kubernetesDashboards?new f(m):m}return d}},72686:(Q,I,e)=>{"use strict";e.d(I,{$L:()=>y,AK:()=>v,Bs:()=>h,NA:()=>p,NY:()=>c,Sm:()=>s,T2:()=>b,U9:()=>u,_e:()=>P,bN:()=>g,g9:()=>E,kd:()=>D});var n=e(75816),a=e(75505),o=e(17172),r=e(82467),i=e(3169),f=e(24283);function d(S){return typeof S=="object"&&S!=null&&"error"in S}const l=({baseUrl:S})=>async T=>{try{const{data:M,...A}=await(0,a.s)((0,o.AI)().fetch({...T,url:S+T.url,showErrorAlert:T.showErrorAlert}));return{data:M,meta:A}}catch(M){return T.manageError?T.manageError(M):{error:M}}},m=S=>({error:(0,o.NF)(S)&&S.status!==404?S:null}),s=(0,n.xP)({reducerPath:"publicDashboardApi",baseQuery:l({baseUrl:"/api"}),tagTypes:["PublicDashboard","AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"],refetchOnMountOrArgChange:!0,endpoints:S=>({getPublicDashboard:S.query({query:T=>({url:`/dashboards/uid/${T}/public-dashboards`,manageError:m,showErrorAlert:!1}),async onQueryStarted(T,{dispatch:M,queryFulfilled:A}){try{await A}catch(x){d(x)&&(0,o.NF)(x.error)&&M((0,r.dx)((0,i.gi)(x.error.data.message)))}},providesTags:(T,M,A)=>[{type:"PublicDashboard",id:A}]}),createPublicDashboard:S.mutation({query:T=>({url:`/dashboards/uid/${T.dashboard instanceof f.H$?T.dashboard.state.uid:T.dashboard.uid}/public-dashboards`,method:"POST",data:T.payload}),async onQueryStarted({dashboard:T,payload:M},{dispatch:A,queryFulfilled:x}){const{data:C}=await x;A((0,r.dx)((0,i.tZ)("Dashboard is public!"))),T instanceof f.H$?T.setState({meta:{...T.state.meta,publicDashboardEnabled:C.isEnabled}}):T.updateMeta({publicDashboardEnabled:C.isEnabled})},invalidatesTags:(T,M,{dashboard:A})=>[{type:"PublicDashboard",id:A instanceof f.H$?A.state.uid:A.uid}]}),updatePublicDashboard:S.mutation({query:({payload:T,dashboard:M})=>({url:`/dashboards/uid/${M instanceof f.H$?M.state.uid:M.uid}/public-dashboards/${T.uid}`,method:"PATCH",data:T}),async onQueryStarted({dashboard:T},{dispatch:M,queryFulfilled:A}){const{data:x}=await A;M((0,r.dx)((0,i.tZ)("Public dashboard updated!"))),T instanceof f.H$?T.setState({meta:{...T.state.meta,publicDashboardEnabled:x.isEnabled}}):T.updateMeta?.({publicDashboardEnabled:x.isEnabled})},invalidatesTags:(T,M,{payload:A})=>[{type:"PublicDashboard",id:A.dashboardUid},"AuditTablePublicDashboard"]}),addRecipient:S.mutation({query:()=>({url:""})}),deleteRecipient:S.mutation({query:()=>({url:""})}),reshareAccessToRecipient:S.mutation({query:()=>({url:""})}),getActiveUsers:S.query({query:()=>({url:"/"}),providesTags:["UsersWithActiveSessions"]}),getActiveUserDashboards:S.query({query:()=>({url:""}),providesTags:(T,M,A)=>[{type:"ActiveUserDashboards",id:A}]}),listPublicDashboards:S.query({query:(T=1)=>({url:`/dashboards/public-dashboards?page=${T}&perpage=8`}),transformResponse:T=>({...T,totalPages:Math.ceil(T.totalCount/T.perPage)}),providesTags:["AuditTablePublicDashboard"]}),deletePublicDashboard:S.mutation({query:T=>({url:`/dashboards/uid/${T.dashboardUid}/public-dashboards/${T.uid}`,method:"DELETE"}),async onQueryStarted({dashboard:T},{dispatch:M,queryFulfilled:A}){await A,M((0,r.dx)((0,i.tZ)("Public dashboard deleted!"))),T instanceof f.H$?T.setState({meta:{...T.state.meta,publicDashboardEnabled:!1}}):T?.updateMeta({publicDashboardEnabled:!1})},invalidatesTags:(T,M,{dashboardUid:A})=>[{type:"PublicDashboard",id:A},"AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"]}),revokeAllAccess:S.mutation({query:()=>({url:""})})})}),{useGetPublicDashboardQuery:h,useCreatePublicDashboardMutation:u,useUpdatePublicDashboardMutation:b,useDeletePublicDashboardMutation:g,useListPublicDashboardsQuery:P,useAddRecipientMutation:c,useDeleteRecipientMutation:y,useReshareAccessToRecipientMutation:p,useGetActiveUsersQuery:v,useGetActiveUserDashboardsQuery:D,useRevokeAllAccessMutation:E}=s},15858:(Q,I,e)=>{"use strict";e.d(I,{M:()=>h});var n=e(2543),a=e(12470),o=e(19347),r=e(2913),i=e(57767),f=e(75096),d=e(82792),l=e(98796),m=e(24240);function s(u){return!!(u.libraryPanel?.name&&u.libraryPanel?.uid)}class h{async makeExportable(b){b.cleanUpRepeats();const g=b.getSaveModelCloneOld();g.id=null,b.processRepeats();const P=[],c={},y={},p={},v=new Map;for(const T of g.getVariables())p[T.name]=T;const D=(T,M)=>{if(T.datasource===void 0){T.datasource=M;return}let A=T.datasource,x=null;const C=A?.uid,O=C&&f.SY.exec(C);if(O){const R=O[1]||O[2]||O[4];x=p[R],x&&x.current&&(A=x.current.value)}return(0,o.l)().get(A).then(R=>{if(R.meta?.builtIn||(c["datasource"+R.meta?.id]={type:"datasource",id:R.meta.id,name:R.meta.name,version:R.meta.info.version||"1.0.0"},x))return;const L=T.libraryPanel,N=L?"-for-library-panel":"";let F="DS_"+R.name.replace(" ","_").toUpperCase()+N.toUpperCase();if(y[F]={name:F,label:R.name,description:"",type:"datasource",pluginId:R.meta?.id,pluginName:R.meta?.name,usage:y[F]?.usage},L){const K=y[F]?.usage?.libraryPanels||[];K.push({name:L.name,uid:L.uid}),y[F].usage={libraryPanels:K}}T.datasource={type:R.meta.id,uid:"${"+F+"}"}})},E=async T=>{if(T.type!=="row"){if(await D(T),T.targets)for(const A of T.targets)await D(A,T.datasource);const M=r.Ay.panels[T.type];M&&(c["panel"+M.id]={type:"panel",id:M.id,name:M.name,version:M.info.version})}},S=async T=>{if((0,d.X)(T)){const{name:M,uid:A}=T.libraryPanel;let x=T.libraryPanel.model;x||(x=(await(0,i.Yr)(A,!0)).model),await D(x);const{gridPos:C,id:O,...R}=x;v.has(A)||v.set(A,{name:M,uid:A,kind:l.i.Panel,model:R})}};try{for(const A of g.panels)if(await E(A),A.collapsed!==void 0&&A.collapsed===!0&&A.panels)for(const x of A.panels)await E(x);for(const A of g.getVariables())A.type==="query"?(await D(A),A.options=[],A.current={},A.refresh=A.refresh!==a.CO.never?A.refresh:a.CO.onDashboardLoad):A.type==="datasource"&&(A.current={});for(const A of g.annotations.list)await D(A);c.grafana={type:"grafana",id:"grafana",name:"Grafana",version:r.Ay.buildInfo.version};for(const A of g.panels)if(await S(A),A.collapsed!==void 0&&A.collapsed===!0&&A.panels)for(const x of A.panels)await S(x);(0,n.each)(y,A=>{P.push(A)});for(const A of g.getVariables())if((0,m.VO)(A)){const x="VAR_"+A.name.replace(" ","_").toUpperCase();P.push({name:x,type:"constant",label:A.label||A.name,value:A.query,description:""}),A.query="${"+x+"}",A.current={value:A.query,text:A.query,selected:!1},A.options=[A.current]}const T=[...v.entries()].reduce((A,[x,C])=>(A[x]=C,A),{}),M=(0,n.defaults)({__inputs:P,__elements:T,__requires:(0,n.sortBy)(c,["id"])},g);for(let A=0;A<M.panels.length;A++){const x=M.panels[A];s(x)&&(M.panels[A]={gridPos:x.gridPos,id:x.id,libraryPanel:{uid:x.libraryPanel.uid,name:x.libraryPanel.name}})}return M}catch(T){return console.error("Export failed:",T),{error:T}}}}},20120:(Q,I,e)=>{"use strict";e.d(I,{UP:()=>ie,fP:()=>de,Ay:()=>fe});var n=e(32196),a=e(96540),o=e(71468),r=e(24180),i=e(40672),f=e(13544),d=e(12131),l=e(69731),m=e(96374),s=e(39938),h=e(19727),u=e(27746),b=e(71678),g=e(15068),P=e(82467),c=e(75269),y=e(10804),p=e(2913),v=e(3169),D=e(10096),E=e(16021),S=e(8484),T=e(91219),M=e(28215),A=e(83122),x=e(55852),C=e(14578),O=e(32264),R=e(38138),L=e(36974),N=e(7758),F=e(31678),K=e(28601);const w=({dashboard:ce})=>{const me=(0,a.useMemo)(()=>(0,L._u)(),[]),pe=(0,F.useDispatch)(),ye=(0,F.useSelector)(Pe=>Pe.dashboard.initialDatasource);return a.createElement(R.W,null,a.createElement(R.W.Item,{key:"add-visualisation",testId:f.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,S.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const Pe=(0,L.OK)(ce,ye);N.c.toolbarAddButtonClicked({item:"add_visualization"}),d.Ny.partial({editPanel:Pe}),pe((0,K.Ub)(void 0))}}),O.$.featureToggles.vizAndWidgetSplit&&a.createElement(R.W.Item,{key:"add-widget",testId:f.Tp.pages.AddDashboard.itemButton("Add new widget menu item"),label:(0,S.t)("dashboard.add-menu.widget","Widget"),onClick:()=>{N.c.toolbarAddButtonClicked({item:"add_widget"}),d.Ny.partial({addWidget:!0})}}),a.createElement(R.W.Item,{key:"add-row",testId:f.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,S.t)("dashboard.add-menu.row","Row"),onClick:()=>{N.c.toolbarAddButtonClicked({item:"add_row"}),(0,L.SD)(ce)}}),a.createElement(R.W.Item,{key:"add-panel-lib",testId:f.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,S.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{N.c.toolbarAddButtonClicked({item:"import_from_library"}),(0,L.s3)(ce)}}),a.createElement(R.W.Item,{key:"add-panel-clipboard",testId:f.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,S.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{N.c.toolbarAddButtonClicked({item:"paste_panel"}),(0,L.no)(ce,me)},disabled:!me}))},W=({dashboard:ce,onToolbarAddMenuOpen:me})=>{const[pe,ye]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{pe&&me&&me()},[pe,me]),a.createElement(A.m,{overlay:()=>a.createElement(w,{dashboard:ce}),placement:"bottom",offset:[0,6],onVisibleChange:ye},a.createElement(x.$n,{variant:"secondary",size:"sm",fill:"outline","data-testid":f.Tp.components.PageToolbar.itemButton("Add button")},a.createElement(S.x6,{i18nKey:"dashboard.toolbar.add"},"Add"),a.createElement(C.I,{name:pe?"angle-up":"angle-down",size:"lg"})))};var V=e(70497),_=e(14792),H=e(2609),G=e(81862),j=e(28444),Y=e(99246),oe=e(93030),se=e(62367);const ne=({dashboard:ce})=>a.createElement(x.$n,{"data-testid":f.Tp.pages.Dashboard.DashNav.shareButton,variant:"primary",size:"sm",onClick:()=>{N.c.toolbarShareClick(),d.Ny.partial({shareView:"link"})}},a.createElement(S.x6,{i18nKey:"dashboard.toolbar.share-button"},"Share")),ee={removeNavIndex:M.Im,setStarred:T.ci,updateTimeZoneForSession:G.Cj,updateNavIndex:P.Vz},Z=ce=>({navIndex:ce.navIndex}),z=(0,o.connect)(Z,ee),q=f.Tp.pages.Dashboard.DashNav;function ie(ce){(0,Y.Y)("left",ce)}function de(ce){(0,Y.Y)("right",ce)}const ue=a.memo(ce=>{(0,r.zy)();const me=(0,l.C)();(0,E.u)(ce.dashboard.events,j.Cf);const pe=ce.dashboard.snapshot?.originalUrl??"",ye=()=>{window.location.href=i.sQ.sanitizeUrl(ce.dashboard.snapshot.originalUrl)},Pe=(0,v._2)(),Ie=()=>{try{const ct=new URL(i.sQ.sanitizeUrl(pe),p.Ay.appUrl),ft=new URL(p.Ay.appUrl);ct.host!==ft.host?D.lE.publish(new j.S8({component:m.u,props:{title:"Proceed to external site?",modalClass:Se,body:a.createElement(a.Fragment,null,a.createElement("p",null,"This link connects to an external website at"," ",a.createElement("code",null,pe)),a.createElement("p",null,"Are you sure you'd like to proceed?")),confirmVariant:"primary",confirmText:"Proceed",onConfirm:ye}})):ye()}catch(ct){Pe.error("Invalid URL",ct instanceof Error?ct.message:void 0)}},Oe=()=>{N.c.toolbarFavoritesClick();const ct=(0,_.UA)(),{dashboard:ft,navIndex:Le,removeNavIndex:re,setStarred:X,updateNavIndex:le}=ce;ct.starDashboard(ft.uid,!!ft.meta.isStarred).then(be=>{X({id:ft.uid,title:ft.title,url:ft.meta.url??"",isStarred:be});const De=Le.starred;if(be)De.children?.push({id:T.L1+ft.uid,text:ft.title,url:ft.meta.url??"",parentItem:De});else{re(T.L1+ft.uid);const Te=De.children?.findIndex(we=>we.id===T.L1+ft.uid);Te&&De.children?.splice(Te,1)}le(De),ft.meta.isStarred=be,me()})},Ne=()=>{N.c.toolbarSettingsClick(),d.Ny.partial({editview:"settings"})},We=()=>{H._o.prev()},Ae=()=>{H._o.next()},Ue=()=>{H._o.stop(),me()},Me=(ct,ft)=>{ct.map((Le,re)=>{const X=Le.component,le=a.createElement(X,{...ce,key:`button-custom-${re}`});typeof Le.index=="number"?ft.splice(Le.index,0,le):ft.push(le)})},$e=()=>H._o.state.isPlaying,ke=()=>{const{dashboard:ct,kioskMode:ft}=ce,{canStar:Le,isStarred:re}=ct.meta,X=[];if(ft||$e())return[];if(Le){let le=re?(0,S.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,S.t)("dashboard.toolbar.mark-favorite","Mark as favorite");X.push(a.createElement(oe._,{tooltip:le,icon:re?"favorite":"star",iconType:re?"mono":"default",iconSize:"lg",onClick:Oe,key:"button-star"}))}return ct.meta.publicDashboardEnabled&&X.push(a.createElement(s.E,{color:"blue",text:"Public",key:"public-dashboard-button-badge",className:he,"data-testid":q.publicDashboardTag})),p.Ay.featureToggles.scenes&&X.push(a.createElement(oe._,{key:"button-scenes",tooltip:"View as Scene",icon:"apps",onClick:()=>{d.Ny.partial({scenes:!0})}})),Me(Y.C.left,X),X},Ze=()=>a.createElement(h.e,{key:"playlist-buttons"},a.createElement(u.I,{tooltip:(0,S.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:We,narrow:!0}),a.createElement(u.I,{onClick:Ue},a.createElement(S.x6,{i18nKey:"dashboard.toolbar.playlist-stop"},"Stop playlist")),a.createElement(u.I,{tooltip:(0,S.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:Ae,narrow:!0})),ot=()=>{const{dashboard:ct,updateTimeZoneForSession:ft,hideTimePicker:Le}=ce;return Le?null:a.createElement(se.$,{dashboard:ct,onChangeTimeZone:ft,onToolbarRefreshClick:N.c.toolbarRefreshClick,onToolbarZoomClick:N.c.toolbarZoomClick,onToolbarTimePickerClick:N.c.toolbarTimePickerClick,key:"time-controls"})},xt=()=>{const{dashboard:ct,isFullscreen:ft,kioskMode:Le,hideTimePicker:re}=ce,{canSave:X,canEdit:le,showSettings:be,canShare:De}=ct.meta,{snapshot:Te}=ct,we=Te&&Te.originalUrl,Ke=[];return $e()?[Ze(),ot()]:Le===F.KioskMode.TV?[ot()]:(we&&Ke.push(a.createElement(u.I,{tooltip:(0,S.t)("dashboard.toolbar.open-original","Open original dashboard"),onClick:Ie,icon:"link",key:"button-snapshot"})),X&&!ft&&Ke.push(a.createElement(b.$s,{key:"button-save"},({showModal:Ve,hideModal:ht})=>a.createElement(u.I,{tooltip:(0,S.t)("dashboard.toolbar.save","Save dashboard"),icon:"save",onClick:()=>{N.c.toolbarSaveClick(),Ve(V.$,{dashboard:ct,onDismiss:ht})}}))),Me(Y.C.right,Ke),be&&Ke.push(a.createElement(u.I,{tooltip:(0,S.t)("dashboard.toolbar.settings","Dashboard settings"),icon:"cog",onClick:Ne,key:"button-settings"})),le&&!ft&&Ke.push(a.createElement(W,{dashboard:ct,onToolbarAddMenuOpen:N.c.toolbarAddClick,key:"panel-add-dropdown"})),De&&Ke.push(a.createElement(ne,{key:"button-share",dashboard:ct})),re||Ke.push(a.createElement(y.K,{key:"toolbar-separator"})),Ke.push(ot()),Ke)};return a.createElement(c.H,{actions:a.createElement(a.Fragment,null,ke(),a.createElement(y.K,{leftActionsSeparator:!0}),a.createElement(g.U,{alignment:"right"},xt()))})});ue.displayName="DashNav";const fe=z(ue),Se=(0,n.css)({width:"max-content",maxWidth:"80vw"}),he=(0,n.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})},93030:(Q,I,e)=>{"use strict";e.d(I,{_:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(29158);const i=({icon:d,iconType:l,iconSize:m,tooltip:s,onClick:h,children:u})=>{const b=(0,o.of)(f);return a.createElement("div",{className:b.noBorderContainer},d&&a.createElement(r.K,{name:d,size:m,iconType:l,tooltip:s,tooltipPlacement:"bottom",onClick:h}),u)},f=d=>({noBorderContainer:(0,n.css)({padding:`0 ${d.spacing(.5)}`,display:"flex"})})},62367:(Q,I,e)=>{"use strict";e.d(I,{$:()=>h});var n=e(96540),a=e(85858),o=e(3591),r=e(11134),i=e(25573),f=e(10096),d=e(8484),l=e(16233),m=e(74856),s=e(28444);class h extends n.Component{constructor(){super(...arguments),this.onChangeRefreshInterval=b=>{(0,m.jG)().setAutoRefresh(b),this.forceUpdate()},this.onRefresh=()=>((0,m.jG)().refreshTimeModel(),Promise.resolve()),this.onMoveBack=()=>{f.lE.publish(new s.Io({direction:s.xL.Left}))},this.onMoveForward=()=>{f.lE.publish(new s.Io({direction:s.xL.Right}))},this.onChangeTimePicker=b=>{const{dashboard:g}=this.props,P=g.timepicker,c=P.nowDelay&&b.raw.to==="now",y=a.isMathString(b.raw.from)?b.raw.from:b.from,p=a.isMathString(b.raw.to)?b.raw.to:b.to,v={from:y,to:c?"now-"+P.nowDelay:p};(0,m.jG)().setTime(v)},this.onChangeTimeZone=b=>{this.props.dashboard.timezone=b,this.props.onChangeTimeZone(b),this.onRefresh()},this.onChangeFiscalYearStartMonth=b=>{this.props.dashboard.fiscalYearStartMonth=b,this.onRefresh()},this.onZoom=()=>{this.props.onToolbarZoomClick&&this.props.onToolbarZoomClick(),f.lE.publish(new s.U0({scale:2}))},this.onRefreshClick=()=>{this.props.onToolbarRefreshClick&&this.props.onToolbarRefreshClick(),this.onRefresh()}}componentDidMount(){this.sub=this.props.dashboard.events.subscribe(o.sR,()=>this.forceUpdate())}componentWillUnmount(){this.sub?.unsubscribe()}render(){const{dashboard:b,isOnCanvas:g}=this.props,{refresh_intervals:P}=b.timepicker,c=(0,m.jG)().getValidIntervals(P||r.cb),y=(0,m.jG)().timeRange(),p=b.getTimezone(),v=b.fiscalYearStartMonth,D=b.panelInEdit?.isEditing;let E;return b.refresh===l.SM&&(E=(0,m.jG)().getAutoRefreshInteval().interval),n.createElement(n.Fragment,null,n.createElement(i.m,{value:y,onChange:this.onChangeTimePicker,timeZone:p,fiscalYearStartMonth:v,onMoveBackward:this.onMoveBack,onMoveForward:this.onMoveForward,onZoom:this.onZoom,onChangeTimeZone:this.onChangeTimeZone,onChangeFiscalYearStartMonth:this.onChangeFiscalYearStartMonth,isOnCanvas:g,onToolbarTimePickerClick:this.props.onToolbarTimePickerClick}),n.createElement(r.cC,{onIntervalChanged:this.onChangeRefreshInterval,onRefresh:this.onRefreshClick,value:b.refresh,intervals:c,isOnCanvas:g,tooltip:(0,d.t)("dashboard.toolbar.refresh","Refresh dashboard"),noIntervalPicker:D,showAutoInterval:!0,text:E}))}}},16495:(Q,I,e)=>{"use strict";e.d(I,{U:()=>n.Ay});var n=e(20120)},46991:(Q,I,e)=>{"use strict";e.d(I,{d:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(55852);const i=({children:d,...l})=>{const m=(0,o.of)(f);return a.createElement("div",{className:m.buttonWrapper},a.createElement(r.$n,{icon:"plus",...l},d))},f=d=>({buttonWrapper:(0,n.css)({padding:`${d.spacing(3)} 0`})})},75590:(Q,I,e)=>{"use strict";e.d(I,{p:()=>y});var n=e(2543),a=e(96540),o=e(65879),r=e(13544),i=e(57418),f=e(88575),d=e(20333),l=e(15648),m=e(10354),s=e(15292),h=e(8484),u=e(11134),b=e(74856);const g=({refreshIntervals:p,onRefreshIntervalChange:v,getIntervalsFunc:D=c,validateIntervalsFunc:E=P})=>{const[S,T]=(0,a.useState)(D(p??u.cb)),[M,A]=(0,a.useState)(null);(0,a.useEffect)(()=>{const R=D(p??u.cb);T(R)},[D,p]);const x=(0,a.useMemo)(()=>Array.isArray(S)?S.join(","):"",[S]),C=(0,a.useCallback)(R=>{const L=R.currentTarget.value?R.currentTarget.value.split(","):[];T(L)},[T]),O=(0,a.useCallback)(R=>{const L=E(S);L===null&&v(D(S)),A(L)},[D,S,v,E]);return a.createElement(f.D,{label:(0,h.t)("dashboard-settings.general.auto-refresh-label","Auto refresh"),description:(0,h.t)("dashboard-settings.general.auto-refresh-description","Define the auto refresh intervals that should be available in the auto refresh list. Use the format '5s' for seconds, '1m' for minutes, '1h' for hours, and '1d' for days (e.g.: '5s,10s,30s,1m,5m,15m,30m,1h,2h,1d')."),error:M,invalid:!!M},a.createElement(m.p,{id:"auto-refresh-input",invalid:!!M,value:x,onChange:C,onBlur:O}))},P=(p,v={getTimeSrv:b.jG})=>{try{return c(p,v),null}catch(D){return D instanceof Error?D.message:"Invalid intervals"}},c=(p,v={getTimeSrv:b.jG})=>{const D=p.filter(E=>E.trim()!=="").map(E=>E.replace(/\s+/g,""));return[...new Set(v.getTimeSrv().getValidIntervals(D))]};class y extends a.PureComponent{constructor(){super(...arguments),this.state={isNowDelayValid:!0},this.onNowDelayChange=v=>{const D=v.currentTarget.value;if((0,n.isEmpty)(D))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(D);if(o.isValidTimeSpan(D))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(D);this.setState({isNowDelayValid:!1})},this.onHideTimePickerChange=()=>{this.props.onHideTimePickerChange(!this.props.timePickerHidden)},this.onLiveNowChange=()=>{this.props.onLiveNowChange(!this.props.liveNow)},this.onTimeZoneChange=v=>{typeof v=="string"&&this.props.onTimeZoneChange(v)},this.onWeekStartChange=v=>{this.props.onWeekStartChange(v)}}render(){return a.createElement(i.M,{label:(0,h.t)("dashboard-settings.time-picker.time-options-label","Time options"),isOpen:!0},a.createElement(f.D,{label:(0,h.t)("dashboard-settings.time-picker.time-zone-label","Time zone"),"data-testid":r.Tp.components.TimeZonePicker.containerV2},a.createElement(d.U,{inputId:"time-options-input",includeInternal:!0,value:this.props.timezone,onChange:this.onTimeZoneChange,width:40})),a.createElement(f.D,{label:(0,h.t)("dashboard-settings.time-picker.week-start-label","Week start"),"data-testid":r.Tp.components.WeekStartPicker.containerV2},a.createElement(l.l,{inputId:"week-start-input",width:40,value:this.props.weekStart,onChange:this.onWeekStartChange})),a.createElement(g,{refreshIntervals:this.props.refreshIntervals,onRefreshIntervalChange:this.props.onRefreshIntervalChange}),a.createElement(f.D,{label:(0,h.t)("dashboard-settings.time-picker.now-delay-label","Now delay"),description:(0,h.t)("dashboard-settings.time-picker.now-delay-description","Exclude recent data that may be incomplete.")},a.createElement(m.p,{id:"now-delay-input",invalid:!this.state.isNowDelayValid,placeholder:"0m",onChange:this.onNowDelayChange,defaultValue:this.props.nowDelay})),a.createElement(f.D,{label:(0,h.t)("dashboard-settings.time-picker.hide-time-picker","Hide time picker")},a.createElement(s.d,{id:"hide-time-picker-toggle",value:!!this.props.timePickerHidden,onChange:this.onHideTimePickerChange})),a.createElement(f.D,{label:(0,h.t)("dashboard-settings.time-picker.refresh-live-dashboards-label","Refresh live dashboards"),description:(0,h.t)("dashboard-settings.time-picker.refresh-live-dashboards-description","Continuously re-draw panels where the time range references 'now'")},a.createElement(s.d,{id:"refresh-live-dashboards-toggle",value:!!this.props.liveNow,onChange:this.onLiveNowChange})))}}},16561:(Q,I,e)=>{"use strict";e.d(I,{s:()=>ko});var n=e(96540),a=e(24180),o=e(71733),r=e(13544),i=e(12131),f=e(55852),d=e(15068),l=e(67061),m=e(94753),s=e(75269),h=e(67608),u=e(8484),b=e(16233),g=e(31678),P=e(28444),c=e(71468),y=e(14644),p=e(32196),v=e(16817),D=e(14110),E=e(40845),S=e(57418),T=e(66864),M=e(62930),A=e(56034),x=e(14578),C=e(29158),O=e(37390);const R=({nodes:zt,edges:rn,direction:zn,width:Fn,height:ta,onDoubleClick:ua})=>{const ya=(0,n.useRef)(null),as=(0,n.useRef)(null),Ga=(0,n.useCallback)(_a=>{ua&&ua(_a.nodes[0])},[ua]);return(0,n.useEffect)(()=>((async()=>{const nr=await e.e(5083).then(e.t.bind(e,83416,23)),ps={nodes:L(nr,zt),edges:N(nr,rn)},Qs={width:"100%",height:"100%",autoResize:!0,layout:{improvedLayout:!0,hierarchical:{enabled:!0,direction:zn??"DU",sortMethod:"directed"}},interaction:{navigationButtons:!0,dragNodes:!1}};ya.current=new nr.Network(as.current,ps,Qs),ya.current?.on("doubleClick",Ga)})(),()=>{ya.current&&ya.current.off("doubleClick")}),[zn,rn,zt,Ga]),n.createElement("div",null,n.createElement("div",{ref:as,style:{width:Fn??"100%",height:ta??"60vh"}}))};function L(zt,rn){const zn=rn.map(Fn=>({...Fn,shape:"box"}));return new zt.DataSet(zn)}function N(zt,rn){const zn=rn.map(Fn=>({...Fn,arrows:"to",dashes:!0}));return new zt.DataSet(zn)}function F({edges:zt,nodes:rn,show:zn,title:Fn,children:ta}){const[ua,ya]=(0,n.useState)(zn),as=(0,n.useCallback)(()=>ya(!0),[ya]),Ga=(0,n.useCallback)(()=>ya(!1),[ya]);return n.createElement(n.Fragment,null,n.createElement(O.a,{isOpen:ua,title:Fn,icon:"info-circle",iconTooltip:"The graph can be moved, zoomed in, and zoomed out.",onClickBackdrop:Ga,onDismiss:Ga},n.createElement(R,{nodes:rn,edges:zt})),ta({showModal:as}))}const K=({id:zt,usages:rn})=>{const zn=(0,n.useMemo)(()=>rn.find(ta=>ta.variable.id===zt),[zt,rn]);if(!zn)return null;const Fn=zn.nodes.map(ta=>ta.label.includes(`$${zt}`)?{...ta,color:"#FB7E81"}:ta);return n.createElement(F,{show:!1,title:`Showing usages for: $${zt}`,nodes:Fn,edges:zn.edges},({showModal:ta})=>n.createElement(C.K,{onClick:()=>ta(),name:"code-branch",tooltip:"Show usages","data-testid":"VariablesUnknownButton"}))};var B=e(12846);const w=1e3;function U({variables:zt,dashboard:rn}){const[zn,Fn]=(0,n.useState)(!1),[ta,ua]=(0,n.useState)(0),[ya,as]=(0,n.useState)([]),Ga=(0,E.of)(H);(0,n.useEffect)(()=>ua(ps=>ps+1),[zt,rn]);const{loading:_a}=(0,v.A)(async()=>{if(zn&&ta>0){const ps=Date.now(),Qs=await(0,B.g0)(zt,rn),_r=Date.now()-ps;return _r>=w&&(0,D.rR)("Slow unknown variables expansion",{elapsed:_r}),ua(0),as(Qs),Qs}return[]},[zt,rn,zn,ta]),nr=ps=>{ps&&(0,D.rR)("Unknown variables section expanded"),Fn(ps)};return n.createElement("div",{className:Ga.container},n.createElement(S.M,{label:n.createElement(W,null),isOpen:zn,onToggle:nr},_a&&n.createElement(T.gW,{justify:"center"},n.createElement(T.Gy,{justify:"center"},n.createElement("span",null,"Loading..."),n.createElement(M.y,null))),!_a&&ya&&n.createElement(n.Fragment,null,ya.length===0&&n.createElement(V,null),ya.length>0&&n.createElement(_,{usages:ya}))))}function W(){const zt=(0,E.of)(H);return n.createElement("h5",null,"Renamed or missing variables",n.createElement(A.m,{content:"Click to expand a list with all variable references that have been renamed or are missing from the dashboard."},n.createElement(x.I,{name:"info-circle",className:zt.infoIcon})))}function V(){return n.createElement("span",null,"No renamed or missing variables found.")}function _({usages:zt}){const rn=(0,E.of)(H);return n.createElement("table",{className:"filter-table filter-table--hover"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"Variable"),n.createElement("th",{colSpan:5}))),n.createElement("tbody",null,zt.map(zn=>{const{variable:Fn}=zn,{id:ta,name:ua}=Fn;return n.createElement("tr",{key:ta},n.createElement("td",{className:rn.firstColumn},n.createElement("span",null,ua)),n.createElement("td",{className:rn.defaultColumn}),n.createElement("td",{className:rn.defaultColumn}),n.createElement("td",{className:rn.defaultColumn}),n.createElement("td",{className:rn.lastColumn},n.createElement(K,{id:Fn.id,usages:zt})))})))}const H=zt=>({container:(0,p.css)`
    margin-top: ${zt.spacing(4)};
    padding-top: ${zt.spacing(4)};
  `,infoIcon:(0,p.css)`
    margin-left: ${zt.spacing(1)};
  `,defaultColumn:(0,p.css)`
    width: 1%;
  `,firstColumn:(0,p.css)`
    width: 1%;
    vertical-align: top;
    color: ${zt.colors.text.maxContrast};
  `,lastColumn:(0,p.css)`
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    width: 100%;
    text-align: right;
  `});var G=e(48594),j=e(87421),Y=e(56968),oe=e(75096),se=e(96374);function ne({varName:zt,isOpen:rn=!1,onConfirm:zn,onDismiss:Fn}){return n.createElement(se.u,{title:"Delete variable",isOpen:rn,onConfirm:zn,onDismiss:Fn,body:`
      Are you sure you want to delete variable "${zt}"?
    `,modalClass:ee.modal,confirmText:"Delete"})}const ee={modal:(0,p.css)({width:"max-content",maxWidth:"80vw"})};var Z=e(39070),z=e(8964),q=e(58975),ie=e(85140),de=e(14329),ue=e(41820),fe=e(20601),Se=e(24240),he=e(72401),ce=e(89458);function me({onChange:zt,type:rn}){const zn=(0,n.useMemo)(()=>(0,oe.AX)(),[]),Fn=(0,n.useMemo)(()=>zn.find(ta=>ta.value===rn)??zn[0],[zn,rn]);return n.createElement(ce.v,{name:"Select variable type",value:Fn,options:zn,onChange:zt,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalTypeSelectV2})}var pe=e(2543),ye=e(27238),Pe=e(3843);const Ie=zt=>async rn=>{const{rootStateKey:zn}=zt;rn((0,G.kb)(zn,(0,Pe.sJ)({name:(0,j.dn)(zt).name,id:zt.id})))},Oe=zt=>async(rn,zn)=>{const{rootStateKey:Fn}=zt;rn((0,G.kb)(Fn,(0,Pe.T7)((0,oe.qD)(zt))))},Ne=(zt,rn)=>(zn,Fn)=>{const{id:ta,rootStateKey:ua}=zt;let ya=null;if(rn.match(/^(?!__).*$/)||(ya="Template names cannot begin with '__', that's reserved for Grafana's global variables"),rn.match(/^\w+$/)||(ya="Only word characters are allowed in variable names"),(0,j.SS)(ua,Fn()).filter(_a=>_a.name===rn&&_a.id!==ta).length&&(ya="Variable with the same name already exists"),ya){zn((0,G.kb)(ua,(0,Pe.DW)({newName:rn,errorText:ya})));return}zn(We(zt,rn))},We=(zt,rn)=>(zn,Fn)=>{const{rootStateKey:ta}=zt,ua=(0,j.dn)(zt,Fn());if(ua.name===rn){zn((0,G.kb)(ta,(0,Pe.FN)((0,oe.qD)(zt,{newName:rn}))));return}const ya={...(0,pe.cloneDeep)(ua),name:rn,id:rn},as=ua.global,Ga=ua.index,_a=(0,oe.jX)(ya);zn((0,G.kb)(ta,(0,Y.QV)((0,oe.qD)(_a,{global:as,index:Ga,model:ya})))),zn((0,G.kb)(ta,(0,Pe.FN)((0,oe.qD)(_a,{newName:rn})))),zn((0,G.kb)(ta,(0,Y.Hr)((0,oe.qD)(zt,{reIndex:!1}))))},Ae=(zt,rn="query")=>(zn,Fn)=>{const ta=(0,oe.q4)(zt),ua=(0,j.SS)(ta,Fn()),ya=Me(rn,ua),as={type:rn,id:ya},Ga=!1,_a=(0,j.hk)(ta,Fn()),nr=(0,pe.cloneDeep)(fe.B.get(rn).initialState);nr.id=ya,nr.name=ya,nr.rootStateKey=ta,zn((0,G.kb)(ta,(0,Y.QV)((0,oe.qD)(as,{global:Ga,model:nr,index:_a})))),i.Ny.partial({editIndex:ua.length})},Ue=zt=>(rn,zn)=>{const Fn=(0,oe.q4)(zt),ta=zn(),ua=(0,j.nS)(Fn,ta),ya=ta.dashboard.getModel(),{usages:as}=(0,B.hM)(ua,ya),Ga=(0,B.Ow)(as);rn((0,G.kb)(Fn,(0,ye.bX)({usages:as,usagesNetwork:Ga})))};function Me(zt,rn){let zn=0,Fn=`${zt}${zn}`;for(;rn.find(ta=>ta.id===Fn);)Fn=`${zt}${++zn}`;return Fn}var $e=e(85830);const ke=(zt,rn)=>({editor:(0,j.nx)(rn.identifier.rootStateKey,zt).editor,variable:(0,j.dn)(rn.identifier,zt)}),Ze=zt=>({...(0,y.bindActionCreators)({variableEditorMount:Ie,variableEditorUnMount:Oe,changeVariableName:Ne,updateOptions:he.mZ},zt),changeVariableProp:(rn,zn,Fn)=>zt((0,G.kb)(rn.rootStateKey,(0,Y.QP)((0,oe.qD)(rn,{propName:zn,propValue:Fn})))),changeVariableType:(rn,zn)=>zt((0,G.kb)(rn.rootStateKey,(0,Y.l_)((0,oe.qD)(rn,{newType:zn})))),removeVariable:rn=>{zt((0,G.kb)(rn.rootStateKey,(0,Y.Hr)((0,oe.qD)(rn,{reIndex:!0}))))}}),ot=(0,c.connect)(ke,Ze);class xt extends n.PureComponent{constructor(){super(...arguments),this.state={showDeleteModal:!1},this.onNameChange=rn=>{rn.preventDefault(),this.props.changeVariableName(this.props.identifier,rn.currentTarget.value)},this.onTypeChange=rn=>{rn.value&&this.props.changeVariableType(this.props.identifier,rn.value)},this.onLabelChange=rn=>{rn.preventDefault(),this.props.changeVariableProp(this.props.identifier,"label",rn.currentTarget.value)},this.onDescriptionChange=rn=>{this.props.changeVariableProp(this.props.identifier,"description",rn.currentTarget.value)},this.onHideChange=rn=>{this.props.changeVariableProp(this.props.identifier,"hide",rn)},this.onPropChanged=({propName:rn,propValue:zn,updateOptions:Fn=!1})=>{this.props.changeVariableProp(this.props.identifier,rn,zn),Fn&&this.props.updateOptions((0,oe.jX)(this.props.variable))},this.onHandleSubmit=async rn=>{rn.preventDefault(),this.props.editor.isValid&&this.props.updateOptions((0,oe.jX)(this.props.variable))},this.onModalOpen=()=>{this.setState({showDeleteModal:!0})},this.onModalClose=()=>{this.setState({showDeleteModal:!1})},this.onDelete=()=>{this.props.removeVariable(this.props.identifier),this.onModalClose(),i.Ny.partial({editIndex:null})},this.onApply=()=>{i.Ny.partial({editIndex:null})},this.getVariableOptions=()=>{const{variable:rn}=this.props;return(0,Se.SP)(rn)?rn.options.map(zn=>({label:String(zn.text),value:String(zn.value)})):[]}}componentDidMount(){this.props.variableEditorMount(this.props.identifier)}componentWillUnmount(){this.props.variableEditorUnMount(this.props.identifier)}render(){const{variable:rn}=this.props,zn=fe.B.get(this.props.variable.type).editor;if(!zn)return null;const Fn=rn.state===Z.Gu.Loading;return n.createElement(n.Fragment,null,n.createElement("form",{"aria-label":"Variable editor Form",onSubmit:this.onHandleSubmit},n.createElement(me,{onChange:this.onTypeChange,type:this.props.variable.type}),n.createElement(q.Y,null,"General"),n.createElement(de._,{value:this.props.editor.name,onChange:this.onNameChange,name:"Name",placeholder:"Variable name",description:"The name of the template variable. (Max. 50 characters)",invalid:!!this.props.editor.errors.name,error:this.props.editor.errors.name,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalNameInputV2,maxLength:$e.M.MaxSize,required:!0}),n.createElement(de._,{name:"Label",description:"Optional display name",value:this.props.variable.label??"",placeholder:"Label name",onChange:this.onLabelChange,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalLabelInputV2}),n.createElement(ie.Z,{name:"Description",value:rn.description??"",placeholder:"Descriptive text",onChange:this.onDescriptionChange,width:52}),n.createElement(z.D,{onChange:this.onHideChange,hide:this.props.variable.hide,type:this.props.variable.type}),zn&&n.createElement(zn,{variable:this.props.variable,onPropChange:this.onPropChanged}),(0,Se.SP)(this.props.variable)?n.createElement(ue.j,{options:this.getVariableOptions()}):null,n.createElement("div",{style:{marginTop:"16px"}},n.createElement(T.Gy,{spacing:"md",height:"inherit"},n.createElement(f.$n,{variant:"destructive",fill:"outline",onClick:this.onModalOpen},"Delete"),n.createElement(f.$n,{type:"submit","data-testid":r.Tp.pages.Dashboard.Settings.Variables.Edit.General.submitButton,disabled:Fn,variant:"secondary"},"Run query",Fn&&n.createElement(x.I,{className:"spin-clockwise",name:"sync",size:"sm",style:{marginLeft:"2px"}})),n.createElement(f.$n,{variant:"primary",onClick:this.onApply,"data-testid":r.Tp.pages.Dashboard.Settings.Variables.Edit.General.applyButton},"Apply")))),n.createElement(ne,{isOpen:this.state.showDeleteModal,varName:this.props.editor.name,onConfirm:this.onDelete,onDismiss:this.onModalClose}))}}const ct=ot(xt);var ft=e(75494),Le=e(69529),re=e(72109),X=e(99140);const le=({variables:zt})=>{const rn=(0,n.useMemo)(()=>(0,B.hI)(zt),[zt]),zn=(0,n.useMemo)(()=>(0,B.qJ)(zt),[zt]);return zn.length?n.createElement(F,{show:!1,title:"Dependencies",nodes:(0,B.H7)(rn,zn),edges:zn},({showModal:Fn})=>n.createElement(f.$n,{onClick:()=>{(0,D.rR)("Show variable dependencies"),Fn()},icon:"channel-add",variant:"secondary"},"Show dependencies")):null},be=zt=>n.createElement(c.Provider,{store:X.M_},n.createElement(le,{...zt})),De=({id:zt,usages:rn,isAdhoc:zn})=>{const Fn=(0,n.useMemo)(()=>rn.find(ua=>ua.variable.id===zt),[rn,zt]);if(rn.length===0||zn||!Fn)return null;const ta=Fn.nodes.map(ua=>ua.label.includes(`$${zt}`)?{...ua,color:"#FB7E81"}:ua);return n.createElement(F,{show:!1,title:`Showing usages for: $${zt}`,nodes:ta,edges:Fn.edges},({showModal:ua})=>n.createElement(C.K,{onClick:()=>{(0,D.rR)("Show variable usages"),ua()},name:"code-branch",tooltip:"Show usages"}))};function Te({index:zt,variable:rn,usageTree:zn,usagesNetwork:Fn,onEdit:ta,onDuplicate:ua,onDelete:ya}){const as=(0,E.$j)(),Ga=(0,E.of)(Ve),_a=we(rn),ps=(0,B.PK)(rn.id,zn)>0||rn.type==="adhoc",Qs=(0,oe.jX)(rn);return n.createElement(ft.sx,{draggableId:JSON.stringify(Qs),index:zt},(Hr,_r)=>n.createElement("tr",{ref:Hr.innerRef,...Hr.draggableProps,style:{userSelect:_r.isDragging?"none":"auto",background:_r.isDragging?as.colors.background.secondary:void 0,...Hr.draggableProps.style}},n.createElement("td",{role:"gridcell",className:Ga.column},n.createElement(f.$n,{size:"xs",fill:"text",onClick:Rr=>{Rr.preventDefault(),ta(Qs)},className:Ga.nameLink,"aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowNameFields(rn.name)},rn.name)),n.createElement("td",{role:"gridcell",className:Ga.definitionColumn,onClick:Rr=>{Rr.preventDefault(),ta(Qs)},"aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(rn.name)},_a),n.createElement("td",{role:"gridcell",className:Ga.column},n.createElement("div",{className:Ga.icons},n.createElement(Ke,{passed:ps}),n.createElement(De,{id:rn.id,isAdhoc:rn.type==="adhoc",usages:Fn}),n.createElement(C.K,{onClick:Rr=>{Rr.preventDefault(),(0,D.rR)("Duplicate variable"),ua(Qs)},name:"copy",tooltip:"Duplicate variable","aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(rn.name)}),n.createElement(C.K,{onClick:Rr=>{Rr.preventDefault(),(0,D.rR)("Delete variable"),ya(Qs)},name:"trash-alt",tooltip:"Remove variable","aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(rn.name)}),n.createElement("div",{...Hr.dragHandleProps,className:Ga.dragHandle},n.createElement(x.I,{name:"draggabledots",size:"lg"}))))))}function we(zt){let rn="";return zt.type==="query"?zt.definition?rn=zt.definition:typeof zt.query=="string"&&(rn=zt.query):(0,Se.SP)(zt)&&(rn=zt.query),rn}function Ke({passed:zt}){const rn=(0,E.of)(Ve);return zt?n.createElement(x.I,{name:"check",className:rn.iconPassed,title:"This variable is referenced by other variables or dashboard."}):n.createElement(x.I,{name:"exclamation-triangle",className:rn.iconFailed,title:"This variable is not referenced by any variable or dashboard."})}function Ve(zt){return{dragHandle:(0,p.css)`
      cursor: grab;
      margin-left: ${zt.spacing(1)};
    `,column:(0,p.css)`
      width: 1%;
    `,nameLink:(0,p.css)`
      cursor: pointer;
      color: ${zt.colors.primary.text};
    `,definitionColumn:(0,p.css)`
      width: 100%;
      max-width: 200px;
      cursor: pointer;
      overflow: hidden;
      text-overflow: ellipsis;
      -o-text-overflow: ellipsis;
      white-space: nowrap;
    `,iconPassed:(0,p.css)`
      color: ${zt.v1.palette.greenBase};
      margin-right: ${zt.spacing(2)};
    `,iconFailed:(0,p.css)`
      color: ${zt.v1.palette.orange};
      margin-right: ${zt.spacing(2)};
    `,icons:(0,p.css)`
      display: flex;
      gap: ${zt.spacing(2)};
      align-items: center;
    `}}function ht({variables:zt,usages:rn,usagesNetwork:zn,onChangeOrder:Fn,onAdd:ta,onEdit:ua,onDelete:ya,onDuplicate:as}){const Ga=(0,E.of)(bt),_a=nr=>{if(!nr.destination||!nr.source)return;(0,D.rR)("Variable drag and drop");const ps=JSON.parse(nr.draggableId);Fn(ps,zt[nr.source.index].index,zt[nr.destination.index].index)};return n.createElement("div",null,n.createElement("div",null,zt.length===0&&n.createElement(gt,{onAdd:ta}),zt.length>0&&n.createElement(l.B,{direction:"column",gap:4},n.createElement("div",{className:Ga.tableContainer},n.createElement("table",{className:"filter-table filter-table--hover","aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.table,role:"grid"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"Variable"),n.createElement("th",null,"Definition"),n.createElement("th",{colSpan:5}))),n.createElement(ft.JY,{onDragEnd:_a},n.createElement(ft.gL,{droppableId:"variables-list",direction:"vertical"},nr=>n.createElement("tbody",{ref:nr.innerRef,...nr.droppableProps},zt.map((ps,Qs)=>n.createElement(Te,{index:Qs,key:`${ps.name}-${Qs}`,variable:ps,usageTree:rn,usagesNetwork:zn,onDelete:ya,onDuplicate:as,onEdit:ua})),nr.placeholder))))),n.createElement(l.B,null,n.createElement(be,{variables:zt}),n.createElement(f.$n,{"aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.newButton,onClick:ta,icon:"plus"},"New variable")))))}function gt({onAdd:zt}){return n.createElement(l.B,{direction:"column"},n.createElement(Le.p,{variant:"call-to-action",button:n.createElement(f.$n,{"data-testid":r.Tp.components.CallToActionCard.buttonV2("Add variable"),icon:"calculator-alt",onClick:zt,size:"lg"},n.createElement(u.x6,{i18nKey:"variables.empty-state.button-title"},"Add variable")),message:(0,u.t)("variables.empty-state.title","There are no variables added yet")},n.createElement("p",null,n.createElement(u.x6,{i18nKey:"variables.empty-state.info-box-content"},"Variables enable more interactive and dynamic dashboards. Instead of hard-coding things like server or sensor names in your metric queries you can use variables in their place. Variables are shown as list boxes at the top of the dashboard. These drop-down lists make it easy to change the data being displayed in your dashboard.")),n.createElement(u.x6,{i18nKey:"variables.empty-state.info-box-content-2"},"Check out the"," ",n.createElement(re.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/variables/"},"Templates and variables documentation")," ","for more information.")))}const bt=()=>({tableContainer:(0,p.css)`
    overflow: scroll;
    width: 100%;
  `}),St=(zt,rn)=>{const{uid:zn}=rn.dashboard,Fn=(0,j.nx)(zn,zt);return{variables:(0,j.nS)(zn,zt),idInEditor:Fn.editor.id,usagesNetwork:Fn.inspect.usagesNetwork,usages:Fn.inspect.usages}},Je=zt=>({...(0,y.bindActionCreators)({createNewVariable:Ae,initListMode:Ue},zt),changeVariableOrder:(rn,zn,Fn)=>zt((0,G.kb)(rn.rootStateKey,(0,Y.hj)((0,oe.qD)(rn,{fromIndex:zn,toIndex:Fn})))),duplicateVariable:rn=>zt((0,G.kb)(rn.rootStateKey,(0,Y.ut)((0,oe.qD)(rn,{newId:void 0})))),removeVariable:rn=>{zt((0,G.kb)(rn.rootStateKey,(0,Y.Hr)((0,oe.qD)(rn,{reIndex:!0}))))}}),rt=(0,c.connect)(St,Je);class Rt extends n.PureComponent{constructor(){super(...arguments),this.state={variableId:void 0},this.onEditVariable=rn=>{const zn=this.props.variables.findIndex(Fn=>Fn.id===rn.id);i.Ny.partial({editIndex:zn})},this.onNewVariable=()=>{this.props.createNewVariable(this.props.dashboard.uid)},this.onChangeVariableOrder=(rn,zn,Fn)=>{this.props.changeVariableOrder(rn,zn,Fn)},this.onDuplicateVariable=rn=>{this.props.duplicateVariable(rn)},this.onModalOpen=rn=>{this.setState({variableId:rn})},this.onModalClose=()=>{this.setState({variableId:void 0})},this.onRemoveVariable=()=>{this.props.removeVariable(this.state.variableId),this.onModalClose()}}componentDidMount(){this.props.initListMode(this.props.dashboard.uid)}render(){const{editIndex:rn,variables:zn,sectionNav:Fn}=this.props,ta=rn!=null?zn[rn]:void 0,ua=Fn.node,ya=ua.parentItem?{...ua.parentItem,url:ua.url}:void 0,as=ta?{text:ta.name,parentItem:ya}:ya;return n.createElement(h.Y,{navModel:this.props.sectionNav,pageNav:as},!ta&&n.createElement(ht,{variables:this.props.variables,onAdd:this.onNewVariable,onEdit:this.onEditVariable,onChangeOrder:this.onChangeVariableOrder,onDuplicate:this.onDuplicateVariable,onDelete:this.onModalOpen,usages:this.props.usages,usagesNetwork:this.props.usagesNetwork}),!ta&&this.props.variables.length>0&&n.createElement(U,{variables:this.props.variables,dashboard:this.props.dashboard}),ta&&n.createElement(ct,{identifier:(0,oe.jX)(ta)}),n.createElement(ne,{isOpen:this.state.variableId!==void 0,varName:this.state.variableId?.id??"",onConfirm:this.onRemoveVariable,onDismiss:this.onModalClose}))}}const _t=rt(Rt);var nn=e(52487),Kt=e(10096);const en=({dashboard:zt,sectionNav:rn})=>{const zn=Kt.contextSrv.hasPermission(g.AccessControlAction.DashboardsPermissionsWrite),Fn=rn.node.parentItem;return n.createElement(h.Y,{navModel:rn,pageNav:Fn},n.createElement(nn.x,{resource:"dashboards",resourceId:zt.uid,canSetPermissions:zn}))};var Qt=e(78050),An=e(22391),un=e(19347),fn=e(84167),Tt=e(88575),$t=e(10354),Yt=e(10880),Cn=e(21594),Tn=e(77268),vn=e(2913),Kn=e(82241),Yn=e(46502),nt=e(51612);const yt="New annotation",Vt=({editIdx:zt,dashboard:rn})=>{const zn=(0,E.of)(je),[Fn,ta]=(0,n.useState)(rn.annotations.list[zt]),ua=(0,n.useMemo)(()=>Fn.filter?Fn.filter.exclude?2:1:0,[Fn.filter]),{value:ya}=(0,v.A)(()=>(0,un.l)().get(Fn.datasource),[Fn.datasource]),as=(0,un.l)().getInstanceSettings(Fn.datasource),Ga=cn=>{const On=[...rn.annotations.list];On.splice(zt,1,cn),ta(cn),rn.annotations.list=On},_a=cn=>{Ga({...Fn,name:cn.currentTarget.value})},nr=cn=>{const On=(0,An.p$)(cn);Fn.datasource?.type!==On.type?Ga({datasource:On,builtIn:Fn.builtIn,enable:Fn.enable,iconColor:Fn.iconColor,name:Fn.name,hide:Fn.hide,filter:Fn.filter,mappings:Fn.mappings,type:Fn.type}):Ga({...Fn,datasource:On})},ps=cn=>{const On=cn.currentTarget;Ga({...Fn,[On.name]:On.type==="checkbox"?On.checked:On.value})},Qs=cn=>{Ga({...Fn,iconColor:cn})},Hr=cn=>{let On=cn.value===0?void 0:{exclude:cn.value===2,ids:Fn.filter?.ids??[]};Ga({...Fn,filter:On})},_r=cn=>{if(!Array.isArray(cn))return;const On={exclude:ua===2,ids:[]};cn.forEach(ha=>ha.value&&On.ids.push(ha.value)),Ga({...Fn,filter:On})},Rr=tt,Eo=()=>{i.Ny.partial({editview:null,editIndex:null})},co=()=>{const cn=rn.annotations.list;rn.annotations.list=[...cn.slice(0,zt),...cn.slice(zt+1)],tt()},Ur=Fn.name===yt,At=(cn,On)=>cn.label&&On.label?cn.label.toLowerCase().localeCompare(On.label.toLowerCase()):-1,an=(0,n.useMemo)(()=>rn?.panels.filter(cn=>vn.Ay.panels[cn.type]).map(cn=>({value:cn.id,label:cn.title??`Panel ${cn.id}`,description:cn.description,imgUrl:vn.Ay.panels[cn.type].info.logos.small})).sort(At)??[],[rn]);return n.createElement("div",null,n.createElement(fn.n,{className:zn.settingsForm},n.createElement(Tt.D,{label:"Name"},n.createElement($t.p,{"data-testid":r.Tp.pages.Dashboard.Settings.Annotations.Settings.name,name:"name",id:"name",autoFocus:Ur,value:Fn.name,onChange:_a})),n.createElement(Tt.D,{label:"Data source",htmlFor:"data-source-picker"},n.createElement(nt.s,{annotations:!0,variables:!0,current:Fn.datasource,onChange:nr})),n.createElement(Tt.D,{label:"Enabled",description:"When enabled the annotation query is issued every dashboard refresh"},n.createElement(Yt.S,{name:"enable",id:"enable",value:Fn.enable,onChange:ps})),n.createElement(Tt.D,{label:"Hidden",description:"Annotation queries can be toggled on or off at the top of the dashboard. With this option checked this toggle will be hidden."},n.createElement(Yt.S,{name:"hide",id:"hide",value:Fn.hide,onChange:ps})),n.createElement(Tt.D,{label:"Color",description:"Color to use for the annotation event markers"},n.createElement(T.Gy,null,n.createElement(Tn.a,{value:Fn?.iconColor,onChange:Qs}))),n.createElement(Tt.D,{label:"Show in","data-testid":r.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.showInLabel},n.createElement(n.Fragment,null,n.createElement(Cn.l6,{options:Ot,value:ua,onChange:Hr,"data-testid":r.Tp.components.Annotations.annotationsTypeInput}),ua!==0&&n.createElement(Cn.KF,{options:an,value:an.filter(cn=>Fn.filter?.ids.includes(cn.value)),onChange:_r,isClearable:!0,placeholder:"Choose panels",width:100,closeMenuOnSelect:!1,className:zn.select,"data-testid":r.Tp.components.Annotations.annotationsChoosePanelInput})))),n.createElement(fn.n,null,n.createElement("h3",{className:"page-heading"},"Query"),ya?.annotations&&as&&n.createElement(Kn.A,{datasource:ya,datasourceInstanceSettings:as,annotation:Fn,onChange:Ga}),ya&&!ya.annotations&&n.createElement(Yn.F,{datasource:ya,annotation:Fn,onChange:Ga})),n.createElement(l.B,null,!Fn.builtIn&&n.createElement(f.$n,{variant:"destructive",onClick:co},"Delete"),n.createElement(f.$n,{variant:"secondary",onClick:Eo,"data-testid":r.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.previewInDashboard},"Preview in dashboard"),n.createElement(f.$n,{variant:"primary",onClick:Rr},"Apply")))},je=zt=>({settingsForm:(0,p.css)({maxWidth:zt.spacing(60),marginBottom:zt.spacing(2)}),select:(0,p.css)({marginTop:"8px"})});function tt(){i.Ny.partial({editIndex:null})}var Dt=(zt=>(zt[zt.AllPanels=0]="AllPanels",zt[zt.IncludePanels=1]="IncludePanels",zt[zt.ExcludePanels=2]="ExcludePanels",zt))(Dt||{});const Ot=[{label:"All panels",value:0,description:"Send the annotation data to all panels that support annotations"},{label:"Selected panels",value:1,description:"Send the annotations to the explicitly listed panels"},{label:"All panels except",value:2,description:"Do not send annotation data to the following panels"}];var Lt=e(14588),Gt=e(91605),hn=e(46991);const mt=({dashboard:zt,onNew:rn,onEdit:zn})=>{const Fn=(0,E.of)(Bt),[ta,ua]=(0,n.useState)(zt.annotations.list),ya=(ps,Qs)=>{zt.annotations.list=Lt.moveItemImmutably(ta,ps,ps+Qs),ua(zt.annotations.list)},as=ps=>{zt.annotations.list=[...ta.slice(0,ps),...ta.slice(ps+1)],ua(zt.annotations.list)},Ga=ta.length===0||ta.length===1&&ta[0].builtIn,_a=ps=>ps.enable===!1?n.createElement(n.Fragment,null,n.createElement("em",{className:"muted"},"(Disabled) \xA0 ",ps.name)):ps.builtIn?n.createElement(n.Fragment,null,n.createElement("em",{className:"muted"},ps.name," \xA0 (Built-in)")):n.createElement(n.Fragment,null,ps.name),nr=(0,un.l)();return n.createElement(l.B,{direction:"column"},ta.length>0&&n.createElement("div",{className:Fn.table},n.createElement("table",{role:"grid",className:"filter-table filter-table--hover"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"Query name"),n.createElement("th",null,"Data source"),n.createElement("th",{colSpan:3}))),n.createElement("tbody",null,zt.annotations.list.map((ps,Qs)=>n.createElement("tr",{key:`${ps.name}-${Qs}`},ps.builtIn?n.createElement("td",{role:"gridcell",style:{width:"90%"},className:"pointer",onClick:()=>zn(Qs)},n.createElement(f.$n,{size:"sm",fill:"text",variant:"secondary"},_a(ps))):n.createElement("td",{role:"gridcell",className:"pointer",onClick:()=>zn(Qs)},n.createElement(f.$n,{size:"sm",fill:"text",variant:"secondary"},_a(ps))),n.createElement("td",{role:"gridcell",className:"pointer",onClick:()=>zn(Qs)},nr.getInstanceSettings(ps.datasource)?.name||ps.datasource?.uid),n.createElement("td",{role:"gridcell",style:{width:"1%"}},Qs!==0&&n.createElement(C.K,{name:"arrow-up",onClick:()=>ya(Qs,-1),tooltip:"Move up"})),n.createElement("td",{role:"gridcell",style:{width:"1%"}},zt.annotations.list.length>1&&Qs!==zt.annotations.list.length-1?n.createElement(C.K,{name:"arrow-down",onClick:()=>ya(Qs,1),tooltip:"Move down"}):null),n.createElement("td",{role:"gridcell",style:{width:"1%"}},!ps.builtIn&&n.createElement(Gt.e,{size:"sm",onConfirm:()=>as(Qs),"aria-label":`Delete query with title "${ps.name}"`}))))))),Ga&&n.createElement(l.B,{direction:"column"},n.createElement(Le.p,{variant:"call-to-action",button:n.createElement(f.$n,{"data-testid":r.Tp.components.CallToActionCard.buttonV2("Add annotation query"),icon:"comment-alt",onClick:rn,size:"lg"},n.createElement(u.x6,{i18nKey:"annotations.empty-state.button-title"},"Add annotation query")),message:(0,u.t)("annotations.empty-state.title","There are no custom annotation queries added yet")},n.createElement(u.x6,{i18nKey:"annotations.empty-state.info-box-content"},n.createElement("p",null,"Annotations provide a way to integrate event data into your graphs. They are visualized as vertical lines and icons on all graph panels. When you hover over an annotation icon you can get event text & tags for the event. You can add annotation events directly from grafana by holding CTRL or CMD + click on graph (or drag region). These will be stored in Grafana's annotation database.")),n.createElement(u.x6,{i18nKey:"annotations.empty-state.info-box-content-2"},"Checkout the"," ",n.createElement(re.Y,{external:!0,href:"http://docs.grafana.org/reference/annotations/"},"Annotations documentation")," ","for more information."))),!Ga&&n.createElement(hn.d,{"data-testid":r.Tp.pages.Dashboard.Settings.Annotations.List.addAnnotationCTAV2,onClick:rn},"New query"))},Bt=()=>({table:(0,p.css)({width:"100%",overflowX:"scroll"})});function Jt({dashboard:zt,editIndex:rn,sectionNav:zn}){const Fn=()=>{const ya={name:yt,enable:!0,datasource:(0,An.p$)((0,un.l)().getInstanceSettings(null)),iconColor:"red"};zt.annotations.list=[...zt.annotations.list,{...ya}],i.Ny.partial({editIndex:zt.annotations.list.length-1})},ta=ya=>{i.Ny.partial({editIndex:ya})},ua=rn!=null&&rn<zt.annotations.list.length;return n.createElement(h.Y,{navModel:zn,pageNav:Rn(zt,rn,zn.node)},!ua&&n.createElement(mt,{dashboard:zt,onNew:Fn,onEdit:ta}),ua&&n.createElement(Vt,{dashboard:zt,editIdx:rn}))}function Rn(zt,rn,zn){const Fn=zn.parentItem;if(rn==null)return Fn;const ta=zt.annotations.list[rn];if(ta)return{text:ta.name,parentItem:Fn&&{...Fn,url:zn.url}}}var Mt=e(32264),wt=e(90613),Ht=e(60029),tn=e(21744),It=e(79924),Xe=e(94354),jn=e(36607),Qn=e(3673),ia=e(71678),wn=e(14792),sa=e(5805),La=e(11230);const xa={cleanUpDashboardAndVariables:Qn.Bz},ga=(0,c.connect)(null,xa),Ts=({hideModal:zt,cleanUpDashboardAndVariables:rn,dashboard:zn})=>{const Fn=zn.meta.provisioned,[,ta]=(0,sa.default)(async()=>{await(0,La.A_)(zn.uid,!0),rn(),zt(),i.Ny.replace("/")},[zt]);return Fn?n.createElement(Us,{hideModal:zt,provisionedId:zn.meta.provisionedExternalId}):n.createElement(se.u,{isOpen:!0,body:n.createElement(n.Fragment,null,n.createElement("p",null,"Do you want to delete this dashboard?"),n.createElement("p",null,zn.title)),onConfirm:ta,onDismiss:zt,title:"Delete",icon:"trash-alt",confirmText:"Delete"})},Us=({hideModal:zt,provisionedId:rn})=>n.createElement(O.a,{isOpen:!0,title:"Cannot delete provisioned dashboard",icon:"trash-alt",onDismiss:zt,className:(0,p.css)({width:"500px"})},n.createElement("p",null,"This dashboard is managed by Grafana provisioning and cannot be deleted. Remove the dashboard from the config file to delete it."),n.createElement("p",null,n.createElement("i",null,"See"," ",n.createElement("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer"},"documentation")," ","for more information about provisioning."),n.createElement("br",null),"File path: ",rn),n.createElement(O.a.ButtonRow,null,n.createElement(f.$n,{variant:"primary",onClick:zt},"OK"))),Bs=ga(Ts),ks=()=>{const zt=(0,wn.UA)().getCurrent();return n.createElement(ia.$s,null,({showModal:rn,hideModal:zn})=>n.createElement(f.$n,{variant:"destructive",onClick:()=>{rn(Bs,{dashboard:zt,hideModal:zn})},"data-testid":r.Tp.pages.Dashboard.Settings.General.deleteDashBoard},n.createElement(u.x6,{i18nKey:"dashboard-settings.dashboard-delete-button"},"Delete dashboard")))};var Ms=e(81394),Dr=e(27966),_s=e(75590);const Ir=[{value:0,label:"Default"},{value:1,label:"Shared crosshair"},{value:2,label:"Shared Tooltip"}];function Xs({dashboard:zt,updateTimeZone:rn,updateWeekStart:zn,sectionNav:Fn}){const[ta,ua]=(0,n.useState)(0),[ya,as]=(0,n.useState)(zt.title),[Ga,_a]=(0,n.useState)(zt.description),nr=Fn.node.parentItem,ps=(la,Ns)=>{zt.meta.folderUid=la,zt.meta.folderTitle=Ns,zt.meta.hasUnsavedFolderChange=!0,ua(ta+1)},Qs=n.useCallback(la=>{zt.title=la,as(la)},[as,zt]),Hr=n.useCallback(la=>{zt.description=la,_a(la)},[_a,zt]),_r=la=>{zt.graphTooltip=la,ua(ta+1)},Rr=la=>{zt.timepicker.refresh_intervals=la.filter(Ns=>Ns.trim()!=="")},Eo=la=>{zt.timepicker.nowDelay=la},co=la=>{zt.timepicker.hidden=la,ua(ta+1)},Ur=la=>{zt.liveNow=la,ua(ta+1)},At=la=>{zt.timezone=la,ua(ta+1),rn(la)},an=la=>{zt.weekStart=la,ua(ta+1),zn(la)},cn=la=>{zt.tags=la,ua(ta+1)},On=la=>{zt.editable=la,ua(ta+1)},ha=[{label:"Editable",value:!0},{label:"Read-only",value:!1}];return n.createElement(h.Y,{navModel:Fn,pageNav:nr},n.createElement("div",{style:{maxWidth:"600px"}},n.createElement(wt.a,{marginBottom:5},n.createElement(Tt.D,{label:n.createElement(l.B,{justifyContent:"space-between"},n.createElement(Ht.J,{htmlFor:"title-input"},n.createElement(u.x6,{i18nKey:"dashboard-settings.general.title-label"},"Title")),Mt.$.featureToggles.dashgpt&&n.createElement(Dr.Z,{onGenerate:Qs}))},n.createElement($t.p,{id:"title-input",name:"title",value:ya,onChange:la=>Qs(la.target.value)})),n.createElement(Tt.D,{label:n.createElement(l.B,{justifyContent:"space-between"},n.createElement(Ht.J,{htmlFor:"description-input"},(0,u.t)("dashboard-settings.general.description-label","Description")),Mt.$.featureToggles.dashgpt&&n.createElement(Ms.V,{onGenerate:Hr}))},n.createElement(tn.f,{id:"description-input",name:"description",value:Ga,onChange:la=>Hr(la.target.value)})),n.createElement(Tt.D,{label:(0,u.t)("dashboard-settings.general.tags-label","Tags")},n.createElement(It.u,{id:"tags-input",tags:zt.tags,onChange:cn,width:40})),n.createElement(Tt.D,{label:(0,u.t)("dashboard-settings.general.folder-label","Folder")},n.createElement(jn.d,{value:zt.meta.folderUid,onChange:ps,initialTitle:zt.meta.folderTitle,inputId:"dashboard-folder-input",enableCreateNew:!0,dashboardId:zt.id,skipInitialLoad:!0})),n.createElement(Tt.D,{label:(0,u.t)("dashboard-settings.general.editable-label","Editable"),description:(0,u.t)("dashboard-settings.general.editable-description","Set to read-only to disable all editing. Reload the dashboard for changes to take effect")},n.createElement(Xe.z,{value:zt.editable,options:ha,onChange:On}))),n.createElement(_s.p,{onTimeZoneChange:At,onWeekStartChange:an,onRefreshIntervalChange:Rr,onNowDelayChange:Eo,onHideTimePickerChange:co,onLiveNowChange:Ur,refreshIntervals:zt.timepicker.refresh_intervals,timePickerHidden:zt.timepicker.hidden,nowDelay:zt.timepicker.nowDelay,timezone:zt.timezone,weekStart:zt.weekStart,liveNow:zt.liveNow}),n.createElement(S.M,{label:(0,u.t)("dashboard-settings.general.panel-options-label","Panel options"),isOpen:!0},n.createElement(Tt.D,{label:(0,u.t)("dashboard-settings.general.panel-options-graph-tooltip-label","Graph tooltip"),description:(0,u.t)("dashboard-settings.general.panel-options-graph-tooltip-description","Controls tooltip and hover highlight behavior across different panels. Reload the dashboard for changes to take effect")},n.createElement(Xe.z,{onChange:_r,options:Ir,value:zt.graphTooltip}))),n.createElement(wt.a,{marginTop:3},zt.meta.canDelete&&n.createElement(ks,null))))}const Gs={updateTimeZone:Qn.lC,updateWeekStart:Qn.Ss},Mr=(0,c.connect)(null,Gs)(Xs);var vr=e(32372),fr=e(6473);function js({dashboard:zt,sectionNav:rn}){const zn=zt.getSaveModelClone(),[Fn,ta]=(0,n.useState)(JSON.stringify(zn,null,2)),ua=rn.node.parentItem,ya=async()=>{await(0,wn.UA)().saveJSONDashboard(Fn),fr.t.reloadPage()},as=(0,E.of)(to);return n.createElement(h.Y,{navModel:rn,pageNav:ua},n.createElement("div",{className:as.wrapper},n.createElement(u.x6,{i18nKey:"dashboard-settings.json-editor.subtitle"},"The JSON model below is the data structure that defines the dashboard. This includes dashboard settings, panel settings, layout, queries, and so on."),n.createElement(vr.B,{value:Fn,language:"json",showMiniMap:!0,showLineNumbers:!0,onBlur:ta,containerStyles:as.codeEditor}),zt.meta.canSave&&n.createElement("div",null,n.createElement(f.$n,{type:"submit",onClick:ya},n.createElement(u.x6,{i18nKey:"dashboard-settings.json-editor.save-button"},"Save changes")))))}const to=zt=>({wrapper:(0,p.css)({display:"flex",height:"100%",flexDirection:"column",gap:zt.spacing(2)}),codeEditor:(0,p.css)({flexGrow:1})});var Ar=e(4588),Ko=e(65857);const no=({editLinkIdx:zt,dashboard:rn,onGoBack:zn})=>{const[Fn,ta]=(0,n.useState)(zt!==null?rn.links[zt]:Ar.q),ua=ya=>{const as=[...rn.links];as.splice(zt,1,ya),rn.links=as,ta(ya)};return n.createElement(Ko.d,{link:Fn,onUpdate:ua,onGoBack:zn})};var vo=e(6199);const ao=({dashboard:zt,onNew:rn,onEdit:zn})=>{const[Fn,ta]=(0,n.useState)(zt.links),ua=(Ga,_a)=>{zt.links=Lt.moveItemImmutably(Fn,Ga,Ga+_a),ta(zt.links)},ya=Ga=>{zt.links=[...Fn,{...Ga}],ta(zt.links)},as=Ga=>{zt.links=[...Fn.slice(0,Ga),...Fn.slice(Ga+1)],ta(zt.links)};return n.createElement(vo.X,{links:Fn,onNew:rn,onEdit:zn,onDuplicate:ya,onDelete:as,onOrderChange:ua})};function Do({dashboard:zt,sectionNav:rn,editIndex:zn}){const[Fn,ta]=(0,n.useState)(!1),ua=()=>{ta(!1),i.Ny.partial({editIndex:void 0})},ya=()=>{zt.links=[...zt.links,{...Ar.q}],ta(!0),i.Ny.partial({editIndex:zt.links.length-1})},as=nr=>{ta(!1),i.Ny.partial({editIndex:nr})},Ga=zn!==void 0;let _a=rn.node.parentItem;if(Ga){_a={text:Fn?"New link":"Edit link",subTitle:Fn?"Create a new link on your dashboard":"Edit a specific link of your dashboard"};const Qs=rn.node.url;_a.parentItem=rn.node.parentItem&&{...rn.node.parentItem,url:Qs}}return n.createElement(h.Y,{navModel:rn,pageNav:_a},!Ga&&n.createElement(ao,{dashboard:zt,onNew:ya,onEdit:as}),Ga&&n.createElement(no,{dashboard:zt,editLinkIdx:zn,onGoBack:ua}))}var Xr=e(57714),mo=e(19626),qr=e(22764),Po=e(56596),jr=e(41053),Io=e(3169);const $o=async(zt,rn)=>(fr.t.ignoreNextSave(),await Xr.wL.restoreDashboard(rn.uid,zt)),qo=zt=>{const rn=(0,g.useSelector)(ua=>ua.dashboard.getModel()),[zn,Fn]=(0,jr.A)(async()=>await $o(zt,rn),[]),ta=(0,Io._2)();return(0,n.useEffect)(()=>{if(zn.value){const ua=i.Ny.getLocation(),ya=o.I.stripBaseFromUrl(zn.value.url),as=ua.state?.routeReloadCounter;i.Ny.replace({...ua,pathname:ya,state:{routeReloadCounter:as?as+1:1}}),ta.success("Dashboard restored",`Restored from version ${zt}`)}},[zn,zt,ta]),{state:zn,onRestoreDashboard:Fn}},lo=({hideModal:zt,version:rn})=>{const{state:zn,onRestoreDashboard:Fn}=qo(rn);return(0,n.useEffect)(()=>{!zn.loading&&zn.value&&zt()},[zn,zt]),n.createElement(se.u,{isOpen:!0,title:"Restore Version",icon:"history",onDismiss:zt,onConfirm:Fn,body:n.createElement("p",null,"Are you sure you want to restore the dashboard to version ",rn,"? All unsaved changes will be lost."),confirmText:`Yes, restore to version ${rn}`})},Vo=({baseInfo:zt,newInfo:rn,diffData:zn,isNewLatest:Fn})=>{const ta=(0,Po.G4)(zn.lhs,zn.rhs),ua=(0,E.of)(Co);return n.createElement(l.B,{direction:"column",gap:1},n.createElement(l.B,{justifyContent:"space-between",alignItems:"center"},n.createElement(l.B,{alignItems:"center"},n.createElement("span",{className:(0,p.cx)(ua.versionInfo,ua.noMarginBottom)},n.createElement("strong",null,"Version ",zt.version)," updated by ",zt.createdBy," ",zt.ageString,zt.message),n.createElement(x.I,{name:"arrow-right",size:"sm"}),n.createElement("span",{className:ua.versionInfo},n.createElement("strong",null,"Version ",rn.version)," updated by ",rn.createdBy," ",rn.ageString,rn.message)),Fn&&n.createElement(ia.$s,null,({showModal:ya,hideModal:as})=>n.createElement(f.$n,{variant:"destructive",icon:"history",onClick:()=>{ya(lo,{version:zt.version,hideModal:as})}},"Restore to version ",zt.version))),Object.entries(ta).map(([ya,as])=>n.createElement(mo.D,{diffs:as,key:ya,title:ya})),n.createElement(wt.a,{paddingTop:2},n.createElement(S.M,{isOpen:!1,label:"View JSON Diff"},n.createElement(qr.M,{oldValue:JSON.stringify(zn.lhs,null,2),newValue:JSON.stringify(zn.rhs,null,2)}))))},Co=zt=>({versionInfo:(0,p.css)({color:zt.colors.text.secondary,fontSize:zt.typography.bodySmall.fontSize}),noMarginBottom:(0,p.css)({marginBottom:0})});var zo=e(78369);const So=({versions:zt,canCompare:rn,onCheck:zn})=>{const Fn=(0,E.of)(si);return n.createElement("div",{className:Fn.margin},n.createElement("table",{className:"filter-table"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",{className:"width-4"}),n.createElement("th",{className:"width-4"},"Version"),n.createElement("th",{className:"width-14"},"Date"),n.createElement("th",{className:"width-10"},"Updated by"),n.createElement("th",null,"Notes"),n.createElement("th",null))),n.createElement("tbody",null,zt.map((ta,ua)=>n.createElement("tr",{key:ta.id},n.createElement("td",null,n.createElement(Yt.S,{"aria-label":`Toggle selection of version ${ta.version}`,className:(0,p.css)({display:"inline"}),checked:ta.checked,onChange:ya=>zn(ya,ta.id),disabled:!ta.checked&&rn})),n.createElement("td",null,ta.version),n.createElement("td",null,ta.createdDateString),n.createElement("td",null,ta.createdBy),n.createElement("td",null,ta.message),n.createElement("td",{className:"text-right"},ua===0?n.createElement(zo.v,{name:"Latest",colorIndex:17}):n.createElement(ia.$s,null,({showModal:ya,hideModal:as})=>n.createElement(f.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{ya(lo,{version:ta.version,hideModal:as})}},"Restore"))))))))};function si(zt){return{margin:(0,p.css)({marginBottom:zt.spacing(4)})}}const Yo=10;class ri extends n.PureComponent{constructor(rn){super(rn),this.getVersions=(zn=!1)=>{this.setState({isAppending:zn}),Xr.wL.getHistoryList(this.props.dashboard.uid,{limit:this.limit,start:this.start}).then(Fn=>{this.setState({isLoading:!1,versions:[...this.state.versions,...this.decorateVersions(Fn)]}),this.start+=this.limit}).catch(Fn=>console.log(Fn)).finally(()=>this.setState({isAppending:!1}))},this.getDiff=async()=>{const zn=this.state.versions.filter(Ga=>Ga.checked),[Fn,ta]=zn,ua=Fn.version===this.props.dashboard.version;this.setState({isLoading:!0});const ya=await Xr.wL.getDashboardVersion(this.props.dashboard.uid,ta.version),as=await Xr.wL.getDashboardVersion(this.props.dashboard.uid,Fn.version);this.setState({baseInfo:ta,isLoading:!1,isNewLatest:ua,newInfo:Fn,viewMode:"compare",diffData:{lhs:ya.data,rhs:as.data}})},this.decorateVersions=zn=>zn.map(Fn=>({...Fn,createdDateString:this.props.dashboard.formatDate(Fn.created),ageString:this.props.dashboard.getRelativeTime(Fn.created),checked:!1})),this.onCheck=(zn,Fn)=>{this.setState({versions:this.state.versions.map(ta=>ta.id===Fn?{...ta,checked:zn.currentTarget.checked}:ta)})},this.reset=()=>{this.setState({baseInfo:void 0,diffData:{lhs:"",rhs:""},isNewLatest:!1,newInfo:void 0,versions:this.state.versions.map(zn=>({...zn,checked:!1})),viewMode:"list"})},this.limit=Yo,this.start=0,this.state={isAppending:!0,isLoading:!0,versions:[],viewMode:"list",isNewLatest:!1,diffData:{lhs:"",rhs:""}}}componentDidMount(){this.getVersions()}isLastPage(){return this.state.versions.find(rn=>rn.version===1)}render(){const{versions:rn,viewMode:zn,baseInfo:Fn,newInfo:ta,isNewLatest:ua,isLoading:ya,diffData:as}=this.state,Ga=rn.filter(Qs=>Qs.checked).length===2,_a=rn.length>1,nr=rn.length>=this.limit,ps=this.props.sectionNav.node.parentItem;return zn==="compare"?n.createElement(h.Y,{navModel:this.props.sectionNav,pageNav:ps},n.createElement(Xr.me,{onClick:this.reset,baseVersion:Fn?.version,newVersion:ta?.version,isNewLatest:ua}),ya?n.createElement(Ao,{msg:"Fetching changes\u2026"}):n.createElement(Vo,{newInfo:ta,baseInfo:Fn,isNewLatest:ua,diffData:as})):n.createElement(h.Y,{navModel:this.props.sectionNav,pageNav:ps},ya?n.createElement(Ao,{msg:"Fetching history list\u2026"}):n.createElement(So,{versions:rn,onCheck:this.onCheck,canCompare:Ga}),this.state.isAppending&&n.createElement(Ao,{msg:"Fetching more entries\u2026"}),_a&&n.createElement(Xr.rJ,{hasMore:nr,canCompare:Ga,getVersions:this.getVersions,getDiff:this.getDiff,isLastPage:!!this.isLastPage()}))}}const Ao=({msg:zt})=>n.createElement(T.Gy,null,n.createElement(M.y,null),n.createElement("em",null,zt)),so=()=>i.Ny.partial({editview:null,editIndex:null});function ko({dashboard:zt,editview:rn,pageNav:zn,sectionNav:Fn}){const[ta,ua]=(0,n.useState)(0);(0,n.useEffect)(()=>{zt.events.subscribe(P.Cf,()=>ua(Eo=>Eo+1))},[zt]);const ya=(0,n.useMemo)(()=>eo(zt),[zt,ta]),as=()=>{zt.meta.hasUnsavedFolderChange=!1},Ga=ya.find(Eo=>Eo.id===rn)??ya[0],_a=b.TP.hasEditPermissionInFolders,nr=zt.meta.canSave,ps=(0,a.zy)(),Qs=oo(ps),Hr=To(zn,Fn,ya,Ga,ps,zt.uid),_r="sm",Rr=[n.createElement(f.$n,{"data-testid":r.Tp.pages.Dashboard.Settings.Actions.close,variant:"secondary",key:"close",fill:"outline",size:_r,onClick:so},"Close"),_a&&n.createElement(Qt.m,{dashboard:zt,onSaveSuccess:as,variant:"secondary",key:"save as",size:_r}),nr&&n.createElement(Qt.C,{dashboard:zt,onSaveSuccess:as,key:"Save",size:_r})];return n.createElement(n.Fragment,null,n.createElement(s.H,{actions:n.createElement(d.U,{alignment:"right"},Rr)}),n.createElement(Ga.component,{sectionNav:Hr,dashboard:zt,editIndex:Qs}))}function eo(zt){const rn=[],zn=(0,u.t)("dashboard-settings.general.title","General");zt.meta.canEdit&&(rn.push({title:zn,id:"settings",icon:"sliders-v-alt",component:Mr}),rn.push({title:(0,u.t)("dashboard-settings.annotations.title","Annotations"),id:"annotations",icon:"comment-alt",component:Jt,subTitle:"Annotation queries return events that can be visualized as event markers in graphs across the dashboard."}),rn.push({title:(0,u.t)("dashboard-settings.variables.title","Variables"),id:"templating",icon:"calculator-alt",component:_t,subTitle:"Variables can make your dashboard more dynamic and act as global filters."}),rn.push({title:(0,u.t)("dashboard-settings.links.title","Links"),id:"links",icon:"link",component:Do})),zt.meta.canMakeEditable&&rn.push({title:zn,icon:"sliders-v-alt",id:"settings",component:oi}),zt.id&&zt.meta.canSave&&rn.push({title:(0,u.t)("dashboard-settings.versions.title","Versions"),id:"versions",icon:"history",component:ri});const Fn=(0,u.t)("dashboard-settings.permissions.title","Permissions");return zt.id&&zt.meta.canAdmin&&b.TP.hasPermission(g.AccessControlAction.DashboardsPermissionsRead)&&rn.push({title:Fn,id:"permissions",icon:"lock",component:en}),rn.push({title:(0,u.t)("dashboard-settings.json-editor.title","JSON Model"),id:"dashboard_json",icon:"arrow",component:js}),rn}function No(zt,rn){return{...zt,parentItem:zt.parentItem?No(zt.parentItem,rn):rn}}function To(zt,rn,zn,Fn,ta,ua){const ya={text:(0,u.t)("dashboard-settings.settings.title","Settings"),children:[],icon:"apps",hideFromBreadcrumbs:!1,url:o.I.getUrlForPartial(ta,{editview:"settings",editIndex:null})};ya.children=zn.map(Ga=>({text:Ga.title,icon:Ga.icon,id:`${ua}/${Ga.id}`,url:o.I.getUrlForPartial(ta,{editview:Ga.id,editIndex:null}),active:Ga===Fn,parentItem:ya,subTitle:Ga.subTitle}));const as=No(zt,rn.node);return ya.parentItem=as,{main:ya,node:ya.children.find(Ga=>Ga.active)}}function oi({dashboard:zt,sectionNav:rn}){return n.createElement(h.Y,{navModel:rn},n.createElement(l.B,{direction:"column",gap:2,alignItems:"flex-start"},n.createElement(m.E,{variant:"h3"},"Dashboard not editable"),n.createElement(f.$n,{type:"submit",onClick:()=>zt.makeEditable()},"Make editable")))}function oo(zt){const rn=new URLSearchParams(zt.search).get("editIndex");if(rn!=null)return parseInt(rn,10)}},10740:(Q,I,e)=>{"use strict";e.d(I,{n:()=>w,C:()=>B});var n=e(32196),a=e(96540),o=e(40845),r=e(55852),i=e(94753),f=e(60782),d=e(62930),l=e(56034),m=e(42418),s=e(67061),h=e(10354),u=e(14578),b=e(72109),g=e(29158);const P=({currentPage:W,numberOfPages:V,onNavigate:_,hideWhenSinglePage:H,className:G})=>{const j=(0,o.of)(c);return H&&V<=1?null:a.createElement("div",{className:(0,n.cx)(j.wrapper,G)},a.createElement(g.K,{name:"angle-left",size:"md",tooltip:"Previous",onClick:()=>_(W-1),disabled:W===1}),W," of ",V,a.createElement(g.K,{name:"angle-right",size:"md",tooltip:"Next",onClick:()=>_(W+1),disabled:W===V}))},c=W=>({wrapper:(0,n.css)({display:"flex",flexDirection:"row",gap:16,userSelect:"none"})});var y=e(16817),p=e(65418),v=e(34867),D=e(3169),E=e(3363);const S=(0,v.DW)("features.dashboards.genai");var T=(W=>(W.IDLE="idle",W.GENERATING="generating",W.COMPLETED="completed",W))(T||{});const M=1e4;function A(W=E.C4,V=1){const[_,H]=(0,a.useState)([]),[G,j]=(0,a.useState)(!1),[Y,oe]=(0,a.useState)(""),[se,ne]=(0,a.useState)("idle"),[ee,Z]=(0,a.useState)(),{error:z}=(0,D._2)();let q="";const ie=(0,a.useCallback)(he=>{ne("idle"),H([]),j(!1),Z(he),z("Failed to generate content using OpenAI","Please try again or if the problem persists, contact your organization admin."),console.error(he),S.logError(he,{messages:JSON.stringify(_),model:W,temperature:String(V)})},[_,W,V,z]);(0,a.useEffect)(()=>{_.length>0&&oe("")},[_]);const{error:de,value:ue}=(0,y.A)(async()=>await(0,E.QX)(),[E.QX]),{error:fe,value:Se}=(0,y.A)(async()=>{if(!ue||!_.length)return{enabled:ue};ne("generating"),Z(void 0);const he=p.qH({model:W,temperature:V,messages:_}).pipe(p.qA());return{enabled:ue,stream:he.subscribe({next:ce=>{q=ce},error:ie,complete:()=>{oe(q),ne("completed"),setTimeout(()=>{ne("idle")}),H([]),j(!1),Z(void 0)}})}},[_,ue]);return(0,a.useEffect)(()=>()=>{Se?.stream&&Se.stream.unsubscribe()},[Se]),(0,a.useEffect)(()=>{G&&(Se?.stream?.unsubscribe(),ne("idle"),j(!1),Z(void 0),H([]))},[G,Se?.stream]),(0,a.useEffect)(()=>{let he;return se==="generating"&&Y===""&&(he=setTimeout(()=>{ie(new Error(`OpenAI stream timed out after ${M}ms`))},M)),()=>{he&&clearTimeout(he)}},[se,Y,ie]),(fe||de)&&Z(fe||de),{setMessages:H,setStopGeneration:j,messages:_,reply:Y,streamStatus:se,error:ee,value:Se}}const x=({history:W,index:V,reply:_,streamStatus:H,onNavigate:G})=>{const j=(0,o.of)(C),Y=W.length,oe=()=>_&&H!==T.IDLE?_:W[V-1];return a.createElement(a.Fragment,null,a.createElement("div",{className:j.contentWrapper},a.createElement(i.E,{element:"p",color:"secondary"},oe())),a.createElement(P,{currentPage:V,numberOfPages:Y,onNavigate:G,hideWhenSinglePage:!1,className:j.paginationWrapper}))},C=W=>({paginationWrapper:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"flex-end",marginTop:15}),contentWrapper:(0,n.css)({display:"flex",flexBasis:"100%",flexGrow:3,whiteSpace:"pre-wrap",maxHeight:110,overflowY:"scroll",backgroundColor:W.colors.background.secondary,border:`1px solid ${W.colors.border.weak}`,padding:W.spacing(1),minHeight:60})}),O=({onSuggestionClick:W,isGenerating:V})=>{const _=(0,o.of)(R);return a.createElement("div",{className:_.quickSuggestionsWrapper},a.createElement(r.$n,{onClick:()=>W(E.HG.Shorter),size:"sm",variant:"secondary",icon:"paragraph",disabled:V},E.HG.Shorter),a.createElement(r.$n,{onClick:()=>W(E.HG.MoreDescriptive),size:"sm",variant:"secondary",icon:"document-layout-left",disabled:V},E.HG.MoreDescriptive),a.createElement(r.$n,{onClick:()=>W(E.HG.Regenerate),icon:"sync",size:"sm",variant:"secondary",disabled:V},E.HG.Regenerate))},R=W=>({quickSuggestionsWrapper:(0,n.css)({display:"flex",flexDirection:"row",gap:8})});var L=e(57725);const N=.5,F=({eventTrackingSrc:W,history:V,messages:_,onApplySuggestion:H,updateHistory:G})=>{const j=(0,o.of)(K),[Y,oe]=(0,a.useState)(1),[se,ne]=(0,a.useState)(!1),[ee,Z]=(0,a.useState)(""),{setMessages:z,setStopGeneration:q,reply:ie,streamStatus:de,error:ue}=A(E.C4,N),fe=de===T.GENERATING,Se=(Ne,We)=>(0,L.XX)(W,Ne,We);(0,a.useEffect)(()=>{!fe&&ie!==""&&oe(1)},[fe,ie]),(0,a.useEffect)(()=>{de===T.COMPLETED&&G((0,E.Kb)(ie))},[de,ie,G]),(0,a.useEffect)(()=>{ue&&ne(!0),de===T.GENERATING&&ne(!1)},[ue,de]);const he=Ne=>{pe(Ne),Se(L.KR.customFeedback,{customFeedback:Ne})},ce=()=>{fe?(q(!0),ie!==""&&G((0,E.Kb)(ie))):H(V[Y-1])},me=Ne=>{oe(Ne),Se(Ne>Y?L.KR.backHistoryItem:L.KR.forwardHistoryItem)},pe=Ne=>{Ne!==E.HG.Regenerate?_=[..._,...(0,E.To)(V[Y-1],Ne)]:_=[..._,...(0,E.To)(V[Y-1],"Please, regenerate")],z(_),Ne in E.HG&&Se(L.KR.quickFeedback,{quickFeedbackItem:Ne})},ye=Ne=>Ne.key==="Enter"&&he(ee),Pe=Ne=>Z(Ne.currentTarget.value),Ie=()=>he(ee),Oe=()=>Se(L.KR.linkToDocs);return a.createElement("div",{className:j.container},se&&a.createElement(m.F,{title:""},a.createElement(s.B,{direction:"column"},a.createElement("p",null,"Sorry, I was unable to complete your request. Please try again."))),a.createElement(x,{history:V,index:Y,onNavigate:me,reply:(0,E.Kb)(ie),streamStatus:de}),a.createElement("div",{className:j.actionButtons},a.createElement(O,{onSuggestionClick:pe,isGenerating:fe})),a.createElement(h.p,{placeholder:"Tell AI what to do next...",suffix:a.createElement(r.$n,{icon:"enter",variant:"secondary",fill:"text","aria-label":"Send custom feedback",onClick:Ie,disabled:ee===""},"Send"),value:ee,onChange:Pe,onKeyDown:ye}),a.createElement("div",{className:j.applySuggestion},a.createElement(s.B,{justifyContent:"flex-end",direction:"row"},a.createElement(r.$n,{icon:fe?"fa fa-spinner":"check",onClick:ce},fe?B:"Apply"))),a.createElement("div",{className:j.footer},a.createElement(u.I,{name:"exclamation-circle","aria-label":"exclamation-circle",className:j.infoColor}),a.createElement(i.E,{variant:"bodySmall",color:"secondary"},"This content is AI-generated using the"," ",a.createElement(b.Y,{variant:"bodySmall",inline:!0,href:"https://grafana.com/docs/grafana-cloud/alerting-and-irm/machine-learning/llm-plugin/",external:!0,onClick:Oe},"Grafana LLM plugin"))))},K=W=>({container:(0,n.css)({display:"flex",flexDirection:"column",width:520,maxHeight:350,paddingBottom:25}),applySuggestion:(0,n.css)({paddingTop:W.spacing(2)}),actions:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),footer:(0,n.css)({position:"absolute",bottom:0,left:0,width:"100%",display:"flex",flexDirection:"row",margin:0,padding:W.spacing(1),paddingLeft:W.spacing(2),alignItems:"center",gap:W.spacing(1),borderTop:`1px solid ${W.colors.border.weak}`,marginTop:W.spacing(2)}),infoColor:(0,n.css)({color:W.colors.info.main}),actionButtons:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",padding:"24px 0 8px 0"})}),B="Stop generating",w=({text:W="Auto-generate",toggleTipTitle:V="",onClick:_,model:H=E.C4,messages:G,onGenerate:j,temperature:Y=1,eventTrackingSrc:oe,disabled:se})=>{const ne=(0,o.of)(U),{setMessages:ee,setStopGeneration:Z,reply:z,value:q,error:ie,streamStatus:de}=A(H,Y),[ue,fe]=(0,a.useState)([]),[Se,he]=(0,a.useState)(!1),ce=ue.length>0,me=de===T.GENERATING,pe=!ce,ye=se||q&&!q.enabled&&!ie,Pe=ke=>(0,L.XX)(oe,ke),Ie=ke=>{de===T.GENERATING?Z(!0):ce?he(!0):(_?.(ke),ee(Me()));const Ze=ie?L.KR.erroredRetryButton:me?L.KR.stopGenerationButton:pe?L.KR.autoGenerateButton:L.KR.improveButton;Pe(Ze)},Oe=(0,a.useCallback)(ke=>{ue.indexOf(ke)===-1&&fe([ke,...ue])},[ue]);if((0,a.useEffect)(()=>{de===T.COMPLETED&&z&&j((0,E.Kb)(z))},[de,z,j]),(0,a.useEffect)(()=>{de===T.COMPLETED&&Oe((0,E.Kb)(z))},[ue,de,z,Oe]),!q?.enabled)return null;const Ne=ke=>{Pe(L.KR.applySuggestion),j(ke),he(!1)},We=()=>{if(!me)return ie||q&&!q?.enabled?"exclamation-circle":"ai"},Ae=()=>{let ke=W;return ie&&(ke="Retry"),me&&(ke=B),ce&&(ke="Improve"),ke},Ue=a.createElement(r.$n,{icon:We(),onClick:Ie,fill:"text",size:"sm",disabled:ye,variant:ie?"destructive":"primary"},Ae()),Me=()=>typeof G=="function"?G():G,$e=()=>{if(ce){const ke=a.createElement(i.E,{element:"p"},V);return a.createElement(f.G,{title:ke,content:a.createElement(F,{history:ue,messages:Me(),onApplySuggestion:Ne,updateHistory:Oe,eventTrackingSrc:oe}),placement:"left-start",fitContent:!0,show:Se,onClose:()=>he(!1),onOpen:()=>he(!0)},Ue)}return Ue};return a.createElement("div",{className:ne.wrapper},me&&a.createElement(d.y,{size:"sm",className:ne.spinner}),pe?a.createElement(l.m,{show:ie?void 0:!1,interactive:!0,content:"Failed to generate content using OpenAI. Please try again or if the problem persist, contact your organization admin."},Ue):$e())},U=W=>({wrapper:(0,n.css)({display:"flex"}),spinner:(0,n.css)({color:W.colors.text.link})})},81394:(Q,I,e)=>{"use strict";e.d(I,{V:()=>l});var n=e(96540),a=e(14792),o=e(10740),r=e(57725),i=e(3363);const d=`You are an expert in creating Grafana Dashboards.
Your goal is to write a descriptive and concise dashboard description.
You will be given the title and description of the dashboard's panels.
The dashboard description is meant to explain the purpose of the dashboard and what its panels show.
If the dashboard has no panels, the description should be "Empty dashboard"
There should be no numbers in the description except where they are important.
The dashboard description should not have the dashboard title or any quotation marks in it.
The description should be, at most, 300 characters.
Respond with only the description of the dashboard.`,l=({onGenerate:s})=>n.createElement(o.n,{messages:m,onGenerate:s,eventTrackingSrc:r.ec.dashboardDescription,toggleTipTitle:"Improve your dashboard description"});function m(){const s=(0,a.UA)().getCurrent(),h=(0,i.BB)(s);return[{content:d,role:i.Xh.system},{content:`The title of the dashboard is "${s.title}"
${h}`,role:i.Xh.user}]}},27966:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>l});var n=e(96540),a=e(14792),o=e(10740),r=e(57725),i=e(3363);const d=`You are an expert in creating Grafana Dashboards.
Your goal is to write a concise dashboard title.
You will be given the title and description of the dashboard's panels.
The dashboard title is meant to say what it shows on one line for users to navigate to it.
If the dashboard has no panels, the title should be "Empty dashboard"
There should be no numbers in the title.
The dashboard title should not have quotation marks in it.
The title should be, at most, 50 characters.
Respond with only the title of the dashboard.`,l=({onGenerate:s})=>n.createElement(o.n,{messages:m,onGenerate:s,eventTrackingSrc:r.ec.dashboardTitle,toggleTipTitle:"Improve your dashboard title"});function m(){const s=(0,a.UA)().getCurrent();return[{content:d,role:i.Xh.system},{content:`The panels in the dashboard are: ${(0,i.BB)(s)}`,role:i.Xh.user}]}},20214:(Q,I,e)=>{"use strict";e.d(I,{t:()=>l});var n=e(96540),a=e(14792),o=e(10740),r=e(57725),i=e(3363);const d=`You are an expert in creating Grafana Panels.
You will be given the title and description of the dashboard the panel is in as well as the JSON for the panel.
Your goal is to write a descriptive and concise panel description.
The panel description is meant to explain the purpose of the panel, not just its attributes.
Do not refer to the panel; simply describe its purpose.
There should be no numbers in the description except for thresholds.
The description should be, at most, 200 characters.`,l=({onGenerate:s,panel:h})=>n.createElement(o.n,{messages:()=>m(h),onGenerate:s,eventTrackingSrc:r.ec.panelDescription,toggleTipTitle:"Improve your panel description"});function m(s){const h=(0,a.UA)().getCurrent(),u=(0,i.hn)(s);return[{content:d,role:i.Xh.system},{content:`The panel is part of a dashboard with the title: ${h.title}
The panel is part of a dashboard with the description: ${h.description}
This is the JSON which defines the panel: ${u}`,role:i.Xh.user}]}},74410:(Q,I,e)=>{"use strict";e.d(I,{h:()=>d});var n=e(96540),a=e(10740),o=e(57725),r=e(3363);const f="You are an expert in creating Grafana Panels.Your goal is to write short, descriptive, and concise panel title.The title should be shorter than 50 characters.",d=({onGenerate:m,panel:s,dashboard:h})=>n.createElement(a.n,{messages:()=>l(s,h),onGenerate:m,eventTrackingSrc:o.ec.panelTitle,toggleTipTitle:"Improve your panel title"});function l(m,s){const h=(0,r.hn)(m);return[{content:f,role:r.Xh.system},{content:`The panel is part of a dashboard with the title: ${s.title}
The panel is part of a dashboard with the description: ${s.description}
Use this JSON object which defines the panel: ${h}`,role:r.Xh.user}]}},57725:(Q,I,e)=>{"use strict";e.d(I,{KR:()=>r,XX:()=>i,ec:()=>o});var n=e(14110);const a="dashboards_autogenerate_clicked";var o=(f=>(f.panelDescription="panel-description",f.panelTitle="panel-title",f.dashboardChanges="dashboard-changes",f.dashboardTitle="dashboard-title",f.dashboardDescription="dashboard-description",f.unknown="unknown",f))(o||{}),r=(f=>(f.autoGenerateButton="auto-generate-button",f.erroredRetryButton="errored-retry-button",f.stopGenerationButton="stop-generating-button",f.improveButton="improve-button",f.backHistoryItem="back-history-item",f.forwardHistoryItem="forward-history-item",f.quickFeedback="quick-feedback",f.linkToDocs="link-to-docs",f.customFeedback="custom-feedback",f.applySuggestion="apply-suggestion",f))(r||{});function i(f,d,l){(0,n.rR)(a,{src:f,item:d,...l})}},3363:(Q,I,e)=>{"use strict";e.d(I,{C4:()=>y,HG:()=>c,Xh:()=>P,Yy:()=>v,BB:()=>T,To:()=>S,hn:()=>M,QX:()=>E,Kb:()=>p});var n=e(2543),a=e(65418),o=e(32264),r=e(90254),i=e(34214);function f(A,x){return A===x?x:Array.isArray(A)&&Array.isArray(x)?m(A,x):d(A)&&d(x)?l(A,x):x}function d(A){return typeof A=="object"&&!Array.isArray(A)&&A!==null}function l(A,x){const C=Object.keys(A),O={};for(const R of C)x.hasOwnProperty(R)&&(Array.isArray(A[R])&&Array.isArray(x[R])||typeof A[R]=="object"&&typeof x[R]=="object"?O[R]=f(A[R],x[R]):O[R]=x[R]);return O}function m(A,x){const C=new Array(A.length).fill(void 0),O=new Set([...Array(A.length).keys()]),R=new Set([...Array(x.length).keys()]);for(let L=0;L<A.length&&R.size!==0;L++){let N=A[L];for(let F=0;F<x.length;F++){if(!R.has(F))continue;let K=x[F];K=f(N,K),JSON.stringify(N)===JSON.stringify(K)&&(O.delete(L),R.delete(F),C[L]=K)}}return s(A,x,C,O,R),C.filter(L=>L!==void 0)}function s(A,x,C,O,R){let L={};R.forEach(F=>{let K=x[F];if(typeof K!="object"||Array.isArray(K)){C.push(K),R.delete(F);return}O.forEach(B=>{let w=A[B];if(typeof w!="object"||Array.isArray(w)){O.delete(B);return}let U=0;for(const W in w){let V=w[W];if(!K.hasOwnProperty(W))continue;let _=K[W];typeof V!="string"&&typeof V!="number"||typeof V!=typeof _||V===_&&(W==="id"&&(U+=1e3),U++)}U!==0&&(L[U]===void 0&&(L[U]=[]),L[U].push([B,F]))})});const N=Object.keys(L).map(Number);N.sort((F,K)=>K-F);for(const F of N){let K=L[F];for(const B of K){const[w,U]=B;O.has(w)&&R.has(U)&&(C[w]=x[U],O.delete(w),R.delete(U))}}for(const F of R)C.push(x[F])}function h(A){const x=A.split(`
`);let C=A[0].startsWith("Index")?4:3,O=x.slice(0,C);const R=/("title"|Title|\{|\}|\[|\])/i;for(let L=C;L<x.length;L++){let N=x[L];(R.test(N)||N.startsWith("+")||N.startsWith("-"))&&O.push(N)}return O.join(`
`)+`
`}function u(A){if(A===null||A==="")return null;if(Array.isArray(A)){const C=A.map(O=>u(O)).filter(O=>O!==null);return C.length>0?C:null}if(typeof A!="object")return A;const x={};for(const C in A){const O=u(A[C]);if(O!==null){if(Array.isArray(O)&&O.length===0||typeof O=="object"&&Object.keys(O).length===0)continue;x[C]=O}}return Object.keys(x).length>0?x:null}function b(A){return JSON.parse(JSON.stringify(A,null,2))}function g(A){let x=b(A.getOriginalDashboard()),C=b(new i.G(x).getSaveModelClone()),O=b(A.getSaveModelClone());C=u(f(x,C)),O=u(f(C,O)),x=u(x);let R=(0,r.ss)("Before migration changes","After migration changes",JSON.stringify(x,null,2),JSON.stringify(C,null,2),"","",{context:20}),L=(0,r.ss)("Before user changes","After user changes",JSON.stringify(C,null,2),JSON.stringify(O,null,2),"","",{context:20});return R=h(R),L=h(L),{migrationDiff:R,userDiff:L}}var P=(A=>(A.system="system",A.user="user",A))(P||{}),c=(A=>(A.Shorter="Even shorter",A.MoreDescriptive="More descriptive",A.Regenerate="Regenerate",A))(c||{});const y="gpt-4",p=A=>A.replace(/^"|"$/g,"");function v(A){const{migrationDiff:x,userDiff:C}=g(A);return{userChanges:C,migrationChanges:x}}let D;async function E(){return o.$.apps["grafana-llm-app"]?D||(D=new Promise(A=>{a.vK().then(x=>{x.ok||(D=void 0),A(x.ok)})}),D):!1}const S=(A,x)=>[{role:"system",content:`Your previous response was: ${A}. The user has provided the following feedback: ${x}. Re-generate your response according to the provided feedback.`}];function T(A){const x=(R,L)=>`- Panel ${L}
- Title: ${R.title}${R.description?`
- Description: ${R.description}`:""}`,C=A.panels.map(x);let O;if(C.length<=10)O=`The panels in the dashboard are:
${C.join(`
`)}`;else{const R=A.panels.filter(F=>F.description),L=A.panels.filter(F=>!F.description);let N;R.length>=10?N=R.slice(10).map(x).join(`
`):(N=R.map(x).join(`
`),N+=`
`,N+=L.slice(10-R.length).map(x).join("n")),O=`There are ${C.length} panels.
Due to space constraints, only the information for ten of them is presented.
These ten are not necessarily the first ten, but prioritized to those with descriptions.
The panels in the dashboard are:
${N}`}return O}function M(A){const x=["datasource","title","description","targets","type"],C={...(0,n.pick)(A,x),options:(0,n.pick)(A.options,["content"])};return JSON.stringify(C,null,2)}},18803:(Q,I,e)=>{"use strict";e.d(I,{B6:()=>h,E_:()=>b,jD:()=>u});var n=e(2543),a=e.n(n),o=e(72985),r=e(89667),i=e(52622),f=e(72724),d=e(39070),l=e(32264),m=e(41524),s=e(68706);function h(p){const v=[];if(p?.series)for(const D of p.series)v.push((0,r.Nw)(D));if(p?.annotations)for(const D of p.annotations){const E=(0,r.Nw)(D);E.schema?.meta||(E.schema.meta={}),E.schema.meta.dataTopic=i.QR.Annotations,v.push(E)}return v}function u(p,v){const D=p.getSaveModel(),E={panelType:D.type,datasource:"??"},S=l.$.buildInfo.versionString;let T=`| Key | Value |
|--|--|
| Panel | ${E.panelType} @ ${D.pluginVersion??S} |
| Grafana | ${S} // ${l.$.buildInfo.edition} |
`;return v&&(T+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+v+"\n```\n</details>"),T}async function b(p,v,D){const E=p.getSaveModel(),S=(0,n.cloneDeep)(y),T={panelType:E.type,datasource:"??"},M=await(0,o._)(p.getQueryRunner().getData({withFieldConfig:!1,withTransforms:!1})),A=p.datasource,x=(0,m.W)(h(M),v),C=l.$.buildInfo.versionString,O=E?.targets??[],R=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${T.panelType} @ ${E.pluginVersion??C}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${O.map(L=>{const N=L.datasource??A;return`${L.refId}[${N?.type}]`}).join(", ")}</td>
    </tr>
    ${g(E)}
    ${P(M,x)}
    ${c(M)}
    <tr>
      <th>Grafana</th>
      <td>${C} // ${l.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(S.panels[0]={...E,...S.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:s.nj.Snapshot,snapshot:x}]},E.transformations?.length){const L=S.panels[S.panels.length-1];L.title=L.title+" (after transformations)";const N=(0,n.cloneDeep)(L);N.id=100,N.title="Data (before transformations)",N.gridPos.w=24,N.targets[0].withTransforms=!1,S.panels.push(N)}return M.annotations?.length&&S.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:i.QR.Annotations,refId:"A"}]}),S.panels[1].options.content=R,S.panels[2].options.content=JSON.stringify(E,null,2),S.title=`Debug: ${E.title} // ${(0,f.LE)(new Date)}`,S.tags=["debug",`debug-${T.panelType}`],S.time={from:D.from.toISOString(),to:D.to.toISOString()},S}function g(p){return p.transformations?`<tr>
      <th>Transform</th>
      <td>${p.transformations.map(v=>v.id).join(", ")}</td>
  </tr>`:""}function P(p,v){let D=p.series.length??0,E=0,S=0;for(const T of p.series)E+=T.fields.length,S+=T.length;return`<tr><th>Data</th><td>${p.state!==d.Gu.Done?p.state:""} ${D} frames, ${E} fields, ${S} rows </td></tr>`}function c(p){return p.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${p.annotations.map((v,D)=>`<span>${v.length}</span>`)}</td>
</tr>`:""}const y={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37}},65123:(Q,I,e)=>{"use strict";e.d(I,{BN:()=>l,kx:()=>m,sd:()=>d});var n=e(96540),a=e(24705),o=e(19347),r=e(8484),i=e(16560),f=e(54612);const d=s=>(0,a.A)(async()=>l(s),[s]).value;async function l(s){const h=s?.request?.targets||[];if(s&&s.series&&h.length){for(const u of s.series)if(u.meta&&u.meta.custom){const b=await(0,o.l)().get(h[0].datasource);if(b&&b.components?.MetadataInspector)return b}}}const m=(s,h,u,b,g)=>(0,n.useMemo)(()=>{const P=[];return(0,f.$)(u)&&(P.push({label:(0,r.t)("dashboard.inspect.data-tab","Data"),value:i.q.Data}),P.push({label:(0,r.t)("dashboard.inspect.stats-tab","Stats"),value:i.q.Stats})),g&&P.push({label:(0,r.t)("dashboard.inspect.meta-tab","Meta data"),value:i.q.Meta}),P.push({label:(0,r.t)("dashboard.inspect.json-tab","JSON"),value:i.q.JSON}),b&&P.push({label:(0,r.t)("dashboard.inspect.error-tab","Error"),value:i.q.Error}),h.meta.canEdit&&(0,f.$)(u)&&P.push({label:(0,r.t)("dashboard.inspect.query-tab","Query"),value:i.q.Query}),P},[u,g,h,b])},57755:(Q,I,e)=>{"use strict";e.d(I,{D:()=>h});var n=e(32196),a=e(96540),o=e(78685),r=e(13544),i=e(53402),f=e(40845),d=e(55852),l=e(83277),m=e(53466);const s="showCategory",h=a.memo(({id:g,title:P,children:c,forceOpen:y,isOpenDefault:p=!0,renderTitle:v,className:D,itemsCount:E,isNested:S=!1,sandboxId:T})=>{const[M,A]=(0,o.A)(b(g),{isExpanded:p}),[x,C]=(0,a.useState)(M?.isExpanded??p),O=(0,a.useRef)(0),R=(0,a.useRef)(null),[L,N]=(0,l.s)(),F=L[s]===g;(0,a.useEffect)(()=>{O.current&&Date.now()-O.current<200||(F||y)&&(x||C(!0),F&&R.current?.scrollIntoView())},[y,x,F]);const K=(0,a.useCallback)(()=>{O.current=Date.now(),N({[s]:x?void 0:g},!0),A({isExpanded:!x}),C(!x)},[A,C,N,x,g]);v||(v=function(_){return _||E===void 0||E===0?P:a.createElement("span",null,P," ",a.createElement(i.p,{value:E}))});const B=(0,f.of)(u),w=(0,n.cx)({[B.box]:!0,[B.boxNestedExpanded]:S&&x},D),U=(0,n.cx)(B.header,{[B.headerExpanded]:x,[B.headerNested]:S}),W=(0,n.cx)(B.body,{[B.bodyNested]:S});return a.createElement("div",{className:w,"data-plugin-sandbox":T,"data-testid":r.Tp.components.OptionsGroup.group(g),ref:R},a.createElement("div",{className:U,onClick:K},a.createElement(d.$n,{"data-testid":r.Tp.components.OptionsGroup.toggle(g),type:"button",fill:"text",size:"sm",variant:"secondary","aria-expanded":x,className:B.toggleButton,icon:x?"angle-down":"angle-right",onClick:K}),a.createElement("h6",{id:`button-${g}`,className:B.title},v(x))),x&&a.createElement("div",{className:W,id:g,"aria-labelledby":`button-${g}`},c))});h.displayName="OptionsPaneCategory";const u=g=>({box:(0,n.css)({borderTop:`1px solid ${g.colors.border.weak}`}),boxNestedExpanded:(0,n.css)({marginBottom:g.spacing(2)}),title:(0,n.css)({flexGrow:1,overflow:"hidden",lineHeight:1.5,fontSize:"1rem",paddingLeft:"6px",fontWeight:g.typography.fontWeightMedium,margin:0}),header:(0,n.css)({display:"flex",cursor:"pointer",alignItems:"center",padding:g.spacing(.5),color:g.colors.text.primary,fontWeight:g.typography.fontWeightMedium,"&:hover":{background:g.colors.emphasize(g.colors.background.primary,.03)}}),toggleButton:(0,n.css)({alignSelf:"baseline"}),headerExpanded:(0,n.css)({color:g.colors.text.primary}),headerNested:(0,n.css)({padding:g.spacing(.5,0,.5,0)}),body:(0,n.css)({padding:g.spacing(1,2,1,4)}),bodyNested:(0,n.css)({position:"relative",paddingRight:0,"&:before":{content:"''",position:"absolute",top:0,left:"8px",width:"1px",height:"100%",background:g.colors.border.weak}})}),b=g=>`${m.wi}.optionGroup[${g}]`},48192:(Q,I,e)=>{"use strict";e.d(I,{C:()=>o});var n=e(96540),a=e(57755);class o{constructor(i){this.props=i,this.items=[],this.categories=[]}addItem(i){return i.parent=this,this.items.push(i),this}addCategory(i){return i.props.isNested=!0,i.parent=this,this.categories.push(i),this}getCategory(i){let f=this.categories.find(d=>d.props.id===i);return f||(f=new o({title:i,id:i}),this.addCategory(f)),f}render(i){return this.props.customRender?this.props.customRender():n.createElement(a.D,{key:this.props.title,...this.props},this.items.map(f=>f.render(i)),this.categories.map(f=>f.render(i)))}}},74097:(Q,I,e)=>{"use strict";e.d(I,{v:()=>u});var n=e(32196),a=e(96540),o=e(23257),r=e.n(o),i=e(13544),f=e(60029),d=e(88575),l=e(40845),m=e(56034);function s({overrides:P}){const c=(0,l.of)(h);return a.createElement("div",{className:c.wrapper},P.map((y,p)=>a.createElement(m.m,{content:y.tooltip,key:p.toString(),placement:"top"},a.createElement("div",{"aria-label":y.description,className:c[y.type]}))))}const h=P=>{const c={width:8,height:8,borderRadius:P.shape.radius.circle,marginLeft:P.spacing(1),top:"-1px"};return{wrapper:(0,n.css)({display:"flex"}),rule:(0,n.css)({...c,position:"relative",backgroundColor:P.colors.primary.main}),data:(0,n.css)({...c,position:"relative",backgroundColor:P.colors.warning.main})}};class u{constructor(c){this.props=c}getLabel(c){const{title:y,description:p,overrides:v,addon:D}=this.props;if(!c)return this.parent.props.title===y&&!v?.length?null:a.createElement(b,{title:y,description:p,overrides:v,addon:D});const E=[];return this.parent.parent&&E.push(this.highlightWord(this.parent.parent.props.title,c)),this.parent.props.title!==y&&E.push(this.highlightWord(this.parent.props.title,c)),a.createElement(f.J,{description:p&&this.highlightWord(p,c),category:E},this.highlightWord(y,c),v&&v.length>0&&a.createElement(s,{overrides:v}))}highlightWord(c,y){return a.createElement(r(),{textToHighlight:c,searchWords:[y],highlightClassName:"search-fragment-highlight"})}renderOverrides(){const{overrides:c}=this.props;!c||c.length}render(c){const{title:y,description:p,render:v,showIf:D,skipField:E}=this.props,S=`${this.parent.props.id} ${y}`;return D&&!D()?null:E?v():a.createElement(d.D,{label:this.getLabel(c),description:p,key:S,"aria-label":i.Tp.components.PanelEditor.OptionsPane.fieldLabel(S)},v())}}function b({title:P,description:c,overrides:y,addon:p}){const v=(0,l.of)(g);return a.createElement("div",{className:v.container},a.createElement(f.J,{description:c},P,y&&y.length>0&&a.createElement(s,{overrides:y})),p)}function g(P){return{container:(0,n.css)({display:"flex",justifyContent:"space-between"})}}},26443:(Q,I,e)=>{"use strict";e.d(I,{gs:()=>ne,Ff:()=>oe,Po:()=>ee});var n=e(32196),a=e(96540),o=e(32264),r=e(40845),i=e(67647),f=e(94354),d=e(40276),l=e(74106),m=e(82792),s=e(71468),h=e(7376),u=e(79971),b=e(40334),g=e(33390);function P(z,q){g.A.set(`panel-edit-section-${z}`,q?"true":"false")}function c(z,q){return g.A.getBool(`panel-edit-section-${z}`,q)}const y=(z,q)=>({angularPanelComponent:(0,b.U)(z,q.panel)?.angularComponent}),p={changePanelPlugin:u.gW},v=(0,s.connect)(y,p);class D extends a.PureComponent{constructor(q){super(q)}componentDidMount(){this.loadAngularOptions()}componentDidUpdate(q){(this.props.plugin!==q.plugin||this.props.angularPanelComponent!==q.angularPanelComponent)&&this.cleanUpAngularOptions(),this.loadAngularOptions()}componentWillUnmount(){this.cleanUpAngularOptions()}cleanUpAngularOptions(){this.angularOptions&&(this.angularOptions.destroy(),this.angularOptions=null)}loadAngularOptions(){const{panel:q,angularPanelComponent:ie,changePanelPlugin:de}=this.props;if(!this.element||!ie||this.angularOptions)return;const ue=ie.getScope();if(!ue.$$childHead){setTimeout(()=>{this.forceUpdate()});return}const fe=ue.$$childHead.ctrl;fe.initEditMode(),fe.onPluginTypeChange=me=>{de({panel:q,pluginId:me.id})};let Se="";for(let me=0;me<fe.editorTabs.length;me++){const pe=fe.editorTabs[me];pe.isOpen=c(pe.title,me===0),Se+=`
      <div class="panel-options-group" ng-cloak>
        <div class="panel-options-group__header" ng-click="toggleOptionGroup(${me})" aria-label="${pe.title} section">
          <div class="panel-options-group__icon">
            <icon name="ctrl.editorTabs[${me}].isOpen ? 'angle-down' : 'angle-right'"></icon>
          </div>
          <div class="panel-options-group__title">${pe.title}</div>
        </div>
        <div class="panel-options-group__body" ng-if="ctrl.editorTabs[${me}].isOpen">
          <panel-editor-tab editor-tab="ctrl.editorTabs[${me}]" ctrl="ctrl"></panel-editor-tab>
        </div>
      </div>
      `}const he=(0,h.E)(),ce={ctrl:fe,toggleOptionGroup:me=>{const pe=fe.editorTabs[me];pe.isOpen=!pe.isOpen,P(pe.title,!!pe.isOpen)}};this.angularOptions=he.load(this.element,ce,Se),this.angularOptions.digest()}render(){return a.createElement("div",{ref:q=>this.element=q})}}const E=(0,s.connect)(y,p)(D);var S=e(57755),T=e(22290),M=e(10354);const A=({panel:z,formatDate:q})=>{const ie=(0,r.of)(x),de=z.libraryPanel?.meta;return de?a.createElement("div",{className:ie.info},a.createElement("div",{className:ie.libraryPanelInfo},`Used on ${de.connectedDashboards} `,de.connectedDashboards===1?"dashboard":"dashboards"),a.createElement("div",{className:ie.libraryPanelInfo},"Last edited on ",q?.(de.updated,"L")??de.updated," by",de.updatedBy.avatarUrl&&a.createElement("img",{width:"22",height:"22",className:ie.userAvatar,src:de.updatedBy.avatarUrl,alt:`Avatar for ${de.updatedBy.name}`}),de.updatedBy.name)):null},x=z=>({info:(0,n.css)`
      line-height: 1;
    `,libraryPanelInfo:(0,n.css)`
      color: ${z.colors.text.secondary};
      font-size: ${z.typography.bodySmall.fontSize};
    `,userAvatar:(0,n.css)`
      border-radius: ${z.shape.radius.circle};
      box-sizing: content-box;
      width: 22px;
      height: 22px;
      padding-left: ${z.spacing(1)};
      padding-right: ${z.spacing(1)};
    `});var C=e(48192),O=e(74097);function R(z){const{panel:q,onPanelConfigChange:ie,dashboard:de}=z,ue=new C.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return(0,m.X)(q)&&ue.addItem(new O.v({title:"Name",value:q.libraryPanel.name,popularRank:1,render:function(){return a.createElement(M.p,{id:"LibraryPanelFrameName",defaultValue:q.libraryPanel.name,onBlur:Se=>ie("libraryPanel",{...q.libraryPanel,name:Se.currentTarget.value})})}})).addItem(new O.v({title:"Information",render:function(){return a.createElement(A,{panel:q,formatDate:de.formatDate})}})),ue}var L=e(13544),N=e(21744),F=e(15292),K=e(64919),B=e(21594),w=e(6923),U=e(20214),W=e(74410),V=e(92378);function _(z){const{dashboard:q,panel:ie,onPanelConfigChange:de}=z,ue=new C.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),fe=he=>{const ce=document.getElementById("PanelFrameTitle");ce instanceof HTMLInputElement&&(ce.value=he,de("title",he))},Se=he=>{const ce=document.getElementById("description-text-area");ce instanceof HTMLTextAreaElement&&(ce.value=he,de("description",he))};return ue.addItem(new O.v({title:"Title",value:ie.title,popularRank:1,render:function(){return a.createElement(M.p,{"data-testid":L.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),id:"PanelFrameTitle",defaultValue:ie.title,onBlur:ce=>de("title",ce.currentTarget.value)})},addon:o.$.featureToggles.dashgpt&&a.createElement(W.h,{onGenerate:fe,panel:ie.getSaveModel(),dashboard:q.getSaveModelClone()})})).addItem(new O.v({title:"Description",description:ie.description,value:ie.description,render:function(){return a.createElement(N.f,{"data-testid":L.Tp.components.PanelEditor.OptionsPane.fieldInput("Description"),id:"description-text-area",defaultValue:ie.description,onBlur:ce=>de("description",ce.currentTarget.value)})},addon:o.$.featureToggles.dashgpt&&a.createElement(U.t,{onGenerate:Se,panel:ie.getSaveModel()})})).addItem(new O.v({title:"Transparent background",render:function(){return a.createElement(F.d,{"data-testid":L.Tp.components.PanelEditor.OptionsPane.fieldInput("Transparent background"),value:ie.transparent,id:"transparent-background",onChange:ce=>de("transparent",ce.currentTarget.checked)})}})).addCategory(new C.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:ie.links?.length}).addItem(new O.v({title:"Panel links",render:function(){return a.createElement(K.e,{links:ie.links,onChange:ce=>de("links",ce),getSuggestions:w.Fq,data:[]})}}))).addCategory(new C.C({title:"Repeat options",id:"Repeat options",isOpenDefault:!1}).addItem(new O.v({title:"Repeat by variable",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(){return a.createElement(V.G,{id:"repeat-by-variable-select",repeat:ie.repeat,onChange:ce=>{de("repeat",ce)}})}})).addItem(new O.v({title:"Repeat direction",showIf:()=>!!ie.repeat,render:function(){const ce=[{label:"Horizontal",value:"h"},{label:"Vertical",value:"v"}];return a.createElement(f.z,{options:ce,value:ie.repeatDirection||"h",onChange:me=>de("repeatDirection",me)})}})).addItem(new O.v({title:"Max per row",showIf:()=>!!(ie.repeat&&ie.repeatDirection==="h"),render:function(){const ce=[2,3,4,6,8,12].map(me=>({label:me.toString(),value:me}));return a.createElement(B.l6,{options:ce,value:ie.maxPerRow,onChange:me=>de("maxPerRow",me.value)})}})))}var H=e(66211);class G{constructor(q,ie){this.categories=q,this.overrides=ie}search(q){const ie=new RegExp(q,"i"),ue=this.collectHits(this.categories,ie,[]).sort(j).map(he=>he.item),Se=this.collectHits(this.overrides,ie,[]).sort(j).map(he=>he.item);return{optionHits:ue,overrideHits:this.buildOverrideHitCategories(Se),totalCount:this.getAllOptionsCount(this.categories)}}collectHits(q,ie,de){for(const ue of q){const fe=ie.test(ue.props.title);for(const Se of ue.items){if(ie.test(Se.props.title)){de.push({item:Se,rank:1});continue}if(Se.props.description&&ie.test(Se.props.description)){de.push({item:Se,rank:2});continue}fe&&de.push({item:Se,rank:3})}ue.categories.length>0&&this.collectHits(ue.categories,ie,de)}return de}getAllOptionsCount(q){let ie=0;for(const de of q)ie+=de.items.length,de.categories.length>0&&(ie+=this.getAllOptionsCount(de.categories));return ie}buildOverrideHitCategories(q){const ie={};for(const de of q){let ue=ie[de.parent.props.title];ue||(ue=ie[de.parent.props.title]=new C.C(de.parent.props),ue.addItem(de.parent.items[0])),ue.items[0].props.title!==de.props.title&&ue.addItem(de)}return Object.values(ie)}}function j(z,q){return z.rank-q.rank}function Y(z){const q=[];for(const ie of z)for(const de of ie.items)de.props.title==="Unit"&&(de.props.popularRank=2),de.props.title==="Min"&&(de.props.popularRank=3),de.props.title==="Max"&&(de.props.popularRank=4),de.props.title==="Display name"&&(de.props.popularRank=5),de.props.popularRank&&q.push(de);return q.sort((ie,de)=>ie.props.popularRank-de.props.popularRank)}const oe=z=>{const{plugin:q,dashboard:ie,panel:de}=z,[ue,fe]=(0,a.useState)(""),[Se,he]=(0,a.useState)("All"),ce=(0,r.of)(Z),[me,pe,ye]=(0,a.useMemo)(()=>[_(z),(0,H.Zm)(z),R(z)],[de.configRev,z.data,z.instanceState,ue]),Pe=(0,a.useMemo)(()=>(0,T.v)(z.panel.fieldConfig,z.plugin.fieldConfigRegistry,z.data?.series??[],ue,z.onFieldConfigsChange),[de.configRev,z.data,z.instanceState,ue]),Ie=[],Oe=ue.length>0,Ne=(0,a.useMemo)(se,[]),We=(0,m.X)(de)?[ye,me,...pe]:[me,...pe];if(Oe)Ie.push(ee(We,Pe,ue)),z.plugin.angularPanelCtrl&&Ie.push(a.createElement("div",{className:ce.searchNotice,key:"Search notice"},"This is an old visualization type that does not support searching all options."));else switch(Se){case"All":(0,m.X)(de)&&Ie.push(ye.render()),Ie.push(me.render()),z.plugin.angularPanelCtrl&&Ie.push(a.createElement(E,{plugin:q,dashboard:ie,panel:de,key:"AngularOptions"}));for(const Ue of pe)Ie.push(Ue.render());for(const Ue of Pe)Ie.push(Ue.render());break;case"Overrides":for(const Ue of Pe)Ie.push(Ue.render());break;case"Recent":Ie.push(a.createElement(S.D,{id:"Recent options",title:"Recent options",key:"Recent options",forceOpen:1},Y(We).map(Ue=>Ue.render())));break}const Ae=!Oe&&!q.fieldConfigRegistry.isEmpty();return a.createElement("div",{className:ce.wrapper},a.createElement("div",{className:ce.formBox},de.isAngularPlugin()&&!q.meta.angular?.hideDeprecation&&a.createElement(l.c,{className:ce.angularDeprecationWrapper,showPluginDetailsLink:!0,pluginId:q.meta.id,pluginType:q.meta.type,angularSupportEnabled:o.$?.angularSupportEnabled,interactionElementId:"panel-options"}),a.createElement("div",{className:ce.formRow},a.createElement(i.Z,{width:0,value:ue,onChange:fe,placeholder:"Search options"})),Ae&&a.createElement("div",{className:ce.formRow},a.createElement(f.z,{options:Ne,value:Se,fullWidth:!0,onChange:he}))),a.createElement("div",{className:ce.scrollWrapper},a.createElement(d.E,{autoHeightMin:"100%"},a.createElement("div",{className:ce.mainBox},Ie))))};function se(){return[{label:"All",value:"All"},{label:"Overrides",value:"Overrides"}]}var ne=(z=>(z.All="All",z.Overrides="Overrides",z.Recent="Recent",z))(ne||{});function ee(z,q,ie){const de=new G(z,q),{optionHits:ue,totalCount:fe,overrideHits:Se}=de.search(ie);return a.createElement("div",{key:"search results"},a.createElement(S.D,{id:"Found options",title:`Matched ${ue.length}/${fe} options`,key:"Normal options",forceOpen:1},ue.map(he=>he.render(ie))),Se.map(he=>he.render(ie)))}const Z=z=>({wrapper:(0,n.css)({height:"100%",display:"flex",flexDirection:"column",flex:"1 1 0",".search-fragment-highlight":{color:z.colors.warning.text,background:"transparent"}}),searchBox:(0,n.css)({display:"flex",flexDirection:"column",minHeight:0}),formRow:(0,n.css)({marginBottom:z.spacing(1)}),formBox:(0,n.css)({padding:z.spacing(1),background:z.colors.background.primary,border:`1px solid ${z.components.panel.borderColor}`,borderTopLeftRadius:z.shape.borderRadius(1.5),borderBottom:"none"}),closeButton:(0,n.css)({marginLeft:z.spacing(1)}),searchHits:(0,n.css)({padding:z.spacing(1,1,0,1)}),scrollWrapper:(0,n.css)({flexGrow:1,minHeight:0}),searchNotice:(0,n.css)({fontSize:z.typography.size.sm,color:z.colors.text.secondary,padding:z.spacing(1),textAlign:"center"}),mainBox:(0,n.css)({background:z.colors.background.primary,border:`1px solid ${z.components.panel.borderColor}`,borderTop:"none",flexGrow:1}),angularDeprecationWrapper:(0,n.css)({padding:z.spacing(1)})})},22290:(Q,I,e)=>{"use strict";e.d(I,{v:()=>A});var n=e(32196),a=e(2543),o=e(96540),r=e(85200),i=e(37055),f=e(84349),d=e(51986),l=e(40845),m=e(6923),s=e(23257),h=e.n(s),u=e(66864),b=e(60029),g=e(53402),P=e(29158),c=e(88575),y=e(57755);const p=({property:R,context:L,registry:N,onChange:F,onRemove:K,isSystemOverride:B,searchQuery:w})=>{const U=(0,l.of)(v),W=N?.getIfExists(R.id),V=(0,o.useId)();if(!W)return null;const _=Array.isArray(R.value)||R.id===i.uo.Thresholds||R.id===i.uo.Links||R.id===i.uo.Mappings,H=W.category?.filter(Y=>Y!==W.name);let G;const j=(Y=!0,oe=!1)=>(se=!1)=>o.createElement(u.Gy,{justify:"space-between"},o.createElement(b.J,{category:H,description:Y?W.description:void 0,htmlFor:V},o.createElement(h(),{textToHighlight:W.name,searchWords:[w],highlightClassName:"search-fragment-highlight"}),!se&&oe&&W.getItemsCount&&o.createElement(g.p,{value:W.getItemsCount(R.value)})),!B&&o.createElement("div",null,o.createElement(P.K,{name:"times",onClick:K,tooltip:"Remove label"})));return _?G=o.createElement(y.D,{id:W.name,renderTitle:j(!1,!0),className:(0,n.css)({paddingLeft:0,paddingRight:0}),isNested:!0,isOpenDefault:R.value!==void 0},o.createElement(W.override,{value:R.value,onChange:Y=>{F(Y)},item:W,context:L})):G=o.createElement("div",null,o.createElement(c.D,{label:j()(),description:W.description},o.createElement(W.override,{value:R.value,onChange:Y=>{F(Y)},item:W,context:L,id:V}))),o.createElement("div",{className:(0,n.cx)(_&&U.collapsibleOverrideEditor,!_&&"dynamicConfigValueEditor--nonCollapsible")},G)},v=R=>({collapsibleOverrideEditor:(0,n.css)({label:"collapsibleOverrideEditor","& + .dynamicConfigValueEditor--nonCollapsible":{marginTop:R.spacing(1)}})});var D=e(48192),E=e(74097),S=e(14578);const T=({isExpanded:R,registry:L,matcherUi:N,overrideName:F,override:K,onOverrideRemove:B})=>{const w=(0,l.of)(M),W=K.properties.map(_=>L.getIfExists(_.id)).filter(_=>!!_).map(_=>_?.name).join(", "),V=N.optionsToLabel(K.matcher.options);return o.createElement("div",null,o.createElement(u.Gy,{justify:"space-between"},o.createElement("div",null,F),o.createElement(P.K,{name:"trash-alt",onClick:B,tooltip:"Remove override"})),!R&&o.createElement("div",{className:w.overrideDetails},o.createElement("div",{className:w.options,title:V},V," ",o.createElement(S.I,{name:"angle-right"})," ",W)))};T.displayName="OverrideTitle";const M=R=>({matcherUi:(0,n.css)({padding:R.spacing(1)}),propertyPickerWrapper:(0,n.css)({marginTop:R.spacing(2)}),overrideDetails:(0,n.css)({fontSize:R.typography.bodySmall.fontSize,color:R.colors.text.secondary,fontWeight:R.typography.fontWeightRegular}),options:(0,n.css)({overflow:"hidden",paddingRight:R.spacing(4)}),unknownLabel:(0,n.css)({marginBottom:0})});function A(R,L,N,F,K){const B=[],w=R;if(!L||L.isEmpty())return[];const U=(H,G)=>{let j=(0,a.cloneDeep)(w.overrides);j[H]=G,K({...w,overrides:j})},W=H=>{let G=(0,a.cloneDeep)(w.overrides);G.splice(H,1),K({...w,overrides:G})},V=H=>{const G=r.sJ.get(H.value);G&&K({...w,overrides:[...w.overrides,{matcher:{id:G.id,options:G.defaultOptions},properties:[]}]})},_={data:N,getSuggestions:H=>(0,m.Hf)(N,H),isOverride:!0};for(let H=0;H<w.overrides.length;H++){const G=w.overrides[H],j=`Override ${H+1}`,Y=f.g.get(G.matcher.id),oe=x(L),se=(0,i.Ow)(G),ne=G.properties.length===0?1:0,ee=new D.C({title:j,id:j,forceOpen:ne,renderTitle:function(ie){return o.createElement(T,{override:G,isExpanded:ie,registry:L,overrideName:j,matcherUi:Y,onOverrideRemove:()=>W(H)})}}),Z=q=>{G.matcher.options=q,U(H,G)},z=(q,ie)=>{const de=L.get(ie.value),ue={id:de.id,value:de.defaultValue};G.properties?q.properties.push(ue):q.properties=[ue],U(H,q)};ee.addItem(new E.v({title:Y.name,render:function(){return o.createElement(Y.component,{id:`${Y.matcher.id}-${H}`,matcher:Y.matcher,data:N??[],options:G.matcher.options,onChange:Z})}}));for(let q=0;q<G.properties.length;q++){const ie=G.properties[q],de=L.getIfExists(ie.id);if(!de)continue;const ue=Se=>{G.properties[q].value=Se,U(H,G)},fe=()=>{G.properties.splice(q,1),U(H,G)};ee.addItem(new E.v({title:de.name,skipField:!0,render:function(){return o.createElement(p,{key:`${ie.id}/${q}`,isSystemOverride:se,onChange:ue,onRemove:fe,property:ie,registry:L,context:_,searchQuery:F})}}))}!se&&G.matcher.options&&ee.addItem(new E.v({title:"----------",skipField:!0,render:function(){return o.createElement(d.i,{key:"Add override property",label:"Add override property",variant:"secondary",isFullWidth:!0,icon:"plus",menuPlacement:"auto",options:oe,onChange:ie=>z(G,ie)})}})),B.push(ee)}return B.push(new D.C({title:"add button",id:"add button",customRender:function(){return o.createElement(C,{key:"Add override"},o.createElement(d.i,{icon:"plus",label:"Add field override",variant:"secondary",menuPlacement:"auto",isFullWidth:!0,size:"md",options:f.g.list().filter(G=>!G.excludeFromPicker).map(G=>({label:G.name,value:G.id,description:G.description})),onChange:G=>V(G)}))}})),B}function x(R){return R.list().filter(L=>!L.hideFromOverrides).map(L=>{let N=L.name;return L.category&&(N=[...L.category,L.name].join(" > ")),{label:N,value:L.id,description:L.description}})}function C({children:R}){const L=(0,l.of)(O);return o.createElement("div",{className:L},R)}function O(R){return(0,n.css)({borderTop:`1px solid ${R.colors.border.weak}`,padding:`${R.spacing(2)}`,display:"flex"})}},66211:(Q,I,e)=>{"use strict";e.d(I,{g5:()=>E,tN:()=>v,Zm:()=>p,Z4:()=>D});var n=e(2543),a=e(96540),o=e(60264),r=e(10354),i=e(32196),f=e(72724),d=e(40845);const l=({libraryPanel:S})=>{const T=(0,d.of)(m),M=S.useState(),A=M.$timeRange?.getTimeZone(),x=M._loadedPanel?.meta;return x?a.createElement("div",{className:T.info},a.createElement("div",{className:T.libraryPanelInfo},`Used on ${x.connectedDashboards} `,x.connectedDashboards===1?"dashboard":"dashboards"),a.createElement("div",{className:T.libraryPanelInfo},(0,f.LE)(x.updated,{format:"L",timeZone:A})," by",x.updatedBy.avatarUrl&&a.createElement("img",{className:T.userAvatar,src:x.updatedBy.avatarUrl,alt:`Avatar for ${x.updatedBy.name}`}),x.updatedBy.name)):null},m=S=>({info:(0,i.css)({lineHeight:1}),libraryPanelInfo:(0,i.css)({color:S.colors.text.secondary,fontSize:S.typography.bodySmall.fontSize}),userAvatar:(0,i.css)({borderRadius:S.shape.radius.circle,boxSizing:"content-box",width:"22px",height:"22px",paddingLeft:S.spacing(1),paddingRight:S.spacing(1)})});var s=e(6923),h=e(48192),u=e(74097);const b="Some data fields have this option pre-configured. Add a field override rule to override the pre-configured value.",g="An override rule exists for this property";function P(S,T,M){const A=[];if(M){for(const C of M)for(const O of C.fields)if((0,n.get)(O.config,S.path)!=null){A.push({type:"data",description:b,tooltip:b});break}}return T.overrides.some(C=>C.properties.some(O=>O.id===S.id))&&A.push({type:"rule",description:g,tooltip:g}),A}var c=e(54612);function y({data:S,replaceVariables:T,options:M,eventBus:A,instanceState:x}){const C=S?.series??[];return{data:C,replaceVariables:T,options:M,eventBus:A,getSuggestions:R=>(0,s.Hf)(C,R),instanceState:x}}function p(S){const{plugin:T,panel:M,onPanelOptionsChanged:A,onFieldConfigsChange:x,data:C,dashboard:O,instanceState:R}=S,L=M.getOptions(),N=M.fieldConfig,F={},K=y({data:C,replaceVariables:M.replaceVariables,options:L,eventBus:O.events,instanceState:R}),B=U=>{const W=(U&&U[0])??`${T.meta.name}`,V=F[W];return V||(F[W]=new h.C({title:W,id:W,sandboxId:T.meta.id}))},w={getValue:U=>(0,n.get)(L,U),onChange:(U,W)=>{const V=(0,c.Sf)(L,U,W);A(V)}};E(T.getPanelOptionsSupplier(),w,B,K);for(const U of T.fieldConfigRegistry.list()){if(U.isCustom){if(U.showIf&&!U.showIf(N.defaults.custom,C?.series))continue}else if(U.showIf&&!U.showIf(N.defaults,C?.series))continue;if(U.hideFromDefaults)continue;const W=B(U.category),V=U.editor,_=N.defaults,H=U.isCustom?_.custom?(0,n.get)(_.custom,U.path):void 0:(0,n.get)(_,U.path);U.getItemsCount&&(W.props.itemsCount=U.getItemsCount(H)),W.addItem(new u.v({title:U.name,description:U.description,overrides:P(U,N,C?.series),render:function(){const j=Y=>{x((0,c.EQ)(N,U.path,Y,U.isCustom))};return a.createElement(V,{value:H,onChange:j,item:U,context:K,id:U.id})}}))}return Object.values(F)}function v(S){const T=new h.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return T.addItem(new u.v({title:"Name",value:S,popularRank:1,render:function(){return a.createElement(r.p,{id:"LibraryPanelFrameName","data-testid":"library panel name input",defaultValue:S.state.name,onBlur:A=>S.setState({name:A.currentTarget.value})})}})).addItem(new u.v({title:"Information",render:function(){return a.createElement(l,{libraryPanel:S})}})),T}function D(S){const{plugin:T,panel:M,data:A,eventBus:x,instanceState:C}=S,O={},R=B=>{const w=B?.[0]??T.meta.name,U=O[w];return U||(O[w]=new h.C({title:w,id:w,sandboxId:T.meta.id}))},L=M.state.options,N={getValue:B=>(0,n.get)(L,B),onChange:(B,w)=>{const U=(0,c.Sf)(L,B,w);M.onOptionsChange(U)}},F=y({data:A,replaceVariables:M.interpolate,options:L,eventBus:x,instanceState:C});E(T.getPanelOptionsSupplier(),N,R,F);const K=M.state.fieldConfig;for(const B of T.fieldConfigRegistry.list()){const w=B.showIf&&(B.isCustom?!B.showIf(K.defaults.custom,A?.series):!B.showIf(K.defaults,A?.series));if(B.hideFromDefaults||w)continue;const U=R(B.category),W=B.editor,V=K.defaults,_=B.isCustom?V.custom?(0,n.get)(V.custom,B.path):void 0:(0,n.get)(V,B.path);B.getItemsCount&&(U.props.itemsCount=B.getItemsCount(_)),U.addItem(new u.v({title:B.name,description:B.description,overrides:P(B,K,A?.series),render:function(){const G=j=>{M.onFieldConfigChange((0,c.EQ)(K,B.path,j,B.isCustom),!0)};return a.createElement(W,{value:_,onChange:G,item:B,context:F,id:B.id})}}))}return Object.values(O)}function E(S,T,M,A,x){const C=new o.pv;S(C,A);for(const O of C.getItems()){if(O.showIf&&!O.showIf(A.options,A.data))continue;let R=x;if(R?O.category?.[0]?.length&&(R=R.getCategory(O.category[0])):R=M(O.category),(0,o.iF)(O)){const N=O.getNestedValueAccess(T),F=N.getContext?N.getContext(A):{...A,options:T.getValue(O.path)};E(O.getBuilder(),N,M,F,R);continue}const L=O.editor;R.addItem(new u.v({title:O.name,description:O.description,render:function(){return a.createElement(L,{value:T.getValue(O.path),onChange:F=>{T.onChange(O.path,F)},item:O,context:A,id:O.id})}}))}}},53466:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>v,GU:()=>h,MJ:()=>b,Ox:()=>g,eK:()=>c,fR:()=>P,kw:()=>y,wi:()=>d});var n=e(65307),a=e(39070),o=e(43127),r=e(33390),i=e(84423),f=e(32696);const d="grafana.dashboard.editor.ui",l={isPanelOptionsVisible:!0,rightPaneSize:400,topPaneSize:.45,mode:f.q5.Fill},m=()=>{const D=r.A.getObject(d,l);let E={...D};return typeof D.topPaneSize=="string"&&(E={...D,topPaneSize:parseFloat(D.topPaneSize)/100}),{getPanel:()=>new i.a9({}),getSourcePanel:()=>new i.a9({}),getData:()=>({state:a.Gu.NotStarted,series:[],timeRange:(0,o.E2)()}),initDone:!1,shouldDiscardChanges:!1,isOpen:!1,isVizPickerOpen:!1,tableViewEnabled:!1,ui:{...l,...E}}},s=(0,n.Z0)({name:"panelEditor",initialState:m(),reducers:{updateEditorInitState:(D,E)=>{D.getPanel=()=>E.payload.panel,D.getSourcePanel=()=>E.payload.sourcePanel,D.initDone=!0,D.isOpen=!0,D.shouldDiscardChanges=!1},setEditorPanelData:(D,E)=>{D.getData=()=>E.payload},setDiscardChanges:(D,E)=>{D.shouldDiscardChanges=E.payload},setPanelEditorUIState:(D,E)=>{D.ui={...D.ui,...E.payload},!D.ui.isPanelOptionsVisible&&D.isVizPickerOpen&&(D.isVizPickerOpen=!1)},toggleVizPicker:(D,E)=>{D.isVizPickerOpen=E.payload,D.isVizPickerOpen&&(D.ui.isPanelOptionsVisible=!0)},toggleTableView(D){D.tableViewEnabled=!D.tableViewEnabled},closeEditor:D=>{D.getPanel=()=>new i.a9({}),D.getSourcePanel=()=>new i.a9({}),D.isOpen=!1,D.initDone=!1,D.isVizPickerOpen=!1,D.tableViewEnabled=!1}}}),{updateEditorInitState:h,setEditorPanelData:u,setDiscardChanges:b,closeEditor:g,setPanelEditorUIState:P,toggleVizPicker:c,toggleTableView:y}=s.actions,v={panelEditor:s.reducer}},95689:(Q,I,e)=>{"use strict";e.d(I,{a:()=>d,e:()=>l});var n=e(41811),a=e(2913),o=e(16233),r=e(75471),i=e(57220),f=e(32696);const d=(0,n.A)((m,s)=>{const h=[];if(!s)return h;let u=f.M8.Visualize;if(s.meta.skipDataQuery)return[];s.meta.skipDataQuery||(u=f.M8.Query,h.push({id:f.M8.Query,text:"Query",icon:"database",active:!1}),h.push({id:f.M8.Transform,text:"Transform data",icon:"process",active:!1})),l(s)&&h.push({id:f.M8.Alert,text:"Alert",icon:"bell",active:!1});const b=h.find(g=>g.id===(m||u))??h[0];return b.active=!0,h});function l(m){const{unifiedAlertingEnabled:s=!1}=(0,a.zj)(),h=o.TP.hasPermission((0,r.Wd)(i.hY).read);if(!(s&&h))return!1;const b=m.meta.id==="graph",g=m.meta.id==="timeseries";return b||g}},32696:(Q,I,e)=>{"use strict";e.d(I,{M8:()=>n,Nt:()=>r,__:()=>f,q5:()=>a});var n=(d=>(d.Query="query",d.Transform="transform",d.Visualize="visualize",d.Alert="alert",d))(n||{}),a=(d=>(d[d.Fill=0]="Fill",d[d.Fit=1]="Fit",d[d.Exact=2]="Exact",d))(a||{}),o=(d=>(d[d.Off=0]="Off",d[d.Table=1]="Table",d))(o||{});const r=[{value:0,label:"Fill",description:"Use all available space"},{value:2,label:"Actual",description:"Make same size as on the dashboard"}],i=[{value:0,label:"Visualization",description:"Show using selected visualization"},{value:1,label:"Table",description:"Show raw data in table form"}];var f=(d=>(d[d.Visualizations=0]="Visualizations",d[d.LibraryPanels=1]="LibraryPanels",d[d.Suggestions=2]="Suggestions",d[d.Widgets=3]="Widgets",d))(f||{})},54612:(Q,I,e)=>{"use strict";e.d(I,{$:()=>f,A:()=>i,EQ:()=>d,Sf:()=>l});var n=e(2543),a=e.n(n),o=e(15054),r=e(32696);function i(m,s,h,u){if(m===r.q5.Fill)return{width:s,height:h};const b=8*6,c=(window.innerWidth-60-o.dU*4)/o.cV*u.gridPos.w,y=o.sD*u.gridPos.h+b,p=Math.min(s/c,h/y);return c<=s&&y<=h?{width:c,height:y}:{width:c*p,height:y*p}}function f(m){return m?.meta.skipDataQuery===!1}const d=(m,s,h,u)=>{let b={...m.defaults};const g=h==null||h==="";return u?b.custom?g?b.custom=(0,n.omit)(b.custom,s):b.custom=l(b.custom,s,h):g||(b.custom=l(b.custom,s,h)):g?b=(0,n.omit)(b,s):b=l(b,s,h),{...m,defaults:b}};function l(m,s,h){const u=Array.isArray(s)?s:s.split("."),b=u.shift();if(b.endsWith("]")){const P=b.lastIndexOf("["),c=+b.substring(P+1,b.length-1),y=b.substring(0,P);let p=m[y];const v=Array.isArray(p)?[...p]:[];return u.length&&(p=v[c],(p==null||typeof p!="object")&&(p={}),h=l(p,u,h)),v[c]=h,{...m,[y]:v}}if(!u.length)return{...m,[b]:h};let g=m[b];return(g==null||typeof g!="object")&&(g={}),{...m,[b]:l(g,u,h)}}},31771:(Q,I,e)=>{"use strict";e.d(I,{P:()=>m,Q:()=>s});var n=e(32196),a=e(96540),o=e(40845);const r="https://grafana.com/?src=grafananet&cnt=public-dashboards",i="public/img/grafana_text_logo_light.svg",f="public/img/grafana_text_logo_dark.svg",d="grafana-logo",l=u=>{const b=(0,o.$j)(),g=(0,o.of)(h),{footerHide:P,footerText:c,footerLink:y,footerLogo:p,headerLogoHide:v}=u||{footerHide:!1,footerText:"Powered by",footerLogo:d,footerLink:r,headerLogoHide:!1};return{footerHide:P,footerText:a.createElement("span",{className:g.text},c),footerLogo:p===d?b.isDark?i:f:p,footerLink:y,headerLogoHide:v}};let m=()=>l();function s(u){m=()=>l(u)}const h=u=>({text:(0,n.css)({color:u.colors.text.secondary,fontSize:u.typography.body.fontSize})})},92378:(Q,I,e)=>{"use strict";e.d(I,{G:()=>f,U:()=>d});var n=e(96540),a=e(16401),o=e(21594),r=e(31678),i=e(87421);const f=({repeat:l,onChange:m,id:s})=>{const h=(0,r.useSelector)(g=>(0,i.SS)((0,i.y7)(g),g)),u=(0,n.useMemo)(()=>{const g=h.map(P=>({label:P.name,value:P.name}));return g.length===0&&g.unshift({label:"No template variables found",value:null}),g.unshift({label:"Disable repeating",value:null}),g},[h]),b=(0,n.useCallback)(g=>m(g.value),[m]);return n.createElement(o.l6,{inputId:s,value:l,onChange:b,options:u})},d=({parent:l,repeat:m,id:s,onChange:h})=>{const b=(0,n.useMemo)(()=>a.jh.getVariables(l),[l]).useState().variables,g=(0,n.useMemo)(()=>{const c=b.map(y=>({label:y.state.name,value:y.state.name}));return c.length===0&&c.unshift({label:"No template variables found",value:null}),c.unshift({label:"Disable repeating",value:null}),c},[b]),P=(0,n.useCallback)(c=>h(c.value),[h]);return n.createElement(o.l6,{inputId:s,value:m,onChange:P,options:g})}},78050:(Q,I,e)=>{"use strict";e.d(I,{C:()=>d,m:()=>l});var n=e(96540),a=e(13544),o=e(14110),r=e(71678),i=e(55852),f=e(70497);const d=({dashboard:m,onSaveSuccess:s,size:h})=>n.createElement(r.$s,null,({showModal:u,hideModal:b})=>n.createElement(i.$n,{size:h,onClick:()=>{u(f.$,{dashboard:m,onSaveSuccess:s,onDismiss:b})},"aria-label":a.Tp.pages.Dashboard.Settings.General.saveDashBoard},"Save dashboard")),l=({dashboard:m,onClick:s,onSaveSuccess:h,variant:u,size:b})=>n.createElement(r.$s,null,({showModal:g,hideModal:P})=>n.createElement(i.$n,{size:b,onClick:()=>{(0,o.rR)("grafana_dashboard_save_as_clicked"),s?.(),g(f.$,{dashboard:m,onSaveSuccess:h,onDismiss:P,isCopy:!0})},variant:u,"aria-label":a.Tp.pages.Dashboard.Settings.General.saveAsDashBoard},"Save as"))},54943:(Q,I,e)=>{"use strict";e.d(I,{l:()=>l});var n=e(96540),a=e(16817),o=e(67061),r=e(62930),i=e(90613),f=e(19626),d=e(22764);const l=({diff:m,oldValue:s,newValue:h,hasFolderChanges:u,oldFolder:b,newFolder:g})=>{const P=(0,a.A)(async()=>{const y=JSON.stringify(s??{},null,2),p=JSON.stringify(h??{},null,2);let v;const D=[];let E=0;if(m)for(const[S,T]of Object.entries(m)){const M=n.createElement(f.D,{diffs:T,key:S,title:S});S==="schemaVersion"?v=M:D.push(M),E+=T.length}return{schemaChange:v,diffs:D,count:E,showDiffs:E<15,jsonView:n.createElement(d.M,{oldValue:y,newValue:p})}},[m,s,h]),{value:c}=P;return n.createElement(o.B,{direction:"column",gap:1},u&&n.createElement(f.D,{diffs:[{op:"replace",value:g,originalValue:b,path:[],startLineNumber:0,endLineNumber:0}],key:"folder",title:"folder"}),(!c||!s)&&n.createElement(r.y,null),c&&c.count>=1?n.createElement(n.Fragment,null,c&&c.schemaChange&&c.schemaChange,c&&c.showDiffs&&c.diffs,n.createElement(i.a,{paddingTop:1},n.createElement("h4",null,"Full JSON diff"),c.jsonView)):n.createElement(i.a,{paddingTop:1},"No changes in the dashboard JSON"))}},70497:(Q,I,e)=>{"use strict";e.d(I,{$:()=>Me});var n=e(96540),a=e(17172),o=e(32264),r=e(87978),i=e(63021),f=e(40675),d=e(56596),l=e(32196),m=e(16817),s=e(40845),h=e(42418),u=e(27677);function b({dashboard:$e}){const ke=(0,s.of)(g),{loading:Ze,value:ot,error:xt}=(0,m.A)(async()=>{const ft=$e.getSaveModelCloneOld();return u.IB.validateDashboard(ft).catch(re=>{if(re.status>=500)throw re;return re.data})},[$e]);let ct;if(Ze)ct=n.createElement(h.F,{severity:"info",title:"Checking dashboard validity"});else if(ot)ot.isValid||(ct=n.createElement(h.F,{severity:"warning",title:"Dashboard failed schema validation"},n.createElement("p",null,"Validation is provided for development purposes and should be safe to ignore. If you are a Grafana developer, consider checking and updating the dashboard schema"),n.createElement("div",{className:ke.error},ot.message)));else{const ft=xt?.message??"Unknown error";ct=n.createElement(h.F,{severity:"info",title:"Error checking dashboard validity"},n.createElement("p",{className:ke.error},ft))}return ct?n.createElement("div",{className:ke.root},ct):null}const g=$e=>({root:(0,l.css)({marginTop:$e.spacing(1)}),error:(0,l.css)({fontFamily:$e.typography.fontFamilyMonospace,whiteSpace:"pre-wrap",overflowX:"auto",maxWidth:"100%"})}),P=b;var c=e(54943),y=e(96374),p=e(37390),v=e(55852),D=e(78050),E=e(41053),S=e(71733),T=e(14110),M=e(12131),A=e(28138),x=e(3169),C=e(91219),O=e(55314),R=e(31678),L=e(28444),N=e(36974);const F=async($e,ke,Ze,ot)=>{const xt=await ot({dashboard:$e,folderUid:ke.folderUid??Ze.meta.folderUid??$e.meta?.folderUid,message:ke.message,overwrite:ke.overwrite});if("error"in xt)throw xt.error;return xt.data},K=($e=!1)=>{const ke=(0,R.useDispatch)(),Ze=(0,x._2)(),[ot]=(0,O.e8)(),[xt,ct]=(0,E.A)(async(ft,Le,re)=>{try{const X=await F(ft,Le,re,ot);re.version=X.version,ft.version=X.version,re.clearUnsavedChanges(ft,Le),A.A.publish(new L.Eu),Ze.success("Dashboard saved"),(0,N.ko)(X.uid),$e?(0,T.rR)("grafana_dashboard_copied",{name:re.title,url:X.url}):(0,T.rR)(`grafana_dashboard_${re.id?"saved":"created"}`,{name:re.title,url:X.url});const le=M.Ny.getLocation().pathname,be=S.I.stripBaseFromUrl(X.url);return be!==le&&setTimeout(()=>M.Ny.replace(be)),re.meta.isStarred&&ke((0,C.TU)({id:re.uid,title:re.title,url:be})),X}catch(X){throw X instanceof Error&&Ze.error(X.message??"Error saving dashboard"),X}},[ke,Ze]);return{state:xt,onDashboardSave:ct}},B=({dashboard:$e,dashboardSaveModel:ke,error:Ze,onDismiss:ot,setErrorIsHandled:xt})=>{const{onDashboardSave:ct}=K();return n.createElement(n.Fragment,null,Ze.data&&Ze.data.status==="version-mismatch"&&n.createElement(y.u,{isOpen:!0,title:"Conflict",body:n.createElement("div",null,"Someone else has updated this dashboard ",n.createElement("br",null)," ",n.createElement("small",null,"Would you still like to save this dashboard?")),confirmText:"Save and overwrite",onConfirm:async()=>{await ct(ke,{overwrite:!0},$e),ot()},onDismiss:ot}),Ze.data&&Ze.data.status==="name-exists"&&n.createElement(y.u,{isOpen:!0,title:"Conflict",body:n.createElement("div",null,"A dashboard with the same name in selected folder already exists. ",n.createElement("br",null),n.createElement("small",null,"Would you still like to save this dashboard?")),confirmText:"Save and overwrite",onConfirm:async()=>{await ct(ke,{overwrite:!0},$e),ot()},onDismiss:ot}),Ze.data&&Ze.data.status==="plugin-dashboard"&&n.createElement(w,{dashboard:$e,onDismiss:()=>{xt(!0),ot()}}))},w=({onDismiss:$e,dashboard:ke})=>{const{onDashboardSave:Ze}=K(),ot=(0,s.of)(W);return n.createElement(p.a,{className:ot.modal,title:"Plugin dashboard",icon:"copy",isOpen:!0,onDismiss:$e},n.createElement("div",{className:ot.modalText},"Your changes will be lost when you update the plugin.",n.createElement("br",null),n.createElement("small",null,"Use ",n.createElement("strong",null,"Save As")," to create custom version.")),n.createElement(p.a.ButtonRow,null,n.createElement(v.$n,{variant:"secondary",onClick:$e,fill:"outline"},"Cancel"),n.createElement(D.m,{onClick:$e,dashboard:ke,onSaveSuccess:$e}),n.createElement(v.$n,{variant:"destructive",onClick:async()=>{await Ze(ke.getSaveModelClone(),{overwrite:!0},ke),$e()}},"Overwrite")))},U=$e=>{switch($e){case"version-mismatch":case"name-exists":case"plugin-dashboard":return!0;default:return!1}},W=$e=>({modal:(0,l.css)({width:"500px"}),modalText:(0,l.css)({fontSize:$e.typography.h4.fontSize,color:$e.colors.text.primary,marginBottom:$e.spacing(4),paddingTop:$e.spacing(2)}),modalButtonRow:(0,l.css)({marginBottom:"14px","a, button":{marginRight:$e.spacing(2)}})});var V=e(51253),_=e(16504),H=e(88575),G=e(67061),j=e(60029),Y=e(10354),oe=e(21744),se=e(15292),ne=e(36607),ee=e(71500),Z=e(81394),z=e(27966);const q=$e=>{const ke=$e.getSaveModelClone();return ke.id=null,ke.uid="",ke.title+=" Copy",ke.editable=!0,$e.id>0&&ke.panels&&ke.panels.forEach(Ze=>{Ze.type==="graph"&&Ze.alert&&delete Ze.thresholds,delete Ze.alert}),ke},ie=({dashboard:$e,isLoading:ke,isNew:Ze,onSubmit:ot,onCancel:xt,onSuccess:ct})=>{const ft={title:Ze?$e.title:`${$e.title} Copy`,description:$e.description,$folder:{uid:$e.meta.folderUid,title:$e.meta.folderTitle},copyTags:!1},Le=re=>async X=>{if(X&&X===re().$folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await ee.P.validateNewDashboardName(re().$folder.uid??"general",X),!0}catch(le){return le instanceof Error?le.message:"Dashboard name is invalid"}};return n.createElement(V.l,{defaultValues:ft,onSubmit:async re=>{if(!ot)return;const X=q($e);X.title=re.title,X.description=re.description,!Ze&&!re.copyTags&&(X.tags=[]),(await ot(X,{folderUid:re.$folder.uid},$e)).status==="success"&&ct()}},({register:re,control:X,errors:le,getValues:be})=>n.createElement(n.Fragment,null,n.createElement(_.e,{render:({field:{ref:De,...Te}})=>n.createElement(H.D,{label:n.createElement(G.B,{justifyContent:"space-between"},n.createElement(j.J,{htmlFor:"title"},"Title"),o.$.featureToggles.dashgpt&&Ze&&n.createElement(z.Z,{onGenerate:we=>Te.onChange(we)})),invalid:!!le.title,error:le.title?.message},n.createElement(Y.p,{...Te,onChange:we=>Te.onChange(we.target.value),"aria-label":"Save dashboard title field",autoFocus:!0})),control:X,name:"title",rules:{validate:Le(be)}}),n.createElement(_.e,{render:({field:{ref:De,...Te}})=>n.createElement(H.D,{label:n.createElement(G.B,{justifyContent:"space-between"},n.createElement(j.J,{htmlFor:"description"},"Description"),o.$.featureToggles.dashgpt&&Ze&&n.createElement(Z.V,{onGenerate:we=>Te.onChange(we)})),invalid:!!le.description,error:le.description?.message},n.createElement(oe.f,{...Te,onChange:we=>Te.onChange(we.target.value),"aria-label":"Save dashboard description field",autoFocus:!0})),control:X,name:"description"}),n.createElement(H.D,{label:"Folder"},n.createElement(_.e,{render:({field:{ref:De,...Te}})=>n.createElement(ne.d,{...Te,onChange:(we,Ke)=>Te.onChange({uid:we,title:Ke}),value:Te.value?.uid,initialTitle:$e.meta.folderTitle,dashboardId:$e.id,enableCreateNew:!0}),control:X,name:"$folder"})),!Ze&&n.createElement(H.D,{label:"Copy tags"},n.createElement(se.d,{...re("copyTags")})),n.createElement(G.B,null,n.createElement(v.$n,{type:"button",variant:"secondary",onClick:xt,fill:"outline"},"Cancel"),n.createElement(v.$n,{disabled:ke,type:"submit","aria-label":"Save dashboard button"},ke?"Saving...":"Save"))))};var de=e(13544),ue=e(10880),fe=e(10740),Se=e(57725),he=e(3363);const ce=["You are an expert in Grafana Dashboards","Your goal is to write a description of the changes for a dashboard to display to the user","You will be given human-readable diffs with most irrelevant lines filtered out"].join(`.
`),me=["Respond only with the diff description, which is meant to be loaded directly into the application for the user.",'If there are no substantial user or migration changes, the correct description is "Minor changes only"',`If there are too many changes of either kind, and those changes have a message saying 'too long', the correct response for that section is "Too many changes to auto-summarize"`,"In a diff, lines beginning with - are removed, and lines beginning with + are added.","Lines with neither + nor - are included for context. Be careful not to mark them as added or removed if they do not start with + or -.","If a line is changed, it will show a previous version removed and a new version added","When referring to panel changes, use the panel title","When using panel title, wrap it with double quotes","When the panel changes position, just mention that the panel has changed position","When an entire panel is added or removed, use the panel title and only say it was added or removed and disregard the rest of the changes for that panel","Group together similar changes into one line when multiple panels are affected","Refer to templating elements as variables","Try to make the response as short as possible"].join(`.
`),pe=({dashboard:$e,onGenerate:ke,disabled:Ze})=>{const ot=(0,n.useCallback)(()=>ye($e),[$e]);return n.createElement(fe.n,{messages:ot,onGenerate:ke,temperature:0,model:"gpt-3.5-turbo-16k",eventTrackingSrc:Se.ec.dashboardChanges,toggleTipTitle:"Improve your dashboard changes summary",disabled:Ze})};function ye($e){let{userChanges:ke,migrationChanges:Ze}=(0,he.Yy)($e);return ke.length>8e3&&(ke="User changes were too long, fill in the user changes section with 'User changes too long to auto-summarize'"),Ze.split(`
`).length<10?Ze="No significant migration changes":Ze.length>8e3&&(Ze="Migration changes were too long, fill in the migration changes section with 'Migration changes too long to auto-summarize'"),[{content:ce,role:he.Xh.system},{content:`Summarize the following user changes diff under "User changes":
${ke}`,role:he.Xh.system},{content:`Be sure to only include substantial user changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Do not include "User Changes" section if there are no substantial user changes to report.`,role:he.Xh.system},{content:`Summarize the following migration changes diff under "Migration changes":
${Ze}`,role:he.Xh.system},{content:`Be sure to only include substantial migration changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Ignore any threshold step changes or templating list changes.
Ignore other changes and do not include them in the summary. Do not include "Migration Changes" section if there are no substantial migration changes to report.
If there are substantial migration changes, add "Some autogenerated changes are included to update the dashboard to the latest valid schema version" at the end.`,role:he.Xh.system},{content:me,role:he.Xh.system}]}const Pe=({dashboard:$e,isLoading:ke,saveModel:Ze,options:ot,onSubmit:xt,onCancel:ct,onSuccess:ft,onOptionsChange:Le})=>{const re=(0,n.useMemo)(()=>$e.hasTimeChanged(),[$e]),X=(0,n.useMemo)(()=>$e.hasVariablesChanged(),[$e]),[le,be]=(0,n.useState)(!1),[De,Te]=(0,n.useState)(ot.message),we=(0,s.of)(Ie);return n.createElement("form",{onSubmit:async Ke=>{if(Ke.preventDefault(),!xt)return;be(!0),ot={...ot,message:De},(await xt(Ze.clone,ot,$e)).status==="success"?ft():be(!1)},style:{maxWidth:600}},n.createElement(G.B,{gap:2,direction:"column",alignItems:"flex-start"},re&&n.createElement(ue.S,{checked:!!ot.saveTimerange,onChange:()=>Le({...ot,saveTimerange:!ot.saveTimerange}),label:"Save current time range as dashboard default","aria-label":de.Tp.pages.SaveDashboardModal.saveTimerange}),X&&n.createElement(ue.S,{checked:!!ot.saveVariables,onChange:()=>Le({...ot,saveVariables:!ot.saveVariables}),label:"Save current variable values as dashboard default","aria-label":de.Tp.pages.SaveDashboardModal.saveVariables}),n.createElement("div",{className:we.message},o.$.featureToggles.aiGeneratedDashboardChanges&&n.createElement(pe,{dashboard:$e,onGenerate:Ke=>{Le({...ot,message:Ke}),Te(Ke)},disabled:!Ze.hasChanges}),n.createElement(oe.f,{"aria-label":"message",value:De,onChange:Ke=>{Le({...ot,message:Ke.currentTarget.value}),Te(Ke.currentTarget.value)},placeholder:"Add a note to describe your changes.",autoFocus:!0,rows:5})),n.createElement(G.B,{alignItems:"center"},n.createElement(v.$n,{variant:"secondary",onClick:ct,fill:"outline"},"Cancel"),n.createElement(v.$n,{type:"submit",disabled:!Ze.hasChanges||ke,icon:le?"spinner":void 0,"aria-label":de.Tp.pages.SaveDashboardModal.save},ke?"Saving...":"Save"),!Ze.hasChanges&&n.createElement("div",null,"No changes to save"))))};function Ie($e){return{message:(0,l.css)({display:"flex",alignItems:"end",flexDirection:"column",width:"100%"})}}var Oe=e(4213),Ne=e(66864),We=e(10534);const Ae=({dashboard:$e,onCancel:ke})=>{const[Ze,ot]=(0,n.useState)(()=>{const ct=$e.getSaveModelClone();return delete ct.id,JSON.stringify(ct,null,2)}),xt=(0,n.useCallback)(()=>{const ct=new Blob([Ze],{type:"application/json;charset=utf-8"});(0,Oe.saveAs)(ct,$e.title+"-"+new Date().getTime()+".json")},[$e.title,Ze]);return n.createElement(n.Fragment,null,n.createElement(G.B,{direction:"column",gap:2},n.createElement("div",null,"This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",n.createElement("br",null),n.createElement("i",null,"See"," ",n.createElement("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer"},"documentation")," ","for more information about provisioning."),n.createElement("br",null)," ",n.createElement("br",null),n.createElement("strong",null,"File path: ")," ",$e.meta.provisionedExternalId),n.createElement(oe.f,{spellCheck:!1,value:Ze,onChange:ct=>{ot(ct.currentTarget.value)},className:Ue.json}),n.createElement(Ne.Gy,null,n.createElement(v.$n,{variant:"secondary",onClick:ke,fill:"outline"},"Cancel"),n.createElement(We.b,{icon:"copy",getText:()=>Ze},"Copy JSON to clipboard"),n.createElement(v.$n,{type:"submit",onClick:xt},"Save JSON to file"))))},Ue={json:(0,l.css)({height:"400px",width:"100%",overflow:"auto",resize:"none",fontFamily:"monospace"})},Me=({dashboard:$e,onDismiss:ke,onSaveSuccess:Ze,isCopy:ot})=>{const[xt,ct]=(0,n.useState)({}),ft=$e.getOriginalDashboard(),Le=$e.meta.provisioned,re=$e.version===0,X=!!$e.meta.hasUnsavedFolderChange,[le,be]=(0,n.useState)(!1),De=(0,n.useMemo)(()=>{const St=$e.getSaveModelClone({saveTimerange:!!xt.saveTimerange,saveVariables:!!xt.saveVariables});if(!ft)return{clone:St,diff:{},diffCount:0,hasChanges:!1};const Je=(0,d.G4)(ft,St);let rt=0;for(const Rt of Object.values(Je))rt+=Rt.length;return{clone:St,diff:Je,diffCount:rt,hasChanges:(rt>0||X)&&!re}},[$e,ft,xt,re,X]),[Te,we]=(0,n.useState)(!1),{state:Ke,onDashboardSave:Ve}=K(ot),ht=Ze?()=>{ke(),Ze()}:ke,gt=()=>Te?n.createElement(c.l,{diff:De.diff,oldValue:ft,newValue:De.clone}):re||ot?n.createElement(ie,{dashboard:$e,isLoading:Ke.loading,onCancel:ke,onSuccess:ht,onSubmit:Ve,isNew:re}):Le?n.createElement(Ae,{dashboard:$e,onCancel:ke,onSuccess:ht}):n.createElement(Pe,{dashboard:$e,isLoading:Ke.loading,saveModel:De,onCancel:ke,onSuccess:ht,onSubmit:Ve,options:xt,onOptionsChange:ct});if(Ke.error&&!le&&(0,a.NF)(Ke.error)&&U(Ke.error.data.status))return n.createElement(B,{error:Ke.error,dashboard:$e,dashboardSaveModel:De.clone,onDismiss:ke,setErrorIsHandled:be});let bt="Save dashboard";return ot?bt="Save dashboard copy":Le&&(bt="Provisioned dashboard"),n.createElement(r._,{title:bt,onClose:ke,subtitle:$e.title,tabs:n.createElement(i.U,null,n.createElement(f.o,{label:"Details",active:!Te,onChangeTab:()=>we(!1)}),De.hasChanges&&n.createElement(f.o,{label:"Changes",active:Te,onChangeTab:()=>we(!0),counter:De.diffCount}))},gt(),o.$.featureToggles.showDashboardValidationWarnings&&n.createElement(P,{dashboard:$e}))}},35280:(Q,I,e)=>{"use strict";e.d(I,{D:()=>b});var n=e(96540),a=e(94701),o=e(14110),r=e(88575),i=e(15292),f=e(21744),d=e(37390),l=e(10534),m=e(8484),s=e(7758),h=e(87895),u=e(22699);function b({panel:g,dashboard:P,range:c,buildIframe:y=u.CF}){const[p,v]=(0,n.useState)(!0),[D,E]=(0,n.useState)("current"),[S,T]=(0,n.useState)("");(0,a.A)(()=>{(0,o.rR)("grafana_dashboards_embed_share_viewed",{shareResource:(0,u.hD)(g)})}),(0,n.useEffect)(()=>{const R=y(p,P.uid,D,g,c);T(R)},[D,p,P,g,c,y]);const M=R=>{T(R.currentTarget.value)},A=()=>{v(R=>!R)},x=R=>{E(R)},O=P.time.to==="now"?(0,m.t)("share-modal.embed.time-range-description","Transforms the current relative time range to an absolute time range"):"";return n.createElement(n.Fragment,null,n.createElement("p",{className:"share-modal-info-text"},n.createElement(m.x6,{i18nKey:"share-modal.embed.info"},"Generate HTML for embedding an iframe with this panel.")),n.createElement(r.D,{label:(0,m.t)("share-modal.embed.time-range","Current time range"),description:O},n.createElement(i.d,{id:"share-current-time-range",value:p,onChange:A})),n.createElement(h.w,{selectedTheme:D,onChange:x}),n.createElement(r.D,{label:(0,m.t)("share-modal.embed.html","Embed HTML"),description:(0,m.t)("share-modal.embed.html-description","The HTML code below can be pasted and included in another web page. Unless anonymous access is enabled, the user viewing that page need to be signed into Grafana for the graph to load.")},n.createElement(f.f,{"data-testid":"share-embed-html",id:"share-panel-embed-embed-html-textarea",rows:5,value:S,onChange:M})),n.createElement(d.a.ButtonRow,null,n.createElement(l.b,{icon:"copy",variant:"primary",getText:()=>S,onClipboardCopy:()=>{s.c.embedSnippetCopy({currentTimeRange:p,theme:D,shareResource:(0,u.hD)(g)})}},n.createElement(m.x6,{i18nKey:"share-modal.embed.copy"},"Copy to clipboard"))))}},86394:(Q,I,e)=>{"use strict";e.d(I,{j:()=>f});var n=e(96540),a=e(14110),o=e(8484),r=e(96227),i=e(22699);const f=({panel:d,initialFolderUid:l,onCreateLibraryPanel:m,onDismiss:s})=>((0,n.useEffect)(()=>{(0,a.rR)("grafana_dashboards_library_panel_share_viewed",{shareResource:(0,i.hD)(d)})},[d]),d?n.createElement(n.Fragment,null,n.createElement("p",{className:"share-modal-info-text"},n.createElement(o.x6,{i18nKey:"share-modal.library.info"},"Create library panel.")),n.createElement(r.b,{panel:d,initialFolderUid:l,onCreateLibraryPanel:m,onDismiss:s})):null)},7686:(Q,I,e)=>{"use strict";e.d(I,{Zy:()=>z,mJ:()=>oe});var n=e(96540),a=e(25897),o=e(37390),r=e(40980),i=e(40845),f=e(2913),d=e(10096),l=e(8484),m=e(4785),s=e(72254),h=e(7758),u=e(82792),b=e(35280),g=e(4213),P=e(88575),c=e(15292),y=e(55852),p=e(15858),v=e(28444),D=e(70713),E=e(32372),S=e(10534);function T({json:q,onDismiss:ie}){const de=(0,n.useCallback)(()=>q,[q]);return n.createElement(o.a,{title:"JSON",onDismiss:ie,onClickBackdrop:ie,isOpen:!0},n.createElement(D.Ay,{disableHeight:!0},({width:ue})=>n.createElement(E.B,{value:q,language:"json",showMiniMap:!1,height:"500px",width:ue})),n.createElement(o.a.ButtonRow,null,n.createElement(S.b,{icon:"copy",getText:de,onClipboardCopy:()=>{h.c.exportCopyJsonClicked()}},n.createElement(l.x6,{i18nKey:"share-modal.view-json.copy-button"},"Copy to Clipboard"))))}var M=e(22699);class A extends n.PureComponent{constructor(ie){super(ie),this.onShareExternallyChange=()=>{this.setState({shareExternally:!this.state.shareExternally})},this.onSaveAsFile=()=>{const{dashboard:de}=this.props,{shareExternally:ue}=this.state;h.c.exportSaveJsonClicked({externally:ue,shareResource:(0,M.hD)(this.props.panel)}),ue?this.exporter.makeExportable(de).then(fe=>{this.openSaveAsDialog(fe)}):this.openSaveAsDialog(de.getSaveModelClone())},this.onViewJson=()=>{const{dashboard:de}=this.props,{shareExternally:ue}=this.state;h.c.exportViewJsonClicked({externally:ue,shareResource:(0,M.hD)(this.props.panel)}),ue?this.exporter.makeExportable(de).then(fe=>{this.openJsonModal(fe)}):this.openJsonModal(de.getSaveModelClone())},this.openSaveAsDialog=de=>{const ue=JSON.stringify(de,null,2),fe=new Blob([ue],{type:"application/json;charset=utf-8"}),Se=new Date().getTime();(0,g.saveAs)(fe,`${de.title}-${Se}.json`)},this.openJsonModal=de=>{d.lE.publish(new v.S8({props:{json:JSON.stringify(de,null,2)},component:T})),this.props.onDismiss?.()},this.state={shareExternally:!1},this.exporter=new p.M}render(){const{onDismiss:ie}=this.props,{shareExternally:de}=this.state,ue=(0,l.t)("share-modal.export.share-externally-label","Export for sharing externally");return n.createElement(n.Fragment,null,n.createElement("p",{className:"share-modal-info-text"},n.createElement(l.x6,{i18nKey:"share-modal.export.info-text"},"Export this dashboard.")),n.createElement(P.D,{label:ue},n.createElement(c.d,{id:"share-externally-toggle",value:de,onChange:this.onShareExternallyChange})),n.createElement(o.a.ButtonRow,null,n.createElement(y.$n,{variant:"secondary",onClick:ie,fill:"outline"},n.createElement(l.x6,{i18nKey:"share-modal.export.cancel-button"},"Cancel")),n.createElement(y.$n,{variant:"secondary",onClick:this.onViewJson},n.createElement(l.x6,{i18nKey:"share-modal.export.view-button"},"View JSON")),n.createElement(y.$n,{variant:"primary",onClick:this.onSaveAsFile},n.createElement(l.x6,{i18nKey:"share-modal.export.save-button"},"Save to file"))))}}var x=e(86394),C=e(13544),O=e(84167),R=e(10354),L=e(72109),N=e(42418),F=e(87895);class K extends n.PureComponent{constructor(ie){super(ie),this.buildUrl=async()=>{const{panel:de,dashboard:ue}=this.props,{useCurrentTimeRange:fe,useShortUrl:Se,selectedTheme:he}=this.state,ce=await(0,M.Xe)(fe,he,de,Se),me=(0,M.Lb)(fe,ue.uid,he,de);this.setState({shareUrl:ce,imageUrl:me})},this.onUseCurrentTimeRangeChange=()=>{this.setState({useCurrentTimeRange:!this.state.useCurrentTimeRange})},this.onUrlShorten=()=>{this.setState({useShortUrl:!this.state.useShortUrl})},this.onThemeChange=de=>{this.setState({selectedTheme:de})},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{h.c.shareLinkCopied({currentTimeRange:this.state.useCurrentTimeRange,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,M.hD)(this.props.panel)})},this.state={useCurrentTimeRange:!0,useShortUrl:!1,selectedTheme:"current",shareUrl:"",imageUrl:""}}componentDidMount(){this.buildUrl()}componentDidUpdate(ie,de){const{useCurrentTimeRange:ue,useShortUrl:fe,selectedTheme:Se}=this.state;(de.useCurrentTimeRange!==ue||de.selectedTheme!==Se||de.useShortUrl!==fe)&&this.buildUrl()}render(){const{panel:ie,dashboard:de}=this.props,ue=de?de.time.to==="now":!1,{useCurrentTimeRange:fe,useShortUrl:Se,selectedTheme:he,shareUrl:ce,imageUrl:me}=this.state,pe=C.Tp.pages.SharePanelModal,ye=!!de.id,Pe=(0,l.t)("share-modal.link.time-range-label","Lock time range"),Ie=(0,l.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),Oe=(0,l.t)("share-modal.link.shorten-url","Shorten URL"),Ne=(0,l.t)("share-modal.link.link-url","Link URL");return n.createElement(n.Fragment,null,n.createElement("p",{className:"share-modal-info-text"},n.createElement(l.x6,{i18nKey:"share-modal.link.info-text"},"Create a direct link to this dashboard or panel, customized with the options below.")),n.createElement(O.n,null,n.createElement(P.D,{label:Pe,description:ue?Ie:""},n.createElement(c.d,{id:"share-current-time-range",value:fe,onChange:this.onUseCurrentTimeRangeChange})),n.createElement(F.w,{selectedTheme:he,onChange:this.onThemeChange}),n.createElement(P.D,{label:Oe},n.createElement(c.d,{id:"share-shorten-url",value:Se,onChange:this.onUrlShorten})),n.createElement(P.D,{label:Ne},n.createElement(R.p,{id:"link-url-input",value:ce,readOnly:!0,addonAfter:n.createElement(S.b,{icon:"copy",variant:"primary",getText:this.getShareUrl,onClipboardCopy:this.onCopy},n.createElement(l.x6,{i18nKey:"share-modal.link.copy-link-button"},"Copy"))}))),ie&&f.Ay.rendererAvailable&&n.createElement(n.Fragment,null,ye&&n.createElement(L.Y,{href:me,external:!0,icon:"camera","aria-label":pe.linkToRenderedImage},(0,l.t)("share-modal.link.rendered-image","Direct link rendered image")),!ye&&n.createElement(N.F,{severity:"info",title:(0,l.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0},n.createElement(l.x6,{i18nKey:"share-modal.link.save-dashboard"},"To render a panel image, you must save the dashboard first."))),ie&&!f.Ay.rendererAvailable&&n.createElement(N.F,{severity:"info",title:(0,l.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0},n.createElement(l.x6,{i18nKey:"share-modal.link.render-instructions"},"To render a panel image, you must install the"," ",n.createElement(L.Y,{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",external:!0},"Grafana image renderer plugin"),". Please contact your Grafana administrator to install the plugin.")))}}var B=e(92041),w=e(12470),U=e(17172),W=e(21594),V=e(62930),_=e(74856),H=e(69064);class G extends n.PureComponent{constructor(ie){super(ie),this.createSnapshot=de=>()=>{const{timeoutSeconds:ue}=this.state;this.dashboard.snapshot={timestamp:new Date},this.setState({isLoading:!0}),this.dashboard.startRefresh(),setTimeout(()=>{this.saveSnapshot(this.dashboard,de)},ue*1e3)},this.saveSnapshot=async(de,ue)=>{const{snapshotExpires:fe,timeoutSeconds:Se}=this.state,he=this.dashboard.getSaveModelCloneOld();this.scrubDashboard(he);const ce={dashboard:he,name:he.title,expires:fe,external:ue};try{const me=await(0,H.s)().create(ce);this.setState({deleteUrl:me.deleteUrl,snapshotUrl:me.url,step:2})}finally{ue?h.c.publishSnapshotClicked({expires:fe,timeout:Se,shareResource:(0,M.hD)(this.props.panel)}):h.c.publishSnapshotLocalClicked({expires:fe,timeout:Se,shareResource:(0,M.hD)(this.props.panel)}),this.setState({isLoading:!1})}},this.scrubDashboard=de=>{const{panel:ue}=this.props,{snapshotName:fe}=this.state;de.title=fe,de.time=(0,_.jG)().timeRange(),de.links=[],de.panels.forEach(he=>{he.targets=[],he.links=[],he.datasource=null});const Se=de.annotations.list.filter(he=>he.enable);if(de.annotations.list=Se.map(he=>({name:he.name,enable:he.enable,iconColor:he.iconColor,snapshotData:he.snapshotData,type:he.type,builtIn:he.builtIn,hide:he.hide})),de.getVariables().forEach(he=>{"query"in he&&(he.query=""),"options"in he&&(he.options=he.current&&!(0,B.R)(he.current)?[he.current]:[]),"refresh"in he&&(he.refresh=w.CO.never)}),ue){const he=ue.getSaveModel();he.gridPos.w=24,he.gridPos.x=0,he.gridPos.y=0,he.gridPos.h=20,de.panels=[he]}delete this.dashboard.snapshot,this.dashboard.forEachPanel(he=>{delete he.snapshotData}),this.dashboard.annotations.list.forEach(he=>{delete he.snapshotData})},this.deleteSnapshot=async()=>{const{deleteUrl:de}=this.state;await(0,U.AI)().get(de),this.setState({step:3})},this.getSnapshotUrl=()=>this.state.snapshotUrl,this.onSnapshotNameChange=de=>{this.setState({snapshotName:de.target.value})},this.onTimeoutChange=de=>{this.setState({timeoutSeconds:Number(de.target.value)})},this.onExpireChange=de=>{this.setState({selectedExpireOption:de,snapshotExpires:de.value})},this.dashboard=ie.dashboard,this.expireOptions=[{label:(0,l.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,l.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},{label:(0,l.t)("share-modal.snapshot.expire-week","1 Week"),value:60*60*24*7},{label:(0,l.t)("share-modal.snapshot.expire-never","Never"),value:0}],this.state={isLoading:!1,step:1,selectedExpireOption:this.expireOptions[2],snapshotExpires:this.expireOptions[2].value,snapshotName:ie.dashboard.title,timeoutSeconds:4,snapshotUrl:"",deleteUrl:"",externalEnabled:!1,sharingButtonText:""}}componentDidMount(){this.getSnaphotShareOptions()}async getSnaphotShareOptions(){const ie=await(0,H.s)().getSharingOptions();this.setState({sharingButtonText:ie.externalSnapshotName,externalEnabled:ie.externalEnabled})}renderStep1(){const{onDismiss:ie}=this.props,{snapshotName:de,selectedExpireOption:ue,timeoutSeconds:fe,isLoading:Se,sharingButtonText:he,externalEnabled:ce}=this.state,me=(0,l.t)("share-modal.snapshot.name","Snapshot name"),pe=(0,l.t)("share-modal.snapshot.expire","Expire"),ye=(0,l.t)("share-modal.snapshot.timeout","Timeout (seconds)"),Pe=(0,l.t)("share-modal.snapshot.timeout-description","You might need to configure the timeout value if it takes a long time to collect your dashboard metrics.");return n.createElement(n.Fragment,null,n.createElement("div",null,n.createElement("p",{className:"share-modal-info-text"},n.createElement(l.x6,{i18nKey:"share-modal.snapshot.info-text-1"},"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard.")),n.createElement("p",{className:"share-modal-info-text"},n.createElement(l.x6,{i18nKey:"share-modal.snapshot.info-text-2"},"Keep in mind, your snapshot ",n.createElement("em",null,"can be viewed by anyone")," that has the link and can access the URL. Share wisely."))),n.createElement(P.D,{label:me},n.createElement(R.p,{id:"snapshot-name-input",width:30,value:de,onChange:this.onSnapshotNameChange})),n.createElement(P.D,{label:pe},n.createElement(W.l6,{inputId:"expire-select-input",width:30,options:this.expireOptions,value:ue,onChange:this.onExpireChange})),n.createElement(P.D,{label:ye,description:Pe},n.createElement(R.p,{id:"timeout-input",type:"number",width:21,value:fe,onChange:this.onTimeoutChange})),n.createElement(o.a.ButtonRow,null,n.createElement(y.$n,{variant:"secondary",onClick:ie,fill:"outline"},n.createElement(l.x6,{i18nKey:"share-modal.snapshot.cancel-button"},"Cancel")),ce&&n.createElement(y.$n,{variant:"secondary",disabled:Se,onClick:this.createSnapshot(!0)},he),n.createElement(y.$n,{variant:"primary",disabled:Se,onClick:this.createSnapshot()},n.createElement(l.x6,{i18nKey:"share-modal.snapshot.local-button"},"Publish Snapshot"))))}renderStep2(){const{snapshotUrl:ie}=this.state;return n.createElement(n.Fragment,null,n.createElement(P.D,{label:(0,l.t)("share-modal.snapshot.url-label","Snapshot URL")},n.createElement(R.p,{id:"snapshot-url-input",value:ie,readOnly:!0,addonAfter:n.createElement(S.b,{icon:"copy",variant:"primary",getText:this.getSnapshotUrl},n.createElement(l.x6,{i18nKey:"share-modal.snapshot.copy-link-button"},"Copy"))})),n.createElement("div",{className:"pull-right",style:{padding:"5px"}},n.createElement(l.x6,{i18nKey:"share-modal.snapshot.mistake-message"},"Did you make a mistake? "),"\xA0",n.createElement(y.z9,{fill:"text",target:"_blank",onClick:this.deleteSnapshot},n.createElement(l.x6,{i18nKey:"share-modal.snapshot.delete-button"},"Delete snapshot."))))}renderStep3(){return n.createElement("div",{className:"share-modal-header"},n.createElement("p",{className:"share-modal-info-text"},n.createElement(l.x6,{i18nKey:"share-modal.snapshot.deleted-message"},"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches.")))}render(){const{isLoading:ie,step:de}=this.state;return n.createElement(n.Fragment,null,de===1&&this.renderStep1(),de===2&&this.renderStep2(),de===3&&this.renderStep3(),ie&&n.createElement(V.y,{inline:!0}))}}const j=[],Y=[];function oe(q){j.push(q)}function se(q){Y.push(q)}function ne(q,ie,de){const fe=[{label:(0,l.t)("share-modal.tab-title.link","Link"),value:M.wr.link,component:K}];if(d.contextSrv.isSignedIn&&f.config.snapshotEnabled&&q){const he=(0,l.t)("share-modal.tab-title.snapshot","Snapshot");fe.push({label:he,value:M.wr.snapshot,component:G})}if(ie){const he=(0,l.t)("share-modal.tab-title.embed","Embed");if(fe.push({label:he,value:M.wr.embed,component:b.D}),!(0,u.X)(ie)){const ce=(0,l.t)("share-modal.tab-title.library-panel","Library panel");fe.push({label:ce,value:M.wr.libraryPanel,component:x.j})}fe.push(...Y)}else{const he=(0,l.t)("share-modal.tab-title.export","Export");fe.push({label:he,value:M.wr.export,component:A}),fe.push(...j),(0,s.iR)()&&fe.push({label:(0,l.t)("share-modal.tab-title.public-dashboard-title","Public dashboard"),value:M.wr.publicDashboard,component:m.b})}const Se=fe.find(he=>he.value===de);return{tabs:fe,activeTab:Se?.value??fe[0].value}}function ee(q){const{tabs:ie,activeTab:de}=ne(q.dashboard.canEditDashboard(),q.panel,q.activeTab);return{tabs:ie,activeTab:de}}class Z extends n.Component{constructor(ie){super(ie),this.onSelectTab=de=>{this.setState(ue=>({...ue,activeTab:de.value})),h.c.sharingTabChanged({item:de.value,shareResource:(0,M.hD)(this.props.panel)})},this.state=ee(ie)}getActiveTab(){const{tabs:ie,activeTab:de}=this.state;return ie.find(ue=>ue.value===de)}renderTitle(){const{panel:ie}=this.props,{activeTab:de}=this.state,ue=ie?(0,l.t)("share-modal.panel.title","Share Panel"):(0,l.t)("share-modal.dashboard.title","Share"),fe=this.props.dashboard.canEditDashboard(),Se=ne(fe,this.props.panel,this.state.activeTab).tabs;return n.createElement(a.J,{title:ue,icon:"share-alt",tabs:Se,activeTab:de,onChangeTab:this.onSelectTab})}render(){const{dashboard:ie,panel:de}=this.props,fe=this.getActiveTab().component;return n.createElement(o.a,{isOpen:!0,title:this.renderTitle(),onDismiss:this.props.onDismiss},n.createElement(r.J,null,n.createElement(fe,{dashboard:ie,panel:de,onDismiss:this.props.onDismiss})))}}const z=(0,i.cV)(Z)},59037:(Q,I,e)=>{"use strict";e.d(I,{K:()=>he,b:()=>Se});var n=e(32196),a=e(96540),o=e(49785),r=e(13544),i=e(32264),f=e(33378),d=e(40845),l=e(88575),m=e(10354),s=e(10534),h=e(15292),u=e(60029),b=e(66864),g=e(55852),P=e(71678),c=e(8484),y=e(72686),p=e(21380),v=e(7758),D=e(90591),E=e(16233),S=e(31678),T=e(52908);const M=()=>{const{width:me}=(0,T.A)();return me>1024};var A=e(7686),x=e(22699),C=e(29304),O=e(42418);const R=()=>a.createElement(O.F,{title:(0,c.t)("public-dashboard.modal-alerts.save-dashboard-changes-alert-title","Please save your dashboard changes before updating the public configuration"),severity:"warning",bottomSpacing:0});var L=e(12257),N=e(10872),F=e(72254),K=e(84167),B=e(54230);const w=r.Tp.pages.ShareDashboardModal.PublicDashboard,U=({disabled:me,onChange:pe,register:ye,timeRange:Pe})=>a.createElement(a.Fragment,null,a.createElement(K.n,{disabled:me},a.createElement(b.gW,{spacing:"md"},a.createElement(b.PE,{orientation:1,spacing:"xs",justify:"space-between"},a.createElement(u.J,{description:(0,c.t)("public-dashboard.settings-configuration.default-time-range-label-desc","The public dashboard uses the default time range settings of the dashboard")},a.createElement(c.x6,{i18nKey:"public-dashboard.settings-configuration.default-time-range-label"},"Default time range")),a.createElement(B.b,{value:Pe,disabled:!0,onChange:()=>{}})),a.createElement(b.PE,{orientation:0,spacing:"sm"},a.createElement(h.d,{...ye("isTimeSelectionEnabled"),"data-testid":w.EnableTimeRangeSwitch,onChange:Ie=>{pe("isTimeSelectionEnabled",Ie.currentTarget.checked),v.c.publicDashboardTimeSelectionChanged({enabled:Ie.currentTarget.checked})}}),a.createElement(u.J,{description:(0,c.t)("public-dashboard.settings-configuration.time-range-picker-label-desc","Allow viewers to change time range")},a.createElement(c.x6,{i18nKey:"public-dashboard.settings-configuration.time-range-picker-label"},"Time range picker enabled"))),a.createElement(b.PE,{orientation:0,spacing:"sm"},a.createElement(h.d,{...ye("isAnnotationsEnabled"),onChange:Ie=>{pe("isAnnotationsEnabled",Ie.currentTarget.checked),v.c.publicDashboardAnnotationsSelectionChanged({enabled:Ie.currentTarget.checked})},"data-testid":w.EnableAnnotationsSwitch}),a.createElement(u.J,{description:(0,c.t)("public-dashboard.settings-configuration.show-annotations-label-desc","Show annotations on public dashboard")},a.createElement(c.x6,{i18nKey:"public-dashboard.settings-configuration.show-annotations-label"},"Show annotations"))))));var W=e(19727),V=e(94354),_=e(62930),H=e(24283);const G=r.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,j=({recipients:me,dashboardUid:pe,publicDashboardUid:ye})=>{const Pe=(0,d.of)(oe),[Ie,{isLoading:Oe}]=(0,y.$L)(),[Ne,{isLoading:We}]=(0,y.NA)(),Ae=Oe||We,Ue=($e,ke)=>{v.c.revokePublicDashboardEmailClicked(),Ie({recipientUid:$e,recipientEmail:ke,dashboardUid:pe,uid:ye})},Me=$e=>{v.c.resendPublicDashboardEmailClicked(),Ne({recipientUid:$e,uid:ye})};return a.createElement("table",{className:Pe.table,"data-testid":G.EmailSharingList},a.createElement("tbody",null,me.map(($e,ke)=>a.createElement("tr",{key:$e.uid},a.createElement("td",null,$e.recipient),a.createElement("td",null,a.createElement(W.e,{className:Pe.tableButtonsContainer},a.createElement(g.$n,{type:"button",variant:"destructive",fill:"text",title:(0,c.t)("public-dashboard.email-sharing.revoke-button-title","Revoke"),size:"sm",disabled:Ae,onClick:()=>Ue($e.uid,$e.recipient),"data-testid":`${G.DeleteEmail}-${ke}`},a.createElement(c.x6,{i18nKey:"public-dashboard.email-sharing.revoke-button"},"Revoke")),a.createElement(g.$n,{type:"button",variant:"primary",fill:"text",title:(0,c.t)("public-dashboard.email-sharing.resend-button-title","Resend"),size:"sm",disabled:Ae,onClick:()=>Me($e.uid),"data-testid":`${G.ReshareLink}-${ke}`},a.createElement(c.x6,{i18nKey:"public-dashboard.email-sharing.resend-button"},"Resend"))))))))},Y=({dashboard:me})=>{const{width:pe}=(0,T.A)(),ye=(0,d.of)(oe),Pe=me instanceof H.H$?me.state.uid:me.uid,{data:Ie}=(0,y.Bs)(Pe),[Oe]=(0,y.T2)(),[Ne,{isLoading:We}]=(0,y.NY)(),Ae=E.TP.hasPermission(S.AccessControlAction.DashboardsPublicWrite),{register:Ue,setValue:Me,control:$e,watch:ke,handleSubmit:Ze,formState:{errors:ot},reset:xt}=(0,o.mN)({defaultValues:{shareType:Ie?.share||F.Xo.PUBLIC,email:""},mode:"onSubmit"}),ct=Le=>{const re={dashboard:me,payload:{...Ie,share:Le}};Oe(re)},ft=async Le=>{v.c.publicDashboardEmailInviteClicked(),await Ne({recipient:Le.email,uid:Ie.uid,dashboardUid:Pe}).unwrap(),xt({email:"",shareType:F.Xo.EMAIL})};return a.createElement("form",{onSubmit:Ze(ft)},a.createElement(K.n,{disabled:!Ae,"data-testid":G.Container,className:ye.container},a.createElement(l.D,{label:(0,c.t)("public-dashboard.config.can-view-dashboard-radio-button-label","Can view dashboard"),className:ye.field},a.createElement(o.xI,{name:"shareType",control:$e,render:({field:Le})=>{const{ref:re,...X}=Le,le=[{label:(0,c.t)("public-dashboard.config.public-share-type-option-label","Anyone with a link"),value:F.Xo.PUBLIC},{label:(0,c.t)("public-dashboard.config.email-share-type-option-label","Only specified people"),value:F.Xo.EMAIL}];return a.createElement(V.z,{...X,size:pe<480?"sm":"md",options:le,onChange:be=>{v.c.publicDashboardShareTypeChange({shareType:be===F.Xo.EMAIL?"email":"public"}),Me("shareType",be),ct(be)}})}})),ke("shareType")===F.Xo.EMAIL&&a.createElement(a.Fragment,null,a.createElement(l.D,{label:(0,c.t)("public-dashboard.email-sharing.invite-field-label","Invite"),description:(0,c.t)("public-dashboard.email-sharing.invite-field-desc","Invite people by email"),error:ot.email?.message,invalid:!!ot.email?.message||void 0,className:ye.field},a.createElement("div",{className:ye.emailContainer},a.createElement(m.p,{className:ye.emailInput,placeholder:"email",autoCapitalize:"none",...Ue("email",{required:(0,c.t)("public-dashboard.email-sharing.input-required-email-text","Email is required"),pattern:{value:F._l,message:(0,c.t)("public-dashboard.email-sharing.input-invalid-email-text","Invalid email")}}),"data-testid":G.EmailSharingInput}),a.createElement(g.$n,{type:"submit",variant:"primary",disabled:We,"data-testid":G.EmailSharingInviteButton},a.createElement(c.x6,{i18nKey:"public-dashboard.email-sharing.invite-button"},"Invite"),We&&a.createElement(_.y,null)))),!!Ie?.recipients?.length&&a.createElement(j,{recipients:Ie.recipients,dashboardUid:Pe,publicDashboardUid:Ie.uid}))))},oe=me=>({container:(0,n.css)({label:"emailConfigContainer",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:me.spacing(3)}),field:(0,n.css)({label:"field-noMargin",marginBottom:0}),emailContainer:(0,n.css)({label:"emailContainer",display:"flex",gap:me.spacing(1)}),emailInput:(0,n.css)({label:"emailInput",flexGrow:1}),table:(0,n.css)({label:"table",display:"flex",maxHeight:"220px",overflowY:"scroll","& tbody":{display:"flex",flexDirection:"column",flexGrow:1},"& tr":{minHeight:"40px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:me.spacing(.5,1),":nth-child(odd)":{background:me.colors.background.secondary}}}),tableButtonsContainer:(0,n.css)({display:"flex",justifyContent:"end"})});var se=e(67892),ne=e(29158);function ee({headerElement:me,isContentVisible:pe=!1,onRowToggle:ye,title:Pe,...Ie}){const Oe=(0,d.of)(Z),Ne=me&&se.renderOrCallToRender(me,{className:Oe.summaryWrapper});return a.createElement("div",{className:Oe.wrapper},a.createElement("div",{className:Oe.header},a.createElement(ne.K,{name:pe?"angle-down":"angle-right",tooltip:pe?(0,c.t)("public-dashboard.settings-bar-header.collapse-settings-tooltip","Collapse settings"):(0,c.t)("public-dashboard.settings-bar-header.expand-settings-tooltip","Expand settings"),className:Oe.collapseIcon,onClick:ye,"aria-expanded":pe,...Ie}),Pe&&a.createElement("div",{className:Oe.titleWrapper,onClick:ye},a.createElement("span",{className:Oe.title},Pe)),Ne))}ee.displayName="SettingsBarHeader";function Z(me){return{wrapper:(0,n.css)({label:"header",padding:me.spacing(.5,.5),borderRadius:me.shape.radius.default,background:me.colors.background.secondary,minHeight:me.spacing(4),"&:focus":{outline:"none"}}),header:(0,n.css)({label:"column",display:"flex",alignItems:"center",whiteSpace:"nowrap"}),collapseIcon:(0,n.css)({marginLeft:me.spacing(.5),color:me.colors.text.disabled}),titleWrapper:(0,n.css)({display:"flex",alignItems:"center",cursor:"pointer",overflow:"hidden",marginRight:`${me.spacing(.5)}`,[me.breakpoints.down("sm")]:{flex:"1 1"}}),title:(0,n.css)({fontWeight:me.typography.fontWeightBold,marginLeft:me.spacing(.5),overflow:"hidden",textOverflow:"ellipsis"}),summaryWrapper:(0,n.css)({display:"flex",flexWrap:"wrap",[me.breakpoints.down("sm")]:{flex:"2 2"}})}}function z({children:me,title:pe,headerElement:ye,...Pe}){const Ie=(0,d.of)(q),[Oe,Ne]=(0,a.useState)(!1);function We(){Ne(Ae=>!Ae)}return a.createElement(a.Fragment,null,a.createElement(ee,{onRowToggle:We,isContentVisible:Oe,title:pe,headerElement:ye,...Pe}),Oe&&a.createElement("div",{className:Ie.content},me))}z.displayName="SettingsBar";const q=me=>({content:(0,n.css)({marginTop:me.spacing(1),marginLeft:me.spacing(4)})});var ie=e(3799);function de({className:me,isDataLoading:pe=!1,timeRange:ye,timeSelectionEnabled:Pe,annotationsEnabled:Ie}){const Oe=(0,d.of)(ue),Ne=(0,c.t)("public-dashboard.settings-summary.time-range-picker-enabled-text","Time range picker = enabled"),We=(0,c.t)("public-dashboard.settings-summary.time-range-picker-disabled-text","Time range picker = disabled"),Ae=(0,c.t)("public-dashboard.settings-summary.annotations-show-text","Annotations = show"),Ue=(0,c.t)("public-dashboard.settings-summary.annotations-hide-text","Annotations = hide");return pe?a.createElement("div",{className:(0,n.cx)(Oe.summaryWrapper,me)},a.createElement(_.y,{className:Oe.summary,inline:!0,size:"sm"})):a.createElement("div",{className:(0,n.cx)(Oe.summaryWrapper,me)},a.createElement("span",{className:Oe.summary},a.createElement(c.x6,{i18nKey:"public-dashboard.settings-summary.time-range-text"},"Time range = "),a.createElement(ie.f,{className:Oe.timeRange,value:ye})),a.createElement("span",{className:Oe.summary},Pe?Ne:We),a.createElement("span",{className:Oe.summary},Ie?Ae:Ue))}de.displayName="SettingsSummary";const ue=me=>({summaryWrapper:(0,n.css)({display:"flex"}),summary:(0,n.css)({label:"collapsedText",marginLeft:`${me.spacing.gridSize*2}px`,fontSize:me.typography.bodySmall.fontSize,color:me.colors.text.secondary}),timeRange:(0,n.css)({display:"inline-block"})}),fe=r.Tp.pages.ShareDashboardModal.PublicDashboard;function Se({onRevoke:me,timeRange:pe,hasTemplateVariables:ye=!1,showSaveChangesAlert:Pe=!1,unsupportedDatasources:Ie=[],publicDashboard:Oe,dashboard:Ne}){const We=(0,d.of)(ce),Ae=M(),[Ue,{isLoading:Me}]=(0,y.T2)(),$e=E.TP.hasPermission(S.AccessControlAction.DashboardsPublicWrite),ke=!$e||Me,Ze=!!i.$.featureToggles.publicDashboardsEmailSharing&&(0,f.a)("publicDashboardsEmailSharing"),{handleSubmit:ot,setValue:xt,register:ct}=(0,o.mN)({defaultValues:{isAnnotationsEnabled:Oe?.annotationsEnabled,isTimeSelectionEnabled:Oe?.timeSelectionEnabled,isPaused:!Oe?.isEnabled}}),ft=async X=>{const{isAnnotationsEnabled:le,isTimeSelectionEnabled:be,isPaused:De}=X;Ue({dashboard:Ne,payload:{...Oe,annotationsEnabled:le,timeSelectionEnabled:be,isEnabled:!De}})},Le=async(X,le)=>{xt(X,le),await ot(be=>ft(be))()};function re(){v.c.publicDashboardUrlCopied()}return a.createElement("div",{className:We.configContainer},Pe&&a.createElement(R,null),!$e&&a.createElement(C.t,{mode:"edit"}),ye&&a.createElement(N.D,null),Ie.length>0&&a.createElement(L.s,{unsupportedDataSources:Ie.join(", ")}),Ze&&a.createElement(Y,{dashboard:Ne}),a.createElement(l.D,{label:(0,c.t)("public-dashboard.config.dashboard-url-field-label","Dashboard URL"),className:We.fieldSpace},a.createElement(m.p,{value:(0,F.mL)(Oe.accessToken),readOnly:!0,disabled:!Oe?.isEnabled,"data-testid":fe.CopyUrlInput,addonAfter:a.createElement(s.b,{"data-testid":fe.CopyUrlButton,variant:"primary",disabled:!Oe?.isEnabled,getText:()=>(0,F.mL)(Oe.accessToken),onClipboardCopy:re},a.createElement(c.x6,{i18nKey:"public-dashboard.config.copy-button"},"Copy"))})),a.createElement(l.D,{className:We.fieldSpace},a.createElement(b.PE,null,a.createElement(h.d,{...ct("isPaused"),disabled:ke,onChange:X=>{v.c.publicDashboardPauseSharingClicked({paused:X.currentTarget.checked}),Le("isPaused",X.currentTarget.checked)},"data-testid":fe.PauseSwitch}),a.createElement(u.J,{className:(0,n.css)({marginBottom:0})},a.createElement(c.x6,{i18nKey:"public-dashboard.config.pause-sharing-dashboard-label"},"Pause sharing dashboard")))),a.createElement(l.D,{className:We.fieldSpace},a.createElement(z,{title:(0,c.t)("public-dashboard.config.settings-title","Settings"),headerElement:({className:X})=>a.createElement(de,{className:X,isDataLoading:Me,timeRange:pe,timeSelectionEnabled:Oe?.timeSelectionEnabled,annotationsEnabled:Oe?.annotationsEnabled}),"data-testid":fe.SettingsDropdown},a.createElement(U,{disabled:ke,onChange:Le,register:ct,timeRange:pe}))),a.createElement(b.PE,{orientation:Ae?0:1,justify:Ae?"flex-end":"flex-start",align:Ae?"center":"normal"},a.createElement(b.Gy,{justify:"flex-end"},a.createElement(g.$n,{title:(0,c.t)("public-dashboard.config.revoke-public-URL-button-title","Revoke public URL"),onClick:me,type:"button",disabled:ke,"data-testid":fe.DeleteButton,variant:"destructive",fill:"outline"},a.createElement(c.x6,{i18nKey:"public-dashboard.config.revoke-public-URL-button"},"Revoke public URL")))))}function he({publicDashboard:me,unsupportedDatasources:pe}){const Pe=(0,S.useSelector)(Ue=>Ue.dashboard).getModel(),Ie=(0,p.z)(Pe.getDefaultTime(),Pe),Oe=E.TP.hasPermission(S.AccessControlAction.DashboardsPublicWrite),Ne=(0,F.kD)(Pe.getVariables()),[We]=(0,y.bN)(),Ae=Ue=>{We({dashboard:Pe,uid:me.uid,dashboardUid:Pe.uid}),Ue()};return a.createElement(P.$s,null,({showModal:Ue,hideModal:Me})=>a.createElement(Se,{publicDashboard:me,dashboard:Pe,unsupportedDatasources:pe,timeRange:Ie,showSaveChangesAlert:Oe&&Pe.hasUnsavedChanges(),hasTemplateVariables:Ne,onRevoke:()=>{v.c.revokePublicDashboardClicked(),Ue(D.m,{dashboardTitle:Pe.title,onConfirm:()=>Ae(Me),onDismiss:()=>{Ue(A.Zy,{dashboard:Pe,onDismiss:Me,activeTab:x.wr.publicDashboard})}})}}))}const ce=me=>({configContainer:(0,n.css)({label:"config container",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:me.spacing(3)}),fieldSpace:(0,n.css)({label:"field space",width:"100%",marginBottom:0}),timeRange:(0,n.css)({display:"inline-block"})})},22234:(Q,I,e)=>{"use strict";e.d(I,{M:()=>x,D:()=>A});var n=e(32196),a=e(96540),o=e(49785),r=e(13544),i=e(40845),f=e(55852),d=e(62930),l=e(8484),m=e(16233),s=e(72686),h=e(7758),u=e(31678),b=e(29304),g=e(12257),P=e(10872),c=e(72254),y=e(71415),p=e(84167),v=e(66864),D=e(10880);const E=r.Tp.pages.ShareDashboardModal.PublicDashboard,S=({disabled:O,register:R})=>{const L=(0,i.of)(T),N=[{type:"publicAcknowledgment",description:(0,l.t)("public-dashboard.acknowledgment-checkboxes.public-ack-desc","Your entire dashboard will be public*"),testId:E.WillBePublicCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/",tooltip:(0,l.t)("public-dashboard.acknowledgment-checkboxes.public-ack-tooltip","Learn more about public dashboards")}},{type:"dataSourcesAcknowledgment",description:(0,l.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-desc","Publishing currently only works with a subset of data sources*"),testId:E.LimitedDSCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/datasources/",tooltip:(0,l.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-tooltip","Learn more about public datasources")}},{type:"usageAcknowledgment",description:(0,l.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc","Making a dashboard public will cause queries to run each time it is viewed, which may increase costs*"),testId:E.CostIncreaseCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/enterprise/query-caching/",tooltip:(0,l.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc-tooltip","Learn more about query caching")}}];return a.createElement(a.Fragment,null,a.createElement("p",{className:L.title},a.createElement(l.x6,{i18nKey:"public-dashboard.acknowledgment-checkboxes.ack-title"},"Before you make the dashboard public, acknowledge the following:")),a.createElement(p.n,{disabled:O},a.createElement(v.gW,{spacing:"md"},N.map(F=>a.createElement(v.Gy,{key:F.type,spacing:"none",align:"center"},a.createElement(D.S,{...R(F.type,{required:!0}),label:F.description,"data-testid":F.testId}),a.createElement(f.z9,{variant:"primary",href:F.info.href,target:"_blank",fill:"text",icon:"info-circle",rel:"noopener noreferrer",tooltip:F.info.tooltip}))))))},T=O=>({title:(0,n.css)({fontWeight:O.typography.fontWeightBold})}),M=r.Tp.pages.ShareDashboardModal.PublicDashboard,A=({unsupportedDatasources:O=[],unsupportedTemplateVariables:R=!1,dashboard:L,hasError:N=!1})=>{const F=(0,i.of)(C),K=m.TP.hasPermission(u.AccessControlAction.DashboardsPublicWrite),[B,{isLoading:w,isError:U}]=(0,s.U9)(),W=()=>{B({dashboard:L,payload:{isEnabled:!0}}),h.c.generatePublicDashboardUrlClicked({})},{handleSubmit:V,register:_,formState:{isValid:H}}=(0,o.mN)({mode:"onChange"}),G=!K||w||U||N;return a.createElement("div",{className:F.container},a.createElement("div",null,a.createElement("p",{className:F.title},a.createElement(l.x6,{i18nKey:"public-dashboard.create-page.welcome-title"},"Welcome to public dashboards!")),a.createElement("p",{className:F.description},a.createElement(l.x6,{i18nKey:"public-dashboard.create-page.unsupported-features-desc"},"Currently, we don\u2019t support template variables or frontend data sources"))),!K&&a.createElement(b.t,{mode:"create"}),R&&a.createElement(P.D,null),O.length>0&&a.createElement(g.s,{unsupportedDataSources:O.join(", ")}),a.createElement("form",{onSubmit:V(W)},a.createElement("div",{className:F.checkboxes},a.createElement(S,{disabled:G,register:_})),a.createElement("div",{className:F.buttonContainer},a.createElement(f.$n,{type:"submit",disabled:G||!H,"data-testid":M.CreateButton},a.createElement(l.x6,{i18nKey:"public-dashboard.create-page.generate-public-url-button"},"Generate public URL"),w&&a.createElement(d.y,{className:F.loadingSpinner})))))};function x({hasError:O}){const L=(0,u.useSelector)(K=>K.dashboard).getModel(),{unsupportedDataSources:N}=(0,y.Z)(L),F=(0,c.kD)(L.getVariables());return a.createElement(A,{dashboard:L,unsupportedDatasources:N,unsupportedTemplateVariables:F,hasError:O})}const C=O=>({container:(0,n.css)({display:"flex",flexDirection:"column",gap:O.spacing(4)}),title:(0,n.css)({fontSize:O.typography.h4.fontSize,margin:O.spacing(0,0,2)}),description:(0,n.css)({color:O.colors.text.secondary,marginBottom:O.spacing(0)}),checkboxes:(0,n.css)({margin:O.spacing(0,0,4)}),buttonContainer:(0,n.css)({display:"flex",justifyContent:"end"}),loadingSpinner:(0,n.css)({marginLeft:O.spacing(1)})})},29304:(Q,I,e)=>{"use strict";e.d(I,{t:()=>f});var n=e(96540),a=e(13544),o=e(42418),r=e(8484);const i=a.Tp.pages.ShareDashboardModal.PublicDashboard,f=({mode:d})=>n.createElement(o.F,{severity:"info",title:(0,r.t)("public-dashboard.modal-alerts.no-upsert-perm-alert-title","You don\u2019t have permission to {{ mode }} a public dashboard",{mode:d}),"data-testid":i.NoUpsertPermissionsWarningAlert,bottomSpacing:0},n.createElement(r.x6,{i18nKey:"public-dashboard.modal-alerts.no-upsert-perm-alert-desc"},"Contact your admin to get permission to ",{mode:d}," public dashboards"))},12257:(Q,I,e)=>{"use strict";e.d(I,{s:()=>s});var n=e(32196),a=e(46942),o=e.n(a),r=e(96540),i=e(13544),f=e(40845),d=e(42418),l=e(8484);const m=i.Tp.pages.ShareDashboardModal.PublicDashboard,s=({unsupportedDataSources:u})=>{const b=(0,f.of)(h);return r.createElement(d.F,{severity:"warning",title:(0,l.t)("public-dashboard.modal-alerts.unsupported-data-source-alert-title","Unsupported data sources"),"data-testid":m.UnsupportedDataSourcesWarningAlert,bottomSpacing:0},r.createElement("p",{className:b.unsupportedDataSourceDescription},r.createElement(l.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-data-source-alert-desc"},"There are data sources in this dashboard that are unsupported for public dashboards. Panels that use these data sources may not function properly: ",{unsupportedDataSources:u},".")),r.createElement("a",{href:"https://grafana.com/docs/grafana/next/dashboards/dashboard-public/",className:o()("text-link",b.unsupportedDataSourceDescription)},r.createElement(l.x6,{i18nKey:"public-dashboard.modal-alerts.unsupport-data-source-alert-readmore-link"},"Read more about supported data sources")))},h=u=>({unsupportedDataSourceDescription:(0,n.css)({color:u.colors.text.secondary,marginBottom:u.spacing(1)})})},10872:(Q,I,e)=>{"use strict";e.d(I,{D:()=>f});var n=e(96540),a=e(13544),o=e(42418),r=e(8484);const i=a.Tp.pages.ShareDashboardModal.PublicDashboard,f=()=>n.createElement(o.F,{severity:"warning",title:(0,r.t)("public-dashboard.modal-alerts.unsupported-template-variable-alert-title","Template variables are not supported"),"data-testid":i.TemplateVariablesWarningAlert,bottomSpacing:0},n.createElement(r.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-template-variable-alert-desc"},"This public dashboard may not work since it uses template variables"))},4785:(Q,I,e)=>{"use strict";e.d(I,{a:()=>u,b:()=>b});var n=e(32196),a=e(96540),o=e(40845),r=e(62930),i=e(72686),f=e(72254),d=e(31678),l=e(42930),m=e(59037),s=e(22234),h=e(71415);const u=()=>{const P=(0,o.of)(g);return a.createElement(l.G,{className:P.loadingContainer},a.createElement(a.Fragment,null,"Loading configuration",a.createElement(r.y,{size:"lg",className:P.spinner})))},b=P=>{const{data:c,isLoading:y,isError:p}=(0,i.Bs)(P.dashboard.uid),D=(0,d.useSelector)(S=>S.dashboard).getModel(),{unsupportedDataSources:E}=(0,h.Z)(D);return a.createElement(a.Fragment,null,y?a.createElement(u,null):(0,f.lI)(c)?a.createElement(m.K,{publicDashboard:c,unsupportedDatasources:E}):a.createElement(s.M,{hasError:p}))},g=P=>({loadingContainer:(0,n.css)({height:"280px",alignItems:"center",justifyContent:"center",gap:P.spacing(1)}),spinner:(0,n.css)({marginBottom:P.spacing(0)})})},72254:(Q,I,e)=>{"use strict";e.d(I,{Xo:()=>d,_A:()=>s,_l:()=>b,gN:()=>u,iR:()=>g,kD:()=>l,lI:()=>m,mL:()=>h});var n=e(26657),a=e(32264),o=e(2913),r=e(31193),i=e(22699),f=e(31204),d=(P=>(P.PUBLIC="public",P.EMAIL="email",P))(d||{});const l=P=>P.length>0,m=P=>P?.uid!==""&&P?.uid!==void 0,s=async P=>{let c=new Set;for(const y of P)for(const p of y.targets){const v=p?.datasource?.type;v&&(f.z.has(v)&&await(0,r.tR)().get(p.datasource)instanceof n.iy||c.add(v))}return Array.from(c).sort()},h=P=>`${(0,o.zj)().appUrl}public-dashboards/${P}`,u=(P,c)=>`/d/${P}/${c}?shareView=${i.wr.publicDashboard}`,b=/^[A-Z\d._%+-]+@[A-Z\d.-]+\.[A-Z]{2,}$/i,g=()=>!!a.$.featureToggles.publicDashboards&&a.$.publicDashboardsEnabled},31204:(Q,I,e)=>{"use strict";e.d(I,{z:()=>n});const n=new Set(["__expr__","aggregations-io-datasource","apache-iotdb-datasource","aquaqanalytics-kdbbackend-datasource","axiomhq-axiom-datasource","cloudwatch","cnos-cnosdb-datasource","datasource","dlopes7-appdynamics-datasource","dvelop-odata-datasource","elasticsearch","frser-sqlite-datasource","grafadruid-druid-datasource","grafana-athena-datasource","grafana-azure-data-explorer-datasource","grafana-azure-monitor-datasource","grafana-bigquery-datasource","grafana-clickhouse-datasource","grafana-databricks-datasource","grafana-datadog-datasource","grafana-dynatrace-datasource","grafana-es-open-distro-datasource","grafana-falconlogscale-datasource","grafana-github-datasource","grafana-gitlab-datasource","grafana-honeycomb-datasource","grafana-iot-sitewise-datasource","grafana-jira-datasource","grafana-looker-datasource","grafana-mock-datasource","grafana-mongodb-datasource","grafana-newrelic-datasource","grafana-odbc-datasource","grafana-opcua-datasource","grafana-opensearch-datasource","grafana-oracle-datasource","grafana-orbit-datasource","grafana-redshift-datasource","grafana-salesforce-datasource","grafana-saphana-datasource","grafana-sentry-datasource","grafana-servicenow-datasource","grafana-snowflake-datasource","grafana-splunk-datasource","grafana-splunk-monitoring-datasource","grafana-sumologic-datasource","grafana-testdata-datasource","grafana-timestream-datasource","grafana-wavefront-datasource","grafana-x-ray-datasource","graphite","hadesarchitect-cassandra-datasource","influxdata-flightsql-datasource","influxdb","innius-grpc-datasource","kniepdennis-neo4j-datasource","loki","manassehzhou-maxcompute-datasource","marcusolsson-csv-datasource","mssql","mysql","nagasudhirpulla-api-datasource","needleinajaystack-haystack-datasource","opentsdb","postgres","prometheus","quickwit-quickwit-datasource","redis-datasource","sentinelone-dataset-datasource","sneller-sneller-datasource","spiceai-spicexyz-datasource","stackdriver","tdengine-datasource","trino-datasource","vertamedia-clickhouse-datasource","vertica-grafana-datasource","ydbtech-ydb-datasource","yesoreyeram-infinity-datasource"])},71415:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>o});var n=e(96540),a=e(72254);const o=r=>{const[i,f]=(0,n.useState)([]);return(0,n.useEffect)(()=>{(async()=>await(0,a._A)(r.panels))().then(l=>{f(l)})},[r.panels]),{unsupportedDataSources:i}}},87895:(Q,I,e)=>{"use strict";e.d(I,{w:()=>i});var n=e(96540),a=e(88575),o=e(94354),r=e(8484);const i=({selectedTheme:f="current",onChange:d})=>{const l=[{label:(0,r.t)("share-modal.theme-picker.current","Current"),value:"current"},{label:(0,r.t)("share-modal.theme-picker.dark","Dark"),value:"dark"},{label:(0,r.t)("share-modal.theme-picker.light","Light"),value:"light"}];return n.createElement(a.D,{label:(0,r.t)("share-modal.theme-picker.field-name","Theme")},n.createElement(o.z,{options:l,value:f,onChange:d}))}},1702:(Q,I,e)=>{"use strict";e.d(I,{ShareModal:()=>n.Zy,addDashboardShareTab:()=>n.mJ});var n=e(7686)},22699:(Q,I,e)=>{"use strict";e.d(I,{CF:()=>b,Lb:()=>u,P_:()=>m,XV:()=>l,Xe:()=>s,hD:()=>P,wr:()=>c});var n=e(65879),a=e(76885),o=e(71733),r=e(47232),i=e(32264),f=e(7030),d=e(74856);function l({useCurrentTimeRange:y,selectedTheme:p,panel:v,search:D=window.location.search,range:E=(0,d.jG)().timeRange(),orgId:S=i.$.bootData.user.orgId}){const T=new URLSearchParams(D),M=v?.timeFrom;if(M){const{from:A,to:x}=n.describeTextRange(M);T.set("from",A),T.set("to",x)}else T.set("from",String(E.from.valueOf())),T.set("to",String(E.to.valueOf()));return T.set("orgId",String(S)),y||(T.delete("from"),T.delete("to")),p!=="current"&&T.set("theme",p),v&&!T.has("editPanel")&&T.set("viewPanel",String(v.id)),T.delete("auth_token"),T.delete("shareView"),T}function m(){let y=window.location.href;const p=y.indexOf("?");return p!==-1&&(y=y.substring(0,p)),y}async function s(y,p,v,D){const E=m(),S=l({useCurrentTimeRange:y,selectedTheme:p,panel:v}),T=a.kM.appendQueryToUrl(E,S.toString());return D?await(0,f.fn)(T):T}function h(y,p,v,D,E){const S=m(),T=l({useCurrentTimeRange:y,selectedTheme:v,panel:D,range:E});let M=S.replace(i.$.appSubUrl+"/dashboard/",i.$.appSubUrl+"/dashboard-solo/");M=M.replace(i.$.appSubUrl+"/d/",i.$.appSubUrl+"/d-solo/"),o.I.stripBaseFromUrl(S)==="/"&&(M=`${i.$.appUrl}d-solo/${p}`);const x=T.get("editPanel")??T.get("viewPanel")??"";return T.set("panelId",x),T.delete("editPanel"),T.delete("viewPanel"),a.kM.appendQueryToUrl(M,T.toString())}function u(y,p,v,D){let S=h(y,p,v,D).replace(i.$.appSubUrl+"/dashboard-solo/",i.$.appSubUrl+"/render/dashboard-solo/");return S=S.replace(i.$.appSubUrl+"/d-solo/",i.$.appSubUrl+"/render/d-solo/"),S+=`&width=${i.$.rendererDefaultImageWidth}&height=${i.$.rendererDefaultImageHeight}&scale=${i.$.rendererDefaultImageScale}`+g(),S}function b(y,p,v,D,E){return`<iframe src="${h(y,p,v,D,E)}" width="450" height="200" frameborder="0"></iframe>`}function g(){const y="&tz=UTC"+encodeURIComponent((0,r.KQ)().format("Z"));if(!window.Intl)return y;const p=window.Intl.DateTimeFormat();if(!p.resolvedOptions)return y;const v=p.resolvedOptions();return v.timeZone?"&tz="+encodeURIComponent(v.timeZone):y}const P=y=>y?"panel":"dashboard",c={link:"link",snapshot:"snapshot",export:"export",embed:"embed",libraryPanel:"library_panel",pdf:"pdf",report:"report",publicDashboard:"public_dashboard"}},52424:(Q,I,e)=>{"use strict";e.d(I,{Zx:()=>D,aK:()=>P});var n=e(32196),a=e(96540),o=e(16817),r=e(80997),i=e(13544),f=e(40845),d=e(38138),l=e(40276),m=e(83122),s=e(14578),h=e(55852),u=e(27677),b=e(6923);function g({dashboardUID:E,link:S}){const T=(0,f.of)(v),M=c({dashboardUID:E,link:S});return!M||p.length===0?null:a.createElement(d.W,null,a.createElement("div",{className:T.dropdown},a.createElement(l.E,null,M.map((A,x)=>a.createElement(d.W.Item,{url:A.url,target:S.targetBlank?"_blank":void 0,key:`dashlinks-dropdown-item-${A.uid}-${x}`,label:A.title,testId:i.Tp.components.DashboardLinks.link,"aria-label":`${A.title} dashboard`})))))}const P=E=>{const{link:S,linkInfo:T,dashboardUID:M}=E,A=c(E),x=(0,f.of)(v);return S.asDropdown?a.createElement(m.m,{overlay:a.createElement(g,{link:S,dashboardUID:M})},a.createElement(D,{"data-placement":"bottom","data-toggle":"dropdown","aria-controls":"dropdown-list","aria-haspopup":"menu",fill:"outline",variant:"secondary","data-testid":i.Tp.components.DashboardLinks.dropDown},a.createElement(s.I,{"aria-hidden":!0,name:"bars",className:x.iconMargin}),a.createElement("span",null,T.title))):a.createElement(a.Fragment,null,A.length>0&&A.map((C,O)=>a.createElement(D,{key:`dashlinks-list-item-${C.uid}-${O}`,icon:"apps",variant:"secondary",fill:"outline",href:C.url,target:S.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":i.Tp.components.DashboardLinks.link},C.title)))},c=({link:E,dashboardUID:S})=>{const{tags:T}=E,M=(0,o.A)(()=>y(T),[T]);return M.value?p(S,E,M.value):[]};async function y(E,S={getBackendSrv:u.AI}){return await S.getBackendSrv().search({tag:E,limit:100})}function p(E,S,T,M={getLinkSrv:b.mQ,sanitize:r.aj,sanitizeUrl:r.Jf}){return T.filter(A=>A.uid!==E).map(A=>{const x=A.uid,C=M.sanitize(A.title),O=M.getLinkSrv().getLinkUrl({...S,url:A.url}),R=M.sanitizeUrl(O);return{uid:x,title:C,url:R}})}function v(E){return{iconMargin:(0,n.css)({marginRight:E.spacing(.5)}),dropdown:(0,n.css)({maxWidth:"max(30vw, 300px)",maxHeight:"70vh",overflowY:"auto"}),button:(0,n.css)({color:E.colors.text.primary}),dashButton:(0,n.css)({fontSize:E.typography.bodySmall.fontSize,paddingLeft:E.spacing(1),paddingRight:E.spacing(1)})}}const D=a.forwardRef(({className:E,...S},T)=>{const M=(0,f.of)(v),A=S.href?h.z9:h.$n;return a.createElement(A,{...S,variant:"secondary",fill:"outline",className:(0,n.cx)(E,M.dashButton),ref:T})});D.displayName="DashboardLinkButton"},57650:(Q,I,e)=>{"use strict";e.d(I,{A:()=>K});var n=e(96540),a=e(97497),o=e(42941),r=e(1173),i=e(52622),f=e(13544),d=e(14110),l=e(96374),m=e(10343),s=e(7788),h=e(2913),u=e(10803),b=e(32196),g=e(69862),P=e(85200),c=e(2514),y=e(72574),p=e(40845),v=e(87978),D=e(24022),E=e(14578);const S=({debugMode:B,index:w,data:U,uiConfig:W,configs:V,onChange:_,toggleShowDebug:H})=>{const G=(0,p.of)(T),[j,Y]=(0,n.useState)([]),[oe,se]=(0,n.useState)([]),ne=(0,n.useMemo)(()=>V[w],[V,w]);(0,n.useEffect)(()=>{const Z=V[w].transformation,z=Z.filter?.options?(0,P.Dq)(Z.filter):void 0,q=V.slice(0,w).map(Se=>Se.transformation),ie=V.slice(w,w+1).map(Se=>Se.transformation),de={interpolate:Se=>(0,y.w)().replace(Se)},ue=(0,c.m)(q,U,de).subscribe(Se=>{z&&(Se=U.filter(he=>z(he))),Y(Se)}),fe=(0,c.m)(q,U,de).pipe((0,g.Z)(Se=>(0,c.m)(ie,Se,de))).subscribe(se);return function(){ue.unsubscribe(),fe.unsubscribe()}},[w,U,V]);const ee=(0,n.useMemo)(()=>n.createElement(W.editor,{options:{...W.transformation.defaultOptions,...ne.transformation.options},input:j,onChange:Z=>{_(w,{...ne.transformation,options:Z})}}),[W.editor,W.transformation.defaultOptions,ne.transformation,j,_,w]);return n.createElement("div",{"data-testid":f.Tp.components.TransformTab.transformationEditor(W.name)},ee,B&&n.createElement(v._,{title:"Debug transformation",subtitle:W.name,onClose:H},n.createElement("div",{className:G.debugWrapper,"data-testid":f.Tp.components.TransformTab.transformationEditorDebugger(W.name)},n.createElement("div",{className:G.debug},n.createElement("div",{className:G.debugTitle},"Input data"),n.createElement("div",{className:G.debugJson},n.createElement(D.B,{json:j}))),n.createElement("div",{className:G.debugSeparator},n.createElement(E.I,{name:"arrow-right"})),n.createElement("div",{className:G.debug},n.createElement("div",{className:G.debugTitle},"Output data"),n.createElement("div",{className:G.debugJson},oe&&n.createElement(D.B,{json:oe}))))))},T=B=>({title:(0,b.css)({display:"flex",padding:"4px 8px 4px 8px",position:"relative",height:"35px",borderRadius:"4px 4px 0 0",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"}),name:(0,b.css)({fontWeight:B.typography.fontWeightMedium,color:B.colors.primary.text}),iconRow:(0,b.css)({display:"flex"}),icon:(0,b.css)({background:"transparent",border:"none",boxShadow:"none",cursor:"pointer",color:B.colors.text.secondary,marginLeft:B.spacing(1),"&:hover":{color:B.colors.text.primary}}),debugWrapper:(0,b.css)({display:"flex",flexDirection:"row"}),debugSeparator:(0,b.css)({width:"48px",minHeight:"300px",display:"flex",alignItems:"center",alignSelf:"stretch",justifyContent:"center",margin:`0 ${B.spacing(.5)}`,color:B.colors.primary.text}),debugTitle:(0,b.css)({padding:`${B.spacing(1)} ${B.spacing(.25)}`,fontFamily:B.typography.fontFamilyMonospace,fontSize:B.typography.bodySmall.fontSize,color:B.colors.text.primary,borderBottom:`1px solid ${B.colors.border.weak}`,flexGrow:0,flexShrink:1}),debug:(0,b.css)({marginTop:B.spacing(1),padding:`0 ${B.spacing(1,1,1)}`,border:`1px solid ${B.colors.border.weak}`,background:`${B.isLight?B.v1.palette.white:B.v1.palette.gray05}`,borderRadius:B.shape.radius.default,width:"100%",minHeight:"300px",display:"flex",flexDirection:"column",alignSelf:"stretch"}),debugJson:(0,b.css)({flexGrow:1,height:"100%",overflow:"hidden",padding:B.spacing(.5)})});var M=e(22214),A=e(91847);const x=({isOpen:B,onCloseClick:w,transformer:U})=>{const{transformation:{name:W},help:V}=U,_=V||(0,A.$n)(),H=n.createElement(v._,{title:W,subtitle:"Transformation help",onClose:()=>w(!1)},n.createElement(M.j,{markdown:_,styleOverrides:{borderTop:"2px solid"}}));return B?H:null};var C=e(88575),O=e(21594),R=e(19743);const L=({index:B,data:w,config:U,onChange:W})=>{const V=(0,p.of)(N),_=(0,n.useMemo)(()=>({context:{data:w.series},showTopic:!0,showFilter:U.topic!==i.QR.Annotations,source:[{value:i.QR.Series,label:"Query results"},{value:i.QR.Annotations,label:"Annotation data"}]}),[w,U.topic]);return n.createElement("div",{className:V.wrapper},n.createElement(C.D,{label:"Apply transformation to"},n.createElement(n.Fragment,null,_.showTopic&&n.createElement(O.l6,{isClearable:!0,options:_.source,value:_.source.find(H=>H.value===U.topic),placeholder:_.source[0].label,className:V.padded,onChange:H=>{W(B,{...U,topic:H?.value})}}),_.showFilter&&n.createElement(R.x,{value:U.filter,context:_.context,item:{},onChange:H=>W(B,{...U,filter:H})}))))},N=B=>{const w=B.shape.radius.default;return{wrapper:(0,b.css)({padding:B.spacing(2),border:`2px solid ${B.colors.background.secondary}`,borderTop:"none",borderRadius:`0 0 ${w} ${w}`,position:"relative",top:"-4px"}),padded:(0,b.css)({marginBottom:B.spacing(1)})}},F=({onRemove:B,index:w,id:U,data:W,configs:V,uiConfig:_,onChange:H})=>{const[G,j]=(0,o.A)(!1),[Y,oe]=(0,o.A)(!1),[se,ne]=(0,o.A)(!1),ee=!!V[w].transformation.disabled,Z=V[w].transformation.topic,z=V[w].transformation.filter!=null||Z!=null,q=z||W.series.length>1||(W.annotations?.length??0)>0,ie=(0,n.useCallback)(Se=>{const he=V[Se].transformation;H(Se,{...he,disabled:he.disabled?void 0:!0})},[H,V]),de=(0,n.useCallback)(()=>{let Se={...V[w].transformation};Se.filter?delete Se.filter:Se.filter={id:r.jR.byRefId,options:""},H(w,Se)},[H,w,V]),ue=(0,n.useCallback)((Se,he,ce)=>me=>{let pe="panel_editor_tabs_transformations_toggle";h.Ay.featureToggles.transformationsRedesign&&(pe="transformations_redesign_"+pe),(0,d.rR)(pe,{action:ce?"off":"on",toggleId:he,transformationId:V[w].transformation.id}),Se(me)},[V,w]),fe=()=>n.createElement(n.Fragment,null,_.state&&n.createElement(u.p,{state:_.state}),n.createElement(m.A,{title:"Show transform help",icon:"info-circle",onClick:ue(ne,"help",se),active:se}),q&&n.createElement(m.A,{title:"Filter",icon:"filter",onClick:ue(de,"filter",z),active:z}),n.createElement(m.A,{title:"Debug",icon:"bug",onClick:ue(oe,"debug",Y),active:Y}),n.createElement(m.A,{title:"Disable transformation",icon:ee?"eye-slash":"eye",onClick:ue(()=>ie(w),"disabled",ee),active:ee,dataTestId:f.Tp.components.Transforms.disableTransformationButton}),n.createElement(m.q,{title:"Remove",icon:"trash-alt",onClick:()=>h.Ay.featureToggles.transformationsRedesign?j(!0):B(w)}),h.Ay.featureToggles.transformationsRedesign&&n.createElement(l.u,{isOpen:G,title:`Delete ${_.name}?`,body:"Note that removing one transformation may break others. If there is only a single transformation, you will go back to the main selection screen.",confirmText:"Delete",onConfirm:()=>{j(!1),B(w)},onDismiss:()=>j(!1)}));return n.createElement(n.Fragment,null,n.createElement(s.u,{id:U,index:w,title:`${w+1} - ${_.name}`,draggable:!0,actions:fe,disabled:ee,expanderMessages:{close:"Collapse transformation row",open:"Expand transformation row"}},z&&n.createElement(L,{index:w,config:V[w].transformation,data:W,onChange:H}),n.createElement(S,{debugMode:Y,index:w,data:Z===i.QR.Annotations?W.annotations??[]:W.series,configs:V,uiConfig:_,onChange:H,toggleShowDebug:oe})),n.createElement(x,{transformer:_,isOpen:se,onCloseClick:ne}))},K=({data:B,onChange:w,onRemove:U,configs:W})=>n.createElement(n.Fragment,null,W.map((V,_)=>{const H=a.h.getIfExists(V.transformation.id);return H?n.createElement(F,{index:_,id:`${V.id}`,key:`${V.id}`,data:B,configs:W,uiConfig:H,onRemove:U,onChange:w}):null}))},21427:(Q,I,e)=>{"use strict";e.d(I,{R:()=>D});var n=e(32196),a=e(96540),o=e(81010),r=e(18282),i=e(97497),f=e(13544),d=e(40845),l=e(87978),m=e(10354),s=e(15292),h=e(92174),u=e(10860),b=e(29158),g=e(2913),P=e(10803),c=e(94397);const v=[["viewAll","View all"],...Object.entries(c.eJ)];function D(C){const O=(0,d.of)(E),{suffix:R,xforms:L,search:N,onSearchChange:F,onSearchKeyDown:K,showIllustrations:B,onTransformationAdd:w,selectedFilter:U,data:W,onClose:V,onShowIllustrationsChange:_,onSelectedFilterChange:H}=C,G=(0,a.useCallback)(j=>{j?.click()},[]);return a.createElement(l._,{size:"md",onClose:()=>{V&&V()},title:"Add another transformation"},a.createElement("div",{className:O.searchWrapper},a.createElement(m.p,{"data-testid":f.Tp.components.Transforms.searchInput,className:O.searchInput,value:N??"",placeholder:"Search for transformation",onChange:F,onKeyDown:K,suffix:R,ref:G}),a.createElement("div",{className:O.showImages},a.createElement("span",{className:O.illustationSwitchLabel},"Show images")," ",a.createElement(s.d,{value:B,onChange:()=>_&&_(!B)}))),a.createElement("div",{className:O.filterWrapper},v.map(([j,Y])=>a.createElement(h.m,{key:j,onClick:()=>H&&H(j),label:Y,selected:U===j}))),a.createElement(S,{showIllustrations:B,transformations:L,data:W,onClick:j=>{w({value:j})}}))}function E(C){return{showImages:(0,n.css)({flexBasis:"0",display:"flex",gap:"8px",alignItems:"center"}),pickerInformationLine:(0,n.css)({fontSize:"16px",marginBottom:`${C.spacing(2)}`}),pickerInformationLineHighlight:(0,n.css)({verticalAlign:"middle"}),searchWrapper:(0,n.css)({display:"flex",flexWrap:"wrap",columnGap:"27px",rowGap:"16px",width:"100%"}),searchInput:(0,n.css)({flexGrow:"1",width:"initial"}),illustationSwitchLabel:(0,n.css)({whiteSpace:"nowrap"}),filterWrapper:(0,n.css)({padding:`${C.spacing(1)} 0`,display:"flex",flexWrap:"wrap",rowGap:`${C.spacing(1)}`,columnGap:`${C.spacing(.5)}`})}}function S({showIllustrations:C,transformations:O,onClick:R,data:L}){const N=(0,d.of)(T);return a.createElement("div",{className:N.grid},O.map(F=>{let K=o.M.Applicable;F.transformation.isApplicable!==void 0&&(K=F.transformation.isApplicable(L));const B=K>0;let w=null;F.transformation.isApplicableDescription!==void 0&&(typeof F.transformation.isApplicableDescription=="function"?w=F.transformation.isApplicableDescription(L):w=F.transformation.isApplicableDescription);let U=N.newCard;return B||(U=(0,n.cx)(N.newCard,N.cardDisabled)),a.createElement(u.Z,{className:U,"data-testid":f.Tp.components.TransformTab.newTransform(F.name),onClick:()=>R(F.id),key:F.id},a.createElement(u.Z.Heading,{className:N.heading},a.createElement("span",null,F.name),a.createElement("span",{className:N.pluginStateInfoWrapper},a.createElement(P.p,{state:F.state}))),a.createElement(u.Z.Description,{className:N.description},a.createElement("span",null,x(F.id)),C&&a.createElement("span",null,a.createElement("img",{className:N.image,src:M(F.id,!B),alt:F.name})),!B&&w!==null&&a.createElement(b.K,{className:N.cardApplicableInfo,name:"info-circle",tooltip:w})))}))}function T(C){return{heading:(0,n.css)({fontWeight:400,"> button":{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"nowrap"}}),description:(0,n.css)({fontSize:"12px",display:"flex",flexDirection:"column",justifyContent:"space-between"}),image:(0,n.css)({display:"block",maxEidth:"100%`",marginTop:`${C.spacing(2)}`}),grid:(0,n.css)({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gridAutoRows:"1fr",gap:`${C.spacing(2)} ${C.spacing(1)}`,width:"100%"}),cardDisabled:(0,n.css)({backgroundColor:"rgb(204, 204, 220, 0.045)",color:`${C.colors.text.disabled} !important`,img:{filter:"grayscale(100%)",opacity:.33}}),cardApplicableInfo:(0,n.css)({position:"absolute",bottom:`${C.spacing(1)}`,right:`${C.spacing(1)}`}),newCard:(0,n.css)({gridTemplateRows:"min-content 0 1fr 0"}),pluginStateInfoWrapper:(0,n.css)({marginLeft:"5px"})}}const M=(C,O)=>`public/img/transformations/${g.Ay.theme2.isDark?"dark":"light"}/${C}.svg`,A={[r.F.concatenate]:"Combine all fields into a single frame.",[r.F.configFromData]:"Set unit, min, max and more.",[r.F.fieldLookup]:"Use a field value to lookup countries, states, or airports.",[r.F.filterFieldsByName]:"Remove parts of the query results using a regex pattern.",[r.F.filterByRefId]:"Remove rows from the data based on origin query",[r.F.filterByValue]:"Remove rows from the query results using user-defined filters.",[r.F.groupBy]:"Group data by a field value and create aggregate data.",[r.F.groupingToMatrix]:"Summarize and reorganize data based on three fields.",[r.F.joinByField]:"Combine rows from 2+ tables, based on a related field.",[r.F.labelsToFields]:"Group series by time and return labels or tags as fields.",[r.F.merge]:"Merge multiple series. Values will be combined into one row.",[r.F.organize]:"Re-order, hide, or rename fields.",[r.F.partitionByValues]:"Split a one-frame dataset into multiple series.",[r.F.prepareTimeSeries]:"Stretch data frames from the wide format into the long format.",[r.F.reduce]:"Reduce all rows or data points to a single value (ex. max, mean).",[r.F.renameByRegex]:"Rename parts of the query results using a regular expression and replacement pattern.",[r.F.seriesToRows]:"Merge multiple series. Return time, metric and values as a row."},x=C=>A[C]||i.h.getIfExists(C)?.description||""},66879:(Q,I,e)=>{"use strict";e.d(I,{o:()=>w,e:()=>K});var n=e(96540),a=e(75494),o=e(97497),r=e(13544),i=e(14110),f=e(29158),d=e(55852),l=e(96374),m=e(19727),s=e(40276),h=e(66864),u=e(40845),b=e(2913),g=e(79280),P=e(12131),c=e(32696);function y({message:U}){const W=(0,n.useCallback)(()=>{P.Ny.partial({tab:c.M8.Query})},[]);return n.createElement(h.PE,{justify:"center",style:{marginTop:"100px"}},n.createElement(h.gW,{spacing:"md"},n.createElement("h2",null,U),n.createElement("div",null,n.createElement(d.$n,{size:"md",variant:"secondary",icon:"arrow-left",onClick:W},"Go back to Queries"))))}var p=e(57650),v=e(32196),D=e(87885),E=e(42418),S=e(10354),T=e(10860),M=e(61680);const A={[D.f.Transformations]:"https://grafana.com/docs/grafana/latest/panels/transformations",[D.f.FieldConfig]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/",[D.f.FieldConfigOverrides]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/#override-a-field"},x=U=>A[U];var C=e(10803);const O="dashboard.components.TransformationEditor.featureInfoBox.isDismissed";function R(U){const{noTransforms:W,search:V,xforms:_,onSearchChange:H,onSearchKeyDown:G,onTransformationAdd:j,suffix:Y}=U;return n.createElement(h.gW,null,W&&n.createElement(h.mc,{grow:1},n.createElement(M.b,{storageKey:O,defaultValue:!1},(oe,se)=>oe?null:n.createElement(E.F,{title:"Transformations",severity:"info",onRemove:()=>{se(!0)}},n.createElement("p",null,"Transformations allow you to join, calculate, re-order, hide, and rename your query results before they are visualized. ",n.createElement("br",null),"Many transforms are not suitable if you're using the Graph visualization, as it currently only supports time series data. ",n.createElement("br",null),"It can help to switch to the Table visualization to understand what a transformation is doing."," "),n.createElement("a",{href:x(D.f.Transformations),className:"external-link",target:"_blank",rel:"noreferrer"},"Read more")))),n.createElement(S.p,{"data-testid":r.Tp.components.Transforms.searchInput,value:V??"",autoFocus:!W,placeholder:"Search for transformation",onChange:H,onKeyDown:G,suffix:Y}),_.map(oe=>n.createElement(L,{key:oe.name,transform:oe,onClick:()=>{j({value:oe.id})}})))}function L({transform:U,onClick:W}){const V=(0,u.of)(N);return n.createElement(T.Z,{className:V.card,"data-testid":r.Tp.components.TransformTab.newTransform(U.name),onClick:W},n.createElement(T.Z.Heading,null,U.name),n.createElement(T.Z.Description,null,U.description),U.state&&n.createElement(T.Z.Tags,null,n.createElement(C.p,{state:U.state})))}function N(U){return{card:(0,v.css)({margin:"0",padding:`${U.spacing(1)}`})}}var F=e(21427);const K="viewAll";class B extends n.PureComponent{constructor(W){super(W),this.onSearchChange=H=>{this.setState({search:H.target.value})},this.onSearchKeyDown=H=>{if(H.key==="Enter"){const{search:G}=this.state;if(G){const j=G.toLowerCase(),Y=o.h.list().filter(oe=>(oe.name+oe.description).toLowerCase().indexOf(j)>=0);Y.length>0&&this.onTransformationAdd({value:Y[0].id})}}else H.keyCode===27&&(this.setState({search:"",showPicker:!1}),H.stopPropagation())},this.getTransformationNextId=H=>{const{transformations:G}=this.state;let j=0;const Y=G.filter(oe=>oe.id.startsWith(H)).map(oe=>oe.id);return Y.length!==0&&(j=Math.max(...Y.map(oe=>parseInt(oe.match(/\d+/)[0],10)))+1),`${H}-${j}`},this.onTransformationAdd=H=>{let G="panel_editor_tabs_transformations_management";b.Ay.featureToggles.transformationsRedesign&&(G="transformations_redesign_"+G),(0,i.rR)(G,{action:"add",transformationId:H.value});const{transformations:j}=this.state,Y=this.getTransformationNextId(H.value);this.setState({search:"",showPicker:!1}),this.onChange([...j,{id:Y,transformation:{id:H.value,options:{}}}])},this.onTransformationChange=(H,G)=>{const{transformations:j}=this.state,Y=Array.from(j);let oe="panel_editor_tabs_transformations_management";b.Ay.featureToggles.transformationsRedesign&&(oe="transformations_redesign_"+oe),(0,i.rR)(oe,{action:"change",transformationId:Y[H].transformation.id}),Y[H].transformation=G,this.onChange(Y)},this.onTransformationRemove=H=>{const{transformations:G}=this.state,j=Array.from(G);let Y="panel_editor_tabs_transformations_management";b.Ay.featureToggles.transformationsRedesign&&(Y="transformations_redesign_"+Y),(0,i.rR)(Y,{action:"remove",transformationId:j[H].transformation.id}),j.splice(H,1),this.onChange(j)},this.onTransformationRemoveAll=()=>{this.onChange([]),this.setState({showRemoveAllModal:!1})},this.onDragEnd=H=>{const{transformations:G}=this.state;if(!H||!H.destination)return;const j=H.source.index,Y=H.destination.index;if(j===Y)return;const oe=Array.from(G),[se]=oe.splice(j,1);oe.splice(Y,0,se),this.onChange(oe)},this.renderEmptyMessage=()=>n.createElement(g.p,{onShowPicker:()=>{this.setState({showPicker:!0})}}),this.renderTransformationEditors=()=>{const{data:H,transformations:G}=this.state;return n.createElement(a.JY,{onDragEnd:this.onDragEnd},n.createElement(a.gL,{droppableId:"transformations-list",direction:"vertical"},j=>n.createElement("div",{ref:j.innerRef,...j.droppableProps},n.createElement(p.A,{configs:G,data:H,onRemove:this.onTransformationRemove,onChange:this.onTransformationChange}),j.placeholder)))};const V=W.panel.transformations||[],_=this.buildTransformationIds(V);this.state={transformations:V.map((H,G)=>({transformation:H,id:_[G]})),data:{series:[]},search:"",selectedFilter:K,showIllustrations:!0}}buildTransformationIds(W){const V={},_=[];for(let H=0;H<W.length;H++){const G=W[H];V[G.id]===void 0?V[G.id]=0:V[G.id]+=1,_.push(`${W[H].id}-${V[W[H].id]}`)}return _}componentDidMount(){this.subscription=this.props.panel.getQueryRunner().getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:W=>this.setState({data:W})})}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(W,V){if(b.Ay.featureToggles.transformationsRedesign){const H=!(V.transformations.length>0)||V.showPicker,j=!(this.state.transformations.length>0)||this.state.showPicker;if(H!==j){const Y=Math.random()/2;this.setState({scrollTop:j?Y:Number.MAX_SAFE_INTEGER})}}}onChange(W){this.setState({transformations:W}),this.props.panel.setTransformations(W.map(V=>V.transformation))}renderTransformsPicker(){let{showPicker:W}=this.state;const{transformations:V,search:_}=this.state,{transformationsRedesign:H}=b.Ay.featureToggles,G=!V?.length,j=V.length>0;let Y=null,oe=o.h.list().sort((Z,z)=>Z.name>z.name?1:z.name>Z.name?-1:0);if(!H&&G&&(W=!0),this.state.selectedFilter!==K&&(oe=oe.filter(Z=>Z.categories&&this.state.selectedFilter&&Z.categories.has(this.state.selectedFilter))),_){const Z=_.toLowerCase(),z=oe.filter(q=>(q.name+q.description).toLowerCase().indexOf(Z)>=0);Y=n.createElement(n.Fragment,null,z.length," / ",oe.length," \xA0\xA0",n.createElement(f.K,{name:"times",onClick:()=>{this.setState({search:""})},tooltip:"Clear search"})),oe=z}!Y&&W&&!G&&(Y=n.createElement(f.K,{name:"times",onClick:()=>{this.setState({showPicker:!1})},tooltip:"Close picker"}));let se=null,ne=null;H?(se=n.createElement(F.R,{noTransforms:G,search:_,suffix:Y,xforms:oe,onClose:()=>this.setState({showPicker:!1}),onSelectedFilterChange:Z=>this.setState({selectedFilter:Z}),onShowIllustrationsChange:Z=>this.setState({showIllustrations:Z}),onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd,data:this.state.data.series,selectedFilter:this.state.selectedFilter,showIllustrations:this.state.showIllustrations}),ne=n.createElement(n.Fragment,null,n.createElement(d.$n,{icon:"times",variant:"secondary",onClick:()=>this.setState({showRemoveAllModal:!0}),style:{marginLeft:this.props.theme.spacing.md}},"Delete all transformations"),n.createElement(l.u,{isOpen:!!this.state.showRemoveAllModal,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>this.onTransformationRemoveAll(),onDismiss:()=>this.setState({showRemoveAllModal:!1})}))):se=n.createElement(R,{noTransforms:G,search:_,suffix:Y,xforms:oe,onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd});const ee=n.createElement(m.e,null,n.createElement(d.$n,{icon:"plus",variant:"secondary",onClick:()=>{this.setState({showPicker:!0})},"data-testid":r.Tp.components.Transforms.addTransformationButton},"Add another transformation"),ne);return n.createElement(n.Fragment,null,W&&se,H&&j&&ee||!H&&!W&&j&&ee)}render(){const{panel:{alert:W}}=this.props,{transformations:V}=this.state,_=V.length>0;if(W){const H=_?"Transformations can't be used on a panel with alerts":"Transformations can't be used on a panel with existing alerts";return n.createElement(y,{message:H})}return n.createElement(s.E,{scrollTop:this.state.scrollTop,autoHeightMin:"100%"},n.createElement(h.mc,{padding:"lg"},n.createElement("div",{"data-testid":r.Tp.components.TransformTab.content},!_&&b.Ay.featureToggles.transformationsRedesign&&this.renderEmptyMessage(),_&&this.renderTransformationEditors(),this.renderTransformsPicker())))}}const w=(0,u.SL)(B)},55087:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{SoloPanel:()=>h,SoloPanelPage:()=>s,default:()=>u});var n=e(96540),a=e(71468),o=e(70713),r=e(76888),i=e(39569),f=e(20470);const d=b=>({dashboard:b.dashboard.getModel()}),l={initDashboard:f.vR},m=(0,a.connect)(d,l);class s extends n.Component{constructor(){super(...arguments),this.state={panel:null,notFound:!1}}static{this.contextType=r.YE}componentDidMount(){const{match:g,route:P}=this.props;this.props.initDashboard({urlSlug:g.params.slug,urlUid:g.params.uid,urlType:g.params.type,routeName:P.routeName,fixUrl:!1,keybindingSrv:this.context.keybindings})}getPanelId(){return parseInt(this.props.queryParams.panelId??"0",10)}componentDidUpdate(g){const{dashboard:P}=this.props;if(P&&(!g.dashboard||g.dashboard.uid!==P.uid)){const c=P.getPanelByUrlId(this.props.queryParams.panelId);if(!c){this.setState({notFound:!0});return}c&&P.exitViewPanel(c),this.setState({panel:c}),P.initViewPanel(c)}}render(){return n.createElement(h,{dashboard:this.props.dashboard,notFound:this.state.notFound,panel:this.state.panel,panelId:this.getPanelId(),timezone:this.props.queryParams.timezone})}}const h=({dashboard:b,notFound:g,panel:P,panelId:c,timezone:y})=>g?n.createElement("div",{className:"alert alert-error"},"Panel with id ",c," not found"):!P||!b?n.createElement("div",null,"Loading & initializing dashboard"):n.createElement("div",{className:"panel-solo"},n.createElement(o.Ay,null,({width:p,height:v})=>p===0?null:n.createElement(i.L,{stateKey:P.key,width:p,height:v,dashboard:b,panel:P,isEditing:!1,isViewing:!0,lazy:!1,timezone:y,hideMenu:!0}))),u=m(s)},68064:(Q,I,e)=>{"use strict";e.d(I,{A:()=>v});var n=e(32196),a=e(96540),o=e(13544),r=e(12131),i=e(32264),f=e(40845),d=e(67061),l=e(90613),m=e(94753),s=e(55852),h=e(8484),u=e(36974),b=e(19293),g=e(24283),P=e(7758),c=e(31678),y=e(28601);const v=({dashboard:E,canCreate:S})=>{const T=(0,f.of)(D),M=(0,c.useDispatch)(),A=(0,c.useSelector)(O=>O.dashboard.initialDatasource),x=()=>{let O;if(E instanceof g.H$){const R=E.onCreateNewPanel();E.setState({editPanel:(0,b.L)(R,!0)}),r.Ny.partial({firstPanel:!0})}else O=(0,u.OK)(E,A),M((0,y.Ub)(void 0)),r.Ny.partial({editPanel:O,firstPanel:!0});P.c.emptyDashboardButtonClicked({item:"add_visualization"})},C=()=>{P.c.emptyDashboardButtonClicked({item:"import_from_library"}),E instanceof g.H$?E.onShowAddLibraryPanelDrawer():(0,u.s3)(E)};return a.createElement(d.B,{alignItems:"center",justifyContent:"center"},a.createElement("div",{className:T.wrapper},a.createElement(d.B,{alignItems:"stretch",justifyContent:"center",gap:4,direction:"column"},a.createElement(l.a,{borderColor:"strong",borderStyle:"dashed",padding:4},a.createElement(d.B,{direction:"column",alignItems:"center",gap:2},a.createElement(m.E,{element:"h1",textAlignment:"center",weight:"medium"},a.createElement(h.x6,{i18nKey:"dashboard.empty.add-visualization-header"},"Start your new dashboard by adding a visualization")),a.createElement(l.a,{marginBottom:2,paddingX:4},a.createElement(m.E,{element:"p",textAlignment:"center",color:"secondary"},a.createElement(h.x6,{i18nKey:"dashboard.empty.add-visualization-body"},"Select a data source and then query and visualize your data with charts, stats and tables or create lists, markdowns and other widgets."))),a.createElement(s.$n,{size:"lg",icon:"plus","data-testid":o.Tp.pages.AddDashboard.itemButton("Create new panel button"),onClick:x,disabled:!S},a.createElement(h.x6,{i18nKey:"dashboard.empty.add-visualization-button"},"Add visualization")))),a.createElement(d.B,{direction:{xs:"column",md:"row"},wrap:"wrap",gap:4},i.$.featureToggles.vizAndWidgetSplit&&a.createElement(l.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1},a.createElement(d.B,{direction:"column",alignItems:"center",gap:1},a.createElement(m.E,{element:"h3",textAlignment:"center",weight:"medium"},a.createElement(h.x6,{i18nKey:"dashboard.empty.add-widget-header"},"Add a widget")),a.createElement(l.a,{marginBottom:2},a.createElement(m.E,{element:"p",textAlignment:"center",color:"secondary"},a.createElement(h.x6,{i18nKey:"dashboard.empty.add-widget-body"},"Create lists, markdowns and other widgets"))),a.createElement(s.$n,{icon:"plus",fill:"outline","data-testid":o.Tp.pages.AddDashboard.itemButton("Create new widget button"),onClick:()=>{P.c.emptyDashboardButtonClicked({item:"add_widget"}),r.Ny.partial({addWidget:!0})},disabled:!S},a.createElement(h.x6,{i18nKey:"dashboard.empty.add-widget-button"},"Add widget")))),a.createElement(l.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1},a.createElement(d.B,{direction:"column",alignItems:"center",gap:1},a.createElement(m.E,{element:"h3",textAlignment:"center",weight:"medium"},a.createElement(h.x6,{i18nKey:"dashboard.empty.add-library-panel-header"},"Import panel")),a.createElement(l.a,{marginBottom:2},a.createElement(m.E,{element:"p",textAlignment:"center",color:"secondary"},a.createElement(h.x6,{i18nKey:"dashboard.empty.add-library-panel-body"},"Add visualizations that are shared with other dashboards."))),a.createElement(s.$n,{icon:"plus",fill:"outline","data-testid":o.Tp.pages.AddDashboard.itemButton("Add a panel from the panel library button"),onClick:C,disabled:!S},a.createElement(h.x6,{i18nKey:"dashboard.empty.add-library-panel-button"},"Add library panel")))),a.createElement(l.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1},a.createElement(d.B,{direction:"column",alignItems:"center",gap:1},a.createElement(m.E,{element:"h3",textAlignment:"center",weight:"medium"},a.createElement(h.x6,{i18nKey:"dashboard.empty.import-a-dashboard-header"},"Import a dashboard")),a.createElement(l.a,{marginBottom:2},a.createElement(m.E,{element:"p",textAlignment:"center",color:"secondary"},a.createElement(h.x6,{i18nKey:"dashboard.empty.import-a-dashboard-body"},"Import dashboards from files or ",a.createElement("a",{href:"https://grafana.com/grafana/dashboards/"},"grafana.com"),"."))),a.createElement(s.$n,{icon:"upload",fill:"outline","data-testid":o.Tp.pages.AddDashboard.itemButton("Import dashboard button"),onClick:()=>{P.c.emptyDashboardButtonClicked({item:"import_dashboard"}),(0,u.VF)()},disabled:!S},a.createElement(h.x6,{i18nKey:"dashboard.empty.import-dashboard-button"},"Import dashboard"))))))))};function D(E){return{wrapper:(0,n.css)({label:"dashboard-empty-wrapper",flexDirection:"column",maxWidth:"890px",gap:E.spacing.gridSize*4,paddingTop:E.spacing(2),[E.breakpoints.up("sm")]:{paddingTop:E.spacing(12)}})}}},39569:(Q,I,e)=>{"use strict";e.d(I,{L:()=>Yn});var n=e(96540),a=e(71468),o=e(79971),r=e(80095),i=e(94701);function f({children:nt,width:yt,height:Vt,onLoad:je,onChange:tt}){const Dt=(0,n.useId)(),[Ot,Lt]=(0,n.useState)(!1),[Gt,hn]=(0,n.useState)(!1),mt=(0,n.useRef)(null);return(0,i.A)(()=>{f.addCallback(Dt,Jt=>{!Ot&&Jt.isIntersecting&&(Lt(!0),je?.()),hn(Jt.isIntersecting),tt?.(Jt.isIntersecting)});const Bt=mt.current;return Bt&&f.observer.observe(Bt),()=>{delete f.callbacks[Dt],Bt&&f.observer.unobserve(Bt),Object.keys(f.callbacks).length===0&&f.observer.disconnect()}}),n.createElement("div",{id:Dt,ref:mt,style:{width:yt,height:Vt}},Ot&&(typeof nt=="function"?nt({isInView:Gt}):nt))}const d={};f.callbacks=d,f.addCallback=(nt,yt)=>f.callbacks[nt]=yt,f.observer=new IntersectionObserver(nt=>{for(const yt of nt)f.callbacks[yt.target.id]&&f.callbacks[yt.target.id](yt)},{rootMargin:"100px"});var l=e(64423),m=e(39070),s=e(43127),h=e(7376),u=e(91052),b=e(2913),g=e(15054),P=e(40334),c=e(74856),y=e(36663),p=e(72574),v=e(12131),D=e(32264),E=e(7758),S=e(16560),T=e(32349),M=e(8480),A=e(32196),x=e(43585),C=e(40845),O=e(56034),R=e(14578),L=e(15666),N=e(38138),F=e(83122),K=e(27746);function B({panelLinks:nt,onShowPanelLinks:yt}){const Vt=(0,C.of)(w),je=()=>{const tt=yt();return n.createElement(N.W,null,tt?.map((Dt,Ot)=>n.createElement(N.W.Item,{key:Ot,label:Dt.title,url:Dt.href,target:Dt.target,onClick:Dt.onClick})))};if(nt.length===1){const tt=yt()[0];return n.createElement(u.NR.TitleItem,{href:tt.href,onClick:tt.onClick,target:tt.target,title:tt.title},n.createElement(R.I,{name:"external-link-alt",size:"md"}))}else return n.createElement(F.m,{overlay:je},n.createElement(K.I,{icon:"external-link-alt",iconSize:"md","aria-label":"panel links",className:Vt.menuTrigger}))}const w=nt=>({menuTrigger:(0,A.css)({height:"100%",background:"inherit",border:"none",borderRadius:`${nt.shape.radius.default}`,cursor:"context-menu"})});var U=e(2038);function W(nt){const{alertState:yt,data:Vt,panelId:je,onShowPanelLinks:tt,panelLinks:Dt,angularNotice:Ot}=nt,Lt=(0,C.of)(_),Gt=n.createElement(O.m,{content:yt??"unknown"},n.createElement(u.NR.TitleItem,{className:(0,A.cx)({[Lt.ok]:yt===x.O.OK,[Lt.pending]:yt===x.O.Pending,[Lt.alerting]:yt===x.O.Alerting})},n.createElement(R.I,{name:yt==="alerting"?"heart-break":"heart",className:"panel-alert-icon",size:"md"}))),hn=n.createElement(n.Fragment,null,Vt.request&&Vt.request.timeInfo&&n.createElement(O.m,{content:n.createElement(L.xS,{timeRange:Vt.request?.range,timeZone:Vt.request?.timezone})},n.createElement(u.NR.TitleItem,{className:Lt.timeshift},n.createElement(R.I,{name:"clock-nine",size:"md"})," ",Vt.request?.timeInfo))),mt=`This ${V(Ot)} requires Angular (deprecated).`,Bt=n.createElement(O.m,{content:mt},n.createElement(u.NR.TitleItem,{className:Lt.angularNotice,"data-testid":"angular-deprecation-icon"},n.createElement(R.I,{name:"exclamation-triangle",size:"md"})));return n.createElement(n.Fragment,null,Dt&&Dt.length>0&&tt&&n.createElement(B,{onShowPanelLinks:tt,panelLinks:Dt}),n.createElement(U.Z,{panelId:je,frames:Vt.series}),hn,yt&&Gt,Ot?.show&&Bt)}const V=nt=>nt?.isAngularPanel?"panel":nt?.isAngularDatasource?"data source":"panel or data source",_=nt=>({ok:(0,A.css)({color:nt.colors.success.text}),pending:(0,A.css)({color:nt.colors.warning.text}),alerting:(0,A.css)({color:nt.colors.error.text}),timeshift:(0,A.css)({color:nt.colors.text.link,gap:nt.spacing(.5),whiteSpace:"nowrap","&:hover":{color:nt.colors.emphasize(nt.colors.text.link,.03)}}),angularNotice:(0,A.css)({color:nt.colors.warning.text})});function H(nt){function yt(){return nt.data.request&&nt.data.request.timeInfo?!1:!nt.panel.hasTitle()}const Vt=()=>{const It=(0,p.w)().replace(nt.panel.description,nt.panel.scopedVars);return(0,y.G)(It)},je=()=>{const It=(0,T.E7)(nt.panel);if(!It)return[];const Xe=It&&It.getLinks(nt.panel.replaceVariables);return Xe.map(jn=>({...jn,onClick:(...Qn)=>{E.c.panelLinkClicked({has_multiple_links:Xe.length>1}),jn.onClick?.(...Qn)}}))},tt=(It,Xe)=>{It.stopPropagation(),v.Ny.partial({inspect:nt.panel.id,inspectTab:Xe})},Dt=It=>{It.stopPropagation(),v.Ny.partial({inspect:nt.panel.id,inspectTab:S.q.Error}),E.c.panelStatusMessageClicked()},Ot=()=>{nt.panel.getQueryRunner().cancelQuery(),E.c.panelCancelQueryClicked({data_state:nt.data.state})},Lt=nt.plugin.noPadding?"none":"md",Gt=nt.data.alertState?.state,hn=nt.panel.datasource?.uid?(0,M.Hv)(nt.panel.datasource?.uid):!1,mt=nt.panel.isAngularPlugin()&&!nt.plugin.meta.angular?.hideDeprecation,Bt=(D.$.featureToggles.angularDeprecationUI??!1)&&(hn||mt),Rn=(nt.panel.links&&nt.panel.links.length>0&&je||nt.data.series.length>0&&nt.data.series.some(It=>(It.meta?.notices?.length??0)>0)||nt.data.request&&nt.data.request.timeInfo||Bt||Gt)&&n.createElement(W,{alertState:Gt,data:nt.data,panelId:nt.panel.id,panelLinks:nt.panel.links,angularNotice:{show:Bt,isAngularDatasource:hn,isAngularPanel:mt},onShowPanelLinks:je}),Mt=nt.panel.description?Vt:void 0,wt=!(nt.isViewing||nt.isEditing)&&(nt.isDraggable??!0)?"grid-drag-handle":"",Ht=nt.panel.getDisplayTitle();return{hasOverlayHeader:yt,onShowPanelDescription:Vt,onShowPanelLinks:je,onOpenInspector:tt,onOpenErrorInspect:Dt,onCancelQuery:Ot,padding:Lt,description:Mt,dragClass:wt,title:Ht,titleItems:Rn,onOpenMenu:()=>{E.c.panelMenuShown()}}}var G=e(13544);function j({items:nt}){const yt=Vt=>Vt.map(je=>{switch(je.type){case"divider":return n.createElement(N.W.Divider,{key:je.text});case"group":return n.createElement(N.W.Group,{key:je.text,label:je.text},je.subMenu?yt(je.subMenu):void 0);default:return n.createElement(N.W.Item,{key:je.text,label:je.text,icon:je.iconClassName,childItems:je.subMenu?yt(je.subMenu):void 0,url:je.href,onClick:je.onClick,shortcut:je.shortcut,testId:G.Tp.components.Panels.Panel.menuItems(je.text)})}});return n.createElement(N.W,null,yt(nt))}var Y=e(74135),oe=e(1933),se=e(3197),ne=e(31678),ee=e(76885),Z=e(3169),z=e(8484),q=e(16001),ie=e(16233),de=e(94954),ue=e(87490),fe=e(63066),Se=e(19752),he=e(82792),ce=e(75462),me=e(14348),pe=e(99140),ye=e(75471),Pe=e(29436);function Ie(nt,yt,Vt,je){const tt=wn=>{wn.preventDefault(),v.Ny.partial({viewPanel:yt.id}),E.c.panelMenuItemClicked("view")},Dt=wn=>{wn.preventDefault(),v.Ny.partial({editPanel:yt.id}),E.c.panelMenuItemClicked("edit")},Ot=wn=>{wn.preventDefault(),(0,Se.Mc)(nt,yt),E.c.panelMenuItemClicked("share")},Lt=wn=>{wn.preventDefault(),(0,Se.d7)(nt,yt),E.c.panelMenuItemClicked("createLibraryPanel")},Gt=wn=>{wn.preventDefault(),(0,Se.ZY)(yt),E.c.panelMenuItemClicked("unlinkLibraryPanel")},hn=wn=>{v.Ny.partial({inspect:yt.id,inspectTab:wn}),E.c.panelMenuInspectClicked(wn??S.q.Data)},mt=wn=>{wn.preventDefault()},Bt=wn=>{wn.preventDefault(),(0,Se.iU)(nt,yt),E.c.panelMenuItemClicked("duplicate")},Jt=wn=>{wn.preventDefault(),(0,Se.KJ)(yt),E.c.panelMenuItemClicked("copy")},Rn=wn=>{wn.preventDefault(),(0,Se.FC)(nt,yt,!0),E.c.panelMenuItemClicked("remove")},Mt=wn=>{wn.preventDefault();const sa=wn.ctrlKey||wn.metaKey?La=>window.open(`${b.Ay.appSubUrl}${La}`):void 0;pe.M_.dispatch((0,Pe.ow)(yt,{timeRange:(0,c.jG)().timeRange(),getExploreUrl:ue.Xe,openInNewWindow:sa})),E.c.panelMenuItemClicked("explore")},wt=wn=>{wn.preventDefault(),(0,Se.ET)(yt),E.c.panelMenuItemClicked("toggleLegend")},Ht=[];yt.isEditing||Ht.push({text:(0,z.t)("panel.header-menu.view","View"),iconClassName:"eye",onClick:tt,shortcut:"v"}),nt.canEditPanel(yt)&&!yt.isEditing&&Ht.push({text:(0,z.t)("panel.header-menu.edit","Edit"),iconClassName:"edit",onClick:Dt,shortcut:"e"}),Ht.push({text:(0,z.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",onClick:Ot,shortcut:"p s"}),ie.TP.hasAccessToExplore()&&!(yt.plugin&&yt.plugin.meta.skipDataQuery)&&yt.datasource?.uid!==me.K&&Ht.push({text:(0,z.t)("panel.header-menu.explore","Explore"),iconClassName:"compass",onClick:Mt,shortcut:"p x"});const tn=[];yt.plugin&&!yt.plugin.meta.skipDataQuery&&(tn.push({text:(0,z.t)("panel.header-menu.inspect-data","Data"),onClick:wn=>hn(S.q.Data)}),nt.meta.canEdit&&tn.push({text:(0,z.t)("panel.header-menu.query","Query"),onClick:wn=>hn(S.q.Query)})),tn.push({text:(0,z.t)("panel.header-menu.inspect-json","Panel JSON"),onClick:wn=>hn(S.q.JSON)}),Ht.push({type:"submenu",text:(0,z.t)("panel.header-menu.inspect","Inspect"),iconClassName:"info-circle",onClick:wn=>{const sa=wn.currentTarget,La=wn.target;(La===sa||La instanceof HTMLElement&&La.closest('[role="menuitem"]')===sa)&&hn()},shortcut:"i",subMenu:tn});const It=async()=>{let wn;try{wn=await(0,fe.mp)(yt,nt)}catch(La){const xa=`Error getting rule values from the panel: ${(0,de.q)(La)}`;(0,pe.JD)((0,q.dx)((0,Z.gi)(xa)));return}const sa=ee.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(wn),returnTo:location.pathname+location.search});v.Ny.push(sa)},Xe=wn=>{wn.preventDefault(),It(),E.c.panelMenuItemClicked("create-alert")},jn=[],Qn=nt.canEditPanel(yt),ia=(0,ye.q0)();if(yt.isViewing||yt.isEditing||(Qn?(jn.push({text:(0,z.t)("panel.header-menu.duplicate","Duplicate"),onClick:Bt,shortcut:"p d"}),jn.push({text:(0,z.t)("panel.header-menu.copy","Copy"),onClick:Jt}),(0,he.X)(yt)?jn.push({text:(0,z.t)("panel.header-menu.unlink-library-panel","Unlink library panel"),onClick:Gt}):jn.push({text:(0,z.t)("panel.header-menu.create-library-panel","Create library panel"),onClick:Lt})):ie.TP.isEditor&&jn.push({text:(0,z.t)("panel.header-menu.copy","Copy"),onClick:Jt})),ia&&jn.push({text:(0,z.t)("panel.header-menu.new-alert-rule","New alert rule"),onClick:Xe}),je){const wn=je.getScope(),sa=wn.$$childHead.ctrl,La=sa.getExtendedMenu();for(const xa of La){const ga={text:xa.text,href:xa.href,shortcut:xa.shortcut};xa.click&&(ga.onClick=()=>{wn.$eval(xa.click,{ctrl:sa})}),jn.push(ga)}}return yt.options.legend&&jn.push({text:yt.options.legend.showLegend?(0,z.t)("panel.header-menu.hide-legend","Hide legend"):(0,z.t)("panel.header-menu.show-legend","Show legend"),onClick:wt,shortcut:"p l"}),yt.isEditing&&(jn.length=0,ia&&jn.push({text:(0,z.t)("panel.header-menu.new-alert-rule","New alert rule"),onClick:Xe})),Qn&&yt.plugin&&!yt.plugin.meta.skipDataQuery&&jn.push({text:(0,z.t)("panel.header-menu.get-help","Get help"),onClick:wn=>hn(S.q.Help)}),Vt.length>0&&!yt.isEditing&&Ht.push({text:"Extensions",iconClassName:"plug",type:"submenu",subMenu:(0,ce.N9)(Vt)}),jn.length&&Ht.push({type:"submenu",text:(0,z.t)("panel.header-menu.more","More..."),iconClassName:"cube",subMenu:jn,onClick:mt}),nt.canEditPanel(yt)&&!yt.isEditing&&!yt.isViewing&&(Ht.push({type:"divider",text:""}),Ht.push({text:(0,z.t)("panel.header-menu.remove","Remove"),iconClassName:"trash-alt",onClick:Rn,shortcut:"p r"})),Ht}function Oe({panel:nt,dashboard:yt,loadingState:Vt,children:je}){const[tt,Dt]=(0,n.useState)([]),Ot=(0,ne.useSelector)(hn=>(0,P.U)(hn,nt)?.angularComponent),Lt=(0,n.useMemo)(()=>Ne(nt,yt),[nt,yt]),{extensions:Gt}=(0,se.vl)({extensionPointId:Y.S.DashboardPanelMenu,context:Lt,limitPerPlugin:3});return(0,n.useEffect)(()=>{Dt(Ie(yt,nt,Gt,Ot))},[yt,nt,Ot,Vt,Dt,Gt]),je({items:tt})}function Ne(nt,yt){return{id:nt.id,pluginId:nt.type,title:nt.title,timeRange:yt.time,timeZone:(0,oe.O)({timeZone:yt.timezone}),dashboard:{uid:yt.uid,title:yt.title,tags:Array.from(yt.tags)},targets:nt.targets,scopedVars:nt.scopedVars,data:nt.getQueryRunner().getLastResult()}}function We({style:nt,panel:yt,dashboard:Vt,loadingState:je}){return n.createElement(Oe,{panel:yt,dashboard:Vt,loadingState:je},({items:tt})=>n.createElement(j,{style:nt,items:tt}))}class Ae extends n.PureComponent{constructor(yt){super(yt),this.element=null,this.timeSrv=(0,c.jG)(),this.subs=new l.yU,this.state={data:{state:m.Gu.NotStarted,series:[],timeRange:(0,s.E2)()}}}componentDidMount(){const{panel:yt}=this.props;this.loadAngularPanel();const Vt=yt.getQueryRunner();this.subs.add(Vt.getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:je=>this.onPanelDataUpdate(je)}))}onPanelDataUpdate(yt){let Vt;if(yt.state===m.Gu.Error){const{error:je}=yt;je&&Vt!==je.message&&(Vt=je.message)}this.setState({data:yt,errorMessage:Vt})}componentWillUnmount(){this.subs.unsubscribe(),this.props.angularComponent&&this.props.angularComponent?.destroy()}componentDidUpdate(yt,Vt){const{plugin:je,height:tt,width:Dt,panel:Ot}=this.props;yt.plugin!==je&&this.loadAngularPanel(),(yt.width!==Dt||yt.height!==tt)&&this.scopeProps&&(this.scopeProps.size.height=this.getInnerPanelHeight(),this.scopeProps.size.width=this.getInnerPanelWidth(),Ot.render())}getInnerPanelHeight(){const{plugin:yt,height:Vt}=this.props,{theme:je}=b.Ay,tt=this.hasOverlayHeader()?0:je.panelHeaderHeight,Dt=yt.noPadding?0:je.panelPadding;return Vt-tt-Dt*2-g.IZ}getInnerPanelWidth(){const{plugin:yt,width:Vt}=this.props,{theme:je}=b.Ay,tt=yt.noPadding?0:je.panelPadding;return Vt-tt*2-g.IZ}loadAngularPanel(){const{panel:yt,dashboard:Vt,setPanelAngularComponent:je}=this.props;if(!this.element)return;const tt=(0,h.E)(),Dt='<plugin-component type="panel" class="panel-height-helper"></plugin-component>';this.scopeProps={panel:yt,dashboard:Vt,size:{width:this.getInnerPanelWidth(),height:this.getInnerPanelHeight()}},je({key:yt.key,angularComponent:tt.load(this.element,this.scopeProps,Dt)})}hasOverlayHeader(){const{panel:yt}=this.props,{data:Vt}=this.state;return Vt.request&&Vt.request.timeInfo?!1:!yt.hasTitle()}render(){const{dashboard:yt,panel:Vt}=this.props,{errorMessage:je,data:tt}=this.state,{transparent:Dt}=Vt,Ot=H({...this.props,data:tt}),Lt=(Vt.gridPos?.y??0)===0?-16:void 0,Gt=n.createElement("div",{"data-testid":"panel-dropdown"},n.createElement(We,{panel:Vt,dashboard:yt,loadingState:tt.state}));return n.createElement(u.NR,{width:this.props.width,height:this.props.height,title:Ot.title,loadingState:tt.state,statusMessage:je,statusMessageOnClick:Ot.onOpenErrorInspect,description:Ot.description,titleItems:Ot.titleItems,menu:this.props.hideMenu?void 0:Gt,dragClass:Ot.dragClass,dragClassCancel:"grid-drag-cancel",padding:Ot.padding,hoverHeaderOffset:Lt,hoverHeader:Ot.hasOverlayHeader(),displayMode:Dt?"transparent":"default",onCancelQuery:Ot.onCancelQuery,onOpenMenu:Ot.onOpenMenu},()=>n.createElement("div",{ref:hn=>this.element=hn,className:"panel-height-helper"}))}}const Ue=(nt,yt)=>({angularComponent:(0,P.U)(nt,yt.panel)?.angularComponent}),Me={setPanelAngularComponent:r.S3},$e=(0,a.connect)(Ue,Me)(Ae);var ke=e(2543),Ze=e(94624),ot=e(41987),xt=e(69129),ct=e(47232),ft=e(22391),Le=e(14236),re=e(3591),X=e(79041),le=e(66602),be=e(28138),De=e(18898),Te=e(31193),we=e(26260),Ke=e(90478),Ve=e(1173),ht=e(24293);const gt=(nt,yt,Vt)=>{const{overrides:je}=Vt,tt=Vt.overrides.findIndex(hn=>hn.matcher.id===Ve.Ct.byName&&hn.matcher.options===nt);if(tt<0)return{...Vt,overrides:[...Vt.overrides,bt(nt,yt)]};const Dt=Array.from(je),Ot=Dt[tt],Lt=Ot.properties.findIndex(hn=>hn.id==="color");if(Lt<0)return Dt[tt]={...Ot,properties:[...Ot.properties,St(yt)]},{...Vt,overrides:Dt};const Gt=Array.from(Ot.properties);return Gt[Lt]=St(yt),Dt[tt]={...Ot,properties:Gt},{...Vt,overrides:Dt}},bt=(nt,yt)=>({matcher:{id:Ve.Ct.byName,options:nt},properties:[St(yt)]}),St=nt=>({id:"color",value:{mode:ht.Y.Fixed,fixedColor:nt}});var Je=e(28444),rt=e(10154),Rt=e(42972),_t=e(60444),nn=e(32631),Kt=(nt=>(nt.FIELD_CONFIG_OVERRIDES_CHANGED_EVENT="field config overrides changed",nt.NEW_PANEL_OPTION_EVENT="new panel option",nt.PANEL_OPTION_CHANGED_EVENT="panel option changed",nt.NEW_DEFAULT_FIELD_CONFIG_EVENT="new default field config",nt.DEFAULT_FIELD_CONFIG_CHANGED_EVENT="default field config changed",nt.NEW_CUSTOM_FIELD_CONFIG_EVENT="new custom field config",nt.CUSTOM_FIELD_CONFIG_CHANGED_EVENT="custom field config changed",nt.MEASURE_PANEL_LOAD_TIME_EVENT="measure panel load time",nt.THRESHOLDS_COUNT_CHANGED_EVENT="thresholds count changed",nt.THRESHOLDS_MODE_CHANGED_EVENT="thresholds mode changed",nt.MAPPINGS_COUNT_CHANGED_EVENT="mappings count changed",nt.LINKS_COUNT_CHANGED_EVENT="links count changed",nt.PANEL_ERROR="panel error",nt))(Kt||{});const en="overrides",Qt="custom",An=nt=>{const yt=performance.now();return(0,n.useEffect)(()=>{b.config.grafanaJavascriptAgent.enabled&&requestAnimationFrame(()=>{setTimeout(()=>{nn.P.api.pushMeasurement({type:Kt.MEASURE_PANEL_LOAD_TIME_EVENT,values:{start_loading_time_ms:yt,load_time_ms:performance.now()-yt}},{context:{panel_type:nt.panelType,panel_id:String(nt.panelId),panel_title:nt.panelTitle}})},0)})},[]),null};var un=e(91126),fn=e(61582);class Tt{constructor(yt,Vt,je){this.logChanges=(tt,Dt)=>{this.logPanelOptionChanges(tt,this.initialPanelOptions),this.logFieldConfigChanges(Dt,this.initialFieldConfig),this.initialPanelOptions=tt,this.initialFieldConfig=Dt},this.logPanelEvent=(tt,Dt,Ot,Lt)=>{const Gt={key:Dt,newValue:Ot,oldValue:Lt??"",panelTitle:this.panelLogInfo.panelTitle,panelId:this.panelLogInfo.panelId,panelType:this.panelLogInfo.panelType};nn.P.api.pushEvent(tt,Gt)},this.logPanelOptionChanges=(tt,Dt)=>{if(typeof tt!="object"||tt===null||typeof Dt!="object"||Dt===null)return;const Ot={...Dt};for(const[Lt,Gt]of Object.entries(tt)){const hn=typeof Gt!="string"?JSON.stringify(Gt):Gt,mt=typeof Gt!="string"?JSON.stringify(Ot[Lt]):String(Ot[Lt]);Ot[Lt]===void 0?this.logPanelEvent(Kt.NEW_PANEL_OPTION_EVENT,Lt,hn):mt!==hn&&this.logPanelEvent(Kt.PANEL_OPTION_CHANGED_EVENT,Lt,hn,mt)}},this.logFieldConfigChanges=(tt,Dt)=>{const Ot=JSON.stringify(Dt.overrides),Lt=JSON.stringify(tt.overrides);Ot!==Lt&&this.logPanelEvent(Kt.FIELD_CONFIG_OVERRIDES_CHANGED_EVENT,en,Lt,Ot);const Gt={...Dt.defaults};for(const[mt,Bt]of Object.entries(tt.defaults)){if(mt===Qt)continue;const Jt=typeof Bt!="string"?JSON.stringify(Bt):Bt,Rn=typeof Bt!="string"?JSON.stringify(Gt[mt]):String(Gt[mt]);Gt[mt]===void 0?this.logPanelEvent(Kt.NEW_DEFAULT_FIELD_CONFIG_EVENT,mt,Jt):Rn!==Jt&&this.logPanelEvent(Kt.DEFAULT_FIELD_CONFIG_CHANGED_EVENT,mt,Jt,Rn)}if(!tt.defaults.custom||Gt.custom===void 0)return;const hn={...Gt.custom};for(const[mt,Bt]of Object.entries(tt.defaults.custom)){if(Gt.custom===null||hn[mt]===null)continue;const Jt=typeof Bt!="string"?JSON.stringify(Bt):Bt,Rn=typeof Bt!="string"?JSON.stringify(hn[mt]):String(hn[mt]);hn[mt]===void 0?this.logPanelEvent(Kt.NEW_CUSTOM_FIELD_CONFIG_EVENT,mt,Jt):Rn!==Jt&&this.logPanelEvent(Kt.CUSTOM_FIELD_CONFIG_CHANGED_EVENT,mt,Jt,Rn)}},this.initialPanelOptions=yt,this.initialFieldConfig=Vt,this.panelLogInfo=je}}const $t="Error in plugin";class Yt extends n.PureComponent{constructor(yt){super(yt),this.timeSrv=(0,c.jG)(),this.subs=new l.yU,this.eventFilter={onlyLocal:!0},this.panelOptionsLogger=void 0,this.getSync=()=>this.props.isEditing?Ze.y.Off:this.props.dashboard.graphTooltip,this.onInstanceStateChange=je=>{this.props.onInstanceStateChange(je),this.setState({context:{...this.state.context,instanceState:je}})},this.onUpdateData=je=>(0,Ke.H)(this.props.panel,je),this.onSeriesColorChange=(je,tt)=>{this.onFieldConfigChange(gt(je,tt,this.props.panel.fieldConfig))},this.onSeriesVisibilityChange=(je,tt)=>{this.onFieldConfigChange((0,un.M)(je,tt,this.props.panel.fieldConfig,this.state.data.series))},this.onToggleLegendSort=je=>{const tt=this.props.panel.options.legend;if(!tt)return;let Dt=tt.sortDesc,Ot=tt.sortBy;je!==Ot&&(Dt=void 0),Dt===!1?(Ot=void 0,Dt=void 0):(Dt=!Dt,Ot=je),this.onOptionsChange({...this.props.panel.options,legend:{...tt,sortBy:Ot,sortDesc:Dt}})},this.onRefresh=()=>{const{dashboard:je,panel:tt,isInView:Dt,width:Ot}=this.props;if(!je.snapshot&&!Dt){tt.refreshWhenInView=!0;return}const Lt=(0,Se.nk)(tt,this.timeSrv.timeRange());if(this.wantsQueryExecution){if(Ot<0)return;tt.refreshWhenInView=!1,tt.runAllPanelQueries({dashboardUID:je.uid,dashboardTimezone:je.getTimezone(),timeData:Lt,width:Ot})}else this.setState({data:{...this.state.data,timeRange:this.timeSrv.timeRange()},renderCounter:this.state.renderCounter+1,liveTime:void 0})},this.onRender=()=>{const je={renderCounter:this.state.renderCounter+1};this.setState(je)},this.onOptionsChange=je=>{this.props.panel.updateOptions(je)},this.onFieldConfigChange=je=>{this.props.panel.updateFieldConfig(je)},this.onPanelError=je=>{b.Ay.featureToggles.panelMonitoring&&this.getPanelContextApp()===ot.Jk.PanelEditor&&this.logPanelChangesOnError();const tt=je.message||$t;this.state.errorMessage!==tt&&this.setState({errorMessage:tt})},this.onPanelErrorRecover=()=>{this.setState({errorMessage:void 0})},this.onAnnotationCreate=async je=>{const tt=je.from!==je.to,Dt={dashboardUID:this.props.dashboard.uid,panelId:this.props.panel.id,isRegion:tt,time:je.from,timeEnd:tt?je.to:0,tags:je.tags,text:je.description};await(0,rt.vJ)(Dt),(0,Rt.Dh)().run({dashboard:this.props.dashboard,range:this.timeSrv.timeRange()}),this.state.context.eventBus.publish(new xt.We(Dt))},this.onAnnotationDelete=async je=>{await(0,rt.Xm)({id:je}),(0,Rt.Dh)().run({dashboard:this.props.dashboard,range:this.timeSrv.timeRange()}),this.state.context.eventBus.publish(new xt.We({id:je}))},this.onAnnotationUpdate=async je=>{const tt=je.from!==je.to,Dt={id:je.id,dashboardUID:this.props.dashboard.uid,panelId:this.props.panel.id,isRegion:tt,time:je.from,timeEnd:tt?je.to:0,tags:je.tags,text:je.description};await(0,rt.rJ)(Dt),(0,Rt.Dh)().run({dashboard:this.props.dashboard,range:this.timeSrv.timeRange()}),this.state.context.eventBus.publish(new xt.We(Dt))},this.onChangeTimeRange=je=>{this.timeSrv.setTime({from:(0,ct.yT)(je.from),to:(0,ct.yT)(je.to)})},this.onAddAdHocFilter=je=>{const{key:tt,value:Dt,operator:Ot}=je,Lt=(0,Te.tR)().getInstanceSettings(this.props.panel.datasource),Gt=Lt&&(0,ft.p$)(Lt);Gt&&(0,pe.JD)((0,we.z_)({datasource:Gt,key:tt,operator:Ot,value:Dt}))};const Vt=yt.dashboard.events.newScopedBus(`panel:${yt.panel.id}`,this.eventFilter);if(this.debouncedSetPanelAttention=(0,ke.debounce)(this.setPanelAttention.bind(this),100),this.state={isFirstLoad:!0,renderCounter:0,context:{eventsScope:"__global_",eventBus:Vt,app:this.getPanelContextApp(),sync:this.getSync,onSeriesColorChange:this.onSeriesColorChange,onToggleSeriesVisibility:this.onSeriesVisibilityChange,onAnnotationCreate:this.onAnnotationCreate,onAnnotationUpdate:this.onAnnotationUpdate,onAnnotationDelete:this.onAnnotationDelete,onInstanceStateChange:this.onInstanceStateChange,onToggleLegendSort:this.onToggleLegendSort,canAddAnnotations:yt.dashboard.canAddAnnotations.bind(yt.dashboard),canEditAnnotations:yt.dashboard.canEditAnnotations.bind(yt.dashboard),canDeleteAnnotations:yt.dashboard.canDeleteAnnotations.bind(yt.dashboard),onAddAdHocFilter:this.onAddAdHocFilter,onUpdateData:this.onUpdateData},data:this.getInitialPanelDataState()},b.Ay.featureToggles.panelMonitoring&&this.getPanelContextApp()===ot.Jk.PanelEditor){const je={panelId:String(yt.panel.id),panelType:yt.panel.type,panelTitle:yt.panel.title};this.panelOptionsLogger=new Tt(yt.panel.getOptions(),yt.panel.fieldConfig,je)}}getPanelContextApp(){return this.props.isEditing?ot.Jk.PanelEditor:this.props.isViewing?ot.Jk.PanelViewer:ot.Jk.Dashboard}getInitialPanelDataState(){return{state:m.Gu.NotStarted,series:[],timeRange:(0,s.E2)()}}componentDidMount(){const{panel:yt,dashboard:Vt}=this.props;if(this.subs.add(yt.events.subscribe(re._,this.onRefresh)),this.subs.add(yt.events.subscribe(Je.XM,this.onRender)),Vt.panelInitialized(this.props.panel),this.hasPanelSnapshot){this.setState({data:(0,_t.d)(yt,Vt),isFirstLoad:!1});return}this.wantsQueryExecution||this.setState({isFirstLoad:!1}),this.subs.add(yt.getQueryRunner().getData({withTransforms:!0,withFieldConfig:!0}).subscribe({next:je=>this.onDataUpdate(je)})),fn.a.listen(this)}componentWillUnmount(){this.subs.unsubscribe(),fn.a.remove(this)}liveTimeChanged(yt){const{data:Vt}=this.state;if(Vt.timeRange){const je=yt.to.valueOf()-Vt.timeRange.to.valueOf();if(je<100){console.log("Skip tick render",this.props.panel.title,je);return}}this.setState({liveTime:yt})}componentDidUpdate(yt){const{isInView:Vt,width:je,panel:tt}=this.props,{context:Dt}=this.state,Ot=this.getPanelContextApp();Dt.app!==Ot&&this.setState({context:{...Dt,app:Ot}}),Vt!==yt.isInView&&Vt&&tt.refreshWhenInView&&this.onRefresh(),je!==yt.width&&fn.a.updateInterval(this)}onDataUpdate(yt){const{dashboard:Vt,panel:je,plugin:tt}=this.props;if(tt.meta.skipDataQuery){this.setState({data:this.getInitialPanelDataState()});return}let{isFirstLoad:Dt}=this.state,Ot;switch(yt.state){case m.Gu.Loading:if(this.state.data.state===m.Gu.Loading)return;break;case m.Gu.Error:const{error:Lt,errors:Gt}=yt;Gt?.length?Gt.length===1?Ot=Gt[0].message:Ot="Multiple errors found. Click for more details":Lt&&Ot!==Lt.message&&(Ot=Lt.message);break;case m.Gu.Done:Vt.snapshot&&(je.snapshotData=yt.series.map(hn=>(0,Le.Kl)(hn))),Dt&&(Dt=!1);break}this.setState({isFirstLoad:Dt,errorMessage:Ot,data:yt,liveTime:void 0})}logPanelChangesOnError(){this.panelOptionsLogger.logChanges(this.props.panel.getOptions(),this.props.panel.fieldConfig)}get hasPanelSnapshot(){const{panel:yt}=this.props;return yt.snapshotData&&yt.snapshotData.length}get wantsQueryExecution(){return!(this.props.plugin.meta.skipDataQuery||this.hasPanelSnapshot)}shouldSignalRenderingCompleted(yt,Vt){return yt===m.Gu.Done||yt===m.Gu.Streaming||yt===m.Gu.Error||Vt.skipDataQuery}skipFirstRender(yt){const{isFirstLoad:Vt}=this.state;return this.wantsQueryExecution&&Vt&&(yt===m.Gu.Loading||yt===m.Gu.NotStarted)}renderPanelContent(yt,Vt){const{panel:je,plugin:tt,dashboard:Dt}=this.props,{renderCounter:Ot,data:Lt}=this.state,{state:Gt}=Lt;if(this.skipFirstRender(Gt))return null;this.shouldSignalRenderingCompleted(Gt,tt.meta)&&De.E.renderingCompleted();const hn=tt.panel,mt=this.state.liveTime??Lt.timeRange??this.timeSrv.timeRange(),Bt=je.getOptions();return this.eventFilter.onlyLocal=Dt.graphTooltip===0,n.createElement(n.Fragment,null,n.createElement(X.XF,{value:this.state.context},n.createElement(hn,{id:je.id,data:Lt,title:je.title,timeRange:mt,timeZone:this.props.dashboard.getTimezone(),options:Bt,fieldConfig:je.fieldConfig,transparent:je.transparent,width:yt,height:Vt,renderCounter:Ot,replaceVariables:je.replaceVariables,onOptionsChange:this.onOptionsChange,onFieldConfigChange:this.onFieldConfigChange,onChangeTimeRange:this.onChangeTimeRange,eventBus:Dt.events}),b.Ay.featureToggles.panelMonitoring&&this.state.errorMessage===void 0&&n.createElement(An,{panelType:tt.meta.id,panelId:je.id,panelTitle:je.title})))}setPanelAttention(){be.A.publish(new xt.Tp({panelId:this.props.panel.id}))}debouncedSetPanelAttention(){}render(){const{dashboard:yt,panel:Vt,width:je,height:tt,plugin:Dt}=this.props,{errorMessage:Ot,data:Lt}=this.state,{transparent:Gt}=Vt,hn=H({...this.props,data:Lt}),mt=(Vt.gridPos?.y??0)===0?-16:void 0,Bt=n.createElement("div",{"data-testid":"panel-dropdown"},n.createElement(We,{panel:Vt,dashboard:yt,loadingState:Lt.state}));return n.createElement(u.NR,{width:je,height:tt,title:hn.title,loadingState:Lt.state,statusMessage:Ot,statusMessageOnClick:hn.onOpenErrorInspect,description:hn.description,titleItems:hn.titleItems,menu:this.props.hideMenu?void 0:Bt,dragClass:hn.dragClass,dragClassCancel:"grid-drag-cancel",padding:hn.padding,hoverHeaderOffset:mt,hoverHeader:hn.hasOverlayHeader(),displayMode:Gt?"transparent":"default",onCancelQuery:hn.onCancelQuery,onOpenMenu:hn.onOpenMenu,onFocus:()=>this.setPanelAttention(),onMouseMove:()=>this.debouncedSetPanelAttention()},(Jt,Rn)=>n.createElement(n.Fragment,null,n.createElement(le.tH,{dependencies:[Lt,Dt,Vt.getOptions()],onError:this.onPanelError,onRecover:this.onPanelErrorRecover},({error:Mt})=>Mt?null:this.renderPanelContent(Jt,Rn))))}}const Cn=(nt,yt)=>{const Vt=nt.panels[yt.stateKey];return Vt?{plugin:Vt.plugin,instanceState:Vt.instanceState}:{plugin:void 0}},Tn={initPanelState:o.Ap,setPanelInstanceState:r.nF},vn=(0,a.connect)(Cn,Tn);class Kn extends n.PureComponent{constructor(){super(...arguments),this.onInstanceStateChange=yt=>{this.props.setPanelInstanceState({key:this.props.stateKey,value:yt})},this.onVisibilityChange=yt=>{this.props.panel.isInView=yt},this.onPanelLoad=()=>{this.props.plugin||this.props.initPanelState(this.props.panel)},this.renderPanel=({isInView:yt})=>{const{dashboard:Vt,panel:je,isViewing:tt,isEditing:Dt,width:Ot,height:Lt,plugin:Gt,timezone:hn,hideMenu:mt,isDraggable:Bt=!0}=this.props;return Gt?Gt&&Gt.angularPanelCtrl?n.createElement($e,{plugin:Gt,panel:je,dashboard:Vt,isViewing:tt,isEditing:Dt,isInView:yt,isDraggable:Bt,width:Ot,height:Lt}):n.createElement(Yt,{plugin:Gt,panel:je,dashboard:Vt,isViewing:tt,isEditing:Dt,isInView:yt,isDraggable:Bt,width:Ot,height:Lt,onInstanceStateChange:this.onInstanceStateChange,timezone:hn,hideMenu:mt}):null}}static{this.defaultProps={lazy:!0}}componentDidMount(){this.props.panel.isInView=!this.props.lazy,this.props.lazy||this.onPanelLoad()}render(){const{width:yt,height:Vt,lazy:je}=this.props;return je?n.createElement(f,{width:yt,height:Vt,onChange:this.onVisibilityChange,onLoad:this.onPanelLoad},this.renderPanel):this.renderPanel({isInView:!0})}}const Yn=vn(Kn)},2038:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>h});var n=e(96540),a=e(12131),o=e(32196),r=e(40845),i=e(27746),f=e(14578),d=e(56034),l=e(16797);const m=({notice:u,onClick:b})=>{const g=(0,r.of)(s),P=u.severity==="error"||u.severity==="warning"?"exclamation-triangle":"file-landscape-alt";return u.inspect&&b?n.createElement(i.I,{className:g.notice,icon:P,iconSize:"md",key:u.severity,tooltip:u.text,onClick:c=>b(c,u.inspect)}):u.link?n.createElement("a",{className:g.notice,"aria-label":u.text,href:u.link,target:"_blank",rel:"noreferrer"},n.createElement(f.I,{name:P,style:{marginRight:"8px"},size:"md"})):n.createElement(d.m,{key:u.severity,content:u.text},n.createElement("span",{className:g.iconTooltip},n.createElement(f.I,{name:P,size:"md"})))},s=u=>({notice:(0,o.css)({background:"inherit",border:"none",borderRadius:u.shape.radius.default}),iconTooltip:(0,o.css)({color:`${u.colors.text.secondary}`,backgroundColor:"inherit",cursor:"auto",border:"none",borderRadius:`${u.shape.radius.default}`,padding:`${u.spacing(0,1)}`,height:` ${u.spacing(u.components.height.md)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,l.getFocusStyles)(u),zIndex:1},"&: focus:not(:focus-visible)":(0,l.getMouseFocusStyles)(u),"&:hover ":{boxShadow:`${u.shadows.z1}`,color:`${u.colors.text.primary}`,background:`${u.colors.background.secondary}`}})}),h=({frames:u,panelId:b})=>{const g=(0,n.useCallback)((c,y)=>{c.stopPropagation(),a.Ny.partial({inspect:b,inspectTab:y})},[b]),P={};for(const c of u)if(!(!c.meta||!c.meta.notices))for(const y of c.meta.notices)P[y.severity]=y;return n.createElement(n.Fragment,null,Object.values(P).map(c=>n.createElement(m,{notice:c,onClick:g,key:c.severity})))}},91126:(Q,I,e)=>{"use strict";e.d(I,{M:()=>s});var n=e(37055),a=e(58972),o=e(1173),r=e(11261),i=e(28240),f=e(85200),d=e(88895);const l="hideSeriesFrom",m=(0,n.ZW)(l);function s(y,p,v,D){const{overrides:E}=v,S=y,T=E.findIndex(m);if(T<0){if(p===d.B.ToggleSelection){const R=h([S,...c(E,D)]);return{...v,overrides:[...v.overrides,R]}}const C=P(D,S),O=h(C);return{...v,overrides:[...v.overrides,O]}}const M=Array.from(E),[A]=M.splice(T,1);if(p===d.B.ToggleSelection){let C=b(A);const O=c(M,D);if(O.length>0&&(C=C.filter(L=>O.indexOf(L)<0)),C[0]===S&&C.length===1)return{...v,overrides:M};const R=h([S,...O]);return{...v,overrides:[...M,R]}}const x=u(A,S);return g(x,D)?{...v,overrides:M}:{...v,overrides:[...M,x]}}function h(y,p=a.PP.exclude,v){return v=v??{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:l,matcher:{id:o.Ct.byNames,options:{mode:p,names:y,prefix:p===a.PP.exclude?"All except:":void 0,readOnly:!0}},properties:[{...v,value:{viz:!0,legend:!1,tooltip:!1}}]}}const u=(y,p,v=a.PP.exclude)=>{const D=y.properties.find(T=>T.id==="custom.hideFrom"),E=b(y),S=E.findIndex(T=>T===p);return S<0?E.push(p):E.splice(S,1),h(E,v,D)},b=y=>{const p=y.matcher.options?.names;return Array.isArray(p)?[...p]:[]},g=(y,p)=>b(y).length===P(p).length,P=(y,p)=>{const v=new Set;for(const D of y)for(const E of D.fields){if(E.type!==r.PU.number)continue;const S=(0,i.Ct)(E,D,y);S!==p&&v.add(S)}return Array.from(v)},c=(y,p)=>{let v=[];for(const D of y){const E=D.properties.find(S=>S.id==="custom.hideFrom");if(E!==void 0&&E.value?.legend===!0){const T=f.sJ.get(D.matcher.id).get(D.matcher.options);for(const M of p)for(const A of M.fields){if(A.type!==r.PU.number)continue;const x=(0,i.Ct)(A,M,p);T(A,M,p)&&v.push(x)}}}return v}},61582:(Q,I,e)=>{"use strict";e.d(I,{a:()=>l});var n=e(49426),a=e(47232),o=e(85858);const r=100;class i{constructor(){this.listeners=[],this.budget=1,this.threshold=1.5,this.ok=new n.t(!0),this.lastUpdate=Date.now(),this.isLive=!1,this.liveTimeOffset=0,this.measure=()=>{const s=Date.now();this.budget=(s-this.lastUpdate)/r;const h=this.ok.getValue(),u=this.budget<=this.threshold;if(h!==u&&this.ok.next(u),this.lastUpdate=s,this.isLive&&this.ok.getValue()&&this.timeRange){let b;for(const g of this.listeners){if(!g.panel.props.isInView)continue;if(s-g.last>=g.intervalMs){if(!b){const{raw:c}=this.timeRange;b={raw:c,from:(0,a.KQ)(s-this.liveTimeOffset),to:(0,a.KQ)(s)}}g.panel.liveTimeChanged(b),g.last=s}}}}}setLiveTimeRange(s){if(this.timeRange=s,this.isLive=s?.raw?.to==="now",this.isLive){const h=o.parse(s.raw.from,!1)?.valueOf(),u=o.parse(s.raw.to,!0)?.valueOf();this.liveTimeOffset=u-h;for(const b of this.listeners)b.intervalMs=d(this.liveTimeOffset,b.panel.props.width)}}listen(s){this.listeners.push({last:this.lastUpdate,panel:s,intervalMs:d(6e4,s.props.width)})}remove(s){this.listeners=this.listeners.filter(h=>h.panel!==s)}updateInterval(s){if(!(!this.timeRange||!this.isLive)){for(const h of this.listeners)if(h.panel===s){h.intervalMs=d(this.liveTimeOffset,h.panel.props.width);return}}}}const f=5*60*1e3;function d(m,s){const h=Math.ceil(m/s/100)*100;return h>f?f:h}const l=new i;setInterval(l.measure,r)},17493:(Q,I,e)=>{"use strict";e.d(I,{Fu:()=>D,np:()=>E});var n=e(34796),a=e.n(n),o=e(2543),r=e.n(o),i=e(95093),f=e.n(i),d=e(26272),l=e(85858),m=e(17172),s=e(12131),h=e(27677),u=e(62301),b=e(68576),g=e(72255),P=e(31193),c=e(10096),y=e(28676),p=e(14792),v=e(69064);class D{constructor(){}_dashboardLoadFailed(M,A){return A=A||!1,{meta:{canStar:!1,isSnapshot:A,canDelete:!1,canSave:!1,canEdit:!1,canShare:!1,dashboardNotFound:!0},dashboard:{title:M,uid:M,schemaVersion:0}}}loadDashboard(M,A,x){const C=(0,g.sP)();let O;if(M==="script"&&A)O=this._loadScriptedDashboard(A);else if(M==="snapshot"&&A)O=(0,v.s)().getSnapshot(A).catch(()=>this._dashboardLoadFailed("Snapshot not found",!0));else if(M==="ds"&&A)O=this._loadFromDatasource(A);else if(M==="public"&&x)O=h.IB.getPublicDashboardByUid(x).then(R=>R).catch(R=>{const L=R.data.statusCode===403&&R.data.messageId==="publicdashboards.notEnabled",N=R.data.statusCode===404&&R.data.messageId==="publicdashboards.notFound",F=R.data.statusCode===404&&R.data.messageId==="publicdashboards.dashboardNotFound",K=this._dashboardLoadFailed(L?"Public Dashboard paused":"Public Dashboard Not found",!0);return{...K,meta:{...K.meta,publicDashboardEnabled:N?void 0:!L,dashboardNotFound:N||F}}});else if(x){const R=C.getFromCache(x);if(R)return Promise.resolve(R);O=(0,y.n)().getDashboardDTO(x).then(L=>{if(L.meta.isFolder)throw c.lE.emit(d.r1.alertError,["Dashboard not found"]),new Error("Dashboard not found");return L}).catch(()=>this._dashboardLoadFailed("Not found",!0))}else throw new Error("Dashboard uid or slug required");return O.then(R=>(R.meta.dashboardNotFound!==!0&&u.A.addDashboardImpression(R.dashboard.uid),R)),O}_loadScriptedDashboard(M){const A="public/dashboards/"+M.replace(/\.(?!js)/,"/")+"?"+new Date().getTime();return(0,m.AI)().get(A).then(this._executeScript.bind(this)).then(x=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:x.data}),x=>(console.error("Script dashboard error "+x),c.lE.emit(d.r1.alertError,["Script Error","Please make sure it exists and returns a valid dashboard"]),this._dashboardLoadFailed("Scripted dashboard")))}async _loadFromDatasource(M){const A=await(0,P.tR)().get(M);if(!A)return Promise.reject("can not find datasource: "+M);const x=new URLSearchParams(window.location.search),C=x.get("path");if(!C)return Promise.reject("expecting path parameter");const O={};return x.forEach((R,L)=>{O[L]=R}),(0,m.AI)().get(`/api/datasources/uid/${A.uid}/resources/${C}`,O).then(R=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:R}))}_executeScript(M){const A={dashboardSrv:(0,p.UA)(),datasourceSrv:(0,P.tR)()},C=new Function("ARGS","kbn","dateMath","_","moment","window","document","$","jQuery","services",M)(s.Ny.getSearchObject(),b.A,l,r(),f(),window,document,a(),a(),A);return(0,o.isFunction)(C)?new Promise(O=>{C(R=>{O({data:R})})}):{data:C}}}let E=new D;const S=T=>{throw new Error("dashboardLoaderSrv can be only overriden in test environment")}},14792:(Q,I,e)=>{"use strict";e.d(I,{UA:()=>b});var n=e(75505),a=e(26272),o=e(28138),r=e(8484),i=e(27677),f=e(28676),d=e(28444),l=e(98365),m=e(19752);class s{constructor(){this.onRemovePanel=P=>{const c=this.getCurrent();c&&(0,m.FC)(c,c.getPanelById(P),!0)},o.l.subscribe(d.Vz,P=>this.onRemovePanel(P.payload))}create(P,c){return new l.G(P,c)}setCurrent(P){this.dashboard=P}getCurrent(){return this.dashboard}saveJSONDashboard(P){const c=JSON.parse(P);return(0,f.n)().saveDashboard({dashboard:c,folderUid:this.dashboard?.meta.folderUid||c.folderUid})}saveDashboard(P,c){return(0,n.s)((0,i.AI)().fetch({url:"/api/dashboards/db/",method:"POST",data:{...P,dashboard:P.dashboard.getSaveModelClone()},...c}))}starDashboard(P,c){const y=(0,i.AI)(),p={showSuccessAlert:!1,url:"/api/user/stars/dashboard/uid/"+P,method:c?"DELETE":"POST"};return y.request(p).then(()=>{const v=!c;this.dashboard?.uid===P&&(this.dashboard.meta.isStarred=v);const D=v?(0,r.t)("notifications.starred-dashboard","Dashboard starred"):(0,r.t)("notifications.unstarred-dashboard","Dashboard unstarred");return o.l.emit(a.r1.alertSuccess,[D]),v})}}let h;function u(g){h=g}function b(){return h||(h=new s),h}},69064:(Q,I,e)=>{"use strict";e.d(I,{s:()=>l});var n=e(75505),a=e(81160),o=e(17172),r=e(32264),i=e(10096);const f={create:m=>(0,o.AI)().post("/api/snapshots",m),getSnapshots:()=>(0,o.AI)().get("/api/dashboard/snapshots"),getSharingOptions:()=>(0,o.AI)().get("/api/snapshot/shared-options"),deleteSnapshot:m=>(0,o.AI)().delete("/api/snapshots/"+m),getSnapshot:async m=>{const s=await(0,o.AI)().get("/api/snapshots/"+m);return s.meta.canShare=!1,s}};class d{constructor(){this.apiVersion="dashboardsnapshot.grafana.app/v0alpha1",this.url=`/apis/${this.apiVersion}/namespaces/${r.$.namespace}/dashboardsnapshots`}async create(s){return(0,o.AI)().post(this.url+"/create",s)}async getSnapshots(){return(await(0,o.AI)().get(this.url)).items.map(h=>({key:h.metadata.name,name:h.spec.title,external:h.spec.externalUrl!=null,externalUrl:h.spec.externalUrl}))}deleteSnapshot(s){return(0,o.AI)().delete(this.url+"/"+s)}async getSharingOptions(){return(0,o.AI)().get("/api/snapshot/shared-options")}async getSnapshot(s){const h={};if(!i.contextSrv.isSignedIn){alert("TODO... need a barer token for anonymous use case");const u=`??? TODO, get anon token for snapshots (${i.contextSrv.user?.name}) ???`;h.Authorization=`Bearer ${u}`}return(0,n.s)((0,o.AI)().fetch({url:this.url+"/"+s+"/body",method:"GET",headers:h}).pipe((0,a.T)(u=>({dashboard:u.data.dashboard,meta:{isSnapshot:!0,canSave:!1,canEdit:!1,canAdmin:!1,canStar:!1,canShare:!1,canDelete:!1,isFolder:!1,provisioned:!1}}))))}}function l(){return r.$.featureToggles.kubernetesSnapshots?new d:f}},74856:(Q,I,e)=>{"use strict";e.d(I,{jG:()=>E});var n=e(2543),a=e(47232),o=e(43127),r=e(65879),i=e(26272),f=e(85858),d=e(12131),l=e(16401),m=e(76412),s=e(28138),h=e(2913),u=e(16233),b=e(80582),g=e(21380),P=e(28444),c=e(11134);function y({urlRefresh:S,currentRefresh:T,isAllowedIntervalFn:M,minRefreshInterval:A,refreshIntervals:x=c.cb}){if(!S)return T;const C=M(S),O=x.find(R=>R===S);if(!C||!O){const R=A?x.find(N=>N===A):void 0,L=x?.length?x[0]:void 0;return R??L??T}return S||T}class p{constructor(T){this.contextSrv=T,this.timeRangeForUrl=()=>{const M=this.timeRange().raw;return(0,a.Ar)(M.from)&&(M.from=M.from.valueOf().toString()),(0,a.Ar)(M.to)&&(M.to=M.to.valueOf().toString()),M},this.time=(0,o.E2)().raw,this.timeAtLoad=(0,o.E2)().raw,this.refreshTimeModel=this.refreshTimeModel.bind(this),s.A.subscribe(P.U0,M=>{this.zoomOut(M.payload.scale,M.payload.updateUrl)}),s.A.subscribe(P.Io,M=>{this.shiftTime(M.payload.direction,M.payload.updateUrl)}),s.A.subscribe(P.Rh,M=>{this.makeAbsoluteTime(M.payload.updateUrl)}),s.A.subscribe(P.Bt,()=>{this.copyTimeRangeToClipboard()}),s.A.subscribe(P.VZ,M=>{this.pasteTimeRangeFromClipboard(M.payload.updateUrl)}),document.addEventListener("visibilitychange",()=>{this.autoRefreshBlocked&&document.visibilityState==="visible"&&(this.autoRefreshBlocked=!1,this.refreshTimeModel())})}init(T){this.timeModel=T,this.time=T.time,this.refresh=T.refresh,this.initTimeFromUrl(),this.parseTime(),this.timeAtLoad=(0,n.cloneDeep)(this.time),this.refresh&&this.setAutoRefresh(this.refresh)}getValidIntervals(T){return this.contextSrv.getValidIntervals(T)}parseTime(){(0,n.isString)(this.time.from)&&this.time.from.indexOf("Z")>=0&&(this.time.from=(0,a.KQ)(this.time.from).utc()),(0,n.isString)(this.time.to)&&this.time.to.indexOf("Z")>=0&&(this.time.to=(0,a.KQ)(this.time.to).utc())}parseUrlParam(T){if(T.indexOf("now")!==-1)return T;if(T.length===8){const M=(0,a.yT)(T,"YYYYMMDD");if(M.isValid())return M}else if(T.length===15){const M=(0,a.yT)(T,"YYYYMMDDTHHmmss");if(M.isValid())return M}if(!isNaN(Number(T))){const M=parseInt(T,10);return(0,a.yT)(M)}return null}getTimeWindow(T,M){const A=parseInt(T,10);let x;return M.match(/^\d+$/)&&parseInt(M,10)?x=parseInt(M,10):x=r.intervalToMs(M),{from:(0,a.yT)(A-x/2),to:(0,a.yT)(A+x/2)}}initTimeFromUrl(){if(h.config.publicDashboardAccessToken&&this.timeModel?.timepicker?.hidden)return;const T=d.Ny.getSearch();T.get("time")&&T.get("time.window")&&(this.time=this.getTimeWindow(T.get("time"),T.get("time.window"))),T.get("from")&&(this.time.from=this.parseUrlParam(T.get("from"))||this.time.from),T.get("to")&&(this.time.to=this.parseUrlParam(T.get("to"))||this.time.to),T.get("to")&&T.get("to").indexOf("now")===-1&&(this.refresh=!1,this.timeModel&&(this.timeModel.refresh=void 0)),this.refresh=y({urlRefresh:T.get("refresh"),currentRefresh:this.refresh,refreshIntervals:Array.isArray(this.timeModel?.timepicker?.refresh_intervals)?this.timeModel?.timepicker?.refresh_intervals:void 0,isAllowedIntervalFn:this.contextSrv.isAllowedInterval,minRefreshInterval:h.config.minRefreshInterval})}updateTimeRangeFromUrl(){const T=d.Ny.getSearch();if(T.get("left"))return;const M=this.timeRangeForUrl(),A=T.get("from"),x=T.get("to");A&&x?(A!==M.from||x!==M.to)&&(this.initTimeFromUrl(),this.setTime(this.time,!1)):this.timeHasChangedSinceLoad()&&this.setTime(this.timeAtLoad,!0)}timeHasChangedSinceLoad(){return this.timeAtLoad&&(this.timeAtLoad.from!==this.time.from||this.timeAtLoad.to!==this.time.to)}setAutoRefresh(T){this.timeModel&&(this.timeModel.refresh=T),this.stopAutoRefresh();const M=d.Ny.getSearchObject();if(!T){M.refresh&&d.Ny.partial({refresh:null},!0);return}let A=T,x=60*1e3;T===u.SM?x=this.getAutoRefreshInteval().intervalMs:(A=this.contextSrv.getValidInterval(T),x=r.intervalToMs(A)),this.refreshMS=x,this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(x),this.refreshTimeModel()},x),M.refresh!==A&&d.Ny.partial({refresh:A},!0)}getAutoRefreshInteval(){const T=window?.innerWidth??2e3;return r.calculateInterval(this.timeRange(),T,h.config.minRefreshInterval)}refreshTimeModel(){this.timeModel?.timeRangeUpdated(this.timeRange())}startNextRefreshTimer(T){this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(T),this.contextSrv.isGrafanaVisible()?this.refreshTimeModel():this.autoRefreshBlocked=!0},T)}stopAutoRefresh(){clearTimeout(this.refreshTimer),this.refreshTimer=void 0,this.refreshMS=void 0}resumeAutoRefresh(){this.timeModel?.refresh&&this.setAutoRefresh(this.timeModel.refresh)}setTime(T,M=!0){if((0,n.extend)(this.time,T),(0,a.Ar)(T.to)?(this.oldRefresh=this.timeModel?.refresh||this.oldRefresh,this.setAutoRefresh("")):this.oldRefresh&&this.oldRefresh!==this.timeModel?.refresh&&(this.setAutoRefresh(this.oldRefresh),this.oldRefresh=void 0),M===!0){const A=this.timeRangeForUrl(),x=d.Ny.getSearchObject();if(x.from===A.from.toString()&&x.to===A.to.toString())return;x.from=A.from.toString(),x.to=A.to.toString(),d.Ny.partial(x)}this.timeModel?.refresh===u.SM&&this.getAutoRefreshInteval().intervalMs!==this.refreshMS&&this.setAutoRefresh(u.SM),this.refreshTimeModel()}timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?l.jh.getTimeRange(window.__grafanaSceneContext).state.value:(0,g.z)(this.time,this.timeModel)}zoomOut(T,M=!0){const A=this.timeRange(),{from:x,to:C}=(0,b.Zk)(A,T);this.setTime({from:(0,a.yT)(x),to:(0,a.yT)(C)},M)}shiftTime(T,M=!0){const A=this.timeRange(),{from:x,to:C}=(0,b.Wb)(T,A);this.setTime({from:(0,a.yT)(x),to:(0,a.yT)(C)},M)}makeAbsoluteTime(T){const{from:M,to:A}=this.timeRange();this.setTime({from:M,to:A},T)}copyTimeRangeToClipboard(){const{raw:T}=this.timeRange();navigator.clipboard.writeText(JSON.stringify({from:T.from,to:T.to})),s.A.emit(i.r1.alertSuccess,[(0,m.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}async pasteTimeRangeFromClipboard(T=!0){const{range:M,isError:A}=await(0,b.zG)();if(A===!0){s.A.emit(i.r1.alertError,[(0,m.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,m.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:M})]);return}const{from:x,to:C}=M;this.setTime({from:x,to:C},T)}isRefreshOutsideThreshold(T,M=.05){const A=this.timeRange();if(f.isMathString(A.raw.from)){const x=A.to.diff(A.from),C=Date.now()-T,O=x*M;return C>=O}return!1}}let v;function D(S){v=S}function E(){return v||(v=new p(u.TP)),v}},79056:(Q,I,e)=>{"use strict";e.d(I,{O2:()=>B,SW:()=>w,og:()=>G});var n=e(2543),a=e(69550),o=e(92041),r=e(12470),i=e(22391),f=e(76885),d=e(6709),l=e(25019),m=e(47737),s=e(1173),h=e(11261),u=e(6829),b=e(58140),g=e(19347),P=e(52622),c=e(57021),y=e(33919),p=e(2913),v=e(15054);function D(z){return Array.from(new Array(z+1),(q,ie)=>ie).filter(q=>z%q===0)}var E=e(68576),S=e(31193),T=e(24240),M=e(86886),A=e(14678),x=e(14738),C=e(36373),O=e(77789),R=e(25640);function L(z,q){const ie=[];if(z?.statistics&&z?.statistics.length){z.statistic=z.statistics[0];for(const de of z.statistics.splice(1))ie.push({...z,statistic:de})}for(const de of ie)de.refId=(0,O.M)(q),delete de.statistics,q.push(de);return delete z.statistics,ie}function N(z){const q=[];if(z&&"statistics"in z&&z?.statistics?.length){for(const ie of z.statistics.splice(1)){const{statistics:de,name:ue,...fe}=z;q.push({...fe,statistic:ie,name:`${ue} - ${ie}`})}z.statistic=z.statistics[0],q.length!==0&&(z.name=`${z.name} - ${z.statistic}`),delete z.statistics}return q}function F(z){z.hasOwnProperty("metricQueryType")||(z.metricQueryType=R.d$.Search),z.hasOwnProperty("metricEditorMode")||(z.metricQueryType===R.d$.Query?z.metricEditorMode=R.Rx.Code:z.metricEditorMode=z.expression?R.Rx.Code:R.Rx.Builder)}var K=e(84423);a.D.setInit(y.H),a.G.setInit(y.u);const B=39;class w{constructor(q){this.dashboard=q,(0,g.l)()||(0,g.h)(new S.xq)}updateSchema(q){let ie,de,ue,fe;const Se=this.dashboard.schemaVersion,he=[];if(this.dashboard.schemaVersion=B,Se!==this.dashboard.schemaVersion){if(Se<2&&(q.services&&q.services.filter&&(this.dashboard.time=q.services.filter.time,this.dashboard.templating.list=q.services.filter.list||[]),he.push(ce=>(ce.type==="graphite"&&(ce.type="graph"),ce.type!=="graph"||((0,n.isBoolean)(ce.legend)&&(ce.legend={show:ce.legend}),ce.grid&&(ce.grid.min&&(ce.grid.leftMin=ce.grid.min,delete ce.grid.min),ce.grid.max&&(ce.grid.leftMax=ce.grid.max,delete ce.grid.max)),ce.y_format&&(ce.y_formats||(ce.y_formats=[]),ce.y_formats[0]=ce.y_format,delete ce.y_format),ce.y2_format&&(ce.y_formats||(ce.y_formats=[]),ce.y_formats[1]=ce.y2_format,delete ce.y2_format)),ce))),Se<3){let ce=this.dashboard.getNextPanelId();he.push(me=>(me.id||(me.id=ce,ce+=1),me))}if(Se<4&&he.push(ce=>(ce.type!=="graph"||((0,n.each)(ce.aliasYAxis,(me,pe)=>{ce.seriesOverrides=[{alias:pe,yaxis:me}]}),delete ce.aliasYAxis),ce)),Se<6){const ce=(0,n.find)(q.pulldowns,{type:"annotations"});for(ce&&(this.dashboard.annotations={list:ce.annotations||[]}),ie=0;ie<this.dashboard.templating.list.length;ie++){const me=this.dashboard.templating.list[ie];me.datasource===void 0&&(me.datasource=null),me.type==="filter"&&(me.type="query"),me.type===void 0&&(me.type="query"),me.allFormat===void 0&&delete me.allFormat}}if(Se<7&&(q.nav&&q.nav.length&&(this.dashboard.timepicker=q.nav[0]),he.push(ce=>((0,n.each)(ce.targets,me=>{me.refId||(me.refId=ce.getNextQueryLetter&&ce.getNextQueryLetter())}),ce))),Se<8&&he.push(ce=>((0,n.each)(ce.targets,me=>{me.fields&&me.tags&&me.groupBy&&(me.rawQuery?(delete me.fields,delete me.fill):(me.select=(0,n.map)(me.fields,pe=>{const ye=[];return ye.push({type:"field",params:[pe.name]}),ye.push({type:pe.func,params:[]}),pe.mathExpr&&ye.push({type:"math",params:[pe.mathExpr]}),pe.asExpr&&ye.push({type:"alias",params:[pe.asExpr]}),ye}),delete me.fields,(0,n.each)(me.groupBy,pe=>{pe.type==="time"&&pe.interval&&(pe.params=[pe.interval],delete pe.interval),pe.type==="tag"&&pe.key&&(pe.params=[pe.key],delete pe.key)}),me.fill&&(me.groupBy.push({type:"fill",params:[me.fill]}),delete me.fill)))}),ce)),Se<9&&he.push(ce=>{if(ce.type!=="singlestat"&&ce.thresholds!=="")return ce;if(ce.thresholds){const me=ce.thresholds.split(",");me.length>=3&&(me.shift(),ce.thresholds=me.join(","))}return ce}),Se<10&&he.push(ce=>(ce.type!=="table"||(0,n.each)(ce.styles,me=>{if(me.thresholds&&me.thresholds.length>=3){const pe=me.thresholds;pe.shift(),me.thresholds=pe}}),ce)),Se<12&&(0,n.each)(this.dashboard.getVariables(),ce=>{"refresh"in ce&&(ce.refresh&&(ce.refresh=1),ce.refresh||(ce.refresh=0)),"hideVariable"in ce&&ce.hideVariable?ce.hide=2:"hideLabel"in ce&&ce.hideLabel&&(ce.hide=1)}),Se<12&&he.push(ce=>(ce.type!=="graph"||!ce.grid||ce.yaxes||(ce.yaxes=[{show:ce["y-axis"],min:ce.grid.leftMin,max:ce.grid.leftMax,logBase:ce.grid.leftLogBase,format:ce.y_formats[0],label:ce.leftYAxisLabel},{show:ce["y-axis"],min:ce.grid.rightMin,max:ce.grid.rightMax,logBase:ce.grid.rightLogBase,format:ce.y_formats[1],label:ce.rightYAxisLabel}],ce.xaxis={show:ce["x-axis"]},delete ce.grid.leftMin,delete ce.grid.leftMax,delete ce.grid.leftLogBase,delete ce.grid.rightMin,delete ce.grid.rightMax,delete ce.grid.rightLogBase,delete ce.y_formats,delete ce.leftYAxisLabel,delete ce.rightYAxisLabel,delete ce["y-axis"],delete ce["x-axis"]),ce)),Se<13&&he.push(ce=>{if(ce.type!=="graph"||!ce.grid)return ce;ce.thresholds||(ce.thresholds=[]);const me={},pe={};return ce.grid.threshold1!==null&&(me.value=ce.grid.threshold1,ce.grid.thresholdLine?(me.line=!0,me.lineColor=ce.grid.threshold1Color,me.colorMode="custom"):(me.fill=!0,me.fillColor=ce.grid.threshold1Color,me.colorMode="custom")),ce.grid.threshold2!==null&&(pe.value=ce.grid.threshold2,ce.grid.thresholdLine?(pe.line=!0,pe.lineColor=ce.grid.threshold2Color,pe.colorMode="custom"):(pe.fill=!0,pe.fillColor=ce.grid.threshold2Color,pe.colorMode="custom")),(0,n.isNumber)(me.value)&&((0,n.isNumber)(pe.value)?me.value>pe.value?(me.op=pe.op="lt",ce.thresholds.push(me),ce.thresholds.push(pe)):(me.op=pe.op="gt",ce.thresholds.push(me),ce.thresholds.push(pe)):(me.op="gt",ce.thresholds.push(me))),delete ce.grid.threshold1,delete ce.grid.threshold1Color,delete ce.grid.threshold2,delete ce.grid.threshold2Color,delete ce.grid.thresholdLine,ce}),Se<14&&(this.dashboard.graphTooltip=q.sharedCrosshair?1:0),Se<16&&this.upgradeToGridLayout(q),Se<17&&he.push(ce=>{if(ce.minSpan){const me=v.cV/ce.minSpan,pe=D(v.cV);ce.maxPerRow=pe[(0,n.findIndex)(pe,ye=>ye>me)-1]}return delete ce.minSpan,ce}),Se<18&&he.push(ce=>(ce["options-gauge"]&&(ce.options=ce["options-gauge"],ce.options.valueOptions={unit:ce.options.unit,stat:ce.options.stat,decimals:ce.options.decimals,prefix:ce.options.prefix,suffix:ce.options.suffix},ce.options.thresholds&&ce.options.thresholds.reverse(),delete ce.options.options,delete ce.options.unit,delete ce.options.stat,delete ce.options.decimals,delete ce.options.prefix,delete ce.options.suffix,delete ce["options-gauge"]),ce)),Se<19&&he.push(ce=>(ce.links&&(0,n.isArray)(ce.links)&&(ce.links=ce.links.map(V)),ce)),Se<20){const ce=me=>({...me,url:_(me.url)});he.push(me=>(me.options&&me.options.dataLinks&&(0,n.isArray)(me.options.dataLinks)&&(me.options.dataLinks=me.options.dataLinks.map(ce)),me.options&&me.options.fieldOptions&&me.options.fieldOptions.defaults&&(me.options.fieldOptions.defaults.links&&(0,n.isArray)(me.options.fieldOptions.defaults.links)&&(me.options.fieldOptions.defaults.links=me.options.fieldOptions.defaults.links.map(ce)),me.options.fieldOptions.defaults.title&&(me.options.fieldOptions.defaults.title=_(me.options.fieldOptions.defaults.title))),me))}if(Se<21){const ce=me=>({...me,url:me.url.replace(/__series.labels/g,"__field.labels")});he.push(me=>(me.options&&me.options.dataLinks&&(0,n.isArray)(me.options.dataLinks)&&(me.options.dataLinks=me.options.dataLinks.map(ce)),me.options&&me.options.fieldOptions&&me.options.fieldOptions.defaults&&me.options.fieldOptions.defaults.links&&(0,n.isArray)(me.options.fieldOptions.defaults.links)&&(me.options.fieldOptions.defaults.links=me.options.fieldOptions.defaults.links.map(ce)),me))}if(Se<22&&he.push(ce=>(ce.type!=="table"||(0,n.each)(ce.styles,me=>{me.align="auto"}),ce)),Se<23)for(const ce of this.dashboard.templating.list){if(!(0,T.iv)(ce))continue;const{multi:me,current:pe}=ce;(0,o.R)(pe)||(ce.current=(0,M.C)(pe,me))}if(Se<24&&he.push(ce=>{const me=ce.type==="table";if(me&&!ce.styles)return ce;const pe=ce.table==="table2";return!me||pe||(ce.type=me?"table-old":"table"),ce}),Se<25,Se<26&&he.push(ce=>(ce.type==="text2"&&(ce.type="text",delete ce.options.angular),ce)),Se<27&&(this.removeRepeatedPanels(),this.dashboard.templating.list=this.dashboard.templating.list.map(ce=>{if(!(0,T.VO)(ce))return ce;const me={...ce};return me.current={selected:!0,text:me.query??"",value:me.query??""},me.options=[me.current],me.hide===r.zL.dontHide||me.hide===r.zL.hideLabel?{...me,type:"textbox"}:me})),Se<28){he.push(ce=>ce.type==="singlestat"?H(ce):ce);for(const ce of this.dashboard.templating.list)ce.tags&&delete ce.tags,ce.tagsQuery&&delete ce.tagsQuery,ce.tagValuesQuery&&delete ce.tagValuesQuery,ce.useTags&&delete ce.useTags}if(Se<29)for(const ce of this.dashboard.templating.list)ce.type==="query"&&(ce.refresh!==1&&ce.refresh!==2&&(ce.refresh=1),ce.options?.length&&(ce.options=[]));if(Se<30&&(he.push(Y),he.push(ee)),Se<31&&he.push(ce=>{if(ce.transformations){for(const me of ce.transformations)if(me.id===u.V.id)return j(ce,u.V.id,{id:b.o.id,options:{}})}return ce}),Se<32,Se<33&&he.push(ce=>{if(ce.datasource=G(ce.datasource,{returnDefaultAsNull:!0}),!ce.targets)return ce;for(const me of ce.targets){const pe=G(me.datasource,{returnDefaultAsNull:!0});pe!=null&&(me.datasource=pe)}return ce}),Se<34&&(he.push(ce=>(this.migrateCloudWatchQueries(ce),ce)),this.migrateCloudWatchAnnotationQuery()),Se<35&&he.push(Z),Se<36){for(const me of this.dashboard.annotations.list)me.datasource=G(me.datasource,{returnDefaultAsNull:!1});const ce=(0,g.l)().getInstanceSettings(null);if(ce){for(const me of this.dashboard.templating.list)me.type==="query"&&me.datasource===null&&(me.datasource=(0,i.p$)(ce));he.push(me=>{if(me.targets){let pe=!1;me.datasource==null&&me.targets.length>0&&(me.datasource=(0,i.p$)(ce),pe=!0);for(const ye of me.targets)(ye.datasource==null||ye.datasource.uid==null)&&(me.datasource?.uid!==A.uv?ye.datasource={...me.datasource}:ye.datasource=G(ye.datasource,{returnDefaultAsNull:!1})),pe&&ye.datasource?.uid!=="__expr__"&&(me.datasource=ye.datasource)}return me})}}if(Se<37&&he.push(ce=>(ce.options?.legend&&(ce.options.legend.displayMode==="hidden"||ce.options.legend.showLegend===!1)?(ce.options.legend.displayMode="list",ce.options.legend.showLegend=!1):ce.options?.legend&&(ce.options.legend={...ce.options?.legend,showLegend:!0}),ce)),Se<38&&he.push(ce=>{if(ce.type==="table"&&ce.fieldConfig!==void 0){const me=ce.fieldConfig.defaults?.custom?.displayMode;if(me!==void 0&&(ce.fieldConfig.defaults.custom.cellOptions=(0,c.o7)(me),delete ce.fieldConfig.defaults.custom.displayMode),ce.fieldConfig?.overrides)for(const pe of ce.fieldConfig.overrides)for(let ye=0;ye<pe.properties?.length;ye++){let Pe=pe.properties[ye].value;pe.properties[ye].id==="custom.displayMode"&&(pe.properties[ye].id="custom.cellOptions",pe.properties[ye].value=(0,c.o7)(Pe))}}return ce}),Se<39&&he.push(ce=>(ce.transformations?.forEach(me=>{if(me.id==="timeSeriesTable"&&me.options!==void 0&&me.options.refIdToStat!==void 0){let pe={};for(const[ye,Pe]of Object.entries(me.options.refIdToStat)){let Ie={};Ie.stat=Pe,pe[ye]=Ie}me.options=pe}}),ce)),he.length!==0)for(de=0;de<this.dashboard.panels.length;de++)for(ue=0;ue<he.length;ue++){this.dashboard.panels[de]=he[ue].call(this,this.dashboard.panels[de]);const ce=this.dashboard.panels[de].panels;if(ce)for(fe=0;fe<ce.length;fe++)ce[fe]=he[ue].call(this,ce[fe])}}}removeRepeatedPanels(){const q=[];for(const ie of this.dashboard.panels)ie.repeatPanelId||ie.repeatByRow||(ie.type==="row"&&Array.isArray(ie.panels)&&(ie.panels=ie.panels.filter(de=>!de.repeatPanelId)),q.push(ie));this.dashboard.panels=q}migrateCloudWatchQueries(q){for(const ie of q.targets||[])if(oe(ie)&&(F(ie),ie.hasOwnProperty("statistics"))){const de=L(ie,[...q.targets]);for(const ue of de)q.targets.push(ue)}}migrateCloudWatchAnnotationQuery(){for(const q of this.dashboard.annotations.list)if(se(q)){const ie=N(q);for(const de of ie)this.dashboard.annotations.list.push(de)}}upgradeToGridLayout(q){let ie=0;const de=v.cV/12;let fe=(0,n.max)((0,n.flattenDeep)((0,n.map)(q.rows,he=>(0,n.map)(he.panels,"id"))))+1;if(!q.rows)return;const Se=(0,n.some)(q.rows,he=>he.collapse||he.showTitle||he.repeat);for(const he of q.rows){if(he.repeatIteration)continue;const ce=he.height||v.bJ,me=U(ce),pe={};let ye;Se&&(pe.id=fe,pe.type="row",pe.title=he.title,pe.collapsed=he.collapse,pe.repeat=he.repeat,pe.panels=[],pe.gridPos={x:0,y:ie,w:v.cV,h:me},ye=new K.a9(pe),fe++,ie++);const Pe=new W(me,v.cV,ie);for(const Ie of he.panels){Ie.span=Ie.span||v.o9,Ie.minSpan&&(Ie.minSpan=Math.min(v.cV,v.cV/12*Ie.minSpan));const Oe=Math.floor(Ie.span)*de,Ne=Ie.height?U(Ie.height):me,We=Pe.getPanelPosition(Ne,Oe);ie=Pe.yPos,Ie.gridPos={x:We.x,y:ie+We.y,w:Oe,h:Ne},Pe.addPanel(Ie.gridPos),delete Ie.span,ye&&pe.collapsed?ye.panels?.push(Ie):this.dashboard.panels.push(new K.a9(Ie))}ye&&this.dashboard.panels.push(ye),ye&&pe.collapsed||(ie+=me)}}}function U(z){return(0,n.isString)(z)&&(z=parseInt(z.replace("px",""),10)),z<v.cx&&(z=v.cx),Math.ceil(z/(v.sD+v.dU))}class W{constructor(q,ie=v.cV,de=0){this.area=new Array(ie).fill(0),this.yPos=de,this.height=q}reset(){this.area.fill(0)}addPanel(q){for(let ie=q.x;ie<q.x+q.w;ie++)(!this.area[ie]||q.y+q.h-this.yPos>this.area[ie])&&(this.area[ie]=q.y+q.h-this.yPos);return this.area}getPanelPosition(q,ie,de=!1){let ue,fe,Se;for(let he=this.area.length-1;he>=0&&this.height-this.area[he]>0;he--)if(fe===void 0)fe=he;else if(he<this.area.length-1&&this.area[he]<=this.area[he+1])ue=he;else break;if(ue!==void 0&&fe!==void 0&&fe-ue>=ie-1){const he=(0,n.max)(this.area.slice(ue));Se={x:ue,y:he}}else return de?null:(this.yPos+=this.height,this.reset(),this.getPanelPosition(q,ie,!0));return Se}}function V(z){let q=z.url;return!q&&z.dashboard&&(q=`dashboard/db/${E.A.slugifyForUrl(z.dashboard)}`),!q&&z.dashUri&&(q=`dashboard/${z.dashUri}`),q||(q="/"),z.keepTime&&(q=f.kM.appendQueryToUrl(q,`$${d.c.keepTime}`)),z.includeVars&&(q=f.kM.appendQueryToUrl(q,`$${d.c.includeVars}`)),z.params&&(q=f.kM.appendQueryToUrl(q,z.params)),{url:q,title:z.title,targetBlank:z.targetBlank}}function _(z){const q=/(__series_name)|(\$__series_name)|(__value_time)|(__field_name)|(\$__field_name)/g;return z.replace(q,(ie,de,ue,fe,Se,he)=>de?"__series.name":ue?"${__series.name}":fe?"__value.time":Se?"__field.name":he?"${__field.name}":ie)}function H(z){if(p.config.panels["grafana-singlestat-panel"])return z.type="grafana-singlestat-panel",z;let q=!1;return z.changePlugin||(q=!0,z=new K.a9(z)),z.plugin={angularPanelCtrl:{}},z.gauge?.show?(x.plugin.meta=p.config.panels.gauge,z.changePlugin(x.plugin)):(C.plugin.meta=p.config.panels.stat,z.changePlugin(C.plugin)),q?z.getSaveModel():z}function G(z,q){if(q.returnDefaultAsNull&&(z==null||z==="default"))return null;if((0,i.fN)(z))return z;const ie=(0,g.l)().getInstanceSettings(z);return ie?(0,i.p$)(ie):{uid:z||void 0}}function j(z,q,ie){if(z.transformations){const de=[];for(const ue of z.transformations)de.push(ue),ue.id===q&&de.push({...ie});z.transformations=de}return z}function Y(z){const q=z.fieldConfig;if(!q)return z;if(q.defaults&&q.defaults.mappings&&(q.defaults.mappings=ne(q.defaults.mappings,q.defaults.thresholds)),Array.isArray(q.overrides))for(const ie of q.overrides)for(const de of ie.properties)de.id==="mappings"&&(de.value=ne(de.value));return z}function oe(z){return z.hasOwnProperty("dimensions")&&z.hasOwnProperty("namespace")&&z.hasOwnProperty("region")&&z.hasOwnProperty("metricName")}function se(z){return z.hasOwnProperty("dimensions")&&z.hasOwnProperty("namespace")&&z.hasOwnProperty("region")&&z.hasOwnProperty("prefixMatching")&&z.hasOwnProperty("statistics")}function ne(z,q){if(!z)return;const ie={type:l.d.ValueToText,options:{}},de=[];for(const ue of z){if(ue.type&&ue.options){ue.type===l.d.ValueToText?ie.options={...ie.options,...ue.options}:de.push(ue);continue}let fe;const Se=parseFloat(ue.text);if(q&&!isNaN(Se)){const he=(0,m.yQ)(Se,q.steps);he&&he.color&&(fe=he.color)}switch(ue.type){case 1:ue.value!=null&&(ue.value==="null"?de.push({type:l.d.SpecialValue,options:{match:l.W.Null,result:{text:ue.text,color:fe}}}):ie.options[String(ue.value)]={text:ue.text,color:fe});break;case 2:de.push({type:l.d.RangeToText,options:{from:+ue.from,to:+ue.to,result:{text:ue.text,color:fe}}});break}}return Object.keys(ie.options).length>0&&de.unshift(ie),de}function ee(z){return(z.type==="timeseries"||z.type==="xychart"||z.type==="xychart2")&&z.options.tooltipOptions&&(z.options={...z.options,tooltip:z.options.tooltipOptions},delete z.options.tooltipOptions),z}function Z(z){return z.type==="timeseries"&&z.fieldConfig?.defaults.custom?.axisPlacement===P.vM.Hidden&&(z.fieldConfig={...z.fieldConfig,overrides:[...z.fieldConfig.overrides,{matcher:{id:s.Ct.byType,options:h.PU.time},properties:[{id:"custom.axisPlacement",value:P.vM.Auto}]}]}),z}},98365:(Q,I,e)=>{"use strict";e.d(I,{G:()=>F});var n=e(2543),a=e(64423),o=e(18226),r=e(72724),i=e(47232),f=e(3591),d=e(32264),l=e(24284),m=e(15054),s=e(16233),h=e(28874),u=e(8480),b=e(20601),g=e(72401),P=e(87421),c=e(31678),y=e(28444),p=e(10096),v=e(99140),D=e(80484),E=e(75096),S=e(74856),T=e(34214);const M=new Set(["gridPos","title","description","transparent"]);function A(w,U){const W=[],V={changed:!1,actions:{add:[],remove:[],replace:[],update:[],noop:[]},panels:W};let _=0;const H=new Map;for(let G of U){let{id:j}=G;j||(_||(_=C([w,U])),j=_++,G={...G,id:j}),H.set(j,G)}for(const G of w){const j=H.get(G.id);if(!j){V.changed=!0,V.actions.remove.push(G.id),G.destroy();continue}if(H.delete(G.id),j===G){W.push(G),V.actions.noop.push(G.id);continue}if(G.type===j.type){const oe=G.getSaveModel();let se=!0,ne=!1;for(const[ee,Z]of Object.entries(j))if(!(0,n.isEqualWith)(Z,oe[ee],x))if(V.changed=!0,se=!1,M.has(ee))G[ee]=Z,ne=!0;else{ne=!1;break}if(se){W.push(G),V.actions.noop.push(G.id);continue}if(ne){W.push(G),V.actions.update.push(G.id);continue}}G.destroy();const Y=new T.a(j);Y.key=`${Y.id}-update-${Date.now()}`,W.push(Y),V.changed=!0,V.actions.replace.push(G.id)}for(const G of H.values())W.push(new T.a(G)),V.changed=!0,V.actions.add.push(G.id);return V}function x(w,U){if(w==null&&(U===1/0||U===-1/0||U==null)||U==null&&(w===1/0||w===-1/0||w==null))return!0}function C(w){let U=0;for(const W of w)for(const V of W)V.id>U&&(U=V.id);return U+1}var O=e(79056),R=e(84423);function L(w,U){return w.repeatDirection===m.HG?!1:U.gridPos.x>=w.gridPos.x+w.gridPos.w&&U.gridPos.y===w.gridPos.y}function N(w){for(const U of w)if(delete U.scopedVars,U.panels?.length)for(const W of U.panels)delete W.scopedVars}class F{constructor(U,W,V){this.timeRangeUpdatedDuringEditOrView=!1,this.originalDashboard=null,this.getVariablesFromState=V?.getVariablesFromState??P.SS,this.events=new o.o,this.id=U.id||null,this.uid=U.uid||null,this.revision=U.revision??void 0,this.title=U.title??"No Title",this.description=U.description,this.tags=U.tags??[],this.timezone=U.timezone??"",this.weekStart=U.weekStart??"",this.editable=U.editable!==!1,this.graphTooltip=U.graphTooltip||0,this.time=U.time??{from:"now-6h",to:"now"},this.timepicker=U.timepicker??{},this.liveNow=U.liveNow,this.templating=this.ensureListExist(U.templating),this.annotations=this.ensureListExist(U.annotations),this.refresh=U.refresh,this.snapshot=U.snapshot,this.schemaVersion=U.schemaVersion??0,this.fiscalYearStartMonth=U.fiscalYearStartMonth??0,this.version=U.version??0,this.links=U.links??[],this.gnetId=U.gnetId||null,this.panels=(0,n.map)(U.panels??[],_=>new R.a9(_)),this.originalDashboard=(0,n.cloneDeep)(U),this.originalTemplating=(0,n.cloneDeep)(this.templating),this.originalTime=(0,n.cloneDeep)(this.time),this.ensurePanelsHaveUniqueIds(),this.formatDate=this.formatDate.bind(this),this.initMeta(W),this.updateSchema(U),this.addBuiltInAnnotationQuery(),this.sortPanelsByGridPos(),this.panelsAffectedByVariableChange=null,this.appEventsSubscription=new a.yU,this.lastRefresh=Date.now(),this.appEventsSubscription.add(p.lE.subscribe(D.og,this.variablesChangedHandler.bind(this))),this.appEventsSubscription.add(p.lE.subscribe(D.BS,this.variablesTimeRangeProcessDoneHandler.bind(this))),this.appEventsSubscription.add(p.lE.subscribe(D.eF,this.variablesChangedInUrlHandler.bind(this)))}static{this.nonPersistedProperties={events:!0,meta:!0,panels:!0,templating:!0,originalTime:!0,originalTemplating:!0,originalLibraryPanels:!0,panelInEdit:!0,panelInView:!0,getVariablesFromState:!0,formatDate:!0,appEventsSubscription:!0,panelsAffectedByVariableChange:!0,lastRefresh:!0,timeRangeUpdatedDuringEditOrView:!0,originalDashboard:!0}}addBuiltInAnnotationQuery(){this.annotations.list.some(W=>W.builtIn===1)||this.annotations.list.unshift({datasource:{uid:"-- Grafana --",type:"grafana"},name:"Annotations & Alerts",type:"dashboard",iconColor:l.Mk,enable:!0,hide:!0,builtIn:1})}initMeta(U){U=U||{},U.canShare=U.canShare!==!1,U.canSave=U.canSave!==!1,U.canStar=U.canStar!==!1,U.canEdit=U.canEdit!==!1,U.canDelete=U.canDelete!==!1,U.showSettings=U.canEdit,U.canMakeEditable=U.canSave&&!this.editable,U.hasUnsavedFolderChange=!1,this.editable||(U.canEdit=!1,U.canDelete=!1,U.canSave=!1),this.meta=U}getSaveModelCloneOld(U){const W=(0,n.defaults)(U||{},{saveVariables:!0,saveTimerange:!0});let V={};for(const _ in this)F.nonPersistedProperties[_]||!this.hasOwnProperty(_)||(V[_]=(0,n.cloneDeep)(this[_]));return V.templating=this.getTemplatingSaveModel(W),W.saveTimerange||(V.time=this.originalTime),V.panels=this.getPanelSaveModels(),V=(0,h.v)(V),V.getVariables=()=>V.templating.list,V}getSaveModelClone(U){const W=this.getSaveModelCloneOld(U),V=JSON.stringify(W);return JSON.parse(V)}updatePanels(U){const W=A(this.panels,U??[]);return W.changed&&(this.panels=W.panels??[],this.sortPanelsByGridPos(),this.events.publish(new y.Q$)),W}getPanelSaveModels(){return this.panels.filter(U=>this.isSnapshotTruthy()||!(U.repeatPanelId||U.repeatedByRow)).map(U=>{if(U.libraryPanel){const{id:W,title:V,libraryPanel:_,gridPos:H}=U;return{id:W,title:V,gridPos:H,libraryPanel:{uid:_.uid,name:_.name}}}return this.panelInEdit&&this.panelInEdit.id===U.id?this.panelInEdit.getSaveModel():U.getSaveModel()}).map(U=>(this.isSnapshotTruthy()||(delete U.scopedVars,U.type==="row"&&U.panels&&U.panels.length>0&&(U.panels=U.panels.filter(W=>!W.repeatPanelId).map(W=>(delete W.scopedVars,W)))),U))}getTemplatingSaveModel(U){const W=this.originalTemplating?.list??[],_=this.getVariablesFromState(this.uid).map(G=>{const j=b.B.get(G.type).getSaveModel(G,U.saveVariables);if(!U.saveVariables){const Y=W.find(({name:oe,type:se})=>oe===G.name&&se===G.type);if(!Y)return j;G.type==="adhoc"?j.filters=Y.filters:(j.current=Y.current,j.options=Y.options)}return j});return{list:(0,h.v)(_)}}timeRangeUpdated(U){this.events.publish(new f.sR(U)),(0,v.JD)((0,g.RK)(this.uid,U)),(this.panelInEdit||this.panelInView)&&(this.timeRangeUpdatedDuringEditOrView=!0)}startRefresh(U={refreshAll:!0,panelIds:[]}){if(this.events.publish(new f._),this.lastRefresh=Date.now(),this.panelInEdit&&(U.refreshAll||U.panelIds.includes(this.panelInEdit.id))){this.panelInEdit.refresh();return}const W=this.panels.filter(V=>!this.otherPanelInFullscreen(V)&&(U.refreshAll||U.panelIds.includes(V.id)));if(!this.isSnapshot())for(const V of W)V.refreshWhenInView=!0;for(const V of W)V.refresh()}render(){this.events.publish(new y.XM);for(const U of this.panels)U.render()}panelInitialized(U){const W=U.getQueryRunner().getLastResult();!this.otherPanelInFullscreen(U)&&!W&&U.refresh()}otherPanelInFullscreen(U){return(this.panelInEdit||this.panelInView)&&!(U.isViewing||U.isEditing)}initEditPanel(U){return(0,S.jG)().stopAutoRefresh(),this.panelInEdit=U.getEditClone(),this.timeRangeUpdatedDuringEditOrView=!1,this.panelInEdit}exitPanelEditor(){this.panelInEdit.destroy(),this.panelInEdit=void 0,(0,S.jG)().resumeAutoRefresh(),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}initViewPanel(U){this.panelInView=U,this.timeRangeUpdatedDuringEditOrView=!1,U.setIsViewing(!0)}exitViewPanel(U){this.panelInView=void 0,U.setIsViewing(!1),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged(){(this.panelsAffectedByVariableChange||this.timeRangeUpdatedDuringEditOrView)&&(this.startRefresh({panelIds:this.panelsAffectedByVariableChange??[],refreshAll:this.timeRangeUpdatedDuringEditOrView}),this.panelsAffectedByVariableChange=null,this.timeRangeUpdatedDuringEditOrView=!1)}ensurePanelsHaveUniqueIds(){const U=new Set;let W=this.getNextPanelId();for(const V of this.panelIterator())(!V.id||U.has(V.id))&&(V.id=W++),U.add(V.id)}ensureListExist(U={}){return U.list??=[],U}getNextPanelId(){let U=0;for(const W of this.panelIterator())W.id>U&&(U=W.id);return U+1}*panelIterator(){for(const U of this.panels){yield U;const W=U.panels??[];for(const V of W)yield V}}forEachPanel(U){for(let W=0;W<this.panels.length;W++)U(this.panels[W],W)}getPanelById(U,W=!1){if(this.panelInEdit&&this.panelInEdit.id===U)return this.panelInEdit;if(W){for(const V of this.panelIterator())if(V.id===U)return V;return null}else return this.panels.find(V=>V.id===U)??null}canEditPanel(U){return!!(this.meta.canEdit&&U&&!U.repeatPanelId&&U.type!=="row")}canEditPanelById(U){return this.canEditPanel(this.getPanelById(U))}addPanel(U){U.id=this.getNextPanelId(),this.panels.unshift(new R.a9(U)),this.sortPanelsByGridPos(),this.events.publish(new y.Q$)}updateMeta(U){this.meta={...this.meta,...U},this.events.publish(new y.Cf)}makeEditable(){this.editable=!0,this.updateMeta({canMakeEditable:!1,canEdit:!0,canSave:!0})}sortPanelsByGridPos(){this.panels.sort((U,W)=>U.gridPos.y===W.gridPos.y?U.gridPos.x-W.gridPos.x:U.gridPos.y-W.gridPos.y)}clearUnsavedChanges(U,W){for(const V of this.panels)V.configRev=0;this.panelInEdit&&(this.panelInEdit.hasSavedPanelEditChange=this.panelInEdit.configRev>0,this.panelInEdit.configRev=0),this.originalDashboard=U,this.originalTemplating=U.templating,W.saveTimerange&&(this.originalTime=U.time)}hasUnsavedChanges(){return!!this.panels.find(W=>W.hasChanged)}cleanUpRepeats(){if(this.isSnapshotTruthy()||!this.hasVariables())return;N(this.panels);const U=this.panels.filter(W=>(!W.repeat||W.repeatedByRow)&&W.repeatPanelId);(0,n.pull)(this.panels,...U),U.map(W=>W.destroy()),this.sortPanelsByGridPos()}processRepeats(){if(!(this.isSnapshotTruthy()||!this.hasVariables()||this.panelInView)){this.cleanUpRepeats();for(let U=0;U<this.panels.length;U++){const W=this.panels[U];W.repeat&&this.repeatPanel(W,U)}this.sortPanelsByGridPos(),this.events.publish(new y.Q$)}}cleanUpRowRepeats(U){const W=U.map(_=>_.id),V=U.filter(_=>!_.repeat&&_.repeatPanelId&&W.includes(_.repeatPanelId));(0,n.pull)(U,...V),(0,n.pull)(this.panels,...V)}processRowRepeats(U){if(this.isSnapshotTruthy()||!this.hasVariables())return;let W=U.panels??[];if(!U.collapsed){const V=this.panels.findIndex(_=>_.id===U.id);W=this.getRowPanels(V)}this.cleanUpRowRepeats(W);for(const V of W)if(V.repeat){const _=this.panels.findIndex(H=>H.id===V.id);this.repeatPanel(V,_)}}getPanelRepeatClone(U,W,V){if(W===0)return U;const _=U.getSaveModel();_.id=this.getNextPanelId();const H=new R.a9(_);return this.panels.splice(V+W,0,H),H.repeatPanelId=U.id,H.repeat=void 0,this.panelInView?.id===H.id&&(H.setIsViewing(!0),this.panelInView=H),H}getRowRepeatClone(U,W,V){if(W===0){if(!U.collapsed){const j=this.getRowPanels(V);U.panels=j}return U}const _=new R.a9(U.getSaveModel());let H,G;return U.collapsed?(H=(0,n.cloneDeep)(U.panels)??[],_.panels=H,G=V+W):(H=this.getRowPanels(V),_.panels=H.map(j=>j.getSaveModel()),G=V+(H.length+1)*W),this.panels.splice(G,0,_),this.updateRepeatedPanelIds(_),_}repeatPanel(U,W){const V=this.getPanelRepeatVariable(U);if(!V)return;if(U.type==="row"){this.repeatRow(U,W,V);return}const _=this.getSelectedVariableOptions(V),H=U.maxPerRow||4;let G=0,j=U.gridPos.y;for(let oe=0;oe<_.length;oe++){const se=_[oe];let ne;ne=this.getPanelRepeatClone(U,oe,W),ne.scopedVars??={},ne.scopedVars[V.name]=se,U.repeatDirection===m.Pz?(oe>0&&(j+=ne.gridPos.h),ne.gridPos.y=j):(ne.gridPos.w=Math.max(m.cV/_.length,m.cV/H),ne.gridPos.x=G,ne.gridPos.y=j,G+=ne.gridPos.w,G+ne.gridPos.w>m.cV&&(G=0,j+=ne.gridPos.h))}const Y=j-U.gridPos.y;if(Y>0){const oe=W+_.length;for(const se of this.panels.slice(oe))L(U,se)||(se.gridPos.y+=Y)}}repeatRow(U,W,V){const _=this.getSelectedVariableOptions(V);for(let H=0;H<_.length;H++){const G=_[H],j=this.getRowRepeatClone(U,H,W);B(j,V,G);const Y=this.getRowHeight(j),oe=j.panels||[];let se;if(U.collapsed){for(const ne of oe)B(ne,V,G),H>0&&this.updateRepeatedPanelIds(ne,!0);j.gridPos.y+=H,se=W+H+1}else{const ne=W+(oe.length+1)*H+1;oe.forEach((ee,Z)=>{if(B(ee,V,G),H>0){const z=new R.a9(ee);this.updateRepeatedPanelIds(z,!0),z.gridPos.y+=Y*H,this.panels.splice(ne+Z,0,z)}}),j.panels=[],j.gridPos.y+=Y*H,se=ne+oe.length}if(_.length>1)for(const ne of this.panels.slice(se))ne.gridPos.y+=Y}}updateRepeatedPanelIds(U,W){return U.repeatPanelId=U.id,U.id=this.getNextPanelId(),W?U.repeatedByRow=!0:U.repeat=void 0,U}getSelectedVariableOptions(U){let W;return(0,E.ML)(U)?W=U.options.slice(1,U.options.length):W=(0,n.filter)(U.options,{selected:!0}),W}getRowHeight(U){if(!U.panels||U.panels.length===0)return 0;if(U.collapsed)return 1;const W=(0,n.maxBy)(U.panels,({gridPos:V})=>V.y+V.h).gridPos;return W.y+W.h-U.gridPos.y}removePanel(U){this.panels=this.panels.filter(W=>W!==U),U.destroy(),this.events.publish(new y.Q$)}removeRow(U,W){(!W&&U.collapsed||W&&!U.collapsed)&&this.toggleRow(U),this.removePanel(U)}expandRows(){const U=this.panels.filter(W=>W.type==="row"&&W.collapsed);for(const W of U)this.toggleRow(W)}collapseRows(){const U=this.panels.filter(W=>W.type==="row"&&!W.collapsed);for(const W of U)this.toggleRow(W)}isSubMenuVisible(){return this.links.length>0||this.getVariables().some(U=>U.hide!==2)||this.annotations.list.some(U=>!U.hide)}getPanelInfoById(U){const W=this.panels.findIndex(V=>V.id===U);return W>=0?{panel:this.panels[W],index:W}:null}duplicatePanel(U){const W=U.getSaveModel();return W.id=this.getNextPanelId(),delete W.repeat,delete W.repeatIteration,delete W.repeatPanelId,delete W.scopedVars,W.alert&&delete W.thresholds,delete W.alert,U.gridPos.x+U.gridPos.w*2<=m.cV?W.gridPos.x+=U.gridPos.w:W.gridPos.y+=U.gridPos.h,this.addPanel(W),W}formatDate(U,W){return(0,r.LE)(U,{format:W,timeZone:this.getTimezone()})}destroy(){this.appEventsSubscription.unsubscribe(),this.events.removeAllListeners();for(const U of this.panels)U.destroy()}toggleRow(U){const W=(0,n.indexOf)(this.panels,U);if(!U.collapsed){const G=this.getRowPanels(W);(0,n.pull)(this.panels,...G),U.panels=G.map(j=>j.getSaveModel()),U.collapsed=!0,G.some(j=>j.hasChanged)&&U.configRev++,this.events.publish(new y.Q$);return}U.collapsed=!1;const V=U.panels??[],_=V.some(G=>G.repeat),H=U.repeat;if(V.length>0){const j=(V[0].gridPos.y??U.gridPos.y)-(U.gridPos.y+U.gridPos.h);let Y=W+1,oe=U.gridPos.y;for(const ne of V){if(H){const ee=this.getPanelRepeatVariable(U);if(ne.scopedVars??={},ee){const Z=this.getSelectedVariableOptions(ee);ne.scopedVars={...ne.scopedVars,[ee.name]:Z[0]}}}ne.gridPos.y??(ne.gridPos.y=U.gridPos.y),ne.gridPos.y-=j,this.panels.splice(Y,0,new R.a9(ne)),Y+=1,oe=Math.max(oe,ne.gridPos.y+ne.gridPos.h)}const se=oe-U.gridPos.y-1;for(const ne of this.panels.slice(Y))ne.gridPos.y+=se;U.panels=[],_&&this.processRowRepeats(U)}this.sortPanelsByGridPos(),this.events.publish(new y.Q$)}getRowPanels(U){const W=this.panels.slice(U+1),V=W.findIndex(H=>H.type==="row");return W.slice(0,V>=0?V:this.panels.length)}on(U,W){console.log("DashboardModel.on is deprecated use events.subscribe"),this.events.on(U,W)}off(U,W){console.log("DashboardModel.off is deprecated"),this.events.off(U,W)}cycleGraphTooltip(){this.graphTooltip=(this.graphTooltip+1)%3}sharedTooltipModeEnabled(){return this.graphTooltip>0}sharedCrosshairModeOnly(){return this.graphTooltip===1}getRelativeTime(U){return(0,r.fq)(U,{timeZone:this.getTimezone()})}isSnapshot(){return this.snapshot!==void 0}getTimezone(){return this.timezone?this.timezone:s.TP?.user?.timezone}updateSchema(U){new O.SW(this).updateSchema(U)}hasTimeChanged(){const{time:U,originalTime:W}=this;return!((0,n.isEqual)(U,W)||(0,n.isEqual)((0,i.KQ)(U?.from),(0,i.KQ)(W?.from))&&(0,n.isEqual)((0,i.KQ)(U?.to),(0,i.KQ)(W?.to)))}autoFitPanels(U,W){const V=Math.max(...this.panels.map(oe=>oe.gridPos.h+oe.gridPos.y)),_=55;let G=U-_-20;W&&W!==c.KioskMode.TV&&(G+=_);const j=Math.floor(G/(m.sD+m.dU)),Y=V/j;for(const oe of this.panels)oe.gridPos.y=Math.round(oe.gridPos.y/Y)||1,oe.gridPos.h=Math.round(oe.gridPos.h/Y)||1}templateVariableValueUpdated(){this.processRepeats(),this.events.emit(c.CoreEvents.bG)}getPanelByUrlId(U){const W=parseInt(U??"0",10),V=this.panels.filter(_=>_.collapsed);for(const _ of V)_.panels?.some(G=>G.id===W)&&this.toggleRow(_);return this.getPanelById(W)}toggleLegendsForAll(){const U=this.panels.filter(K),W=U.filter(H=>H.legend.show).length,V=U.length-W,_=W>=V;for(const H of U)H.legend.show=!_,H.render()}toggleExemplarsForAll(){for(const U of this.panels)for(const W of U.targets){if(!(W.datasource&&W.datasource.type==="prometheus"))continue;const V=W;V.exemplar=!V.exemplar}this.startRefresh()}getVariables(){return this.getVariablesFromState(this.uid)}canEditAnnotations(U){let W=!0;return U?W=!!this.meta.annotationsPermissions?.dashboard.canEdit:W=!!this.meta.annotationsPermissions?.organization.canEdit,(d.$.featureToggles.annotationPermissionUpdate||this.canEditDashboard())&&W}canDeleteAnnotations(U){let W=!0;return U?W=!!this.meta.annotationsPermissions?.dashboard.canDelete:W=!!this.meta.annotationsPermissions?.organization.canDelete,d.$.featureToggles.annotationPermissionUpdate?W:W&&this.canEditDashboard()}canAddAnnotations(){return this.annotations.list.find(W=>W.builtIn===1)?.enable===!1?!1:d.$.featureToggles.annotationPermissionUpdate?!!this.meta.annotationsPermissions?.dashboard.canAdd:!!this.meta.annotationsPermissions?.dashboard.canAdd&&this.canEditDashboard()}canEditDashboard(){return!!(this.meta.canEdit||this.meta.canMakeEditable)}shouldUpdateDashboardPanelFromJSON(U,W){!(0,n.isEqual)(U?.gridPos,W?.gridPos)&&this.events.publish(new y.Q$)}getDefaultTime(){return this.originalTime}getPanelRepeatVariable(U){return this.getVariablesFromState(this.uid).find(W=>W.name===U.repeat)}isSnapshotTruthy(){return this.snapshot}hasVariables(){return this.getVariablesFromState(this.uid).length>0}hasVariablesChanged(){const U=this.originalTemplating?.list??[],W=this.getTemplatingSaveModel({saveVariables:!0}).list;return U.length!==W.length?!1:!(0,n.isEqual)(W,U)}variablesTimeRangeProcessDoneHandler(U){const W=U.payload.variableIds.length>0;this.variablesChangedHandler(new D.og({panelIds:[],refreshAll:!0}),W)}variablesChangedHandler(U,W=!0){if(W&&this.processRepeats(),U.payload.refreshAll||(0,S.jG)().isRefreshOutsideThreshold(this.lastRefresh)){this.startRefresh({refreshAll:!0,panelIds:[]});return}(this.panelInEdit||this.panelInView)&&(this.panelsAffectedByVariableChange=U.payload.panelIds.filter(V=>V!==(this.panelInEdit?.id??this.panelInView?.id))),this.startRefresh(U.payload)}variablesChangedInUrlHandler(U){this.templateVariableValueUpdated(),this.startRefresh(U.payload)}getOriginalDashboard(){return this.originalDashboard}hasAngularPlugins(){return this.panels.some(U=>{const W=(d.$.panels[U.type]?.angular?.detected||R.vI.includes(U.type))&&!d.$.panels[U.type]?.angular?.hideDeprecation;let V=!1;return U.datasource?.uid&&(V=(0,u.Hv)(U.datasource?.uid)),W||V})}}function K(w){return!!w.legend}function B(w,U,W){w.scopedVars??={},w.scopedVars[U.name]=W}},84423:(Q,I,e)=>{"use strict";e.d(I,{Ar:()=>S,NB:()=>v,a9:()=>E,tD:()=>D,tw:()=>T,vI:()=>p});var n=e(2543),a=e.n(n),o=e(62938),r=e(18226),i=e(77789),f=e(41987),d=e(581),l=e(3591),m=e(72574),s=e(2913),h=e(87490),u=e(28444),b=e(80924),g=e(96382);const P={events:!0,isViewing:!0,isEditing:!0,isInView:!0,hasRefreshed:!0,cachedPluginOptions:!0,plugin:!0,queryRunner:!0,replaceVariables:!0,configRev:!0,hasSavedPanelEditChange:!0,getDisplayTitle:!0,dataSupport:!0,key:!0,isNew:!0,refreshWhenInView:!0},c={id:!0,gridPos:!0,type:!0,title:!0,scopedVars:!0,repeat:!0,repeatPanelId:!0,repeatDirection:!0,repeatedByRow:!0,minSpan:!0,collapsed:!0,panels:!0,targets:!0,datasource:!0,timeFrom:!0,timeShift:!0,hideTimeOverride:!0,description:!0,links:!0,fullscreen:!0,isEditing:!0,isViewing:!0,hasRefreshed:!0,events:!0,cacheTimeout:!0,queryCachingTTL:!0,cachedPluginOptions:!0,transparent:!0,pluginVersion:!0,queryRunner:!0,transformations:!0,fieldConfig:!0,maxDataPoints:!0,interval:!0,replaceVariables:!0,libraryPanel:!0,getDisplayTitle:!0,configRev:!0,key:!0},y={gridPos:{x:0,y:0,h:3,w:6},targets:[{refId:"A"}],cachedPluginOptions:{},transparent:!1,options:{},links:[],transformations:[],fieldConfig:{defaults:{},overrides:[]},title:""},p=["graph","table-old","grafana-piechart-panel","grafana-worldmap-panel","singlestat","grafana-singlestat-panel"],v={graph:"timeseries","table-old":"table",singlestat:"stat","grafana-singlestat-panel":"stat","grafana-piechart-panel":"piechart","grafana-worldmap-panel":"geomap"},D={"heatmap-new":"heatmap"};class E{constructor(A){this.datasource=null,this.isViewing=!1,this.isEditing=!1,this.isInView=!1,this.configRev=0,this.refreshWhenInView=!0,this.cachedPluginOptions={},this.events=new r.o,this.restoreModel(A),this.replaceVariables=this.replaceVariables.bind(this),this.key=(0,o.A)()}restoreModel(A){for(const C in this)P[C]||!this.hasOwnProperty(C)||A[C]||typeof this[C]!="function"&&typeof this[C]!="symbol"&&delete this[C];for(const C in A)this[C]=A[C];const x=(0,g.p)(this);x&&(this.autoMigrateFrom=this.type,this.type=x),(0,n.defaultsDeep)(this,(0,n.cloneDeep)(y)),this.ensureQueryIds()}generateNewKey(){this.key=(0,o.A)()}ensureQueryIds(){if(this.targets&&(0,n.isArray)(this.targets))for(const A of this.targets)A.refId||(A.refId=(0,i.M)(this.targets))}getOptions(){return this.options}get hasChanged(){return this.configRev>0}updateOptions(A){this.options=A,this.configRev++,this.events.publish(new u.PR),this.render()}updateFieldConfig(A){this.fieldConfig=A,this.configRev++,this.events.publish(new u.PR),this.resendLastResult(),this.render()}getSaveModel(){const A={};for(const x in this)P[x]||!this.hasOwnProperty(x)||(0,n.isEqual)(this[x],y[x])||(A[x]=(0,n.cloneDeep)(this[x]));return this.type==="row"&&this.panels&&this.panels.length>0&&(A.panels=this.panels.map(x=>{if(x.libraryPanel){const{id:C,title:O,libraryPanel:R,gridPos:L}=x;return{id:C,title:O,gridPos:L,libraryPanel:{uid:R.uid,name:R.name}}}return x})),A}setIsViewing(A){this.isViewing=A}updateGridPos(A,x=!0){A.x===this.gridPos.x&&A.y===this.gridPos.y&&A.h===this.gridPos.h&&A.w===this.gridPos.w||(this.gridPos.x=A.x,this.gridPos.y=A.y,this.gridPos.w=A.w,this.gridPos.h=A.h,x&&this.configRev++,this.render())}runAllPanelQueries({dashboardUID:A,dashboardTimezone:x,timeData:C,width:O}){this.getQueryRunner().run({datasource:this.datasource,queries:this.targets,panelId:this.id,panelPluginId:this.type,dashboardUID:A,timezone:x,timeRange:C.timeRange,timeInfo:C.timeInfo,maxDataPoints:this.maxDataPoints||Math.floor(O),minInterval:this.interval,scopedVars:this.scopedVars,cacheTimeout:this.cacheTimeout,queryCachingTTL:this.queryCachingTTL,transformations:this.transformations,app:this.isEditing?f.Jk.PanelEditor:this.isViewing?f.Jk.PanelViewer:f.Jk.Dashboard})}refresh(){this.hasRefreshed=!0,this.events.publish(new l._)}render(){this.hasRefreshed?this.events.publish(new u.XM):this.refresh()}getOptionsToRemember(){return Object.keys(this).reduce((A,x)=>P[x]||c[x]?A:{...A,[x]:this[x]},{})}restorePanelOptions(A){const x=this.cachedPluginOptions[A];x&&(Object.keys(x.properties).map(C=>{this[C]=x.properties[C]}),this.fieldConfig=(0,d.H9)(this.fieldConfig,x.fieldConfig))}applyPluginOptionDefaults(A,x){const C=(0,d.F)({plugin:A,currentOptions:this.options,currentFieldConfig:this.fieldConfig,isAfterPluginChange:x});this.fieldConfig=C.fieldConfig,this.options=C.options}async pluginLoaded(A){this.plugin=A;const x=S(A);if(this.autoMigrateFrom){const C=v[this.autoMigrateFrom]!=null,O=this.getOptionsToRemember(),R=this.autoMigrateFrom,L=this.type;this.clearPropertiesBeforePluginChange(),this.type=L,this.plugin=A,this.callPanelTypeChangeHandler(A,R,O,C)}if(A.onPanelMigration&&x!==this.pluginVersion){const C=A.onPanelMigration(this);this.options=await C,this.pluginVersion=x}this.applyPluginOptionDefaults(A,!1),this.resendLastResult()}clearPropertiesBeforePluginChange(){for(const A in this)c[A]||delete this[A];this.options={},this.fieldConfig={defaults:{...this.fieldConfig.defaults,custom:{}},overrides:(0,d.aW)(this.fieldConfig.overrides,d.nx)}}callPanelTypeChangeHandler(A,x,C,O){if(A.onPanelTypeChanged){const R=O?{angular:C}:C.options;Object.assign(this.options,A.onPanelTypeChanged(this,x,R,this.fieldConfig))}}changePlugin(A){const x=A.meta.id,C=this.getOptionsToRemember(),O=this.fieldConfig,R=this.type,L=this.isAngularPlugin()||!!v[R];this.cachedPluginOptions[R]={properties:C,fieldConfig:O},this.clearPropertiesBeforePluginChange(),this.restorePanelOptions(x),this.callPanelTypeChangeHandler(A,R,C,L),this.type=x,this.plugin=A,this.configRev++,this.applyPluginOptionDefaults(A,!0),A.onPanelMigration&&(this.pluginVersion=S(A))}updateQueries(A){const{dataSource:x}=A;this.datasource={uid:x.uid,type:x.type},this.cacheTimeout=A.cacheTimeout,this.queryCachingTTL=A.queryCachingTTL,this.timeFrom=A.timeRange?.from,this.timeShift=A.timeRange?.shift,this.hideTimeOverride=A.timeRange?.hide,this.interval=A.minInterval,this.maxDataPoints=A.maxDataPoints,this.targets=A.queries,this.configRev++,this.events.publish(new u.zq)}addQuery(A){A=A||{refId:"A"},A.refId=(0,i.M)(this.targets),this.targets.push(A),this.configRev++}changeQuery(A,x){A.refId=this.targets[x].refId,this.configRev++,this.targets=this.targets.map((C,O)=>O===x?A:C)}getEditClone(){const A=this.getSaveModel(),x=new E(A);x.isEditing=!0,x.plugin=this.plugin;const C=this.getQueryRunner();return x.getQueryRunner().useLastResultFrom(C),x}getTransformations(){return this.transformations}getFieldOverrideOptions(){if(this.plugin)return{fieldConfig:this.fieldConfig,replaceVariables:this.replaceVariables,fieldConfigRegistry:this.plugin.fieldConfigRegistry,theme:s.Ay.theme2}}getDataSupport(){return this.plugin?.dataSupport??{annotations:!1,alertStates:!1}}getQueryRunner(){return this.queryRunner||(this.queryRunner=new b.Z(this)),this.queryRunner}hasTitle(){return this.title&&this.title.length>0}isAngularPlugin(){return(this.plugin&&this.plugin.angularPanelCtrl)!==void 0||(this.plugin?.meta?.angular?.detected??!1)}destroy(){this.events.removeAllListeners(),this.queryRunner&&this.queryRunner.destroy()}setTransformations(A){this.transformations=A,this.resendLastResult(),this.configRev++,this.events.publish(new u.JI)}setProperty(A,x){this[A]=x,this.configRev++,A==="repeat"&&(this.repeat&&!this.repeatDirection?this.repeatDirection="h":this.repeat||(delete this.repeatDirection,delete this.maxPerRow))}replaceVariables(A,x,C){const O=this.getQueryRunner().getLastRequest(),R=Object.assign({},this.scopedVars,O?.scopedVars,x);return(0,m.w)().replace(A,R,C)}resendLastResult(){this.plugin&&this.getQueryRunner().resendLastResult()}getDisplayTitle(){return this.replaceVariables(this.title,void 0,"text")}initLibraryPanel(A){for(const[x,C]of Object.entries(A.model)){switch(x){case"id":case"gridPos":case"libraryPanel":continue}this[x]=C}this.libraryPanel=A}unlinkLibraryPanel(){delete this.libraryPanel,this.configRev++,this.render()}}function S(M){return M&&M.meta.info.version?M.meta.info.version:s.Ay.buildInfo.version}function T(M){const A={};return Object.entries(M).filter(([x,C])=>!P[x]&&M.hasOwnProperty(x)&&!(0,n.isEqual)(C,y[x])).forEach(([x,C])=>{A[x]=C}),(0,h.MA)(A)}},3673:(Q,I,e)=>{"use strict";e.d(I,{Bz:()=>P,Q9:()=>b,Ss:()=>y,TA:()=>g,lC:()=>c});var n=e(17172),a=e(82467),o=e(3169),r=e(28676),i=e(6473),f=e(80095),d=e(81862),l=e(20701),m=e(72401),s=e(14792),h=e(74856),u=e(28601);function b(p,v){return async D=>{await(0,n.AI)().post("/api/dashboards/import",p),D((0,a.dx)((0,o.tZ)("Dashboard Imported",v))),D((0,l.h9)())}}function g(p){return async v=>{await(0,r.n)().deleteDashboard(p,!1),v((0,l.h9)())}}const P=()=>(p,v)=>{const E=v().dashboard.getModel();E&&(E.destroy(),p((0,m.Y7)(E.uid))),(0,h.jG)().stopAutoRefresh(),p((0,u.p0)()),p((0,f.rG)()),i.t.leave(),(0,s.UA)().setCurrent(void 0)},c=p=>v=>{v((0,d.Cj)(p)),(0,h.jG)().refreshTimeModel()},y=p=>v=>{v((0,d.xu)(p)),(0,h.jG)().refreshTimeModel()}},41176:(Q,I,e)=>{"use strict";e.d(I,{B:()=>o});var n=e(61298),a=e(14110);function o(r){const i={dashboardId:r.id,dashboardName:r.title,dashboardUid:r.uid,folderName:r.meta.folderTitle,eventName:n.n_.DashboardView};(0,a.G$)(i)}},96382:(Q,I,e)=>{"use strict";e.d(I,{p:()=>o});var n=e(2913),a=e(84423);function o(r,i){if(a.tD[r.type])return a.tD[r.type];const f=l=>{const m="__feature."+l,h=new URLSearchParams(window.location.search).get(m);return h==="true"||h===""},d=i||!n.Ay.angularSupportEnabled||n.Ay.featureToggles.autoMigrateOldPanels||f("autoMigrateOldPanels")||f("disableAngular");if(r.type==="graph"&&(d||n.Ay.featureToggles.autoMigrateGraphPanel||f("autoMigrateGraphPanel")))return r.xaxis?.mode==="series"?"barchart":r.xaxis?.mode==="histogram"?"histogram":"timeseries";if(d)return a.NB[r.type];if(r.type==="table-old"&&(n.Ay.featureToggles.autoMigrateTablePanel||f("autoMigrateTablePanel")))return"table";if(r.type==="grafana-piechart-panel"&&(n.Ay.featureToggles.autoMigratePiechartPanel||f("autoMigratePiechartPanel")))return"piechart";if(r.type==="grafana-worldmap-panel"&&(n.Ay.featureToggles.autoMigrateWorldmapPanel||f("autoMigrateWorldmapPanel")))return"geomap";if((r.type==="singlestat"||r.type==="grafana-singlestat-panel")&&n.Ay.featureToggles.autoMigrateStatPanel||f("autoMigrateStatPanel"))return"stat"}},34214:(Q,I,e)=>{"use strict";e.d(I,{G:()=>n.G,a:()=>a.a9});var n=e(98365),a=e(84423)},20470:(Q,I,e)=>{"use strict";e.d(I,{us:()=>U,vR:()=>w,yZ:()=>V,OI:()=>W});var n=e(71733),a=e(47232),o=e(69129),r=e(12131),i=e(17172),f=e(32264),d=e(82467),l=e(28138),m=e(3169),s=e(27677),h=e(33390),u=e(78160),b=e(17493),g=e(14792),P=e(74856),c=e(72255),y=e(71176),p=e(71101),v=e(54650);function D(_){return async H=>{const G=await s.IB.getFolderByUid(_);return H((0,v.jl)(G)),H((0,d.Vz)((0,p.R4)(G))),G}}var E=e(6473),S=e(2609),T=e(75096),M=e(31678),A=e(42972),x=e(72401),C=e(87421),O=e(16833),R=e(98365),L=e(41176),N=e(28601);const F="initDashboard";async function K(_,H,G){const j=h.A.getObject(U);if(j)return V(),j;try{switch(_.routeName){case M.DashboardRoutes.Home:{const oe=(0,c.sP)().getFromCache(c.m6);if(oe)return oe;const se=await s.IB.get("/api/dashboards/home");if(se.redirectUri){const ne=n.I.stripBaseFromUrl(se.redirectUri);return r.Ny.replace(ne),null}return se.meta.canSave=!1,se.meta.canShare=!1,se.meta.canStar=!1,se}case M.DashboardRoutes.Public:return await b.np.loadDashboard("public",_.urlSlug,_.accessToken);case M.DashboardRoutes.Normal:{const Y=await b.np.loadDashboard(_.urlType,_.urlSlug,_.urlUid);if(Y.meta.folderUid)try{await H(D(Y.meta.folderUid))}catch(oe){console.warn("Error fetching parent folder",Y.meta.folderUid,"for dashboard",oe)}if(_.fixUrl&&Y.meta.url&&!S._o.state.isPlaying){const oe=n.I.stripBaseFromUrl(Y.meta.url),se=r.Ny.getLocation().pathname;oe!==se&&(r.Ny.replace({...r.Ny.getLocation(),pathname:oe}),console.log("not correct url correcting",oe,se))}return Y}case M.DashboardRoutes.New:return _.urlFolderUid&&await H(D(_.urlFolderUid)),await(0,y.X)(_.urlFolderUid);case M.DashboardRoutes.Path:{const Y=_.urlSlug??"";return await b.np.loadDashboard(M.DashboardRoutes.Path,Y,Y)}default:throw{message:"Unknown route "+_.routeName}}}catch(Y){return(0,i.NF)(Y)&&Y.cancelled||(H((0,N.ig)({message:"Failed to fetch dashboard",error:Y})),console.error(Y)),null}}const B=(_,H={})=>(_.forEach(G=>{G.panels?B(G.panels,H):G.targets&&G.targets.forEach(j=>{j.datasource?.type&&(H[j.datasource.type]?H[j.datasource.type].push(j):H[j.datasource.type]=[j])})}),H);function w(_){return async(H,G)=>{(0,u.j)(F),H((0,N.xS)());const j=await K(_,H,G),Y=j?.dashboard?.version;if(!j)return;H((0,N.X1)());let oe;try{oe=new R.G(j.dashboard,j.meta)}catch(de){H((0,N.ig)({message:"Failed create dashboard model",error:de})),console.error(de);return}const se=G(),ne=r.Ny.getSearchObject();ne.orgId||r.Ny.partial({orgId:se.user.orgId},!0);const ee=(0,P.jG)();(0,g.UA)().setCurrent(oe),ee.init(oe);const z=(0,T.q4)(_.urlUid??oe.uid);if(await H((0,x._q)(z,oe)),(0,A.nm)({dashboard:oe,timeSrv:ee}).run({dashboard:oe,range:ee.timeRange()}),(0,C.Tk)(G())!==z||G().dashboard.initPhase!==M.DashboardInitPhase.Services)return;try{oe.processRepeats(),ne.autofitpanels&&oe.autoFitPanels(window.innerHeight,ne.kiosk),f.$.publicDashboardAccessToken||_.keybindingSrv.setupDashboardBindings(oe)}catch(de){de instanceof Error&&H((0,d.dx)((0,m.gi)("Dashboard init failed",de))),console.error(de)}_.routeName!==M.DashboardRoutes.New?((0,L.B)(oe),E.t.watch(oe.uid)):E.t.leave(),oe.weekStart!==""?(0,a.$D)(oe.weekStart):(0,a.$D)(f.$.bootData.user.weekStart),l.A.publish(new o.gc({dashboardId:oe.uid,orgId:se.user.orgId,userId:se.user.user?.id,grafanaVersion:f.$.buildInfo.version,queries:B(oe.panels)}));const ie=(0,u.z)(F);(0,O.d)(oe,ie?.duration,Y),H((0,N.O9)(oe))}}const U="DASHBOARD_FROM_LS_KEY";function W(_){h.A.setObject(U,_)}function V(){h.A.delete(U)}},28601:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>P,O9:()=>m,Ub:()=>b,X1:()=>s,ig:()=>l,p0:()=>h,xS:()=>d});var n=e(65307),a=e(79422),o=e(31678),r=e(98365);const i={initPhase:o.DashboardInitPhase.NotStarted,getModel:()=>null,initError:null,initialDatasource:void 0},f=(0,n.Z0)({name:"dashboard",initialState:i,reducers:{dashboardInitFetching:c=>{c.initPhase=o.DashboardInitPhase.Fetching},dashboardInitServices:c=>{c.initPhase=o.DashboardInitPhase.Services},dashboardInitCompleted:(c,y)=>{c.getModel=()=>y.payload,c.initPhase=o.DashboardInitPhase.Completed},dashboardInitFailed:(c,y)=>{c.initPhase=o.DashboardInitPhase.Failed,c.initError=y.payload,c.getModel=()=>new r.G({...a.Ye,title:"Dashboard init failed"},{canSave:!1,canEdit:!1})},cleanUpDashboard:c=>{c.initPhase=o.DashboardInitPhase.NotStarted,c.initError=null,c.getModel=()=>null},addPanel:(c,y)=>{},setInitialDatasource:(c,y)=>{c.initialDatasource=y.payload}}}),{dashboardInitFetching:d,dashboardInitFailed:l,dashboardInitCompleted:m,dashboardInitServices:s,cleanUpDashboard:h,addPanel:u,setInitialDatasource:b}=f.actions,P={dashboard:f.reducer}},36974:(Q,I,e)=>{"use strict";e.d(I,{B1:()=>p,CW:()=>c,OK:()=>l,SD:()=>s,VF:()=>h,_u:()=>g,dH:()=>v,ko:()=>y,no:()=>b,ob:()=>m,s3:()=>u});var n=e(2543),a=e.n(n),o=e(12131),r=e(2913),i=e(15054),f=e(33390),d=e(19752);function l(E,S){const T={type:"timeseries",title:"Panel Title",gridPos:(0,d.Ft)(E),datasource:S?{uid:S}:null,isNew:!0};return E.addPanel(T),T.id}function m(E,S){const T={type:S,title:"Widget title",gridPos:(0,d.Ft)(E),datasource:null,isNew:!0};return E.addPanel(T),T.id}function s(E){const S={type:"row",title:"Row title",gridPos:{x:0,y:0}};E.addPanel(S)}function h(){o.Ny.push("/dashboard/import")}function u(E){const S={type:"add-library-panel",gridPos:(0,d.Ft)(E)};E.addPanel(S)}function b(E,S){if(!S)return;const T=(0,d.Ft)(E),M={type:S.id,title:"Panel Title",gridPos:{x:T.x,y:T.y,w:S.defaults.gridPos.w,h:S.defaults.gridPos.h}};S.defaults&&((0,n.defaults)(M,S.defaults),M.title=S.defaults.title,f.A.delete(i.tH)),E.addPanel(M)}function g(){const E=(0,n.chain)(r.Ay.panels).filter({hideFromList:!1}).map(T=>T).value(),S=f.A.get(i.tH);if(S){const T=JSON.parse(S),M=(0,n.find)(E,{id:T.type});if(M){const A=(0,n.cloneDeep)(M);return A.name=T.title,A.sort=-1,{...A,defaults:{...T}}}}}const P="grafana.dashboards.panelEdit.lastUsedDatasource";function c(E){if(f.A.exists(P)){const S=f.A.getObject(P);if(S?.dashboardUid===E)return S}}function y(E){if(!f.A.exists(P))return;const T=f.A.getObject(P)?.datasourceUid??"";D(E,T)}function p(E){f.A.setObject(P,{dashboardUid:E,datasourceUid:""})}function v(E,S){const T=c(E);if(!T)D(E,S);else{const M=T?.dashboardUid??"";D(M,S)}}function D(E,S){f.A.setObject(P,{dashboardUid:E,datasourceUid:S})}},60444:(Q,I,e)=>{"use strict";e.d(I,{d:()=>s});var n=e(14236),a=e(43127),o=e(33948),r=e(39070),i=e(90708),f=e(2913),d=e(85595),l=e(74856),m=e(19752);function s(h,u){const b=(0,n.Bt)(h.snapshotData),g=new d.F,P={dashboard:u,range:(0,a.E2)()},c=g.canWork(P)?g.getAnnotationsInSnapshot(u,h.id):[],y=[(0,o.I)(c)];return{timeRange:(0,m.nk)(h,(0,l.jG)().timeRange()).timeRange,state:r.Gu.Done,series:(0,i.we)({data:b,fieldConfig:{defaults:{},overrides:[]},replaceVariables:h.replaceVariables,fieldConfigRegistry:h.plugin.fieldConfigRegistry,theme:f.config.theme2,timeZone:u.getTimezone()}),structureRev:1,annotations:y}}},19752:(Q,I,e)=>{"use strict";e.d(I,{ET:()=>x,FC:()=>v,Ft:()=>L,KJ:()=>E,Mc:()=>S,ZY:()=>M,d7:()=>T,iU:()=>D,nk:()=>C});var n=e(2543),a=e.n(n),o=e(26272),r=e(65879),i=e(47232),f=e(85858),d=e(72574),l=e(28138),m=e(2913),s=e(15054),h=e(33390),u=e(1702),b=e(84423),g=e(54174),P=e(96227),c=e(79971),y=e(99140),p=e(28444);const v=(N,F,K)=>{if(K!==!1){const B=F.alert?"YES":void 0;l.A.publish(new p.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",confirmText:B,yesText:"Remove",onConfirm:()=>v(N,F,!1)}));return}N.removePanel(F),(0,y.JD)((0,c.O6)(F.key))},D=(N,F)=>{N.duplicatePanel(F)},E=N=>{let F=N;N instanceof b.a9&&(F=N.getSaveModel()),h.A.set(s.tH,JSON.stringify(F)),l.A.emit(o.r1.alertSuccess,["Panel copied. Click **Add panel** icon to paste."])},S=(N,F)=>{l.A.publish(new p.S8({component:u.ShareModal,props:{dashboard:N,panel:F}}))},T=(N,F)=>{l.A.publish(new p.S8({component:P.o,props:{panel:F,initialFolderUid:N.meta.folderUid,isOpen:!0}}))},M=N=>{l.A.publish(new p.S8({component:g.l,props:{onConfirm:()=>N.unlinkLibraryPanel(),isOpen:!0}}))},A=N=>{N.refresh()},x=N=>{const F={...N.options};F.legend.showLegend===!0?F.legend.showLegend=!1:F.legend.showLegend=!0,N.updateOptions(F)};function C(N,F){const K={timeInfo:"",timeRange:F};if(N.timeFrom){const B=(0,d.w)().replace(N.timeFrom,N.scopedVars),w=r.describeTextRange(B);if(w.invalid)return K.timeInfo="invalid time override",K;if((0,n.isString)(F.raw.from)){const U=(0,i.AN)(F.from).tz(),W=(0,i.AN)(F.to).tz(),V=f.parse(w.from,void 0,U);K.timeInfo=w.display,K.timeRange={from:V,to:f.parse(w.to,void 0,W),raw:{from:w.from,to:w.to}}}}if(N.timeShift){const B=(0,d.w)().replace(N.timeShift,N.scopedVars);if(r.describeTextRange(B).invalid)return K.timeInfo="invalid timeshift",K;const U="-"+B;K.timeInfo+=" timeshift "+U;const W=f.parseDateMath(U,K.timeRange.from,!1),V=f.parseDateMath(U,K.timeRange.to,!0);K.timeRange={from:W,to:V,raw:{from:W,to:V}}}return N.hideTimeOverride&&(K.timeInfo=""),K}function O(N){const K=document.getElementsByTagName("html")[0].getBoundingClientRect().width;return N.maxDataPoints?N.maxDataPoints:Math.ceil(K*(N.gridPos.w/24))}function R(N,F){const K=N.plugin&&N.plugin.noPadding?0:config.theme.panelPadding*2,B=N.hasTitle()?config.theme.panelHeaderHeight:0;return F-B-K-PANEL_BORDER}function L(N){for(const K of N.panelIterator())K.gridPos.y+=8;return{x:0,y:0,w:12,h:8}}},21380:(Q,I,e)=>{"use strict";e.d(I,{z:()=>o});var n=e(47232),a=e(85858);const o=(r,i)=>{const f={from:(0,n.Ar)(r.from)?(0,n.KQ)(r.from):r.from,to:(0,n.Ar)(r.to)?(0,n.KQ)(r.to):r.to},d=i?i.getTimezone():void 0;return{from:a.parse(f.from,!1,d,i?.fiscalYearStartMonth),to:a.parse(f.to,!0,d,i?.fiscalYearStartMonth),raw:f}}},16833:(Q,I,e)=>{"use strict";e.d(I,{D:()=>o,d:()=>a});var n=e(7758);function a(l,m,s){const h=i(l.templating.list),u=r(l.panels);n.c.dashboardInitialized({uid:l.uid,title:l.title,theme:l.style,schemaVersion:l.schemaVersion,version_before_migration:s,panels_count:l.panels.length,...u,...h,settings_nowdelay:l.timepicker.nowDelay,settings_livenow:!!l.liveNow,duration:m,isScene:!1})}function o(l,m){const s=l.getInitialSaveModel();if(s){const h=r(s.panels||[]),u=i(s.templating?.list||[]);n.c.dashboardInitialized({uid:s.uid,title:s.title,theme:void 0,schemaVersion:s.schemaVersion,version_before_migration:s.version,panels_count:s.panels?.length||0,...h,...u,settings_nowdelay:void 0,settings_livenow:!!s.liveNow,duration:m,isScene:!0})}}function r(l){return l.map(m=>m.type).reduce((m,s)=>(m[d(s)]=1+m[d(s)]||1,m),{})}function i(l){return l.map(m=>m.type).reduce((m,s)=>(m[f(s)]=1+m[f(s)]||1,m),{})}const f=l=>`variable_type_${l}_count`,d=l=>`panel_type_${l}_count`},40489:(Q,I,e)=>{"use strict";e.d(I,{ZF:()=>f,vI:()=>i,o2:()=>d});var n=e(88483),a=e(14236);function o(l){const m=new Set;return Object.keys(l).forEach(s=>{l[s].forEach(h=>{m.add(h)})}),m}function r(l){const m=Array.from(o(l));return m.length===1?m[0]:`${m.slice(0,-1).join(", ")} or ${m.slice(-1)}`}function i(l){return new n.c(m=>{let s=0;Promise.all([e.e(2136),e.e(3686)]).then(e.bind(e,22136)).then(h=>{l.forEach(u=>{const b=new FileReader;b.readAsArrayBuffer(u),b.onload=()=>{const g=b.result;if(g&&g instanceof ArrayBuffer){if(u.type==="application/json"){const P=new TextDecoder("utf-8"),c=JSON.parse(P.decode(g));m.next({dataFrames:[(0,a.Vc)(c)],file:u})}else m.next({dataFrames:h.readSpreadsheet(g),file:u});++s>=l.length&&m.complete()}}})}).catch(()=>{throw"Failed to load sheets module"})})}const f={"text/plain":[".csv",".txt"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"],"application/vnd.apple.numbers":[".numbers"],"application/vnd.oasis.opendocument.spreadsheet":[".ods"],"application/json":[".json"]},d=5e5},87455:(Q,I,e)=>{"use strict";e.d(I,{r:()=>i});var n=e(96540),a=e(13544),o=e(42418);const r="This data source was added by config and cannot be modified using the UI. Please contact your server admin to update this data source.";function i(){return n.createElement(o.F,{"data-testid":a.Tp.pages.DataSource.readOnly,severity:"info",title:"Provisioned data source"},r)}},32738:(Q,I,e)=>{"use strict";e.d(I,{r:()=>d});var n=e(96540),a=e(55852),o=e(10096),r=e(8484),i=e(6320),f=e(31678);function d({variant:l,onClick:m}){const s=o.contextSrv.hasPermission(f.AccessControlAction.DataSourcesCreate),h=i.b.DataSourcesNew;return n.createElement(a.z9,{variant:l||"primary",href:h,disabled:!s,tooltip:s?void 0:"You do not have permission to configure new data sources",onClick:m,target:"_blank"},n.createElement(r.x6,{i18nKey:"data-source-picker.add-new-data-source"},"Configure a new data source"))}},2221:(Q,I,e)=>{"use strict";e.d(I,{A:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(10860),i=e(64149);function f({ds:l,onClick:m,selected:s,description:h,...u}){const b=(0,o.$j)(),g=d(b,l.meta.builtIn);return a.createElement(r.Z,{key:l.uid,onClick:m,className:(0,n.cx)(g.card,s?g.selected:void 0),...u},a.createElement(r.Z.Heading,{className:g.heading},a.createElement("div",{className:g.headingContent},a.createElement("span",{className:g.name},l.name," ",l.isDefault?a.createElement(i.L,{tags:["default"]}):null),a.createElement("small",{className:g.type},h||l.meta.name))),a.createElement(r.Z.Figure,{className:g.logo},a.createElement("img",{src:l.meta.info.logos.small,alt:`${l.meta.name} Logo`})))}function d(l,m=!1){return{card:(0,n.css)`
      cursor: pointer;
      background-color: ${l.colors.background.primary};
      border-bottom: 1px solid ${l.colors.border.weak};
      // Move to list component
      margin-bottom: 0;
      border-radius: 0;
      padding: ${l.spacing(1)};
    `,heading:(0,n.css)`
      width: 100%;
      overflow: hidden;
      // This is needed to enable ellipsis when text overlfows
      > button {
        width: 100%;
      }
    `,headingContent:(0,n.css)`
      color: ${l.colors.text.secondary};
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: flex;
      justify-content: space-between;
    `,logo:(0,n.css)`
      width: 32px;
      height: 32px;
      padding: ${l.spacing(0,1)};
      display: flex;
      align-items: center;

      > img {
        max-height: 100%;
        min-width: 24px;
        filter: invert(${m&&l.isLight?1:0});
      }
    `,name:(0,n.css)`
      color: ${l.colors.text.primary};
      display: flex;
      gap: ${l.spacing(2)};
    `,type:(0,n.css)`
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: flex;
      align-items: center;
    `,separator:(0,n.css)`
      margin: 0 ${l.spacing(1)};
      color: ${l.colors.border.weak};
    `,selected:(0,n.css)`
      background-color: ${l.colors.background.secondary};
    `,meta:(0,n.css)`
      display: block;
      overflow-wrap: unset;
      white-space: nowrap;
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
    `}}},11219:(Q,I,e)=>{"use strict";e.d(I,{S:()=>h});var n=e(32196),a=e(96540),o=e(13544),r=e(72574),i=e(40845),f=e(8484),d=e(87282),l=e(32738),m=e(2221),s=e(47311);function h(c){const y=(0,a.useRef)(null),[p,v]=(0,d.dR)({keyboardEvents:c.keyboardEvents,containerRef:y}),D=(0,i.$j)(),E=P(D,v),{className:S,current:T,onChange:M,enableKeyboardNavigation:A,onClickEmptyStateCTA:x}=c,C=(0,d.Kr)({alerting:c.alerting,annotations:c.annotations,dashboard:c.dashboard,logs:c.logs,metrics:c.metrics,mixed:c.mixed,pluginId:c.pluginId,tracing:c.tracing,type:c.type,variables:c.variables}),[O,R]=(0,d.TX)(),L=c.filter?C.filter(c.filter):C;return a.createElement("div",{ref:y,className:(0,n.cx)(S,E.container),"data-testid":o.Tp.components.DataSourcePicker.dataSourceList},L.length===0&&a.createElement(u,{className:E.emptyState,onClickCTA:x}),L.sort((0,s.Tj)(T,O,g())).map(N=>a.createElement(m.A,{"data-testid":"data-source-card",key:N.uid,ds:N,onClick:()=>{R(N),M(N)},selected:(0,s.Df)(N,T),...A?p:{}})))}function u({className:c,onClickCTA:y}){const p=(0,i.of)(b);return a.createElement("div",{className:(0,n.cx)(c,p.container)},a.createElement("p",{className:p.message},a.createElement(f.x6,{i18nKey:"data-source-picker.list.no-data-source-message"},"No data sources found")),a.createElement(l.r,{onClick:y}))}function b(c){return{container:(0,n.css)`
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    `,message:(0,n.css)`
      margin-bottom: ${c.spacing(3)};
    `}}function g(){return(0,r.w)().getVariables().filter(y=>y.type==="datasource").map(y=>`\${${y.id}}`)}function P(c,y){return{container:(0,n.css)`
      display: flex;
      flex-direction: column;
      ${y} {
        background-color: ${c.colors.background.secondary};
      }
    `,emptyState:(0,n.css)`
      height: 100%;
      flex: 1;
    `}}},50481:(Q,I,e)=>{"use strict";e.d(I,{p:()=>A});var n=e(32196),a=e(2543),o=e(96540),r=e(14110),i=e(32264),f=e(40845),d=e(37390),l=e(10354),m=e(14578),s=e(40276),h=e(37270),u=e(8484),b=e(40489),g=e(90478),P=e(87282),c=e(32738),y=e(13544),p=e(2221),v=e(47311);function D(C){switch(C){case"grafana":return(0,u.t)("data-source-picker.built-in-list.description-grafana","Discover visualizations using mock data");case"-- Mixed --":return(0,u.t)("data-source-picker.built-in-list.description-mixed","Use multiple data sources");case"-- Dashboard --":return(0,u.t)("data-source-picker.built-in-list.description-dashboard","Reuse query results from other visualizations");default:return""}}function E({className:C,current:O,onChange:R,tracing:L,dashboard:N,mixed:F,metrics:K,type:B,annotations:w,variables:U,alerting:W,pluginId:V,logs:_,filter:H}){const j=(0,P.Kr)({tracing:L,dashboard:N,mixed:F,metrics:K,type:B,annotations:w,variables:U,alerting:W,pluginId:V,logs:_}).filter(Y=>(H?H?.(Y):!0)&&!!Y.meta.builtIn);return o.createElement("div",{className:C,"data-testid":y.Tp.components.DataSourcePicker.advancedModal.builtInDataSourceList},j.map(Y=>o.createElement(p.A,{key:Y.uid,ds:Y,description:D(Y.uid),selected:(0,v.Df)(Y,O),onClick:()=>R(Y)})))}var S=e(11219);const T="dashboards_dspickermodal_clicked",M={SELECT_DS:"select_ds",UPLOAD_FILE:"upload_file",CONFIG_NEW_DS:"config_new_ds",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state",SEARCH:"search",DISMISS:"dismiss"};function A({tracing:C,dashboard:O,mixed:R,metrics:L,type:N,annotations:F,variables:K,alerting:B,pluginId:w,logs:U,uploadFile:W,filter:V,onChange:_,current:H,onDismiss:G,reportedInteractionFrom:j}){const Y=(0,f.of)(x),[oe,se]=(0,o.useState)(""),ne=j||"modal",ee=()=>{G(),(0,r.rR)(T,{item:M.DISMISS,src:ne})},Z=ue=>{_(ue),(0,r.rR)(T,{item:M.SELECT_DS,ds_type:ue.type,src:ne})},z=o.useMemo(()=>(0,a.once)(()=>{(0,r.rR)(T,{item:"search",src:ne})}),[ne]),q=(0,P.ps)("-- Grafana --"),ie=(0,g.j)((ue,fe)=>{q&&(_(q,[ue]),(0,r.rR)(T,{item:M.UPLOAD_FILE,src:ne}),fe.length<1&&G())}),de=({className:ue})=>o.createElement(E,{className:ue,onChange:Z,current:H,filter:V,variables:K,tracing:C,metrics:L,type:N,annotations:F,alerting:B,pluginId:w,logs:U,dashboard:O,mixed:R});return o.createElement(d.a,{title:(0,u.t)("data-source-picker.modal.title","Select data source"),closeOnEscape:!0,closeOnBackdropClick:!0,isOpen:!0,className:Y.modal,contentClassName:Y.modalContent,onClickBackdrop:ee,onDismiss:ee},o.createElement("div",{className:Y.leftColumn},o.createElement(l.p,{type:"search",autoFocus:!0,className:Y.searchInput,value:oe,prefix:o.createElement(m.I,{name:"search"}),placeholder:(0,u.t)("data-source-picker.modal.input-placeholder","Select data source"),onChange:ue=>{se(ue.currentTarget.value),z()}}),o.createElement(s.E,null,o.createElement(S.S,{onChange:Z,current:H,onClickEmptyStateCTA:()=>(0,r.rR)(T,{item:M.CONFIG_NEW_DS_EMPTY_STATE,src:ne}),filter:ue=>(V?V?.(ue):!0)&&(0,v.Zn)(ue,oe)&&!ue.meta.builtIn,variables:K,tracing:C,metrics:L,type:N,annotations:F,alerting:B,pluginId:w,logs:U,dashboard:O,mixed:R}),o.createElement(de,{className:Y.appendBuiltInDataSourcesList}))),o.createElement("div",{className:Y.rightColumn},o.createElement("div",{className:Y.builtInDataSources},o.createElement(s.E,{className:Y.builtInDataSourcesList},o.createElement(de,null)),W&&i.$.featureToggles.editPanelCSVDragAndDrop&&o.createElement(h.gH,{readAs:"readAsArrayBuffer",fileListRenderer:()=>{},options:{maxSize:b.o2,multiple:!1,accept:b.ZF,onDrop:ie}},o.createElement(h.wI,null))),o.createElement("div",{className:Y.newDSSection},o.createElement("span",{className:Y.newDSDescription},o.createElement(u.x6,{i18nKey:"data-source-picker.modal.configure-new-data-source"},"Open a new tab and configure a data source")),o.createElement(c.r,{variant:"secondary",onClick:()=>{(0,r.rR)(T,{item:M.CONFIG_NEW_DS,src:ne}),G()}}))))}function x(C){return{modal:(0,n.css)`
      width: 80%;
      height: 80%;
      max-width: 1200px;
      max-height: 900px;

      ${C.breakpoints.down("md")} {
        width: 100%;
      }
    `,modalContent:(0,n.css)`
      display: flex;
      flex-direction: row;
      height: 100%;

      ${C.breakpoints.down("md")} {
        flex-direction: column;
      }
    `,leftColumn:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 50%;
      height: 100%;
      padding-right: ${C.spacing(4)};
      border-right: 1px solid ${C.colors.border.weak};

      ${C.breakpoints.down("md")} {
        width: 100%;
        border-right: 0;
        padding-right: 0;
        flex: 1;
        overflow-y: auto;
      }
    `,rightColumn:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 50%;
      height: 100%;
      justify-items: space-evenly;
      align-items: stretch;
      padding-left: ${C.spacing(4)};

      ${C.breakpoints.down("md")} {
        width: 100%;
        padding-left: 0;
        flex: 0;
      }
    `,builtInDataSources:(0,n.css)`
      flex: 1 1;
      margin-bottom: ${C.spacing(4)};

      ${C.breakpoints.down("md")} {
        flex: 0;
      }
    `,builtInDataSourcesList:(0,n.css)`
      ${C.breakpoints.down("md")} {
        display: none;
        margin-bottom: 0;
      }

      margin-bottom: ${C.spacing(4)};
    `,appendBuiltInDataSourcesList:(0,n.css)`
      ${C.breakpoints.up("md")} {
        display: none;
      }
    `,newDSSection:(0,n.css)`
      display: flex;
      flex-direction: row;
      width: 100%;
      justify-content: space-between;
      align-items: center;
    `,newDSDescription:(0,n.css)`
      flex: 1 0;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
      color: ${C.colors.text.secondary};
    `,searchInput:(0,n.css)`
      width: 100%;
      min-height: 32px;
      margin-bottom: ${C.spacing(1)};
    `}}},51612:(Q,I,e)=>{"use strict";e.d(I,{s:()=>N});var n=e(32196),a=e(34743),o=e(36376),r=e(7315),i=e(18828),f=e(85690),d=e(93225),l=e(96540),m=e(13544),s=e(14110),h=e(40845),u=e(10354),b=e(14578),g=e(17464),P=e(40276),c=e(71678),y=e(55852),p=e(2913),v=e(8484),D=e(97427),E=e(68706),S=e(87282),T=e(11219);function M(W){const{dataSource:V}=W,_=(0,h.$j)(),H=x(_,V?.meta.builtIn);return V?l.createElement("img",{className:H.pickerDSLogo,alt:`${V.meta.name} logo`,src:V.meta.info.logos.small}):A()}function A(){const W=(0,h.of)(x);return l.createElement("div",{className:W.pickerDSLogo})}function x(W,V=!1){return{pickerDSLogo:(0,n.css)`
      height: 20px;
      width: 20px;
      filter: invert(${V&&W.isLight?1:0});
    `}}var C=e(50481),O=e(47311);const R="dashboards_dspicker_clicked",L={OPEN_DROPDOWN:"open_dspicker",SELECT_DS:"select_ds",ADD_FILE:"add_file",OPEN_ADVANCED_DS_PICKER:"open_advanced_ds_picker",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state"};function N(W){const{current:V,onChange:_,hideTextValue:H=!1,width:G,inputId:j,noDefault:Y=!1,disabled:oe=!1,placeholder:se="Select data source",...ne}=W,ee=(0,h.of)(F,W),[Z,z]=(0,l.useState)(!1),[q,ie]=(0,l.useState)(!1),[de,ue]=(0,l.useState)(""),{onKeyDown:fe,keyboardEvents:Se}=(0,D.d)(),he=(0,l.useRef)(null),[ce,me]=(0,l.useState)(),[pe,ye]=(0,l.useState)(),Pe=(0,S.ps)(V),Ie=(0,S.ps)("-- Grafana --"),Oe=!V&&Y?void 0:Pe,Ne=de&&Z?l.createElement(A,null):l.createElement(M,{dataSource:Oe}),We=[(0,a.cY)(4),(0,a.Ej)({apply({availableHeight:re,elements:X}){X.floating.style.maxHeight=`${Math.max(200,re-20)}px`,X.floating.style.minHeight="200px"}}),(0,a.UU)({fallbackStrategy:"initialPlacement",crossAxis:!1,boundary:document.body}),(0,a.BN)()],{refs:Ae,floatingStyles:Ue}=(0,o.we)({open:Z,placement:"bottom-start",onOpenChange:z,middleware:We,whileElementsMounted:r.ll,strategy:"fixed"}),Me=(0,l.useCallback)(re=>{Ae.setReference(re),me(re)},[Ae]),$e=(0,l.useCallback)(()=>{ue(""),z(!1),ce?.focus()},[z,ce]),{overlayProps:ke,underlayProps:Ze}=(0,d.e)({onClose:$e,isDismissable:!0,isOpen:Z,shouldCloseOnInteractOutside:re=>ce?!ce.isSameNode(re):!1},he),{dialogProps:ot}=(0,i.s)({"aria-label":"Opened data source picker list"},he);function xt(){(0,s.rR)(R,{item:L.OPEN_DROPDOWN}),z(!0),ce?.focus()}function ct(){Ie&&_(Ie,[E.dx])}function ft(re){re.key==="Tab"&&!re.shiftKey&&Z&&(re.preventDefault(),pe?.focus()),re.key==="Tab"&&re.shiftKey&&Z&&$e(),fe(re)}function Le(re){re.shiftKey?(re.preventDefault(),ce?.focus()):$e()}return(0,l.useEffect)(()=>{const re=Se.subscribe({next:X=>{switch(X?.code){case"ArrowDown":xt(),X.preventDefault();break;case"ArrowUp":xt(),X.preventDefault();break;case"Escape":$e(),X.preventDefault();break}}});return()=>re.unsubscribe()}),l.createElement("div",{className:ee.container,"data-testid":m.Tp.components.DataSourcePicker.container},l.createElement("div",{className:ee.trigger,onClick:xt},l.createElement(u.p,{id:j||"data-source-picker",className:q?void 0:ee.input,"data-testid":m.Tp.components.DataSourcePicker.inputV2,"aria-label":"Select a data source",autoComplete:"off",prefix:Oe?Ne:void 0,suffix:l.createElement(b.I,{name:Z?"search":"angle-down"}),placeholder:H?"":(0,O.q7)(Oe)||se,onFocus:()=>{ie(!0)},onBlur:()=>{ie(!1)},onKeyDown:ft,value:de,onChange:re=>{xt(),ue(re.currentTarget.value)},ref:Me,disabled:oe})),Z?l.createElement(g.ZL,null,l.createElement("div",{...Ze}),l.createElement("div",{ref:he,...ke,...ot},l.createElement(K,{...ne,style:Ue,ref:Ae.setFloating,footerRef:ye,current:Oe,filterTerm:de,keyboardEvents:Se,onChange:(re,X)=>{$e(),re.uid!==Oe?.uid&&(_(re,X),(0,s.rR)(R,{item:L.SELECT_DS,ds_type:re.type}))},onClose:$e,onClickAddCSV:ct,onDismiss:$e,onNavigateOutsiteFooter:Le}))):null)}function F(W,V){return{container:(0,n.css)({position:"relative",cursor:V.disabled?"not-allowed":"pointer",width:W.spacing(V.width||"auto")}),trigger:(0,n.css)({cursor:"pointer",pointerEvents:V.disabled?"none":"auto"}),input:(0,n.css)({"input::placeholder":{color:V.disabled?W.colors.action.disabledText:W.colors.text.primary}})}}const K=l.forwardRef((W,V)=>{const{filterTerm:_,onChange:H,onClose:G,onClickAddCSV:j,current:Y,filter:oe}=W,se=(0,l.useCallback)(Z=>{H(Z)},[H]),ne=(0,l.useCallback)(()=>{j?.(),G(),(0,s.rR)(R,{item:L.ADD_FILE})},[j,G]),ee=(0,h.of)(B);return l.createElement("div",{style:W.style,ref:V,className:ee.container},l.createElement(P.E,null,l.createElement(T.S,{...W,enableKeyboardNavigation:!0,className:ee.dataSourceList,current:Y,onChange:se,filter:Z=>(oe?oe?.(Z):!0)&&(0,O.Zn)(Z,_),onClickEmptyStateCTA:()=>(0,s.rR)(R,{item:L.CONFIG_NEW_DS_EMPTY_STATE})})),l.createElement(f.n1,null,l.createElement(w,{...W,onClickAddCSV:ne,onChange:se,onNavigateOutsiteFooter:W.onNavigateOutsiteFooter})))});K.displayName="PickerContent";function B(W){return{container:(0,n.css)({display:"flex",flexDirection:"column",background:W.colors.background.primary,boxShadow:W.shadows.z3}),picker:(0,n.css)({background:W.colors.background.secondary}),dataSourceList:(0,n.css)({flex:1}),footer:(0,n.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:W.spacing(1.5),borderTop:`1px solid ${W.colors.border.weak}`,backgroundColor:W.colors.background.secondary})}}function w({onClose:W,onChange:V,onClickAddCSV:_,...H}){const G=(0,h.of)(U),j=H.uploadFile&&p.Ay.featureToggles.editPanelCSVDragAndDrop,Y=se=>{se.key==="Tab"&&H.onNavigateOutsiteFooter(se)},oe=se=>{se.key==="Tab"&&se.shiftKey&&H.onNavigateOutsiteFooter(se)};return l.createElement("div",{className:G.footer},l.createElement(c.$s,null,({showModal:se,hideModal:ne})=>l.createElement(y.$n,{size:"sm",variant:"secondary",fill:"text",onClick:()=>{W(),se(C.p,{reportedInteractionFrom:"ds_picker",tracing:H.tracing,dashboard:H.dashboard,mixed:H.mixed,metrics:H.metrics,type:H.type,annotations:H.annotations,variables:H.variables,alerting:H.alerting,pluginId:H.pluginId,logs:H.logs,filter:H.filter,uploadFile:H.uploadFile,current:H.current,onDismiss:ne,onChange:(ee,Z)=>{V(ee,Z),ne()}}),(0,s.rR)(R,{item:L.OPEN_ADVANCED_DS_PICKER})},ref:H.footerRef,onKeyDown:j?oe:Y},l.createElement(v.x6,{i18nKey:"data-source-picker.open-advanced-button"},"Open advanced data source picker"),l.createElement(b.I,{name:"arrow-right"}))),j&&l.createElement(y.$n,{variant:"secondary",size:"sm",onClick:_,onKeyDown:Y},"Add csv or spreadsheet"))}function U(W){return{footer:(0,n.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:W.spacing(1.5),borderTop:`1px solid ${W.colors.border.weak}`,backgroundColor:W.colors.background.secondary})}}},47311:(Q,I,e)=>{"use strict";e.d(I,{Df:()=>r,Tj:()=>f,Zn:()=>d,q7:()=>i,tw:()=>l});var n=e(14792),a=e(36974),o=e(14678);function r(m,s){return!m||!s?!1:typeof s=="string"?m.uid===s:m.uid===s.uid}function i(m){if(m){if(typeof m=="string")return`${m} - not found`;if("name"in m)return m.name;if(m.uid)return`${m.uid} - not found`}}function f(m,s,h){return(b,g)=>{const P=b.name.toUpperCase(),c=g.name.toUpperCase();if(m&&r(b,m))return-1;if(m&&r(g,m))return 1;const y=s.indexOf(b.uid),p=s.indexOf(g.uid);if(y>-1&&y>p)return-1;if(p>-1&&p>y)return 1;const v=h.includes(b.uid),D=h.includes(g.uid);return v&&!D?-1:D&&!v||b.meta.builtIn&&!g.meta.builtIn?1:g.meta.builtIn&&!b.meta.builtIn||P<c?-1:1}}function d(m,s=""){return m.name.toLowerCase().includes(s.toLowerCase())}function l(m){if(!m.uid)return;const s=(0,n.UA)().getCurrent()?.uid??"";if(m.uid===o.uv)return(0,a.B1)(s);(0,a.dH)(s,m.uid)}},83883:(Q,I,e)=>{"use strict";e.d(I,{I:()=>n});const n={List:"/datasources",Edit:"/datasources/edit/:uid",Dashboards:"/datasources/edit/:uid/dashboards",New:"/datasources/new"}},87282:(Q,I,e)=>{"use strict";e.d(I,{Kr:()=>f,TX:()=>i,dR:()=>l,ps:()=>d});var n=e(96540),a=e(78685),o=e(19347);const r="grafana.features.datasources.components.picker.DataSourceDropDown.history";function i(){const[m=[],s]=(0,a.A)(r,[]),h=(0,n.useCallback)(u=>{u.meta.builtIn||(m.includes(u.uid)?(m.splice(m.findIndex(b=>u.uid===b),1),s([...m,u.uid])):s([...m,u.uid].slice(1,6)))},[m,s]);return[m,h]}function f(m){return(0,o.l)().getList(m)}function d(m){const s=(0,o.l)();return s.getInstanceSettings(m)}function l(m){const{keyboardEvents:s,containerRef:h}=m,u=(0,n.useRef)(0),b="data-role",g="keyboardSelectableItem",P={[b]:g},c=`[${b}="${g}"`,y="data-selectedItem",p=`[${y}="true"]`,v=(0,n.useCallback)(E=>{const S=h?.current?.querySelectorAll(c),T=S?.item(E%S?.length);S?.forEach(M=>M.setAttribute(y,"false")),T&&(T.scrollIntoView({block:"center"}),T.setAttribute(y,"true"))},[h,c]),D=(0,n.useCallback)(()=>{h?.current?.querySelector(p)?.querySelector("button")?.click()},[h,p]);return(0,n.useEffect)(()=>{if(!s)return;const E=s.subscribe({next:S=>{switch(S?.code){case"ArrowDown":{v(++u.current),S.preventDefault();break}case"ArrowUp":u.current=u.current>0?u.current-1:u.current,v(u.current),S.preventDefault();break;case"Enter":D();break}}});return()=>E.unsubscribe()},[s,v,D]),(0,n.useEffect)(()=>{const E=new MutationObserver(S=>{S.some(M=>M.addedNodes&&M.addedNodes.length>0||M.removedNodes&&M.removedNodes.length>0)&&v(0)});return h.current&&E.observe(h.current,{childList:!0}),()=>{E.disconnect()}},[h,c,v]),[P,p]}},34258:(Q,I,e)=>{"use strict";e.d(I,{du:()=>oe,Qq:()=>ee,PK:()=>_,ak:()=>j,xI:()=>Y,G2:()=>se,bn:()=>G,Ge:()=>H,jB:()=>ne});var n=e(69129),a=e(71733),o=e(26657),r=e(17172),i=e(32264),f=e(12131),d=e(82467),l=e(10096),m=e(27677),s=e(6320),h=e(31193),u=e(27716),b=e(54427),g=e(31678),P=e(75505),c=e(80714);const y=async()=>await(0,m.AI)().get("/api/datasources"),p=async Z=>{const z=await(0,P.s)((0,m.AI)().fetch({method:"GET",url:`/api/datasources/${Z}`,params:(0,c.F)(),showErrorAlert:!1}));if(z.ok)return z.data;throw Error(`Could not find data source by ID: "${Z}"`)},v=async Z=>{const z=await(0,P.s)((0,m.AI)().fetch({method:"GET",url:`/api/datasources/uid/${Z}`,params:(0,c.F)(),showErrorAlert:!1}));if(z.ok)return z.data;throw Error(`Could not find data source by UID: "${Z}"`)},D=async Z=>{try{return await v(Z)}catch{console.log(`Failed to lookup data source using UID "${Z}"`)}try{return await p(Z)}catch{console.log(`Failed to lookup data source using ID "${Z}"`)}throw Error("Could not find data source")},E=Z=>(0,m.AI)().post("/api/datasources",Z),S=()=>(0,m.AI)().get("/api/plugins",{enabled:1,type:"datasource"}),T=Z=>(0,m.AI)().put(`/api/datasources/uid/${Z.uid}`,Z,{showErrorAlert:!1,showSuccessAlert:!1}),M=Z=>(0,m.AI)().delete(`/api/datasources/uid/${Z}`);var A=e(83883),x=e(4589),C=e(43429),O=e(33378);function R(Z){const z=[{id:"tsdb",title:"Time series databases",plugins:[]},{id:"logging",title:"Logging & document databases",plugins:[]},{id:"tracing",title:"Distributed tracing",plugins:[]},{id:"profiling",title:"Profiling",plugins:[]},{id:"sql",title:"SQL",plugins:[]},{id:"cloud",title:"Cloud",plugins:[]},{id:"enterprise",title:"Enterprise plugins",plugins:[]},{id:"iot",title:"Industrial & IoT",plugins:[]},{id:"other",title:"Others",plugins:[]}].filter(ue=>ue),q={},ie={},de=N();for(const ue of z)q[ue.id]=ue;for(const ue of Z){const fe=de.find(he=>he.id===ue.id);if((ue.enterprise||fe)&&(ue.category="enterprise",ue.unlicensed=!(0,O.a)("enterprise.plugins"),ue.info.links=fe?.info?.links||ue.info.links),ue.info.links)for(const he of ue.info.links)he.name="Learn more";(z.find(he=>he.id===ue.category)||q.other).plugins.push(ue),ie[ue.id]=ue}for(const ue of z){if(ue.id==="cloud"&&ue.plugins.push(F()),ue.id==="enterprise")for(const fe of de)ie[fe.id]||ue.plugins.push(fe);L(ue.plugins)}return z.filter(ue=>ue.plugins.length>0)}function L(Z){const z={prometheus:100,graphite:95,loki:90,mysql:80,jaeger:100,postgres:79,gcloud:-1};Z.sort((q,ie)=>{const de=z[q.id]||0,ue=z[ie.id]||0;return de>ue?-1:de<ue||q.name>ie.name?1:-1})}function N(){return[K({id:"grafana-splunk-datasource",name:"Splunk",description:"Visualize and explore Splunk logs",imgUrl:"public/img/plugins/splunk_logo_128.png"}),K({id:"grafana-oracle-datasource",name:"Oracle",description:"Visualize and explore Oracle SQL",imgUrl:"public/img/plugins/oracle.png"}),K({id:"grafana-dynatrace-datasource",name:"Dynatrace",description:"Visualize and explore Dynatrace data",imgUrl:"public/img/plugins/dynatrace.png"}),K({id:"grafana-servicenow-datasource",description:"ServiceNow integration and data source",name:"ServiceNow",imgUrl:"public/img/plugins/servicenow.svg"}),K({id:"grafana-datadog-datasource",description:"DataDog integration and data source",name:"DataDog",imgUrl:"public/img/plugins/datadog.png"}),K({id:"grafana-newrelic-datasource",description:"New Relic integration and data source",name:"New Relic",imgUrl:"public/img/plugins/newrelic.svg"}),K({id:"grafana-mongodb-datasource",description:"MongoDB integration and data source",name:"MongoDB",imgUrl:"public/img/plugins/mongodb.svg"}),K({id:"grafana-snowflake-datasource",description:"Snowflake integration and data source",name:"Snowflake",imgUrl:"public/img/plugins/snowflake.svg"}),K({id:"grafana-wavefront-datasource",description:"Wavefront integration and data source",name:"Wavefront",imgUrl:"public/img/plugins/wavefront.svg"}),K({id:"dlopes7-appdynamics-datasource",description:"AppDynamics integration and data source",name:"AppDynamics",imgUrl:"public/img/plugins/appdynamics.svg"}),K({id:"grafana-saphana-datasource",description:"SAP HANA\xAE integration and data source",name:"SAP HANA\xAE",imgUrl:"public/img/plugins/sap_hana.png"}),K({id:"grafana-honeycomb-datasource",description:"Honeycomb integration and datasource",name:"Honeycomb",imgUrl:"public/img/plugins/honeycomb.png"}),K({id:"grafana-salesforce-datasource",description:"Salesforce integration and datasource",name:"Salesforce",imgUrl:"public/img/plugins/salesforce.svg"}),K({id:"grafana-jira-datasource",description:"Jira integration and datasource",name:"Jira",imgUrl:"public/img/plugins/jira_logo.png"}),K({id:"grafana-gitlab-datasource",description:"GitLab integration and datasource",name:"GitLab",imgUrl:"public/img/plugins/gitlab.svg"}),K({id:"grafana-splunk-monitoring-datasource",description:"SignalFx integration and datasource",name:"Splunk Infrastructure Monitoring",imgUrl:"public/img/plugins/signalfx-logo.svg"}),K({id:"grafana-azuredevops-datasource",description:"Azure Devops datasource",name:"Azure Devops",imgUrl:"public/img/plugins/azure-devops.png"}),K({id:"grafana-sumologic-datasource",description:"SumoLogic integration and datasource",name:"SumoLogic",imgUrl:"public/img/plugins/sumo.svg"}),K({id:"grafana-pagerduty-datasource",description:"PagerDuty datasource",name:"PagerDuty",imgUrl:"public/img/plugins/pagerduty.svg"}),K({id:"grafana-azurecosmosdb-datasource",description:"Azure CosmosDB datasource",name:"Azure CosmosDB",imgUrl:"public/img/plugins/azure-cosmosdb.svg"})]}function F(){return{id:"gcloud",name:"Grafana Cloud",type:C.QE.datasource,module:"phantom",baseUrl:"",info:{description:"Hosted Graphite, Prometheus, and Loki",logos:{small:"public/img/grafana_icon.svg",large:"asd"},author:{name:"Grafana Labs"},links:[{url:"https://grafana.com/products/cloud/",name:"Learn more"}],screenshots:[],updated:"2019-05-10",version:"1.0.0"}}}function K(Z){return{id:Z.id,name:Z.name,type:C.QE.datasource,module:"phantom",baseUrl:"",info:{description:Z.description,logos:{small:Z.imgUrl,large:Z.imgUrl},author:{name:"Grafana Labs"},links:[{url:"/plugins/"+Z.id,name:"Install now",target:"_self"}],screenshots:[],updated:"2019-05-10",version:"1.0.0"}}}var B=e(74984),w=e(36227),U=e(54226);const W=Z=>{let z,q;return Z.error&&Z.error instanceof o.b1?(z=Z.error.message,q=Z.error.details):(0,r.NF)(Z)?z=Z.data.message??`HTTP error ${Z.statusText}`:Z instanceof Error&&(z=Z.message),{message:z,details:q}},V=Z=>{const{details:z,message:q,status:ie}=Z;return{status:ie,message:q,details:z}},_=(Z,z={loadDataSource:j,loadDataSourceMeta:Y,getDataSource:U.U4,getDataSourceMeta:U.Fj,importDataSourcePlugin:b.cS})=>async(q,ie)=>{if(!Z){q((0,w.qR)(new Error("Invalid UID")));return}try{const de=await q(z.loadDataSource(Z));await q(z.loadDataSourceMeta(de));const ue=z.getDataSource(ie().dataSources,Z),fe=z.getDataSourceMeta(ie().dataSources,ue.type),Se=await z.importDataSourcePlugin(fe);q((0,w.Ks)(Se))}catch(de){de instanceof Error&&q((0,w.qR)(de))}},H=(Z,z=A.I.Edit,q={getDatasourceSrv:h.tR,getBackendSrv:m.AI})=>async(ie,de)=>{const ue=await q.getDatasourceSrv().get(Z),fe=z.replace(/:uid/gi,Z);ue.testDatasource&&(ie((0,w.QZ)()),q.getBackendSrv().withNoBackendCache(async()=>{try{const Se=await ue.testDatasource(),he=V({...Se,details:{...Se.details}});ie((0,w.lg)(he)),(0,x.Mh)({grafana_version:i.$.buildInfo.version,plugin_id:ue.type,datasource_uid:ue.uid,success:!0,path:fe}),l.lE.publish(new n.NI)}catch(Se){const he=W(Se);ie((0,w.UP)({...he})),(0,x.Mh)({grafana_version:i.$.buildInfo.version,plugin_id:ue.type,datasource_uid:ue.uid,success:!1,path:fe}),l.lE.publish(new n.LL)}}))};function G(){return async Z=>{if(!l.contextSrv.hasPermission(g.AccessControlAction.DataSourcesRead))return;Z((0,w.TN)());const z=await y();Z((0,w.E1)(z))}}function j(Z){return async z=>{let q=await D(Z);return Z!==q.uid&&(window.location.href=a.I.assureBaseUrl(`/datasources/edit/${q.uid}`),q={}),z((0,w.jz)(q)),q}}function Y(Z){return async z=>{const q=await(0,u.x)(Z.type),ie=await(0,b.cS)(q),de=ie.DataSourceClass.prototype instanceof o.iy,ue={...q,isBackend:q.backend||de};z((0,w.gZ)(ue)),ie.meta=ue,z((0,d.Vz)((0,B.R4)(Z,ie)))}}function oe(Z,z=A.I.Edit){return async()=>{const q={type:Z.id,access:"proxy"},ie=await E(q),de=z.replace(/:uid/gi,ie.datasource.uid);await(0,h.tR)().reload(),await l.contextSrv.fetchUserPermissions(),(0,x.V9)({grafana_version:i.$.buildInfo.version,plugin_id:Z.id,datasource_uid:ie.datasource.uid,plugin_version:ie.meta?.info?.version,path:de}),f.Ny.push(de)}}function se(){return async Z=>{Z((0,w.Gc)());const z=await S(),q=R(z);Z((0,w.f$)({plugins:z,categories:q}))}}function ne(Z){return async z=>{try{await T(Z)}catch(q){const ie=W(q);return z((0,w.UP)(ie)),Promise.reject(Z)}return await(0,h.tR)().reload(),z(j(Z.uid))}}function ee(){return async(Z,z)=>{const{uid:q}=z().dataSources.dataSource;try{await M(q),await(0,h.tR)().reload();const ie=s.b.DataSources;f.Ny.push(ie)}catch(ie){const de=W(ie);Z((0,w.UP)(de))}}}},458:(Q,I,e)=>{"use strict";e.d(I,{C:()=>o});var n=e(96540),a=e(83883);const o=(0,n.createContext)(a.I)},11084:(Q,I,e)=>{"use strict";e.d(I,{$k:()=>v,BY:()=>b,S4:()=>S,Tn:()=>E,US:()=>g,Um:()=>y,_e:()=>T,aM:()=>A,hx:()=>c,k9:()=>p,oU:()=>u,u1:()=>M,xw:()=>D});var n=e(96540),a=e(97007),o=e(28138),r=e(10096),i=e(31678),f=e(28444),d=e(11959),l=e(34258),m=e(458),s=e(36227),h=e(54226);const u=x=>{const C=(0,i.useDispatch)();(0,n.useEffect)(()=>(C((0,l.PK)(x)),function(){C((0,a.N)({cleanupAction:R=>R.dataSourceSettings=s.IJ}))}),[x,C])},b=x=>{const C=(0,i.useDispatch)(),O=A();return()=>C((0,l.Ge)(x,O.Edit))},g=()=>{const x=(0,i.useDispatch)(),C=(0,i.useSelector)(R=>R.dataSources.isLoadingDataSources),O=(0,i.useSelector)(R=>R.dataSources.dataSources);return(0,n.useEffect)(()=>{x((0,l.bn)())},[x]),{isLoading:C,dataSources:O}},P=x=>{const C=useDispatch();useEffect(()=>{C(loadDataSource(x))},[C,x])},c=()=>{const x=(0,i.useDispatch)();(0,n.useEffect)(()=>{x((0,l.G2)())},[x])},y=()=>{const x=(0,i.useDispatch)(),C=A();return O=>{x((0,l.du)(O,C.Edit))}},p=()=>{const x=(0,i.useDispatch)();return async C=>x((0,l.jB)(C))},v=()=>{const x=(0,i.useDispatch)(),{name:C}=(0,i.useSelector)(O=>O.dataSources.dataSource);return()=>{o.A.publish(new f.bY({title:"Delete",text:`Are you sure you want to delete the "${C}" data source?`,yesText:"Delete",icon:"trash-alt",onConfirm:()=>x((0,l.Qq)())}))}},D=x=>(0,i.useSelector)(C=>(0,h.U4)(C.dataSources,x)),E=x=>{const C=D(x);return(0,d.h)(C)},S=x=>(0,i.useSelector)(C=>(0,h.Fj)(C.dataSources,x)),T=()=>(0,i.useSelector)(x=>x.dataSourceSettings),M=x=>{const C=D(x),O=C.readOnly===!0,R=r.contextSrv.hasPermissionInMetadata(i.AccessControlAction.DataSourcesWrite,C),L=r.contextSrv.hasPermissionInMetadata(i.AccessControlAction.DataSourcesDelete,C);return{readOnly:O,hasWriteRights:R,hasDeleteRights:L}},A=()=>(0,n.useContext)(m.C)},85464:(Q,I,e)=>{"use strict";e.d(I,{$k:()=>o.$k,$m:()=>r.$m,BY:()=>o.BY,Bs:()=>i.Bs,CR:()=>a.C,C_:()=>i.C_,S4:()=>o.S4,Tk:()=>i.Tk,Tn:()=>o.Tn,US:()=>o.US,Um:()=>o.Um,_e:()=>o._e,aM:()=>o.aM,du:()=>n.du,eB:()=>i.eB,hp:()=>f.hp,hx:()=>o.hx,jz:()=>i.jz,k9:()=>o.k9,lv:()=>f.lv,oU:()=>o.oU,rb:()=>i.rb,u1:()=>o.u1,wC:()=>f.wC,xs:()=>f.xs,xw:()=>o.xw,zC:()=>f.zC});var n=e(34258),a=e(458),o=e(11084),r=e(74984),i=e(36227),f=e(54226)},74984:(Q,I,e)=>{"use strict";e.d(I,{$m:()=>h,R4:()=>m,Vh:()=>s});var n=e(43429),a=e(33378),o=e(76323),r=e(2913),i=e(10096),f=e(35538),d=e(31678);const l="Loading";function m(b,g){const P=g.meta,c=r.Ay.featureToggles.featureHighlights,y={img:P.info.logos.large,id:"datasource-"+b.uid,url:"",text:b.name,children:[{active:!1,icon:"sliders-v-alt",id:`datasource-settings-${b.uid}`,text:"Settings",url:`datasources/edit/${b.uid}/`}]};if(g.configPages)for(const T of g.configPages)y.children.push({active:!1,text:T.title,icon:T.icon,url:`datasources/edit/${b.uid}/?page=${T.id}`,id:`datasource-page-${T.id}`});P.includes&&u(P.includes)&&i.contextSrv.hasRole("Admin")&&y.children.push({active:!1,icon:"apps",id:`datasource-dashboards-${b.uid}`,text:"Dashboards",url:`datasources/edit/${b.uid}/dashboards`});const p=b.type===l,v="feature-highlights-data-source-permissions-badge",D={active:!1,icon:"lock",id:`datasource-permissions-${b.uid}`,text:"Permissions",url:`datasources/edit/${b.uid}/permissions`};if((0,f.z5)()&&!p&&(D.tabSuffix=()=>(0,o.J)({experimentId:v,eventVariant:"trial"})),(0,a.a)("dspermissions.enforcement")?i.contextSrv.hasPermissionInMetadata(d.AccessControlAction.DataSourcesPermissionsRead,b)&&y.children.push(D):c&&!p&&y.children.push({...D,url:D.url+"/upgrade",tabSuffix:()=>(0,o.J)({experimentId:v})}),r.Ay.analytics?.enabled){const T="feature-highlights-data-source-insights-badge",M={active:!1,icon:"info-circle",id:`datasource-insights-${b.uid}`,text:"Insights",url:`datasources/edit/${b.uid}/insights`};(0,f.z5)()&&!p&&(M.tabSuffix=()=>(0,o.J)({experimentId:T,eventVariant:"trial"})),(0,a.a)("analytics")?i.contextSrv.hasPermission(d.AccessControlAction.DataSourcesInsightsRead)&&y.children.push(M):c&&!p&&y.children.push({...M,url:M.url+"/upgrade",tabSuffix:()=>(0,o.J)({experimentId:T})})}const E="feature-highlights-query-caching-badge",S={active:!1,icon:"database",id:`datasource-cache-${b.uid}`,text:"Cache",url:`datasources/edit/${b.uid}/cache`,hideFromTabs:!P.isBackend||!r.Ay.caching.enabled};return(0,f.z5)()&&!p&&(S.tabSuffix=()=>(0,o.J)({experimentId:E,eventVariant:"trial"})),(0,a.a)("caching")?i.contextSrv.hasPermissionInMetadata(d.AccessControlAction.DataSourcesCachingRead,b)&&y.children.push(S):c&&!p&&y.children.push({...S,url:S.url+"/upgrade",tabSuffix:()=>(0,o.J)({experimentId:E})}),y}function s(b,g){let P={text:""};for(const c of b.children)if(c.id.indexOf(g)>0){c.active=!0,P=c;break}return{main:b,node:P}}function h(b){const g=m({access:"",basicAuth:!1,basicAuthUser:"",withCredentials:!1,database:"",id:1,uid:"x",isDefault:!1,jsonData:{authType:"credentials",defaultRegion:"eu-west-2"},name:"Loading",orgId:1,readOnly:!1,type:l,typeName:l,typeLogoUrl:"public/img/icn-datasource.svg",url:"",user:"",secureJsonFields:{}},{meta:{id:"1",type:n.QE.datasource,name:"",info:{author:{name:"",url:""},description:"",links:[{name:"",url:""}],logos:{large:"",small:""},screenshots:[],updated:"",version:""},includes:[],module:"",baseUrl:""}});return s(g,b)}function u(b){return b.find(g=>g.type==="dashboard")!==void 0}},36227:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>M,Bs:()=>s,C_:()=>g,E1:()=>f,Gc:()=>l,IJ:()=>y,Ks:()=>p,QZ:()=>D,TN:()=>i,Tk:()=>P,UP:()=>S,eB:()=>u,f$:()=>m,gZ:()=>d,jz:()=>r,lg:()=>E,qR:()=>v,rb:()=>b});var n=e(65307),a=e(19484);const o={dataSources:[],plugins:[],categories:[],dataSource:{},layoutMode:a.R.List,searchQuery:"",dataSourcesCount:0,dataSourceTypeSearchQuery:"",isLoadingDataSources:!1,isLoadingDataSourcePlugins:!1,dataSourceMeta:{},isSortAscending:!0},r=(0,n.VP)("dataSources/dataSourceLoaded"),i=(0,n.VP)("dataSources/dataSourcesLoad"),f=(0,n.VP)("dataSources/dataSourcesLoaded"),d=(0,n.VP)("dataSources/dataSourceMetaLoaded"),l=(0,n.VP)("dataSources/dataSourcePluginsLoad"),m=(0,n.VP)("dataSources/dataSourcePluginsLoaded"),s=(0,n.VP)("dataSources/setDataSourcesSearchQuery"),h=(0,n.VP)("dataSources/setDataSourcesLayoutMode"),u=(0,n.VP)("dataSources/setDataSourceTypeSearchQuery"),b=(0,n.VP)("dataSources/setDataSourceName"),g=(0,n.VP)("dataSources/setIsDefault"),P=(0,n.VP)("dataSources/setIsSortAscending"),c=(A=o,x)=>i.match(x)?{...A,isLoadingDataSources:!0}:f.match(x)?{...A,isLoadingDataSources:!1,dataSources:x.payload,dataSourcesCount:x.payload.length}:r.match(x)?{...A,dataSource:x.payload}:s.match(x)?{...A,searchQuery:x.payload}:h.match(x)?{...A,layoutMode:x.payload}:l.match(x)?{...A,plugins:[],isLoadingDataSourcePlugins:!0}:m.match(x)?{...A,plugins:x.payload.plugins,categories:x.payload.categories,isLoadingDataSourcePlugins:!1}:u.match(x)?{...A,dataSourceTypeSearchQuery:x.payload}:d.match(x)?{...A,dataSourceMeta:x.payload}:b.match(x)?{...A,dataSource:{...A.dataSource,name:x.payload}}:g.match(x)?{...A,dataSource:{...A.dataSource,isDefault:x.payload}}:P.match(x)?{...A,isSortAscending:x.payload}:A,y={testingStatus:{},loadError:null,loading:!0,plugin:null},p=(0,n.VP)("dataSourceSettings/initDataSourceSettingsSucceeded"),v=(0,n.VP)("dataSourceSettings/initDataSourceSettingsFailed"),D=(0,n.VP)("dataSourceSettings/testDataSourceStarting"),E=(0,n.VP)("dataSourceSettings/testDataSourceSucceeded"),S=(0,n.VP)("dataSourceSettings/testDataSourceFailed"),M={dataSources:c,dataSourceSettings:(A=y,x)=>p.match(x)?{...A,plugin:x.payload,loadError:null,loading:!1}:v.match(x)?{...A,plugin:null,loadError:x.payload.message,loading:!1}:D.match(x)?{...A,testingStatus:{message:"Testing... this could take up to a couple of minutes",status:"info"}}:E.match(x)?{...A,testingStatus:{status:x.payload?.status,message:x.payload?.message,details:x.payload?.details}}:S.match(x)?{...A,testingStatus:{status:"error",message:x.payload?.message,details:x.payload?.details}}:A}},54226:(Q,I,e)=>{"use strict";e.d(I,{Fj:()=>i,U4:()=>r,hp:()=>o,lv:()=>m,wC:()=>l,xs:()=>f,zC:()=>a});var n=e(41811);const a=(0,n.A)(s=>{const h=new RegExp(s.searchQuery,"i");return s.dataSources.filter(b=>h.test(b.name)||h.test(b.database)||h.test(b.type)).sort((b,g)=>s.isSortAscending?b.name.localeCompare(g.name):g.name.localeCompare(b.name))}),o=(0,n.A)(s=>{const h=new RegExp(s.dataSourceTypeSearchQuery,"i");return s.plugins.filter(u=>h.test(u.name))}),r=(s,h)=>s.dataSource.uid===h?s.dataSource:{},i=(s,h)=>s.dataSourceMeta.id===h?s.dataSourceMeta:{},f=s=>s.searchQuery,d=s=>s.layoutMode,l=s=>s.dataSourcesCount,m=s=>s.isSortAscending},4589:(Q,I,e)=>{"use strict";e.d(I,{M1:()=>r,Mh:()=>o,TR:()=>i,V9:()=>a,_i:()=>d,kg:()=>f,m3:()=>l});var n=e(14110);const a=m=>{(0,n.rR)("grafana_ds_add_datasource_clicked",m)},o=m=>{(0,n.rR)("grafana_ds_test_datasource_clicked",m)},r=m=>{(0,n.rR)("grafana_ds_explore_datasource_clicked",m)},i=m=>{(0,n.rR)("grafana_ds_create_dashboard_clicked",m)},f=m=>{(0,n.rR)("grafana_ds_datasources_list_viewed",m)},d=m=>{(0,n.rR)("connections_datasources_settings_clicked",{item:m})},l=m=>{(0,n.rR)("connections_datasources_ds_configured",m)}},11959:(Q,I,e)=>{"use strict";e.d(I,{h:()=>o});var n=e(76885),a=e(71733);const o=r=>{const i=JSON.stringify({datasource:r.name,context:"explore"});return n.kM.renderUrl(a.I.assureBaseUrl("/explore"),{left:i})}},38074:()=>{"use strict"},25148:(Q,I,e)=>{"use strict";e.d(I,{n:()=>P});var n=e(32196),a=e(96540),o=e(40845),r=e(55852),i=e(39268),f=e(14186),d=e(10354),l=e(95868),m=e(13840),s=e(40321),h=e(47694),u=e(21813),b=e(80744),g=e(19448);const P=p=>{const{value:v,src:D,name:E,placeholder:S,onChange:T,onClear:M,mediaType:A,folderName:x,size:C,color:O,maxFiles:R}=p,L=(0,o.of)(y),N=(0,o.$j)(),F=(0,a.createRef)(),K=a.createElement(g.i,{onChange:T,value:v,mediaType:A,folderName:x,maxFiles:R});let B=D;!B&&v&&(B=(0,u.D)(v));const w=O&&{fill:N.visualization.getColorByName(O)},U=()=>v&&B?a.createElement(h.y,{src:B,className:L.icon,style:{...w}}):a.createElement(r.z9,{variant:"primary",fill:"text",size:"sm"},"Set icon"),W=()=>a.createElement(i.C,null,a.createElement(f.I,{label:null,grow:!0},a.createElement(d.p,{value:c(D,E),placeholder:S,readOnly:!0,prefix:B&&a.createElement(h.y,{src:B,className:L.icon,style:{...w}}),suffix:a.createElement(r.$n,{icon:"times",variant:"secondary",fill:"text",size:"sm",onClick:M})})));return a.createElement(l.I,{content:K},(V,_,H)=>a.createElement(a.Fragment,null,F.current&&a.createElement(m.A,{...H,referenceElement:F.current,onMouseEnter:V,onKeyDown:G=>{(0,s.Q)(G,_)}}),a.createElement("div",{ref:F,className:L.pointer,onClick:V,onKeyDown:G=>{G.key==="Enter"&&V()},role:"button",tabIndex:0},C===b.Iy.SMALL&&U(),C===b.Iy.NORMAL&&W())))};function c(p,v){if(p?.startsWith("public/img/icons")){const D=v?.lastIndexOf(".svg")??0;if(D>0)return v.substring(0,D)}return v}const y=p=>({pointer:(0,n.css)`
    cursor: pointer;
    input[readonly] {
      cursor: pointer;
    }
  `,icon:(0,n.css)`
    vertical-align: middle;
    display: inline-block;
    fill: currentColor;
    width: 25px;
  `})},19448:(Q,I,e)=>{"use strict";e.d(I,{i:()=>B});var n=e(32196),a=e(18828),o=e(85690),r=e(93225),i=e(96540),f=e(17172),d=e(40845),l=e(55852),m=e(2913),s=e(80744),h=e(88575),u=e(37270),b=e(47694);function g({secondaryText:U="Drag and drop here or browse"}){const W=(0,d.of)(c);return i.createElement("div",{className:W.iconWrapper},i.createElement("small",{className:W.small},U),i.createElement(l.$n,{type:"button",icon:"upload"},"Upload"))}const P=({mediaType:U,setFormData:W,setUpload:V,error:_})=>{const H=(0,d.of)(c),[G,j]=(0,i.useState)(!1),[Y,oe]=(0,i.useState)(""),se=()=>i.createElement(h.D,{label:"Preview"},i.createElement("div",{className:H.iconPreview},U===s.zu.Icon&&i.createElement(b.y,{src:Y,className:H.img}),U===s.zu.Image&&i.createElement("img",{src:Y,alt:"Preview of the uploaded file",className:H.img}))),ne=Z=>{fetch(`/api/storage/delete/upload/${Z.file.name}`,{method:"DELETE"}).catch(z=>console.error("cannot delete file",z))},ee=U==="icon"?{"image/*":[".svg",".xml"]}:{"image/*":[".jpeg",".png",".gif",".webp"]};return i.createElement(u.gH,{readAs:"readAsBinaryString",onFileRemove:ne,options:{accept:ee,multiple:!1,onDrop:Z=>{let z=new FormData;z.append("file",Z[0]),oe(URL.createObjectURL(Z[0])),j(!0),W(z),V(!0)}}},_.message!==""&&G?i.createElement("p",null,_.message):G?i.createElement(se,null):i.createElement(g,null))};function c(U,W){return{container:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 100%;
    `,dropzone:(0,n.css)`
      display: flex;
      flex: 1;
      flex-direction: column;
      align-items: center;
      padding: ${U.spacing(6)};
      border-radius: 2px;
      border: 2px dashed ${U.colors.border.medium};
      background-color: ${W?U.colors.background.secondary:U.colors.background.primary};
      cursor: pointer;
    `,iconWrapper:(0,n.css)`
      display: flex;
      flex-direction: column;
      align-items: center;
    `,acceptMargin:(0,n.css)`
      margin: ${U.spacing(2,0,1)};
    `,small:(0,n.css)`
      color: ${U.colors.text.secondary};
      margin-bottom: ${U.spacing(2)};
    `,iconContainer:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 80%;
      align-items: center;
      align-self: center;
    `,iconPreview:(0,n.css)`
      width: 238px;
      height: 198px;
      border: 1px solid ${U.colors.border.medium};
      display: flex;
      align-items: center;
      justify-content: center;
    `,img:(0,n.css)`
      width: 147px;
      height: 147px;
      fill: ${U.colors.text.primary};
    `}}var y=e(21594),p=e(67647),v=e(31193),D=e(70713),E=e(91793);const S=(0,i.memo)(function(W){const{columnIndex:V,rowIndex:_,style:H,data:G}=W,{cards:j,columnCount:Y,onChange:oe,selected:se}=G,ne=V+_*Y,ee=j[ne],Z=(0,d.of)(M);return i.createElement("div",{style:H},ee&&i.createElement("div",{key:ee.value,className:se===ee.value?(0,n.cx)(Z.card,Z.selected):Z.card,onClick:()=>oe(ee.value),onKeyDown:z=>{z.key==="Enter"&&oe(ee.value)},role:"button",tabIndex:0},ee.imgUrl.endsWith(".svg")?i.createElement(b.y,{src:ee.imgUrl,className:Z.img}):i.createElement("img",{src:ee.imgUrl,alt:"",className:Z.img}),i.createElement("h6",{className:Z.text},ee.label.slice(0,-4))))},E.t7),T=U=>{const{onChange:W,cards:V,value:_}=U,H=(0,d.of)(M);return i.createElement(D.Ay,{defaultWidth:680},({width:G,height:j})=>{const se=Math.floor(G/90),ne=Math.ceil(V.length/se);return i.createElement(E.yi,{width:G,height:j,columnCount:se,columnWidth:90,rowCount:ne,rowHeight:90,itemData:{cards:V,columnCount:se,onChange:W,selected:_},className:H.grid},S)})},M=U=>({card:(0,n.css)`
    display: inline-block;
    width: 90px;
    height: 90px;
    margin: 0.75rem;
    margin-left: 15px;
    text-align: center;
    cursor: pointer;
    position: relative;
    background-color: transparent;
    border: 1px solid transparent;
    border-radius: 8px;
    padding-top: 6px;
    :hover {
      border-color: ${U.colors.action.hover};
      box-shadow: ${U.shadows.z2};
    }
  `,selected:(0,n.css)`
    border: 2px solid ${U.colors.primary.main};
    :hover {
      border-color: ${U.colors.primary.main};
    }
  `,img:(0,n.css)`
    width: 40px;
    height: 40px;
    object-fit: cover;
    vertical-align: middle;
    fill: ${U.colors.text.primary};
  `,text:(0,n.css)`
    color: ${U.colors.text.primary};
    white-space: nowrap;
    font-size: 12px;
    text-overflow: ellipsis;
    display: block;
    overflow: hidden;
  `,grid:(0,n.css)`
    border: 1px solid ${U.colors.border.medium};
  `}),A=U=>U===s.zu.Icon?[s.Iu.Icon,s.Iu.IOT,s.Iu.Marker]:[s.Iu.BG],x=(U,W)=>U.find(V=>W.startsWith(V.value))??U[0],C=U=>{const{value:W,mediaType:V,folderName:_,newValue:H,setNewValue:G,maxFiles:j}=U,Y=(0,d.of)(O),oe=A(V).map(fe=>({label:fe,value:fe})),[se,ne]=(0,i.useState)(),[ee,Z]=(0,i.useState)(x(oe,W?.length?W:_)),[z,q]=(0,i.useState)([]),[ie,de]=(0,i.useState)([]),ue=fe=>{fe?(fe=fe.toLowerCase(),de(z.filter(Se=>Se.search.includes(fe)))):de(z)};return(0,i.useEffect)(()=>{const fe=ee?.value;if(fe){const Se=V===s.zu.Icon?he=>he.name.endsWith(".svg"):he=>he.name.endsWith(".png")||he.name.endsWith(".gif");(0,v.tR)().get("-- Grafana --").then(he=>{he.listFiles(fe,j).subscribe({next:ce=>{const me=[];ce.forEach(pe=>{if(Se(pe)){const ye=pe.name.lastIndexOf(".");me.push({value:`${fe}/${pe.name}`,label:pe.name,search:(ye?pe.name.substring(0,ye):pe.name).toLowerCase(),imgUrl:`public/${fe}/${pe.name}`})}}),q(me),de(me)}})})}},[V,ee,j]),i.createElement(i.Fragment,null,i.createElement(h.D,null,i.createElement(y.l6,{options:oe,onChange:Z,value:ee,menuShouldPortal:!1})),i.createElement(h.D,null,i.createElement(p.Z,{value:se??"",placeholder:"Search",onChange:fe=>{ue(fe),ne(fe)}})),ie&&i.createElement("div",{className:Y.cardsWrapper},i.createElement(T,{cards:ie,onChange:fe=>G(fe),value:H})))},O=U=>({cardsWrapper:(0,n.css)`
    height: 30vh;
    min-height: 50px;
    margin-top: 5px;
    max-width: 680px;
  `});var R=e(10354),L=e(60029),N=e(21813);const F=U=>{const{newValue:W,setNewValue:V,mediaType:_}=U,H=(0,d.of)(K),G=(0,N.D)(W);let j=W?.substring(W.lastIndexOf("/")+1,W.lastIndexOf("."));return j.length>20&&(j=j.substring(0,20)+"..."),i.createElement(i.Fragment,null,i.createElement(h.D,null,i.createElement(R.p,{onChange:Y=>V(Y.currentTarget.value),value:W})),i.createElement("div",{className:H.iconContainer},i.createElement(h.D,{label:"Preview"},i.createElement("div",{className:H.iconPreview},_===s.zu.Icon&&i.createElement(b.y,{src:G,className:H.img}),_===s.zu.Image&&W&&i.createElement("img",{src:G,alt:"Preview of the selected URL",className:H.img}))),i.createElement(L.J,null,j)))},K=U=>({iconContainer:(0,n.css)`
    display: flex;
    flex-direction: column;
    width: 80%;
    align-items: center;
    align-self: center;
  `,iconPreview:(0,n.css)`
    width: 238px;
    height: 198px;
    border: 1px solid ${U.colors.border.medium};
    display: flex;
    align-items: center;
    justify-content: center;
  `,img:(0,n.css)`
    width: 147px;
    height: 147px;
    fill: ${U.colors.text.primary};
  `}),B=U=>{const{value:W,onChange:V,mediaType:_,folderName:H,maxFiles:G}=U,j=(0,d.of)(w),Y=()=>{V(W)},oe=(0,i.createRef)(),{dialogProps:se}=(0,a.s)({},oe),{overlayProps:ne}=(0,r.e)({onClose:Y,isDismissable:!0,isOpen:!0},oe),ee=W&&W.includes("://"),[Z,z]=(0,i.useState)(W??""),[q,ie]=(0,i.useState)(ee?s.QC.URL:s.QC.Folder),[de,ue]=(0,i.useState)(new FormData),[fe,Se]=(0,i.useState)(!1),[he,ce]=(0,i.useState)({message:""}),me=Oe=>`${j.resourcePickerPopoverTab} ${q===Oe&&j.resourcePickerPopoverActiveTab}`,pe=()=>i.createElement(C,{value:W,mediaType:_,folderName:H,newValue:Z,setNewValue:z,maxFiles:G}),ye=()=>i.createElement(F,{newValue:Z,setNewValue:z,mediaType:_}),Pe=()=>i.createElement(P,{mediaType:_,setFormData:ue,setUpload:Se,newValue:Z,error:he}),Ie=()=>{switch(q){case s.QC.Folder:return pe();case s.QC.URL:return ye();case s.QC.Upload:return Pe();default:return pe()}};return i.createElement(o.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},i.createElement("section",{ref:oe,...ne,...se},i.createElement("div",{className:j.resourcePickerPopover},i.createElement("div",{className:j.resourcePickerPopoverTabs},i.createElement("button",{className:me(s.QC.Folder),onClick:()=>ie(s.QC.Folder)},"Folder"),i.createElement("button",{className:me(s.QC.URL),onClick:()=>ie(s.QC.URL)},"URL")),i.createElement("div",{className:j.resourcePickerPopoverContent},Ie(),i.createElement("div",{className:j.buttonRow},i.createElement(l.$n,{variant:"secondary",onClick:()=>Y(),fill:"outline"},"Cancel"),i.createElement(l.$n,{variant:Z&&Z!==W?"primary":"secondary",onClick:()=>{fe?fetch("/api/storage/upload",{method:"POST",body:de}).then(Oe=>{if(Oe.status>=400){Oe.json().then(Ne=>ce(Ne));return}else return Oe.json()}).then(Oe=>{(0,f.AI)().get(`api/storage/read/${Oe.path}`).then(()=>z(`${m.config.appUrl}api/storage/read/${Oe.path}`)).then(()=>V(`${m.config.appUrl}api/storage/read/${Oe.path}`))}).catch(Oe=>console.error(Oe)):V(Z)}},"Select"))))))},w=U=>({resourcePickerPopover:(0,n.css)`
    border-radius: ${U.shape.radius.default};
    box-shadow: ${U.shadows.z3};
    background: ${U.colors.background.primary};
    border: 1px solid ${U.colors.border.weak};
  `,resourcePickerPopoverTab:(0,n.css)`
    width: 50%;
    text-align: center;
    padding: ${U.spacing(1,0)};
    background: ${U.colors.background.secondary};
    color: ${U.colors.text.secondary};
    font-size: ${U.typography.bodySmall.fontSize};
    cursor: pointer;
    border: none;

    &:focus:not(:focus-visible) {
      outline: none;
      box-shadow: none;
    }

    :focus-visible {
      position: relative;
    }
  `,resourcePickerPopoverActiveTab:(0,n.css)`
    color: ${U.colors.text.primary};
    font-weight: ${U.typography.fontWeightMedium};
    background: ${U.colors.background.primary};
  `,resourcePickerPopoverContent:(0,n.css)`
    width: 315px;
    font-size: ${U.typography.bodySmall.fontSize};
    min-height: 184px;
    padding: ${U.spacing(1)};
    display: flex;
    flex-direction: column;
  `,resourcePickerPopoverTabs:(0,n.css)`
    display: flex;
    width: 100%;
    border-radius: ${U.shape.radius.default} ${U.shape.radius.default} 0 0;
  `,buttonRow:(0,n.css)({display:"flex",justifyContent:"center",gap:U.spacing(2),padding:U.spacing(1)})})},63577:(Q,I,e)=>{"use strict";e.d(I,{MediaType:()=>n.zu,ResourceFolderName:()=>n.Iu,findField:()=>i.UI,findFieldIndex:()=>i.gG,getColorDimension:()=>f,getPublicOrAbsoluteUrl:()=>g.D,getResourceDimension:()=>g.$,getScalarDimension:()=>c.H,getScaledDimension:()=>l.hX,getScaledDimensionForField:()=>l.qx,getTextDimension:()=>u});var n=e(80744),a=e(8066),o=e(58563),r=e(57875),i=e(33924);function f(y,p,v){return d((0,i.UI)(y,p.field),p,v)}function d(y,p,v){if(!y){const S=v.visualization.getColorByName(p.fixed??"grey");return{isAssumed:!!p.field?.length||!p.fixed,fixed:S,value:()=>S,get:T=>S}}const D=(0,a.Qi)(y);if(D.isByValue||y.config.mappings?.length){const S=(0,o.xg)(y,!0);S!==y.config&&(y={...y,config:S},y.state=void 0);const T=(0,r.J)({field:y,theme:v}),M=A=>T(A).color??"#ccc";return{field:y,get:A=>M(y.values[A]),value:()=>M((0,i.sB)(y))}}const E=D.getCalculator(y,v)(0,0);return{fixed:E,value:()=>E,get:S=>E,field:y}}var l=e(18379),m=e(11261),s=e(83195),h=e(52622);function u(y,p){const v=p.field?(0,i.UI)(y,p.field):y?.fields.find(D=>D.type===m.PU.string);return b(v,p)}function b(y,p){let v=p.fixed;const D=p.mode??h.RU.Fixed;if(D===h.RU.Fixed)return{isAssumed:!v,fixed:v,value:()=>v,get:S=>v};if(D===h.RU.Template){const S=T=>`TEMPLATE[${p.fixed} // ${T}]`;return y?{field:y,get:T=>S(y.values[T]),value:()=>S((0,i.sB)(y))}:(v=S(""),{isAssumed:!0,fixed:v,value:()=>v,get:T=>v})}if(!y)return{isAssumed:!0,fixed:v,value:()=>v,get:S=>v};let E=S=>(0,s.cN)(y.display(S));return{field:y,get:S=>E(y.values[S]),value:()=>E((0,i.sB)(y))}}var g=e(21813),P=e(38074),c=e(26781)},21813:(Q,I,e)=>{"use strict";e.d(I,{$:()=>r,D:()=>o});var n=e(52622),a=e(33924);function o(i){return i?i.indexOf(":/")>0?i:window.__grafana_public_path__+i:""}function r(i,f){const d=f.mode??n.q_.Fixed;if(d===n.q_.Fixed){const s=o(f.fixed);return{isAssumed:!s,fixed:s,value:()=>s,get:h=>s}}const l=(0,a.UI)(i,f.field);if(!l){const s="";return{isAssumed:!0,fixed:s,value:()=>s,get:h=>s}}if(d===n.q_.Mapping){const s=h=>o(`${h}`);return{field:l,get:h=>s(l.values[h]),value:()=>s((0,a.sB)(l))}}const m=s=>{if(l&&l.display){const h=l.display(s).icon;return o(h??"")}return""};return{field:l,get:s=>m(l.values[s]),value:()=>m((0,a.sB)(l))}}},26781:(Q,I,e)=>{"use strict";e.d(I,{H:()=>o});var n=e(52622),a=e(33924);function o(i,f){return r((0,a.UI)(i,f?.field),f)}function r(i,f){if(!i){const m=f.fixed??0;return{isAssumed:!!f.field?.length||!f.fixed,fixed:m,value:()=>m,get:()=>m}}let d=m=>m%f.max;return f.mode===n.WQ.Clamped&&(d=m=>m<f.min?f.min:m>f.max?f.max:m),{field:i,get:m=>{const s=i.values[m];return s===null||typeof s!="number"?0:d(s)},value:()=>(0,a.sB)(i)}}},18379:(Q,I,e)=>{"use strict";e.d(I,{Nn:()=>f,Ru:()=>d,hX:()=>r,qx:()=>i});var n=e(58563),a=e(52622),o=e(33924);function r(l,m){return i((0,o.UI)(l,m?.field),m)}function i(l,m,s){if(!l){const c=m.fixed??0;return{isAssumed:!!m.field?.length||!m.fixed,fixed:c,value:()=>c,get:()=>c}}const h=(0,n.AP)(l),u=m.max-m.min;if(l.values.length<1||u<=0||h.delta<=0)return{fixed:m.min,value:()=>m.min,get:()=>m.min};let g=c=>m.min+c*u;if(s===a.QH.Quad){const c=Math.PI*(m.max/2)**2,y=Math.PI*(m.min/2)**2,p=c-y;g=v=>{let D=y+p*v;return Math.sqrt(D/Math.PI)*2}}const P=c=>{const y=l.values[c];let p=0;return y!==-1/0&&(p=(y-h.min)/h.delta),p>1?p=1:p<0&&(p=0),g(p)};return{get:P,value:()=>P((0,o.sB)(l)),field:l}}function f(l){return l||(l={min:0,max:1}),l.min==null&&(l.min=0),l.max==null&&(l.max=1),l}function d(l,m){let{min:s,max:h}=f(m);if(l||(l={}),l.max==null&&(l.max=h),l.min==null&&(l.min=s),l.min>l.max){const u=l.max;l.max=l.min,l.min=u}return l.min<s&&(l.min=s),l.max>h&&(l.max=h),l.fixed==null&&(l.fixed=l.min+(l.max-l.min)/2),l.field||(l.fixed>h?l.fixed=h:l.fixed<s&&(l.fixed=s)),l}},80744:(Q,I,e)=>{"use strict";e.d(I,{Iu:()=>o,Iy:()=>f,QC:()=>i,nG:()=>a,zu:()=>r});var n=e(52622);const a=Object.freeze({fixed:"",mode:n.RU.Field,field:""});var o=(d=>(d.Icon="img/icons/unicons",d.IOT="img/icons/iot",d.Marker="img/icons/marker",d.BG="img/bg",d))(o||{}),r=(d=>(d.Icon="icon",d.Image="image",d))(r||{}),i=(d=>(d.Folder="folder",d.URL="url",d.Upload="upload",d))(i||{}),f=(d=>(d.SMALL="small",d.NORMAL="normal",d))(f||{})},33924:(Q,I,e)=>{"use strict";e.d(I,{B_:()=>m,UI:()=>h,Wb:()=>f,XV:()=>d,b5:()=>l,gG:()=>u,sB:()=>b,wv:()=>s});var n=e(28240),a=e(75059),o=e(32264),r=e(63577),i=e(26781);function f(g,P){if(g?.series&&P.field)for(const c of g.series){const y=(0,r.getColorDimension)(c,P,o.$.theme2);if(!y.isAssumed||g.series.length===1)return y}return(0,r.getColorDimension)(void 0,P,o.$.theme2)}function d(g,P){if(g?.series&&P.field)for(const c of g.series){const y=(0,r.getScaledDimension)(c,P);if(!y.isAssumed||g.series.length===1)return y}return(0,r.getScaledDimension)(void 0,P)}function l(g,P){if(g?.series&&P.field)for(const c of g.series){const y=(0,i.H)(c,P);if(!y.isAssumed||g.series.length===1)return y}return(0,i.H)(void 0,P)}function m(g,P){if(g?.series&&P.field)for(const c of g.series){const y=(0,r.getResourceDimension)(c,P);if(!y.isAssumed||g.series.length===1)return y}return(0,r.getResourceDimension)(void 0,P)}function s(g,P){if(g?.series&&P.field)for(const c of g.series){const y=(0,r.getTextDimension)(c,P);if(!y.isAssumed||g.series.length===1)return y}return(0,r.getTextDimension)(void 0,P)}function h(g,P){const c=u(P,g);return c==null?void 0:g.fields[c]}function u(g,P,c){if(!(!P||!g?.length))for(let y=0;y<P.fields.length;y++){const p=P.fields[y];if(g===p.name)return y;const v=(0,n.Ct)(p,P,c);if(g===v)return y}}function b(g){const P=g.state?.calcs;if(P){const p=P[a.gy.lastNotNull];if(p!=null)return p}const c=g.values;let y=c.length-1;for(;y>=0;){const p=c[y--];if(p!=null)return p}}},9791:(Q,I,e)=>{"use strict";e.d(I,{k:()=>M});var n=e(2543),a=e(96540),o=e(84596),r=e(39070),i=e(47232),f=e(28528),d=e(24293),l=e(90708),m=e(28240),s=e(94624),h=e(24308),u=e(52622),b=e(40845),g=e(79041),P=e(41706),c=e(91126),y=e(33368),p=e(1932);function v(A,x,C){return(0,p.jM)(A,O=>{O.defaults.custom===void 0&&(O.defaults.custom={}),O.defaults.max=C;const{custom:R}=O.defaults;switch(R.stacking===void 0&&(R.stacking={group:"A"}),x){case"lines":R.drawStyle=u.GR.Line,R.stacking.mode=u.gs.None,R.fillOpacity=0;break;case"bars":R.drawStyle=u.GR.Bars,R.stacking.mode=u.gs.None,R.fillOpacity=100;break;case"points":R.drawStyle=u.GR.Points,R.stacking.mode=u.gs.None,R.fillOpacity=0;break;case"stacked_lines":R.drawStyle=u.GR.Line,R.stacking.mode=u.gs.Normal,R.fillOpacity=100,R.axisSoftMin=0;break;case"stacked_bars":R.drawStyle=u.GR.Bars,R.stacking.mode=u.gs.Normal,R.fillOpacity=100,R.axisSoftMin=0;break;default:{const L=x;throw new Error(`Invalid graph-style: ${L}`)}}})}function D(A,x,C){return(0,p.jM)(A,O=>{O.defaults.thresholds=C,O.defaults.custom=O.defaults.custom??{},O.defaults.custom.thresholdsStyle=x})}var E=e(56737),S=e(21423);function T(A){const[x,{inc:C}]=(0,E.A)(1),O=(0,o.A)(A);return(0,a.useMemo)(()=>{O&&!(0,S.J3)(A,O,S.bW)&&C()},[A,O,C]),x}function M({data:A,height:x,width:C,timeZone:O,absoluteRange:R,onChangeTime:L,loadingState:N,annotations:F,onHiddenSeriesChanged:K,splitOpenFn:B,graphStyle:w,tooltipDisplayMode:U=u.$N.Single,anchorToZero:W=!1,yAxisMaximum:V,thresholdsConfig:_,thresholdsStyle:H,eventBus:G,vizLegendOverrides:j,toggleLegendRef:Y}){const oe=(0,b.$j)(),se=(0,o.A)(R),ne=N===r.Gu.Loading&&se?se:R,ee=(0,a.useMemo)(()=>({from:(0,i.KQ)(ne.from),to:(0,i.KQ)(ne.to),raw:{from:(0,i.KQ)(ne.from),to:(0,i.KQ)(ne.to)}}),[ne.from,ne.to]),Z=(0,a.useMemo)(()=>(0,f.O)((0,P.V)(P.S),"Explore"),[]),[z,q]=(0,a.useState)({defaults:{min:W?0:void 0,max:V||void 0,unit:"short",color:{mode:d.Y.PaletteClassic},custom:{drawStyle:u.GR.Line,fillOpacity:0,pointSize:5}},overrides:[]}),ie=(0,a.useMemo)(()=>{const pe=v(z,w,V);return D(pe,H,_)},[z,w,V,_,H]),de=(0,y.h)(B,ee),ue=(0,a.useMemo)(()=>(0,l.we)({fieldConfig:ie,data:A,timeZone:O,replaceVariables:pe=>pe,theme:oe,fieldConfigRegistry:Z,dataLinkPostProcessor:de}),[Z,A,O,oe,ie,de]),fe=(0,a.useMemo)(()=>(0,l.we)({fieldConfig:{defaults:{},overrides:[]},data:F,timeZone:O,replaceVariables:pe=>pe,theme:oe,dataLinkPostProcessor:de}),[F,O,oe,de]),Se=T(ue);(0,a.useEffect)(()=>{if(K){const pe=[];ue.forEach(ye=>{ye.fields.map(Ie=>Ie.config?.custom?.hideFrom?.viz).every(n.identity)&&pe.push((0,m.Ri)(ye))}),K(pe)}},[ue,K]);const he={eventsScope:"explore",eventBus:G,sync:()=>s.y.Off,onToggleSeriesVisibility(pe,ye){q((0,c.M)(pe,ye,z,A))},dataLinkPostProcessor:de};function ce(pe,ye){q((0,c.M)(pe,ye,z,A))}Y&&(Y.current=ce);const me=(0,a.useMemo)(()=>({tooltip:{mode:U,sort:u.xB.None},legend:{displayMode:u.lm.List,showLegend:!0,placement:"bottom",calcs:[],...j}}),[U,j]);return a.createElement(g.XF,{value:he},a.createElement(h.m,{data:{series:ue,timeRange:ee,state:N,annotations:fe,structureRev:Se},pluginId:"timeseries",title:"",width:C,height:x,onChangeTimeRange:L,timeZone:O,options:me}))}},72519:(Q,I,e)=>{"use strict";e.d(I,{y:()=>T});var n=e(32196),a=e(96540),o=e(42941),r=e(40845),i=e(91052),f=e(14578),d=e(56034),l=e(55852),m=e(8484),s=e(34028),h=e(9791),u=e(94354),b=e(31678);const g=b.EXPLORE_GRAPH_STYLES.map(A=>({value:A,label:A[0].toUpperCase()+A.slice(1).replace(/_/," ")}));function P(A){const{graphStyle:x,onChangeGraphStyle:C}=A;return a.createElement(u.z,{size:"sm",options:g,value:x,onChange:C})}var c=e(33390);const y="grafana.explore.style.graph",p=A=>{store.set(y,A)},v=()=>E(c.A.get(y)),D="lines",E=A=>b.EXPLORE_GRAPH_STYLES.find(C=>C===A)??D,S=20,T=({data:A,eventBus:x,height:C,width:O,absoluteRange:R,timeZone:L,annotations:N,onChangeTime:F,splitOpenFn:K,thresholdsConfig:B,thresholdsStyle:w,loadingState:U,statusMessage:W})=>{const[V,_]=(0,o.A)(!1),[H,G]=(0,a.useState)(v),j=(0,r.of)(M),Y=(0,a.useCallback)(se=>{(0,s.ng)(se),G(se)},[]),oe=(0,a.useMemo)(()=>V?A:A.slice(0,S),[A,V]);return a.createElement(i.NR,{title:(0,m.t)("graph.container.title","Graph"),titleItems:[!V&&S<A.length&&a.createElement("div",{key:"disclaimer",className:j.timeSeriesDisclaimer},a.createElement("span",{className:j.warningMessage},a.createElement(f.I,{name:"exclamation-triangle","aria-hidden":"true"}),a.createElement(m.x6,{i18nKey:"graph.container.show-only-series"},"Showing only ",{MAX_NUMBER_OF_TIME_SERIES:S}," series")),a.createElement(d.m,{content:(0,m.t)("graph.container.content","Rendering too many series in a single panel may impact performance and make data harder to read. Consider refining your queries.")},a.createElement(l.$n,{variant:"secondary",size:"sm",onClick:_},a.createElement(m.x6,{i18nKey:"graph.container.show-all-series"},"Show all ",{length:A.length}))))].filter(Boolean),width:O,height:C,loadingState:U,statusMessage:W,actions:a.createElement(P,{graphStyle:H,onChangeGraphStyle:Y})},(se,ne)=>a.createElement(h.k,{graphStyle:H,data:oe,height:ne,width:se,absoluteRange:R,onChangeTime:F,timeZone:L,annotations:N,splitOpenFn:K,loadingState:U,thresholdsConfig:B,thresholdsStyle:w,eventBus:x}))},M=A=>({timeSeriesDisclaimer:(0,n.css)({label:"time-series-disclaimer",display:"flex",alignItems:"center",gap:A.spacing(1)}),warningMessage:(0,n.css)({display:"flex",alignItems:"center",gap:A.spacing(.5),color:A.colors.warning.main,fontSize:A.typography.bodySmall.fontSize})})},97186:(Q,I,e)=>{"use strict";e.d(I,{$:()=>n,r:()=>a});const n={showLabels:"grafana.explore.logs.showLabels",showTime:"grafana.explore.logs.showTime",wrapLogMessage:"grafana.explore.logs.wrapLogMessage",prettifyLogMessage:"grafana.explore.logs.prettifyLogMessage",logsSortOrder:"grafana.explore.logs.sortOrder",logContextWrapLogMessage:"grafana.explore.logs.logContext.wrapLogMessage"},a="grafana.explore.logs.visualisationType"},9651:(Q,I,e)=>{"use strict";e.d(I,{a:()=>d,d:()=>l});var n=e(32196),a=e(96540),o=e(75212),r=e(40845),i=e(9663);const f=(m,s)=>({valueNavigation:(0,n.css)`
      width: ${i.QH};
      font-weight: bold;
    `,valueNavigationWrapper:(0,n.css)`
      display: flex;
      justify-content: flex-end;
    `,itemLabelsWrap:(0,n.css)`
      ${s?"":`border-bottom: 1px solid ${m.colors.border.medium}`};
    `}),d=m=>m.includes(o.gs)?m.replace(o.gs,""):m,l=({valueLabels:m,expanded:s})=>{const h=(0,r.of)(f,s);return a.createElement("div",{className:h.itemLabelsWrap},a.createElement("div",{className:h.valueNavigationWrapper},m.map((u,b)=>a.createElement("span",{className:h.valueNavigation,key:u.name},d(u.name)))))}},9663:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>D,QH:()=>P,Jd:()=>c});var n=e(32196),a=e(96540),o=e(73287),r=e(14110),i=e(40845),f=e(29158),d=e(9651),l=e(57408);const m=(E,S)=>({rowWrapper:(0,n.css)`
    position: relative;
    min-width: ${P};
    padding-right: 5px;
  `,rowValue:(0,n.css)`
    white-space: nowrap;
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    display: block;
    padding-right: 10px;

    &::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    &:before {
      pointer-events: none;
      content: '';
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(to right, transparent calc(100% - 25px), ${E.colors.background.primary});
    }
  `,rowValuesWrap:(0,n.css)`
    padding-left: ${c};
    width: calc(${S} * ${P});
    display: flex;
  `}),s=({totalNumberOfValues:E,values:S,hideFieldsWithoutValues:T})=>{const M=(0,i.of)(m,E);return a.createElement("div",{role:"cell",className:M.rowValuesWrap},S?.map(A=>T&&(A.value===void 0||A.value===l.M)?null:a.createElement("span",{key:A.key,className:M.rowWrapper},a.createElement("span",{className:M.rowValue},A.value))))},h=E=>{const S=E.isDark?"#ce9178":"#a31515",T=E.isDark?"#73bf69":"#56a64b";return{metricName:(0,n.css)`
      color: ${T};
    `,metricValue:(0,n.css)`
      color: ${S};
    `,expanded:(0,n.css)`
      display: block;
      text-indent: 1em;
    `}},b=({value:E,index:S,length:T,isExpandedView:M})=>{const A=(0,i.of)(h),x=E.key,C=E.value;return a.createElement("span",{className:M?A.expanded:"",key:S},a.createElement("span",{className:A.metricName},x),a.createElement("span",null,"="),a.createElement("span",null,'"'),a.createElement("span",{className:A.metricValue},C),a.createElement("span",null,'"'),S<T-1&&a.createElement("span",null,", "))},g="20px",P="80px",c="25px",y=(E,S,T)=>({rowWrapper:(0,n.css)`
    border-bottom: 1px solid ${E.colors.border.medium};
    display: flex;
    position: relative;
    padding-left: 22px;
    ${T?"":"align-items: center;"}
    ${T?"":"height: 100%;"}
  `,copyToClipboardWrapper:(0,n.css)`
    position: absolute;
    left: 0;
    ${T?"":"bottom: 0;"}
    ${T?"top: 4px;":"top: 0;"}
    margin: auto;
    z-index: 1;
    height: 16px;
    width: 16px;
  `,rowLabelWrapWrap:(0,n.css)`
    position: relative;
    width: calc(100% - (${S} * ${P}) - ${c});
  `,rowLabelWrap:(0,n.css)`
    white-space: nowrap;
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    padding-right: ${g};

    &::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    &:after {
      pointer-events: none;
      content: '';
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(
        to right,
        transparent calc(100% - ${g}),
        ${E.colors.background.primary}
      );
    }
  `});function p(E){let S=[],T=[];for(const M in E)M in E&&E[M]&&!M.includes("Value")?S.push({key:M,value:E[M]}):M in E&&E[M]&&M.includes("Value")&&T.push({key:M,value:E[M]});return{values:T,attributeValues:S}}const D=({listItemData:E,listKey:S,totalNumberOfValues:T,valueLabels:M,isExpandedView:A})=>{const{__name__:x,...C}=E,[O,R]=(0,o.A)(),L=M?.length??T,N=(0,i.of)(y,L,A),{values:F,attributeValues:K}=p(C),B=W=>W==="\u221E"||W==="Infinity"?"+Inf":W,w=`${x}{${K.map(W=>`${W.key}="${B(W.value)}"`)}}`,U=!!(M&&M?.length);return a.createElement(a.Fragment,null,M!==void 0&&A&&a.createElement(d.d,{valueLabels:M,expanded:A}),a.createElement("div",{key:S,className:N.rowWrapper},a.createElement("span",{className:N.copyToClipboardWrapper},a.createElement(f.K,{tooltip:"Copy to clipboard",onClick:()=>{(0,r.rR)("grafana_explore_prometheus_instant_query_ui_raw_toggle_expand"),R(w)},name:"copy"})),a.createElement("span",{role:"cell",className:N.rowLabelWrapWrap},a.createElement("div",{className:N.rowLabelWrap},a.createElement("span",null,x),a.createElement("span",null,"{"),a.createElement("span",null,K.map((W,V)=>a.createElement(b,{isExpandedView:A,value:W,key:V,index:V,length:K.length}))),a.createElement("span",null,"}"))),a.createElement(s,{hideFieldsWithoutValues:U,totalNumberOfValues:L,values:F})))}},57408:(Q,I,e)=>{"use strict";e.d(I,{E:()=>o,M:()=>a});var n=e(83195);const a=" ",o=r=>{const i={},f=[],d=r.fields.filter(s=>!["Time"].includes(s.name));let l=d.find(s=>s.name==="__name__")?.values??[];!l.length&&d.length&&d[0].values.length&&(l=Array(d[0].values.length).fill(""));const m=r.fields.filter(s=>!["__name__"].includes(s.name));return l.forEach(function(s,h){i[s]={};const u=i[s][h]??{};for(const b of m){const g=b.name;if(g!=="Time")if(typeof b?.display=="function"){const P=b?.display(b.values[h]);if(!isNaN(P.numeric))u[g]=P.numeric.toString(10);else{const c=(0,n.cN)(P);c?u[g]=c:g.includes("Value #")&&(u[g]=a)}}else console.warn("Field display method is missing!")}f.push({...u,__name__:s})}),f}},97814:(Q,I,e)=>{"use strict";e.d(I,{g:()=>o});var n=e(96540),a=e(47232);const o=({timeInMs:i,className:f,humanize:d})=>n.createElement("span",{className:f},r(i,d)),r=(i,f=!1)=>{const d=i/1e3;if(!f)return`${d.toFixed(1)}s`;const l=(0,a.Ah)(d,"seconds"),m=l.hours(),s=l.minutes(),h=l.seconds();return m?`${m}h ${s}m ${h}s`:s?`${s}m ${h}s`:`${h}s`}},92599:(Q,I,e)=>{"use strict";e.d(I,{V:()=>Le});var n=e(32196),a=e(96540),o=e(42941),r=e(41987),i=e(6709);function f(X){if(X?.tracesToLogsV2)return X.tracesToLogsV2;if(!X?.tracesToLogs)return;const le={customQuery:!1};return le.datasourceUid=X.tracesToLogs.datasourceUid,le.tags=X.tracesToLogs.mapTagNamesEnabled?X.tracesToLogs.mappedTags:X.tracesToLogs.tags?.map(be=>({key:be})),le.filterByTraceID=X.tracesToLogs.filterByTraceID,le.filterBySpanID=X.tracesToLogs.filterBySpanID,le.spanStartTimeShift=X.tracesToLogs.spanStartTimeShift,le.spanEndTimeShift=X.tracesToLogs.spanEndTimeShift,le}function d({options:X,onOptionsChange:le}){const be=["loki","elasticsearch","grafana-splunk-datasource","grafana-opensearch-datasource","grafana-falconlogscale-datasource","googlecloud-logging-datasource"],De=useMemo(()=>f(X.jsonData)||{customQuery:!1},[X.jsonData]),{query:Te="",tags:we,customQuery:Ke}=De,Ve=useCallback(ht=>{le({...X,jsonData:{...X.jsonData,tracesToLogsV2:{...De,...ht},tracesToLogs:void 0}})},[le,X,De]);return React.createElement("div",{className:css({width:"100%"})},React.createElement(InlineFieldRow,null,React.createElement(InlineField,{tooltip:"The logs data source the trace is going to navigate to",label:"Data source",labelWidth:26},React.createElement(DataSourcePicker,{inputId:"trace-to-logs-data-source-picker",filter:ht=>be.includes(ht.type),current:De.datasourceUid,noDefault:!0,width:40,onChange:ht=>Ve({datasourceUid:ht.uid})}))),React.createElement(InlineFieldRow,null,React.createElement(IntervalInput,{label:m("start"),tooltip:s("start","0"),value:De.spanStartTimeShift||"",onChange:ht=>{Ve({spanStartTimeShift:ht})},isInvalidError:h})),React.createElement(InlineFieldRow,null,React.createElement(IntervalInput,{label:m("end"),tooltip:s("end","0"),value:De.spanEndTimeShift||"",onChange:ht=>{Ve({spanEndTimeShift:ht})},isInvalidError:h})),React.createElement(InlineFieldRow,null,React.createElement(InlineField,{tooltip:"Tags that will be used in the query. Default tags: 'cluster', 'hostname', 'namespace', 'pod', 'service.name', 'service.namespace'",label:"Tags",labelWidth:26},React.createElement(TagMappingInput,{values:we??[],onChange:ht=>Ve({tags:ht})}))),React.createElement(l,{disabled:Ke,type:"trace",id:"filterByTraceID",value:!!De.filterByTraceID,onChange:ht=>Ve({filterByTraceID:ht})}),React.createElement(l,{disabled:Ke,type:"span",id:"filterBySpanID",value:!!De.filterBySpanID,onChange:ht=>Ve({filterBySpanID:ht})}),React.createElement(InlineFieldRow,null,React.createElement(InlineField,{tooltip:"Use a custom query with the possibility to interpolate variables from the trace or span",label:"Use custom query",labelWidth:26},React.createElement(InlineSwitch,{id:"customQuerySwitch",value:Ke,onChange:ht=>Ve({customQuery:ht.currentTarget.checked})}))),Ke&&React.createElement(InlineField,{label:"Query",labelWidth:26,tooltip:"The query that will run when navigating from a trace to logs data source. Interpolate tags using the `$__tags` keyword",grow:!0},React.createElement(Input,{label:"Query",type:"text",allowFullScreen:!0,value:Te,onChange:ht=>Ve({query:ht.currentTarget.value})})))}function l(X){return React.createElement(InlineFieldRow,null,React.createElement(InlineField,{disabled:X.disabled,label:`Filter by ${X.type} ID`,labelWidth:26,grow:!0,tooltip:`Filters logs by ${X.type} ID, where the ${X.type} ID should be part of the log line`},React.createElement(InlineSwitch,{id:X.id,value:X.value,onChange:le=>X.onChange(le.currentTarget.checked)})))}const m=X=>`Span ${X} time shift`,s=(X,le)=>`Shifts the ${X} time of the span. Default: ${le} (Time units can be used here, for example: 5s, -1m, 3h)`,h="Invalid time shift. See tooltip for examples.",u=({options:X,onOptionsChange:le})=>{let be=X.type;return be+=X.type==="tempo"?"/configure-tempo-data-source/#trace-to-logs":"/#trace-to-logs",React.createElement(ConfigSection,{title:"Trace to logs",description:React.createElement(ConfigDescriptionLink,{description:"Navigate from a trace span to the selected data source's logs.",suffix:be,feature:"trace to logs"}),isCollapsible:!0,isInitiallyOpen:!0},React.createElement(d,{options:X,onOptionsChange:le}))};var b=e(72574),g=e(40845),P=e(31193),c=e(32901),y=e(31678),p=e(62256),v=e(56271),D=e(41811);const S=(X,le,be)=>{let De;return be?De=le?.childSpanIds.find(Te=>X.has(Te)&&X.get(Te).startTime+X.get(Te).duration<be):De=le.childSpanIds[0],De?X.get(De):void 0},M=X=>{const le=[],be=[];X.forEach(we=>{if(we.references[0]?.refType==="FOLLOWS_FROM"){le.push(we.spanID);const Ke=X.get(we.references[0].spanID);Ke.childSpanIds=Ke.childSpanIds.filter(Ve=>Ve!==we.spanID),X.set(Ke.spanID,{...Ke})}});const De=we=>{we.forEach(Ke=>{const Ve=X.get(Ke);Ve.hasChildren&&(be.push(...Ve.childSpanIds),De(Ve.childSpanIds))})};return De(le),[...le,...be].forEach(we=>X.delete(we)),X},x=X=>{let le=[...X.keys()];return le.forEach(be=>{const De=X.get(be);if(!(De&&De.references.length&&De.depth))return;const Te=X.get(De.references[0].spanID);if(!Te){X.delete(De.spanID);return}const we=De.startTime+De.duration,Ke=Te.startTime+Te.duration;if(De.startTime>=Te.startTime){if(De.startTime>=Ke){X.delete(De.spanID),Te.childSpanIds=Te.childSpanIds.filter(Ve=>Ve!==De.spanID);return}if(we>Ke){X.set(De.spanID,{...De,duration:Ke-De.startTime});return}return}we<=Te.startTime?(X.delete(De.spanID),Te.childSpanIds=Te.childSpanIds.filter(Ve=>Ve!==De.spanID)):we<=Ke?X.set(De.spanID,{...De,startTime:Te.startTime,duration:we-Te.startTime}):X.set(De.spanID,{...De,startTime:Te.startTime,duration:Ke-Te.startTime})}),le=[...X.keys()],le.forEach(be=>{const De=X.get(be);if(De.references.length){const Te=X.get(De.references[0].spanID);De.references[0].span=Te,X.set(be,{...De})}}),X},C=(X,le,be,De)=>{const Te=X.get(le);if(!Te)return be;const we=S(X,Te,De);let Ke;if(we)Ke={spanId:Te.spanID,section_start:we.startTime+we.duration,section_end:De||Te.startTime+Te.duration},Ke.section_start!==Ke.section_end&&be.push(Ke),C(X,we.spanID,be);else if(Ke={spanId:Te.spanID,section_start:Te.startTime,section_end:De||Te.startTime+Te.duration},Ke.section_start!==Ke.section_end&&be.push(Ke),Te.references.length){const Ve=Te.references.filter(ht=>ht.refType==="CHILD_OF")[0].spanID;C(X,Ve,be,Te.startTime)}return be};function O(X){let le=[];const be=X?.spans[0].spanID;if(be){const De=X.spans.reduce((Te,we)=>(Te.set(we.spanID,we),Te),new Map);try{const Te=M(De),we=x(Te);le=C(we,be,le)}catch(Te){console.log("error while computing critical path for a trace",Te)}}return le}const L=(0,D.A)(O);var N=e(3911),F=e(71656),K=e(30700);const B=.8,w=2,U=200,W=10,V=60,_=6;function H(X,le,be,De,Te){const we=new Map,Ke=le.length<V?V:Math.min(le.length,U),Ve=window.innerWidth*2;X.width=Ve,X.height=Ke;const ht=Math.min(_,Math.max(w,Ke/le.length)),gt=Ke/le.length,bt=X.getContext("2d",{alpha:!1});if(bt){bt.fillStyle=Te,bt.fillRect(0,0,Ve,Ke);for(let St=0;St<le.length;St++){const{valueWidth:Je,valueOffset:rt,serviceName:Rt}=le[St],_t=rt/be*Ve;let nn=Je/be*Ve;nn<W&&(nn=W);let Kt=we.get(Rt);Kt||(Kt=`rgba(${De(Rt).concat(B).join()})`,we.set(Rt,Kt)),bt.fillStyle=Kt,bt.fillRect(_t,St*gt,nn,ht)}}}const G=(0,N.N)(X=>({CanvasSpanGraph:(0,n.css)`
      label: CanvasSpanGraph;
      background: ${(0,F.R)(X,"#fafafa")};
      height: 60px;
      position: absolute;
      width: 100%;
    `}));class j extends a.PureComponent{constructor(le){super(le),this.getColor=be=>(0,K.rY)(be,this.props.theme),this._setCanvasRef=be=>{this._canvasElm=be},this._canvasElm=void 0}componentDidMount(){this._draw()}componentDidUpdate(){this._draw()}_draw(){if(this._canvasElm){const{valueWidth:le,items:be}=this.props;H(this._canvasElm,be,le,this.getColor,(0,F.R)(this.props.theme,"#fff"))}}render(){return a.createElement("canvas",{className:G(this.props.theme).CanvasSpanGraph,ref:this._setCanvasRef,"data-testid":"CanvasSpanGraph"})}}const Y=(0,g.cV)(j);var oe=e(6389);const se=()=>({TickLabels:(0,n.css)`
      label: TickLabels;
      height: 1rem;
      position: relative;
    `,TickLabelsLabel:(0,n.css)`
      label: TickLabelsLabel;
      color: #717171;
      font-size: 0.7rem;
      position: absolute;
      user-select: none;
    `});function ne(X){const{numTicks:le,duration:be}=X,De=(0,g.of)(se),Te=[];for(let we=0;we<le+1;we++){const Ke=we/le,Ve=Ke===1?{right:"0%"}:{left:`${Ke*100}%`};Te.push(a.createElement("div",{key:Ke,className:De.TickLabelsLabel,style:Ve,"data-testid":"tick"},(0,oe.a3)(be*Ke)))}return a.createElement("div",{className:De.TickLabels,"data-testid":"TickLabels"},Te)}var ee=e(46942),Z=e.n(ee),z=e(55852),q=e(92151);const ie=()=>({GraphTick:(0,n.css)`
      label: GraphTick;
      stroke: #aaa;
      stroke-width: 1px;
    `});function de(X){const{numTicks:le}=X,be=(0,g.of)(ie),De=[];for(let Te=1;Te<le;Te++){const we=`${Te/le*100}%`;De.push(a.createElement("line",{className:be.GraphTick,x1:we,y1:"0%",x2:we,y2:"100%",key:Te/le}))}return a.createElement("g",{"data-testid":"ticks","aria-hidden":"true"},De)}const ue=()=>({ScrubberHandleExpansion:Z()((0,n.css)`
        label: ScrubberHandleExpansion;
        cursor: col-resize;
        fill-opacity: 0;
        fill: #44f;
      `,"scrubber-handle-expansion"),ScrubberHandle:Z()((0,n.css)`
        label: ScrubberHandle;
        cursor: col-resize;
        fill: #555;
      `,"scrubber-handle"),ScrubberLine:Z()((0,n.css)`
        label: ScrubberLine;
        pointer-events: none;
        stroke: #555;
      `,"scrubber-line"),ScrubberDragging:(0,n.css)`
      label: ScrubberDragging;
      & .scrubber-handle-expansion {
        fill-opacity: 1;
      }
      & .scrubber-handle {
        fill: #44f;
      }
      & > .scrubber-line {
        stroke: #44f;
      }
    `,ScrubberHandles:(0,n.css)`
      label: ScrubberHandles;
      &:hover > .scrubber-handle-expansion {
        fill-opacity: 1;
      }
      &:hover > .scrubber-handle {
        fill: #44f;
      }
      &:hover + .scrubber.line {
        stroke: #44f;
      }
    `});function fe({isDragging:X,onMouseDown:le,onMouseEnter:be,onMouseLeave:De,position:Te}){const we=`${Te*100}%`,Ke=(0,g.of)(ue),Ve=Z()({[Ke.ScrubberDragging]:X});return a.createElement("g",{className:Ve,"data-testid":"scrubber-component"},a.createElement("g",{"data-testid":"scrubber-component-g",className:Ke.ScrubberHandles,onMouseDown:le,onMouseEnter:be,onMouseLeave:De},a.createElement("rect",{"data-testid":"scrubber-component-rect-1",x:we,className:Ke.ScrubberHandleExpansion,style:{transform:"translate(-4.5px)"},width:"9",height:"20"}),a.createElement("rect",{"data-testid":"scrubber-component-rect-2",x:we,className:Ke.ScrubberHandle,style:{transform:"translate(-1.5px)"},width:"3",height:"20"})),a.createElement("line",{className:Ke.ScrubberLine,y2:"100%",x1:we,x2:we,"data-testid":"scrubber-component-line"}))}const Se=(0,N.N)(X=>{const le="JaegerUiComponents__ViewingLayerResetZoomHoverClassName",be=(0,n.css)`
    label: ViewingLayerResetZoom;
    display: none;
    position: absolute;
    right: 1%;
    top: 10%;
    z-index: 1;
  `;return{ViewingLayer:(0,n.css)`
      label: ViewingLayer;
      cursor: vertical-text;
      position: relative;
      z-index: 1;
      &:hover > .${le} {
        display: unset;
      }
    `,ViewingLayerGraph:(0,n.css)`
      label: ViewingLayerGraph;
      border: 1px solid ${(0,F.R)(X,"#999")};
      /* need !important here to overcome something from semantic UI */
      overflow: visible !important;
      position: relative;
      transform-origin: 0 0;
      width: 100%;
    `,ViewingLayerInactive:(0,n.css)`
      label: ViewingLayerInactive;
      fill: ${(0,F.R)(X,"rgba(214, 214, 214, 0.5)")};
    `,ViewingLayerCursorGuide:(0,n.css)`
      label: ViewingLayerCursorGuide;
      stroke: ${(0,F.R)(X,"#f44")};
      stroke-width: 1;
    `,ViewingLayerDraggedShift:(0,n.css)`
      label: ViewingLayerDraggedShift;
      fill-opacity: 0.2;
    `,ViewingLayerDrag:(0,n.css)`
      label: ViewingLayerDrag;
      fill: ${(0,F.R)(X,"#44f")};
    `,ViewingLayerFullOverlay:(0,n.css)`
      label: ViewingLayerFullOverlay;
      bottom: 0;
      cursor: col-resize;
      left: 0;
      position: fixed;
      right: 0;
      top: 0;
      user-select: none;
    `,ViewingLayerResetZoom:be,ViewingLayerResetZoomHoverClassName:le}}),he={SHIFT_END:"SHIFT_END",SHIFT_START:"SHIFT_START",REFRAME:"REFRAME"};function ce(X,le){const[be,De]=X<le?[X,le]:[le,X];return{x:`${be*100}%`,width:`${(De-be)*100}%`,leadingX:`${le*100}%`}}class me extends a.PureComponent{constructor(le){super(le),this._setRoot=be=>{this._root=be},this._getDraggingBounds=be=>{if(!this._root)throw new Error("invalid state");const{left:De,width:Te}=this._root.getBoundingClientRect(),[we,Ke]=this.props.viewRange.time.current;let Ve=1,ht=0;return be===he.SHIFT_START?Ve=Ke:be===he.SHIFT_END&&(ht=we),{clientXLeft:De,maxValue:Ve,minValue:ht,width:Te}},this._handleReframeMouseMove=({value:be})=>{this.props.updateNextViewRangeTime({cursor:be})},this._handleReframeMouseLeave=()=>{this._draggerReframe.resetBounds(),this.props.updateNextViewRangeTime({cursor:null})},this._handleReframeDragUpdate=({value:be})=>{const De=be,{time:Te}=this.props.viewRange,Ke={reframe:{anchor:Te.reframe?Te.reframe.anchor:De,shift:De}};this.props.updateNextViewRangeTime(Ke)},this._handleReframeDragEnd=({manager:be,value:De})=>{const{time:Te}=this.props.viewRange,we=Te.reframe?Te.reframe.anchor:De,[Ke,Ve]=De<we?[De,we]:[we,De];be.resetBounds(),this.props.updateViewRangeTime(Ke,Ve,"minimap")},this._handleScrubberEnterLeave=({type:be})=>{const De=be===q.EUpdateTypes.MouseEnter;this.setState({preventCursorLine:De})},this._handleScrubberDragUpdate=({event:be,tag:De,type:Te,value:we})=>{Te===q.EUpdateTypes.DragStart&&be.stopPropagation(),De===he.SHIFT_START?this.props.updateNextViewRangeTime({shiftStart:we}):De===he.SHIFT_END&&this.props.updateNextViewRangeTime({shiftEnd:we})},this._handleScrubberDragEnd=({manager:be,tag:De,value:Te})=>{const[we,Ke]=this.props.viewRange.time.current;let Ve;if(De===he.SHIFT_START)Ve=[Te,Ke];else if(De===he.SHIFT_END)Ve=[we,Te];else throw new Error("bad state");be.resetBounds(),this.setState({preventCursorLine:!1}),this.props.updateViewRangeTime(Ve[0],Ve[1],"minimap")},this._resetTimeZoomClickHandler=()=>{this.props.updateViewRangeTime(0,1)},this._draggerReframe=new q.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleReframeDragEnd,onDragMove:this._handleReframeDragUpdate,onDragStart:this._handleReframeDragUpdate,onMouseMove:this._handleReframeMouseMove,onMouseLeave:this._handleReframeMouseLeave,tag:he.REFRAME}),this._draggerStart=new q.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleScrubberDragEnd,onDragMove:this._handleScrubberDragUpdate,onDragStart:this._handleScrubberDragUpdate,onMouseEnter:this._handleScrubberEnterLeave,onMouseLeave:this._handleScrubberEnterLeave,tag:he.SHIFT_START}),this._draggerEnd=new q.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleScrubberDragEnd,onDragMove:this._handleScrubberDragUpdate,onDragStart:this._handleScrubberDragUpdate,onMouseEnter:this._handleScrubberEnterLeave,onMouseLeave:this._handleScrubberEnterLeave,tag:he.SHIFT_END}),this._root=void 0,this.state={preventCursorLine:!1}}componentWillUnmount(){this._draggerReframe.dispose(),this._draggerEnd.dispose(),this._draggerStart.dispose()}_getMarkers(le,be){const De=Se(this.props.theme),Te=ce(le,be);return[a.createElement("rect",{key:"fill",className:Z()(De.ViewingLayerDraggedShift,De.ViewingLayerDrag),x:Te.x,y:"0",width:Te.width,height:this.props.height-2}),a.createElement("rect",{key:"edge",className:Z()(De.ViewingLayerDrag),x:Te.leadingX,y:"0",width:"1",height:this.props.height-2})]}render(){const{height:le,viewRange:be,numTicks:De,theme:Te}=this.props,{preventCursorLine:we}=this.state,{current:Ke,cursor:Ve,shiftStart:ht,shiftEnd:gt,reframe:bt}=be.time,St=ht!=null||gt!=null||bt!=null,[Je,rt]=Ke;let Rt=0;Je&&(Rt=Je*100);let _t=100;rt&&(_t=100-rt*100);let nn;!St&&Ve!=null&&!we&&(nn=`${Ve*100}%`);const Kt=Se(Te);return a.createElement("div",{"aria-hidden":!0,className:Kt.ViewingLayer,style:{height:le}},(Je!==0||rt!==1)&&a.createElement(z.$n,{onClick:this._resetTimeZoomClickHandler,className:Z()(Kt.ViewingLayerResetZoom,Kt.ViewingLayerResetZoomHoverClassName),type:"button",variant:"secondary"},"Reset Selection"),a.createElement("svg",{height:le,className:Kt.ViewingLayerGraph,ref:this._setRoot,onMouseDown:this._draggerReframe.handleMouseDown,onMouseLeave:this._draggerReframe.handleMouseLeave,onMouseMove:this._draggerReframe.handleMouseMove},Rt>0&&a.createElement("rect",{x:0,y:0,height:"100%",width:`${Rt}%`,className:Kt.ViewingLayerInactive,"data-testid":"left-ViewingLayerInactive"}),_t>0&&a.createElement("rect",{x:`${100-_t}%`,y:0,height:"100%",width:`${_t}%`,className:Kt.ViewingLayerInactive,"data-testid":"right-ViewingLayerInactive"}),a.createElement(de,{numTicks:De}),nn&&a.createElement("line",{className:Kt.ViewingLayerCursorGuide,x1:nn,y1:"0",x2:nn,y2:le-2,strokeWidth:"1","data-testid":"ViewingLayerCursorGuide"}),ht!=null&&this._getMarkers(Je,ht),gt!=null&&this._getMarkers(rt,gt),a.createElement(fe,{isDragging:ht!=null,onMouseDown:this._draggerStart.handleMouseDown,onMouseEnter:this._draggerStart.handleMouseEnter,onMouseLeave:this._draggerStart.handleMouseLeave,position:Je||0}),a.createElement(fe,{isDragging:gt!=null,position:rt||1,onMouseDown:this._draggerEnd.handleMouseDown,onMouseEnter:this._draggerEnd.handleMouseEnter,onMouseLeave:this._draggerEnd.handleMouseLeave}),bt!=null&&this._getMarkers(bt.anchor,bt.shift)),St&&a.createElement("div",{className:Kt.ViewingLayerFullOverlay}))}}const pe=(0,g.cV)(me),ye=()=>({container:(0,n.css)({padding:"0 0.5rem 0.5rem 0.5rem"}),canvasContainer:(0,n.css)({position:"relative"})}),Pe=60,Ie=4;function Oe(X){return{valueOffset:X.relativeStartTime,valueWidth:X.duration,serviceName:X.process.serviceName}}function Ne(X){return X.spans.map(Oe)}const We=(0,D.A)(Ne);class Ae extends a.PureComponent{static{this.defaultProps={height:Pe}}render(){const{height:le,trace:be,viewRange:De,updateNextViewRangeTime:Te,updateViewRangeTime:we}=this.props,Ke=ye();if(!be)return a.createElement("div",null);const Ve=We(be);return a.createElement("div",{className:Ke.container},a.createElement(ne,{numTicks:Ie,duration:be.duration}),a.createElement("div",{className:Ke.canvasContainer},a.createElement(Y,{valueWidth:be.duration,items:Ve}),a.createElement(pe,{viewRange:De,numTicks:Ie,height:le||Pe,updateViewRangeTime:we,updateNextViewRangeTime:Te})))}}var Ue=e(28114);function Me(){const[X,le]=(0,a.useState)(new Set),be=(0,a.useCallback)(function(ht){if(X.size===0)return;let gt=-1,bt=!0;const St=ht.reduce((Je,rt)=>(rt.depth<=gt&&(bt=!0),bt&&Je.has(rt.spanID)&&(Je.delete(rt.spanID),bt=!1,gt=rt.depth),Je),new Set(X));le(St)},[X]),De=(0,a.useCallback)(function(ht){if($e(ht,X))return;let gt;const bt=ht.reduce((St,Je)=>(gt&&Je.depth<=gt.depth?(St.add(gt.spanID),Je.hasChildren&&(gt=Je)):Je.hasChildren&&!St.has(Je.spanID)&&(gt=Je),St),new Set(X));gt&&bt.add(gt.spanID),le(bt)},[X]),Te=(0,a.useCallback)(function(){le(new Set)},[]),we=(0,a.useCallback)(function(ht){if($e(ht,X))return;const gt=ht.reduce((bt,St)=>(St.hasChildren&&bt.add(St.spanID),bt),new Set);le(gt)},[X]),Ke=(0,a.useCallback)(function(ht){const gt=new Set(X);X.has(ht)?gt.delete(ht):gt.add(ht),le(gt)},[X]);return{childrenHiddenIDs:X,expandOne:be,collapseOne:De,expandAll:Te,collapseAll:we,childrenToggle:Ke}}function $e(X,le){return X.filter(De=>De.hasChildren).length===le.size}function ke(X){const[le,be]=(0,a.useState)(new Map);(0,a.useEffect)(()=>{be(new Map)},[X,be]);const De=(0,a.useCallback)(function(Ve){const ht=new Map(le);ht.has(Ve)?ht.delete(Ve):ht.set(Ve,new v.DetailState),be(ht)},[le]),Te=(0,a.useCallback)(function(Ve,ht){const gt=le.get(Ve);if(!gt)return;const bt=gt.toggleLogItem(ht),St=new Map(le);return St.set(Ve,bt),be(St)},[le]),we=(0,a.useCallback)(function(Ve,ht){const gt=le.get(Ve);if(!gt)return;const bt=gt.toggleReferenceItem(ht),St=new Map(le);return St.set(Ve,bt),be(St)},[le]);return{detailStates:le,toggleDetail:De,detailLogItemToggle:Te,detailLogsToggle:(0,a.useCallback)(Ke=>Ze("logs",le,be)(Ke),[le]),detailWarningsToggle:(0,a.useCallback)(Ke=>Ze("warnings",le,be)(Ke),[le]),detailStackTracesToggle:(0,a.useCallback)(Ke=>Ze("stackTraces",le,be)(Ke),[le]),detailReferenceItemToggle:we,detailReferencesToggle:(0,a.useCallback)(Ke=>Ze("references",le,be)(Ke),[le]),detailProcessToggle:(0,a.useCallback)(Ke=>Ze("process",le,be)(Ke),[le]),detailTagsToggle:(0,a.useCallback)(Ke=>Ze("tags",le,be)(Ke),[le])}}function Ze(X,le,be){return De=>{const Te=le.get(De);if(!Te)return;let we;X==="tags"?we=Te.toggleTags():X==="process"?we=Te.toggleProcess():X==="warnings"?we=Te.toggleWarnings():X==="references"?we=Te.toggleReferences():X==="stackTraces"?we=Te.toggleStackTraces():we=Te.toggleLogs();const Ke=new Map(le);Ke.set(De,we),be(Ke)}}function ot(){const[X,le]=(0,a.useState)(new Set),be=(0,a.useCallback)(function(we){le(Ke=>{const Ve=new Set(Ke);return Ve.add(we),Ve})},[]),De=(0,a.useCallback)(function(we){le(Ke=>{const Ve=new Set(Ke);return Ve.delete(we),Ve})},[]);return{hoverIndentGuideIds:X,addHoverIndentGuideId:be,removeHoverIndentGuideId:De}}var xt=e(15583);function ct(){const[X,le]=(0,a.useState)({time:{current:[0,1]}}),be=(0,a.useCallback)(function(we){le(Ke=>{const Ve={...Ke.time,...we};return{...Ke,time:Ve}})},[]),De=(0,a.useCallback)(function(we,Ke){const ht={current:[we,Ke]};le(gt=>({...gt,time:ht}))},[]);return{viewRange:X,updateViewRangeTime:De,updateNextViewRangeTime:be}}const ft=X=>({noDataMsg:(0,n.css)`
    height: 100%;
    width: 100%;
    display: grid;
    place-items: center;
    font-size: ${X.typography.h4.fontSize};
    color: ${X.colors.text.secondary};
  `});function Le(X){const{traceProp:le,datasource:be,topOfViewRef:De,exploreId:Te,createSpanLink:we,focusedSpanId:Ke,createFocusSpanLink:Ve}=X,{detailStates:ht,toggleDetail:gt,detailLogItemToggle:bt,detailLogsToggle:St,detailProcessToggle:Je,detailReferencesToggle:rt,detailReferenceItemToggle:Rt,detailTagsToggle:_t,detailWarningsToggle:nn,detailStackTracesToggle:Kt}=ke(X.dataFrames[0]),{removeHoverIndentGuideId:en,addHoverIndentGuideId:Qt,hoverIndentGuideIds:An}=ot(),{viewRange:un,updateViewRangeTime:fn,updateNextViewRangeTime:Tt}=ct(),{expandOne:$t,collapseOne:Yt,childrenToggle:Cn,collapseAll:Tn,childrenHiddenIDs:vn,expandAll:Kn}=Me(),{search:Yn,setSearch:nt,spanFilterMatches:yt}=(0,xt.SQ)(le?.spans),[Vt,je]=(0,a.useState)(""),[tt,Dt]=(0,o.A)(!1),[Ot,Lt]=(0,a.useState)(!1),[Gt,hn]=(0,a.useState)(!1),[mt,Bt]=(0,a.useState)(100),[Jt,Rn]=(0,a.useState)({}),[Mt,wt]=(0,a.useState)({}),Ht=(0,g.of)(ft),[tn,It]=(0,a.useState)(.4),[Xe,jn]=re({refId:X.dataFrames[0]?.refId,exploreId:X.exploreId,datasource:be,splitOpenFn:X.splitOpenFn}),Qn=Ke??Xe,ia=Ve??jn,wn=(0,a.useMemo)(()=>({childrenHiddenIDs:vn,detailStates:ht,hoverIndentGuideIds:An,spanNameColumnWidth:tn,traceID:X.traceProp?.traceID}),[vn,ht,An,tn,X.traceProp?.traceID]),sa=(0,P.tR)().getInstanceSettings(be?.name),La=f(sa?.jsonData),ga=sa?.jsonData?.tracesToMetrics,Us=sa?.jsonData?.tracesToProfiles,Bs=sa?.jsonData,ks=(0,a.useMemo)(()=>we??(0,Ue.lU)({splitOpenFn:X.splitOpenFn,traceToLogsOptions:La,traceToMetricsOptions:ga,traceToProfilesOptions:Us,dataFrame:X.dataFrames[0],createFocusSpanLink:ia,trace:le}),[X.splitOpenFn,La,ga,Us,X.dataFrames,ia,le,we]),Ms=(0,y.useSelector)(Xs=>(0,c.O)(Xs.user)),Dr=be?be?.type:"unknown",_s=X.scrollElement?X.scrollElement:document.getElementsByClassName(X.scrollElementClass??"")[0],Ir=L(le);return a.createElement(a.Fragment,null,X.dataFrames?.length&&le?a.createElement(a.Fragment,null,a.createElement(v.TracePageHeader,{trace:le,data:X.dataFrames[0],timeZone:Ms,search:Yn,setSearch:nt,showSpanFilters:tt,setShowSpanFilters:Dt,showSpanFilterMatchesOnly:Ot,setShowSpanFilterMatchesOnly:Lt,showCriticalPathSpansOnly:Gt,setShowCriticalPathSpansOnly:hn,setFocusedSpanIdForSearch:je,spanFilterMatches:yt,datasourceType:Dr,setHeaderHeight:Bt,app:Te?r.Jk.Explore:r.Jk.Unknown}),a.createElement(Ae,{trace:le,viewRange:un,updateNextViewRangeTime:Tt,updateViewRangeTime:fn}),a.createElement(v.TraceTimelineViewer,{findMatchesIDs:yt,trace:le,traceToProfilesOptions:Us,datasourceType:Dr,spanBarOptions:Bs?.spanBar,traceTimeline:wn,updateNextViewRangeTime:Tt,updateViewRangeTime:fn,viewRange:un,timeZone:Ms,setSpanNameColumnWidth:It,collapseAll:Tn,collapseOne:Yt,expandAll:Kn,expandOne:$t,childrenToggle:Cn,detailLogItemToggle:bt,detailLogsToggle:St,detailWarningsToggle:nn,detailStackTracesToggle:Kt,detailReferencesToggle:rt,detailReferenceItemToggle:Rt,detailProcessToggle:Je,detailTagsToggle:_t,detailToggle:gt,addHoverIndentGuideId:Qt,removeHoverIndentGuideId:en,linksGetter:()=>[],createSpanLink:ks,scrollElement:_s,focusedSpanId:Qn,focusedSpanIdForSearch:Vt,showSpanFilterMatchesOnly:Ot,showCriticalPathSpansOnly:Gt,createFocusSpanLink:ia,topOfViewRef:De,headerHeight:mt,criticalPath:Ir,traceFlameGraphs:Jt,setTraceFlameGraphs:Rn,redrawListView:Mt,setRedrawListView:wt})):a.createElement("div",{className:Ht.noDataMsg},"No data"))}function re(X){const le=(0,y.useSelector)(Ve=>Ve.explore.panes[X.exploreId]?.panelsState.trace),be=le?.spanId,De=(0,y.useDispatch)(),Te=Ve=>De((0,p.EA)(X.exploreId,"trace",{...le,spanId:Ve})),we=(0,y.useSelector)(Ve=>Ve.explore.panes[X.exploreId]?.queries.find(ht=>ht.refId===X.refId));return[be,(Ve,ht)=>{const gt={title:"Deep link to this span",url:"",internal:{datasourceUid:X.datasource?.uid,datasourceName:X.datasource?.name,query:{...we,query:Ve},panelsState:{trace:{spanId:ht}}}},bt=we?.queryType==="traceql"&&we.query===Ve;return(0,i.u)({link:gt,internalLink:gt.internal,scopedVars:{},field:{},onClickFn:bt?()=>Te(be===ht?void 0:ht):X.splitOpenFn?()=>X.splitOpenFn({datasourceUid:X.datasource?.uid,queries:[{...we,query:Ve}],panelsState:{trace:{spanId:ht}}}):void 0,replaceVariables:(0,b.w)().replace.bind((0,b.w)())})}]}},71656:(Q,I,e)=>{"use strict";e.d(I,{R:()=>a});var n=e(84140);function a(o,r,i){if(o.isLight)return r;{if(i){const l=(0,n.A)(r);return n.A.mostReadable(i,[l.clone().lighten(25),l.clone().lighten(10),l,l.clone().darken(10),l.clone().darken(25)],{includeFallbackColors:!1}).toHex8String()}const f=(0,n.A)(r).toHsl();f.l=1-f.l;const d=(0,n.A)(f);return d.isLight()?d.darken(5).toHex8String():d.lighten(5).toHex8String()}}},56271:(Q,I,e)=>{"use strict";e.d(I,{DetailState:()=>xo,TracePageHeader:()=>Lr,TraceTimelineViewer:()=>ko,filterSpans:()=>Jn,transformTraceData:()=>Os});var n=e(32196),a=e(96540),o=e(14110),r=e(32264),i=e(3911),f=e(40845),d=e(71656),l=e(75888),m=e.n(l);const h={scrollPageDown:{binding:"s",label:"Scroll down"},scrollPageUp:{binding:"w",label:"Scroll up"},scrollToNextVisibleSpan:{binding:"f",label:"Scroll to the next visible span"},scrollToPrevVisibleSpan:{binding:"b",label:"Scroll to the previous visible span"},panLeft:{binding:["a","left"],label:"Pan left"},panLeftFast:{binding:["shift+a","shift+left"],label:"Pan left \u2014 Large"},panRight:{binding:["d","right"],label:"Pan right"},panRightFast:{binding:["shift+d","shift+right"],label:"Pan right \u2014 Large"},zoomIn:{binding:"up",label:"Zoom in"},zoomInFast:{binding:"shift+up",label:"Zoom in \u2014 Large"},zoomOut:{binding:"down",label:"Zoom out"},zoomOutFast:{binding:"shift+down",label:"Zoom out \u2014 Large"},collapseAll:{binding:"]",label:"Collapse All"},expandAll:{binding:"[",label:"Expand All"},collapseOne:{binding:"p",label:"Collapse One Level"},expandOne:{binding:"o",label:"Expand One Level"},searchSpans:{binding:"ctrl+b",label:"Search Spans"},clearSearch:{binding:"escape",label:"Clear Search"}};let u;function b(){if(u)return u;const _e=new(m())(document.body);return u=_e,_e}function g(_e){const et=b();Object.keys(_e).forEach(st=>{const pt=_e[st];pt&&et.bind(h[st].binding,pt)})}function P(){b().reset()}var c=e(46942),y=e.n(c),p=e(6389);function v(_e){const{min:et,max:st,viewStart:pt,viewEnd:Wt}=_e,Xt=st-et,dn=et+pt*Xt,Hn=st-(1-Wt)*Xt-dn;return(ra,Ba)=>({start:(ra-dn)/Hn,end:(Ba-dn)/Hn})}function D(_e,et,st){return!Array.isArray(st.tags)||!st.tags.length?!1:st.tags.some(pt=>pt.key===_e&&pt.value===et)}const E=_e=>_e.kind==="client",S=D.bind(null,"span.kind","client"),T=_e=>E(_e)||S(_e),M=_e=>_e.kind==="server",A=D.bind(null,"span.kind","server"),x=_e=>M(_e)||A(_e),C=_e=>_e.statusCode===2,O=D.bind(null,"error",!0),R=D.bind(null,"error","true"),L=_e=>C(_e)||O(_e)||R(_e);function N(_e,et){const{depth:st}=_e[et];let pt=et+1;for(;pt<_e.length&&_e[pt].depth>st;pt++)if(L(_e[pt]))return!0;return!1}function F(_e){if(_e.length<=1||!T(_e[0]))return!1;const st=_e[0].depth+1;let pt=1;for(;pt<_e.length&&_e[pt].depth===st;){if(x(_e[pt]))return _e[pt];pt++}return null}const K=_e=>_e.kind?_e.kind==="client":_e.tags.some(({key:et,value:st})=>et==="span.kind"&&st==="client"),B=_e=>({Ticks:(0,n.css)`
      label: Ticks;
      pointer-events: none;
    `,TicksTick:(0,n.css)`
      label: TicksTick;
      position: absolute;
      height: 100%;
      width: 1px;
      background: ${(0,d.R)(_e,"#d8d8d8")};
      &:last-child {
        width: 0;
      }
    `,TicksTickLabel:(0,n.css)`
      label: TicksTickLabel;
      left: 0.25rem;
      position: absolute;
    `,TicksTickLabelEndAnchor:(0,n.css)`
      label: TicksTickLabelEndAnchor;
      left: initial;
      right: 0.25rem;
    `});function w({endTime:_e=null,numTicks:et,showLabels:st=null,startTime:pt=null}){let Wt;if(st){Wt=[];const In=(_e||0)-(pt||0);for(let Hn=0;Hn<et;Hn++){const ra=(pt||0)+Hn/(et-1)*In;Wt.push((0,p.a3)(ra))}}const Xt=(0,f.of)(B),dn=[];for(let In=0;In<et;In++){const Hn=In/(et-1);dn.push(a.createElement("div",{"data-testid":"TicksID",key:Hn,className:Xt.TicksTick,style:{left:`${Hn*100}%`}},Wt&&a.createElement("span",{className:y()(Xt.TicksTickLabel,{[Xt.TicksTickLabelEndAnchor]:Hn>=1})},Wt[In])))}return a.createElement("div",{className:Xt.Ticks},dn)}const U=()=>({row:(0,n.css)({display:"flex",flex:"0 1 auto",flexDirection:"row"}),rowCell:(0,n.css)({position:"relative"})});function W({children:_e,className:et="",...st}){const pt=(0,f.of)(U);return a.createElement("div",{className:y()(pt.row,et),...st},_e)}function V({children:_e,className:et="",width:st,style:pt={},...Wt}){const Xt=`${st*100}%`,dn={...pt,flexBasis:Xt,maxWidth:Xt},In=(0,f.of)(U);return a.createElement("div",{className:y()(In.rowCell,et),style:dn,"data-testid":"TimelineRowCell",...Wt},_e)}W.Cell=V;var _=e(29158);const H=()=>({TimelineCollapser:(0,n.css)`
      align-items: center;
      display: flex;
      flex: none;
      justify-content: center;
      margin-right: 0.5rem;
    `});function G(_e){const{onExpandAll:et,onExpandOne:st,onCollapseAll:pt,onCollapseOne:Wt}=_e,Xt=(0,f.of)(H);return a.createElement("div",{className:Xt.TimelineCollapser,"data-testid":"TimelineCollapser"},a.createElement(_.K,{tooltip:"Expand +1",size:"xl",tooltipPlacement:"top",name:"angle-down",onClick:st}),a.createElement(_.K,{tooltip:"Collapse +1",size:"xl",tooltipPlacement:"top",name:"angle-right",onClick:Wt}),a.createElement(_.K,{tooltip:"Expand All",size:"xl",tooltipPlacement:"top",name:"angle-double-down",onClick:et}),a.createElement(_.K,{tooltip:"Collapse All",size:"xl",tooltipPlacement:"top",name:"angle-double-right",onClick:pt}))}var j=e(92151);const Y=()=>({TimelineColumnResizer:(0,n.css)`
      left: 0;
      position: absolute;
      right: 0;
      top: 0;
    `,wrapper:(0,n.css)`
      bottom: 0;
      position: absolute;
      top: 0;
    `,dragger:(0,n.css)`
      border-left: 2px solid transparent;
      cursor: col-resize;
      height: 5000px;
      margin-left: -1px;
      position: absolute;
      top: 0;
      width: 1px;
      z-index: 10;
      &:hover {
        border-left: 2px solid rgba(0, 0, 0, 0.3);
      }
      &::before {
        position: absolute;
        top: 0;
        bottom: 0;
        left: -8px;
        right: 0;
        content: ' ';
      }
    `,draggerDragging:(0,n.css)`
      background: rgba(136, 0, 136, 0.05);
      width: unset;
      &::before {
        left: -2000px;
        right: -2000px;
      }
    `,draggerDraggingLeft:(0,n.css)`
      border-left: 2px solid #808;
      border-right: 1px solid #999;
    `,draggerDraggingRight:(0,n.css)`
      border-left: 1px solid #999;
      border-right: 2px solid #808;
    `,gripIcon:(0,n.css)`
      position: absolute;
      top: 0;
      bottom: 0;
      &::before,
      &::after {
        border-right: 1px solid #ccc;
        content: ' ';
        height: 9px;
        position: absolute;
        right: 9px;
        top: 25px;
      }
      &::after {
        right: 5px;
      }
    `,gripIconDragging:(0,n.css)`
      &::before,
      &::after {
        border-right: 1px solid rgba(136, 0, 136, 0.5);
      }
    `});class oe extends a.PureComponent{constructor(et){super(et),this._setRootElm=st=>{this._rootElm=st},this._getDraggingBounds=()=>{if(!this._rootElm)throw new Error("invalid state");const{left:st,width:pt}=this._rootElm.getBoundingClientRect(),{min:Wt,max:Xt}=this.props;return{clientXLeft:st,width:pt,maxValue:Xt,minValue:Wt}},this._handleDragUpdate=({value:st})=>{this.setState({dragPosition:st})},this._handleDragEnd=({manager:st,value:pt})=>{st.resetBounds(),this.setState({dragPosition:null}),this.props.onChange(pt)},this._dragManager=new j.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleDragEnd,onDragMove:this._handleDragUpdate,onDragStart:this._handleDragUpdate}),this._rootElm=void 0,this.state={dragPosition:null}}componentWillUnmount(){this._dragManager.dispose()}render(){let et,st;const{position:pt,columnResizeHandleHeight:Wt}=this.props,{dragPosition:Xt}=this.state;et=`${pt*100}%`;const dn={left:et};let In=!1,Hn=!1;const ra=Y();if(this._dragManager.isDragging()&&this._rootElm&&Xt!=null){In=Xt<pt,Hn=Xt>pt;const wa=`${Math.min(pt,Xt)*100}%`,Ua=`calc(${(1-Math.max(pt,Xt))*100}% - 1px)`;st={left:wa,right:Ua}}else st=dn;st.height=Wt;const Ba=In||Hn;return a.createElement("div",{className:ra.TimelineColumnResizer,ref:this._setRootElm,"data-testid":"TimelineColumnResizer"},a.createElement("div",{className:y()(ra.gripIcon,Ba&&ra.gripIconDragging),style:dn,"data-testid":"TimelineColumnResizer--gripIcon"}),a.createElement("div",{"aria-hidden":!0,className:y()(ra.dragger,Ba&&ra.draggerDragging,Hn&&ra.draggerDraggingRight,In&&ra.draggerDraggingLeft),onMouseDown:this._dragManager.handleMouseDown,style:st,"data-testid":"TimelineColumnResizer--dragger"}))}}const se=(0,i.N)(()=>({TimelineViewingLayer:(0,n.css)`
      label: TimelineViewingLayer;
      bottom: 0;
      cursor: vertical-text;
      left: 0;
      position: absolute;
      right: 0;
      top: 0;
    `,TimelineViewingLayerCursorGuide:(0,n.css)`
      label: TimelineViewingLayerCursorGuide;
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      width: 1px;
      background-color: red;
    `,TimelineViewingLayerDragged:(0,n.css)`
      label: TimelineViewingLayerDragged;
      position: absolute;
      top: 0;
      bottom: 0;
    `,TimelineViewingLayerDraggedDraggingLeft:(0,n.css)`
      label: TimelineViewingLayerDraggedDraggingLeft;
      border-left: 1px solid;
    `,TimelineViewingLayerDraggedDraggingRight:(0,n.css)`
      label: TimelineViewingLayerDraggedDraggingRight;
      border-right: 1px solid;
    `,TimelineViewingLayerDraggedShiftDrag:(0,n.css)`
      label: TimelineViewingLayerDraggedShiftDrag;
      background-color: rgba(68, 68, 255, 0.2);
      border-color: #44f;
    `,TimelineViewingLayerDraggedReframeDrag:(0,n.css)`
      label: TimelineViewingLayerDraggedReframeDrag;
      background-color: rgba(255, 68, 68, 0.2);
      border-color: #f44;
    `,TimelineViewingLayerFullOverlay:(0,n.css)`
      label: TimelineViewingLayerFullOverlay;
      bottom: 0;
      cursor: col-resize;
      left: 0;
      position: fixed;
      right: 0;
      top: 0;
      user-select: none;
    `}));function ne(_e){return Reflect.has(_e,"isOutOfView")}function ee(_e,et,st){return _e+st*(et-_e)}function Z(_e,et,st){return(st-_e)/(et-_e)}function z(_e,et){let[st,pt]=_e<et?[_e,et]:[et,_e];return st>=1||pt<=0?{isOutOfView:!0}:(st<0&&(st=0),pt>1&&(pt=1),{isDraggingLeft:_e>et,left:`${st*100}%`,width:`${(pt-st)*100}%`})}function q(_e,et,st,pt,Wt){const Xt=Z(_e,et,st),dn=Z(_e,et,pt),In=z(Xt,dn);if(ne(In))return null;const{isDraggingLeft:Hn,left:ra,width:Ba}=In,wa=se(),Ua=(0,n.cx)({[wa.TimelineViewingLayerDraggedDraggingRight]:!Hn,[wa.TimelineViewingLayerDraggedReframeDrag]:!Wt,[wa.TimelineViewingLayerDraggedShiftDrag]:Wt});return a.createElement("div",{className:(0,n.cx)(wa.TimelineViewingLayerDragged,wa.TimelineViewingLayerDraggedDraggingLeft,Ua),style:{left:ra,width:Ba},"data-testid":"Dragged"})}class ie extends a.PureComponent{constructor(et){super(et),this._setRoot=st=>{this._root=st},this._getDraggingBounds=()=>{if(!this._root)throw new Error("invalid state");const{left:st,width:pt}=this._root.getBoundingClientRect();return{clientXLeft:st,width:pt}},this._handleReframeMouseMove=({value:st})=>{const[pt,Wt]=this.props.viewRangeTime.current,Xt=ee(pt,Wt,st);this.props.updateNextViewRangeTime({cursor:Xt})},this._handleReframeMouseLeave=()=>{this.props.updateNextViewRangeTime({cursor:void 0})},this._handleReframeDragUpdate=({value:st})=>{const{current:pt,reframe:Wt}=this.props.viewRangeTime,[Xt,dn]=pt,In=ee(Xt,dn,st),ra={reframe:{anchor:Wt?Wt.anchor:In,shift:In}};this.props.updateNextViewRangeTime(ra)},this._handleReframeDragEnd=({manager:st,value:pt})=>{const{current:Wt,reframe:Xt}=this.props.viewRangeTime,[dn,In]=Wt,Hn=ee(dn,In,pt),ra=Xt?Xt.anchor:Hn,[Ba,wa]=Hn<ra?[Hn,ra]:[ra,Hn];st.resetBounds(),this.props.updateViewRangeTime(Ba,wa,"timeline-header")},this._draggerReframe=new j.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleReframeDragEnd,onDragMove:this._handleReframeDragUpdate,onDragStart:this._handleReframeDragUpdate,onMouseLeave:this._handleReframeMouseLeave,onMouseMove:this._handleReframeMouseMove}),this._root=void 0}UNSAFE_componentWillReceiveProps(et){const{boundsInvalidator:st}=this.props;st!==et.boundsInvalidator&&this._draggerReframe.resetBounds()}componentWillUnmount(){this._draggerReframe.dispose()}render(){const{viewRangeTime:et}=this.props,{current:st,cursor:pt,reframe:Wt,shiftEnd:Xt,shiftStart:dn}=et,[In,Hn]=st,ra=Wt!=null||Xt!=null||dn!=null;let Ba;!ra&&pt!=null&&pt>=In&&pt<=Hn&&(Ba=`${Z(In,Hn,pt)*100}%`);const wa=se();return a.createElement("div",{"aria-hidden":!0,className:wa.TimelineViewingLayer,ref:this._setRoot,onMouseDown:this._draggerReframe.handleMouseDown,onMouseLeave:this._draggerReframe.handleMouseLeave,onMouseMove:this._draggerReframe.handleMouseMove,"data-testid":"TimelineViewingLayer"},Ba!=null&&a.createElement("div",{className:wa.TimelineViewingLayerCursorGuide,style:{left:Ba},"data-testid":"TimelineViewingLayer--cursorGuide"}),Wt!=null&&q(In,Hn,Wt.anchor,Wt.shift,!1),Xt!=null&&q(In,Hn,Hn,Xt,!0),dn!=null&&q(In,Hn,In,dn,!0))}}const de=_e=>({TimelineHeaderRow:(0,n.css)`
      label: TimelineHeaderRow;
      background: ${(0,d.R)(_e,"#ececec")};
      border-bottom: 1px solid ${(0,d.R)(_e,"#ccc")};
      height: 38px;
      line-height: 38px;
      width: 100%;
      z-index: 4;
      position: relative;
    `,TimelineHeaderRowTitle:(0,n.css)`
      label: TimelineHeaderRowTitle;
      flex: 1;
      overflow: hidden;
      margin: 0;
      text-overflow: ellipsis;
      white-space: nowrap;
    `,TimelineHeaderWrapper:(0,n.css)`
      label: TimelineHeaderWrapper;
      align-items: center;
      display: flex;
      padding-left: ${_e.spacing(1)};
      padding-right: ${_e.spacing(1)};
    `});function ue(_e){const{duration:et,nameColumnWidth:st,numTicks:pt,onCollapseAll:Wt,onCollapseOne:Xt,onColummWidthChange:dn,onExpandAll:In,onExpandOne:Hn,updateViewRangeTime:ra,updateNextViewRangeTime:Ba,viewRangeTime:wa,columnResizeHandleHeight:Ua}=_e,[Za,cs]=wa.current,Ya=(0,f.of)(de);return a.createElement(W,{className:Ya.TimelineHeaderRow,"data-testid":"TimelineHeaderRow"},a.createElement(W.Cell,{className:Ya.TimelineHeaderWrapper,width:st},a.createElement("h4",{className:Ya.TimelineHeaderRowTitle},"Service & Operation"),a.createElement(G,{onCollapseAll:Wt,onExpandAll:In,onCollapseOne:Xt,onExpandOne:Hn})),a.createElement(W.Cell,{width:1-st},a.createElement(ie,{boundsInvalidator:st,updateNextViewRangeTime:Ba,updateViewRangeTime:ra,viewRangeTime:wa}),a.createElement(w,{numTicks:pt,startTime:Za*et,endTime:cs*et,showLabels:!0})),a.createElement(oe,{columnResizeHandleHeight:Ua,position:st,onChange:dn,min:.2,max:.85}))}var fe=e(2543),Se=e(41811),he=e(27746);const ce="peer.service";var me=e(30700);class pe{constructor(et){this.ys=[],this.heights=[],this.bufferLen=et,this.dataLen=-1,this.lastI=-1}profileData(et){et!==this.dataLen&&(this.dataLen=et,this.ys.length=et,this.heights.length=et,this.lastI>=et&&(this.lastI=et-1))}calcHeights(et,st,pt){pt!=null&&(this.lastI=pt);let Wt=et+this.bufferLen;if(Wt<=this.lastI)return;Wt>=this.heights.length&&(Wt=this.heights.length-1);let Xt=this.lastI;for(this.lastI===-1&&(Xt=0,this.ys[0]=0);Xt<=Wt;){const dn=this.heights[Xt]=st(Xt);this.ys[Xt+1]=this.ys[Xt]+dn,Xt++}this.lastI=Wt}calcYs(et,st){for(;(this.ys[this.lastI]==null||et>this.ys[this.lastI])&&this.lastI<this.dataLen-1;)this.calcHeights(this.lastI,st)}confirmHeight(et,st){let pt=et;if(pt>this.lastI){this.calcHeights(pt,st);return}const Wt=st(pt);if(Wt===this.heights[pt])return;const Xt=Wt-this.heights[pt];for(this.heights[pt]=Wt;++pt<=this.lastI;)this.ys[pt]+=Xt;this.ys[this.lastI+1]!=null&&(this.ys[this.lastI+1]+=Xt)}findFloorIndex(et,st){this.calcYs(et,st);let pt=0,Wt=this.lastI;if(this.ys.length<2||et<this.ys[1])return 0;if(et>this.ys[Wt])return Wt;let Xt;for(;pt<Wt;)if(Xt=pt+.5*(Wt-pt)|0,et>this.ys[Xt]){if(et<=this.ys[Xt+1])return Xt;pt=Xt}else if(et<this.ys[Xt]){if(et>=this.ys[Xt-1])return Xt-1;Wt=Xt}else return Xt;throw new Error(`unable to find floor index for y=${et}`)}getRowPosition(et,st){return this.confirmHeight(et,st),{height:this.heights[et],y:this.ys[et]}}getEstimatedHeight(){const et=this.ys[this.lastI]+this.heights[this.lastI];return this.lastI>=this.dataLen-1?et|0:et/(this.lastI+1)*this.heights.length|0}}const ye=100;class Pe extends a.Component{constructor(et){super(et),this.getViewHeight=()=>this._viewHeight,this.getBottomVisibleIndex=()=>{const st=this._scrollTop+this._viewHeight;return this._yPositions.findFloorIndex(st,this._getHeight)},this.getTopVisibleIndex=()=>this._yPositions.findFloorIndex(this._scrollTop,this._getHeight),this.getRowPosition=st=>this._yPositions.getRowPosition(st,this._getHeight),this.scrollToIndex=(st,pt)=>{const{scrollElement:Wt}=this.props,Xt=Wt?.getBoundingClientRect().top||0,In=(Wt?.scrollTop||0)+(this._itemHolderElm?.getBoundingClientRect().top||0)-Xt,Hn=this.getRowPosition(st).y;this.props.scrollElement?.scrollTo({top:Hn+In-pt-80})},this._onScroll=()=>{this._isScrolledOrResized||(this._isScrolledOrResized=!0,window.requestAnimationFrame(this._positionList))},this._positionList=()=>{if(this._isScrolledOrResized=!1,!this._wrapperElm)return;this._calcViewIndexes();const st=this.props.viewBufferMin>this._startIndex?0:this._startIndex-this.props.viewBufferMin,pt=this.props.viewBufferMin<this.props.dataLength-this._endIndex?this._endIndex+this.props.viewBufferMin:this.props.dataLength-1;(st<this._startIndexDrawn||pt>this._endIndexDrawn)&&this.forceUpdate()},this._initWrapper=st=>{this.props.windowScroller&&(this._wrapperElm=st,st&&(this._viewHeight=st.clientHeight))},this._initItemHolder=st=>{this._itemHolderElm=st,this._scanItemHeights()},this._scanItemHeights=()=>{const st=this.props.getIndexFromKey;if(!this._itemHolderElm)return;let pt=null,Wt=null,Xt=!1;const dn=this._itemHolderElm.childNodes,In=dn.length;for(let Hn=0;Hn<In;Hn++){const ra=dn[Hn];if(ra instanceof HTMLElement){const Ba=ra.getAttribute("data-item-key");if(!Ba){console.warn("itemKey not found");continue}const Ua=(ra.firstElementChild||ra).clientHeight,Za=this._knownHeights.get(Ba);Ua!==Za&&(this._knownHeights.set(Ba,Ua),Xt?Wt=Ba:(Xt=!0,pt=Wt=Ba))}}if(pt!=null&&Wt!=null){const Hn=st(pt),ra=Wt===pt?Hn:st(Wt);this._yPositions.calcHeights(ra,this._getHeight,Hn),this.forceUpdate()}},this._getHeight=st=>{const pt=this.props.getKeyFromIndex(st),Wt=this._knownHeights.get(pt);return Wt!=null&&Wt===Wt?Wt:this.props.itemHeightGetter(st,pt)},this._yPositions=new pe(200),this._knownHeights=new Map,this._startIndexDrawn=2**20,this._endIndexDrawn=-(2**20),this._startIndex=0,this._endIndex=0,this._viewHeight=-1,this._scrollTop=-1,this._isScrolledOrResized=!1,this._htmlTopOffset=-1,this._windowScrollListenerAdded=!1,this._htmlElm=document.documentElement,this._wrapperElm=void 0,this._itemHolderElm=void 0}static{this.defaultProps={initialDraw:ye,itemsWrapperClassName:"",windowScroller:!1}}componentDidMount(){if(this.props.windowScroller){if(this._wrapperElm){const{top:et}=this._wrapperElm.getBoundingClientRect();this._htmlTopOffset=et+this._htmlElm.scrollTop}window.addEventListener("scroll",this._onScroll),this._windowScrollListenerAdded=!0}else this._wrapperElm=this.props.scrollElement,this._wrapperElm?.addEventListener("scroll",this._onScroll)}componentDidUpdate(et){this._itemHolderElm&&this._scanItemHeights(),!this.props.windowScroller&&et.scrollElement!==this.props.scrollElement&&(et.scrollElement?.removeEventListener("scroll",this._onScroll),this._wrapperElm=this.props.scrollElement,this._wrapperElm?.addEventListener("scroll",this._onScroll))}componentWillUnmount(){this._windowScrollListenerAdded?window.removeEventListener("scroll",this._onScroll):this._wrapperElm?.removeEventListener("scroll",this._onScroll)}_isViewChanged(){if(!this._wrapperElm)return!1;const et=this.props.windowScroller,st=et?this._htmlElm.clientHeight:this._wrapperElm.clientHeight,pt=et?this._htmlElm.scrollTop:this._wrapperElm.scrollTop;return st!==this._viewHeight||pt!==this._scrollTop}_calcViewIndexes(){if(this.props.windowScroller)this._viewHeight=window.innerHeight-this._htmlTopOffset,this._scrollTop=window.scrollY;else{if(!this._wrapperElm){this._viewHeight=-1,this._startIndex=0,this._endIndex=0;return}this._viewHeight=this._wrapperElm.clientHeight,this._scrollTop=this._wrapperElm.scrollTop}const st=this._scrollTop,pt=this._scrollTop+this._viewHeight;this._startIndex=this._yPositions.findFloorIndex(st,this._getHeight),this._endIndex=this._yPositions.findFloorIndex(pt,this._getHeight)}render(){const{dataLength:et,getKeyFromIndex:st,initialDraw:pt=ye,itemRenderer:Wt,viewBuffer:Xt,viewBufferMin:dn}=this.props,In=this._getHeight,Hn=[];let ra,Ba;if(this._yPositions.profileData(et),!this._wrapperElm)ra=0,Ba=(pt<et?pt:et)-1;else{this._isViewChanged()&&this._calcViewIndexes();const Za=dn>this._startIndex?0:this._startIndex-dn,cs=dn<et-this._endIndex?this._endIndex+dn:et-1;Za<this._startIndexDrawn||cs>this._endIndexDrawn?(ra=Xt>this._startIndex?0:this._startIndex-Xt,Ba=this._endIndex+Xt,Ba>=et&&(Ba=et-1)):(ra=this._startIndexDrawn>et-1?0:this._startIndexDrawn,Ba=this._endIndexDrawn>et-1?et-1:this._endIndexDrawn)}this._yPositions.calcHeights(Ba,In,ra||-1),this._startIndexDrawn=ra,this._endIndexDrawn=Ba,Hn.length=Ba-ra+1;for(let Za=ra;Za<=Ba;Za++){const{y:cs,height:Ya}=this._yPositions.getRowPosition(Za,In),Ks={height:Ya,top:cs,position:"absolute"},Ge=st(Za),Re={"data-item-key":Ge};Hn.push(Wt(Ge,Ks,Za,Re))}const wa={style:{position:"relative"},ref:this._initWrapper};this.props.windowScroller||(wa.onScroll=this._onScroll,wa.style.height="100%",wa.style.overflowY="auto");const Ua={position:"relative",height:this._yPositions.getEstimatedHeight()};return a.createElement("div",{...wa,"data-testid":"ListView"},a.createElement("div",{style:Ua},a.createElement("div",{style:{position:"absolute",top:0,margin:0,padding:0},className:this.props.itemsWrapperClassName,ref:this._initItemHolder},Hn)))}}const Ie="None",Oe="Duration",Ne="Tag";function We({options:_e,onOptionsChange:et}){const st=useStyles2(Ue),pt=[Ie,Oe,Ne].map(toOption);return React.createElement("div",{className:css({width:"100%"})},React.createElement(InlineFieldRow,{className:st.row},React.createElement(InlineField,{label:"Label",labelWidth:26,tooltip:"Default: duration",grow:!0},React.createElement(Select,{inputId:"label",options:pt,value:_e.jsonData.spanBar?.type||"",onChange:Wt=>{updateDatasourcePluginJsonDataOption({onOptionsChange:et,options:_e},"spanBar",{..._e.jsonData.spanBar,type:Wt?.value??""})},placeholder:"Duration",isClearable:!0,"aria-label":"select-label-name",width:40}))),_e.jsonData.spanBar?.type===Ne&&React.createElement(InlineFieldRow,{className:st.row},React.createElement(InlineField,{label:"Tag key",labelWidth:26,tooltip:"Tag key which will be used to get the tag value. A span's attributes and resources will be searched for the tag key"},React.createElement(Input,{type:"text",placeholder:"Enter tag key",onChange:Wt=>updateDatasourcePluginJsonDataOption({onOptionsChange:et,options:_e},"spanBar",{..._e.jsonData.spanBar,tag:Wt.currentTarget.value}),value:_e.jsonData.spanBar?.tag||"",width:40}))))}const Ae=({options:_e,onOptionsChange:et})=>{let st=_e.type;return st+=_e.type==="tempo"?"/configure-tempo-data-source/#span-bar":"/#span-bar",React.createElement(ConfigSubSection,{title:"Span bar",description:React.createElement(ConfigDescriptionLink,{description:"Add additional info next to the service and operation on a span bar row in the trace view.",suffix:st,feature:"the span bar"})},React.createElement(We,{options:_e,onOptionsChange:et}))},Ue=_e=>({infoText:css({label:"infoText",paddingBottom:_e.spacing(2),color:_e.colors.text.secondary}),row:css({label:"row",alignItems:"baseline"})});var Me=e(14578),$e=e(13544),ke=e(56034),Ze=e(95868),ot=e(13840);function xt({children:_e,content:et,overlayClassName:st}){const pt=(0,a.useRef)(null);return a.createElement(Ze.I,{content:et,hideAfter:300},(Wt,Xt,dn)=>a.createElement(a.Fragment,null,pt.current&&a.createElement(ot.A,{...dn,referenceElement:pt.current,wrapperClassName:st,onMouseLeave:Xt,onMouseEnter:Wt}),a.cloneElement(_e,{ref:pt,onMouseEnter:Wt,onMouseLeave:Xt})))}const ct="label";var ft=e(55852);const Le=()=>({CopyIcon:(0,n.css)`
      background-color: transparent;
      border: none;
      color: inherit;
      height: 100%;
      overflow: hidden;
      &:focus {
        background-color: rgba(255, 255, 255, 0.25);
        color: inherit;
      }
    `});function re({copyText:_e,icon:et="copy",tooltipTitle:st}){const pt=(0,f.of)(Le),[Wt,Xt]=(0,a.useState)(!1),dn=()=>{navigator.clipboard.writeText(_e),Xt(!0)};return a.createElement(ke.m,{content:Wt?"Copied":st},a.createElement(ft.$n,{className:y()(pt.CopyIcon),type:"button",icon:et,onClick:dn}))}var X=e(72834),le=e.n(X);const be="copyIcon",De=_e=>({KeyValueTable:(0,n.css)`
      label: KeyValueTable;
      background: ${(0,d.R)(_e,"#fff")};
      border: 1px solid ${(0,d.R)(_e,"#ddd")};
      margin-bottom: 0.5rem;
      max-height: 450px;
      overflow: auto;
    `,table:(0,n.css)({width:"100%"}),body:(0,n.css)`
      label: body;
      vertical-align: baseline;
    `,row:(0,n.css)`
      label: row;
      & > td {
        padding: 0rem 0.5rem;
        height: 30px;
      }
      &:nth-child(2n) > td {
        background: ${(0,d.R)(_e,"#f5f5f5")};
      }
      &:not(:hover) .${be} {
        visibility: hidden;
      }
    `,keyColumn:(0,n.css)`
      label: keyColumn;
      color: ${(0,d.R)(_e,"#888")};
      white-space: pre;
      width: 125px;
    `,copyColumn:(0,n.css)`
      label: copyColumn;
      text-align: right;
    `,linkIcon:(0,n.css)`
      label: linkIcon;
      vertical-align: middle;
      font-weight: bold;
    `,jsonTable:(0,n.css)({display:"inline-block"})}),Te=/^(\[|\{)/;function we(_e){if(typeof _e=="string"&&Te.test(_e))try{return JSON.parse(_e)}catch{}return _e}const Ke=({href:_e,title:et="",children:st})=>a.createElement("a",{href:_e,title:et,target:"_blank",rel:"noopener noreferrer"},st," ",a.createElement(Me.I,{name:"external-link-alt"}));function Ve(_e){const{data:et,linksGetter:st}=_e,pt=(0,f.of)(De);return a.createElement("div",{className:y()(pt.KeyValueTable),"data-testid":"KeyValueTable"},a.createElement("table",{className:pt.table},a.createElement("tbody",{className:pt.body},et.map((Wt,Xt)=>{const dn={__html:le()(we(Wt.value))},In=a.createElement("div",{className:pt.jsonTable,dangerouslySetInnerHTML:dn}),Hn=st?st(et,Xt):null;let ra;return Hn&&Hn.length?ra=a.createElement("div",null,a.createElement(Ke,{href:Hn[0].url,title:Hn[0].text},In)):ra=In,a.createElement("tr",{className:pt.row,key:`${Wt.key}-${Xt}`},a.createElement("td",{className:pt.keyColumn,"data-testid":"KeyValueTable--keyColumn"},Wt.key),a.createElement("td",null,ra),a.createElement("td",{className:pt.copyColumn},a.createElement(re,{className:be,copyText:JSON.stringify(Wt,null,2),tooltipTitle:"Copy JSON"})))}))))}var ht=e(11908),gt=e(72724),bt=e(12131),St=e(14689),Je=e(25994),rt=e(21744),Rt=e(19071),_t=e(28114);const nn=_e=>et=>({LabeledList:(0,n.css)`
      label: LabeledList;
      list-style: none;
      margin: 0;
      padding: 0;
      ${_e&&`
        margin-right: -8px;
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-end;
      `}
    `,LabeledListItem:(0,n.css)`
      label: LabeledListItem;
      display: inline-block;
      ${_e&&`
        border-right: 1px solid ${(0,d.R)(et,"#ddd")};
        padding: 0 8px;
      `}
    `,LabeledListLabel:(0,n.css)`
      label: LabeledListLabel;
      color: ${et.isLight?"#999":"#666"};
      margin-right: 0.25rem;
    `,LabeledListValue:(0,n.css)`
      label: LabeledListValue;
      ${!_e&&"margin-right: 0.55rem;"}
    `});function Kt(_e){const{className:et,divider:st=!1,items:pt}=_e,Wt=(0,f.of)(nn(st));return a.createElement("ul",{className:y()(Wt.LabeledList,et)},pt.map(({key:Xt,label:dn,value:In})=>a.createElement("li",{className:Wt.LabeledListItem,key:`${Xt}`},a.createElement("span",{className:Wt.LabeledListLabel},dn),a.createElement("strong",{className:Wt.LabeledListValue},In))))}const en="kind",Qt="status",An="status.message",un="library.name",fn="library.version",Tt="trace.state",$t="id";var Yt=e(92102);function Cn(_e){const{reference:et,children:st,createFocusSpanLink:pt}=_e,Wt=pt(et.traceID,et.spanID);return a.createElement("a",{href:Wt.href,target:Wt.target,rel:"noopener noreferrer",onClick:Wt.onClick?Xt=>{Xt.preventDefault(),Wt.onClick(Xt)}:void 0},st)}const Tn=_e=>({AccordianReferenceItem:(0,n.css)`
      border-bottom: 1px solid ${(0,d.R)(_e,"#d8d8d8")};
    `,AccordianKeyValues:(0,n.css)`
      margin-left: 10px;
    `,AccordianReferences:(0,n.css)`
      label: AccordianReferences;
      border: 1px solid ${(0,d.R)(_e,"#d8d8d8")};
      position: relative;
      margin-bottom: 0.25rem;
    `,AccordianReferencesHeader:(0,n.css)`
      label: AccordianReferencesHeader;
      background: ${(0,d.R)(_e,"#e4e4e4")};
      color: inherit;
      display: block;
      padding: 0.25rem 0.5rem;
      &:hover {
        background: ${(0,d.R)(_e,"#dadada")};
      }
    `,AccordianReferencesContent:(0,n.css)`
      label: AccordianReferencesContent;
      background: ${(0,d.R)(_e,"#f0f0f0")};
      border-top: 1px solid ${(0,d.R)(_e,"#d8d8d8")};
      padding: 0.5rem 0.5rem 0.25rem 0.5rem;
    `,AccordianReferencesFooter:(0,n.css)`
      label: AccordianReferencesFooter;
      color: ${(0,d.R)(_e,"#999")};
    `,AccordianKeyValuesItem:(0,n.css)({marginBottom:_e.spacing(.5)}),ReferencesList:(0,n.css)`
      background: #fff;
      border: 1px solid #ddd;
      margin-bottom: 0.7em;
      max-height: 450px;
      overflow: auto;
    `,list:(0,n.css)`
      width: 100%;
      list-style: none;
      padding: 0;
      margin: 0;
      background: #fff;
    `,itemContent:(0,n.css)`
      padding: 0.25rem 0.5rem;
      display: flex;
      width: 100%;
      justify-content: space-between;
    `,item:(0,n.css)`
      &:nth-child(2n) {
        background: #f5f5f5;
      }
    `,debugInfo:(0,n.css)`
      letter-spacing: 0.25px;
      margin: 0.5em 0 0;
      flex-wrap: wrap;
      display: flex;
      justify-content: flex-end;
    `,debugLabel:(0,n.css)`
      margin: 0 5px 0 5px;
      &::before {
        color: #bbb;
        content: attr(data-label);
      }
    `,serviceName:(0,n.css)`
      margin-right: 8px;
    `,title:(0,n.css)`
      display: flex;
      align-items: center;
      gap: 4px;
    `});function vn(_e){const{data:et,createFocusSpanLink:st,openedItems:pt,onItemToggle:Wt,interactive:Xt}=_e,dn=(0,f.of)(Tn);return a.createElement("div",{className:dn.AccordianReferencesContent},et.map((In,Hn)=>a.createElement("div",{className:Hn<et.length-1?dn.AccordianReferenceItem:void 0,key:Hn},a.createElement("div",{className:dn.item,key:`${In.spanID}`},a.createElement(Cn,{reference:In,createFocusSpanLink:st},a.createElement("span",{className:dn.itemContent},In.span?a.createElement("span",null,a.createElement("span",{className:(0,n.cx)("span-svc-name",dn.serviceName)},In.span.process.serviceName),a.createElement("small",{className:"endpoint-name"},In.span.operationName)):a.createElement("span",{className:(0,n.cx)("span-svc-name",dn.title)},"View Linked Span ",a.createElement(Me.I,{name:"external-link-alt"})),a.createElement("small",{className:dn.debugInfo},a.createElement("span",{className:dn.debugLabel,"data-label":"TraceID:"},In.traceID),a.createElement("span",{className:dn.debugLabel,"data-label":"SpanID:"},In.spanID))))),!!In.tags?.length&&a.createElement("div",{className:dn.AccordianKeyValues},a.createElement(Qn,{className:Hn<et.length-1?dn.AccordianKeyValuesItem:null,data:In.tags||[],highContrast:!0,interactive:Xt,isOpen:pt?pt.has(In):!1,label:"attributes",linksGetter:null,onToggle:Xt&&Wt?()=>Wt(In):null})))))}const Kn=({data:_e,interactive:et=!0,isOpen:st,onToggle:pt,onItemToggle:Wt,openedItems:Xt,createFocusSpanLink:dn})=>{const In=!Array.isArray(_e)||!_e.length;let Hn=null,ra="span",Ba=null;et&&(Hn=st?a.createElement(Me.I,{name:"angle-down",className:Ht}):a.createElement(Me.I,{name:"angle-right",className:Ht}),ra="a",Ba={"aria-checked":st,onClick:In?null:pt,role:"switch"});const wa=(0,f.of)(Tn);return a.createElement("div",{className:wa.AccordianReferences},a.createElement(ra,{className:wa.AccordianReferencesHeader,...Ba},Hn,a.createElement("strong",null,a.createElement("span",null,"References"))," ","(",_e.length,")"),st&&a.createElement(vn,{data:_e,openedItems:Xt,createFocusSpanLink:dn,onItemToggle:Wt,interactive:et}))},Yn=a.memo(Kn),nt=()=>({TextList:(0,n.css)`
      max-height: 450px;
      overflow: auto;
    `,List:(0,n.css)`
      width: 100%;
      list-style: none;
      padding: 0;
      margin: 0;
    `,item:(0,n.css)`
      padding: 0.25rem 0.5rem;
      vertical-align: top;
      &:nth-child(2n) {
        background: #f5f5f5;
      }
    `});function yt(_e){const{data:et}=_e,st=(0,f.of)(nt);return a.createElement("div",{className:y()(st.TextList),"data-testid":"TextList"},a.createElement("ul",{className:st.List},et.map((pt,Wt)=>a.createElement("li",{className:st.item,key:`${Wt}`},pt))))}const Vt=_e=>({header:(0,n.css)`
      cursor: pointer;
      overflow: hidden;
      padding: 0.25em 0.1em;
      text-overflow: ellipsis;
      white-space: nowrap;
      &:hover {
        background: ${(0,d.R)(_e,"#e8e8e8")};
      }
    `});function je({data:_e}){return a.createElement(yt,{data:_e})}function tt({className:_e=null,data:et,headerClassName:st,highContrast:pt=!1,interactive:Wt=!0,isOpen:Xt,label:dn,onToggle:In=null,TextComponent:Hn=je}){const ra=!Array.isArray(et)||!et.length,Ba=(0,f.of)(Xe),wa=y()(Ht,{[Ba.emptyIcon]:ra});let Ua=null,Za=null;Wt&&(Ua=Xt?a.createElement(Me.I,{name:"angle-down",className:wa}):a.createElement(Me.I,{name:"angle-right",className:wa}),Za={"aria-checked":Xt,onClick:ra?null:In,role:"switch"});const cs=(0,f.of)(Vt);return a.createElement("div",{className:_e||""},a.createElement("div",{className:y()(cs.header,st),...Za,"data-testid":"AccordianText--header"},Ua,a.createElement("strong",null,dn)," (",et.length,")"),Xt&&a.createElement(Hn,{data:et}))}var Dt=e(49185),Ot=e(75505),Lt=e(47232),Gt=e(41987),hn=e(85194),mt=e(26657),Bt=e(72574),Jt=e(31193);function Rn(_e){const{span:et,traceToProfilesOptions:st,timeZone:pt,traceFlameGraphs:Wt,setTraceFlameGraphs:Xt,setRedrawListView:dn,traceDuration:In,traceName:Hn}=_e,[ra,{height:Ba}]=(0,Dt.A)(),wa=(0,f.of)(Mt),Ua=et.tags.filter(Ge=>Ge.key===_t.QW),Za=Ua.length>0?Ua[0].value:void 0,cs=(0,a.useCallback)(()=>{const Ge=Math.floor(et.startTime/1e3)-3e4,Re=(et.startTime+et.duration)/1e3+3e4,qe=(0,Lt.KQ)(Re),ut=(0,Lt.KQ)(Ge);return{from:ut,to:qe,raw:{from:ut,to:qe}}},[et.duration,et.startTime]),Ya=async(Ge,Re)=>{const qe=await(0,Jt.tR)().get(Re);if(qe instanceof mt.iy){const Ft=(await(0,Ot.s)(qe.query(Ge))).data.find(on=>on.name==="response");if(Ft&&Ft.length>1)return Ft}},Ks=(0,a.useCallback)(async(Ge,Re,qe)=>{let ut="{}";if(Re.customQuery&&Re.query){const sn={...(0,_t.gt)(In,Hn,qe.traceID),...(0,_t.hv)(qe),...(0,_t.Cr)(qe,Re)};ut=(0,Bt.w)().replace(Re.query,sn)}else{const sn=Re.tags&&Re.tags.length>0?Re.tags:_t.i0;ut=`{${(0,_t._o)(qe,sn)}}`}const Ft={requestId:"span-flamegraph-requestId",interval:"2s",intervalMs:2e3,range:cs(),scopedVars:{},app:Gt.Jk.Unknown,timezone:pt,startTime:qe.startTime,targets:[{labelSelector:ut,groupBy:[],profileTypeId:Re.profileTypeId??"",queryType:"profile",spanSelector:[Za],refId:"span-flamegraph-refId",datasource:{type:Ge.type,uid:Ge.uid}}]},on=await Ya(Ft,Ge.uid);on&&on.length>0&&Xt({...Wt,[Za]:on})},[cs,Za,Xt,pt,In,Wt,Hn]);return(0,a.useEffect)(()=>{if(!Object.keys(Wt).includes(Za)){let Ge;st&&st?.datasourceUid&&(Ge=(0,Jt.tR)().getInstanceSettings(st.datasourceUid)),st&&Ge&&Ks(Ge,st,et)}},[Xt,et,Wt,st,cs,pt,Ks,Za]),(0,a.useEffect)(()=>{dn({})},[Ba,dn]),Wt[Za]?a.createElement("div",{className:wa.flameGraph,ref:ra},a.createElement("div",{className:wa.flameGraphTitle},"Flame graph"),a.createElement(hn.A,{data:Wt[Za],getTheme:()=>r.$.theme2,showFlameGraphOnly:!0,disableCollapsing:!0})):a.createElement(a.Fragment,null)}const Mt=()=>({flameGraph:(0,n.css)({label:"flameGraphInSpan",margin:"5px"}),flameGraphTitle:(0,n.css)({label:"flameGraphTitleInSpan",marginBottom:"5px",fontWeight:"bold"})}),wt=_e=>({header:(0,n.css)`
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 0 1rem;
      margin-bottom: 0.25rem;
    `,listWrapper:(0,n.css)`
      overflow: hidden;
    `,list:(0,n.css)({textAlign:"right"}),operationName:(0,n.css)({margin:0}),debugInfo:(0,n.css)`
      label: debugInfo;
      display: block;
      letter-spacing: 0.25px;
      margin: 0.5em 0 -0.75em;
      text-align: right;
    `,debugLabel:(0,n.css)`
      label: debugLabel;
      &::before {
        color: ${(0,d.R)(_e,"#bbb")};
        content: attr(data-label);
      }
    `,debugValue:(0,n.css)`
      label: debugValue;
      background-color: inherit;
      border: none;
      color: ${(0,d.R)(_e,"#888")};
      cursor: pointer;
      &:hover {
        color: ${(0,d.R)(_e,"#333")};
      }
    `,AccordianWarnings:(0,n.css)`
      label: AccordianWarnings;
      background: ${(0,d.R)(_e,"#fafafa")};
      border: 1px solid ${(0,d.R)(_e,"#e4e4e4")};
      margin-bottom: 0.25rem;
    `,AccordianWarningsHeader:(0,n.css)`
      label: AccordianWarningsHeader;
      background: ${(0,d.R)(_e,"#fff7e6")};
      padding: 0.25rem 0.5rem;
      &:hover {
        background: ${(0,d.R)(_e,"#ffe7ba")};
      }
    `,AccordianWarningsHeaderOpen:(0,n.css)`
      label: AccordianWarningsHeaderOpen;
      border-bottom: 1px solid ${(0,d.R)(_e,"#e8e8e8")};
    `,AccordianWarningsLabel:(0,n.css)`
      label: AccordianWarningsLabel;
      color: ${(0,d.R)(_e,"#d36c08")};
    `,AccordianKeyValuesItem:(0,n.css)({marginBottom:_e.spacing(.5)}),Textarea:(0,n.css)`
      word-break: break-all;
      white-space: pre;
    `,LinkIcon:(0,n.css)`
      font-size: 1.5em;
    `}),Ht=(0,n.css)({margin:"-0.2rem 0.25rem 0 0"});function tn(_e){const{detailState:et,linksGetter:st,logItemToggle:pt,logsToggle:Wt,processToggle:Xt,span:dn,tagsToggle:In,traceStartTime:Hn,traceDuration:ra,traceName:Ba,warningsToggle:wa,stackTracesToggle:Ua,referencesToggle:Za,referenceItemToggle:cs,createSpanLink:Ya,createFocusSpanLink:Ks,datasourceType:Ge,traceFlameGraphs:Re,setTraceFlameGraphs:qe,traceToProfilesOptions:ut,setRedrawListView:Ft}=_e,{isTagsOpen:on,isProcessOpen:sn,logs:Ln,isWarningsOpen:qn,references:na,isStackTracesOpen:Sa}=et,{operationName:ka,process:Da,duration:ds,relativeStartTime:Xa,startTime:qs,traceID:Cs,spanID:Ss,logs:fa,tags:Fa,warnings:Na,references:Is,stackTraces:pr}=dn,{timeZone:ir}=_e;let fo=[{key:"svc",label:"Service:",value:Da.serviceName},{key:"duration",label:"Duration:",value:(0,p.a3)(ds)},{key:"start",label:"Start Time:",value:(0,p.a3)(Xa)+It(qs,ir)},...dn.childSpanCount>0?[{key:"child_count",label:"Child Count:",value:dn.childSpanCount}]:[]];const ss=(0,f.of)(wt);dn.kind&&fo.push({key:en,label:"Kind:",value:dn.kind}),dn.statusCode!==void 0&&fo.push({key:Qt,label:"Status:",value:ht.s[dn.statusCode].toLowerCase()}),dn.statusMessage&&fo.push({key:An,label:"Status Message:",value:dn.statusMessage}),dn.instrumentationLibraryName&&fo.push({key:un,label:"Library Name:",value:dn.instrumentationLibraryName}),dn.instrumentationLibraryVersion&&fo.push({key:fn,label:"Library Version:",value:dn.instrumentationLibraryVersion}),dn.traceState&&fo.push({key:Tt,label:"Trace State:",value:dn.traceState});const wo=(Or,mi,ii,Li)=>a.createElement(St.R,{link:{...Or,title:ii,target:"_blank",origin:Or.field,onClick:_c=>{(0,o.rR)("grafana_traces_trace_view_span_link_clicked",{datasourceType:Ge,grafana_version:r.$.buildInfo.version,type:mi,location:"spanDetails"}),Or.onClick?Or.onClick?.(_c):bt.Ny.push(Or.href)}},buttonProps:{icon:Li}});let ui=null,Sl=null;if(Ya){const Or=Ya(dn),mi=Or?.filter(Li=>Li.type===Yt.N.Logs);Or&&mi&&mi.length>0&&(ui=wo(mi[0],Yt.N.Logs,"Logs for this span","gf-logs"));const ii=Or?.filter(Li=>Li.type===Yt.N.Profiles&&Li.title===Rt.cd);Or&&ii&&ii.length>0&&(Sl=wo(ii[0],Yt.N.Profiles,"Profiles for this span","link"))}const _o=Ks(Cs,Ss);return a.createElement("div",{"data-testid":"span-detail-component"},a.createElement("div",{className:ss.header},a.createElement("h2",{className:ss.operationName},ka),a.createElement("div",{className:ss.listWrapper},a.createElement(Kt,{className:ss.list,divider:!0,items:fo}))),a.createElement("span",{style:{marginRight:"10px"}},ui),Sl,a.createElement(Je.c,{spacing:1}),a.createElement("div",null,a.createElement("div",null,a.createElement(Qn,{data:Fa,label:"Span Attributes",linksGetter:st,isOpen:on,onToggle:()=>In(Ss)}),Da.tags&&a.createElement(Qn,{className:ss.AccordianKeyValuesItem,data:Da.tags,label:"Resource Attributes",linksGetter:st,isOpen:sn,onToggle:()=>Xt(Ss)})),fa&&fa.length>0&&a.createElement(wn,{linksGetter:st,logs:fa,isOpen:Ln.isOpen,openedItems:Ln.openedItems,onToggle:()=>Wt(Ss),onItemToggle:Or=>pt(Ss,Or),timestamp:Hn}),Na&&Na.length>0&&a.createElement(tt,{className:ss.AccordianWarnings,headerClassName:ss.AccordianWarningsHeader,label:a.createElement("span",{className:ss.AccordianWarningsLabel},"Warnings"),data:Na,isOpen:qn,onToggle:()=>wa(Ss)}),pr?.length?a.createElement(tt,{label:"Stack trace",data:pr,isOpen:Sa,TextComponent:Or=>{let mi;return Or.data?.length>1?mi=Or.data.map((ii,Li)=>`StackTrace ${Li+1}:
${ii}`).join(`
`):mi=Or.data?.[0],a.createElement(rt.f,{className:ss.Textarea,style:{cursor:"unset"},readOnly:!0,cols:10,rows:10,value:mi})},onToggle:()=>Ua(Ss)}):null,Is&&Is.length>0&&(Is.length>1||Is[0].refType!=="CHILD_OF")&&a.createElement(Yn,{data:Is,isOpen:na.isOpen,openedItems:na.openedItems,onToggle:()=>Za(Ss),onItemToggle:Or=>cs(Ss,Or),createFocusSpanLink:Ks}),dn.tags.some(Or=>Or.key===_t.QW)&&a.createElement(Rn,{span:dn,timeZone:ir,traceFlameGraphs:Re,setTraceFlameGraphs:qe,traceToProfilesOptions:ut,setRedrawListView:Ft,traceDuration:ra,traceName:Ba}),a.createElement("small",{className:ss.debugInfo},a.createElement("a",{..._o,onClick:Or=>{_o.onClick&&Or.button===0&&(!Or.currentTarget.target||Or.currentTarget.target==="_self")&&!(Or.metaKey||Or.altKey||Or.ctrlKey||Or.shiftKey)&&(Or.preventDefault(),_o.onClick(Or))}},a.createElement(Me.I,{name:"link",className:y()(Ht,ss.LinkIcon)})),a.createElement("span",{className:ss.debugLabel,"data-label":"SpanID:"})," ",Ss)))}const It=(_e,et)=>{const st=(0,gt.LE)(_e/1e3,{timeZone:et,defaultWithMS:!0}),pt=st.split(" ");return` (${pt[1]?pt[1]:st})`},Xe=_e=>({container:(0,n.css)({textOverflow:"ellipsis"}),header:(0,n.css)`
      label: header;
      cursor: pointer;
      overflow: hidden;
      padding: 0.25em 0.1em;
      text-overflow: ellipsis;
      white-space: nowrap;
      &:hover {
        background: ${(0,d.R)(_e,"#e8e8e8")};
      }
    `,headerEmpty:(0,n.css)`
      label: headerEmpty;
      background: none;
      cursor: initial;
    `,headerHighContrast:(0,n.css)`
      label: headerHighContrast;
      &:hover {
        background: ${(0,d.R)(_e,"#ddd")};
      }
    `,emptyIcon:(0,n.css)`
      label: emptyIcon;
      color: ${(0,d.R)(_e,"#aaa")};
    `,summary:(0,n.css)`
      label: summary;
      display: inline;
      list-style: none;
      padding: 0;
    `,summaryItem:(0,n.css)`
      label: summaryItem;
      display: inline;
      margin-left: 0.7em;
      padding-right: 0.5rem;
      border-right: 1px solid ${(0,d.R)(_e,"#ddd")};
      &:last-child {
        padding-right: 0;
        border-right: none;
      }
    `,summaryLabel:(0,n.css)`
      label: summaryLabel;
      color: ${(0,d.R)(_e,"#777")};
    `,summaryDelim:(0,n.css)`
      label: summaryDelim;
      color: ${(0,d.R)(_e,"#bbb")};
      padding: 0 0.2em;
    `});function jn({data:_e=null}){const et=(0,f.of)(Xe);return!Array.isArray(_e)||!_e.length?null:a.createElement("ul",{className:et.summary},_e.map((st,pt)=>a.createElement("li",{className:et.summaryItem,key:`${st.key}-${pt}`},a.createElement("span",{className:et.summaryLabel},st.key),a.createElement("span",{className:et.summaryDelim},"="),String(st.value))))}function Qn({className:_e=null,data:et,highContrast:st=!1,interactive:pt=!0,isOpen:Wt,label:Xt,linksGetter:dn,onToggle:In=null}){const Hn=!Array.isArray(et)||!et.length,ra=(0,f.of)(Xe),Ba=y()(Ht,{[ra.emptyIcon]:Hn});let wa=null,Ua=null;return pt&&(wa=Wt?a.createElement(Me.I,{name:"angle-down",className:Ba}):a.createElement(Me.I,{name:"angle-right",className:Ba}),Ua={"aria-checked":Wt,onClick:Hn?null:In,role:"switch"}),a.createElement("div",{className:y()(_e,ra.container)},a.createElement("div",{className:y()(ra.header,{[ra.headerEmpty]:Hn,[ra.headerHighContrast]:st&&!Hn}),...Ua,"data-testid":"AccordianKeyValues--header"},wa,a.createElement("strong",{"data-test":ct},Xt,Wt||":"),!Wt&&a.createElement(jn,{data:et})),Wt&&a.createElement(Ve,{data:et,linksGetter:dn}))}const ia=_e=>({AccordianLogs:(0,n.css)`
      label: AccordianLogs;
      border: 1px solid ${(0,d.R)(_e,"#d8d8d8")};
      position: relative;
      margin-bottom: 0.25rem;
    `,AccordianLogsHeader:(0,n.css)`
      label: AccordianLogsHeader;
      background: ${(0,d.R)(_e,"#e4e4e4")};
      color: inherit;
      display: block;
      padding: 0.25rem 0.5rem;
      &:hover {
        background: ${(0,d.R)(_e,"#dadada")};
      }
    `,AccordianLogsContent:(0,n.css)`
      label: AccordianLogsContent;
      background: ${(0,d.R)(_e,"#f0f0f0")};
      border-top: 1px solid ${(0,d.R)(_e,"#d8d8d8")};
      padding: 0.5rem 0.5rem 0.25rem 0.5rem;
    `,AccordianLogsFooter:(0,n.css)`
      label: AccordianLogsFooter;
      color: ${(0,d.R)(_e,"#999")};
    `,AccordianKeyValuesItem:(0,n.css)({marginBottom:_e.spacing(.5)})});function wn({interactive:_e=!0,isOpen:et,linksGetter:st,logs:pt,openedItems:Wt,onItemToggle:Xt,onToggle:dn,timestamp:In}){let Hn=null,ra="span",Ba=null;_e&&(Hn=et?a.createElement(Me.I,{name:"angle-down",className:Ht}):a.createElement(Me.I,{name:"angle-right",className:"u-align-icon"}),ra="a",Ba={"aria-checked":et,onClick:dn,role:"switch"});const wa=(0,f.of)(ia);return a.createElement("div",{className:wa.AccordianLogs},a.createElement(ra,{className:wa.AccordianLogsHeader,...Ba},Hn," ",a.createElement("strong",null,"Events")," (",pt.length,")"),et&&a.createElement("div",{className:wa.AccordianLogsContent},(0,fe.sortBy)(pt,"timestamp").map((Ua,Za)=>a.createElement(Qn,{key:`${Ua.timestamp}-${Za}`,className:Za<pt.length-1?wa.AccordianKeyValuesItem:null,data:Ua.fields||[],highContrast:!0,interactive:_e,isOpen:Wt?Wt.has(Ua):!1,label:`${(0,p.a3)(Ua.timestamp-In)}`,linksGetter:st,onToggle:_e&&Xt?()=>Xt(Ua):null})),a.createElement("small",{className:wa.AccordianLogsFooter},"Log timestamps are relative to the start time of the full trace.")))}const sa=_e=>({wrapper:(0,n.css)({label:"wrapper",bottom:0,left:0,position:"absolute",right:0,top:0,overflow:"hidden",zIndex:0}),bar:(0,n.css)({label:"bar",borderRadius:_e.shape.radius.default,minWidth:"2px",position:"absolute",height:"36%",top:"32%"}),rpc:(0,n.css)({label:"rpc",position:"absolute",top:"35%",bottom:"35%",zIndex:1}),label:(0,n.css)({label:"label",color:"#aaa",fontSize:"12px",fontFamily:"'Helvetica Neue', Helvetica, Arial, sans - serif",lineHeight:"1em",whiteSpace:"nowrap",padding:"0 0.5em",position:"absolute"}),logMarker:(0,n.css)({label:"logMarker",backgroundColor:(0,d.R)(_e,"#2c3235"),cursor:"pointer",height:"60%",minWidth:"1px",position:"absolute",top:"20%","&:hover":{backgroundColor:(0,d.R)(_e,"#464c54")},"&::before, &::after":{content:"''",position:"absolute",top:0,bottom:0,right:0,border:"1px solid transparent"},"&::after":{left:0}}),criticalPath:(0,n.css)({position:"absolute",top:"45%",height:"11%",zIndex:2,overflow:"hidden",background:(0,d.R)(_e,"#f1f1f1"),borderLeft:`1px solid ${(0,d.R)(_e,"#2c3235")}`,borderRight:`1px solid ${(0,d.R)(_e,"#2c3235")}`})});function La(_e){return`${(_e*100).toFixed(1)}%`}function xa(_e){return`${_e*100}%`}function ga({criticalPath:_e,viewEnd:et,viewStart:st,getViewedBounds:pt,color:Wt,shortLabel:Xt,longLabel:dn,onClick:In,rpc:Hn,traceStartTime:ra,span:Ba,className:wa,labelClassName:Ua}){const[Za,cs]=(0,a.useState)(Xt),Ya=()=>cs(Xt),Ks=()=>cs(dn),Ge=(0,fe.groupBy)(Ba.logs,qe=>{const ut=pt(qe.timestamp,qe.timestamp).start;return La(Math.round(ut*500)/500)}),Re=(0,f.of)(sa);return a.createElement("div",{className:y()(Re.wrapper,wa),onBlur:Ya,onClick:In,onFocus:Ks,onMouseOut:Ya,onMouseOver:Ks,"aria-hidden":!0,"data-testid":$e.Tp.components.TraceViewer.spanBar},a.createElement("div",{"aria-label":Za,className:y()(Re.bar),style:{background:Wt,left:La(st),width:La(et-st)}},a.createElement("div",{className:y()(Re.label,Ua),"data-testid":"SpanBar--label"},Za)),a.createElement("div",null,Object.keys(Ge).map(qe=>a.createElement(xt,{key:qe,content:a.createElement(wn,{interactive:!1,isOpen:!0,logs:Ge[qe],timestamp:ra})},a.createElement("div",{"data-testid":"SpanBar--logMarker",className:y()(Re.logMarker),style:{left:qe}})))),Hn&&a.createElement("div",{className:y()(Re.rpc),style:{background:Hn.color,left:La(Hn.viewStart),width:La(Hn.viewEnd-Hn.viewStart)}}),_e?.map((qe,ut)=>{const Ft=pt(qe.section_start,qe.section_end),on=Ft.start,sn=Ft.end,Ln=`${qe.spanId}-${ut}`;return a.createElement(ke.m,{key:Ln,placement:"top",content:a.createElement("div",null,"A segment on the ",a.createElement("em",null,"critical path")," of the overall trace / request / workflow.")},a.createElement("div",{"data-testid":"SpanBar--criticalPath",className:Re.criticalPath,style:{left:xa(on),width:xa(sn-on)}}))}))}const Ts=a.memo(ga);var Us=e(64539),Bs=e(28122);const ks=(_e,et,st,pt)=>(_e.sort(function(Wt,Xt){return(Wt.title||"link").toLowerCase().localeCompare((Xt.title||"link").toLowerCase())}),_e.map((Wt,Xt)=>a.createElement(Us.D,{key:Xt,label:Wt.title||"Link",onClick:Wt.onClick?dn=>{(0,o.rR)("grafana_traces_trace_view_span_link_clicked",{datasourceType:pt,grafana_version:r.$.buildInfo.version,type:Wt.type,location:"menu"}),dn?.preventDefault(),Wt.onClick(dn),st()}:void 0,url:Wt.href,className:et.menuItem}))),Ms=({links:_e,datasourceType:et,color:st})=>{const pt=(0,f.of)(()=>Dr(st)),[Wt,Xt]=(0,a.useState)(!1),[dn,In]=(0,a.useState)({x:0,y:0}),Hn=()=>Xt(!1);return a.createElement("div",{"data-testid":"SpanLinksMenu",className:pt.wrapper},a.createElement("button",{onClick:ra=>{Xt(!0),In({x:ra.pageX,y:ra.pageY})},className:pt.button},a.createElement(Me.I,{name:"link",className:pt.icon})),Wt?a.createElement(Bs.t,{onClose:()=>Xt(!1),renderMenuItems:()=>ks(_e,pt,Hn,et),focusOnOpen:!1,x:dn.x,y:dn.y}):null)},Dr=_e=>({wrapper:(0,n.css)`
      border: none;
      background: ${_e}10;
      border-bottom: 1px solid ${_e}CF;
      padding-right: 4px;
    `,button:(0,n.css)`
      background: transparent;
      border: none;
      padding: 0;
    `,icon:(0,n.css)`
      background: transparent;
      border: none;
      padding: 0;
    `,menuItem:(0,n.css)`
      max-width: 60ch;
      overflow: hidden;
    `});function _s(_e){return(0,fe.get)((0,fe.find)(_e.references,({span:et,refType:st})=>et&&et.spanID&&(st==="CHILD_OF"||st==="FOLLOWS_FROM")),"span")}function Ir(_e){const et=[];if(!_e)return et;let st=_s(_e);for(;st;)et.push(st.spanID),st=_s(st);return et}const Xs=(0,i.N)(_e=>({SpanTreeOffset:(0,n.css)`
      label: SpanTreeOffset;
      color: ${(0,d.R)(_e,"#000")};
      position: relative;
    `,SpanTreeOffsetParent:(0,n.css)`
      label: SpanTreeOffsetParent;
      &:hover {
        cursor: pointer;
      }
    `,indentGuide:(0,n.css)`
      label: indentGuide;
      /* The size of the indentGuide is based off of the iconWrapper */
      padding-right: 1rem;
      height: 100%;
      display: inline-flex;
      transition: padding 300ms ease-out;
      &::before {
        content: '';
        padding-left: 1px;
        background-color: ${(0,d.R)(_e,"lightgrey")};
      }
    `,indentGuideActive:(0,n.css)`
      label: indentGuideActive;
      &::before {
        background-color: ${(0,d.R)(_e,"#777")};
      }
    `,indentGuideThin:(0,n.css)`
      padding-right: 0.3rem;
    `,iconWrapper:(0,n.css)`
      label: iconWrapper;
      position: absolute;
      right: 0;
    `}));class Gs extends a.PureComponent{constructor(et){super(et),this.handleMouseLeave=(st,pt)=>{(!(st.relatedTarget instanceof HTMLSpanElement)||(0,fe.get)(st,"relatedTarget.dataset.ancestorId")!==pt)&&this.props.removeHoverIndentGuideId(pt)},this.handleMouseEnter=(st,pt)=>{(!(st.relatedTarget instanceof HTMLSpanElement)||(0,fe.get)(st,"relatedTarget.dataset.ancestorId")!==pt)&&this.props.addHoverIndentGuideId(pt)},this.ancestorIds=Ir(et.span),this.ancestorIds.push("root"),this.ancestorIds.reverse()}static{this.displayName="UnthemedSpanTreeOffset"}static{this.defaultProps={childrenVisible:!1,showChildrenIcon:!0}}render(){const{childrenVisible:et,onClick:st,showChildrenIcon:pt,span:Wt,theme:Xt,visibleSpanIds:dn}=this.props,{hasChildren:In,spanID:Hn}=Wt,ra=In?{onClick:st,role:"switch","aria-checked":et}:null,Ba=pt&&In&&(et?a.createElement(Me.I,{name:"angle-down","data-testid":"icon-arrow-down",size:"sm"}):a.createElement(Me.I,{name:"angle-right","data-testid":"icon-arrow-right",size:"sm"})),wa=Xs(Xt);return a.createElement("span",{className:y()(wa.SpanTreeOffset,{[wa.SpanTreeOffsetParent]:In}),...ra},this.ancestorIds.map((Ua,Za)=>a.createElement("span",{key:Ua,className:y()(wa.indentGuide,{[wa.indentGuideActive]:this.props.hoverIndentGuideIds.has(Ua),[wa.indentGuideThin]:Za!==this.ancestorIds.length-1&&Ua!=="root"&&!dn.includes(Ua)}),"data-ancestor-id":Ua,"data-testid":"SpanTreeOffset--indentGuide",onMouseEnter:cs=>this.handleMouseEnter(cs,Ua),onMouseLeave:cs=>this.handleMouseLeave(cs,Ua)})),Ba&&a.createElement("span",{className:wa.iconWrapper,onMouseEnter:Ua=>this.handleMouseEnter(Ua,Hn),onMouseLeave:Ua=>this.handleMouseLeave(Ua,Hn),"data-testid":"icon-wrapper"},Ba))}}const Br=(0,f.cV)(Gs),Mr="spanBar",vr="spanBarLabel",fr="nameWrapper",js="nameWrapperMatchingFilter",to="jaegerView",Ar="nameColumn",Ko=(0,i.N)((_e,et)=>{const st={label:"flash",flash:(0,n.keyframes)`
    from {
      background-color: ${(0,d.R)(_e,"#68b9ff")};
    }
    to {
      background-color: 'default';
    }
  `},pt=et?"":(0,d.R)(_e,"#fffce4");return{nameWrapper:(0,n.css)`
      label: nameWrapper;
      line-height: 27px;
      overflow: hidden;
      display: flex;
    `,nameWrapperMatchingFilter:(0,n.css)`
      label: nameWrapperMatchingFilter;
      background-color: ${pt};
    `,nameColumn:(0,n.css)`
      label: nameColumn;
      position: relative;
      white-space: nowrap;
      z-index: 1;
      &:hover {
        z-index: 1;
      }
    `,endpointName:(0,n.css)`
      label: endpointName;
      color: ${(0,d.R)(_e,"#484848")};
      font-size: 0.9em;
    `,view:(0,n.css)`
      label: view;
      position: relative;
    `,viewExpanded:(0,n.css)`
      label: viewExpanded;
      background: ${(0,d.R)(_e,"#f8f8f8")};
      outline: 1px solid ${(0,d.R)(_e,"#ddd")};
    `,viewExpandedAndMatchingFilter:(0,n.css)`
      label: viewExpandedAndMatchingFilter;
      background: ${(0,d.R)(_e,"#fff3d7")};
      outline: 1px solid ${(0,d.R)(_e,"#ddd")};
    `,row:(0,n.css)`
      label: row;
      font-size: 0.9em;
      &:hover .${Mr} {
        opacity: 1;
      }
      &:hover .${vr} {
        color: ${(0,d.R)(_e,"#000")};
      }
      &:hover .${fr} {
        background: #f8f8f8;
        background: linear-gradient(
          90deg,
          ${(0,d.R)(_e,"#fafafa")},
          ${(0,d.R)(_e,"#f8f8f8")} 75%,
          ${(0,d.R)(_e,"#eee")}
        );
      }
      &:hover .${to} {
        background-color: ${(0,d.R)(_e,"#f5f5f5")};
        outline: 1px solid ${(0,d.R)(_e,"#ddd")};
      }
    `,rowClippingLeft:(0,n.css)`
      label: rowClippingLeft;
      & .${Ar}::before {
        content: ' ';
        height: 100%;
        position: absolute;
        width: 6px;
        background-image: linear-gradient(
          to right,
          ${(0,d.R)(_e,"rgba(25, 25, 25, 0.25)")},
          ${(0,d.R)(_e,"rgba(32, 32, 32, 0)")}
        );
        left: 100%;
        z-index: -1;
      }
    `,rowClippingRight:(0,n.css)`
      label: rowClippingRight;
      & .${to}::before {
        content: ' ';
        height: 100%;
        position: absolute;
        width: 6px;
        background-image: linear-gradient(
          to left,
          ${(0,d.R)(_e,"rgba(25, 25, 25, 0.25)")},
          ${(0,d.R)(_e,"rgba(25, 25, 25, 0.25)")}
        );
        right: 0%;
        z-index: 1;
      }
    `,rowExpanded:(0,n.css)`
      label: rowExpanded;
      & .${Mr} {
        opacity: 1;
      }
      & .${vr} {
        color: ${(0,d.R)(_e,"#000")};
      }
      & .${fr}, &:hover .${fr} {
        background: ${(0,d.R)(_e,"#f0f0f0")};
        box-shadow: 0 1px 0 ${(0,d.R)(_e,"#ddd")};
      }
      & .${js} {
        background: ${(0,d.R)(_e,"#fff3d7")};
      }
      &:hover .${to} {
        background: ${(0,d.R)(_e,"#eee")};
      }
    `,rowMatchingFilter:(0,n.css)`
      label: rowMatchingFilter;
      // background-color: ${(0,d.R)(_e,"#fffbde")};
      &:hover .${fr} {
        background: linear-gradient(
          90deg,
          ${(0,d.R)(_e,"#fffbde")},
          ${(0,d.R)(_e,"#fffbde")} 75%,
          ${(0,d.R)(_e,"#f7f1c6")}
        );
      }
      &:hover .${to} {
        background-color: ${(0,d.R)(_e,"#f7f1c6")};
        outline: 1px solid ${(0,d.R)(_e,"#ddd")};
      }
    `,rowFocused:(0,n.css)`
      label: rowFocused;
      background-color: ${(0,d.R)(_e,"#cbe7ff")};
      animation: ${st.flash} 1s cubic-bezier(0.12, 0, 0.39, 0);
      & .${fr}, .${to}, .${js} {
        background-color: ${(0,d.R)(_e,"#cbe7ff")};
        animation: ${st.flash} 1s cubic-bezier(0.12, 0, 0.39, 0);
      }
      & .${Mr} {
        opacity: 1;
      }
      & .${vr} {
        color: ${(0,d.R)(_e,"#000")};
      }
      &:hover .${fr}, :hover .${to} {
        background: ${(0,d.R)(_e,"#d5ebff")};
        box-shadow: 0 1px 0 ${(0,d.R)(_e,"#ddd")};
      }
    `,rowExpandedAndMatchingFilter:(0,n.css)`
      label: rowExpandedAndMatchingFilter;
      &:hover .${to} {
        background: ${(0,d.R)(_e,"#ffeccf")};
      }
    `,name:(0,n.css)`
      label: name;
      color: ${(0,d.R)(_e,"#000")};
      cursor: pointer;
      flex: 1 1 auto;
      outline: none;
      overflow-y: hidden;
      overflow-x: auto;
      padding-left: 4px;
      padding-right: 0.25em;
      position: relative;
      -ms-overflow-style: none;
      scrollbar-width: none;
      &::-webkit-scrollbar {
        display: none;
      }
      &:focus {
        text-decoration: none;
      }
      &:hover > span {
        color: ${(0,d.R)(_e,"#000")};
      }
      text-align: left;
      background: transparent;
      border: none;
      border-bottom-width: 1px;
      border-bottom-style: solid;
    `,nameDetailExpanded:(0,n.css)`
      label: nameDetailExpanded;
      &::before {
        bottom: 0;
      }
    `,svcName:(0,n.css)`
      label: svcName;
      font-size: 0.9em;
      font-weight: bold;
      margin-right: 0.25rem;
    `,svcNameChildrenCollapsed:(0,n.css)`
      label: svcNameChildrenCollapsed;
      font-weight: bold;
      font-style: italic;
    `,errorIcon:(0,n.css)`
      label: errorIcon;
      border-radius: 6.5px;
      color: ${(0,d.R)(_e,"#fff")};
      font-size: 0.85em;
      margin-right: 0.25rem;
      padding: 1px;
    `,rpcColorMarker:(0,n.css)`
      label: rpcColorMarker;
      border-radius: 6.5px;
      display: inline-block;
      font-size: 0.85em;
      height: 1em;
      margin-right: 0.25rem;
      padding: 1px;
      width: 1em;
      vertical-align: middle;
    `,labelRight:(0,n.css)`
      label: labelRight;
      left: 100%;
    `,labelLeft:(0,n.css)`
      label: labelLeft;
      right: 100%;
    `}});class no extends a.PureComponent{constructor(){super(...arguments),this._detailToggle=()=>{this.props.onDetailToggled(this.props.span.spanID)},this._childrenToggle=()=>{this.props.onChildrenToggled(this.props.span.spanID)},this.getSpanBarLabel=(et,st,pt)=>{const Wt=st?.type??"";if(Wt===Ie)return"";if(Wt===""||Wt===Oe)return`(${pt})`;if(Wt===Ne){const Xt=st?.tag?.trim()??"";if(Xt!==""&&et.tags){const dn=et.tags?.find(Hn=>Hn.key===Xt);if(dn)return`(${dn.value})`;const In=et.process?.tags?.find(Hn=>Hn.key===Xt);if(In)return`(${In.value})`}}return""}}static{this.displayName="UnthemedSpanBarRow"}static{this.defaultProps={className:"",rpc:null}}render(){const{className:et,color:st,spanBarOptions:pt,columnDivision:Wt,isChildrenExpanded:Xt,isDetailExpanded:dn,isMatchingFilter:In,showSpanFilterMatchesOnly:Hn,isFocused:ra,numTicks:Ba,rpc:wa,noInstrumentedServer:Ua,showErrorIcon:Za,getViewedBounds:cs,traceStartTime:Ya,span:Ks,hoverIndentGuideIds:Ge,addHoverIndentGuideId:Re,removeHoverIndentGuideId:qe,clippingLeft:ut,clippingRight:Ft,theme:on,createSpanLink:sn,datasourceType:Ln,showServiceName:qn,visibleSpanIds:na,criticalPath:Sa}=this.props,{duration:ka,hasChildren:Da,operationName:ds,process:{serviceName:Xa}}=Ks,qs=(0,p.a3)(ka),Cs=cs(Ks.startTime,Ks.startTime+Ks.duration),Ss=Cs.start,fa=Cs.end,Fa=Ko(on,Hn),Na=`${Xa}::${ds}`;let Is,pr;return Ss>1-fa?(Is=`${Na} | ${qs}`,pr=Fa.labelLeft):(Is=`${qs} | ${Na}`,pr=Fa.labelRight),a.createElement(W,{className:y()(Fa.row,{[Fa.rowExpanded]:dn,[Fa.rowMatchingFilter]:In,[Fa.rowExpandedAndMatchingFilter]:In&&dn,[Fa.rowFocused]:ra,[Fa.rowClippingLeft]:ut,[Fa.rowClippingRight]:Ft},et)},a.createElement(W.Cell,{className:y()(Fa.nameColumn,Ar),width:Wt},a.createElement("div",{className:y()(Fa.nameWrapper,fr,{[Fa.nameWrapperMatchingFilter]:In,nameWrapperMatchingFilter:In})},a.createElement(Br,{onClick:Da?this._childrenToggle:void 0,childrenVisible:Xt,span:Ks,hoverIndentGuideIds:Ge,addHoverIndentGuideId:Re,removeHoverIndentGuideId:qe,visibleSpanIds:na}),a.createElement("button",{type:"button",className:y()(Fa.name,{[Fa.nameDetailExpanded]:dn}),"aria-checked":dn,title:Na,onClick:this._detailToggle,role:"switch",style:{background:`${st}10`,borderBottomColor:`${st}CF`},tabIndex:0},Za&&a.createElement(Me.I,{name:"exclamation-circle",style:{backgroundColor:Ks.errorIconColor?(0,d.R)(on,Ks.errorIconColor):(0,d.R)(on,"#db2828")},className:Fa.errorIcon}),qn&&a.createElement("span",{className:y()(Fa.svcName,{[Fa.svcNameChildrenCollapsed]:Da&&!Xt})},`${Xa} `),wa&&a.createElement("span",null,a.createElement(Me.I,{name:"arrow-right"})," ",a.createElement("i",{className:Fa.rpcColorMarker,style:{background:wa.color}}),wa.serviceName),Ua&&a.createElement("span",null,a.createElement(Me.I,{name:"arrow-right"})," ",a.createElement("i",{className:Fa.rpcColorMarker,style:{background:Ua.color}}),Ua.serviceName),a.createElement("span",{className:Fa.endpointName},wa?wa.operationName:ds),a.createElement("span",{className:Fa.endpointName}," ",this.getSpanBarLabel(Ks,pt,qs))),sn&&(()=>{const ir=sn(Ks),fo=ir?.length||0;return ir&&fo===1?ir[0]?a.createElement("a",{href:ir[0].href,target:"_blank",style:{background:`${st}10`,borderBottom:`1px solid ${st}CF`,paddingRight:"4px"},rel:"noopener noreferrer",onClick:ir[0].onClick?ss=>{!(ss.ctrlKey||ss.metaKey||ss.shiftKey)&&ir[0].onClick&&(ss.preventDefault(),ir[0].onClick(ss))}:void 0},ir[0].content):null:ir&&fo>1?a.createElement(Ms,{links:ir,datasourceType:Ln,color:st}):null})())),a.createElement(W.Cell,{className:y()(Fa.view,to,{[Fa.viewExpanded]:dn,[Fa.viewExpandedAndMatchingFilter]:In&&dn}),"data-testid":"span-view",style:{cursor:"pointer"},width:1-Wt,onClick:this._detailToggle},a.createElement(w,{numTicks:Ba}),a.createElement(Ts,{criticalPath:Sa,rpc:wa,viewStart:Ss,viewEnd:fa,getViewedBounds:cs,color:st,shortLabel:qs,longLabel:Is,traceStartTime:Ya,span:Ks,labelClassName:`${vr} ${pr}`,className:Mr})))}}const vo=(0,f.cV)(no),ao=(0,i.N)(_e=>({expandedAccent:(0,n.css)`
      cursor: pointer;
      height: 100%;
      overflow: hidden;
      position: absolute;
      width: 100%;
      &::before {
        border-left: 1px solid;
        pointer-events: none;
        width: 1000px;
      }
      &::after {
        border-right: 1000px solid;
        border-color: inherit;
        cursor: pointer;
        opacity: 0.2;
      }

      /* border-color inherit must come AFTER other border declarations for accent */
      &::before,
      &::after {
        border-color: inherit;
        content: ' ';
        position: absolute;
        height: 100%;
      }

      &:hover::after {
        opacity: 0.35;
      }
    `,infoWrapper:(0,n.css)`
      label: infoWrapper;
      border: 1px solid ${(0,d.R)(_e,"#d3d3d3")};
      border-top: 3px solid;
      padding: 0.75rem;
    `}));class Do extends a.PureComponent{constructor(){super(...arguments),this._detailToggle=()=>{this.props.onDetailToggled(this.props.span.spanID)},this._linksGetter=(et,st)=>{const{linksGetter:pt,span:Wt}=this.props;return pt(Wt,et,st)}}render(){const{color:et,columnDivision:st,detailState:pt,logItemToggle:Wt,logsToggle:Xt,processToggle:dn,referenceItemToggle:In,referencesToggle:Hn,warningsToggle:ra,stackTracesToggle:Ba,span:wa,traceToProfilesOptions:Ua,timeZone:Za,tagsToggle:cs,traceStartTime:Ya,traceDuration:Ks,traceName:Ge,hoverIndentGuideIds:Re,addHoverIndentGuideId:qe,removeHoverIndentGuideId:ut,theme:Ft,createSpanLink:on,focusedSpanId:sn,createFocusSpanLink:Ln,datasourceType:qn,visibleSpanIds:na,traceFlameGraphs:Sa,setTraceFlameGraphs:ka,setRedrawListView:Da}=this.props,ds=ao(Ft);return a.createElement(W,null,a.createElement(W.Cell,{width:st,style:{overflow:"hidden"}},a.createElement(Br,{span:wa,showChildrenIcon:!1,hoverIndentGuideIds:Re,addHoverIndentGuideId:qe,removeHoverIndentGuideId:ut,visibleSpanIds:na}),a.createElement(ft.$n,{fill:"text",onClick:this._detailToggle,className:y()(ds.expandedAccent,(0,ft.my)(Ft)),style:{borderColor:et},"data-testid":"detail-row-expanded-accent"})),a.createElement(W.Cell,{width:1-st},a.createElement("div",{className:ds.infoWrapper,style:{borderTopColor:et}},a.createElement(tn,{detailState:pt,linksGetter:this._linksGetter,logItemToggle:Wt,logsToggle:Xt,processToggle:dn,referenceItemToggle:In,referencesToggle:Hn,warningsToggle:ra,stackTracesToggle:Ba,span:wa,traceToProfilesOptions:Ua,timeZone:Za,tagsToggle:cs,traceStartTime:Ya,traceDuration:Ks,traceName:Ge,createSpanLink:on,focusedSpanId:sn,createFocusSpanLink:Ln,datasourceType:qn,traceFlameGraphs:Sa,setTraceFlameGraphs:ka,setRedrawListView:Da}))))}}const Xr=(0,f.cV)(Do),mo=(0,i.N)(()=>({rowsWrapper:(0,n.css)`
      width: 100%;
    `,row:(0,n.css)`
      width: 100%;
    `,scrollToTopButton:(0,n.css)`
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      width: 40px;
      height: 40px;
      position: absolute;
      bottom: 30px;
      right: 30px;
      z-index: 1;
    `})),qr={bar:28,detail:161,detailWithLogs:197},Po=5,jr=33;function Io(_e,et,st,pt,Wt,Xt,dn){if(!_e)return[];Wt&&pt&&(_e=_e.filter(ra=>pt.has(ra.spanID))),Xt&&dn&&(_e=_e.filter(ra=>dn.find(Ba=>Ba.spanId===ra.spanID)));let In=null;const Hn=[];for(let ra=0;ra<_e.length;ra++){const Ba=_e[ra],{spanID:wa,depth:Ua}=Ba;let Za=!1;In!=null&&(Ua>=In?Za=!0:In=null),!Za&&(et.has(wa)&&(In=Ua+1),Hn.push({span:Ba,isDetail:!1,spanIndex:ra}),st.has(wa)&&Hn.push({span:Ba,isDetail:!0,spanIndex:ra}))}return Hn}function $o(_e){const[et,st]=_e;return{left:et>0,right:st<1}}function qo(_e,et,st,pt,Wt,Xt,dn){return _e?Io(_e.spans,et,st,pt,Wt,Xt,dn):[]}function lo(_e){const et=new Map;return _e&&_e.spans.forEach(st=>{st.childSpanIds.length&&et.set(st.spanID,st.childSpanIds)}),et}const Vo=(0,Se.A)(qo),Co=(0,Se.A)(v,fe.isEqual),zo=(0,Se.A)($o,fe.isEqual),So=(0,Se.A)(lo);class si extends a.Component{constructor(){super(...arguments),this.hasScrolledToSpan=!1,this.getViewRange=()=>this.props.currentViewRangeTime,this.getSearchedSpanIDs=()=>this.props.findMatchesIDs,this.getCollapsedChildren=()=>this.props.childrenHiddenIDs,this.mapRowIndexToSpanIndex=et=>this.getRowStates()[et].spanIndex,this.mapSpanIndexToRowIndex=et=>{const st=this.getRowStates().length;for(let pt=0;pt<st;pt++){const{spanIndex:Wt}=this.getRowStates()[pt];if(Wt===et)return pt}throw new Error(`unable to find row for span index: ${et}`)},this.setListView=et=>{this.listView=et},this.getKeyFromIndex=et=>{const{isDetail:st,span:pt}=this.getRowStates()[et];return`${pt.traceID}--${pt.spanID}--${st?"detail":"bar"}`},this.getIndexFromKey=et=>{const st=et.split("--"),pt=st[0],Wt=st[1],Xt=st[2]==="detail",dn=this.getRowStates().length;for(let In=0;In<dn;In++){const{span:Hn,isDetail:ra}=this.getRowStates()[In];if(Hn.spanID===Wt&&Hn.traceID===pt&&ra===Xt)return In}return-1},this.getRowHeight=et=>{const{span:st,isDetail:pt}=this.getRowStates()[et];return pt?Array.isArray(st.logs)&&st.logs.length?qr.detailWithLogs:qr.detail:qr.bar},this.renderRow=(et,st,pt,Wt)=>{const{isDetail:Xt,span:dn,spanIndex:In}=this.getRowStates()[pt],Hn=Math.max((this.listView?.getTopVisibleIndex()||0)-jr,0),ra=(this.listView?.getBottomVisibleIndex()||0)+jr,Ba=this.getVisibleSpanIds(Hn,ra);return Xt?this.renderSpanDetailRow(dn,et,st,Wt,Ba):this.renderSpanBarRow(dn,In,et,st,Wt,Ba)},this.scrollToSpan=(et,st)=>{if(st==null)return;const pt=this.getRowStates().findIndex(Wt=>Wt.span.spanID===st);pt>=0&&this.listView?.scrollToIndex(pt,et)},this.scrollToTop=()=>{const{topOfViewRef:et,datasourceType:st,trace:pt}=this.props;et?.current?.scrollIntoView({behavior:"smooth"}),(0,o.rR)("grafana_traces_trace_view_scroll_to_top_clicked",{datasourceType:st,grafana_version:r.$.buildInfo.version,numServices:pt.services.length,numSpans:pt.spans.length})},this.getVisibleSpanIds=(0,Se.A)((et,st)=>{const pt=[];for(let Wt=et;Wt<st;Wt++){const Xt=this.getRowStates()[Wt];Xt?.span&&pt.push(Xt.span.spanID)}return pt})}componentDidMount(){this.scrollToSpan(this.props.headerHeight,this.props.focusedSpanId)}shouldComponentUpdate(et){let st;for(st in et)if(et[st]!==this.props[st])return!0;return!1}componentDidUpdate(et){const{headerHeight:st,focusedSpanId:pt,focusedSpanIdForSearch:Wt}=this.props;this.hasScrolledToSpan||(this.scrollToSpan(st,pt),this.hasScrolledToSpan=!0),pt!==et.focusedSpanId&&this.scrollToSpan(st,pt),Wt!==et.focusedSpanIdForSearch&&this.scrollToSpan(st,Wt)}getRowStates(){const{childrenHiddenIDs:et,detailStates:st,trace:pt,findMatchesIDs:Wt,showSpanFilterMatchesOnly:Xt,showCriticalPathSpansOnly:dn,criticalPath:In}=this.props;return Vo(pt,et,st,Wt,Xt,dn,In)}getClipping(){const{currentViewRangeTime:et}=this.props;return zo(et)}getViewedBounds(){const{currentViewRangeTime:et,trace:st}=this.props,[pt,Wt]=et;return Co({min:st.startTime,max:st.endTime,viewStart:pt,viewEnd:Wt})}getChildSpansMap(){return So(this.props.trace)}getAccessors(){const et=this.listView;if(!et)throw new Error("ListView unavailable");return{getViewRange:this.getViewRange,getSearchedSpanIDs:this.getSearchedSpanIDs,getCollapsedChildren:this.getCollapsedChildren,getViewHeight:et.getViewHeight,getBottomRowIndexVisible:et.getBottomVisibleIndex,getTopRowIndexVisible:et.getTopVisibleIndex,getRowPosition:et.getRowPosition,mapRowIndexToSpanIndex:this.mapRowIndexToSpanIndex,mapSpanIndexToRowIndex:this.mapSpanIndexToRowIndex}}renderSpanBarRow(et,st,pt,Wt,Xt,dn){const{spanID:In,childSpanIds:Hn}=et,{serviceName:ra}=et.process,{childrenHiddenIDs:Ba,childrenToggle:wa,detailStates:Ua,detailToggle:Za,findMatchesIDs:cs,spanNameColumnWidth:Ya,trace:Ks,spanBarOptions:Ge,hoverIndentGuideIds:Re,addHoverIndentGuideId:qe,removeHoverIndentGuideId:ut,createSpanLink:Ft,focusedSpanId:on,focusedSpanIdForSearch:sn,showSpanFilterMatchesOnly:Ln,theme:qn,datasourceType:na,criticalPath:Sa}=this.props;if(!Ks)return null;const ka=(0,me.Kv)(ra,qn),Da=Ba.has(In),ds=Ua.has(In),Xa=cs?cs.has(In):!1,qs=In===on||In===sn,Cs=L(et)||Da&&N(Ks.spans,st);let Ss=null;if(Da){const ss=F(Ks.spans.slice(st));if(ss){const wo=this.getViewedBounds()(ss.startTime,ss.startTime+ss.duration);Ss={color:(0,me.Kv)(ss.process.serviceName,qn),operationName:ss.operationName,serviceName:ss.process.serviceName,viewEnd:wo.end,viewStart:wo.start}}}const fa=et.tags.find(ss=>ss.key===ce);let Fa=null;!et.hasChildren&&fa&&K(et)&&(Fa={serviceName:fa.value,color:(0,me.Kv)(fa.value,qn)});const Na=st>0?Ks.spans[st-1]:null,Is=[In,...Hn],pr=ss=>{ss.forEach(wo=>{const ui=this.getChildSpansMap().get(wo);ui?.length&&(Is.push(...ui),pr(ui))})};pr(Hn);const ir=Sa?.filter(ss=>Da?Is.includes(ss.spanId):ss.spanId===In),fo=mo();return a.createElement("div",{className:fo.row,key:pt,style:Wt,...Xt},a.createElement(vo,{clippingLeft:this.getClipping().left,clippingRight:this.getClipping().right,color:ka,spanBarOptions:Ge,columnDivision:Ya,isChildrenExpanded:!Da,isDetailExpanded:ds,isMatchingFilter:Xa,isFocused:qs,showSpanFilterMatchesOnly:Ln,numTicks:Po,onDetailToggled:Za,onChildrenToggled:wa,rpc:Ss,noInstrumentedServer:Fa,showErrorIcon:Cs,getViewedBounds:this.getViewedBounds(),traceStartTime:Ks.startTime,span:et,hoverIndentGuideIds:Re,addHoverIndentGuideId:qe,removeHoverIndentGuideId:ut,createSpanLink:Ft,datasourceType:na,showServiceName:Na===null||Na.process.serviceName!==et.process.serviceName,visibleSpanIds:dn,criticalPath:ir}))}renderSpanDetailRow(et,st,pt,Wt,Xt){const{spanID:dn}=et,{serviceName:In}=et.process,{detailLogItemToggle:Hn,detailLogsToggle:ra,detailProcessToggle:Ba,detailReferencesToggle:wa,detailReferenceItemToggle:Ua,detailWarningsToggle:Za,detailStackTracesToggle:cs,detailStates:Ya,detailTagsToggle:Ks,detailToggle:Ge,spanNameColumnWidth:Re,trace:qe,traceToProfilesOptions:ut,timeZone:Ft,hoverIndentGuideIds:on,addHoverIndentGuideId:sn,removeHoverIndentGuideId:Ln,linksGetter:qn,createSpanLink:na,focusedSpanId:Sa,createFocusSpanLink:ka,theme:Da,datasourceType:ds,traceFlameGraphs:Xa,setTraceFlameGraphs:qs,setRedrawListView:Cs}=this.props,Ss=Ya.get(dn);if(!qe||!Ss)return null;const fa=(0,me.Kv)(In,Da),Fa=mo();return a.createElement("div",{className:Fa.row,key:st,style:{...pt,zIndex:1},...Wt},a.createElement(Xr,{color:fa,columnDivision:Re,onDetailToggled:Ge,detailState:Ss,linksGetter:qn,logItemToggle:Hn,logsToggle:ra,processToggle:Ba,referenceItemToggle:Ua,referencesToggle:wa,warningsToggle:Za,stackTracesToggle:cs,span:et,traceToProfilesOptions:ut,timeZone:Ft,tagsToggle:Ks,traceStartTime:qe.startTime,traceDuration:qe.duration,traceName:qe.traceName,hoverIndentGuideIds:on,addHoverIndentGuideId:sn,removeHoverIndentGuideId:Ln,createSpanLink:na,focusedSpanId:Sa,createFocusSpanLink:ka,datasourceType:ds,visibleSpanIds:Xt,traceFlameGraphs:Xa,setTraceFlameGraphs:qs,setRedrawListView:Cs}))}render(){const et=mo(),{scrollElement:st,redrawListView:pt}=this.props;return a.createElement(a.Fragment,null,a.createElement(Pe,{ref:this.setListView,dataLength:this.getRowStates().length,itemHeightGetter:this.getRowHeight,itemRenderer:this.renderRow,viewBuffer:jr,viewBufferMin:jr,itemsWrapperClassName:et.rowsWrapper,getKeyFromIndex:this.getKeyFromIndex,getIndexFromKey:this.getIndexFromKey,windowScroller:!1,scrollElement:st,redraw:pt}),this.props.topOfViewRef&&a.createElement(he.I,{className:et.scrollToTopButton,onClick:this.scrollToTop,title:"Scroll to top",icon:"arrow-up"}))}}const Yo=(0,f.cV)(si),ri=(0,i.N)(_e=>({TraceTimelineViewer:(0,n.css)`
      label: TraceTimelineViewer;
      border-bottom: 1px solid ${(0,d.R)(_e,"#bbb")};

      & .json-markup {
        line-height: 17px;
        font-size: 13px;
        font-family: monospace;
        white-space: pre-wrap;
      }

      & .json-markup-key {
        font-weight: bold;
      }

      & .json-markup-bool {
        color: ${(0,d.R)(_e,"firebrick")};
      }

      & .json-markup-string {
        color: ${(0,d.R)(_e,"teal")};
      }

      & .json-markup-null {
        color: ${(0,d.R)(_e,"teal")};
      }

      & .json-markup-number {
        color: ${(0,d.R)(_e,"blue","black")};
      }
    `})),Ao=5;class so extends a.PureComponent{constructor(et){super(et),this.collapseAll=()=>{this.props.collapseAll(this.props.trace.spans),(0,o.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"collapseAll"})},this.collapseOne=()=>{this.props.collapseOne(this.props.trace.spans),(0,o.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"collapseOne"})},this.expandAll=()=>{this.props.expandAll(),(0,o.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"expandAll"})},this.expandOne=()=>{this.props.expandOne(this.props.trace.spans),(0,o.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"expandOne"})},this.state={height:0}}componentDidMount(){g({collapseAll:this.collapseAll,expandAll:this.expandAll,collapseOne:this.collapseOne,expandOne:this.expandOne})}render(){const{setSpanNameColumnWidth:et,updateNextViewRangeTime:st,updateViewRangeTime:pt,viewRange:Wt,traceTimeline:Xt,theme:dn,topOfViewRef:In,focusedSpanIdForSearch:Hn,...ra}=this.props,{trace:Ba}=ra,wa=ri(dn);return a.createElement("div",{className:wa.TraceTimelineViewer,ref:Ua=>Ua&&this.setState({height:Ua.getBoundingClientRect().height})},a.createElement(ue,{duration:Ba.duration,nameColumnWidth:Xt.spanNameColumnWidth,numTicks:Ao,onCollapseAll:this.collapseAll,onCollapseOne:this.collapseOne,onColummWidthChange:et,onExpandAll:this.expandAll,onExpandOne:this.expandOne,viewRangeTime:Wt.time,updateNextViewRangeTime:st,updateViewRangeTime:pt,columnResizeHandleHeight:this.state.height}),a.createElement(Yo,{...ra,...Xt,setSpanNameColumnWidth:et,currentViewRangeTime:Wt.time.current,topOfViewRef:In,focusedSpanIdForSearch:Hn,datasourceType:this.props.datasourceType}))}}const ko=(0,f.cV)(so);var eo=e(39938);const No=()=>({NewWindowIconLarge:(0,n.css)`
      label: NewWindowIconLarge;
      font-size: 1.5em;
    `});function To({isLarge:_e=!1,className:et}){const st=(0,f.of)(No),pt=y()({[st.NewWindowIconLarge]:_e},et);return a.createElement(Me.I,{className:pt,name:"anchor"})}const oi=_e=>a.createElement("a",{href:_e.href,title:_e.title,target:"_blank",rel:"noopener noreferrer",className:_e.className},_e.children," ",a.createElement(To,null));function oo(_e){const{links:et}=_e;return a.createElement(oi,{href:et[0].url,title:et[0].text,className:_e.className})}const zt=100,rn="<trace-without-root-span>",zn=()=>({BreakableText:(0,n.css)`
      label: BreakableText;
      display: inline-block;
      white-space: pre;
    `}),Fn=/\W*\w+\W*/g;function ta({text:_e,className:et,wordRegexp:st=Fn}){const pt=(0,f.of)(zn);if(!_e)return null;const Wt=[];st.exec("");let Xt=st.exec(_e)||[_e];for(;Xt;)Wt.push(a.createElement("span",{key:`${_e}-${Wt.length}`,className:et||pt.BreakableText},Xt[0])),Xt=st.exec(_e);return a.createElement(a.Fragment,null,Wt)}const ua=_e=>({TraceName:(0,n.css)`
      label: TraceName;
      font-size: ${_e.typography.size.lg};
    `});function ya(_e){const{className:et,traceName:st}=_e,pt=(0,f.of)(ua),Wt=String(st||rn),Xt=a.createElement(ta,{text:Wt});return a.createElement("span",{className:y()(pt.TraceName,et)},Xt)}var as=e(40784);const Ga=Object.defineProperty({archiveEnabled:!1,dependencies:{dagMaxNumServices:zt,menuEnabled:!0},linkPatterns:[],search:{maxLookback:{label:"2 Days",value:"2d"},maxLimit:1500},tracking:{gaID:null,trackErrors:!0}},"__mergeFields",{value:["dependencies","search","tracking"]});function _a(){return Ga}function nr(_e){return(0,fe.get)(_a(),_e)}const ps=/#\{([^{}]*)\}/g;function Qs(_e){const et=new Set;return _e.replace(ps,(st,pt)=>(et.add(pt),st)),Array.from(et)}function Hr(_e,et,st){return _e.replace(ps,(pt,Wt)=>{const Xt=st[Wt];return Xt==null?"":et(Xt)})}function _r(_e,et){if(typeof _e!="string")throw new Error("Invalid template");return{parameters:Qs(_e),template:Hr.bind(null,_e,et)}}function Rr(_e){if(typeof _e=="string")return et=>et===_e;if(Array.isArray(_e))return et=>_e.indexOf(et)>-1;if(_e==null)return()=>!0;throw new Error(`Invalid value: ${_e}`)}const Eo=_e=>_e;function co(_e){try{const et=_r(_e.url,encodeURIComponent),st=_r(_e.text,Eo);return{object:_e,type:Rr(_e.type),key:Rr(_e.key),value:Rr(_e.value),url:et,text:st,parameters:(0,fe.uniq)(et.parameters.concat(st.parameters))}}catch(et){return console.error(`Ignoring invalid link pattern: ${et}`,_e),null}}function Ur(_e,et){return _e.template(et)}function At(_e,et){const st=[],pt=Object.keys(et).filter(Wt=>typeof et[Wt]=="string"||et[Wt]==="number");return _e?.filter(Wt=>Wt?.type("traces")).forEach(Wt=>{const Xt={};Wt?.parameters.every(In=>{const Hn=In;return pt.includes(Hn)?(Xt[In]=et[Hn],!0):!1})&&st.push({url:Ur(Wt.url,Xt),text:Ur(Wt.text,Xt)})}),st}const an=(nr("linkPatterns")||[]).map(co).filter(_e=>!!_e),cn=(0,as.A)(10)(_e=>{const et=[];return _e?At(an,_e):et});function On(_e){let et;const st=new Set(_e.map(({spanID:pt})=>pt));for(let pt=0;pt<_e.length;pt++){if(_e[pt].references&&_e[pt].references.some(({traceID:In,spanID:Hn})=>In===_e[pt].traceID&&st.has(Hn)))continue;if(!et){et=_e[pt];continue}const Xt=_e[pt].references&&_e[pt].references.length||0,dn=et.references&&et.references.length||0;(Xt<dn||Xt===dn&&_e[pt].startTime<et.startTime)&&(et=_e[pt])}return et?`${et.process.serviceName}: ${et.operationName}`:""}const ha=(0,fe.memoize)(On,_e=>_e.length?_e[0].traceID:0);function la(_e){for(let et=0;et<_e.length;et++){const st=_e[et].tags.filter(Xt=>Xt.key==="http.request.method"),pt=_e[et].tags.filter(Xt=>Xt.key==="http.response.status_code"),Wt=_e[et].tags.filter(Xt=>Xt.key==="http.route");if(st.length>0||pt.length>0||Wt.length>0)return{method:st,status:pt,url:Wt}}for(let et=0;et<_e.length;et++){const st=_e[et].tags.filter(Xt=>Xt.key==="http.method"),pt=_e[et].tags.filter(Xt=>Xt.key==="http.status_code"),Wt=_e[et].tags.filter(Xt=>Xt.key==="http.url"||Xt.key==="http.target"||Xt.key==="http.path");if(st.length>0||pt.length>0||Wt.length>0)return{method:st,status:pt,url:Wt}}return{}}const Ns=(0,fe.memoize)(la,_e=>_e.length?_e[0].traceID:0);var Ds=e(2913),Js=e(18358);const Rs=_e=>({ActionButton:(0,n.css)`
      label: ActionButton;
      overflow: hidden;
      position: relative;
      &:after {
        content: '';
        background: ${_e.colors.primary.main};
        display: block;
        position: absolute;
        right: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: all 0.8s;
      }
      &:active:after {
        margin: 0;
        opacity: 0.3;
        transition: 0s;
      }
    `});function Er(_e){const{onClick:et,ariaLabel:st,label:pt,icon:Wt}=_e,Xt=(0,f.of)(Rs);return a.createElement(ft.$n,{className:Xt.ActionButton,size:"sm",variant:"secondary",fill:"outline",type:"button",icon:Wt,"aria-label":st,onClick:et},pt)}const Vs=_e=>({TracePageActions:(0,n.css)({label:"TracePageActions",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",marginBottom:"10px"}),feedback:(0,n.css)({margin:"6px 6px 6px 0",color:_e.colors.text.secondary,fontSize:_e.typography.bodySmall.fontSize,"&:hover":{color:_e.colors.text.link}})});function hs(_e){const{traceId:et,data:st,app:pt}=_e,Wt=(0,f.$j)(),Xt=Vs(Wt),[dn,In]=(0,a.useState)(!1),Hn=()=>{navigator.clipboard.writeText(et),In(!0),setTimeout(()=>{In(!1)},5e3)},ra=()=>{const Ba=(0,Js.ek)(st,"Trace-"+et.substring(et.length-6));(0,o.rR)("grafana_traces_download_traces_clicked",{app:pt,grafana_version:Ds.config.buildInfo.version,trace_format:Ba,location:"trace-view"})};return a.createElement("div",{className:Xt.TracePageActions},a.createElement("a",{href:"https://forms.gle/RZDEx8ScyZNguDoC8",className:Xt.feedback,title:"Share your thoughts about tracing in Grafana.",target:"_blank",rel:"noreferrer noopener"},a.createElement(Me.I,{name:"comment-alt-message"})," Give feedback"),a.createElement(Er,{onClick:Hn,ariaLabel:"Copy Trace ID",label:dn?"Copied!":"Trace ID",icon:"copy"}),a.createElement(Er,{onClick:ra,ariaLabel:"Export Trace",label:"Export",icon:"save"}))}var Pr=e(50877),ro=e(3721),yo=e(40996),Kr=e(14186),io=e(10354);const Ro=/^(-?\d+(?:\.\d+)?)(ms|[Mwdhmsy])$/,Qr=(_e,et)=>!(_e.match(et)||!_e),uo=_e=>{const et=_e.validationRegex||Ro,[st,pt]=(0,a.useState)(()=>_e.value?Qr(_e.value,et):!1);(0,yo.A)(()=>{pt(Qr(_e.value,et))},500,[_e.value]);const Wt={labelWidth:26,disabled:_e.disabled??!1,invalid:st,error:_e.isInvalidError};return _e.label&&(Wt.label=_e.label,Wt.tooltip=_e.tooltip||""),a.createElement(Kr.I,{...Wt},a.createElement(io.p,{type:"text",placeholder:_e.placeholder||"0",width:_e.width||40,onChange:Xt=>{_e.onChange(Xt.currentTarget.value)},value:_e.value,"aria-label":_e.ariaLabel||"interval input"}))};var Mo=e(82762),Jo=e(39268),Lo=e(66864),$r=e(21594),Ei=e(15583);class Ki extends a.PureComponent{constructor(){super(...arguments),this.clearUiFind=()=>{this.props.onChange("")}}static{this.defaultProps={value:void 0}}render(){const{value:et}=this.props,st=a.createElement(a.Fragment,null,et&&et.length&&a.createElement(_.K,{name:"times",onClick:this.clearUiFind,tooltip:"Clear input"}));return a.createElement("div",{style:{width:"200px"}},a.createElement(io.p,{placeholder:"Find...",onChange:pt=>this.props.onChange(pt.currentTarget.value),suffix:st,value:et}))}}const dt=(0,a.memo)(function(et){const{trace:st,spanFilterMatches:pt,setFocusedSpanIdForSearch:Wt,focusedSpanIndexForSearch:Xt,setFocusedSpanIndexForSearch:dn,datasourceType:In,showSpanFilters:Hn}=et,ra=Pn((0,f.$j)(),Hn);(0,a.useEffect)(()=>{if(pt&&Xt!==-1){const ut=Array.from(pt);Wt(ut[Xt])}},[Xt,Wt,pt]);const Ba=(ut,Ft)=>{if(ut.preventDefault(),ut.stopPropagation(),Ft){if((0,o.rR)("grafana_traces_trace_view_find_next_prev_clicked",{datasourceType:In,grafana_version:r.$.buildInfo.version,direction:"next"}),Xt===-1||pt&&Xt===pt.size-1){dn(0);return}dn(Xt+1)}},wa=(ut,Ft)=>{if(ut.preventDefault(),ut.stopPropagation(),Ft){if((0,o.rR)("grafana_traces_trace_view_find_next_prev_clicked",{datasourceType:In,grafana_version:r.$.buildInfo.version,direction:"prev"}),pt&&(Xt===-1||Xt===0)){dn(pt.size-1);return}dn(Xt-1)}},Ua=(ut,Ft)=>{ut.key==="Enter"&&Ba(ut,Ft)},Za=(ut,Ft)=>{ut.key==="Enter"&&wa(ut,Ft)},cs=(pt&&pt?.size>0)??!1,Ya=cs?ra.button:(0,n.cx)(ra.button,ra.buttonDisabled),Ks=(0,a.useCallback)(ut=>a.createElement(ke.m,{content:ut,placement:"top"},a.createElement("span",{className:ra.tooltip},a.createElement(Me.I,{name:"info-circle",size:"md"}))),[ra.tooltip]),Ge=(0,a.useCallback)((ut,Ft)=>{let on=a.createElement(a.Fragment,null,a.createElement("span",null,`${st.spans.length} spans`),Ks(a.createElement(a.Fragment,null,a.createElement("div",null,"Services: ",Ft),a.createElement("div",null,"Depth: ",ut))));if(pt)if(pt.size===0)on=a.createElement(a.Fragment,null,a.createElement("span",null,"0 matches"),Ks("There are 0 span matches for the filters selected. Please try removing some of the selected filters."));else{const sn=pt.size===1?"match":"matches",Ln=Xt!==-1?`${Xt+1}/${pt.size} ${sn}`:`${pt.size} ${sn}`,qn=[];pt.forEach(na=>{st.processes[na]&&qn.push(st.processes[na].serviceName)}),on=a.createElement(a.Fragment,null,a.createElement("span",null,Ln),Ks(a.createElement(a.Fragment,null,a.createElement("div",null,"Services: ",new Set(qn).size,"/",Ft),a.createElement("div",null,"Depth: ",ut))))}return on},[Xt,Ks,pt,st.processes,st.spans]),Re=new Set((0,fe.values)(st.processes).map(ut=>ut.serviceName)).size,qe=(0,fe.get)((0,fe.maxBy)(st.spans,"depth"),"depth",0)+1;return a.createElement(a.Fragment,null,a.createElement("span",{className:ra.matches},Ge(qe,Re)),a.createElement("div",{className:cs?ra.buttons:(0,n.cx)(ra.buttons,ra.buttonsDisabled)},a.createElement("div",{"aria-label":"Prev result button",className:Ya,onClick:ut=>wa(ut,cs),onKeyDown:ut=>Za(ut,cs),role:"button",tabIndex:cs?0:-1},"Prev"),a.createElement("div",{"aria-label":"Next result button",className:Ya,onClick:ut=>Ba(ut,cs),onKeyDown:ut=>Ua(ut,cs),role:"button",tabIndex:cs?0:-1},"Next")))}),Pn=(_e,et)=>{const st=(0,ft.hs)({theme:_e,variant:"secondary",size:et?"md":"sm",iconOnly:!1,fill:"outline"});return{buttons:(0,n.css)`
      display: inline-flex;
      gap: 4px;
    `,buttonsDisabled:(0,n.css)`
      cursor: not-allowed;
    `,button:(0,n.css)`
      ${st.button};
    `,buttonDisabled:(0,n.css)`
      ${st.disabled};
      pointer-events: none;
    `,matches:(0,n.css)`
      margin-right: ${_e.spacing(2)};
      text-wrap: nowrap;
    `,tooltip:(0,n.css)`
      color: #aaa;
      margin: 0 0 0 5px;
    `}};var gn=e(15292);function Jn(_e,et){if(!et)return;let st=!1;_e.serviceName&&(et=xs(et,_e),st=!0),_e.spanName&&(et=ms(et,_e),st=!0),(_e.from||_e.to)&&(et=ls(et,_e),st=!0);const pt=_n(et,_e.tags);if(pt&&(et=pt,st=!0),_e.query){const Wt=Zn(_e.query,et);Wt&&(et=Wt,st=!0)}return st?new Set(et.map(Wt=>Wt.spanID)):void 0}function Zn(_e,et){if(!et)return;const st=[];_e.split(/\s+/).filter(Boolean).forEach(dn=>{st.push(dn.toLowerCase())});const pt=(dn,In)=>dn.some(Hn=>In.toLowerCase().includes(Hn)),Wt=dn=>dn?dn.some(In=>pt(st,In.key)||pt(st,In.value.toString())):!1,Xt=dn=>pt(st,dn.operationName)||pt(st,dn.process.serviceName)||Wt(dn.tags)||dn.kind&&pt(st,dn.kind)||dn.statusCode!==void 0&&pt(st,ht.s[dn.statusCode])||dn.statusMessage&&pt(st,dn.statusMessage)||dn.instrumentationLibraryName&&pt(st,dn.instrumentationLibraryName)||dn.instrumentationLibraryVersion&&pt(st,dn.instrumentationLibraryVersion)||dn.traceState&&pt(st,dn.traceState)||dn.logs!==null&&dn.logs.some(In=>Wt(In.fields))||Wt(dn.process.tags)||st.some(In=>In===dn.spanID);return et.filter(Xt)}const _n=(_e,et)=>{if(et=et.filter(st=>st.key&&st.key!==""||st.value),et.length>0)return _e.filter(st=>et.every(pt=>{if(pt.key&&pt.value){if(st.tags.some(Wt=>Ca(pt,Wt))||st.process.tags.some(Wt=>Ca(pt,Wt))||st.logs&&st.logs.some(Wt=>Wt.fields.some(Xt=>Ca(pt,Xt)))||st.kind&&pt.key===en&&pt.value===st.kind||st.statusCode!==void 0&&pt.key===Qt&&pt.value===ht.s[st.statusCode].toLowerCase()||st.statusMessage&&pt.key===An&&pt.value===st.statusMessage||st.instrumentationLibraryName&&pt.key===un&&pt.value===st.instrumentationLibraryName||st.instrumentationLibraryVersion&&pt.key===fn&&pt.value===st.instrumentationLibraryVersion||st.traceState&&pt.key===Tt&&pt.value===st.traceState||pt.key===$t&&pt.value===st.spanID)return za(pt.operator,!0)}else if(pt.key&&(st.tags.some(Wt=>Pa(pt.key,Wt.key))||st.process.tags.some(Wt=>Pa(pt.key,Wt.key))||st.logs&&st.logs.some(Wt=>Wt.fields.some(Xt=>Pa(pt.key,Xt.key)))||st.kind&&pt.key===en||st.statusCode!==void 0&&pt.key===Qt||st.statusMessage&&pt.key===An||st.instrumentationLibraryName&&pt.key===un||st.instrumentationLibraryVersion&&pt.key===fn||st.traceState&&pt.key===Tt||pt.key===$t))return za(pt.operator,!0);return za(pt.operator,!1)}))},Pa=(_e,et)=>_e===et.toString(),Ca=(_e,et)=>_e.key===et.key.toString()&&_e.value===et.value.toString(),za=(_e,et)=>_e==="="?et:!et,xs=(_e,et)=>_e.filter(st=>et.serviceNameOperator==="="?st.process.serviceName===et.serviceName:st.process.serviceName!==et.serviceName),ms=(_e,et)=>_e.filter(st=>et.spanNameOperator==="="?st.operationName===et.spanName:st.operationName!==et.spanName),ls=(_e,et)=>{const st=Ws(et?.from||""),pt=Ws(et?.to||"");let Wt=[];if(st&&(Wt=_e.filter(Xt=>et.fromOperator===">"?Xt.duration>st:Xt.duration>=st)),pt){const Xt=dn=>et.toOperator==="<"?dn.duration<pt:dn.duration<=pt;Wt=Wt.length>0?Wt.filter(dn=>Xt(dn)):_e.filter(dn=>Xt(dn))}return Wt},Ws=_e=>{if(_e.includes("ns"))return parseFloat(_e.split("ns")[0])/1e3;if(_e.includes("us"))return parseFloat(_e.split("us")[0]);if(_e.includes("\xB5s"))return parseFloat(_e.split("\xB5s")[0]);if(_e.includes("ms"))return parseFloat(_e.split("ms")[0])*1e3;if(_e.includes("s"))return parseFloat(_e.split("s")[0])*1e3*1e3;if(_e.includes("m"))return parseFloat(_e.split("m")[0])*1e3*1e3*60;if(_e.includes("h"))return parseFloat(_e.split("h")[0])*1e3*1e3*60*60},is=(0,a.memo)(function(et){const{trace:st,search:pt,spanFilterMatches:Wt,showSpanFilterMatchesOnly:Xt,setShowSpanFilterMatchesOnly:dn,showCriticalPathSpansOnly:In,setShowCriticalPathSpansOnly:Hn,focusedSpanIndexForSearch:ra,setFocusedSpanIndexForSearch:Ba,setFocusedSpanIdForSearch:wa,datasourceType:Ua,clear:Za,showSpanFilters:cs}=et,Ya=(0,f.of)(fs),Ks=(0,a.useMemo)(()=>pt.serviceName&&pt.serviceName!==""||pt.spanName&&pt.spanName!==""||Ws(pt.from||"")||Ws(pt.to||"")||pt.tags.length>1||pt.tags.some(Ge=>Ge.key)||pt.query&&pt.query!==""||Xt,[pt.serviceName,pt.spanName,pt.from,pt.to,pt.tags,pt.query,Xt]);return a.createElement("div",{className:Ya.container},a.createElement("div",{className:Ya.controls},a.createElement(a.Fragment,null,a.createElement("div",null,a.createElement(ft.$n,{variant:"destructive",disabled:!Ks,type:"button",fill:"outline","aria-label":"Clear filters button",onClick:Za},"Clear"),a.createElement("div",{className:Ya.matchesOnly},a.createElement(gn.d,{value:Xt,onChange:Ge=>dn(Ge.currentTarget.checked??!1),label:"Show matches only switch",disabled:!Wt?.size}),a.createElement(ft.$n,{onClick:()=>dn(!Xt),className:Ya.clearMatchesButton,variant:"secondary",fill:"text",disabled:!Wt?.size},"Show matches only")),a.createElement("div",{className:Ya.matchesOnly},a.createElement(gn.d,{value:In,onChange:Ge=>Hn(Ge.currentTarget.checked??!1),label:"Show critical path only switch"}),a.createElement(ft.$n,{onClick:()=>Hn(!In),className:Ya.clearMatchesButton,variant:"secondary",fill:"text"},"Show critical path only"))),a.createElement("div",{className:Ya.nextPrevResult},a.createElement(dt,{trace:st,spanFilterMatches:Wt,setFocusedSpanIdForSearch:wa,focusedSpanIndexForSearch:ra,setFocusedSpanIndexForSearch:Ba,datasourceType:Ua,showSpanFilters:cs})))))}),fs=_e=>{const et=(0,ft.hs)({theme:_e,variant:"secondary",size:"md",iconOnly:!1,fill:"outline"});return{button:(0,n.css)(et.button),buttonDisabled:(0,n.css)(et.disabled,{pointerEvents:"none",cursor:"not-allowed"}),container:(0,n.css)`
      display: inline;
    `,controls:(0,n.css)`
      display: flex;
      justify-content: flex-end;
      margin: 5px 0 0 0;
    `,matchesOnly:(0,n.css)`
      display: inline-flex;
      margin: 0 0 0 25px;
      vertical-align: middle;
      align-items: center;
    `,clearMatchesButton:(0,n.css)`
      color: ${_e.colors.text.primary};

      &:hover {
        background: inherit;
      }
    `,nextPrevResult:(0,n.css)`
      margin-left: auto;
      display: flex;
      align-items: center;
    `}},ys=(0,a.memo)(_e=>{const{trace:et,search:st,setSearch:pt,showSpanFilters:Wt,setShowSpanFilters:Xt,showSpanFilterMatchesOnly:dn,setShowSpanFilterMatchesOnly:In,showCriticalPathSpansOnly:Hn,setShowCriticalPathSpansOnly:ra,setFocusedSpanIdForSearch:Ba,spanFilterMatches:wa,datasourceType:Ua}=_e,Za={...(0,f.of)(Ps)},[cs,Ya]=(0,a.useState)(),[Ks,Ge]=(0,a.useState)(),[Re,qe]=(0,a.useState)(),[ut,Ft]=(0,a.useState)({}),[on,sn]=(0,a.useState)(-1),Ln=/^\d+(?:\.\d)?\d*(?:ns|us|s|ms|s|m|h)$/,qn=(0,a.useCallback)(()=>{Ya(void 0),Ge(void 0),qe(void 0),Ft({}),pt(Ei.Ji),In(!1)},[pt,In]);if((0,a.useEffect)(()=>{qn()},[qn,et]),!et)return null;const na=fa=>{sn(-1),Ba(""),pt(fa)},Sa=()=>{if(!cs){const fa=et.spans.map(Fa=>Fa.process.serviceName);Ya((0,fe.uniq)(fa).sort().map(Pr.z))}},ka=()=>{if(!Ks){const fa=et.spans.map(Fa=>Fa.operationName);Ge((0,fe.uniq)(fa).sort().map(Pr.z))}},Da=()=>{if(!Re){let fa=[],Fa=[];et.spans.forEach(Na=>{Na.tags.forEach(Is=>{fa.push(Is.key)}),Na.process.tags.forEach(Is=>{fa.push(Is.key)}),Na.logs!==null&&Na.logs.forEach(Is=>{Is.fields.forEach(pr=>{Fa.push(pr.key)})}),Na.kind&&fa.push(en),Na.statusCode!==void 0&&fa.push(Qt),Na.statusMessage&&fa.push(An),Na.instrumentationLibraryName&&fa.push(un),Na.instrumentationLibraryVersion&&fa.push(fn),Na.traceState&&fa.push(Tt),fa.push($t)}),fa=(0,fe.uniq)(fa).sort(),Fa=(0,fe.uniq)(Fa).sort(),qe([...fa,...Fa].map(Pr.z))}},ds=async fa=>{const Fa=[];return et.spans.forEach(Na=>{const Is=Na.tags.find(ir=>ir.key===fa)?.value;Is&&Fa.push(Is.toString());const pr=Na.process.tags.find(ir=>ir.key===fa)?.value;switch(pr&&Fa.push(pr.toString()),Na.logs!==null&&Na.logs.forEach(ir=>{const fo=ir.fields.find(ss=>ss.key===fa)?.value;fo&&Fa.push(fo.toString())}),fa){case en:Na.kind&&Fa.push(Na.kind);break;case Qt:Na.statusCode!==void 0&&Fa.push(ht.s[Na.statusCode].toLowerCase());break;case An:Na.statusMessage&&Fa.push(Na.statusMessage);break;case un:Na.instrumentationLibraryName&&Fa.push(Na.instrumentationLibraryName);break;case fn:Na.instrumentationLibraryVersion&&Fa.push(Na.instrumentationLibraryVersion);break;case Tt:Na.traceState&&Fa.push(Na.traceState);break;case $t:Fa.push(Na.spanID);break;default:break}}),(0,fe.uniq)(Fa).sort().map(Pr.z)},Xa=(fa,Fa)=>{pt({...st,tags:st.tags?.map(Is=>Is.id===fa.id?{...Is,key:Fa?.value||"",value:void 0}:Is)}),(async()=>{if(Fa?.value)Ft({...ut,[fa.id]:await ds(Fa.value)});else{const Is={...ut};Is[fa.id]&&delete Is[fa.id],Ft(Is)}})()},qs=()=>{const fa={id:(0,Ei.zE)(),operator:"="};pt({...st,tags:[...st.tags,fa]})},Cs=fa=>{let Fa=st.tags.filter(Na=>Na.id!==fa);Fa.length===0&&(Fa=[{id:(0,Ei.zE)(),operator:"="}]),pt({...st,tags:Fa})},Ss=a.createElement(a.Fragment,null,a.createElement(ke.m,{content:"Filter your spans below. You can continue to apply filters until you have narrowed down your resulting spans to the select few you are most interested in.",placement:"right"},a.createElement("span",{className:Za.collapseLabel},"Span Filters",a.createElement(Me.I,{size:"md",name:"info-circle"}))),!Wt&&a.createElement("div",{className:Za.nextPrevResult},a.createElement(dt,{trace:et,spanFilterMatches:wa,setFocusedSpanIdForSearch:Ba,focusedSpanIndexForSearch:on,setFocusedSpanIndexForSearch:sn,datasourceType:Ua,showSpanFilters:Wt})));return a.createElement("div",{className:Za.container},a.createElement(Mo.S,{label:Ss,collapsible:!0,isOpen:Wt,onToggle:Xt},a.createElement(Jo.C,{className:Za.flexContainer},a.createElement(Kr.I,{label:"Service Name",labelWidth:16},a.createElement(Lo.Gy,{spacing:"xs"},a.createElement($r.l6,{"aria-label":"Select service name operator",onChange:fa=>na({...st,serviceNameOperator:fa.value}),options:[(0,Pr.z)("="),(0,Pr.z)("!=")],value:st.serviceNameOperator}),a.createElement($r.l6,{"aria-label":"Select service name",isClearable:!0,onChange:fa=>na({...st,serviceName:fa?.value||""}),onOpenMenu:Sa,options:cs,placeholder:"All service names",value:st.serviceName||null}))),a.createElement(Ki,{onChange:fa=>{na({...st,query:fa}),fa===""&&In(!1)},value:st.query||""})),a.createElement(Jo.C,null,a.createElement(Kr.I,{label:"Span Name",labelWidth:16},a.createElement(Lo.Gy,{spacing:"xs"},a.createElement($r.l6,{"aria-label":"Select span name operator",onChange:fa=>na({...st,spanNameOperator:fa.value}),options:[(0,Pr.z)("="),(0,Pr.z)("!=")],value:st.spanNameOperator}),a.createElement($r.l6,{"aria-label":"Select span name",isClearable:!0,onChange:fa=>na({...st,spanName:fa?.value||""}),onOpenMenu:ka,options:Ks,placeholder:"All span names",value:st.spanName||null})))),a.createElement(Jo.C,null,a.createElement(Kr.I,{label:"Duration",labelWidth:16,tooltip:"Filter by duration. Accepted units are ns, us, ms, s, m, h"},a.createElement(Lo.Gy,{spacing:"xs",align:"flex-start"},a.createElement($r.l6,{"aria-label":"Select min span operator",onChange:fa=>na({...st,fromOperator:fa.value}),options:[(0,Pr.z)(">"),(0,Pr.z)(">=")],value:st.fromOperator}),a.createElement("div",{className:Za.intervalInput},a.createElement(uo,{ariaLabel:"Select min span duration",onChange:fa=>na({...st,from:fa}),isInvalidError:"Invalid duration",placeholder:"e.g. 100ms, 1.2s",width:18,value:st.from||"",validationRegex:Ln})),a.createElement($r.l6,{"aria-label":"Select max span operator",onChange:fa=>na({...st,toOperator:fa.value}),options:[(0,Pr.z)("<"),(0,Pr.z)("<=")],value:st.toOperator}),a.createElement(uo,{ariaLabel:"Select max span duration",onChange:fa=>na({...st,to:fa}),isInvalidError:"Invalid duration",placeholder:"e.g. 100ms, 1.2s",width:18,value:st.to||"",validationRegex:Ln})))),a.createElement(Jo.C,{className:Za.tagsRow},a.createElement(Kr.I,{label:"Tags",labelWidth:16,tooltip:"Filter by tags, process tags or log fields in your spans."},a.createElement("div",null,st.tags.map((fa,Fa)=>a.createElement("div",{key:Fa},a.createElement(Lo.Gy,{spacing:"xs",width:"auto"},a.createElement($r.l6,{"aria-label":"Select tag key",isClearable:!0,key:fa.key,onChange:Na=>Xa(fa,Na),onOpenMenu:Da,options:Re,placeholder:"Select tag",value:fa.key||null}),a.createElement($r.l6,{"aria-label":"Select tag operator",onChange:Na=>{na({...st,tags:st.tags?.map(Is=>Is.id===fa.id?{...Is,operator:Na.value}:Is)})},options:[(0,Pr.z)("="),(0,Pr.z)("!=")],value:fa.operator}),a.createElement("span",{className:Za.tagValues},a.createElement($r.l6,{"aria-label":"Select tag value",isClearable:!0,key:fa.value,onChange:Na=>{na({...st,tags:st.tags?.map(Is=>Is.id===fa.id?{...Is,value:Na?.value||""}:Is)})},options:ut[fa.id]?ut[fa.id]:[],placeholder:"Select value",value:fa.value})),(fa.key||fa.value||st.tags.length>1)&&a.createElement(ro.Z,{"aria-label":"Remove tag",variant:"secondary",icon:"times",onClick:()=>Cs(fa.id),tooltip:"Remove tag"}),(fa.key||fa.value)&&Fa===st.tags.length-1&&a.createElement("span",{className:Za.addTag},a.createElement(ro.Z,{"aria-label":"Add tag",variant:"secondary",icon:"plus",onClick:qs,tooltip:"Add tag"})))))))),a.createElement(is,{trace:et,search:st,spanFilterMatches:wa,showSpanFilterMatchesOnly:dn,setShowSpanFilterMatchesOnly:In,showCriticalPathSpansOnly:Hn,setShowCriticalPathSpansOnly:ra,setFocusedSpanIdForSearch:Ba,focusedSpanIndexForSearch:on,setFocusedSpanIndexForSearch:sn,datasourceType:Ua,clear:qn,showSpanFilters:Wt})))});ys.displayName="SpanFilters";const Ps=_e=>({container:(0,n.css)`
      label: SpanFilters;
      margin: 0.5em 0 -${_e.spacing(1)} 0;
      z-index: 5;

      & > div {
        border-left: none;
        border-right: none;
      }
    `,collapseLabel:(0,n.css)`
      svg {
        color: #aaa;
        margin: -2px 0 0 10px;
      }
    `,flexContainer:(0,n.css)({display:"flex",justifyContent:"space-between"}),addTag:(0,n.css)({marginLeft:_e.spacing(1)}),intervalInput:(0,n.css)`
      margin: 0 -4px 0 0;
    `,tagsRow:(0,n.css)`
      margin: -4px 0 0 0;
    `,tagValues:(0,n.css)`
      max-width: 200px;
    `,nextPrevResult:(0,n.css)`
      flex: 1;
      align-items: center;
      display: flex;
      justify-content: flex-end;
      margin-right: ${_e.spacing(1)};
    `}),Lr=(0,a.memo)(_e=>{const{trace:et,data:st,app:pt,timeZone:Wt,search:Xt,setSearch:dn,showSpanFilters:In,setShowSpanFilters:Hn,showSpanFilterMatchesOnly:ra,setShowSpanFilterMatchesOnly:Ba,showCriticalPathSpansOnly:wa,setShowCriticalPathSpansOnly:Ua,setFocusedSpanIdForSearch:Za,spanFilterMatches:cs,datasourceType:Ya,setHeaderHeight:Ks}=_e,Ge=(0,f.of)(Gr);(0,a.useEffect)(()=>{Ks(document.querySelector("."+Ge.header)?.scrollHeight??0)},[Ks,In,Ge.header]);const Re=(0,a.useMemo)(()=>et?cn(et):[],[et]);if(!et)return null;const qe=(na,Sa)=>{const ka=(0,gt.LE)(na.startTime/1e3,{timeZone:Sa,defaultWithMS:!0}),Da=ka.match(/^(.+)(:\d\d\.\d+)$/);return Da?a.createElement("span",{className:Ge.TracePageHeaderOverviewItemValue},Da[1],a.createElement("span",{className:Ge.TracePageHeaderOverviewItemValueDetail},Da[2])):ka},ut=a.createElement("h1",{className:y()(Ge.title)},a.createElement(ya,{traceName:ha(et.spans)}),a.createElement("small",{className:Ge.duration},(0,p.a3)(et.duration))),{method:Ft,status:on,url:sn}=Ns(et.spans);let Ln="green";on&&on.length>0&&(on[0].value.toString().charAt(0)==="4"?Ln="orange":on[0].value.toString().charAt(0)==="5"&&(Ln="red"));const qn=na=>a.createElement(a.Fragment,null,a.createElement("div",null,"http.url or http.target or http.path"),a.createElement("div",null,"(",na,")"));return a.createElement("header",{className:Ge.header},a.createElement("div",{className:Ge.titleRow},Re&&Re.length>0&&a.createElement(oo,{links:Re,className:Ge.TracePageHeaderBack}),ut,a.createElement(hs,{traceId:et.traceID,data:st,app:pt})),a.createElement("div",{className:Ge.subtitle},a.createElement("span",{className:Ge.timestamp},qe(et,Wt)),a.createElement("span",{className:Ge.tagMeta},Ft&&Ft.length>0&&a.createElement(ke.m,{content:"http.method",interactive:!0},a.createElement("span",{className:Ge.tag},a.createElement(eo.E,{text:Ft[0].value,color:"blue"}))),on&&on.length>0&&a.createElement(ke.m,{content:"http.status_code",interactive:!0},a.createElement("span",{className:Ge.tag},a.createElement(eo.E,{text:on[0].value,color:Ln}))),sn&&sn.length>0&&a.createElement(ke.m,{content:qn(sn[0].value),interactive:!0},a.createElement("span",{className:Ge.url},sn[0].value)))),a.createElement(ys,{trace:et,showSpanFilters:In,setShowSpanFilters:Hn,showSpanFilterMatchesOnly:ra,setShowSpanFilterMatchesOnly:Ba,showCriticalPathSpansOnly:wa,setShowCriticalPathSpansOnly:Ua,search:Xt,setSearch:dn,spanFilterMatches:cs,setFocusedSpanIdForSearch:Za,datasourceType:Ya}))});Lr.displayName="TracePageHeader";const Gr=_e=>({TracePageHeaderBack:(0,n.css)`
      label: TracePageHeaderBack;
      align-items: center;
      align-self: stretch;
      background-color: #fafafa;
      border-bottom: 1px solid #ddd;
      border-right: 1px solid #ddd;
      color: inherit;
      display: flex;
      font-size: 1.4rem;
      padding: 0 1rem;
      margin-bottom: -1px;
      &:hover {
        background-color: #f0f0f0;
        border-color: #ccc;
      }
    `,TracePageHeaderOverviewItemValueDetail:y()((0,n.css)`
        label: TracePageHeaderOverviewItemValueDetail;
        color: #aaa;
      `,"trace-item-value-detail"),TracePageHeaderOverviewItemValue:(0,n.css)`
      label: TracePageHeaderOverviewItemValue;
      &:hover > .trace-item-value-detail {
        color: unset;
      }
    `,header:(0,n.css)({label:"TracePageHeader",backgroundColor:_e.colors.background.primary,padding:"0.5em 0 0 0",position:"sticky",top:0,zIndex:5,textAlign:"left"}),titleRow:(0,n.css)({alignItems:"flex-start",display:"flex",padding:"0 8px",flexWrap:"wrap"}),title:(0,n.css)({color:"inherit",flex:1,fontSize:"1.7em",lineHeight:"1em",marginBottom:0,minWidth:"200px"}),subtitle:(0,n.css)({flex:1,lineHeight:"1em",margin:"-0.5em 0.5em 0.75em 0.5em"}),tag:(0,n.css)({margin:"0 0.5em 0 0"}),duration:(0,n.css)({color:"#aaa",margin:"0 0.75em"}),timestamp:(0,n.css)({verticalAlign:"middle"}),tagMeta:(0,n.css)({margin:"0 0.75em",verticalAlign:"text-top"}),url:(0,n.css)({margin:"-2.5px 0.3em",height:"15px",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"700px",display:"inline-block"}),TracePageHeaderTraceId:(0,n.css)({label:"TracePageHeaderTraceId",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"30%",display:"inline-block"})}),ei="None",Ji="Duration",ti="Tag";function di({options:_e,onOptionsChange:et}){const st=useStyles2(Oi),pt=[ei,Ji,ti].map(toOption);return React.createElement("div",{className:css({width:"100%"})},React.createElement(InlineFieldRow,{className:st.row},React.createElement(InlineField,{label:"Label",labelWidth:26,tooltip:"Default: duration",grow:!0},React.createElement(Select,{inputId:"label",options:pt,value:_e.jsonData.spanBar?.type||"",onChange:Wt=>{updateDatasourcePluginJsonDataOption({onOptionsChange:et,options:_e},"spanBar",{..._e.jsonData.spanBar,type:Wt?.value??""})},placeholder:"Duration",isClearable:!0,"aria-label":"select-label-name",width:40}))),_e.jsonData.spanBar?.type===ti&&React.createElement(InlineFieldRow,{className:st.row},React.createElement(InlineField,{label:"Tag key",labelWidth:26,tooltip:"Tag key which will be used to get the tag value. A span's attributes and resources will be searched for the tag key"},React.createElement(Input,{type:"text",placeholder:"Enter tag key",onChange:Wt=>updateDatasourcePluginJsonDataOption({onOptionsChange:et,options:_e},"spanBar",{..._e.jsonData.spanBar,tag:Wt.currentTarget.value}),value:_e.jsonData.spanBar?.tag||"",width:40}))))}const $i=({options:_e,onOptionsChange:et})=>{let st=_e.type;return st+=_e.type==="tempo"?"/configure-tempo-data-source/#span-bar":"/#span-bar",React.createElement(ConfigSubSection,{title:"Span bar",description:React.createElement(ConfigDescriptionLink,{description:"Add additional info next to the service and operation on a span bar row in the trace view.",suffix:st,feature:"the span bar"})},React.createElement(di,{options:_e,onOptionsChange:et}))},Oi=_e=>({infoText:css`
    label: infoText;
    padding-bottom: ${_e.spacing(2)};
    color: ${_e.colors.text.secondary};
  `,row:css`
    label: row;
    align-items: baseline;
  `});class xo{constructor(et){const{isTagsOpen:st,isProcessOpen:pt,isReferencesOpen:Wt,isWarningsOpen:Xt,isStackTracesOpen:dn,logs:In,references:Hn}=et||{};this.isTagsOpen=!!st,this.isProcessOpen=!!pt,this.isReferencesOpen=!!Wt,this.isWarningsOpen=!!Xt,this.isStackTracesOpen=!!dn,this.logs={isOpen:!!(In&&In.isOpen),openedItems:In&&In.openedItems?new Set(In.openedItems):new Set},this.references={isOpen:!!(Hn&&Hn.isOpen),openedItems:Hn&&Hn.openedItems?new Set(Hn.openedItems):new Set}}toggleTags(){const et=new xo(this);return et.isTagsOpen=!this.isTagsOpen,et}toggleProcess(){const et=new xo(this);return et.isProcessOpen=!this.isProcessOpen,et}toggleReferences(){const et=new xo(this);return et.references.isOpen=!this.references.isOpen,et}toggleReferenceItem(et){const st=new xo(this);return st.references.openedItems.has(et)?st.references.openedItems.delete(et):st.references.openedItems.add(et),st}toggleWarnings(){const et=new xo(this);return et.isWarningsOpen=!this.isWarningsOpen,et}toggleStackTraces(){const et=new xo(this);return et.isStackTracesOpen=!this.isStackTracesOpen,et}toggleLogs(){const et=new xo(this);return et.logs.isOpen=!this.logs.isOpen,et}toggleLogItem(et){const st=new xo(this);return st.logs.openedItems.has(et)?st.logs.openedItems.delete(et):st.logs.openedItems.add(et),st}}var Vi=e(25508);class Zo{static iterFunction(et,st=0){return pt=>et(pt.value,pt,st)}static searchFunction(et){return typeof et=="function"?et:(st,pt)=>et instanceof Zo?pt===et:st===et}constructor(et,st=[]){this.value=et,this.children=st}get depth(){return this.children.reduce((et,st)=>Math.max(st.depth+1,et),1)}get size(){let et=0;return this.walk(()=>et++),et}addChild(et){return this.children.push(et instanceof Zo?et:new Zo(et)),this}find(et){if(Zo.iterFunction(Zo.searchFunction(et))(this))return this;for(let pt=0;pt<this.children.length;pt++){const Wt=this.children[pt].find(et);if(Wt)return Wt}return null}getPath(et){const st=Zo.iterFunction(Zo.searchFunction(et)),pt=(Wt,Xt)=>{const dn=Xt.concat([Wt]);if(st(Wt))return dn;for(let In=0;In<Wt.children.length;In++){const Hn=Wt.children[In],ra=pt(Hn,dn);if(ra)return ra}return null};return pt(this,[])}walk(et,st=0){const pt=[];let Wt=st;for(pt.push({node:this,depth:Wt});pt.length;){const Xt=pt[pt.length-1];pt.pop();const{node:dn,depth:In}=Xt;et(dn.value,dn,In),Wt=In+1;let Hn=dn.children.length-1;for(;Hn>=0;)pt.push({node:dn.children[Hn],depth:Wt}),Hn--}}paths(et){const st=[];st.push({node:this,childIndex:0});const pt=[];for(;st.length;){const{node:Wt,childIndex:Xt}=st[st.length-1];if(Wt.children.length>=Xt+1)st[st.length-1].childIndex++,st.push({node:Wt.children[Xt],childIndex:0});else{if(Wt.children.length===0){const dn=st.map(In=>In.node.value);et(dn)}st.pop()}}return pt}}const yi=_e=>_e.spanID,Ii=_e=>_e.references||[],bi=(0,Vi.Mz)((0,Vi.Mz)(({span:_e})=>_e,Ii),({type:_e})=>_e,(_e,et)=>_e.find(st=>st.refType===et)),$l=(0,Vi.Mz)(_e=>bi({span:_e,type:"CHILD_OF"}),_e=>_e?_e.spanID:null),Vl=_e=>_e.spans,Ai=(0,Vi.Mz)(Vl,_e=>_e.reduce((et,st)=>et.set(yi(st),st),new Map)),Ri="__root__";function zl(_e,et=null){const st=new Map(_e.spans.map(dn=>[dn.spanID,new Zo(dn.spanID)])),pt=et??new Map(_e.spans.map(dn=>[dn.spanID,dn])),Wt=new Zo(Ri);_e.spans.forEach(dn=>{const In=st.get(dn.spanID);if(Array.isArray(dn.references)&&dn.references.length){const{refType:Hn,spanID:ra}=dn.references[0];if(Hn==="CHILD_OF"||Hn==="FOLLOWS_FROM")(st.get(ra)||Wt).children?.push(In);else throw new Error(`Unrecognized ref type: ${Hn}`)}else Wt.children.push(In)});const Xt=(dn,In)=>{const Hn=dn?.value?pt.get(dn.value.toString()):void 0,ra=In?.value?pt.get(In.value.toString()):void 0;return+(Hn?.startTime>ra?.startTime)||+(Hn?.startTime===ra?.startTime)-1};return _e.spans.forEach(dn=>{const In=st.get(dn.spanID);In.children.length>1&&In?.children.sort(Xt)}),Wt.children.sort(Xt),Wt}function ul(_e){const et=new Map,st=_e.reduce((Wt,Xt)=>(Wt.some(dn=>dn.key===Xt.key&&dn.value===Xt.value)?et.set(`${Xt.key}:${Xt.value}`,`Duplicate tag "${Xt.key}:${Xt.value}"`):Wt.push(Xt),Wt),[]),pt=Array.from(et.values());return{dedupedTags:st,warnings:pt}}function Di(_e,et){const st=_e?.slice()??[],pt=(et||[]).map(Wt=>Wt.toLowerCase());return st.sort((Wt,Xt)=>{const dn=Wt.key.toLowerCase(),In=Xt.key.toLowerCase();for(let Hn=0;Hn<pt.length;Hn++){const ra=pt[Hn];if(dn.startsWith(ra)&&!In.startsWith(ra))return-1;if(!dn.startsWith(ra)&&In.startsWith(ra))return 1}return dn>In?1:dn<In?-1:0}),st}function Os(_e){if(!_e?.traceID)return null;const et=_e.traceID.toLowerCase();let st=0,pt=Number.MAX_SAFE_INTEGER;const Wt=new Map,Xt=new Map;_e.spans=_e.spans.filter(Ua=>!!Ua.startTime),_e.processes=Object.entries(_e.processes).reduce((Ua,[Za,cs])=>(Ua[Za]={...cs,tags:Di(cs.tags)},Ua),{});const dn=_e.spans.length;for(let Ua=0;Ua<dn;Ua++){const Za=_e.spans[Ua],{startTime:cs,duration:Ya,processID:Ks}=Za;let Ge=Za.spanID;cs<pt&&(pt=cs),cs+Ya>st&&(st=cs+Ya);const Re=Wt.get(Ge);Re!=null?(console.warn(`Dupe spanID, ${Re+1} x ${Ge}`,Za,Xt.get(Ge)),(0,fe.isEqual)(Za,Xt.get(Ge))&&console.warn("	 two spans with same ID have `isEqual(...) === true`"),Wt.set(Ge,Re+1),Ge=`${Ge}_${Re}`,Za.spanID=Ge):Wt.set(Ge,1),Za.process=_e.processes[Ks],Xt.set(Ge,Za)}const In=zl(_e,Xt),Hn=[],ra={};In.walk((Ua,Za,cs=0)=>{if(Ua==="__root__"||typeof Ua!="string")return;const Ya=Xt.get(Ua);if(!Ya)return;const{serviceName:Ks}=Ya.process;ra[Ks]=(ra[Ks]||0)+1,Ya.relativeStartTime=Ya.startTime-pt,Ya.depth=cs-1,Ya.hasChildren=Za.children.length>0,Ya.childSpanCount=Za.children.length,Ya.warnings=Ya.warnings||[],Ya.tags=Ya.tags||[],Ya.references=Ya.references||[],Ya.childSpanIds=Za.children.slice().sort((Re,qe)=>{const ut=Xt.get(Re.value),Ft=Xt.get(qe.value);return Ft.startTime+Ft.duration-(ut.startTime+ut.duration)}).map(Re=>Re.value);const Ge=ul(Ya.tags);Ya.tags=Di(Ge.dedupedTags,nr("topTagPrefixes")),Ya.warnings=Ya.warnings.concat(Ge.warnings),Ya.references.forEach((Re,qe)=>{const ut=Xt.get(Re.spanID);ut&&(Re.span=ut,qe>0&&(ut.subsidiarilyReferencedBy=ut.subsidiarilyReferencedBy||[],ut.subsidiarilyReferencedBy.push({spanID:Ua,traceID:et,span:Ya,refType:Re.refType})))}),Hn.push(Ya)});const Ba=ha(Hn);return{services:Object.keys(ra).map(Ua=>({name:Ua,numberOfSpans:ra[Ua]})),spans:Hn,traceID:et,traceName:Ba,processes:_e.processes,duration:st-pt,startTime:pt,endTime:st}}},92102:(Q,I,e)=>{"use strict";e.d(I,{N:()=>n});var n=(a=>(a.Logs="log",a.Traces="trace",a.Metrics="metric",a.Profiles="profile",a.Unknown="unknown",a))(n||{})},92151:(Q,I,e)=>{"use strict";e.d(I,{EUpdateTypes:()=>a,default:()=>i});var n=(f=>(f.DragEnd="DragEnd",f.DragMove="DragMove",f.DragStart="DragStart",f.MouseEnter="MouseEnter",f.MouseLeave="MouseLeave",f.MouseMove="MouseMove",f))(n||{});const a=n;var o=e(2543);const r=0;class i{constructor({getBounds:d,tag:l,resetBoundsOnResize:m=!0,...s}){this.resetBounds=()=>{this._bounds=void 0},this._handleMinorMouseEvent=h=>{const{button:u,clientX:b,type:g}=h;if(this._isDragging||u!==r)return;let P=null,c;if(g==="mouseenter")P=a.MouseEnter,c=this._onMouseEnter;else if(g==="mouseleave")P=a.MouseLeave,c=this._onMouseLeave;else if(g==="mousemove")P=a.MouseMove,c=this._onMouseMove;else throw new Error(`invalid event type: ${g}`);if(!c)return;const{value:y,x:p}=this._getPosition(b);c({event:h,type:P,value:y,x:p,manager:this,tag:this.tag})},this._handleDragEvent=h=>{const{button:u,clientX:b,type:g}=h;let P=null,c;if(g==="mousedown"){if(this._isDragging||u!==r)return;window.addEventListener("mousemove",this._handleDragEvent),window.addEventListener("mouseup",this._handleDragEvent);const v=(0,o.get)(document,"body.style");v&&(v.userSelect="none"),this._isDragging=!0,P=a.DragStart,c=this._onDragStart}else if(g==="mousemove"){if(!this._isDragging)return;P=a.DragMove,c=this._onDragMove}else if(g==="mouseup"){if(!this._isDragging)return;this._stopDragging(),P=a.DragEnd,c=this._onDragEnd}else throw new Error(`invalid event type: ${g}`);if(!c)return;const{value:y,x:p}=this._getPosition(b);c({event:h,type:P,value:y,x:p,manager:this,tag:this.tag})},this.handleMouseDown=this._handleDragEvent,this.handleMouseEnter=this._handleMinorMouseEvent,this.handleMouseMove=this._handleMinorMouseEvent,this.handleMouseLeave=this._handleMinorMouseEvent,this.getBounds=d,this.tag=l,this._isDragging=!1,this._bounds=void 0,this._resetBoundsOnResize=!!m,this._resetBoundsOnResize&&window.addEventListener("resize",this.resetBounds),this._onMouseEnter=s.onMouseEnter,this._onMouseLeave=s.onMouseLeave,this._onMouseMove=s.onMouseMove,this._onDragStart=s.onDragStart,this._onDragMove=s.onDragMove,this._onDragEnd=s.onDragEnd}_getBounds(){return this._bounds||(this._bounds=this.getBounds(this.tag)),this._bounds}_getPosition(d){const{clientXLeft:l,maxValue:m,minValue:s,width:h}=this._getBounds();let u=d-l,b=u/h;return s!=null&&b<s?(b=s,u=s*h):m!=null&&b>m&&(b=m,u=m*h),{value:b,x:u}}_stopDragging(){window.removeEventListener("mousemove",this._handleDragEvent),window.removeEventListener("mouseup",this._handleDragEvent);const d=(0,o.get)(document,"body.style");d&&(d.userSelect="auto"),this._isDragging=!1}isDragging(){return this._isDragging}dispose(){this._isDragging&&this._stopDragging(),this._resetBoundsOnResize&&window.removeEventListener("resize",this.resetBounds),this._bounds=void 0,this._onMouseEnter=void 0,this._onMouseLeave=void 0,this._onMouseMove=void 0,this._onDragStart=void 0,this._onDragMove=void 0,this._onDragEnd=void 0}}},30700:(Q,I,e)=>{"use strict";e.d(I,{Kv:()=>l,rY:()=>m});var n=e(41811),a=e(84140),o=e(24284);function r(h){if(h.length!==7)return[0,0,0];const u=h.slice(1,3),b=h.slice(3,5),g=h.slice(5);return[parseInt(u,16),parseInt(b,16),parseInt(g,16)]}class i{constructor(u,b){const g=s(u,b);this.colorsHex=g,this.colorsRgb=g.map(r),this.cache=new Map,this.prevColorIndex=void 0}_getColorIndex(u){let b=this.cache.get(u);if(b==null){const g=this.hashCode(u?u.toLowerCase():"");if(b=Math.abs(g%this.colorsHex.length),this.prevColorIndex!==void 0){this.prevColorIndex===b&&(b=this.getNextIndex(b));const P=this.colorsHex[this.prevColorIndex];if(a.A.readability(P,this.colorsHex[b])<1.5){let c=b;for(let y=0;y<this.colorsHex.length;y++)if(c=this.getNextIndex(c),a.A.readability(P,this.colorsHex[c])>1.5){b=c;break}}}this.cache.set(u,b),this.prevColorIndex=b}return b}getNextIndex(u){return u+1<this.colorsHex.length?u+1:0}hashCode(u){let b=0,g,P;for(g=0;g<u.length;g++)P=u.charCodeAt(g),b=(b<<5)-b+P;return b}getColorByKey(u){const b=this._getColorIndex(u);return this.colorsHex[b]}getRgbColorByKey(u){const b=this._getColorIndex(u);return this.colorsRgb[b]}clear(){this.cache.clear()}}const f=(0,n.A)((h,u)=>new i(h,u));function d(h){f([],h)}function l(h,u){return f(o.Tj,u).getColorByKey(h)}function m(h,u){return f(o.Tj,u).getRgbColorByKey(h)}function s(h,u){const b=[...h],g=b.indexOf("#E24D42");g>-1&&b.splice(g,1);const P=h.indexOf("#BF1B00");P>-1&&b.splice(P,1);let c=[];for(const y of b)a.A.readability(u.colors.background.primary,y)>=3&&c.push(y);return c}},6389:(Q,I,e)=>{"use strict";e.d(I,{a3:()=>v});var n=e(2543),a=e.n(n),o=e(84743),r=e.n(o);const i="YYYY-MM-DD",f="HH:mm",d=1e3,l=1e3*d,m=60*l,s=60*m,h=24*s,u=Math.log10(d),b=[{unit:"d",microseconds:h,ofPrevious:24},{unit:"h",microseconds:s,ofPrevious:60},{unit:"m",microseconds:m,ofPrevious:60},{unit:"s",microseconds:l,ofPrevious:1e3},{unit:"ms",microseconds:d,ofPrevious:1e3},{unit:"\u03BCs",microseconds:1,ofPrevious:1e3}],g=(D,E,S)=>toFloatPrecision(D/S,E)*S;function P(D){return moment(D/d).format(i)}function c(D){return moment(D/d).format(f)}function y(D){const E=g(D,u,d);return`${moment.duration(E/d).asMilliseconds()}ms`}function p(D){const E=g(D,u,l);return`${moment.duration(E/d).asSeconds()}s`}function v(D){const[E,S]=(0,n.dropWhile)(b,({microseconds:C},O)=>O<b.length-1&&C>D);if(E.ofPrevious===1e3)return`${(0,n.round)(D/E.microseconds,2)}${E.unit}`;const M=`${Math.floor(D/E.microseconds)}${E.unit}`,A=Math.round(D/S.microseconds%E.ofPrevious),x=`${A}${S.unit}`;return A===0?M:`${M} ${x}`}},28114:(Q,I,e)=>{"use strict";e.d(I,{Cr:()=>A,QW:()=>g,_o:()=>E,gt:()=>T,hv:()=>M,i0:()=>b,lU:()=>s});var n=e(96540),a=e(6709),o=e(65879),r=e(47232),i=e(72574),f=e(14578),d=e(31193),l=e(96192),m=e(92102);function s({splitOpenFn:x,traceToLogsOptions:C,traceToMetricsOptions:O,traceToProfilesOptions:R,dataFrame:L,createFocusSpanLink:N,trace:F}){if(!L)return;let K=T(F.duration,F.traceName,F.traceID);const B=L.fields.some(U=>!!U.config.links?.length),w=P(x,L.fields[0],C,O,N,K);return function(W){let V=w(W);if(B){K={...K,...M(W),...A(W,R)};const _=L.fields.filter(H=>!!H.config.links?.length);try{let H;R?.datasourceUid&&(H=(0,d.tR)().getInstanceSettings(R.datasourceUid));const G=H?.type==="grafana-pyroscope-datasource",j=W.tags.some(ne=>ne.key===g),Y=G&&j;let oe=[];_.forEach(ne=>{const ee=(0,l.QL)({field:ne,rowIndex:W.dataFrameRowIndex,splitOpenFn:x,range:S(W,void 0,void 0,Y),dataFrame:L,vars:K});oe=oe.concat(ee)});const se=oe.map(ne=>({title:ne.title,href:ne.href,onClick:ne.onClick,content:n.createElement(f.I,{name:"link",title:ne.title||"Link"}),field:ne.origin,type:Y?m.N.Profiles:m.N.Unknown}));V.push.apply(V,se)}catch(H){return console.error(H),V}}return V}}const h=x=>x.map(C=>({key:C,value:C.includes(".")?C.replace(".","_"):void 0})),u=h(["cluster","hostname","namespace","pod","service.name","service.namespace"]),b=h(["service.name","service.namespace"]),g="pyroscope.profile.id";function P(x,C,O,R,L,N){let F;O?.datasourceUid&&(F=(0,d.tR)().getInstanceSettings(O.datasourceUid));const K=F?.type==="grafana-splunk-datasource";let B;return R?.datasourceUid&&(B=(0,d.tR)().getInstanceSettings(R.datasourceUid)),function(U){N={...N,...M(U)};const W=[];let V,_="";if(F&&O){const H=O.customQuery?O.query:void 0,G=O.tags&&O.tags.length>0?O.tags:u;switch(F?.type){case"loki":_=E(U,G),V=c(U,O,_,H);break;case"grafana-splunk-datasource":_=E(U,G,{joinBy:" "}),V=p(U,O,_,H);break;case"elasticsearch":case"grafana-opensearch-datasource":_=E(U,G,{labelValueSign:":",joinBy:" AND "}),V=y(U,O,_,H);break;case"grafana-falconlogscale-datasource":_=E(U,G,{joinBy:" OR "}),V=D(U,O,_,H);break;case"googlecloud-logging-datasource":_=E(U,G,{joinBy:" AND "}),V=v(U,O,_,H)}if(V){const j={title:F.name,url:"",internal:{datasourceUid:F.uid,datasourceName:F.name,query:V}};if(N={...N,__tags:{text:"Tags",value:_}},(0,l.O1)(j.internal.query,N).allVariablesDefined){const Y=(0,a.u)({link:j,internalLink:j.internal,scopedVars:N,range:S(U,{startMs:O.spanStartTimeShift?o.intervalToMs(O.spanStartTimeShift):0,endMs:O.spanEndTimeShift?o.intervalToMs(O.spanEndTimeShift):0},K),field:{},onClickFn:x,replaceVariables:(0,i.w)().replace.bind((0,i.w)())});W.push({href:Y.href,title:"Related logs",onClick:Y.onClick,content:n.createElement(f.I,{name:"gf-logs",title:"Explore the logs for this in split view"}),field:C,type:m.N.Logs})}}}if(B&&R?.queries)for(const H of R.queries){const G=H.query||`histogram_quantile(0.5, sum(rate(traces_spanmetrics_latency_bucket{service="${U.process.serviceName}"}[5m])) by (le))`,j={title:B.name,url:"",internal:{datasourceUid:B.uid,datasourceName:B.name,query:{expr:G,refId:"A"}}},Y=R.tags&&R.tags.length>0?R.tags:u;N={...N,__tags:{text:"Tags",value:E(U,Y)}};const oe=(0,a.u)({link:j,internalLink:j.internal,scopedVars:N,range:S(U,{startMs:R.spanStartTimeShift?o.intervalToMs(R.spanStartTimeShift):-12e4,endMs:R.spanEndTimeShift?o.intervalToMs(R.spanEndTimeShift):12e4}),field:{},onClickFn:x,replaceVariables:(0,i.w)().replace.bind((0,i.w)())});W.push({title:H?.name,href:oe.href,onClick:oe.onClick,content:n.createElement(f.I,{name:"chart-line",title:"Explore metrics for this span"}),field:C,type:m.N.Metrics})}if(U.references&&L)for(const H of U.references){if(H.refType==="CHILD_OF")continue;const G=L(H.traceID,H.spanID);W.push({href:G.href,title:H.span?H.span.operationName:"View linked span",content:n.createElement(f.I,{name:"link",title:"View linked span"}),onClick:G.onClick,field:G.origin,type:m.N.Traces})}if(U.subsidiarilyReferencedBy&&L)for(const H of U.subsidiarilyReferencedBy){const G=L(H.traceID,H.spanID);W.push({href:G.href,title:H.span?H.span.operationName:"View linked span",content:n.createElement(f.I,{name:"link",title:"View linked span"}),onClick:G.onClick,field:G.origin,type:m.N.Traces})}return W}}function c(x,C,O,R){const{filterByTraceID:L,filterBySpanID:N}=C;if(R)return{expr:R,refId:""};if(!O)return;let F="{${__tags}}";return L&&x.traceID&&(F+=' |="${__span.traceId}"'),N&&x.spanID&&(F+=' |="${__span.spanId}"'),{expr:F,refId:""}}function y(x,C,O,R){const{filterByTraceID:L,filterBySpanID:N}=C;if(R)return{query:R,refId:"",metrics:[{id:"1",type:"logs"}]};let F=[];return N&&x.spanID&&F.push('"${__span.spanId}"'),L&&x.traceID&&F.push('"${__span.traceId}"'),O&&F.push("${__tags}"),{query:F.join(" AND "),refId:"",metrics:[{id:"1",type:"logs"}]}}function p(x,C,O,R){const{filterByTraceID:L,filterBySpanID:N}=C;if(R)return{query:R,refId:""};let F="";return O&&(F+="${__tags}"),L&&x.traceID&&(F+=' "${__span.traceId}"'),N&&x.spanID&&(F+=' "${__span.spanId}"'),{query:F,refId:""}}function v(x,C,O,R){const{filterByTraceID:L,filterBySpanID:N}=C;if(R)return{query:R,refId:""};let F=[];return N&&x.spanID&&F.push('"${__span.spanId}"'),L&&x.traceID&&F.push('"${__span.traceId}"'),O&&F.push("${__tags}"),{query:F.join(" AND "),refId:""}}function D(x,C,O,R){const{filterByTraceID:L,filterBySpanID:N}=C;if(R)return{lsql:R,refId:""};if(!O)return;let F="${__tags}";return L&&x.traceID&&(F+=' or "${__span.traceId}"'),N&&x.spanID&&(F+=' or "${__span.spanId}"'),{lsql:F,refId:""}}function E(x,C,{labelValueSign:O="=",joinBy:R=", "}={}){return[...x.process.tags,...x.tags,{key:"spanId",value:x.spanID},{key:"traceId",value:x.traceID},{key:"name",value:x.operationName},{key:"duration",value:x.duration}].map(L=>{const N=C.find(F=>F.key===L.key);if(N)return`${N.value?N.value:N.key}${O}"${L.value}"`}).filter(L=>!!L).join(R)}function S(x,C={startMs:0,endMs:0},O=!1,R=!1){let L=Math.floor(x.startTime/1e3+C.startMs);const N=(x.startTime+x.duration)/1e3;let F=Math.floor(N+C.endMs);O&&F-L<1e3?F=L+1e3:R?(L=L-6e4,F=F+6e4):L===F&&F++;const K=(0,r.KQ)(F),B=(0,r.KQ)(L);return{from:B,to:K,raw:{from:B,to:K}}}function T(x,C,O){return{__trace:{text:"Trace",value:{duration:x,name:C,traceId:O}}}}function M(x){const C={};for(const O of x.process.tags)C[O.key]=O.value;for(const O of x.tags)C[O.key]=O.value;return{__span:{text:"Span",value:{spanId:x.spanID,traceId:x.traceID,duration:x.duration,name:x.operationName,tags:C}}}}function A(x,C){let O={};if(C){const R=C.tags&&C.tags.length>0?C.tags:b;O={__tags:{text:"Tags",value:E(x,R)}}}return O}},15583:(Q,I,e)=>{"use strict";e.d(I,{Ji:()=>f,SQ:()=>d,zE:()=>r});var n=e(96540),a=e(62938),o=e(56271);const r=()=>(0,a.A)().slice(0,12),f={spanNameOperator:"=",serviceNameOperator:"=",fromOperator:">",toOperator:"<",tags:[{id:r(),operator:"="}]};function d(l){const[m,s]=(0,n.useState)(f),h=(0,n.useMemo)(()=>l&&(0,o.filterSpans)(m,l),[m,l]);return{search:m,setSearch:s,spanFilterMatches:h}}},35090:(Q,I,e)=>{"use strict";e.d(I,{L:()=>o});var n=e(78368),a=e(56271);function o(i){if(!i)return null;let f=i.fields.length===1?i.fields[0].values[0]:r(i);return f?(0,a.transformTraceData)(f):null}function r(i){const f=new n.R(i),d={};for(let l=0;l<f.length;l++){const m=f.get(l);if(!m.spanID)return null;d[m.spanID]||(d[m.spanID]={serviceName:m.serviceName,tags:m.serviceTags})}return{traceID:f.get(0).traceID,processes:d,spans:f.toArray().map((l,m)=>{const s=[];return l.parentSpanID&&s.push({refType:"CHILD_OF",spanID:l.parentSpanID,traceID:l.traceID}),l.references&&s.push(...l.references.map(h=>({refType:"FOLLOWS_FROM",...h}))),{...l,duration:l.duration*1e3,startTime:l.startTime*1e3,processID:l.spanID,flags:0,references:s,logs:l.logs?.map(h=>({...h,timestamp:h.timestamp*1e3}))||[],dataFrameRowIndex:m}})}}},11140:(Q,I,e)=>{"use strict";e.d(I,{v:()=>L});var n=e(2543),a=e(96540),o=e(49785),r=e(71733),i=e(14110),f=e(12131),d=e(32264),l=e(88575),m=e(94354),s=e(42418),h=e(37390),u=e(55852),b=e(59429),g=e(16233),P=e(20470),c=e(31678),y=e(9955),p=e(28676),v=e(71176),D=(N=>(N.FETCH_DASHBOARD="fetch-dashboard",N.SET_DASHBOARD_LS="set-dashboard-ls-error",N))(D||{});function E(N,F){let K=[];return N==="table"&&F.panelState?.logs?.columns&&(F.panelState.logs?.labelFieldName&&K.push({id:"extractFields",options:{source:F.panelState.logs.labelFieldName}}),K.push({id:"organize",options:{indexByName:Object.values(F.panelState.logs.columns).reduce((B,w,U)=>({...B,[w]:U}),{}),includeByName:Object.values(F.panelState.logs.columns).reduce((B,w)=>({...B,[w]:!0}),{})}})),K}async function S(N){const F=A(N.queries,N.queryResponse,N?.panelState),K={targets:N.queries,type:F,title:"New Panel",gridPos:{x:0,y:0,w:12,h:8},datasource:N.datasource,transformations:E(F,N)};let B;if(N.dashboardUid)try{B=await(0,p.n)().getDashboardDTO(N.dashboardUid)}catch{throw"fetch-dashboard"}else B=await(0,v.X)();B.dashboard.panels=[K,...B.dashboard.panels??[]],B.dashboard.time=N.time;try{(0,P.OI)(B)}catch{throw"set-dashboard-ls-error"}}const T=N=>!N.hide,M=N=>F=>F.refId===N;function A(N,F,K){for(const{refId:B}of N.filter(T)){const w=M(B);if(F.flameGraphFrames.some(w))return"flamegraph";if(F.graphFrames.some(w))return"timeseries";if(F.logsFrames.some(w))return K?.logs?.visualisationType?K.logs.visualisationType:"logs";if(F.nodeGraphFrames.some(w))return"nodeGraph";if(F.traceFrames.some(w))return"traces";if(F.customFrames.some(w))return F.customFrames.find(w)?.meta?.preferredVisualisationPluginId??"table"}return"table"}var x=(N=>(N.NewDashboard="new-dashboard",N.ExistingDashboard="existing-dashboard",N))(x||{});function C(N){}function O(N){return N?`d/${N}`:"dashboard/new"}var R=(N=>(N.UNKNOWN="unknown-error",N.NAVIGATION="navigation-error",N))(R||{});function L(N){const{exploreId:F,onClose:K}=N,B=(0,c.useSelector)((0,y.qq)(F)),[w,U]=(0,a.useState)(),{handleSubmit:W,control:V,formState:{errors:_},watch:H}=(0,o.mN)({defaultValues:{saveTarget:"new-dashboard"}}),G=g.TP.hasPermission(c.AccessControlAction.DashboardsCreate),j=g.TP.hasPermission(c.AccessControlAction.DashboardsWrite),Y=[];G&&Y.push({label:"New dashboard",value:"new-dashboard"}),j&&Y.push({label:"Existing dashboard",value:"existing-dashboard"});const oe=Y.length>1?H("saveTarget"):Y[0].value,se=async(ne,ee)=>{U(void 0);const Z=ee.saveTarget==="existing-dashboard"?ee.dashboardUid:void 0;(0,i.rR)("e_2_d_submit",{newTab:ne,saveTarget:ee.saveTarget,queries:B.queries.length});const{from:z,to:q}=B.range.raw;try{await S({dashboardUid:Z,datasource:B.datasourceInstance?.getRef(),queries:B.queries,queryResponse:B.queryResponse,panelState:B?.panelsState,time:{from:typeof z=="string"?z:z.toISOString(),to:typeof q=="string"?q:q.toISOString()}})}catch(ue){switch(ue){case D.FETCH_DASHBOARD:U({error:ue,message:"Could not fetch dashboard information. Please try again."});break;case D.SET_DASHBOARD_LS:U({error:ue,message:"Could not add panel to dashboard. Please try again."});break;default:U({error:"unknown-error",message:"Something went wrong. Please try again."})}return}const ie=O(Z);if(!ne){K(),f.Ny.push(r.I.stripBaseFromUrl(ie));return}if(!!!e.g.open(d.$.appUrl+ie,"_blank")){U({error:"navigation-error",message:"Could not navigate to the selected dashboard. Please try again."}),(0,P.yZ)();return}K()};return(0,a.useEffect)(()=>{(0,i.rR)("e_2_d_open")},[]),a.createElement("form",null,Y.length>1&&a.createElement(o.xI,{control:V,render:({field:{ref:ne,...ee}})=>a.createElement(l.D,{label:"Target dashboard",description:"Choose where to add the panel."},a.createElement(m.z,{options:Y,...ee,id:"e2d-save-target"})),name:"saveTarget"}),oe==="existing-dashboard"&&a.createElement(o.xI,{render:({field:{ref:ne,value:ee,onChange:Z,...z}})=>a.createElement(l.D,{label:"Dashboard",description:"Select in which dashboard the panel will be created.",error:_.dashboardUid?.message,invalid:!!_.dashboardUid},a.createElement(b.b,{...z,inputId:"e2d-dashboard-picker",defaultOptions:!0,onChange:q=>Z(q?.uid)})),control:V,name:"dashboardUid",shouldUnregister:!0,rules:{required:{value:!0,message:"This field is required."}}}),w&&a.createElement(s.F,{severity:"error",title:"Error adding the panel"},w.message),a.createElement(h.a.ButtonRow,null,a.createElement(u.$n,{type:"reset",onClick:K,fill:"outline",variant:"secondary"},"Cancel"),a.createElement(u.$n,{type:"submit",variant:"secondary",onClick:W((0,n.partial)(se,!0)),icon:"external-link-alt"},"Open in new tab"),a.createElement(u.$n,{type:"submit",variant:"primary",onClick:W((0,n.partial)(se,!1)),icon:"apps"},"Open dashboard")))}},12881:(Q,I,e)=>{"use strict";e.d(I,{t:()=>o});var n=e(16233),a=e(31678);function o(){const r=n.TP.hasPermission(a.AccessControlAction.DashboardsCreate),i=n.TP.hasPermission(a.AccessControlAction.DashboardsWrite);return r&&!i?"Add panel to new dashboard":i&&!r?"Add panel to existing dashboard":"Add panel to dashboard"}},24401:(Q,I,e)=>{"use strict";e.d(I,{s:()=>d});var n=e(96540),a=e(71733),o=e(12131),r=e(37390),i=e(67061),f=e(55852);function d(l){const{onDismiss:m,path:s,title:h}=l,u=()=>{e.g.open(a.I.assureBaseUrl(s),"_blank"),m()},b=()=>o.Ny.push(s);return n.createElement(r.a,{title:h,isOpen:!0,onDismiss:m},n.createElement(i.B,{direction:"column",gap:1},n.createElement("p",null,"Do you want to proceed in the current tab or open a new tab?")),n.createElement(r.a.ButtonRow,null,n.createElement(f.$n,{onClick:m,fill:"outline",variant:"secondary"},"Cancel"),n.createElement(f.$n,{type:"submit",variant:"secondary",onClick:u,icon:"external-link-alt"},"Open in new tab"),n.createElement(f.$n,{type:"submit",variant:"primary",onClick:b,icon:"apps"},"Open")))}},30973:(Q,I,e)=>{"use strict";e.d(I,{w:()=>r});var n=e(96540),a=e(38138),o=e(75462);function r({extensions:d,onSelect:l}){const{categorised:m,uncategorised:s}=f(d),h=s.length>0&&Object.keys(m).length>0;return n.createElement(a.W,null,n.createElement(n.Fragment,null,Object.keys(m).map(u=>n.createElement(a.W.Group,{key:u,label:(0,o.pL)(u,25)},i(m[u],l))),h&&n.createElement(a.W.Divider,{key:"divider"}),i(s,l)))}function i(d,l){return d.map(m=>n.createElement(a.W.Item,{ariaLabel:m.title,icon:m?.icon||"plug",key:m.id,label:(0,o.pL)(m.title,25),onClick:s=>{if(m.path)return l(m);m.onClick?.(s)}}))}function f(d){return(0,n.useMemo)(()=>{const l=[],m={};for(const s of d){if(!s.category){l.push(s);continue}Array.isArray(m[s.category])||(m[s.category]=[]),m[s.category].push(s)}return{uncategorised:l,categorised:m}},[d])}},33368:(Q,I,e)=>{"use strict";e.d(I,{h:()=>o});var n=e(96540),a=e(96192);const o=(r,i)=>(0,n.useMemo)(()=>(0,a.YV)(r,i),[r,i])},39590:(Q,I,e)=>{"use strict";e.d(I,{m:()=>oe,s:()=>ne});var n=e(96540),a=e(76888),o=e(3169),r=e(31678),i=e(9955),f=e(34028);const d={parse:ee=>{if(!ee.left&&!ee.right)return{to:{left:{datasource:null,queries:[],range:{from:f.kn.from,to:f.kn.to}},schemaVersion:0},error:!1};let Z,z,q,ie;return typeof ee.left=="string"&&([Z,q]=h(ee.left)),typeof ee.right=="string"?[z,ie]=h(ee.right):ee.right&&(z=s,ie=!0),Z||(Z=s),{to:{schemaVersion:0,left:Z,...z&&{right:z}},error:!!q||!!ie}}},l=(ee,...Z)=>Z.some(z=>ee.hasOwnProperty(z));var m=(ee=>(ee[ee.RangeFrom=0]="RangeFrom",ee[ee.RangeTo=1]="RangeTo",ee[ee.Datasource=2]="Datasource",ee[ee.SegmentsStart=3]="SegmentsStart",ee))(m||{});const s={datasource:null,queries:[],range:f.kn};function h(ee){let Z;try{Z=JSON.parse(ee)}catch{return[s,!0]}if(!Array.isArray(Z))return[{queries:[],range:f.kn,...Z},!1];if(Z.length<=3)return[s,!0];const z={from:Z[0],to:Z[1]},q=Z[2],ie=Z.slice(3),de=ie.filter(fe=>!l(fe,"ui","mode","__panelsState")),ue=ie.find(fe=>l(fe,"__panelsState"))?.__panelsState;return[{datasource:q,queries:de,range:z,panelsState:ue},!1]}var u=e(87490),b=e(15961);const g={parse:ee=>{if(!ee||!ee.panes||typeof ee.panes!="string")return{to:{schemaVersion:1,panes:{[(0,u.o$)()]:P}},error:!1};let Z;try{Z=JSON.parse(ee.panes)}catch{}if(Z==null||typeof Z!="object")return{to:{schemaVersion:1,panes:{[(0,u.o$)()]:P}},error:!0};const z=Object.entries(Z).map(([q,ie])=>[q,c(ie)]).reduce((q,[ie,de])=>{let ue=ie;return(ue.length!==3||/^\d+$/.test(ue)||ue.split("").some(fe=>u.WP.indexOf(fe)===-1))&&(ue=(0,u.o$)()),{...q,[ue]:de}},{});return Object.keys(z).length||(z[(0,u.o$)()]=P),{to:{schemaVersion:1,panes:z},error:!1}},migrate:ee=>({schemaVersion:1,panes:{[(0,u.o$)()]:ee.left,...ee.right&&{[(0,u.o$)()]:ee.right}}})},P={datasource:null,queries:[],range:f.kn};function c(ee){return!ee||typeof ee!="object"?P:{...P,...(0,b.C)("queries",ee)&&Array.isArray(ee.queries)&&{queries:ee.queries},...(0,b.C)("datasource",ee)&&typeof ee.datasource=="string"&&{datasource:ee.datasource},...(0,b.C)("panelsState",ee)&&!!ee.panelsState&&typeof ee.panelsState=="object"&&{panelsState:ee.panelsState},...(0,b.C)("range",ee)&&!!ee.range&&typeof ee.range=="object"&&(0,b.C)("from",ee.range)&&(0,b.C)("to",ee.range)&&typeof ee.range.from=="string"&&typeof ee.range.to=="string"&&{range:{from:ee.range.from,to:ee.range.to}}}}const y=ee=>v(ee),p=[d,g],v=ee=>{const Z=D(ee),[z,...q]=p.slice(Z),{error:ie,to:de}=z.parse(ee);return[q.reduce((fe,Se)=>Se.migrate?Se.migrate(fe):fe,de),ie]};function D(ee){return!ee||!("schemaVersion"in ee)||!ee.schemaVersion?0:typeof ee.schemaVersion=="number"?ee.schemaVersion:typeof ee.schemaVersion=="string"?Number.parseInt(ee.schemaVersion,10):0}var E=e(2543),S=e(18226),T=e(62860),M=e(62256),A=e(29436),x=e(23994),C=e(89224),O=e(27649),R=e(39070),L=e(41987),N=e(31193),F=e(14678);const K=(ee,Z)=>{const z=!(0,E.isEqual)(Z?.datasource,ee?.datasource),q=!(0,E.isEqual)(Z?.queries,ee?.queries),ie=!(0,E.isEqual)(Z?.range||f.kn,ee?.range||f.kn),de=!(0,E.isEqual)(Z?.panelsState,ee?.panelsState);return{datasource:z,queries:q,range:ie,panelsState:de}};async function B(ee,Z,z){if(ee)try{return await(0,N.tR)().get(ee)}catch{}const q=[...new Set(Z.map(ie=>ie.datasource).filter(R.zz).map(ie=>typeof ie=="string"?ie:ie.uid))];try{if(q.length>=1){const ie=(await Promise.allSettled(q.map(de=>(0,N.tR)().get(de)))).filter(b.s);if(ie.length>1)return await(0,N.tR)().get(F.uv);if(ie.length===1)return await(0,N.tR)().get(q[0])}}catch{}return(0,N.tR)().get((0,u.HQ)(z)).catch(()=>(0,N.tR)().get()).catch(()=>{})}function w(ee){return{...ee.getDefaultQuery?.(L.Jk.Explore),refId:"A",datasource:ee.getRef()}}function U(ee){return ee.name===F.uv}function W(ee){return ee&&U(ee)?Z=>!!Z.datasource:Z=>Z.datasource?typeof Z.datasource=="string"?Z.datasource===ee?.uid||Z.datasource===ee?.name:Z.datasource.uid===ee?.uid:!0}async function V(ee){return(await Promise.allSettled(ee.map(z=>(0,N.tR)().get(z.datasource).then(q=>({query:z,ds:q}))))).filter(b.s).map(({value:z})=>z.query)}function _(ee,Z,z){const q=Object.values(ee.panes);if(q.length>1){const ie=q.some(({range:de},ue,[{range:fe}])=>!(0,E.isEqual)(de,fe));z((0,A.qz)({syncedTimes:!ie}))}Object.entries(ee.panes).forEach(async([ie,de],ue)=>{const{datasource:fe,queries:Se,range:he,panelsState:ce}=de,me=Z[ie];if(me!==void 0){const pe=K(de,oe(me));Promise.resolve().then(async()=>{pe.datasource&&fe&&await z((0,T.wh)({exploreId:ie,datasource:fe}))}).then(async()=>{pe.range&&z((0,C.JA)({exploreId:ie,rawRange:(0,f.Z9)(he)})),pe.queries&&z((0,x.h9)({exploreId:ie,queries:(0,O.v)(Se)})),(pe.queries||pe.range)&&(await z((0,x.hS)(ie)),z((0,x.Od)({exploreId:ie}))),pe.panelsState&&ce&&z((0,M.fx)({exploreId:ie,panelsState:ce}))})}else z((0,M.Gd)({exploreId:ie,datasource:fe||"",queries:(0,O.v)(Se),range:(0,f.Z9)(he),panelsState:ce,position:ue,eventBridge:new S.o}))}),Object.keys(Z).filter(ie=>!Object.keys(ee.panes).includes(ie)).forEach(ie=>z((0,A.J8)(ie)))}function H(ee,Z,z,q,ie){q((0,A.Ve)()),Promise.all(Object.entries(ee.panes).map(([de,{datasource:ue,queries:fe,range:Se,panelsState:he}])=>B(ue,fe,z).then(ce=>Promise.resolve(ce?fe.length?(0,O.v)(fe).filter(W(ce)).map(U(ce)?E.identity:me=>({...me,datasource:ce.getRef()})):(0,N.tR)().get(U(ce)?void 0:ce.getRef()).then(me=>[w(me)]):[]).then(async me=>{let pe=await V(me);return!pe.length&&ce&&(pe=[w(U(ce)?await(0,N.tR)().get():ce)]),{exploreId:de,range:Se,panelsState:he,queries:pe,datasource:ce}})))).then(async de=>{const ue=await Promise.all(de.map(({exploreId:me,range:pe,panelsState:ye,queries:Pe,datasource:Ie})=>q((0,M.Gd)({exploreId:me,datasource:Ie,queries:Pe,range:(0,f.Z9)(pe),panelsState:ye,eventBridge:new S.o})).unwrap()));if(ue.length>1){const me=ue.some(({state:pe},ye,[{state:Pe}])=>!(0,E.isEqual)(pe.range.raw,Pe.range.raw));q((0,A.qz)({syncedTimes:!me}))}const fe=ue.reduce((me,{exploreId:pe,state:ye})=>({...me,[pe]:oe(ye)}),{}),Se=ie.getSearchObject();let he={};for(const[me,pe]of Object.entries(Se).filter(([ye])=>!["schemaVersion","panes","orgId","left","right"].includes(ye)))he[me]=pe;const ce=new URLSearchParams({schemaVersion:`${ee.schemaVersion}`,panes:JSON.stringify(fe),orgId:`${z}`,...he});ie.replace({pathname:ie.getLocation().pathname,search:ce.toString()}),Z.current="done"})}function G(ee,Z){return ee.current=T.wh.pending.type===Z.type,[A.J8.type,A.ve.fulfilled.type,x.Od.pending.type,C.eM.type,M.fx.type,T.wh.fulfilled.type].includes(Z.type)&&!ee.current}function j(ee,Z,z,q){const ie=Object.entries(ee.panes).reduce((de,[ue,fe])=>fe?{...de,[ue]:oe(fe)}:de,{});if(!(0,E.isEqual)(Z.current.panes,JSON.stringify(ie))){const de=!!Z.current.panes&&Object.values(Z.current.panes).filter(Boolean).length===0||z.current==="pending";Z.current={panes:JSON.stringify(ie)},q.partial({panes:Z.current.panes},de)}}var Y=e(76885);function oe(ee){return{datasource:ee.datasourceInstance?.uid||"",queries:ee.queries.map(u.w4),range:(0,Y.sQ)(ee.range.raw),panelsState:se(ee.panelsState)}}function se(ee){let Z=(0,E.mapValues)(ee,z=>(0,E.isObject)(z)?se(z):z);if(Z=(0,E.omitBy)(Z,E.isEmpty),!(0,E.isEmpty)(Z))return Z}function ne(ee){const{location:Z}=(0,a.Il)(),z=(0,r.useDispatch)(),q=(0,r.useSelector)(i.Qb),ie=(0,r.useSelector)(he=>he.user.orgId),de=(0,n.useRef)(ee),ue=(0,n.useRef)("notstarted"),fe=(0,n.useRef)(!1),{warning:Se}=(0,o._2)();(0,n.useEffect)(()=>{ee.panes||(ue.current="notstarted",de.current=ee)},[ee]),(0,n.useEffect)(()=>{const he=z((0,r.addListener)({predicate:ce=>G(fe,ce),effect:async(ce,{cancelActiveListeners:me,delay:pe,getState:ye})=>{me(),await pe(200),j(ye().explore,de,ue,Z)}}));return()=>he()},[z,Z]),(0,n.useEffect)(()=>{const he=de.current?.panes!==ee.panes,[ce,me]=y(ee);me&&Se("Could not parse Explore URL","The requested URL contains invalid parameters, a default Explore state has been loaded."),!he&&ue.current==="notstarted"&&(ue.current="pending",H(ce,ue,ie,z,Z)),de.current=ee,he&&ue.current==="done"&&_(ce,q,z)},[z,q,ie,Z,ee,Se])}},15961:(Q,I,e)=>{"use strict";e.d(I,{C:()=>a,s:()=>n});const n=o=>o.status==="fulfilled";function a(o,r){return o in r}},324:(Q,I,e)=>{"use strict";e.d(I,{M:()=>h,v:()=>b});var n=e(88483),a=e(19347),o=e(14110),r=e(82467),i=e(3169),f=e(18380),d=e(99140),l=e(62256),m=e(29436),s=e(23994);const h=g=>new n.c(P=>{const c=d.M_.getState().explore.panes[g]?.correlations;if(c)P.next(c),P.complete();else{const y=d.M_.subscribe(()=>{const p=d.M_.getState().explore.panes[g]?.correlations;p&&(y(),P.next(p),P.complete())})}});function u(g){return async(P,c)=>{const y=c().explore.panes[g];if(y.datasourceInstance?.uid!==void 0){let p=y.datasourceInstance.meta.mixed?y.queries.map(D=>D.datasource?.uid).filter(D=>D!==null):[y.datasourceInstance.uid];const v=await(0,f.J6)(p);P((0,l.Fb)({exploreId:g,correlations:v.correlations||[]}))}}}function b(g,P,c){return async(y,p)=>{const v=Object.keys(p().explore?.panes),D=p().explore?.panes[v[0]],E=p().explore?.panes[v[1]];if(!D||!E)return;const S=D.datasourceInstance?.meta.mixed?D.queries[0].datasource:D.datasourceInstance?.getRef(),T=E.datasourceInstance?.meta.mixed?E.queries[0].datasource:E.datasourceInstance?.getRef(),[M,A]=await Promise.all([(0,a.l)().get(S),(0,a.l)().get(T)]);if(M?.uid&&A?.uid&&E.correlationEditorHelperData?.resultField){const x={sourceUID:M.uid,targetUID:A.uid,label:g||await(0,f.tZ)(D,E),description:P,config:{field:E.correlationEditorHelperData.resultField,target:E.queries[0],type:"query",transformations:c}};await(0,f.$q)(M.uid,x).then(async()=>{y((0,m.J8)(v[1])),await y(u(v[0])),await y((0,s.Od)({exploreId:v[0]})),(0,o.rR)("grafana_explore_correlation_editor_saved",{sourceDatasourceType:M.type,targetDataSourceType:A.type})}).catch(C=>{y((0,r.dx)((0,i.gi)("Error creating correlation",C))),console.error(C)})}}}},62860:(Q,I,e)=>{"use strict";e.d(I,{YR:()=>g,wh:()=>b});var n=e(65307),a=e(14110),o=e(11134),r=e(87490),i=e(18380),f=e(31678),d=e(57288),l=e(62256),m=e(23994),s=e(89224),h=e(34028);const u=(0,n.VP)("explore/updateDatasourceInstance"),b=(0,f.createAsyncThunk)("explore/changeDatasource",async({datasource:P,exploreId:c,options:y},{getState:p,dispatch:v})=>{const D=p().user.orgId,{history:E,instance:S}=await(0,h.BE)(D,P),T=p().explore.panes[c].datasourceInstance;(0,a.rR)("explore_change_ds",{from:(T?.meta?.mixed?"mixed":T?.type)||"unknown",to:S.meta.mixed?"mixed":S.type,exploreId:c}),v(u({exploreId:c,datasourceInstance:S,history:E}));const M=p().explore.panes[c].queries,A=(0,h.dq)(S.uid,M),x=await(0,i.J6)(A);v((0,l.Fb)({exploreId:c,correlations:x.correlations||[]})),y?.importQueries&&await v((0,m.y2)(c,M,T,S)),p().explore.panes[c].isLive&&v((0,s.hO)({exploreId:c,refreshInterval:o.cC.offOption.value})),y?.importQueries&&v((0,m.Od)({exploreId:c}))}),g=(P,c)=>{if(u.match(c)){const{datasourceInstance:y,history:p}=c.payload;return(0,r._u)(P.querySubscription),{...P,datasourceInstance:y,graphResult:null,tableResult:null,logsResult:null,supplementaryQueries:(0,d.Ez)(),queryResponse:(0,h.RA)(),queryKeys:[],history:p}}return P}},62256:(Q,I,e)=>{"use strict";e.d(I,{EA:()=>u,Fb:()=>c,Gd:()=>p,LJ:()=>v,QZ:()=>y,fx:()=>h,nE:()=>b});var n=e(65307),a=e(87490),o=e(18380),r=e(32901),i=e(31678),f=e(62860),d=e(23994),l=e(89224),m=e(34028);const s=(0,n.VP)("explore/changeSize"),h=(0,n.VP)("explore/changePanels");function u(D,E,S){return async(T,M)=>{const A=M().explore.panes[D];if(A===void 0)return;const{panelsState:x}=A;T(h({exploreId:D,panelsState:{...x,[E]:S}}))}}const b=(0,n.VP)("explore/changeCorrelationHelperData"),g=(0,n.VP)("explore/initializeExploreAction"),P=(0,n.VP)("explore/setUrlReplaced"),c=(0,n.VP)("explore/saveCorrelationsAction");function y(D,{width:E}){return s({exploreId:D,width:E})}const p=(0,i.createAsyncThunk)("explore/initializeExplore",async({exploreId:D,datasource:E,queries:S,range:T,panelsState:M,correlationHelperData:A,eventBridge:x},{dispatch:C,getState:O,fulfillWithValue:R})=>{let L,N=[];if(E){const F=O().user.orgId,K=await(0,m.BE)(F,E);L=K.instance,N=K.history}if(C(g({exploreId:D,queries:S,range:(0,m.eO)(T,(0,r.O)(O().user)),datasourceInstance:L,history:N,eventBridge:x})),M!==void 0&&C(h({exploreId:D,panelsState:M})),C((0,l.JA)({exploreId:D})),L){const F=(0,m.dq)(L.uid,S),K=await(0,o.J6)(F);C(c({exploreId:D,correlations:K.correlations||[]})),C((0,d.Od)({exploreId:D}))}return A!==void 0&&O().explore.correlationEditorDetails?.editorMode&&C(b({exploreId:D,correlationEditorHelperData:A})),R({exploreId:D,state:O().explore.panes[D]})}),v=(D=(0,m.HZ)(),E)=>{if(D=(0,d.JQ)(D,E),D=(0,f.YR)(D,E),D=(0,l.QP)(D,E),s.match(E)){const S=E.payload.width;return{...D,containerWidth:S}}if(h.match(E)){const{panelsState:S}=E.payload;return{...D,panelsState:S}}if(b.match(E)){const{correlationEditorHelperData:S}=E.payload;return{...D,correlationEditorHelperData:S}}if(c.match(E))return{...D,correlations:E.payload.correlations};if(g.match(E)){const{queries:S,range:T,datasourceInstance:M,history:A,eventBridge:x}=E.payload;return{...D,range:T,queries:S,initialized:!0,eventBridge:x,queryKeys:(0,a.dY)(S),datasourceInstance:M,history:A,queryResponse:(0,m.RA)(),cache:[],correlations:[]}}return D}},72433:(Q,I,e)=>{"use strict";e.d(I,{Bj:()=>y,H9:()=>m,PA:()=>P,Uu:()=>b,VM:()=>s,fP:()=>c,jX:()=>u,ri:()=>d,s1:()=>h,sh:()=>l,wk:()=>g});var n=e(65307),a=e(81523),o=e(11401),r=e(29436);const i=(0,n.VP)("explore/historyUpdated"),f=({updatedQuery:p,deletedId:v})=>async(D,E)=>{const S=E().explore.richHistory,T=S.map(A=>A.id===p?.id?p:A).filter(A=>A.id!==v),M=S.length-T.length;D((0,r.U2)({richHistoryResults:{richHistory:T,total:E().explore.richHistoryTotal-M}}))},d=(p,v,D,E,S)=>async(T,M)=>{const A=S?{quotaExceededError:!1,limitExceededWarning:!1,otherErrors:!1}:{quotaExceededError:!M().explore.richHistoryStorageFull,limitExceededWarning:!M().explore.richHistoryLimitExceededWarningShown},{richHistoryStorageFull:x,limitExceeded:C}=await(0,a.l0)({localOverride:p,datasource:{uid:v,name:D},queries:E,starred:!1,showNotif:A});S||(x&&T((0,r.fj)()),C&&T((0,r.D)()))},l=(p,v)=>async(D,E)=>{const S=await(0,a.oU)(p,v);D(f({updatedQuery:S}))},m=(p,v)=>async D=>{const E=await(0,a.cX)(p,v);D(f({updatedQuery:E}))},s=p=>async v=>{const D=await(0,a.NC)(p);v(f({deletedId:D}))},h=()=>async p=>{await(0,a.X1)(),p((0,r.U2)({richHistoryResults:{richHistory:[],total:0}})),p((0,r.U2)({richHistoryResults:{richHistory:[],total:0}}))},u=()=>async(p,v)=>{const D=v().explore.richHistorySearchFilters;if(D){const E=await(0,a.DI)(D);p((0,r.U2)({richHistoryResults:E}))}},b=()=>async(p,v)=>{const D=v().explore.richHistorySearchFilters,E=v().explore.richHistory;if(D&&E){const S={...D,page:(D?.page||1)+1},T=await(0,a.DI)(S),M=[...E,...T.richHistory];p((0,r.Ju)({filters:S})),p((0,r.U2)({richHistoryResults:{richHistory:M,total:T.total}}))}},g=()=>async p=>{p((0,r.Ju)({filters:void 0})),p((0,r.U2)({richHistoryResults:{richHistory:[],total:0}}))},P=()=>async(p,v)=>{let D=v().explore.richHistorySettings;D||(D=await(0,a.Gx)(),p((0,r.bZ)(D)))},c=p=>async v=>{v((0,r.bZ)(p)),await(0,a.rs)(p)},y=p=>async(v,D)=>{await v((0,r.Ju)({filters:{...p}}));const E=D().explore.richHistorySettings;(0,o.gQ)().lastUsedDataSourcesAvailable&&await v(c({...E,lastUsedDatasourceFilters:p.datasourceFilters}))}},29436:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>N,D:()=>P,J8:()=>E,JA:()=>D,Ju:()=>y,U2:()=>b,Ve:()=>T,am:()=>x,bZ:()=>c,fj:()=>g,nD:()=>p,ow:()=>C,qz:()=>u,tP:()=>v,ve:()=>M});var n=e(65307),a=e(2543),o=e.n(a),r=e(18226),i=e(12131),f=e(87490),d=e(23989),l=e(31678),m=e(27649),s=e(62256),h=e(34028);const u=(0,n.VP)("explore/syncTimes"),b=(0,n.VP)("explore/richHistoryUpdated"),g=(0,n.VP)("explore/richHistoryStorageFullAction"),P=(0,n.VP)("explore/richHistoryLimitExceededAction"),c=(0,n.VP)("explore/richHistorySettingsUpdated"),y=(0,n.VP)("explore/richHistorySearchFiltersUpdatedAction"),p=(0,n.VP)("explore/splitSizeUpdateAction"),v=(0,n.VP)("explore/maximizePaneAction"),D=(0,n.VP)("explore/evenPaneResizeAction"),E=(0,n.VP)("explore/splitClose"),S=(0,n.VP)("explore/setPaneState"),T=(0,n.VP)("explore/clearPanes"),M=(0,l.createAsyncThunk)("explore/splitOpen",async(F,{getState:K,dispatch:B})=>{const w=Object.values(K().explore.panes)[0],U=F?.queries??w?.queries??[];Object.keys(K().explore.panes).forEach((_,H)=>{H>=1&&B(E(_))});const W=F?.range||w?.range.raw||h.kn;let V=(0,f.o$)();for(;K().explore.panes[V];)V=(0,f.o$)();await B(A({exploreId:V,datasource:F?.datasourceUid||w?.datasourceInstance?.getRef(),queries:(0,m.v)(U),range:W,panelsState:F?.panelsState||w?.panelsState,correlationHelperData:F?.correlationHelperData,eventBridge:new r.o})),w?.range&&await B(u({syncedTimes:(0,a.isEqual)(w.range.raw,W)}))}),A=(0,l.createAsyncThunk)("explore/createNewSplitOpen",async(F,{dispatch:K})=>{await K((0,s.Gd)(F))}),x=(0,n.VP)("explore/changeCorrelationEditorDetails"),C=(F,K)=>async B=>{const{timeRange:w,getExploreUrl:U,openInNewWindow:W}=K,V=await U({queries:F.targets,dsRef:F.datasource,scopedVars:F.scopedVars,timeRange:w,adhocFilters:(0,d.w)().getAdhocFilters(F.datasource?.uid??"",!0)});if(W&&V){W(V);return}i.Ny.push(V)},O=(0,h.HZ)(),R={syncedTimes:!1,panes:{},correlationEditorDetails:{editorMode:!1,correlationDirty:!1,queryEditorDirty:!1,isExiting:!1},richHistoryStorageFull:!1,richHistoryLimitExceededWarningShown:!1,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,richHistory:[]},N={explore:(F=R,K)=>{if(E.match(K)){const{[K.payload]:w,...U}={...F.panes};return{...F,panes:U,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,syncedTimes:!1}}if(p.match(K)){const{largerExploreId:w}=K.payload;return{...F,largerExploreId:w,maxedExploreId:void 0,evenSplitPanes:w===void 0}}if(v.match(K)){const{exploreId:w}=K.payload;return{...F,largerExploreId:w,maxedExploreId:w,evenSplitPanes:!1}}if(D.match(K))return{...F,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0};if(u.match(K))return{...F,syncedTimes:K.payload.syncedTimes};if(g.match(K))return{...F,richHistoryStorageFull:!0};if(P.match(K))return{...F,richHistoryLimitExceededWarningShown:!0};if(c.match(K)){const w=K.payload;return{...F,richHistorySettings:w}}if(b.match(K)){const{richHistory:w,total:U}=K.payload.richHistoryResults;return{...F,richHistory:w,richHistoryTotal:U}}if(y.match(K)){const w=K.payload.filters;return{...F,richHistorySearchFilters:w}}if(A.pending.match(K))return{...F,panes:{...F.panes,[K.meta.arg.exploreId]:O}};if(s.Gd.pending.match(K)){const w=Object.entries(F.panes),U=w.slice(0,K.meta.arg.position),W=w.slice(U.length),V=[...U,[K.meta.arg.exploreId,O],...W].reduce((_,[H,G])=>({..._,[H]:G}),{});return{...F,panes:V}}if(T.match(K))return{...F,panes:{}};if(x.match(K)){const{editorMode:w,label:U,description:W,canSave:V,correlationDirty:_,queryEditorDirty:H,isExiting:G,postConfirmAction:j,transformations:Y}=K.payload;return{...F,correlationEditorDetails:{editorMode:!!(w??F.correlationEditorDetails?.editorMode),canSave:!!(V??F.correlationEditorDetails?.canSave),label:U??F.correlationEditorDetails?.label,description:W??F.correlationEditorDetails?.description,transformations:Y??F.correlationEditorDetails?.transformations,correlationDirty:!!(_??F.correlationEditorDetails?.correlationDirty),queryEditorDirty:!!(H??F.correlationEditorDetails?.queryEditorDirty),isExiting:!!(G??F.correlationEditorDetails?.isExiting),postConfirmAction:j}}}const B=K.payload?.exploreId;return typeof B=="string"?{...F,panes:Object.entries(F.panes).reduce((w,[U,W])=>({...w,[U]:U===B?(0,s.LJ)(W,K):W}),{})}:F}}},23994:(Q,I,e)=>{"use strict";e.d(I,{_0:()=>le,He:()=>Kt,hS:()=>be,bO:()=>we,IL:()=>en,rR:()=>ct,y2:()=>Ke,Az:()=>Qt,PD:()=>Ve,JQ:()=>un,S6:()=>St,Od:()=>bt,GI:()=>nn,q9:()=>Le,h1:()=>me,qk:()=>xt,Rk:()=>_t,h9:()=>Ze,TO:()=>An});var n=e(65307),a=e(32017),o=e.n(a),r=e(2543),i=e(49510),f=e(62467),d=e(58307),l=e(69862),m=e(99165),s=e(39070),h=e(73372),u=e(47232),b=e(9557),g=e(40187),P=e(26272),c=e(14236),y=e(80822),p=e(19347),v=e(32264),D=e(14110),E=e(33390),S=e(87490),T=e(80582),M=e(18380),A=e(31193),x=e(32901),C=e(65650),O=e(14678),R=e(31678),L=e(82467),N=e(3169),F=e(39374),K=e(97186),B=e(81160),w=e(57875),U=e(91890),W=e(57934),V=e(11261),_=e(69147),H=e(91002),G=e(15162);const j=Tt=>{const $t=[],Yt=[],Cn=[],Tn=[],vn=[],Kn=[],Yn=[],nt=[];for(const yt of Tt.series){if(q(yt)){nt.push(yt);continue}switch(yt.meta?.preferredVisualisationType){case"logs":Tn.push(yt);break;case"graph":$t.push(yt);break;case"trace":vn.push(yt);break;case"table":Yt.push(yt);break;case"rawPrometheus":Cn.push(yt);break;case"nodeGraph":Kn.push(yt);break;case"flamegraph":Yn.push(yt);break;default:z(yt)&&$t.push(yt),Yt.push(yt)}}return{...Tt,graphFrames:$t,tableFrames:Yt,logsFrames:Tn,traceFrames:vn,nodeGraphFrames:Kn,customFrames:nt,flameGraphFrames:Yn,rawPrometheusFrames:Cn,graphResult:null,tableResult:null,logsResult:null,rawPrometheusResult:null}},Y=({showCorrelationEditorLinks:Tt,queries:$t,correlations:Yt,defaultTargetDatasource:Cn})=>Tn=>{if(Tt&&Cn)for(const vn of Tn.series)for(const Kn of vn.fields){Kn.config.links=[],Kn.display=Kn.display||(0,w.H)();const Yn={};vn.fields.map(nt=>{Yn[`${nt.name}`]=`\${__data.fields.['${nt.name}']}`}),Kn.config.links.push({url:"",origin:U.x0.ExploreCorrelationsEditor,title:`Correlate with ${Kn.name}`,internal:{datasourceUid:Cn.uid,datasourceName:Cn.name,query:{datasource:{uid:Cn.uid}},meta:{correlationData:{resultField:Kn.name,vars:Yn,origVars:Yn}}}})}else if($t?.length&&Yt?.length){const vn=(0,r.mapValues)((0,r.groupBy)($t,"refId"),"0.datasource.uid");(0,M.cA)(Tn.series,Yt,vn)}return Tn},oe=Tt=>Tt.graphFrames.length?{...Tt,graphResult:Tt.graphFrames}:{...Tt,graphResult:null},se=Tt=>{if(Tt.tableFrames.length===0)return(0,f.of)({...Tt,tableResult:null});Tt.tableFrames.sort((Tn,vn)=>{const Kn=Tn.refId,Yn=vn.refId;return Kn>Yn?1:Kn<Yn?-1:0});const $t=Tt.tableFrames.every(Tn=>z(Tn)),Yt={interpolate:Tn=>Tn};return($t?(0,f.of)(Tt.tableFrames).pipe(W.c.joinByFieldTransformer.operator({},Yt)):(0,f.of)(Tt.tableFrames).pipe(W.c.mergeTransformer.operator({},Yt))).pipe((0,B.T)(Tn=>{for(const vn of Tn)for(const Kn of vn.fields)Kn.display=Kn.display??(0,w.J)({field:Kn,theme:v.$.theme2,timeZone:Tt.request?.timezone??"browser"});return{...Tt,tableResult:Tn}}))},ne=Tt=>{const $t=Tt.rawPrometheusFrames;if(!$t||$t.length===0)return(0,f.of)({...Tt,tableResult:null});$t.sort((vn,Kn)=>{const Yn=vn.refId,nt=Kn.refId;return Yn>nt?1:Yn<nt?-1:0});const Yt=$t.every(vn=>z(vn)),Cn={interpolate:vn=>vn};return(Yt?(0,f.of)($t).pipe(W.c.joinByFieldTransformer.operator({},Cn)):(0,f.of)($t).pipe(W.c.mergeTransformer.operator({},Cn))).pipe((0,B.T)(vn=>{const Kn=vn[0];for(const Yn of Kn.fields)Yn.display=Yn.display??(0,w.J)({field:Yn,theme:v.$.theme2,timeZone:Tt.request?.timezone??"browser"});return{...Tt,rawPrometheusResult:Kn}}))},ee=(Tt={})=>$t=>{if($t.logsFrames.length===0)return{...$t,logsResult:null};const Yt=$t.request?.intervalMs,Cn=(0,_.HT)($t.logsFrames,Yt,Tt.absoluteRange,Tt.queries,Tt.deduplicate),Tn=(0,S.uE)(Tt.refreshInterval),vn=(0,H.zy)(Cn,Tn),Kn=vn.rows,Yn=vn.series,nt={...vn,rows:Kn,series:Yn};return{...$t,logsResult:nt}};function Z(Tt,$t,Yt,Cn,Tn,vn,Kn){return(0,f.of)(Tt).pipe((0,B.T)(Yn=>(0,c.N$)(Yn,$t)),(0,B.T)(Y({defaultTargetDatasource:Kn,showCorrelationEditorLinks:vn,queries:Cn,correlations:Tn})),(0,B.T)(j),(0,B.T)(oe),(0,B.T)(Yt),(0,l.Z)(ne),(0,l.Z)(se))}function z(Tt){const $t=(0,r.groupBy)(Tt.fields,Yt=>Yt.type);return!!(Object.keys($t).length===2&&$t[V.PU.time]?.length===1&&$t[V.PU.number])}function q(Tt){return Tt.meta?.preferredVisualisationPluginId?(0,G.oZ)(Tt.meta?.preferredVisualisationPluginId):!1}var ie=e(57288),de=e(324),ue=e(62256),fe=e(72433),Se=e(29436),he=e(89224),ce=e(34028);const me=Tt=>$t=>{const Yt=$t.explore.panes[Tt];return Yt&&Yt.queryResponse?Yt.queryResponse.state===s.Gu.Loading||Yt.queryResponse.state===s.Gu.Streaming:!1},pe=(0,n.VP)("explore/addQueryRow"),ye=(0,n.VP)("explore/changeQueries"),Pe=(0,n.VP)("explore/cancelQueries"),Ie=(0,n.VP)("explore/queriesImported"),Oe=(0,n.VP)("explore/queryStoreSubscription"),Ne=(0,n.VP)("explore/setSupplementaryQueryEnabledAction"),We=(0,n.VP)("explore/storeSupplementaryQueryDataProviderAction"),Ae=(0,n.VP)("explore/cleanSupplementaryQueryDataProviderAction"),Ue=(0,n.VP)("explore/cleanSupplementaryQueryAction"),Me=(0,n.VP)("explore/storeSupplementaryQueryDataSubscriptionAction"),$e=(0,n.VP)("explore/updateSupplementaryQueryDataAction"),ke=(0,n.VP)("explore/queryStreamUpdated"),Ze=(0,n.VP)("explore/setQueries"),ot=(0,n.VP)("changeLoadingState"),xt=(0,n.VP)("explore/setPausedState"),ct=(0,n.VP)("explore/clearLogs"),ft=(0,n.VP)("explore/scanStart"),Le=(0,n.VP)("explore/scanStop"),re=(0,n.VP)("explore/addResultsToCache"),X=(0,n.VP)("explore/clearCache");function le(Tt,$t){return async(Yt,Cn)=>{const Tn=Cn().explore.panes[Tt];let vn;Tn.datasourceInstance?.meta.mixed?vn=(0,r.findLast)(Tn.queries,Yn=>!!Yn.datasource)?.datasource||void 0:vn=Tn.datasourceInstance?.getRef();const Kn=await(0,S.Ll)(Tn.queries,$t,vn);Yt(pe({exploreId:Tt,index:$t,query:Kn}))}}function be(Tt){return($t,Yt)=>{$t(Le({exploreId:Tt})),$t(Pe({exploreId:Tt}));const Cn=Yt().explore.panes[Tt].supplementaryQueries;for(const Tn of ie.VW)$t(Ae({exploreId:Tt,type:Tn})),Cn[Tn]?.data?.state!==s.Gu.Done&&$t(Ue({exploreId:Tt,type:Tn}))}}const De=(Tt,$t)=>{const Yt=Tt.getRef();return $t.map(Cn=>({...Cn,datasource:Yt}))},Te=async(Tt,$t,Yt)=>{let Cn=[];if($t.meta?.id===Tt.meta?.id)Cn=Yt;else if((0,h.Ee)($t)&&(0,h.FL)(Tt)){const Tn=await $t.exportToAbstractQueries(Yt);Cn=await Tt.importFromAbstractQueries(Tn)}else Tt.importQueries&&(Cn=await Tt.importQueries(Yt,$t));return De(Tt,Cn)},we=(0,R.createAsyncThunk)("explore/changeQueries",async({queries:Tt,exploreId:$t},{getState:Yt,dispatch:Cn})=>{let Tn=!1;const vn=Yt().explore.panes[$t].queries,Kn=Yt().explore.panes[$t].datasourceInstance?.uid,Yn=Yt().explore.correlationEditorDetails,nt=Yn?.editorMode||!1;!(Object.keys(Yt().explore.panes)[0]===$t)&&nt&&!Yn?.queryEditorDirty&&Cn((0,Se.am)({queryEditorDirty:!0}));for(const Vt of Tt)for(const je of vn){if(Vt.refId===je.refId&&Vt.datasource?.type!==je.datasource?.type){const tt=await(0,p.l)().get(je.datasource),Dt=await(0,p.l)().get({uid:Vt.datasource?.uid});await Cn(Ke($t,vn,tt,Dt,Vt.refId)),Tn=!0}if(Kn===O.uv&&Vt.refId===je.refId&&Vt.datasource?.uid!==je.datasource?.uid){const tt=(0,ce.dq)(O.uv,Tt),Dt=await(0,M.J6)(tt);Cn((0,ue.Fb)({exploreId:$t,correlations:Dt.correlations||[]}))}}Tn||Cn(ye({queries:Tt,exploreId:$t})),Tt.length<vn.length&&Cn(bt({exploreId:$t}))}),Ke=(Tt,$t,Yt,Cn,Tn)=>async vn=>{if(!Yt){vn(Ie({exploreId:Tt,queries:$t}));return}let Kn=$t;if(Cn.uid===O.uv)Kn=$t.map(nt=>({...nt,datasource:Yt.getRef()}));else if(Yt.uid===O.uv){const nt=(0,r.groupBy)($t,Vt=>Vt.datasource?.uid),yt=await Promise.all(Object.keys(nt).map(async Vt=>{const je=await(0,p.l)().get({uid:Vt});return await Te(Cn,je,nt[Vt])}));Kn=(0,r.flatten)(yt.filter(Vt=>Vt.length>0))}else{let nt=$t;if(Tn!==void 0){const yt=$t.find(Vt=>Vt.refId===Tn);yt&&(nt=[yt])}Kn=await Te(Cn,Yt,nt)}let Yn=await(0,S.di)(Kn,Cn.getRef());if(Tn!==void 0){Kn.length===0&&(Kn=[await(0,S.Ll)([],void 0,Cn.getRef())]);const nt=$t.findIndex(Vt=>Vt.refId===Tn),yt={...Yn[0],refId:$t[nt].refId};Yn=[...$t],Yn[nt]=yt}return vn(Ie({exploreId:Tt,queries:Yn})),Yn};function Ve(Tt,$t,Yt){return async(Cn,Tn)=>{const vn=Tn().explore.panes[Tt],{queries:Kn}=vn,nt=(await Promise.all(Kn.map(yt=>Yt({...yt},$t)))).map((yt,Vt)=>(0,S.eF)(yt,Kn,Vt));Cn(Ze({exploreId:Tt,queries:nt})),$t.preventSubmit||Cn(bt({exploreId:Tt}))}}function ht(Tt,$t){if(!(Tt.filterQuery&&!Tt.filterQuery($t)))return $t}async function gt(Tt,$t,Yt,Cn){const vn=(await Promise.all(Cn.map(async Kn=>{if(Kn.datasource?.uid===Yt.uid)return ht(Yt,Kn);{const Yn=await(0,A.tR)().get(Kn.datasource);return ht(Yn,Kn)}}))).filter(Kn=>!!Kn);vn.length>0&&(Tt((0,fe.ri)(!0,Yt.uid,Yt.name,vn,v.$.queryHistoryEnabled)),v.$.queryHistoryEnabled&&Tt((0,fe.ri)(!1,Yt.uid,Yt.name,vn,!1)),await Tt((0,fe.jX)()))}const bt=(0,R.createAsyncThunk)("explore/runQueries",async({exploreId:Tt,preserveCache:$t},{dispatch:Yt,getState:Cn})=>{Yt(be(Tt));const{defaultCorrelationEditorDatasource:Tn,scopedVars:vn,showCorrelationEditorLinks:Kn}=await(0,ce.aj)(Cn(),Tt),Yn=(0,de.M)(Tt);Yt((0,he.JA)({exploreId:Tt})),$t!==!0&&Yt(en(Tt));const yt=Cn().explore.panes[Tt],{datasourceInstance:Vt,containerWidth:je,isLive:tt,range:Dt,scanning:Ot,queryResponse:Lt,querySubscription:Gt,refreshInterval:hn,absoluteRange:mt,cache:Bt,supplementaryQueries:Jt}=yt;let Rn,Mt;const wt=yt.queries.map(tn=>({...tn,datasource:tn.datasource||Vt?.getRef()}));Vt!=null&&gt(Yt,Cn().explore,Vt,wt);const Ht=(0,ce.rk)(Bt,mt);if(Ht)Rn=(0,i.z)([(0,f.of)(Ht),Yn]).pipe((0,l.Z)(([tn,It])=>Z(tn,Lt,ee({absoluteRange:mt,refreshInterval:hn,queries:wt}),wt,It,Kn,Tn))),Mt=Rn.subscribe(tn=>{Yt(ke({exploreId:Tt,response:tn}))});else{if(!(0,S.zT)(wt)||!Vt)return;const tn=Vt?.interval;(0,S._u)(Gt);const It={minInterval:tn,maxDataPoints:je,liveStreaming:tt},Xe=(0,x.O)(Cn().user),jn=(0,S.bI)(Tt,wt,It,Dt,Ot,Xe,vn);if(Yt(ot({exploreId:Tt,loadingState:s.Gu.Loading})),Rn=(0,i.z)([(0,F.BN)(Vt,jn.request).pipe(tt?(0,m.c)(500):d.D),Yn]).pipe((0,l.Z)(([Qn,ia])=>Z(Qn,Lt,ee({absoluteRange:mt,refreshInterval:hn,queries:wt}),wt,ia,Kn,Tn))),Mt=Rn.subscribe({next(Qn){const ia=Cn().explore.panes[Tt];if(Qn.logsResult!==null&&Qn.state===s.Gu.Done&&(0,D.rR)("grafana_explore_logs_result_displayed",{datasourceType:Vt.type,visualisationType:ia?.panelsState?.logs?.visualisationType??E.A.get(K.r)??"N/A",length:Qn.logsResult.rows.length,defaultVisualisationType:v.$.featureToggles.logsExploreTableDefaultVisualization?"table":"logs"}),Yt(ke({exploreId:Tt,response:Qn})),ia.scanning)if(Qn.state===s.Gu.Done&&Qn.series.length===0){const wn=(0,T.Wb)(-1,ia.range);Yt((0,he.JA)({exploreId:Tt,absoluteRange:wn})),Yt(bt({exploreId:Tt}))}else Yt(Le({exploreId:Tt}))},error(Qn){Yt((0,L.dx)((0,N.gi)("Query processing error",Qn))),Yt(ot({exploreId:Tt,loadingState:s.Gu.Error})),console.error(Qn)},complete(){Cn().explore.panes[Tt].queryResponse.state===s.Gu.Loading&&Yt(ot({exploreId:Tt,loadingState:s.Gu.Done}))}}),tt)for(const Qn of ie.VW)Yt(Ae({exploreId:Tt,type:Qn})),Yt(Ue({exploreId:Tt,type:Qn}));else Yt(rt({exploreId:Tt,datasourceInstance:Vt,transaction:jn,newQuerySource:Rn,supplementaryQueries:Jt,queries:wt,absoluteRange:mt}))}Yt(Oe({exploreId:Tt,querySubscription:Mt}))}),St=(0,R.createAsyncThunk)("explore/runLoadMoreQueries",async({exploreId:Tt,absoluteRange:$t},{dispatch:Yt,getState:Cn})=>{Yt(be(Tt));const{datasourceInstance:Tn,containerWidth:vn,queryResponse:Kn}=Cn().explore.panes[Tt],{defaultCorrelationEditorDatasource:Yn,scopedVars:nt,showCorrelationEditorLinks:yt}=await(0,ce.aj)(Cn(),Tt),Vt=(0,de.M)(Tt);let je;const tt=Kn.logsResult?.queries||[],Dt=Kn.logsFrames.map(Bt=>Bt.refId),Ot=tt.filter(Bt=>Dt.includes(Bt.refId)).map(Bt=>({...Bt,datasource:Bt.datasource||Tn?.getRef(),refId:Bt.refId,supportingQueryType:C.Q$.InfiniteScroll}));if(!(0,S.zT)(Ot)||!Tn)return;const Lt={minInterval:Tn?.interval,maxDataPoints:vn},Gt=(0,x.O)(Cn().user),hn=(0,S.zq)(Gt,{from:(0,u.oZ)(Gt,$t.from),to:(0,u.oZ)(Gt,$t.to)},(0,x.q)(Cn().user)),mt=(0,S.bI)(Tt,Ot,Lt,hn,!1,Gt,nt);Yt(ot({exploreId:Tt,loadingState:s.Gu.Loading})),je=(0,i.z)([(0,F.BN)(Tn,mt.request),Vt]).pipe((0,l.Z)(([Bt,Jt])=>Bt.state!==s.Gu.Done?(0,f.of)({...Kn,state:s.Gu.Loading}):Z((0,y._k)(Kn,Bt),Kn,ee({absoluteRange:$t,queries:tt,deduplicate:!0}),Ot,Jt,yt,Yn))),je.subscribe({next(Bt){Yt(ke({exploreId:Tt,response:Bt}))},error(Bt){Yt((0,L.dx)((0,N.gi)("Query processing error",Bt))),Yt(ot({exploreId:Tt,loadingState:s.Gu.Error})),console.error(Bt)},complete(){Yt(ot({exploreId:Tt,loadingState:s.Gu.Done}))}})}),Je=async(Tt,$t)=>{const Yt=Tt.filter(Tn=>Tn.datasource?.uid!==O.uv),Cn=(0,r.groupBy)(Yt,"datasource.uid");return await Promise.all(Object.values(Cn).map(async Tn=>({datasource:await(0,p.l)().get(Tn[0].datasource,$t),targets:Tn})))},rt=(0,R.createAsyncThunk)("explore/handleSupplementaryQueries",async({datasourceInstance:Tt,exploreId:$t,transaction:Yt,newQuerySource:Cn,supplementaryQueries:Tn,queries:vn,absoluteRange:Kn},{dispatch:Yn})=>{let nt;Tt.meta.mixed?nt=await Je(Yt.request.targets,Yt.request.scopedVars):nt=[{datasource:Tt,targets:Yt.request.targets}];for(const yt of ie.VW){const Vt=(0,ie.Pm)(nt,yt,{...Yt.request,requestId:`${Yt.request.requestId}_${(0,r.snakeCase)(yt)}`},Cn);Vt?(Yn(We({exploreId:$t,type:yt,dataProvider:Vt})),Rt(Tn[yt].data,vn,Kn)||(Yn(Ue({exploreId:$t,type:yt})),Tn[yt].enabled&&Yn(Qt($t,yt)))):Yn(Ae({exploreId:$t,type:yt}))}});function Rt(Tt,$t,Yt){if(!Tt)return!1;const Cn=(0,r.zipObject)((0,r.map)($t,"refId"),$t),Tn=(0,r.mapValues)((0,r.groupBy)(Tt.data.map(nt=>nt.meta?.custom?.sourceQuery),"refId"),r.head),vn=Tt.data.every(nt=>nt.meta?.custom?.logsVolumeType===b.Aj.FullRange),Kn=o()(Cn,Tn),Yn=Tt.data.every(nt=>{const yt=nt.meta?.custom?.absoluteRange;return yt?yt&&yt.from<=Yt.from&&Yt.to<=yt.to:!0});return vn&&Kn&&Yn}function _t(Tt,$t){return(Yt,Cn)=>{const Tn=Cn().explore.panes[Tt].queries,vn=$t.map((Kn,Yn)=>(0,S.eF)(Kn,Tn,Yn));Yt(Ze({exploreId:Tt,queries:vn})),Yt(bt({exploreId:Tt}))}}function nn(Tt){return($t,Yt)=>{$t(ft({exploreId:Tt}));const Cn=(0,T.Wb)(-1,Yt().explore.panes[Tt].range);$t((0,he.JA)({exploreId:Tt,absoluteRange:Cn})),$t(bt({exploreId:Tt}))}}function Kt(Tt){return($t,Yt)=>{const Cn=Yt().explore.panes[Tt].queryResponse,Tn=Yt().explore.panes[Tt].absoluteRange,vn=(0,ce.O2)(Tn);Cn.state===s.Gu.Done&&$t(re({exploreId:Tt,cacheKey:vn,queryResponse:Cn}))}}function en(Tt){return($t,Yt)=>{$t(X({exploreId:Tt}))}}function Qt(Tt,$t){return(Yt,Cn)=>{const{supplementaryQueries:Tn}=Cn().explore.panes[Tt],vn=Tn[$t].dataProvider;if(vn){const Kn=vn.subscribe({next:Yn=>{Yt($e({exploreId:Tt,type:$t,data:Yn}))}});Yt(Me({exploreId:Tt,type:$t,dataSubscription:Kn}))}}}function An(Tt,$t,Yt){return(Cn,Tn)=>{Cn(Ne({exploreId:Tt,enabled:$t,type:Yt})),(0,ie.Oi)($t,Yt),$t&&Cn(Qt(Tt,Yt))}}const un=(Tt,$t)=>{if(pe.match($t)){const{queries:Yt}=Tt,{index:Cn,query:Tn}=$t.payload,vn=[...Yt.slice(0,Cn+1),{...Tn},...Yt.slice(Cn+1)];return{...Tt,queries:vn,queryKeys:(0,S.dY)(vn)}}if(ye.match($t)){const{queries:Yt}=$t.payload;return{...Tt,queries:Yt}}if(Pe.match($t))return(0,S._u)(Tt.querySubscription),{...Tt,...Tt.queryResponse?{queryResponse:{...Tt.queryResponse,state:s.Gu.Done}}:{}};if(Ze.match($t)){const{queries:Yt}=$t.payload;return{...Tt,queries:Yt.slice(),queryKeys:(0,S.dY)(Yt)}}if(Oe.match($t)){const{querySubscription:Yt}=$t.payload;return{...Tt,querySubscription:Yt}}if(Ne.match($t)){const{enabled:Yt,type:Cn}=$t.payload,{supplementaryQueries:Tn}=Tt,vn=Tn[Cn].dataSubscription;!Yt&&vn&&vn.unsubscribe();const Kn={...Tn,[Cn]:{...Tn[Cn],enabled:Yt,data:void 0}};return{...Tt,supplementaryQueries:Kn}}if(We.match($t)){const{dataProvider:Yt,type:Cn}=$t.payload,{supplementaryQueries:Tn}=Tt,vn=Tn[Cn];vn?.dataSubscription&&vn.dataSubscription.unsubscribe();const Kn={...Tn,[Cn]:{...vn,dataProvider:Yt,dataSubscription:void 0}};return{...Tt,supplementaryQueries:Kn}}if(Ae.match($t)){const{type:Yt}=$t.payload,{supplementaryQueries:Cn}=Tt,Tn=Cn[Yt];Tn?.dataSubscription&&Tn.dataSubscription.unsubscribe();const vn={...Cn,[Yt]:{...Tn,dataProvider:void 0,dataSubscription:void 0}};return{...Tt,supplementaryQueries:vn}}if(Ue.match($t)){const{type:Yt}=$t.payload,{supplementaryQueries:Cn}=Tt,Tn={...Cn,[Yt]:{...Cn[Yt],data:void 0}};return{...Tt,supplementaryQueries:Tn}}if(Me.match($t)){const{dataSubscription:Yt,type:Cn}=$t.payload,{supplementaryQueries:Tn}=Tt,vn={...Tn,[Cn]:{...Tn[Cn],dataSubscription:Yt}};return{...Tt,supplementaryQueries:vn}}if($e.match($t)){let{data:Yt,type:Cn}=$t.payload;const{supplementaryQueries:Tn}=Tt,vn={...Tn,[Cn]:{...Tn[Cn],data:Yt}};return{...Tt,supplementaryQueries:vn}}if(ke.match($t))return fn(Tt,$t);if(Ie.match($t)){const{queries:Yt}=$t.payload;return{...Tt,queries:Yt,queryKeys:(0,S.dY)(Yt)}}if(ot.match($t)){const{loadingState:Yt}=$t.payload;return{...Tt,queryResponse:{...Tt.queryResponse,state:Yt}}}if(xt.match($t)){const{isPaused:Yt}=$t.payload;return{...Tt,isPaused:Yt}}if(ft.match($t))return{...Tt,scanning:!0};if(Le.match($t))return{...Tt,scanning:!1,scanRange:void 0};if(re.match($t)){const{cache:Cn}=Tt,{queryResponse:Tn,cacheKey:vn}=$t.payload;let Kn=[...Cn];return Kn.some(nt=>nt.key===vn)||(Kn=[{key:vn,value:Tn},...Kn].slice(0,5)),{...Tt,cache:Kn}}if(X.match($t))return{...Tt,cache:[]};if(ct.match($t)){if(!Tt.logsResult)return{...Tt,clearedAtIndex:null};if(Tt.queryResponse.state===s.Gu.Loading)return{...Tt,clearedAtIndex:null,logsResult:{...Tt.logsResult,rows:[]}};const Yt=Tt.clearedAtIndex?Tt.clearedAtIndex+Tt.logsResult.rows.length:Tt.logsResult.rows.length-1;return{...Tt,clearedAtIndex:Yt,logsResult:{...Tt.logsResult,rows:[]}}}return Tt},fn=(Tt,$t)=>{const{response:Yt}=$t.payload,{request:Cn,series:Tn,error:vn,graphResult:Kn,logsResult:Yn,tableResult:nt,rawPrometheusResult:yt,traceFrames:Vt,nodeGraphFrames:je,flameGraphFrames:tt,rawPrometheusFrames:Dt,customFrames:Ot}=Yt;if(vn){if(vn.type===g.v2.Timeout||vn.type===g.v2.Cancelled)return{...Tt};v.$.angularSupportEnabled&&Tt.datasourceInstance?.components?.QueryCtrl&&Tt.eventBridge.emit(P.ee.dataError,vn)}if(!Cn)return{...Tt};if(v.$.angularSupportEnabled&&Tt.datasourceInstance?.components?.QueryCtrl){const Lt=Tn.map(Gt=>(0,c.w3)(Gt));Tt.eventBridge.emit(P.ee.dataReceived,Lt)}return{...Tt,queryResponse:Yt,graphResult:Kn,tableResult:nt,rawPrometheusResult:yt,logsResult:Tt.isLive&&Yn?{...Yn,rows:(0,ce.pg)(Tt.clearedAtIndex,Yn.rows)}:Yn,showLogs:!!Yn,showMetrics:!!Kn,showTable:!!nt?.length,showTrace:!!Vt.length,showNodeGraph:!!je.length,showRawPrometheus:!!Dt.length,showFlameGraph:!!tt.length,showCustom:!!Ot?.length,clearedAtIndex:Tt.isLive?Tt.clearedAtIndex:null}}},9955:(Q,I,e)=>{"use strict";e.d(I,{Jr:()=>s,K6:()=>d,Kl:()=>b,Qb:()=>r,i6:()=>f,pF:()=>l,qq:()=>h,st:()=>m,vC:()=>u});var n=e(25508),a=e(2543),o=e.n(a);const r=g=>g.explore.panes,i=g=>g.explore,f=g=>g.explore.richHistorySettings,d=(0,n.Mz)(r,Object.entries),l=(0,n.Mz)(d,g=>g.length>1),m=(0,n.Mz)(d,g=>g.some(P=>P[1].correlationEditorHelperData!==void 0)),s=g=>(0,n.Mz)(r,P=>Object.keys(P)[0]===g),h=g=>(0,n.Mz)(r,P=>P[g]),u=(0,n.Mz)(i,g=>g.correlationEditorDetails),b=(0,n.Mz)(d,g=>{const P=g.map(([p,v])=>{const D=[v?.datasourceInstance?.getRef()],E=v?.queries.map(T=>T.datasource)||[],S=[...D,...E].filter(T=>!!T);if(!(S===void 0||S.length===0))return{exploreId:p,datasources:(0,a.uniqBy)(S,T=>T.uid)}}).filter(p=>!!p),y=(0,a.uniqBy)((0,a.flatten)(P.map(p=>p.datasources)),p=>p.uid).map(p=>{let v=[];return P.forEach(D=>{D.datasources.some(E=>E.uid===p.uid)&&v.push(D.exploreId)}),{datasource:p,exploreIds:v}});return{exploreToDS:P,dsToExplore:y}})},89224:(Q,I,e)=>{"use strict";e.d(I,{$_:()=>T,GA:()=>C,GH:()=>p,Iy:()=>M,JA:()=>D,QP:()=>O,Xk:()=>x,eM:()=>c,hO:()=>y,iO:()=>E,ke:()=>A,zY:()=>v});var n=e(65307),a=e(47232),o=e(26272),r=e(39070),i=e(72574),f=e(11134),d=e(76412),l=e(28138),m=e(87490),s=e(80582),h=e(74856),u=e(91002),b=e(32901),g=e(29436),P=e(23994);const c=(0,n.VP)("explore/changeRange"),y=(0,n.VP)("explore/changeRefreshInterval"),p=R=>(L,N)=>{const{syncedTimes:F}=N().explore;F?Object.keys(N().explore.panes).forEach(K=>{L(D({...R,exploreId:K})),L((0,P.Od)({exploreId:K,preserveCache:!0}))}):(L(D({...R})),L((0,P.Od)({exploreId:R.exploreId,preserveCache:!0})))},v=R=>L=>{L((0,P.S6)({...R}))},D=R=>(L,N)=>{const{exploreId:F,absoluteRange:K,rawRange:B}=R,w=N().explore.panes[F],U=(0,b.O)(N().user),W=(0,b.q)(N().user),{range:V}=w;let _=V.raw;K&&(_={from:(0,a.oZ)(U,K.from),to:(0,a.oZ)(U,K.to)}),B&&(_=B);const H=(0,m.zq)(U,_,W),G={from:H.from.valueOf(),to:H.to.valueOf()};(0,h.jG)().init({timepicker:{},getTimezone:()=>U,timeRangeUpdated(j){},time:H.raw}),(0,i.w)().updateTimeRange(H),L(c({exploreId:F,range:H,absoluteRange:G}))};function E(R){return(L,N)=>{const F=N().explore.panes[R].range.raw;Object.keys(N().explore.panes).filter(B=>B!==R).forEach(B=>{L(p({exploreId:B,rawRange:F}))});const K=N().explore.syncedTimes;L((0,g.qz)({syncedTimes:!K}))}}function S(R){return(L,N)=>{const F=(0,b.O)(N().user),K=(0,b.q)(N().user);Object.entries(N().explore.panes).forEach(([B,w])=>{const U=(0,m.zq)(F,w.range.raw,K);R(B,w,U,L)})}}function T(){return S((R,L,N,F)=>{const K={from:N.from.valueOf(),to:N.to.valueOf()};F(p({exploreId:R,absoluteRange:K}))})}function M(R){return S((L,N,F,K)=>{const B=(0,s.Wb)(R,F);K(p({exploreId:L,absoluteRange:B}))})}function A(R){return S((L,N,F,K)=>{const B=(0,s.Zk)(F,R);K(p({exploreId:L,absoluteRange:B}))})}function x(){return(R,L)=>{const N=L().explore.panes[Object.keys(L().explore.panes)[0]].range.raw;navigator.clipboard.writeText(JSON.stringify(N)),l.A.emit(o.r1.alertSuccess,[(0,d.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}}function C(){return async(R,L)=>{const{range:N,isError:F}=await(0,s.zG)();if(F===!0){l.A.emit(o.r1.alertError,[(0,d.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,d.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:N})]);return}if(L().explore.syncedTimes){R(p({exploreId:Object.keys(L().explore.panes)[0],rawRange:N})),R(p({exploreId:Object.keys(L().explore.panes)[1],rawRange:N}));return}R(p({exploreId:Object.keys(L().explore.panes)[0],rawRange:N}))}}const O=(R,L)=>{if(y.match(L)){const{refreshInterval:N}=L.payload,F=f.cC.isLive(N),K=(0,m.uE)(N),B=(0,u.zy)(R.logsResult,K);return f.cC.isLive(R.refreshInterval)&&!F&&(0,m._u)(R.querySubscription),{...R,refreshInterval:N,queryResponse:{...R.queryResponse,state:F?r.Gu.Streaming:r.Gu.Done},isLive:F,isPaused:F?!1:R.isPaused,logsResult:B}}if(c.match(L)){const{range:N,absoluteRange:F}=L.payload;return{...R,range:N,absoluteRange:F}}return R}},34028:(Q,I,e)=>{"use strict";e.d(I,{BE:()=>E,HZ:()=>v,O2:()=>S,RA:()=>D,Z9:()=>A,aj:()=>R,dq:()=>O,eO:()=>M,kn:()=>c,ng:()=>p,pg:()=>C,rk:()=>T});var n=e(2543),a=e.n(n),o=e(39070),r=e(43127),i=e(85858),f=e(47232),d=e(19347),l=e(11401),m=e(81523),s=e(14678),h=e(33390),u=e(87490),b=e(31193),g=e(57288);const P=100,c={from:"now-1h",to:"now"},y="grafana.explore.style.graph",p=L=>{h.A.set(y,L)},v=L=>({containerWidth:0,datasourceInstance:null,history:[],queries:[],initialized:!1,range:{from:null,to:null,raw:c},absoluteRange:{from:null,to:null},scanning:!1,queryKeys:[],isLive:!1,isPaused:!1,queryResponse:D(),tableResult:null,graphResult:null,logsResult:null,clearedAtIndex:null,rawPrometheusResult:null,eventBridge:null,cache:[],supplementaryQueries:(0,g.Ez)(),panelsState:{},correlations:void 0,...L}),D=()=>({state:o.Gu.NotStarted,series:[],timeRange:(0,r.E2)(),graphFrames:[],logsFrames:[],traceFrames:[],nodeGraphFrames:[],flameGraphFrames:[],customFrames:[],tableFrames:[],rawPrometheusFrames:[],rawPrometheusResult:null,graphResult:null,logsResult:null,tableResult:null});async function E(L,N){let F;try{F=await(0,b.tR)().get(N)}catch{F=await(0,b.tR)().get()}if(F.init)try{F.init()}catch(U){console.error(U)}let K=[];const B=(0,l.tU)(),w=await B.getRichHistory({search:"",sortOrder:m.xB.Ascending,datasourceFilters:[F.name],starred:!1});if((w.total||0)>0&&w.richHistory.forEach(U=>{U.queries.forEach(W=>{K.push({ts:parseInt(U.id,10),query:W})})}),K.length<P){const U=await B.getRichHistory({search:"",sortOrder:m.xB.Ascending,datasourceFilters:[s.uv],starred:!1});(U.total||0)>0&&U.richHistory.forEach(W=>{W.queries.forEach(V=>{V?.datasource?.uid===F.uid&&K.push({ts:parseInt(W.id,10),query:V})})})}if(K.length<P){const U=`grafana.explore.history.${F.meta?.id}`;K=[...K,...h.A.getObject(U,[])]}return K.length>P&&(K.length=P),(0,u.dr)(L,F.uid),{history:K,instance:F}}function S(L){const N={from:L.from,to:L.to};return Object.entries(N).map(([K,B])=>`${encodeURIComponent(K)}=${encodeURIComponent(B.toString())}`).join("&")}function T(L,N){const F=S(N),K=L.findIndex(w=>w.key===F);return K>=0?L[K].value:void 0}function M(L,N){return{from:i.parse(L.from,!1,N),to:i.parse(L.to,!0,N),raw:L}}function A(L){let N=c,F={from:x(L.from),to:x(L.to)};return F.from!==null&&F.to!==null&&(N={from:F.from,to:F.to}),N}function x(L){if(L===null)return null;if((0,f.Ar)(L))return L;if(typeof L!="string")return null;const N=L;if(N.indexOf("now")!==-1)return N;if(N.length===8)return(0,f.yT)(N,"YYYYMMDD");if(N.length===15)return(0,f.yT)(N,"YYYYMMDDTHHmmss");if(N.length===19)return(0,f.yT)(N,"YYYY-MM-DD HH:mm:ss");if(N.match(/^\d+$/)){const K=parseInt(N,10);return(0,f.yT)(K)}const F=(0,f.yT)(N);return F.isValid()?F:null}const C=(L,N)=>N?L?N.slice(L+1):N:[],O=(L,N)=>L===s.uv?(0,n.uniq)(N.map(F=>F.datasource?.uid).filter(F=>!!F)):[L];async function R(L,N){const F=L.explore.panes[N].correlationEditorHelperData,K=L.explore.correlationEditorDetails?.editorMode||!1,B=Object.keys(L.explore.panes)[0]===N,w=K&&B,U=w?await(0,d.l)().get():void 0,W=K&&!B&&F!==void 0;let V={};return W&&F!==void 0&&Object.entries(F?.vars).forEach(_=>{V[_[0]]={value:_[1]}}),{defaultCorrelationEditorDatasource:U,scopedVars:V,showCorrelationEditorLinks:w}}},96192:(Q,I,e)=>{"use strict";e.d(I,{JQ:()=>E,O1:()=>T,QL:()=>v,YV:()=>p,_O:()=>x});var n=e(2543),a=e.n(n),o=e(96540),r=e(92461),i=e(91890),f=e(41987),d=e(6709),l=e(76885),m=e(72574),s=e(14110),h=e(16233),u=e(67023),b=e(6923),g=e(39590);const c=[C=>!C.internal||h.TP.hasAccessToExplore()],y="grafana_data_link_clicked",p=(C,O)=>L=>{const{field:N,dataLinkScopedVars:F,frame:K,link:B,linkModel:w}=L,{valueRowIndex:U}=L.config;if(!B.internal||U===void 0)return w;const W=v({field:N,rowIndex:U,splitOpenFn:C,range:O,vars:F,dataFrame:K,linksToProcess:[B]});return W.length?(0,n.first)(W):void 0},v=C=>{const{field:O,vars:R,splitOpenFn:L,range:N,rowIndex:F,dataFrame:K}=C,B={...R||{}};B.__value={value:{raw:O.values[F]},text:"Raw value"};let w;K&&(w=(0,r.F)({frame:K,rowIndex:F}),B.__data={value:{name:K.name,refId:K.refId,fields:w},text:"Data"},K.fields.forEach(W=>{w&&w[W.name]&&(B[W.name]={value:w[W.name]})}),B.__targetField={value:w[O.name]});const U=C.linksToProcess||O.config.links;return U?U.filter(_=>c.every(H=>H(_,B))).map(_=>{if(_.internal){let H={};_.internal?.transformations&&_.internal?.transformations.forEach(se=>{let ne;se.field?ne=K?.fields.find(Z=>Z.name===se.field)?.values[F]:ne=O.values[F],H={...H,...(0,u.k)(se,ne,O.name)}});const G={...B,...H},j=T(_,G);let Y=[];if(j.variables.length===0){const se=O.name.toString();Y.push({variableName:se,value:"",match:""})}else Y=j.variables;const oe=se=>{(0,s.rR)(y,{origin:_.origin||i.x0.Datasource,app:f.Jk.Explore,internal:!0}),L?.(se)};return j.allVariablesDefined?{...(0,d.u)({link:_,internalLink:_.internal,scopedVars:G,range:N,field:O,onClickFn:C.splitOpenFn?ne=>oe(ne):void 0,replaceVariables:(0,m.w)().replace.bind((0,m.w)())}),variables:Y}:void 0}else{const H=(j,Y)=>(0,m.w)().replace(j,{...Y,...B}),G=(0,b.mQ)().getDataLinkUIModel(_,H,O);return G.title||(G.title=D(G.href)),G}}).filter(_=>!!_):[]};function D(C){C.indexOf("://")<0&&(C=`http://${C}`);let O;try{O=new URL(C).hostname}catch{O=C}return O}function E(C,O){return(0,o.useCallback)((R,L)=>R.fields.flatMap(N=>N.config?.links&&N.config?.links.length?v({field:N,rowIndex:L,range:C,dataFrame:R,splitOpenFn:O}):[]),[C,O])}const S=["__from","__to","__interval","__interval_ms","__org","__user","__range","__rate_interval","__timeFilter","timeFilter"];function T(C,O){let R=[];return(0,m.w)().replace.bind((0,m.w)())(M(C),O,void 0,R),R=(0,n.uniqBy)(R,"variableName"),{variables:R,allVariablesDefined:R.filter(N=>!S.includes(N.variableName)).every(N=>N.found)}}function M(C){let O="",R;for(R in C)typeof C[R]=="string"?O+=" "+C[R]:typeof C[R]=="object"&&(O+=" "+M(C[R]));return O}const A=C=>C[1]!==void 0,x=C=>{const O=Object.entries(C).filter(A).map(([R,L])=>{const N=(0,g.m)(L);return N.range={to:L.range.to.valueOf().toString(),from:L.range.from.valueOf().toString()},[R,N]}).reduce((R,[L,N])=>({...R,[L]:N}),{});return l.kM.renderUrl("/explore",{schemaVersion:1,panes:JSON.stringify(O)})}},27649:(Q,I,e)=>{"use strict";e.d(I,{v:()=>a});var n=e(77789);function a(o){const r=new Set(o.map(i=>i.refId).filter(Boolean));return r.size===o.length?o:(r.clear(),o.map(i=>{if(i.refId&&!r.has(i.refId))return r.add(i.refId),i;const f=(0,n.M)(o);return r.add(f),{...i,refId:f}}))}},57288:(Q,I,e)=>{"use strict";e.d(I,{Ez:()=>g,Oi:()=>b,Pm:()=>y,VW:()=>h});var n=e(2543),a=e.n(n),o=e(88483),r=e(44240),i=e(6276),f=e(29405),d=e(9557),l=e(39070),m=e(33390),s=e(69147);const h=[d.cF.LogsVolume,d.cF.LogsSample],u=p=>`grafana.explore.logs.enable${p}`,b=(p,v)=>{m.A.set(u(v),p?"true":"false")},g=()=>{let p={[d.cF.LogsVolume]:{enabled:!0},[d.cF.LogsSample]:{enabled:!1}};for(const v of h){if(v===d.cF.LogsSample)continue;m.A.get(u(v))==="false"&&(p[v]={enabled:!1})}return p},P=(p,v,D)=>new o.c(E=>p.subscribe(S=>{if(S.logsResult&&S.logsResult.rows&&S.logsResult.visibleRange&&S.logsResult.bucketSize!==void 0&&S.state===l.Gu.Done){const T=S.logsResult.bucketSize,M=v.map(C=>C.refId),A=(0,n.groupBy)(S.logsResult.rows,"dataFrame.refId");let x=[];M.forEach(C=>{if(A[C]?.length){const O=(0,s.J9)(A[C],T);x=[...x,...O];const R={logsVolumeType:d.Aj.Limited,absoluteRange:S.logsResult?.visibleRange,datasourceName:D,sourceQuery:v.find(L=>L.refId===C)};E.next({data:x.map(L=>{const N=L.meta?.custom||{};return{...L,meta:{custom:{...N,...R}}}}),state:S.state})}}),E.complete()}})),c=(p,v,D,E)=>{if(p===d.cF.LogsVolume)return P(v,D,E)},y=(p,v,D,E)=>{const T=p.map(({datasource:M,targets:A},x)=>{const C=(0,n.cloneDeep)(D);if(C.requestId=`${C.requestId||""}_${x}`,C.targets=A,(0,d.Nc)(M,v)){if(M.getDataProvider)return M.getDataProvider(v,C);if(M.getSupplementaryRequest){const O=M.getSupplementaryRequest(v,C);return O?v===d.cF.LogsVolume?(0,s.sg)(M,O,{targets:C.targets}):(0,s.Wr)(M,O):void 0}else return}else return c(v,E,A,M.name)}).filter(l.zz);if(T.length!==0)return T.length===1?T[0]:(0,r.h)(...T).pipe((0,f.S)((M,A)=>M.errors&&M.errors.length||A.state===l.Gu.NotStarted?M:A.state===l.Gu.Loading&&M.state===l.Gu.NotStarted?{...M,state:l.Gu.Loading}:A.state&&A.state!==l.Gu.Done?M:{...M,data:[...M.data,...A.data],state:l.Gu.Done},{data:[],state:l.Gu.NotStarted}),(0,i.d)())}},53478:(Q,I,e)=>{"use strict";e.d(I,{Ex:()=>T,$i:()=>S});var n=e(65474),a=e(69862),o=e(43429),r=e(26657),i=e(72574),f=e(19347),d=e(96540),l=e(14186),m=e(21594),s=e(98808),h=e(71680),u=e(1712),b=e(34263),g=e(18225),P=e(76658),c=e(66718),y=e(76942);const p=15;function v(){const M=(0,d.useRef)({}),A=(0,d.useCallback)(C=>{switch(C){case c.Tz.math:case c.Tz.reduce:case c.Tz.resample:case c.Tz.threshold:case c.Tz.sql:return M.current[C];case c.Tz.classic:return}},[]),x=(0,d.useCallback)((C,O)=>{switch(C){case c.Tz.math:M.current.math=O;break;case c.Tz.reduce:case c.Tz.resample:case c.Tz.resample:M.current.reduce=O,M.current.resample=O,M.current.threshold=O;break;case c.Tz.sql:M.current.sql=O}},[]);return{getCachedExpression:A,setCachedExpression:x}}function D(M){const{query:A,queries:x,onRunQuery:C,onChange:O}=M,{getCachedExpression:R,setCachedExpression:L}=v();(0,d.useEffect)(()=>{L(A.type,A.expression)},[A.expression,A.type,L]);const N=(0,d.useCallback)(B=>{const w=R(B.value),U=(0,y.r)({...A,type:B.value});O({...U,expression:w??U.expression})},[A,O,R]),F=()=>{const B=x.filter(w=>A.refId!==w.refId).map(w=>({value:w.refId,label:w.refId}));switch(A.type){case c.Tz.math:return d.createElement(h.z,{onChange:O,query:A,labelWidth:p,onRunQuery:C});case c.Tz.reduce:return d.createElement(u.Z,{refIds:B,onChange:O,labelWidth:p,query:A});case c.Tz.resample:return d.createElement(b.C,{query:A,labelWidth:p,onChange:O,refIds:B});case c.Tz.classic:return d.createElement(s.z,{onChange:O,query:A,refIds:B});case c.Tz.threshold:return d.createElement(P.O,{onChange:O,query:A,labelWidth:p,refIds:B});case c.Tz.sql:return d.createElement(g.k,{onChange:O,query:A,refIds:B})}},K=c.uQ.find(B=>B.value===A.type);return d.createElement("div",null,d.createElement(l.I,{label:"Operation",labelWidth:p},d.createElement(m.l6,{options:c.uQ,value:K,onChange:N,width:25})),F())}class E extends r.iy{constructor(A){super(A),this.instanceSettings=A}applyTemplateVariables(A,x){const C=(0,i.w)();return{...A,expression:C.replace(A.expression,x),window:C.replace(A.window,x)}}getCollapsedText(A){return`Expression: ${A.type}`}query(A){let x=A.targets.map(async O=>{const R=await(0,f.l)().get(O.datasource);return R.interpolateVariablesInQueries?R?.interpolateVariablesInQueries([O],A.scopedVars,A.filters)[0]:O});return(0,n.H)(Promise.all(x)).pipe((0,a.Z)(O=>super.query({...A,targets:O})))}newQuery(A){return{refId:"--",datasource:r.dR,type:A?.type??c.Tz.math,...A}}}const S={id:-100,uid:c.Uj,name:r.dR.name,type:r.dR.type,access:"proxy",meta:{baseUrl:"",module:"",type:o.QE.datasource,name:r.dR.type,id:r.dR.type,info:{author:{name:"Grafana Labs"},logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"},description:"Adds expression support to Grafana",screenshots:[],links:[],updated:"",version:""}},jsonData:{},readOnly:!0},T=new E(S);T.meta={id:r.dR.type,info:{logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"}}},T.components={QueryEditor:D}},98808:(Q,I,e)=>{"use strict";e.d(I,{z:()=>v});var n=e(96540),a=e(39268),o=e(14186),r=e(55852),i=e(14578),f=e(76942),d=e(32196),l=e(40845),m=e(67061),s=e(9261),h=e(21594),u=e(10354),b=e(55907);const g=b.A.reducerTypes.map(D=>({label:D.text,value:D.value})),P=b.A.evalOperators.map(D=>({label:D.text,value:D.value})),c=b.A.evalFunctions.map(D=>({label:D.text,value:D.value})),y=({condition:D,index:E,onChange:S,onRemoveCondition:T,refIds:M})=>{const A=(0,l.of)(p),x=K=>{S({...D,operator:{type:K.value}})},C=K=>{S({...D,reducer:{type:K.value,params:[]}})},O=K=>{S({...D,query:{params:[K.value]}})},R=K=>{S({...D,evaluator:{params:D.evaluator.params,type:K.value}})},L=(K,B)=>{const w=parseFloat(K.currentTarget.value),U=[...D.evaluator.params];U[B]=w,S({...D,evaluator:{...D.evaluator,params:U}})},N=(0,d.css)`
    width: 60px;
  `,F=D.evaluator.type===b.p.IsWithinRange||D.evaluator.type===b.p.IsOutsideRange;return n.createElement(m.B,null,n.createElement("div",{style:{flex:1}},n.createElement(a.C,null,E===0?n.createElement("div",{className:(0,d.cx)(A.button,N)},"WHEN"):n.createElement(s.f,{className:(0,d.cx)(A.buttonSelectText,N),options:P,onChange:x,value:P.find(K=>K.value===D.operator.type)}),n.createElement(h.l6,{options:g,onChange:C,width:20,value:g.find(K=>K.value===D.reducer.type)}),n.createElement("div",{className:A.button},"OF"),n.createElement(h.l6,{onChange:O,options:M,width:"auto",value:M.find(K=>K.value===D.query.params[0])})),n.createElement(a.C,null,n.createElement(s.f,{className:A.buttonSelectText,options:c,onChange:R,value:c.find(K=>K.value===D.evaluator.type)}),F?n.createElement(n.Fragment,null,n.createElement(u.p,{type:"number",width:10,onChange:K=>L(K,0),value:D.evaluator.params[0]}),n.createElement("div",{className:A.button},"TO"),n.createElement(u.p,{type:"number",width:10,onChange:K=>L(K,1),value:D.evaluator.params[1]})):D.evaluator.type!==b.p.HasNoValue?n.createElement(u.p,{type:"number",width:10,onChange:K=>L(K,0),value:D.evaluator.params[0]}):null)),n.createElement(r.$n,{variant:"secondary",type:"button",onClick:()=>T(E)},n.createElement(i.I,{name:"trash-alt"})))},p=D=>{const E=(0,d.css)`
    color: ${D.colors.primary.text};
    font-size: ${D.typography.bodySmall.fontSize};
  `;return{buttonSelectText:E,button:(0,d.cx)((0,d.css)`
        display: flex;
        align-items: center;
        border-radius: ${D.shape.radius.default};
        font-weight: ${D.typography.fontWeightMedium};
        border: 1px solid ${D.colors.border.weak};
        white-space: nowrap;
        padding: 0 ${D.spacing(1)};
        background-color: ${D.colors.background.canvas};
      `,E)}},v=({onChange:D,query:E,refIds:S})=>{const T=(x,C)=>{E.conditions&&D({...E,conditions:[...E.conditions.slice(0,C),x,...E.conditions.slice(C+1)]})},M=()=>{if(E.conditions){const x=E.conditions.at(-1)?.query?.params??[],C={...f.P,query:{params:x}};D({...E,conditions:E.conditions.length>0?[...E.conditions,C]:[C]})}},A=x=>{if(E.conditions){const C=E.conditions[x],O=E.conditions.filter(R=>R!==C).map((R,L)=>L===0?{...R,operator:{type:"when"}}:R);D({...E,conditions:O})}};return n.createElement("div",null,n.createElement(a.C,null,n.createElement(o.I,{label:"Conditions",labelWidth:14},n.createElement("div",null,E.conditions?.map((x,C)=>{if(x)return n.createElement(y,{key:C,index:C,condition:x,onChange:O=>T(O,C),onRemoveCondition:A,refIds:S})})))),n.createElement(r.$n,{variant:"secondary",type:"button",onClick:M},n.createElement(i.I,{name:"plus-circle"})))}},71680:(Q,I,e)=>{"use strict";e.d(I,{z:()=>h});var n=e(32196),a=e(96540),o=e(40845),r=e(67061),i=e(14186),f=e(76892),d=e(60782),l=e(14578),m=e(21744);const s="Math operations on one or more queries. You reference the query by ${refId} ie. $A, $B, $C etc\nThe sum of two scalar values: $A + $B > 10",h=({labelWidth:P,onChange:c,query:y,onRunQuery:p})=>{const v=S=>{c({...y,expression:S.target.value})},D=(0,o.of)(b),E=()=>{y.expression&&p()};return a.createElement(r.B,null,a.createElement(i.I,{label:a.createElement(f.c,{width:"auto"},a.createElement(d.G,{fitContent:!0,content:a.createElement("div",{className:D.documentationContainer},a.createElement("div",null,"Run math operations on one or more queries. You reference the query by ","${refId}"," ie. $A, $B, $C etc.",a.createElement("br",null),"Example: ",a.createElement("code",null,"$A + $B")),a.createElement("header",{className:D.documentationHeader},"Available Math functions"),a.createElement("div",{className:D.documentationFunctions},a.createElement(u,{name:"abs",description:"returns the absolute value of its argument which can be a number or a series"}),a.createElement(u,{name:"is_inf",description:"returns 1 for Inf values (negative or positive) and 0 for other values. It's able to operate on series or scalar values."}),a.createElement(u,{name:"is_nan",description:"returns 1 for NaN values and 0 for other values. It's able to operate on series or scalar values."}),a.createElement(u,{name:"is_null",description:"returns 1 for null values and 0 for other values. It's able to operate on series or scalar values."}),a.createElement(u,{name:"is_number",description:"returns 1 for all real number values and 0 for non-number. It's able to operate on series or scalar values."}),a.createElement(u,{name:"log",description:"returns the natural logarithm of its argument, which can be a number or a series"}),a.createElement(u,{name:"inf, infn, nan, and null",description:"The inf for infinity positive, infn for infinity negative, nan, and null functions all return a single scalar value that matches its name."}),a.createElement(u,{name:"round",description:"returns a rounded integer value. It's able to operate on series or escalar values."}),a.createElement(u,{name:"ceil",description:"rounds the number up to the nearest integer value. It's able to operate on series or escalar values."}),a.createElement(u,{name:"floor",description:"rounds the number down to the nearest integer value. It's able to operate on series or escalar values."}))),title:a.createElement(r.B,{gap:1,direction:"row"},a.createElement(l.I,{name:"book-open"})," Math operator"),footer:a.createElement("div",null,"See our additional documentation on"," ",a.createElement("a",{className:D.documentationLink,target:"_blank",href:"https://grafana.com/docs/grafana/latest/panels/query-a-data-source/use-expressions-to-manipulate-data/about-expressions/#math",rel:"noreferrer"},a.createElement(l.I,{size:"xs",name:"external-link-alt"})," Math expressions"),"."),closeButton:!0,placement:"bottom-start"},a.createElement("div",{className:D.info},"Expression ",a.createElement(l.I,{name:"info-circle"})))),labelWidth:P,grow:!0,shrink:!0},a.createElement(m.f,{value:y.expression,onChange:v,rows:1,placeholder:s,onBlur:E,style:{minWidth:250,lineHeight:"26px",minHeight:32}})))},u=({name:P,description:c})=>{const y=(0,o.of)(g);return a.createElement(a.Fragment,null,a.createElement("span",{className:y.name},P),a.createElement("span",{className:y.description},c))},b=P=>({documentationHeader:(0,n.css)`
    font-size: ${P.typography.h5.fontSize};
    font-weight: ${P.typography.h5.fontWeight};
  `,documentationLink:(0,n.css)`
    color: ${P.colors.text.link};
  `,documentationContainer:(0,n.css)`
    display: flex;
    flex: 1;
    flex-direction: column;
    gap: ${P.spacing(2)};

    padding: ${P.spacing(1)} ${P.spacing(2)};
  `,documentationFunctions:(0,n.css)`
    display: grid;
    grid-template-columns: max-content auto;
    column-gap: ${P.spacing(2)};
  `,info:(0,n.css)`
    display: flex;
    flex-direction: row;
    align-items: center;
    cursor: pointer;
    gap: ${P.spacing(1)};
  `}),g=P=>({name:(0,n.css)`
    font-weight: ${P.typography.fontWeightBold};
  `,description:(0,n.css)`
    font-size: ${P.typography.bodySmall.fontSize};
    color: ${P.colors.text.disabled};
  `})},1712:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>d});var n=e(96540),a=e(14186),o=e(10354),r=e(39268),i=e(21594),f=e(66718);const d=({labelWidth:l="auto",onChange:m,refIds:s,query:h})=>{const u=f.Cu.find(D=>D.value===h.reducer),b=D=>{m({...h,expression:D.value})},g=D=>{m({...h,reducer:D.value})},P=D=>{m({...h,settings:D})},c=D=>{let E;switch(D.value){case f.Mt.ReplaceNonNumbers:let S=0;h.settings?.mode===f.Mt.ReplaceNonNumbers&&(S=h.settings?.replaceWithValue??0),E={mode:f.Mt.ReplaceNonNumbers,replaceWithValue:S};break;default:E={mode:D.value}}P(E)},y=D=>{const E=D.currentTarget.valueAsNumber;P({mode:f.Mt.ReplaceNonNumbers,replaceWithValue:E??0})},p=h.settings?.mode??f.Mt.Strict,v=()=>{if(p===f.Mt.ReplaceNonNumbers)return n.createElement(a.I,{label:"Replace With",labelWidth:l},n.createElement(o.p,{type:"number",width:10,onChange:y,value:h.settings?.replaceWithValue??0}))};return n.createElement(n.Fragment,null,n.createElement(r.C,null,n.createElement(a.I,{label:"Input",labelWidth:l},n.createElement(i.l6,{onChange:b,options:s,value:h.expression,width:"auto"}))),n.createElement(r.C,null,n.createElement(a.I,{label:"Function",labelWidth:l},n.createElement(i.l6,{options:f.Cu,value:u,onChange:g,width:20})),n.createElement(a.I,{label:"Mode",labelWidth:l},n.createElement(i.l6,{onChange:c,options:f.HZ,value:p,width:25})),v()))}},34263:(Q,I,e)=>{"use strict";e.d(I,{C:()=>d});var n=e(96540),a=e(39268),o=e(14186),r=e(21594),i=e(10354),f=e(66718);const d=({labelWidth:l="auto",onChange:m,refIds:s,query:h})=>{const u=f.PN.find(p=>p.value===h.downsampler),b=f.iX.find(p=>p.value===h.upsampler),g=p=>{m({...h,window:p.target.value})},P=p=>{m({...h,expression:p.value})},c=p=>{m({...h,downsampler:p.value})},y=p=>{m({...h,upsampler:p.value})};return n.createElement(n.Fragment,null,n.createElement(a.C,null,n.createElement(o.I,{label:"Input",labelWidth:l},n.createElement(r.l6,{onChange:P,options:s,value:h.expression,width:20}))),n.createElement(a.C,null,n.createElement(o.I,{label:"Resample to",labelWidth:l,tooltip:"10s, 1m, 30m, 1h"},n.createElement(i.p,{onChange:g,value:h.window,width:15})),n.createElement(o.I,{label:"Downsample"},n.createElement(r.l6,{options:f.PN,value:u,onChange:c,width:25})),n.createElement(o.I,{label:"Upsample"},n.createElement(r.l6,{options:f.iX,value:b,onChange:y,width:25}))))}},18225:(Q,I,e)=>{"use strict";e.d(I,{k:()=>o});var n=e(96540),a=e(6867);const o=({onChange:r,refIds:i,query:f})=>{const l=`select * from ${(0,n.useMemo)(()=>i.map(s=>s.value),[i])[0]} limit 1`,m=s=>{r({...f,expression:s})};return n.createElement(a.Y,{query:f.expression||l,onChange:m})}},76658:(Q,I,e)=>{"use strict";e.d(I,{O:()=>A});var n=e(32196),a=e(96540),o=e(46819),r=e(40845),i=e(39268),f=e(14186),d=e(21594),l=e(9261),m=e(10354),s=e(15292),h=e(2913),u=e(55907),b=e(66718),g=e(65307);const P=(0,g.VP)("thresold/updateRefId"),c=(0,g.VP)("thresold/updateThresholdType"),y=(0,g.VP)("thresold/updateThresholdParams"),p=(0,g.VP)("thresold/updateHysteresis"),v=(0,g.VP)("thresold/updateUnloadParams"),D=(0,g.vy)({type:b.Tz.threshold,refId:"",conditions:[]},O=>{O.addCase(P,(R,L)=>{R.expression=L.payload}),O.addCase(c,(R,L)=>{const N=L.payload.evalFunction,F=L.payload.onError;if(R.conditions[0].evaluator.type=N,!!R.conditions[0].unloadEvaluator){const B=E(R.conditions[0].evaluator.type);F&&F(void 0),R.conditions[0].evaluator.type=N;const w={type:B,params:R.conditions[0].evaluator?.params??[0,0]};R.conditions[0].unloadEvaluator=w}}),O.addCase(y,(R,L)=>{const{param:N,index:F}=L.payload;R.conditions[0].evaluator.params[F]=N}),O.addCase(p,(R,L)=>{const{hysteresisChecked:N,onError:F}=L.payload;N?R.conditions[0].unloadEvaluator={type:E(R.conditions[0].evaluator.type),params:R.conditions[0].evaluator?.params??[0,0]}:(R.conditions[0].unloadEvaluator=void 0,F&&F(void 0))}),O.addCase(v,(R,L)=>{const{param:N,index:F,onError:K}=L.payload;R.conditions[0].unloadEvaluator?R.conditions[0].unloadEvaluator.params[F]=N:R.conditions[0].unloadEvaluator={type:E(R.conditions[0].evaluator.type),params:R.conditions[0].evaluator?.params??[0,0]};const B=S(R.conditions[0]),{errorMsg:w,errorMsgFrom:U,errorMsgTo:W}=B??{};K&&K(w||U||W)})});function E(O){return O===u.p.IsAbove?u.p.IsBelow:O===u.p.IsBelow?u.p.IsAbove:O===u.p.IsWithinRange?u.p.IsOutsideRange:O===u.p.IsOutsideRange?u.p.IsWithinRange:u.p.IsBelow}function S(O){const{unloadEvaluator:R,evaluator:L}=O;if(!L)return;if(R?.params[0]===void 0||Number.isNaN(R?.params[0]))return{errorMsg:"This value cannot be empty"};const{type:N,params:F}=L,{params:K}=R;if(N===u.p.IsWithinRange||N===u.p.IsOutsideRange){if(K[0]===void 0||Number.isNaN(K[0]))return{errorMsgFrom:"This value cannot be empty"};if(K[1]===void 0||Number.isNaN(K[1]))return{errorMsgTo:"This value cannot be empty"}}const[B,w]=R.params,[U,W]=F;switch(N){case u.p.IsAbove:if(B>U)return{errorMsg:`Enter a number less than or equal to ${U}`};break;case u.p.IsBelow:if(B<U)return{errorMsg:`Enter a number more than or equal to ${U}`};break;case u.p.IsOutsideRange:if(B<U)return{errorMsgFrom:`Enter a number more than or equal to ${U}`};if(w>W)return{errorMsgTo:`Enter a number less than or equal to ${W}`};break;case u.p.IsWithinRange:if(B>U)return{errorMsgFrom:`Enter a number less than or equal to ${U}`};if(w<W)return{errorMsgTo:`Enter a number be more than or equal to ${W}`};break;default:throw new Error(`evaluator function type ${N} not supported.`)}}const T=u.p.IsAbove,M={type:"query",evaluator:{type:T,params:[0,0]},query:{params:[]},reducer:{params:[],type:"last"}},A=({labelWidth:O,onChange:R,refIds:L,query:N,onError:F,useHysteresis:K=!1})=>{const B=(0,r.of)(C),w={...N,conditions:N.conditions?.length?N.conditions:[M]},[U,W]=(0,a.useReducer)(D,w),V=U.conditions[0],_=b.zd.find(ne=>ne.value===U.conditions[0].evaluator?.type),H=ne=>{W(P(ne.value))};(0,a.useEffect)(()=>{U&&R(U)},[U]);const G=ne=>{W(c({evalFunction:ne.value??T,onError:F}))},j=(ne,ee)=>{W(y({param:parseFloat(ne.currentTarget.value),index:ee}))},Y=V.evaluator.type===u.p.IsWithinRange||V.evaluator.type===u.p.IsOutsideRange,oe=!!h.config.featureToggles?.recoveryThreshold&&K;return a.createElement(a.Fragment,null,a.createElement(i.C,null,a.createElement(f.I,{label:"Input",labelWidth:O},a.createElement(d.l6,{onChange:H,options:L,value:N.expression,width:20}))),a.createElement(i.C,null,a.createElement(l.f,{className:B.buttonSelectText,options:b.zd,onChange:G,value:_}),Y?a.createElement(a.Fragment,null,a.createElement(m.p,{type:"number",width:10,onChange:ne=>j(ne,0),defaultValue:V.evaluator.params[0]}),a.createElement("div",{className:B.button},"TO"),a.createElement(m.p,{type:"number",width:10,onChange:ne=>j(ne,1),defaultValue:V.evaluator.params[1]})):a.createElement(m.p,{type:"number",width:10,onChange:ne=>j(ne,0),defaultValue:V.evaluator.params[0]||0})),oe&&a.createElement(se,{isRange:Y,onError:F}));function se({isRange:ne,onError:ee}){const Z=!!V.unloadEvaluator,z=de=>{W(p({hysteresisChecked:de.currentTarget.checked,onError:ee})),q.current=!0},q=a.useRef(!0),ie=()=>{q.current=!1};return a.createElement("div",{className:B.hysteresis},a.createElement("div",{onMouseDown:ie},a.createElement(s.K,{showLabel:!0,label:"Custom recovery threshold",value:Z,onChange:z,className:B.switch})),Z&&a.createElement(x,{isRange:ne,condition:V,onError:ee,dispatch:W,allowOnblur:q}))}};function x({isRange:O,condition:R,onError:L,dispatch:N,allowOnblur:F}){const K=(0,r.of)(C),B=(G,j)=>{const Y=parseFloat(G.currentTarget.value);N(v({param:Y,index:j,onError:L}))},w=S(R),{errorMsg:U,errorMsgFrom:W,errorMsgTo:V}=w??{};if(O)return a.createElement(_,{allowOnblur:F});return a.createElement(H,{allowOnblur:F});function _({allowOnblur:G}){return R.evaluator.type===u.p.IsWithinRange?a.createElement(i.C,{className:K.hysteresis},a.createElement(f.I,{label:"Stop alerting when outside range",labelWidth:"auto"},a.createElement(o.B,{direction:"row",gap:0},a.createElement("div",{className:K.range},a.createElement(f.I,{invalid:!!W,error:W,className:K.noMargin},a.createElement(m.p,{type:"number",width:10,onBlur:j=>G.current&&B(j,0),defaultValue:R.unloadEvaluator?.params[0]}))),a.createElement("div",{className:K.button},"TO"),a.createElement("div",{className:K.range},a.createElement(f.I,{invalid:!!V,error:V},a.createElement(m.p,{type:"number",width:10,onBlur:j=>G.current&&B(j,1),defaultValue:R.unloadEvaluator?.params[1]})))))):a.createElement(i.C,{className:K.hysteresis},a.createElement(f.I,{label:"Stop alerting when inside range",labelWidth:"auto"},a.createElement(o.B,{direction:"row",gap:0},a.createElement("div",{className:K.range},a.createElement(f.I,{invalid:!!W,error:W},a.createElement(m.p,{type:"number",width:10,onBlur:j=>G.current&&B(j,0),defaultValue:R.unloadEvaluator?.params[0]}))),a.createElement("div",{className:K.button},"TO"),a.createElement("div",{className:K.range},a.createElement(f.I,{invalid:!!V,error:V},a.createElement(m.p,{type:"number",width:10,onBlur:j=>G.current&&B(j,1),defaultValue:R.unloadEvaluator?.params[1]}))))))}function H({allowOnblur:G}){return R.evaluator.type===u.p.IsAbove?a.createElement(i.C,{className:K.hysteresis},a.createElement(f.I,{label:"Stop alerting when below",labelWidth:"auto",invalid:!!U,error:U},a.createElement(m.p,{type:"number",width:10,onBlur:j=>{G.current&&B(j,0)},defaultValue:R.unloadEvaluator?.params[0]}))):a.createElement(i.C,{className:K.hysteresis},a.createElement(f.I,{label:"Stop alerting when above",labelWidth:"auto",invalid:!!U,error:U},a.createElement(m.p,{type:"number",width:10,onBlur:j=>{G.current&&B(j,0)},defaultValue:R.unloadEvaluator?.params[0]})))}}const C=O=>({buttonSelectText:(0,n.css)({color:O.colors.primary.text,fontSize:O.typography.bodySmall.fontSize,textTransform:"uppercase",padding:`0 ${O.spacing(1)}`}),button:(0,n.css)({height:"32px",color:O.colors.primary.text,fontSize:O.typography.bodySmall.fontSize,textTransform:"uppercase",display:"flex",alignItems:"center",borderRadius:O.shape.radius.default,fontWeight:O.typography.fontWeightBold,border:`1px solid ${O.colors.border.medium}`,whiteSpace:"nowrap",padding:`0 ${O.spacing(1)}`,backgroundColor:O.colors.background.primary}),range:(0,n.css)({width:"min-content"}),hysteresis:(0,n.css)({marginTop:O.spacing(2)}),switch:(0,n.css)({paddingLeft:O.spacing(1)}),noMargin:(0,n.css)({margin:0})})},69437:(Q,I,e)=>{"use strict";e.d(I,{f:()=>o});var n=e(26657),a=e(66718);const o=r=>{if(!r)return!1;if((0,n.s9)(r.datasource))return!0;const i=r;return typeof i.type!="string"?!1:Object.values(a.Tz).includes(i.type)}},66718:(Q,I,e)=>{"use strict";e.d(I,{Cu:()=>l,HZ:()=>s,Mt:()=>m,NI:()=>f,PN:()=>h,Tz:()=>i,Uj:()=>r,iX:()=>u,uQ:()=>d,zd:()=>b});var n=e(75059),a=e(2913),o=e(55907);const r="__expr__";var i=(g=>(g.math="math",g.reduce="reduce",g.resample="resample",g.classic="classic_conditions",g.threshold="threshold",g.sql="sql",g))(i||{});const f=g=>{switch(g){case"math":return"Math";case"reduce":return"Reduce";case"resample":return"Resample";case"classic_conditions":return"Classic condition (legacy)";case"threshold":return"Threshold";case"sql":return"SQL"}},d=[{value:"math",label:"Math",description:"Free-form math formulas on time series or number data."},{value:"reduce",label:"Reduce",description:"Takes one or more time series returned from a query or an expression and turns each series into a single number."},{value:"resample",label:"Resample",description:"Changes the time stamps in each time series to have a consistent time interval."},{value:"classic_conditions",label:"Classic condition (legacy)",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the condition. Disables multi-dimensional alerts for this rule."},{value:"threshold",label:"Threshold",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the threshold condition."},{value:"sql",label:"SQL",description:"Transform data using SQL. Supports Aggregate/Analytics functions from DuckDB"}].filter(g=>g.value==="sql"?a.config.featureToggles?.sqlExpressions:!0),l=[{value:n.gy.min,label:"Min",description:"Get the minimum value"},{value:n.gy.max,label:"Max",description:"Get the maximum value"},{value:n.gy.mean,label:"Mean",description:"Get the average value"},{value:n.gy.sum,label:"Sum",description:"Get the sum of all values"},{value:n.gy.count,label:"Count",description:"Get the number of values"},{value:n.gy.last,label:"Last",description:"Get the last value"}];var m=(g=>(g.Strict="",g.ReplaceNonNumbers="replaceNN",g.DropNonNumbers="dropNN",g))(m||{});const s=[{value:"",label:"Strict",description:"Result can be NaN if series contains non-numeric data"},{value:"dropNN",label:"Drop Non-numeric Values",description:"Drop NaN, +/-Inf and null from input series before reducing"},{value:"replaceNN",label:"Replace Non-numeric Values",description:"Replace NaN, +/-Inf and null with a constant value before reducing"}],h=[{value:n.gy.last,label:"Last",description:"Fill with the last value"},{value:n.gy.min,label:"Min",description:"Fill with the minimum value"},{value:n.gy.max,label:"Max",description:"Fill with the maximum value"},{value:n.gy.mean,label:"Mean",description:"Fill with the average value"},{value:n.gy.sum,label:"Sum",description:"Fill with the sum of all values"}],u=[{value:"pad",label:"pad",description:"fill with the last known value"},{value:"backfilling",label:"backfilling",description:"fill with the next known value"},{value:"fillna",label:"fillna",description:"Fill with NaNs"}],b=[{value:o.p.IsAbove,label:"Is above"},{value:o.p.IsBelow,label:"Is below"},{value:o.p.IsWithinRange,label:"Is within range"},{value:o.p.IsOutsideRange,label:"Is outside range"}]},76942:(Q,I,e)=>{"use strict";e.d(I,{P:()=>i,r:()=>r});var n=e(75059),a=e(55907),o=e(66718);const r=f=>{switch(f.type){case o.Tz.reduce:f.reducer||(f.reducer=n.gy.mean);break;case o.Tz.resample:f.downsampler||(f.downsampler=n.gy.mean),f.upsampler||(f.upsampler="fillna"),f.reducer=void 0;break;case o.Tz.math:f.expression=void 0;break;case o.Tz.classic:f.conditions||(f.conditions=[i]);break;default:f.reducer=void 0}return f},i={type:"query",reducer:{params:[],type:"avg"},operator:{type:"and"},query:{params:[]},evaluator:{params:[0,0],type:a.p.IsAbove}}},71101:(Q,I,e)=>{"use strict";e.d(I,{Cg:()=>d,Fk:()=>m,R4:()=>u,Rj:()=>f,pq:()=>l});var n=e(32264),a=e(8484),o=e(16233),r=e(36689),i=e(31678);const f="manage-folder",d=g=>`folder-dashboards-${g}`,l=g=>`folder-library-panels-${g}`,m=g=>`folder-alerting-${g}`,s=g=>`folder-permissions-${g}`,h=g=>`folder-settings-${g}`;function u(g,P=g.parents){const c={icon:"folder",id:f,subTitle:(0,r.o)("manage-folder"),url:g.url,text:g.title,children:[{active:!1,icon:"apps",id:d(g.uid),text:(0,a.t)("browse-dashboards.manage-folder-nav.dashboards","Dashboards"),url:g.url}]};if(P&&P.length>0){const y=P[P.length-1],p=P.slice(0,P.length-1);c.parentItem=u(y,p)}return c.children.push({active:!1,icon:"library-panel",id:l(g.uid),text:(0,a.t)("browse-dashboards.manage-folder-nav.panels","Panels"),url:`${g.url}/library-panels`}),o.TP.hasPermission(i.AccessControlAction.AlertingRuleRead)&&n.$.unifiedAlertingEnabled&&c.children.push({active:!1,icon:"bell",id:m(g.uid),text:(0,a.t)("browse-dashboards.manage-folder-nav.alert-rules","Alert rules"),url:`${g.url}/alerting`}),c}function b(g){const P=u({created:"",createdBy:"",hasAcl:!1,updated:"",updatedBy:"",id:1,uid:"loading",title:"Loading",url:"url",canSave:!0,canEdit:!0,canAdmin:!0,canDelete:!0,version:0});return P.children[g].active=!0,{main:P,node:P.children[g]}}},54650:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>m,jl:()=>f});var n=e(65307),a=e(55314);const o={id:0,uid:"loading",title:"loading",url:"",canSave:!1,canDelete:!1,hasChanged:!1,version:1},r=(s,h)=>({...s,...h.payload,hasChanged:!1}),i=(0,n.Z0)({name:"folder",initialState:o,reducers:{loadFolder:r,setFolderTitle:(s,h)=>({...s,title:h.payload,hasChanged:h.payload.trim().length>0})},extraReducers:s=>{s.addMatcher(a.vZ.getFolder.matchFulfilled,r)}}),{loadFolder:f,setFolderTitle:d}=i.actions,m={folder:i.reducer}},84350:(Q,I,e)=>{"use strict";e.d(I,{G:()=>l});var n=e(32196),a=e(96540),o=e(40845),r=e(21594),i=e(42418),f=e(67140);const d=[{label:"Countries",description:"Lookup countries by name, two letter code, or three letter code",value:f.fx},{label:"USA States",description:"Lookup states by name or 2 ",value:"public/gazetteer/usa-states.json"},{label:"Airports",description:"Lookup airports by id or code",value:"public/gazetteer/airports.geojson"}],l=({value:s,onChange:h,context:u,item:b})=>{const g=(0,o.of)(m),[P,c]=(0,a.useState)(),y=b.settings;(0,a.useEffect)(()=>{async function D(){const E=await(0,f.q3)(s);c(E)}D()},[s,c]);const{current:p,options:v}=(0,a.useMemo)(()=>{let D=y?.options?[...y.options]:[...d],E=D?.find(S=>S.value===P?.path);return!E&&P&&(E={label:P.path,value:P.path},D.push(E)),{options:D,current:E}},[P,y?.options]);return a.createElement(a.Fragment,null,a.createElement(r.l6,{value:p,options:v,onChange:D=>h(D.value),allowCustomValue:!0,formatCreateLabel:D=>`Load from URL: ${D}`}),P&&a.createElement(a.Fragment,null,P.error&&a.createElement(i.F,{title:P.error,severity:"warning"}),P.count&&a.createElement("div",{className:g.keys},a.createElement("b",null,"(",P.count,")"),P.examples(10).map(D=>a.createElement("span",{key:D},D,",")),P.count>10&&" ...")))},m=()=>({keys:(0,n.css)`
    margin-top: 4px;
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;

    > span {
      margin-left: 4px;
    }
  `})},61983:(Q,I,e)=>{"use strict";e.d(I,{G:()=>y});var n=e(11261),a=e(52622),o=e(84350),r=e(32196),i=e(96540),f=e(13544),d=e(40845),l=e(42418),m=e(14578),s=e(21594),h=e(66864),u=e(31484);const b=[{value:a.aG.Auto,label:"Auto",ariaLabel:f.Tp.components.Transforms.SpatialOperations.location.autoOption,description:"Automatically identify location data based on default field names"},{value:a.aG.Coords,label:"Coords",ariaLabel:f.Tp.components.Transforms.SpatialOperations.location.coords.option,description:"Specify latitude and longitude fields"},{value:a.aG.Geohash,label:"Geohash",ariaLabel:f.Tp.components.Transforms.SpatialOperations.location.geohash.option,description:"Specify geohash field"},{value:a.aG.Lookup,label:"Lookup",ariaLabel:f.Tp.components.Transforms.SpatialOperations.location.lookup.option,description:"Specify Gazetteer and lookup field"}],g="https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/geomap/#location",P=({value:p,onChange:v,context:D,item:E})=>{const[S,T]=(0,i.useState)();(0,i.useEffect)(()=>{E.settings?.source&&E.settings?.data?.length&&E.settings.data[0]&&(0,u.nE)(E.settings.source).then(x=>{E.settings&&E.settings.data&&T((0,u.FM)(E.settings.data[0],x))})},[E.settings]);const M=(0,d.of)(c),A=()=>{if(S){if(S.warning)return i.createElement(l.F,{title:S.warning,severity:"warning",buttonContent:i.createElement(m.I,{name:"question-circle",size:"xl"}),className:M.alert,onRemove:()=>{const x=window.open(g,"_blank","noopener,noreferrer");x&&(x.opener=null)}});if(p===a.aG.Auto&&S.description)return i.createElement("span",null,S.description)}return null};return i.createElement(i.Fragment,null,i.createElement(s.l6,{options:b,value:p,onChange:x=>{v(x.value)}}),i.createElement(h.Gy,{className:M.hGroup},A()))},c=p=>({alert:(0,r.css)`
      & div {
        padding: 4px;
      }
      margin-bottom: 0px;
      margin-top: 5px;
      padding: 2px;
    `,hGroup:(0,r.css)`
      & div {
        width: 100%;
      }
    `});function y(p,v,D,E,S){switch(D.addCustomEditor({id:"modeEditor",path:`${v}mode`,name:"Location Mode",editor:P,settings:{data:S,source:E}}),E?.mode){case a.aG.Coords:D.addFieldNamePicker({path:`${v}latitude`,name:"Latitude field",settings:{filter:T=>T.type===n.PU.number,noFieldsMessage:"No numeric fields found"}}).addFieldNamePicker({path:`${v}longitude`,name:"Longitude field",settings:{filter:T=>T.type===n.PU.number,noFieldsMessage:"No numeric fields found"}});break;case a.aG.Geohash:D.addFieldNamePicker({path:`${v}geohash`,name:"Geohash field",settings:{filter:T=>T.type===n.PU.string,noFieldsMessage:"No strings fields found"}});break;case a.aG.Lookup:D.addFieldNamePicker({path:`${v}lookup`,name:"Lookup field",settings:{filter:T=>T.type===n.PU.string,noFieldsMessage:"No strings fields found"}}).addCustomEditor({id:"gazetteer",path:`${v}gazetteer`,name:"Gazetteer",editor:o.G})}}},96606:(Q,I,e)=>{"use strict";e.d(I,{RA:()=>u,XR:()=>b,Dc:()=>h,qy:()=>m,Pz:()=>s});var n=e(44294),a=e(34338),o=e(11217),r=e(22796),i=e(11261),f=e(78134);function d(P){if(!P?.length)return;const c=[16,8,4,2,1],y="0123456789bcdefghjkmnpqrstuvwxyz";let p=!0;const v=[],D=[];v[0]=-90,v[1]=90,D[0]=-180,D[1]=180;let E;P.split("").forEach(M=>{E=y.indexOf(M),c.forEach(A=>{l(p?D:v,E,A),p=!p})});const S=(v[0]+v[1])/2;return[(D[0]+D[1])/2,S]}function l(P,c,y){c&y?P[0]=(P[0]+P[1])/2:P[1]=(P[0]+P[1])/2}function m(P){return{name:P.name??"Point",type:i.PU.geo,values:P.values.map(c=>{const y=d(c);if(y)return new n.A((0,r.Rb)(y))}),config:g}}function s(P,c){const y=new Array(P.values.length);for(let p=0;p<P.values.length;p++){const v=P.values[p],D=c.values[p];v===null||D===null||(y[p]=new n.A((0,r.Rb)([v,D])))}return{name:"Point",type:i.PU.geo,values:y,config:g}}function h(P,c){const y=c.values.length,p=new Array(y);for(let v=0;v<y;v++)p[v]=P.find(c.values[v])?.geometry();return{name:"Geometry",type:i.PU.geo,values:p,config:g}}function u(P,c){const y=P.values,p=c.values;if(!y||!p)throw"missing src/dest";if(y.length!==p.length)throw"Source and destination field lengths do not match";const v=P.values.length,D=new Array(v);for(let E=0;E<v;E++){const S=y[E],T=p[E];S&&T?D[E]=new a.A([S,T]):S?D[E]=S:T&&(D[E]=T)}return{name:"Geometry",type:i.PU.geo,values:D,config:g}}function b(P,c){const y=P.values,p=c.values;if(!y||!p)throw"missing src/dest";if(y.length!==p.length)throw"Source and destination field lengths do not match";const v=P.values.length,D=new Array(v);for(let E=0;E<v;E++){const S=y[E],T=p[E];S&&T&&(D[E]=new o.A([(0,f.EX)(S),(0,f.EX)(T)]))}return{name:"Geometry",type:i.PU.geo,values:D,config:g}}const g=Object.freeze({custom:{hideFrom:{tooltip:!0}}})},67140:(Q,I,e)=>{"use strict";e.d(I,{fx:()=>P,q3:()=>c});var n=e(70915),a=e(44294),o=e(14236),r=e(11261),i=e(17172),f=e(11365);function d(y){const p=new f.A().readFeatures(y,{featureProjection:"EPSG:3857"}),v=p.length,D=new Array(v).fill(null),E=[],S=new Map,T=C=>{let O=S.get(C);return O||(O={types:new Set,values:new Array(v).fill(null),count:0},E.push(C),S.set(C,O)),O},M=(...C)=>{for(const O of C)if(!S.has(O))return O;return"___"+C[0]},A={types:new Set,values:new Array(v).fill(null),count:0};for(let C=0;C<v;C++){const O=p[C];D[C]=O.getGeometry();const R=O.getId();R!=null&&(A.values[C]=R,A.types.add((0,o.oE)(R)),A.count++);for(const L of O.getKeys()){const N=O.get(L);if(N===D[C]||N==null)continue;const F=T(L);F.values[C]=N,F.types.add((0,o.oE)(N)),F.count++}}const x=[];if(A.count>0){const C=l(A);x.push({name:M("id","_id","__id"),type:C,values:A.values,config:{}})}x.push({name:M("geo","geometry"),type:r.PU.geo,values:D,config:{}});for(const C of E){const O=S.get(C);if(!O)continue;const R=l(O);x.push({name:C,type:R,values:O.values,config:{}})}return{fields:x,length:v}}function l(y){return y.count<1?r.PU.other:y.types.size>1?(y.values=y.values.map(p=>p!=null?`${p}`:p),r.PU.string):y.types.values().next().value}var m=e(96606),s=e(22796);function h(y,p){let v=0;const D=new Map;for(const E of p){const S=new a.A((0,s.Rb)([E.longitude,E.latitude])),T={point:()=>S,geometry:()=>S};if(E.name&&(D.set(E.name,T),D.set(E.name.toUpperCase(),T)),E.key&&(D.set(E.key,T),D.set(E.key.toUpperCase(),T)),E.keys)for(const M of E.keys)D.set(M,T),D.set(M.toUpperCase(),T);v++}return{path:y,find:E=>{let S=D.get(E);return!S&&typeof E=="string"&&(S=D.get(E.toUpperCase())),S},count:v,examples:E=>{const S=[];if(D.size<1)S.push("no values found");else for(const T of D.keys())if(S.push(T),S.length>=E)break;return S}}}function u(y,p){let v;if(Array.isArray(p)){const D=p[0];if(D.latitude&&D.longitude&&(D.key||D.keys))return h(y,p)}else Array.isArray(p?.features)&&p?.type==="FeatureCollection"&&(v=d(p));if(!v)try{v=(0,o.Vc)(p)}catch(D){return{path:y,error:`${D}`,find:E=>{},examples:E=>[]}}return b(v,{path:y})}function b(y,p){const v=[];let D,E,S,T,M;for(const C of y.fields)if(C.type===r.PU.geo&&(D=C),!M&&C.type===r.PU.string&&(M=C),C.name){p.keys&&p.keys.includes(C.name)&&v.push(C);const O=C.name.toUpperCase();switch(O){case"LAT":case"LATITUTE":E=C;break;case"LON":case"LNG":case"LONG":case"LONGITUE":S=C;break;case"GEOHASH":T=C;break;case"ID":case"UID":case"KEY":case"CODE":p.keys||v.push(C);break;default:p.keys||(O.endsWith("_ID")||O.endsWith("_CODE"))&&v.push(C)}}!v.length&&M&&v.push(M);let A=!1;D?A=D.values[0]?.getType()==="Point":T?(D=(0,m.qy)(T),A=!0):E&&S&&(D=(0,m.Pz)(S,E),A=!0);const x=new Map;return v.forEach(C=>{C.values.forEach((O,R)=>{const L=`${O}`;x.set(L.toUpperCase(),R),x.set(L,R)})}),{path:p.path,find:C=>{const O=x.get(C);if(O!=null){const R=D?.values[O];return{frame:y,index:O,point:()=>!R||A?R:new a.A((0,n.q1)(R.getExtent())),geometry:()=>R}}},examples:C=>{const O=[];for(let R of x.keys())if(O.push(R),O.length>C)break;return O},frame:()=>y,count:y.length}}const g={},P="public/gazetteer/countries.json";async function c(y){y||(y=P);let p=g[y];if(!p){try{const v=await(0,i.AI)().get(y);p=u(y,v)}catch(v){console.warn("Error loading placename lookup",y,v),p={path:y,error:"Error loading URL",find:D=>{},examples:D=>[]}}g[y]=p}return p}},31484:(Q,I,e)=>{"use strict";e.d(I,{FM:()=>b,nE:()=>h});var n=e(28240),a=e(11261),o=e(85200),r=e(1173),i=e(52622),f=e(96606),d=e(67140);function l(g){return P=>{for(const c of P.fields)if(g(c,P,[]))return c}}function m(g){return P=>{for(const c of P.fields){if(g.has(c.name.toLowerCase()))return c;const y=(0,n.Ct)(c,P);if(g.has(y))return c}}}const s={mode:i.aG.Auto,geohash:m(new Set(["geohash"])),latitude:m(new Set(["latitude","lat"])),longitude:m(new Set(["longitude","lon","lng"])),h3:m(new Set(["h3"])),wkt:m(new Set(["wkt"])),lookup:m(new Set(["lookup"])),geo:g=>g.fields.find(P=>P.type===a.PU.geo)};async function h(g){const P={...s,mode:g?.mode??i.aG.Auto};switch(P.gazetteer=await(0,d.q3)(g?.gazetteer),P.mode){case i.aG.Geohash:g?.geohash?P.geohash=l((0,o.NS)({id:r.Ct.byName,options:g.geohash})):P.geohash=()=>{};break;case i.aG.Lookup:const c=g?.lookup?.length?(0,o.NS)({id:r.Ct.byName,options:g.lookup}):(0,o.NS)({id:r.Ct.byType,options:a.PU.string});P.lookup=l(c);break;case i.aG.Coords:g?.latitude?P.latitude=l((0,o.NS)({id:r.Ct.byName,options:g.latitude})):P.latitude=()=>{},g?.longitude?P.longitude=l((0,o.NS)({id:r.Ct.byName,options:g.longitude})):P.longitude=()=>{};break}return P}function u(g,P){const c={mode:P.mode??i.aG.Auto};if(c.mode===i.aG.Auto){if(c.geo=P.geo(g),c.geo)return c;if(c.latitude=P.latitude(g),c.longitude=P.longitude(g),c.latitude&&c.longitude)return c.mode=i.aG.Coords,c;if(c.geohash=P.geohash(g),c.geohash)return c.mode=i.aG.Geohash,c;if(c.lookup=P.lookup(g),c.lookup)return c.mode=i.aG.Lookup,c}switch(c.mode){case i.aG.Coords:c.latitude=P.latitude(g),c.longitude=P.longitude(g);break;case i.aG.Geohash:c.geohash=P.geohash(g);break;case i.aG.Lookup:c.lookup=P.lookup(g);break}return c}function b(g,P){const c=u(g,P);switch(c.mode){case i.aG.Auto:return c.geo?{field:c.geo}:{warning:"Unable to find location fields"};case i.aG.Coords:return c.latitude&&c.longitude?{field:(0,f.Pz)(c.longitude,c.latitude),derived:!0,description:`${c.mode}: ${c.latitude.name}, ${c.longitude.name}`}:{warning:"Select latitude/longitude fields"};case i.aG.Geohash:return c.geohash?{field:(0,f.qy)(c.geohash),derived:!0,description:`${c.mode}`}:{warning:"Select geohash field"};case i.aG.Lookup:return c.lookup?P.gazetteer?{field:(0,f.Dc)(P.gazetteer,c.lookup),derived:!0,description:`${c.mode}: ${P.gazetteer.path}`}:{warning:"Gazetteer not found"}:{warning:"Select lookup field"}}return{warning:"unable to find geometry"}}},61453:(Q,I,e)=>{"use strict";e.d(I,{q:()=>R});var n=e(2543),a=e(96540),o=e(70713),r=e(18282),i=e(2514),f=e(90708),d=e(13544),l=e(14110),m=e(72574),s=e(55852),h=e(62930),u=e(77093),b=e(2913),g=e(8484),P=e(69147),c=e(28240),y=e(40845),p=e(66864),v=e(88575),D=e(21594),E=e(15292),S=e(7788),T=e(32196);const M=N=>(0,T.css)`
  padding: ${N.spacing(0,2)};
  font-size: ${N.typography.bodySmall.fontSize};
  color: ${N.colors.text.secondary};
  overflow: hidden;
  text-overflow: ellipsis;
`,A=({children:N})=>{const F=(0,y.of)(M);return a.createElement("div",{className:F},N)};var x=e(26323);const C=({options:N,actions:F,formattedDataDescription:K,onOptionsChange:B,hasTransformations:w,data:U,dataFrames:W,transformationOptions:V,selectedDataFrame:_,onDataFrameChange:H,downloadForExcel:G,toggleDownloadForExcel:j})=>{const Y=(0,y.of)(x.A);let oe=W;_===r.F.joinByField&&(oe=U);const se=oe.map((Z,z)=>({value:z,label:`${(0,c.Ri)(Z)} (${z})`})),ne=[...V,...se];function ee(){let Z="";if(!U)return Z;const z=[];return _===r.F.joinByField?z.push((0,g.t)("dashboard.inspect-data.series-to-columns","Series joined by time")):U.length>1&&z.push((0,c.Ri)(U[_])),(N.withTransforms||N.withFieldConfig)&&(N.withTransforms&&z.push((0,g.t)("dashboard.inspect-data.panel-transforms","Panel transforms")),N.withTransforms&&N.withFieldConfig,N.withFieldConfig&&z.push((0,g.t)("dashboard.inspect-data.formatted","Formatted data"))),G&&z.push((0,g.t)("dashboard.inspect-data.excel-header","Excel header")),z.join(", ")}return a.createElement("div",{className:Y.dataDisplayOptions},a.createElement(S.u,{id:"Data options",index:0,title:(0,g.t)("dashboard.inspect-data.data-options","Data options"),headerElement:a.createElement(A,null,ee()),isOpen:!1,actions:F},a.createElement("div",{className:Y.options,"data-testid":"dataOptions"},a.createElement(p.gW,{spacing:"none"},U.length>1&&a.createElement(v.D,{label:(0,g.t)("dashboard.inspect-data.dataframe-label","Show data frame")},a.createElement(D.l6,{options:ne,value:_,onChange:H,width:30,"aria-label":(0,g.t)("dashboard.inspect-data.dataframe-aria-label","Select dataframe")})),a.createElement(p.Gy,null,w&&B&&a.createElement(v.D,{label:(0,g.t)("dashboard.inspect-data.transformations-label","Apply panel transformations"),description:(0,g.t)("dashboard.inspect-data.transformations-description","Table data is displayed with transformations defined in the panel Transform tab.")},a.createElement(E.d,{value:!!N.withTransforms,onChange:()=>B({...N,withTransforms:!N.withTransforms})})),B&&a.createElement(v.D,{label:(0,g.t)("dashboard.inspect-data.formatted-data-label","Formatted data"),description:K||(0,g.t)("dashboard.inspect-data.formatted-data-description","Table data is formatted with options defined in the Field and Override tabs.")},a.createElement(E.d,{id:"formatted-data-toggle",value:!!N.withFieldConfig,onChange:()=>B({...N,withFieldConfig:!N.withFieldConfig})})),a.createElement(v.D,{label:(0,g.t)("dashboard.inspect-data.download-excel-label","Download for Excel"),description:(0,g.t)("dashboard.inspect-data.download-excel-description","Adds header to CSV for use with Excel")},a.createElement(E.d,{id:"excel-toggle",value:G,onChange:j})))))))};var O=e(18358);class R extends a.PureComponent{constructor(F){super(F),this.onExportLogsAsTxt=()=>{const{data:K,dataName:B,app:w}=this.props;(0,l.rR)("grafana_logs_download_logs_clicked",{app:w,format:"logs",area:"inspector"});const U=(0,P.HT)(K||[]);(0,O.Zy)(U,B)},this.onExportTracesAsJson=()=>{const{data:K,dataName:B,app:w}=this.props;if(K)for(const U of K){if(U.meta?.preferredVisualisationType!=="trace")continue;const W=(0,O.ek)(U,B+"-traces");(0,l.rR)("grafana_traces_download_traces_clicked",{app:w,grafana_version:b.config.buildInfo.version,trace_format:W,location:"inspector"})}},this.onExportServiceGraph=()=>{const{data:K,dataName:B,app:w}=this.props;(0,l.rR)("grafana_traces_download_service_graph_clicked",{app:w,grafana_version:b.config.buildInfo.version,location:"inspector"}),K&&(0,O.ny)(K,B)},this.onDataFrameChange=K=>{this.setState({transformId:K.value===r.F.joinByField?r.F.joinByField:r.F.noop,dataFrameIndex:typeof K.value=="number"?K.value:0,selectedDataFrame:K.value})},this.onToggleDownloadForExcel=()=>{this.setState(K=>({downloadForExcel:!K.downloadForExcel}))},this.state={selectedDataFrame:0,dataFrameIndex:0,transformId:r.F.noop,transformationOptions:L(),transformedData:F.data??[],downloadForExcel:!1}}componentDidUpdate(F,K){if(!this.props.data){this.setState({transformedData:[]});return}if(this.props.options.withTransforms){this.setState({transformedData:this.props.data});return}if(F.data!==this.props.data||K.transformId!==this.state.transformId){const B=this.state.transformationOptions.find(w=>w.value===this.state.transformId);if(B&&B.transformer.id!==r.F.noop){const w=this.state.selectedDataFrame,U=this.state.dataFrameIndex,W=(0,i.m)([B.transformer],this.props.data).subscribe(V=>{this.setState({transformedData:V,selectedDataFrame:w,dataFrameIndex:U},()=>W.unsubscribe())});return}this.setState({transformedData:this.props.data});return}}exportCsv(F,K){const{dataName:B}=this.props,{transformId:w}=this.state,U=F[this.state.dataFrameIndex];K&&(0,l.rR)("grafana_logs_download_clicked",{app:this.props.app,format:"csv"}),(0,O.EM)(U,B,{useExcelHeader:this.state.downloadForExcel},w)}getProcessedData(){const{options:F,panelPluginId:K,fieldConfig:B,timeZone:w}=this.props,U=this.state.transformedData;if(!F.withFieldConfig)return(0,f.K3)(U);let W=B??{defaults:{},overrides:[]};return K==="table"&&B&&(W=this.cleanTableConfigFromFieldConfig(B)),(0,f.we)({data:U,theme:b.config.theme2,fieldConfig:W,timeZone:w,replaceVariables:(V,_,H)=>(0,m.w)().replace(V,_,H)})}cleanTableConfigFromFieldConfig(F){F=(0,n.cloneDeep)(F),F.defaults.custom={};for(const K of F.overrides)for(const B of K.properties)if(B.id.startsWith("custom.")){const w=K.properties.indexOf(B);K.properties.slice(w,1)}return F}renderActions(F,K,B,w){return a.createElement(a.Fragment,null,a.createElement(s.$n,{variant:"primary",onClick:()=>this.exportCsv(F,K),size:"sm"},a.createElement(g.x6,{i18nKey:"dashboard.inspect-data.download-csv"},"Download CSV")),K&&a.createElement(s.$n,{variant:"primary",onClick:this.onExportLogsAsTxt,size:"sm"},a.createElement(g.x6,{i18nKey:"dashboard.inspect-data.download-logs"},"Download logs")),B&&a.createElement(s.$n,{variant:"primary",onClick:this.onExportTracesAsJson,size:"sm"},a.createElement(g.x6,{i18nKey:"dashboard.inspect-data.download-traces"},"Download traces")),w&&a.createElement(s.$n,{variant:"primary",onClick:this.onExportServiceGraph,size:"sm"},a.createElement(g.x6,{i18nKey:"dashboard.inspect-data.download-service"},"Download service graph")))}render(){const{isLoading:F,options:K,data:B,formattedDataDescription:w,onOptionsChange:U,hasTransformations:W}=this.props,{dataFrameIndex:V,transformationOptions:_,selectedDataFrame:H,downloadForExcel:G}=this.state,j=(0,x.c)();if(F)return a.createElement("div",null,a.createElement(h.y,{inline:!0})," Loading");const Y=this.getProcessedData();if(!Y||!Y.length)return a.createElement("div",null,"No Data");const oe=Y[V]?V:0,se=Y[oe],ne=Y.some(z=>z?.meta?.preferredVisualisationType==="logs"),ee=Y.some(z=>z?.meta?.preferredVisualisationType==="trace"),Z=Y.some(z=>z?.meta?.preferredVisualisationType==="nodeGraph");return a.createElement("div",{className:j.wrap,"aria-label":d.Tp.components.PanelInspector.Data.content},a.createElement("div",{className:j.toolbar},a.createElement(C,{data:B,hasTransformations:W,options:K,dataFrames:Y,transformationOptions:_,selectedDataFrame:H,downloadForExcel:G,formattedDataDescription:w,onOptionsChange:U,onDataFrameChange:this.onDataFrameChange,toggleDownloadForExcel:this.onToggleDownloadForExcel,actions:this.renderActions(Y,ne,ee,Z)})),a.createElement("div",{className:j.content},a.createElement(o.Ay,null,({width:z,height:q})=>z===0?null:a.createElement(u.X,{width:z,height:q,data:se,showTypeIcons:!0}))))}}function L(){return[{value:r.F.joinByField,label:(0,g.t)("dashboard.inspect-data.transformation","Series joined by time"),transformer:{id:r.F.joinByField,options:{byField:void 0}}}]}},32067:(Q,I,e)=>{"use strict";e.d(I,{N:()=>g});var n=e(32196),a=e(96540),o=e(13544),r=e(8484),i=e(57875),f=e(11261),d=e(83195),l=e(40845);const m=({timeZone:c,name:y,stats:p})=>{const v=(0,l.$j)(),D=(0,l.of)(h);return!p||!p.length?null:a.createElement("div",{className:D.wrapper},a.createElement("div",{className:"section-heading"},y),a.createElement("table",{className:"filter-table width-30"},a.createElement("tbody",null,p.map((E,S)=>a.createElement("tr",{key:`${E.displayName}-${S}`},a.createElement("td",null,E.displayName),a.createElement("td",{className:D.cell},s(E,c,v)))))))};function s(c,y,p){const v=(0,i.J)({field:{type:f.PU.number,config:c},theme:p,timeZone:y});return(0,d.cN)(v(c.value))}const h=c=>({wrapper:(0,n.css)`
    padding-bottom: ${c.spacing(2)};
  `,cell:(0,n.css)`
    text-align: right;
  `}),u=({name:c,traceIds:y})=>{const p=(0,l.of)(b);return y.length===0?null:a.createElement("div",{className:p.wrapper},a.createElement("div",{className:"section-heading"},c),a.createElement("table",{className:"filter-table width-30"},a.createElement("tbody",null,y.map((v,D)=>a.createElement("tr",{key:`${v}-${D}`},a.createElement("td",null,v))))))},b=c=>({wrapper:(0,n.css)`
    padding-bottom: ${c.spacing(2)};
  `,cell:(0,n.css)`
    text-align: right;
  `}),g=({data:c,timeZone:y})=>{if(!c.request)return null;let p=[];const v=c.request.endTime?c.request.endTime-c.request.startTime:-1,D=c.timings?.dataProcessingTime||-1;let E=0;for(const x of c.series)E+=x.length;v>0&&p.push({displayName:(0,r.t)("dashboard.inspect-stats.request-time","Total request time"),value:v,unit:"ms"}),D>0&&p.push({displayName:(0,r.t)("dashboard.inspect-stats.processing-time","Data processing time"),value:D,unit:"ms"}),p.push({displayName:(0,r.t)("dashboard.inspect-stats.queries","Number of queries"),value:c.request.targets?.length??0}),p.push({displayName:(0,r.t)("dashboard.inspect-stats.rows","Total number rows"),value:E});let S=[];for(const x of c.series)x.meta&&x.meta.stats&&(S=S.concat(x.meta.stats));const T=(0,r.t)("dashboard.inspect-stats.table-title","Stats"),M=(0,r.t)("dashboard.inspect-stats.data-title","Data source stats"),A=(0,r.t)("dashboard.inspect-stats.data-traceids","Trace IDs");return a.createElement("div",{"aria-label":o.Tp.components.PanelInspector.Stats.content,className:P},a.createElement(m,{timeZone:y,name:T,stats:p}),a.createElement(m,{timeZone:y,name:M,stats:S}),a.createElement(u,{name:A,traceIds:c.traceIds??[]}))},P=(0,n.css)`
  height: 100%;
  overflow-y: scroll;
`},90820:(Q,I,e)=>{"use strict";e.d(I,{e:()=>P});var n=e(32196),a=e(96540),o=e(64423),r=e(39070),i=e(13544),f=e(32264),d=e(67061),l=e(55852),m=e(10534),s=e(39558),h=e(24022),u=e(8484),b=e(27677),g=e(26323);class P extends a.PureComponent{constructor(y){super(y),this.subs=new o.yU,this.setFormattedJson=p=>{this.formattedJson=p},this.getTextForClipboard=()=>JSON.stringify(this.formattedJson,null,2),this.onToggleExpand=()=>{this.setState(p=>({...p,allNodesExpanded:!this.state.allNodesExpanded}))},this.onToggleMocking=()=>{this.setState(p=>({...p,isMocking:!this.state.isMocking}))},this.getNrOfOpenNodes=()=>this.state.allNodesExpanded===null?3:this.state.allNodesExpanded?20:1,this.state={executedQueries:[],allNodesExpanded:null,isMocking:!1,mockedResponse:"",response:{}}}componentDidMount(){this.subs.add(b.IB.getInspectorStream().subscribe({next:y=>{let p=!0;if(this.props.instanceId&&y?.requestId&&(p=y.requestId.startsWith(this.props.instanceId)),p)return this.onDataSourceResponse(y.response)}}))}componentDidUpdate(y){this.props.data!==y.data&&this.updateQueryList()}updateQueryList(){const{data:y}=this.props,p=y.series,v=[];if(p?.length){let D;p.forEach((E,S)=>{const T=E.meta?.executedQueryString;if(T){const M=E.refId||"?";D?.refId===M?(D.frames++,D.rows+=E.length):(D={refId:M,frames:0,rows:E.length,query:T},v.push(D))}})}this.setState({executedQueries:v})}componentWillUnmount(){this.subs.unsubscribe()}onDataSourceResponse(y){y.config?.hideFromInspector||(y={...y},y.headers&&delete y.headers,y.config&&(y.request=y.config,delete y.config,delete y.request.transformRequest,delete y.request.transformResponse,delete y.request.paramSerializer,delete y.request.jsonpCallbackParam,delete y.request.headers,delete y.request.requestId,delete y.request.inspect,delete y.request.retry,delete y.request.timeout),y.data&&(y.response=y.data,delete y.config,delete y.data,delete y.status,delete y.statusText,delete y.ok,delete y.url,delete y.redirected,delete y.type,delete y.$$config),this.setState({response:y}))}renderExecutedQueries(y){if(!y.length)return null;const p={refId:(0,n.css)`
        font-weight: ${f.$.theme.typography.weight.semibold};
        color: ${f.$.theme.colors.textBlue};
        margin-right: 8px;
      `};return a.createElement("div",null,y.map(v=>a.createElement(d.B,{key:v.refId,gap:1,direction:"column"},a.createElement("div",null,a.createElement("span",{className:p.refId},v.refId,":"),v.frames>1&&a.createElement("span",null,v.frames," frames, "),a.createElement("span",null,v.rows," rows")),a.createElement("pre",null,v.query))))}render(){const{allNodesExpanded:y,executedQueries:p,response:v}=this.state,{onRefreshQuery:D,data:E}=this.props,S=this.getNrOfOpenNodes(),T=(0,g.A)(f.$.theme2),M=Object.keys(v).length>0,A=E.state===r.Gu.Loading;return a.createElement("div",{className:T.wrap},a.createElement("div",{"aria-label":i.Tp.components.PanelInspector.Query.content},a.createElement("h3",{className:"section-heading"},"Query inspector"),a.createElement("p",{className:"small muted"},a.createElement(u.x6,{i18nKey:"inspector.query.description"},"Query inspector allows you to view raw request and response. To collect this data Grafana needs to issue a new query. Click refresh button below to trigger a new query."))),this.renderExecutedQueries(p),a.createElement("div",{className:T.toolbar},a.createElement(l.$n,{icon:"sync",onClick:D,"aria-label":i.Tp.components.PanelInspector.Query.refreshButton},a.createElement(u.x6,{i18nKey:"inspector.query.refresh"},"Refresh")),M&&y&&a.createElement(l.$n,{icon:"minus",variant:"secondary",className:T.toolbarItem,onClick:this.onToggleExpand},a.createElement(u.x6,{i18nKey:"inspector.query.collapse-all"},"Collapse all")),M&&!y&&a.createElement(l.$n,{icon:"plus",variant:"secondary",className:T.toolbarItem,onClick:this.onToggleExpand},a.createElement(u.x6,{i18nKey:"inspector.query.expand-all"},"Expand all")),M&&a.createElement(m.b,{getText:this.getTextForClipboard,className:T.toolbarItem,icon:"copy",variant:"secondary"},a.createElement(u.x6,{i18nKey:"inspector.query.copy-to-clipboard"},"Copy to clipboard")),a.createElement("div",{className:"flex-grow-1"})),a.createElement("div",{className:T.content},A&&a.createElement(s._,{text:"Loading query inspector..."}),!A&&M&&a.createElement(h.B,{json:v,open:S,onDidRender:this.setFormattedJson}),!A&&!M&&a.createElement("p",{className:"muted"},a.createElement(u.x6,{i18nKey:"inspector.query.no-data"},"No request and response collected yet. Hit refresh button"))))}}},26323:(Q,I,e)=>{"use strict";e.d(I,{A:()=>i,c:()=>r});var n=e(32196),a=e(3911),o=e(2913);const r=(0,a.N)(()=>i(o.config.theme2)),i=f=>({wrap:(0,n.css)`
      display: flex;
      flex-direction: column;
      height: 100%;
      width: 100%;
      flex: 1 1 0;
      min-height: 0;
    `,toolbar:(0,n.css)`
      display: flex;
      width: 100%;
      flex-grow: 0;
      align-items: center;
      justify-content: flex-end;
      margin-bottom: ${f.v1.spacing.sm};
    `,toolbarItem:(0,n.css)`
      margin-left: ${f.v1.spacing.md};
    `,content:(0,n.css)`
      flex-grow: 1;
      height: 100%;
    `,editor:(0,n.css)`
      font-family: monospace;
      height: 100%;
      flex-grow: 1;
    `,viewer:(0,n.css)`
      overflow: scroll;
    `,dataFrameSelect:(0,n.css)`
      flex-grow: 2;
    `,leftActions:(0,n.css)`
      display: flex;
      flex-grow: 1;

      max-width: 85%;
      @media (max-width: 1345px) {
        max-width: 75%;
      }
    `,options:(0,n.css)`
      padding-top: ${f.v1.spacing.sm};
    `,dataDisplayOptions:(0,n.css)`
      flex-grow: 1;
      min-width: 300px;
      margin-right: ${f.v1.spacing.sm};
    `,selects:(0,n.css)`
      display: flex;
      > * {
        margin-right: ${f.v1.spacing.sm};
      }
    `})},16560:(Q,I,e)=>{"use strict";e.d(I,{q:()=>n});var n=(a=>(a.Data="data",a.Meta="meta",a.Error="error",a.Stats="stats",a.JSON="json",a.Query="query",a.Help="help",a))(n||{})},18358:(Q,I,e)=>{"use strict";e.d(I,{ny:()=>F,EM:()=>N,Zy:()=>L,ek:()=>K});var n=e(4213),a=e.n(n),o=e(72724),r=e(18282),i=e(72436),f=e(37471),d=e(19071),l=e(2543);const s=Object.defineProperty({archiveEnabled:!1,dependencies:{dagMaxNumServices:100,menuEnabled:!0},linkPatterns:[],search:{maxLookback:{label:"2 Days",value:"2d"},maxLimit:1500},tracking:{gaID:null,trackErrors:!0}},"__mergeFields",{value:["dependencies","search","tracking"]});function h(){return defaultConfig}function u(B){return _get(h(),B)}function b(B){let w;const U=new Set(B.map(({spanID:W})=>W));for(let W=0;W<B.length;W++){if(B[W].references&&B[W].references.some(({traceID:G,spanID:j})=>G===B[W].traceID&&U.has(j)))continue;if(!w){w=B[W];continue}const _=B[W].references&&B[W].references.length||0,H=w.references&&w.references.length||0;(_<H||_===H&&B[W].startTime<w.startTime)&&(w=B[W])}return w?`${w.process.serviceName}: ${w.operationName}`:""}const g=(0,l.memoize)(b,B=>B.length?B[0].traceID:0);function P(B){const w=new Map,U=B.reduce((V,_)=>(V.some(H=>H.key===_.key&&H.value===_.value)?w.set(`${_.key}:${_.value}`,`Duplicate tag "${_.key}:${_.value}"`):V.push(_),V),[]),W=Array.from(w.values());return{dedupedTags:U,warnings:W}}function c(B,w){const U=B?.slice()??[],W=(w||[]).map(V=>V.toLowerCase());return U.sort((V,_)=>{const H=V.key.toLowerCase(),G=_.key.toLowerCase();for(let j=0;j<W.length;j++){const Y=W[j];if(H.startsWith(Y)&&!G.startsWith(Y))return-1;if(!H.startsWith(Y)&&G.startsWith(Y))return 1}return H>G?1:H<G?-1:0}),U}function y(B){if(!B?.traceID)return null;const w=B.traceID.toLowerCase();let U=0,W=Number.MAX_SAFE_INTEGER;const V=new Map,_=new Map;B.spans=B.spans.filter(ne=>!!ne.startTime),B.processes=Object.entries(B.processes).reduce((ne,[ee,Z])=>(ne[ee]={...Z,tags:c(Z.tags)},ne),{});const H=B.spans.length;for(let ne=0;ne<H;ne++){const ee=B.spans[ne],{startTime:Z,duration:z,processID:q}=ee;let ie=ee.spanID;Z<W&&(W=Z),Z+z>U&&(U=Z+z);const de=V.get(ie);de!=null?(console.warn(`Dupe spanID, ${de+1} x ${ie}`,ee,_.get(ie)),_isEqual(ee,_.get(ie))&&console.warn("	 two spans with same ID have `isEqual(...) === true`"),V.set(ie,de+1),ie=`${ie}_${de}`,ee.spanID=ie):V.set(ie,1),ee.process=B.processes[q],_.set(ie,ee)}const G=getTraceSpanIdsAsTree(B,_),j=[],Y={};G.walk((ne,ee,Z=0)=>{if(ne==="__root__"||typeof ne!="string")return;const z=_.get(ne);if(!z)return;const{serviceName:q}=z.process;Y[q]=(Y[q]||0)+1,z.relativeStartTime=z.startTime-W,z.depth=Z-1,z.hasChildren=ee.children.length>0,z.childSpanCount=ee.children.length,z.warnings=z.warnings||[],z.tags=z.tags||[],z.references=z.references||[],z.childSpanIds=ee.children.slice().sort((de,ue)=>{const fe=_.get(de.value),Se=_.get(ue.value);return Se.startTime+Se.duration-(fe.startTime+fe.duration)}).map(de=>de.value);const ie=P(z.tags);z.tags=c(ie.dedupedTags,getConfigValue("topTagPrefixes")),z.warnings=z.warnings.concat(ie.warnings),z.references.forEach((de,ue)=>{const fe=_.get(de.spanID);fe&&(de.span=fe,ue>0&&(fe.subsidiarilyReferencedBy=fe.subsidiarilyReferencedBy||[],fe.subsidiarilyReferencedBy.push({spanID:ne,traceID:w,span:z,refType:de.refType})))}),j.push(z)});const oe=getTraceName(j);return{services:Object.keys(Y).map(ne=>({name:ne,numberOfSpans:Y[ne]})),spans:j,traceID:w,traceName:oe,processes:B.processes,duration:U-W,startTime:W,endTime:U}}function p(B){const w=B.spans.map(W=>v(W,B.processes)),U=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string},{name:"spanID",type:FieldType.string},{name:"parentSpanID",type:FieldType.string},{name:"operationName",type:FieldType.string},{name:"serviceName",type:FieldType.string},{name:"serviceTags",type:FieldType.other},{name:"startTime",type:FieldType.number},{name:"duration",type:FieldType.number},{name:"logs",type:FieldType.other},{name:"tags",type:FieldType.other},{name:"warnings",type:FieldType.other},{name:"stackTraces",type:FieldType.other}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"jaeger"}}});for(const W of w)U.add(W);return U}function v(B,w){return{spanID:B.spanID,traceID:B.traceID,parentSpanID:B.references?.find(U=>U.refType==="CHILD_OF")?.spanID,operationName:B.operationName,startTime:B.startTime/1e3,duration:B.duration/1e3,logs:B.logs.map(U=>({...U,timestamp:U.timestamp/1e3})),tags:B.tags,warnings:B.warnings??void 0,stackTraces:B.stackTraces,serviceName:w[B.processID].serviceName,serviceTags:w[B.processID].tags}}function D(B,w){const U=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:w.uid,datasourceName:w.name,query:{query:"${__value.raw}"}}}]}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace name"}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"\xB5s"}}],meta:{preferredVisualisationType:"table"}}),W=B.map(E).sort((V,_)=>_?.startTime-V?.startTime);for(const V of W)U.add(V);return U}function E(B){const w=transformTraceData(B);if(w)return{traceID:w.traceID,startTime:w.startTime/1e3,duration:w.duration,traceName:w.traceName}}function S(B){let w={traceID:"",spans:[],processes:{},warnings:null},U=[];for(let W=0;W<B.length;W++){const V=B.get(W);w.traceID||(w.traceID=V.traceID),U.find(_=>_===V.serviceName)||(U.push(V.serviceName),w.processes[`p${U.length}`]={serviceName:V.serviceName,tags:V.serviceTags}),w.spans.push({traceID:V.traceID,spanID:V.spanID,duration:V.duration*1e3,references:V.parentSpanID?[{refType:"CHILD_OF",spanID:V.parentSpanID,traceID:V.traceID}]:[],flags:0,logs:V.logs.map(_=>({..._,timestamp:_.timestamp*1e3})),operationName:V.operationName,processID:Object.keys(w.processes).find(_=>w.processes[_].serviceName===V.serviceName)||"",startTime:V.startTime*1e3,tags:V.tags,warnings:V.warnings?V.warnings:null})}return{data:[w],total:0,limit:0,offset:0,errors:null}}function T(B){const w=B.map(M),U=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"zipkin"}}});for(const W of w)U.add(W);return U}function M(B){const w={traceID:B.traceId,spanID:B.id,parentSpanID:B.parentId,operationName:B.name,serviceName:B.localEndpoint?.serviceName||B.remoteEndpoint?.serviceName||"unknown",serviceTags:x(B),startTime:B.timestamp/1e3,duration:B.duration/1e3,logs:B.annotations?.map(A)??[],tags:Object.keys(B.tags||{}).reduce((U,W)=>W==="error"?(U.push({key:"error",value:!0}),U.push({key:"errorValue",value:B.tags.error}),U):(U.push({key:W,value:B.tags[W]}),U),[])};return B.kind&&(w.tags=[{key:"kind",value:B.kind},...w.tags??[]]),B.shared&&(w.tags=[{key:"shared",value:B.shared},...w.tags??[]]),w}function A(B){return{timestamp:B.timestamp,fields:[{key:"annotation",value:B.value}]}}function x(B){const w=B.localEndpoint||B.remoteEndpoint;return w?[C("ipv4",w.ipv4),C("ipv6",w.ipv6),C("port",w.port),C("endpointType",B.localEndpoint?"local":"remote")].filter(U=>!!U):[]}function C(B,w){if(w)return{key:B,value:w}}const O=B=>{let w=[];for(let U=0;U<B.length;U++){const W=B.get(U);w.push({traceId:W.traceID,parentId:W.parentSpanID,name:W.operationName,id:W.spanID,timestamp:W.startTime*1e3,duration:W.duration*1e3,...R(W),annotations:W.logs.length?W.logs.map(V=>({timestamp:V.timestamp,value:V.fields[0].value})):void 0,tags:W.tags.length?W.tags.filter(V=>V.key!=="kind"&&V.key!=="endpointType"&&V.key!=="shared").reduce((V,_)=>_.key==="error"?{...V,[_.key]:W.tags.find(H=>H.key==="errorValue").value||""}:{...V,[_.key]:_.value},{}):void 0,kind:W.tags.find(V=>V.key==="kind")?.value,shared:W.tags.find(V=>V.key==="shared")?.value})}return w},R=B=>{const w=B.serviceTags.find(U=>U.key==="endpointType")?.value==="local"?"localEndpoint":"remoteEndpoint";return B.serviceName!=="unknown"?{[w]:{serviceName:B.serviceName,ipv4:B.serviceTags.find(U=>U.key==="ipv4")?.value,ipv6:B.serviceTags.find(U=>U.key==="ipv6")?.value,port:B.serviceTags.find(U=>U.key==="port")?.value}}:void 0};function L(B,w){let U="";B.meta?.forEach(_=>{const H=`${_.label}: ${JSON.stringify(_.value)}
`;U=U+H}),U=U+`

`,B.rows.forEach(_=>{const H=(0,o.LE)(_.timeEpochMs,{defaultWithMS:!0})+"	"+_.entry+`
`;U=U+H});const W=new Blob([U],{type:"text/plain;charset=utf-8"}),V=`${w}-logs-${(0,o.LE)(new Date)}.txt`;a()(W,V)}function N(B,w,U,W=r.F.noop){const V=(0,i._O)([B],U),_=U?.useExcelHeader?"\uFEFF":"",H=new Blob([_,V],{type:"text/csv;charset=utf-8"}),G=W!==r.F.noop?"-as-"+W.toLocaleLowerCase():"",j=`${w}-data${G}-${(0,o.LE)(new Date)}.csv`;a()(H,j)}function F(B,w){const U=new Blob([JSON.stringify(B)],{type:"application/json"}),W=`${w}-${(0,o.LE)(new Date)}.json`;a()(U,W)}function K(B,w){let U="otlp";switch(B.meta?.custom?.traceFormat){case"jaeger":{let W=S(new f.k(B));F(W,w),U="jaeger";break}case"zipkin":{let W=O(new f.k(B));F(W,w),U="zipkin";break}case"otlp":default:{let W=(0,d.xw)(new f.k(B));F(W,w);break}}return U}},77938:(Q,I,e)=>{"use strict";e.d(I,{p:()=>o});var n=e(26272),a=e(28138);function o(i){let f="";try{f=JSON.stringify(i,r(),2)}catch(d){d instanceof Error&&(d.toString().includes("RangeError")||d.toString().includes("allocation size overflow"))?a.A.emit(n.r1.alertError,[d.toString(),"Cannot display JSON, the object is too big."]):a.A.emit(n.r1.alertError,[d instanceof Error?d.toString():d])}return f}function r(){const i=new WeakSet;return(f,d)=>{if(f==="__dataContext"||f==="__sceneObject")return"Filtered out in JSON serialization";if(typeof d=="object"&&d!==null){if(i.has(d))return;i.add(d)}return d}}},47259:(Q,I,e)=>{"use strict";e.d(I,{G7:()=>r,KU:()=>i,eb:()=>f});var n=e(17172),a=e(10096),o=e(31678);const r=(0,o.createAsyncThunk)("users/fetchInvitees",async()=>a.contextSrv.hasPermission(o.AccessControlAction.OrgUsersAdd)?await(0,n.AI)().get("/api/org/invites"):[]),i=(0,o.createAsyncThunk)("users/addInvitee",async(d,{dispatch:l})=>{await(0,n.AI)().post("/api/org/invites",d),await l(r())}),f=(0,o.createAsyncThunk)("users/revokeInvite",async d=>(await(0,n.AI)().patch(`/api/org/invites/${d}/revoke`,{}),d))},40823:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>l,Tp:()=>r});var n=e(65307),a=e(47259);const o=(0,n.pU)({selectId:m=>m.code}),r=o.getSelectors(),i=o.getInitialState({status:"idle"}),l={invites:(0,n.Z0)({name:"invites",initialState:i,reducers:{},extraReducers:m=>{m.addCase(a.G7.pending,s=>{s.status="loading"}).addCase(a.G7.fulfilled,(s,{payload:h})=>{o.setAll(s,h),s.status="succeeded"}).addCase(a.G7.rejected,s=>{s.status="failed"}).addCase(a.eb.fulfilled,(s,{payload:h})=>{o.removeOne(s,h),s.status="succeeded"})}}).reducer}},96227:(Q,I,e)=>{"use strict";e.d(I,{b:()=>b,o:()=>g});var n=e(96540),a=e(40996),o=e(16817),r=e(17172),i=e(88575),f=e(10354),d=e(37390),l=e(55852),m=e(85242),s=e(8484),h=e(57767),u=e(88861);const b=({panel:P,initialFolderUid:c,onCreateLibraryPanel:y,onDismiss:p})=>{const[v,D]=(0,n.useState)(c),[E,S]=(0,n.useState)(P.title),[T,M]=(0,n.useState)(P.title),[A,x]=(0,n.useState)(!1);(0,n.useEffect)(()=>x(!0),[E]),(0,a.A)(()=>M(E),350,[E]);const{saveLibraryPanel:C}=(0,u.b)(),O=(0,n.useCallback)(()=>{P.libraryPanel={uid:"",name:E},C(P,v).then(N=>{(0,r.NF)(N)?P.libraryPanel=void 0:(p?.(),y?.(N))})},[P,E,C,v,p,y]),R=(0,o.A)(async()=>{try{return!(await(0,h.e9)(E)).some(N=>N.folderUid===v)}catch(N){return(0,r.NF)(N)&&(N.isHandled=!0),!0}finally{x(!1)}},[T,v]);console.log("isValidName:",R);const L=!R?.value&&R.value!==void 0&&E===T&&!A;return n.createElement(n.Fragment,null,n.createElement(i.D,{label:(0,s.t)("library-panel.add-modal.name","Library panel name"),invalid:L,error:L?(0,s.t)("library-panel.add-modal.error","Library panel with this name already exists"):""},n.createElement(f.p,{id:"share-panel-library-panel-name-input",name:"name",value:E,onChange:N=>S(N.currentTarget.value)})),n.createElement(i.D,{label:(0,s.t)("library-panel.add-modal.folder","Save in folder"),description:(0,s.t)("library-panel.add-modal.folder-description","Library panel permissions are derived from the folder permissions")},n.createElement(m.sR,{onChange:({uid:N})=>D(N),initialFolderUid:c,inputId:"share-panel-library-panel-folder-picker"})),n.createElement(d.a.ButtonRow,null,n.createElement(l.$n,{variant:"secondary",onClick:p,fill:"outline"},n.createElement(s.x6,{i18nKey:"library-panel.add-modal.cancel"},"Cancel")),n.createElement(l.$n,{onClick:O,disabled:L},n.createElement(s.x6,{i18nKey:"library-panel.add-modal.create"},"Create library panel"))))},g=({isOpen:P=!1,panel:c,initialFolderUid:y,...p})=>n.createElement(d.a,{title:"Create library panel",isOpen:P,onDismiss:p.onDismiss},n.createElement(b,{panel:c,initialFolderUid:y,onDismiss:p.onDismiss}))},86474:(Q,I,e)=>{"use strict";e.d(I,{E:()=>O});var n=e(32196),a=e(96540),o=e(70255),r=e(32264),i=e(40845),f=e(14578),d=e(50720),l=e(72129),m=e(41394),s=e(25701),h=e(39070),u=e(37390),b=e(55852),g=e(43535),P=e(16547),c=e(57767),y=e(65307);const p={loadingState:h.Gu.Loading,dashboardTitles:[]},v=(0,y.VP)("libraryPanels/delete/searchCompleted"),D=(N=p,F)=>v.match(F)?{...N,dashboardTitles:F.payload.dashboards.map(K=>K.title),loadingState:h.Gu.Done}:N;function E(N){return async function(F){const K=await(0,c.xV)(N.uid);F(v({dashboards:K}))}}const S=({libraryPanel:N,onDismiss:F,onConfirm:K})=>{const B=(0,i.of)(g.o),[{dashboardTitles:w,loadingState:U},W]=(0,a.useReducer)(D,p),V=(0,a.useMemo)(()=>(0,P.QC)(W),[W]);(0,a.useEffect)(()=>{V(E(N))},[V,N]);const _=!!w.length,H=U===h.Gu.Done;return a.createElement(u.a,{className:B.modal,title:"Delete library panel",icon:"trash-alt",onDismiss:F,isOpen:!0},H?null:a.createElement(T,null),H?a.createElement("div",null,_?a.createElement(A,{dashboardTitles:w}):null,_?null:a.createElement(M,null),a.createElement(u.a.ButtonRow,null,a.createElement(b.$n,{variant:"secondary",onClick:F,fill:"outline"},"Cancel"),a.createElement(b.$n,{variant:"destructive",onClick:K,disabled:_},"Delete"))):null)},T=()=>a.createElement("span",null,"Loading library panel..."),M=()=>{const N=(0,i.of)(g.o);return a.createElement("div",{className:N.modalText},"Do you want to delete this panel?")},A=({dashboardTitles:N})=>{const F=(0,i.of)(g.o),K=N.length===1?"dashboard.":"dashboards.",B=`${N.length} ${K}`;return N.length===0?null:a.createElement("div",null,a.createElement("p",{className:F.textInfo},"This library panel can not be deleted because it is connected to ",a.createElement("strong",null,B)," Remove the library panel from the dashboards listed below and retry."),a.createElement("table",{className:F.myTable},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Dashboard name"))),a.createElement("tbody",null,N.map((w,U)=>a.createElement("tr",{key:`dash-title-${U}`},a.createElement("td",null,w))))))},x=({libraryPanel:N,onClick:F,onDelete:K,showSecondaryActions:B})=>{const[w,U]=(0,a.useState)(!1),W=()=>{K?.(N),U(!1)},V=r.$.panels[N.model.type]??(0,m.$)(N.model.type).meta;return a.createElement(a.Fragment,null,a.createElement(s.b,{isCurrent:!1,title:N.name,description:N.description,plugin:V,onClick:()=>F?.(N),onDelete:B?()=>U(!0):void 0},a.createElement(R,{libraryPanel:N})),w&&a.createElement(S,{libraryPanel:N,onConfirm:W,onDismiss:()=>U(!1)}))},C=({showSecondaryActions:N,rootProps:F})=>{const K=(0,i.of)(L);return a.createElement(s.b.Skeleton,{hasDelete:N,...F},a.createElement(o.A,{containerClassName:K.metaContainer,width:80}))},O=(0,l.j)(x,C);function R({libraryPanel:N}){const F=(0,i.of)(L);return!N.meta?.folderUid&&!N.meta?.folderName?null:N.meta.folderUid?a.createElement("span",{className:F.metaContainer},a.createElement(d.N,{href:`/dashboards/f/${N.meta.folderUid}`},a.createElement(f.I,{name:"folder-upload",size:"sm"}),a.createElement("span",null,N.meta.folderName))):a.createElement("span",{className:F.metaContainer},a.createElement(f.I,{name:"folder",size:"sm"}),a.createElement("span",null,N.meta.folderName))}function L(N){return{metaContainer:(0,n.css)({display:"flex",alignItems:"center",color:N.colors.text.secondary,fontSize:N.typography.bodySmall.fontSize,paddingTop:N.spacing(.5),svg:{marginRight:N.spacing(.5),marginBottom:3}})}}},16678:(Q,I,e)=>{"use strict";e.d(I,{j:()=>T,s:()=>S});var n=e(32196),a=e(96540),o=e(40996),r=e(40845),i=e(66864),f=e(67647),d=e(76459),l=e.n(d),m=e(55852),s=e(21594),h=e(14578),u=e(27677),b=e(64161),g=e(31678);function P({onChange:C,maxMenuHeight:O}){const R=(0,r.of)(y),[L,N]=(0,a.useState)(!1),F=(0,a.useCallback)(W=>c(W,N),[]),K=(0,a.useMemo)(()=>l()(F,300),[F]),[B,w]=(0,a.useState)([]),U=(0,a.useCallback)(W=>{const V=W.filter(_=>!!_.value).map(_=>_.value);C(V),w(W)},[C]);return a.createElement("div",{className:R.container},B.length>0&&a.createElement(m.$n,{size:"xs",icon:"trash-alt",fill:"text",className:R.clear,onClick:()=>C([]),"aria-label":"Clear folders"},"Clear folders"),a.createElement(s.Iv,{value:B,onChange:U,isLoading:L,loadOptions:K,maxMenuHeight:O,placeholder:"Filter by folder",noOptionsMessage:"No folders found",prefix:a.createElement(h.I,{name:"filter"}),"aria-label":"Folder filter",defaultOptions:!0}))}async function c(C,O){O(!0);const R={query:C,type:b.G.DashFolder,permission:g.PermissionLevelString.View},N=(await(0,u.AI)().search(R)).map(F=>({label:F.title,value:{uid:F.uid,title:F.title}}));return(!C||"general".includes(C.toLowerCase()))&&N.unshift({label:"General",value:{uid:"general",title:"General"}}),O(!1),N}function y(C){return{container:(0,n.css)({label:"container",position:"relative",minWidth:"180px",flexGrow:1}),clear:(0,n.css)({label:"clear",fontSize:C.spacing(1.5),position:"absolute",top:-C.spacing(4.5),right:0})}}var p=e(68313),v=e(73725),D=e(15054),E=e(83791),S=(C=>(C.Tight="tight",C.Spacious="spacious",C))(S||{});const T=({onClick:C,variant:O="spacious",currentPanelId:R,currentFolderUID:L,perPage:N=D.FG,showPanelFilter:F=!1,showFolderFilter:K=!1,showSort:B=!1,showSecondaryActions:w=!1})=>{const U=(0,r.of)(M,O),[W,V]=(0,a.useState)(""),[_,H]=(0,a.useState)("");(0,o.A)(()=>H(W),200,[W]);const[G,j]=(0,a.useState)({}),[Y,oe]=(0,a.useState)(L?[L]:[]),[se,ne]=(0,a.useState)([]),ee=B||F||K,Z=O==="tight"?"lg":"xs";return a.createElement("div",{className:U.container},a.createElement(i.gW,{spacing:Z},a.createElement("div",{className:(0,n.cx)(U.gridContainer,{[U.tightLayout]:O==="tight"})},a.createElement("div",{className:U.filterInputWrapper},a.createElement(f.Z,{value:W,onChange:V,placeholder:"Search by name or description",width:0,escapeRegex:!1})),ee&&a.createElement(A,{showSort:B,showPanelFilter:F,showFolderFilter:K,onSortChange:j,onFolderFilterChange:oe,onPanelFilterChange:ne,sortDirection:G.value,variant:O})),a.createElement("div",{className:U.libraryPanelsView},a.createElement(E.y,{onClickCard:C,searchString:_,sortDirection:G.value,panelFilter:se,folderFilter:Y,currentPanelId:R,showSecondaryActions:w,perPage:N}))))};function M(C,O){return{filterInputWrapper:(0,n.css)({flexGrow:O==="tight"?1:"initial"}),container:(0,n.css)({width:"100%",overflowY:"auto",padding:C.spacing(1)}),libraryPanelsView:(0,n.css)({width:"100%"}),gridContainer:(0,n.css)({display:"flex",flexDirection:"column",width:"100%",columnGap:C.spacing(1),rowGap:C.spacing(1),paddingBottom:C.spacing(2)}),tightLayout:(0,n.css)({flexDirection:"row",rowGap:C.spacing(1)})}}const A=a.memo(({variant:C="spacious",showSort:O,showPanelFilter:R,showFolderFilter:L,sortDirection:N,onSortChange:F,onFolderFilterChange:K,onPanelFilterChange:B})=>{const w=(0,r.of)(x),U=(0,a.useCallback)(V=>B(V.map(_=>_.id)),[B]),W=(0,a.useCallback)(V=>K(V.map(_=>_.uid??"")),[K]);return a.createElement("div",{className:(0,n.cx)(w.container,{[w.containerTight]:C==="tight"})},O&&a.createElement(v.r,{value:N,onChange:F,filter:["alpha-asc","alpha-desc"]}),(L||R)&&a.createElement("div",{className:(0,n.cx)(w.filterContainer,{[w.filterContainerTight]:C==="tight"})},L&&a.createElement(P,{onChange:W}),R&&a.createElement(p.$,{onChange:U})))});A.displayName="SearchControls";function x(C){return{container:(0,n.css)({display:"flex",gap:C.spacing(1),flexGrow:1,flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),containerTight:(0,n.css)({flexGrow:"initial",flexDirection:"column",justifyContent:"normal"}),filterContainer:(0,n.css)({display:"flex",flexDirection:"row",gap:C.spacing(1)}),filterContainerTight:(0,n.css)({flexDirection:"column",marginLeft:"initial"})}}},83791:(Q,I,e)=>{"use strict";e.d(I,{y:()=>g});var n=e(32196),a=e(96540),o=e(40996),r=e(39070),i=e(40845),f=e(69529),d=e(72109),l=e(67061),m=e(19384),s=e(8484),h=e(86474),u=e(16547),b=e(8184);const g=({onClickCard:c,searchString:y,sortDirection:p,panelFilter:v,folderFilter:D,showSecondaryActions:E,currentPanelId:S,perPage:T=40,isWidget:M})=>{const A=(0,i.of)(P),[{libraryPanels:x,page:C,perPage:O,numberOfPages:R,loadingState:L,currentPanelId:N},F]=(0,a.useReducer)(b.w_,{...b.Xb,currentPanelId:S,perPage:T}),K=(0,a.useMemo)(()=>(0,u.QC)(F),[F]);(0,o.A)(()=>K((0,u.IF)({searchString:y,sortDirection:p,panelFilter:v,folderFilterUIDs:D,page:C,perPage:O,currentPanelId:N,isWidget:M})),300,[y,p,v,D,C,K]);const B=({uid:W})=>K((0,u.h4)(W,{searchString:y,sortDirection:p,panelFilter:v,folderFilterUIDs:D,page:C,perPage:O})),w=W=>K((0,b.yd)({page:W}));return!(y||v?.length||D?.length)&&L===r.Gu.Done&&x.length<1?a.createElement(f.p,{variant:"call-to-action",message:(0,s.t)("library-panel.empty-state.message","You haven't created any library panels yet")},a.createElement(s.x6,{i18nKey:"library-panel.empty-state.more-info"},"Create a library panel from any existing dashboard panel through the panel context menu."," ",a.createElement(d.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-library-panels/#create-a-library-panel"},"Learn more"))):a.createElement(l.B,{direction:"column",wrap:"nowrap"},L===r.Gu.Loading?a.createElement(a.Fragment,null,a.createElement(h.E.Skeleton,{showSecondaryActions:E}),a.createElement(h.E.Skeleton,{showSecondaryActions:E}),a.createElement(h.E.Skeleton,{showSecondaryActions:E})):x.length<1?a.createElement(f.p,{variant:"not-found",message:(0,s.t)("library-panels.empty-state.message","No library panels found")}):x?.map((W,V)=>a.createElement(h.E,{key:`library-panel=${V}`,libraryPanel:W,onDelete:B,onClick:c,showSecondaryActions:E})),x.length?a.createElement("div",{className:A.pagination},a.createElement(m.d,{currentPage:C,numberOfPages:R,onNavigate:w,hideWhenSinglePage:!0})):null)},P=c=>({pagination:(0,n.css)({alignSelf:"center",marginTop:c.spacing(1)})})},16547:(Q,I,e)=>{"use strict";e.d(I,{IF:()=>c,QC:()=>p,h4:()=>y});var n=e(64423),a=e(65474),o=e(62467),r=e(44240),i=e(39697),f=e(69862),d=e(66847),l=e(69850),m=e(1005),s=e(65961),h=e(67791),u=e(32264),b=e(17706),g=e(57767),P=e(8184);function c(v){const D=(S,T)=>S.id===T.type,E=(S,T)=>{const M=(0,b.A4)();return S.filter(A=>{const x=M.find(C=>D(C,A));return T?!!x?.skipDataQuery:!x?.skipDataQuery})};return function(S){const T=new n.yU,M=(0,a.H)((0,g.dq)({searchString:v.searchString,perPage:v.perPage,page:v.page,excludeUid:v.currentPanelId,sortDirection:v.sortDirection,typeFilter:v.panelFilter,folderFilterUIDs:v.folderFilterUIDs})).pipe((0,f.Z)(A=>{const{elements:x}=A;if(u.$.featureToggles.vizAndWidgetSplit&&v.isWidget!==void 0){const C=E(x,v.isWidget);return(0,o.of)({...A,elements:C})}return(0,o.of)({...A,elements:x})}),(0,f.Z)(({perPage:A,elements:x,page:C,totalCount:O})=>(0,o.of)((0,P.c4)({libraryPanels:x,page:C,perPage:A,totalCount:O}))),(0,d.W)(A=>(console.error(A),(0,o.of)((0,P.c4)({...P.Xb,page:v.page,perPage:v.perPage})))),(0,l.j)(()=>T.unsubscribe()),(0,m.u)());T.add((0,r.h)((0,i.O)(50).pipe((0,s.u)((0,P.d9)()),(0,h.Q)(M)),M).subscribe(S))}}function y(v,D){return async function(E){try{await(0,g.h4)(v),c(D)(E)}catch(S){console.error(S)}}}function p(v){return function(D){return D instanceof Function?D(v):v(D)}}},8184:(Q,I,e)=>{"use strict";e.d(I,{Xb:()=>o,c4:()=>i,d9:()=>r,w_:()=>d,yd:()=>f});var n=e(65307),a=e(39070);const o={loadingState:a.Gu.Loading,libraryPanels:[],totalCount:0,perPage:40,page:1,numberOfPages:0,currentPanelId:void 0},r=(0,n.VP)("libraryPanels/view/initSearch"),i=(0,n.VP)("libraryPanels/view/searchCompleted"),f=(0,n.VP)("libraryPanels/view/changePage"),d=(l,m)=>{if(r.match(m))return{...l,loadingState:a.Gu.Loading};if(i.match(m)){const{libraryPanels:s,page:h,perPage:u,totalCount:b}=m.payload,g=Math.ceil(b/u);return{...l,libraryPanels:s,perPage:u,totalCount:b,loadingState:a.Gu.Done,numberOfPages:g,page:h>g?h-1:h}}return f.match(m)?{...l,page:m.payload.page}:l}},82792:(Q,I,e)=>{"use strict";e.d(I,{X:()=>n});function n(a){return!!a.libraryPanel?.uid}},57767:(Q,I,e)=>{"use strict";e.d(I,{GN:()=>g,GX:()=>y,Yr:()=>m,d7:()=>h,dq:()=>l,e9:()=>s,h4:()=>b,jc:()=>u,xV:()=>P});var n=e(75505),a=e(79422),o=e(34214),r=e(41507),i=e(20455),f=e(27677),d=e(98796);async function l({searchString:p="",perPage:v=100,page:D=1,excludeUid:E="",sortDirection:S="",typeFilter:T=[],folderFilterUIDs:M=[]}={}){const A=new URLSearchParams;A.append("searchString",p),A.append("sortDirection",S),A.append("typeFilter",T.join(",")),A.append("folderFilterUIDs",M.join(",")),A.append("excludeUid",E),A.append("perPage",v.toString(10)),A.append("page",D.toString(10)),A.append("kind",d.i.Panel.toString(10));const{result:x}=await(0,f.AI)().get(`/api/library-elements?${A.toString()}`);return x}async function m(p,v=!1){const D=await(0,n.s)((0,f.AI)().fetch({method:"GET",url:`/api/library-elements/${p}`,showSuccessAlert:!v,showErrorAlert:!v})),{result:E}=D.data,S=new o.G({...a.Ye,schemaVersion:35,panels:[E.model]}),{scopedVars:T,...M}=S.panels[0].getSaveModel();return delete M.gridPos,delete M.id,delete M.libraryPanel,S.destroy(),{...E,model:M}}async function s(p){const{result:v}=await(0,f.AI)().get(`/api/library-elements/name/${p}`);return v}async function h(p,v){const{result:D}=await(0,f.AI)().post("/api/library-elements",{folderUid:v,name:p.libraryPanel.name,model:p,kind:d.i.Panel});return D}async function u(p){const{libraryPanel:v,...D}=p,{uid:E,name:S,version:T,folderUid:M}=v,A=d.i.Panel,{result:x}=await(0,f.AI)().patch(`/api/library-elements/${E}`,{folderUid:M,name:S,model:D,version:T,kind:A});return x}function b(p){return(0,f.AI)().delete(`/api/library-elements/${p}`)}async function g(p){const{result:v}=await(0,f.AI)().get(`/api/library-elements/${p}/connections`);return v}async function P(p){const v=await g(p);return v.length===0?[]:await(0,f.AI)().search({dashboardUIDs:v.map(E=>E.connectionUid)})}function c(p){const{panel:v,uid:D,name:E,_loadedPanel:S}=p.state,T=p.parent;if(!T||!(T instanceof r.U))throw new Error("LibraryVizPanel must be a child of DashboardGridItem");return{uid:D,folderUID:S?.folderUid,name:E,version:S?.version||0,model:(0,i.Z6)(v,{x:T.state.x??0,y:T.state.y??0,w:T.state.width??0,h:T.state.height??0},!1,T),kind:d.i.Panel}}async function y(p){const{uid:v,folderUID:D,name:E,model:S,version:T,kind:M}=c(p),{result:A}=await(0,f.AI)().patch(`/api/library-elements/${v}`,{folderUID:D,name:E,model:S,version:T,kind:M});return A}},43535:(Q,I,e)=>{"use strict";e.d(I,{o:()=>a});var n=e(32196);function a(o){return{myTable:(0,n.css)`
      max-height: 204px;
      overflow-y: auto;
      margin-top: 11px;
      margin-bottom: 28px;
      border-radius: ${o.shape.radius.default};
      border: 1px solid ${o.colors.action.hover};
      background: ${o.colors.background.primary};
      color: ${o.colors.text.secondary};
      font-size: ${o.typography.h6.fontSize};
      width: 100%;

      thead {
        color: #538ade;
        font-size: ${o.typography.bodySmall.fontSize};
      }

      th,
      td {
        padding: 6px 13px;
        height: ${o.spacing(4)};
      }

      tbody > tr:nth-child(odd) {
        background: ${o.colors.background.secondary};
      }
    `,noteTextbox:(0,n.css)`
      margin-bottom: ${o.spacing(4)};
    `,textInfo:(0,n.css)`
      color: ${o.colors.text.secondary};
      font-size: ${o.typography.size.sm};
    `,dashboardSearch:(0,n.css)`
      margin-top: ${o.spacing(2)};
    `,modal:(0,n.css)`
      width: 500px;
    `,modalText:(0,n.css)`
      font-size: ${o.typography.h4.fontSize};
      color: ${o.colors.text.primary};
      margin-bottom: ${o.spacing(4)};
      padding-top: ${o.spacing(2)};
    `}}},98796:(Q,I,e)=>{"use strict";e.d(I,{i:()=>n});var n=(o=>(o[o.Panel=1]="Panel",o))(n||{}),a=(o=>(o[o.Dashboard=1]="Dashboard",o))(a||{})},88861:(Q,I,e)=>{"use strict";e.d(I,{b:()=>s});var n=e(5805),a=e(17172),o=e(3169),r=e(8484),i=e(57767);async function f(h,u){const b=d(h),g=await m(b,u);return l(h,g),g}function d(h){let{scopedVars:u,...b}=h.getSaveModel();return b={libraryPanel:{name:h.title,uid:void 0},...b},b}function l(h,u){h.restoreModel({...u.model,configRev:0,libraryPanel:u,title:h.title}),h.hasSavedPanelEditChange=!0,h.refresh()}function m(h,u){return h.libraryPanel?h.libraryPanel&&h.libraryPanel.uid===""?(0,i.d7)(h,u):(0,i.jc)(h):Promise.reject()}const s=()=>{const h=(0,o._2)(),[u,b]=(0,n.default)(async(g,P)=>{try{const c=await f(g,P);return h.success((0,r.t)("library-panels.save.success","Library panel saved")),c}catch(c){throw(0,a.NF)(c)&&(c.isHandled=!0,h.error((0,r.t)("library-panels.save.error",'Error saving library panel: "{{errorMsg}}"',{errorMsg:c.message??c.data.message}))),c}},[]);return{state:u,saveLibraryPanel:b}}},6473:(Q,I,e)=>{"use strict";e.d(I,{t:()=>v});var n=e(62938),a=e(55004),o=e(26272),r=e(78731),i=e(12131),f=e(10096),d=e(28444),l=e(14792),m=e(32196),s=e(96540),h=e(40845),u=e(37390),b=e(55852),g=(D=>(D.Saved="saved",D.EditingStarted="editing-started",D.EditingCanceled="editing-cancelled",D.Deleted="deleted",D))(g||{});function P({onDismiss:D,event:E}){const S=(0,h.of)(c),T=()=>{if(E?.action===g.Deleted){i.Ny.push("/");return}v.reloadPage(),D()};return s.createElement(u.a,{isOpen:!0,title:"Dashboard changed",icon:"copy",onDismiss:D,onClickBackdrop:()=>{},className:S.modal},s.createElement("div",{className:S.description},"The dashboad has been updated by another session. Do you want to continue editing or discard your local changes?"),s.createElement(u.a.ButtonRow,null,s.createElement(b.$n,{onClick:D,variant:"secondary",fill:"outline"},"Continue editing"),s.createElement(b.$n,{onClick:T,variant:"destructive"},"Discard local changes")))}const c=D=>({modal:(0,m.css)({width:"600px"}),description:(0,m.css)({color:D.colors.text.secondary,paddingBottom:D.spacing(1)})}),y=(0,n.A)();class p{constructor(){this.editing=!1,this.observer={next:E=>{if((0,a.ew)(E)&&this.editing&&E.state===a.ZF.Connected&&this.sendEditingState(),(0,a.Z7)(E)){if(E.message.sessionId===y)return;const{action:S}=E.message;switch(S){case g.EditingStarted:case g.Saved:{if(this.ignoreSave){this.ignoreSave=!1;return}const T=(0,l.UA)().getCurrent();if(T?.uid!==E.message.uid){console.log("dashboard event for different dashboard?",E,T);return}const M=this.editing||T.hasUnsavedChanges();if(S===g.Saved)M?f.lE.publish(new d.S8({component:P,props:{event:E}})):(f.lE.emit(o.r1.alertSuccess,["Dashboard updated"]),this.reloadPage());else if(M&&S===g.EditingStarted&&!this.hasSeenNotice){const A=E.message,x=this.getRecentEditingEvent();(!x||x.message!==A.message)&&(this.hasSeenNotice=!0,f.lE.emit(o.r1.alertWarning,["Another session is editing this dashboard",A.message])),this.lastEditing=A}return}}}}}}setEditingState(E){const S=this.editing=E;this.editing=E,this.hasSeenNotice=!1,S&&f.contextSrv.isEditor&&this.sendEditingState()}sendEditingState(){const{channel:E,uid:S}=this;E&&S&&(0,r.oF)().publish(E,{sessionId:y,uid:S,action:this.editing?g.EditingStarted:g.EditingCanceled,timestamp:Date.now()})}watch(E){const S=(0,r.oF)();S&&E!==this.uid&&(this.channel={scope:a.qD.Grafana,namespace:"dashboard",path:`uid/${E}`},this.leave(),E&&(this.subscription=S.getStream(this.channel).subscribe(this.observer)),this.uid=E)}leave(){this.subscription&&this.subscription.unsubscribe(),this.subscription=void 0,this.uid=void 0}ignoreNextSave(){this.ignoreSave=!0}getRecentEditingEvent(){return this.lastEditing&&this.lastEditing.timestamp&&Date.now()-this.lastEditing.timestamp>5e3&&(this.lastEditing=void 0),this.lastEditing}reloadPage(){i.Ny.reload()}}const v=new p},47118:(Q,I,e)=>{"use strict";e.d(I,{_w:()=>a,o$:()=>f,ot:()=>o});var n=e(14236),a=(d=>(d.NewValuesSameSchema="NewValuesSameSchema",d.FullFrame="FullFrame",d))(a||{});const o=(d,l)=>"type"in d&&d.type===l,r=Object.values(a),i=d=>"type"in d&&r.includes(d.type),f=d=>(0,n.ci)(d)&&"packetInfo"in d},39408:(Q,I,e)=>{"use strict";e.d(I,{l:()=>o});var n=e(89667),a=e(17172);async function o(){return(0,a.AI)().get("api/live/list").then(r=>{const i=r.channels??[],f={},d=i.map(l=>{if(l.data){const m=new Set,s=(0,n.or)(l.data);for(const h of s.fields)m.add(h.name);f[l.channel]=Array.from(m).map(h=>({value:h,label:h}))}return{value:l.channel,label:l.channel+" ["+l.minute_rate+" msg/min]"}});return{channelFields:f,channels:d}})}},81073:(Q,I,e)=>{"use strict";e.d(I,{I:()=>r});var n=e(32196),a=e(96540),o=e(62930);const r=({adjective:f="newer"})=>{const d=`Loading ${f} logs...`;return a.createElement("div",{className:i},a.createElement("div",null,d," ",a.createElement(o.y,{inline:!0})))},i=(0,n.css)`
  display: flex;
  justify-content: center;
`},93463:(Q,I,e)=>{"use strict";e.d(I,{A:()=>d,h:()=>f});var n=e(32196),a=e(96540),o=e(40845),r=e(56034);const i=["level","lvl","filename"],f=a.memo(({labels:s,emptyMessage:h})=>{const u=(0,o.of)(m),b=(0,a.useMemo)(()=>Object.keys(s).filter(g=>!g.startsWith("_")&&!i.includes(g)).sort(),[s]);return b.length===0&&h?a.createElement("span",{className:(0,n.cx)([u.logsLabels])},a.createElement("span",{className:(0,n.cx)([u.logsLabel])},h)):a.createElement("span",{className:(0,n.cx)([u.logsLabels])},b.map(g=>{const P=s[g];if(!P)return;const c=`${g}=${P}`;return a.createElement(r.m,{content:c,key:g,placement:"top"},a.createElement(l,{styles:u},c))}))});f.displayName="LogLabels";const d=a.memo(({labels:s})=>{const h=(0,o.of)(m);return a.createElement("span",{className:(0,n.cx)([h.logsLabels])},s.map(u=>a.createElement(l,{key:u,styles:h,tooltip:u},u)))});d.displayName="LogLabelsList";const l=a.forwardRef(({styles:s,tooltip:h,children:u},b)=>a.createElement("span",{className:(0,n.cx)([s.logsLabel]),ref:b},a.createElement("span",{className:(0,n.cx)([s.logsLabelValue]),title:h},u)));l.displayName="LogLabel";const m=s=>({logsLabels:(0,n.css)`
      display: flex;
      flex-wrap: wrap;
      font-size: ${s.typography.size.xs};
    `,logsLabel:(0,n.css)`
      label: logs-label;
      display: flex;
      padding: ${s.spacing(0,.25)};
      background-color: ${s.colors.background.secondary};
      border-radius: ${s.shape.radius.default};
      margin: ${s.spacing(.125,.5,0,0)};
      text-overflow: ellipsis;
      white-space: nowrap;
      overflow: hidden;
    `,logsLabelValue:(0,n.css)`
      label: logs-label__value;
      display: inline-block;
      max-width: ${s.spacing(25)};
      text-overflow: ellipsis;
      overflow: hidden;
    `})},85492:(Q,I,e)=>{"use strict";e.d(I,{$:()=>m});var n=e(88838),a=e(96540),o=e(23257),r=e.n(o),i=e(21),f=e(40845);function d(s,h){return h.split(/;\s*/).reduce((u,b)=>{if(b==="color:rgba(0,0,0,0.5)")return{color:s.colors.text.secondary};const g=b.match(/([^:\s]+)\s*:\s*(.+)/);if(g&&g[1]&&g[2]){const P=g[1].replace(/-([a-z])/g,(c,y)=>y.toUpperCase());u[P]=g[2]}return u},{})}class l extends a.PureComponent{constructor(){super(...arguments),this.state={chunks:[],prevValue:""}}static getDerivedStateFromProps(h,u){return h.value===u.prevValue?null:{chunks:n.Ay.parse(h.value).spans.map(g=>g.css?{style:d(h.theme,g.css),text:g.text}:{text:g.text}),prevValue:h.value}}render(){const{chunks:h}=this.state;return h.map((u,b)=>{const g=this.props.highlight?.searchWords?a.createElement(r(),{key:b,textToHighlight:u.text,searchWords:this.props.highlight.searchWords,findChunks:i.Oq,highlightClassName:this.props.highlight.highlightClassName}):u.text;return u.style?a.createElement("span",{key:b,style:u.style,"data-testid":"ansiLogLine"},g):g})}}const m=(0,f.cV)(l);m.displayName="LogMessageAnsi"},42785:(Q,I,e)=>{"use strict";e.d(I,{Q:()=>l});var n=e(96540),a=e(76885),o=e(71733),r=e(43127),i=e(29158),f=e(10534),d=e(2913);const l=n.memo(({logText:m,onOpenContext:s,onPermalinkClick:h,onPinLine:u,onUnpinLine:b,pinned:g,row:P,showContextToggle:c,styles:y,mouseIsOver:p,onBlur:v,getRowContextQuery:D})=>{const E=c?c(P):!1,S=(0,n.useCallback)(x=>{x.stopPropagation()},[]),T=(0,n.useCallback)(async x=>{if(x.stopPropagation(),D&&(x.nativeEvent.ctrlKey||x.nativeEvent.metaKey||x.nativeEvent.shiftKey)){const C=window.open("about:blank"),O=await D(P,void 0,!1);if(O&&C){const R=a.kM.renderUrl(o.I.assureBaseUrl(`${(0,d.zj)().appSubUrl}explore`),{left:JSON.stringify({datasource:O.datasource,queries:[O],range:(0,r.E2)()})});C.location=R;return}C?.close()}s(P)},[s,D,P]),M=(0,n.useCallback)(x=>{!x.currentTarget.contains(x.relatedTarget)&&v&&v()},[v]),A=(0,n.useCallback)(()=>m,[m]);return n.createElement("span",{className:`log-row-menu ${y.rowMenu}`,onClick:S,onBlur:M},g&&!p&&n.createElement(i.K,{className:y.unPinButton,size:"md",name:"gf-pin",onClick:()=>b&&b(P),tooltip:"Unpin line",tooltipPlacement:"top","aria-label":"Unpin line",tabIndex:0}),p&&n.createElement(n.Fragment,null,E&&n.createElement(i.K,{size:"md",name:"gf-show-context",onClick:T,tooltip:"Show context",tooltipPlacement:"top","aria-label":"Show context",tabIndex:0}),n.createElement(f.b,{className:y.copyLogButton,icon:"copy",variant:"secondary",fill:"text",size:"md",getText:A,tooltip:"Copy to clipboard",tooltipPlacement:"top",tabIndex:0}),g&&b&&n.createElement(i.K,{className:y.unPinButton,size:"md",name:"gf-pin",onClick:()=>b&&b(P),tooltip:"Unpin line",tooltipPlacement:"top","aria-label":"Unpin line",tabIndex:0}),!g&&u&&n.createElement(i.K,{className:y.unPinButton,size:"md",name:"gf-pin",onClick:()=>u&&u(P),tooltip:"Pin line",tooltipPlacement:"top","aria-label":"Pin line",tabIndex:0}),h&&P.rowId!==void 0&&P.uid&&n.createElement(i.K,{tooltip:"Copy shortlink","aria-label":"Copy shortlink",tooltipPlacement:"top",size:"md",name:"share-alt",onClick:()=>h(P),tabIndex:0})))});l.displayName="LogRowMenuCell"},40455:(Q,I,e)=>{"use strict";e.d(I,{S:()=>d,a:()=>s});var n=e(96540),a=e(23257),o=e.n(a),r=e(21),i=e(85492),f=e(42785);const d=1e5,l=({hasAnsi:h,entry:u,highlights:b,styles:g})=>{const P=b&&b.length>0&&b[0]&&b[0].length>0&&u.length<d,c=b??[];if(h){const y=P?{searchWords:c,highlightClassName:g.logsRowMatchHighLight}:void 0;return n.createElement(i.$,{value:u,highlight:y})}else if(P)return n.createElement(o(),{textToHighlight:u,searchWords:c,findChunks:r.Oq,highlightClassName:g.logsRowMatchHighLight});return n.createElement(n.Fragment,null,u)},m=(h,u,b,g)=>{if(u)try{return JSON.stringify(JSON.parse(h),void 0,2)}catch{}return!b&&!g&&(h=h.replace(/(\r\n|\n|\r)/g,"")),h},s=n.memo(h=>{const{row:u,wrapLogMessage:b,prettifyLogMessage:g,showContextToggle:P,styles:c,onOpenContext:y,onPermalinkClick:p,onUnpinLine:v,onPinLine:D,pinned:E,mouseIsOver:S,onBlur:T,getRowContextQuery:M,expanded:A}=h,{hasAnsi:x,raw:C}=u,O=(0,n.useMemo)(()=>m(C,g,b,!!A),[C,g,b,A]),R=(0,n.useMemo)(()=>S||E,[S,E]);return n.createElement(n.Fragment,null,n.createElement("td",{className:c.logsRowMessage},n.createElement("div",{className:b?c.positionRelative:c.horizontalScroll},n.createElement("button",{className:`${c.logLine} ${c.positionRelative}`},n.createElement(l,{hasAnsi:x,entry:O,highlights:u.searchWords,styles:c})))),n.createElement("td",{className:`log-row-menu-cell ${c.logRowMenuCell}`},R&&n.createElement(f.Q,{logText:O,row:u,showContextToggle:P,getRowContextQuery:M,onOpenContext:y,onPermalinkClick:p,onPinLine:D,onUnpinLine:v,pinned:E,styles:c,mouseIsOver:S,onBlur:T})))});s.displayName="LogRowMessage"},14647:(Q,I,e)=>{"use strict";e.d(I,{k:()=>Z});var n=e(32196),a=e(41811),o=e(96540),r=e(41987),i=e(52622),f=e(32264),d=e(40845),l=e(14110),m=e(38138),s=e(91002);const h=({x:z,y:q,onClickFilterValue:ie,onClickFilterOutValue:de,selection:ue,row:fe,close:Se})=>{const he=(0,o.useRef)(null),ce=(0,d.of)(b);return(0,o.useEffect)(()=>{function pe(ye){ye.key==="Escape"&&Se()}return document.addEventListener("keyup",pe),()=>{document.removeEventListener("keyup",pe)}},[Se]),ie||de?o.createElement("div",{className:ce.menu,style:{top:q,left:z}},o.createElement(m.W,{ref:he},o.createElement(m.W.Item,{label:"Copy selection",onClick:()=>{(0,s.Dk)(ue,he),Se(),u("copy",ue.length,fe.datasourceType)}}),ie&&o.createElement(m.W.Item,{label:"Add as line contains filter",onClick:()=>{ie(ue,fe.dataFrame.refId),Se(),u("line_contains",ue.length,fe.datasourceType)}}),de&&o.createElement(m.W.Item,{label:"Add as line does not contain filter",onClick:()=>{de(ue,fe.dataFrame.refId),Se(),u("line_does_not_contain",ue.length,fe.datasourceType)}}))):null};function u(z,q,ie){(0,l.rR)("grafana_explore_logs_popover_menu",{action:z,selectionLength:q,datasourceType:ie||"unknown"})}const b=z=>({menu:(0,n.css)({position:"fixed",zIndex:z.zIndex.modal})});class g{constructor(){this.seen=new Set,this.count=0}getKey(q){this.count+=1;const ie=`k_${q}`;return this.seen.has(ie)?`i_${this.count}`:(this.seen.add(ie),ie)}}var P=e(2543),c=e(72724),y=e(56034),p=e(14578),v=e(41260),D=e(10534),E=e(29158),S=e(14689),T=e(69147),M=e(3911);const A=z=>({logsStatsRow:(0,n.css)`
    label: logs-stats-row;
    margin: ${parseInt(z.spacing(2),10)/1.75}px 0;
  `,logsStatsRowActive:(0,n.css)`
    label: logs-stats-row--active;
    color: ${z.colors.primary.text};
    position: relative;
  `,logsStatsRowLabel:(0,n.css)`
    label: logs-stats-row__label;
    display: flex;
    margin-bottom: 1px;
  `,logsStatsRowValue:(0,n.css)`
    label: logs-stats-row__value;
    flex: 1;
    text-overflow: ellipsis;
    overflow: hidden;
  `,logsStatsRowCount:(0,n.css)`
    label: logs-stats-row__count;
    text-align: right;
    margin-left: ${z.spacing(.75)};
  `,logsStatsRowPercent:(0,n.css)`
    label: logs-stats-row__percent;
    text-align: right;
    margin-left: ${z.spacing(.75)};
    width: ${z.spacing(4.5)};
  `,logsStatsRowBar:(0,n.css)`
    label: logs-stats-row__bar;
    height: ${z.spacing(.5)};
    overflow: hidden;
    background: ${z.colors.text.disabled};
  `,logsStatsRowInnerBar:(0,n.css)`
    label: logs-stats-row__innerbar;
    height: ${z.spacing(.5)};
    overflow: hidden;
    background: ${z.colors.primary.main};
  `}),x=({active:z,count:q,proportion:ie,value:de})=>{const ue=(0,d.of)(A),fe=`${Math.round(ie*100)}%`,Se={width:fe},he=z?(0,n.cx)([ue.logsStatsRow,ue.logsStatsRowActive]):(0,n.cx)([ue.logsStatsRow]);return o.createElement("div",{className:he},o.createElement("div",{className:(0,n.cx)([ue.logsStatsRowLabel])},o.createElement("div",{className:(0,n.cx)([ue.logsStatsRowValue]),title:de},de),o.createElement("div",{className:(0,n.cx)([ue.logsStatsRowCount])},q),o.createElement("div",{className:(0,n.cx)([ue.logsStatsRowPercent])},fe)),o.createElement("div",{className:(0,n.cx)([ue.logsStatsRowBar])},o.createElement("div",{className:(0,n.cx)([ue.logsStatsRowInnerBar]),style:Se})))};x.displayName="LogLabelStatsRow";const C=5,O=(0,M.N)(z=>({logsStats:(0,n.css)`
      label: logs-stats;
      background: inherit;
      color: ${z.colors.text.primary};
      word-break: break-all;
      width: fit-content;
      max-width: 100%;
    `,logsStatsHeader:(0,n.css)`
      label: logs-stats__header;
      border-bottom: 1px solid ${z.colors.border.medium};
      display: flex;
    `,logsStatsTitle:(0,n.css)`
      label: logs-stats__title;
      font-weight: ${z.typography.fontWeightMedium};
      padding-right: ${z.spacing(2)};
      display: inline-block;
      white-space: nowrap;
      text-overflow: ellipsis;
      flex-grow: 1;
    `,logsStatsClose:(0,n.css)`
      label: logs-stats__close;
      cursor: pointer;
    `,logsStatsBody:(0,n.css)`
      label: logs-stats__body;
      padding: 5px 0px;
    `}));class R extends o.PureComponent{render(){const{label:q,rowCount:ie,stats:de,value:ue,theme:fe,isLabel:Se}=this.props,he=O(fe),ce=de.slice(0,C);let me=ce.find(We=>We.value===ue),pe=de.slice(C);const ye=!me;ye&&(me=pe.find(We=>We.value===ue),pe=pe.filter(We=>We.value!==ue));const Pe=pe.reduce((We,Ae)=>We+Ae.count,0),Oe=ce.reduce((We,Ae)=>We+Ae.count,0)+Pe,Ne=Pe/Oe;return o.createElement("div",{className:he.logsStats,"data-testid":"logLabelStats"},o.createElement("div",{className:he.logsStatsHeader},o.createElement("div",{className:he.logsStatsTitle},q,": ",Oe," of ",ie," rows have that ",Se?"label":"field")),o.createElement("div",{className:he.logsStatsBody},ce.map(We=>o.createElement(x,{key:We.value,...We,active:We.value===ue})),ye&&me&&o.createElement(x,{key:me.value,...me,active:!0}),Pe>0&&o.createElement(x,{key:"__OTHERS__",count:Pe,value:"Other",proportion:Ne})))}}const L=(0,d.cV)(R);L.displayName="LogLabelStats";var N=e(77020);const F=(0,a.A)(z=>({wordBreakAll:(0,n.css)`
      label: wordBreakAll;
      word-break: break-all;
    `,copyButton:(0,n.css)`
      & > button {
        color: ${z.colors.text.secondary};
        padding: 0;
        justify-content: center;
        border-radius: ${z.shape.radius.circle};
        height: ${z.spacing(z.components.height.sm)};
        width: ${z.spacing(z.components.height.sm)};
        svg {
          margin: 0;
        }

        span > div {
          top: -5px;
          & button {
            color: ${z.colors.success.main};
          }
        }
      }
    `,adjoiningLinkButton:(0,n.css)`
      margin-left: ${z.spacing(1)};
    `,wrapLine:(0,n.css)`
      label: wrapLine;
      white-space: pre-wrap;
    `,logDetailsStats:(0,n.css)`
      padding: 0 ${z.spacing(1)};
    `,logDetailsValue:(0,n.css)`
      display: flex;
      align-items: center;
      line-height: 22px;

      .log-details-value-copy {
        visibility: hidden;
      }
      &:hover {
        .log-details-value-copy {
          visibility: visible;
        }
      }
    `,buttonRow:(0,n.css)`
      display: flex;
      flex-direction: row;
      gap: ${z.spacing(.5)};
      margin-left: ${z.spacing(.5)};
    `}));class K extends o.PureComponent{constructor(){super(...arguments),this.state={showFieldsStats:!1,fieldCount:0,fieldStats:null},this.showField=()=>{const{onClickShowField:q,parsedKeys:ie,row:de}=this.props;q&&q(ie[0]),(0,l.rR)("grafana_explore_logs_log_details_replace_line_clicked",{datasourceType:de.datasourceType,logRowUid:de.uid,type:"enable"})},this.hideField=()=>{const{onClickHideField:q,parsedKeys:ie,row:de}=this.props;q&&q(ie[0]),(0,l.rR)("grafana_explore_logs_log_details_replace_line_clicked",{datasourceType:de.datasourceType,logRowUid:de.uid,type:"disable"})},this.isFilterLabelActive=async()=>{const{isFilterLabelActive:q,parsedKeys:ie,parsedValues:de,row:ue}=this.props;return q?await q(ie[0],de[0],ue.dataFrame?.refId):!1},this.filterLabel=()=>{const{onClickFilterLabel:q,parsedKeys:ie,parsedValues:de,row:ue}=this.props;q&&q(ie[0],de[0],(0,T.f8)(ue)||void 0),(0,l.rR)("grafana_explore_logs_log_details_filter_clicked",{datasourceType:ue.datasourceType,filterType:"include",logRowUid:ue.uid})},this.filterOutLabel=()=>{const{onClickFilterOutLabel:q,parsedKeys:ie,parsedValues:de,row:ue}=this.props;q&&q(ie[0],de[0],(0,T.f8)(ue)||void 0),(0,l.rR)("grafana_explore_logs_log_details_filter_clicked",{datasourceType:ue.datasourceType,filterType:"exclude",logRowUid:ue.uid})},this.updateStats=()=>{const{getStats:q}=this.props,ie=q(),de=ie?ie.reduce((ue,fe)=>ue+fe.count,0):0;(!(0,P.isEqual)(this.state.fieldStats,ie)||de!==this.state.fieldCount)&&this.setState({fieldStats:ie,fieldCount:de})},this.showStats=()=>{const{isLabel:q,row:ie,app:de}=this.props,{showFieldsStats:ue}=this.state;ue||this.updateStats(),this.toggleFieldsStats(),(0,l.rR)("grafana_explore_logs_log_details_stats_clicked",{dataSourceType:ie.datasourceType,fieldType:q?"label":"detectedField",type:ue?"close":"open",logRowUid:ie.uid,app:de})}}componentDidUpdate(){this.state.showFieldsStats&&this.updateStats()}toggleFieldsStats(){this.setState(q=>({showFieldsStats:!q.showFieldsStats}))}generateClipboardButton(q){const{theme:ie}=this.props,de=F(ie);return o.createElement("div",{className:`log-details-value-copy ${de.copyButton}`},o.createElement(D.b,{getText:()=>q,title:"Copy value to clipboard",fill:"text",variant:"secondary",icon:"copy",size:"md"}))}generateMultiVal(q,ie){return o.createElement("table",null,o.createElement("tbody",null,q?.map((de,ue)=>o.createElement("tr",{key:`${de}-${ue}`},o.createElement("td",null,de,ie&&de!==""&&this.generateClipboardButton(de))))))}render(){const{theme:q,parsedKeys:ie,parsedValues:de,isLabel:ue,links:fe,displayedFields:Se,wrapLogMessage:he,onClickFilterLabel:ce,onClickFilterOutLabel:me,disableActions:pe,row:ye}=this.props,{showFieldsStats:Pe,fieldStats:Ie,fieldCount:Oe}=this.state,Ne=F(q),We=(0,N.D)(q),Ae=ie==null?!1:ie.length===1,Ue=de==null?!1:de.length===1,Me=!pe&&ce&&me,$e=ye.dataFrame?.refId?` in query ${ye.dataFrame?.refId}`:"",ke=!Ue&&de!=null&&!de.every(ot=>ot===""),Ze=Se&&ie!=null&&Se.includes(ie[0])?o.createElement(E.K,{variant:"primary",tooltip:"Hide this field",name:"eye",onClick:this.hideField}):o.createElement(E.K,{tooltip:"Show this field instead of the message",name:"eye",onClick:this.showField});return o.createElement(o.Fragment,null,o.createElement("tr",{className:We.logDetailsValue},o.createElement("td",{className:We.logsDetailsIcon},o.createElement("div",{className:Ne.buttonRow},Me&&o.createElement(o.Fragment,null,o.createElement(B,{name:"search-plus",onClick:this.filterLabel,isActive:()=>this.isFilterLabelActive(),tooltipSuffix:$e}),o.createElement(E.K,{name:"search-minus",tooltip:`Filter out value${$e}`,onClick:this.filterOutLabel})),!pe&&Se&&Ze,!pe&&o.createElement(E.K,{variant:Pe?"primary":"secondary",name:"signal",tooltip:"Ad-hoc statistics",className:"stats-button",disabled:!Ae,onClick:this.showStats}))),o.createElement("td",{className:We.logDetailsLabel},Ae?ie[0]:this.generateMultiVal(ie)),o.createElement("td",{className:(0,n.cx)(Ne.wordBreakAll,he&&Ne.wrapLine)},o.createElement("div",{className:Ne.logDetailsValue},Ue?de[0]:this.generateMultiVal(de,!0),Ue&&this.generateClipboardButton(de[0]),o.createElement("div",{className:(0,n.cx)((Ue||ke)&&Ne.adjoiningLinkButton)},fe?.map((ot,xt)=>o.createElement("span",{key:`${ot.title}-${xt}`},o.createElement(S.R,{link:ot}))))))),Pe&&Ae&&Ue&&o.createElement("tr",null,o.createElement("td",null,o.createElement(E.K,{variant:Pe?"primary":"secondary",name:"signal",tooltip:"Hide ad-hoc statistics",onClick:this.showStats})),o.createElement("td",{colSpan:2},o.createElement("div",{className:Ne.logDetailsStats},o.createElement(L,{stats:Ie,label:ie[0],value:de[0],rowCount:Oe,isLabel:ue})))))}}const B=({isActive:z,tooltipSuffix:q,...ie})=>{const[de,ue]=(0,o.useState)(!1),fe=de?"Remove filter":"Filter for value";return(0,o.useEffect)(()=>{z().then(ue)},[z]),o.createElement(E.K,{...ie,variant:de?"primary":void 0,tooltip:fe+q})},w=(0,d.cV)(K);w.displayName="LogDetailsRow";var U=e(70377);class W extends o.PureComponent{render(){const{app:q,row:ie,theme:de,hasError:ue,onClickFilterOutLabel:fe,onClickFilterLabel:Se,getRows:he,showDuplicates:ce,className:me,onClickShowField:pe,onClickHideField:ye,displayedFields:Pe,getFieldLinks:Ie,wrapLogMessage:Oe,styles:Ne}=this.props,We=(0,N.L)(de,ie.logLevel),Ae=ie.labels?ie.labels:{},Ue=Object.keys(Ae).length>0,Me=(0,U.jE)(ie,Ie);let $e=Me.filter(re=>re.links?.length);const ke=$e.filter(re=>re.fieldIndex!==ie.entryFieldIndex).sort(),Ze=$e.filter(re=>re.fieldIndex===ie.entryFieldIndex).sort(),ot=(0,U.qE)(Ze),xt=ke&&ke.length>0||ot&&ot.length>0,ct=ie.dataFrame.meta?.type===v.m.LogLines?[]:Me.filter(re=>re.links?.length===0&&re.fieldIndex!==ie.entryFieldIndex).sort(),ft=ct&&ct.length>0,Le=ue?"":`${We.logsRowLevelColor} ${Ne.logsRowLevel} ${Ne.logsRowLevelDetails}`;return o.createElement("tr",{className:(0,n.cx)(me,Ne.logDetails)},ce&&o.createElement("td",null),o.createElement("td",{className:Le,"aria-label":"Log level"}),o.createElement("td",{colSpan:4},o.createElement("div",{className:Ne.logDetailsContainer},o.createElement("table",{className:Ne.logDetailsTable},o.createElement("tbody",null,(Ue||ft)&&o.createElement("tr",null,o.createElement("td",{colSpan:100,className:Ne.logDetailsHeading,"aria-label":"Fields"},"Fields")),Object.keys(Ae).sort().map((re,X)=>{const le=Ae[re];return o.createElement(w,{key:`${re}=${le}-${X}`,parsedKeys:[re],parsedValues:[le],isLabel:!0,getStats:()=>(0,s.Tj)(he(),re),onClickFilterOutLabel:fe,onClickFilterLabel:Se,onClickShowField:pe,onClickHideField:ye,row:ie,app:q,wrapLogMessage:Oe,displayedFields:Pe,disableActions:!1,isFilterLabelActive:this.props.isFilterLabelActive})}),ct.map((re,X)=>{const{keys:le,values:be,fieldIndex:De}=re;return o.createElement(w,{key:`${le[0]}=${be[0]}-${X}`,parsedKeys:le,parsedValues:be,onClickShowField:pe,onClickHideField:ye,onClickFilterOutLabel:fe,onClickFilterLabel:Se,getStats:()=>(0,s.s2)(ie.dataFrame.fields[De].values),displayedFields:Pe,wrapLogMessage:Oe,row:ie,app:q,disableActions:!1,isFilterLabelActive:this.props.isFilterLabelActive})}),xt&&o.createElement("tr",null,o.createElement("td",{colSpan:100,className:Ne.logDetailsHeading,"aria-label":"Data Links"},"Links")),ke.map((re,X)=>{const{keys:le,values:be,links:De,fieldIndex:Te}=re;return o.createElement(w,{key:`${le[0]}=${be[0]}-${X}`,parsedKeys:le,parsedValues:be,links:De,onClickShowField:pe,onClickHideField:ye,getStats:()=>(0,s.s2)(ie.dataFrame.fields[Te].values),displayedFields:Pe,wrapLogMessage:Oe,row:ie,app:q,disableActions:!1})}),ot?.map((re,X)=>{const{keys:le,values:be,links:De,fieldIndex:Te}=re;return o.createElement(w,{key:`${le[0]}=${be[0]}-${X}`,parsedKeys:le,parsedValues:be,links:De,onClickShowField:pe,onClickHideField:ye,getStats:()=>(0,s.s2)(ie.dataFrame.fields[Te].values),displayedFields:Pe,wrapLogMessage:Oe,row:ie,app:q,disableActions:!0})}),!ft&&!Ue&&!xt&&o.createElement("tr",null,o.createElement("td",{colSpan:100,"aria-label":"No details"},"No details available")))))))}}const V=(0,d.cV)(W);V.displayName="LogDetails";var _=e(93463),H=e(40455),G=e(42785);const j=o.memo(z=>{const{row:q,detectedFields:ie,getFieldLinks:de,wrapLogMessage:ue,styles:fe,mouseIsOver:Se,pinned:he,...ce}=z,me=ue?"":Y.noWrap,pe=(0,o.useMemo)(()=>(0,U.jE)(q,de),[de,q]),ye=(0,o.useMemo)(()=>{let Ie="";for(let Oe=0;Oe<ie.length;Oe++){const Ne=ie[Oe],We=pe.find(Ae=>{const{keys:Ue}=Ae;return Ue[0]===Ne});We&&(Ie+=` ${Ne}=${We.values}`),q.labels[Ne]!==void 0&&q.labels[Ne]!==null&&(Ie+=` ${Ne}=${q.labels[Ne]}`)}return Ie.trimStart()},[ie,pe,q.labels]),Pe=(0,o.useMemo)(()=>Se||he,[Se,he]);return o.createElement(o.Fragment,null,o.createElement("td",{className:fe.logsRowMessage},o.createElement("div",{className:me},ye)),o.createElement("td",{className:`log-row-menu-cell ${fe.logRowMenuCell}`},Pe&&o.createElement(G.Q,{logText:ye,row:q,styles:fe,pinned:he,mouseIsOver:Se,...ce})))}),Y={noWrap:(0,n.css)`
    white-space: nowrap;
  `};j.displayName="LogRowMessageDisplayedFields";class oe extends o.PureComponent{constructor(q){super(q),this.state={permalinked:!1,showingContext:!1,showDetails:!1,mouseIsOver:!1},this.debouncedContextClose=(0,P.debounce)(()=>{this.setState({showingContext:!1})},3e3),this.onOpenContext=ie=>{this.setState({showingContext:!0}),this.props.onOpenContext(ie,this.debouncedContextClose)},this.onRowClick=ie=>{this.props.handleTextSelection?.(ie,this.props.row)||this.props.enableLogDetails&&((0,l.rR)("grafana_explore_logs_log_details_clicked",{datasourceType:this.props.row.datasourceType,type:this.state.showDetails?"close":"open",logRowUid:this.props.row.uid,app:this.props.app}),this.setState(de=>({showDetails:!de.showDetails})))},this.onMouseEnter=()=>{this.setState({mouseIsOver:!0}),this.props.onLogRowHover&&this.props.onLogRowHover(this.props.row)},this.onMouseMove=ie=>{this.props.handleTextSelection&&document.getSelection()?.toString()&&ie.buttons>0&&this.setState({mouseIsOver:!1})},this.onMouseLeave=()=>{this.setState({mouseIsOver:!1}),this.props.onLogRowHover&&this.props.onLogRowHover(void 0)},this.scrollToLogRow=(ie,de=!1)=>{const{row:ue,permalinkedRowId:fe,scrollIntoView:Se,containerRendered:he}=this.props;if(fe!==ue.uid){(ie.permalinked||de)&&this.setState({permalinked:!1});return}!this.state.permalinked&&he&&this.logLineRef.current&&Se&&(Se(this.logLineRef.current),(0,l.rR)("grafana_explore_logs_permalink_opened",{datasourceType:ue.datasourceType??"unknown",logRowUid:ue.uid}),this.setState({permalinked:!0}))},this.escapeRow=(0,a.A)((ie,de)=>ie.hasUnescapedContent&&de?{...ie,entry:(0,s.Hw)(ie.entry),raw:(0,s.Hw)(ie.raw)}:ie),this.logLineRef=o.createRef()}renderTimeStamp(q){return(0,c.LE)(q,{timeZone:this.props.timeZone,defaultWithMS:!0})}componentDidMount(){this.scrollToLogRow(this.state,!0)}componentDidUpdate(q,ie){this.scrollToLogRow(ie)}render(){const{getRows:q,onClickFilterLabel:ie,onClickFilterOutLabel:de,onClickShowField:ue,onClickHideField:fe,enableLogDetails:Se,row:he,showDuplicates:ce,showContextToggle:me,showLabels:pe,showTime:ye,displayedFields:Pe,wrapLogMessage:Ie,prettifyLogMessage:Oe,theme:Ne,getFieldLinks:We,forceEscape:Ae,app:Ue,styles:Me,getRowContextQuery:$e}=this.props,{showDetails:ke,showingContext:Ze,permalinked:ot}=this.state,xt=(0,N.L)(Ne,he.logLevel),{errorMessage:ct,hasError:ft}=(0,s.Ei)(he),Le=(0,n.cx)(Me.logsRow,{[Me.errorLogRow]:ft,[Me.highlightBackground]:Ze||ot}),re=(0,n.cx)(Me.logsRow,{[Me.errorLogRow]:ft,[Me.highlightBackground]:ot&&!this.state.showDetails}),X=this.escapeRow(he,Ae);return o.createElement(o.Fragment,null,o.createElement("tr",{ref:this.logLineRef,className:Le,onClick:this.onRowClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onMouseMove:this.onMouseMove,onFocus:this.onMouseEnter},ce&&o.createElement("td",{className:Me.logsRowDuplicates},X.duplicates&&X.duplicates>0?`${X.duplicates+1}x`:null),o.createElement("td",{className:ft?Me.logsRowWithError:`${xt.logsRowLevelColor} ${Me.logsRowLevel}`},ft&&o.createElement(y.m,{content:`Error: ${ct}`,placement:"right",theme:"error"},o.createElement(p.I,{className:Me.logIconError,name:"exclamation-triangle",size:"xs"}))),o.createElement("td",{title:Se?ke?"Hide log details":"See log details":"",className:Se?Me.logsRowToggleDetails:""},Se&&o.createElement(p.I,{className:Me.topVerticalAlign,name:ke?"angle-down":"angle-right"})),ye&&o.createElement("td",{className:Me.logsRowLocalTime},this.renderTimeStamp(he.timeEpochMs)),pe&&X.uniqueLabels&&o.createElement("td",{className:Me.logsRowLabels},o.createElement(_.h,{labels:X.uniqueLabels})),Pe&&Pe.length>0?o.createElement(j,{row:X,showContextToggle:me,detectedFields:Pe,getFieldLinks:We,wrapLogMessage:Ie,onOpenContext:this.onOpenContext,onPermalinkClick:this.props.onPermalinkClick,styles:Me,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinned:this.props.pinned,mouseIsOver:this.state.mouseIsOver,onBlur:this.onMouseLeave}):o.createElement(H.a,{row:X,showContextToggle:me,getRowContextQuery:$e,wrapLogMessage:Ie,prettifyLogMessage:Oe,onOpenContext:this.onOpenContext,onPermalinkClick:this.props.onPermalinkClick,app:Ue,styles:Me,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinned:this.props.pinned,mouseIsOver:this.state.mouseIsOver,onBlur:this.onMouseLeave,expanded:this.state.showDetails})),this.state.showDetails&&o.createElement(V,{className:re,showDuplicates:ce,getFieldLinks:We,onClickFilterLabel:ie,onClickFilterOutLabel:de,onClickShowField:ue,onClickHideField:fe,getRows:q,row:X,wrapLogMessage:Ie,hasError:ft,displayedFields:Pe,app:Ue,styles:Me,isFilterLabelActive:this.props.isFilterLabelActive}))}}const se=(0,d.cV)(oe);se.displayName="LogRow";const ne=100;class ee extends o.PureComponent{constructor(){super(...arguments),this.renderAllTimer=null,this.logRowsRef=(0,o.createRef)(),this.state={renderAll:!1,selection:"",selectedRow:null,popoverMenuCoordinates:{x:0,y:0}},this.openContext=(q,ie)=>{this.props.onOpenContext&&this.props.onOpenContext(q,ie)},this.handleSelection=(q,ie)=>{if(this.popoverMenuSupported()===!1)return!1;const de=document.getSelection()?.toString();if(!de||!this.logRowsRef.current)return!1;const ue=270,fe=105,Se=q.clientX+ue>window.innerWidth?window.innerWidth-ue:q.clientX,he=q.clientY+fe>window.innerHeight?window.innerHeight-fe:q.clientY;return this.setState({selection:de,popoverMenuCoordinates:{x:Se,y:he},selectedRow:ie}),document.addEventListener("click",this.handleDeselection),document.addEventListener("contextmenu",this.handleDeselection),!0},this.handleDeselection=q=>{if((0,s.a8)(q.target)&&!this.logRowsRef.current?.contains(q.target)){this.closePopoverMenu();return}document.getSelection()?.toString()},this.closePopoverMenu=()=>{document.removeEventListener("click",this.handleDeselection),document.removeEventListener("contextmenu",this.handleDeselection),this.setState({selection:"",popoverMenuCoordinates:{x:0,y:0},selectedRow:null})},this.makeGetRows=(0,a.A)(q=>()=>q),this.sortLogs=(0,a.A)((q,ie)=>(0,s.oR)(q,ie))}static{this.defaultProps={previewLimit:ne}}popoverMenuSupported(){return!f.$.featureToggles.logRowsPopoverMenu||this.props.app!==r.Jk.Explore?!1:!!(this.props.onClickFilterOutValue||this.props.onClickFilterValue)}componentDidMount(){const{logRows:q,previewLimit:ie}=this.props,ue=(q?q.length:0)<=ie*2;ue?this.setState({renderAll:ue}):this.renderAllTimer=window.setTimeout(()=>this.setState({renderAll:!0}),2e3)}componentWillUnmount(){document.removeEventListener("click",this.handleDeselection),document.removeEventListener("contextmenu",this.handleDeselection),document.removeEventListener("selectionchange",this.handleDeselection),this.renderAllTimer&&clearTimeout(this.renderAllTimer)}render(){const{deduplicatedRows:q,logRows:ie,dedupStrategy:de,theme:ue,logsSortOrder:fe,previewLimit:Se,...he}=this.props,{renderAll:ce}=this.state,me=(0,N.D)(ue),pe=q||ie,ye=ie&&ie.length>0,Pe=pe?pe.reduce(($e,ke)=>ke.duplicates?$e+ke.duplicates:$e,0):0,Ie=de!==i.fY.none&&Pe>0,Oe=pe||[],Ne=fe?this.sortLogs(Oe,fe):Oe,We=Ne.slice(0,Se),Ae=Ne.slice(Se,Ne.length),Ue=this.makeGetRows(Ne),Me=new g;return o.createElement("div",{className:me.logRows,ref:this.logRowsRef},this.state.selection&&this.state.selectedRow&&o.createElement(h,{close:this.closePopoverMenu,row:this.state.selectedRow,selection:this.state.selection,...this.state.popoverMenuCoordinates,onClickFilterValue:he.onClickFilterValue,onClickFilterOutValue:he.onClickFilterOutValue}),o.createElement("table",{className:(0,n.cx)(me.logsRowsTable,this.props.overflowingContent?"":me.logsRowsTableContain)},o.createElement("tbody",null,ye&&We.map($e=>o.createElement(se,{key:Me.getKey($e.uid),getRows:Ue,row:$e,showDuplicates:Ie,logsSortOrder:fe,onOpenContext:this.openContext,styles:me,onPermalinkClick:this.props.onPermalinkClick,scrollIntoView:this.props.scrollIntoView,permalinkedRowId:this.props.permalinkedRowId,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinned:this.props.pinnedRowId===$e.uid,isFilterLabelActive:this.props.isFilterLabelActive,handleTextSelection:this.popoverMenuSupported()?this.handleSelection:void 0,...he})),ye&&ce&&Ae.map($e=>o.createElement(se,{key:Me.getKey($e.uid),getRows:Ue,row:$e,showDuplicates:Ie,logsSortOrder:fe,onOpenContext:this.openContext,styles:me,onPermalinkClick:this.props.onPermalinkClick,scrollIntoView:this.props.scrollIntoView,permalinkedRowId:this.props.permalinkedRowId,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinned:this.props.pinnedRowId===$e.uid,isFilterLabelActive:this.props.isFilterLabelActive,handleTextSelection:this.popoverMenuSupported()?this.handleSelection:void 0,...he})),ye&&!ce&&o.createElement("tr",null,o.createElement("td",{colSpan:5},"Rendering ",Ne.length-Se," rows...")))))}}const Z=(0,d.cV)(ee);Z.displayName="LogsRows"},77020:(Q,I,e)=>{"use strict";e.d(I,{D:()=>l,L:()=>d});var n=e(32196),a=e(41811),o=e(84140),r=e(9557),i=e(23596),f=e(16797);const d=(m,s)=>{let h=m.isLight?m.v1.palette.gray5:m.v1.palette.gray2;switch(s){case r.$b.crit:case r.$b.critical:h="#705da0";break;case r.$b.error:case r.$b.err:h="#e24d42";break;case r.$b.warning:case r.$b.warn:h=m.colors.warning.main;break;case r.$b.info:h="#7eb26d";break;case r.$b.debug:h="#1f78c1";break;case r.$b.trace:h="#6ed0e0";break}return{logsRowLevelColor:(0,n.css)`
      &::after {
        background-color: ${h};
      }
    `}},l=(0,a.A)(m=>{const s=f.hoverColor(m.colors.background.secondary,m),h=(0,o.A)(m.components.dashboard.background).setAlpha(.7).toRgbString();return{logsRowLevel:(0,n.css)`
      label: logs-row__level;
      max-width: ${m.spacing(1.25)};
      cursor: default;
      &::after {
        content: '';
        display: block;
        position: absolute;
        top: 1px;
        bottom: 1px;
        width: 3px;
        left: ${m.spacing(.5)};
      }
    `,logsRowWithError:(0,n.css)({maxWidth:`${m.spacing(1.5)}`}),logsRowMatchHighLight:(0,n.css)`
      label: logs-row__match-highlight;
      background: inherit;
      padding: inherit;
      color: ${m.components.textHighlight.text}
      background-color: ${m.components.textHighlight};
    `,logRows:(0,n.css)({position:"relative"}),logsRowsTable:(0,n.css)`
      label: logs-rows;
      font-family: ${m.typography.fontFamilyMonospace};
      font-size: ${m.typography.bodySmall.fontSize};
      width: 100%;
      position: relative;
    `,logsRowsTableContain:(0,n.css)`
      contain: strict;
    `,highlightBackground:(0,n.css)`
      background-color: ${(0,o.A)(m.colors.info.transparent).setAlpha(.25).toString()};
    `,logsRow:(0,n.css)`
      label: logs-row;
      width: 100%;
      cursor: pointer;
      vertical-align: top;

      &:hover {
        .log-row-menu {
          z-index: 1;
        }

        background: ${s};
      }

      td:not(.log-row-menu-cell):last-child {
        width: 100%;
      }

      > td:not(.log-row-menu-cell) {
        position: relative;
        padding-right: ${m.spacing(1)};
        border-top: 1px solid transparent;
        border-bottom: 1px solid transparent;
        height: 100%;
      }
    `,logsRowDuplicates:(0,n.css)`
      label: logs-row__duplicates;
      text-align: right;
      width: 4em;
      cursor: default;
    `,logIconError:(0,n.css)`
      color: ${m.colors.warning.main};
    `,logsRowToggleDetails:(0,n.css)`
      label: logs-row-toggle-details__level;
      font-size: 9px;
      padding-top: 5px;
      max-width: 15px;
    `,logsRowLocalTime:(0,n.css)`
      label: logs-row__localtime;
      white-space: nowrap;
    `,logsRowLabels:(0,n.css)`
      label: logs-row__labels;
      white-space: nowrap;
      max-width: 22em;

      /* This is to make the labels vertical align */
      > span {
        margin-top: 0.75px;
      }
    `,logsRowMessage:(0,n.css)`
      label: logs-row__message;
      white-space: pre-wrap;
      word-break: break-all;
      overflow-wrap: anywhere;
      width: 100%;
      text-align: left;
    `,copyLogButton:(0,n.css)`
      padding: 0 0 0 ${m.spacing(.5)};
      height: ${m.spacing(3)};
      width: ${m.spacing(3.25)};
      line-height: ${m.spacing(2.5)};
      overflow: hidden;
      &:hover {
          background-color: ${i.alpha(m.colors.text.primary,.12)};
        }
      }
    `,logDetailsContainer:(0,n.css)`
      label: logs-row-details-table;
      border: 1px solid ${m.colors.border.medium};
      padding: 0 ${m.spacing(1)} ${m.spacing(1)};
      border-radius: ${m.shape.radius.default};
      margin: ${m.spacing(2.5)} ${m.spacing(1)} ${m.spacing(2.5)} ${m.spacing(2)};
      cursor: default;
    `,logDetailsTable:(0,n.css)`
      label: logs-row-details-table;
      line-height: 18px;
      width: 100%;
      td:last-child {
        width: 100%;
      }
    `,logsDetailsIcon:(0,n.css)`
      label: logs-row-details__icon;
      position: relative;
      color: ${m.v1.palette.gray3};
      padding-top: 1px;
      padding-bottom: 1px;
      padding-right: ${m.spacing(.75)};
    `,logDetailsLabel:(0,n.css)`
      label: logs-row-details__label;
      max-width: 30em;
      min-width: 20em;
      padding: 0 ${m.spacing(1)};
      overflow-wrap: break-word;
    `,logDetailsHeading:(0,n.css)`
      label: logs-row-details__heading;
      font-weight: ${m.typography.fontWeightBold};
      padding: ${m.spacing(1)} 0 ${m.spacing(.5)};
    `,logDetailsValue:(0,n.css)`
      label: logs-row-details__row;
      position: relative;
      vertical-align: middle;
      cursor: default;

      &:hover {
        background-color: ${s};
      }
    `,topVerticalAlign:(0,n.css)`
      label: topVerticalAlign;
      margin-top: -${m.spacing(.9)};
      margin-left: -${m.spacing(.25)};
    `,detailsOpen:(0,n.css)`
      &:hover {
        background-color: ${f.hoverColor(m.colors.background.primary,m)};
      }
    `,errorLogRow:(0,n.css)`
      label: erroredLogRow;
      color: ${m.colors.text.secondary};
    `,positionRelative:(0,n.css)`
      label: positionRelative;
      position: relative;
    `,rowWithContext:(0,n.css)`
      label: rowWithContext;
      z-index: 1;
      outline: 9999px solid ${h};
      display: inherit;
    `,horizontalScroll:(0,n.css)`
      label: horizontalScroll;
      white-space: pre;
    `,contextNewline:(0,n.css)`
      display: block;
      margin-left: 0px;
    `,rowMenu:(0,n.css)`
      label: rowMenu;
      display: flex;
      flex-wrap: nowrap;
      flex-direction: row;
      align-content: flex-end;
      justify-content: space-evenly;
      align-items: center;
      position: absolute;
      top: 0;
      bottom: auto;
      background: ${m.colors.background.primary};
      box-shadow: ${m.shadows.z3};
      padding: ${m.spacing(.5,1,.5,1)};
      z-index: 100;
      gap: ${m.spacing(.5)};

      & > button {
        margin: 0;
      }
    `,logRowMenuCell:(0,n.css)`
      position: sticky;
      z-index: ${m.zIndex.dropdown};
      margin-top: -${m.spacing(.125)};
      right: 0px;

      & > span {
        transform: translateX(-100%);
      }
    `,logLine:(0,n.css)`
      background-color: transparent;
      border: none;
      diplay: inline;
      font-family: ${m.typography.fontFamilyMonospace};
      font-size: ${m.typography.bodySmall.fontSize};
      letter-spacing: ${m.typography.bodySmall.letterSpacing};
      text-align: left;
      padding: 0;
      user-select: text;
    `,logsRowLevelDetails:(0,n.css)`
      label: logs-row__level_details;
      &::after {
        top: -3px;
      }
    `,logDetails:(0,n.css)`
      label: logDetailsDefaultCursor;
      cursor: default;

      &:hover {
        background-color: ${m.colors.background.primary};
      }
    `,visibleRowMenu:(0,n.css)`
      label: visibleRowMenu;
      aspect-ratio: 1/1;
      z-index: 90;
    `,linkButton:(0,n.css)`
      label: linkButton;
      > button {
        padding-top: ${m.spacing(.5)};
      }
    `,hidden:(0,n.css)`
      label: hidden;
      visibility: hidden;
    `,unPinButton:(0,n.css)`
      height: ${m.spacing(3)};
      line-height: ${m.spacing(2.5)};
    `}})},81166:(Q,I,e)=>{"use strict";e.d(I,{V:()=>N});var n=e(32196),a=e(2543),o=e(96540),r=e(16817),i=e(39070),f=e(52622),d=e(9557),l=e(47232),m=e(14110),s=e(32264),h=e(40845),u=e(37390),b=e(55852),g=e(33390),P=e(97186),c=e(29436),y=e(31678),p=e(69147),v=e(91002),D=e(81073),E=e(14647),S=e(15292);function T(F){return{buttons:(0,n.css)({display:"flex",gap:F.spacing(1)})}}const M=F=>{const K=(0,h.of)(T),{wrapLines:B,onChangeWrapLines:w,onScrollCenterClick:U}=F,W=(0,o.useCallback)(V=>{const _=V.currentTarget.checked;(0,m.rR)("grafana_explore_logs_log_context_toggle_lines_clicked",{state:_}),w(_)},[w]);return o.createElement("div",{className:K.buttons},o.createElement(S.K,{showLabel:!0,value:B,onChange:W,label:"Wrap lines"}),o.createElement(b.$n,{variant:"secondary",onClick:U},"Center matched line"))},A=F=>({modal:(0,n.css)`
      width: 85vw;
      ${F.breakpoints.down("md")} {
        width: 100%;
      }
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    `,sticky:(0,n.css)`
      position: sticky;
      z-index: 1;
      top: -1px;
      bottom: -1px;
    `,entry:(0,n.css)`
      & > td {
        padding: ${F.spacing(1)} 0 ${F.spacing(1)} 0;
      }
      background: ${F.colors.emphasize(F.colors.background.secondary)};

      & > table {
        margin-bottom: 0;
      }

      & .log-row-menu {
        margin-top: -6px;
      }
    `,datasourceUi:(0,n.css)`
      padding-bottom: ${F.spacing(1.25)};
      display: flex;
      align-items: center;
    `,logRowGroups:(0,n.css)`
      overflow: auto;
      max-height: 75%;
      align-self: stretch;
      display: inline-block;
      border: 1px solid ${F.colors.border.weak};
      border-radius: ${F.shape.radius.default};
      & > table {
        min-width: 100%;
      }
    `,flexColumn:(0,n.css)`
      display: flex;
      flex-direction: column;
      padding: 0 ${F.spacing(3)} ${F.spacing(3)} ${F.spacing(3)};
    `,flexRow:(0,n.css)`
      display: flex;
      flex-direction: row;
      align-items: center;
      & > div:last-child {
        margin-left: auto;
      }
    `,noMarginBottom:(0,n.css)`
      & > table {
        margin-bottom: 0;
      }
    `,hidden:(0,n.css)`
      display: none;
    `,paddingTop:(0,n.css)`
      padding-top: ${F.spacing(1)};
    `,paddingBottom:(0,n.css)`
      padding-bottom: ${F.spacing(1)};
    `,link:(0,n.css)`
      color: ${F.colors.text.secondary};
      font-size: ${F.typography.bodySmall.fontSize};
      :hover {
        color: ${F.colors.text.link};
      }
    `,loadingCell:(0,n.css)`
      position: sticky;
      left: 50%;
      display: inline-block;
      transform: translateX(-50%);
    `}),x=()=>({above:{loadingState:i.Gu.NotStarted,rows:[]},below:{loadingState:i.Gu.NotStarted,rows:[]}}),C=(F,K)=>F==="above"&&K===f.uH.Descending||F==="below"&&K===f.uH.Ascending?d.ZF.Forward:d.ZF.Backward,O=(F,K)=>({...F,dataFrame:{...F.dataFrame,refId:`context_${K.above}_${K.below}`}}),R=(F,K)=>F.some(B=>B.entry===K.entry&&B.timeEpochNs===K.timeEpochNs),L=100,N=({row:F,open:K,logsSortOrder:B,timeZone:w,getLogRowContextUi:U,getRowContextQuery:W,onClose:V,getRowContext:_})=>{const H=(0,o.useRef)(null),G=(0,o.useRef)(null),j=(0,o.useRef)(null),Y=(0,o.useRef)(null),oe=(0,o.useRef)(null),se=(0,o.useRef)(null),ne=(0,o.useRef)(null),ee=(0,o.useRef)({above:0,below:0}),Z=(0,y.useDispatch)(),z=(0,h.$j)(),q=A(z),[ie,de]=(0,o.useState)(!0),[ue,fe]=(0,o.useState)(x()),Se=(ct,ft)=>{fe(Le=>{const re={...Le};return re[ct]=ft(Le[ct]),re})},he=(0,o.useRef)(1),[ce,me]=(0,o.useState)(null),[pe,ye]=(0,o.useState)(g.A.getBool(P.$.logContextWrapLogMessage,g.A.getBool(P.$.wrapLogMessage,!0))),Pe=(0,o.useCallback)(()=>{const{below:ct,above:ft}=ue,Le=(0,v.oR)([...ct.rows,F,...ft.rows],f.uH.Ascending),re=Le[0].timeEpochMs;let X=Le[Le.length-1].timeEpochMs;re===X&&(X+=1);const le=(0,l.KQ)(re),be=(0,l.KQ)(X);return{from:le,to:be,raw:{from:le,to:be}}},[ue,F]),Ie=(0,o.useCallback)(async()=>{const ct=W?await W(F):null;me(ct)},[F,W]),Oe=async()=>{await Ie(),fe(x()),ee.current={above:0,below:0},he.current+=1},Ne=async(ct,ft)=>{ee.current[ct]+=1;const Le=ft.at(ct==="above"?0:-1);if(Le==null)throw new Error("should never happen. the array always contains at least 1 item (the middle row)");(0,m.rR)("grafana_explore_logs_log_context_load_more_called",{datasourceType:Le.datasourceType,above:ee.current.above,below:ee.current.below});const re=C(ct,B),X=await _(O(Le,ee.current),{limit:L,direction:re}),le=(0,p.HT)(X.data).rows;return B===f.uH.Ascending&&le.reverse(),le.filter(De=>!R(ft,De))};(0,o.useEffect)(()=>{K&&Ie()},[Ie,K]);const[We,Ae]=(0,o.useState)([]),Ue=ct=>{We.indexOf(ct)===-1&&Ae([...We,ct])},Me=ct=>{const ft=We.indexOf(ct);ft>-1&&(We.splice(ft,1),Ae([...We]))},$e=async ct=>{const{below:ft,above:Le}=ue;if(ue[ct].loadingState===i.Gu.Loading)return;Se(ct,le=>({...le,loadingState:i.Gu.Loading}));const X=he.current;try{const le=[...Le.rows,F,...ft.rows],be=(await Ne(ct,le)).map(Ve=>!Ve.searchWords||!Ve.searchWords?.length?{...Ve,searchWords:F.searchWords}:Ve),[De,Te]=(0,a.partition)(be,Ve=>Ve.timeEpochNs>F.timeEpochNs),we=B===f.uH.Ascending?Te:De,Ke=B===f.uH.Ascending?De:Te;X===he.current&&fe(Ve=>{const ht=we.length>0?(0,v.oR)([...we,...Ve.above.rows],B):Ve.above.rows,gt=Ke.length>0?(0,v.oR)([...Ve.below.rows,...Ke],B):Ve.below.rows;return{above:{rows:ht,loadingState:ct==="above"?be.length===0?i.Gu.Done:i.Gu.NotStarted:Ve.above.loadingState},below:{rows:gt,loadingState:ct==="below"?be.length===0?i.Gu.Done:i.Gu.NotStarted:Ve.below.loadingState}}})}catch{Se(ct,le=>({rows:le.rows,loadingState:i.Gu.Error}))}},ke=async(ct,ft)=>{for(const Le of ct){if(!Le.isIntersecting)continue;const re=Le.target;re===se.current?$e("above"):re===ne.current&&$e("below")}};(0,o.useEffect)(()=>{const ct=H.current,ft=se.current,Le=ne.current;if(ct==null)return;const re=new IntersectionObserver(ke,{root:ct});return ft!=null&&re.observe(ft),Le!=null&&re.observe(Le),()=>{re.disconnect()}});const Ze=(0,o.useCallback)(()=>{j.current?.scrollIntoView({block:"center"}),G.current?.scrollIntoView({block:"center"})},[j,G]);(0,o.useLayoutEffect)(()=>{const ct=H.current;if(ct==null)return;const ft=oe.current,Le=ct.clientHeight;if(oe.current=Le,ft!==Le){Ze();return}if(ee.current.above<=1&&ee.current.below<=1){Ze();return}const re=Y.current,X=ct.scrollHeight;if(Y.current=X,re!=null){const le=ct.scrollTop+(X-re);ct.scrollTop=le}},[ue.above.rows,Ze]),(0,r.A)(Ie,[W,F]);const ot=ue.above.loadingState,xt=ue.below.loadingState;return o.createElement(u.a,{isOpen:K,title:"Log context",contentClassName:q.flexColumn,className:q.modal,onDismiss:V},s.$.featureToggles.logsContextDatasourceUi&&U&&o.createElement("div",{className:q.datasourceUi},U(F,Oe)),o.createElement("div",{className:(0,n.cx)(q.flexRow,q.paddingBottom)},o.createElement("div",null,o.createElement(M,{wrapLines:pe,onChangeWrapLines:ye,onScrollCenterClick:Ze}))),o.createElement("div",{ref:H,className:q.logRowGroups},o.createElement("table",null,o.createElement("tbody",null,o.createElement("tr",null,o.createElement("td",{className:q.loadingCell},ot!==i.Gu.Done&&ot!==i.Gu.Error&&o.createElement("div",{ref:se},o.createElement(D.I,{adjective:"newer"})),ot===i.Gu.Error&&o.createElement("div",null,"Error loading log more logs."),ot===i.Gu.Done&&o.createElement("div",null,"No more logs available."))),o.createElement("tr",null,o.createElement("td",{className:q.noMarginBottom},o.createElement(E.k,{logRows:ue.above.rows,dedupStrategy:f.fY.none,showLabels:g.A.getBool(P.$.showLabels,!1),showTime:g.A.getBool(P.$.showTime,!0),wrapLogMessage:pe,prettifyLogMessage:g.A.getBool(P.$.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:w,displayedFields:We,onClickShowField:Ue,onClickHideField:Me}))),o.createElement("tr",{ref:j}),o.createElement("tr",{ref:G,className:(0,n.cx)(q.entry,ie?q.sticky:null),"data-testid":"entry-row"},o.createElement("td",{className:q.noMarginBottom},o.createElement(E.k,{logRows:[F],dedupStrategy:f.fY.none,showLabels:g.A.getBool(P.$.showLabels,!1),showTime:g.A.getBool(P.$.showTime,!0),wrapLogMessage:pe,prettifyLogMessage:g.A.getBool(P.$.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:w,displayedFields:We,onClickShowField:Ue,onClickHideField:Me,onUnpinLine:()=>de(!1),onPinLine:()=>de(!0),pinnedRowId:ie?F.uid:void 0,overflowingContent:!0}))),o.createElement("tr",null,o.createElement("td",null,o.createElement(o.Fragment,null,o.createElement(E.k,{logRows:ue.below.rows,dedupStrategy:f.fY.none,showLabels:g.A.getBool(P.$.showLabels,!1),showTime:g.A.getBool(P.$.showTime,!0),wrapLogMessage:pe,prettifyLogMessage:g.A.getBool(P.$.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:w,displayedFields:We,onClickShowField:Ue,onClickHideField:Me})))),o.createElement("tr",null,o.createElement("td",{className:q.loadingCell},xt!==i.Gu.Done&&xt!==i.Gu.Error&&o.createElement("div",{ref:ne},o.createElement(D.I,{adjective:"older"})),xt===i.Gu.Error&&o.createElement("div",null,"Error loading log more logs."),xt===i.Gu.Done&&o.createElement("div",null,"No more logs available.")))))),o.createElement(u.a.ButtonRow,null,ce?.datasource?.uid&&o.createElement(b.$n,{variant:"secondary",onClick:async()=>{let ct=F.uid;F.dataFrame.refId&&(ct=F.uid.replace(F.dataFrame.refId,ce.refId)),Z((0,c.ve)({queries:[ce],range:Pe(),datasourceUid:ce.datasource.uid,panelsState:{logs:{id:ct}}})),V(),(0,m.rR)("grafana_explore_logs_log_context_open_split_view_clicked",{datasourceType:F.datasourceType,logRowUid:F.uid})}},"Open in split view")))}},70377:(Q,I,e)=>{"use strict";e.d(I,{FE:()=>d,jE:()=>i,qE:()=>f});var n=e(2543),a=e.n(n),o=e(87490),r=e(98101);const i=(h,u)=>d(h,u),f=h=>{let u=[];return h.forEach(b=>{b.links?.forEach(g=>{if(g.variables){const P=g.variables.map(y=>{const p=y.variableName,v=y.fieldPath?`.${y.fieldPath}`:"";return`${p}${v}`}),c=g.variables.map(y=>y.found?y.value:"");u.push({keys:P,values:c,links:[g],fieldIndex:b.fieldIndex})}})}),u},d=(h,u)=>s(h).map(g=>{const P=u?u(g,h.rowIndex,h.dataFrame):[],c=g.values[h.rowIndex],y=typeof c=="string"||typeof c=="number"?c.toString():(0,o.MA)(c);return{keys:[g.name],values:[y],links:P,fieldIndex:g.index}});function l(h,u){const b=(0,r.O)(h);if(b===null)return new Set;const g=new Set(b.extraFields.map(P=>P.index));return b.severityField!==null&&g.add(b.severityField.index),u.keepBody&&g.add(b.bodyField.index),u.keepTimestamp&&g.add(b.timeField.index),g}function m(h,u){const b=h.fields.map((y,p)=>({...y,index:p})),g=l(h,u??{}),[P,c]=partition(b,y=>y.config.custom?.hidden?!1:(y.config.links??[]).length>0?!0:g.has(y.index));return{visible:P,hidden:c}}function s(h,u){const b=h.dataFrame,g=l(b,u??{}),P=[];for(let c=0;c<b.fields.length;c++){const y=b.fields[c];y.values[h.rowIndex]!=null&&(y.config.custom?.hidden||(y.config.links&&y.config.links.length>0||g.has(c))&&P.push({...y,index:c}))}return P}},98101:(Q,I,e)=>{"use strict";e.d(I,{n:()=>b,O:()=>P});var n=e(85404),a=e(11261),o=e(41260);function r(c,y){const p=c.labels;if(p!==void 0){const v=new Array(y);return v.fill(p),v}else return null}function i(c,y,p){const v=c.getFieldByName("labels");if(v!==void 0&&v.type===a.PU.other){const D=v.values.map(b);return[v,()=>D]}else return[null,()=>r(y,p.length)]}function f(c){const y=new n.L(c),p=y.getFirstFieldOfType(a.PU.time),v=y.getFirstFieldOfType(a.PU.string);if(p===void 0||v===void 0)return null;const D=y.getFieldByName("tsNs")??null,E=y.getFieldByName("level")??null,S=y.getFieldByName("id")??null,[T,M]=i(y,v,c),A=y.fields.filter((x,C)=>C!==p.index&&C!==v.index&&C!==D?.index&&C!==E?.index&&C!==S?.index&&C!==T?.index);return{timeField:p,bodyField:v,timeNanosecondField:D,severityField:E,idField:S,getLogFrameLabels:M,getLogFrameLabelsAsLabels:M,getLabelFieldName:()=>T?.name??null,extraFields:A}}function d(c,y,p){const v=c.getFieldByName(y);if(v!==void 0)return v.type===p?v:void 0}const l="timestamp",m="body",s="severity",h="id",u="labels";function b(c){const y={};return Object.entries(c).forEach(([p,v])=>{y[p]=typeof v=="string"?v:JSON.stringify(v)}),y}function g(c){const y=new n.L(c),p=d(y,l,a.PU.time),v=d(y,m,a.PU.string);if(p===void 0||v===void 0)return null;const D=d(y,s,a.PU.string)??null,E=d(y,h,a.PU.string)??null,S=d(y,u,a.PU.other)??null,T=S===null?null:S.values,M=y.fields.filter((A,x)=>x!==p.index&&x!==v.index&&x!==D?.index&&x!==E?.index&&x!==S?.index);return{timeField:p,bodyField:v,severityField:D,idField:E,getLogFrameLabels:()=>T,timeNanosecondField:null,getLogFrameLabelsAsLabels:()=>T!==null?T.map(b):null,getLabelFieldName:()=>S!==null?S.name:null,extraFields:M}}function P(c){return c.meta?.type===o.m.LogLines?g(c):f(c)}},69147:(Q,I,e)=>{"use strict";e.d(I,{yR:()=>x,cZ:()=>C,HT:()=>_,M0:()=>w,ct:()=>U,f8:()=>de,J9:()=>W,Wr:()=>q,sg:()=>z});var n=e(2543),a=e(88483),o=e(50832),r=e(65474),i=e(9557),f=e(52622),d=e(14236),l=e(85404),m=e(11261),s=e(24293),h=e(47232),u=e(8249),b=e(40672),g=e(72724),P=e(65879),c=e(39070),y=e(26517),p=e(32264),v=e(24284),D=e(88838),E=e(2913);function S(ue,fe){return E.Ay.bootData?.user?.lightTheme?fe:ue}var T=e(98101),M=e(91002);const A="Line limit",x="Common labels",C={[i.$b.critical]:v.Tj[7],[i.$b.error]:v.Tj[4],[i.$b.warning]:v.Tj[1],[i.$b.info]:v.Tj[0],[i.$b.debug]:v.Tj[5],[i.$b.trace]:v.Tj[2],[i.$b.unknown]:S("#8e8e8e","#bdc4cd")},O=1,R=1e3*O,L=60*R,N=60*L,F=24*N,K=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-6]\d[,\.]\d+([+-][0-2]\d:[0-5]\d|Z)/g;function B(ue,fe,Se){switch(Se){case f.fY.exact:return ue.entry.replace(K,"")===fe.entry.replace(K,"");case f.fY.numbers:return ue.entry.replace(/\d/g,"")===fe.entry.replace(/\d/g,"");case f.fY.signature:return ue.entry.replace(/\w/g,"")===fe.entry.replace(/\w/g,"");default:return!1}}function w(ue,fe){return fe===f.fY.none?ue:ue.reduce((Se,he,ce)=>{const me={...he},pe=Se[Se.length-1];return ce>0&&B(he,pe,fe)?pe.duplicates++:(me.duplicates=0,Se.push(me)),Se},[])}function U(ue,fe){return fe.size===0?ue:ue.filter(Se=>!fe.has(Se.logLevel))}function W(ue,fe){const Se={},he=[];for(const ce of ue){let me=Se[ce.logLevel];me||(Se[ce.logLevel]=me={lastTs:null,datapoints:[],target:ce.logLevel,color:C[ce.logLevel]},he.push(me));const pe=Math.floor(ce.timeEpochMs/fe)*fe;pe===me.lastTs?me.datapoints[me.datapoints.length-1][0]++:(me.datapoints.push([1,pe]),me.lastTs=pe);for(const ye of he)ye!==me&&ye.lastTs!==pe&&(ye.datapoints.push([0,pe]),ye.lastTs=pe)}return he.map((ce,me)=>{ce.datapoints.sort((Ie,Oe)=>Ie[1]-Oe[1]);const pe=(0,d.Vc)(ce),Pe=new l.L(pe).getFirstFieldOfType(m.PU.number);return pe.fields[Pe.index].config.min=0,pe.fields[Pe.index].config.decimals=0,pe.fields[Pe.index].config.color={mode:s.Y.Fixed,fixedColor:ce.color},pe.fields[Pe.index].config.custom={drawStyle:f.GR.Bars,barAlignment:f.Nj.Center,barWidthFactor:.9,barMaxWidth:5,lineColor:ce.color,pointColor:ce.color,fillColor:ce.color,lineWidth:0,fillOpacity:100,stacking:{mode:f.gs.Normal,group:"A"}},pe})}function V(ue){return ue.fields.some(fe=>fe.type===m.PU.time)&&ue.fields.some(fe=>fe.type===m.PU.string)}function _(ue,fe,Se,he,ce){const{logSeries:me}=G(ue),pe=Y(me,he,!!ce);if(pe){if(fe&&pe.rows.length>0){const ye=pe.rows.sort(M.M1),{visibleRange:Pe,bucketSize:Ie,visibleRangeMs:Oe,requestedRangeMs:Ne}=H(ye,fe,Se);pe.visibleRange=Pe,pe.bucketSize=Ie,pe.series=W(ye,Ie),pe.meta&&(pe.meta=oe(pe,Oe,Ne))}else pe.series=[];return pe.queries=he,pe}return{hasUniqueLabels:!1,rows:[],meta:[],series:[],queries:he}}function H(ue,fe,Se,he=20,ce=1e3){let me=Se,pe=fe,ye=Math.max(pe*he,ce),Pe,Ie;if(Se){const Oe=ue[0].timeEpochMs;if(Ie=Se.to-Se.from,Pe=Se.to-Oe,Pe>0){const Ne=Pe/Ie;pe*=Ne,ye=Math.max(Math.ceil(pe*he),ce),me={from:Math.floor(Oe/ye)*ye,to:Se.to}}else Pe=1}return{bucketSize:ye,visibleRange:me,visibleRangeMs:Pe,requestedRangeMs:Ie}}function G(ue){const fe=[],Se=[];for(const he of ue){if(V(he)||!he.fields.length){Se.push(he);continue}he.length>0&&fe.push(he)}return{logSeries:Se,metricSeries:fe}}function j(ue,fe,Se){const he=ue.values[Se],me=(0,h.yT)(he).valueOf();if(fe)return{ts:he,timeEpochMs:me,timeEpochNs:fe.values[Se]};if(ue.nanos!==void 0){const pe=ue.nanos[Se].toString().padStart(6,"0"),ye=`${me}${pe}`;return{ts:he,timeEpochMs:me,timeEpochNs:ye}}return{ts:he,timeEpochMs:me,timeEpochNs:me+"000000"}}function Y(ue,fe=[],Se=!1){if(ue.length===0)return;const he=[];let ce=[];const me=ue.filter(Ze=>Ze.fields.length);me.length&&me.forEach(Ze=>{const ot=(0,T.O)(Ze);if(ot!=null){const xt=ot.getLogFrameLabelsAsLabels()??void 0,ct={rawFrame:Ze,logsFrame:ot,frameLabels:xt};ce.push(ct),xt&&xt.length>0&&he.push(xt)}});const pe=he.flat(),ye=pe.length>0?(0,u.yO)(pe):{};let Pe=[],Ie=!1;const Oe=(0,M.kA)();for(const Ze of ce){const{logsFrame:ot,rawFrame:xt,frameLabels:ct}=Ze,{timeField:ft,timeNanosecondField:Le,bodyField:re,severityField:X,idField:le}=ot;for(let be=0;be<xt.length;be++){const{ts:De,timeEpochMs:Te,timeEpochNs:we}=j(ft,Le??void 0,be),Ke=re.values[be]??"",Ve=typeof Ke=="string"?Ke:JSON.stringify(Ke),ht=b.sQ.hasAnsiCodes(Ve),gt=!!Ve.match(/\\n|\\t|\\r/),bt=xt.meta?.custom?.searchWords??xt.meta?.searchWords??[],St=ht?D.DB.strip(Ve):Ve,Je=ct?.[be],rt=(0,u.s6)(Je,ye);Object.keys(rt).length>0&&(Ie=!0);let Rt=i.$b.unknown;const _t=X&&X.values[be]||Je&&Je.level;typeof _t=="number"||typeof _t=="string"?Rt=(0,M.EK)(_t):Rt=(0,M.XM)(St);const nn=fe.find(en=>en.refId===xt.refId)?.datasource?.type,Kt={entryFieldIndex:re.index,rowIndex:be,dataFrame:xt,logLevel:Rt,timeFromNow:(0,g.fq)(De),timeEpochMs:Te,timeEpochNs:we,timeLocal:(0,g.LE)(De,{timeZone:"browser"}),timeUtc:(0,g.LE)(De,{timeZone:"utc"}),uniqueLabels:rt,hasAnsi:ht,hasUnescapedContent:gt,searchWords:bt,entry:St,raw:Ve,labels:Je||{},uid:`${xt.refId}_${le?le.values[be]:be.toString()}`,datasourceType:nn};le!==null&&(Kt.rowId=le.values[be]),!(Se&&Oe(Kt))&&Pe.push(Kt)}}const Ne=[];(0,n.size)(ye)>0&&Ne.push({label:x,value:ye,kind:i.tG.LabelsMap});const Ae=ue.filter(Ze=>Ze?.meta?.custom?.limit??Ze?.meta?.limit).reduce((Ze,ot)=>(Ze[ot.refId??""]=ot.meta?.custom?.limit??ot.meta?.limit??0,Ze),{}),Ue=Object.values(Ae).reduce((Ze,ot)=>Ze+=ot,0);Ue>0&&Ne.push({label:A,value:Ue,kind:i.tG.Number});let Me=0;const $e={};let ke=!1;for(const Ze of ue){const ot=Ze.meta?.custom?.lokiQueryStatKey,{refId:xt}=Ze;if(!ke&&Ze.meta?.custom?.error&&(Ne.push({label:"",value:Ze.meta?.custom.error,kind:i.tG.Error}),ke=!0),xt&&!$e[xt]){if(ot&&Ze.meta?.stats){const ct=Ze.meta.stats.find(ft=>ft.displayName===ot);ct&&(Me+=ct.value)}$e[xt]=!0}}if(Me>0){const{text:Ze,suffix:ot}=(0,y.rT)("B")(Me);Ne.push({label:"Total bytes processed",value:`${Ze} ${ot}`,kind:i.tG.String})}return{hasUniqueLabels:Ie,meta:Ne,rows:Pe}}function oe(ue,fe,Se){if(!ue.meta)return[];let he=[...ue.meta];const ce=he.findIndex(pe=>pe.label===A),me=ce>=0&&he[ce]?.value;if(me&&typeof me=="number"&&me>0){let pe;if(me===ue.rows.length&&fe&&Se){const ye=(fe/Se*100).toFixed(2);pe=`${me} reached, received logs cover ${ye}% (${P.msRangeToTimeString(fe)}) of your selected time range (${P.msRangeToTimeString(Se)})`}else{const ye=p.$.featureToggles.logsInfiniteScrolling?"displayed":"returned";pe=`${me} (${ue.rows.length} ${ye})`}he[ce]={label:A,value:pe,kind:i.tG.String}}return he}function se(ue,fe){const Se=fe&&ue===i.$b.unknown?"logs":ue,he=C[ue];return{displayNameFromDS:Se,color:{mode:s.Y.Fixed,fixedColor:he},custom:{drawStyle:f.GR.Bars,barAlignment:f.Nj.Center,lineColor:he,pointColor:he,fillColor:he,lineWidth:1,fillOpacity:100,stacking:{mode:f.gs.Normal,group:"A"}}}}const ne=(ue,fe,Se)=>(ue.fields=ue.fields.map(he=>(he.type===m.PU.number&&(he.config={...he.config,...se(fe(ue),Se)}),he)),ue);function ee(ue){let fe;try{fe=new l.L(ue).getFirstFieldOfType(m.PU.number)}catch{}return fe?.labels?Z(fe.labels):i.$b.unknown}function Z(ue){const fe=ue.level??ue.lvl??ue.loglevel??"";return fe?(0,M.EK)(fe):i.$b.unknown}function z(ue,fe,Se){const he=fe.range,ce=Se.targets,me=ee,pe=he.to.valueOf()-he.from.valueOf(),ye=ie(fe.scopedVars,pe);return fe.interval=ye.interval,fe.scopedVars.__interval={value:ye.interval,text:ye.interval},ye.intervalMs!==void 0&&(fe.intervalMs=ye.intervalMs,fe.scopedVars.__interval_ms={value:ye.intervalMs,text:ye.intervalMs}),fe.hideFromInspector=!0,new a.c(Pe=>{let Ie=[];Pe.next({state:c.Gu.Loading,error:void 0,data:[]});const Oe=ue.query(fe),We=((0,o.A)(Oe)?Oe:(0,r.H)(Oe)).subscribe({complete:()=>{Pe.complete()},next:Ae=>{const{error:Ue}=Ae;if(Ue!==void 0)Pe.next({state:c.Gu.Error,error:Ue,data:[]}),Pe.error(Ue);else{const Me=(0,n.groupBy)(Ae.data,"refId");Ie=Ae.data.map($e=>{if($e.meta?.dataTopic===f.QR.Annotations)return $e;let ke=$e.refId||"";ke.startsWith("log-volume-")&&(ke=ke.substr(11));const Ze={logsVolumeType:i.Aj.FullRange,absoluteRange:{from:he.from.valueOf(),to:he.to.valueOf()},datasourceName:ue.name,sourceQuery:ce.find(ot=>ot.refId===ke)};return $e.meta={...$e.meta,custom:{...$e.meta?.custom,...Ze}},ne($e,me,Me[$e.refId].length===1)}),Pe.next({state:Ae.state,error:void 0,data:Ie})}},error:Ae=>{Pe.next({state:c.Gu.Error,error:Ae,data:[]}),Pe.error(Ae)}});return()=>{We?.unsubscribe()}})}function q(ue,fe){return fe.hideFromInspector=!0,new a.c(Se=>{let he=[];Se.next({state:c.Gu.Loading,error:void 0,data:[]});const ce=ue.query(fe),pe=((0,o.A)(ce)?ce:(0,r.H)(ce)).subscribe({complete:()=>{Se.next({state:c.Gu.Done,error:void 0,data:he}),Se.complete()},next:ye=>{const{error:Pe}=ye;Pe!==void 0?(Se.next({state:c.Gu.Error,error:Pe,data:[]}),Se.error(Pe)):he=ye.data.map(Ie=>{const Oe=(0,d.Vc)(Ie),{timeIndex:Ne}=(0,d.KR)(Oe);return(0,d.ES)(Oe,Ne)})},error:ye=>{Se.next({state:c.Gu.Error,error:ye,data:[]}),Se.error(ye)}});return()=>{pe?.unsubscribe()}})}function ie(ue,fe){if(ue.__interval_ms){let Se=ue.__interval_ms.value,he="";return fe<R*5?(Se=O,he="1ms"):Se>N?(Se=F,he="1d"):Se>L?(Se=N,he="1h"):Se>R?(Se=L,he="1m"):(Se=R,he="1s"),{interval:he,intervalMs:Se}}else return{interval:"$__interval"}}function de(ue){const fe=ue.dataFrame;return fe.length===0||fe.length<=ue.rowIndex?null:(0,d.EI)({fields:fe.fields.map(he=>({...he,values:[he.values[ue.rowIndex]]})),refId:fe.refId})}},91002:(Q,I,e)=>{"use strict";e.d(I,{Dg:()=>D,Dk:()=>A,Dm:()=>T,Dx:()=>E,EK:()=>s,Ei:()=>p,Hw:()=>v,M1:()=>g,Tj:()=>h,XM:()=>m,a8:()=>C,e3:()=>M,kA:()=>O,oR:()=>y,oT:()=>S,s2:()=>u,tX:()=>x,zy:()=>c});var n=e(2543),a=e.n(n),o=e(9557),r=e(52622),i=e(37471),f=e(11261),d=e(85404),l=e(70377);function m(R){if(!R)return o.$b.unknown;let L=o.$b.unknown,N;for(const[F,K]of Object.entries(o.$b)){const w=new RegExp(`\\b${F}\\b`,"i").exec(R);w&&(N===void 0||w.index<N)&&(L=K,N=w.index)}return L}function s(R){const L=o.$b[R.toString().toLowerCase()];if(L)return L;if(typeof R=="string"){const N=parseInt(R,10);if(R.length===N.toString().length)return o.s5[R]||o.$b.unknown}else if(typeof R=="number")return o.s5[R]||o.$b.unknown;return o.$b.unknown}function h(R,L){const N=R.filter(B=>B.labels[L]!==void 0),F=N.length,K=(0,n.countBy)(N,B=>B.labels[L]);return b(K,F)}function u(R){const L=R.filter(F=>F!=null),N=(0,n.countBy)(L);return b(N,L.length)}const b=(R,L)=>(0,n.chain)(R).map((N,F)=>({count:N,value:F,proportion:N/L})).sortBy("count").reverse().value(),g=(R,L)=>R.timeEpochMs<L.timeEpochMs?-1:R.timeEpochMs>L.timeEpochMs?1:R.timeEpochNs<L.timeEpochNs?-1:R.timeEpochNs>L.timeEpochNs?1:0,P=(R,L)=>R.timeEpochMs>L.timeEpochMs?-1:R.timeEpochMs<L.timeEpochMs?1:R.timeEpochNs>L.timeEpochNs?-1:R.timeEpochNs<L.timeEpochNs?1:0,c=(R,L)=>{const N=R?y(R.rows,L):[];return R?{...R,rows:N}:{hasUniqueLabels:!1,rows:N}},y=(R,L)=>L===r.uH.Ascending?R.sort(g):R.sort(P),p=R=>R.labels.__error__?{hasError:!0,errorMessage:R.labels.__error__}:{hasError:!1},v=R=>R.replace(/\\r\\n|\\n|\\t|\\r/g,L=>L.slice(1)==="t"?"	":`
`);function D(R){return R.map(L=>{const N=(0,l.FE)(L).reduce((F,K)=>{const B=K.keys[0];return F[B]=K.values[0],F},{});return{line:L.entry,timestamp:L.timeEpochNs,fields:{...N,...L.labels}}})}const E=R=>{let L={from:1/0,to:-1/0};return R.forEach(N=>{const F=N.meta?.custom||{};F.absoluteRange?.from&&F.absoluteRange?.to&&(L={from:Math.min(L.from,F.absoluteRange.from),to:Math.max(L.to,F.absoluteRange.to)})}),L},S=R=>{if(R.length===0)throw new Error("Cannot aggregate data frames: there must be at least one data frame to aggregate");const L={},N={};let F=-1/0;const K={};let B=[];return R.forEach(w=>{const{level:U,valueField:W,timeField:V,length:_}=x(w);K[U]={meta:w.meta,valueFieldConfig:W.config,timeFieldConfig:V.config};for(let H=0;H<_;H++){const G=V.values[H],j=W.values[H];L[U]??={},L[U][G]=(L[U][G]||0)+j,N[G]=(N[G]||0)+j,F=Math.max(N[G],F)}}),Object.keys(L).forEach(w=>{const U=new i.k,{meta:W,timeFieldConfig:V,valueFieldConfig:_}=K[w];U.name=w,U.meta=W,U.addField({name:"Time",type:f.PU.time,config:V}),U.addField({name:"Value",type:f.PU.number,config:_}),Object.entries(L[w]).sort((H,G)=>Number(H[0])-Number(G[0])).forEach(([H,G])=>{U.add({Time:Number(H),Value:G})}),B.push(U)}),{dataFrames:B,maximum:F}},T=R=>{const L=R[0]?.meta?.custom;return L&&L.datasourceName?{name:L.datasourceName}:null},M=R=>R[0]?.meta?.custom?.logsVolumeType===o.Aj.Limited,A=async(R,L)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(R);{const N=document.createElement("textarea");L.current?.appendChild(N),N.value=R,N.focus(),N.select(),document.execCommand("copy"),N.remove()}};function x(R){const L=new d.L(R),N=L.getFirstFieldOfType(f.PU.time),F=L.getFirstFieldOfType(f.PU.number);if(!N)throw new Error("Missing time field");if(!F)throw new Error("Missing value field");const K=F.config.displayNameFromDS||R.name||"logs",B=F.values.length;return{level:K,valueField:F,timeField:N,length:B}}function C(R){return R instanceof Element}function O(){const R=new Set;return function(L){let N=`${L.dataFrame.refId}_${L.rowId?L.rowId:`${L.timeEpochNs}_${L.entry}`}`;return R.has(N)?!0:(R.add(N),!1)}}},90591:(Q,I,e)=>{"use strict";e.d(I,{m:()=>d});var n=e(32196),a=e(96540),o=e(40845),r=e(96374),i=e(8484);const f=({title:m})=>{const s=(0,o.of)(l);return a.createElement("p",{className:s.description},m?(0,i.t)("public-dashboard.delete-modal.revoke-nonorphaned-body-text","Are you sure you want to revoke this URL? The dashboard will no longer be public."):(0,i.t)("public-dashboard.delete-modal.revoke-orphaned-body-text","Orphaned public dashboard will no longer be public."))},d=({dashboardTitle:m,onConfirm:s,onDismiss:h})=>{const u=(0,i.t)("public-dashboard.delete-modal.revoke-title","Revoke public URL");return a.createElement(r.u,{isOpen:!0,body:a.createElement(f,{title:m}),onConfirm:s,onDismiss:h,title:u,icon:"trash-alt",confirmText:u})},l=m=>({title:(0,n.css)`
    margin-bottom: ${m.spacing(1)};
  `,description:(0,n.css)`
    font-size: ${m.typography.body.fontSize};
  `})},71500:(Q,I,e)=>{"use strict";e.d(I,{P:()=>r});var n=e(24439);class a extends Error{constructor(f,d){super(d),this.type=f}}class o{constructor(){this.rootName="general"}validateNewDashboardName(f,d){return this.validate(f,d,"A dashboard or a folder with the same name already exists")}validateNewFolderName(f){return this.validate(this.rootName,f,"A folder or dashboard in the general folder with the same name already exists")}async validate(f,d,l){d=(d||"").trim();const m=d.toLowerCase();if(d.length===0)throw new a("REQUIRED","Name is required");if(m===this.rootName)throw new a("EXISTING","This is a reserved name and cannot be used for a folder.");const h=await(0,n.getGrafanaSearcher)().search({kind:["dashboard"],query:d,location:f||"general"});for(const u of h.view)if(m===u.name.toLowerCase())throw new a("EXISTING",l)}}const r=new o},11230:(Q,I,e)=>{"use strict";e.d(I,{A_:()=>B,FG:()=>D,Q9:()=>E,Ql:()=>F,c0:()=>N,iP:()=>u,rw:()=>h,vV:()=>O});var n=e(17172),a=e(19347),o=e(82467),r=e(3169),i=e(55314),f=e(28676),d=e(31678),l=e(57767),m=e(98796),s=e(88264);function h(U){return async W=>{try{W((0,s.f7)());const V=await(0,n.AI)().get(`/api/gnet/dashboards/${U}`);await W(p(V.json)),await W(P(V)),W(y())}catch(V){W((0,s.oQ)()),(0,n.NF)(V)&&W((0,o.dx)((0,r.gi)(V.data.message||V)))}}}function u(U){return async W=>{await W(p(U)),await W(c(U)),W(y())}}const b=(U,W)=>U?.usage?.libraryPanels?.filter(V=>W.inputs.libraryPanels.some(_=>_.state!==s.J7.Exists&&_.model.uid===V.uid));function g(U,W){let V=U.__inputs;if(W.inputs.libraryPanels?.length){const _=[];U.__inputs?.forEach(H=>{if(!H?.usage?.libraryPanels){_.push(H);return}const G=b(H,W);H.usage={libraryPanels:G},!!G?.length&&_.push(H)}),V=_}return{...U,__inputs:V}}function P(U){return(W,V)=>{const _=V().importDashboard,H=g(U.json,_);W((0,s.Rp)({...U,json:H}))}}function c(U){return(W,V)=>{const _=V().importDashboard,H=g(U,_);W((0,s.dd)(H))}}function y(){return(U,W)=>{const V=W().importDashboard.dashboard;if(V&&V.__inputs){const _=[];V.__inputs.forEach(H=>{const G={name:H.name,label:H.label,info:H.description,value:H.value,type:H.type,pluginId:H.pluginId,options:[]};G.description=T(H),H.type===s.NZ.DataSource?S(H,G):G.info||(G.info="Specify a string constant"),_.push(G)}),U((0,s.y3)(_))}}}function p(U){return async function(W){const V=await v(U);W((0,s.dW)(V))}}async function v(U){if(!U||!U.__elements)return[];const W=[];for(const V of Object.values(U.__elements)){if(V.kind!==m.i.Panel)continue;const _=V.model,{type:H,description:G}=_,{uid:j,name:Y}=V,oe={model:{model:_,uid:j,name:Y,version:0,type:H,kind:m.i.Panel,description:G},state:s.J7.New};try{const se=await(0,l.Yr)(j,!0);oe.state=s.J7.Exists,oe.model=se}catch(se){if(se.status!==404)throw se}W.push(oe)}return W}function D(){return U=>{U((0,s.SN)())}}function E(U){return async(W,V)=>{const _=V().importDashboard.dashboard,H=V().importDashboard.inputs,G=[];U.dataSources?.forEach((j,Y)=>{const oe=H.dataSources[Y];G.push({name:oe.name,type:oe.type,pluginId:oe.pluginId,value:j.uid})}),U.constants?.forEach((j,Y)=>{const oe=H.constants[Y];G.push({value:j,name:oe.name,type:oe.type})}),W(i.cU.endpoints.importDashboard.initiate({dashboard:{..._,title:U.title,uid:U.uid||_.uid},overwrite:!0,inputs:G,folderUid:U.folder.uid}))}}const S=(U,W)=>{(0,a.l)().getList({pluginId:U.pluginId}).length===0?W.info="No data sources of type "+U.pluginName+" found":W.info||(W.info="Select a "+U.pluginName+" data source")},T=U=>{if(U.usage&&U.usage.libraryPanels)return`List of affected library panels: ${U.usage.libraryPanels.reduce((V,_,H)=>H===0?_.name:`${V}, ${_.name}`,"")}`};async function M(U,W){const V={totalCount:U.length,successCount:0};for(const _ of U)try{await R(_,W)!==null&&(V.successCount+=1)}catch(H){console.error("Failed to move a folder",H)}return V}function A(U,W,...V){return async _=>{try{const H=await U(...V);return Array.prototype.concat(_,[H])}catch(H){if(W)return _;throw H}}}function x(U,W){const V=[];for(const _ of U)V.push(A(C,!0,_,!0));for(const _ of W)V.push(A(B,!0,_,!0));return w(V)}function C(U,W){return getBackendSrv().delete(`/api/folders/${U}?forceDeleteRules=false`,void 0,{showSuccessAlert:W})}function O(U){return(0,n.AI)().post("/api/folders",U)}function R(U,W){const V={parentUid:W.uid};return getBackendSrv().post(`/api/folders/${U}/move`,V,{showErrorAlert:!1})}const L=1e3;function N(U,W,V=d.SearchQueryType.Folder){return(0,n.AI)().get("/api/search",{query:U,type:V,permission:W,limit:L})}function F(U){return(0,n.AI)().get(`/api/folders/${U}`)}function K(U){return getBackendSrv().get(`/api/folders/id/${U}`)}function B(U,W){return(0,f.n)().deleteDashboard(U,W)}function w(U){return U.reduce((W,V)=>Promise.resolve(W).then(V),[])}},88264:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>c,J7:()=>i,NZ:()=>r,Rp:()=>s,SN:()=>l,V9:()=>f,dW:()=>u,dd:()=>h,f7:()=>g,oQ:()=>b,qx:()=>o,y3:()=>m});var n=e(65307),a=e(39070),o=(y=>(y[y.Gcom=0]="Gcom",y[y.Json=1]="Json",y))(o||{}),r=(y=>(y.DataSource="datasource",y.Constant="constant",y.LibraryPanel="libraryPanel",y))(r||{}),i=(y=>(y.New="new",y.Exists="exists",y.Different="different",y))(i||{});const f={meta:{updatedAt:"",orgName:""},dashboard:{},source:1,inputs:{},state:a.Gu.NotStarted},d=(0,n.Z0)({name:"manageDashboards",initialState:f,reducers:{setGcomDashboard:(y,p)=>{y.dashboard={...p.payload.json,id:null},y.meta={updatedAt:p.payload.updatedAt,orgName:p.payload.orgName},y.source=0,y.state=a.Gu.Done},setJsonDashboard:(y,p)=>{y.dashboard={...p.payload,id:null},y.meta=f.meta,y.source=1,y.state=a.Gu.Done},clearDashboard:y=>{y.dashboard={},y.state=a.Gu.NotStarted},setInputs:(y,p)=>{y.inputs={dataSources:p.payload.filter(v=>v.type==="datasource"),constants:p.payload.filter(v=>v.type==="constant"),libraryPanels:y.inputs.libraryPanels||[]}},setLibraryPanelInputs:(y,p)=>{y.inputs.libraryPanels=p.payload},fetchFailed:y=>{y.dashboard={},y.state=a.Gu.Error},fetchDashboard:y=>{y.state=a.Gu.Loading}}}),{clearDashboard:l,setInputs:m,setGcomDashboard:s,setJsonDashboard:h,setLibraryPanelInputs:u,fetchFailed:b,fetchDashboard:g}=d.actions,c={importDashboard:d.reducer}},59120:(Q,I,e)=>{"use strict";e.d(I,{O5:()=>c,dX:()=>g,Z1:()=>l,Zd:()=>s,Yl:()=>u,QZ:()=>m,bM:()=>P,Wu:()=>d,TH:()=>b});var n=e(75816),a=e(75505),o=e(17172);function r({baseURL:p}){async function v(D){try{const{data:E,...S}=await(0,a.s)((0,o.AI)().fetch({...D,url:p+D.url,showErrorAlert:D.showErrorAlert,data:D.body}));return{data:E,meta:S}}catch(E){return D.manageError?D.manageError(E):{error:E}}}return v}const f=(0,n.xP)({reducerPath:"migrateToCloudGeneratedAPI",baseQuery:r({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:p=>({getMigrationList:p.query({query:()=>({url:"/cloudmigration/migration"})}),createMigration:p.mutation({query:v=>({url:"/cloudmigration/migration",method:"POST",body:v.cloudMigrationRequest})}),getCloudMigrationRun:p.query({query:v=>({url:`/cloudmigration/migration/run/${v.runUid}`})}),deleteCloudMigration:p.mutation({query:v=>({url:`/cloudmigration/migration/${v.uid}`,method:"DELETE"})}),getCloudMigration:p.query({query:v=>({url:`/cloudmigration/migration/${v.uid}`})}),getCloudMigrationRunList:p.query({query:v=>({url:`/cloudmigration/migration/${v.uid}/run`})}),runCloudMigration:p.mutation({query:v=>({url:`/cloudmigration/migration/${v.uid}/run`,method:"POST"})}),createCloudMigrationToken:p.mutation({query:()=>({url:"/cloudmigration/token",method:"POST"})}),getDashboardByUid:p.query({query:v=>({url:`/dashboards/uid/${v.uid}`})})}),overrideExisting:!1}),{useGetMigrationListQuery:d,useCreateMigrationMutation:l,useGetCloudMigrationRunQuery:m,useDeleteCloudMigrationMutation:s,useGetCloudMigrationQuery:h,useGetCloudMigrationRunListQuery:u,useRunCloudMigrationMutation:b,useCreateCloudMigrationTokenMutation:g,useGetDashboardByUidQuery:P}=f,c=f.enhanceEndpoints({addTagTypes:["cloud-migration-config","cloud-migration-run","cloud-migration-run-list"],endpoints:{createCloudMigrationToken:y,getMigrationList:{providesTags:["cloud-migration-config"]},createMigration(p){y(p),p.invalidatesTags=["cloud-migration-config"]},getCloudMigration:{providesTags:["cloud-migration-config"]},deleteCloudMigration:{invalidatesTags:["cloud-migration-config"]},getCloudMigrationRunList:{providesTags:["cloud-migration-run-list"]},getCloudMigrationRun:{providesTags:["cloud-migration-run"]},runCloudMigration:{invalidatesTags:["cloud-migration-run-list"]},getDashboardByUid:y}});function y(p){if(!p.query)return;const v=p.query;p.query=(...D)=>{const E=v(...D);return E.showErrorAlert=!1,E}}},32931:(Q,I,e)=>{"use strict";e.d(I,{EC:()=>d,L_:()=>i,YS:()=>r,bA:()=>f,wV:()=>l});var n=e(17172),a=e(82467),o=e(10943);function r(m={getBackendSrv:n.AI}){return async s=>{const h=await m.getBackendSrv().get("/api/org");return s((0,o.bK)(h)),h}}function i(m={getBackendSrv:n.AI}){return async(s,h)=>{const u=h().organization.organization;await m.getBackendSrv().put("/api/org",{name:u.name}),s((0,a.YA)(u.name)),s(r(m))}}function f(m,s={getBackendSrv:n.AI}){return async h=>{const u=await s.getBackendSrv().post("/api/user/using/"+m);h((0,a.YA)(u.name))}}function d(m,s={getBackendSrv:n.AI}){return async h=>{const u=await s.getBackendSrv().post("/api/orgs/",m);h(f(u.orgId))}}function l(m={getBackendSrv:n.AI}){return async s=>{const h=await m.getBackendSrv().get("/api/user/orgs");return s((0,o.Bz)(h)),h}}},10943:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>l,Bz:()=>f,bK:()=>i,n:()=>r});var n=e(65307);const a={organization:{},userOrgs:[]},o=(0,n.Z0)({name:"organization",initialState:a,reducers:{organizationLoaded:(m,s)=>({...m,organization:s.payload}),setOrganizationName:(m,s)=>({...m,organization:{...m.organization,name:s.payload}}),userOrganizationsLoaded:(m,s)=>({...m,userOrgs:s.payload})}}),{setOrganizationName:r,organizationLoaded:i,userOrganizationsLoaded:f}=o.actions,l={organization:o.reducer}},17888:(Q,I,e)=>{"use strict";e.d(I,{a:()=>v});var n=e(32196),a=e(96540),o=e(47070),r=e(41987),i=e(13544),f=e(12131),d=e(40845),l=e(79041),m=e(14578);const s=a.forwardRef(({icon:S,children:T,onClick:M,...A},x)=>{const C=(0,d.of)(h);return a.createElement("button",{...A,className:C.action,onClick:M},a.createElement(m.I,{name:S,size:"xl"}),T)});s.displayName="CardButton";const h=S=>({action:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",justifySelf:"center",cursor:"pointer",background:S.colors.background.secondary,borderRadius:S.shape.radius.default,color:S.colors.text.primary,border:"unset",width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center","&:hover":{background:S.colors.emphasize(S.colors.background.secondary)}})});var u=e(15054),b=e(33390),g=e(53466),P=e(32696),c=e(14792),y=e(31678),p=e(79971);function v(S){const T=(0,d.of)(E),M=(0,l.d2)(),A=new o.v2(S.data),{dataSummary:x}=A,C=D(S,x),O=(0,y.useDispatch)(),R=(0,c.UA)().getCurrent()?.getPanelById(S.panelId),L=()=>{b.A.setObject(u.wV,P.__.Suggestions),O((0,g.eK)(!0))},N=()=>{R&&O((0,p.gW)({panel:R,pluginId:"table"}))},F=K=>{R&&(O((0,p.gW)({...K,panel:R})),K.transformations&&setTimeout(()=>{f.Ny.partial({tab:"transform"})},100))};return a.createElement("div",{className:T.wrapper},a.createElement("div",{className:T.message,"data-testid":i.Tp.components.Panels.Panel.PanelDataErrorMessage},C),M.app===r.Jk.PanelEditor&&x.hasData&&R&&a.createElement("div",{className:T.actions},S.suggestions&&a.createElement(a.Fragment,null,S.suggestions.map(K=>a.createElement(s,{key:K.name,icon:"process",onClick:()=>F(K)},K.name))),a.createElement(s,{icon:"table",onClick:N},"Switch to table"),a.createElement(s,{icon:"chart-line",onClick:L},"Open visualization suggestions")))}function D({data:S,fieldConfig:T,message:M,needsNumberField:A,needsTimeField:x,needsStringField:C},O){return M||(!S.series||S.series.length===0||S.series.every(R=>R.length===0)?T?.defaults.noValue??"No data":C&&!O.hasStringField?"Data is missing a string field":A&&!O.hasNumberField?"Data is missing a number field":x&&!O.hasTimeField?"Data is missing a time field":"Cannot visualize data")}const E=S=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"}),message:(0,n.css)({textAlign:"center",color:S.colors.text.secondary,fontSize:S.typography.size.lg,width:"100%"}),actions:(0,n.css)({marginTop:S.spacing(2),display:"flex",height:"50%",maxHeight:"150px",columnGap:S.spacing(1),rowGap:S.spacing(1),width:"100%",maxWidth:"600px"})})},41394:(Q,I,e)=>{"use strict";e.d(I,{$:()=>l,W:()=>d});var n=e(96540),a=e(65158),o=e(43429),r=e(42418),i=e(31678);class f extends n.PureComponent{constructor(s){super(s)}render(){const s={display:"flex",alignItems:"center",justifyContent:"center",height:"100%"};return n.createElement("div",{style:s},n.createElement(r.F,{severity:i.AppNotificationSeverity.Error,...this.props}))}}function d(m,s){const h=class extends n.PureComponent{render(){const g=n.createElement(n.Fragment,null,"Check the server startup logs for more information. ",n.createElement("br",null),"If this plugin was loaded from Git, then make sure it was compiled.");return n.createElement(f,{title:`Error loading: ${m.id}`,text:g})}},u=new a.m(h);return u.meta=m,u.loadError=!0,u}function l(m,s){const h=class extends n.PureComponent{render(){return n.createElement(f,{title:`Panel plugin not found: ${m}`})}},u=new a.m(s?()=>null:h);return u.meta={id:m,name:m,sort:100,type:o.QE.panel,module:"",baseUrl:"",info:{author:{name:""},description:"",links:[],logos:{large:"",small:"public/img/grafana_icon.svg"},screenshots:[],updated:"",version:""}},u}},20726:(Q,I,e)=>{"use strict";e.d(I,{m:()=>b});var n=e(96540),a=e(1933),o=e(90708),r=e(13834),i=e(581),f=e(72574),d=e(40845),l=e(79041),m=e(66602),s=e(10096),h=e(15162);const u={defaults:{},overrides:[]};function b(P){const{pluginId:c,data:y,timeZone:p=(0,a.O)(),options:v={},width:D,height:E,title:S,onOptionsChange:T=()=>{},onChangeTimeRange:M=()=>{},onFieldConfigChange:A=()=>{},fieldConfig:x=u}=P,C=(0,d.$j)(),O=(0,f.w)(),R=(0,n.useMemo)(()=>O.replace.bind(O),[O]),[L,N]=(0,n.useState)((0,h.PY)(c)),[F,K]=(0,n.useState)(),B=g(L,v,x),{dataLinkPostProcessor:w}=(0,l.d2)(),U=(0,o.rJ)(L,B?.fieldConfig,y,p,C,R,w);if((0,n.useEffect)(()=>{L&&L.hasPluginId(c)||(0,h.TV)(c).then(V=>N(V)).catch(V=>{K(V.message)})},[c,L]),F)return n.createElement("div",null,"Failed to load plugin: ",F);if(!L||!L.hasPluginId(c))return n.createElement("div",null,"Loading plugin panel...");if(!L.panel)return n.createElement("div",null,"Seems like the plugin you are trying to load does not have a panel component.");if(!U)return n.createElement("div",null,"No panel data");const W=L.panel;return n.createElement(m.Xw,{dependencies:[L,y]},n.createElement(r.a,{meta:L.meta},n.createElement(W,{id:1,data:U,title:S,timeRange:U.timeRange,timeZone:p,options:B.options,fieldConfig:x,transparent:!1,width:D,height:E,renderCounter:0,replaceVariables:V=>V,onOptionsChange:T,onFieldConfigChange:A,onChangeTimeRange:M,eventBus:s.lE})))}function g(P,c,y){return(0,n.useMemo)(()=>{if(P)return(0,i.F)({plugin:P,currentOptions:c,currentFieldConfig:y,isAfterPluginChange:!1})},[P,y,c])}},25701:(Q,I,e)=>{"use strict";e.d(I,{b:()=>P});var n=e(32196),a=e(96540),o=e(70255),r=e(43429),i=e(51527),f=e(13544),d=e(40845),l=e(29158),m=e(98624),s=e(72129),h=e(10803);const u=38,b=({isCurrent:v,title:D,plugin:E,onClick:S,onDelete:T,disabled:M,showBadge:A,description:x,children:C})=>{const O=(0,d.of)(y),R=M||E.state===r.pn.deprecated,L=(0,n.cx)({[O.item]:!0,[O.itemDisabled]:R,[O.current]:v});return a.createElement("div",{className:L,"aria-label":f.Tp.components.PluginVisualization.item(E.name),"data-testid":f.Tp.components.PluginVisualization.item(E.name),onClick:R?void 0:S,title:v?"Click again to close this section":E.name},a.createElement("img",{className:(0,n.cx)(O.img,{[O.disabled]:R}),src:E.info.logos.small,alt:""}),a.createElement("div",{className:(0,n.cx)(O.itemContent,{[O.disabled]:R})},a.createElement("div",{className:O.name},D),x?a.createElement("span",{className:O.description},x):null,C),A&&a.createElement("div",{className:(0,n.cx)(O.badge,{[O.disabled]:R})},a.createElement(p,{plugin:E})),T&&a.createElement(l.K,{name:"trash-alt",onClick:N=>{N.stopPropagation(),T()},className:O.deleteButton,"aria-label":"Delete button on panel type card",tooltip:"Delete"}))};b.displayName="PanelTypeCard";const g=({children:v,hasDescription:D,hasDelete:E,rootProps:S})=>{const T=(0,d.of)(y),M=(0,d.of)(c);return a.createElement("div",{className:T.item,...S},a.createElement(o.A,{className:(0,n.cx)(T.img,M.image),width:u,height:u}),a.createElement("div",{className:T.itemContent},a.createElement("div",{className:T.name},a.createElement(o.A,{width:160})),D?a.createElement(o.A,{containerClassName:T.description,width:80}):null,v),E&&a.createElement(o.A,{containerClassName:(0,n.cx)(T.deleteButton,M.deleteButton),width:16,height:16}))},P=(0,s.j)(b,g),c=()=>({deleteButton:(0,n.css)({lineHeight:1}),image:(0,n.css)({lineHeight:1})}),y=v=>({item:(0,n.css)({position:"relative",display:"flex",flexShrink:0,cursor:"pointer",background:v.colors.background.secondary,borderRadius:v.shape.radius.default,boxShadow:v.shadows.z1,border:`1px solid ${v.colors.background.secondary}`,alignItems:"center",padding:v.spacing(1),width:"100%",overflow:"hidden",[v.transitions.handleMotion("no-preference","reduce")]:{transition:v.transitions.create(["background"],{duration:v.transitions.duration.short})},"&:hover":{background:v.colors.emphasize(v.colors.background.secondary,.03)}}),itemContent:(0,n.css)({overflow:"hidden",position:"relative",padding:v.spacing(0,1)}),itemDisabled:(0,n.css)({cursor:"default","&, &:hover":{background:v.colors.action.disabledBackground}}),current:(0,n.css)({label:"currentVisualizationItem",border:`1px solid ${v.colors.primary.border}`,background:v.colors.action.selected}),disabled:(0,n.css)({opacity:.6,filter:"grayscale(1)",cursor:"default",pointerEvents:"none"}),name:(0,n.css)({textOverflow:"ellipsis",overflow:"hidden",fontSize:v.typography.size.sm,fontWeight:v.typography.fontWeightMedium,width:"100%"}),description:(0,n.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",color:v.colors.text.secondary,fontSize:v.typography.bodySmall.fontSize,fontWeight:v.typography.fontWeightLight,width:"100%",maxHeight:"4.5em"}),img:(0,n.css)({maxHeight:u,width:u,display:"flex",alignItems:"center"}),badge:(0,n.css)({background:v.colors.background.primary}),deleteButton:(0,n.css)({cursor:"pointer",marginLeft:"auto"})}),p=({plugin:v})=>(0,i.x)(v.signature)?a.createElement(m.B,{status:v.signature}):a.createElement(h.p,{state:v.state});p.displayName="PanelPluginBadge"},56707:(Q,I,e)=>{"use strict";e.d(I,{a:()=>p});var n=e(32196),a=e(96540),o=e(16817),r=e(70713),i=e(40845),f=e(47070),d=e(32264),l=e(15162);const m=["timeseries","barchart","gauge","stat","piechart","bargauge","table","state-timeline","status-history","logs","candlestick","flamegraph","traces","nodeGraph"];async function s(E,S){const T=new f.v2(E,S);for(const A of m){const C=(await(0,l.TV)(A)).getSuggestionsSupplier();C&&C.getSuggestionsForData(T)}const M=T.getList();if(!d.$.featureToggles.vizAndWidgetSplit&&T.dataSummary.fieldCount===0)for(const A of Object.values(d.$.panels))!A.skipDataQuery||A.hideFromList||M.push({name:A.name,pluginId:A.id,description:A.info.description,cardOptions:{imgSrc:A.info.logos.small}});return M.sort((A,x)=>{if(T.dataSummary.preferredVisualisationType){if(A.pluginId===T.dataSummary.preferredVisualisationType)return-1;if(x.pluginId===T.dataSummary.preferredVisualisationType)return 1}return(x.score??f.nQ.OK)-(A.score??f.nQ.OK)})}var h=e(2543),u=e(13544),b=e(56034),g=e(20726);function P({data:E,suggestion:S,onChange:T,width:M}){const A=(0,i.of)(c),{innerStyles:x,outerStyles:C,renderWidth:O,renderHeight:R}=y(M),L=S.cardOptions??{},N={"aria-label":S.name,className:A.vizBox,"data-testid":u.Tp.components.VisualizationPreview.card(S.name),style:C,onClick:()=>{T({pluginId:S.pluginId,options:S.options,fieldConfig:S.fieldConfig})}};if(L.imgSrc)return a.createElement(b.m,{content:S.description??S.name},a.createElement("button",{...N,className:(0,n.cx)(A.vizBox,A.imgBox)},a.createElement("div",{className:A.name},S.name),a.createElement("img",{className:A.img,src:L.imgSrc,alt:S.name})));let F=S;return S.cardOptions?.previewModifier&&(F=(0,h.cloneDeep)(S),S.cardOptions.previewModifier(F)),a.createElement("button",{...N},a.createElement(b.m,{content:S.name},a.createElement("div",{style:x,className:A.renderContainer},a.createElement(g.m,{title:"",data:E,pluginId:S.pluginId,width:O,height:R,options:F.options,fieldConfig:F.fieldConfig}),a.createElement("div",{className:A.hoverPane}))))}const c=E=>({hoverPane:(0,n.css)({position:"absolute",top:0,right:0,left:0,borderRadius:E.spacing(2),bottom:0}),vizBox:(0,n.css)`
      position: relative;
      background: none;
      border-radius: ${E.shape.radius.default};
      cursor: pointer;
      border: 1px solid ${E.colors.border.medium};

      transition: ${E.transitions.create(["background"],{duration:E.transitions.duration.short})};

      &:hover {
        background: ${E.colors.background.secondary};
      }
    `,imgBox:(0,n.css)`
      display: flex;
      flex-direction: column;
      height: 100%;

      justify-self: center;
      color: ${E.colors.text.primary};
      width: 100%;
      display: flex;

      justify-content: center;
      align-items: center;
      text-align: center;
    `,name:(0,n.css)`
      padding-bottom: ${E.spacing(.5)};
      margin-top: ${E.spacing(-1)};
      font-size: ${E.typography.bodySmall.fontSize};
      white-space: nowrap;
      overflow: hidden;
      color: ${E.colors.text.secondary};
      font-weight: ${E.typography.fontWeightMedium};
      text-overflow: ellipsis;
    `,img:(0,n.css)`
      max-width: ${E.spacing(8)};
      max-height: ${E.spacing(8)};
    `,renderContainer:(0,n.css)`
      position: absolute;
      transform-origin: left top;
      top: 6px;
      left: 6px;
    `});function y(E){const T=E,M=E*(1/1.6),A=350,x=A*(1/1.6),C=6,O=(T-C*2)/A,R=(M-C*2)/x;return{renderHeight:x,renderWidth:A,outerStyles:{width:T,height:M},innerStyles:{width:A,height:x,transform:`scale(${O}, ${R})`}}}function p({searchQuery:E,onChange:S,data:T,panel:M}){const A=(0,i.of)(D),{value:x}=(0,o.A)(()=>s(T,M),[T,M]),C=v(E,x);return a.createElement("div",null,a.createElement(r.Ay,{disableHeight:!0,style:{width:"100%",height:"100%"}},({width:O})=>{if(!O)return null;O=O-1;const R=Math.floor(O/200),L=8*(R-1),N=Math.floor((O-L)/R);return a.createElement("div",null,a.createElement("div",{className:A.filterRow},a.createElement("div",{className:A.infoText},"Based on current data")),a.createElement("div",{className:A.grid,style:{gridTemplateColumns:`repeat(auto-fill, ${N}px)`}},C.map((F,K)=>a.createElement(P,{key:K,data:T,suggestion:F,onChange:S,width:N-1})),E&&C.length===0&&a.createElement("div",{className:A.infoText},"No results matched your query")))}))}function v(E,S){if(!E||!S)return S||[];const T=new RegExp(E,"i");return S.filter(M=>T.test(M.name)||T.test(M.pluginId))}const D=E=>({heading:(0,n.css)({...E.typography.h5,margin:E.spacing(0,.5,1)}),filterRow:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",paddingBottom:"8px"}),infoText:(0,n.css)({fontSize:E.typography.bodySmall.fontSize,color:E.colors.text.secondary,fontStyle:"italic"}),grid:(0,n.css)({display:"grid",gridGap:E.spacing(1),gridTemplateColumns:"repeat(auto-fill, 144px)",marginBottom:E.spacing(1),justifyContent:"space-evenly"})})},86292:(Q,I,e)=>{"use strict";e.d(I,{G:()=>l});var n=e(32196),a=e(96540),o=e(32264),r=e(40845),i=e(41670),f=e(17706),d=e(48889);function l({pluginId:s,searchQuery:h,onChange:u,isWidget:b=!1}){const g=(0,r.of)(m),P=(0,a.useMemo)(()=>o.$.featureToggles.vizAndWidgetSplit?b?(0,f.nr)():(0,f.if)():(0,f.A4)(),[b]),c=(0,a.useMemo)(()=>(0,f.CO)(P,h,s),[P,h,s]);return c.length===0?a.createElement(i.Z,null,"Could not find anything matching your query"):a.createElement("div",{className:g.grid},c.map(y=>a.createElement(d.f,{disabled:!1,key:y.id,isCurrent:y.id===s,plugin:y,onClick:p=>u({pluginId:y.id,withModKey:p.metaKey||p.ctrlKey||p.altKey})})))}const m=s=>({grid:(0,n.css)({maxWidth:"100%",display:"grid",gridGap:s.spacing(.5)}),heading:(0,n.css)({...s.typography.h5,margin:s.spacing(0,.5,1)})})},48889:(Q,I,e)=>{"use strict";e.d(I,{f:()=>o});var n=e(96540),a=e(25701);const o=({isCurrent:r,plugin:i,onClick:f,disabled:d})=>n.createElement(a.b,{title:i.name,plugin:i,description:i.info.description,onClick:f,isCurrent:r,disabled:d,showBadge:!0});o.displayName="VizTypePickerPlugin"},32349:(Q,I,e)=>{"use strict";e.d(I,{CH:()=>l,E7:()=>d,EO:()=>f});var n=e(14236),a=e(83195),o=e(92461),r=e(32023),i=e(6923);const f=m=>{const s=m.field.links;if(!(!s||s.length===0))return{getLinks:h=>{const u={};if(m.view){const{dataFrame:g}=m.view;u.__series={value:{name:g.name,refId:g.refId},text:"Series"};const P=m.colIndex!==void 0?g.fields[m.colIndex]:void 0;if(P){if(u.__field={value:{name:P.name,labels:P.labels},text:"Field"},m.rowIndex!==void 0&&m.rowIndex>=0){const{timeField:c}=(0,n.KR)(g);u.__value={value:{raw:P.values[m.rowIndex],numeric:m.display.numeric,text:(0,a.cN)(m.display),time:c?c.values[m.rowIndex]:void 0},text:"Value"}}m.view&&(u.__data={value:{name:g.name,refId:g.refId,fields:(0,o.F)({frame:g,rowIndex:m.rowIndex})},text:"Data"})}else u.__value={value:{raw:m.display.numeric,numeric:m.display.numeric,text:(0,a.cN)(m.display),calc:m.name},text:"Value"}}else console.log("VALUE",m);const b=(g,P,c)=>{const y={...u,...P};return h(g,y,c)};return s.map(g=>(0,i.mQ)().getDataLinkUIModel(g,b,m))}}},d=(m,s)=>{const h=m.links;if(!(!h||h.length===0))return{getLinks:()=>h.map(u=>(0,i.mQ)().getDataLinkUIModel(u,s||m.replaceVariables,m))}},l=(m,s)=>{const h=r.b4.getPanelLinks(m)?.state.rawLinks;if(!(!h||h.length===0))return{getLinks:()=>h.map(u=>(0,i.mQ)().getDataLinkUIModel(u,s,m))}}},6923:(Q,I,e)=>{"use strict";e.d(I,{Fq:()=>p,Hf:()=>E,mQ:()=>x});var n=e(2543),a=e.n(n),o=e(6709),r=e(91890),i=e(28240),f=e(11261),d=e(71733),l=e(40672),m=e(76885),s=e(95344),h=e(72574),u=e(52622),b=e(2913);const g=[{value:`${o.c.keepTime}`,label:"Time range",documentation:"Adds current time range",origin:r.$0.BuiltIn},{value:`${o.c.timeRangeFrom}`,label:"Time range: from",documentation:"Adds current time range's from value",origin:r.$0.BuiltIn},{value:`${o.c.timeRangeTo}`,label:"Time range: to",documentation:"Adds current time range's to value",origin:r.$0.BuiltIn}],P=[{value:`${o.c.seriesName}`,label:"Name",documentation:"Name of the series",origin:r.$0.Series}],c=[{value:`${o.c.valueNumeric}`,label:"Numeric",documentation:"Numeric representation of selected value",origin:r.$0.Value},{value:`${o.c.valueText}`,label:"Text",documentation:"Text representation of selected value",origin:r.$0.Value},{value:`${o.c.valueRaw}`,label:"Raw",documentation:"Raw value",origin:r.$0.Value}],y=C=>C.includes(".")||C.trim().includes(" ")?`["${C}"]`:`.${C}`,p=()=>[...(0,h.w)().getVariables().map(C=>({value:C.name,label:C.name,origin:r.$0.Template})),{value:`${o.c.includeVars}`,label:"All variables",documentation:"Adds current variables",origin:r.$0.Template},...g],v=C=>{const O=[];for(const L of C)for(const N of L.fields)if(N.labels)for(const F of Object.keys(N.labels))O.push(F);const R=(0,n.chain)(O).flatten().uniq().value();return[{value:`${o.c.fieldName}`,label:"Name",documentation:"Field name of the clicked datapoint (in ms epoch)",origin:r.$0.Field},...R.map(L=>({value:`__field.labels${y(L)}`,label:`labels.${L}`,documentation:`${L} label value`,origin:r.$0.Field}))]},D=C=>{let O,R;const L=[],N={};if(C.length!==1)return[];const F=C[0];for(const K of F.fields){const B=(0,i.Ct)(K,F,C);N[B]||(L.push({value:`__data.fields${y(B)}`,label:`${B}`,documentation:`Formatted value for ${B} on the same row`,origin:r.$0.Fields}),N[B]=!0,!O&&K.type===f.PU.number&&(O={...K,name:B}),!R&&K.config.displayName&&K.config.displayName!==K.name&&(R={...K,name:B}))}return L.length&&L.push({value:"__data.fields[0]",label:"Select by index",documentation:"Enter the field order",origin:r.$0.Fields}),O&&(L.push({value:`__data.fields${y(O.name)}.numeric`,label:"Show numeric value",documentation:"the numeric field value",origin:r.$0.Fields}),L.push({value:`__data.fields${y(O.name)}.text`,label:"Show text value",documentation:"the text value",origin:r.$0.Fields})),R&&L.push({value:`__data.fields${y(R.name)}`,label:"Select by title",documentation:"Use the title to pick the field",origin:r.$0.Fields}),L},E=(C,O)=>{const R={value:`${o.c.valueTime}`,label:"Time",documentation:"Time value of the clicked datapoint (in ms epoch)",origin:r.$0.Value};return O===r.uP.Values?[...P,...v(C),...c,R,...D(C),...p()]:[...P,...v(C),...D(C),...p()]},S=C=>{const O=v(C),R={value:`${DataLinkBuiltInVars.valueCalc}`,label:"Calculation name",documentation:"Name of the calculation the value is a result of",origin:VariableOrigin.Value};return[...P,...O,...c,R,...p()]};class T{constructor(){this.getDataLinkUIModel=(O,R,L)=>{let N=O.url;O.onBuildUrl&&(N=O.onBuildUrl({origin:L,replaceVariables:R}));const F={href:d.I.assureBaseUrl(N.replace(/\n/g,"")),title:O.title??"",target:O.targetBlank?"_blank":void 0,origin:L};return R&&(F.href=R(F.href,void 0,u.$m.UriEncode),F.title=R(O.title)),O.onClick&&(F.onClick=K=>{O.onClick({origin:L,replaceVariables:R,e:K})}),F.href=(0,b.zj)().disableSanitizeHtml?F.href:l.sQ.sanitizeUrl(F.href),F}}getLinkUrl(O){let R={};O.keepTime&&(R[`$${o.c.keepTime}`]=!0),O.includeVars&&(R[`$${o.c.includeVars}`]=!0);let L=d.I.assureBaseUrl(m.kM.appendQueryToUrl(O.url||"",m.kM.toUrlParams(R)));return L=(0,h.w)().replace(L),(0,b.zj)().disableSanitizeHtml?L:l.sQ.sanitizeUrl(L)}getAnchorInfo(O){const R=(0,h.w)();return{href:this.getLinkUrl(O),title:R.replace(O.title||""),tooltip:R.replace(O.tooltip||"")}}getPanelLinkAnchorInfo(O,R){(0,s.l)("link_srv.ts","getPanelLinkAnchorInfo","getDataLinkUIModel");const L=(N,F,K)=>(0,h.w)().replace(N,{...R,...F},K);return this.getDataLinkUIModel(O,L,{})}}let M;function A(C){M=C}function x(){return M||(M=new T),M}},79971:(Q,I,e)=>{"use strict";e.d(I,{Ap:()=>d,O6:()=>l,Xk:()=>s,gW:()=>m});var n=e(581),a=e(57767),o=e(41394),r=e(20701),i=e(28444),f=e(80095);function d(u){return async(b,g)=>{if(u.libraryPanel?.uid&&!("model"in u.libraryPanel)){b(h(u));return}u.maxDataPoints&&(u.maxDataPoints=Number(u.maxDataPoints));let P=u.type,c=g().plugins.panels[P];if(!c)try{c=await b((0,r.y7)(P))}catch{c=(0,o.$)(P,P==="row")}u.plugin||await u.pluginLoaded(c),b((0,f.XM)({key:u.key,plugin:c}))}}function l(u){return b=>{b((0,f.FC)({key:u}))}}function m({panel:u,pluginId:b,options:g,fieldConfig:P,transformations:c}){return async(y,p)=>{if(u.type===b&&!g&&!P&&!c)return;let D=p().plugins.panels[b];if(D||(D=await y((0,r.y7)(b))),u.type!==b&&u.changePlugin(D),g||P||c){const E=(0,n.F)({plugin:D,currentOptions:g||u.options,currentFieldConfig:P||u.fieldConfig,isAfterPluginChange:!1});u.options=E.options,u.fieldConfig=E.fieldConfig,u.transformations=c||u.transformations,u.configRev++}u.generateNewKey(),y((0,f.XM)({key:u.key,plugin:D}))}}function s(u,b){return async(g,P)=>{const c=b.model.type,y=u.type;if(u.restoreModel({...b.model,gridPos:u.gridPos,id:u.id,libraryPanel:b}),u.getQueryRunner().clearLastResult(),y!==c){let v=P().plugins.panels[c];v||(v=await g((0,r.y7)(c))),await u.pluginLoaded(v),u.generateNewKey(),await g((0,f.XM)({key:u.key,plugin:v}))}else{const p=u.key;u.generateNewKey(),g((0,f.io)({oldKey:p,newKey:u.key}))}u.configRev=0,u.hasSavedPanelEditChange=!0,u.refresh(),u.events.publish(i.zq),u.events.publish(i.PR)}}function h(u){return async(b,g)=>{const P=u.libraryPanel.uid;try{const c=await(0,a.Yr)(P,!0);u.initLibraryPanel(c);const y=g().dashboard.getModel();if(u.repeat&&y){const p=y.panels.findIndex(v=>v.id===u.id);y.repeatPanel(u,p),y.sortPanelsByGridPos(),y.events.publish(new i.Q$)}await b(d(u))}catch(c){console.log("ERROR: ",c),b((0,f.XM)({key:u.key,plugin:(0,o.$)("Unable to load library panel: "+P,!1)}))}}}},80095:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>h,FC:()=>l,S3:()=>i,XM:()=>r,io:()=>d,nF:()=>f,rG:()=>m});var n=e(65307);const a={},o=(0,n.Z0)({name:"panels",initialState:a,reducers:{panelModelAndPluginReady:(u,b)=>{u[b.payload.key]={plugin:b.payload.plugin}},changePanelKey:(u,b)=>{u[b.payload.newKey]=u[b.payload.oldKey],delete u[b.payload.oldKey]},removePanel:(u,b)=>{delete u[b.payload.key]},removeAllPanels:u=>{Object.keys(u).forEach(b=>delete u[b])},setPanelInstanceState:(u,b)=>{u[b.payload.key].instanceState=b.payload.value},setPanelAngularComponent:(u,b)=>{const g=u[b.payload.key];g.angularComponent=b.payload.angularComponent}}}),{panelModelAndPluginReady:r,setPanelAngularComponent:i,setPanelInstanceState:f,changePanelKey:d,removePanel:l,removeAllPanels:m}=o.actions,h={panels:o.reducer}},40334:(Q,I,e)=>{"use strict";e.d(I,{U:()=>n});function n(a,o){return a.panels[o.key]}},17706:(Q,I,e)=>{"use strict";e.d(I,{A4:()=>r,CO:()=>d,if:()=>f,nr:()=>i});var n=e(43429),a=e(54479),o=e(2913);function r(){const l=o.config.panels;return Object.keys(l).filter(m=>l[m].hideFromList===!1).map(m=>l[m]).sort((m,s)=>m.sort-s.sort)}function i(){return r().filter(l=>!!l.skipDataQuery)}function f(){return r().filter(l=>!l.skipDataQuery)}function d(l,m,s){if(!m.length)return l.filter(P=>P.state===n.pn.deprecated?s===P.id:!0);const h=(0,a.xb)(m).toLowerCase(),u=[],b=[],g="graph".startsWith(h);for(const P of l){if(P.state===n.pn.deprecated&&s!==P.id)continue;const y=P.name.toLowerCase().indexOf(h);y===0?u.push(P):y>0?b.push(P):g&&P.id==="timeseries"&&u.push(P)}return u.concat(b)}},2609:(Q,I,e)=>{"use strict";e.d(I,{_o:()=>h});var n=e(2543),a=e.n(n),o=e(71733),r=e(76885),i=e(65879),f=e(12131),d=e(2619),l=e(86022);const m={kiosk:!0,autofitpanels:!0,orgId:!0,"_dash.hideTimePicker":!0,"_dash.hideVariables":!0,"_dash.hideLinks":!0};class s extends d.Q{constructor(){super({isPlaying:!1}),this.urls=[],this.index=0,this.numberOfLoops=0,this.locationUpdated=this.locationUpdated.bind(this),this.api=(0,l.NF)()}next(){if(clearTimeout(this.nextTimeoutId),this.index>this.urls.length-1){if(this.numberOfLoops++,this.numberOfLoops>=3){window.location.href=this.startUrl;return}this.index=0}const g=this.urls[this.index],P=f.Ny.getSearchObject(),c=(0,n.pickBy)(P,(p,v)=>m[v]),y=o.I.stripBaseFromUrl(g);this.index++,this.validPlaylistUrl=y,this.nextTimeoutId=setTimeout(()=>this.next(),this.interval),f.Ny.push(y+"?"+r.kM.toUrlParams(c))}prev(){this.index=Math.max(this.index-2,0),this.next()}locationUpdated(b){b.pathname!==this.validPlaylistUrl&&this.stop()}async start(b){this.stop(),this.startUrl=window.location.href,this.index=0,this.setState({isPlaying:!0}),this.locationListenerUnsub=f.Ny.getHistory().listen(this.locationUpdated);const g=[];let P=await this.api.getPlaylist(b);if(!P.items?.length)return;this.interval=i.intervalToMs(P.interval);const c=await(0,l.qY)(P.items);for(const y of c)if(y.dashboards)for(const p of y.dashboards)g.push(p.url);g.length&&(this.urls=g,this.setState({isPlaying:!0}),this.next())}stop(){this.state.isPlaying&&(this.index=0,this.setState({isPlaying:!1}),this.locationListenerUnsub&&this.locationListenerUnsub(),this.nextTimeoutId&&clearTimeout(this.nextTimeoutId),f.Ny.getSearchObject().kiosk&&f.Ny.partial({kiosk:null}))}}const h=new s},86022:(Q,I,e)=>{"use strict";e.d(I,{GM:()=>v,NF:()=>D,aV:()=>p,qY:()=>y});var n=e(75505),a=e(78368),o=e(17172),r=e(32264),i=e(82467),f=e(3169),d=e(90183),l=e(68706),m=e(99140),s=e(2468),h=e(24439);class u{async getAllPlaylist(){return(0,o.AI)().get("/api/playlists/")}async getPlaylist(S){const T=await(0,o.AI)().get(`/api/playlists/${S}`);return await P(T),T}async createPlaylist(S){await c(()=>(0,o.AI)().post("/api/playlists",S))}async updatePlaylist(S){await c(()=>(0,o.AI)().put(`/api/playlists/${S.uid}`,S))}async deletePlaylist(S){await c(()=>(0,o.AI)().delete(`/api/playlists/${S}`),"Playlist deleted")}}class b{constructor(){this.playlistAsK8sResource=S=>({metadata:{name:S.uid},spec:{title:S.name,interval:S.interval,items:S.items??[]}}),this.server=new s.w({group:"playlist.grafana.app",version:"v0alpha1",resource:"playlists"})}async getAllPlaylist(){return(await this.server.list()).items.map(g)}async getPlaylist(S){const T=await this.server.get(S),M=g(T);return await P(M),M}async createPlaylist(S){const T=this.playlistAsK8sResource(S);await c(()=>this.server.create(T))}async updatePlaylist(S){const T=this.playlistAsK8sResource(S);await c(()=>this.server.update(T).then(()=>{}))}async deletePlaylist(S){await c(()=>this.server.delete(S).then(()=>{}),"Playlist deleted")}}function g(E){const{spec:S,metadata:T}=E;return{uid:T.name,name:S.title,interval:S.interval,items:S.items}}async function P(E){if(E?.items){for(const S of E.items)if(S.type==="dashboard_by_id"){S.type="dashboard_by_uid";const T=await(0,o.AI)().get(`/api/dashboards/ids/${S.value}`);T?.length&&(S.value=T[0])}}}async function c(E,S="Playlist saved"){try{await E(),(0,m.JD)((0,i.dx)((0,f.tZ)(S)))}catch(T){T instanceof Error&&(0,m.JD)((0,i.dx)((0,f.gi)("Unable to save playlist",T)))}}async function y(E){let S=0;if(!E?.length)return[];const T=[];for(const x of E){const C={query:"*",kind:["dashboard"],limit:1e3};switch(x.type){case"dashboard_by_id":throw new Error("invalid item (with id)");case"dashboard_by_uid":C.uid=[x.value];break;case"dashboard_by_tag":C.tags=[x.value];break}T.push({refId:`${S++}`,queryType:l.nj.Search,search:C})}if(!r.$.featureToggles.panelTitleSearch){const x=(0,h.getGrafanaSearcher)(),C=[];for(let O=0;O<T.length;O++){const R=(await x.search(T[O].search)).view;C.push({...E[O],dashboards:R.map(L=>({...L}))})}return C}const M=await(0,d.o)(),A=await(0,n.s)(M.query({targets:T}));if(A.data.length!==E.length)throw new Error("unexpected result size");return E.map((x,C)=>{const O=new a.R(A.data[C]);return{...x,dashboards:O.map(R=>({...R}))}})}function p(){return{items:[],interval:"5m",name:"",uid:""}}function v(E,S){return S?.length?(S=S.toLowerCase(),E.filter(T=>T.name.toLowerCase().includes(S))):E}function D(){return r.$.featureToggles.kubernetesPlaylists?new b:new u}},84684:(Q,I,e)=>{"use strict";e.d(I,{Ap:()=>b,Bj:()=>l,CB:()=>f,Gd:()=>u,T_:()=>d,XP:()=>g,cu:()=>c,ij:()=>y,xZ:()=>P});var n=e(36663),a=e(17172),o=e(80714),r=e(6745),i=e(5129);async function f(v){const D=await m(v),E=!!D,[S,T,M]=await Promise.all([u(),s(v,E),h(v)]),A=S.find(C=>C.id===v),x=A?.dependencies||D?.json?.dependencies;return{grafanaDependency:x?.grafanaDependency??x?.grafanaVersion??"",pluginDependencies:x?.plugins||[],links:A?.info.links||D?.json?.info.links||[],readme:M||D?.readme,versions:T,statusContext:D?.statusContext??"",iam:D?.json?.iam}}async function d(){try{const{items:v}=await(0,a.AI)().get(`${r.P5}/plugins`,{includeDeprecated:!0});return v.filter(i.hY)}catch(v){if((0,a.NF)(v))return v.isHandled=!0,console.error("Failed to fetch plugins from catalog (default https://grafana.com/api/plugins)"),[];throw v}}async function l(){try{return await(0,a.AI)().get(`${r.Sw}/errors`)}catch{return[]}}async function m(v){try{return await(0,a.AI)().get(`${r.P5}/plugins/${v}`,{})}catch(D){(0,a.NF)(D)&&(D.isHandled=!0);return}}async function s(v,D){try{return D?((await(0,a.AI)().get(`${r.P5}/plugins/${v}/versions`)).items||[]).map(S=>({version:S.version,createdAt:S.createdAt,isCompatible:S.isCompatible,grafanaDependency:S.grafanaDependency})):[]}catch(E){return(0,a.NF)(E)&&(E.isHandled=!0),[]}}async function h(v){try{const D=await(0,a.AI)().get(`${r.Sw}/${v}/markdown/README`);return D?(0,n.G)(D):""}catch(D){return(0,a.NF)(D)&&(D.isHandled=!0),""}}async function u(){return(await(0,a.AI)().get(`${r.Sw}`,(0,o.F)({embedded:0}))).filter(i.Sq)}async function b(){const{items:v}=await(0,a.AI)().get(`${r.Mi}/plugins`);return v}async function g(){const{items:v}=await(0,a.AI)().get(`${r.Mi}/provisioned-plugins`);return v.map(D=>({slug:D.type}))}async function P(v){return await(0,a.AI)().post(`${r.Sw}/${v}/install`,void 0,{showErrorAlert:!1})}async function c(v){return await(0,a.AI)().post(`${r.Sw}/${v}/uninstall`)}async function y(v,D){return(await(0,a.AI)().datasourceRequest({url:`/api/plugins/${v}/settings`,method:"POST",data:D}))?.data}const p={getRemotePlugins:d,getInstalledPlugins:u,installPlugin:P,uninstallPlugin:c}},42930:(Q,I,e)=>{"use strict";e.d(I,{G:()=>r});var n=e(32196),a=e(96540),o=e(40845);const r=({children:f,wrap:d,className:l})=>{const m=(0,o.$j)(),s=i(m,d);return a.createElement("div",{className:(0,n.cx)(s.container,l)},f)},i=(f,d)=>({container:(0,n.css)`
    display: flex;
    flex-direction: row;
    flex-wrap: ${d?"wrap":"no-wrap"};
    & > * {
      margin-bottom: ${f.spacing()};
      margin-right: ${f.spacing()};
    }
    & > *:last-child {
      margin-right: 0;
    }
  `})},31906:(Q,I,e)=>{"use strict";e.d(I,{a:()=>r});var n=e(96540),a=e(90613),o=e(39558);const r=({text:i="Loading..."})=>n.createElement(a.a,{display:"flex",alignItems:"center",direction:"column",justifyContent:"center",paddingTop:10},n.createElement(o._,{text:i}))},6745:(Q,I,e)=>{"use strict";e.d(I,{Mi:()=>a,P5:()=>o,Sw:()=>n,fu:()=>r});const n="/api/plugins",a="/api/instance",o="/api/gnet",r="plugins"},5129:(Q,I,e)=>{"use strict";e.d(I,{Gl:()=>S,H2:()=>c,N6:()=>M,Sq:()=>A,TD:()=>F,Xc:()=>p,by:()=>y,hY:()=>x,j_:()=>T,kH:()=>g,td:()=>h,tr:()=>E});var n=e(53076),a=e(43429),o=e(53531),r=e(32264),i=e(33378),f=e(2913),d=e(10096),l=e(27677),m=e(31678),s=e(66253);function h({local:K=[],remote:B=[],instance:w=[],provisioned:U=[],pluginErrors:W}){const V=[],_=v(W),H=w.reduce((j,Y)=>(j.set(Y.pluginSlug,Y),j),new Map),G=U.reduce((j,Y)=>(j.add(Y.slug),j),new Set);return K.forEach(j=>{const Y=B.find(se=>se.slug===j.id),oe=_[j.id];Y||V.push(u(j,void 0,oe))}),B.forEach(j=>{const Y=K.find(ne=>ne.id===j.slug),oe=_[j.slug];if(!(j.status===s.Uy.Deprecated&&!Y)){const ne=u(Y,j,oe);if(f.Ay.featureToggles.managedPluginsInstall&&r.$.pluginAdminExternalManageEnabled){ne.isFullyInstalled=ne.isCore?!0:(H.has(j.slug)||G.has(j.slug))&&ne.isInstalled,ne.isInstalled=H.has(j.slug)||ne.isInstalled;const ee=H.get(j.slug);ne.isUpdatingFromInstance=H.has(j.slug)&&ne.hasUpdate&&ne.installedVersion!==ee?.version,ee?.version&&ee?.version!==j.version&&(ne.hasUpdate=!0),ne.isUninstallingFromInstance=!!Y&&!H.has(j.slug)}V.push(ne)}}),V}function u(K,B,w){return!K&&B?b(B,w):K&&!B?g(K,w):P(K,B,w)}function b(K,B){const{name:w,slug:U,description:W,version:V,orgName:_,popularity:H,downloads:G,typeCode:j,updatedAt:Y,createdAt:oe,status:se,angularDetected:ne,keywords:ee}=K,Z=!!B||O(j);return{description:W,downloads:G,id:U,info:{logos:{small:`${r.$.appSubUrl}/api/gnet/plugins/${U}/versions/${V}/logos/small`,large:`${r.$.appSubUrl}/api/gnet/plugins/${U}/versions/${V}/logos/large`},keywords:ee},name:w,orgName:_,popularity:H,publishedAt:oe,signature:D({remote:K,error:B}),updatedAt:Y,hasUpdate:!1,isPublished:!0,isInstalled:Z,isDisabled:Z,isDeprecated:se===s.Uy.Deprecated,isCore:K.internal,isDev:!1,isEnterprise:se===s.Uy.Enterprise,type:j,error:B?.errorCode,angularDetected:ne,isFullyInstalled:Z}}function g(K,B){const{name:w,info:{description:U,version:W,logos:V,updated:_,author:H,keywords:G},id:j,dev:Y,type:oe,signature:se,signatureOrg:ne,signatureType:ee,hasUpdate:Z,accessControl:z,angularDetected:q}=K,ie=!!B||O(oe);return{description:U,downloads:0,id:j,info:{logos:V,keywords:G},name:w,orgName:H.name,popularity:0,publishedAt:"",signature:D({local:K,error:B}),signatureOrg:ne,signatureType:ee,updatedAt:_,installedVersion:W,hasUpdate:Z,isInstalled:!0,isDisabled:ie,isCore:se==="internal",isPublished:!1,isDeprecated:!1,isDev:!!Y,isEnterprise:!1,type:oe,error:B?.errorCode,accessControl:z,angularDetected:q,isFullyInstalled:!0,iam:K.iam}}function P(K,B,w){const U=K?.info.version,W=B?.slug||K?.id||"",V=K?.type||B?.typeCode,_=!!w||O(V),H=B?.keywords||K?.info.keywords||[];let G={small:`/public/img/icn-${V}.svg`,large:`/public/img/icn-${V}.svg`};return B?G={small:`${r.$.appSubUrl}/api/gnet/plugins/${W}/versions/${B.version}/logos/small`,large:`${r.$.appSubUrl}/api/gnet/plugins/${W}/versions/${B.version}/logos/large`}:K&&K.info.logos&&(G=K.info.logos),{description:K?.info.description||B?.description||"",downloads:B?.downloads||0,hasUpdate:K?.hasUpdate||!1,id:W,info:{logos:G,keywords:H},isCore:!!(B?.internal||K?.signature===a.Ac.internal),isDev:!!K?.dev,isEnterprise:B?.status===s.Uy.Enterprise,isInstalled:!!K||_,isDisabled:_,isDeprecated:B?.status===s.Uy.Deprecated,isPublished:!0,name:B?.name||K?.name||"",orgName:B?.orgName||K?.info.author.name||"",popularity:B?.popularity||0,publishedAt:B?.createdAt||"",type:V,signature:D({local:K,remote:B,error:w}),signatureOrg:K?.signatureOrg||B?.versionSignedByOrgName,signatureType:K?.signatureType||B?.versionSignatureType||B?.signatureType||void 0,updatedAt:B?.updatedAt||K?.info.updated||"",installedVersion:U,error:w?.errorCode,accessControl:K?.accessControl,angularDetected:K?.angularDetected??B?.angularDetected,isFullyInstalled:!!K||_,iam:K?.iam}}const c=K=>`${r.$.pluginCatalogURL}${K}`;var y=(K=>(K.nameAsc="nameAsc",K.nameDesc="nameDesc",K.updated="updated",K.published="published",K.downloads="downloads",K))(y||{});const p=(K,B)=>{const w={nameAsc:(U,W)=>U.name.localeCompare(W.name),nameDesc:(U,W)=>W.name.localeCompare(U.name),updated:(U,W)=>(0,o.b)(W.updatedAt).valueOf()-(0,o.b)(U.updatedAt).valueOf(),published:(U,W)=>(0,o.b)(W.publishedAt).valueOf()-(0,o.b)(U.publishedAt).valueOf(),downloads:(U,W)=>W.downloads-U.downloads};return w[B]?K.sort(w[B]):K};function v(K=[]){return K.reduce((B,w)=>(B[w.pluginId]=w,B),{})}function D(K){const{error:B,local:w,remote:U}=K;if(B)switch(B.errorCode){case a.ZK.invalidSignature:return a.Ac.invalid;case a.ZK.missingSignature:return a.Ac.missing;case a.ZK.modifiedSignature:return a.Ac.modified}return w?.signature?w.signature:U?.signatureType&&U?.versionSignatureType?a.Ac.valid:a.Ac.missing}const E=()=>(0,l.AI)().get("/api/frontend/settings").then(K=>{r.$.panels=K.panels});function S(K){if(!K)return;const[B]=K.filter(w=>!!w.isCompatible);return B}const T=()=>r.$.pluginAdminEnabled,M=(K,B,w)=>{const U=r.$.pluginAdminExternalManageEnabled,W=d.contextSrv.hasPermission(m.AccessControlAction.PluginsInstall),V=!!w;return K.type===a.QE.renderer||K.type===a.QE.secretsmanager||K.isEnterprise&&!(0,i.a)("enterprise.plugins")||K.isDev||!W&&!U||!K.isPublished||!V||!B},A=K=>C(K.id),x=K=>C(K.slug);function C(K){const{pluginCatalogHiddenPlugins:B}=r.$;return!B.includes(K)}function O(K){return K===a.QE.secretsmanager&&!r.$.secretsManagerPluginEnabled}function R(K){return K?.signature==="internal"}function L(K){return K.split(" - ")[0]}function N(K){return K.reduce((B,{id:w,name:U,type:W,orgName:V,info:_})=>{const H=_.keywords?.join(" ").toLowerCase(),G=`${w} - ${U} - ${W} - ${V} - ${H}`;return B.push(G),B},[])}function F(K,B){const w=N(K);let W=new n.A({intraMode:1,intraSub:0}).filter(w,B);return W===null?null:W.map(V=>L(w[V]))}},20701:(Q,I,e)=>{"use strict";e.d(I,{JC:()=>x,JJ:()=>p,LR:()=>y,NJ:()=>O,aU:()=>D,ai:()=>M,h9:()=>C,mj:()=>c,nT:()=>A,t5:()=>v,y7:()=>R});var n=e(65307),a=e(65474),o=e(62467),r=e(66847),i=e(45650),f=e(90593),d=e(75505),l=e(32264),m=e(17172),s=e(2913),h=e(15162),u=e(81900),b=e(84684),g=e(6745),P=e(5129);const c=(0,n.zD)(`${g.fu}/fetchAll`,async(L,N)=>{try{N.dispatch({type:`${g.fu}/fetchLocal/pending`}),N.dispatch({type:`${g.fu}/fetchRemote/pending`});const F=l.$.pluginAdminExternalManageEnabled&&s.Ay.featureToggles.managedPluginsInstall?(0,a.H)((0,b.Ap)()):(0,o.of)(void 0),K=l.$.pluginAdminExternalManageEnabled&&s.Ay.featureToggles.managedPluginsInstall?(0,a.H)((0,b.XP)()):(0,o.of)(void 0),B=500,w=(0,a.H)((0,b.Bj)()),U=(0,a.H)((0,b.Gd)()),W=(0,a.H)((0,b.T_)()).pipe((0,r.W)(V=>(N.dispatch({type:`${g.fu}/fetchRemote/rejected`}),console.error(V),(0,o.of)([]))));return(0,i.p)({local:U,remote:W,instance:F,provisioned:K,pluginErrors:w}).pipe((0,f.w)({each:B,with:()=>(W.subscribe(async V=>{if(N.dispatch({type:`${g.fu}/fetchRemote/fulfilled`}),V.length>0){const _=await(0,d.s)(U),H=await(0,d.s)(F),G=await(0,d.s)(K),j=await(0,d.s)(w);N.dispatch(D((0,P.td)({local:_,remote:V,instance:H,provisioned:G,pluginErrors:j})))}}),(0,i.p)({local:U,instance:F,provisioned:K,pluginErrors:w}))})).subscribe(({local:V,remote:_,instance:H,provisioned:G,pluginErrors:j})=>{V&&_?(N.dispatch({type:`${g.fu}/fetchLocal/fulfilled`}),N.dispatch({type:`${g.fu}/fetchRemote/fulfilled`}),N.dispatch(D((0,P.td)({local:V,remote:_,instance:H,provisioned:G,pluginErrors:j})))):V&&(N.dispatch({type:`${g.fu}/fetchLocal/fulfilled`}),N.dispatch(D((0,P.td)({local:V,pluginErrors:j}))))},V=>(console.log(V),N.dispatch({type:`${g.fu}/fetchLocal/rejected`}),N.dispatch({type:`${g.fu}/fetchRemote/rejected`}),N.rejectWithValue("Unknown error."))),null}catch{return N.rejectWithValue("Unknown error.")}}),y=(0,n.zD)(`${g.fu}/fetchAllLocal`,async(L,N)=>{try{return(await(0,b.Gd)()).map(K=>(0,P.kH)(K))}catch{return N.rejectWithValue("Unknown error.")}}),p=(0,n.zD)(`${g.fu}/fetchRemotePlugins`,async(L,N)=>{try{return await(0,b.T_)()}catch(F){return(0,m.NF)(F)&&(F.isHandled=!0),N.rejectWithValue([])}}),v=(0,n.zD)(`${g.fu}/fetchDetails`,async(L,N)=>{try{const F=await(0,b.CB)(L);return{id:L,changes:{details:F}}}catch{return N.rejectWithValue("Unknown error.")}}),D=(0,n.VP)(`${g.fu}/addPlugins`),E=(0,n.VP)(`${g.fu}/addLocalPlugins`),S=(0,n.VP)(`${g.fu}/addLocalPlugins`),T=(0,n.VP)(`${g.fu}/addLocalPlugins`),M=(0,n.zD)(`${g.fu}/install`,async({id:L,version:N,isUpdating:F=!1},K)=>{const B=F?{isInstalled:!0,installedVersion:N,hasUpdate:!1}:{isInstalled:!0,installedVersion:N};try{return await(0,b.xZ)(L),await(0,P.tr)(),F&&(0,u.sk)(L),{id:L,changes:B}}catch(w){return console.error(w),(0,m.NF)(w)?K.rejectWithValue(w.data):K.rejectWithValue("Unknown error.")}}),A=(0,n.zD)(`${g.fu}/install`,async()=>({})),x=(0,n.zD)(`${g.fu}/uninstall`,async(L,N)=>{try{return await(0,b.cu)(L),await(0,P.tr)(),(0,u.sk)(L),{id:L,changes:{isInstalled:!1,installedVersion:void 0}}}catch(F){return console.error(F),N.rejectWithValue("Unknown error.")}}),C=(0,n.zD)(`${g.fu}/loadPluginDashboards`,async(L,N)=>{const B=`api/plugins/${N.getState().dataSources.dataSource.type}/dashboards`;return(0,m.AI)().get(B)}),O=(0,n.VP)(`${g.fu}/panelPluginLoaded`),R=L=>async(N,F)=>{let K=F().plugins.panels[L];return K||(K=await(0,h.TV)(L),F().plugins.panels[L]||N(O(K))),K}},83391:(Q,I,e)=>{"use strict";e.d(I,{Tr:()=>V,A5:()=>W,wr:()=>N,m5:()=>L,PW:()=>E,F9:()=>M,ob:()=>S,xX:()=>A,XN:()=>F,pw:()=>O,Gp:()=>C,qG:()=>K,SQ:()=>x});var n=e(96540),a=e(31678),o=e(5129),r=e(20701),i=e(31326),f=e(25508),d=e(54479),l=e(14110),m=e(66253);const s=_=>_.plugins,h=(0,f.Mz)(s,({items:_})=>_),u=(0,f.Mz)(s,({settings:_})=>_.displayMode),{selectAll:b,selectById:g}=i.AI.getSelectors(h),P=_=>(0,f.Mz)(b,H=>{const G=_.keyword?(0,d.xb)(_.keyword.toLowerCase()):"",j=G!==""?(0,o.TD)(H,G):null;return G&&(0,l.rR)("plugins_search",{resultsCount:j?.length}),H.filter(Y=>!(G&&j==null||G&&!j?.includes(Y.id)||_.type&&Y.type!==_.type||_.isInstalled!==void 0&&Y.isInstalled!==_.isInstalled||_.isEnterprise!==void 0&&Y.isEnterprise!==_.isEnterprise))}),c=_=>(0,f.Mz)(b,H=>{const G=[];for(const j of H)j.error&&(!_||j.type===_)&&G.push({pluginId:j.id,errorCode:j.error,pluginType:j.type});return G}),y=_=>(0,f.Mz)(s,({requests:H={}})=>H[_]),p=_=>(0,f.Mz)(y(_),H=>H?.status===m.IZ.Pending),v=_=>(0,f.Mz)(y(_),H=>H?.status===m.IZ.Rejected?H?.error:null),D=_=>(0,f.Mz)(y(_),H=>H===void 0),E=(_,H=o.by.nameAsc)=>{B();const G=(0,n.useMemo)(()=>P(_),[_]),j=(0,a.useSelector)(G),{isLoading:Y,error:oe}=R(),se=(0,o.Xc)(j,H);return{isLoading:Y,error:oe,plugins:se}},S=_=>(B(),U(_),(0,a.useSelector)(H=>g(H,_))),T=_=>(w(),useSelector(H=>selectById(H,_))),M=_=>(B(),(0,a.useSelector)(c(_))),A=()=>{const _=(0,a.useDispatch)();return(H,G,j)=>_((0,r.ai)({id:H,version:G,isUpdating:j}))},x=()=>{const _=(0,a.useDispatch)();return()=>_((0,r.nT)())},C=()=>{const _=(0,a.useDispatch)();return H=>_((0,r.JC)(H))},O=()=>(0,a.useSelector)(v(r.JJ.typePrefix))===null,R=()=>{const _=(0,a.useSelector)(p("plugins/fetchLocal")),H=(0,a.useSelector)(v("plugins/fetchLocal"));return{isLoading:_,error:H}},L=()=>{const _=(0,a.useSelector)(p(r.mj.typePrefix)),H=(0,a.useSelector)(p("plugins/fetchLocal")),G=(0,a.useSelector)(p("plugins/fetchRemote")),j=_||H||G,Y=(0,a.useSelector)(v(r.mj.typePrefix));return{isLoading:j,error:Y}},N=()=>{const _=(0,a.useSelector)(p(r.t5.typePrefix)),H=(0,a.useSelector)(v(r.t5.typePrefix));return{isLoading:_,error:H}},F=()=>{const _=(0,a.useSelector)(p(r.ai.typePrefix)),H=(0,a.useSelector)(v(r.ai.typePrefix));return{isInstalling:_,error:H}},K=()=>{const _=(0,a.useSelector)(p(r.JC.typePrefix)),H=(0,a.useSelector)(v(r.JC.typePrefix));return{isUninstalling:_,error:H}},B=()=>{const _=(0,a.useDispatch)(),H=(0,a.useSelector)(D(r.mj.typePrefix));(0,n.useEffect)(()=>{H&&_((0,r.mj)())},[])},w=()=>{const _=useDispatch(),H=useSelector(selectIsRequestNotFetched(fetchAllLocal.typePrefix));useEffect(()=>{H&&_(fetchAllLocal())},[])},U=_=>{const H=(0,a.useDispatch)(),G=(0,a.useSelector)(oe=>g(oe,_)),Y=!(0,a.useSelector)(p(r.t5.typePrefix))&&G&&!G.details;(0,n.useEffect)(()=>{Y&&H((0,r.t5)(_))},[G])},W=()=>{const _=(0,a.useDispatch)();return H=>_((0,r.t5)(H))},V=()=>{const _=(0,a.useDispatch)();return{displayMode:(0,a.useSelector)(u),setDisplayMode:G=>_((0,i.qo)(G))}}},31326:(Q,I,e)=>{"use strict";e.d(I,{AI:()=>i,Ff:()=>b,qo:()=>u});var n=e(65307),a=e(6745),o=e(66253),r=e(20701);const i=(0,n.pU)(),f=g=>new RegExp(`${a.fu}/(.*)/pending`).test(g.type),d=g=>new RegExp(`${a.fu}/(.*)/fulfilled`).test(g.type),l=g=>new RegExp(`${a.fu}/(.*)/rejected`).test(g.type),m=g=>{const P=g.lastIndexOf("/");return g.substring(0,P)},s={items:i.getInitialState(),requests:{},settings:{displayMode:o.fy.Grid},plugins:[],errors:[],searchQuery:"",hasFetched:!1,dashboards:[],isLoadingPluginDashboards:!1,panels:{}},h=(0,n.Z0)({name:"plugins",initialState:s,reducers:{setDisplayMode(g,P){g.settings.displayMode=P.payload}},extraReducers:g=>g.addCase(r.aU,(P,c)=>{i.upsertMany(P.items,c.payload)}).addCase(r.LR.fulfilled,(P,c)=>{i.upsertMany(P.items,c.payload)}).addCase(r.t5.fulfilled,(P,c)=>{i.updateOne(P.items,c.payload)}).addCase(r.ai.fulfilled,(P,c)=>{i.updateOne(P.items,c.payload)}).addCase(r.JC.fulfilled,(P,c)=>{i.updateOne(P.items,c.payload)}).addCase(r.NJ,(P,c)=>{P.panels[c.payload.meta.id]=c.payload}).addCase(r.h9.pending,(P,c)=>{P.isLoadingPluginDashboards=!0,P.dashboards=[]}).addCase(r.h9.fulfilled,(P,c)=>{P.isLoadingPluginDashboards=!1,P.dashboards=c.payload}).addMatcher(f,(P,c)=>{P.requests[m(c.type)]={status:o.IZ.Pending}}).addMatcher(d,(P,c)=>{P.requests[m(c.type)]={status:o.IZ.Fulfilled}}).addMatcher(l,(P,c)=>{P.requests[m(c.type)]={status:o.IZ.Rejected,error:c.payload}})}),{setDisplayMode:u}=h.actions,b=h.reducer},66253:(Q,I,e)=>{"use strict";e.d(I,{IZ:()=>l,Ip:()=>o,LZ:()=>d,Uy:()=>r,fy:()=>n,og:()=>f,u8:()=>i,vk:()=>a});var n=(m=>(m.Grid="grid",m.List="list",m))(n||{}),a=(m=>(m.Home="plugins-home",m.Browse="plugins-browse",m.Details="plugins-details",m))(a||{}),o=(m=>(m.app="apps",m.datasource="database",m.panel="credit-card",m.renderer="capture",m.secretsmanager="key-skeleton-alt",m))(o||{}),r=(m=>(m.Deleted="deleted",m.Active="active",m.Pending="pending",m.Deprecated="deprecated",m.Enterprise="enterprise",m))(r||{}),i=(m=>(m.INSTALL="INSTALL",m.UNINSTALL="UNINSTALL",m.UPDATE="UPDATE",m.REINSTALL="REINSTALL",m))(i||{}),f=(m=>(m.OVERVIEW="Overview",m.VERSIONS="Version history",m.CONFIG="Config",m.DASHBOARDS="Dashboards",m.USAGE="Usage",m.IAM="IAM",m))(f||{}),d=(m=>(m.OVERVIEW="overview",m.VERSIONS="version-history",m.CONFIG="config",m.DASHBOARDS="dashboards",m.USAGE="usage",m.IAM="iam",m))(d||{}),l=(m=>(m.Pending="Pending",m.Fulfilled="Fulfilled",m.Rejected="Rejected",m))(l||{})},74106:(Q,I,e)=>{"use strict";e.d(I,{c:()=>f});var n=e(96540),a=e(43429),o=e(14110),r=e(42418);function i(d,l){let m;switch(d){case a.QE.app:m="app plugin";break;case a.QE.panel:m="panel plugin";break;case a.QE.datasource:m="data source plugin";break;default:m="plugin"}let s=`This ${m} uses a deprecated, legacy platform based on AngularJS and `;return l===void 0?s+" may be incompatible depending on your Grafana configuration.":l?s+" will stop working in future releases of Grafana.":s+" is incompatible with your current Grafana configuration."}function f(d){const{className:l,angularSupportEnabled:m,pluginId:s,pluginType:h,showPluginDetailsLink:u,interactionElementId:b}=d,[g,P]=(0,n.useState)(!1),c={};return s&&(c.pluginId=s),b&&(c.elementId=b),g?null:n.createElement(r.F,{severity:"warning",title:"Angular plugin",className:l,onRemove:()=>P(!0)},n.createElement("p",null,i(h,m)),n.createElement("div",{className:"markdown-html"},n.createElement("ul",null,n.createElement("li",null,n.createElement("a",{href:"https://grafana.com/docs/grafana/latest/developers/angular_deprecation/",className:"external-link",target:"_blank",rel:"noreferrer",onClick:()=>{(0,o.rR)("angular_deprecation_docs_clicked",c)}},"Read our deprecation notice and migration advice.")),u&&s?n.createElement("li",null,n.createElement("a",{href:`plugins/${encodeURIComponent(s)}`,className:"external-link",target:"_blank",rel:"noreferrer"},"View plugin details")):null)))}},8480:(Q,I,e)=>{"use strict";e.d(I,{Hv:()=>r,mz:()=>i});var n=e(32264);function a(f){return Object.values(n.$.datasources).find(d=>d.uid===f)??null}function o(f){return a(f)?.meta.angular?.detected??!1}function r(f){const d=a(f);return(d?.meta.angular?.detected&&!d?.meta.angular.hideDeprecation)??!1}const i=new Set(["autoMigrateOldPanels","autoMigrateGraphPanel","autoMigrateTablePanel","autoMigratePiechartPanel","autoMigrateWorldmapPanel","autoMigrateStatPanel","disableAngular"])},72798:(Q,I,e)=>{"use strict";e.d(I,{A:()=>a,S:()=>r});var n=e(96540);const a=n.createContext(o());a.displayName="PluginPageContext";function o(){return{sectionNav:{main:{text:"Plugin page"},node:{text:"Plugin page"}}}}function r(i){return{sectionNav:i??o().sectionNav}}},10803:(Q,I,e)=>{"use strict";e.d(I,{p:()=>r});var n=e(96540),a=e(43429),o=e(39938);const r=f=>{const d=i(f.state);return d?n.createElement(o.E,{className:f.className,color:d.color,title:d.tooltip,text:d.text,icon:d.icon}):null};function i(f){switch(f){case a.pn.deprecated:return{text:"Deprecated",color:"red",tooltip:"This feature is deprecated and will be removed in a future release"};case a.pn.alpha:return{text:"Alpha",color:"blue",tooltip:"This feature is experimental and future updates might not be backward compatible"};case a.pn.beta:return{text:"Beta",color:"blue",tooltip:"This feature is close to complete but not fully tested"};default:return null}}},31193:(Q,I,e)=>{"use strict";e.d(I,{tR:()=>y,xq:()=>g});var n=e(40187),a=e(26272),o=e(80147),r=e(72574),i=e(81634),f=e(17172),d=e(19347),l=e(26657),m=e(28138),s=e(2913),h=e(53478),u=e(66718),b=e(54427);class g{constructor(v=(0,r.w)()){this.templateSrv=v,this.datasources={},this.settingsMapByName={},this.settingsMapByUid={},this.settingsMapById={},this.defaultName=""}init(v,D){this.datasources={},this.settingsMapByUid={},this.settingsMapByName=v,this.defaultName=D;for(const E of Object.values(v))E.uid||(E.uid=E.name),this.settingsMapByUid[E.uid]=E,this.settingsMapById[E.id]=E;this.datasources[l.dR.type]=h.Ex,this.datasources[u.Uj]=h.Ex,this.settingsMapByUid[l.dR.uid]=h.$i,this.settingsMapByUid[u.Uj]=h.$i}getDataSourceSettingsByUid(v){return this.settingsMapByUid[v]}getInstanceSettings(v,D){let E=P(v);if((0,l.s9)(E))return h.$i;if(E==="default"||E==null)return this.settingsMapByUid[this.defaultName]??this.settingsMapByName[this.defaultName];if(E[0]==="$"){const S=this.templateSrv.replace(E,D,c);let T;return S==="default"?T=this.settingsMapByName[this.defaultName]:T=this.settingsMapByUid[S]??this.settingsMapByName[S],T?{...T,isDefault:!1,name:E,uid:E,rawRef:{type:T.type,uid:T.uid}}:void 0}return this.settingsMapByUid[E]??this.settingsMapByName[E]??this.settingsMapById[E]}get(v,D){let E=P(v);if(!E)return this.get(this.defaultName);if((0,l.s9)(v))return Promise.resolve(this.datasources[u.Uj]);const S=this.settingsMapByName[E];return S&&(E=S.uid),this.datasources[E]?Promise.resolve(this.datasources[E]):(E=this.templateSrv.replace(E,D,c),E==="default"&&this.defaultName!=="default"?this.get(this.defaultName):this.datasources[E]?Promise.resolve(this.datasources[E]):this.loadDatasource(E))}async loadDatasource(v){if(this.datasources[v])return Promise.resolve(this.datasources[v]);const D=this.getInstanceSettings(v);if(!D)return Promise.reject({message:`Datasource ${v} was not found`});try{const E=await(0,b.cS)(D.meta);if(this.datasources[v])return this.datasources[v];const S=E.DataSourceClass.length!==1;let T;if(S?T=(0,i.C)().instantiate(E.DataSourceClass,{instanceSettings:D}):T=new E.DataSourceClass(D),T.components=E.components,!(T instanceof n.mA)){const M=T;M.name=D.name,M.id=D.id,M.type=D.type,M.meta=D.meta,M.uid=D.uid,T.getRef=n.mA.prototype.getRef}return this.datasources[v]=T,this.datasources[T.uid]=T,T}catch(E){return E instanceof Error&&m.A.emit(a.r1.alertError,[D.name+" plugin failed",E.toString()]),Promise.reject({message:`Datasource: ${v} was not found`})}}getAll(){return Object.values(this.settingsMapByName)}getList(v={}){const D=Object.values(this.settingsMapByName).filter(S=>!(S.meta.id==="grafana"||S.meta.id==="mixed"||S.meta.id==="dashboard"||v.metrics&&!S.meta.metrics||v.tracing&&!S.meta.tracing||v.logs&&S.meta.category!=="logging"&&!S.meta.logs||v.annotations&&!S.meta.annotations||v.alerting&&!S.meta.alerting||v.pluginId&&!(0,o._)(v.pluginId,S.meta)||v.filter&&!v.filter(S)||v.type&&(Array.isArray(v.type)?!v.type.includes(S.type):v.type!==S.type)||!v.all&&S.meta.metrics!==!0&&S.meta.annotations!==!0&&S.meta.tracing!==!0&&S.meta.logs!==!0&&S.meta.alerting!==!0));if(v.variables)for(const S of this.templateSrv.getVariables()){if(S.type!=="datasource")continue;let T=S.current.value==="default"?this.defaultName:S.current.value;Array.isArray(T)&&(T=T[0]);const M=!Array.isArray(T)&&(this.settingsMapByName[T]||this.settingsMapByUid[T]);if(M){const A=`\${${S.name}}`;D.push({...M,isDefault:!1,name:A,uid:A})}}const E=D.sort((S,T)=>S.name.toLowerCase()>T.name.toLowerCase()?1:S.name.toLowerCase()<T.name.toLowerCase()?-1:0);if(!v.pluginId&&!v.alerting){if(v.mixed){const S=this.getInstanceSettings("-- Mixed --");S&&D.push(S)}if(v.dashboard){const S=this.getInstanceSettings("-- Dashboard --");S&&D.push(S)}if(!v.tracing){const S=this.getInstanceSettings("-- Grafana --");S&&D.push(S)}}return E}getExternal(){return this.getList()}getAnnotationSources(){return this.getList({annotations:!0,variables:!0}).map(v=>({name:v.name,value:v.name,meta:v.meta}))}getMetricSources(v){return this.getList({metrics:!0,variables:!v?.skipVariables}).map(D=>({name:D.name,value:D.name,meta:D.meta}))}async reload(){const v=await(0,f.AI)().get("/api/frontend/settings");s.Ay.datasources=v.datasources,s.Ay.defaultDatasource=v.defaultDatasource,this.init(v.datasources,v.defaultDatasource)}}function P(p){return(0,l.s9)(p)?l.dR.uid:typeof p=="string"?p:p?.uid}function c(p){return Array.isArray(p)?p[0]:p}const y=()=>(0,d.l)()},75462:(Q,I,e)=>{"use strict";e.d(I,{$Y:()=>M,FF:()=>b,N9:()=>L,WW:()=>c,io:()=>C,nv:()=>v,ol:()=>E,pL:()=>R,yS:()=>P,yb:()=>p,yt:()=>S,z1:()=>g});var n=e(32196),a=e(2543),o=e.n(a),r=e(96540),i=e(16817),f=e(74135),d=e(13834),l=e(47232),m=e(37390),s=e(28138),h=e(27716),u=e(28444);function b(N){console.warn(`[Plugin Extensions] ${N}`)}function g(N){return typeof N=="object"&&"type"in N&&N.type===f.u.link}function P(N){return typeof N=="object"&&"type"in N&&N.type===f.u.component}function c(N){return typeof N=="object"&&"type"in N&&N.type===f.u.component&&N.extensionPointId.startsWith("capabilities/")}function y(N,F=""){return(...K)=>{try{return N(...K)}catch(B){B instanceof Error&&console.warn(`${F}${B.message}`)}}}function p(N,F){return{openModal:async B=>{const{title:w,body:U,width:W,height:V}=B;s.A.publish(new u.S8({component:v(N,D({title:w,body:U,width:W,height:V}))}))},context:F}}const v=(N,F)=>B=>{const{error:w,loading:U,value:W}=(0,i.A)(()=>(0,h.x)(N,{showErrorAlert:!1}));return U?null:w?(b(`Could not fetch plugin meta information for "${N}", aborting. (${w.message})`),null):W?r.createElement(d.a,{meta:W},r.createElement(F,{...B})):(b(`Fetched plugin meta information is empty for "${N}", aborting.`),null)},D=({title:N,body:F,width:K,height:B})=>{const w=(0,n.css)({width:K,height:B});return({onDismiss:W})=>r.createElement(m.a,{title:N,className:w,isOpen:!0,onDismiss:W,onClickBackdrop:W},r.createElement(F,{onDismiss:W}))};function E(N,F=new Map){if(!N||typeof N!="object"||Object.isFrozen(N))return N;const K=Array.isArray(N)?[...N]:{...N};if(F.has(N))return F.get(N);F.set(N,K);const B=Reflect.ownKeys(K);for(const w of B){const U=Array.isArray(K)?K[Number(w)]:K[w];U&&(typeof U=="object"||typeof U=="function")&&(Array.isArray(K)?K[Number(w)]=E(U,F):K[w]=E(U,F))}return Object.freeze(K)}function S(N,F){const K=`${N}${F.extensionPointId}${F.title}`;return Array.from(K).reduce((B,w)=>Math.imul(31,B)+w.charCodeAt(0)|0,0).toString()}const T=Symbol("isReadOnlyProxy");function M(N){if(!N||typeof N!="object"||x(N))return N;const F=new WeakMap;return new Proxy(N,{defineProperty:()=>!1,deleteProperty:()=>!1,isExtensible:()=>!1,set:()=>!1,get(K,B,w){if(B===T)return!0;const U=Reflect.get(K,B,w);return(0,l.Ar)(U)?(0,l.KQ)(U):(0,a.isObject)(U)||(0,a.isArray)(U)?(F.has(U)||F.set(U,M(U)),F.get(U)):U}})}function A(N){return typeof N=="object"&&N!==null}function x(N){return A(N)&&N[T]===!0}function C(N){const F={type:f.u.link,...N};return O(F),F}function O(N){if(N.type!==f.u.link)throw Error("config is not a extension link")}function R(N,F){return N.length<F?N:`${N.slice(0,F-3).trimEnd()}...`}function L(N){const F={},K=[];for(const w of N){const U=w.category;if(!U){K.push({text:R(w.title,25),href:w.path,onClick:w.onClick});continue}Array.isArray(F[U])||(F[U]=[]),F[U].push({text:R(w.title,25),href:w.path,onClick:w.onClick})}const B=Object.keys(F).reduce((w,U)=>(w.push({text:R(U,25),type:"group",subMenu:F[U]}),w),[]);return K.length>0&&(B.length>0&&B.push({text:"divider",type:"divider"}),Array.prototype.push.apply(B,K)),B}},15162:(Q,I,e)=>{"use strict";e.d(I,{Kk:()=>s,PY:()=>h,TV:()=>d,d4:()=>m,f7:()=>g,oZ:()=>l});var n=e(65158),a=e(2913),o=e(41394),r=e(54427);const i={},f={};function d(P){const c=i[P];if(c)return c;const y=m(P);if(!y)throw new Error(`Plugin ${P} not found`);return i[P]=u(y),P!==y.type&&(i[y.type]=i[P]),i[P]}function l(P){return!!m(P)}function m(P){const c=a.Ay.panels[P];if(!c){for(const y of Object.values(a.Ay.panels))if(y.aliasIDs?.includes(P))return y}return c}function s(P){return u(P)}function h(P){return f[P]}function u(P){return(0,r.j4)({path:P.module,version:P.info?.version,isAngular:P.angular?.detected,pluginId:P.id}).then(c=>{if(c.plugin)return c.plugin;if(c.PanelCtrl){const y=new n.m(null);return y.angularPanelCtrl=c.PanelCtrl,y}throw new Error("missing export: plugin or PanelCtrl")}).then(c=>(c.meta=P,f[P.id]=c,!c.panel&&c.angularPanelCtrl&&(c.panel=b(c)),c)).catch(c=>(console.warn("Error loading panel plugin: "+P.id,c),(0,o.W)(P,c)))}let b=P=>null;function g(P){b=P}},81900:(Q,I,e)=>{"use strict";e.d(I,{GD:()=>r,QO:()=>d,ni:()=>f,sk:()=>i});var n=e(27716),a=e(45179);const o={};function r({pluginId:m,version:s,isAngular:h}){const u=m;u&&!o[u]&&(o[u]={version:encodeURI(s),isAngular:h,pluginId:m})}function i(m){const s=m;o[s]&&delete o[s],(0,n.o)(m)}function f(m,s=a.x8){const h=l(m);if(!h)return`${m}?_cache=${s}`;const b=o[h]?.version||s;return`${m}?_cache=${b}`}function d(m){const s=l(m);if(s)return o[s]}function l(m){const s=Object.keys(o).find(h=>m.includes(h));if(s)return s}},45179:(Q,I,e)=>{"use strict";e.d(I,{$b:()=>a,Bu:()=>o,XV:()=>n,x8:()=>r});const n="package",a=/^plugins.+\.css$/i,o=/^(text|application)\/(x-)?javascript(;|$)/,r=Date.now()},63770:(Q,I,e)=>{"use strict";e.d(I,{z:()=>d});var n=e(59511),a=e.n(n),o=e(65024),r=e.n(o),i=e(35135),f=e.n(i);const d=window.System},94429:(Q,I,e)=>{"use strict";e.d(I,{kB:()=>h,OD:()=>u,Av:()=>b});var n=e(32264),a=e(66161),o=e(45179),r=e(34867);const i=new WeakMap,f={};function d(g,P,c){const y={get(p,v){if(document.currentScript===null&&typeof v!="symbol"&&v.toString()!=="__useDefault"){const E=`${P}.${String(v)}`,S=`${E}`;f[S]||(f[S]=!0,(0,r.fH)(`Plugin using ${E}`,{key:String(v),parent:P,packageName:c}))}let D=Reflect.get(p,v);return D!==null&&typeof D=="object"&&!(D instanceof RegExp)?(i.has(D)||i.set(D,d(D,`${P}.${String(v)}`,c)),i.get(D)):(typeof D=="function"&&(D=D.bind(p)),D)}};return typeof g=="object"&&g!==null?new Proxy(g,y):g}const l=/^(@grafana|app\/)/;function m(g,P){return l.test(P)?d(g,P,P):g}var s=e(63770);function h(g){return Object.keys(g).reduce((P,c)=>{const y=`${o.XV}:${c}`,p=n.$.featureToggles.pluginsAPIMetrics?m(g[c],c):g[c];return s.z.set(y,p),a.s.set(c,g[c]),P[c]=y,P},{})}function u(g){return!!n.$.pluginsCDNBaseURL&&g.startsWith(n.$.pluginsCDNBaseURL)}function b(g){return g.startsWith("http")||g.startsWith("/")?g:`${n.$.appSubUrl??""}/${g}`}},27716:(Q,I,e)=>{"use strict";e.d(I,{o:()=>r,x:()=>o});var n=e(17172);const a={};function o(i,f){const d=a[i];return d?Promise.resolve(d):(0,n.AI)().get(`/api/plugins/${i}/settings`,void 0,void 0,f).then(l=>(a[i]=l,l)).catch(l=>typeof l=="object"&&l!==null&&"status"in l&&l.status===403?(l.isHandled=!0,Promise.reject(l)):Promise.reject(new Error("Unknown Plugin")))}const r=i=>i?delete a[i]:Object.keys(a).forEach(f=>delete a[f])},54427:(Q,I,e)=>{"use strict";e.d(I,{ui:()=>jg,cS:()=>Gg,j4:()=>Nd});var n={};e.r(n),e.d(n,{plugin:()=>un});var a={};e.r(a),e.d(a,{plugin:()=>Rn});var o={};e.r(o),e.d(o,{plugin:()=>ps});var r={};e.r(r),e.d(r,{plugin:()=>At});var i={};e.r(i),e.d(i,{plugin:()=>Ri});var f={};e.r(f),e.d(f,{plugin:()=>Ks});var d={};e.r(d),e.d(d,{plugin:()=>Cm});var l={};e.r(l),e.d(l,{plugin:()=>Ec});var m={};e.r(m),e.d(m,{plugin:()=>Rm});var s={};e.r(s),e.d(s,{plugin:()=>wm});var h={};e.r(h),e.d(h,{plugin:()=>zm});var u={};e.r(u),e.d(u,{plugin:()=>Cc});var b={};e.r(b),e.d(b,{plugin:()=>Eu});var g={};e.r(g),e.d(g,{plugin:()=>rf});var P={};e.r(P),e.d(P,{plugin:()=>Ou});var c={};e.r(c),e.d(c,{plugin:()=>Bu});var y={};e.r(y),e.d(y,{plugin:()=>Kf});var p={};e.r(p),e.d(p,{plugin:()=>Al});var v={};e.r(v),e.d(v,{plugin:()=>El});var D={};e.r(D),e.d(D,{plugin:()=>yd});var E={};e.r(E),e.d(E,{plugin:()=>Bc});var S={};e.r(S),e.d(S,{plugin:()=>vg});var T={};e.r(T),e.d(T,{plugin:()=>Jr});var M=e(40187),A=e(41987),x=e(32264),C=e(96540),O=e(65158),R=e(67061),L=e(55852),N=e(85242),F=e(51612),K=e(31678),B=e(57220),w=e(2543),U=e.n(w),W=e(21594),V=e(14578),_=e(61410),H=e(23770),G=e(88467),j=e(94822),Y=e(75214);const oe=J=>{const{onChange:Ee,id:Ce,defaultValue:Fe,dataSource:He}=J,it=(0,K.useDispatch)();(0,C.useEffect)(()=>{He?He&&it((0,H.mB)({rulesSourceName:He})):it((0,H.nV)())},[it,He]);const vt=(0,_.$)(ln=>ln.promRules),Nt=(0,G.p0)(vt),kt=(0,G.Vf)(vt),Zt=(0,C.useMemo)(()=>{if((0,w.isEmpty)(vt))return[];if(!Nt)return[];const ln=Object.keys(vt).flatMap(bn=>vt[bn].result??[]).flatMap(bn=>bn.groups).flatMap(bn=>bn.rules.filter(Nn=>Nn.type===j.JS.Alerting)).flatMap(bn=>bn.alerts??[]).map(bn=>Object.keys(bn.labels??{})).flatMap(bn=>bn.filter(Nn=>!(0,Y.F2)(Nn)));return(0,w.uniq)(ln)},[Nt,vt]);return C.createElement(W.KF,{id:Ce,isLoading:kt,defaultValue:Fe,"aria-label":"group by label keys",placeholder:"Group by",prefix:C.createElement(V.I,{name:"tag-alt"}),onChange:ln=>{Ee(ln.map(bn=>bn.value??""))},options:Zt.map(ln=>({label:ln,value:ln}))})};var se=e(32196),ne=e(42941),ee=e(94701),Z=e(3591),z=e(40845),q=e(40276),ie=e(37494),de=e(39558),ue=e(42418),fe=e(2913),Se=e(55907),he=e(79938),ce=e(75648),me=e(9518),pe=e(98164),ye=e(55740),Pe=e(23662),Ie=e(14792),Oe=e(19073),Ne=e(64861),We=e(15458),Ae=e(55127),Ue=e.n(Ae),Me=e(2426),$e=e(56361),ke=e(15054),Ze=e(54317);function ot(J,Ee){const Ce=(0,pe.J$)(J);return(0,pe.Av)(Ee,Ce)}function xt(J,Ee){const{stateFilter:Ce,alertInstanceLabelFilter:Fe}=J;return(0,w.isEmpty)(Ce)?Ee:Ee.filter(He=>(Ce.firing&&((0,Ze.S)(He,j.Gi.Alerting)||(0,Ze.S)(He,j.cF.Firing))||Ce.pending&&((0,Ze.S)(He,j.Gi.Pending)||(0,Ze.S)(He,j.cF.Pending))||Ce.noData&&(0,Ze.S)(He,j.Gi.NoData)||Ce.normal&&(0,Ze.S)(He,j.Gi.Normal)||Ce.error&&(0,Ze.S)(He,j.Gi.Error)||Ce.inactive&&(0,Ze.S)(He,j.cF.Inactive))&&(Fe?ot(J.alertInstanceLabelFilter,He.labels):!0))}const ct=({rule:J,alerts:Ee,options:Ce,grafanaTotalInstances:Fe,handleInstancesLimit:He,limitInstances:it,grafanaFilteredInstancesTotal:vt})=>{const Nt=Ce.groupMode===Ne.r6.Custom?!0:Ce.showInstances,[kt,Zt]=(0,C.useState)(Nt),ln=(0,z.of)(ft),bn=(0,z.of)(L.my),Nn=(0,C.useCallback)(()=>{Zt(ar=>!ar)},[]),mn=(0,C.useMemo)(()=>xt(Ce,(0,$e.Cp)(Ce.sortOrder,Ee))??[],[Ee,Ce]),Wn=Fe!==void 0,ba=Fe&&vt?Fe-vt:0,oa=Ee.length-mn.length,da=Wn?ba:oa,Xn=mn.length>0,Gn=Xn?Nn:w.noop;(0,C.useEffect)(()=>{mn.length===0&&Zt(!1)},[mn]);const ea=async()=>{He&&(He(!1),Zt(!0))},qa=async()=>{He&&(He(!0),Zt(!0))},Wa=it?vt:mn.length,Ka=mn.length,Ta=Wn?Wa:Ka,aa=it?`Showing ${ce.Ys} of ${Fe} instances`:`Showing all ${Fe} instances`,Ha=it?"View all instances":`Limit the result to ${ce.Ys} instances`,Ma=Fe&&ce.Ys===mn.length&&Fe>mn.length,Oa=Fe&&ce.Ys<mn.length&&!it,Hs=Ma||Oa?C.createElement("div",{className:ln.footerRow},C.createElement("div",null,aa),C.createElement(L.$n,{size:"sm",variant:"secondary",onClick:it?ea:qa},Ha)):void 0;return C.createElement("div",null,Ce.groupMode===Ne.r6.Default&&C.createElement("button",{className:(0,se.cx)(bn,Xn?ln.clickable:""),onClick:()=>Gn()},Xn&&C.createElement(V.I,{name:kt?"angle-down":"angle-right",size:"md"}),C.createElement("span",null,`${Ta} ${Ue()("instance",Ta)}`),da>0&&C.createElement("span",null,", ",`${da} hidden by filters`)),kt&&C.createElement(Me.D,{rule:J,instances:mn,pagination:{itemsPerPage:2*ke.FG},footerRow:Hs}))},ft=J=>({clickable:(0,se.css)`
    cursor: pointer;
  `,footerRow:(0,se.css)`
    display: flex;
    flex-direction: column;
    gap: ${J.spacing(1)};
    justify-content: space-between;
    align-items: center;
    width: 100%;
  `}),Le="__ungrouped__",re=({rules:J,options:Ee})=>{const Ce=(0,z.of)(en),Fe=Ee.groupBy,He=(0,C.useMemo)(()=>{const it=new Map,vt=Zt=>Fe?be(Zt,Fe):!0;J.forEach(Zt=>{const ln=(0,Pe.TU)(Zt),bn=vt(Zt);(ln?.alerts??[]).forEach(Nn=>{const mn=bn?X(Fe,Nn.labels):Le,Wn=it.get(mn)?.alerts??[];it.set(mn,{rule:Zt,alerts:[...Wn,Nn]})})});const Nt=it.get(Le)?.alerts??[];return it.delete(Le),it.set(Le,{alerts:Nt}),Array.from(it.entries()).reduce((Zt,[ln,{rule:bn,alerts:Nn}])=>{const mn=xt(Ee,Nn);return mn.length>0&&Zt.set(ln,{rule:bn,alerts:mn}),Zt},new Map)},[Fe,J,Ee]);return C.createElement(C.Fragment,null,Array.from(He).map(([it,{rule:vt,alerts:Nt}])=>C.createElement("li",{className:Ce.alertRuleItem,key:it,"data-testid":it},C.createElement("div",null,C.createElement("div",{className:Ce.customGroupDetails},C.createElement("div",{className:Ce.alertLabels},it!==Le&&le(it).map(([kt,Zt])=>C.createElement(We.R,{key:kt,labelKey:kt,value:Zt})),it===Le&&"No grouping")),C.createElement(ct,{rule:vt,alerts:Nt,options:Ee})))))};function X(J,Ee){return new URLSearchParams(J.map(Ce=>[Ce,Ee[Ce]])).toString()}function le(J){return[...new URLSearchParams(J)]}function be(J,Ee){const Ce=(0,Pe.TU)(J);return Ee.every(Fe=>(Ce?.alerts??[]).some(He=>He.labels[Fe]))}const De=re;var Te=e(87586),we=e(70416),Ke=e(26058),Ve=e(18461),ht=e(3704);function gt(J){return Object.values(J).filter(Ee=>Ee!==void 0).reduce((Ee,Ce)=>Ee+Ce,0)}const bt=({rules:J,options:Ee,handleInstancesLimit:Ce,limitInstances:Fe,hideViewRuleLinkText:He})=>{const it=(0,z.of)(en),vt=(0,z.of)(St),{href:Nt}=(0,Te.A)(),kt=J.length<=Ee.maxItems?J:J.slice(0,Ee.maxItems);return C.createElement(C.Fragment,null,C.createElement("ol",{className:it.alertRuleList},kt.map((Zt,ln)=>{const{namespaceName:bn,groupName:Nn,dataSourceName:mn}=Zt,Wn=(0,Pe.Z8)(Zt.promRule)?Zt.promRule:void 0,ba=(0,Pe.Om)(Wn),oa=(0,Ve.UP)(Zt.dataSourceName,Zt),da=(0,Ve.$9)(oa),Xn=Zt.dataSourceName===B.hY?gt(Zt.instanceTotals):void 0,Gn=Zt.dataSourceName===B.hY?gt(Zt.filteredInstanceTotals):void 0,ea=(0,ht.c)(`/alerting/${encodeURIComponent(mn)}/${encodeURIComponent(da)}/view`,{returnTo:Nt??""});return Wn?C.createElement("li",{className:it.alertRuleItem,key:`alert-${bn}-${Nn}-${Zt.name}-${ln}`},C.createElement("div",{className:vt.icon},C.createElement(V.I,{name:Se.A.getStateDisplayModel(Wn.state).iconClass,className:vt[(0,Pe.Wy)(Wn.state)],size:"lg"})),C.createElement("div",{className:it.alertNameWrapper},C.createElement("div",{className:it.instanceDetails},C.createElement(R.B,{direction:"row",gap:1},C.createElement("div",{className:it.alertName,title:Zt.name},Zt.name),C.createElement(Ke.h,null),ea&&C.createElement("a",{href:ea,target:"__blank",className:it.link,rel:"noopener","aria-label":"View alert rule"},C.createElement("span",{className:(0,se.cx)({[it.hidden]:He})},"View alert rule"),C.createElement(V.I,{name:"external-link-alt",size:"sm"}))),C.createElement("div",{className:it.alertDuration},C.createElement("span",{className:vt[(0,Pe.Wy)(Wn.state)]},(0,Pe.XI)(Wn.state))," ",ba&&Wn.state!==j.cF.Inactive&&C.createElement(C.Fragment,null,"for"," ",C.createElement("span",null,(0,we.dU)({start:ba,end:Date.now()}))))),C.createElement(ct,{rule:Zt,alerts:Wn.alerts??[],options:Ee,grafanaTotalInstances:Xn,grafanaFilteredInstancesTotal:Gn,handleInstancesLimit:Ce,limitInstances:Fe}))):null})))},St=J=>({common:(0,se.css)`
    width: 70px;
    text-align: center;
    align-self: stretch;

    display: inline-block;
    color: white;
    border-radius: ${J.shape.radius.default};
    font-size: ${J.typography.bodySmall.fontSize};
    text-transform: capitalize;
    line-height: 1.2;
    flex-shrink: 0;

    display: flex;
    flex-direction: column;
    justify-content: center;
  `,icon:(0,se.css)`
    margin-top: ${J.spacing(2.5)};
    align-self: flex-start;
  `,good:(0,se.css)`
    color: ${J.colors.success.main};
  `,bad:(0,se.css)`
    color: ${J.colors.error.main};
  `,warning:(0,se.css)`
    color: ${J.colors.warning.main};
  `,neutral:(0,se.css)`
    color: ${J.colors.secondary.main};
  `,info:(0,se.css)`
    color: ${J.colors.primary.main};
  `}),Je=bt;function rt(J){const Ee=(Ce,[Fe,He])=>He?[...Ce,Fe]:Ce;return Object.entries(J).reduce(Ee,[])}const Rt=({dispatch:J,limitInstances:Ee,matcherList:Ce,dataSourceName:Fe,stateList:He})=>{J(Fe?(0,H.Lc)({rulesSourceName:Fe,limitAlerts:Ee?ce.Ys:void 0,matcher:Ce,state:He}):(0,H.yo)(!1,{limitAlerts:Ee?ce.Ys:void 0,matcher:Ce,state:He}))};function _t(J){const Ee=(0,K.useDispatch)(),[Ce,Fe]=(0,ne.A)(!0),[,He]=(0,Oe.Ej)(Oe.RY.ViewAlertRule),{usePrometheusRulesByNamespaceQuery:it}=he.hK,vt=(0,_.$)(rs=>rs.promRules),Nt=(0,_.$)(rs=>rs.rulerRules),kt=(0,G.t4)(vt),Zt=J.width<320;(0,C.useEffect)(()=>{J.options.stateFilter.inactive===!0&&(J.options.stateFilter.normal=!0),J.options.stateFilter.inactive=void 0},[J.options.stateFilter]);let ln;(0,ee.A)(()=>{ln=(0,Ie.UA)().getCurrent()});const bn=(0,C.useMemo)(()=>rt(J.options.stateFilter),[J.options.stateFilter]),{options:Nn,replaceVariables:mn}=J,Wn=Nn.datasource===B.vv?B.hY:Nn.datasource,ba={...J.options,alertName:mn(Nn.alertName),alertInstanceLabelFilter:mn(Nn.alertInstanceLabelFilter)},oa=(0,C.useMemo)(()=>(0,pe.J$)(ba.alertInstanceLabelFilter),[ba.alertInstanceLabelFilter]),da=(!Wn||Wn===B.hY)&&He,{currentData:Xn=[],isLoading:Gn,refetch:ea}=it({limitAlerts:Ce?ce.Ys:void 0,matcher:oa,state:bn},{skip:!da});(0,C.useEffect)(()=>{vt.loading||Rt({dispatch:Ee,limitInstances:Ce,matcherList:oa,dataSourceName:Wn,stateList:bn});const rs=ln?.events.subscribe(Z.sR,()=>{da&&ea(),(!Wn||Wn!==B.hY)&&Rt({dispatch:Ee,limitInstances:Ce,matcherList:oa,dataSourceName:Wn,stateList:bn})});return()=>{rs?.unsubscribe()}},[Ee,ln,oa,bn,Ce,Wn,ea,da,vt.loading]);const qa=rs=>{rs?(Rt({dispatch:Ee,limitInstances:Ce,matcherList:oa,dataSourceName:Wn,stateList:bn}),Fe(!0)):(Rt({dispatch:Ee,limitInstances:!1,matcherList:oa,dataSourceName:Wn,stateList:bn}),Fe(!1))},Wa=(0,me.dy)(void 0,Xn),Ka=(0,G.t4)(Nt),Ta=(0,G.BU)(vt),aa=kt||Ka,Ha=(0,G.Vf)(vt),Ma=(0,z.of)(en),Oa=(0,Pe.dS)(Wa),Hs=J.options.sortOrder,ar=(0,C.useMemo)(()=>Kt(J,nn(Hs,Oa)),[Oa,Hs,J]),er=ar.length===0?"No alerts matching filters":void 0,As=Gn||aa&&Ha&&!Ta,bs=Object.values(vt).some(rs=>rs.result);return C.createElement(q.E,{autoHeightMin:"100%",autoHeightMax:"100%"},C.createElement("div",{className:Ma.container},bs&&er&&C.createElement("div",{className:Ma.noAlertsMessage},er),bs&&C.createElement("section",null,J.options.viewMode===Ne.nE.Stat&&C.createElement(ie.yV,{width:J.width,height:J.height,graphMode:ie.$p.None,textMode:ie.SV.Auto,justifyMode:ie.F8.Auto,theme:fe.config.theme2,value:{text:`${ar.length}`,numeric:ar.length}}),J.options.viewMode===Ne.nE.List&&J.options.groupMode===Ne.r6.Custom&&C.createElement(De,{rules:ar,options:ba}),J.options.viewMode===Ne.nE.List&&J.options.groupMode===Ne.r6.Default&&C.createElement(Je,{rules:ar,options:ba,handleInstancesLimit:qa,limitInstances:Ce,hideViewRuleLinkText:Zt})),As&&C.createElement(de._,{text:"Loading..."})))}function nn(J,Ee){if(J===Ne.xB.Importance)return(0,w.sortBy)(Ee,Fe=>Se.A.alertStateSortScore[Fe.state]);if(J===Ne.xB.TimeAsc)return(0,w.sortBy)(Ee,Fe=>{const He=(0,Pe.TU)(Fe)??void 0;return(0,Pe.Om)(He)||new Date});if(J===Ne.xB.TimeDesc)return(0,w.sortBy)(Ee,Fe=>{const He=(0,Pe.TU)(Fe)??void 0;return(0,Pe.Om)(He)||new Date}).reverse();const Ce=(0,w.sortBy)(Ee,Fe=>Fe.name.toLowerCase());return J===Ne.xB.AlphaDesc&&Ce.reverse(),Ce}function Kt(J,Ee){const{options:Ce,replaceVariables:Fe}=J;let He=[...Ee];if(Ce.dashboardAlerts){const it=(0,Ie.UA)().getCurrent()?.uid;He=He.filter(({annotations:vt={}})=>Object.entries(vt).some(([Nt,kt])=>Nt===ye.YH.dashboardUID&&kt===it))}if(Ce.alertName){const it=Fe(Ce.alertName);He=He.filter(({name:vt})=>vt.toLocaleLowerCase().includes(it.toLocaleLowerCase()))}if(He=He.filter(it=>{const vt=(0,Pe.TU)(it);return vt?Ce.stateFilter.firing&&vt.state===j.cF.Firing||Ce.stateFilter.pending&&vt.state===j.cF.Pending||Ce.stateFilter.normal&&vt.state===j.cF.Inactive:!1}),Ce.folder&&(He=He.filter(it=>it.namespaceName===Ce.folder.title)),Ce.datasource){const it=Ce.datasource===B.vv;He=He.filter(it?({dataSourceName:vt})=>vt===B.hY:({dataSourceName:vt})=>vt===Ce.datasource)}return He=He.reduce((it,vt)=>{const Nt=(0,Pe.TU)(vt);return(Nt?xt({stateFilter:Ce.stateFilter,alertInstanceLabelFilter:Fe(Ce.alertInstanceLabelFilter)},Nt.alerts??[]):[]).length&&it.push(vt),it},[]),He}const en=J=>({cardContainer:(0,se.css)`
    padding: ${J.spacing(.5)} 0 ${J.spacing(.25)} 0;
    line-height: ${J.typography.body.lineHeight};
    margin-bottom: 0px;
  `,container:(0,se.css)`
    overflow-y: auto;
    height: 100%;
  `,alertRuleList:(0,se.css)`
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    list-style-type: none;
  `,alertRuleItem:(0,se.css)`
    display: flex;
    align-items: center;
    width: 100%;
    height: 100%;
    background: ${J.colors.background.secondary};
    padding: ${J.spacing(.5)} ${J.spacing(1)};
    border-radius: ${J.shape.radius.default};
    margin-bottom: ${J.spacing(.5)};

    gap: ${J.spacing(2)};
  `,alertName:(0,se.css)`
    font-size: ${J.typography.h6.fontSize};
    font-weight: ${J.typography.fontWeightBold};

    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  `,alertNameWrapper:(0,se.css)`
    display: flex;
    flex: 1;
    flex-wrap: nowrap;
    flex-direction: column;

    min-width: 100px;
  `,alertLabels:(0,se.css)`
    > * {
      margin-right: ${J.spacing(.5)};
    }
  `,alertDuration:(0,se.css)`
    font-size: ${J.typography.bodySmall.fontSize};
  `,alertRuleItemText:(0,se.css)`
    font-weight: ${J.typography.fontWeightBold};
    font-size: ${J.typography.bodySmall.fontSize};
    margin: 0;
  `,alertRuleItemTime:(0,se.css)`
    color: ${J.colors.text.secondary};
    font-weight: normal;
    white-space: nowrap;
  `,alertRuleItemInfo:(0,se.css)`
    font-weight: normal;
    flex-grow: 2;
    display: flex;
    align-items: flex-end;
  `,noAlertsMessage:(0,se.css)`
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
  `,alertIcon:(0,se.css)`
    margin-right: ${J.spacing(.5)};
  `,instanceDetails:(0,se.css)`
    min-width: 1px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  `,customGroupDetails:(0,se.css)`
    margin-bottom: ${J.spacing(.5)};
  `,link:(0,se.css)`
    word-break: break-all;
    color: ${J.colors.primary.text};
    display: flex;
    align-items: center;
    gap: ${J.spacing(1)};
  `,hidden:(0,se.css)`
    display: none;
  `});function Qt(J){const[,Ee]=(0,Oe.Ej)(Oe.RY.ViewAlertRule),[,Ce]=(0,Oe.Ej)(Oe.RY.ViewExternalAlertRule);return!Ee&&!Ce?C.createElement(ue.F,{title:"Permission required"},"Sorry, you do not have the required permissions to read alert rules"):C.createElement(_t,{...J})}const un=new O.m(Qt).setPanelOptions(J=>{J.addRadio({path:"viewMode",name:"View mode",description:"Toggle between list view and stat view",defaultValue:Ne.nE.List,settings:{options:[{label:"List",value:Ne.nE.List},{label:"Stat",value:Ne.nE.Stat}]},category:["Options"]}).addRadio({path:"groupMode",name:"Group mode",description:"How alert instances should be grouped",defaultValue:Ne.r6.Default,settings:{options:[{value:Ne.r6.Default,label:"Default grouping"},{value:Ne.r6.Custom,label:"Custom grouping"}]},category:["Options"]}).addCustomEditor({path:"groupBy",name:"Group by",description:"Filter alerts using label querying",id:"groupBy",defaultValue:[],showIf:Ee=>Ee.groupMode===Ne.r6.Custom,category:["Options"],editor:Ee=>C.createElement(oe,{id:Ee.id??"groupBy",defaultValue:Ee.value.map(Ce=>({label:Ce,value:Ce})),onChange:Ee.onChange,dataSource:Ee.context.options.datasource})}).addNumberInput({name:"Max items",path:"maxItems",description:"Maximum alerts to display",defaultValue:20,category:["Options"]}).addSelect({name:"Sort order",path:"sortOrder",description:"Sort order of alerts and alert instances",settings:{options:[{label:"Alphabetical (asc)",value:Ne.xB.AlphaAsc},{label:"Alphabetical (desc)",value:Ne.xB.AlphaDesc},{label:"Importance",value:Ne.xB.Importance},{label:"Time (asc)",value:Ne.xB.TimeAsc},{label:"Time (desc)",value:Ne.xB.TimeDesc}]},defaultValue:Ne.xB.AlphaAsc,category:["Options"]}).addBooleanSwitch({path:"dashboardAlerts",name:"Alerts linked to this dashboard",description:"Only show alerts linked to this dashboard",defaultValue:!1,category:["Options"]}).addTextInput({path:"alertName",name:"Alert name",description:"Filter for alerts containing this text",defaultValue:"",category:["Filter"]}).addTextInput({path:"alertInstanceLabelFilter",name:"Alert instance label",description:'Filter alert instances using label querying, ex: {severity="critical", instance=~"cluster-us-.+"}',defaultValue:"",category:["Filter"]}).addCustomEditor({path:"datasource",name:"Datasource",description:"Filter from alert source",id:"datasource",defaultValue:null,editor:function(Ce){return C.createElement(R.B,{gap:1},C.createElement(F.s,{...Ce,type:["prometheus","loki","grafana"],noDefault:!0,current:Ce.value,onChange:Fe=>Ce.onChange(Fe.name)}),C.createElement(L.$n,{variant:"secondary",onClick:()=>Ce.onChange(null)},"Clear"))},category:["Filter"]}).addCustomEditor({showIf:Ee=>Ee.datasource===B.vv||!Ee.datasource,path:"folder",name:"Folder",description:"Filter for alerts in the selected folder (only for Grafana alerts)",id:"folder",defaultValue:null,editor:function(Ce){return C.createElement(N.sR,{enableReset:!0,showRoot:!1,allowEmpty:!0,initialTitle:Ce.value?.title,initialFolderUid:Ce.value?.uid,permissionLevel:K.PermissionLevelString.View,onClear:()=>Ce.onChange(""),...Ce})},category:["Filter"]}).addBooleanSwitch({path:"stateFilter.firing",name:"Alerting / Firing",defaultValue:!0,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.pending",name:"Pending",defaultValue:!0,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.noData",name:"No Data",defaultValue:!1,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.normal",name:"Normal",defaultValue:!1,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.error",name:"Error",defaultValue:!0,category:["Alert state filter"]})});var fn=e(79924),Tt=e(64423),$t=e(71733),Yt=e(26272),Cn=e(69129),Tn=e(47232),vn=e(12131),Kn=e(17172),Yn=e(64149),nt=e(3911),yt=e(85918),Vt=e(28138),je=e(10860),tt=e(44522),Dt=e(56034);const Ot=({options:J,annotation:Ee,formatDate:Ce,onClick:Fe,onAvatarClick:He,onTagClick:it})=>{const vt=(0,z.of)(hn),{showUser:Nt,showTags:kt,showTime:Zt}=J,{text:ln="",login:bn,email:Nn,avatarUrl:mn,tags:Wn,time:ba,timeEnd:oa}=Ee,da=()=>{Fe(Ee)},Xn=()=>{He(Ee)},Gn=bn&&Nt,ea=ba&&Zt,qa=oa&&oa!==ba&&Zt;return C.createElement(je.Z,{className:vt.card,onClick:da},C.createElement(je.Z.Heading,null,C.createElement(tt.I,{className:vt.heading,onClick:Wa=>{Wa.stopPropagation()},content:ln})),ea&&C.createElement(je.Z.Description,{className:vt.timestamp},C.createElement(Gt,{formatDate:Ce,time:ba}),qa&&C.createElement(C.Fragment,null,C.createElement("span",{className:vt.time},"-"),C.createElement(Gt,{formatDate:Ce,time:oa})," ")),Gn&&C.createElement(je.Z.Meta,{className:vt.meta},C.createElement(Lt,{email:Nn,login:bn,avatarUrl:mn,onClick:Xn})),kt&&Wn&&C.createElement(je.Z.Tags,null,C.createElement(Yn.L,{tags:Wn,onClick:Wa=>it(Wa,!1)})))},Lt=({onClick:J,avatarUrl:Ee,login:Ce,email:Fe})=>{const He=(0,z.of)(hn),it=Nt=>{Nt.stopPropagation(),J()},vt=C.createElement("span",null,"Created by:",C.createElement("br",null)," ",Fe);return C.createElement(Dt.m,{content:vt,theme:"info",placement:"top"},C.createElement("button",{onClick:it,className:He.avatar},C.createElement("img",{src:Ee,alt:"avatar icon"})))},Gt=({time:J,formatDate:Ee})=>{const Ce=(0,z.of)(hn);return C.createElement("span",{className:Ce.time},C.createElement("span",null,Ee(J)))};function hn(J){return{card:(0,se.css)({gridTemplateAreas:'"Heading Description Meta Tags"',gridTemplateColumns:"auto 1fr auto auto",padding:J.spacing(1),margin:J.spacing(.5),width:"inherit"}),heading:(0,se.css)({a:{zIndex:1,position:"relative",color:J.colors.text.link,"&:hover":{textDecoration:"underline"}}}),meta:(0,se.css)({margin:0,position:"relative",justifyContent:"end"}),timestamp:(0,se.css)({margin:0,alignSelf:"center"}),time:(0,se.css)({marginLeft:J.spacing(1),marginRight:J.spacing(1),fontSize:J.typography.bodySmall.fontSize,color:J.colors.text.secondary}),avatar:(0,se.css)({border:"none",background:"inherit",margin:0,padding:J.spacing(.5),img:{borderRadius:J.shape.radius.circle,width:J.spacing(2),height:J.spacing(2)}})}}class mt extends C.PureComponent{constructor(Ee){super(Ee),this.style=Bt(x.$.theme2),this.subs=new Tt.yU,this.tagListRef=C.createRef(),this.onAnnoClick=async Ce=>{if(!Ce.time)return;const{options:Fe}=this.props,it=(0,Ie.UA)().getCurrent(),vt={from:this._timeOffset(Ce.time,Fe.navigateBefore,!0),to:this._timeOffset(Ce.timeEnd??Ce.time,Fe.navigateAfter,!1),viewPanel:Fe.navigateToPanel&&Ce.panelId?Ce.panelId:void 0};if(!Ce.dashboardUID||it?.uid===Ce.dashboardUID){vn.Ny.partial(vt);return}const Nt=await(0,Kn.AI)().get("/api/search",{dashboardUIDs:Ce.dashboardUID});if(Nt&&Nt.length&&Nt[0].uid===Ce.dashboardUID){const kt=Nt[0],Zt=new URL(kt.url,window.location.origin);Zt.searchParams.set("from",String(vt.from)),Zt.searchParams.set("to",String(vt.to)),vn.Ny.push($t.I.stripBaseFromUrl(Zt.toString()));return}Vt.A.emit(Yt.r1.alertWarning,["Unknown Dashboard: "+Ce.dashboardUID])},this.onTagClick=(Ce,Fe)=>{if(!Fe&&this.state.queryTags.includes(Ce))return;const He=Fe?this.state.queryTags.filter(vt=>vt!==Ce):[...this.state.queryTags,Ce];let it;if(Fe){const vt=document.activeElement,Nt=vt?.getAttribute("data-tag-id");if(this.tagListRef.current?.contains(vt)&&Nt){const kt=Number.parseInt(Nt,10),Zt=this.tagListRef.current.querySelector(`[data-tag-id="${kt+1}"]`)??this.tagListRef.current.querySelector(`[data-tag-id="${kt-1}"]`);Zt instanceof HTMLElement&&(it=Zt)}}this.setState({queryTags:He},()=>it?.focus())},this.onUserClick=Ce=>{this.setState({queryUser:{id:Ce.userId,login:Ce.login,email:Ce.email}})},this.onClearUser=()=>{this.setState({queryUser:void 0})},this.renderItem=(Ce,Fe)=>{const{options:He}=this.props,it=(0,Ie.UA)().getCurrent();return it?C.createElement(Ot,{annotation:Ce,formatDate:it.formatDate,onClick:this.onAnnoClick,onAvatarClick:this.onUserClick,onTagClick:this.onTagClick,options:He}):C.createElement(C.Fragment,null)},this.state={annotations:[],timeInfo:"",loaded:!1,queryTags:[]}}componentDidMount(){this.doSearch(),this.subs.add(this.props.eventBus.getStream(Cn.We).subscribe({next:()=>{this.doSearch()}}))}componentWillUnmount(){this.subs.unsubscribe()}componentDidUpdate(Ee,Ce){const{options:Fe,timeRange:He}=this.props;(Fe!==Ee.options||this.state.queryTags!==Ce.queryTags||this.state.queryUser!==Ce.queryUser||Ee.renderCounter!==this.props.renderCounter||Fe.onlyInTimeRange&&He!==Ee.timeRange)&&this.doSearch()}async doSearch(){const{options:Ee}=this.props,{queryUser:Ce,queryTags:Fe}=this.state,He={tags:Ee.tags,limit:Ee.limit,type:"annotation"};Ee.onlyFromThisDashboard&&(He.dashboardUID=(0,Ie.UA)().getCurrent()?.uid);let it="";if(Ee.onlyInTimeRange){const{timeRange:Nt}=this.props;He.from=Nt.from.valueOf(),He.to=Nt.to.valueOf()}else it="All Time";Ce&&(He.userId=Ce.id),Ee.tags&&Ee.tags.length&&(He.tags=Ee.tags.map(Nt=>this.props.replaceVariables(Nt))),Fe.length&&(He.tags=He.tags?[...He.tags,...Fe]:Fe);const vt=await(0,Kn.AI)().get("/api/annotations",He,`anno-list-panel-${this.props.id}`);this.setState({annotations:vt,timeInfo:it,loaded:!0})}_timeOffset(Ee,Ce,Fe=!1){let He=5,it="m";const vt=/^(\d+)(\w)/.exec(Ce);vt&&vt.length===3&&(He=parseInt(vt[1],10),it=vt[2]);const Nt=(0,Tn.KQ)(Ee);return Fe&&(He*=-1),Nt.add(He,it).valueOf()}render(){const{loaded:Ee,annotations:Ce,queryUser:Fe,queryTags:He}=this.state;if(!Ee)return C.createElement("div",null,"loading...");const it=Fe||He.length>0;return C.createElement(q.E,{autoHeightMin:"100%"},it&&C.createElement("div",{className:this.style.filter},C.createElement("b",null,"Filter:"),Fe&&C.createElement(L.$n,{size:"sm",variant:"secondary",fill:"text",onClick:this.onClearUser,"aria-label":`Remove filter: ${Fe.email}`},Fe.email),He.length>0&&C.createElement(Yn.L,{icon:"times",tags:He,onClick:vt=>this.onTagClick(vt,!0),getAriaLabel:vt=>`Remove ${vt} tag`,className:this.style.tagList,ref:this.tagListRef})),Ce.length<1&&C.createElement("div",{className:this.style.noneFound},"No Annotations Found"),C.createElement(yt.p,{items:Ce,renderItem:this.renderItem,getItemKey:vt=>`${vt.id}`}))}}const Bt=(0,nt.N)(J=>({noneFound:(0,se.css)({display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"calc(100% - 30px)"}),filter:(0,se.css)({alignItems:"center",display:"flex",flexWrap:"wrap",gap:J.spacing(.5),padding:J.spacing(.5)}),tagList:(0,se.css)({justifyContent:"flex-start","li > button":{paddingLeft:"3px"}})})),Jt={limit:10,navigateAfter:"10m",navigateBefore:"10m",navigateToPanel:!0,onlyFromThisDashboard:!1,onlyInTimeRange:!1,showTags:!0,showTime:!0,showUser:!0,tags:[]},Rn=new O.m(mt).setPanelOptions(J=>{J.addRadio({category:["Annotation query"],path:"onlyFromThisDashboard",name:"Query filter",defaultValue:Jt.onlyFromThisDashboard,settings:{options:[{value:!1,label:"All dashboards"},{value:!0,label:"This dashboard"}]}}).addRadio({category:["Annotation query"],path:"onlyInTimeRange",name:"Time range",defaultValue:Jt.onlyInTimeRange,settings:{options:[{value:!1,label:"None"},{value:!0,label:"This dashboard"}]}}).addCustomEditor({category:["Annotation query"],id:"tags",path:"tags",name:"Tags",description:"Match annotation tags",editor(Ee){return C.createElement(fn.u,{tags:Ee.value,onChange:Ee.onChange})}}).addNumberInput({category:["Annotation query"],path:"limit",name:"Limit",defaultValue:Jt.limit}).addBooleanSwitch({category:["Display"],path:"showUser",name:"Show user",defaultValue:Jt.showUser}).addBooleanSwitch({category:["Display"],path:"showTime",name:"Show time",defaultValue:Jt.showTime}).addBooleanSwitch({category:["Display"],path:"showTags",name:"Show tags",defaultValue:Jt.showTags}).addRadio({category:["Link behavior"],path:"navigateToPanel",name:"Link target",defaultValue:Jt.navigateToPanel,settings:{options:[{value:!0,label:"Panel"},{value:!1,label:"Dashboard"}]}}).addTextInput({category:["Link behavior"],path:"navigateBefore",name:"Time before",defaultValue:Jt.navigateBefore,description:""}).addTextInput({category:["Link behavior"],path:"navigateAfter",name:"Time after",defaultValue:Jt.navigateAfter,description:""})}).setPanelChangeHandler((J,Ee,Ce)=>Ee==="ryantxu-annolist-panel"?Ce:J.options);var Mt=e(37055),wt=e(24293),Ht=e(27310),tn=e(47070),It=e(11261),Xe=e(52622),jn=e(52198),Qn=e(38248),ia=e(11404),wn=e(89654),sa=e(22680),La=e(71242),xa=e(24882),ga=e(97152),Ts=e(29413),Us=e(30501),Bs=e(67266),ks=e(81297),Ms=e(77455),Dr=e(22731),_s=e(8066),Ir=e(96516),Xs=e(16895),Gs=e(28895);function Br(J,Ee){return Ee[0].fields.slice(1).some(Ce=>!Ce.config.custom?.hideFrom?.legend)}const Mr=C.memo(({data:J,placement:Ee,calcs:Ce,displayMode:Fe,colorField:He,...it})=>{const vt=(0,z.$j)();if(He!=null){const kt=(0,Gs.jY)([He],vt);if(kt?.length)return C.createElement(Bs.KU.Legend,{placement:Ee},C.createElement(Ir.t,{placement:Ee,items:kt,displayMode:Fe}))}const Nt=J[0].fields.slice(1).map((kt,Zt)=>{const bn=Zt+1;if(!kt||kt.config.custom?.hideFrom?.legend)return;const Nn=kt.state?.displayName??kt.name,mn=(0,_s.lz)(kt,vt).color;return{disabled:kt.state?.hideFrom?.viz,color:mn,label:Nn,yAxis:kt.config.custom?.axisPlacement===Xe.vM.Right?2:1,getDisplayValues:()=>(0,Xs.UO)(Ce,kt,vt),getItemKey:()=>`${Nn}-0-${bn}`}}).filter(kt=>kt!==void 0);return C.createElement(Bs.KU.Legend,{placement:Ee,...it},C.createElement(Ir.t,{placement:Ee,items:Nt,displayMode:Fe,sortBy:it.sortBy,sortDesc:it.sortDesc,isSortable:!0}))});Mr.displayName="BarChartLegend";var vr=e(36613),fr=e(28240),js=e(73060),to=e(57875),Ar=e(83195),Ko=e(73134),no=e(51336),vo=e(52811),ao=e(82915),Do=e(42994),Xr=e(72724),mo=e(23596),qr=e(39758),Po=e(4134);const jr=Do.WC.interval,Io=qr.ur,$o=qr.ur,qo=8,lo=30,Vo=.65,Co=.1,zo=.15,So=5,si=10,Yo=.1;function ri(J,Ee,Ce,Fe,He){const it=(0,Ts.kD)(J,14),vt=Ee/(it.width+2)*14,Nt=Ce/Fe,kt=Math.min(Nt,vt);return{fontSize:Math.min(kt,He??kt),textMetrics:it}}function Ao(J,Ee){const{xOri:Ce,xDir:Fe,rawValue:He,getColor:it,formatValue:vt,formatShortValue:Nt,fillOpacity:kt=1,showValue:Zt,xSpacing:ln=0,hoverMulti:bn=!1,timeZone:Nn="browser"}=J,mn=Ce===Xe.Lt.Horizontal,Wn=!J.text?.valueSize,ba=J.stacking!==Xe.gs.None,oa=J.stacking===Xe.gs.Percent;let{groupWidth:da,barWidth:Xn,barRadius:Gn=0}=J;ba&&([da,Xn]=[Xn,da]);let ea;const Wa=Array(30).fill(null);let Ka;const Ta=ja=>Array.from(ja.data[0].map((Va,us)=>us)),aa=ln===0?void 0:(ja,Va)=>{const us=ja.bbox.width,tr=Fe*(mn?1:-1);let zs=Va.length,rr=zs-1,mr=0,ho=us/vr.A.pxRatio,Wr=Math.abs(Math.floor(ho/ln));mr=zs<Wr?0:Math.ceil(zs/Wr);let Cl=Va.map((vi,il)=>mr!==0&&(ln>0?il:rr-il)%mr>0?null:vi);return tr===1?Cl:Cl.reverse()},Ha=(ja,Va,us,tr,zs)=>{if(J.xTimeAuto){let rr=jr.year;return zs<Us.Zj.second?rr=jr.millisecond:zs<Us.Zj.minute?rr=jr.second:zs<Us.Zj.hour?rr=jr.minute:zs<Us.Zj.day?rr=jr.hour:zs<Us.Zj.month?rr=jr.day:zs<Us.Zj.year?rr=jr.month:rr=jr.year,Va.map(mr=>mr==null?"":(0,Xr.LE)(mr,{format:rr,timeZone:Nn}))}return Va.map(rr=>mn?Nt(0,rr):vt(0,rr))},Ma=(ja,Va,us)=>{Va=0,us=Math.max(1,ja.data[0].length-1);let tr=0;(0,qr.mn)(ja.data[0].length,da,Io,0,(rr,mr,ho)=>{tr=mr+ho/2});let zs=us-Va;if(tr===.5)Va-=zs;else{let mr=(1/(1-tr*2)*zs-zs)/2;Va-=mr,us+=mr}return[Va,us]};let Oa=(ja,Va)=>{let us=Array.from({length:Va},()=>({offs:Array(ja).fill(0),size:Array(ja).fill(0)}));return(0,qr.mn)(ja,da,Io,null,(tr,zs,rr)=>{(0,qr.mn)(Va,Xn,$o,null,(mr,ho,Wr)=>{us[mr].offs[tr]=zs+rr*ho,us[mr].size[tr]=rr*Wr})}),us},Hs=(ja,Va)=>{let us=Array.from({length:Va},()=>({offs:Array(ja).fill(0),size:Array(ja).fill(0)}));return(0,qr.mn)(ja,da,Io,null,(tr,zs,rr)=>{(0,qr.mn)(Va,Xn,$o,null,(mr,ho,Wr)=>{us[mr].offs[tr]=zs,us[mr].size[tr]=rr})}),us};const ar=mn?Co:zo,er=mn?So:si;let As=[],bs=[],rs=1,Zs,hr=J.text?.valueSize??lo,Vr=er,gs=1/0,os=1/0,Ja=it!=null,Es=Ja?{fill:{unit:3,values:(ja,Va)=>bs[Va].fill},stroke:{unit:3,values:(ja,Va)=>bs[Va].stroke}}:{},sr=vr.A.paths.bars({radius:oa?0:ba?(ja,Va)=>Va===ja.data.length-1?[Gn,0]:[0,0]:Gn,disp:{x0:{unit:2,values:(ja,Va)=>As[Va].offs},size:{unit:2,values:(ja,Va)=>As[Va].size},...Es},each:(ja,Va,us,tr,zs,rr,mr)=>{tr-=ja.bbox.left,zs-=ja.bbox.top;let ho=ja.data[Va][us];mn?(gs=Math.min(gs,ho<0?ja.bbox.height-(zs+mr):zs),os=rr):(gs=mr,os=Math.min(os,ho<0?tr:ja.bbox.width-(tr+rr)));let Wr={x:tr,y:zs,w:rr,h:mr,sidx:Va,didx:us};if(!ba&&J.fullHighlight&&(J.xOri===Xe.Lt.Horizontal?(Wr.y=0,Wr.h=ja.bbox.height):(Wr.x=0,Wr.w=ja.bbox.width)),ea.add(Wr),Zt!==Xe.yL.Never){const Cl=He(Va,us);let vi=1;oa&&zr[Va][us]&&(vi=zr[Va][us]);const il=vi===0?0:Cl/vi,gc=vt(Va,il);if(Vr=Math.min(Vr,Math.round(ar*(mn?rr:mr))),Zs[us]===void 0&&(Zs[us]={}),Zs[us][Va]={text:gc,value:He(Va,us),hidden:!1},Wn){const{fontSize:Yi,textMetrics:Kl}=ri(Zs[us][Va].text,os*(mn?Vo:1)-(mn?0:Vr),gs*(mn?1:Vo)-(mn?Vr:0),1);Zs[us][Va].textMetrics=Kl;let Qo=Math.round(Math.min(hr,lo,Yi));rs=Qo/hr*(Qo/14),hr=Qo}else Zs[us][Va].textMetrics=(0,Ts.kD)(Zs[us][Va].text,hr);let Wl=mn?0:-Math.round(Yo*hr),Mi=He(Va,us);if(J.negY?.[Va]&&Mi!=null&&(Mi*=-1),Mi!=null){const Yi=ja.bbox.left+(mn?tr+rr/2:Mi<0?tr-Vr:tr+rr+Vr),Kl=ja.bbox.top+(mn?Mi<0?zs+mr+Vr:zs-Vr:zs+mr/2-Wl),{textMetrics:Qo={width:1,actualBoundingBoxAscent:1,actualBoundingBoxDescent:1}}=Zs[us][Va];let pc=0,wd=0;mn?(pc=Qo.width*rs/2,wd=Mi>0?(Qo.actualBoundingBoxAscent+Qo.actualBoundingBoxDescent)*rs:0):(wd=(Qo.actualBoundingBoxAscent+Qo.actualBoundingBoxDescent)*rs/2,pc=Mi<0?Qo.width*rs:0),Zs[us][Va].x=Yi,Zs[us][Va].y=Kl,Zs[us][Va].bbox={x:Yi-pc,y:Kl-wd,w:Qo.width*rs,h:(Qo.actualBoundingBoxAscent+Qo.actualBoundingBoxDescent)*rs}}}}});const cr=ja=>{ja.root.querySelectorAll(".u-cursor-pt").forEach(Va=>{Va.style.borderRadius="0",J.fullHighlight&&(Va.style.zIndex="-1")})},xr={x:!1,y:!1,drag:{x:!1,y:!1},dataIdx:(ja,Va)=>{if(Va===0){Wa.fill(null),Ka=null;let us=ja.cursor.left*vr.A.pxRatio,tr=ja.cursor.top*vr.A.pxRatio;ea.get(us,tr,1,1,zs=>{(0,Po.ur)(us,tr,zs.x,zs.y,zs.x+zs.w,zs.y+zs.h)&&(Ka=Wa[0]=zs,Wa[Ka.sidx]=Ka,bn&&(0,Po.Tr)(ea,void 0,Ka.didx).forEach(rr=>{Wa[rr.sidx]=rr}))})}return Wa[Va]?.didx},points:{fill:"rgba(255,255,255,0.4)",bbox:(ja,Va)=>{let us=Wa[Va],tr=us!=null;return{left:tr?us.x/vr.A.pxRatio:-10,top:tr?us.y/vr.A.pxRatio:-10,width:tr?us.w/vr.A.pxRatio:0,height:tr?us.h/vr.A.pxRatio:0}}},focus:{prox:1e3,dist:(ja,Va)=>Ka?.sidx===Va?0:1/0}},dr=ja=>{if(ea=ea||new Po.C$(0,0,ja.bbox.width,ja.bbox.height),ea.clear(),ja.series.forEach(Va=>{Va._paths=null}),ba?As=[null,...Hs(ja.data[0].length,ja.data.length-1)]:As=[null,...Oa(ja.data[0].length,ja.data.length-1)],Ja){bs=[null];for(let Va=1;Va<ja.data.length;Va++){let us=ja.data[Va].map((tr,zs)=>tr!=null?it(Va,zs,tr):null);bs.push({fill:kt<1?us.map(tr=>tr!=null?(0,mo.alpha)(tr,kt):null):us,stroke:us})}}Zs={},hr=J.text?.valueSize??lo,Vr=er,gs=os=1/0},Nr=ja=>{if(Zt===Xe.yL.Never||hr<qo)return;ja.ctx.save(),ja.ctx.fillStyle=Ee.colors.text.primary,ja.ctx.font=`${hr}px ${Ee.typography.fontFamily}`;let Va,us;for(const tr in Zs){let zs=!0;for(const rr in Zs[tr]){const mr=Zs[tr][rr],{text:ho,x:Wr=0,y:Cl=0}=mr;let{value:vi}=mr;J.negY?.[rr]&&vi!=null&&(vi*=-1);let il=mn?"center":vi!==null&&vi<0?"right":"left",gc=mn?vi!==null&&vi<0?"top":"alphabetic":"middle";if(il!==Va&&(ja.ctx.textAlign=Va=il),gc!==us&&(ja.ctx.textBaseline=us=gc),Zt===Xe.yL.Always)ja.ctx.fillText(ho,Wr,Cl);else if(Zt===Xe.yL.Auto){let{bbox:Wl}=mr,Mi=!1;if(Wl==null)Mi=!0,mr.hidden=!0;else if(!zs)for(const Yi in Zs[tr]){if(Yi===rr)continue;const Kl=Zs[tr][Yi],{bbox:Qo,hidden:pc}=Kl;if(!pc&&Qo&&(0,Po.HY)(Wl,Qo)){Mi=!0,mr.hidden=!0;break}}zs=!1,!Mi&&ja.ctx.fillText(ho,Wr,Cl)}}}ja.ctx.restore()};let zr=null;function kr(ja,Va){return zr=null,(0,Xs.bq)(ja[0],Va,({totals:us})=>{zr=us})}return{cursor:xr,xRange:Ma,xValues:Ha,xSplits:Ta,hFilter:aa,barsBuilder:sr,init:cr,drawClear:dr,draw:Nr,prepData:kr}}const so={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:Xe.wV.Auto,showValue:Xe.yL.Auto,stacking:Xe.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},ko={fillOpacity:80,gradientMode:Xe.on.None,lineWidth:1};function eo(J,Ee,Ce,Fe,He,it){if(J.length===0||J.every(Zt=>Zt.length===0))return{series:[],_rest:[],warn:"No data in response"};(0,fr.Fm)(J),(0,fr.j2)(J,Ee);let vt={...J[0]};const Nt=vt.fields.findIndex(Zt=>Zt.type===It.PU.time);Nt>=0&&J.length>1&&(vt=(0,js.Fd)({frames:J,keepDisplayNames:!0})??vt);const kt=vt.fields.find(Zt=>Zt.state?.displayName===He||Zt.name===He)??vt.fields.find(Zt=>Zt.type===It.PU.string)??vt.fields[Nt];if(kt!=null){const Zt=[kt],ln=[],bn=it==null?void 0:vt.fields.find(Wn=>Wn.state?.displayName===it||Wn.name===it);vt.fields.forEach(Wn=>{if(Wn!==kt)if(Wn.type===It.PU.number&&!Wn.config.custom?.hideFrom?.viz){const ba={...Wn,values:Wn.values.map(oa=>Number.isFinite(oa)?oa:null),config:{...Wn.config,custom:{...Wn.config.custom,stacking:{group:"_",mode:Ce}}}};Zt.push(ba)}else ln.push(Wn)});let Nn=null;Zt.length===1&&(Nn="No numeric fields found"),vt.fields=Zt;const mn=[vt];return(0,ao.O2)(mn,Fe,0),{series:mn,_rest:ln,color:bn,warn:Nn}}return{series:[],_rest:[],color:null,warn:"Bar charts requires a string or time field"}}const No=({series:J,color:Ee,orientation:Ce,options:Fe,timeZone:He,theme:it})=>{let{showValue:vt,groupWidth:Nt,barWidth:kt,barRadius:Zt=0,stacking:ln,text:bn,tooltip:Nn,xTickLabelRotation:mn,xTickLabelMaxLength:Wn,xTickLabelSpacing:ba=0,legend:oa,fullHighlight:da}=Fe,Xn=J[0];const Gn=new no.e,ea=Xn.fields.map((As,bs)=>ln===Xe.gs.Percent?(0,to.J)({field:{...As,config:{...As.config,unit:"percentunit"}},theme:it}):As.display),qa=(As,bs)=>(0,Ar.cN)(ea[As](bs)),Wa=(As,bs)=>To(qa(As,bs),Wn),Ka=oo(Ce);Xn.fields.length===2&&(Nt=kt,kt=1);const Ta=(As,bs)=>Xn.fields[As].values[bs];let aa,Ha=1;if(Ee!=null){const As=Ee.display;Ha=(Ee.config.custom.fillOpacity??100)/100,aa=(bs,rs)=>As(Ee.values[rs]).color}else Xn.fields.some(bs=>bs.config.custom?.gradientMode===Xe.on.Scheme&&bs.config.color?.mode===Ko.Yb.Thresholds||bs.config.mappings?.some(Zs=>Zs.type==="value"?Object.values(Zs.options).some(hr=>hr.color!=null):Zs.options.result.color!=null))&&(Ha=(Xn.fields.find(rs=>rs.type===It.PU.number).config.custom.fillOpacity??100)/100,aa=(rs,Zs)=>{let hr=Xn.fields[rs];return hr.display(hr.values[Zs]).color});const Ma={xOri:Ka.xOri,xDir:Ka.xDir,groupWidth:Nt,barWidth:kt,barRadius:Zt,stacking:ln,rawValue:Ta,getColor:aa,fillOpacity:Ha,formatValue:qa,formatShortValue:Wa,timeZone:He,text:bn,showValue:vt,legend:oa,xSpacing:ba,xTimeAuto:Xn.fields[0]?.type===It.PU.time&&!Xn.fields[0].config.unit?.startsWith("time:"),negY:Xn.fields.map(As=>As.config.custom?.transform===Xe.NU.NegativeY),fullHighlight:da,hoverMulti:Nn.mode===Xe.$N.Multi},Oa=Ao(Ma,it);if(Gn.setCursor(Oa.cursor),Gn.addHook("init",Oa.init),Gn.addHook("drawClear",Oa.drawClear),Gn.addHook("draw",Oa.draw),mn!==0){let As=50,bs=Ka.xOri===Xe.Lt.Horizontal?14:5;Gn.setPadding(oi(Xn,mn,Wn,As,bs))}Gn.setPrepData(Oa.prepData),Gn.addScale({scaleKey:"x",isTime:!1,range:Oa.xRange,distribution:Xe.L4.Ordinal,orientation:Ka.xOri,direction:Ka.xDir});const Hs=Xn.fields[0]?.config.custom?.axisPlacement!==Xe.vM.Hidden?Ka.xOri===Xe.Lt.Horizontal?Xe.vM.Bottom:Xe.vM.Left:Xe.vM.Hidden,ar=Xn.fields[0]?.config.custom?.axisPlacement!==Xe.vM.Hidden;Gn.addAxis({scaleKey:"x",isTime:!1,placement:Hs,label:Xn.fields[0]?.config.custom?.axisLabel,splits:Oa.xSplits,filter:Ka.xOri===0?Oa.hFilter:void 0,values:Oa.xValues,timeZone:He,grid:{show:!1},ticks:{show:!1},gap:15,tickLabelRotation:Ka.xOri===0?mn*-1:0,theme:it,show:ar});for(let As=1;As<Xn.fields.length;As++){const bs=Xn.fields[As],rs={...ko,...bs.config.custom},Zs=bs.config.unit||vo.s,hr=(0,_s.Qi)(bs),gs=(0,_s.lz)(bs,it).color;let os=rs.axisSoftMin,Ja=rs.axisSoftMax;if(os==null&&bs.config.min==null&&(os=0),Ja==null&&bs.config.max==null&&(Ja=0),rs.thresholdsStyle&&bs.config.thresholds&&(rs.thresholdsStyle.mode??Xe.Ly.Off)!==Xe.Ly.Off&&Gn.addThresholds({config:rs.thresholdsStyle,thresholds:bs.config.thresholds,scaleKey:Zs,theme:it,hardMin:bs.config.min,hardMax:bs.config.max,softMin:rs.axisSoftMin,softMax:rs.axisSoftMax}),Gn.addSeries({scaleKey:Zs,pxAlign:!0,lineWidth:rs.lineWidth,lineColor:gs,fillOpacity:rs.fillOpacity,theme:it,colorMode:hr,pathBuilder:Oa.barsBuilder,show:!rs.hideFrom?.viz,gradientMode:rs.gradientMode,thresholds:bs.config.thresholds,hardMin:bs.config.min,hardMax:bs.config.max,softMin:rs.axisSoftMin,softMax:rs.axisSoftMax}),Gn.addScale({scaleKey:Zs,min:bs.config.min,max:bs.config.max,softMin:os,softMax:Ja,centeredZero:rs.axisCenteredZero,orientation:Ka.yOri,direction:Ka.yDir,distribution:rs.scaleDistribution?.type,log:rs.scaleDistribution?.log}),rs.axisPlacement!==Xe.vM.Hidden){let Es=rs.axisPlacement;(!Es||Es===Xe.vM.Auto)&&(Es=Xe.vM.Left),Ka.xOri===1&&(Es===Xe.vM.Left&&(Es=Xe.vM.Bottom),Es===Xe.vM.Right&&(Es=Xe.vM.Top));let sr={scaleKey:Zs,label:rs.axisLabel,size:rs.axisWidth,placement:Es,formatValue:(cr,xr)=>(0,Ar.cN)(bs.display(cr,xr)),filter:Ka.yOri===0?Oa.hFilter:void 0,tickLabelRotation:Ka.xOri===1?mn*-1:0,theme:it,grid:{show:rs.axisGridShow}};rs.axisBorderShow&&(sr.border={show:!0}),rs.axisColorMode===Xe.Y$.Series&&(sr.color=gs),Gn.addAxis(sr)}}let er=(0,Xs.ro)(Xn);return Gn.setStackingGroups(er),{builder:Gn,prepData:(As,bs)=>(J=As,Xn=J[0],Ee=bs,Gn.prepData(J))}};function To(J,Ee){return J.length>Ee?J.substring(0,Ee).concat("..."):J}function oi(J,Ee,Ce,Fe=0,He=0){const it=J.fields[0].values,vt=Us.pi,Nt=J.fields[0].display,kt=mn=>Nt?Nt(it[mn]):it[mn];let Zt=0;for(let mn=0;mn<it.length;mn++){let Wn=(0,Ts.kD)(To((0,Ar.cN)(kt(mn)),Ce),vt);Zt=Wn.width>Zt?Wn.width:Zt}const ln=Ee>0?Math.cos(Ee*Math.PI/180)*(0,Ts.kD)(To((0,Ar.cN)(kt(it.length-1)),Ce),vt).width:0,bn=Ee<0?Math.cos(Ee*-1*Math.PI/180)*(0,Ts.kD)(To((0,Ar.cN)(kt(0)),Ce),vt).width:0,Nn=Math.sin((Ee>=0?Ee:Ee*-1)*Math.PI/180)*Zt-He;return[Math.round(Us.pi*vr.A.pxRatio),ln,Nn,Math.max(0,bn-Fe)]}function oo(J){return J===Xe.wV.Vertical?{xOri:Xe.Lt.Horizontal,xDir:Xe.ON.Right,yOri:Xe.Lt.Vertical,yDir:Xe.ON.Up}:{xOri:Xe.Lt.Vertical,xDir:Xe.ON.Down,yOri:Xe.Lt.Horizontal,yDir:Xe.ON.Right}}const zt=(0,Ts.kD)("M",Us.pi).width,rn=Math.PI/180,zn=J=>{const{data:Ee,options:Ce,fieldConfig:Fe,width:He,height:it,timeZone:vt,id:Nt}=J,kt=(0,z.$j)(),{barWidth:Zt,barRadius:ln=0,showValue:bn,groupWidth:Nn,stacking:mn,legend:Wn,tooltip:ba,text:oa,xTickLabelRotation:da,xTickLabelSpacing:Xn,fullHighlight:Gn,xField:ea,colorByField:qa}=Ce;let{orientation:Wa,xTickLabelMaxLength:Ka=0}=Ce;Wa=Wa===tn.wV.Auto?He<it?tn.wV.Horizontal:tn.wV.Vertical:Wa,Ka=da===0?1/0:Ka||Math.floor(it/2/Math.sin(Math.abs(da*rn))/zt-3);const Ta=(0,C.useMemo)(()=>eo(Ee.series,Fe,mn,kt,ea,qa),[Ee.series,Fe,mn,kt,ea,qa]),aa=(0,C.useMemo)(()=>Ta.series.map(As=>({...As,fields:As.fields.filter((bs,rs)=>rs===0||!bs.state?.hideFrom?.viz)})),[Ta.series]),Ha=aa[0]?.length??0,Ma=aa[0]?.fields.length??0;let{builder:Oa,prepData:Hs}=(0,C.useMemo)(()=>Ha===0?{builder:null,prepData:null}:No({series:aa,color:Ta.color,orientation:Wa,options:Ce,timeZone:vt,theme:kt}),[Wa,vt,J.data.structureRev,Ma,Ha,Zt,ln,bn,Nn,mn,Wn,ba,oa?.valueSize,da,Xn,Gn,ea,qa,Ka]);const ar=(0,C.useMemo)(()=>Hs==null?[]:Hs(aa,Ta.color),[Hs,aa,Ta.color]);if(Ta.warn!=null||Oa==null)return C.createElement(ga.a,{panelId:Nt,fieldConfig:Fe,data:Ee,message:Ta.warn??"",needsNumberField:!0});const er=Wn.showLegend&&Br(Oa,Ta.series)?C.createElement(Mr,{data:Ta.series,colorField:Ta.color,...Wn}):null;return C.createElement(Bs.KU,{width:J.width,height:J.height,legend:er},(As,bs)=>C.createElement(ks.Z,{config:Oa,data:ar,width:As,height:bs},J.options.tooltip.mode!==Xe.$N.None&&C.createElement(Ms.xl,{config:Oa,maxWidth:Ce.tooltip.maxWidth,hoverMode:Ce.tooltip.mode===Xe.$N.Single?Ms.b3.xOne:Ms.b3.xAll,render:(rs,Zs,hr,Vr,gs,os)=>C.createElement(Dr.k,{series:aa[0],_rest:Ta._rest,dataIdxs:Zs,seriesIdx:hr,mode:Ce.tooltip.mode,sortOrder:Ce.tooltip.sort,isPinned:Vr,maxHeight:Ce.tooltip.maxHeight})})))};var Fn=e(66864),ta=e(94354),ua=e(10880);const ya=[{label:"None",value:0,description:"Show all tick marks"},{label:"Small",value:100,description:"Require 100px spacing"},{label:"Medium",value:200,description:"Require 200px spacing"},{label:"Large",value:300,description:"Require 300px spacing"}],as=J=>{let Ee=J.value??0;const Ce=Ee<0;Ce&&(Ee*=-1);let Fe=ya[0];for(const vt of ya)if(Fe=vt,Ee<=Fe.value)break;const He=vt=>{J.onChange(vt*(Ce?-1:1))},it=()=>{J.onChange(J.value*-1)};return C.createElement(Fn.Gy,null,C.createElement(ta.z,{value:Fe.value,options:ya,onChange:He}),Ee!==0&&C.createElement(Dt.m,{content:"Require space from the right side",placement:"top"},C.createElement("div",null,C.createElement(ua.S,{value:Ce,onChange:it,label:"RTL"}))))},Ga=(J,Ee,Ce,Fe)=>{if(Ee==="graph"){const He=Ce.angular;if(He.xaxis?.mode==="series"){const it=J.transformations||[];it.push({id:"reduce",options:{reducers:He.xaxis?.values??["sum"]}}),J.transformations=it}}return{}};var _a=e(38824);class nr{getListWithDefaults(Ee){return Ee.getListAppender({name:_a.m.BarChart,pluginId:"barchart",options:{showValue:Xe.yL.Never,legend:{calcs:[],displayMode:Xe.lm.List,showLegend:!0,placement:"right"}},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:Ce=>{Ce.options.barWidth=.8}}})}getSuggestionsForData(Ee){const Ce=this.getListWithDefaults(Ee),{dataSummary:Fe}=Ee;Fe.frameCount===1&&(!Fe.hasNumberField||!Fe.hasStringField||Fe.rowCountTotal>50||(Ce.append({name:_a.m.BarChart}),Fe.numberFieldCount>1&&(Ce.append({name:_a.m.BarChartStacked,options:{stacking:Xe.gs.Normal}}),Ce.append({name:_a.m.BarChartStackedPercent,options:{stacking:Xe.gs.Percent}})),Ce.append({name:_a.m.BarChartHorizontal,options:{orientation:tn.wV.Horizontal}}),Fe.numberFieldCount>1&&(Ce.append({name:_a.m.BarChartHorizontalStacked,options:{stacking:Xe.gs.Normal,orientation:tn.wV.Horizontal}}),Ce.append({name:_a.m.BarChartHorizontalStackedPercent,options:{orientation:tn.wV.Horizontal,stacking:Xe.gs.Percent}}))))}}const ps=new O.m(zn).setPanelChangeHandler(Ga).useFieldConfig({standardOptions:{[Mt.uo.Color]:{settings:{byValueSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:wt.Y.PaletteClassic}}},useCustomConfig:J=>{const Ee=ko;J.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:Ee.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:Ee.fillOpacity,settings:{min:0,max:100,step:1}}).addRadio({path:"gradientMode",name:"Gradient mode",defaultValue:jn.t.fillGradient[0].value,settings:{options:jn.t.fillGradient}}),J.addSelect({category:["Graph styles"],name:"Transform",path:"transform",settings:{options:[{label:"Constant",value:Xe.NU.Constant,description:"The first value will be shown as a constant line"},{label:"Negative Y",value:Xe.NU.NegativeY,description:"Flip the results to negative values on the y axis"}],isClearable:!0},hideFromDefaults:!0}),J.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:"Show thresholds",category:["Thresholds"],defaultValue:{mode:Xe.Ly.Off},settings:{options:jn.t.thresholdsDisplayModes},editor:xa.D,override:xa.D,process:Ht.hS,shouldApply:()=>!0}),Qn.r(J,Ee,!1),ia.e(J)}}).setPanelOptions(J=>{J.addFieldNamePicker({path:"xField",name:"X Axis",settings:{placeholderText:"First string or time field"}}).addRadio({path:"orientation",name:"Orientation",settings:{options:[{value:tn.wV.Auto,label:"Auto"},{value:tn.wV.Horizontal,label:"Horizontal"},{value:tn.wV.Vertical,label:"Vertical"}]},defaultValue:so.orientation}).addSliderInput({path:"xTickLabelRotation",name:"Rotate x-axis tick labels",defaultValue:so.xTickLabelRotation,settings:{min:-90,max:90,step:15,marks:{"-90":"-90\xB0","-45":"-45\xB0",0:"0\xB0",45:"45\xB0",90:"90\xB0"},included:!1}}).addNumberInput({path:"xTickLabelMaxLength",name:"X-axis tick label max length",description:"X-axis labels will be truncated to the length provided",settings:{placeholder:"None",min:0},showIf:Ee=>Ee.xTickLabelRotation!==0}).addCustomEditor({id:"xTickLabelSpacing",path:"xTickLabelSpacing",name:"X-axis labels minimum spacing",defaultValue:so.xTickLabelSpacing,editor:as}).addRadio({path:"showValue",name:"Show values",settings:{options:[{value:Xe.yL.Auto,label:"Auto"},{value:Xe.yL.Always,label:"Always"},{value:Xe.yL.Never,label:"Never"}]},defaultValue:so.showValue}).addRadio({path:"stacking",name:"Stacking",settings:{options:jn.t.stacking},defaultValue:so.stacking}).addSliderInput({path:"groupWidth",name:"Group width",defaultValue:so.groupWidth,settings:{min:0,max:1,step:.01},showIf:(Ee,Ce)=>Ee.stacking&&Ee.stacking!==Xe.gs.None?!1:Qs(Ce)!==1}).addSliderInput({path:"barWidth",name:"Bar width",defaultValue:so.barWidth,settings:{min:0,max:1,step:.01}}).addSliderInput({path:"barRadius",name:"Bar radius",defaultValue:so.barRadius,settings:{min:0,max:.5,step:.05}}).addBooleanSwitch({path:"fullHighlight",name:"Highlight full area on hover",defaultValue:so.fullHighlight,showIf:Ee=>Ee.stacking===Xe.gs.None}),J.addFieldNamePicker({path:"colorByField",name:"Color by field",description:"Use the color value for a sibling field to color each bar value."}),wn.D(J),sa.H(J),La.I(J,!1)}).setSuggestionsSupplier(new nr);function Qs(J){let Ee=0;if(J)for(const Ce of J)for(const Fe of Ce.fields)Fe.type===It.PU.number&&Ee++;return Ee}var Hr=e(63250),_r=e(23799);const Rr=J=>(0,Hr._$)(J);var Eo=e(58384),co=e(17516);class Ur{getSuggestionsForData(Ee){const{dataSummary:Ce}=Ee;if(!Ce.hasData||!Ce.hasNumberField)return;const Fe=Ee.getListAppender({name:"",pluginId:"bargauge",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}});Ce.numberFieldCount>50||(Ce.hasStringField&&Ce.frameCount===1&&Ce.rowCountTotal<30?(Fe.append({name:_a.m.BarGaugeBasic,options:{reduceOptions:{values:!0,calcs:[]},displayMode:Xe.eX.Basic,orientation:tn.wV.Horizontal},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}}),Fe.append({name:_a.m.BarGaugeLCD,options:{reduceOptions:{values:!0,calcs:[]},displayMode:Xe.eX.Lcd,orientation:tn.wV.Horizontal},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}})):(Fe.append({name:_a.m.BarGaugeBasic,options:{displayMode:Xe.eX.Basic,orientation:tn.wV.Horizontal,reduceOptions:{values:!1,calcs:["lastNotNull"]}},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}}),Fe.append({name:_a.m.BarGaugeLCD,options:{displayMode:Xe.eX.Lcd,orientation:tn.wV.Horizontal,reduceOptions:{values:!1,calcs:["lastNotNull"]}},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}})))}}const At=new O.m(Eo.d).useFieldConfig().setPanelOptions(J=>{(0,_r.L)(J),(0,_r.h)(J),La.I(J),J.addRadio({path:"displayMode",name:"Display mode",settings:{options:[{value:Xe.eX.Gradient,label:"Gradient"},{value:Xe.eX.Lcd,label:"Retro LCD"},{value:Xe.eX.Basic,label:"Basic"}]},defaultValue:co.K.displayMode}).addRadio({path:"valueMode",name:"Value display",settings:{options:[{value:Xe.$l.Color,label:"Value color"},{value:Xe.$l.Text,label:"Text color"},{value:Xe.$l.Hidden,label:"Hidden"}]},defaultValue:co.K.valueMode}).addRadio({path:"namePlacement",name:"Name placement",settings:{options:[{value:Xe.TZ.Auto,label:"Auto"},{value:Xe.TZ.Top,label:"Top"},{value:Xe.TZ.Left,label:"Left"}]},defaultValue:co.K.namePlacement,showIf:Ee=>Ee.orientation!==tn.wV.Vertical}).addBooleanSwitch({path:"showUnfilled",name:"Show unfilled area",description:"When enabled renders the unfilled region as gray",defaultValue:co.K.showUnfilled,showIf:Ee=>Ee.displayMode!=="lcd"}).addRadio({path:"sizing",name:"Bar size",settings:{options:[{value:Xe.T6.Auto,label:"Auto"},{value:Xe.T6.Manual,label:"Manual"}]},defaultValue:co.K.sizing}).addSliderInput({path:"minVizWidth",name:"Min width",description:"Minimum column width (vertical orientation)",defaultValue:co.K.minVizWidth,settings:{min:0,max:300,step:1},showIf:Ee=>Ee.sizing===Xe.T6.Manual&&(Ee.orientation===tn.wV.Auto||Ee.orientation===tn.wV.Vertical)}).addSliderInput({path:"minVizHeight",name:"Min height",description:"Minimum row height (horizontal orientation)",defaultValue:co.K.minVizHeight,settings:{min:0,max:300,step:1},showIf:Ee=>Ee.sizing===Xe.T6.Manual&&(Ee.orientation===tn.wV.Auto||Ee.orientation===tn.wV.Horizontal)}).addSliderInput({path:"maxVizHeight",name:"Max height",description:"Maximum row height (horizontal orientation)",defaultValue:co.K.maxVizHeight,settings:{min:0,max:300,step:1},showIf:Ee=>Ee.sizing===Xe.T6.Manual&&(Ee.orientation===tn.wV.Auto||Ee.orientation===tn.wV.Horizontal)})}).setPanelChangeHandler(Hr.gl).setMigrationHandler(Rr).setSuggestionsSupplier(new Ur);var an=e(41706),cn=e(79041),On=e(23117),ha=e(68268),la=e(24182),Ns=e(30249),Ds=e(74863),Js=e(55129);const Rs=new Set(["bytes","bits","kbytes","mbytes","gbytes","tbytes","pbytes","binBps","binbps","KiBs","Kibits","MiBs","Mibits","GiBs","Gibits","TiBs","Tibits","PiBs","Pibits"]),Er=Array(53);for(let J=0;J<Er.length;J++)Er[J]=2**J;const Vs=(J,Ee=1)=>J==null?"-":J.toFixed(Ee),hs={drawStyle:Xe.GR.Line,showPoints:Xe.yL.Auto,axisPlacement:Xe.vM.Auto},Pr=({frame:J,theme:Ee,timeZones:Ce,getTimeRange:Fe,allFrames:He,renderers:it,tweakScale:vt=ln=>ln,tweakAxis:Nt=ln=>ln,hoverProximity:kt,orientation:Zt=Xe.wV.Horizontal})=>{const ln=Zt!==Xe.wV.Vertical,bn=new no.e(Ce[0]);let Nn;bn.setPrepData(Ta=>(Nn=Ta[0],(0,Xs.bq)(Ta[0],bn.getStackingGroups())));const mn=J.fields[0];if(!mn)return bn;const Wn="x";let ba="";const oa=mn.config.custom?.axisPlacement===Xe.vM.Hidden?Xe.vM.Hidden:ln?Xe.vM.Bottom:Xe.vM.Left,da=mn.config.custom?.axisPlacement!==Xe.vM.Hidden;if(mn.type===It.PU.time){bn.addScale({scaleKey:Wn,orientation:ln?Xe.Lt.Horizontal:Xe.Lt.Vertical,direction:ln?Xe.ON.Right:Xe.ON.Up,isTime:!0,range:()=>{const aa=Fe();return[aa.from.valueOf(),aa.to.valueOf()]}});const Ta=Ce.length>1?(aa,Ha)=>ln?Ha.map((Ma,Oa)=>Oa<2?null:Ma):Ha:void 0;for(let aa=0;aa<Ce.length;aa++){const Ha=Ce[aa];bn.addAxis({scaleKey:Wn,isTime:!0,placement:oa,show:da,label:mn.config.custom?.axisLabel,timeZone:Ha,theme:Ee,grid:{show:aa===0&&mn.config.custom?.axisGridShow},filter:Ta})}Ce.length>1&&bn.addHook("drawAxes",aa=>{aa.ctx.save();let Ha=0;aa.axes.forEach(Ma=>{if(ln&&Ma.side===2){aa.ctx.fillStyle=Ee.colors.text.primary,aa.ctx.textAlign="left",aa.ctx.textBaseline="bottom";let Oa=Ma._pos+Ma._size;aa.ctx.fillText(Ce[Ha],aa.bbox.left,Oa*vr.A.pxRatio),Ha++}}),aa.ctx.restore()})}else bn.addScale({scaleKey:Wn,orientation:ln?Xe.Lt.Horizontal:Xe.Lt.Vertical,direction:ln?Xe.ON.Right:Xe.ON.Up,range:(Ta,aa,Ha)=>[mn.config.min??aa,mn.config.max??Ha]}),bn.addAxis({scaleKey:Wn,placement:oa,show:da,label:mn.config.custom?.axisLabel,theme:Ee,grid:{show:mn.config.custom?.axisGridShow},formatValue:(Ta,aa)=>(0,Ar.cN)(mn.display(Ta,aa))});let Xn=it?.flatMap(Ta=>Object.values(Ta.fieldMap).filter(aa=>Ta.indicesOnly.indexOf(aa)===-1))??[],Gn;for(let Ta=1;Ta<J.fields.length;Ta++){const aa=J.fields[Ta],Ha={...aa.config,custom:{...hs,...aa.config.custom}},Ma=Ha.custom;if(aa===mn||aa.type!==It.PU.number&&aa.type!==It.PU.enum)continue;let Oa=aa.display??Vs;aa.config.custom?.stacking?.mode===Xe.gs.Percent&&(Oa=(0,to.J)({field:{...aa,config:{...aa.config,unit:"percentunit"}},theme:Ee}));const Hs=(0,Js.M)(Ha,aa.type),ar=(0,_s.Qi)(aa),As=(0,_s.lz)(aa,Ee).color;if(bn.addScale(vt({scaleKey:Hs,orientation:ln?Xe.Lt.Vertical:Xe.Lt.Horizontal,direction:ln?Xe.ON.Up:Xe.ON.Right,distribution:Ma.scaleDistribution?.type,log:Ma.scaleDistribution?.log,linearThreshold:Ma.scaleDistribution?.linearThreshold,min:aa.config.min,max:aa.config.max,softMin:Ma.axisSoftMin,softMax:Ma.axisSoftMax,centeredZero:Ma.axisCenteredZero,range:Ma.stacking?.mode===Xe.gs.Percent?(os,Ja,Es)=>(Ja=Ja<0?-1:0,Es=Es>0?1:0,[Ja,Es]):aa.type===It.PU.enum?(os,Ja,Es)=>[-1,aa.config.type.enum.text.length]:void 0,decimals:aa.config.decimals},aa)),ba||(ba=Hs),Ma.axisPlacement!==Xe.vM.Hidden){let os;Ma.axisColorMode===Xe.Y$.Series&&(ar.isByValue&&aa.config.custom?.gradientMode===Xe.on.Scheme&&ar.id===wt.Y.Thresholds?os=(0,Ds.pl)(1,Ee,ar,aa.config.thresholds):os=As);const Ja={border:{show:Ma.axisBorderShow||!1,width:1/devicePixelRatio,stroke:os||Ee.colors.text.primary},ticks:{show:Ma.axisBorderShow||!1,stroke:os||Ee.colors.text.primary},color:os||Ee.colors.text.primary};let Es,sr,cr;if(Rs.has(Ha.unit))Es=Er;else if(aa.type===It.PU.enum){let xr=aa.config.type.enum.text;cr=xr.map((dr,Nr)=>Nr),sr=xr}bn.addAxis(Nt({scaleKey:Hs,label:Ma.axisLabel,size:Ma.axisWidth,placement:ln?Ma.axisPlacement??Xe.vM.Auto:Xe.vM.Bottom,formatValue:(xr,dr)=>(0,Ar.cN)(Oa(xr,dr)),theme:Ee,grid:{show:Ma.axisGridShow},decimals:aa.config.decimals,distr:Ma.scaleDistribution?.type,splits:cr,values:sr,incrs:Es,...Ja},aa))}const bs=Ma.drawStyle===Xe.GR.Points?Xe.yL.Always:Ma.showPoints;let rs=()=>null;Ma.spanNulls!==!0&&(rs=(os,Ja,Es,sr)=>{let cr=[],xr=os.series[Ja];if(!Es&&sr&&sr.length){const[dr,Nr]=xr.idxs,zr=os.data[0],kr=os.data[Ja],ja=Math.round(os.valToPos(zr[dr],"x",!0)),Va=Math.round(os.valToPos(zr[Nr],"x",!0));sr[0][0]===ja&&cr.push(dr);for(let us=0;us<sr.length;us++){let tr=sr[us],zs=sr[us+1];if(zs&&tr[1]===zs[0]){let rr=os.posToIdx(tr[1],!0);if(kr[rr]==null)for(let mr=1;mr<100;mr++){if(kr[rr+mr]!=null){rr+=mr;break}if(kr[rr-mr]!=null){rr-=mr;break}}cr.push(rr)}}sr[sr.length-1][1]===Va&&cr.push(Nr)}return cr.length?cr:null});let{fillOpacity:Zs}=Ma,hr=null,Vr=null;if(aa.state?.origin){Gn||(Gn=ro(J,He));const os=He[aa.state.origin.frameIndex],Ja=os?.fields[aa.state.origin.fieldIndex],Es=(0,fr.Ct)(Ja??aa,os,He);if(Xn.indexOf(Es)>=0)hr=()=>null,Vr=()=>{};else if(Ma.transform===Xe.NU.Constant){const sr=vr.A.paths.linear();hr=(cr,xr)=>{const dr=cr._data,Nr=Fe();let zr=[Nr.from.valueOf(),Nr.to.valueOf()],kr=dr[xr].find(us=>us!=null),ja=[kr,kr],Va=dr.slice();return Va[0]=zr,Va[xr]=ja,sr({...cr,_data:Va},xr,0,1)}}if(Ma.fillBelowTo){const sr=J.fields.find(Nr=>Ma.fillBelowTo===Nr.name||Ma.fillBelowTo===Nr.config?.displayNameFromDS||Ma.fillBelowTo===(0,fr.Ct)(Nr,J,He)),cr=sr?(0,fr.Ct)(sr,J,He):Ma.fillBelowTo,xr=Gn.get(Es),dr=Gn.get(cr);(0,w.isNumber)(dr)&&(0,w.isNumber)(xr)?(bn.addBand({series:[xr,dr],fill:void 0}),Zs||(Zs=35)):Zs=0}}let gs;ar.id===wt.Y.Thresholds&&(gs=os=>(0,_s.lz)(Nn.fields[os],Ee).color),bn.addSeries({pathBuilder:hr,pointsBuilder:Vr,scaleKey:Hs,showPoints:bs,pointsFilter:rs,colorMode:ar,fillOpacity:Zs,theme:Ee,dynamicSeriesColor:gs,drawStyle:Ma.drawStyle,lineColor:Ma.lineColor??As,lineWidth:Ma.lineWidth,lineInterpolation:Ma.lineInterpolation,lineStyle:Ma.lineStyle,barAlignment:Ma.barAlignment,barWidthFactor:Ma.barWidthFactor,barMaxWidth:Ma.barMaxWidth,pointSize:Ma.pointSize,spanNulls:Ma.spanNulls||!1,show:!Ma.hideFrom?.viz,gradientMode:Ma.gradientMode,thresholds:Ha.thresholds,hardMin:aa.config.min,hardMax:aa.config.max,softMin:Ma.axisSoftMin,softMax:Ma.axisSoftMax,dataFrameFieldIndex:aa.state?.origin}),Ma.thresholdsStyle&&Ha.thresholds&&(Ma.thresholdsStyle.mode??Xe.Ly.Off)!==Xe.Ly.Off&&bn.addThresholds({config:Ma.thresholdsStyle,thresholds:Ha.thresholds,scaleKey:Hs,theme:Ee,hardMin:aa.config.min,hardMax:aa.config.max,softMin:Ma.axisSoftMin,softMax:Ma.axisSoftMax})}let ea=(0,Xs.ro)(J);bn.setStackingGroups(ea),it?.forEach(Ta=>{Gn||(Gn=ro(J,He));let aa={};for(let Ha in Ta.fieldMap){let Ma=Ta.fieldMap[Ha];aa[Ha]=Gn.get(Ma)}Ta.init(bn,aa)});const qa=15;let Ka={hover:{prox:(Ta,aa,Ha)=>kt??(Ta.data[aa][Ha]===null?qa:null),skip:[null]},focus:{prox:kt??30}};return bn.setCursor(Ka),bn};function ro(J,Ee){const Ce=new Map;return J.fields.forEach((Fe,He)=>{const it=Fe.state?.origin;if(it){const vt=Ee[it.frameIndex]?.fields[it.fieldIndex];vt&&Ce.set((0,fr.Ct)(vt,Ee[it.frameIndex],Ee),He)}}),Ce}const yo=["legend","options","theme"];class Kr extends C.Component{constructor(){super(...arguments),this.prepConfig=(Ee,Ce,Fe)=>{const{theme:He,timeZone:it,options:vt,renderers:Nt,tweakAxis:kt,tweakScale:Zt}=this.props;return Pr({frame:Ee,theme:He,timeZones:Array.isArray(it)?it:[it],getTimeRange:Fe,allFrames:Ce,renderers:Nt,tweakScale:Zt,tweakAxis:kt,hoverProximity:vt?.tooltip?.hoverProximity,orientation:vt?.orientation})},this.renderLegend=Ee=>{const{legend:Ce,frames:Fe}=this.props;return!Ee||Ce&&!Ce.showLegend||!(0,la.t)(Ee,Fe)?null:C.createElement(la.$,{data:Fe,config:Ee,...Ce})}}render(){return C.createElement(Ns.o,{...this.props,prepConfig:this.prepConfig,propsToDiff:yo,renderLegend:this.renderLegend})}}const io=(0,z.cV)(Kr);io.displayName="TimeSeries";var Ro=e(62567),Qr=e(78226),uo=e(34743),Mo=e(36376),Jo=e(7315),Lo=e(13544),$r=e(17464),Ei=e(74007),Ki=e(25469);function dt(J){const Ee={position:"relative",top:"auto",right:"auto",marginRight:0};return C.createElement("div",{style:{width:"100%",display:"flex",justifyContent:"flex-end",paddingBottom:"6px"}},C.createElement(Ki.J,{onClick:J.onClick,style:J.style??Ee}))}const Pn=({timeZone:J,dataFrame:Ee,dataFrameFieldIndex:Ce,config:Fe,exemplarColor:He,clickedExemplarFieldIndex:it,setClickedExemplarFieldIndex:vt})=>{const Nt=(0,z.of)(gn),[kt,Zt]=(0,C.useState)(!1),[ln,bn]=(0,C.useState)(!1),Nn=[(0,uo.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,uo.BN)()],{context:mn,refs:Wn,floatingStyles:ba}=(0,Mo.we)({open:kt,placement:"bottom",onOpenChange:Zt,middleware:Nn,whileElementsMounted:Jo.ll,strategy:"fixed"}),oa=(0,Mo.s9)(mn),da=(0,Mo.Mk)(mn,{handleClose:(0,Mo.iB)(),enabled:it===void 0}),{getReferenceProps:Xn,getFloatingProps:Gn}=(0,Mo.bv)([oa,da]);(0,C.useEffect)(()=>{it?.fieldIndex===Ce.fieldIndex&&it?.frameIndex===Ce.frameIndex||bn(!1)},[it,Ce]);const ea=()=>{const aa=[C.createElement("rect",{fill:He,key:"diamond",x:"3.38672",width:"4.78985",height:"4.78985",transform:"rotate(45 3.38672 0)"}),C.createElement("path",{fill:He,key:"x",d:"M1.94444 3.49988L0 5.44432L1.55552 6.99984L3.49996 5.05539L5.4444 6.99983L6.99992 5.44431L5.05548 3.49988L6.99983 1.55552L5.44431 0L3.49996 1.94436L1.5556 0L8.42584e-05 1.55552L1.94444 3.49988Z"}),C.createElement("path",{fill:He,key:"triangle",d:"M4 0L7.4641 6H0.535898L4 0Z"}),C.createElement("rect",{fill:He,key:"rectangle",width:"5",height:"5"}),C.createElement("path",{fill:He,key:"pentagon",d:"M3 0.5L5.85317 2.57295L4.76336 5.92705H1.23664L0.146831 2.57295L3 0.5Z"}),C.createElement("path",{fill:He,key:"plus",d:"m2.35672,4.2425l0,2.357l1.88558,0l0,-2.357l2.3572,0l0,-1.88558l-2.3572,0l0,-2.35692l-1.88558,0l0,2.35692l-2.35672,0l0,1.88558l2.35672,0z"})];return aa[Ce.frameIndex%aa.length]},qa=()=>{bn(!0)},Wa=(0,C.useCallback)(()=>{const aa=Ee.fields.filter(er=>er.config.links?.length&&er.config.links?.length>0)||[],Ha=[...aa,...Ee.fields.filter(er=>!aa.includes(er))],Ma=()=>{bn(!1),Zt(!1),vt(void 0)};let Oa=[],Hs=[];Ha.map((er,As)=>{const bs=er.values[Ce.fieldIndex];er.config.links?.length&&Hs?.push(...er.getLinks?.({valueRowIndex:Ce.fieldIndex})||[]);const rs=er.display?er.display(bs):{text:`${bs}`,numeric:+bs};Oa.push({name:er.name,value:bs,valueString:(0,Ar.cN)(rs),highlight:!1})});const ar={position:"relative",top:"35px",right:"5px",marginRight:0};return C.createElement("div",{className:Nt.tooltip,ref:Wn.setFloating,style:ba,...Gn()},ln&&C.createElement(dt,{onClick:Ma,style:ar}),C.createElement(Ei.i,{displayValues:Oa,links:Hs}))},[Ee.fields,Ce,Nt,ln,vt,ba,Gn,Wn.setFloating]),Ka=Fe.getSeries().find(aa=>aa.props.dataFrameFieldIndex?.frameIndex===Ce.frameIndex)?.props.lineColor,Ta=()=>{vt(Ce),qa()};return C.createElement(C.Fragment,null,C.createElement("div",{ref:Wn.setReference,className:Nt.markerWrapper,"data-testid":Lo.Tp.components.DataSource.Prometheus.exemplarMarker,role:"button",tabIndex:0,...Xn(),onClick:Ta,onKeyDown:aa=>{aa.key==="Enter"&&Ta()}},C.createElement("svg",{viewBox:"0 0 7 7",width:"7",height:"7",style:{fill:Ka},className:(0,se.cx)(Nt.marble,(kt||ln)&&Nt.activeMarble)},ea())),(kt||ln)&&C.createElement($r.ZL,null,Wa()))},gn=J=>{const Ee=J.isDark?J.v1.palette.dark2:J.v1.palette.white,Ce=J.isDark?J.v1.palette.dark9:J.v1.palette.gray5,Fe=J.isDark?J.v1.palette.black:J.v1.palette.white,He=J.isDark?J.v1.palette.dark3:J.v1.palette.gray6;return{markerWrapper:(0,se.css)({padding:"0 4px 4px 4px",width:"8px",height:"8px",boxSizing:"content-box",transform:"translate3d(-50%, 0, 0)","&:hover":{"> svg":{transform:"scale(1.3)",opacity:1,filter:"drop-shadow(0 0 8px rgba(0, 0, 0, 0.5))"}}}),marker:(0,se.css)({width:0,height:0,borderLeft:"4px solid transparent",borderRight:"4px solid transparent",borderBottom:`4px solid ${J.v1.palette.red}`,pointerEvents:"none"}),wrapper:(0,se.css)({background:Ee,border:`1px solid ${Ce}`,borderRadius:J.shape.borderRadius(2),boxShadow:`0 0 20px ${Fe}`,padding:J.spacing(1)}),exemplarsTable:(0,se.css)({width:"100%","tr td":{padding:"5px 10px",whiteSpace:"nowrap",borderBottom:`4px solid ${J.components.panel.background}`},tr:{backgroundColor:J.colors.background.primary,"&:nth-child(even)":{backgroundColor:He}}}),valueWrapper:(0,se.css)({display:"flex",flexDirection:"row",flexWrap:"wrap",columnGap:J.spacing(1),"> span":{flexGrow:0},"> *":{flex:"1 1",alignSelf:"center"}}),tooltip:(0,se.css)({background:"none",padding:0,overflowY:"auto",maxHeight:"95vh"}),header:(0,se.css)({background:Ce,padding:"6px 10px",display:"flex"}),title:(0,se.css)({fontWeight:J.typography.fontWeightMedium,paddingRight:J.spacing(2),overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),body:(0,se.css)({fontWeight:J.typography.fontWeightMedium,borderRadius:J.shape.borderRadius(2),overflow:"hidden"}),marble:(0,se.css)({display:"block",opacity:.5,[J.transitions.handleMotion("no-preference")]:{transition:"transform 0.15s ease-out"}}),activeMarble:(0,se.css)({transform:"scale(1.3)",opacity:1,filter:"drop-shadow(0 0 8px rgba(0, 0, 0, 0.5))"})}},Jn=({exemplars:J,timeZone:Ee,config:Ce,visibleSeries:Fe})=>{const He=(0,C.useRef)(),[it,vt]=(0,C.useState)();(0,C.useLayoutEffect)(()=>{Ce.addHook("init",Zt=>{He.current=Zt})},[Ce]);const Nt=(0,C.useCallback)((Zt,ln)=>{const bn=Zt.fields.find(da=>da.name===It.LE),Nn=Zt.fields.find(da=>da.name===It.Bc);if(!bn||!Nn||!He.current)return;const mn=Object.keys(He.current.scales).find(da=>!["x","y"].some(Xn=>Xn===da))??vo.s,Wn=He.current.scales[mn].min,ba=He.current.scales[mn].max;let oa=Nn.values[ln.fieldIndex];return Wn!=null&&oa<Wn&&(oa=Wn),ba!=null&&oa>ba&&(oa=ba),{x:He.current.valToPos(bn.values[ln.fieldIndex],"x"),y:He.current.valToPos(oa,mn)}},[]),kt=(0,C.useCallback)((Zt,ln)=>{const bn=Fe!==void 0?Pa(Fe,Zt,ln):!0,Nn=Fe!==void 0?_n(Zt,ln,Fe):void 0;return bn?C.createElement(Pn,{setClickedExemplarFieldIndex:vt,clickedExemplarFieldIndex:it,timeZone:Ee,dataFrame:Zt,dataFrameFieldIndex:ln,config:Ce,exemplarColor:Nn}):C.createElement(C.Fragment,null)},[Ce,Ee,Fe,vt,it]);return C.createElement(Qr.a,{config:Ce,id:"exemplars",events:J,renderEventMarker:kt,mapEventToXYCoords:Nt})},Zn=(J,Ee)=>{const Ce=J.series.filter(He=>He.props.show),Fe=[];return Ee?.length&&Ce.forEach(He=>{const it=He.props?.dataFrameFieldIndex?.frameIndex,vt=He.props?.dataFrameFieldIndex?.fieldIndex;if(it!==void 0&&vt!==void 0){const Nt=Ee[it]?.fields[vt];Nt?.labels&&Fe.push({labels:Nt.labels,color:He.props?.lineColor??""})}}),{labels:Fe,totalSeriesCount:J.series.length}},_n=(J,Ee,Ce)=>{let Fe;return Ce.labels.some(He=>{const it=Object.keys(He.labels),vt=J.fields.filter(Nt=>it.find(kt=>kt===Nt.name));return vt.length&&vt.every((kt,Zt,ln)=>{const bn=kt.values[Ee.fieldIndex];return He.labels[kt.name]===bn})?(Fe=He.color,!0):!1}),Fe},Pa=(J,Ee,Ce)=>{let Fe=!1;return J.labels.length===J.totalSeriesCount?Fe=!0:J.labels.some(He=>{const it=Object.keys(He.labels);if(Object.keys(He.labels).length===0)Fe=!0;else{const vt=Ee.fields.filter(Nt=>it.find(kt=>kt===Nt.name));vt.length&&(Fe=J.labels.some(Nt=>Object.keys(Nt.labels).every(kt=>{const Zt=Nt.labels[kt];return vt.find(ln=>ln.values[Ce.fieldIndex]===Zt)})))}return Fe}),Fe};var Ca=e(7874),za=e(55794),xs=e.n(za);const ms=({step:J,y:Ee,dragBounds:Ce,mapPositionToValue:Fe,formatValue:He,onChange:it})=>{const vt=(0,z.$j)();let Nt=Ee,kt="none";Ee<(Ce.top??0)&&(kt="top"),Ee>(Ce.bottom??0)+22&&(kt="bottom"),kt==="bottom"&&(Nt=Ce.bottom??Ee),kt==="top"&&(Nt=Ce.top??Ee);const Zt=typeof it!="function",ln=(0,z.of)(ls,J,kt,Zt),[bn,Nn]=(0,C.useState)(J.value),mn=(0,C.useMemo)(()=>vt.colors.getContrastText(vt.visualization.getColorByName(J.color)),[J.color,vt]);return C.createElement(xs(),{axis:"y",grid:[1,1],disabled:Zt,onStop:Zt?w.noop:(Wn,ba)=>(it(Fe(ba.lastY)),!1),onDrag:(Wn,ba)=>Nn(Fe(ba.lastY)),position:{x:0,y:Nt},bounds:Ce},C.createElement("div",{className:ln.handle,style:{color:mn}},C.createElement("span",{className:ln.handleText},He(bn))))};ms.displayName="ThresholdDragHandle";const ls=(J,Ee,Ce,Fe)=>{const He=J.visualization.getColorByName(Ee.color),it=Ws(Ce),vt=Ce!=="none";return{handle:(0,se.css)`
      display: flex;
      align-items: center;
      position: absolute;
      left: 0;
      width: calc(100% - 9px);
      height: 18px;
      margin-top: -9px;
      border-color: ${He};
      cursor: ${Fe?"initial":"grab"};
      border-top-right-radius: ${J.shape.radius.default};
      border-bottom-right-radius: ${J.shape.radius.default};
      ${vt&&(0,se.css)`
        margin-top: 0;
        border-radius: ${J.shape.radius.default};
      `}
      background: ${He};
      font-size: ${J.typography.bodySmall.fontSize};
      &:before {
        ${it};
      }
    `,handleText:(0,se.css)`
      text-align: center;
      width: 100%;
      display: block;
      text-overflow: ellipsis;
      white-space: nowrap;
      overflow: hidden;
    `}};function Ws(J){const Ee=J==="none",Ce=Fe=>(0,se.css)`
    content: '';
    position: absolute;

    bottom: 0;
    top: 0;
    width: 0;
    height: 0;
    left: 0;

    border-right-style: solid;
    border-right-width: ${Fe}px;
    border-right-color: inherit;
    border-top: ${Fe}px solid transparent;
    border-bottom: ${Fe}px solid transparent;
  `;return Ee?(0,se.css)`
      ${Ce(9)};
      left: -9px;
    `:J==="top"?(0,se.css)`
      ${Ce(5)};
      left: calc(50% - 2.5px);
      top: -7px;
      transform: rotate(90deg);
    `:J==="bottom"?(0,se.css)`
      ${Ce(5)};
      left: calc(50% - 2.5px);
      top: calc(100% - 2.5px);
      transform: rotate(-90deg);
    `:""}const is=60,fs=({config:J,fieldConfig:Ee,onThresholdsChange:Ce})=>{const Fe=(0,C.useRef)(),[He,it]=(0,C.useState)(0);(0,C.useLayoutEffect)(()=>{J.setPadding([0,is,0,0]),J.addHook("init",Nt=>{Fe.current=Nt}),J.addHook("draw",()=>{it(Nt=>Nt+1)})},[J]);const vt=(0,C.useMemo)(()=>{const Nt=Fe.current;if(!Nt)return null;const kt=Ee.defaults.thresholds;if(!kt)return null;const Zt=(0,Js.M)(Ee.defaults,It.PU.number),ln=Ee.defaults.decimals,bn=[];for(let Nn=0;Nn<kt.steps.length;Nn++){const mn=kt.steps[Nn],Wn=Nt.valToPos(mn.value,Zt);if(Number.isNaN(Wn)||!Number.isFinite(Wn))continue;const ba=Nt.bbox.height/window.devicePixelRatio,da=typeof Ce=="function"?Gn=>{const ea=[...kt.steps.slice(0,Nn),...kt.steps.slice(Nn+1),{...kt.steps[Nn],value:Gn}].sort((qa,Wa)=>qa.value-Wa.value);Ce({...kt,steps:ea})}:void 0,Xn=C.createElement(ms,{key:`${mn.value}-${Nn}`,step:mn,y:Wn,dragBounds:{top:0,bottom:ba},mapPositionToValue:Gn=>Nt.posToVal(Gn,Zt),formatValue:Gn=>(0,Ar.j_)(Zt)(Gn,ln).text,onChange:da});bn.push(Xn)}return bn},[He,Ee,Ce]);return Fe.current?C.createElement("div",{style:{position:"absolute",overflow:"visible",left:`${(Fe.current.bbox.left+Fe.current.bbox.width)/window.devicePixelRatio}px`,top:`${Fe.current.bbox.top/window.devicePixelRatio}px`,width:`${is}px`,height:`${Fe.current.bbox.height/window.devicePixelRatio}px`}},vt):null};fs.displayName="ThresholdControlsPlugin";var ys=e(63577),Ps=(J=>(J.Candles="candles",J.CandlesVolume="candles+volume",J.Volume="volume",J))(Ps||{}),Lr=(J=>(J.Candles="candles",J.OHLCBars="ohlcbars",J))(Lr||{}),Gr=(J=>(J.CloseClose="close-close",J.OpenClose="open-close",J))(Gr||{});const ei={down:"red",flat:"gray",up:"green"},ti={...{candleStyle:"candles",colorStrategy:"open-close",colors:{down:"red",up:"green",flat:"gray"},fields:{},includeAllFields:!1,mode:"candles+volume"},legend:{displayMode:Xe.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:Xe.$N.Multi,sort:Xe.xB.None}},di={open:{key:"open",name:"Open",defaults:["open","o"],description:"Value at the start of the period"},high:{key:"high",name:"High",defaults:["high","h","max"],description:"Maximum value within the period"},low:{key:"low",name:"Low",defaults:["low","l","min"],description:"Minimum value within the period"},close:{key:"close",name:"Close",defaults:["close","c"],description:"Value at the end of the period"},volume:{key:"volume",name:"Volume",defaults:["volume","v"],description:"Sample count within the period"}};function $i(J,Ee,Ce){const Fe=(0,ys.findField)(J,Ce[Ee.key]);if(!Fe)for(const He of J.fields){const it=(0,fr.Ct)(He,J).toLowerCase();if(Ee.defaults.includes(it)||Ee.defaults.includes(He.name))return He}return Fe}function Oi(J,Ee,Ce,Fe){if(!J?.length)return null;const He=Ee.fields??{},it=J.length===1?(0,js.Yj)(J[0],J[0].fields.findIndex(mn=>mn.type===It.PU.time)):(0,js.Fd)({frames:J});if(!it?.length)return null;const vt={aligned:it,frame:it,names:{}},Nt=(0,ao.B_)([it],Ce,Fe);if(!Nt)return null;const kt=vt.frame=Nt[0],Zt=kt.fields.findIndex(mn=>mn.type===It.PU.time);if(Zt<0)return null;const ln=new Set;for(const mn of Object.values(di)){const Wn=$i(kt,mn,He);Wn&&(vt[mn.key]=Wn,ln.add(Wn))}if(!vt.open&&!vt.close&&(vt.open=kt.fields.find(mn=>mn.type===It.PU.number),vt.open&&ln.add(vt.open)),vt.open&&!vt.close&&!He.close){const mn=vt.open.values.slice(1);mn.push(mn[mn.length-1]),vt.close={...vt.open,values:mn,name:"Next open",state:void 0},ln.add(vt.close),kt.fields.push(vt.close),vt.autoOpenClose=!0}if(vt.close&&!vt.open&&!He.open){const mn=vt.close.values.slice();mn.unshift(mn[0]),mn.length=kt.length,vt.open={...vt.close,values:mn,name:"Previous close",state:void 0},ln.add(vt.open),kt.fields.push(vt.open),vt.autoOpenClose=!0}!vt.high&&!He.high&&(vt.high=vt.open),!vt.low&&!He.low&&(vt.low=vt.open),Ee.mode===Ps.Volume?(vt.high&&(vt.high!==vt.open&&ln.delete(vt.high),vt.high=void 0),vt.low&&(vt.low!==vt.open&&ln.delete(vt.low),vt.low=void 0)):Ee.mode===Ps.Candles&&vt.volume&&(ln.delete(vt.volume),vt.volume=void 0);for(const mn of Object.values(di)){const Wn=vt[mn.key];Wn&&(vt.names[mn.key]=(0,fr.Ct)(Wn,vt.frame))}const bn=kt.fields[Zt],Nn=[bn];Ee.includeAllFields?Nn.push(...kt.fields.filter(mn=>mn!==bn)):Nn.push(...ln),vt.frame={...vt.frame,fields:Nn};for(let mn=0;mn<vt.frame.fields.length;mn++){const Wn=vt.frame.fields[mn];Wn.state={...Wn.state,seriesIndex:mn-1,origin:{fieldIndex:mn,frameIndex:0}}}return vt}const{alpha:xo}=mo;function Vi(J){let{mode:Ee,candleStyle:Ce,fields:Fe,colorStrategy:He,upColor:it,downColor:vt,flatColor:Nt,volumeAlpha:kt,flatAsUp:Zt=!0}=J;const ln=Ee!==Ps.Volume&&Fe.high!=null&&Fe.low!=null,bn=ln&&Ce===Lr.Candles,Nn=Ee!==Ps.Candles&&Fe.volume!=null;function mn(ea,qa,Wa,Ka,Ta){return ea>0?Wa:ea<0?Ka:Ta?Wa:qa}let Wn=0,ba=Fe.open,oa=Fe.high,da=Fe.low,Xn=Fe.close,Gn=Fe.volume;return ea=>{let qa,Wa,Ka,Ta,aa,Ha;ln&&(Ka=new Path2D,Wa=new Path2D,qa=new Path2D),Nn&&(Ta=new Path2D,aa=new Path2D,Ha=new Path2D);let Ma=new Path2D,Oa=ea.ctx,Hs=ea.data[Wn],ar=ea.data[ba],er=ea.data[Xn],As=ln?ea.data[oa]:null,bs=ln?ea.data[da]:null,rs=Nn?ea.data[Gn]:null,Zs=Gn!=null?Math.round(ea.valToPos(0,ea.series[Gn].scale,!0)):null,[hr,Vr]=ea.series[0].idxs,gs=ea.data[0],os=ar,Ja=ea.bbox.width;if(gs.length>1){let dr=null;for(let Nr=0,zr=1/0;Nr<gs.length;Nr++)if(os[Nr]!==void 0){if(dr!=null){let kr=Math.abs(gs[Nr]-gs[dr]);kr<zr&&(zr=kr,Ja=Math.abs(ea.valToPos(gs[Nr],"x",!0)-ea.valToPos(gs[dr],"x",!0)))}dr=Nr}}let Es=Math.round(.6*Ja),sr=2,cr=2;Es<=12&&(sr=cr=1);let xr=Math.floor(Es/2);for(let dr=hr;dr<=Vr;dr++){let Nr=Math.round(ea.valToPos(Hs[dr],"x",!0)),zr=dr===hr?0:Math.sign(er[dr]-er[dr-1]),kr=Math.sign(er[dr]-ar[dr]);if(Nn&&Ha&&aa&&Ta){let ja=mn(He===Gr.CloseClose?zr:kr,Ha,aa,Ta,dr===hr&&Gr.CloseClose?!1:Zt),Va=Math.round(ea.valToPos(rs[dr],ea.series[Gn].scale,!0));ja.rect(Nr-xr,Va,Es,Zs-Va)}if(ln&&Ka&&Wa&&qa){let ja=mn(He===Gr.CloseClose?zr:kr,Ka,Wa,qa,dr===hr&&Gr.CloseClose?!1:Zt),Va=Math.round(ea.valToPos(As[dr],ea.series[oa].scale,!0)),us=Math.round(ea.valToPos(bs[dr],ea.series[da].scale,!0));ja.rect(Nr-Math.floor(sr/2),Va,sr,us-Va);let tr=Math.round(ea.valToPos(ar[dr],ea.series[ba].scale,!0)),zs=Math.round(ea.valToPos(er[dr],ea.series[Xn].scale,!0));if(bn){let rr=Math.min(tr,zs),mr=Math.max(tr,zs),ho=Math.max(1,mr-rr);ja.rect(Nr-xr,rr,Es,ho),He===Gr.CloseClose&&kr>=0&&ho>cr*2&&Ma.rect(Nr-xr+cr,rr+cr,Es-cr*2,ho-cr*2)}else ja.rect(Nr-xr,tr,xr,sr),ja.rect(Nr,zs,xr,sr)}}Oa.save(),Oa.rect(ea.bbox.left,ea.bbox.top,ea.bbox.width,ea.bbox.height),Oa.clip(),Nn&&Ha&&aa&&Ta&&(Oa.fillStyle=xo(it,kt),Oa.fill(aa),Oa.fillStyle=xo(vt,kt),Oa.fill(Ta),Oa.fillStyle=xo(Nt,kt),Oa.fill(Ha)),ln&&Ka&&Wa&&qa&&(Oa.fillStyle=it,Oa.fill(Wa),Oa.fillStyle=vt,Oa.fill(qa),Oa.fillStyle=Nt,Oa.fill(Ka),Oa.globalCompositeOperation="destination-out",Oa.fill(Ma)),Oa.restore()}}const Zo=({data:J,id:Ee,timeRange:Ce,timeZone:Fe,width:He,height:it,options:vt,fieldConfig:Nt,onChangeTimeRange:kt,replaceVariables:Zt})=>{const{sync:ln,eventsScope:bn,canAddAnnotations:Nn,onThresholdsChange:mn,canEditThresholds:Wn,showThresholds:ba,dataLinkPostProcessor:oa,eventBus:da}=(0,cn.d2)(),Xn=(0,z.$j)(),Gn=(0,C.useMemo)(()=>Oi(J.series,vt,Xn,Ce),[J.series,vt,Xn,Ce]),[ea,qa]=(0,C.useState)(null),Wa=ln?.()??Ko.yV.Off,{renderers:Ka,tweakScale:Ta,tweakAxis:aa,shouldRenderPrice:Ha}=(0,C.useMemo)(()=>{let Oa=(zr,kr)=>zr,Hs=(zr,kr)=>zr,ar={renderers:[],tweakScale:Oa,tweakAxis:Hs,shouldRenderPrice:!1};if(!Gn)return ar;const er=Gn.names;if(!Object.keys(er).length)return ar;const{mode:As,candleStyle:bs,colorStrategy:rs}=vt,Zs={...ei,...vt.colors};let{open:hr,high:Vr,low:gs,close:os,volume:Ja}=er;if(hr==null||os==null)return ar;let Es=.5,sr=-1,cr=!1;if(Ja!=null&&As!==Ps.Candles){let zr=Gn.volume;if(zr!=null){cr=!0;let{fillOpacity:kr}=zr.config.custom;kr&&(Es=kr/100),As!==Ps.Volume&&(zr.config={...zr.config},zr.config.unit="short",zr.display=(0,to.J)({field:zr,theme:fe.config.theme2}),Hs=(ja,Va)=>{if(Va.name===Gn.volume?.name){let us=(tr,zs)=>{let rr=[],mr=tr.series[sr].max;for(let ho=0;ho<zs.length&&(rr.push(zs[ho]),!(mr&&zs[ho]>mr));ho++);return rr};ja.space=20,ja.filter=us,ja.ticks={...ja.ticks,filter:us}}return ja},Oa=(ja,Va)=>(Va.name===Gn.volume?.name&&(ja.range=(us,tr,zs)=>[0,zs*7]),ja))}}let xr=As!==Ps.Volume&&Vr!=null&&gs!=null;if(!xr&&!cr)return ar;let dr={},Nr=[];return xr?dr={open:hr,high:Vr,low:gs,close:os}:Nr.push(hr,os),cr&&(dr.volume=Ja,dr.open=hr,dr.close=os),{shouldRenderPrice:xr,renderers:[{fieldMap:dr,indicesOnly:Nr,init:(zr,kr)=>{sr=kr.volume,zr.addHook("drawAxes",Vi({mode:As,fields:kr,upColor:fe.config.theme2.visualization.getColorByName(Zs.up),downColor:fe.config.theme2.visualization.getColorByName(Zs.down),flatColor:fe.config.theme2.visualization.getColorByName(Zs.flat),volumeAlpha:Es,colorStrategy:rs,candleStyle:bs,flatAsUp:!0}))}}],tweakScale:Oa,tweakAxis:Hs}},[vt,J.structureRev,J.series.length]);if(!Gn)return C.createElement(ga.a,{panelId:Ee,fieldConfig:Nt,data:J,needsTimeField:!0,needsNumberField:!0});if(Ha)for(let Oa in Ka[0].fieldMap){let Hs=Gn[Oa];Hs.config={...Hs.config,custom:{...Hs.config.custom,hideFrom:{legend:!0,tooltip:!1,viz:!1}}}}const Ma=!!Nn?.();return C.createElement(io,{frames:[Gn.frame],structureRev:J.structureRev,timeRange:Ce,timeZone:Fe,width:He,height:it,legend:vt.legend,renderers:Ka,tweakAxis:aa,tweakScale:Ta,options:vt,replaceVariables:Zt,dataLinkPostProcessor:oa,cursorSync:Wa},(Oa,Hs)=>C.createElement(C.Fragment,null,C.createElement(On.Z,{config:Oa}),Wa!==Ko.yV.Off&&C.createElement(ha.K,{config:Oa,eventBus:da,frame:Hs}),vt.tooltip.mode!==Xe.$N.None&&C.createElement(Ms.xl,{config:Oa,hoverMode:vt.tooltip.mode===Xe.$N.Single?Ms.b3.xOne:Ms.b3.xAll,queryZoom:kt,clientZoom:!0,syncMode:Wa,syncScope:bn,render:(ar,er,As,bs=!1,rs,Zs,hr)=>{if(Ma&&Zs!=null){qa(Zs),rs();return}const Vr=()=>{let gs=ar.posToVal(ar.cursor.left,"x");qa({from:gs,to:gs}),rs()};return C.createElement(Dr.k,{series:Hs,dataIdxs:er,seriesIdx:As,mode:hr?Xe.$N.Multi:vt.tooltip.mode,sortOrder:vt.tooltip.sort,isPinned:bs,annotate:Ma?Vr:void 0,maxHeight:vt.tooltip.maxHeight})},maxWidth:vt.tooltip.maxWidth}),C.createElement(Ro.W,{annotations:J.annotations??[],config:Oa,timeZone:Fe,newRange:ea,setNewRange:qa}),C.createElement(Ca.U,{config:Oa,onChangeTimeRange:kt}),J.annotations&&C.createElement(Jn,{config:Oa,exemplars:J.annotations,timeZone:Fe}),(Wn&&mn||ba)&&C.createElement(fs,{config:Oa,fieldConfig:Nt,onThresholdsChange:Wn?mn:void 0})))};class yi{getSuggestionsForData(Ee){const{dataSummary:Ce}=Ee;if(!Ee.data?.series||!Ce.hasData||Ce.timeFieldCount<1||Ce.numberFieldCount<2||Ce.numberFieldCount>10)return;const Fe=Oi(Ee.data.series,ti,x.$.theme2);if(!Fe||Fe.open===Fe.high&&Fe.open===Fe.low)return;Ee.getListAppender({name:"",pluginId:"candlestick",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}).append({name:_a.m.Candlestick,options:ti,fieldConfig:{defaults:{},overrides:[]},score:Fe.autoOpenClose?tn.nQ.Good:tn.nQ.Best})}}const Ii=[{label:"Candles",value:Ps.Candles},{label:"Volume",value:Ps.Volume},{label:"Both",value:Ps.CandlesVolume}],bi=[{label:"Candles",value:Lr.Candles},{label:"OHLC Bars",value:Lr.OHLCBars}],$l=[{label:"Since Open",value:Gr.OpenClose},{label:"Since Prior Close",value:Gr.CloseClose}],Vl=J=>J.type===It.PU.number;function Ai(J,Ee,Ce){let Fe="Auto ";if(Ce){const He=Ce[Ee.key];He?.config?(Fe+="= "+(0,fr.Ct)(He),He===Ce?.open&&Ee.key!=="open"&&(Fe+=` (${Ee.defaults.join(",")})`)):Fe+=`(${Ee.defaults.join(",")})`}J.addFieldNamePicker({path:`fields.${Ee.key}`,name:Ee.name,description:Ee.description,settings:{filter:Vl,placeholderText:Fe}})}const Ri=new O.m(Zo).useFieldConfig((0,an.V)(an.S)).setPanelOptions((J,Ee)=>{const Ce=Ee.options??ti,Fe=Oi(Ee.data,Ce,x.$.theme2);J.addRadio({path:"mode",name:"Mode",description:"",defaultValue:ti.mode,settings:{options:Ii}}).addRadio({path:"candleStyle",name:"Candle style",description:"",defaultValue:ti.candleStyle,settings:{options:bi},showIf:He=>He.mode!==Ps.Volume}).addRadio({path:"colorStrategy",name:"Color strategy",description:"",defaultValue:ti.colorStrategy,settings:{options:$l}}).addColorPicker({path:"colors.up",name:"Up color",defaultValue:ei.up}).addColorPicker({path:"colors.down",name:"Down color",defaultValue:ei.down}),Ai(J,di.open,Fe),Ce.mode!==Ps.Volume&&(Ai(J,di.high,Fe),Ai(J,di.low,Fe)),Ai(J,di.close,Fe),Ce.mode!==Ps.Candles&&Ai(J,di.volume,Fe),J.addRadio({path:"includeAllFields",name:"Additional fields",description:"Use standard timeseries options to configure any fields not mapped above",defaultValue:ti.includeAllFields,settings:{options:[{label:"Ignore",value:!1},{label:"Include",value:!0}]}}),wn.D(J,!1,!0,Ce),sa.H(J)}).setDataSupport({annotations:!0,alertStates:!0}).setSuggestionsSupplier(new yi);var zl=e(36607),ul=e(76885),Di=e(40672),Os=e(6709),_e=e(29158),et=e(82467),st=e(10096),pt=e(16021),Wt=e(91219),Xt=e(28215),dn=e(27677),In=e(62301),Hn=e(80484);const ra=J=>({dashlistSectionHeader:(0,se.css)`
    padding: ${J.spacing(.25,1)};
    margin-right: ${J.spacing(1)};
  `,dashlistSection:(0,se.css)`
    margin-bottom: ${J.spacing(2)};
    padding-top: 3px;
  `,dashlistLink:(0,se.css)`
    display: flex;
    cursor: pointer;
    border-bottom: 1px solid ${J.colors.border.weak};
    margin-right: ${J.spacing(1)};
    padding: ${J.spacing(1)};
    align-items: center;

    &:hover {
      a {
        color: ${J.colors.text.link};
        text-decoration: underline;
      }
    }
  `,dashlistFolder:(0,se.css)`
    color: ${J.colors.text.secondary};
    font-size: ${J.typography.bodySmall.fontSize};
    line-height: ${J.typography.body.lineHeight};
  `,dashlistTitle:(0,se.css)`
    &::after {
      position: absolute;
      content: '';
      left: 0;
      top: 0;
      bottom: 0;
      right: 0;
    }
  `,dashlistLinkBody:(0,se.css)`
    flex-grow: 1;
    overflow: hidden;
    text-overflow: ellipsis;
  `,dashlistItem:(0,se.css)`
    position: relative;
    list-style: none;
  `});async function Ba(J,Ee){let Ce=Promise.resolve([]);if(J.showStarred){const ln={limit:J.maxItems,starred:"true"};Ce=(0,dn.AI)().search(ln)}let Fe=Promise.resolve([]),He=[];if(J.showRecentlyViewed){let ln=await In.A.getDashboardOpened();He=(0,w.take)(ln,J.maxItems),Fe=(0,dn.AI)().search({dashboardUIDs:He,limit:J.maxItems})}let it=Promise.resolve([]);if(J.showSearch){const ln=J.folderUID===""?"general":J.folderUID,bn={limit:J.maxItems,query:Ee(J.query,{},"text"),folderUIDs:ln,tag:J.tags.map(Nn=>Ee(Nn,{},"text")),type:"dash-db"};it=(0,dn.AI)().search(bn)}const[vt,Nt,kt]=await Promise.all([Ce,it,Fe]);let Zt=new Map;for(const ln of He){const bn=kt.find(Nn=>Nn.uid===ln);bn&&Zt.set(ln,{...bn,isRecent:!0})}return Nt.forEach(ln=>{ln.uid&&(Zt.has(ln.uid)?Zt.get(ln.uid).isSearchResult=!0:Zt.set(ln.uid,{...ln,isSearchResult:!0}))}),vt.forEach(ln=>{ln.uid&&(Zt.has(ln.uid)?Zt.get(ln.uid).isStarred=!0:Zt.set(ln.uid,{...ln,isStarred:!0}))}),Zt}function wa(J){const[Ee,Ce]=(0,C.useState)(new Map),Fe=(0,K.useDispatch)(),He=(0,K.useSelector)(Xn=>Xn.navIndex);(0,C.useEffect)(()=>{Ba(J.options,J.replaceVariables).then(Xn=>{Ce(Xn)})},[J.options,J.replaceVariables,J.renderCounter]);const it=async(Xn,Gn)=>{const{uid:ea,title:qa,url:Wa}=Gn;Xn.preventDefault(),Xn.stopPropagation();const Ka=await(0,Ie.UA)().starDashboard(Gn.uid,Gn.isStarred),Ta=new Map(Ee);Ta.set(Gn?.uid??"",{...Gn,isStarred:Ka}),Ce(Ta),Fe((0,Wt.ci)({id:ea??"",title:qa,url:Wa,isStarred:Ka}));const aa=He.starred;if(Ka)aa.children?.push({id:Wt.L1+ea,text:qa,url:Wa??"",parentItem:aa});else{Fe((0,Xt.Im)(Wt.L1+ea));const Ha=aa.children?.findIndex(Ma=>Ma.id===Wt.L1+ea);Ha&&aa.children?.splice(Ha,1)}Fe((0,et.Vz)(aa))},[vt,Nt,kt]=(0,C.useMemo)(()=>{const Xn=[...Ee.values()];return[Xn.filter(Gn=>Gn.isStarred).sort((Gn,ea)=>Gn.title.localeCompare(ea.title)),Xn.filter(Gn=>Gn.isRecent),Xn.filter(Gn=>Gn.isSearchResult).sort((Gn,ea)=>Gn.title.localeCompare(ea.title))]},[Ee]),{showStarred:Zt,showRecentlyViewed:ln,showHeadings:bn,showFolderNames:Nn,showSearch:mn}=J.options,Wn=[{header:"Starred dashboards",dashboards:vt,show:Zt},{header:"Recently viewed dashboards",dashboards:Nt,show:ln},{header:"Search",dashboards:kt,show:mn}],ba=(0,z.of)(ra),oa=Ua(J),da=Xn=>C.createElement("ul",null,Xn.map(Gn=>{let ea=Gn.url;return ea=ul.kM.appendQueryToUrl(ea,oa),ea=(0,fe.zj)().disableSanitizeHtml?ea:Di.sQ.sanitizeUrl(ea),C.createElement("li",{className:ba.dashlistItem,key:`dash-${Gn.uid}`},C.createElement("div",{className:ba.dashlistLink},C.createElement("div",{className:ba.dashlistLinkBody},C.createElement("a",{className:ba.dashlistTitle,href:ea},Gn.title),Nn&&Gn.folderTitle&&C.createElement("div",{className:ba.dashlistFolder},Gn.folderTitle)),C.createElement(_e.K,{tooltip:Gn.isStarred?`Unmark "${Gn.title}" as favorite`:`Mark "${Gn.title}" as favorite`,name:Gn.isStarred?"favorite":"star",iconType:Gn.isStarred?"mono":"default",onClick:qa=>it(qa,Gn)})))}));return C.createElement(q.E,{autoHeightMin:"100%",autoHeightMax:"100%"},Wn.map(({show:Xn,header:Gn,dashboards:ea},qa)=>Xn&&C.createElement("div",{className:ba.dashlistSection,key:`dash-group-${qa}`},bn&&C.createElement("h6",{className:ba.dashlistSectionHeader},Gn),da(ea))))}function Ua(J){(0,pt.u)(st.lE,Hn.og);let Ee={};return J.options.keepTime&&(Ee[`$${Os.c.keepTime}`]=!0),J.options.includeVars&&(Ee[`$${Os.c.includeVars}`]=!0),J.replaceVariables(ul.kM.toUrlParams(Ee))}async function Za(J){return J===0?"":(await(0,Kn.AI)().get(`/api/folders/id/${J}`,void 0,void 0,{showErrorAlert:!1})).uid}async function cs(J){const Ee={...J.options,showStarred:J.options.showStarred??J.starred,showRecentlyViewed:J.options.showRecentlyViewed??J.recent,showSearch:J.options.showSearch??J.search,showHeadings:J.options.showHeadings??J.headings,maxItems:J.options.maxItems??J.limit,query:J.options.query??J.query,folderId:J.options.folderId??J.folderId,tags:J.options.tags??J.tags};if(parseFloat(J.pluginVersion||"6.1")<6.3&&["starred","recent","search","headings","limit","query","folderId"].forEach(He=>delete J[He]),Ee.folderId!==void 0){const Fe=Ee.folderId;try{const He=await Za(Fe);Ee.folderUID=He,delete Ee.folderId}catch(He){console.warn("Dashlist: Error migrating folder ID to UID",He)}}return Ee}const Ya={includeVars:!1,keepTime:!1,maxItems:10,query:"",showFolderNames:!0,showHeadings:!0,showRecentlyViewed:!1,showSearch:!1,showStarred:!0,tags:[]},Ks=new O.m(wa).setPanelOptions(J=>{J.addBooleanSwitch({path:"keepTime",name:"Include current time range",defaultValue:Ya.keepTime}).addBooleanSwitch({path:"includeVars",name:"Include current template variable values",defaultValue:Ya.includeVars}).addBooleanSwitch({path:"showStarred",name:"Starred",defaultValue:Ya.showStarred}).addBooleanSwitch({path:"showRecentlyViewed",name:"Recently viewed",defaultValue:Ya.showRecentlyViewed}).addBooleanSwitch({path:"showSearch",name:"Search",defaultValue:Ya.showSearch}).addBooleanSwitch({path:"showHeadings",name:"Show headings",defaultValue:Ya.showHeadings}).addBooleanSwitch({path:"showFolderNames",name:"Show folder names",defaultValue:Ya.showFolderNames}).addNumberInput({path:"maxItems",name:"Max items",defaultValue:Ya.maxItems}).addTextInput({path:"query",name:"Query",defaultValue:Ya.query}).addCustomEditor({path:"folderUID",name:"Folder",id:"folderUID",defaultValue:void 0,editor:function({value:Ce,onChange:Fe}){return C.createElement(zl.d,{clearable:!0,permission:K.PermissionLevelString.View,value:Ce,onChange:He=>Fe(He)})}}).addCustomEditor({id:"tags",path:"tags",name:"Tags",description:"",defaultValue:Ya.tags,editor(Ee){return C.createElement(fn.u,{tags:Ee.value,onChange:Ee.onChange})}})}).setMigrationHandler(cs);var Ge=e(47187),Re=e(14110),qe=e(11503);const ut=({onBlur:J,placeholder:Ee})=>{const Ce=(0,C.useRef)(null);(0,C.useEffect)(()=>{Ce.current&&Ce.current.focus()});const Fe=He=>{He.key==="Enter"&&He.currentTarget.blur()};return C.createElement("input",{type:"text",placeholder:Ee,onBlur:J,ref:Ce,onKeyDown:Fe,"data-testid":"column-input"})},Ft=({divStyle:J,onColumnInputBlur:Ee})=>{const[Ce,Fe]=(0,C.useState)(!1),He=()=>{Fe(!0)},it=vt=>{const Nt=vt.target.value;Nt&&Ee(Nt),Fe(!1)};return C.createElement("div",{className:J},Ce?C.createElement(ut,{placeholder:"Column Name",onBlur:it}):C.createElement("button",{onClick:He},"+"))};var on=e(50311),sn=e(64539),Ln=e(59093),qn=e(28122),na=e(27183),Sa=e(69321);const ka=()=>x.$.featureToggles.enableDatagridEditing,Da="600 13px Inter",ds="400 13px Inter",Xa=document.createElement("canvas"),qs=20,Cs=300,Ss=65,fa="both",Fa="number",Na={isContextMenuOpen:!1},Is={isInputOpen:!1},pr="datagrid_panel",ir={EDIT_CELL:"edit_cell",GRID_SELECTED:"grid_selected",APPEND_ROW:"append_row",APPEND_COLUMN:"append_column",DELETE_BTN_PRESSED:"delete_btn_pressed",COLUMN_RESIZE:"column_resize",COLUMN_REORDER:"column_reorder",ROW_REORDER:"row_reorder",CONTEXT_MENU_ACTION:"context_menu_action",HEADER_MENU_ACTION:"header_menu_action"},fo={name:"A",fields:[],length:0},ss={kind:Sa.dd.Text,data:"",allowOverlay:!0,readonly:!1,displayData:""},wo={columns:Sa.I1.empty(),rows:Sa.I1.empty()},ui={sticky:!1,tint:!0},Sl={fill:!0,sticky:!1};async function _o(J,Ee){if(Ee&&ka()){for(let Ce=0;Ce<J.fields.length;Ce++)delete J.fields[Ce].config.displayName,delete J.fields[Ce].config.displayNameFromDS;return await Ee([J])}return!1}const Or=(J,Ee=!1)=>{const Ce=Xa.getContext("2d");return Ce.font=Ee?Da:ds,Ce.measureText(J).width},mi=J=>Math.max(Or(J.name,!0)+Ss,Math.min(Cs,J.values.toArray().reduce((Ee,Ce)=>{const Fe=Or(Ce?.toString()??"");return Fe>Ee?Fe:Ee},0)+qs)),ii=(J,Ee,Ce=!1)=>{const Fe={...J,fields:J.fields.map(He=>({...He,values:He.values.slice()}))};for(const He of Fe.fields){const it=He.values.toArray();for(let vt=Ee.length-1;vt>=0;vt--)Ce?it.splice(Ee[vt],1):it.splice(Ee[vt],1,null);He.values=[...it]}return{...Fe,length:Fe.fields[0]?.values.length??0}},Li=(J,Ee)=>{const Ce=Ee.x,Fe=Ee.y,He=Ee.x+Ee.width-1,it={...J,fields:J.fields.map(vt=>({...vt,values:vt.values.slice()}))};for(let vt=Ce;vt<=He;vt++){const Nt=it.fields[vt],kt=Nt.values.toArray();kt.splice(Fe,Ee.height,...new Array(Ee.height).fill(null)),Nt.values=[...kt]}return{...it,length:it.fields[0]?.values.length??0}},_c=J=>{const Ee=J.values.toArray();J.values=Ee.map(Ce=>Ce==="undefined"||Ce==="null"?null:Ce)};function ym(J){return{accentColor:J.colors.primary.main,accentFg:J.colors.secondary.main,textDark:J.colors.text.primary,textMedium:J.colors.text.secondary,textLight:J.colors.text.secondary,textBubble:J.colors.text.primary,textHeader:J.colors.text.primary,bgCell:J.colors.background.primary,bgCellMedium:J.colors.background.primary,bgHeader:J.colors.background.primary,bgHeaderHasFocus:J.colors.background.secondary,bgHeaderHovered:J.colors.background.secondary,linkColor:J.colors.text.link,fontFamily:J.typography.fontFamily,headerFontStyle:`${J.typography.fontWeightMedium} ${J.typography.fontSize}px`,fgIconHeader:J.colors.secondary.contrastText,bgIconHeader:J.colors.secondary.main}}const vc=(J,Ee,Ce=!1)=>{const Fe=J.values.get(Ee);switch(J.type){case It.PU.boolean:return{kind:Sa.dd.Boolean,data:Fe||!1,allowOverlay:!1,readonly:!1};case It.PU.number:return{kind:Sa.dd.Number,data:Fe||0,allowOverlay:ka()&&!Ce,readonly:!1,displayData:Fe!=null?Fe.toString():""};case It.PU.string:return{kind:Sa.dd.Text,data:Fe||"",allowOverlay:ka()&&!Ce,readonly:!1,displayData:Fe!=null?Fe.toString():""};default:return{kind:Sa.dd.Text,data:Fe||"",allowOverlay:ka()&&!Ce,readonly:!1,displayData:Fe!=null?Fe.toString():""}}},Tl=(J,Ee)=>({dataEditor:(0,se.css)`
      .dvn-scroll-inner > div:nth-child(2) {
        pointer-events: none !important;
      }
      scrollbar-color: ${J.colors.background.secondary} ${J.colors.background.primary};
      ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
      }
      ::-webkit-scrollbar-track {
        background: ${J.colors.background.primary};
      }
      ::-webkit-scrollbar-thumb {
        border-radius: 10px;
      }
      ::-webkit-scrollbar-corner {
        display: none;
      }
    `,addColumnDiv:(0,se.css)`
      width: 120px;
      display: flex;
      flex-direction: column;
      background-color: ${J.colors.background.primary};
      button {
        pointer-events: ${Ee?"none":"auto"};
        border: none;
        outline: none;
        height: 37px;
        font-size: 20px;
        background-color: ${J.colors.background.primary};
        color: ${J.colors.text.primary};
        border-right: 1px solid ${J.components.panel.borderColor};
        border-bottom: 1px solid ${J.components.panel.borderColor};
        transition: background-color 200ms;
        cursor: pointer;
        :hover {
          background-color: ${J.colors.background.secondary};
        }
      }
      input {
        height: 37px;
        border: 1px solid ${J.colors.primary.main};
        :focus {
          outline: none;
        }
      }
    `,renameColumnInput:(0,se.css)`
      height: 37px;
      border: 1px solid ${J.colors.primary.main};
      :focus {
        outline: none;
      }
    `}),Wd=J=>J.rows.length||J.columns.length?!0:J.current===void 0?!1:J.current.range&&!(J.current.range.height===1&&J.current.range.width===1);var Oo=(J=>(J.columnResizeStart="columnResizeStart",J.columnResizeEnd="columnResizeEnd",J.columnMove="columnMove",J.updateColumns="updateColumns",J.showColumnRenameInput="showColumnRenameInput",J.hideColumnRenameInput="hideColumnRenameInput",J.openCellContextMenu="openCellContextMenu",J.openHeaderContextMenu="openHeaderContextMenu",J.openHeaderDropdownMenu="openHeaderDropdownMenu",J.closeContextMenu="closeContextMenu",J.multipleCellsSelected="multipleCellsSelected",J.gridSelectionCleared="gridSelectionCleared",J.columnFreezeReset="columnFreezeReset",J.columnFreezeChanged="columnFreezeChanged",J.openSearch="openSearch",J.closeSearch="closeSearch",J))(Oo||{});const Kd={columns:[],contextMenuData:Na,renameColumnInputData:Is,gridSelection:wo,columnFreezeIndex:0,toggleSearch:!1,isResizeInProgress:!1},$d=new Map([[It.PU.number,Sa.Gf.HeaderNumber],[It.PU.string,Sa.Gf.HeaderTextTemplate],[It.PU.boolean,Sa.Gf.HeaderBoolean],[It.PU.time,Sa.Gf.HeaderDate],[It.PU.other,Sa.Gf.HeaderReference]]),bm=(J,Ee)=>{let Ce=[];switch(Ee.type){case"columnResizeStart":Ce=[...J.columns];const Fe=Ee.payload;return Ce[Fe.columnIndex]={...J.columns[Fe.columnIndex],width:Fe.width},{...J,columns:Ce,isResizeInProgress:!0};case"columnMove":Ce=[...J.columns];const He=Ee.payload,it=J.columns[He.from].width;let vt=Ce.splice(He.from,1)[0];return vt={...vt,width:it},Ce.splice(He.to,0,vt),{...J,columns:Ce};case"columnResizeEnd":return{...J,isResizeInProgress:!1};case"updateColumns":const Nt=Ee.payload;return Ce=[...Nt.frame.fields.map((da,Xn)=>{const Gn=J.columns.find(qa=>qa.title===da.name)?.width;return{title:(0,fr.Ct)(da,Nt.frame),width:Gn??mi(da),icon:$d.get(da.type),hasMenu:ka(),trailingRowOptions:{targetColumn:--Xn}}})],{...J,columns:Ce};case"showColumnRenameInput":return{...J,renameColumnInputData:{...J.renameColumnInputData,isInputOpen:!0}};case"hideColumnRenameInput":return{...J,renameColumnInputData:{...J.renameColumnInputData,isInputOpen:!1}};case"openCellContextMenu":const kt=Ee.payload,Zt=kt.event,ln=kt.cell;return{...J,contextMenuData:{x:Zt.bounds.x+Zt.localEventX,y:Zt.bounds.y+Zt.localEventY,column:ln[0]===-1?void 0:ln[0],row:ln[1],isContextMenuOpen:!0,isHeaderMenu:!1}};case"openHeaderContextMenu":const bn=Ee.payload,Nn=bn.event;return{...J,contextMenuData:{x:Nn.bounds.x+Nn.localEventX,y:Nn.bounds.y+Nn.localEventY,column:bn.columnIndex,row:void 0,isContextMenuOpen:!0,isHeaderMenu:!1}};case"openHeaderDropdownMenu":const mn=Ee.payload,Wn=mn.screenPosition;return{...J,contextMenuData:{x:Wn.x+Wn.width,y:Wn.y+Wn.height,column:mn.columnIndex,row:void 0,isContextMenuOpen:!0,isHeaderMenu:!0},renameColumnInputData:{x:Wn.x,y:Wn.y,width:Wn.width,height:Wn.height,columnIdx:mn.columnIndex,isInputOpen:!1,inputValue:mn.value}};case"closeContextMenu":return{...J,contextMenuData:{isContextMenuOpen:!1}};case"closeSearch":return{...J,toggleSearch:!1};case"openSearch":return{...J,toggleSearch:!0};case"multipleCellsSelected":const ba=Ee.payload;return{...J,gridSelection:ba.selection};case"gridSelectionCleared":return{...J,gridSelection:wo};case"columnFreezeReset":return{...J,columnFreezeIndex:0};case"columnFreezeChanged":const oa=Ee.payload;return{...J,columnFreezeIndex:oa.columnIndex};default:return J}},Dm=({menuData:J,data:Ee,saveData:Ce,closeContextMenu:Fe,dispatch:He,gridSelection:it,columnFreezeIndex:vt,renameColumnClicked:Nt})=>{let kt=[],Zt=[];const{row:ln,column:bn,x:Nn,y:mn,isHeaderMenu:Wn}=J;it.rows&&(kt=it.rows.toArray()),it.columns&&(Zt=it.columns.toArray());let ba="Delete row";kt.length&&kt.length>1&&(ba=`Delete ${kt.length} rows`);let oa="Delete column";Zt.length&&Zt.length>1&&(oa=`Delete ${Zt.length} columns`);const da=ln!==void 0&&ln>=0||kt.length,Xn=bn!==void 0&&bn>=0&&ln!==void 0||Zt.length,Gn=ln!==void 0&&ln>=0&&!kt.length,ea=bn!==void 0&&bn>=0&&ln!==void 0&&!Zt.length,qa=()=>C.createElement(C.Fragment,null,da?C.createElement(sn.D,{label:ba,onClick:()=>{if(kt.length){Ce(ii(Ee,kt,!0)),He({type:Oo.gridSelectionCleared});return}ln!==void 0&&ln>=0&&((0,Re.rR)(pr,{item:ir.CONTEXT_MENU_ACTION,menu_action:"row_delete"}),Ce(ii(Ee,[ln],!0)))}}):null,Xn?C.createElement(sn.D,{label:oa,onClick:()=>{if(Zt.length){Ce({...Ee,fields:Ee.fields.filter((Ka,Ta)=>!Zt.includes(Ta))}),He({type:Oo.gridSelectionCleared});return}bn!==void 0&&bn>=0&&((0,Re.rR)(pr,{item:ir.CONTEXT_MENU_ACTION,menu_action:"column_delete"}),Ce({...Ee,fields:Ee.fields.filter((Ka,Ta)=>Ta!==bn)}))}}):null,Xn||da?C.createElement(na.N,null):null,Gn?C.createElement(sn.D,{label:"Clear row",onClick:()=>{(0,Re.rR)(pr,{item:ir.CONTEXT_MENU_ACTION,menu_action:"row_clear"}),Ce(ii(Ee,[ln]))}}):null,ea?C.createElement(sn.D,{label:"Clear column",onClick:()=>{const Ka=Ee.fields[bn];Ka.values=Ka.values.map(()=>null),(0,Re.rR)(pr,{item:ir.CONTEXT_MENU_ACTION,menu_action:"column_clear"}),Ce({...Ee})}}):null,Gn||ea?C.createElement(na.N,null):null,C.createElement(sn.D,{label:"Remove all data",onClick:()=>{(0,Re.rR)(pr,{item:ir.CONTEXT_MENU_ACTION,menu_action:"remove_all"}),Ce(fo)}}),C.createElement(sn.D,{label:"Search...",onClick:()=>{(0,Re.rR)(pr,{item:ir.CONTEXT_MENU_ACTION,menu_action:"open_search"}),He({type:Oo.openSearch})}})),Wa=()=>{if(bn==null)return null;const Ka=Ee.fields[bn].type,Ta=[],aa=Oa=>{Ta.push({label:(0,w.capitalize)(Oa),options:{targetField:Ee.fields[bn].name,destinationType:Oa}})};Ka===It.PU.string?(aa(It.PU.number),aa(It.PU.boolean)):Ka===It.PU.number?(aa(It.PU.string),aa(It.PU.boolean)):Ka===It.PU.boolean?(aa(It.PU.number),aa(It.PU.string)):(aa(It.PU.string),aa(It.PU.number),aa(It.PU.boolean));let Ha="Set column freeze position";const Ma=bn+1;return vt===Ma&&(Ha="Unset column freeze"),C.createElement(C.Fragment,null,Ta.length?C.createElement(Ln.r,{label:"Set field type"},Ta.map((Oa,Hs)=>C.createElement(sn.D,{key:Hs,label:Oa.label,onClick:()=>{const ar=(0,on.s7)(Ee.fields[bn],Oa.options);Oa.options.destinationType===It.PU.string&&_c(ar);const er={name:Ee.name,fields:[...Ee.fields],length:Ee.length};er.fields[bn]=ar,(0,Re.rR)(pr,{item:ir.HEADER_MENU_ACTION,menu_action:"convert_field"}),Ce(er)}}))):null,C.createElement(na.N,null),C.createElement(sn.D,{label:Ha,onClick:()=>{(0,Re.rR)(pr,{item:ir.HEADER_MENU_ACTION,menu_action:"column_freeze"}),He(vt===Ma?{type:Oo.columnFreezeReset}:{type:Oo.columnFreezeChanged,payload:{columnIndex:Ma}})}}),C.createElement(sn.D,{label:"Rename column",onClick:Nt}),C.createElement(na.N,null),C.createElement(sn.D,{label:"Delete column",onClick:()=>{(0,Re.rR)(pr,{item:ir.HEADER_MENU_ACTION,menu_action:"delete_column"}),Ce({...Ee,fields:Ee.fields.filter((Oa,Hs)=>Hs!==bn)}),He({type:Oo.gridSelectionCleared})}}),C.createElement(sn.D,{label:"Clear column",onClick:()=>{const Oa=Ee.fields[bn];Oa.values=Oa.values.map(()=>null),(0,Re.rR)(pr,{item:ir.HEADER_MENU_ACTION,menu_action:"clear_column"}),Ce({...Ee})}}))};return C.createElement(qn.t,{renderMenuItems:Wn?Wa:qa,x:Nn,y:mn,onClose:Fe})},ml=({renameColumnData:J,onColumnInputBlur:Ee,classStyle:Ce})=>{const{x:Fe,y:He,width:it,height:vt,inputValue:Nt,columnIdx:kt}=J,[Zt,ln]=(0,C.useState)({}),[bn,Nn]=(0,C.useState)(Nt),mn=(0,C.useRef)(null);(0,C.useLayoutEffect)(()=>{mn.current?.focus();const da=mn.current?.getBoundingClientRect();if(da){const Xn={right:window.innerWidth<Fe+da.width,bottom:window.innerHeight<He+da.height};ln({position:"fixed",left:Xn.right?Fe-da.width:Fe,top:Xn.bottom?He-da.height:He,width:it,height:vt})}},[vt,it,Fe,He]);const Wn=da=>{const Xn=da.target.value;Xn&&Ee(Xn,kt)},ba=da=>{Nn(da.target.value)},oa=da=>{da.key==="Enter"&&da.currentTarget.blur()};return C.createElement($r.ZL,null,C.createElement("input",{type:"text",className:Ce,value:bn,onBlur:Wn,ref:mn,style:Zt,onChange:ba,onKeyDown:oa}))};function Pm({options:J,data:Ee,id:Ce,fieldConfig:Fe,width:He,height:it}){const[vt,Nt]=(0,C.useReducer)(bm,Kd),{onUpdateData:kt}=(0,cn.d2)(),{columns:Zt,contextMenuData:ln,renameColumnInputData:bn,gridSelection:Nn,columnFreezeIndex:mn,toggleSearch:Wn,isResizeInProgress:ba}=vt,oa=Ee.series[J.selectedSeries??0],da=(0,z.$j)(),Xn=ym(da);(0,C.useEffect)(()=>{oa&&Nt({type:Oo.updateColumns,payload:{frame:oa}})},[oa]);const Gn=([gs,os])=>{const Ja=oa.fields[gs];return!Ja||os>oa.length?ss:vc(Ja,os,Wd(Nn))},ea=(gs,os)=>{if(Wd(Nn))return;const[Ja,Es]=gs,sr={...oa,fields:oa.fields.map(dr=>({...dr,values:[...dr.values]}))},cr=sr.fields[Ja];if(!cr)return;const xr=cr.values.toArray();xr[Es]=os.data,cr.values=[...xr],(0,Re.rR)(pr,{item:ir.EDIT_CELL}),_o(sr,kt)},qa=gs=>{const os=oa.length??0;(0,Re.rR)(pr,{item:ir.APPEND_COLUMN}),_o({...oa,fields:[...oa.fields,{name:gs,type:It.PU.string,config:{},values:new Array(os).fill("")}]},kt)},Wa=()=>{const gs=oa.fields.map(os=>{const Ja=os.values.slice();return Ja.push(null),{...os,values:Ja}});(0,Re.rR)(pr,{item:ir.APPEND_ROW}),_o({...oa,fields:gs,length:oa.length+1},kt)},Ka=(gs,os,Ja,Es)=>{(0,Re.rR)(pr,{item:ir.COLUMN_RESIZE}),Nt({type:Oo.columnResizeStart,payload:{columnIndex:Ja,width:os}})},Ta=(gs,os,Ja,Es)=>{Nt({type:Oo.columnResizeEnd})},aa=()=>{Nt({type:Oo.closeContextMenu})},Ha=gs=>{if(gs.current&&gs.current.range)return(0,Re.rR)(pr,{item:ir.DELETE_BTN_PRESSED,selection:"grid-cell"}),_o(Li(oa,gs.current.range),kt),!0;const os=gs.rows.toArray(),Ja=gs.columns.toArray();if(os.length)return(0,Re.rR)(pr,{item:ir.DELETE_BTN_PRESSED,selection:"rows"}),_o(ii(oa,os),kt),!0;if(Ja.length){const Es={...oa,fields:oa.fields.map((sr,cr)=>Ja.includes(cr)?{...sr,values:new Array(oa.length).fill(null)}:sr)};return(0,Re.rR)(pr,{item:ir.DELETE_BTN_PRESSED,selection:"columns"}),_o(Es,kt),!0}return!1},Ma=(gs,os)=>{os.preventDefault(),Nt({type:Oo.openCellContextMenu,payload:{event:os,cell:gs}})},Oa=(gs,os)=>{os.preventDefault(),Nt({type:Oo.openHeaderContextMenu,payload:{event:os,columnIndex:gs}})},Hs=(gs,os)=>{Nt({type:Oo.openHeaderDropdownMenu,payload:{screenPosition:os,columnIndex:gs,value:vt.columns[gs].title}})},ar=async(gs,os)=>{const Ja=oa.fields.map(cr=>cr),Es=Ja[gs];Ja.splice(gs,1),Ja.splice(os,0,Es),await _o({...oa,fields:Ja},kt)&&((0,Re.rR)(pr,{item:ir.COLUMN_REORDER}),Nt({type:Oo.columnMove,payload:{from:gs,to:os}}))},er=(gs,os)=>{const Ja=oa.fields.map(Es=>({...Es,values:Es.values.slice()}));for(const Es of Ja){const sr=Es.values[gs];Es.values.splice(gs,1),Es.values.splice(os,0,sr)}(0,Re.rR)(pr,{item:ir.ROW_REORDER}),_o({...oa,fields:Ja},kt)},As=()=>{(0,Re.rR)(pr,{item:ir.HEADER_MENU_ACTION,menu_action:"rename_column"}),Nt({type:Oo.showColumnRenameInput})},bs=(gs,os)=>{const Ja=oa.fields.map(Es=>Es);Ja[os].name=gs,Nt({type:Oo.hideColumnRenameInput}),_o({...oa,fields:Ja},kt)},rs=()=>{Nt({type:Oo.closeSearch})},Zs=gs=>{(0,Re.rR)(pr,{item:ir.GRID_SELECTED}),Nt({type:Oo.multipleCellsSelected,payload:{selection:gs}})},hr=gs=>{_o(gs,kt)};if(!oa)return C.createElement(ga.a,{panelId:Ce,fieldConfig:Fe,data:Ee});if(!ka())return C.createElement(ga.a,{panelId:Ce,message:"Datagrid is not enabled",fieldConfig:Fe,data:Ee});if(!document.getElementById("portal")){const gs=document.createElement("div");gs.id="portal",document.body.appendChild(gs)}const Vr=Tl(da,ba);return C.createElement(C.Fragment,null,C.createElement(Ge.D,{className:Vr.dataEditor,getCellContent:Gn,columns:Zt,rows:oa.length,width:He,height:it,initialSize:[He,it],theme:Xn,smoothScrollX:!0,smoothScrollY:!0,overscrollY:50,onCellEdited:ka()?ea:void 0,getCellsForSelection:ka()?!0:void 0,showSearch:ka()?Wn:!1,onSearchClose:rs,gridSelection:Nn,onGridSelectionChange:ka()?Zs:void 0,onRowAppended:ka()?Wa:void 0,onDelete:ka()?Ha:void 0,rowMarkers:ka()?fa:Fa,onColumnResize:Ka,onColumnResizeEnd:Ta,onCellContextMenu:ka()?Ma:void 0,onHeaderContextMenu:ka()?Oa:void 0,onHeaderMenuClick:ka()?Hs:void 0,trailingRowOptions:ui,rightElement:ka()?C.createElement(Ft,{onColumnInputBlur:qa,divStyle:Vr.addColumnDiv}):null,rightElementProps:Sl,freezeColumns:mn,onRowMoved:ka()?er:void 0,onColumnMoved:ka()?ar:void 0}),ln.isContextMenuOpen&&C.createElement(Dm,{menuData:ln,data:oa,saveData:hr,closeContextMenu:aa,dispatch:Nt,gridSelection:Nn,columnFreezeIndex:mn,renameColumnClicked:As}),bn.isInputOpen?C.createElement(ml,{onColumnInputBlur:bs,renameColumnData:bn,classStyle:Vr.renameColumnInput}):null)}const Vd={selectedSeries:0},Cm=new O.m(Pm).setPanelOptions((J,Ee)=>{const Ce=Ee.data.map((Fe,He)=>({value:He,label:Fe.refId}));return Ee.options&&!Ce.map(Fe=>Fe.value).includes(Ee.options.selectedSeries??0)&&(Ee.options.selectedSeries=Vd.selectedSeries),J.addSelect({path:"selectedSeries",name:"Select series",defaultValue:Vd.selectedSeries,settings:{options:Ce}})});var li=e(1819);class Sm extends C.Component{constructor(){super(...arguments),this.subscription=new Tt.yU,this.state={}}componentDidMount(){const{eventBus:Ee}=this.props;this.subscription.add(Ee.subscribe(Cn.b_,Ce=>{this.setState({event:Ce})})),this.subscription.add(Ee.subscribe(Cn.ql,Ce=>{this.setState({event:Ce})})),this.subscription.add(Ee.subscribe(Yt.kb,Ce=>{this.setState({event:Ce})})),this.subscription.add(Ee.subscribe(Yt.Tq,Ce=>{this.setState({event:Ce})}))}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{event:Ee}=this.state;if(!Ee)return C.createElement("div",null,"no events yet");const{type:Ce,payload:Fe,origin:He}=Ee;return C.createElement(q.E,{autoHeightMin:"100%",autoHeightMax:"100%"},C.createElement("h3",null,"Origin: ",He?.path),C.createElement("span",null,"Type: ",Ce),!!Fe&&C.createElement(C.Fragment,null,C.createElement("pre",null,JSON.stringify(Fe.point,null,"  ")),Fe.data&&C.createElement(li.e,{data:Fe.data,rowIndex:Fe.rowIndex,columnIndex:Fe.columnIndex})))}}var zd=e(36120);let kd=100;class Tm extends C.PureComponent{constructor(Ee){super(Ee),this.history=new zd.$({capacity:40,append:"head"}),this.eventObserver={next:Fe=>{const He=Fe.origin;this.history.add({key:kd++,type:Fe.type,path:He?.path,payload:Fe.payload}),this.setState({counter:kd})}},this.state={counter:kd};const Ce=[];Ce.push(Ee.eventBus.getStream(Cn.b_).subscribe(this.eventObserver)),Ce.push(Ee.eventBus.getStream(Cn.ql).subscribe(this.eventObserver)),Ce.push(Ee.eventBus.getStream(Cn.LO).subscribe(this.eventObserver)),this.subs=Ce}componentWillUnmount(){for(const Ee of this.subs)Ee.unsubscribe()}render(){return C.createElement(q.E,{autoHeightMin:"100%",autoHeightMax:"100%"},this.history.map((Ee,Ce)=>C.createElement("div",{key:Ee.key},JSON.stringify(Ee.path)," ",Ee.type," / X:",JSON.stringify(Ee.payload.x)," / Y:",JSON.stringify(Ee.payload.y))))}}var Hc=e(21423),fl=e(75059);class Mm extends C.Component{constructor(){super(...arguments),this.lastRender=Date.now(),this.counters={render:0,dataChanged:0,schemaChanged:0},this.resetCounters=()=>{this.counters={render:0,dataChanged:0,schemaChanged:0},this.forceUpdate()}}shouldComponentUpdate(Ee){const{data:Ce,options:Fe}=this.props;if(Ee.data!==Ce&&(this.counters.dataChanged++,Fe.counters?.schemaChanged)){const He=Ee.data?.series,it=Ce.series;it&&He&&((0,Hc.J3)(it,He,Hc.bW)||this.counters.schemaChanged++)}return!0}render(){const{data:Ee,options:Ce}=this.props,Fe=Ce.counters??{render:!1,dataChanged:!1,schemaChanged:!1};this.counters.render++;const He=Date.now(),it=He-this.lastRender;this.lastRender=He;const vt=fl.AS.get(fl.gy.lastNotNull);return C.createElement("div",null,C.createElement("div",null,C.createElement(_e.K,{name:"step-backward",title:"reset counters",onClick:this.resetCounters,tooltip:"Step back"}),C.createElement("span",null,Fe.render&&C.createElement("span",null,"Render: ",this.counters.render,"\xA0"),Fe.dataChanged&&C.createElement("span",null,"Data: ",this.counters.dataChanged,"\xA0"),Fe.schemaChanged&&C.createElement("span",null,"Schema: ",this.counters.schemaChanged,"\xA0"),C.createElement("span",null,"TIME: ",it,"ms"))),Ee.series&&Ee.series.map((Nt,kt)=>C.createElement("div",{key:`${kt}/${Nt.refId}`},C.createElement("h4",null,(0,fr.Ri)(Nt,kt)," (",Nt.length,")"),C.createElement("table",{className:"filter-table"},C.createElement("thead",null,C.createElement("tr",null,C.createElement("td",null,"Field"),C.createElement("td",null,"Type"),C.createElement("td",null,"Last"))),C.createElement("tbody",null,Nt.fields.map((Zt,ln)=>{const bn=vt.reduce(Zt,!1,!1)[vt.id];return C.createElement("tr",{key:`${ln}/${Zt.name}`},C.createElement("td",null,(0,fr.Ct)(Zt,Nt,Ee.series)),C.createElement("td",null,Zt.type),C.createElement("td",null,`${bn}`))}))))))}}var zi=e(88575),_d=e(10354);function xm(J){const Ee=(0,cn.d2)(),Ce=Fe=>{Ee.onInstanceStateChange({name:Fe.currentTarget.value})};return C.createElement(C.Fragment,null,C.createElement(zi.D,{label:"State name"},C.createElement(_d.p,{value:Ee.instanceState?.name??"",onChange:Ce})))}function Pi({value:J,context:Ee,onChange:Ce,item:Fe}){return C.createElement("div",null,"Current value: ",Ee.instanceState?.name," ")}var Fo=(J=>(J.Cursor="cursor",J.Events="events",J.Render="render",J.State="State",J.ThrowError="ThrowError",J))(Fo||{});class kl extends C.Component{render(){const{options:Ee}=this.props;switch(Ee.mode){case Fo.Events:return C.createElement(Tm,{eventBus:this.props.eventBus});case Fo.Cursor:return C.createElement(Sm,{eventBus:this.props.eventBus});case Fo.State:return C.createElement(xm,{...this.props});case Fo.ThrowError:throw new Error("I failed you and for that i am deeply sorry");default:return C.createElement(Mm,{...this.props})}}}const Ec=new O.m(kl).useFieldConfig().setPanelOptions(J=>{J.addSelect({path:"mode",name:"Mode",defaultValue:Fo.Render,settings:{options:[{label:"Render",value:Fo.Render},{label:"Events",value:Fo.Events},{label:"Cursor",value:Fo.Cursor},{label:"Cursor",value:Fo.Cursor},{label:"Share state",value:Fo.State},{label:"Throw error",value:Fo.ThrowError}]}}).addCustomEditor({id:"stateView",path:"stateView",name:"State view",defaultValue:"",showIf:({mode:Ee})=>Ee===Fo.State,editor:Pi}).addBooleanSwitch({path:"counters.render",name:"Render Count",defaultValue:!0,showIf:({mode:Ee})=>Ee===Fo.Render}).addBooleanSwitch({path:"counters.dataChanged",name:"Data Changed Count",defaultValue:!0,showIf:({mode:Ee})=>Ee===Fo.Render}).addBooleanSwitch({path:"counters.schemaChanged",name:"Schema Changed Count",defaultValue:!0,showIf:({mode:Ee})=>Ee===Fo.Render}).addDashboardPicker({path:"dashboardUID",name:"Dashboard",settings:{placeholder:"Select dashboard",isClearable:!0}})});var Gc=e(76365),Om=e(85194);function yc(J,Ee={}){(0,Re.rR)(`grafana_flamegraph_${J}`,{app:A.Jk.Unknown,grafana_version:x.$.buildInfo.version,...Ee})}const Im=J=>{const Ee=(0,Gc.oA)(J.data.series[0]);return Ee?C.createElement(ga.a,{panelId:J.id,data:J.data,message:(0,Gc.Ik)(Ee)}):C.createElement(Om.A,{data:J.data.series[0],stickyHeader:!1,getTheme:()=>x.$.theme2,showFlameGraphOnly:J.options?.showFlameGraphOnly??!1,onTableSymbolClick:()=>yc("table_item_selected"),onViewSelected:Ce=>yc("view_selected",{view:Ce}),onTextAlignSelected:Ce=>yc("text_align_selected",{align:Ce}),onTableSort:Ce=>yc("table_sort_selected",{sort:Ce}),disableCollapsing:!x.$.featureToggles.flameGraphItemCollapsing})};class Am{getListWithDefaults(Ee){return Ee.getListAppender({name:_a.m.FlameGraph,pluginId:"flamegraph"})}getSuggestionsForData(Ee){if(!Ee.data)return;const Ce=Ee.data.series[0];!Ce||(0,Gc.oA)(Ce)||this.getListWithDefaults(Ee).append({name:_a.m.FlameGraph})}}const Rm=new O.m(Im).setSuggestionsSupplier(new Am);var Hd=e(14738),Gd=e(62930);const Lm=(J,Ee)=>{const Ce="linear-gradient(to right, #5182CC 0%, #245BAF 100%)",Fe=Ee?Ce:"linear-gradient(to right, #f05a28 0%, #fbca0a 100%)",He=Ee?Ce:"linear-gradient(to right, #FBCA0A 0%, #F05A28 100%)",it=J.isDark?Fe:He;return`
      background-color: ${J.colors.background.secondary};
      margin-right: ${J.spacing(4)};
      border: 1px solid ${J.colors.border.weak};
      border-bottom-left-radius: ${J.shape.borderRadius(2)};
      border-bottom-right-radius: ${J.shape.borderRadius(2)};
      position: relative;
      max-height: 230px;

      ${J.breakpoints.down("xxl")} {
        margin-right: ${J.spacing(2)};
      }
      &::before {
        display: block;
        content: ' ';
        position: absolute;
        left: 0;
        right: 0;
        height: 2px;
        top: 0;
        background-image: ${it};
      }
`},jc=(0,se.css)`
  padding: 16px;
`,Zg=({card:J})=>{const Ee=(0,z.of)(Xg,J.done);return C.createElement("div",{className:Ee.card},C.createElement("div",{className:jc},C.createElement("a",{href:`${J.href}?utm_source=grafana_gettingstarted`,className:Ee.url,onClick:()=>(0,Re.rR)("grafana_getting_started_docs",{title:J.title,link:J.href})},C.createElement("div",{className:Ee.heading},J.done?"complete":J.heading),C.createElement("h4",{className:Ee.title},J.title))),C.createElement("a",{href:`${J.learnHref}?utm_source=grafana_gettingstarted`,className:Ee.learnUrl,target:"_blank",rel:"noreferrer",onClick:()=>(0,Re.rR)("grafana_getting_started_docs",{title:J.title,link:J.learnHref})},"Learn how in the docs ",C.createElement(V.I,{name:"external-link-alt"})))},Xg=(J,Ee)=>({card:(0,se.css)`
      ${Lm(J,Ee)}

      min-width: 230px;

      ${J.breakpoints.down("md")} {
        min-width: 192px;
      }
    `,heading:(0,se.css)`
      text-transform: uppercase;
      color: ${Ee?J.v1.palette.blue95:"#FFB357"};
      margin-bottom: ${J.spacing(2)};
    `,title:(0,se.css)`
      margin-bottom: ${J.spacing(2)};
    `,url:(0,se.css)`
      display: inline-block;
    `,learnUrl:(0,se.css)`
      border-top: 1px solid ${J.colors.border.weak};
      position: absolute;
      bottom: 0;
      padding: 8px 16px;
      width: 100%;
    `});var Qc=e(33390);const jd=({card:J})=>{const Ee=(0,z.of)(Bm,J.done);return C.createElement("a",{className:Ee.card,target:"_blank",rel:"noreferrer",href:`${J.href}?utm_source=grafana_gettingstarted`,onClick:Ce=>qg(Ce,J)},C.createElement("div",{className:jc},C.createElement("div",{className:Ee.type},J.type),C.createElement("div",{className:Ee.heading},J.done?"complete":J.heading),C.createElement("h4",{className:Ee.cardTitle},J.title),C.createElement("div",{className:Ee.info},J.info)))},qg=(J,Ee)=>{J.preventDefault(),Qc.A.get(Ee.key)||Qc.A.set(Ee.key,!0),(0,Re.rR)("grafana_getting_started_tutorial",{title:Ee.title})},Bm=(J,Ee)=>({card:(0,se.css)`
      ${Lm(J,Ee)}
      width: 460px;
      min-width: 460px;

      ${J.breakpoints.down("xl")} {
        min-width: 368px;
      }

      ${J.breakpoints.down("lg")} {
        min-width: 272px;
      }
    `,type:(0,se.css)`
      color: ${J.colors.primary.text};
      text-transform: uppercase;
    `,heading:(0,se.css)`
      text-transform: uppercase;
      color: ${J.colors.primary.text};
      margin-bottom: ${J.spacing(1)};
    `,cardTitle:(0,se.css)`
      margin-bottom: ${J.spacing(2)};
    `,info:(0,se.css)`
      margin-bottom: ${J.spacing(2)};
    `,status:(0,se.css)`
      display: flex;
      justify-content: flex-end;
    `}),Qd=({step:J})=>{const Ee=(0,z.of)(Yd);return C.createElement("div",{className:Ee.setup},C.createElement("div",{className:Ee.info},C.createElement("h2",{className:Ee.title},J.title),C.createElement("p",null,J.info)),C.createElement("div",{className:Ee.cards},J.cards.map((Ce,Fe)=>{const He=`${Ce.title}-${Fe}`;return Ce.type==="tutorial"?C.createElement(jd,{key:He,card:Ce}):C.createElement(Zg,{key:He,card:Ce})})))},Yd=J=>({setup:(0,se.css)({display:"flex",width:"95%"}),info:(0,se.css)({width:"172px",marginRight:"5%",[J.breakpoints.down("xxl")]:{marginRight:J.spacing(4)},[J.breakpoints.down("sm")]:{display:"none"}}),title:(0,se.css)({color:J.v1.palette.blue95}),cards:(0,se.css)({overflowX:"auto",overflowY:"hidden",width:"100%",display:"flex",justifyContent:"flex-start"})});var Yc=e(31193);const Ml="Grafana fundamentals",Jd="Create users and teams",Zd="getting.started.",Xd=`${Zd}${Ml.replace(" ","-").trim().toLowerCase()}`,Jc=`${Zd}${Jd.replace(" ","-").trim().toLowerCase()}`,qd=()=>[{heading:"Welcome to Grafana",subheading:"The steps below will guide you to quickly finish setting up your Grafana installation.",title:"Basic",info:"The steps below will guide you to quickly finish setting up your Grafana installation.",done:!1,cards:[{type:"tutorial",heading:"Data source and dashboards",title:Ml,info:"Set up and understand Grafana if you have no prior experience. This tutorial guides you through the entire process and covers the \u201CData source\u201D and \u201CDashboards\u201D steps to the right.",href:"https://grafana.com/tutorials/grafana-fundamentals",icon:"grafana",check:()=>Promise.resolve(Qc.A.get(Xd)),key:Xd,done:!1},{type:"docs",title:"Add your first data source",heading:"data sources",icon:"database",learnHref:"https://grafana.com/docs/grafana/latest/features/datasources/add-a-data-source",href:"datasources/new",check:()=>new Promise(J=>{J((0,Yc.tR)().getMetricSources().filter(Ee=>Ee.meta.builtIn!==!0).length>0)}),done:!1},{type:"docs",heading:"dashboards",title:"Create your first dashboard",icon:"apps",href:"dashboard/new",learnHref:"https://grafana.com/docs/grafana/latest/guides/getting_started/#create-a-dashboard",check:async()=>(await(0,dn.AI)().search({limit:1})).length>0,done:!1}]},{heading:"Setup complete!",subheading:"All necessary steps to use Grafana are done. Now tackle advanced steps or make the best use of this home dashboard \u2013 it is, after all, a fully customizable dashboard \u2013 and remove this panel.",title:"Advanced",info:" Manage your users and teams and add plugins. These steps are optional",done:!1,cards:[{type:"tutorial",heading:"Users",title:"Create users and teams",info:"Learn to organize your users in teams and manage resource access and roles.",href:"https://grafana.com/tutorials/create-users-and-teams",icon:"users-alt",key:Jc,check:()=>Promise.resolve(Qc.A.get(Jc)),done:!1},{type:"docs",heading:"plugins",title:"Find and install plugins",learnHref:"https://grafana.com/docs/grafana/latest/plugins/installation",href:"plugins",icon:"plug",check:async()=>{const J=await(0,dn.AI)().get("/api/plugins",{embedded:0,core:0});return Promise.resolve(J.length>0)},done:!1}]}];class Um extends C.PureComponent{constructor(){super(...arguments),this.state={checksDone:!1,currentStep:0,steps:qd()},this.onForwardClick=()=>{(0,Re.rR)("grafana_getting_started_button_to_advanced_tutorials"),this.setState(Ee=>({currentStep:Ee.currentStep+1}))},this.onPreviousClick=()=>{(0,Re.rR)("grafana_getting_started_button_to_basic_tutorials"),this.setState(Ee=>({currentStep:Ee.currentStep-1}))},this.dismiss=()=>{const{id:Ee}=this.props,Ce=(0,Ie.UA)().getCurrent(),Fe=Ce?.getPanelById(Ee);(0,Re.rR)("grafana_getting_started_remove_panel"),Ce?.removePanel(Fe),dn.IB.put("/api/user/helpflags/1",void 0,{showSuccessAlert:!1}).then(He=>{st.contextSrv.user.helpFlags1=He.helpFlags1})}}async componentDidMount(){const{steps:Ee}=this.state,Ce=Ee.map(async He=>{const it=He.cards.map(async Nt=>Nt.check().then(kt=>({...Nt,done:kt}))),vt=await Promise.all(it);return{...He,done:vt.every(Nt=>Nt.done),cards:vt}}),Fe=await Promise.all(Ce);this.setState({currentStep:Fe[0].done?1:0,steps:Fe,checksDone:!0})}render(){const{checksDone:Ee,currentStep:Ce,steps:Fe}=this.state,He=Nm(),it=Fe[Ce];return C.createElement("div",{className:He.container},Ee?C.createElement(C.Fragment,null,C.createElement(L.$n,{variant:"secondary",fill:"text",className:He.dismiss,onClick:this.dismiss},"Remove this panel"),Ce===Fe.length-1&&C.createElement(L.$n,{className:(0,se.cx)(He.backForwardButtons,He.previous),onClick:this.onPreviousClick,"aria-label":"To basic tutorials",icon:"angle-left",variant:"secondary"}),C.createElement("div",{className:He.content},C.createElement(Qd,{step:it})),Ce<Fe.length-1&&C.createElement(L.$n,{className:(0,se.cx)(He.backForwardButtons,He.forward),onClick:this.onForwardClick,"aria-label":"To advanced tutorials",icon:"angle-right",variant:"secondary"})):C.createElement("div",{className:He.loading},C.createElement("div",{className:He.loadingText},"Checking completed setup steps"),C.createElement(Gd.y,{size:"xl",inline:!0})))}}const Nm=(0,nt.N)(()=>{const J=x.$.theme2;return{container:(0,se.css)({display:"flex",flexDirection:"column",height:"100%",backgroundSize:"cover",padding:`${J.spacing(4)} ${J.spacing(2)} 0`}),content:(0,se.css)({label:"content",display:"flex",justifyContent:"center",[J.breakpoints.down("xxl")]:{marginLeft:J.spacing(3),justifyContent:"flex-start"}}),header:(0,se.css)({label:"header",marginBottom:J.spacing(3),display:"flex",flexDirection:"column",[J.breakpoints.down("lg")]:{flexDirection:"row"}}),headerLogo:(0,se.css)({height:"58px",paddingRight:J.spacing(2),display:"none",[J.breakpoints.up("md")]:{display:"block"}}),heading:(0,se.css)({label:"heading",marginRight:J.spacing(3),marginBottom:J.spacing(3),flexGrow:1,display:"flex",[J.breakpoints.up("md")]:{marginBottom:0}}),backForwardButtons:(0,se.css)({position:"absolute",top:"50%",transform:"translateY(-50%)"}),previous:(0,se.css)({left:"10px",[J.breakpoints.down("md")]:{left:0}}),forward:(0,se.css)({right:"10px",[J.breakpoints.down("md")]:{right:0}}),dismiss:(0,se.css)({alignSelf:"flex-end",textDecoration:"underline",marginBottom:J.spacing(1)}),loading:(0,se.css)({display:"flex",justifyContent:"center",alignItems:"center",height:"100%"}),loadingText:(0,se.css)({marginRight:J.spacing(1)})}}),wm=new O.m(Um).setNoPadding();var Ho=e(77678),eu=e(56675),tu=e(97706);const bc={bucketCount:30,bucketOffset:0},nu={fillOpacity:80,gradientMode:Xe.on.None,lineWidth:1};function au(J,Ee){return Math.floor(J/Ee)*Ee}function su(J,Ee){return Math.ceil(J/Ee)*Ee}function ru(J){return J.fields[0].type===It.PU.string?1:(0,tu.h)(J.fields[1].values[0]-J.fields[0].values[0],9)}function Fm(J){return J.fields[0].type===It.PU.string?1:(0,tu.h)(J.fields[1].values[1]-J.fields[0].values[1],9)}const Wm=(J,Ee)=>{let{min:Ce,max:Fe}=J.fields[2].config,He=new no.e,it=J.fields[0].type===It.PU.string,vt=ru(J),Nt=Fm(J),kt=Nt/vt,Zt=Nt!==vt,ln=(Xn,Gn,ea,qa,Wa,Ka)=>{let Ta=Xn.axes[Gn]._space,aa=Xn.valToPos(Xn.data[0][0]+vt,"x")-Xn.valToPos(Xn.data[0][0],"x"),Ha=au(Ce??Xn.data[0][0],vt),Ma=su(Fe??Xn.data[0][Xn.data[0].length-1]+vt,vt),Oa=[],Hs=Math.ceil(Ta/aa);for(let ar=0,er=Ha;er<=Ma;ar++,er+=vt)!(ar%Hs)&&Oa.push(er);return Oa};He.addScale({scaleKey:"x",isTime:!1,distribution:it?Xe.L4.Ordinal:Zt?Xe.L4.Log:Xe.L4.Linear,log:2,orientation:Xe.Lt.Horizontal,direction:Xe.ON.Right,range:Zt?(Xn,Gn,ea)=>vr.A.rangeLog(Gn,ea*kt,2,!0):(Xn,Gn,ea)=>{Ce!=null&&(Gn=Ce),Fe!=null&&(ea=Fe);let qa=Xn.data[0][Xn.data[0].length-1];return Gn=su(Gn,vt),ea=!it&&ea===qa?ea+vt:au(ea,vt),[Gn,ea]}}),He.addScale({scaleKey:"y",isTime:!1,distribution:Xe.L4.Linear,orientation:Xe.Lt.Vertical,direction:Xe.ON.Up,softMin:0});const bn=J.fields[0].display,Nn=Xn=>(0,Ar.cN)(bn(Xn));He.addAxis({scaleKey:"x",isTime:!1,placement:Xe.vM.Bottom,incrs:it?[1]:Zt?void 0:Ho.rW,splits:Zt||it?void 0:ln,values:it?(Xn,Gn)=>Gn:(Xn,Gn)=>{const ea=Gn.map(Nn),qa=ea.reduce((aa,Ha)=>Math.max((0,Ts.kD)(Ha,Us.pi).width,aa),0),Ka=Xn.bbox.width/((qa+10)*devicePixelRatio),Ta=Math.ceil(ea.length/Ka);return ea.map((aa,Ha)=>Ha%Ta===0?aa:null)},theme:Ee});let Wn=J.fields[2].display;He.addAxis({scaleKey:"y",isTime:!1,placement:Xe.vM.Left,formatValue:(Xn,Gn)=>(0,Ar.cN)(Wn(Xn,Gn)),theme:Ee}),He.setCursor({points:{show:!1},drag:{x:!0,y:!1,setScale:!0}});let ba=(0,Xs.ro)(Zi(J));He.setStackingGroups(ba);let oa=vr.A.paths.bars({align:1,size:[1,1/0]}),da=0;for(let Xn=2;Xn<J.fields.length;Xn++){const Gn=J.fields[Xn];Gn.state=Gn.state??{},Gn.state.seriesIndex=da++;const ea={...nu,...Gn.config.custom},qa="y",Wa=(0,_s.Qi)(Gn),Ta=(0,_s.lz)(Gn,Ee).color;He.addSeries({scaleKey:qa,lineWidth:ea.lineWidth,lineColor:Ta,fillOpacity:ea.fillOpacity,theme:Ee,colorMode:Wa,pathBuilder:oa,show:!ea.hideFrom?.viz,gradientMode:ea.gradientMode,thresholds:Gn.config.thresholds,hardMin:Gn.config.min,hardMax:Gn.config.max,softMin:ea.axisSoftMin,softMax:ea.axisSoftMax,dataFrameFieldIndex:Gn.state.origin})}return He},Zi=J=>({...J,fields:J.fields.filter(Ee=>Ee.name!==Ho.dA)}),Km=(J,Ee)=>{for(let Ce=1;Ce<Ee.fields.length;Ce++){let Fe=Ee.fields[Ce].values;for(let He=0;He<Fe.length;He++)Fe[He]===0&&(Fe[He]=null)}return(0,Xs.bq)(Ee,J.getStackingGroups())};class ou extends C.Component{constructor(Ee){super(Ee),this.state=this.prepState(Ee)}prepState(Ee,Ce=!0){const{alignedFrame:Fe}=Ee,He=Ce?Wm(Fe,this.props.theme):this.state.config,it=Km(He,Zi(Fe));return{alignedFrame:Fe,alignedData:it,config:He}}renderLegend(Ee){const{legend:Ce}=this.props;if(!Ee||Ce.showLegend===!1)return null;const Fe=this.props.options.combine?[this.props.alignedFrame]:this.props.rawSeries;return C.createElement(la.$,{data:Fe,config:Ee,maxHeight:"35%",maxWidth:"60%",...Ce})}componentDidUpdate(Ee){const{structureRev:Ce,alignedFrame:Fe,bucketSize:He,bucketCount:it}=this.props;if(Fe!==Ee.alignedFrame){const vt=this.state.config==null||it!==Ee.bucketCount||He!==Ee.bucketSize||this.props.options!==Ee.options||this.state.config===void 0||Ce!==Ee.structureRev||!Ce,Nt=this.prepState(this.props,vt);this.setState(Nt)}}render(){const{width:Ee,height:Ce,children:Fe,alignedFrame:He}=this.props,{config:it}=this.state;return it?C.createElement(Bs.KU,{width:Ee,height:Ce,legend:this.renderLegend(it)},(vt,Nt)=>C.createElement(ks.Z,{config:this.state.config,data:this.state.alignedData,width:vt,height:Nt},Fe?Fe(it,He):null)):null}}const iu=({data:J,options:Ee,width:Ce,height:Fe})=>{const He=(0,z.$j)(),it=(0,C.useMemo)(()=>{if(!J.series.length)return;if(J.series.forEach((kt,Zt)=>{kt.fields.forEach((ln,bn)=>{ln.state={...ln.state,origin:{frameIndex:Zt,fieldIndex:bn}}})}),J.series.length===1){const kt=(0,Ho.ix)(J.series[0]);if(kt)return(0,Ho.cg)(kt)}const Nt=(0,Ho.p3)(J.series,Ee);if(Nt)return(0,Ho.cg)(Nt,He)},[J.series,Ee,He]);if(!it||!it.fields.length)return C.createElement("div",{className:"panel-empty"},C.createElement("p",null,"No histogram found in response"));const vt=ru(it);return C.createElement(ou,{options:Ee,theme:He,legend:Ee.legend,rawSeries:J.series,structureRev:J.structureRev,width:Ce,height:Fe,alignedFrame:it,bucketSize:vt,bucketCount:Ee.bucketCount},(Nt,kt)=>null)},Dc={stacking:{mode:Xe.gs.None,group:"A"}},$m=(J,Ee,Ce,Fe)=>{if(Ee==="graph"&&Ce.angular.xaxis?.mode==="histogram"){const{fieldConfig:it,options:vt}=Vm({...Ce.angular,fieldConfig:Fe});return J.fieldConfig=it,vt}return{}};function Vm(J){const Ee=J;let Ce={};const Fe={legend:{displayMode:Xe.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:Xe.$N.Single,sort:Xe.xB.None},combine:!1};return Ee.stack&&(Ce.stacking={mode:Ee.percentage?Xe.gs.Percent:Xe.gs.Normal,group:Dc.stacking.group},Fe.combine=!1),{fieldConfig:{defaults:(0,w.omitBy)({custom:Ce},w.isNil),overrides:[]},options:Fe}}function xl(J){if(J?.length!==1)return!1;const Ee=J[0];if(Ee.fields.length<3||!(0,Ho.NX)(Ee.fields[0].name)||!(0,Ho.H1)(Ee.fields[1].name))return!1;for(const Ce of Ee.fields)if(Ce.type!==It.PU.number)return!1;return!0}const zm=new O.m(iu).setPanelChangeHandler($m).setPanelOptions(J=>{J.addCustomEditor({id:"__calc__",path:"__calc__",name:"Values",description:"Showing frequencies that are calculated in the query",editor:()=>null,showIf:(Ee,Ce)=>xl(Ce)}).addNumberInput({path:"bucketCount",name:Ho.Rt.bucketCount.name,description:Ho.Rt.bucketCount.description,settings:{placeholder:`Default: ${bc.bucketCount}`,min:0},showIf:(Ee,Ce)=>!xl(Ce)}).addNumberInput({path:"bucketSize",name:Ho.Rt.bucketSize.name,description:Ho.Rt.bucketSize.description,settings:{placeholder:"Auto",min:0},defaultValue:bc.bucketSize,showIf:(Ee,Ce)=>!xl(Ce)}).addNumberInput({path:"bucketOffset",name:Ho.Rt.bucketOffset.name,description:Ho.Rt.bucketOffset.description,settings:{placeholder:`Default: ${bc.bucketOffset}`,min:0},showIf:(Ee,Ce)=>!xl(Ce)}).addBooleanSwitch({path:"combine",name:Ho.Rt.combine.name,description:Ho.Rt.combine.description,defaultValue:bc.combine,showIf:(Ee,Ce)=>!xl(Ce)}),sa.H(J)}).useFieldConfig({standardOptions:{[Mt.uo.Color]:{settings:{byValueSupport:!1,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:wt.Y.PaletteClassic}}},useCustomConfig:J=>{const Ee=nu;J.addCustomEditor({id:"stacking",path:"stacking",name:"Stacking",category:["Histogram"],defaultValue:Dc.stacking,editor:eu.m,override:eu.m,settings:{options:jn.t.stacking},process:Ht.hS,shouldApply:Ce=>Ce.type===It.PU.number,showIf:(Ce,Fe)=>!xl(Fe)}).addSliderInput({path:"lineWidth",name:"Line width",defaultValue:Ee.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:Ee.fillOpacity,settings:{min:0,max:100,step:1}}).addRadio({path:"gradientMode",name:"Gradient mode",defaultValue:jn.t.fillGradient[0].value,settings:{options:jn.t.fillGradient}}),ia.e(J)}});var Go=e(55004),gl=e(60029),km=e(39408);const Zc=[{label:"Grafana",value:Go.qD.Grafana,description:"Core grafana live features"},{label:"Data Sources",value:Go.qD.DataSource,description:"Data sources with live support"},{label:"Plugins",value:Go.qD.Plugin,description:"Plugins with live support"},{label:"Stream",value:Go.qD.Stream,description:"data streams (eg, influx style)"}];function _m(J){const[Ee,Ce]=(0,C.useState)([]),[Fe,He]=(0,C.useMemo)(()=>{const Nn=[],mn=[],Wn=J.value.scope,ba=J.value.namespace;if(!Wn?.length)return[Nn,mn];const oa={};for(let da of Ee){const Xn=(0,Go.DG)(da.value);!Xn||Xn.scope!==Wn||(oa[Xn.namespace]||(Nn.push({value:Xn.namespace,label:Xn.namespace}),oa[Xn.namespace]=!0),ba?.length&&ba===Xn.namespace&&mn.push({...da,value:Xn.path}))}return[Nn,mn]},[Ee,J.value.scope,J.value.namespace]);(0,C.useEffect)(()=>{(0,km.l)().then(Nn=>{Ce(Nn.channels)})},[J.value.scope]);const it=Nn=>{Nn.value&&J.onChange({scope:Nn.value,namespace:void 0,path:void 0})},vt=Nn=>{J.onChange({scope:J.value?.scope,namespace:Nn?.value,path:void 0})},Nt=Nn=>{const{value:mn,onChange:Wn}=J;Wn({scope:mn.scope,namespace:mn.namespace,path:Nn?.value})},{scope:kt,namespace:Zt,path:ln}=J.value,bn=Gm(fe.config.theme2);return C.createElement(C.Fragment,null,C.createElement(ue.F,{title:"Grafana Live",severity:"info"},"This supports real-time event streams in grafana core. This feature is under heavy development. Expect the intefaces and structures to change as this becomes more production ready."),C.createElement("div",null,C.createElement("div",{className:bn.dropWrap},C.createElement(gl.J,null,"Scope"),C.createElement(W.l6,{options:Zc,value:Zc.find(Nn=>Nn.value===kt),onChange:it})),kt&&C.createElement("div",{className:bn.dropWrap},C.createElement(gl.J,null,"Namespace"),C.createElement(W.l6,{options:Fe,value:Fe.find(Nn=>Nn.value===Zt)??(Zt?{label:Zt,value:Zt}:void 0),onChange:vt,allowCustomValue:!0,backspaceRemovesValue:!0,isClearable:!0})),kt&&Zt&&C.createElement("div",{className:bn.dropWrap},C.createElement(gl.J,null,"Path"),C.createElement(W.l6,{options:He,value:Hm(He,ln),onChange:Nt,allowCustomValue:!0,backspaceRemovesValue:!0,isClearable:!0}))))}function Hm(J,Ee){const Ce=J.find(Fe=>Fe.value===Ee);if(Ce)return Ce;if(Ee)return{label:Ee,value:Ee}}const Gm=(0,nt.N)(J=>({dropWrap:(0,se.css)`
    margin-bottom: ${J.spacing(1)};
  `}));var lu=e(9631),cu=e(90708),Ol=e(39070),Xc=e(78731),du=e(24022),Xi=e(94624),qi=e(1173),uu=e(77093),Il=e(65885);function mu(J){const{data:Ee,height:Ce,width:Fe,options:He,fieldConfig:it,id:vt,timeRange:Nt}=J,kt=(0,z.$j)(),Zt=(0,cn.d2)(),ln=(0,Il.gy)(Ee.series)?(0,Il.S5)(Ee.series):Ee.series,bn=ln?.length,Nn=ln[0]?.fields.length,mn=jm(ln,He),Wn=ln[mn];let ba=Ce;if(!bn||!Nn)return C.createElement(ga.a,{panelId:vt,fieldConfig:it,data:Ee});if(bn>1){const Gn=kt.spacing.gridSize*kt.components.height.md,ea=kt.spacing.gridSize;ba=Ce-Gn-ea}const oa=Zt.sync&&Zt.sync()!==Xi.y.Off,da=C.createElement(uu.X,{height:ba,width:Fe,data:Wn,noHeader:!He.showHeader,showTypeIcons:He.showTypeIcons,resizable:!0,initialSortBy:He.sortBy,onSortByChange:Gn=>Qm(Gn,J),onColumnResize:(Gn,ea)=>qc(Gn,ea,J),onCellFilterAdded:Zt.onAddAdHocFilter,footerOptions:He.footer,enablePagination:He.footer?.enablePagination,cellHeight:He.cellHeight,timeRange:Nt,enableSharedCrosshair:x.$.featureToggles.tableSharedCrosshair&&oa,fieldConfig:it});if(bn===1)return da;const Xn=ln.map((Gn,ea)=>({label:(0,fr.Ri)(Gn),value:ea}));return C.createElement("div",{className:fu.wrapper},da,C.createElement("div",{className:fu.selectWrapper},C.createElement(W.l6,{options:Xn,value:Xn[mn],onChange:Gn=>ep(Gn,J)})))}function jm(J,Ee){return Ee.frameIndex>0&&Ee.frameIndex<J.length?Ee.frameIndex:0}function qc(J,Ee,Ce){const{fieldConfig:Fe}=Ce,{overrides:He}=Fe,it=qi.Ct.byName,vt="custom.width",Nt=He.find(kt=>kt.matcher.id===it&&kt.matcher.options===J);if(Nt){const kt=Nt.properties.find(Zt=>Zt.id===vt);kt?kt.value=Ee:Nt.properties.push({id:vt,value:Ee})}else He.push({matcher:{id:it,options:J},properties:[{id:vt,value:Ee}]});Ce.onFieldConfigChange({...Fe,overrides:He})}function Qm(J,Ee){Ee.onOptionsChange({...Ee.options,sortBy:J})}function ep(J,Ee){Ee.onOptionsChange({...Ee.options,frameIndex:J.value||0})}const fu={wrapper:(0,se.css)`
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 100%;
  `,selectWrapper:(0,se.css)`
    padding: 8px 8px 0px 8px;
  `};var Pc=e(32372),Xo=(J=>(J.Raw="raw",J.JSON="json",J.Auto="auto",J.None="none",J))(Xo||{}),fi=(J=>(J.None="none",J.JSON="json",J.Influx="influx",J))(fi||{});function gu({height:J,mode:Ee,body:Ce,addr:Fe,onSave:He}){const it=(0,C.useMemo)(()=>Ee===fi.JSON?Ce?JSON.stringify(Ce,null,2):"{ }":Ce==null?"":`${Ce}`,[Ee,Ce]),vt=kt=>{Ee===fi.JSON?He(JSON.parse(kt)):He(kt)},Nt=async()=>{if(Ee===fi.Influx){if(Fe?.scope!=="stream"){alert("expected stream scope!");return}return(0,Kn.AI)().post(`api/live/push/${Fe.namespace}`,Ce)}if(!(0,Go.aj)(Fe)){alert("invalid address");return}const kt=await(0,Xc.oF)().publish(Fe,Ce);console.log("onPublishClicked (response from publish)",kt)};return C.createElement(C.Fragment,null,C.createElement(Pc.B,{height:J-32,language:Ee===fi.JSON?"json":"text",value:it,onBlur:vt,onSave:vt,showMiniMap:!1,showLineNumbers:!0}),C.createElement("div",{style:{height:32}},C.createElement(L.$n,{onClick:Nt},"Publish")))}class ed extends C.PureComponent{constructor(Ee){super(Ee),this.styles=_l(x.$.theme2),this.streamObserver={next:Ce=>{(0,Go.ew)(Ce)?this.setState({status:Ce,changed:Date.now()}):(0,Go.Z7)(Ce)?this.setState({message:Ce.message,changed:Date.now()}):console.log("ignore",Ce)}},this.unsubscribe=()=>{this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0)},this.isValid=!!(0,Xc.oF)(),this.state={changed:0}}async componentDidMount(){this.loadChannel()}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(Ee){this.props.options?.channel!==Ee.options?.channel&&this.loadChannel()}async loadChannel(){const Ee=this.props.options?.channel;if(!(0,Go.aj)(Ee)){console.log("INVALID",Ee),this.unsubscribe(),this.setState({addr:void 0});return}if((0,w.isEqual)(Ee,this.state.addr)){console.log("Same channel",this.state.addr);return}const Ce=(0,Xc.oF)();if(!Ce){console.log("INVALID",Ee),this.unsubscribe(),this.setState({addr:void 0});return}this.unsubscribe(),console.log("LOAD",Ee);try{this.subscription=Ce.getStream(Ee).subscribe(this.streamObserver),this.setState({addr:Ee,error:void 0})}catch(Fe){this.setState({addr:void 0,error:Fe})}}renderNotEnabled(){return C.createElement(ue.F,{title:"Grafana Live",severity:"info"},C.createElement("p",null,"Grafana live requires a feature flag to run"),C.createElement("b",null,"custom.ini:"),C.createElement("pre",null,`[feature_toggles]
    enable = live`))}renderMessage(Ee){const{options:Ce}=this.props,{message:Fe}=this.state;if(!Fe)return C.createElement("div",null,C.createElement("h4",null,"Waiting for data:"),Ce.channel?.scope,"/",Ce.channel?.namespace,"/",Ce.channel?.path);if(Ce.display===Xo.JSON)return C.createElement(du.B,{json:Fe,open:5});if(Ce.display===Xo.Auto&&Fe instanceof lu.k9){const He={series:(0,cu.we)({data:[Fe],theme:x.$.theme2,replaceVariables:vt=>vt,fieldConfig:{defaults:{},overrides:[]}}),state:Ol.Gu.Streaming},it={...this.props,options:{frameIndex:0,showHeader:!0}};return C.createElement(mu,{...it,data:He,height:Ee})}return C.createElement("pre",null,JSON.stringify(Fe))}renderPublish(Ee){const{options:Ce}=this.props;return C.createElement(gu,{height:Ee,body:Ce.message,mode:Ce.publish??fi.JSON,onSave:Fe=>this.props.onOptionsChange({...Ce,message:Fe}),addr:this.state.addr})}renderStatus(){const{status:Ee}=this.state;if(Ee?.state===Go.ZF.Connected)return;let Ce="";return Ee&&(Ce=this.styles.status[Ee.state]),C.createElement("div",{className:(0,se.cx)(Ce,this.styles.statusWrap)},Ee?.state)}renderBody(){const{status:Ee}=this.state,{options:Ce,height:Fe}=this.props;if(Ce.publish===fi.JSON||Ce.publish===fi.Influx){if(Ce.display===Xo.None)return this.renderPublish(Fe);const it=Fe/2;return C.createElement("div",null,C.createElement("div",{style:{height:it,overflow:"hidden"}},C.createElement(q.E,{autoHeightMin:"100%",autoHeightMax:"100%"},this.renderMessage(it))),C.createElement("div",null,this.renderPublish(it)))}return Ce.display===Xo.None?C.createElement("pre",null,JSON.stringify(Ee)):C.createElement("div",{style:{overflow:"hidden",height:Fe}},C.createElement(q.E,{autoHeightMin:"100%",autoHeightMax:"100%"},this.renderMessage(Fe)))}render(){if(!this.isValid)return this.renderNotEnabled();const{addr:Ee,error:Ce}=this.state;return Ee?Ce?C.createElement("div",null,C.createElement("h2",null,"ERROR"),C.createElement("div",null,JSON.stringify(Ce))):C.createElement(C.Fragment,null,this.renderStatus(),this.renderBody()):C.createElement(ue.F,{title:"Grafana Live",severity:"info"},"Use the panel editor to pick a channel")}}const _l=(0,nt.N)(J=>({statusWrap:(0,se.css)`
    margin: auto;
    position: absolute;
    top: 0;
    right: 0;
    background: ${J.components.panel.background};
    padding: 10px;
    z-index: ${J.zIndex.modal};
  `,status:{[Go.ZF.Pending]:(0,se.css)`
      border: 1px solid ${J.v1.palette.orange};
    `,[Go.ZF.Connected]:(0,se.css)`
      border: 1px solid ${J.colors.success.main};
    `,[Go.ZF.Connecting]:(0,se.css)`
      border: 1px solid ${J.v1.palette.brandWarning};
    `,[Go.ZF.Disconnected]:(0,se.css)`
      border: 1px solid ${J.colors.warning.main};
    `,[Go.ZF.Shutdown]:(0,se.css)`
      border: 1px solid ${J.colors.error.main};
    `,[Go.ZF.Invalid]:(0,se.css)`
      border: 1px solid red;
    `}})),Cc=new O.m(ed).setPanelOptions(J=>{J.addCustomEditor({category:["Channel"],id:"channel",path:"channel",name:"Channel",editor:_m,defaultValue:{}}),J.addRadio({path:"display",name:"Show Message",description:"Display the last message received on this channel",settings:{options:[{value:Xo.Raw,label:"Raw Text"},{value:Xo.JSON,label:"JSON"},{value:Xo.Auto,label:"Auto"},{value:Xo.None,label:"None"}]},defaultValue:Xo.JSON}).addRadio({path:"publish",name:"Publish",description:"Display a form to publish values",settings:{options:[{value:fi.None,label:"None"},{value:fi.JSON,label:"JSON"},{value:fi.Influx,label:"Influx"}]},defaultValue:fi.None})});var pl=e(9557),pu=e(96192),Hl=e(81166),hu=e(17888),tp=e(7030),Ym=e(93463),Jm=e(14647),td=e(69147),vu=e(16817),Gl=e(19347);const Zm=J=>{const[Ee,Ce]=(0,C.useState)(new Map);return(0,vu.A)(async()=>{if(!J){Ce(new Map);return}const Fe=await Promise.all(J.filter(He=>!!He.datasource?.uid).map(He=>(0,Gl.l)().get(He.datasource?.uid).then(it=>({key:He.refId,ds:it}))));Ce(new Map(Fe.map(({key:He,ds:it})=>[He,it])))},[J]),Ee},nd={},Xm=({data:J,timeZone:Ee,fieldConfig:Ce,options:{showLabels:Fe,showTime:He,wrapLogMessage:it,showCommonLabels:vt,prettifyLogMessage:Nt,sortOrder:kt,dedupStrategy:Zt,enableLogDetails:ln,showLogContextToggle:bn},id:Nn})=>{const mn=kt===Xe.uH.Ascending,Wn=(0,z.of)(qm),[ba,oa]=(0,C.useState)(0),da=(0,C.useRef)(null),[Xn,Gn]=(0,C.useState)(null),ea=J.timeRange,qa=Zm(J.request?.targets),[Wa,Ka]=(0,C.useState)(null);let Ta=(0,C.useRef)();const{eventBus:aa}=(0,cn.d2)(),Ha=(0,C.useCallback)(Ja=>{Ja?aa.publish(new Cn.b_({point:{time:Ja.timeEpochMs}})):aa.publish(new Cn.ql)},[aa]),Ma=(0,C.useCallback)(()=>{Gn(null),Ta.current&&Ta.current()},[Ta]),Oa=(0,C.useCallback)((Ja,Es)=>{Gn(Ja),Ta.current=Es},[Ta]),Hs=(0,C.useCallback)(async Ja=>await tf(Ja,ea),[ea]),ar=(0,C.useCallback)(Ja=>{if(!Ja.dataFrame.refId||!qa||!bn&&J.request?.app!==A.Jk.Dashboard&&J.request?.app!==A.Jk.PanelEditor&&J.request?.app!==A.Jk.PanelViewer)return!1;const Es=qa.get(Ja.dataFrame.refId);return(0,pl.Ol)(Es)},[qa,bn,J.request?.app]),er=(0,C.useCallback)(()=>!(J.request?.app!==A.Jk.Dashboard&&J.request?.app!==A.Jk.PanelEditor&&J.request?.app!==A.Jk.PanelViewer),[J.request?.app]),As=(0,C.useCallback)(async(Ja,Es,sr)=>{if(!Es.dataFrame.refId||!qa)return Promise.resolve({data:[]});const cr=J.request?.targets[0];if(!cr)return Promise.resolve({data:[]});const xr=qa.get(Es.dataFrame.refId);return(0,pl.Ol)(xr)?xr.getLogRowContext(Ja,sr,cr):Promise.resolve({data:[]})},[J.request?.targets,qa]),bs=(0,C.useCallback)((Ja,Es)=>{if(!Ja.dataFrame.refId||!qa)return C.createElement(C.Fragment,null);const sr=J.request?.targets[0];if(!sr)return C.createElement(C.Fragment,null);const cr=qa.get(Ja.dataFrame.refId);return!(0,pl.wj)(cr)||!cr.getLogRowContextUi?C.createElement(C.Fragment,null):cr.getLogRowContextUi(Ja,Es,sr)},[J.request?.targets,qa]),[rs,Zs,hr]=(0,C.useMemo)(()=>{const Ja=J?(0,td.HT)(J.series,J.request?.intervalMs,void 0,J.request?.targets):null,Es=Ja?.rows||[],sr=Ja?.meta?.find(xr=>xr.label===td.yR),cr=(0,td.M0)(Es,Zt);return[Es,cr,sr]},[J,Zt]);(0,C.useLayoutEffect)(()=>{mn&&da.current?oa(da.current.offsetHeight):oa(0)},[mn,rs]);const Vr=(0,C.useCallback)((Ja,Es)=>(0,pu.QL)({field:Ja,rowIndex:Es,range:J.timeRange}),[J]),gs=(0,C.useCallback)(Ja=>{Wa?.scrollTo({top:Ja.offsetTop,behavior:"smooth"})},[Wa]);if(!J||rs.length===0)return C.createElement(hu.a,{fieldConfig:Ce,panelId:Nn,data:J,needsStringField:!0});const os=()=>C.createElement("div",{className:(0,se.cx)(Wn.labelContainer,mn&&Wn.labelContainerAscending)},C.createElement("span",{className:Wn.label},"Common labels:"),C.createElement(Ym.h,{labels:typeof hr?.value=="object"?hr?.value:nd,emptyMessage:"(no common labels)"}));return C.createElement(C.Fragment,null,Xn&&C.createElement(Hl.V,{open:Xn!==null,row:Xn,onClose:Ma,getRowContext:(Ja,Es)=>As(Ja,Xn,Es),logsSortOrder:kt,timeZone:Ee,getLogRowContextUi:bs}),C.createElement(q.E,{autoHide:!0,scrollTop:ba,scrollRefCallback:Ja=>Ka(Ja)},C.createElement("div",{className:Wn.container,ref:da},vt&&!mn&&os(),C.createElement(Jm.k,{containerRendered:da.current!==null,scrollIntoView:gs,permalinkedRowId:ef()?.logs?.id??void 0,onPermalinkClick:er()?Hs:void 0,logRows:rs,showContextToggle:ar,deduplicatedRows:Zs,dedupStrategy:Zt,showLabels:Fe,showTime:He,wrapLogMessage:it,prettifyLogMessage:Nt,timeZone:Ee,getFieldLinks:Vr,logsSortOrder:kt,enableLogDetails:ln,previewLimit:mn?rs.length:void 0,onLogRowHover:Ha,app:A.Jk.Dashboard,onOpenContext:Oa}),vt&&mn&&os())))},qm=J=>({container:(0,se.css)({marginBottom:J.spacing(1.5)}),labelContainer:(0,se.css)({margin:J.spacing(0,0,.5,.5),display:"flex",alignItems:"center"}),labelContainerAscending:(0,se.css)({margin:J.spacing(.5,0,.5,0)}),label:(0,se.css)({marginRight:J.spacing(.5),fontSize:J.typography.bodySmall.fontSize,fontWeight:J.typography.fontWeightMedium})});function ef(){const Ee=ul.kM.getUrlSearchParams()?.panelState;if(Ee&&Array.isArray(Ee)&&Ee?.length>0&&typeof Ee[0]=="string")try{return JSON.parse(Ee[0])}catch(Ce){console.error("error parsing logsPanelState",Ce)}}async function tf(J,Ee){if(J.rowId===void 0||!J.dataFrame.refId)return;const Ce={logs:{id:J.uid}},Fe=new URL(window.location.href);return Fe.searchParams.set("panelState",JSON.stringify(Ce)),Fe.searchParams.set("from",(0,Tn.yT)(Ee.from).valueOf().toString(10)),Fe.searchParams.set("to",(0,Tn.yT)(Ee.to).valueOf().toString(10)),await(0,tp.VP)(Fe.toString()),Promise.resolve()}class nf{getSuggestionsForData(Ee){const Ce=Ee.getListAppender({name:"",pluginId:"logs",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}),{dataSummary:Fe}=Ee;!Fe.hasData||!Fe.hasTimeField||!Fe.hasStringField||(Fe.preferredVisualisationType==="logs"?Ce.append({name:_a.m.Logs,score:tn.nQ.Best}):Ce.append({name:_a.m.Logs}))}}const Eu=new O.m(Xm).setPanelOptions(J=>{J.addBooleanSwitch({path:"showTime",name:"Time",description:"",defaultValue:!1}).addBooleanSwitch({path:"showLabels",name:"Unique labels",description:"",defaultValue:!1}).addBooleanSwitch({path:"showCommonLabels",name:"Common labels",description:"",defaultValue:!1}).addBooleanSwitch({path:"wrapLogMessage",name:"Wrap lines",description:"",defaultValue:!1}).addBooleanSwitch({path:"prettifyLogMessage",name:"Prettify JSON",description:"",defaultValue:!1}).addBooleanSwitch({path:"enableLogDetails",name:"Enable log details",description:"",defaultValue:!0}).addRadio({path:"dedupStrategy",name:"Deduplication",description:"",settings:{options:[{value:Xe.fY.none,label:"None",description:pl._C[Xe.fY.none]},{value:Xe.fY.exact,label:"Exact",description:pl._C[Xe.fY.exact]},{value:Xe.fY.numbers,label:"Numbers",description:pl._C[Xe.fY.numbers]},{value:Xe.fY.signature,label:"Signature",description:pl._C[Xe.fY.signature]}]},defaultValue:Xe.fY.none}).addRadio({path:"sortOrder",name:"Order",description:"",settings:{options:[{value:Xe.uH.Descending,label:"Newest first"},{value:Xe.uH.Ascending,label:"Oldest first"}]},defaultValue:Xe.uH.Descending})}).setSuggestionsSupplier(new nf);var Sc=e(69386),yu=e(62372),af=e(4172);function sf(J){const{width:Ee,options:{feedUrl:Ce=yu.$,showImage:Fe}}=J,{state:He,getNews:it}=(0,af.n)(Ce);return(0,C.useEffect)(()=>{const vt=J.eventBus.subscribe(Z._,it);return()=>{vt.unsubscribe()}},[it,J.eventBus]),(0,C.useEffect)(()=>{it()},[it]),He.error?C.createElement(ue.F,{title:"Error loading RSS feed"},"Make sure that the feed URL is correct and that CORS is configured correctly on the server. See"," ",C.createElement("a",{style:{textDecoration:"underline"},href:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/news/"},"News panel documentation. ",C.createElement(V.I,{name:"external-link-alt"}))):He.loading?C.createElement("div",null,"Loading..."):He.value?C.createElement(q.E,{autoHeightMin:"100%",autoHeightMax:"100%"},He.value.map((vt,Nt)=>C.createElement(Sc.K,{key:Nt,index:Nt,width:Ee,showImage:Fe,data:He.value}))):null}const bu={showImage:!0},rf=new O.m(sf).setPanelOptions(J=>{J.addTextInput({path:"feedUrl",name:"URL",description:"Supports RSS and Atom feeds",settings:{placeholder:yu.$},defaultValue:bu.feedUrl}).addBooleanSwitch({path:"showImage",name:"Show image",description:"Controls if the news item social (og:image) image is shown above text content",defaultValue:bu.showImage})});var of=e(56323),lf=e(29995),cf=e(89227),df=e(98361),Du=e(33434),uf=e(44916),mf=e(4118),ff=e(35472),ad=e(84140),Pu=e(59796),gf=e(3139),pf=e(16797);let hf=0;const vf=()=>hf++;function Ef(J){const Ee=(0,C.useRef)(null);return Ee.current===null&&(Ee.current=J+vf()),Ee.current.toString()}var ki=(J=>(J.Donut="donut",J.Pie="pie",J))(ki||{}),gi=(J=>(J.Name="name",J.Percent="percent",J.Value="value",J))(gi||{}),_i=(J=>(J.Percent="percent",J.Value="value",J))(_i||{});const np={values:[]},yf={displayLabels:[]};function Cu(J){return!J.field.custom?.hideFrom?.viz&&!isNaN(J.display.numeric)}function Su(J,Ee){return Ee.display.numeric+J}const bf=({fieldDisplayValues:J,pieType:Ee,width:Ce,height:Fe,highlightedTitle:He,displayLabels:it=[],tooltipOptions:vt})=>{const Nt=(0,z.$j)(),kt=Ef("PieChart"),Zt=(0,z.of)(Tc),ln=(0,mf.A)(),{containerRef:bn,TooltipInPortal:Nn}=(0,ff.A)({detectBounds:!0,scroll:!0}),mn=J.filter(Cu),Wn=Wa=>Wa.display.numeric,ba=Wa=>`${kt}-${(0,ad.A)(Wa).toHex()}`,oa=Wa=>`url(#${ba(Wa)})`,da=it.length>0,Xn=vt.mode!=="none"&&ln.tooltipOpen,Gn=mn.reduce(Su,0),ea=Tf(Ce,Fe,Ee),qa=[...new Set(mn.map(Wa=>Wa.display.color??wt.F))];return C.createElement("div",{className:Zt.container},C.createElement("svg",{width:ea.size,height:ea.size,ref:bn,style:{overflow:"visible"}},C.createElement(Du.A,{top:ea.position,left:ea.position},qa.map(Wa=>C.createElement(df.A,{key:Wa,id:ba(Wa),from:Mu(Wa,Nt),to:Sf(Wa,Nt),fromOffset:ea.gradientFromOffset,toOffset:"1",gradientUnits:"userSpaceOnUse",cx:0,cy:0,radius:ea.outerRadius})),C.createElement(uf.A,{data:mn,pieValue:Wn,outerRadius:ea.outerRadius,innerRadius:ea.innerRadius,cornerRadius:3,padAngle:.005},Wa=>C.createElement(C.Fragment,null,Wa.arcs.map(Ka=>{const Ta=Ka.data.display.color??wt.F,aa=xu(He,Ka);return Ka.data.hasLinks&&Ka.data.getLinks?C.createElement(Pu.e,{key:Ka.index,links:Ka.data.getLinks},Ha=>C.createElement(Tu,{tooltip:ln,highlightState:aa,arc:Ka,pie:Wa,fill:oa(Ta),openMenu:Ha.openMenu,tooltipOptions:vt})):C.createElement(Tu,{key:Ka.index,highlightState:aa,tooltip:ln,arc:Ka,pie:Wa,fill:oa(Ta),tooltipOptions:vt})}),da&&Wa.arcs.map(Ka=>{const Ta=xu(He,Ka);return C.createElement(Df,{arc:Ka,key:Ka.index,highlightState:Ta,outerRadius:ea.outerRadius,innerRadius:ea.innerRadius,displayLabels:it,total:Gn,color:Nt.colors.text.primary})}))))),Xn?C.createElement(Nn,{key:Math.random(),top:ln.tooltipTop,className:Zt.tooltipPortal,left:ln.tooltipLeft,unstyled:!0,applyPositionStyle:!0},C.createElement(gf.o,{series:ln.tooltipData})):null)};function Tu({arc:J,pie:Ee,highlightState:Ce,openMenu:Fe,fill:He,tooltip:it,tooltipOptions:vt}){const Nt=(0,z.$j)(),kt=(0,z.of)(Tc),{eventBus:Zt}=(0,cn.d2)(),ln=(0,C.useCallback)(mn=>{Zt?.publish({type:Cn.ql.type,payload:{raw:mn,x:0,y:0,dataId:J.data.display.title}}),it.hideTooltip()},[Zt,J,it]),bn=(0,C.useCallback)(mn=>{Zt?.publish({type:Cn.b_.type,payload:{raw:mn,x:0,y:0,dataId:J.data.display.title}});const Wn=mn.currentTarget.ownerSVGElement;if(Wn){const ba=(0,cf.A)(Wn,mn);it.showTooltip({tooltipLeft:ba.x,tooltipTop:ba.y,tooltipData:Pf(Ee,J,vt)})}},[Zt,J,it,Ee,vt]),Nn=Mf(Ce,kt);return C.createElement("g",{key:J.data.display.title,className:Nn,onMouseMove:vt.mode!=="none"?bn:void 0,onMouseOut:ln,onClick:Fe,"data-testid":Lo.Tp.components.Panels.Visualization.PieChart.svgSlice},C.createElement("path",{d:Ee.path({...J}),fill:He,stroke:Nt.colors.background.primary,strokeWidth:1}))}function Df({arc:J,outerRadius:Ee,innerRadius:Ce,displayLabels:Fe,total:He,color:it,highlightState:vt}){const Nt=(0,z.of)(Tc),kt=Ce===0?Ee/6:Ce,[Zt,ln]=Cf(J,Ee,kt);if(!(J.endAngle-J.startAngle>=.3))return null;let Nn=Fe.includes(gi.Name)?Math.min(Math.max(Ee/150*14,12),30):Math.min(Math.max(Ee/100*14,12),36);return C.createElement("g",{className:Mf(vt,Nt)},C.createElement("text",{fill:it,x:Zt,y:ln,dy:".33em",fontSize:Nn,fontWeight:500,textAnchor:"middle",pointerEvents:"none"},Fe.includes(gi.Name)&&C.createElement("tspan",{x:Zt,dy:"1.2em"},J.data.display.title),Fe.includes(gi.Value)&&C.createElement("tspan",{x:Zt,dy:"1.2em"},(0,Ar.cN)(J.data.display)),Fe.includes(gi.Percent)&&C.createElement("tspan",{x:Zt,dy:"1.2em"},(J.data.display.numeric/He*100).toFixed(J.data.field.decimals??0)+"%")))}function Pf(J,Ee,Ce){return Ce.mode==="multi"?J.arcs.filter(Fe=>{const He=Fe.data.field;return He&&!He.custom?.hideFrom?.tooltip&&!He.custom?.hideFrom?.viz}).map(Fe=>({color:Fe.data.display.color??wt.F,label:Fe.data.display.title,value:(0,Ar.cN)(Fe.data.display),isActive:Fe.index===Ee.index})):[{color:Ee.data.display.color??wt.F,label:Ee.data.display.title,value:(0,Ar.cN)(Ee.data.display)}]}function Cf(J,Ee,Ce){const Fe=(Ee+Ce)/2,He=(+J.startAngle+ +J.endAngle)/2-Math.PI/2;return[Math.cos(He)*Fe,Math.sin(He)*Fe]}function Mu(J,Ee){return(0,ad.A)(J).darken(20*(Ee.isDark?1:-.7)).spin(4).toRgbString()}function Sf(J,Ee){return(0,ad.A)(J).darken(10*(Ee.isDark?1:-.7)).spin(-4).toRgbString()}function Tf(J,Ee,Ce,Fe=16){const He=Math.min(Ee,J),it=(He-Fe*2)/2,vt=Ce===ki.Pie?it:Math.max(it/3,20),Nt=it-vt,kt=(He-Fe*2)/2,Zt=1-(it-Nt)/it;return{position:kt+Fe,size:He,outerRadius:it,innerRadius:Nt,gradientFromOffset:Zt}}var jl=(J=>(J[J.Highlighted=0]="Highlighted",J[J.Deemphasized=1]="Deemphasized",J[J.Normal=2]="Normal",J))(jl||{});function xu(J,Ee){return J?J===Ee.data.display.title?0:1:2}function Mf(J,Ee){switch(J){case 0:return Ee.svgArg.highlighted;case 1:return Ee.svgArg.deemphasized;case 2:default:return Ee.svgArg.normal}}const Tc=J=>({container:(0,se.css)`
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    `,svgArg:{normal:(0,se.css)`
        transition: all 200ms ease-in-out;
      `,highlighted:(0,se.css)`
        transition: all 200ms ease-in-out;
        transform: scale3d(1.03, 1.03, 1);
      `,deemphasized:(0,se.css)`
        transition: all 200ms ease-in-out;
        fill-opacity: 0.5;
      `},tooltipPortal:(0,se.css)`
      ${(0,pf.getTooltipContainerStyles)(J)}
    `}),xf={displayMode:Xe.lm.List,showLegend:!0,placement:"right",calcs:[],values:[_i.Percent]};function Of(J){const{data:Ee,timeZone:Ce,fieldConfig:Fe,replaceVariables:He,width:it,height:vt,options:Nt,id:kt}=J,Zt=(0,z.$j)(),ln=If(),bn=(0,of.PI)({fieldConfig:Fe,reduceOptions:Nt.reduceOptions,data:Ee.series,theme:Zt,replaceVariables:He,timeZone:Ce});return sp(bn)?C.createElement(Bs.KU,{width:it,height:vt,legend:ap(J,bn)},(Nn,mn)=>C.createElement(bf,{width:Nn,height:mn,highlightedTitle:ln,fieldDisplayValues:bn,tooltipOptions:Nt.tooltip,pieType:Nt.pieType,displayLabels:Nt.displayLabels})):C.createElement(ga.a,{panelId:kt,fieldConfig:Fe,data:Ee})}function ap(J,Ee){const Ce=J.options.legend??xf;if(Ce.showLegend===!1)return;const Fe=Ee.filter(Cu).reduce(Su,0),He=Ee.sort((it,vt)=>isNaN(it.display.numeric)?1:isNaN(vt.display.numeric)?-1:vt.display.numeric-it.display.numeric).map((it,vt)=>{const Nt=it.field.custom?.hideFrom??{};if(Nt.legend)return;const kt=!!Nt.viz,Zt=it.display;return{label:Zt.title??"",color:Zt.color??wt.F,yAxis:1,disabled:kt,getItemKey:()=>(Zt.title??"")+vt,getDisplayValues:()=>{const ln=Ce.values??[];let bn=[];if(ln.includes(_i.Value)&&bn.push({numeric:Zt.numeric,text:(0,Ar.cN)(Zt),title:"Value"}),ln.includes(_i.Percent)){const Nn=kt?0:Zt.numeric/Fe,mn=Nn*100;bn.push({numeric:Nn,percent:mn,text:kt||isNaN(Nn)?J.fieldConfig.defaults.noValue??"-":mn.toFixed(it.field.decimals??0)+"%",title:ln.length>1?"Percent":""})}return bn}}}).filter(it=>!!it);return C.createElement(Bs.KU.Legend,{placement:Ce.placement,width:Ce.width},C.createElement(Ir.t,{items:He,seriesVisibilityChangeBehavior:lf.K.Hide,placement:Ce.placement,displayMode:Ce.displayMode}))}function sp(J){return J.some(Ee=>Ee.view?.dataFrame.length)}function If(){const[J,Ee]=(0,C.useState)(),{eventBus:Ce}=(0,cn.d2)();return(0,C.useEffect)(()=>{const Fe=vt=>{Ee(vt.payload.dataId)},He=vt=>{Ee(void 0)},it=new Tt.yU;return it.add(Ce.getStream(Cn.b_).subscribe({next:Fe})),it.add(Ce.getStream(Cn.ql).subscribe({next:He})),()=>{it.unsubscribe()}},[Ee,Ce]),J}const sd=(J,Ee,Ce)=>{if(Ee==="grafana-piechart-panel"&&Ce.angular){const Fe=Ce.angular,He=[];let it=J.options;if(Fe.aliasColors)for(const vt of Object.keys(Fe.aliasColors)){const Nt=Fe.aliasColors[vt];Nt&&He.push({matcher:{id:qi.Ct.byName,options:vt},properties:[{id:Mt.uo.Color,value:{mode:wt.Y.Fixed,fixedColor:Nt}}]})}if(J.fieldConfig={overrides:He,defaults:{unit:Fe.format,decimals:Fe.decimals?Fe.decimals:0}},it.legend={placement:"right",values:[],displayMode:Xe.lm.Table,showLegend:!0,calcs:[]},Fe.valueName)switch(it.reduceOptions={calcs:[]},Fe.valueName){case"current":it.reduceOptions.calcs=["lastNotNull"];break;case"min":it.reduceOptions.calcs=["min"];break;case"max":it.reduceOptions.calcs=["max"];break;case"avg":it.reduceOptions.calcs=["mean"];break;case"total":it.reduceOptions.calcs=["sum"];break}switch(Fe.legendType){case"Under graph":it.legend.placement="bottom";break;case"Right side":it.legend.placement="right";break}switch(Fe.pieType){case"pie":it.pieType=ki.Pie;break;case"donut":it.pieType=ki.Donut;break}return Fe.legend&&(Fe.legend.show||(it.legend.showLegend=!1),Fe.legend.values&&it.legend.values.push(_i.Value),Fe.legend.percentage&&it.legend.values.push(_i.Percent)),Fe.legendType==="On graph"&&(it.legend.showLegend=!1,it.displayLabels=[gi.Name],Fe.legend.values&&it.displayLabels.push(gi.Value),Fe.legend.percentage&&it.displayLabels.push(gi.Percent)),it}return{}};class Af{getSuggestionsForData(Ee){const Ce=Ee.getListAppender({name:_a.m.PieChart,pluginId:"piechart",options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},displayLabels:[gi.Percent],legend:{calcs:[],displayMode:Xe.lm.Hidden,placement:"right",values:[],showLegend:!1}}}),{dataSummary:Fe}=Ee;if(Fe.hasNumberField){if(Fe.hasStringField&&Fe.frameCount===1){if(Fe.rowCountTotal>30||Fe.rowCountTotal<2)return;Ce.append({name:_a.m.PieChart,options:{reduceOptions:{values:!0,calcs:[]}}}),Ce.append({name:_a.m.PieChartDonut,options:{reduceOptions:{values:!0,calcs:[]},pieType:ki.Donut}});return}Fe.numberFieldCount>30||Fe.numberFieldCount<2||(Ce.append({name:_a.m.PieChart}),Ce.append({name:_a.m.PieChartDonut,options:{pieType:ki.Donut}}))}}}const Ou=new O.m(Of).setPanelChangeHandler(sd).useFieldConfig({disableStandardOptions:[Mt.uo.Thresholds],standardOptions:{[Mt.uo.Color]:{settings:{byValueSupport:!1,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:wt.Y.PaletteClassic}}},useCustomConfig:J=>{ia.e(J)}}).setPanelOptions(J=>{(0,_r.L)(J),J.addRadio({name:"Piechart type",description:"How the piechart should be rendered",path:"pieType",settings:{options:[{value:ki.Pie,label:"Pie"},{value:ki.Donut,label:"Donut"}]},defaultValue:ki.Pie}).addMultiSelect({name:"Labels",path:"displayLabels",description:"Select the labels to be displayed in the pie chart",settings:{options:[{value:gi.Percent,label:"Percent"},{value:gi.Name,label:"Name"},{value:gi.Value,label:"Value"}]}}),wn.D(J),sa.H(J,!1),J.addMultiSelect({name:"Legend values",path:"legend.values",category:["Legend"],settings:{options:[{value:_i.Percent,label:"Percent"},{value:_i.Value,label:"Value"}]},showIf:Ee=>Ee.legend.showLegend!==!1})}).setSuggestionsSupplier(new Af);var Rf=e(36373),Iu=e(11082),el=e(34163),Au=e(82389),Lf=e(11389),Ru=e(58749),Bf=e(52415),Uf=e(10875),Nf=e(21164);const Lu=({series:J,dataIdxs:Ee,seriesIdx:Ce,mode:Fe=Xe.$N.Single,sortOrder:He=Xe.xB.None,isPinned:it,annotate:vt,timeRange:Nt,withDuration:kt,maxHeight:Zt})=>{const ln=(0,z.of)(Dr.$),bn=J.fields[0],Nn=Ce!=null?Ee[Ce]:Ee.find(da=>da!=null),mn=bn.display(bn.values[Nn]).text;Fe=it?Xe.$N.Single:Fe;const Wn=(0,Uf.cp)(J.fields,bn,Ee,Ce,Fe,He);if(kt&&Fe===Xe.$N.Single){const da=J.fields[Ce],Xn=(0,Gs.GY)(da,Nn);let Gn;Xn&&(Gn=bn.values[Xn]);const ea=bn.values[Nn];let qa;if(Gn)qa=Gn&&(0,Gs.c5)(Gn-ea);else{const Wa=Nt.to.valueOf();qa=(0,Gs.c5)(Wa-ea)}Wn.push({label:"Duration",value:qa})}let ba;if(it&&Ce!=null){const da=J.fields[Ce],Xn=Ee[Ce],Gn=(0,Nf.u)(da,Xn);ba=C.createElement(Ru.S,{dataLinks:Gn,annotate:vt})}const oa={label:bn.type===It.PU.time?"":bn.state?.displayName??bn.name,value:mn};return C.createElement("div",{className:ln.wrapper},C.createElement(Bf.A,{item:oa,isPinned:it}),C.createElement(Lf.o,{items:Wn,isPinned:it,scrollable:(0,ao.T5)({mode:Fe,maxHeight:Zt}),maxHeight:Zt}),ba)},wf=({data:J,timeRange:Ee,timeZone:Ce,options:Fe,width:He,height:it,replaceVariables:vt,onChangeTimeRange:Nt})=>{const kt=(0,z.$j)(),[Zt,ln]=(0,C.useState)(null),{sync:bn,eventsScope:Nn,canAddAnnotations:mn,dataLinkPostProcessor:Wn,eventBus:ba}=(0,cn.d2)(),oa=bn?.()??Xi.y.Off,{frames:da,warn:Xn}=(0,C.useMemo)(()=>(0,Gs.Qe)(J.series,Fe.mergeValues??!0,Ee,kt),[J.series,Fe.mergeValues,Ee,kt]),Gn=(0,C.useMemo)(()=>(0,Gs.Or)(da,Fe.legend,kt),[da,Fe.legend,kt]),ea=(0,C.useMemo)(()=>(0,ao.Fg)(Fe.timezone,Ce),[Fe.timezone,Ce]);if(!da||Xn)return C.createElement("div",{className:"panel-empty"},C.createElement("p",null,Xn??"No data found in response"));if(da.length===1){const Wa=(0,lu.wC)(da[0])}const qa=!!(mn&&mn());return C.createElement(Au.I,{theme:kt,frames:da,structureRev:J.structureRev,timeRange:Ee,timeZone:ea,width:He,height:it,legendItems:Gn,...Fe,mode:Gs.pm.Changes,replaceVariables:vt,dataLinkPostProcessor:Wn,cursorSync:oa},(Wa,Ka)=>C.createElement(C.Fragment,null,oa!==Xi.y.Off&&C.createElement(ha.K,{config:Wa,eventBus:ba,frame:Ka}),Fe.tooltip.mode!==Xe.$N.None&&C.createElement(Ms.xl,{config:Wa,hoverMode:Fe.tooltip.mode===Xe.$N.Multi?Ms.b3.xAll:Ms.b3.xOne,queryZoom:Nt,syncMode:oa,syncScope:Nn,render:(Ta,aa,Ha,Ma,Oa,Hs,ar)=>{if(qa&&Hs!=null){ln(Hs),Oa();return}const er=()=>{let As=Ta.posToVal(Ta.cursor.left,"x");ln({from:As,to:As}),Oa()};return C.createElement(Lu,{series:Ka,dataIdxs:aa,seriesIdx:Ha,mode:ar?Xe.$N.Multi:Fe.tooltip.mode,sortOrder:Fe.tooltip.sort,isPinned:Ma,timeRange:Ee,annotate:qa?er:void 0,withDuration:!0,maxHeight:Fe.tooltip.maxHeight})},maxWidth:Fe.tooltip.maxWidth}),C.createElement(Ro.W,{annotations:J.annotations??[],config:Wa,timeZone:Ce,newRange:Zt,setNewRange:ln,canvasRegionRendering:!1}),C.createElement(Ca.U,{config:Wa,onChangeTimeRange:Nt})))};var Ff=e(25019);const Wf=(J,Ee,Ce)=>{let Fe=J.options??{};if(Ee==="natel-discrete-panel"&&Ce.angular){const He=Ce.angular,it=J.fieldConfig??{defaults:{},overrides:[]};He.units&&(it.defaults.unit=He.units);const vt={fillOpacity:100,lineWidth:0};it.defaults.custom=vt,Fe.mergeValues=!0;const Nt={type:Ff.d.ValueToText,options:{}};if(it.defaults.mappings=[Nt],(0,w.isArray)(He.colorMaps))for(const kt of He.colorMaps){const Zt=kt.color;Zt&&(Nt.options[kt.text]={color:Zt})}if((0,w.isArray)(He.valueMaps))for(const kt of He.valueMaps){const Zt=kt.text,ln=kt.value;if(Zt&&ln){let bn=Nt.options[ln];bn?bn.text=Zt:Nt.options[ln]={text:Zt}}}if((0,w.isArray)(He.rangeMaps))for(const kt of He.rangeMaps){let Zt=+kt.from,ln=+kt.to;const bn=kt.text;bn&&it.defaults.mappings.push({type:Ff.d.RangeToText,options:{from:Zt,to:ln,result:{text:bn}}})}J.fieldConfig=it}return Fe},Ql={alignValue:"left",mergeValues:!0,rowHeight:.9,showValue:Xe.yL.Auto},rd={fillOpacity:70,lineWidth:0};class Mc{getSuggestionsForData(Ee){const{dataSummary:Ce}=Ee;if(!Ce.hasData||!Ce.hasTimeField||!Ce.hasStringField&&!Ce.hasNumberField||Ce.numberFieldCount>=30||Ce.preferredVisualisationType==="logs")return;Ee.getListAppender({name:"",pluginId:"state-timeline",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}).append({name:_a.m.StateTimeline})}}const Bu=new O.m(wf).setPanelChangeHandler(Wf).useFieldConfig({standardOptions:{[Mt.uo.Color]:{settings:{byValueSupport:!0},defaultValue:{mode:wt.Y.ContinuousGrYlRd}}},useCustomConfig:J=>{J.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:rd.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:rd.fillOpacity,settings:{min:0,max:100,step:1}}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:"Connect null values",defaultValue:!1,editor:el.e,override:el.e,shouldApply:Ee=>Ee.type!==It.PU.time,process:Ht.hS,settings:{isTime:!0}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:"Disconnect values",defaultValue:!1,editor:Iu.Z,override:Iu.Z,shouldApply:Ee=>Ee.type!==It.PU.time,process:Ht.hS,settings:{isTime:!0}}),ia.e(J)}}).setPanelOptions(J=>{J.addBooleanSwitch({path:"mergeValues",name:"Merge equal consecutive values",defaultValue:Ql.mergeValues}).addRadio({path:"showValue",name:"Show values",settings:{options:[{value:Xe.yL.Auto,label:"Auto"},{value:Xe.yL.Always,label:"Always"},{value:Xe.yL.Never,label:"Never"}]},defaultValue:Ql.showValue}).addRadio({path:"alignValue",name:"Align values",settings:{options:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]},defaultValue:Ql.alignValue}).addSliderInput({path:"rowHeight",name:"Row height",settings:{min:0,max:1,step:.01},defaultValue:Ql.rowHeight}),sa.H(J,!1),wn.D(J)}).setSuggestionsSupplier(new Mc).setDataSupport({annotations:!0}),Yl=({data:J,timeRange:Ee,timeZone:Ce,options:Fe,width:He,height:it,replaceVariables:vt,onChangeTimeRange:Nt})=>{const kt=(0,z.$j)(),[Zt,ln]=(0,C.useState)(null),{sync:bn,eventsScope:Nn,canAddAnnotations:mn,dataLinkPostProcessor:Wn,eventBus:ba}=(0,cn.d2)(),oa=bn?.()??Xi.y.Off,da=!!(mn&&mn()),{frames:Xn,warn:Gn}=(0,C.useMemo)(()=>(0,Gs.Qe)(J.series,!1,Ee,kt),[J.series,Ee,kt]),ea=(0,C.useMemo)(()=>(0,Gs.Or)(Xn,Fe.legend,kt),[Xn,Fe.legend,kt]),qa=(0,C.useMemo)(()=>(0,ao.Fg)(Fe.timezone,Ce),[Fe.timezone,Ce]);return!Xn||Gn?C.createElement("div",{className:"panel-empty"},C.createElement("p",null,Gn??"No data found in response")):Xn[0].length>He/2?C.createElement("div",{className:"panel-empty"},C.createElement("p",null,"Too many points to visualize properly. ",C.createElement("br",null),"Update the query to return fewer points. ",C.createElement("br",null),"(",Xn[0].length," points received)")):C.createElement(Au.I,{theme:kt,frames:Xn,structureRev:J.structureRev,timeRange:Ee,timeZone:qa,width:He,height:it,legendItems:ea,...Fe,mode:Gs.pm.Samples,replaceVariables:vt,dataLinkPostProcessor:Wn,cursorSync:oa},(Wa,Ka)=>C.createElement(C.Fragment,null,oa!==Xi.y.Off&&C.createElement(ha.K,{config:Wa,eventBus:ba,frame:Ka}),Fe.tooltip.mode!==Xe.$N.None&&C.createElement(Ms.xl,{config:Wa,hoverMode:Fe.tooltip.mode===Xe.$N.Multi?Ms.b3.xAll:Ms.b3.xOne,queryZoom:Nt,syncMode:oa,syncScope:Nn,render:(Ta,aa,Ha,Ma,Oa,Hs,ar)=>{if(da&&Hs!=null){ln(Hs),Oa();return}const er=()=>{let As=Ta.posToVal(Ta.cursor.left,"x");ln({from:As,to:As}),Oa()};return C.createElement(Lu,{series:Ka,dataIdxs:aa,seriesIdx:Ha,mode:ar?Xe.$N.Multi:Fe.tooltip.mode,sortOrder:Fe.tooltip.sort,isPinned:Ma,timeRange:Ee,annotate:da?er:void 0,withDuration:!1,maxHeight:Fe.tooltip.maxHeight})},maxWidth:Fe.tooltip.maxWidth}),C.createElement(Ro.W,{annotations:J.annotations??[],config:Wa,timeZone:Ce,newRange:Zt,setNewRange:ln,canvasRegionRendering:!1}),C.createElement(Ca.U,{config:Wa,onChangeTimeRange:Nt})))},xc={colWidth:.9,rowHeight:.9,showValue:Xe.yL.Auto},Uu={fillOpacity:70,lineWidth:1};class Nu{getSuggestionsForData(Ee){const{dataSummary:Ce}=Ee;if(!Ce.hasData||!Ce.hasTimeField||!Ce.hasStringField&&!Ce.hasNumberField||Ce.numberFieldCount>=30||Ce.rowCountMax>100||Ce.preferredVisualisationType==="logs")return;Ee.getListAppender({name:"",pluginId:"status-history",options:{},fieldConfig:{defaults:{color:{mode:wt.Y.ContinuousGrYlRd},custom:{}},overrides:[]},cardOptions:{previewModifier:He=>{He.options.colWidth=.7}}}).append({name:_a.m.StatusHistory})}}const Kf=new O.m(Yl).useFieldConfig({standardOptions:{[Mt.uo.Color]:{settings:{byValueSupport:!0},defaultValue:{mode:wt.Y.Thresholds}}},useCustomConfig:J=>{J.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:Uu.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:Uu.fillOpacity,settings:{min:0,max:100,step:1}}),ia.e(J)}}).setPanelOptions(J=>{J.addRadio({path:"showValue",name:"Show values",settings:{options:[{value:Xe.yL.Auto,label:"Auto"},{value:Xe.yL.Always,label:"Always"},{value:Xe.yL.Never,label:"Never"}]},defaultValue:Xe.yL.Auto}).addSliderInput({path:"rowHeight",name:"Row height",defaultValue:.9,settings:{min:0,max:1,step:.01}}).addSliderInput({path:"colWidth",name:"Column width",defaultValue:.9,settings:{min:0,max:1,step:.01}}),sa.H(J,!1),wn.D(J)}).setSuggestionsSupplier(new Nu).setDataSupport({annotations:!0});var $f=e(69550),hl=e(39651),Bn=e(15292);function Vf({onChange:J,value:Ee,context:Ce}){const Fe=He=>{He?.currentTarget.checked&&(Ce.options.footer.show=!1),J(He?.currentTarget.checked)};return C.createElement(Bn.d,{value:!!Ee,onChange:Fe})}var wu=e(39938);const tl=({cellOptions:J,onChange:Ee})=>{const Ce=()=>{J.wrapText=!J.wrapText,Ee(J)},Fe=C.createElement(gl.J,{description:"If selected text will be wrapped to the width of text in the configured column"},"Wrap text ",C.createElement(wu.E,{text:"Alpha",color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}}));return C.createElement(C.Fragment,null,C.createElement(zi.D,{label:Fe},C.createElement(Bn.d,{value:J.wrapText,onChange:Ce})))};function zf({cellOptions:J,onChange:Ee}){const Ce=He=>{J.mode=He,Ee(J)},Fe=He=>{J.valueDisplayMode=He,Ee(J)};return C.createElement(R.B,{direction:"column",gap:0},C.createElement(zi.D,{label:"Gauge display mode"},C.createElement(ta.z,{value:J?.mode??Xe.eX.Gradient,onChange:Ce,options:od})),C.createElement(zi.D,{label:"Value display"},C.createElement(ta.z,{value:J?.valueDisplayMode??Xe.$l.Text,onChange:Fe,options:kf})))}const od=[{value:Xe.eX.Basic,label:"Basic"},{value:Xe.eX.Gradient,label:"Gradient"},{value:Xe.eX.Lcd,label:"Retro LCD"}],kf=[{value:Xe.$l.Color,label:"Value color"},{value:Xe.$l.Text,label:"Text color"},{value:Xe.$l.Hidden,label:"Hidden"}],rp=[{value:Xe.Wq.Basic,label:"Basic"},{value:Xe.Wq.Gradient,label:"Gradient"}],_f=({cellOptions:J,onChange:Ee})=>{const Ce=vt=>{J.mode=vt,Ee(J)},Fe=()=>{J.applyToRow=!J.applyToRow,Ee(J)},He=()=>{J.wrapText=!J.wrapText,Ee(J)},it=C.createElement(gl.J,{description:"If selected text will be wrapped to the width of text in the configured column"},"Wrap text ",C.createElement(wu.E,{text:"Alpha",color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}}));return C.createElement(C.Fragment,null,C.createElement(zi.D,{label:"Background display mode"},C.createElement(ta.z,{value:J?.mode??Xe.Wq.Gradient,onChange:Ce,options:rp})),C.createElement(zi.D,{label:"Apply to entire row",description:"If selected the entire row will be colored as this cell would be."},C.createElement(Bn.d,{value:J.applyToRow,onChange:Fe})),C.createElement(zi.D,{label:it},C.createElement(Bn.d,{value:J.wrapText,onChange:He})))};var Oc=e(28528),Hf=e(30355);const id=["hideValue","drawStyle","lineInterpolation","barAlignment","lineWidth","fillOpacity","gradientMode","lineStyle","spanNulls","showPoints","pointSize"];function nl(J){const Ee=(0,an.V)(J);return{...Ee,useCustomConfig:Ce=>{Ee.useCustomConfig?.(Ce),Ce.addBooleanSwitch({path:"hideValue",name:"Hide value"})}}}const Gf=J=>{const{cellOptions:Ee,onChange:Ce}=J,Fe=(0,C.useMemo)(()=>{const vt=nl(Hf.t);return(0,Oc.O)(vt,"ChartCell")},[]),He=(0,z.of)(Ic),it={...Hf.t,...Ee};return C.createElement(Fn.gW,null,Fe.list(id.map(vt=>`custom.${vt}`)).map(vt=>{if(vt.showIf&&!vt.showIf(it))return null;const Nt=vt.editor,kt=vt.path;return C.createElement(zi.D,{label:vt.name,key:vt.id,className:He.field},C.createElement(Nt,{onChange:Zt=>Ce({...Ee,[kt]:Zt}),value:(Fu(kt,it)?it[kt]:void 0)??vt.defaultValue,item:vt,context:{data:[]}}))}))};function Fu(J,Ee){return J in Ee}const Ic=()=>({field:(0,se.css)`
    width: 100%;

    // @TODO don't show "scheme" option for custom gradient mode.
    // it needs thresholds to work, which are not supported
    // for area chart cell right now
    [title='Use color scheme to define gradient'] {
      display: none;
    }
  `}),ld=({value:J,onChange:Ee})=>{const Ce=J.type,Fe=(0,z.of)(jf),He=cd.find(Zt=>Zt.value.type===Ce);let[it,vt]=(0,C.useState)({});const Nt=Zt=>{Zt.value!==void 0&&(J=Zt.value,it[J.type]!==void 0&&Object.keys(it[J.type]).length>1&&(J=(0,w.merge)(J,it[J.type])),Ee(J))},kt=Zt=>{it[J.type]=(0,w.merge)(J,Zt),vt(it),Ee(it[J.type])};return C.createElement("div",{className:Fe.fixBottomMargin},C.createElement(zi.D,null,C.createElement(W.l6,{options:cd,value:He,onChange:Nt})),(Ce===Xe.ob.Auto||Ce===Xe.ob.ColorText)&&C.createElement(tl,{cellOptions:J,onChange:kt}),Ce===Xe.ob.Gauge&&C.createElement(zf,{cellOptions:J,onChange:kt}),Ce===Xe.ob.ColorBackground&&C.createElement(_f,{cellOptions:J,onChange:kt}),Ce===Xe.ob.Sparkline&&C.createElement(Gf,{cellOptions:J,onChange:kt}))},cd=[{value:{type:Xe.ob.Auto},label:"Auto"},{value:{type:Xe.ob.Sparkline},label:"Sparkline"},{value:{type:Xe.ob.ColorText},label:"Colored text"},{value:{type:Xe.ob.ColorBackground},label:"Colored background"},{value:{type:Xe.ob.Gauge},label:"Gauge"},{value:{type:Xe.ob.DataLinks},label:"Data links"},{value:{type:Xe.ob.JSONView},label:"JSON View"},{value:{type:Xe.ob.Image},label:"Image"}],jf=J=>({fixBottomMargin:(0,se.css)({marginBottom:J.spacing(-2)})}),Ac={cellHeight:Xe.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]};class Wu{getSuggestionsForData(Ee){const Ce=Ee.getListAppender({name:_a.m.Table,pluginId:"table",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:Fe=>{Fe.fieldConfig.defaults.custom.minWidth=50}}});Ee.dataSummary.fieldCount===0?Ce.append({cardOptions:{imgSrc:"public/app/plugins/panel/table/img/icn-table-panel.svg"}}):Ce.append({})}}const Hi="Table footer",vl=["Cell options"],Al=new O.m(mu).setPanelChangeHandler(Il.l1).setMigrationHandler(Il.fq).useFieldConfig({useCustomConfig:J=>{J.addNumberInput({path:"minWidth",name:"Minimum column width",description:"The minimum width for column auto resizing",settings:{placeholder:"150",min:50,max:500},shouldApply:()=>!0,defaultValue:hl.gB.minWidth}).addNumberInput({path:"width",name:"Column width",settings:{placeholder:"auto",min:20,max:300},shouldApply:()=>!0,defaultValue:hl.gB.width}).addRadio({path:"align",name:"Column alignment",settings:{options:[{label:"Auto",value:"auto"},{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"}]},defaultValue:hl.gB.align}).addCustomEditor({id:"cellOptions",path:"cellOptions",name:"Cell type",editor:ld,override:ld,defaultValue:hl.gB.cellOptions,process:Ht.hS,category:vl,shouldApply:()=>!0}).addBooleanSwitch({path:"inspect",name:"Cell value inspect",description:"Enable cell value inspection in a modal window",defaultValue:!1,category:vl,showIf:Ee=>Ee.cellOptions.type===Xe.ob.Auto||Ee.cellOptions.type===Xe.ob.JSONView||Ee.cellOptions.type===Xe.ob.ColorText||Ee.cellOptions.type===Xe.ob.ColorBackground}).addBooleanSwitch({path:"filterable",name:"Column filter",description:"Enables/disables field filters in table",defaultValue:hl.gB.filterable}).addBooleanSwitch({path:"hidden",name:"Hide in table",defaultValue:void 0,hideFromDefaults:!0})}}).setPanelOptions(J=>{J.addBooleanSwitch({path:"showHeader",name:"Show table header",defaultValue:Ac.showHeader}).addRadio({path:"cellHeight",name:"Cell height",defaultValue:Ac.cellHeight,settings:{options:[{value:Xe.qM.Sm,label:"Small"},{value:Xe.qM.Md,label:"Medium"},{value:Xe.qM.Lg,label:"Large"}]}}).addBooleanSwitch({path:"footer.show",category:[Hi],name:"Show table footer",defaultValue:Ac.footer?.show}).addCustomEditor({id:"footer.reducer",category:[Hi],path:"footer.reducer",name:"Calculation",description:"Choose a reducer function / calculation",editor:$f.D.get("stats-picker").editor,defaultValue:[fl.gy.sum],showIf:Ee=>Ee.footer?.show}).addBooleanSwitch({path:"footer.countRows",category:[Hi],name:"Count rows",description:"Display a single count for all data rows",defaultValue:Ac.footer?.countRows,showIf:Ee=>Ee.footer?.reducer?.length===1&&Ee.footer?.reducer[0]===fl.gy.count}).addMultiSelect({path:"footer.fields",category:[Hi],name:"Fields",description:"Select the fields that should be calculated",settings:{allowCustomValue:!1,options:[],placeholder:"All Numeric Fields",getOptions:async Ee=>{const Ce=[];if(Ee&&Ee.data&&Ee.data.length>0){const Fe=Ee.data[0];for(const He of Fe.fields)if(He.type===It.PU.number){const it=(0,fr.Ct)(He,Fe,Ee.data),vt=He.name;Ce.push({value:vt,label:it})}}return Ce}},defaultValue:"",showIf:Ee=>Ee.footer?.show&&!Ee.footer?.countRows}).addCustomEditor({id:"footer.enablePagination",path:"footer.enablePagination",name:"Enable pagination",editor:Vf})}).setSuggestionsSupplier(new Wu);var dd=e(49880),Qf=e.n(dd),Yf=e(40996),Jf=e(36663),Wo=(J=>(J.Code="code",J.HTML="html",J.Markdown="markdown",J))(Wo||{}),Ku=(J=>(J.Go="go",J.Html="html",J.Json="json",J.Markdown="markdown",J.Plaintext="plaintext",J.Sql="sql",J.Typescript="typescript",J.Xml="xml",J.Yaml="yaml",J))(Ku||{});const op="plaintext",al={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},ud={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"};function Zf(J){const Ee=(0,z.of)(Xf),[Ce,Fe]=(0,C.useState)({mode:J.options.mode,content:$u(J.options,J.replaceVariables,fe.Ay.disableSanitizeHtml)});if((0,Yf.A)(()=>{const{options:He,replaceVariables:it}=J,vt=$u(He,it,fe.Ay.disableSanitizeHtml);(vt!==Ce.content||He.mode!==Ce.mode)&&Fe({mode:He.mode,content:vt})},100,[J]),Ce.mode===Wo.Code){const He=J.options.code??al;return C.createElement(Pc.B,{key:`${He.showLineNumbers}/${He.showMiniMap}`,value:Ce.content,language:He.language??al.language,width:J.width,height:J.height,containerStyles:Ee.codeEditorContainer,showMiniMap:He.showMiniMap,showLineNumbers:He.showLineNumbers,readOnly:!0})}return C.createElement(q.E,{autoHeightMin:"100%",className:Ee.containStrict},C.createElement(Qf(),{allowRerender:!0,html:Ce.content,className:Ee.markdown,"data-testid":"TextPanel-converted-content"}))}function $u(J,Ee,Ce){let{mode:Fe,content:He}=J;if(!He)return" ";switch(He=Ee(He,{},J.code?.language==="json"?"json":"html"),Fe){case Wo.Code:break;case Wo.HTML:Ce||(He=Di.sQ.sanitizeTextPanelContent(He));break;case Wo.Markdown:default:He=(0,Jf.P)(He,{noSanitize:Ce})}return He}const Xf=J=>({codeEditorContainer:(0,se.css)`
    .monaco-editor .margin,
    .monaco-editor-background {
      background-color: ${J.colors.background.primary};
    }
  `,markdown:(0,se.cx)("markdown-html",(0,se.css)`
      height: 100%;
    `),containStrict:(0,se.css)({contain:"strict"})});var Vu=e(70713),qf=e(99544);const eg=({value:J,onChange:Ee,context:Ce})=>{const Fe=(0,C.useMemo)(()=>Ce.options?.mode??Wo.Markdown,[Ce]),He=(0,z.of)(tg),it=()=>Ce.getSuggestions?Ce.getSuggestions().map(vt=>(0,qf.O)(vt)):[];return C.createElement("div",{className:(0,se.cx)(He.editorBox)},C.createElement(Vu.Ay,{disableHeight:!0},({width:vt})=>vt===0?null:C.createElement(Pc.B,{value:J,onBlur:Ee,onSave:Ee,language:Fe,width:vt,showMiniMap:!1,showLineNumbers:!1,height:"500px",getSuggestions:it})))},tg=J=>({editorBox:(0,se.css)`
    label: editorBox;
    border: 1px solid ${J.colors.border.medium};
    border-radius: ${J.shape.radius.default};
    margin: ${J.spacing(.5)} 0;
    width: 100%;
  `}),ng=J=>{const Ee=parseFloat(J.pluginVersion||"6.1");let Ce=J.options;if(J.hasOwnProperty("content")&&J.hasOwnProperty("mode")){const He=J,it=He.content,vt=He.mode;delete He.content,delete He.mode,Ee<7.1&&(Ce={content:it,mode:vt})}return[Wo.Code,Wo.HTML,Wo.Markdown].find(He=>He===Ce.mode)||(Ce={...Ce,mode:Wo.Markdown}),Ce},El=new O.m(Zf).setPanelOptions(J=>{J.addRadio({path:"mode",name:"Mode",settings:{options:[{value:Wo.Markdown,label:"Markdown"},{value:Wo.HTML,label:"HTML"},{value:Wo.Code,label:"Code"}]},defaultValue:ud.mode}).addSelect({path:"code.language",name:"Language",settings:{options:Object.values(Ku).map(Ee=>({value:Ee,label:Ee}))},defaultValue:al.language,showIf:Ee=>Ee.mode===Wo.Code}).addBooleanSwitch({path:"code.showLineNumbers",name:"Show line numbers",defaultValue:al.showLineNumbers,showIf:Ee=>Ee.mode===Wo.Code}).addBooleanSwitch({path:"code.showMiniMap",name:"Show mini map",defaultValue:al.showMiniMap,showIf:Ee=>Ee.mode===Wo.Code}).addCustomEditor({id:"content",path:"content",name:"Content",editor:eg,defaultValue:ud.content})}).setMigrationHandler(ng);var ci=e(41260),ip=e(18282);class md{getSuggestionsForData(Ee){const{dataSummary:Ce}=Ee;if(!Ce.hasTimeField||!Ce.hasNumberField||Ce.rowCountTotal<2)return;const Fe=Ee.getListAppender({name:_a.m.LineChart,pluginId:"timeseries",options:{legend:{calcs:[],displayMode:Xe.lm.Hidden,placement:"right",showLegend:!1}},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:it=>{it.fieldConfig?.defaults.custom?.drawStyle!==Xe.GR.Bars&&(it.fieldConfig.defaults.custom.lineWidth=Math.max(it.fieldConfig.defaults.custom.lineWidth??1,2))}}}),He=100;if(Fe.append({name:_a.m.LineChart}),Ce.rowCountMax<200&&Fe.append({name:_a.m.LineChartSmooth,fieldConfig:{defaults:{custom:{lineInterpolation:Xe.dx.Smooth}},overrides:[]}}),Ce.numberFieldCount===1){Fe.append({name:_a.m.AreaChart,fieldConfig:{defaults:{custom:{fillOpacity:25}},overrides:[]}}),Fe.append({name:_a.m.LineChartGradientColorScheme,fieldConfig:{defaults:{color:{mode:wt.Y.ContinuousGrYlRd},custom:{gradientMode:Xe.on.Scheme,lineInterpolation:Xe.dx.Smooth,lineWidth:3,fillOpacity:20}},overrides:[]}}),Ce.rowCountMax<He&&(Fe.append({name:_a.m.BarChart,fieldConfig:{defaults:{custom:{drawStyle:Xe.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:Xe.on.Hue}},overrides:[]}}),Fe.append({name:_a.m.BarChartGradientColorScheme,fieldConfig:{defaults:{color:{mode:wt.Y.ContinuousGrYlRd},custom:{drawStyle:Xe.GR.Bars,fillOpacity:90,lineWidth:1,gradientMode:Xe.on.Scheme}},overrides:[]}}));return}Fe.append({name:_a.m.AreaChartStacked,fieldConfig:{defaults:{custom:{fillOpacity:25,stacking:{mode:Xe.gs.Normal,group:"A"}}},overrides:[]}}),Fe.append({name:_a.m.AreaChartStackedPercent,fieldConfig:{defaults:{custom:{fillOpacity:25,stacking:{mode:Xe.gs.Percent,group:"A"}}},overrides:[]}}),Ce.rowCountTotal/Ce.numberFieldCount<He&&(Fe.append({name:_a.m.BarChartStacked,fieldConfig:{defaults:{custom:{drawStyle:Xe.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:Xe.on.Hue,stacking:{mode:Xe.gs.Normal,group:"A"}}},overrides:[]}}),Fe.append({name:_a.m.BarChartStackedPercent,fieldConfig:{defaults:{custom:{drawStyle:Xe.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:Xe.on.Hue,stacking:{mode:Xe.gs.Percent,group:"A"}}},overrides:[]}}))}}function Bi(J){const Ee=(0,Ie.UA)().getCurrent()?.getPanelById(J);if(Ee){const Ce=Ee.transformations?[...Ee.transformations]:[];return Ce.push({id:ip.F.prepareTimeSeries,options:{format:"wide"}}),{name:"Transform to wide time series format",pluginId:"timeseries",transformations:Ce}}}const fd=({data:J,timeRange:Ee,timeZone:Ce,width:Fe,height:He,options:it,fieldConfig:vt,onChangeTimeRange:Nt,replaceVariables:kt,id:Zt})=>{const{sync:ln,eventsScope:bn,canAddAnnotations:Nn,onThresholdsChange:mn,canEditThresholds:Wn,showThresholds:ba,dataLinkPostProcessor:oa,eventBus:da}=(0,cn.d2)(),Xn=it.orientation===Xe.wV.Vertical,Gn=(0,C.useMemo)(()=>(0,ao.B_)(J.series,fe.config.theme2,Ee),[J.series,Ee]),ea=(0,C.useMemo)(()=>(0,ao.Fg)(it.timezone,Ce),[it.timezone,Ce]),qa=(0,C.useMemo)(()=>{if(Gn?.length&&Gn.every(Ha=>Ha.meta?.type===ci.m.TimeSeriesLong)){const Ha=Bi(Zt);return{message:"Long data must be converted to wide",suggestions:Ha?[Ha]:void 0}}},[Gn,Zt]),Wa=!!(Nn&&Nn()),[Ka,Ta]=(0,C.useState)(null),aa=ln?.()??Xi.y.Off;return!Gn||qa?C.createElement(ga.a,{panelId:Zt,message:qa?.message,fieldConfig:vt,data:J,needsTimeField:!0,needsNumberField:!0,suggestions:qa?.suggestions}):C.createElement(io,{frames:Gn,structureRev:J.structureRev,timeRange:Ee,timeZone:ea,width:Fe,height:He,legend:it.legend,options:it,replaceVariables:kt,dataLinkPostProcessor:oa,cursorSync:aa},(Ha,Ma)=>C.createElement(C.Fragment,null,C.createElement(On.Z,{config:Ha}),aa!==Xi.y.Off&&C.createElement(ha.K,{config:Ha,eventBus:da,frame:Ma}),it.tooltip.mode!==Xe.$N.None&&C.createElement(Ms.xl,{config:Ha,hoverMode:it.tooltip.mode===Xe.$N.Single?Ms.b3.xOne:Ms.b3.xAll,queryZoom:Nt,clientZoom:!0,syncMode:aa,syncScope:bn,render:(Oa,Hs,ar,er=!1,As,bs,rs)=>{if(Wa&&bs!=null){Ta(bs),As();return}const Zs=()=>{let hr=Oa.posToVal(Oa.cursor.left,"x");Ta({from:hr,to:hr}),As()};return C.createElement(Dr.k,{series:Ma,dataIdxs:Hs,seriesIdx:ar,mode:rs?Xe.$N.Multi:it.tooltip.mode,sortOrder:it.tooltip.sort,isPinned:er,annotate:Wa?Zs:void 0,maxHeight:it.tooltip.maxHeight})},maxWidth:it.tooltip.maxWidth}),!Xn&&C.createElement(C.Fragment,null,C.createElement(Ro.W,{annotations:J.annotations??[],config:Ha,timeZone:Ce,newRange:Ka,setNewRange:Ta}),C.createElement(Ca.U,{config:Ha,onChangeTimeRange:Nt}),J.annotations&&C.createElement(Jn,{visibleSeries:Zn(Ha,Gn),config:Ha,exemplars:J.annotations,timeZone:Ce}),(Wn&&mn||ba)&&C.createElement(fs,{config:Ha,fieldConfig:vt,onThresholdsChange:Wn?mn:void 0}))))};var gd=e(91410),Rl=e(20333);const lp=({value:J,onChange:Ee})=>{const Ce=(0,z.of)(ag);(!J||J.length<1)&&(J=[""]);const Fe=()=>{Ee([...J,gd.g$.default])},He=vt=>{const Nt=J.slice();Nt.splice(vt,1),Ee(Nt)},it=(vt,Nt)=>{const kt=J.slice();kt[vt]=Nt??gd.g$.default,kt.length===0||kt.length===1&&kt[0]===""?Ee(void 0):Ee(kt)};return C.createElement("div",null,J.map((vt,Nt)=>C.createElement("div",{className:Ce.wrapper,key:`${Nt}.${vt}`},C.createElement("span",{className:Ce.first},C.createElement(Rl.U,{onChange:kt=>it(Nt,kt),includeInternal:!0,value:vt??gd.g$.default})),Nt===J.length-1?C.createElement(_e.K,{name:"plus",onClick:Fe,tooltip:"Add timezone"}):C.createElement(_e.K,{name:"times",onClick:()=>He(Nt),tooltip:"Remove timezone"}))))},ag=J=>({wrapper:(0,se.css)`
    width: 100%;
    display: flex;
    flex-direction: rows;
    align-items: center;
  `,first:(0,se.css)`
    margin-right: 8px;
    flex-grow: 2;
  `});var zu=e(50082),sg=e(74856),ku=e(38477),rg=e(24283),og=e(32023),ig=e(68706);let pd=null;const lg=(J,Ee,Ce,Fe)=>{if(Ee==="graph"&&Ce.angular){const{fieldConfig:He,options:it,annotations:vt}=cg({...Ce.angular,fieldConfig:Fe,panel:J});return vt?.length>0&&mg(vt),J.fieldConfig=He,J.alert=Ce.angular.alert,it}return ug(J),{}};function cg(J){let Ee=[];const Ce=J.fieldConfig?.overrides??[],Fe=J.yaxes??[];let He=dg(Fe[0]);J.fieldConfig?.defaults&&(He={...J.fieldConfig?.defaults,...He});const it={fill:J.dashes?"dash":"solid",dash:[J.dashLength??10,J.spaceLength??10]};if(J.aliasColors)for(const bn of Object.keys(J.aliasColors)){const Nn=J.aliasColors[bn];Nn&&Ce.push({matcher:{id:qi.Ct.byName,options:bn},properties:[{id:Mt.uo.Color,value:{mode:wt.Y.Fixed,fixedColor:Nn}}]})}let vt=!1;if(J.seriesOverrides?.length)for(const bn of J.seriesOverrides){if(!bn.alias)continue;const mn={matcher:{id:/^([/~@;%#'])(.*?)\1([gimsuy]*)$/.test(bn.alias)?qi.Ct.byRegexp:qi.Ct.byName,options:bn.alias},properties:[]};let Wn;for(const ba of Object.keys(bn)){const oa=bn[ba];switch(ba){case"alias":case"$$hashKey":break;case"yaxis":if(oa===2){const da=dg(Fe[1]);Jl(He,da,mn.properties)}break;case"fill":mn.properties.push({id:"custom.fillOpacity",value:oa*10});break;case"fillBelowTo":vt=!0,mn.properties.push({id:"custom.fillBelowTo",value:oa});break;case"fillGradient":oa&&(mn.properties.push({id:"custom.fillGradient",value:"opacity"}),mn.properties.push({id:"custom.fillOpacity",value:oa*10}));break;case"points":mn.properties.push({id:"custom.showPoints",value:oa?Xe.yL.Always:Xe.yL.Never});break;case"bars":oa?(mn.properties.push({id:"custom.drawStyle",value:Xe.GR.Bars}),mn.properties.push({id:"custom.fillOpacity",value:100})):mn.properties.push({id:"custom.drawStyle",value:Xe.GR.Line});break;case"lines":oa?mn.properties.push({id:"custom.drawStyle",value:"line"}):mn.properties.push({id:"custom.lineWidth",value:0});break;case"linewidth":mn.properties.push({id:"custom.lineWidth",value:oa});break;case"pointradius":mn.properties.push({id:"custom.pointSize",value:2+oa*2});break;case"dashLength":case"spaceLength":case"dashes":switch(Wn||(Wn={fill:it.fill,dash:[...it.dash]}),ba){case"dashLength":Wn.dash[0]=oa;break;case"spaceLength":Wn.dash[1]=oa;break;case"dashes":Wn.fill=oa?"dash":"solid";break}break;case"stack":mn.properties.push({id:"custom.stacking",value:_u(oa)});break;case"color":mn.properties.push({id:"color",value:{fixedColor:oa,mode:wt.Y.Fixed}});break;case"transform":mn.properties.push({id:"custom.transform",value:oa==="negative-Y"?Xe.NU.NegativeY:Xe.NU.Constant});break;default:console.log("Ignore override migration:",bn.alias,ba,oa)}}Wn&&mn.properties.push({id:"custom.lineStyle",value:Wn}),mn.properties.length&&Ce.push(mn)}const Nt=He.custom??{};Nt.drawStyle=J.bars?Xe.GR.Bars:J.lines?Xe.GR.Line:Xe.GR.Points,J.points?(Nt.showPoints=Xe.yL.Always,(0,w.isNumber)(J.pointradius)&&(Nt.pointSize=2+J.pointradius*2)):Nt.drawStyle!==Xe.GR.Points&&(Nt.showPoints=Xe.yL.Never),Nt.lineWidth=J.linewidth,it.fill!=="solid"&&(Nt.lineStyle=it),vt?Nt.fillOpacity=35:(0,w.isNumber)(J.fill)&&(Nt.fillOpacity=J.fill*10),(0,w.isNumber)(J.fillGradient)&&J.fillGradient>0&&(Nt.gradientMode=Xe.on.Opacity,Nt.fillOpacity=J.fillGradient*10),Nt.spanNulls=J.nullPointMode===Ol.UW.Ignore,J.steppedLine&&(Nt.lineInterpolation=Xe.dx.StepAfter),Nt.drawStyle===Xe.GR.Bars&&(Nt.fillOpacity=100),J.stack&&(Nt.stacking={mode:J.percentage?Xe.gs.Percent:Xe.gs.Normal,group:an.S.stacking.group},J.percentage&&J.yaxis&&(delete He.min,delete He.max,He.decimals===0&&delete He.decimals)),He.custom=(0,w.omitBy)(Nt,w.isNil),He.nullValueMode=J.nullPointMode;const kt={legend:{displayMode:Xe.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:Xe.$N.Single,sort:Xe.xB.None}},Zt=J.legend;if(Zt){if(Zt.show?kt.legend.displayMode=Zt.alignAsTable?Xe.lm.Table:Xe.lm.List:kt.legend.showLegend=!1,Zt.rightSide&&(kt.legend.placement="right"),J.legend.values){const bn=(0,w.pickBy)(J.legend);kt.legend.calcs=Rc(bn)}J.legend.sideWidth&&(kt.legend.width=J.legend.sideWidth),Zt.hideZero&&Ce.push(Ed(fl.gy.allIsZero)),Zt.hideEmpty&&Ce.push(Ed(fl.gy.allIsNull))}J.timeRegions?.length&&J.timeRegions.map((Nn,mn)=>({name:`T${mn}`,color:Nn.colorMode!=="custom"?Nn.colorMode:Nn.fillColor,line:Nn.line,fill:Nn.fill,fromDayOfWeek:Nn.fromDayOfWeek,toDayOfWeek:Nn.toDayOfWeek,from:Nn.from,to:Nn.to})).forEach((Nn,mn)=>{const Wn={datasource:{type:"datasource",uid:"grafana"},enable:!0,hide:!0,filter:{exclude:!1,ids:[J.panel.id]},iconColor:Nn.fillColor??Nn.color,name:`Time region for panel ${J.panel.title}${mn>0?` ${mn}`:""}`,target:{queryType:ig.nj.TimeRegions,refId:"Anno",timeRegion:{fromDayOfWeek:Nn.fromDayOfWeek,toDayOfWeek:Nn.toDayOfWeek,from:Nn.from,to:Nn.to,timezone:"utc"}}};Nn.fill?Ee.push(Wn):Nn.line&&(Wn.iconColor=Nn.lineColor??"white",Ee.push(Wn))});const ln=J.tooltip;if(ln&&(ln.shared!==void 0&&(kt.tooltip.mode=ln.shared?Xe.$N.Multi:Xe.$N.Single),ln.sort!==void 0&&ln.shared))switch(ln.sort){case 1:kt.tooltip.sort=Xe.xB.Ascending;break;case 2:kt.tooltip.sort=Xe.xB.Descending;break;default:kt.tooltip.sort=Xe.xB.None}if(J.thresholds&&J.thresholds.length>0){let bn=[],Nn=!1,mn=!1;const Wn=J.thresholds.sort((oa,da)=>oa.value>da.value?1:-1);for(let oa=0;oa<Wn.length;oa++){const da=Wn[oa],Xn=Wn.length>oa+1?Wn[oa+1]:null;da.fill&&(Nn=!0),da.line&&(mn=!0),da.op==="gt"&&bn.push({value:da.value,color:hd(da)}),da.op==="lt"&&(bn.length===0&&bn.push({value:-1/0,color:hd(da)}),Xn&&Xn.op==="gt"&&Xn.value>da.value?bn.push({value:da.value,color:"transparent"}):Xn&&Xn.op==="lt"?bn.push({value:da.value,color:hd(Xn)}):bn.push({value:da.value,color:"transparent"}))}bn.length>0&&bn[0].value!==-1/0&&bn.unshift({color:"transparent",value:-1/0});let ba=Nn?Xe.Ly.Area:Xe.Ly.Line;mn&&Nn&&(ba=Xe.Ly.LineAndArea),He.custom.thresholdsStyle={mode:ba},He.thresholds={mode:zu.O.Absolute,steps:bn}}return J.xaxis&&J.xaxis.show===!1&&J.xaxis.mode==="time"&&Ce.push({matcher:{id:qi.Ct.byType,options:It.PU.time},properties:[{id:"custom.axisPlacement",value:Xe.vM.Hidden}]}),{fieldConfig:{defaults:(0,w.omitBy)(He,w.isNil),overrides:Ce},options:kt,annotations:Ee}}function hd(J){return J.colorMode==="critical"?"red":J.colorMode==="warning"?"orange":J.colorMode==="custom"?J.fillColor||J.lineColor:"red"}function dg(J){if(!J)return{};const Ee={axisPlacement:J.show?Xe.vM.Auto:Xe.vM.Hidden};if(J.label&&(Ee.axisLabel=J.label),J.logBase){const Ce=J.logBase;(Ce===2||Ce===10)&&(Ee.scaleDistribution={type:Xe.L4.Log,log:Ce})}return(0,w.omitBy)({unit:J.format,decimals:vd(J.decimals),min:vd(J.min),max:vd(J.max),custom:Ee},w.isNil)}function Jl(J,Ee,Ce){for(const[it,vt]of Object.entries(Ee))it!=="custom"&&vt!==J[it]&&Ce.push({id:it,value:vt});Ce.push({id:"custom.axisPlacement",value:Xe.vM.Right});const Fe=J.custom??{},He=Ee.custom??{};for(const[it,vt]of Object.entries(He))vt!==Fe[it]&&Ce.push({id:`custom.${it}`,value:vt})}function vd(J){if((0,w.isNumber)(J))return J;if((0,w.isString)(J)){const Ee=Number(J);if(!isNaN(Ee))return Ee}}function Rc(J){const Ee=[];for(const Ce in J){const Fe=fl.AS.getIfExists(Ce);Fe&&Ee.push(Fe.id)}return Ee}function ug(J){J.fieldConfig?.defaults?.custom?.hideFrom?.graph!==void 0&&(J.fieldConfig.defaults.custom.hideFrom.viz=J.fieldConfig.defaults.custom.hideFrom.graph,delete J.fieldConfig.defaults.custom.hideFrom.graph),J.fieldConfig?.overrides&&(J.fieldConfig.overrides=J.fieldConfig.overrides.map(Ee=>(Ee.properties=Ee.properties.map(Ce=>(Ce.id==="custom.hideFrom"&&Ce.value.graph&&(Ce.value.viz=Ce.value.graph,delete Ce.value.graph),Ce)),Ee)))}function Ed(J){return{matcher:{id:qi.Ct.byValue,options:{reducer:J,op:Xe.zT.GTE,value:0}},properties:[{id:"custom.hideFrom",value:{tooltip:!0,viz:!1,legend:!0}}]}}function _u(J){const Ee=an.S.stacking?.group;return{mode:J?Xe.gs.Normal:Xe.gs.None,group:(0,w.isString)(J)?J:Ee}}function mg(J){const Ee=window.__grafanaSceneContext;if(Ee instanceof rg.H$){const Fe=og.b4.getDataLayers(Ee),He=[...Fe.state.annotationLayers];for(let it of J){const vt=new ku.g({key:`annotations-${it.name}`,query:it,name:it.name,isEnabled:it.enable,isHidden:it.hide});He.push(vt)}Fe.setState({annotationLayers:He});return}const Ce=(0,Ie.UA)().getCurrent();Ce&&(Ce.annotations.list=[...Ce.annotations.list,...J],pd==null&&(pd=setTimeout(()=>{pd=null,(0,sg.jG)().refreshTimeModel()})))}const yd=new O.m(fd).setPanelChangeHandler(lg).useFieldConfig((0,an.V)(an.S)).setPanelOptions(J=>{wn.D(J,!1,!0),sa.H(J),J.addCustomEditor({id:"timezone",name:"Time zone",path:"timezone",category:["Axis"],editor:lp,defaultValue:void 0})}).setSuggestionsSupplier(new md).setDataSupport({annotations:!0,alertStates:!0});var fg=e(92599),Lc=e(35090);const Zl={wrapper:(0,se.css)`
    height: 100%;
    overflow: scroll;
  `},Ll=({data:J,options:Ee})=>{const Ce=(0,C.createRef)(),Fe=(0,C.useMemo)(()=>(0,Lc.L)(J.series[0]),[J.series]),He=(0,vu.A)(async()=>await(0,Gl.l)().get(J.request?.targets[0].datasource?.uid));return!J||!J.series.length||!Fe?C.createElement("div",{className:"panel-empty"},C.createElement("p",null,"No data found in response")):C.createElement("div",{className:Zl.wrapper},C.createElement("div",{ref:Ce}),C.createElement(fg.V,{dataFrames:J.series,scrollElementClass:Zl.wrapper,traceProp:Fe,datasource:He.value,topOfViewRef:Ce,createSpanLink:Ee.createSpanLink,focusedSpanId:Ee.focusedSpanId,createFocusSpanLink:Ee.createFocusSpanLink}))};class bd{getListWithDefaults(Ee){return Ee.getListAppender({name:_a.m.Trace,pluginId:"traces"})}getSuggestionsForData(Ee){!Ee.data||!Ee.data.series[0]||Ee.data.series[0].meta?.preferredVisualisationType==="trace"&&this.getListWithDefaults(Ee).append({name:_a.m.Trace,score:tn.nQ.Best})}}const Bc=new O.m(Ll).setSuggestionsSupplier(new bd);var gg=e(85200),pg=e(40458);const Hu=({data:J,timeRange:Ee,timeZone:Ce,width:Fe,height:He,options:it,fieldConfig:vt,replaceVariables:Nt,id:kt})=>{const{dataLinkPostProcessor:Zt}=(0,cn.d2)(),ln=it.xField??J.series[0].fields.find(mn=>mn.type===It.PU.number)?.name,bn=(mn,Wn,ba)=>(Wn={...Wn,x:gg.sJ.get(qi.Ct.byName).get(ln)},(0,pg.m)(mn,Wn)),Nn=(0,C.useMemo)(()=>{if(J.series.length>1)return{warning:"Only one frame is supported, consider adding a join transformation",frames:J.series};let mn=J.series,Wn;if(it.xField){if(Wn=(0,ys.findFieldIndex)(it.xField,mn[0]),Wn==null)return{warning:"Unable to find field: "+it.xField,frames:J.series}}else if(Wn=mn[0].fields.findIndex(ba=>ba.type===It.PU.number),Wn===-1)return{warning:"No numeric fields found for X axis",frames:mn};if(Wn!=null){const ba=mn[0].fields[Wn];if(ba.type===It.PU.number&&!(0,js.g2)(ba.values))return{warning:"Values must be in ascending order",frames:mn}}return{frames:(0,ao.B_)(mn,x.$.theme2,void 0,Wn)}},[J.series,it.xField]);return Nn.warning||!Nn.frames?C.createElement(ga.a,{panelId:kt,fieldConfig:vt,data:J,message:Nn.warning,needsNumberField:!0}):C.createElement(io,{frames:Nn.frames,structureRev:J.structureRev,timeRange:Ee,timeZone:Ce,width:Fe,height:He,legend:it.legend,options:it,preparePlotFrame:bn,replaceVariables:Nt,dataLinkPostProcessor:Zt},(mn,Wn)=>C.createElement(C.Fragment,null,C.createElement(On.Z,{config:mn}),it.tooltip.mode!==Xe.$N.None&&C.createElement(Ms.xl,{config:mn,hoverMode:it.tooltip.mode===Xe.$N.Single?Ms.b3.xOne:Ms.b3.xAll,render:(ba,oa,da,Xn=!1)=>C.createElement(Dr.k,{series:Wn,dataIdxs:oa,seriesIdx:da,mode:it.tooltip.mode,sortOrder:it.tooltip.sort,isPinned:Xn,maxHeight:it.tooltip.maxHeight}),maxWidth:it.tooltip.maxWidth})))};class hg{getSuggestionsForData(Ee){const{dataSummary:Ce}=Ee;return Ce.numberFieldCount<2||Ce.rowCountTotal<2||Ce.rowCountTotal<2?void 0:Ee.getListAppender({name:_a.m.LineChart,pluginId:"trend",options:{legend:{calcs:[],displayMode:Xe.lm.Hidden,placement:"right",showLegend:!1}},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:He=>{He.fieldConfig?.defaults.custom?.drawStyle!==Xe.GR.Bars&&(He.fieldConfig.defaults.custom.lineWidth=Math.max(He.fieldConfig.defaults.custom.lineWidth??1,2))}}})}}const vg=new O.m(Hu).useFieldConfig((0,an.V)(an.S,!1)).setPanelOptions(J=>{const Ee=["X Axis"];J.addFieldNamePicker({path:"xField",name:"X Field",description:"An increasing numeric value",category:Ee,defaultValue:void 0,settings:{isClearable:!0,placeholderText:"First numeric value",filter:Ce=>Ce.type===It.PU.number}}),wn.D(J,!1,!0),sa.H(J)}).setSuggestionsSupplier(new hg),Xl=[{value:0,label:"Documentation",href:"https://grafana.com/docs/grafana/latest"},{value:1,label:"Tutorials",href:"https://grafana.com/tutorials"},{value:2,label:"Community",href:"https://community.grafana.com"},{value:3,label:"Public Slack",href:"http://slack.grafana.com"}],Yr=()=>{const J=(0,z.of)(Uc);return C.createElement("div",{className:J.container},C.createElement("h1",{className:J.title},"Welcome to Grafana"),C.createElement("div",{className:J.help},C.createElement("h3",{className:J.helpText},"Need help?"),C.createElement("div",{className:J.helpLinks},Xl.map((Ee,Ce)=>C.createElement("a",{key:`${Ee.label}-${Ce}`,className:J.helpLink,href:`${Ee.href}?utm_source=grafana_gettingstarted`},Ee.label)))))},Uc=J=>({container:(0,se.css)`
      display: flex;
      /// background: url(public/img/g8_home_v2.svg) no-repeat;
      background-size: cover;
      height: 100%;
      align-items: center;
      padding: 0 16px;
      justify-content: space-between;
      padding: 0 ${J.spacing(3)};

      ${J.breakpoints.down("lg")} {
        background-position: 0px;
        flex-direction: column;
        align-items: flex-start;
        justify-content: center;
      }

      ${J.breakpoints.down("sm")} {
        padding: 0 ${J.spacing(1)};
      }
    `,title:(0,se.css)`
      margin-bottom: 0;

      ${J.breakpoints.down("lg")} {
        margin-bottom: ${J.spacing(1)};
      }

      ${J.breakpoints.down("md")} {
        font-size: ${J.typography.h2.fontSize};
      }
      ${J.breakpoints.down("sm")} {
        font-size: ${J.typography.h3.fontSize};
      }
    `,help:(0,se.css)`
      display: flex;
      align-items: baseline;
    `,helpText:(0,se.css)`
      margin-right: ${J.spacing(2)};
      margin-bottom: 0;

      ${J.breakpoints.down("md")} {
        font-size: ${J.typography.h4.fontSize};
      }

      ${J.breakpoints.down("sm")} {
        display: none;
      }
    `,helpLinks:(0,se.css)`
      display: flex;
      flex-wrap: wrap;
    `,helpLink:(0,se.css)`
      margin-right: ${J.spacing(2)};
      text-decoration: underline;
      text-wrap: no-wrap;

      ${J.breakpoints.down("sm")} {
        margin-right: 8px;
      }
    `}),Jr=new O.m(Yr).setNoPadding(),Dd={"core:plugin/graphite":async()=>await e.e(6134).then(e.bind(e,8652)),"core:plugin/cloudwatch":async()=>await Promise.all([e.e(1765),e.e(2651),e.e(3766)]).then(e.bind(e,92651)),"core:plugin/dashboard":async()=>await e.e(2058).then(e.bind(e,92058)),"core:plugin/elasticsearch":async()=>await Promise.all([e.e(1765),e.e(6144),e.e(8747),e.e(1717)]).then(e.bind(e,18747)),"core:plugin/opentsdb":async()=>await e.e(747).then(e.bind(e,24989)),"core:plugin/grafana":async()=>await e.e(3648).then(e.bind(e,62391)),"core:plugin/influxdb":async()=>await Promise.all([e.e(4669),e.e(9404)]).then(e.bind(e,21106)),"core:plugin/loki":async()=>await Promise.all([e.e(6144),e.e(4684),e.e(1477)]).then(e.bind(e,24684)),"core:plugin/mixed":async()=>await e.e(2513).then(e.bind(e,12870)),"core:plugin/mssql":async()=>await Promise.all([e.e(4669),e.e(9040)]).then(e.bind(e,56694)),"core:plugin/prometheus":async()=>await Promise.all([e.e(1765),e.e(6144),e.e(4178),e.e(9546)]).then(e.bind(e,74178)),"core:plugin/alertmanager":async()=>await Promise.all([e.e(1765),e.e(4737)]).then(e.bind(e,27013)),"core:plugin/text":v,"core:plugin/timeseries":D,"core:plugin/trend":S,"core:plugin/state-timeline":c,"core:plugin/status-history":y,"core:plugin/candlestick":i,"core:plugin/graph":async()=>await Promise.all([e.e(9362),e.e(8068)]).then(e.bind(e,229)),"core:plugin/xychart":async()=>x.$.featureToggles.autoMigrateXYChartPanel?await Promise.all([e.e(8891),e.e(3772)]).then(e.bind(e,80983)):await Promise.all([e.e(707),e.e(5594)]).then(e.bind(e,31552)),"core:plugin/geomap":async()=>await Promise.all([e.e(1698),e.e(707),e.e(7734),e.e(190)]).then(e.bind(e,7734)),"core:plugin/canvas":async()=>await Promise.all([e.e(707),e.e(7523)]).then(e.bind(e,68743)),"core:plugin/dashlist":f,"core:plugin/alertlist":n,"core:plugin/annolist":a,"core:plugin/heatmap":async()=>await Promise.all([e.e(8891),e.e(5857)]).then(e.bind(e,26235)),"core:plugin/table":p,"core:plugin/table-old":async()=>await e.e(8777).then(e.bind(e,78491)),"core:plugin/news":g,"core:plugin/live":u,"core:plugin/stat":Rf,"core:plugin/datagrid":d,"core:plugin/debug":l,"core:plugin/flamegraph":m,"core:plugin/gettingstarted":s,"core:plugin/gauge":Hd,"core:plugin/piechart":P,"core:plugin/bargauge":r,"core:plugin/barchart":o,"core:plugin/logs":b,"core:plugin/traces":E,"core:plugin/welcome":T,"core:plugin/nodeGraph":async()=>await Promise.all([e.e(1698),e.e(5511),e.e(7317)]).then(e.bind(e,68403)),"core:plugin/histogram":h};var Ui=e(81900),Bl=e(63770),Qu=e(52762),Dg=e(20582),Yu=e(21313),wc=e(72635),Pd=e(34796),Cd=e.n(Pd),Sd=e(95093),Ci=e.n(Sd),Ju=e(28848),ql=e.n(Ju),Td=e(40961),Zu=e(8867),Pg=e(71468),Xu=e(54625),Md=e(24160),Cg=e(14644),Gi=e(75091),ec=e(32975),tc=e(82611),Dp=e(75226),Fc=e(29317),Sg=e(54087),jo=e(80851),Tg=e(32176),Mg=e(31221),nc=e(91520),Pp=e(92275),Cp=e(82013),Sp=e(2341),xg=e(19538),ac=e(39954),vs=e(85858),yl=e(13303),sc=e(8984),qu=e(91950),pi=e(31140),xd=e(78827),Od=e(68576),Id=e(92247);const Cr=sc;Cr.PanelPlugin=O.m,Cr.DataSourcePlugin=M.tD,Cr.AppPlugin=A.hX,Cr.DataSourceApi=M.mA;const sl=["jquery.flot.crosshair","jquery.flot.events","jquery.flot.fillbelow","jquery.flot.gauge","jquery.flot.pie","jquery.flot.selection","jquery.flot.stack","jquery.flot.stackpercent","jquery.flot.time","jquery.flot"].reduce((J,Ee)=>({...J,[Ee]:{fakeDep:1}}),{}),Og={"@emotion/css":se,"@emotion/react":Qu,"@grafana/data":ac,"@grafana/runtime":yl,"@grafana/slate-react":Fc.Ay,"@grafana/ui":Cr,"@kusto/monaco-kusto":Dg,"app/core/app_events":{default:st.lE,__useDefault:!0},"app/core/config":{default:fe.Ay,__useDefault:!0},"app/core/core":{appEvents:st.lE,contextSrv:st.contextSrv},"app/core/services/backend_srv":{BackendSrv:dn.Mf,getBackendSrv:dn.AI},"app/core/table_model":{default:qu.A,__useDefault:!0},"app/core/time_series":{default:pi.A,__useDefault:!0},"app/core/time_series2":{default:pi.A,__useDefault:!0},"app/core/utils/datemath":vs,"app/core/utils/flatten":xd,"app/core/utils/kbn":{default:Od.A,__useDefault:!0},"app/core/utils/ticks":Id,"app/features/dashboard/impression_store":{impressions:In.A},d3:Yu,emotion:se,i18next:wc,jquery:{default:Cd(),__useDefault:!0},...sl,lodash:{default:U(),__useDefault:!0},moment:{default:Ci(),__useDefault:!0},prismjs:ql(),react:C,"react-dom":Td,"react-inlinesvg":Zu,"react-redux":Pg,"react-router-dom":Xu,"react-router":Md,redux:Cg,rxjs:Gi,"rxjs/operators":ec,slate:tc.Ay,"slate-plain-serializer":Dp.A,"slate-react":Fc.Ay};function rc({url:J,source:Ee,transformSourceMapURL:Ce=!1,transformAssets:Fe=!0}){const He=J.split("/public/plugins/"),it=He[0],vt=He[1].split("/")[0];let Nt=Ee;return Fe&&(Nt=Nt.replace(/(\/?)(public\/plugins)/g,`${it}/$2`),Nt=Nt.replace(/(["|'])(plugins\/.+?.css)(["|'])/g,`$1${it}/public/$2$3`)),Ce&&(Nt=Nt.replace(/(\/\/#\ssourceMappingURL=)(.+)\.map/g,`$1${it}/public/plugins/${vt}/$2.map`)),Nt}var Ad=e(45179),rl=e(94429);async function Ig(J,Ee,Ce){const Fe=await J(Ee,Ce),He=Fe.headers.get("content-type")||"";if(Ad.Bu.test(He)){let vt=await Fe.text();if((0,rl.OD)(Fe.url)){const Nt=rc({url:Fe.url,source:vt});return new Response(new Blob([Nt],{type:"text/javascript"}))}return new Response(new Blob([vt],{type:"text/javascript"}))}return Fe}function em(J,Ee,Ce){try{const Fe=J.apply(this,[Ee,Ce]),He=nm(Fe);return(He.endsWith(".js")||He.endsWith(".css"))&&!(0,rl.OD)(He)?(0,Ui.ni)(He):He}catch{if(Ad.$b.test(Ee)){const He=`${x.$.appSubUrl??""}/public/${Ee}`,it=J.apply(this,[He,Ce]);return(0,Ui.ni)(it)}return console.warn(`SystemJS: failed to resolve '${Ee}'`),Ee}}function tm(J,Ee){if(new URL(Ee,window.location.origin).pathname.endsWith(".css")&&!J){const He=Bl.z.get(Ee)?.default;He&&(document.adoptedStyleSheets=[...document.adoptedStyleSheets,He])}}function nm(J){return J.startsWith(`${Ad.XV}:`)?J:(J.endsWith("!")&&(J=J.slice(0,-1)),["css","js","json","wasm"].some(Fe=>J.endsWith(Fe))?J:J+".js")}var bl=e(22055),Ul=e(6262),Rd=e(35853),Dl=e(43429);function Ld(J){const Ee=new URL(window.location.href),Ce=new URL(J);return Ee.host===Ce.host}async function Ag(J,Ee){let Ce="";if(Ld(J)?(Ce=await(await fetch(J)).text(),Ce=rc({url:J,source:Ce,transformSourceMapURL:!0,transformAssets:!1})):(0,rl.OD)(J)&&(Ce=await(await fetch(J)).text(),Ce=rc({url:J,source:Ce,transformSourceMapURL:!0,transformAssets:!0})),Ce.length===0)throw new Error("Only same domain scripts are allowed in sandboxed plugins");Ce=Bd(Ce),Ee.evaluate(Ce)}async function am(J){if((0,rl.OD)(J.module)){const Ee=J.module;let Fe=await(await fetch(Ee)).text();return Fe=rc({url:Ee,source:Fe,transformSourceMapURL:!0,transformAssets:!0}),Fe}else{let Ee=(0,rl.Av)(J.module);const Ce=(0,Ui.ni)(Ee);let He=await(await fetch(Ce)).text();return He=rc({url:Ce,source:He,transformSourceMapURL:!0,transformAssets:!1}),He=Bd(He),He}}function Bd(J){return J.replace(/window\.location/gi,"window.locationSandbox")}function Wc(J){J.evaluate(`${Rd.V.toString()};${Rd.V.name}()`)}function Rg(J){for(const Ee of Object.values(x.$.datasources))if(Ee.type===J)return Ee.meta;for(const Ee of Object.values(x.$.panels))if(Ee.id===J)return Ee;for(const Ee of Object.values(x.$.apps))if(Ee.id===J)return{id:J,type:Dl.QE.app,module:Ee.path};throw new Error(`Could not find plugin ${J}`)}const Ni=["iframe"];var oc=e(7077),sm=e(29505),ic=e(34867),rm=e(27716);const Lg=!!x.$.featureToggles.frontendSandboxMonitorOnly;function om(J){return!!J&&typeof J=="object"&&J?.hasOwnProperty("plugin")}function Tp(J){throw new Error(`Unexpected object: ${J}. This should never happen.`)}const lc=(0,ic.DW)("sandbox",{monitorOnly:String(Lg)});function Bg(J){return J instanceof C.Component}function Si(J,Ee){lc.logWarning(J,Ee)}function ji(J,Ee){lc.logError(J,Ee)}function im(J,Ee){lc.logInfo(J,Ee)}async function Ug({isAngular:J,pluginId:Ee}){if(!x.$.featureToggles.pluginsFrontendSandbox||J||location.search.includes("nosandbox")&&x.$.buildInfo.env==="development"||x.$.disableFrontendSandboxForPlugins.includes(Ee))return!1;const He=await(0,rm.x)(Ee);return!(He.type===Dl.QE.app&&He.signatureType===Dl.kv.grafana)}function lm(J){return J?.constructor?.name==="RegExp"}function Nl(J){return J&&(lm(J)&&(0,oc.U)(J)?new RegExp(J):Array.isArray(J)?J.map(Nl):typeof J=="object"?Object.keys(J).reduce((Ee,Ce)=>(Reflect.set(Ee,Ce,Nl(Reflect.get(J,Ce))),Ee),{}):J)}function Kc(J){return J&&((0,oc.U)(J)?(0,w.cloneDeep)(J):Array.isArray(J)?J.map(Kc):typeof J=="object"?Object.keys(J).reduce((Ee,Ce)=>(Reflect.set(Ee,Ce,Kc(Reflect.get(J,Ce))),Ee),{}):J)}const Qi=Symbol.for("@@SANDBOX_LIVE_VALUE"),$c=!!x.$.featureToggles.frontendSandboxMonitorOnly;function cm(J,Ee){const Ce=Reflect.get(J,"nodeName");if(Ce==="body"||J===document.body)return document.body;if(Ce==="head"||J===document.head||J===document.documentElement)return J;if(Ni.includes(Ce)&&(Si("<"+Ce+"> is not allowed in sandboxed plugins",{pluginId:Ee,param:Ce}),!$c))throw new Error("<"+Ce+"> is not allowed in sandboxed plugins");if(wg(J,Ee)||J.parentNode===document.body||J.closest("#reactRoot")===null||$c)return J;{const Fe=document.createElement(Ce);return Fe.dataset.grafanaPluginSandboxElement="true",Fe}}function Ng(J){if(typeof J=="object"&&J instanceof Element)try{return J.nodeName!==void 0}catch{return!1}return!1}function Bo(J){const Ee=Reflect.get(J,"style");Object.hasOwn(Ee,Qi)||Reflect.defineProperty(Ee,Qi,{})}function bo(J){J&&(Array.isArray(J)?(J.forEach(bo),cc(J)):typeof J=="object"&&(Object.values(J).forEach(bo),cc(J)))}function cc(J){if(J)return Object.hasOwn(J,Qi)||Reflect.defineProperty(J,Qi,{}),J}function dm(J){J&&(Object.hasOwn(J,Qi)||((0,oc.U)(J)&&!(J instanceof Function)&&(Bg(J)||J instanceof M.mA||J instanceof sm.f5)?Reflect.defineProperty(J,Qi,{}):J===ql().languages&&Object.defineProperty(J,Qi,{})))}function dc(J){return Object.hasOwn(J,Qi)}function wg(J,Ee){return!document.contains(J)||J.closest(`[data-plugin-sandbox=${Ee}]`)!==null}let hi;function Mp(){return hi||(hi=document.createElement("div"),hi.setAttribute("id","grafana-plugin-sandbox-body"),hi.setAttribute("data-plugin-sandbox","true"),hi.dataset.pluginSandbox="sandboxed-plugin",hi.style.width="100%",hi.style.height="0%",hi.style.overflow="hidden",hi.style.top="0",hi.style.left="0",document.body.appendChild(hi)),hi}let um=!1;function go(){um||(um=!0,wl(),Fr())}function Fr(){const J=Worker.prototype.postMessage;Object.defineProperty(Worker.prototype,"postMessage",{value:function(...Ee){return J.apply(this,Kc(Ee))}})}function wl(){const J=window.history.replaceState;Object.defineProperty(window.history,"replaceState",{value:function(...Ee){let Ce=Ee;try{Ce=(0,w.cloneDeep)(Ee)}catch(Fe){Si("Error cloning args in window.history.replaceState",{error:String(Fe)})}return Reflect.apply(J,this,Ce)},writable:!0,configurable:!0,enumerable:!1})}const po=new Map,ni=!!x.$.featureToggles.frontendSandboxMonitorOnly,Pl=Symbol.for("@SANDBOX_LIVE_API_PATCHED");function Fg(){return po.size===0&&(Wg(po),uc(po),mm(po),$g(po),Op(po),Kg(po),xp(po),fm(po),Vg(po),Ud(po),mc(po),gm(po)),po}function Vc(J,Ee){return Si(`Plugin ${Ee.id} tried to set a sandboxed property`,{pluginId:Ee.id,attrOrMethod:String(J),entity:"window"}),ni?J:()=>{throw new Error("Plugins are not allowed to set sandboxed properties")}}function Wg(J){const Ee=["contentDocument","contentWindow","src","srcdoc","srcObject","srcset"];for(const Fe of Ee){const He=Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,Fe);if(He){let it=function(vt,Nt){const kt=Nt.id;return Si(`Plugin ${kt} tried to access iframe.${Fe}`,{pluginId:kt,attrOrMethod:Fe,entity:"iframe"}),ni?vt:()=>{throw new Error("iframe."+Fe+" is not allowed in sandboxed plugins")}};var Ce=it;He.value&&J.set(He.value,it),He.set&&J.set(He.set,it),He.get&&J.set(He.get,it)}}}function uc(J){const Ee=Object.getOwnPropertyDescriptor(window,"console");if(Ee?.value){let Fe=function(He,it){const vt=it.id;if(ni)return He;function Nt(...kt){console.log(`[plugin ${vt}]`,...kt)}return{log:Nt,warn:Nt,error:Nt,info:Nt,debug:Nt,table:Nt}};var Ce=Fe;J.set(Ee.value,Fe)}Ee?.set&&J.set(Ee.set,Vc)}function mm(J){function Ee(Fe,He){const it=He.id;return Si(`Plugin ${it} accessed window.alert`,{pluginId:it,attrOrMethod:"alert",entity:"window"}),ni?Fe:function(...vt){console.log(`[plugin ${it}]`,...vt)}}const Ce=Object.getOwnPropertyDescriptor(window,"alert");Ce?.value&&J.set(Ce.value,Ee),Ce?.set&&J.set(Ce.set,Vc)}function Kg(J){function Ee(Fe,He){const it=He.id;return function(...Nt){for(const kt of Nt){const Zt=String(kt||"").toLowerCase();for(const ln of Ni)if(Zt.includes("<"+ln)){if(Si(`Plugin ${it} tried to set ${ln} in innerHTML`,{pluginId:it,attrOrMethod:"innerHTML",param:ln,entity:"HTMLElement"}),ni)continue;throw new Error("<"+ln+"> is not allowed in sandboxed plugins")}}if((0,w.isFunction)(Fe))return Fe.apply(this,Nt)}}const Ce=[Object.getOwnPropertyDescriptor(Element.prototype,"innerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"outerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentHTML"),Object.getOwnPropertyDescriptor(DOMParser.prototype,"parseFromString")];for(const Fe of Ce)Fe?.set&&J.set(Fe.set,Ee),Fe?.value&&J.set(Fe.value,Ee)}function xp(J){function Ee(Fe,He){const it=He.id;return function(Nt,kt){if(Nt&&Ni.includes(Nt)&&(Si(`Plugin ${it} tried to create ${Nt}`,{pluginId:it,attrOrMethod:"createElement",param:Nt,entity:"document"}),!ni))return document.createDocumentFragment();if((0,w.isFunction)(Fe))return Fe.apply(this,[Nt,kt])}}const Ce=Object.getOwnPropertyDescriptor(Document.prototype,"createElement");Ce?.value&&J.set(Ce.value,Ee)}function Op(J){function Ee(it,vt){const Nt=vt.id;return function(Zt,ln){const bn=Zt?.nodeName?.toLowerCase()||"";if(Zt&&Ni.includes(bn)&&(Si(`Plugin ${Nt} tried to insert ${bn}`,{pluginId:Nt,attrOrMethod:"insertChild",param:bn,entity:"HTMLElement"}),!ni))return document.createDocumentFragment();if((0,w.isFunction)(it))return it.call(this,Zt,ln)}}function Ce(it,vt){const Nt=vt.id;return function(Zt,ln){const bn=ln?.nodeName?.toLowerCase()||"";if(ln&&Ni.includes(bn)&&(Si(`Plugin ${Nt} tried to insert ${bn}`,{pluginId:Nt,attrOrMethod:"insertAdjacentElement",param:bn,entity:"HTMLElement"}),!ni))return document.createDocumentFragment();if((0,w.isFunction)(it))return it.call(this,Zt,ln)}}const Fe=[Object.getOwnPropertyDescriptor(Node.prototype,"insertBefore"),Object.getOwnPropertyDescriptor(Node.prototype,"replaceChild")];for(const it of Fe)it?.value&&J.set(it.set,Ee);const He=Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentElement");He?.value&&J.set(He.set,Ce)}function $g(J){function Ee(it,vt){const Nt=vt.id;return function(...Zt){let ln=Zt;const bn=Zt?.filter(Nn=>!Ni.includes(Nn.nodeName.toLowerCase()));ni||(ln=bn),ln.length!==bn.length&&Si(`Plugin ${Nt} tried to append fobiddenElements`,{pluginId:Nt,attrOrMethod:"append",param:Zt?.filter(Nn=>Ni.includes(Nn.nodeName.toLowerCase()))?.join(",")||"",entity:"HTMLElement"}),(0,w.isFunction)(it)&&it.apply(this,ln)}}function Ce(it,vt,Nt){const kt=vt.id;return function(ln){const bn=ln?.nodeName?.toLowerCase()||"";if(ln&&Ni.includes(bn)&&(Si(`Plugin ${kt} tried to append ${bn}`,{pluginId:kt,attrOrMethod:"appendChild",param:bn,entity:"HTMLElement"}),!ni))return document.createDocumentFragment();if(Nt&&ln&&bn==="script"&&ln instanceof HTMLScriptElement){Ag(ln.src,Nt).then(()=>{ln.onload?.call(ln,new Event("load"))}).catch(Nn=>{ln.onerror?.call(ln,new ErrorEvent("error",{error:Nn}))});return}if((0,w.isFunction)(it))return it.call(this,ln)}}const Fe=[Object.getOwnPropertyDescriptor(Element.prototype,"append"),Object.getOwnPropertyDescriptor(Element.prototype,"prepend"),Object.getOwnPropertyDescriptor(Element.prototype,"after"),Object.getOwnPropertyDescriptor(Element.prototype,"before"),Object.getOwnPropertyDescriptor(Document.prototype,"append"),Object.getOwnPropertyDescriptor(Document.prototype,"prepend")];for(const it of Fe)it?.value&&J.set(it.value,Ee);const He=Object.getOwnPropertyDescriptor(Node.prototype,"appendChild");He?.value&&J.set(He.value,Ce)}function fm(J){const Ee=Object.getOwnPropertyDescriptor(Worker.prototype,"postMessage");function Ce(Fe){return function(...it){try{const vt=(0,w.cloneDeep)(it);(0,w.isFunction)(Fe)&&Fe.apply(this,vt)}catch{throw new Error("postMessage arguments are invalid objects")}}}Ee?.value&&J.set(Ee.value,Ce)}function Vg(J){const Ee=Object.getOwnPropertyDescriptor(Document.prototype,"defaultView");Ee?.get&&J.set(Ee.get,()=>()=>window);const Ce=["write"];for(const Fe of Ce){const He=Object.getOwnPropertyDescriptor(Document.prototype,Fe);He?.set&&J.set(He.set,Vc),He?.value&&J.set(He.value,Vc)}}async function Ud(J){const Ee=Reflect.get(window,"monaco");if(!Ee||Object.hasOwn(Ee,Pl))return;const Ce=Ee.languages.setMonarchTokensProvider;function Fe(){return function(...He){return He.length!==2?Ce.apply(Ee,He):Ce.call(Ee,He[0],Nl(He[1]))}}J.set(Ee.languages.setMonarchTokensProvider,Fe),Reflect.set(Ee,Pl,{})}async function mc(J){const Ee=Object.getOwnPropertyDescriptor(window,"postMessage");function Ce(Fe){return function(...it){try{const vt=(0,w.cloneDeep)(it);(0,w.isFunction)(Fe)&&Fe.apply(this,vt)}catch{throw new Error("postMessage arguments are invalid objects")}}}Ee?.value&&J.set(Ee.value,Ce)}function fc(J){Ud(po)}function gm(J){function Ee(Ce){return(0,w.isFunction)(Ce)?function(...Fe){const He=Ce.apply(this,Fe);return bo(He),He}:Ce}J.set(w.cloneDeep,Ee)}var zg=e(66161);async function pm(J,Ee){if(!om(J))return J;const Ce=await Promise.resolve(J.plugin);if(Reflect.has(Ce,"panel")&&Reflect.set(Ce,"panel",Fl(Reflect.get(Ce,"panel"),Ee)),Reflect.has(Ce,"components")){const Fe=Reflect.get(Ce,"components");Object.entries(Fe).forEach(([He,it])=>{Reflect.set(Fe,He,Fl(it,Ee))}),Reflect.set(Ce,"components",Fe)}if(Reflect.has(Ce,"root")&&Reflect.set(Ce,"root",Fl(Reflect.get(Ce,"root"),Ee)),Reflect.has(Ce,"extensionConfigs")){const Fe=Reflect.get(Ce,"extensionConfigs");for(const He of Fe)Reflect.has(He,"component")&&Reflect.set(He,"component",Fl(Reflect.get(He,"component"),Ee));Reflect.set(Ce,"extensionConfigs",Fe)}if(Reflect.has(Ce,"configPages")){const Fe=Reflect.get(Ce,"configPages")??[];for(const[He,it]of Object.entries(Fe))!it.body||!(0,w.isFunction)(it.body)||Reflect.set(Fe,He,{...it,body:Fl(it.body,Ee)});Reflect.set(Ce,"configPages",Fe)}return J}const Fl=(J,Ee)=>{const Ce=C.memo(Fe=>C.createElement("div",{"data-plugin-sandbox":Ee.id,style:{height:Ee.type===Dl.QE.app||Ee.type===Dl.QE.panel?"100%":"auto"}},C.createElement(J,{...Fe})));return Ce.displayName=`GrafanaSandbox(${J.displayName||J.name||"Component"})`,Ce},zc=new Map,kc={};async function ai({pluginId:J}){go();try{const Ee=Rg(J);return zc.has(J)||zc.set(J,hm(Ee)),zc.get(J)}catch(Ee){const Ce=new Error(`Could not import plugin ${J} inside sandbox: `+Ee);throw ji(Ce,{pluginId:J,error:String(Ee)}),Ce}}async function hm(J){return im("Loading with sandbox",{pluginId:J.id}),new Promise(async(Ee,Ce)=>{const Fe=Fg();let He;function it(Nt){if(Ng(Nt)){const ln=cm(Nt,J.id);return Bo(ln),ln}else dm(Nt);const kt=Fe.get(Nt);if(kt)return kt(Nt,J,He);const Zt=fc(Nt);return Zt||Nt}He=(0,bl.A)(window,{distortionCallback:it,defaultPolicy:Ul.G,liveTargetCallback:dc,endowments:Object.getOwnPropertyDescriptors({locationSandbox:window.location,setImmediate:function(Nt,...kt){return setTimeout(Nt,0,...kt)},get monaco(){return Reflect.get(window,"monaco")},get Prism(){return Reflect.get(window,"Prism")},get jQuery(){return Reflect.get(window,"jQuery")},get $(){return Reflect.get(window,"jQuery")},get grafanaBootData(){if(kc[J.id+"-grafanaBootData"]||(kc[J.id+"-grafanaBootData"]=!0,im("Plugin using window.grafanaBootData",{sandbox:"true",pluginId:J.id,guessedPluginName:J.id,parent:"window",packageName:"window",key:"grafanaBootData"})),x.$.buildInfo.env==="development")throw new Error(`Error in ${J.id}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`);return console.error(`${J.id.toUpperCase()}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`),x.$.bootData},async define(Nt,kt,Zt){let ln,bn;Array.isArray(Nt)?(ln=Nt,bn=kt):(ln=kt,bn=Zt);try{const Nn=vm(ln,J.id),mn=bn.apply(null,Nn),Wn=await pm(mn,J);Ee(Wn)}catch(Nn){const mn=new Error(`Could not execute plugin's define ${J.id}: `+Nn);ji(mn,{pluginId:J.id,error:String(Nn)}),Ce(mn)}}})}),Wc(He);let vt="";try{vt=await am(J)}catch(Nt){const kt=new Error(`Could not load plugin code ${J.id}: `+Nt);ji(kt,{pluginId:J.id,error:String(Nt)}),Ce(kt)}try{He.evaluate(vt)}catch(Nt){const kt=new Error(`Could not run plugin ${J.id} inside sandbox: `+Nt);ji(kt,{pluginId:J.id,error:String(Nt)}),Ce(kt)}})}function vm(J,Ee){const Ce=[];for(const Fe of J){let He=zg.s.get(Fe);if(He?.__useDefault&&(He=He.default),!He){const it=new Error(`[sandbox] Could not resolve dependency ${Fe}`);throw ji(it,{pluginId:Ee,dependency:Fe,error:String(it)}),it}Ce.push(He)}return Ce}const kg=(0,rl.kB)(Og);Bl.z.addImportMap({imports:kg});const Ti=Bl.z.constructor.prototype;Ti.shouldFetch=function(J){const Ee=(0,Ui.QO)(J),Ce=/^[^#?]+\.(js)([?#].*)?$/;return(0,rl.OD)(J)||!!Ee?.isAngular||!Ce.test(J)};const _g=Ti.import;Ti.import=function(...J){return _g.apply(this,J).then(Ee=>Ee&&Ee.__useDefault?Ee.default:Ee)};const Hg=Ti.fetch;Ti.fetch=function(J,Ee){return Ig(Hg,J,Ee)};const ol=Ti.resolve;Ti.resolve=em.bind(Ti,ol),Ti.onload=tm;async function Nd({path:J,version:Ee,isAngular:Ce,pluginId:Fe}){Ee&&(0,Ui.GD)({pluginId:Fe,version:Ee,isAngular:Ce});const He=Dd[J];if(He)return typeof He=="function"?await He():He;let it=(0,rl.Av)(J);return await Ug({isAngular:Ce,pluginId:Fe})?ai({pluginId:Fe}):Bl.z.import(it)}function Gg(J){const Ee=J.angular?.detected??J.angularDetected;return Nd({path:J.module,version:J.info?.version,isAngular:Ee,pluginId:J.id}).then(Ce=>{if(Ce.plugin){const Fe=Ce.plugin;return Fe.meta=J,Fe}if(Ce.Datasource){const Fe=new M.tD(Ce.Datasource);return Fe.setComponentsFromLegacyExports(Ce),Fe.meta=J,Fe}throw new Error("Plugin module is missing DataSourcePlugin or Datasource constructor export")})}function jg(J){const Ee=J.angular?.detected??J.angularDetected;return Nd({path:J.module,version:J.info?.version,isAngular:Ee,pluginId:J.id}).then(Ce=>{const Fe=Ce.plugin?Ce.plugin:new A.hX;return Fe.init(J),Fe.meta=J,Fe.setComponentsFromLegacyExports(Ce),Fe})}},66161:(Q,I,e)=>{"use strict";e.d(I,{s:()=>n});const n=new Map([])},60677:(Q,I,e)=>{"use strict";e.d(I,{W3:()=>f,Wy:()=>d,z4:()=>l});var n=e(43429),a=e(34867),o=e(15162),r=e(27716),i=e(54427);async function f(m){const s=await(0,r.x)(m);let h;if(s.type===n.QE.app&&(h=await(0,i.ui)(s)),s.type===n.QE.datasource&&(h=await(0,i.cS)(s)),s.type===n.QE.panel&&(h=await(0,o.Kk)(s)),s.type===n.QE.renderer&&(h={meta:s}),!h)throw new Error("Unknown Plugin type: "+s.type);return h}function d(m,s,h){let b={...m},g;function P(y,p){return!p.startsWith(y.url??"")||g&&(g.url?.length??0)>(y.url?.length??0)?y:(g&&(g.active=!1),g={...y,active:!0},g)}function c(y,p=0){if(p>10)return y;if(y.children){const v=y.children.map(D=>c(D,p+1));return{...P(y,h),children:v}}return P(y,h)}return b.children=(b?.children??[]).map(c),{main:b,node:g??b}}const l=(0,a.DW)("features.plugins")},81862:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>x,Cj:()=>h,HO:()=>p,Mj:()=>g,Nm:()=>b,Q9:()=>y,RS:()=>E,c1:()=>s,g$:()=>v,ny:()=>P,ri:()=>c,uh:()=>D,xu:()=>u});var n=e(65307),a=e(2543),o=e.n(a),r=e(72724),i=e(47232),f=e(2913),d=e(10096);const l={orgId:f.Ay.bootData.user.orgId,timeZone:f.Ay.bootData.user.timezone,weekStart:f.Ay.bootData.user.weekStart,fiscalYearStartMonth:0,orgsAreLoading:!1,sessionsAreLoading:!1,teamsAreLoading:!1,isUpdating:!1,orgs:[],sessions:[],teams:[],user:null},m=(0,n.Z0)({name:"user/profile",initialState:l,reducers:{updateTimeZone:(C,O)=>{C.timeZone=O.payload.timeZone},updateWeekStart:(C,O)=>{C.weekStart=O.payload.weekStart},updateFiscalYearStartMonth:(C,O)=>{C.fiscalYearStartMonth=O.payload.fiscalYearStartMonth},setUpdating:(C,O)=>{C.isUpdating=O.payload.updating},userLoaded:(C,O)=>{C.user=O.payload.user},initLoadTeams:(C,O)=>{C.teamsAreLoading=!0},teamsLoaded:(C,O)=>{C.teams=O.payload.teams,C.teamsAreLoading=!1},initLoadOrgs:(C,O)=>{C.orgsAreLoading=!0},orgsLoaded:(C,O)=>{C.orgs=O.payload.orgs,C.orgsAreLoading=!1},initLoadSessions:(C,O)=>{C.sessionsAreLoading=!0},sessionsLoaded:(C,O)=>{const R=O.payload.sessions.sort((L,N)=>Number(N.isActive)-Number(L.isActive));C.sessions=R.map(L=>({id:L.id,isActive:L.isActive,seenAt:(0,r.fq)(L.seenAt),createdAt:L.createdAt,clientIp:L.clientIp,browser:L.browser,browserVersion:L.browserVersion,os:L.os,osVersion:L.osVersion,device:L.device})),C.sessionsAreLoading=!1},userSessionRevoked:(C,O)=>{C.sessions=C.sessions.filter(R=>R.id!==O.payload.tokenId),C.isUpdating=!1}}}),s=C=>async O=>{(0,a.set)(d.contextSrv,"user.fiscalYearStartMonth",C),O(M({fiscalYearStartMonth:C}))},h=C=>async O=>{(!(0,a.isString)(C)||(0,a.isEmpty)(C))&&(C=f.Ay?.bootData?.user?.timezone),(0,a.set)(d.contextSrv,"user.timezone",C),O(S({timeZone:C}))},u=C=>async O=>{(!(0,a.isString)(C)||(0,a.isEmpty)(C))&&(C=f.Ay?.bootData?.user?.weekStart),(0,a.set)(d.contextSrv,"user.weekStart",C),O(T({weekStart:C})),(0,i.$D)(C)},{setUpdating:b,initLoadOrgs:g,orgsLoaded:P,initLoadTeams:c,teamsLoaded:y,userLoaded:p,userSessionRevoked:v,initLoadSessions:D,sessionsLoaded:E,updateTimeZone:S,updateWeekStart:T,updateFiscalYearStartMonth:M}=m.actions,A=m.reducer,x={user:m.reducer}},32901:(Q,I,e)=>{"use strict";e.d(I,{O:()=>n,q:()=>a});const n=o=>o.timeZone,a=o=>o.fiscalYearStartMonth},82537:(Q,I,e)=>{"use strict";e.d(I,{g:()=>i});var n=e(75816),a=e(56389);const o=f=>f.items?f.items.map(d=>({uid:d.metadata.name||"",title:d.spec.title,targets:d.spec.targets.map(l=>l.properties),createdAtTimestamp:new Date(d.metadata.creationTimestamp||"").getTime()})):[],r=f=>{const{title:d,targets:l}=f;return{apiVersion:a.mG,kind:a.GY.QueryTemplate,metadata:{generateName:"A"+d},spec:{title:d,vars:[],targets:l.map(m=>({variables:{},properties:m}))}}},i=(0,n.xP)({baseQuery:a.Su,tagTypes:["QueryTemplatesList"],endpoints:f=>({allQueryTemplates:f.query({query:()=>({}),transformResponse:o,providesTags:["QueryTemplatesList"]}),addQueryTemplate:f.mutation({query:d=>({method:"POST",data:r(d)}),invalidatesTags:["QueryTemplatesList"]})}),reducerPath:"queryLibrary"})},56389:(Q,I,e)=>{"use strict";e.d(I,{C1:()=>i,GY:()=>r,Su:()=>f,mG:()=>o});var n=e(75505),a=e(17172);const o="peakq.grafana.app/v0alpha1";var r=(d=>(d.QueryTemplate="QueryTemplate",d))(r||{});const i=`/apis/${o}/namespaces/default/querytemplates/`,f=async d=>{try{const l=(0,a.AI)().fetch({url:i,showErrorAlert:!0,method:d.method||"GET",data:d.data});return await(0,n.s)(l)}catch(l){return(0,a.NF)(l)?{error:new Error(l.data.message)}:l instanceof Error?{error:l}:{error:new Error("Unknown error")}}}},64152:(Q,I,e)=>{"use strict";e.d(I,{d:()=>o,m:()=>a});class n{constructor(){this.extraRenderActions=[]}addExtraRenderAction(i){this.extraRenderActions=this.extraRenderActions.concat(i)}getAllExtraRenderAction(){return this.extraRenderActions}}const a=new n,o=new n},65160:(Q,I,e)=>{"use strict";e.d(I,{c:()=>W,E:()=>_});var n=e(46942),a=e.n(n),o=e(2543),r=e(55127),i=e.n(r),f=e(96540),d=e(41987),l=e(76287),m=e(18226),s=e(39070),h=e(14236),u=e(26272),b=e(13544),g=e(19347),P=e(7376),c=e(14110),y=e(39938),p=e(66602),v=e(22214),D=e(10343),E=e(7788),S=e(8484),T=e(74856),M=e(84423),A=e(64152),x=e(32196),C=e(40845),O=e(14578),R=e(10354),L=e(72093),N=e(51612);const F=H=>{const{query:G,queries:j,onChange:Y,collapsedText:oe,renderExtras:se,hidden:ne}=H,ee=(0,C.of)(B),[Z,z]=(0,f.useState)(!1),[q,ie]=(0,f.useState)(null),de=me=>{z(!0)},ue=me=>{if(z(!1),q){ie(null);return}G.refId!==me&&Y({...G,refId:me})},fe=me=>{const pe=me.currentTarget.value.trim();if(pe.length===0){ie("An empty query name is not allowed");return}for(const ye of j)if(ye!==G&&pe===ye.refId){ie("Query name already exists");return}q&&ie(null)},Se=me=>{ue(me.currentTarget.value.trim())},he=me=>{me.key==="Enter"&&ue(me.currentTarget.value)},ce=me=>{me.target.select()};return f.createElement(f.Fragment,null,f.createElement("div",{className:ee.wrapper},!Z&&f.createElement("button",{className:ee.queryNameWrapper,"aria-label":b.Tp.components.QueryEditorRow.title(G.refId),title:"Edit query name",onClick:de,"data-testid":"query-name-div",type:"button"},f.createElement("span",{className:ee.queryName},G.refId),f.createElement(O.I,{name:"pen",className:ee.queryEditIcon,size:"sm"})),Z&&f.createElement(f.Fragment,null,f.createElement(R.p,{type:"text",defaultValue:G.refId,onBlur:Se,autoFocus:!0,onKeyDown:he,onFocus:ce,invalid:q!==null,onChange:fe,className:ee.queryNameInput,"data-testid":"query-name-input"}),q&&f.createElement(L.P,{horizontal:!0},q)),K(H,ee),se&&f.createElement("div",{className:ee.itemWrapper},se()),ne&&f.createElement("em",{className:ee.contextInfo},"Hidden")),oe&&f.createElement("div",{className:ee.collapsedText},oe))},K=(H,G)=>{const{alerting:j,dataSource:Y,onChangeDataSource:oe}=H;return oe?f.createElement("div",{className:G.itemWrapper},f.createElement(N.s,{variables:!0,alerting:j,current:Y.name,onChange:oe})):f.createElement("em",{className:G.contextInfo},"(",Y.name,")")},B=H=>({wrapper:(0,x.css)`
      label: Wrapper;
      display: flex;
      align-items: center;
      margin-left: ${H.spacing(.5)};
      overflow: hidden;
    `,queryNameWrapper:(0,x.css)`
      display: flex;
      cursor: pointer;
      border: 1px solid transparent;
      border-radius: ${H.shape.borderRadius(2)};
      align-items: center;
      padding: 0 0 0 ${H.spacing(.5)};
      margin: 0;
      background: transparent;
      overflow: hidden;

      &:hover {
        background: ${H.colors.action.hover};
        border: 1px dashed ${H.colors.border.strong};
      }

      &:focus {
        border: 2px solid ${H.colors.primary.border};
      }

      &:hover,
      &:focus {
        .query-name-edit-icon {
          visibility: visible;
        }
      }
    `,queryName:(0,x.css)`
      font-weight: ${H.typography.fontWeightMedium};
      color: ${H.colors.primary.text};
      cursor: pointer;
      overflow: hidden;
      margin-left: ${H.spacing(.5)};
    `,queryEditIcon:(0,x.cx)((0,x.css)`
        margin-left: ${H.spacing(2)};
        visibility: hidden;
      `,"query-name-edit-icon"),queryNameInput:(0,x.css)`
      max-width: 300px;
      margin: -4px 0;
    `,collapsedText:(0,x.css)`
      font-weight: ${H.typography.fontWeightRegular};
      font-size: ${H.typography.bodySmall.fontSize};
      color: ${H.colors.text.secondary};
      padding-left: ${H.spacing(1)};
      align-items: center;
      overflow: hidden;
      font-style: italic;
      white-space: nowrap;
      text-overflow: ellipsis;
    `,contextInfo:(0,x.css)`
      font-size: ${H.typography.bodySmall.fontSize};
      font-style: italic;
      color: ${H.colors.text.secondary};
      padding-left: 10px;
      padding-right: 10px;
    `,itemWrapper:(0,x.css)`
      display: flex;
      margin-left: 4px;
    `});function w({error:H}){const G=(0,C.of)(U),j=H?.message??H?.data?.message??"Query error";return f.createElement("div",{className:G.wrapper},f.createElement("div",{className:G.icon},f.createElement(O.I,{name:"exclamation-triangle"})),f.createElement("div",{className:G.message},j,H.traceId!=null&&f.createElement(f.Fragment,null,f.createElement("br",null)," ",f.createElement("span",null,"(Trace ID: ",H.traceId,")"))))}const U=H=>({wrapper:(0,x.css)({marginTop:H.spacing(.5),background:H.colors.background.secondary,display:"flex"}),icon:(0,x.css)({background:H.colors.error.main,color:H.colors.error.contrastText,padding:H.spacing(1)}),message:(0,x.css)({fontSize:H.typography.bodySmall.fontSize,fontFamily:H.typography.fontFamilyMonospace,padding:H.spacing(1)})});class W extends f.PureComponent{constructor(){super(...arguments),this.element=null,this.angularScope=null,this.angularQueryEditor=null,this.dataSourceSrv=(0,g.l)(),this.id="",this.state={datasource:null,hasTextEditMode:!1,data:void 0,isOpen:!0,showingHelp:!1},this.renderAngularQueryEditor=()=>{if(!this.element)return;this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null);const G=(0,P.E)(),j='<plugin-component type="query-ctrl" />',Y={ctrl:this.getAngularQueryComponentScope()};this.angularQueryEditor=G.load(this.element,Y,j),this.angularScope=Y.ctrl},this.onOpen=()=>{this.renderAngularQueryEditor()},this.renderPluginEditor=()=>{const{query:G,onChange:j,queries:Y,onRunQuery:oe,onAddQuery:se,app:ne=d.Jk.PanelEditor,history:ee}=this.props,{datasource:Z,data:z}=this.state;if(this.isWaitingForDatasourceToLoad())return null;if(Z?.components?.QueryCtrl)return f.createElement("div",{ref:q=>this.element=q});if(Z){let q=this.getReactQueryEditor(Z);if(q)return f.createElement(l.p,{instanceSettings:this.props.dataSource},f.createElement(q,{key:Z?.name,query:G,datasource:Z,onChange:j,onRunQuery:oe,onAddQuery:se,data:z,range:(0,T.jG)().timeRange(),queries:Y,app:ne,history:ee}))}return f.createElement("div",null,f.createElement(S.x6,{i18nKey:"query-operation.query-editor-not-exported"},"Data source plugin does not export any Query Editor component"))},this.onToggleEditMode=(G,j)=>{G.stopPropagation(),this.angularScope&&this.angularScope.toggleEditorMode&&(this.angularScope.toggleEditorMode(),this.angularQueryEditor?.digest(),j.isOpen||j.onOpen())},this.onRemoveQuery=()=>{const{onRemoveQuery:G,query:j,onQueryRemoved:Y}=this.props;G(j),Y&&Y()},this.onCopyQuery=()=>{const{query:G,onAddQuery:j,onQueryCopied:Y}=this.props,oe=(0,o.cloneDeep)(G);j(oe),Y&&Y()},this.onHideQuery=()=>{const{query:G,onChange:j,onRunQuery:Y,onQueryToggled:oe}=this.props;j({...G,hide:!G.hide}),Y(),oe&&oe(G.hide),(0,c.rR)("query_editor_row_hide_query_clicked",{hide:!G.hide})},this.onToggleHelp=()=>{this.setState(G=>({showingHelp:!G.showingHelp}))},this.onClickExample=G=>{G.datasource===void 0&&(G.datasource={type:this.props.dataSource.type,uid:this.props.dataSource.uid}),this.props.onChange({...G,refId:this.props.query.refId}),this.onToggleHelp()},this.renderWarnings=()=>{const{data:G,query:j}=this.props,oe=(_(G,j.refId)?.series??[]).reduce((Z,z)=>{if(!z.meta?.notices)return Z;const q=(0,o.filter)(z.meta.notices,{severity:"warning"})??[];return Z.concat(q)},[]),se=(0,o.uniqBy)(oe,"text");if(!(se.length>0))return null;const ee=se.map(Z=>Z.text).join(`
`);return f.createElement(y.E,{key:"query-warning",color:"orange",icon:"exclamation-triangle",text:f.createElement(f.Fragment,null,se.length," ",i()("warning",se.length)),tooltip:ee})},this.renderExtraActions=()=>{const{query:G,queries:j,data:Y,onAddQuery:oe,dataSource:se}=this.props,ne=A.d.getAllExtraRenderAction().map((ee,Z)=>ee({query:G,queries:j,timeRange:Y.timeRange,onAddQuery:oe,dataSource:se,key:Z})).filter(Boolean);return ne.push(this.renderWarnings()),ne},this.renderActions=G=>{const{query:j,hideHideQueryButton:Y=!1}=this.props,{hasTextEditMode:oe,datasource:se,showingHelp:ne}=this.state,ee=!!j.hide,Z=se?.components?.QueryEditorHelp;return f.createElement(f.Fragment,null,Z&&f.createElement(D.A,{title:(0,S.t)("query-operation.header.datasource-help","Show data source help"),icon:"question-circle",onClick:this.onToggleHelp,active:ne}),oe&&f.createElement(D.q,{title:(0,S.t)("query-operation.header.toggle-edit-mode","Toggle text edit mode"),icon:"pen",onClick:z=>{this.onToggleEditMode(z,G)}}),this.renderExtraActions(),f.createElement(D.q,{title:(0,S.t)("query-operation.header.duplicate-query","Duplicate query"),icon:"copy",onClick:this.onCopyQuery}),Y?null:f.createElement(D.A,{dataTestId:b.Tp.components.QueryEditorRow.actionButton("Hide response"),title:j.hide?(0,S.t)("query-operation.header.show-response","Show response"):(0,S.t)("query-operation.header.hide-response","Hide response"),icon:ee?"eye-slash":"eye",active:ee,onClick:this.onHideQuery}),f.createElement(D.q,{title:(0,S.t)("query-operation.header.remove-query","Remove query"),icon:"trash-alt",onClick:this.onRemoveQuery}))},this.renderHeader=G=>{const{alerting:j,query:Y,dataSource:oe,onChangeDataSource:se,onChange:ne,queries:ee,renderHeaderExtras:Z}=this.props;return f.createElement(F,{query:Y,queries:ee,onChangeDataSource:se,dataSource:oe,hidden:Y.hide,onClick:z=>this.onToggleEditMode(z,G),onChange:ne,collapsedText:G.isOpen?null:this.renderCollapsedText(),renderExtras:Z,alerting:j})}}componentDidMount(){const{data:G,query:j,id:Y}=this.props,oe=_(G,j.refId);this.id=(0,o.uniqueId)(Y+"_"),this.setState({data:oe}),this.loadDatasource()}componentWillUnmount(){this.angularQueryEditor&&this.angularQueryEditor.destroy()}getAngularQueryComponentScope(){const{query:G,queries:j}=this.props,{datasource:Y}=this.state,oe=new M.a9({targets:j}),se={},ne=this;return{datasource:Y,target:G,panel:oe,dashboard:se,refresh:()=>{G.hide!==ne.props.query.hide&&(G.hide=ne.props.query.hide),this.props.onChange(G),this.props.onRunQuery()},render:()=>()=>console.log("legacy render function called, it does nothing"),events:this.props.eventBus||new m.o,range:(0,T.jG)().timeRange()}}getInterpolatedDataSourceUID(){if(this.props.query.datasource){const G=this.dataSourceSrv.getInstanceSettings(this.props.query.datasource);return G?.rawRef?.uid??G?.uid}return this.props.dataSource.rawRef?.uid??this.props.dataSource.uid}async loadDatasource(){let G;const j=this.getInterpolatedDataSourceUID();try{G=await this.dataSourceSrv.get(j)}catch{G=await this.dataSourceSrv.get()}typeof this.props.onDataSourceLoaded=="function"&&this.props.onDataSourceLoaded(G),this.setState({datasource:G,queriedDataSourceIdentifier:j,hasTextEditMode:(0,o.has)(G,"components.QueryCtrl.prototype.toggleEditorMode")})}componentDidUpdate(G){const{datasource:j,queriedDataSourceIdentifier:Y}=this.state,{data:oe,query:se}=this.props;if(G.id!==this.props.id&&(this.id=(0,o.uniqueId)(this.props.id+"_")),oe!==G.data){const ne=_(oe,se.refId);this.setState({data:ne}),this.angularScope&&(this.angularScope.range=(0,T.jG)().timeRange()),this.angularQueryEditor&&ne&&V(this.angularScope,ne,this.angularQueryEditor)}if(j&&Y!==this.getInterpolatedDataSourceUID()){this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null),this.loadDatasource();return}!this.element||this.angularQueryEditor||this.renderAngularQueryEditor()}getReactQueryEditor(G){if(G)switch(this.props.app){case d.Jk.Explore:return G.components?.ExploreMetricsQueryField||G.components?.ExploreLogsQueryField||G.components?.ExploreQueryField||G.components?.QueryEditor;case d.Jk.PanelEditor:case d.Jk.Dashboard:default:return G.components?.QueryEditor}}isWaitingForDatasourceToLoad(){return this.getInterpolatedDataSourceUID()!==this.state.queriedDataSourceIdentifier}renderCollapsedText(){const{datasource:G}=this.state;return G?.getQueryDisplayText?G.getQueryDisplayText(this.props.query):this.angularScope&&this.angularScope.getCollapsedText?this.angularScope.getCollapsedText():null}render(){const{query:G,index:j,visualization:Y,collapsable:oe}=this.props,{datasource:se,showingHelp:ne,data:ee}=this.state,Z=G.hide,z=ee?.error&&ee.error.refId===G.refId?ee.error:ee?.errors?.find(ue=>ue.refId===G.refId),q=a()("query-editor-row",{"query-editor-row--disabled":Z,"gf-form-disabled":Z});if(!se)return null;const ie=this.renderPluginEditor(),de=se.components?.QueryEditorHelp;return f.createElement("div",{"data-testid":"query-editor-row","aria-label":b.Tp.components.QueryEditorRows.rows},f.createElement(E.u,{id:this.id,draggable:!0,collapsable:oe,index:j,headerElement:this.renderHeader,actions:this.renderActions,onOpen:this.onOpen},f.createElement("div",{className:q,id:this.id},f.createElement(p.Xw,null,ne&&de&&f.createElement(v.j,null,f.createElement(de,{onClickExample:ue=>this.onClickExample(ue),query:this.props.query,datasource:se})),ie),z&&f.createElement(w,{error:z}),Y)))}}function V(H,G,j){if(G.state===s.Gu.Done){const Y=G.series.map(oe=>(0,h.w3)(oe));H.events.emit(u.ee.dataReceived,Y)}else G.state===s.Gu.Error&&H.events.emit(u.ee.dataError,G.error);setTimeout(j.digest)}function _(H,G){const j=H.series.filter(ne=>ne.refId===G);if(H.state!==s.Gu.Loading&&(H.error||H.errors?.length)&&!H.series.length)return{...H,state:s.Gu.Error};let Y=H.state,oe=H.errors?.find(ne=>ne.refId===G);!oe&&H.error&&(oe=H.error.refId===G?H.error:void 0),Y!==s.Gu.Loading&&(oe?Y=s.Gu.Error:H.state===s.Gu.Error&&(Y=s.Gu.Done));const se=H.timeRange;return{...H,state:Y,series:j,error:oe,errors:oe?[oe]:void 0,timeRange:se}}},44932:(Q,I,e)=>{"use strict";e.d(I,{L:()=>f});var n=e(96540),a=e(75494),o=e(14110),r=e(19347),i=e(65160);class f extends n.PureComponent{constructor(){super(...arguments),this.onRemoveQuery=m=>{this.props.onQueriesChange(this.props.queries.filter(s=>s!==m))},this.onDragStart=m=>{const{queries:s,dsSettings:h}=this.props;(0,o.rR)("query_row_reorder_started",{startIndex:m.source.index,numberOfQueries:s.length,datasourceType:h.type})},this.onDragEnd=m=>{const{queries:s,onQueriesChange:h,dsSettings:u}=this.props;if(!m||!m.destination)return;const b=m.source.index,g=m.destination.index;if(b===g){(0,o.rR)("query_row_reorder_canceled",{startIndex:b,endIndex:g,numberOfQueries:s.length,datasourceType:u.type});return}const P=Array.from(s),[c]=P.splice(b,1);P.splice(g,0,c),h(P),(0,o.rR)("query_row_reorder_ended",{startIndex:b,endIndex:g,numberOfQueries:s.length,datasourceType:u.type})}}onChangeQuery(m,s){const{queries:h,onQueriesChange:u}=this.props;u(h.map((b,g)=>g===s?m:b))}onDataSourceChange(m,s){const{queries:h,onQueriesChange:u}=this.props;u(h.map((b,g)=>{if(g!==s)return b;const P={type:m.type,uid:m.uid};return b.datasource&&(0,r.l)().getInstanceSettings(b.datasource)?.type===m.type?{...b,datasource:P}:{refId:b.refId,hide:b.hide,datasource:P}}))}render(){const{dsSettings:m,data:s,queries:h,app:u,history:b,eventBus:g,onAddQuery:P,onRunQueries:c,onQueryCopied:y,onQueryRemoved:p,onQueryToggled:v,queryRowWrapper:D}=this.props;return n.createElement(a.JY,{onDragStart:this.onDragStart,onDragEnd:this.onDragEnd},n.createElement(a.gL,{droppableId:"transformations-list",direction:"vertical"},E=>n.createElement("div",{"data-testid":"query-editor-rows",ref:E.innerRef,...E.droppableProps},h.map((S,T)=>{const M=d(S,m),A=m.meta.mixed?C=>this.onDataSourceChange(C,T):void 0,x=n.createElement(i.c,{id:S.refId,index:T,key:S.refId,data:s,query:S,dataSource:M,onChangeDataSource:A,onChange:C=>this.onChangeQuery(C,T),onRemoveQuery:this.onRemoveQuery,onAddQuery:P,onRunQuery:c,onQueryCopied:y,onQueryRemoved:p,onQueryToggled:v,queries:h,app:u,history:b,eventBus:g});return D?D(x,S.refId):x}),E.placeholder)))}}const d=(l,m)=>l.datasource&&(0,r.l)().getInstanceSettings(l.datasource)||m},37464:(Q,I,e)=>{"use strict";e.d(I,{g:()=>G,K:()=>Y});var n=e(32196),a=e(96540),o=e(39070),r=e(43127),i=e(41987),f=e(43429),d=e(13544),l=e(19347),m=e(12131),s=e(66864),h=e(55852),u=e(40276),b=e(37390),g=e(3911),P=e(38894),c=e(16817),y=e(36663),p=e(17172),v=e(39558);function D({pluginId:se}){const{value:ne,loading:ee,error:Z}=(0,c.A)(async()=>(0,p.AI)().get(`/api/plugins/${se}/markdown/query_help`),[]),z=(0,y.G)(ne);return ee?a.createElement(v._,{text:"Loading help..."}):Z?a.createElement("h3",null,"An error occurred when loading help."):ne===""?a.createElement("h3",null,"No query help could be found."):a.createElement("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:z}})}var E=e(2913),S=e(27677),T=e(21969),M=e(50481),A=e(51612),x=e(53478),C=e(74106),O=e(14348),R=e(8480),L=e(93117),N=e(64152),F=e(44932),K=e(65879),B=e(10354),w=e(15292),U=e(7788);class W extends a.PureComponent{constructor(ne){super(ne),this.onRelativeTimeChange=Z=>{this.setState({timeRangeFrom:Z.target.value})},this.onTimeShiftChange=Z=>{this.setState({timeRangeShift:Z.target.value})},this.onOverrideTime=Z=>{const{options:z,onChange:q}=this.props,ie=_(Z.target.value),de=V(ie);de&&z.timeRange?.from!==ie&&q({...z,timeRange:{...z.timeRange??{},from:ie}}),this.setState({relativeTimeIsValid:de})},this.onTimeShift=Z=>{const{options:z,onChange:q}=this.props,ie=_(Z.target.value),de=V(ie);de&&z.timeRange?.shift!==ie&&q({...z,timeRange:{...z.timeRange??{},shift:ie}}),this.setState({timeShiftIsValid:de})},this.onToggleTimeOverride=()=>{const{onChange:Z,options:z}=this.props;this.setState({timeRangeHide:!this.state.timeRangeHide},()=>{Z({...z,timeRange:{...z.timeRange??{},hide:this.state.timeRangeHide}})})},this.onCacheTimeoutBlur=Z=>{const{options:z,onChange:q}=this.props;q({...z,cacheTimeout:_(Z.target.value)})},this.onQueryCachingTTLBlur=Z=>{const{options:z,onChange:q}=this.props;let ie=parseInt(Z.target.value,10);(isNaN(ie)||ie===0)&&(ie=null),q({...z,queryCachingTTL:ie})},this.onMaxDataPointsBlur=Z=>{const{options:z,onChange:q}=this.props;let ie=parseInt(Z.currentTarget.value,10);(isNaN(ie)||ie===0)&&(ie=null),ie!==z.maxDataPoints&&q({...z,maxDataPoints:ie})},this.onMinIntervalBlur=Z=>{const{options:z,onChange:q}=this.props,ie=_(Z.target.value);ie!==z.minInterval&&q({...z,minInterval:ie})},this.onOpenOptions=()=>{this.setState({isOpen:!0})},this.onCloseOptions=()=>{this.setState({isOpen:!1})};const{options:ee}=ne;this.state={timeRangeFrom:ee.timeRange?.from||"",timeRangeShift:ee.timeRange?.shift||"",timeRangeHide:ee.timeRange?.hide??!1,isOpen:!1,relativeTimeIsValid:!0,timeShiftIsValid:!0}}renderCacheTimeoutOption(){const{dataSource:ne,options:ee}=this.props,Z=`If your time series store has a query cache this option can override the default cache timeout. Specify a
    numeric value in seconds.`;return ne.meta.queryOptions?.cacheTimeout?a.createElement("div",{className:"gf-form-inline"},a.createElement("div",{className:"gf-form"},a.createElement(P.I,{width:9,tooltip:Z},"Cache timeout"),a.createElement(B.p,{type:"text",className:"width-6",placeholder:"60",spellCheck:!1,onBlur:this.onCacheTimeoutBlur,defaultValue:ee.cacheTimeout??""}))):null}renderQueryCachingTTLOption(){const{dataSource:ne,options:ee}=this.props,Z="Cache time-to-live: How long results from this queries in this panel will be cached, in milliseconds. Defaults to the TTL in the caching configuration for this datasource.";return ne.cachingConfig?.enabled?a.createElement("div",{className:"gf-form-inline"},a.createElement("div",{className:"gf-form"},a.createElement(P.I,{width:9,tooltip:Z},"Cache TTL"),a.createElement(B.p,{type:"number",className:"width-6",placeholder:`${ne.cachingConfig.TTLMs}`,spellCheck:!1,onBlur:this.onQueryCachingTTLBlur,defaultValue:ee.queryCachingTTL??void 0}))):null}renderMaxDataPointsOption(){const{data:ne,options:ee}=this.props,Z=ne.request?.maxDataPoints,z=ee.maxDataPoints??"",q=z==="";return a.createElement("div",{className:"gf-form-inline"},a.createElement("div",{className:"gf-form"},a.createElement(P.I,{width:9,tooltip:a.createElement(a.Fragment,null,"The maximum data points per series. Used directly by some data sources and used in calculation of auto interval. With streaming data this value is used for the rolling buffer.")},"Max data points"),a.createElement(B.p,{type:"number",className:"width-6",placeholder:`${Z}`,spellCheck:!1,onBlur:this.onMaxDataPointsBlur,defaultValue:z}),q&&a.createElement(a.Fragment,null,a.createElement("div",{className:"gf-form-label query-segment-operator"},"="),a.createElement("div",{className:"gf-form-label"},"Width of panel"))))}renderIntervalOption(){const{data:ne,dataSource:ee,options:Z}=this.props,z=ne.request?.interval,q=ee.interval??"No limit";return a.createElement(a.Fragment,null,a.createElement("div",{className:"gf-form-inline"},a.createElement("div",{className:"gf-form"},a.createElement(P.I,{width:9,tooltip:a.createElement(a.Fragment,null,"A lower limit for the interval. Recommended to be set to write frequency, for example ",a.createElement("code",null,"1m")," ","if your data is written every minute. Default value can be set in data source settings for most data sources.")},"Min interval"),a.createElement(B.p,{type:"text",className:"width-6",placeholder:`${q}`,spellCheck:!1,onBlur:this.onMinIntervalBlur,defaultValue:Z.minInterval??""}))),a.createElement("div",{className:"gf-form-inline"},a.createElement("div",{className:"gf-form"},a.createElement(P.I,{width:9,tooltip:a.createElement(a.Fragment,null,"The evaluated interval that is sent to data source and is used in ",a.createElement("code",null,"$__interval")," and"," ",a.createElement("code",null,"$__interval_ms"),". This value is not exactly equal to"," ",a.createElement("code",null,"Time range / max data points"),", it will approximate a series of magic number.")},"Interval"),a.createElement(P.I,{width:6},z),a.createElement("div",{className:"gf-form-label query-segment-operator"},"="),a.createElement("div",{className:"gf-form-label"},"Time range / max data points"))))}renderCollapsedText(ne){const{data:ee,options:Z}=this.props,{isOpen:z}=this.state;if(z)return;let q=Z.maxDataPoints??"";q===""&&ee.request&&(q=`auto = ${ee.request.maxDataPoints}`);let ie=Z.minInterval;return ee.request&&(ie=`${ee.request.interval}`),a.createElement(a.Fragment,null,a.createElement("div",{className:ne.collapsedText},"MD = ",q),a.createElement("div",{className:ne.collapsedText},"Interval = ",ie))}render(){const{timeRangeHide:ne,relativeTimeIsValid:ee,timeShiftIsValid:Z}=this.state,{timeRangeFrom:z,timeRangeShift:q,isOpen:ie}=this.state,de=H();return a.createElement(U.u,{id:"Query options",index:0,title:"Query options",headerElement:this.renderCollapsedText(de),isOpen:ie,onOpen:this.onOpenOptions,onClose:this.onCloseOptions},this.renderMaxDataPointsOption(),this.renderIntervalOption(),this.renderCacheTimeoutOption(),this.renderQueryCachingTTLOption(),a.createElement("div",{className:"gf-form"},a.createElement(P.I,{width:9,tooltip:a.createElement(a.Fragment,null,"Overrides the relative time range for individual panels, which causes them to be different than what is selected in the dashboard time picker in the top-right corner of the dashboard. For example to configure the Last 5 minutes the Relative time should be ",a.createElement("code",null,"now-5m")," and ",a.createElement("code",null,"5m"),", or variables like ",a.createElement("code",null,"$_relativeTime"),".")},"Relative time"),a.createElement(B.p,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onRelativeTimeChange,onBlur:this.onOverrideTime,invalid:!ee,value:z})),a.createElement("div",{className:"gf-form"},a.createElement(P.I,{width:9,tooltip:a.createElement(a.Fragment,null,"Overrides the time range for individual panels by shifting its start and end relative to the time picker. For example to configure the Last 1h the Time shift should be ",a.createElement("code",null,"now-1h")," and"," ",a.createElement("code",null,"1h"),", or variables like ",a.createElement("code",null,"$_timeShift"),".")},"Time shift"),a.createElement(B.p,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onTimeShiftChange,onBlur:this.onTimeShift,invalid:!Z,value:q})),(q||z)&&a.createElement("div",{className:"gf-form-inline align-items-center"},a.createElement(P.I,{width:9},"Hide time info"),a.createElement(w.d,{value:ne,onChange:this.onToggleTimeOverride})))}}const V=se=>se?K.isValidTimeSpan(se):!0,_=se=>se===""?null:se,H=(0,g.N)(()=>{const{theme:se}=E.config;return{collapsedText:(0,n.css)`
      margin-left: ${se.spacing.md};
      font-size: ${se.typography.size.sm};
      color: ${se.colors.textWeak};
    `}});class G extends a.PureComponent{constructor(){super(...arguments),this.backendSrv=S.IB,this.dataSourceSrv=(0,l.l)(),this.querySubscription=null,this.state={isDataSourceModalOpen:!!m.Ny.getSearchObject().firstPanel,isLoadingHelp:!1,helpContent:null,isPickerOpen:!1,isHelpOpen:!1,queries:[],data:{state:o.Gu.NotStarted,series:[],timeRange:(0,r.E2)()}},this.onChangeDataSource=async(ne,ee)=>{const{dsSettings:Z}=this.state,z=Z?await(0,l.l)().get(Z.uid):void 0,q=await(0,l.l)().get(ne.uid),ie=ee||await(0,L.y)(q,ne.uid,this.state.queries,z),de=await this.dataSourceSrv.get(ne.name);this.onChange({queries:ie,dataSource:{name:ne.name,uid:ne.uid,type:ne.meta.id,default:ne.isDefault}}),this.setState({queries:ie,dataSource:de,dsSettings:ne}),ee&&this.props.onRunQueries()},this.onAddQueryClick=()=>{const{queries:ne}=this.state;this.onQueriesChange((0,T.U7)(ne,this.newQuery())),this.onScrollBottom()},this.onAddExpressionClick=()=>{this.onQueriesChange((0,T.U7)(this.state.queries,x.Ex.newQuery())),this.onScrollBottom()},this.onScrollBottom=()=>{setTimeout(()=>{this.state.scrollElement&&this.state.scrollElement.scrollTo({top:1e4})},20)},this.onUpdateAndRun=ne=>{this.props.onOptionsChange(ne),this.props.onRunQueries()},this.onOpenHelp=()=>{this.setState({isHelpOpen:!0})},this.onCloseHelp=()=>{this.setState({isHelpOpen:!1})},this.onCloseDataSourceModal=()=>{this.setState({isDataSourceModalOpen:!1})},this.onAddQuery=ne=>{const{dsSettings:ee,queries:Z}=this.state;this.onQueriesChange((0,T.U7)(Z,ne,{type:ee?.type,uid:ee?.uid})),this.onScrollBottom()},this.onQueriesChange=ne=>{this.onChange({queries:ne}),this.setState({queries:ne})},this.setScrollRef=ne=>{this.setState({scrollElement:ne})}}async componentDidMount(){const{options:ne,queryRunner:ee}=this.props;this.querySubscription=ee.getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:Z=>this.onPanelDataUpdate(Z)}),this.setNewQueriesAndDatasource(ne)}componentWillUnmount(){this.querySubscription&&(this.querySubscription.unsubscribe(),this.querySubscription=null)}async componentDidUpdate(){const{options:ne}=this.props,ee=await(0,l.l)().get(ne.dataSource);this.state.dataSource&&ee.uid!==this.state.dataSource?.uid&&this.setNewQueriesAndDatasource(ne)}async setNewQueriesAndDatasource(ne){try{const ee=await this.dataSourceSrv.get(ne.dataSource),Z=this.dataSourceSrv.getInstanceSettings(ne.dataSource),z=await this.dataSourceSrv.get(),q=ee.getRef(),ie=ne.queries.map(de=>({...(0,T.Ih)(de)&&ee?.getDefaultQuery?.(i.Jk.PanelEditor),datasource:q,...de}));this.setState({queries:ie,dataSource:ee,dsSettings:Z,defaultDataSource:z})}catch(ee){console.error("failed to load data source",ee)}}onPanelDataUpdate(ne){this.setState({data:ne})}newQuery(){const{dsSettings:ne,defaultDataSource:ee}=this.state,Z=ne?.meta.mixed?ee:ne;return{...this.state.dataSource?.getDefaultQuery?.(i.Jk.PanelEditor),datasource:{uid:Z?.uid,type:Z?.type}}}onChange(ne){this.props.onOptionsChange({...this.props.options,...ne})}renderTopSection(ne){const{onOpenQueryInspector:ee,options:Z}=this.props,{dataSource:z,data:q,dsSettings:ie}=this.state;return!ie||!z?null:a.createElement(Y,{data:q,dataSource:z,options:Z,dsSettings:ie,onOptionsChange:this.onUpdateAndRun,onDataSourceChange:this.onChangeDataSource,onOpenQueryInspector:ee})}renderQueries(ne){const{onRunQueries:ee}=this.props,{data:Z,queries:z}=this.state;return a.createElement("div",{"aria-label":d.Tp.components.QueryTab.content},a.createElement(F.L,{queries:z,dsSettings:ne,onQueriesChange:this.onQueriesChange,onAddQuery:this.onAddQuery,onRunQueries:ee,data:Z}))}isExpressionsSupported(ne){return(ne.meta.alerting||ne.meta.mixed)===!0}renderExtraActions(){return N.m.getAllExtraRenderAction().map((ne,ee)=>ne({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:ee})).filter(Boolean)}renderAddQueryRow(ne,ee){const Z=!(0,O.kN)(ne.name);return a.createElement(s.Gy,{spacing:"md",align:"flex-start"},Z&&a.createElement(h.$n,{icon:"plus",onClick:this.onAddQueryClick,variant:"secondary","data-testid":d.Tp.components.QueryTab.addQuery},"Add query"),E.Ay.expressionsEnabled&&this.isExpressionsSupported(ne)&&a.createElement(h.$n,{icon:"plus",onClick:this.onAddExpressionClick,variant:"secondary",className:ee.expressionButton,"data-testid":"query-tab-add-expression"},a.createElement("span",null,"Expression\xA0")),this.renderExtraActions())}render(){const{isHelpOpen:ne,dsSettings:ee}=this.state,Z=j();return a.createElement(u.E,{autoHeightMin:"100%",scrollRefCallback:this.setScrollRef},a.createElement("div",{className:Z.innerWrapper},this.renderTopSection(Z),ee&&a.createElement(a.Fragment,null,a.createElement("div",{className:Z.queriesWrapper},this.renderQueries(ee)),this.renderAddQueryRow(ee,Z),ne&&a.createElement(b.a,{title:"Data source help",isOpen:!0,onDismiss:this.onCloseHelp},a.createElement(D,{pluginId:ee.meta.id})))))}}const j=(0,g.N)(()=>{const{theme:se}=E.Ay;return{innerWrapper:(0,n.css)`
      display: flex;
      flex-direction: column;
      padding: ${se.spacing.md};
    `,dataSourceRow:(0,n.css)`
      display: flex;
      margin-bottom: ${se.spacing.md};
    `,dataSourceRowItem:(0,n.css)`
      margin-right: ${se.spacing.inlineFormMargin};
    `,dataSourceRowItemOptions:(0,n.css)`
      flex-grow: 1;
      margin-right: ${se.spacing.inlineFormMargin};
    `,queriesWrapper:(0,n.css)`
      padding-bottom: 16px;
    `,expressionWrapper:(0,n.css)``,expressionButton:(0,n.css)`
      margin-right: ${se.spacing.sm};
    `}});function Y({dataSource:se,options:ne,data:ee,dsSettings:Z,onDataSourceChange:z,onOptionsChange:q,onOpenQueryInspector:ie}){const de=j(),[ue,fe]=(0,a.useState)(!1);return a.createElement(a.Fragment,null,a.createElement("div",{"data-testid":d.Tp.components.QueryTab.queryGroupTopSection},a.createElement("div",{className:de.dataSourceRow},a.createElement(P.I,{htmlFor:"data-source-picker",width:"auto"},"Data source"),a.createElement("div",{className:de.dataSourceRowItem},a.createElement(oe,{options:ne,onChange:async(Se,he)=>await z?.(Se,he),isDataSourceModalOpen:!!m.Ny.getSearchObject().firstPanel})),se&&a.createElement(a.Fragment,null,a.createElement("div",{className:de.dataSourceRowItem},a.createElement(h.$n,{variant:"secondary",icon:"question-circle",title:"Open data source help",onClick:()=>fe(!0),"data-testid":"query-tab-help-button"})),a.createElement("div",{className:de.dataSourceRowItemOptions},a.createElement(W,{options:ne,dataSource:se,data:ee,onChange:Se=>{q?.(Se)}})),ie&&a.createElement("div",{className:de.dataSourceRowItem},a.createElement(h.$n,{variant:"secondary",onClick:ie,"aria-label":d.Tp.components.QueryTab.queryInspectorButton},"Query inspector")))),se&&(0,R.Hv)(se.uid)&&a.createElement(C.c,{pluginId:se.type,pluginType:f.QE.datasource,angularSupportEnabled:E.Ay?.angularSupportEnabled,showPluginDetailsLink:!0,interactionElementId:"datasource-query"})),ue&&a.createElement(b.a,{title:"Data source help",isOpen:!0,onDismiss:()=>fe(!1)},a.createElement(D,{pluginId:Z.meta.id})))}function oe({options:se,onChange:ne,...ee}){const[Z,z]=(0,a.useState)(!!ee.isDataSourceModalOpen);(0,a.useEffect)(()=>{m.Ny.getSearchObject().firstPanel&&m.Ny.partial({firstPanel:null},!0)},[]);const q={metrics:!0,mixed:!0,dashboard:!0,variables:!0,current:se.dataSource,uploadFile:!0,onChange:async(ie,de)=>{await ne(ie,de),z(!1)}};return a.createElement(a.Fragment,null,Z&&a.createElement(M.p,{...q,onDismiss:()=>z(!1)}),a.createElement(A.s,{...q}))}},42972:(Q,I,e)=>{"use strict";e.d(I,{nm:()=>ie,Dh:()=>Z});var n=e(39741),a=e(13752),o=e(64423),r=e(44240),i=e(39697),f=e(81160),d=e(67791),l=e(93031),m=e(71030),s=e(69850),h=e(1005),u=e(65961),b=e(3591),g=e(2543);function P(de){let ue=[];const fe=(0,g.partition)(de,"id"),Se=(0,g.groupBy)(fe[0],"id");return ue=(0,g.map)(Se,he=>he.length>1&&!(0,g.every)(he,c)?(0,g.find)(he,ce=>ce.eventType!=="panel-alert"):(0,g.head)(he)),ue=(0,g.concat)(ue,fe[1]),ue}function c(de){return de.eventType==="panel-alert"}var y=e(74856),p=e(62467),v=e(65474),D=e(66847),E=e(69862),S=e(16126),T=e(32264),M=e(19347),A=e(90569),x=e(28444),C=e(27302),O=e(7436);class R{canRun(ue){return ue?!!(!ue.annotationQuery||ue.annotations):!1}run({annotation:ue,datasource:fe,dashboard:Se,range:he}){if(!this.canRun(fe))return(0,p.of)([]);const ce={};return(0,C.b)({dashboard:Se,range:he,panel:ce},fe,ue).pipe((0,f.T)(me=>me.events??[]),(0,D.W)(O.SD))}}var L=e(42493);class N{canRun(ue){return ue?(0,L.E7)(ue)?!0:!!(ue.annotationQuery&&!ue.annotations):!1}run({annotation:ue,datasource:fe,dashboard:Se,range:he}){return this.canRun(fe)?(0,v.H)(fe.annotationQuery({range:he,rangeRaw:he.raw,annotation:ue,dashboard:Se})).pipe((0,D.W)(O.SD)):(0,p.of)([])}}class F{constructor(ue=[new N,new R]){this.runners=ue}canWork({dashboard:ue}){return!!ue.annotations.list.find(F.getAnnotationsToProcessFilter)}work(ue){if(!this.canWork(ue))return(0,O.$)();const{dashboard:fe,range:Se}=ue;let he=fe.annotations.list.filter(F.getAnnotationsToProcessFilter);T.$.publicDashboardAccessToken&&he.length>0&&(he=[he[0]]);const ce=he.map(me=>{let pe;if(T.$.publicDashboardAccessToken){const ye=new A.X;pe=(0,p.of)(ye).pipe((0,D.W)(O.H0))}else pe=(0,v.H)((0,M.l)().get(me.datasource)).pipe((0,D.W)(O.H0));return pe.pipe((0,E.Z)(ye=>{const Pe=this.runners.find(Ie=>Ie.canRun(ye));return Pe?(fe.events.publish(new x.xc(me)),Pe.run({annotation:me,datasource:ye,dashboard:fe,range:Se}).pipe((0,d.Q)(Z().cancellations().pipe((0,S.p)(Ie=>Ie===me))),(0,f.T)(Ie=>(fe.snapshot&&(me.snapshotData=(0,g.cloneDeep)(Ie)),T.$.publicDashboardAccessToken?Ie:(0,O.G9)(me,Ie))),(0,s.j)(()=>{fe.events.publish(new x.yj(me))}))):(0,p.of)([])}))});return(0,r.h)(ce).pipe((0,l.U)(),(0,m.T)((me,pe)=>me.concat(pe)),(0,f.T)(me=>({annotations:me,alertStates:[]})))}static getAnnotationsToProcessFilter(ue){return ue.enable&&!ue.snapshotData}}var K=e(85595),B=e(43585),w=e(16233),U=e(79938),W=e(49498),V=e(55740),_=e(57220),H=e(23662),G=e(91309),j=e(99140),Y=e(31678);class oe{constructor(){this.hasAlertRules={}}canWork({dashboard:ue,range:fe}){return!(!ue.uid||T.$.publicDashboardAccessToken||fe.raw.to!=="now"||this.hasAlertRules[ue.uid]===!1||!(w.TP.hasPermission(Y.AccessControlAction.AlertingRuleRead)&&w.TP.hasPermission(Y.AccessControlAction.AlertingRuleExternalRead)))}work(ue){if(!this.canWork(ue))return(0,O.$)();const{dashboard:fe}=ue,Se=async()=>(await(0,j.JD)(U.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:_.hY,dashboardUid:fe.uid}))).data;return(0,v.H)(Se()).pipe((0,f.T)(ce=>(0,W.Kw)(ce))).pipe((0,f.T)(ce=>{this.hasAlertRules[fe.uid]=!1;const me={};return ce.forEach(pe=>pe.rules.forEach(ye=>{if((0,H.Z8)(ye)&&ye.annotations&&ye.annotations[V.YH.panelID]){this.hasAlertRules[fe.uid]=!0;const Pe=Number(ye.annotations[V.YH.panelID]),Ie=(0,G.S)(ye.state);me[Pe]?Ie===B.O.Alerting&&me[Pe].state!==B.O.Alerting?me[Pe].state=B.O.Alerting:Ie===B.O.Pending&&me[Pe].state!==B.O.Alerting&&me[Pe].state!==B.O.Pending&&(me[Pe].state=B.O.Pending):me[Pe]={state:Ie,id:Object.keys(me).length,panelId:Pe,dashboardId:fe.id}}})),{alertStates:Object.values(me),annotations:[]}}),(0,D.W)(O.Zr))}}class se{constructor(ue,fe=(0,y.jG)(),Se=[new oe,new K.F,new F]){this.dashboard=ue,this.timeSrv=fe,this.workers=Se,this.run=this.run.bind(this),this.getResult=this.getResult.bind(this),this.cancel=this.cancel.bind(this),this.destroy=this.destroy.bind(this),this.executeRun=this.executeRun.bind(this),this.results=new n.m(1),this.runs=new a.B,this.cancellationStream=new a.B,this.runsSubscription=this.runs.subscribe(he=>this.executeRun(he)),this.eventsSubscription=ue.events.subscribe(b._,he=>{this.run({dashboard:this.dashboard,range:this.timeSrv.timeRange()})})}run(ue){this.runs.next(ue)}getResult(ue){return this.results.asObservable().pipe((0,f.T)(fe=>{const Se=(0,O.FK)(fe.annotations,ue),he=fe.alertStates.find(ce=>!!ue&&ce.panelId===ue);return{annotations:P(Se),alertState:he}}))}executeRun(ue){const Se=this.workers.filter(ye=>ye.canWork(ue)).map(ye=>ye.work(ue)),he=new o.yU,ce=(0,r.h)(Se).pipe((0,d.Q)(this.runs.asObservable()),(0,l.U)(),(0,m.T)((ye,Pe)=>(ye.annotations=ye.annotations.concat(Pe.annotations),ye.alertStates=ye.alertStates.concat(Pe.alertStates),ye)),(0,s.j)(()=>{he.unsubscribe()}),(0,h.u)()),me=new o.yU,pe=(0,i.O)(200).pipe((0,u.u)({annotations:[],alertStates:[]}),(0,d.Q)(ce),(0,s.j)(()=>{me.unsubscribe()}));me.add(pe.subscribe(ye=>{this.results.next(ye)})),he.add(ce.subscribe(ye=>{this.results.next(ye)}))}cancel(ue){this.cancellationStream.next(ue)}cancellations(){return this.cancellationStream.asObservable().pipe((0,h.u)())}destroy(){this.results.complete(),this.runs.complete(),this.cancellationStream.complete(),this.runsSubscription.unsubscribe(),this.eventsSubscription.unsubscribe()}}let ne;function ee(de){ne&&ne.destroy(),ne=de}function Z(){if(!ne)throw new Error("getDashboardQueryRunner can only be used after Grafana instance has started.");return ne}let z;function q(de){z=de}function ie(de){z||(z=({dashboard:fe,timeSrv:Se,workers:he})=>new se(fe,Se,he));const ue=z(de);return ee(ue),ue}},90569:(Q,I,e)=>{"use strict";e.d(I,{X:()=>s});var n=e(62467),a=e(65474),o=e(40187),r=e(14236),i=e(17172),f=e(32264),d=e(57220),l=e(68706);const m="-- Public --";class s extends o.mA{constructor(){let u={};super({name:"public-ds",id:0,type:"public-ds",meta:u,uid:m,jsonData:{},access:"proxy",readOnly:!0}),this.annotations={prepareQuery(b){return{...b,queryType:l.nj.Annotations,refId:"anno"}}}}query(u){return u.targets.length?u.targets[0]?.datasource?.uid===d.vv?(0,a.H)(this.getAnnotations(u)):(0,n.of)({data:[]}):(0,n.of)({data:[]})}async getAnnotations(u){const{range:{to:b,from:g}}=u,P={from:g.valueOf(),to:b.valueOf()},c=await(0,i.AI)().get(`/api/public/dashboards/${f.$.publicDashboardAccessToken}/annotations`,P);return{data:[(0,r.Vc)(c)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}},85595:(Q,I,e)=>{"use strict";e.d(I,{F:()=>o});var n=e(62467),a=e(7436);class o{canWork({dashboard:i}){return i?.annotations?.list?.some(f=>f.enable&&!!f.snapshotData)}work(i){if(!this.canWork(i))return(0,a.$)();const f=this.getAnnotationsFromSnapshot(i.dashboard);return(0,n.of)({annotations:f,alertStates:[]})}getAnnotationsFromSnapshot(i){return(i?.annotations?.list?.filter(m=>m.enable)).filter(m=>!!m.snapshotData).reduce((m,s)=>m.concat((0,a.G9)(s,s.snapshotData)),[])}getAnnotationsInSnapshot(i,f){const d=this.getAnnotationsFromSnapshot(i);return(0,a.FK)(d,f)}}},7436:(Q,I,e)=>{"use strict";e.d(I,{$:()=>u,FK:()=>P,G9:()=>c,H:()=>y,H0:()=>h,SD:()=>s,Zr:()=>b});var n=e(2543),a=e.n(n),o=e(62467),r=e(78368),i=e(12091),f=e(32264),d=e(99140),l=e(3169),m=e(16001);function s(p){return p.cancelled?(0,o.of)([]):(g("AnnotationQueryRunner failed",p),(0,o.of)([]))}function h(p){return g("Failed to retrieve datasource",p),(0,o.of)(void 0)}const u=()=>(0,o.of)({annotations:[],alertStates:[]});function b(p){return p.cancelled||g("DashboardQueryRunner failed",p),u()}function g(p,v){const D=(0,i.u)(v);console.error("handleAnnotationQueryRunnerError",D);const E=(0,l.gi)(p,D.message);(0,d.JD)((0,m.dx)(E))}function P(p,v){return v==null?p:p.filter(D=>{let E;if(E=D.source,!E)return!0;if(E.filter){const S=(E.filter.ids??[]).includes(v);if(E.filter.exclude){if(S)return!1}else if(!S)return!1}return D.panelId&&D.source.type==="dashboard"?D.panelId===v:!0})}function c(p,v){p.snapshotData&&(p=(0,n.cloneDeep)(p),delete p.snapshotData);for(const D of v)switch(D.source=p,D.color=f.$.theme2.visualization.getColorByName(p.iconColor),D.type=p.name,D.isRegion=!!(D.timeEnd&&D.time!==D.timeEnd),D.newState?.toLowerCase()){case"pending":D.color="yellow";break;case"alerting":D.color="red";break;case"ok":D.color="green";break;case"normal":D.color="green";break;case"no_data":D.color="gray";break;case"nodata":D.color="gray";break}return v}function y(p){if(!p||!p.length)return[];const v=[];for(const D of p){const E=new r.R(D);for(let S=0;S<D.length;S++){const T=(0,n.cloneDeep)(E.get(S));v.push(T)}}return v}},80924:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>L,S:()=>R});var n=e(2543),a=e(39741),o=e(62467),r=e(69862),i=e(81160),f=e(66847),d=e(39070),l=e(14236),m=e(43127),s=e(90708),h=e(21423),u=e(52622),b=e(2514),g=e(41987),P=e(65879),c=e(12091),y=e(26657),p=e(47118),v=e(31193),D=e(23989),E=e(14348),S=e(42972),T=e(49510),M=e(33948);function A(F=[]){F.forEach(K=>{K.meta={...K.meta,dataTopic:u.QR.Annotations}})}function x(F,K){return(0,T.z)([F,K]).pipe((0,r.Z)(B=>{const[w,U]=B;if(U.annotations?.length||U.alertState){w.annotations||(w.annotations=[]);const W=w.annotations.concat((0,M.I)(U.annotations));A(W);const V=U.alertState;return(0,o.of)({...w,annotations:W,alertState:V})}return A(w.annotations),(0,o.of)(w)}))}var C=e(39374);let O=100;function R(){return"Q"+O++}class L{constructor(K){this.templateSrv=(0,D.w)(),this.resendLastResult=()=>{this.lastResult&&this.subject.next(this.lastResult)},this.subject=new a.m(1),this.dataConfigSource=K}getData(K){const{withFieldConfig:B,withTransforms:w}=K;let U=1,W,V=[],_=[],H,G=!0,j=-1;if(this.dataConfigSource.snapshotData){const Y={state:d.Gu.Done,series:this.dataConfigSource.snapshotData.map(oe=>(0,l.Vc)(oe)),timeRange:(0,m.E2)(),structureRev:U};return(0,o.of)(Y)}return this.subject.pipe((0,r.Z)(Y=>{let oe=this.dataConfigSource.getFieldOverrideOptions(),se=this.dataConfigSource.getTransformations();if(Y.series===_&&W?.fieldConfig===oe?.fieldConfig&&H===se)return(0,o.of)({...Y,structureRev:U,series:V});W=oe,H=se,_=Y.series;let ne=(0,o.of)(Y);return w&&(ne=this.applyTransformations(Y)),ne.pipe((0,i.T)(ee=>{let Z=ee,z=!1;if(B&&ee.series?.length){if(j===this.dataConfigSource.configRev){let q;for(const ie of ee.series)if((0,p.o$)(ie)){q=ie;break}q&&!q.packetInfo.schemaChanged&&V[0].fields.length===q.fields.length&&(Z={...Z,series:V.map((ie,de)=>({...ie,length:ee.series[de].length,fields:ie.fields.map((ue,fe)=>({...ue,values:ee.series[de].fields[fe].values,state:{...ue.state,calcs:void 0,range:void 0}}))}))},z=!0)}oe!=null&&(G||!z)&&(j=this.dataConfigSource.configRev,Z={...Z,series:(0,s.we)({timeZone:ee.request?.timezone??"browser",data:Z.series,...oe})},Z.annotations&&(Z.annotations=(0,s.we)({data:Z.annotations,...oe,fieldConfig:{defaults:{},overrides:[]}})),G=!1)}return!z&&!(0,h.J3)(V,Z.series,h.bW)&&U++,V=Z.series,{...Z,structureRev:U}}))}))}applyTransformations(K){const B=this.dataConfigSource.getTransformations();if(B&&B.every(G=>G.disabled)||!B||B.length===0)return(0,o.of)(K);const U={interpolate:G=>this.templateSrv.replace(G,K?.request?.scopedVars)};let W=B.filter(G=>G.topic==null||G.topic===u.QR.Series),V=B.filter(G=>G.topic===u.QR.Annotations),_=(0,b.m)(W,K.series,U),H=(0,b.m)(V,K.annotations??[],U);return(0,n.merge)(_,H).pipe((0,i.T)(G=>{let Y=G.some(oe=>oe.meta?.dataTopic===u.QR.Annotations)?{annotations:G}:{series:G};return{...K,...Y}}),(0,f.W)(G=>(console.warn("Error running transformation:",G),(0,o.of)({...K,state:d.Gu.Error,errors:[(0,c.u)(G)]}))))}async run(K){const{queries:B,timezone:w,datasource:U,panelId:W,panelPluginId:V,dashboardUID:_,timeRange:H,timeInfo:G,cacheTimeout:j,queryCachingTTL:Y,maxDataPoints:oe,scopedVars:se,minInterval:ne,app:ee}=K;if((0,E.kN)(U)){this.pipeToSubject((0,E.mw)(K,B[0]),W,!0);return}const Z=this.shouldAddErrorWhenDatasourceVariableIsMultiple(U,se),z={app:ee??g.Jk.Dashboard,requestId:R(),timezone:w,panelId:W,panelPluginId:V,dashboardUID:_,range:H,timeInfo:G,interval:"",intervalMs:0,targets:(0,n.cloneDeep)(B),maxDataPoints:oe,scopedVars:se||{},cacheTimeout:j,queryCachingTTL:Y,startTime:Date.now(),rangeRaw:H.raw};try{const q=await N(U,z.scopedVars),ie=q.meta?.mixed;z.targets=z.targets.map(fe=>{const Se=fe.datasource?.type===y.dR.type;return(!fe.datasource||fe.datasource.uid!==q.uid&&!ie&&!Se)&&(fe.datasource=q.getRef()),fe});const de=ne?this.templateSrv.replace(ne,z.scopedVars):q.interval,ue=P.calculateInterval(H,oe,de);z.scopedVars=Object.assign({},z.scopedVars,{__interval:{text:ue.interval,value:ue.interval},__interval_ms:{text:ue.intervalMs.toString(),value:ue.intervalMs}}),z.interval=ue.interval,z.intervalMs=ue.intervalMs,z.filters=this.templateSrv.getAdhocFilters(q.name,!0),this.lastRequest=z,this.pipeToSubject((0,C.BN)(q,z),W,!1,Z)}catch(q){this.pipeToSubject((0,o.of)({state:d.Gu.Error,error:(0,c.u)(q),series:[],timeRange:z.range}),W)}}pipeToSubject(K,B,w=!1,U=!1){this.subscription&&this.subscription.unsubscribe();let W=K;const V=this.dataConfigSource.getDataSupport();if(V.alertStates||V.annotations){const _=this.dataConfigSource;W=x(K,(0,S.Dh)().getResult(_.id))}this.subscription=W.subscribe({next:_=>{const H=this.lastResult,G=w?_:(0,l.N$)(_,H);if(H!=null&&G.state!==d.Gu.Streaming){let j=(0,h.J3)(H.series??[],G.series??[],(se,ne)=>se===ne),Y=(0,h.J3)(H.annotations??[],G.annotations??[],(se,ne)=>se===ne),oe=H.state===G.state;if(j&&(G.series=H.series),Y&&(G.annotations=H.annotations),j&&Y&&oe)return}this.lastResult=G,U&&(G.errors=[{message:"Panel is using a variable datasource with multiple values without repeat option. Please configure the panel to be repeated by the same datasource variable."}],G.state=d.Gu.Error),this.subject.next(G)}})}cancelQuery(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&(this.lastResult.state===d.Gu.Loading||this.lastResult.state===d.Gu.Streaming)&&this.subject.next({...this.lastResult,state:d.Gu.Done}))}clearLastResult(){this.lastResult=void 0,this.subject=new a.m(1)}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}useLastResultFrom(K){this.lastResult=K.getLastResult(),this.lastResult&&this.subject.next(this.lastResult)}setLastResult(K){this.lastResult=K}getLastResult(){return this.lastResult}getLastRequest(){return this.lastRequest}shouldAddErrorWhenDatasourceVariableIsMultiple(K,B){let w=!1;return K?.uid?.startsWith("${")&&this.templateSrv.replace(K.uid,B,U=>(Array.isArray(U)&&U.length>1&&(w=!0),"")),w}}async function N(F,K){return F&&typeof F=="object"&&"query"in F?F:await(0,v.tR)().get(F,K)}},81583:(Q,I,e)=>{"use strict";e.d(I,{N:()=>a});var n=e(69850);function a(o,r){return(0,n.j)(()=>{r&&o.resolveCancelerIfExists(r)})}},72955:(Q,I,e)=>{"use strict";e.d(I,{B:()=>a});var n=e(21423);const a=(o,r)=>{let i=1;return r?.structureRev&&r.series&&(i=r.structureRev,(0,n.J3)(o.series,r.series,n.bW)||i++),o.structureRev=i,o}},39374:(Q,I,e)=>{"use strict";e.d(I,{BN:()=>K});var n=e(2543),a=e(62467),o=e(44240),r=e(39697),i=e(65474),f=e(81160),d=e(66847),l=e(59099),m=e(1005),s=e(65961),h=e(67791),u=e(39070),b=e(52622),g=e(85858),P=e(41987),c=e(12091),y=e(32264),p=e(26657),v=e(27677),D=e(21969),E=e(53478),S=e(34867);const T=(0,S.DW)("features.query");var M=e(81583),A=e(76885),x=e(61298),C=e(14110),O=e(14792);function R(w){let U=!1;return V=>{if(!V.request||U||A.kM.getUrlSearchParams().editPanel!=null||V.state!==u.Gu.Done&&V.state!==u.Gu.Error)return;const H={eventName:x.n_.DataRequest,source:V.request.app,datasourceName:w.name,datasourceId:w.id,datasourceUid:w.uid,datasourceType:w.type,dataSize:0,panelId:0,panelPluginId:V.request?.panelPluginId,duration:V.request.endTime-V.request.startTime};W(H,V),V.request.app!==P.Jk.Explore&&V.request.app!==P.Jk.Correlations&&L(H,V),V.series&&V.series.length>0&&(H.dataSize=V.series.length),(0,C.G$)(H),U=!0};function W(V,_){const H={};for(let j=0;j<_.series.length;j++){const Y=_.series[j].refId;Y&&!H[Y]&&(H[Y]=_.series[j].meta?.isCachedResponse??!1)}V.totalQueries=Object.keys(H).length,V.cachedQueries=Object.values(H).filter(j=>j===!0).length,_.request&&Number.isInteger(_.request.panelId)&&(V.panelId=_.request.panelId);const G=(0,O.UA)().getCurrent();G&&(V.dashboardId=G.id,V.dashboardName=G.title,V.dashboardUid=G.uid,V.folderName=G.meta.folderTitle)}}function L(w,U){U.errors?.length?w.error=U.errors.join(", "):U.error&&(w.error=U.error.message)}function N(w,U){const W=U.panelData.request,V={...U.packets},_=w.key??w.data?.[0]?.refId??"A";V[_]=w;let H=w.state||u.Gu.Done,G,j;const Y=[],oe=[];for(const Z in V){const z=V[Z];if((z.error||z.errors?.length)&&(H=u.Gu.Error,G=z.error,j=z.errors),z.data&&z.data.length)for(const q of z.data){if(q.meta?.dataTopic===b.QR.Annotations){oe.push(q);continue}Y.push(q)}}const se=F(W,H),ne={state:H,series:Y,annotations:oe,error:G,errors:j,request:W,timeRange:se},ee=new Set([...U.panelData.traceIds??[],...w.traceIds??[]]);return ee.size>0&&(ne.traceIds=Array.from(ee)),{packets:V,panelData:ne}}function F(w,U){const W=w.range;return!(0,n.isString)(W.raw.from)||U!==u.Gu.Streaming?W:{...W,from:g.parse(W.raw.from,!1),to:g.parse(W.raw.to,!0)}}function K(w,U,W){let V={panelData:{state:u.Gu.Loading,series:[],request:U,timeRange:U.range},packets:{}};if(!U.targets.length)return U.endTime=Date.now(),V.panelData.state=u.Gu.Done,(0,a.of)(V.panelData);const _=B(w,U,W).pipe((0,f.T)(H=>{if(!(0,n.map)(H.data))throw new Error(`Expected response data to be array, got ${typeof H.data}.`);const G=U.targets.filter(j=>j.hide);for(const j of G)H.data=H.data.filter(Y=>Y.refId!==j.refId);return U.endTime=Date.now(),V=N(H,V),V.panelData}),(0,d.W)(H=>(console.error("runRequest.catchError",H),T.logError(H),(0,a.of)({...V.panelData,state:u.Gu.Error,error:(0,c.u)(H)}))),(0,l.M)(R(w)),(0,M.N)(v.IB,U.requestId),(0,m.u)());return(0,o.h)((0,r.O)(200).pipe((0,s.u)(V.panelData),(0,h.Q)(_)),_)}function B(w,U,W){if(U.targets=U.targets.map(_=>(0,D.Ih)(_)?{...w?.getDefaultQuery?.(P.Jk.PanelEditor),..._}:_),y.$.publicDashboardAccessToken)return(0,i.H)(w.query(U));for(const _ of U.targets)if((0,p.s9)(_.datasource))return E.Ex.query(U);if(W||(U.targets=U.targets.filter(_=>w.filterQuery?.(_)??!0)),U.targets.length===0)return(0,a.of)({data:[]});const V=W?W(U):w.query(U);return(0,i.H)(V)}},93117:(Q,I,e)=>{"use strict";e.d(I,{y:()=>f});var n=e(41987),a=e(73372),o=e(77789),r=e(72574),i=e(26657);async function f(d,l,m,s){let h=m;const u={type:d.type,uid:l},b={...d?.getDefaultQuery?.(n.Jk.PanelEditor),datasource:u,refId:"A"};if(s?.meta.id!==d.meta.id){if(d.meta.mixed)return m;if((0,a.Ee)(s)&&(0,a.FL)(d)){const g=await s.exportToAbstractQueries(m);h=await d.importFromAbstractQueries(g)}else if(s&&d.importQueries)h=await d.importQueries(m,s);else{if(s){const g=(0,r.w)(),P=[];let c=d.uid;const y=g.containsTemplate(l);y&&(c=g.replace(d.uid));const p=m.reduce((v,D)=>{if(D.datasource){let E=D.datasource.uid;const S=g.containsTemplate(E);if(S&&(E=g.replace(D.datasource.uid)),E===c&&S===y)return D.refId=(0,o.M)(v),v.concat([D])}return v},P);if(p.length>0)return p}return[b]}}return h.length===0?[b]:h.map(g=>(!(0,i.s9)(g.datasource)&&!d.meta.mixed&&(g.datasource=u),g))}},53477:(Q,I,e)=>{"use strict";e.d(I,{G3:()=>f,TF:()=>m,XJ:()=>g,YU:()=>u,d7:()=>h,if:()=>P,r4:()=>i,w7:()=>b});var n=e(64161);const a=null,o=58,r=8,i={label:"A\u2013Z",value:"alpha-asc"},f="search.sections",d="grafana.search.expanded-folder",l=0,m="general",s="General",h="grafana.search.include.panels",u="grafana.search.layout",b="grafana.search.sort",g={dashboard:n.G.DashDB,folder:n.G.DashFolder,home:n.G.DashHome},P=1e3},97427:(Q,I,e)=>{"use strict";e.d(I,{d:()=>i,n:()=>f});var n=e(96540),a=e(13752),o=e(71733),r=e(12131);function i(){const d=(0,n.useRef)(new a.B);return{keyboardEvents:d.current,onKeyDown:l=>{switch(l.code){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":case"Enter":d.current.next(l);default:}}}}function f(d,l,m){const s=(0,n.useRef)({x:0,y:-1}),[h,u]=(0,n.useState)({x:0,y:-1}),b=(0,n.useRef)();return(0,n.useEffect)(()=>{b.current=m.view.fields.url,s.current.x=0,s.current.y=-1,u({...s.current})},[m]),(0,n.useEffect)(()=>{const g=d.subscribe({next:P=>{switch(P?.code){case"ArrowDown":{s.current.y++,u({...s.current});break}case"ArrowUp":s.current.y=Math.max(0,s.current.y-1),u({...s.current});break;case"ArrowRight":{l>0&&(s.current.x=Math.min(l,s.current.x+1),u({...s.current}));break}case"ArrowLeft":{l>0&&(s.current.x=Math.max(0,s.current.x-1),u({...s.current}));break}case"Enter":if(!b.current)break;const c=s.current.x*l+s.current.y;if(c<0){s.current.x=0,s.current.y=0,u({...s.current});break}const y=b.current.values?.[c];typeof y=="string"&&r.Ny.push(o.I.stripBaseFromUrl(y))}}});return()=>g.unsubscribe()},[d,l]),h}},6204:(Q,I,e)=>{"use strict";e.d(I,{B9:()=>f,J$:()=>r,KZ:()=>i,MK:()=>o,Pf:()=>a});var n=e(14110);const a=(l,m)=>{(0,n.rR)(`${l}_viewed`,d(m))},o=(l,m)=>{(0,n.rR)(`${l}_result_clicked`,d(m))},r=(l,m)=>{(0,n.rR)(`${l}_query_submitted`,d(m))},i=(l,{error:m,...s})=>{(0,n.rR)(`${l}_query_failed`,{...d(s),error:m})},f=(l,m,s)=>{(0,n.rR)(`grafana_panel_inspect_${l}_${m}_clicked`,s)},d=l=>({layout:l.layout,starredFilter:l.starred??!1,sort:l.sortValue??"",tagCount:l.tagCount??0,queryLength:l.query?.length??0,includePanels:l.includePanels??!1,deleted:l.deleted??!1})},24439:(Q,I,e)=>{"use strict";e.d(I,{getGrafanaSearcher:()=>A});var n=e(32264),a=e(78368),o=e(14236),r=e(57875),i=e(17172),f=e(40957);const d="Loading",l="api/search-v2",m="name_sort";class s{constructor(C){this.fallbackSearcher=C}async search(C){if(C.facet?.length)throw new Error("facets not supported!");return this.doSearchQuery(C)}async starred(C){if(C.facet?.length)throw new Error("facets not supported!");const O=await(0,i.AI)().get("api/user/stars");return O?.length?this.doSearchQuery({uid:O,query:C.query??"*"}):{view:new a.R({length:0,fields:[]}),totalRows:0,loadMoreItems:async(R,L)=>{},isItemLoaded:R=>!0}}async tags(C){const O={...C,query:C.query??"*",sort:void 0,facet:[{field:"tag"}],limit:1},L=(await(0,i.AI)().post(l,O)).frames.map(N=>(0,o.Vc)(N));if(L[0]?.name===d)return this.fallbackSearcher.tags(C);for(const N of L)if(N.fields[0].name==="tag")return b(N);return[]}getSortOptions(){const C=[{value:m,label:"Alphabetically (A-Z)"},{value:"-name_sort",label:"Alphabetically (Z-A)"}];if(n.$.licenseInfo.enabledFeatures.analytics){for(const O of g)C.push({value:`-${O.name}`,label:`${O.display} (most)`}),C.push({value:`${O.name}`,label:`${O.display} (least)`});for(const O of P)C.push({value:`-${O.name}`,label:`${O.display} (recent)`}),C.push({value:`${O.name}`,label:`${O.display} (oldest)`})}return Promise.resolve(C)}async doSearchQuery(C){C=await(0,f.u4)(C);const O={...C,query:C.query??"*",limit:C.limit??h},L=(await(0,i.AI)().post(l,O)).frames.map(W=>(0,o.Vc)(W)),N=L.length?(0,o.Vc)(L[0]):{fields:[],length:0};if(N.name===d)return this.fallbackSearcher.search(C);for(const W of N.fields)W.display=(0,r.J)({field:W,theme:n.$.theme2});N.meta?.custom||(N.meta={...N.meta,custom:{count:N.length,max_score:1}});const F=N.meta.custom;if(F.locationInfo||(F.locationInfo={}),F.sortBy?.length){const W=N.fields.find(V=>V.name===F.sortBy);if(W){const V=c(W.name);F.sortBy=V,W.name=V}}let K=0,B;const w=async()=>{for(;K>U.dataFrame.length;){const W=U.dataFrame.length;if(W>=F.count)return;const V=await(0,i.AI)().post(l,{...O??{},from:W,limit:u}),_=(0,o.Vc)(V.frames[0]);if(!_){console.log("no results",_);return}if(_.fields.length!==U.dataFrame.fields.length){console.log("invalid shape",_,U.dataFrame);return}const H=_.length+U.dataFrame.length;for(let j=0;j<_.fields.length;j++)U.dataFrame.fields[j].values.push(..._.fields[j].values);U.dataFrame.length=H;const G=_.meta?.custom;if(G?.locationInfo&&F)for(const[j,Y]of Object.entries(G.locationInfo))F.locationInfo[j]=Y}B=void 0},U=new a.R(N);return{totalRows:F.count??N.length,view:U,loadMoreItems:async(W,V)=>(K=Math.max(K,V),B||(B=w()),B),isItemLoaded:W=>W<U.dataFrame.length}}getFolderViewSort(){return"name_sort"}}const h=50,u=100;function b(x){const C=x.fields[0].values,O=x.fields[1].values,R=[];for(let L=0;L<x.length;L++)R.push({term:C[L],count:O[L]});return R}const g=[{name:"views_total",display:"Views total"},{name:"views_last_30_days",display:"Views 30 days"},{name:"errors_total",display:"Errors total"},{name:"errors_last_30_days",display:"Errors 30 days"}],P=[{name:"created_at",display:"Created time"},{name:"updated_at",display:"Updated time"}];function c(x){for(const C of g)if(C.name===x)return C.display;for(const C of P)if(C.name===x)return C.display;return x}var y=e(53076);class p{constructor(C){this.parent=C,this.cache=new Map,this.sortPlaceholder="Default (Relevance)"}async search(C){if(C.facet?.length)throw new Error("facets not supported!");if(C.sort!=null)throw new Error("custom sorting is not supported yet");if(C.tags?.length||C.ds_uid?.length)return this.parent.search(C);const R=(await this.getCache(C.kind)).search(C.query);return{isItemLoaded:()=>!0,loadMoreItems:async(L,N)=>{},totalRows:R.length,view:R}}async getCache(C){const O=C?C.sort().join(","):"*",R=this.cache.get(O);if(R)try{return await R}catch{return this.cache.delete(O),new v(new a.R({name:"error",fields:[],length:0}))}const L=this.parent.search({kind:C,limit:5e3}).then(N=>new v(N.view));return this.cache.set(O,L),L}async starred(C){return this.parent.starred(C)}async getSortOptions(){return this.parent.getSortOptions()}async tags(C){return this.parent.tags(C)}getFolderViewSort(){return this.parent.getFolderViewSort()}}class v{constructor(C){this.full=C,this.ufuzzy=new y.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),this.names=this.full.fields.name.values,this.empty=new a.R({...this.full.dataFrame,fields:this.full.dataFrame.fields.map(O=>({...O,values:[]})),length:0})}search(C){if(!C?.length||C==="*")return this.full;const O=this.full.dataFrame.fields,R=this.names,L=O.map(B=>[]);let[N,F,K]=this.ufuzzy.search(R,C,5);for(let B=0;B<O.length;B++){let w=O[B].values,U=L[B];if(F&&K)for(let W=0;W<K.length;W++){let V=F.idx[K[W]];U.push(w[V])}else if(N)for(let W=0;W<N.length;W++){let V=N[W];U.push(w[V])}}return this.empty.dataFrame.fields.forEach((B,w)=>{B.values=L[w]}),this.empty.dataFrame.length=this.empty.dataFrame.fields[0].values.length,this.empty}}var D=e(11261),E=e(27677),S=e(53477);class T{constructor(){this.locationInfo={general:{kind:"folder",name:"General",url:"/dashboards"}},this.getFolderViewSort=()=>""}async composeQuery(C,O){const R=await(0,f.u4)(O);return R.query?.length&&R.query!=="*"&&(C.query=R.query),R.kind?.length===1&&S.XJ[R.kind[0]]&&(C.type=S.XJ[R.kind[0]]),R.uid?C.dashboardUID=R.uid:R.location?.length&&(C.folderUIDs=[R.location]),C}async search(C){if(C.facet?.length)throw new Error("facets not supported!");if(C.from!==void 0){if(!C.limit)throw new Error("Must specify non-zero limit parameter when using from");if(C.from/C.limit%1!==0)throw new Error("From parameter must be a multiple of limit")}const O=C.limit??(C.from!==void 0?1:S.if),R=C.from!==void 0?C.from/O+1:void 0,L=await this.composeQuery({limit:O,tag:C.tags,sort:C.sort,permission:C.permission,page:R,deleted:C.deleted},C);return this.doAPIQuery(L)}async starred(C){if(C.facet?.length)throw new Error("facets not supported!");const O=await this.composeQuery({limit:C.limit??S.if,tag:C.tags,sort:C.sort,starred:C.starred},C);return this.doAPIQuery(O)}async getSortOptions(){return(await E.IB.get("/api/search/sorting")).sortOptions.map(O=>({value:O.name,label:O.displayName}))}async tags(C){return(await E.IB.get("/api/dashboards/tags")).sort((R,L)=>L.count-R.count)}async doAPIQuery(C){const O=await E.IB.get("/api/search",C),R=[],L=[],N=[],F=[],K=[],B=[],w=[];let U;for(let _ of O){const H=_.type==="dash-folder"?"folder":"dashboard";R.push(H),L.push(_.title),N.push(_.uid),F.push(_.url),K.push(_.tags),w.push(_.sortMeta);let G=_.folderUid;!G&&H==="dashboard"&&(G="general"),B.push(G),_.sortMetaName?.length&&(U=_.sortMetaName),_.folderUid&&_.folderTitle?this.locationInfo[_.folderUid]={kind:"folder",name:_.folderTitle,url:_.folderUrl,folderUid:_.folderUid}:H==="folder"&&(this.locationInfo[_.uid]={kind:H,name:_.title,url:_.url,folderUid:_.folderUid})}const W={fields:[{name:"kind",type:D.PU.string,config:{},values:R},{name:"name",type:D.PU.string,config:{},values:L},{name:"uid",type:D.PU.string,config:{},values:N},{name:"url",type:D.PU.string,config:{},values:F},{name:"tags",type:D.PU.other,config:{},values:K},{name:"location",type:D.PU.string,config:{},values:B}],length:L.length,meta:{custom:{count:L.length,max_score:1,locationInfo:this.locationInfo}}};U?.length&&w.length&&(W.meta.custom.sortBy=U,W.fields.push({name:U,type:D.PU.number,config:{},values:w}));for(const _ of W.fields)_.display=(0,r.J)({field:_,theme:n.$.theme2});const V=new a.R(W);return{totalRows:W.length,view:V,loadMoreItems:async(_,H)=>{},isItemLoaded:_=>!0}}}let M;function A(){if(!M){const x=new T,C=n.$.featureToggles.panelTitleSearch;M=C?new s(x):x,C&&location.search.includes("do-frontend-query")&&(M=new p(M))}return M}},40957:(Q,I,e)=>{"use strict";e.d(I,{TM:()=>f,cu:()=>d,hI:()=>m,u4:()=>o});var n=e(49952),a=e(14792);async function o(s){return s.query&&s.query.indexOf("folder:current")>=0&&(s={...s,location:await r(),query:s.query.replace("folder:current","").trim()},s.query?.length||(s.query="*")),Promise.resolve(s)}async function r(){try{let s=(0,a.UA)().getCurrent();return s||(await i(500),s=(0,a.UA)().getCurrent()),Promise.resolve(s?.meta?.folderUid)}catch(s){console.error(s)}}function i(s){return new Promise(h=>setTimeout(h,s))}function f(s,h){return s==="dashboard"?"apps":s==="folder"?h?"folder-open":"folder":"question-circle"}function d(s,h){return s&&(0,n.I)(s.uid)?"users-alt":f(s.kind,h)}function l(s){switch(s){case"dashboard":case"folder":case"panel":return s;default:return"dashboard"}}function m(s,h){const u=h?.dataFrame.meta?.custom,b={kind:l(s.kind),uid:s.uid,title:s.name,url:s.url,tags:s.tags??[]},g=u?.sortBy;if(g){const P=s[g];(typeof P=="string"||typeof P=="number")&&(b.sortMetaName=g,b.sortMeta=P)}if(s.location){const P=s.location.split("/"),c=P[P.length-1],y=u?.locationInfo[c];y&&(b.parentTitle=y.name,b.parentKind=y.kind,b.parentUID=c)}return b}},64161:(Q,I,e)=>{"use strict";e.d(I,{G:()=>n,P:()=>a});var n=(o=>(o.DashDB="dash-db",o.DashHome="dash-home",o.DashFolder="dash-folder",o))(n||{}),a=(o=>(o.List="list",o.Folders="folders",o))(a||{})},16757:(Q,I,e)=>{"use strict";e.d(I,{N1:()=>i,W1:()=>o});var n=e(53477);const a=f=>f?!!(f.query||f.tag?.length>0||f.starred||f.sort):!1,o=()=>{const f=n.G3+".";for(let d=0;d<window.localStorage.length;d++){const l=window.localStorage.key(d);l?.startsWith(f)&&window.localStorage.removeItem(l)}},r=(f="General")=>`${SECTION_STORAGE_KEY}.${f.toLowerCase()}`,i=f=>{const d=Object.entries(f).reduce((l,[m,s])=>{if(s){if(m==="tag"&&!Array.isArray(s))return{...l,tag:[s]}}else return l;return{...l,[m]:s}},{});if(f.folder){const l=`folder:${f.folder}`;return{...d,query:`${l} ${(d.query??"").replace(l,"")}`}}return{...d}}},1936:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>S,EC:()=>v,FW:()=>P,G3:()=>l,L5:()=>E,QM:()=>f,Yh:()=>c,aD:()=>m,c3:()=>D,ch:()=>d,dJ:()=>s,ew:()=>p,jE:()=>h,zh:()=>y});var n=e(65307),a=e(31678);const o={serviceAccount:{},isLoading:!0,tokens:[]},r=(0,n.Z0)({name:"serviceaccount",initialState:o,reducers:{serviceAccountFetchBegin:T=>({...T,isLoading:!0}),serviceAccountFetchEnd:T=>({...T,isLoading:!1}),serviceAccountLoaded:(T,M)=>({...T,serviceAccount:M.payload,isLoading:!1}),serviceAccountTokensLoaded:(T,M)=>({...T,tokens:M.payload,isLoading:!1}),rolesFetchBegin:T=>({...T,rolesLoading:!0}),rolesFetchEnd:T=>({...T,rolesLoading:!1})}}),i=r.reducer,{serviceAccountLoaded:f,serviceAccountTokensLoaded:d,serviceAccountFetchBegin:l,serviceAccountFetchEnd:m,rolesFetchBegin:s,rolesFetchEnd:h}=r.actions,u={serviceAccounts:[],isLoading:!0,roleOptions:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,serviceAccountStateFilter:a.ServiceAccountStateFilter.All},b=(0,n.Z0)({name:"serviceaccounts",initialState:u,reducers:{serviceAccountsFetched:(T,M)=>{const{totalCount:A,perPage:x,...C}=M.payload,O=Math.ceil(A/x);return{...T,...C,totalPages:O,perPage:x,showPaging:O>1,isLoading:!1}},serviceAccountsFetchBegin:T=>({...T,isLoading:!0}),serviceAccountsFetchEnd:T=>({...T,isLoading:!1}),acOptionsLoaded:(T,M)=>({...T,roleOptions:M.payload}),queryChanged:(T,M)=>({...T,query:M.payload,page:0}),pageChanged:(T,M)=>({...T,page:M.payload}),stateFilterChanged:(T,M)=>({...T,serviceAccountStateFilter:M.payload})}}),g=b.reducer,{serviceAccountsFetchBegin:P,serviceAccountsFetchEnd:c,serviceAccountsFetched:y,acOptionsLoaded:p,pageChanged:v,stateFilterChanged:D,queryChanged:E}=b.actions,S={serviceAccountProfile:i,serviceAccounts:g}},8212:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>b,NV:()=>h,Y1:()=>l,j7:()=>d,kH:()=>f,pB:()=>s,s7:()=>m,sF:()=>i,sJ:()=>r});var n=e(65307);const a={supportBundles:[],isLoading:!1,supportBundleCollectors:[],createBundlePageLoading:!1,loadBundlesError:"",createBundleError:""},o=(0,n.Z0)({name:"supportBundles",initialState:a,reducers:{supportBundlesLoaded:(g,P)=>({...g,supportBundles:P.payload,isLoading:!1}),fetchBegin:g=>({...g,isLoading:!0}),fetchEnd:g=>({...g,isLoading:!1}),collectorsFetchBegin:g=>({...g,createBundlePageLoading:!0}),collectorsFetchEnd:g=>({...g,createBundlePageLoading:!1}),supportBundleCollectorsLoaded:(g,P)=>({...g,supportBundleCollectors:P.payload,createBundlePageLoading:!1}),setLoadBundleError:(g,P)=>({...g,loadBundlesError:P.payload,supportBundleCollectors:[]}),setCreateBundleError:(g,P)=>({...g,createBundleError:P.payload})}}),{supportBundlesLoaded:r,fetchBegin:i,fetchEnd:f,supportBundleCollectorsLoaded:d,collectorsFetchBegin:l,collectorsFetchEnd:m,setLoadBundleError:s,setCreateBundleError:h}=o.actions,b={supportBundles:o.reducer}},34655:(Q,I,e)=>{"use strict";e.d(I,{$T:()=>b,$u:()=>d,Ay:()=>p,EC:()=>f,L5:()=>i,Q9:()=>r,dJ:()=>l,jE:()=>m,tC:()=>g});var n=e(65307);const a={teams:[],page:1,query:"",perPage:30,totalPages:0,noTeams:!1,hasFetched:!1},o=(0,n.Z0)({name:"teams",initialState:a,reducers:{teamsLoaded:(v,D)=>{const{totalCount:E,perPage:S,...T}=D.payload,M=Math.ceil(E/S);return{...v,...T,totalPages:M,perPage:S,hasFetched:!0}},queryChanged:(v,D)=>({...v,page:1,query:D.payload}),pageChanged:(v,D)=>({...v,page:D.payload}),sortChanged:(v,D)=>({...v,sort:D.payload,page:1}),rolesFetchBegin:v=>({...v,rolesLoading:!0}),rolesFetchEnd:v=>({...v,rolesLoading:!1})}}),{teamsLoaded:r,queryChanged:i,pageChanged:f,sortChanged:d,rolesFetchBegin:l,rolesFetchEnd:m}=o.actions,s=o.reducer,h={team:{},members:[],groups:[],searchMemberQuery:""},u=(0,n.Z0)({name:"team",initialState:h,reducers:{teamLoaded:(v,D)=>({...v,team:D.payload}),teamMembersLoaded:(v,D)=>({...v,members:D.payload}),setSearchMemberQuery:(v,D)=>({...v,searchMemberQuery:D.payload}),teamGroupsLoaded:(v,D)=>({...v,groups:D.payload})}}),{teamLoaded:b,teamGroupsLoaded:g,teamMembersLoaded:P,setSearchMemberQuery:c}=u.actions,y=u.reducer,p={teams:s,team:y}},23989:(Q,I,e)=>{"use strict";e.d(I,{w:()=>ee});var n=e(2543),a=e(95344),o=e(19347),r=e(72574),i=e(16401),f=e(52622),d=e(73788),l=e(20601),m=e(13344),s=e(24240),h=e(87421),u=e(75096);let b={};function g(Z){const z=b[Z];return z||(b[Z]=(0,n.property)(Z))}class P{constructor(z,q,ie){this.state={name:z.name,value:q,text:ie,type:z.type}}getValue(z){let{value:q}=this.state;return q==="string"||q==="number"||q==="boolean"?q:String(q)}getValueText(){const{value:z,text:q}=this.state;return typeof q=="string"?z===m.To?m.Zm:q:Array.isArray(q)?q.join(" + "):(console.log("value",q),String(q))}}let c;function y(Z,z,q){return c?(c.state.name=Z.name,c.state.type=Z.type,c.state.value=z,c.state.text=q):c=new P(Z,z,q),c}function p(Z,z,q,ie){if(q=q||{},Z==null||(0,s.EW)(q)&&z!==f.$m.QueryParam)return"";if(!Array.isArray(Z)&&typeof Z=="object"&&(Z=`${Z}`),typeof z=="function")return z(Z,q,p);z||(z=f.$m.Glob);let de=z.split(":");de.length>1?(z=de[0],de=de.slice(1)):de=[];let ue=i.vz.getIfExists(z);ue||(console.error(`Variable format ${z} not found. Using glob format as fallback.`),ue=i.vz.get(f.$m.Glob));const fe=y(q,Z,ie??Z);return ue.formatter(Z,de,fe)}var v=e(84743),D=e.n(v),E=e(6709),S=e(76885),T=e(1933),M=e(74856),A=e(25304),x=e(83195),C=e(11261),O=e(92461),R=e(57875),L=e(28240),N=e(8249);function F(Z,z,q){return new Proxy({},{get:(ie,de)=>{if(de==="name")return Z.name;if(de==="displayName")return(0,L.Ct)(Z,z,q);if(de==="labels"||de==="formattedLabels")return Z.labels?{...Z.labels,__values:Object.values(Z.labels).sort().join(", "),toString:()=>(0,N.h6)(Z.labels,"",!0)}:""}})}function K(Z,z,q,ie){const de=B(Z,z,q);return p(de,ie)}function B(Z,z,q){const ie=q?.__dataContext;if(!ie)return Z;const{frame:de,rowIndex:ue,field:fe,calculatedValue:Se}=ie.value;if(Se)switch(z){case"numeric":return Se.numeric.toString();case"raw":return Se.numeric;case"time":return"";case"text":default:return(0,x.cN)(Se)}if(ue===void 0)return Z;if(z==="time"){const pe=de.fields.find(ye=>ye.type===C.PU.time);return pe?pe.values[ue]:void 0}const he=fe.values[ue];if(z==="raw")return he;const me=(fe.display??W())(he);switch(z){case"numeric":return me.numeric;case"text":return me.text;default:return(0,x.cN)(me)}}function w(Z,z,q,ie){const de=q?.__dataContext;if(!de||!z)return Z;const{frame:ue,rowIndex:fe}=de.value;if(fe===void 0||z===void 0)return Z;const Se={name:ue.name,refId:ue.refId,fields:(0,O.F)({frame:ue,rowIndex:fe})},he=g(z)(Se)??"";return p(he,ie)}let U;function W(){return U||(U=(0,R.J)()),U}function V(Z,z,q,ie){const de=q?.__dataContext;if(!de||z!=="name")return Z;const{frame:ue,frameIndex:fe}=de.value,Se=(0,L.Ri)(ue,fe);return p(Se,ie)}function _(Z,z,q,ie){const de=q?.__dataContext;if(!de||z===void 0||z==="")return Z;const{frame:ue,field:fe,data:Se}=de.value,he=F(fe,ue,Se),ce=g(z)(he)??"";return p(ce,ie)}const H={__value:K,__data:w,__series:V,__field:_,[E.c.includeVars]:G,[E.c.keepTime]:j,__timezone:Y};function G(Z,z,q){const ie=(0,A.z)(q);return S.kM.toUrlParams(ie)}function j(){return S.kM.toUrlParams((0,M.jG)().timeRangeForUrl())}function Y(){const Z=(0,T.O)({timeZone:(0,M.jG)().timeModel?.getTimezone()});return Z==="browser"?D().tz.guess():Z}const oe={getFilteredVariables:h.bZ,getVariables:h.UN,getVariableWithName:h._2};class se{constructor(z=oe){this.dependencies=z,this.regex=u.SY,this.index={},this.grafanaVariables=new Map,this.timeRange=null,this._adhocFiltersDeprecationWarningLogged=new Map,this._variables=[]}init(z,q){this._variables=z,this.timeRange=q,this.updateIndex()}get variables(){return(0,a.l)("template_srv.ts","variables","getVariables"),this.getVariables()}getVariables(){return window.__grafanaSceneContext?(0,d.E)(window.__grafanaSceneContext):this.dependencies.getVariables()}updateIndex(){const z=q=>q||q==="";if(this.index=this._variables.reduce((q,ie)=>(ie.current&&(ie.current.isNone||z(ie.current.value))&&(q[ie.name]=ie),q),{}),this.timeRange){const q=this.timeRange.from.valueOf().toString(),ie=this.timeRange.to.valueOf().toString();this.index={...this.index,__from:{current:{value:q,text:q}},__to:{current:{value:ie,text:ie}}}}}updateTimeRange(z){this.timeRange=z,this.updateIndex()}variableInitialized(z){this.index[z.name]=z}getAdhocFilters(z,q){let ie=[],de=(0,o.l)().getInstanceSettings(z);if(!de)return[];!q&&!this._adhocFiltersDeprecationWarningLogged.get(de.type)&&((0,a.l)(`DataSource ${de.type}`,"templateSrv.getAdhocFilters","filters property on the request (DataQueryRequest). Or if this is called from interpolateVariablesInQueries or applyTemplateVariables it is passed as a new argument"),this._adhocFiltersDeprecationWarningLogged.set(de.type,!0));for(const ue of this.getAdHocVariables()){const fe=ue.datasource?.uid;(fe===de.uid||fe?.indexOf("$")===0&&this.replace(fe)===de.uid)&&(ie=ie.concat(ue.filters))}return ie}setGrafanaVariable(z,q){this.grafanaVariables.set(z,q)}setGlobalVariable(z,q){(0,a.l)("template_srv.ts","setGlobalVariable",""),this.index={...this.index,[z]:{current:q}}}getVariableName(z){this.regex.lastIndex=0;const q=this.regex.exec(z);return q?q.slice(1).find(de=>de!==void 0):null}containsTemplate(z){if(!z)return!1;const q=this.getVariableName(z),ie=q&&this.getVariableAtIndex(q);return ie!=null}variableExists(z){return(0,a.l)("template_srv.ts","variableExists","containsTemplate"),this.containsTemplate(z)}highlightVariablesAsHtml(z){return!z||!(0,n.isString)(z)?z:(z=(0,n.escape)(z),this._replaceWithVariableRegex(z,void 0,(q,ie)=>this.getVariableAtIndex(ie)?'<span class="template-variable">'+q+"</span>":q))}getAllValue(z){if(z.allValue)return z.allValue;const q=[];for(let ie=1;ie<z.options.length;ie++)q.push(z.options[ie].value);return q}getVariableValue(z,q){return q?g(q)(z.value):z.value}getVariableText(z,q){return z.value===q||typeof q!="string"?z.text:q}replace(z,q,ie,de){if(q&&q.__sceneObject){const ue=q.__sceneObject.value.valueOf();return i.jh.interpolate(ue,z,q,ie,de)}return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?i.jh.interpolate(window.__grafanaSceneContext,z,q,ie,de):z?(this.regex.lastIndex=0,this._replaceWithVariableRegex(z,ie,(ue,fe,Se,he)=>{const ce=this._evaluateVariableExpression(ue,fe,Se,he,q);return de&&de.push({match:ue,variableName:fe,fieldPath:Se,format:he,value:ce,found:ce!==ue}),ce})):z??""}_evaluateVariableExpression(z,q,ie,de,ue){const fe=this.getVariableAtIndex(q),Se=ue?.[q];if(Se){const pe=this.getVariableValue(Se,ie),ye=this.getVariableText(Se,pe);if(pe!=null)return p(pe,de,fe,ye)}if(!fe){const pe=H[q];return pe?pe(z,ie,ue,de):z}if(de===f.$m.QueryParam||(0,s.EW)(fe)){const pe=l.B.get(fe.type).getValueForUrl(fe),ye=(0,s.EW)(fe)?fe.id:fe.current.text;return p(pe,de,fe,ye)}const he=this.grafanaVariables.get(fe.current.value);if(he)return p(he,de,fe);let ce=fe.current.value,me=fe.current.text;if(this.isAllValue(ce)&&(ce=this.getAllValue(fe),me=m.Zm,fe.allValue&&de!==f.$m.Text&&de!==f.$m.PercentEncode))return this.replace(ce);if(ie){const pe=this.getVariableValue({value:ce,text:me},ie);if(pe!=null)return p(pe,de,fe,me)}return p(ce,de,fe,me)}_replaceWithVariableRegex(z,q,ie){return this.regex.lastIndex=0,z.replace(this.regex,(de,ue,fe,Se,he,ce,me)=>ie(de,ue||fe||he,ce,Se||me||q))}isAllValue(z){return z===m.To||Array.isArray(z)&&z[0]===m.To}replaceWithText(z,q){return(0,a.l)("template_srv.ts","replaceWithText()","replace(), and specify the :text format"),this.replace(z,q,"text")}getVariableAtIndex(z){if(z)return this.index[z]?this.index[z]:this.dependencies.getVariableWithName(z)}getAdHocVariables(){return this.dependencies.getFilteredVariables(s.EW)}}const ne=new se;(0,r.d)(ne);const ee=()=>ne},3817:(Q,I,e)=>{"use strict";e.d(I,{v:()=>w});var n=e(4200),a=e(16401);function o({title:U,unit:W}){return a.d0.timeseries().setTitle(U).setUnit(W).setOption("legend",{showLegend:!1}).setCustomFieldConfig("fillOpacity",9)}function r({description:U,mainQueryExpr:W,breakdownQueryExpr:V,unit:_}){const H={title:`${n.Rp}`,unit:_},G={refId:"A",expr:W,legendFormat:U},j={...H,title:U,queries:[G],variant:"main",vizBuilder:()=>o({...j})},Y={...j,title:`${n.Rp}`,queries:[{...G,legendFormat:U}],vizBuilder:()=>o(Y),variant:"preview"},oe={...H,queries:[{refId:"A",expr:V,legendFormat:`{{${n.aZ}}}`}],vizBuilder:()=>o(oe),variant:"breakdown"};return{preview:Y,main:j,breakdown:oe,variants:[]}}const i=`${n.Rp}${n.ui}`,f=`rate(${i}[$__rate_interval])`;function d(U){return U?f:i}const l={avg:"average",sum:"overall"};function m(U){return l[U]||U}function s({agg:U,rate:W,unit:V}){const _=d(W),H=W?`${m(U)} per-second rate`:`${m(U)}`,G=`${n.Rp} (${H})`,j=`${U}(${_})`,Y=`${U}(${_})by(${n.aZ})`;return r({description:G,mainQueryExpr:j,breakdownQueryExpr:Y,unit:V})}const h="short";function u(U){return U&&b[U]||h}const b={bytes:"bytes",seconds:"s"},g={bytes:"Bps",seconds:"short"},P="cps";function c(U){return U&&g[U]||P}const y=new Set(["count","total"]),p=new Set(["sum","bucket"]),v={count:"sum",total:"sum"};function D(U){return U==="total"}function E(U){const W=U.at(-1);if(W==null||p.has(W))throw new Error(`This function does not support a metric suffix of "${W}"`);const V=y.has(W),_=v[W]||"avg",H=D(W)?U.at(-2):W,G=V?c(H):u(H);return{agg:_,unit:G,rate:V}}function S(U){const W=E(U);return s(W)}const T={generator:S};var M=e(52995);function A({title:U,unit:W}){return a.d0.heatmap().setTitle(U).setUnit(W).setOption("calculate",!1).setOption("color",{mode:M.P7.Scheme,exponent:.5,scheme:"Spectral",steps:32,reverse:!1})}function x({title:U,unit:W}){return a.d0.timeseries().setTitle(U).setUnit(W).setCustomFieldConfig("fillOpacity",9)}function C(U){const W=`${n.Rp}`,V=U.at(-2),_=u(V),H={title:W,unit:_},G={...H,variant:"p50",queries:[N(50)],vizBuilder:()=>o(G)},j={...H,variant:"p50",queries:[N(50,[n.aZ])],vizBuilder:()=>o(j)},Y={...H,variant:"percentiles",queries:[99,90,50].map(se=>N(se)),vizBuilder:()=>x(Y)},oe={...H,variant:"heatmap",queries:[L()],vizBuilder:()=>A(oe)};return{preview:G,main:Y,variants:[Y,oe],breakdown:j}}const O=`rate(${n.Rp}${n.ui}[$__rate_interval])`;function R(U=[]){return`sum by(${["le",...U].join(", ")}) (${O})`}function L(U=[]){return{refId:"Heatmap",expr:R(U),format:"heatmap"}}function N(U,W=[]){const V=U/100;let _=`${U}th Percentile`;return W[0]&&(_=`{{${W[0]}}}`),{refId:`Percentile${U}`,expr:`histogram_quantile(${V}, ${R(W)})`,legendFormat:_}}function F(U){if(U.at(-1)!=="sum")throw new Error('createSummaryQueryDefs is only to be used for metrics that end in "_sum"');const V=U.at(-2),_=u(V),G=d(!0),j=U.slice(0,-1).join("_"),Y=ee(`sum(${G})`),oe=ee(`sum(${G})by(${n.aZ})`),ne=`${j} (average)`;function ee(Z){const z=Z.replace(n.Rp,`${j}_sum`),q=Z.replace(n.Rp,`${j}_count`);return`${z}/${q}`}return r({description:ne,mainQueryExpr:Y,breakdownQueryExpr:oe,unit:_})}const K={sum:F,bucket:C};function B(U){return U&&K[U]||T.generator}function w(U){const W=U.split("_"),V=W.at(-1),_=B(V);if(!_)throw new Error(`Unable to generate queries for metric "${U}" due to issues with derived suffix "${V}"`);return _(W)}},56833:(Q,I,e)=>{"use strict";e.d(I,{b:()=>E,B:()=>S});var n=e(32196),a=e(96540),o=e(76885),r=e(12470),i=e(12131),f=e(16401),d=e(40845),l=e(15292),m=e(83122),s=e(27746),h=e(40588);class u extends f.Bs{constructor(C){super({stickyMainGraph:C.stickyMainGraph??!0,isOpen:C.isOpen??!1}),this.onToggleStickyMainGraph=()=>{const O=!this.state.stickyMainGraph;(0,h.z)("settings_changed",{stickyMainGraph:O}),this.setState({stickyMainGraph:O})},this.onToggleOpen=O=>{this.setState({isOpen:O})}}static{this.Component=({model:C})=>{const{stickyMainGraph:O,isOpen:R}=C.useState(),L=(0,d.of)(b),N=()=>a.createElement("div",{className:L.popover,onClick:F=>F.stopPropagation()},a.createElement("div",{className:L.heading},"Settings"),a.createElement("div",{className:L.options},a.createElement("div",null,"Always keep selected metric graph in-view"),a.createElement(l.d,{value:O,onChange:C.onToggleStickyMainGraph})));return a.createElement(m.m,{overlay:N,placement:"bottom",onVisibleChange:C.onToggleOpen},a.createElement(s.I,{icon:"cog",variant:"canvas",isOpen:R}))}}}function b(x){return{popover:(0,n.css)({display:"flex",padding:x.spacing(2),flexDirection:"column",background:x.colors.background.primary,boxShadow:x.shadows.z3,borderRadius:x.shape.borderRadius(),border:`1px solid ${x.colors.border.weak}`,zIndex:1,marginRight:x.spacing(2)}),heading:(0,n.css)({fontWeight:x.typography.fontWeightMedium,paddingBottom:x.spacing(2)}),options:(0,n.css)({display:"grid",gridTemplateColumns:"1fr 50px",rowGap:x.spacing(1),columnGap:x.spacing(2)})}}var g=e(13054),P=e(75176),c=e(35015),y=e(90623),p=e(74764),v=e(88434),D=e(4200);class E extends f.Bs{constructor(C){super({$timeRange:C.$timeRange??new f.JZ({}),$variables:C.$variables??T(C.initialDS,C.metric,C.initialFilters),controls:C.controls??[new f.K8({layout:"vertical"}),new f.N0,new f.KE({}),new f.WM({})],history:C.history??new g.L({}),settings:C.settings??new u({}),createdAt:C.createdAt??new Date().getTime(),...C}),this._urlSync=new f.So(this,{keys:["metric"]}),this._variableDependency=new f.Sh(this,{variableNames:[D.EY],onReferencedVariableValueChanged:O=>{const{name:R}=O.state;R===D.EY&&this.datasourceHelper.reset()}}),this._addingFilterWithoutReportingInteraction=!1,this.datasourceHelper=new v.q(this),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.topScene||this.setState({topScene:S(this.state.metric)}),this.subscribeToEvent(D.OO,this._handleMetricSelectedEvent.bind(this));const C=f.jh.lookupVariable(D.Ao,this);C instanceof f.H9&&this._subs.add(C?.subscribeToState((L,N)=>{this._addingFilterWithoutReportingInteraction||(0,h.h)(L.filters,N.filters)}));const O=this.state.history.state.steps[this.state.history.state.currentStep]?.trailState;O&&this.restoreFromHistoryStep(O),this.enableUrlSync();const R=()=>(0,p._)().setRecentTrail(this);return window.addEventListener("unload",R),()=>{this.disableUrlSync(),this.state.embedded||R(),window.removeEventListener("unload",R)}}enableUrlSync(){this.state.embedded||(0,f.Is)().initSync(this)}disableUrlSync(){this.state.embedded||(0,f.Is)().cleanUp(this)}addFilterWithoutReportingInteraction(C){const O=f.jh.lookupVariable("filters",this);O instanceof f.H9&&(this._addingFilterWithoutReportingInteraction=!0,O.setState({filters:[...O.state.filters,C]}),this._addingFilterWithoutReportingInteraction=!1)}getMetricMetadata(C){return this.datasourceHelper.getMetricMetadata(C)}getCurrentMetricMetadata(){return this.getMetricMetadata(this.state.metric)}restoreFromHistoryStep(C){this.disableUrlSync(),!C.topScene&&!C.metric&&(C.topScene=new c.t({})),this.setState(f.Go.cloneSceneObjectState(C,{history:this.state.history,metric:C.metric?C.metric:void 0}));const O=(0,f.Is)().getUrlState(this),R=o.kM.renderUrl(i.Ny.getLocation().pathname,O);i.Ny.replace(R),this.enableUrlSync()}_handleMetricSelectedEvent(C){this.setState(this.getSceneUpdatesForNewMetricValue(C.payload));const O=f.jh.lookupVariable(D.Ao,this);O instanceof f.H9&&O.setState({baseFilters:A(C.payload)})}getSceneUpdatesForNewMetricValue(C){const O={};return O.metric=C,O.topScene=S(C),O}getUrlState(){return{metric:this.state.metric}}updateFromUrl(C){const O={};typeof C.metric=="string"?this.state.metric!==C.metric&&Object.assign(O,this.getSceneUpdatesForNewMetricValue(C.metric)):C.metric==null&&(O.metric=void 0,O.topScene=new c.t({})),this.setState(O)}static{this.Component=({model:C})=>{const{controls:O,topScene:R,history:L,settings:N}=C.useState(),F=(0,d.of)(M),K=(0,p._)().recent.length<2;return a.createElement("div",{className:F.container},K&&a.createElement(y.p,null),a.createElement(L.Component,{model:L}),O&&a.createElement("div",{className:F.controls},O.map(B=>a.createElement(B.Component,{key:B.state.key,model:B})),a.createElement(N.Component,{model:N})),a.createElement("div",{className:F.body},R&&a.createElement(R.Component,{model:R})))}}}function S(x){return x?new P.R({metric:x}):new c.t({})}function T(x,C,O){return new f.Pj({variables:[new f.mI({name:D.EY,label:"Data source",description:"Only prometheus data sources are supported",value:x,pluginId:"prometheus"}),new f.H9({name:D.Ao,addFilterButtonText:"Add label",datasource:D.GH,hide:r.zL.hideLabel,layout:"vertical",filters:O??[],baseFilters:A(C)})]})}function M(x){return{container:(0,n.css)({flexGrow:1,display:"flex",gap:x.spacing(1),minHeight:"100%",flexDirection:"column"}),body:(0,n.css)({flexGrow:1,display:"flex",flexDirection:"column"}),controls:(0,n.css)({display:"flex",gap:x.spacing(1),padding:x.spacing(1,0),alignItems:"flex-end",flexWrap:"wrap",position:"sticky",background:x.isDark?x.colors.background.canvas:x.colors.background.primary,zIndex:x.zIndex.navbarFixed,top:0})}}function A(x){return x?[{key:"__name__",operator:"=",value:x}]:[]}},13054:(Q,I,e)=>{"use strict";e.d(I,{L:()=>u,h:()=>h});var n=e(32196),a=e(96540),o=e(16401),r=e(67061),i=e(40845),f=e(56034),d=e(56833),l=e(40588),m=e(4200),s=e(51080);function h(c){return"currentStep"in c&&"steps"in c}class u extends o.Bs{constructor(y){super({steps:y.steps??[],currentStep:y.currentStep??0}),this.stepTransitionInProgress=!1,this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const y=(0,s.kj)(this);if(this.state.steps.length===0&&(this.addTrailStep(y,"start"),y.state.metric)){const{metric:p,...v}=y.state;v.topScene=(0,d.B)(void 0),this.state.steps[0].trailState=v,this.addTrailStep(y,"metric")}y.subscribeToState((p,v)=>{p.metric!==v.metric&&(this.state.steps.length===1&&(this.state.steps[0].trailState=o.Go.cloneSceneObjectState(v,{history:this})),(p.metric||v.metric)&&this.addTrailStep(y,"metric"))}),y.subscribeToEvent(o.oh,p=>{p.payload.state.name===m.Ao&&this.addTrailStep(y,"filters")}),y.subscribeToEvent(o.bZ,p=>{if(p.payload.changedObject instanceof o.JZ){const{prevState:v,newState:D}=p.payload;if((0,s.iG)(v)&&(0,s.iG)(D)&&v.from===D.from&&v.to===D.to)return;this.addTrailStep(y,"time")}})}addTrailStep(y,p){if(this.stepTransitionInProgress)return;const v=this.state.steps.length,D=p==="start"?-1:this.state.currentStep;this.setState({currentStep:v,steps:[...this.state.steps,{description:"Test",type:p,trailState:o.Go.cloneSceneObjectState(y.state,{history:this}),parentIndex:D}]})}goBackToStep(y){if(y===this.state.currentStep)return;const p=this.state.steps[y],v=p.type==="metric"&&p.trailState.metric===void 0?"metric-clear":p.type;(0,l.z)("history_step_clicked",{type:v,step:y,numberOfSteps:this.state.steps.length}),this.stepTransitionInProgress=!0,this.setState({currentStep:y}),(0,s.kj)(this).restoreFromHistoryStep(p.trailState),this.stepTransitionInProgress=!1}renderStepTooltip(y){return a.createElement(r.B,{direction:"column"},a.createElement("div",null,y.type),y.type==="metric"&&a.createElement("div",null,y.trailState.metric||"Select new metric"))}static{this.Component=({model:y})=>{const{steps:p,currentStep:v}=y.useState(),D=(0,i.of)(b),{ancestry:E,alternatePredecessorStyle:S}=(0,a.useMemo)(()=>{const T=new Set;let M=v;for(;M>=0;){const x=p[M];if(!x)break;T.add(M),M=x.parentIndex}const A=new Map;return T.forEach(x=>{const C=p[x].parentIndex;C+1!==x&&A.set(x,P(x,C))}),{ancestry:T,alternatePredecessorStyle:A}},[v,p]);return a.createElement("div",{className:D.container},a.createElement("div",{className:D.heading},"History"),p.map((T,M)=>{let A=T.type;return A==="metric"&&T.trailState.metric===void 0&&(A="start"),a.createElement(f.m,{content:()=>y.renderStepTooltip(T),key:M},a.createElement("button",{className:(0,n.cx)(D.step,D.stepTypes[A],v===M?D.stepSelected:"",S.get(M)??"",M!==T.parentIndex+1?D.stepOmitsDirectLeftLink:"",M===0?D.stepOmitsDirectLeftLink:"",E.has(M)?"":D.stepIsNotAncestorOfCurrent),onClick:()=>y.goBackToStep(M)}))}))}}}function b(c){const y=c.visualization;return{container:(0,n.css)({display:"flex",gap:10,alignItems:"center"}),heading:(0,n.css)({}),step:(0,n.css)({flexGrow:0,cursor:"pointer",border:"none",boxShadow:"none",padding:0,margin:0,width:8,height:8,opacity:.7,borderRadius:c.shape.radius.circle,background:c.colors.primary.main,position:"relative","&:hover":{opacity:1},"&:hover:before":{opacity:.7},"&:before":{content:'""',position:"absolute",width:10,height:2,left:-10,top:3,background:c.colors.primary.border,pointerEvents:"none"}}),stepSelected:(0,n.css)({"&:after":{content:'""',borderStyle:"solid",borderWidth:2,borderRadius:"50%",position:"absolute",width:16,height:16,left:-4,top:-4,boxShadow:`0px 0px 0px 2px inset ${c.colors.background.canvas}`}}),stepOmitsDirectLeftLink:(0,n.css)({"&:before":{background:"none"}}),stepIsNotAncestorOfCurrent:(0,n.css)({opacity:.2,"&:hover:before":{opacity:.2}}),stepTypes:{start:g(y.getColorByName("green")),filters:g(y.getColorByName("purple")),metric:g(y.getColorByName("orange")),time:g(c.colors.primary.main)}}}function g(c){return(0,n.css)({background:c,"&:before":{background:c,borderColor:c},"&:after":{borderColor:c}})}function P(c,y){const D=(c-y)*18;return(0,n.css)({"&:before":{content:'""',width:D+2,height:10,borderStyle:"solid",borderWidth:2,borderBottom:"none",borderTopLeftRadius:8,borderTopRightRadius:8,top:-10,left:3-D,background:"none"}})}},75176:(Q,I,e)=>{"use strict";e.d(I,{k:()=>xt,R:()=>Ze});var n=e(32196),a=e(96540),o=e(32264),r=e(16401),i=e(40845),f=e(90613),d=e(67061),l=e(27746),m=e(14578),s=e(55852),h=e(63021),u=e(40675),b=e(56034),g=e(87490),P=e(2543),c=e(11261),y=e(88575),p=e(13344),v=e(3817),D=e(77366),E=e(29413),S=e(94354),T=e(21594);function M({options:Le,value:re,onChange:X}){const le=(0,i.of)(A),be=(0,i.$j)(),[De,Te]=(0,a.useState)(0),[we,Ke]=(0,a.useState)(0),Ve=we>De,ht=(0,a.useRef)(null);return(0,D.w)({ref:ht,onResize:()=>{const gt=ht.current;gt&&Ke(gt.clientWidth)}}),(0,a.useEffect)(()=>{const{fontSize:gt}=be.typography,bt=Le.map(rt=>rt.label||rt.value||"").join(" "),St=(0,E.kD)(bt,gt).width;Te(St+32*Le.length)},[Le,be]),a.createElement("div",{ref:ht},Ve?a.createElement(S.z,{options:Le,value:re,onChange:X}):a.createElement(T.l6,{options:Le,value:re,onChange:gt=>X(gt.value),className:le.select}))}function A(Le){return{select:(0,n.css)({maxWidth:Le.spacing(16)})}}var x=e(69096),C=e(40588),O=e(4200),R=e(51080);class L extends r.Bs{constructor(){super(...arguments),this.onClick=()=>{if(!(r.jh.lookupVariable("filters",this)instanceof r.H9))return;const X=this.state.frame.fields[1]?.labels??{};if(Object.keys(X).length!==1)return;const le=Object.keys(X)[0];(0,C.z)("label_filter_changed",{label:le,action:"added",cause:"breakdown"});const be=(0,R.kj)(this),De={key:le,operator:"=",value:X[le]};be.addFilterWithoutReportingInteraction(De)}}static{this.Component=({model:re})=>{const le=re.useState().frame.fields[1]?.labels||{};return Object.keys(le).length!==0?a.createElement(s.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:re.onClick},"Add to filters"):null}}}var N=e(39070);function F(Le,re){const X=r.jh.lookupVariable(O.Ao,Le),le=[];if(!(X instanceof r.H9))return[];const be=X.state.filters;for(const De of re.getOptionsForSelect()){const Te=be.find(we=>we.key===De.value);De.label!=="le"&&(Te||le.push({label:De.label,value:String(De.value)}))}return le}function K(Le,re){const X=sceneGraph.findObject(Le,le=>le instanceof re);return X instanceof re?X:null}function B(Le,re){function X(be){return be instanceof re}return r.jh.findAllObjects(Le,X).filter(X)}class w extends r.Bs{constructor(re){super(re),this.addActivationHandler(()=>{const X=r.jh.getData(this);this._subs.add(X.subscribeToState((le,be)=>{if(le.data===void 0)return;const De=le.data;le.data!==void 0&&le.data?.state!==be.data?.state&&B(this,r.Zv).forEach(Te=>{Te.setState({data:{...Te.state.data,state:De.state}})}),De.state===N.Gu.Done&&this.performRepeat(De)})),X.state.data&&this.performRepeat(X.state.data)})}performRepeat(re){const X=[];for(let le=0;le<re.series.length;le++){const be=re.series[le];if(be.length<=1)continue;const De=this.state.getLayoutChild(re,be,le);X.push(De)}this.state.body.setState({children:X}),this.setState({body:this.state.body})}static{this.Component=({model:re})=>{const{body:X}=re.useState(),{children:le}=X.useState(),Te=r.jh.getData(re).useState()?.data,we=Te?.state==="Loading"&&le.length===0,Ke=Te?.state===N.Gu.Error?"Failed to load data.":void 0,Ve=!we&&le.length===0&&!Ke?"There is no data available. Try adjusting your filters, time range, or selecting a different label.":void 0;return a.createElement(x.O,{blockingMessage:Ve,error:Ke,isLoading:we},a.createElement(X.Component,{model:X}))}}}class U extends r.Bs{constructor(){super(...arguments),this.onLayoutChange=re=>{(0,C.z)("breakdown_layout_changed",{layout:re}),this.getMetricScene().setState({layout:re})}}getMetricScene(){return r.jh.getAncestor(this,Ze)}Selector({model:re}){const{options:X}=re.useState(),le=re.useActiveLayout();return a.createElement(y.D,{label:"View"},a.createElement(S.z,{options:X,value:le,onChange:re.onLayoutChange}))}useActiveLayout(){const{options:re}=this.useState(),{layout:X}=this.getMetricScene().useState();return re.map(be=>be.value).includes(X)?X:re[0].value}static{this.Component=({model:re})=>{const{layouts:X,options:le}=re.useState(),be=re.useActiveLayout(),De=le.findIndex(we=>we.value===be);if(De===-1)return null;const Te=X[De];return a.createElement(Te.Component,{model:Te})}}}var W=e(52622);const V=r.zd.timeseries().setOption("tooltip",{mode:W.$N.Multi,sort:W.xB.Descending}).setOption("legend",{showLegend:!1}).build();var _=e(65463);class H extends _.x{static{this.type="selected-metric-query-results-event"}}const G=Le=>{const re=r.jh.getAncestor(Le,Y);B(Le,r.Eb).forEach(be=>{be.isActive?X(be.state.$data):be.addActivationHandler(()=>{X(be.state.$data)})}),B(Le,r.Eb).forEach(be=>X(be.state.$data));function X(be){be&&(be.isActive||be.addActivationHandler(()=>{X(be)}),be.state.data&&re.reportBreakdownPanelData(be.state.data),be.subscribeToState(({data:De},Te)=>{re.reportBreakdownPanelData(De)}))}const le=re.subscribeToEvent(H,be=>{if(!Le.isActive){le.unsubscribe();return}const De=r.No.timeseries().setCustomFieldConfig("axisSoftMin",be.payload.min).setCustomFieldConfig("axisSoftMax",be.payload.max).build();B(Le,r.Eb).forEach(Te=>{function we(){Te.onFieldConfigChange(De)}Te.isActive?we():Te.addActivationHandler(we)})})},j=60;class Y extends r.Bs{constructor(re){super({labels:re.labels??[],...re}),this._variableDependency=new r.Sh(this,{variableNames:[O.Ao],onReferencedVariableValueChanged:this.onReferencedVariableValueChanged.bind(this)}),this._triggerAxisChangedEvent=(0,P.throttle)(()=>{const{breakdownPanelMinValue:X,breakdownPanelMaxValue:le}=this;X!==void 0&&le!==void 0&&this.publishEvent(new H({min:X,max:le}))},1e3),this.onChange=X=>{if(!X)return;(0,C.z)("label_selected",{label:X,cause:"selector"}),this.getVariable().changeValueTo(X)},this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const re=this.getVariable();re.subscribeToState((De,Te)=>{(De.options!==Te.options||De.value!==Te.value||De.loading!==Te.loading)&&this.updateBody(re)});const X=r.jh.getAncestor(this,Ze),le=X.state.metric;this._query=(0,v.v)(le).breakdown,(0,R.kj)(this).state.$timeRange?.subscribeToState(()=>{this.clearBreakdownPanelAxisValues()}),X.subscribeToState(({layout:De},Te)=>{De!==Te.layout&&this.clearBreakdownPanelAxisValues()}),this.updateBody(re)}reportBreakdownPanelData(re){if(!re)return;let X=this.breakdownPanelMinValue,le=this.breakdownPanelMaxValue;re.series.forEach(be=>{be.fields.forEach(De=>{if(De.type!==c.PU.number)return;const Te=De.values.filter(P.isNumber),we=(0,P.max)(Te),Ke=(0,P.min)(Te);le=(0,P.max)([le,we].filter(P.isNumber)),X=(0,P.min)([X,Ke].filter(P.isNumber))})}),!(le===void 0||X===void 0||!Number.isFinite(le+X))&&(this.breakdownPanelMaxValue===le&&this.breakdownPanelMinValue===X||(this.breakdownPanelMaxValue=le,this.breakdownPanelMinValue=X,this._triggerAxisChangedEvent()))}clearBreakdownPanelAxisValues(){this.breakdownPanelMaxValue=void 0,this.breakdownPanelMinValue=void 0}getVariable(){const re=r.jh.lookupVariable(O.yr,this);if(!(re instanceof r.fS))throw new Error("Group by variable not found");return re}onReferencedVariableValueChanged(){const re=this.getVariable();re.changeValueTo(p.To),this.updateBody(re)}updateBody(re){const X=F(this,re),le={loading:re.state.loading,value:String(re.state.value),labels:X,error:re.state.error,blockingMessage:void 0};!re.state.loading&&re.state.options.length?le.body=re.hasAllValue()?se(X,this._query):ee(this._query):re.state.loading||(le.body=void 0,le.blockingMessage="Unable to retrieve label options for currently selected metric."),this.clearBreakdownPanelAxisValues(),this.setState(le)}static{this.Component=({model:re})=>{const{labels:X,body:le,loading:be,value:De,blockingMessage:Te}=re.useState(),we=(0,i.of)(oe);return a.createElement("div",{className:we.container},a.createElement(x.O,{isLoading:be,blockingMessage:Te},a.createElement("div",{className:we.controls},!be&&X.length&&a.createElement("div",{className:we.controlsLeft},a.createElement(y.D,{label:"By label"},a.createElement(M,{options:X,value:De,onChange:re.onChange}))),le instanceof U&&a.createElement("div",{className:we.controlsRight},a.createElement(le.Selector,{model:le}))),a.createElement("div",{className:we.content},le&&a.createElement(le.Component,{model:le}))))}}}function oe(Le){return{container:(0,n.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column"}),content:(0,n.css)({flexGrow:1,display:"flex",paddingTop:Le.spacing(0)}),controls:(0,n.css)({flexGrow:0,display:"flex",alignItems:"top",gap:Le.spacing(2)}),controlsRight:(0,n.css)({flexGrow:0,display:"flex",justifyContent:"flex-end"}),controlsLeft:(0,n.css)({display:"flex",justifyContent:"flex-left",justifyItems:"left",width:"100%",flexDirection:"column"})}}function se(Le,re){const X=[];for(const le of Le){if(le.value===p.To)continue;if(X.length===j)break;const be=re.queries[0].expr.replaceAll(O.aZ,String(le.value)),De=re.unit,Te=r.d0.timeseries().setTitle(le.label).setData(new r.dt({maxDataPoints:250,datasource:O.GH,queries:[{refId:"A",expr:be,legendFormat:`{{${le.label}}}`}]})).setHeaderActions(new q({labelName:String(le.value)})).setUnit(De).setBehaviors([de]).build();Te.addActivationHandler(()=>{Te.onOptionsChange(V)}),X.push(new r.xK({$behaviors:[G],body:Te}))}return new U({options:[{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],layouts:[new r.gF({templateColumns:ne,autoRows:"200px",children:X,isLazy:!0}),new r.gF({templateColumns:"1fr",autoRows:"200px",children:X.map(le=>le.clone()),isLazy:!0})]})}const ne="repeat(auto-fit, minmax(400px, 1fr))";function ee(Le){const re=Le.unit;function X(le,be,De){const Te=Le.vizBuilder().setTitle(Z(be)).setData(new r.Zv({data:{...le,series:[be]}})).setColor({mode:"fixed",fixedColor:(0,R.Vy)(De)}).setHeaderActions(new L({frame:be})).setUnit(re).build(),we=be.length<=1,Ke=new r.xK({$behaviors:[G],body:Te,isHidden:we});return Te.addActivationHandler(()=>{Te.onOptionsChange(V)}),Ke}return new U({$data:new r.dt({datasource:O.GH,maxDataPoints:300,queries:Le.queries}),options:[{value:"single",label:"Single"},{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],layouts:[new r.G1({direction:"column",children:[new r.vA({minHeight:300,body:r.d0.timeseries().setTitle("$metric").build()})]}),new w({body:new r.gF({templateColumns:ne,autoRows:"200px",children:[]}),getLayoutChild:X}),new w({body:new r.gF({templateColumns:"1fr",autoRows:"200px",children:[]}),getLayoutChild:X})]})}function Z(Le){const re=Le.fields[1]?.labels||{},X=Object.keys(re);return X.length===0?"<unspecified>":re[X[0]]}function z(){return new Y({})}class q extends r.Bs{constructor(){super(...arguments),this.onClick=()=>{const re=this.state.labelName;(0,C.z)("label_selected",{label:re,cause:"breakdown_panel"}),ie(this).onChange(re)}}static{this.Component=({model:re})=>a.createElement(s.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:re.onClick},"Select")}}function ie(Le){if(Le instanceof Y)return Le;if(Le.parent)return ie(Le.parent);throw new Error("Unable to find breakdown scene")}function de(Le){Le.state.$data?.subscribeToState((re,X)=>{const le=re.data?.request?.targets[0];if(ue(le)){const{legendFormat:be}=le,De=be.slice(2,-2);re.data?.series.forEach(Te=>{if(!Te.fields[1].labels?.[De]){const we=Te.fields[1].labels;we&&(we[De]=`<unspecified ${De}>`)}})}})}function ue(Le){return Le!==void 0&&"legendFormat"in Le&&typeof Le.legendFormat=="string"}var fe=e(94753),Se=e(72109);class he extends r.Bs{constructor(re){super({...re}),this._variableDependency=new r.Sh(this,{variableNames:[O.gR],onReferencedVariableValueChanged:this.onReferencedVariableValueChanged.bind(this)}),this.addActivationHandler(this._onActivate.bind(this))}getVariable(){const re=r.jh.lookupVariable(O.yr,this);if(!(re instanceof r.fS))throw new Error("Group by variable not found");return re}_onActivate(){this.updateMetadata()}onReferencedVariableValueChanged(){this.updateMetadata()}async updateMetadata(){this.setState({metadataLoading:!0,metadata:void 0});const X=(0,R.aM)(this).state.metric,be=await(0,R.kj)(this).getMetricMetadata(X);this.setState({metadata:be,metadataLoading:!1})}static{this.Component=({model:re})=>{const{metadata:X,metadataLoading:le}=re.useState(),be=re.getVariable(),{loading:De}=be.useState(),Te=F(re,be).filter(we=>we.value!==p.To);return a.createElement(x.O,{isLoading:De||le},a.createElement(d.B,{gap:6},a.createElement(a.Fragment,null,a.createElement(d.B,{direction:"column",gap:.5},a.createElement(fe.E,{weight:"medium"},"Description"),a.createElement("div",{style:{maxWidth:360}},X?.help?a.createElement("div",null,X?.help):a.createElement("i",null,"No description available"))),a.createElement(d.B,{direction:"column",gap:.5},a.createElement(fe.E,{weight:"medium"},"Type"),X?.type?a.createElement("div",null,X?.type):a.createElement("i",null,"Unknown")),a.createElement(d.B,{direction:"column",gap:.5},a.createElement(fe.E,{weight:"medium"},"Unit"),X?.unit?a.createElement("div",null,X?.unit):a.createElement("i",null,"Unknown")),a.createElement(d.B,{direction:"column",gap:.5},a.createElement(fe.E,{weight:"medium"},"Labels"),Te.length===0&&"Unable to fetch labels.",Te.map(we=>a.createElement(Se.Y,{key:we.label,href:`#View breakdown for ${we.label}`,title:`View breakdown for ${we.label}`,onClick:Ke=>{Ke.preventDefault(),Ke.stopPropagation(),r.jh.getAncestor(re,Ze).setActionView("breakdown");const Ve=r.jh.lookupVariable(O.yr,re);return Ve instanceof r.fS&&we.label!=null&&((0,C.z)("label_selected",{label:we.label,cause:"overview_link"}),Ve.setState({value:we.value})),!1}},we.label))))))}}}function ce(){return new he({})}var me=e(35015);function pe(){return new me.t({})}var ye=e(94624);class Pe extends r.Bs{constructor(re){super(re),this.onChangeQuery=X=>{const le=(0,R.aM)(this),be=le.state.autoQuery.variants.find(De=>De.variant===X);this.setState({panel:this.getVizPanelFor(be)}),le.setState({queryDef:be})},this.addActivationHandler(this.onActivate.bind(this))}onActivate(){if(!this.state.panel){const{autoQuery:re}=(0,R.aM)(this).state;this.setState({panel:this.getVizPanelFor(re.main)})}}getQuerySelector(re){const{autoQuery:X}=(0,R.aM)(this).state;if(X.variants.length===0)return;const le=X.variants.map(be=>({label:be.variant,value:be.variant}));return a.createElement(S.z,{size:"sm",options:le,value:re.variant,onChange:this.onChangeQuery})}getVizPanelFor(re){return re.vizBuilder().setData(new r.dt({datasource:O.GH,maxDataPoints:500,queries:re.queries})).setHeaderActions(this.getQuerySelector(re)).build()}static{this.Component=({model:re})=>{const{panel:X}=re.useState();if(X)return a.createElement(X.Component,{model:X})}}}const Ie=280,Oe="40%";class Ne extends r.Bs{constructor(re){super({topView:re.topView??Ae(),...re})}static{this.Component=({model:re})=>{const{topView:X,selectedTab:le}=re.useState(),{stickyMainGraph:be}=(0,R.KE)(re).useState(),De=(0,i.of)(We);return a.createElement("div",{className:De.container},a.createElement("div",{className:be?De.sticky:De.nonSticky},a.createElement(X.Component,{model:X})),le&&a.createElement(le.Component,{model:le}))}}}function We(Le){return{container:(0,n.css)({display:"flex",flexDirection:"column",position:"relative"}),sticky:(0,n.css)({display:"flex",flexDirection:"row",background:Le.isLight?Le.colors.background.primary:Le.colors.background.canvas,position:"sticky",top:"70px",zIndex:10}),nonSticky:(0,n.css)({display:"flex",flexDirection:"row"})}}function Ae(){return new r.G1({direction:"column",$behaviors:[new r.Gg.K2({key:"metricCrosshairSync",sync:ye.y.Crosshair})],children:[new r.vA({minHeight:Ie,maxHeight:Oe,body:new Pe({})}),new r.vA({ySizing:"content",body:new xt({})})]})}const Ue=({trail:Le})=>{const[re,X]=(0,a.useState)("Copy url"),le=()=>{if(navigator.clipboard){(0,C.z)("selected_metric_action_clicked",{action:"share_url"});const De=(o.$.appUrl.endsWith("/")?o.$.appUrl.slice(0,-1):o.$.appUrl)+(0,R.xi)(Le);navigator.clipboard.writeText(De),X("Copied!"),setTimeout(()=>{X("Copy url")},2e3)}};return a.createElement(l.I,{variant:"canvas",icon:"share-alt",tooltip:re,onClick:le})};var Me=e(13054),$e=e(74764);function ke(Le){const re=()=>(0,$e._)().getBookmarkIndex(Le),X=re(),[le,be]=(0,a.useState)(X);(0,a.useEffect)(()=>{const Ke=Le.subscribeToEvent(r.bZ,({payload:{prevState:Ve,newState:ht}})=>{(0,Me.h)(Ve)&&(0,Me.h)(ht)&&ht.steps.length>Ve.steps.length&&be((0,$e._)().getBookmarkIndex(Le))});return()=>Ke.unsubscribe()},[Le]),X!==le&&be(X);const De=le!=null;return[De,()=>{if((0,C.z)("bookmark_changed",{action:De?"toggled_off":"toggled_on"}),De){let Ke=re();for(;Ke!=null;)(0,$e._)().removeBookmark(Ke),Ke=re()}else(0,$e._)().addBookmark(Le);be(re())}]}class Ze extends r.Bs{constructor(re){const X=re.autoQuery??(0,v.v)(re.metric);super({$variables:re.$variables??ft(re.metric),body:re.body??new Ne({}),autoQuery:X,queryDef:re.queryDef??X.main,layout:re.layout??"grid",...re}),this._urlSync=new r.So(this,{keys:["actionView","layout"]}),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.actionView===void 0&&this.setActionView("overview")}getUrlState(){return{actionView:this.state.actionView,layout:this.state.layout}}updateFromUrl(re){if(typeof re.actionView=="string"){if(this.state.actionView!==re.actionView){const X=ot.find(le=>le.value===re.actionView);X&&this.setActionView(X.value)}}else re.actionView===null&&this.setActionView(void 0);if(typeof re.layout=="string"){const X=re.layout;this.state.layout!==X&&this.setState({layout:X})}}setActionView(re){const{body:X}=this.state,le=ot.find(be=>be.value===re);le&&le.value!==this.state.actionView?(X.state.topView.state.children[0].setState({maxHeight:Ie}),X.setState({selectedTab:le.getScene()}),this.setState({actionView:le.value})):(X.state.topView.state.children[0].setState({maxHeight:Oe}),X.setState({selectedTab:void 0}),this.setState({actionView:void 0}))}static{this.Component=({model:re})=>{const{body:X}=re.useState();return a.createElement(X.Component,{model:X})}}}const ot=[{displayName:"Overview",value:"overview",getScene:ce},{displayName:"Breakdown",value:"breakdown",getScene:z},{displayName:"Related metrics",value:"related",getScene:pe,description:"Relevant metrics based on current label filters"}];class xt extends r.Bs{constructor(){super(...arguments),this.getLinkToExplore=async()=>{const re=r.jh.getAncestor(this,Ze),X=(0,R.kj)(this),le=(0,R.U4)(X),be=re.state.queryDef?.queries||[],De=r.jh.getTimeRange(this);return(0,g.Xe)({queries:be,dsRef:{uid:le},timeRange:De.state.value,scopedVars:{__sceneObject:{value:re}}})},this.openExploreLink=async()=>{(0,C.z)("selected_metric_action_clicked",{action:"open_in_explore"}),this.getLinkToExplore().then(re=>{const X=`${o.$.appSubUrl}${re}`;window.open(X,"_blank")})}}static{this.Component=({model:re})=>{const X=r.jh.getAncestor(re,Ze),le=(0,i.of)(ct),be=(0,R.kj)(re),[De,Te]=ke(be),{actionView:we}=X.useState();return a.createElement(f.a,{paddingY:1},a.createElement("div",{className:le.actions},a.createElement(d.B,{gap:1},a.createElement(l.I,{variant:"canvas",tooltip:"Remove existing metric and choose a new metric",onClick:()=>{(0,C.z)("selected_metric_action_clicked",{action:"unselect"}),be.publishEvent(new O.OO(void 0))}},"Select new metric"),a.createElement(l.I,{variant:"canvas",icon:"compass",tooltip:"Open in explore",onClick:re.openExploreLink}),a.createElement(Ue,{trail:be}),a.createElement(l.I,{variant:"canvas",icon:De?a.createElement(m.I,{name:"favorite",type:"mono",size:"lg"}):a.createElement(m.I,{name:"star",type:"default",size:"lg"}),tooltip:"Bookmark",onClick:Te}),be.state.embedded&&a.createElement(s.z9,{href:(0,R.xi)(be),variant:"secondary",onClick:()=>(0,C.z)("selected_metric_action_clicked",{action:"open_from_embedded"})},"Open"))),a.createElement(h.U,null,ot.map((Ke,Ve)=>{const ht=a.createElement(u.o,{key:Ve,label:Ke.displayName,active:we===Ke.value,onChangeTab:()=>{(0,C.z)("metric_action_view_changed",{view:Ke.value}),X.setActionView(Ke.value)}});return Ke.description?a.createElement(b.m,{key:Ve,content:Ke.description,placement:"bottom-start",theme:"info"},ht):ht})))}}}function ct(Le){return{actions:(0,n.css)({[Le.breakpoints.up(Le.breakpoints.values.md)]:{position:"absolute",right:0,top:16,zIndex:2}})}}function ft(Le){return new r.Pj({variables:[...(0,O.ym)(Le),new r.fS({name:O.yr,label:"Group by",datasource:O.GH,includeAll:!0,defaultToAll:!0,query:{query:`label_names(${O.Rp})`,refId:"A"},value:"",text:""})]})}},35015:(Q,I,e)=>{"use strict";e.d(I,{t:()=>K});var n=e(32196),a=e(2543),o=e(96540),r=e(12470),i=e(16401),f=e(79422),d=e(40845),l=e(88575),m=e(10354),s=e(14578),h=e(15292),u=e(42418),b=e(75176),g=e(69096),P=e(88434),c=e(40588),y=e(4200),p=e(51080),v=e(55852);class D extends i.Bs{constructor(){super(...arguments),this.onClick=()=>{this.publishEvent(new y.OO(this.state.metric),!0)}}static{this.Component=({model:G})=>{const{title:j}=G.useState();return o.createElement(v.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:G.onClick},j)}}}var E=e(3817),S=e(39070),T=e(11261);function M(H){return G=>{const j=i.jh.getData(G);j&&j.subscribeToState(Y=>{if(Y.data?.state===S.Gu.Loading||Y.data?.state===S.Gu.Error)return;const oe=i.jh.getAncestor(G,K);if(!Y.data?.series.length){oe.updateMetricPanel(H,!0,!0);return}let se=!1;for(const ne of Y.data.series){for(const ee of ne.fields)if(ee.type===T.PU.number&&(se=ee.values.some(Z=>Z!=null&&!isNaN(Z)&&Z!==0),se))break;if(se)break}oe.updateMetricPanel(H,!0,!se)})}}function A(H,G,j,Y){const oe=(0,E.v)(H),se=oe.preview.vizBuilder().setColor({mode:"fixed",fixedColor:(0,p.Vy)(G)}).setDescription(Y).setHeaderActions(new D({metric:H,title:"Select"})).build(),ne=oe.preview.queries.map(ee=>x(ee,j));return new i.xK({$variables:new i.Pj({variables:(0,y.ym)(H)}),$behaviors:[M(H)],$data:new i.dt({datasource:y.GH,maxDataPoints:200,queries:ne}),body:se})}function x(H,G){const j=G>0?'${filters},__ignore_usage__=""':'__ignore_usage__=""',Y=H.expr?.replace("${filters}",j);return{...H,expr:Y}}var C=e(51088);function O(H,G){return H.sort((j,Y)=>{const oe=L(j,G),se=L(Y,G);return oe.halfLeven+oe.wholeLeven-(se.halfLeven+se.wholeLeven)})}const R=new Map;function L(H,G){let j=R.get(H);j||(j=new Map,R.set(H,j));let Y=j.get(G);if(!Y){const oe=H.split("_"),se=oe.slice(0,oe.length/2).join("_"),ne=(0,C.A)(se,G)||0,ee=(0,C.A)(H,G)||0;Y={halfLeven:ne,wholeLeven:ee},j.set(G,Y)}return Y}const N="175px",F="64px";class K extends i.Bs{constructor(G){super({$variables:G.$variables??B(),body:G.body??new i.gF({children:[],templateColumns:"repeat(auto-fill, minmax(450px, 1fr))",autoRows:N,isLazy:!0}),showPreviews:!0,...G}),this.previewCache={},this.ignoreNextUpdate=!1,this._variableDependency=new i.Sh(this,{variableNames:[y.MN,y.EY],onReferencedVariableValueChanged:j=>{const{name:Y}=j.state;Y===y.EY?this.state.body.setState({children:[]}):Y===y.MN&&(this.onMetricNamesChange(),this.updateMetrics(),this.buildLayout())}}),this.currentMetricNames=new Set,this.updateMetricPanel=(j,Y,oe)=>{const se=this.previewCache[j];se&&(se.isEmpty=oe,se.loaded=Y,this.previewCache[j]=se,this.buildLayout())},this.onSearchQueryChange=j=>{this.setState({searchQuery:j.currentTarget.value}),this.searchQueryChangedDebounced()},this.searchQueryChangedDebounced=(0,a.debounce)(()=>{this.updateMetrics(),this.buildLayout()},500),this.onTogglePreviews=()=>{this.setState({showPreviews:!this.state.showPreviews}),this.buildLayout()},this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.body.state.children.length===0?this.buildLayout():this.ignoreNextUpdate=!0;const G=(0,p.kj)(this),j=G.subscribeToEvent(y.OO,Y=>{const{steps:oe,currentStep:se}=G.state.history.state,ne=oe[se].parentIndex,Z=oe[ne].trailState.metric!==void 0,z=this.state.searchQuery?.split(W).filter(q=>q.length>0);Y.payload!==void 0&&(0,c.z)("metric_selected",{from:Z?"related_metrics":"metric_list",searchTermCount:z?.length||0})});return()=>{j.unsubscribe()}}sortedPreviewMetrics(){return Object.values(this.previewCache).sort((G,j)=>G.isEmpty&&j.isEmpty?G.index-j.index:G.isEmpty?1:j.isEmpty?-1:G.index-j.index)}onMetricNamesChange(){const G=i.jh.lookupVariable(y.MN,this);if(!(G instanceof i.fS)||G.state.loading)return;const j=G.state.options.map(oe=>oe.value.toString()),Y=new Set(j);Object.values(this.previewCache).forEach(oe=>{Y.has(oe.name)||(oe.isEmpty=!0)}),this.currentMetricNames=Y,this.buildLayout()}applyMetricSearch(){const G=Array.from(this.currentMetricNames);if(G==null)return;const j=V(this.state.searchQuery);if(!j)this.setState({metricsAfterSearch:G});else{const Y=G.filter(oe=>!j||j.test(oe));this.setState({metricsAfterSearch:Y})}}updateMetrics(G=!0){G&&this.applyMetricSearch();const{metricsAfterSearch:j}=this.state,Y=j||[],oe=(0,p.kj)(this),se=oe.state.metric!==void 0?O(Y,oe.state.metric):Y,ne={},ee=120;Object.keys(this.previewCache).forEach(Z=>{this.currentMetricNames.has(Z)||delete this.previewCache[Z]});for(let Z=0;Z<se.length;Z++){const z=se[Z];if(Object.keys(ne).length>ee)break;const ie=this.previewCache[z]||{name:z,index:Z,loaded:!1};ne[z]=ie}try{const Z=i.jh.getAncestor(this,b.R).state.metric;delete ne[Z]}catch{}this.previewCache=ne}async buildLayout(){if(this.ignoreNextUpdate){this.ignoreNextUpdate=!1;return}const G=i.jh.lookupVariable(y.MN,this);if(!(G instanceof i.fS)||G.state.loading)return;Object.keys(this.previewCache).length||this.updateMetrics();const j=[],Y=(0,p.kj)(this),oe=this.sortedPreviewMetrics(),ne=(0,p.gA)(this)?.length||0;for(let Z=0;Z<oe.length;Z++){const z=oe[Z],q=await Y.getMetricMetadata(z.name),ie=(0,P.R)(q);if(this.state.showPreviews){if(z.itemRef&&z.isPanel){j.push(z.itemRef.resolve());continue}const de=A(z.name,Z,ne,ie);z.itemRef=de.getRef(),z.isPanel=!0,j.push(de)}else{const de=new i.xK({$variables:new i.Pj({variables:(0,y.ym)(z.name)}),body:w(z.name,ie)});z.itemRef=de.getRef(),z.isPanel=!1,j.push(de)}}const ee=this.state.showPreviews?N:F;this.state.body.setState({children:j,autoRows:ee})}static{this.Component=({model:G})=>{const{searchQuery:j,showPreviews:Y,body:oe}=G.useState(),{children:se}=oe.useState(),ne=(0,d.of)(U),ee=_(y.MN,G),Z=se.length===0&&j,z=!ee.isLoading&&G.currentMetricNames.size===0,q=ee.isLoading&&se.length===0,ie=q?void 0:z&&"There are no results found. Try a different time range or a different data source."||Z&&"There are no results found. Try adjusting your search or filters."||void 0,de=ee.error||ee.isLoading;return o.createElement("div",{className:ne.container},o.createElement("div",{className:ne.header},o.createElement(l.D,{label:"Search metrics",className:ne.searchField},o.createElement(m.p,{placeholder:"Search metrics",prefix:o.createElement(s.I,{name:"search"}),value:j,onChange:G.onSearchQueryChange,disabled:de})),o.createElement(h.K,{showLabel:!0,label:"Show previews",value:Y,onChange:G.onTogglePreviews,disabled:de})),ee.error&&o.createElement(u.F,{title:"Unable to retrieve metric names",severity:"error"},o.createElement("div",null,"We are unable to connect to your data source. Double check your data source URL and credentials."),o.createElement("div",null,"(",ee.error,")")),o.createElement(g.O,{isLoading:q,blockingMessage:ie},o.createElement(oe.Component,{model:oe})))}}}function B(){return new i.Pj({variables:[new i.fS({name:y.MN,datasource:y.GH,hide:f.zL.hideVariable,includeAll:!0,defaultToAll:!0,skipUrlSync:!0,refresh:r.CO.onTimeRangeChanged,query:{query:`label_values(${y.ui},__name__)`,refId:"A"}})]})}function w(H,G){return i.d0.text().setTitle(H).setDescription(G).setHeaderActions(new D({metric:H,title:"Select"})).setOption("content","").build()}function U(H){return{container:(0,n.css)({display:"flex",flexDirection:"column",flexGrow:1}),headingWrapper:(0,n.css)({marginBottom:H.spacing(.5)}),header:(0,n.css)({flexGrow:0,display:"flex",gap:H.spacing(2),marginBottom:H.spacing(2),alignItems:"flex-end"}),searchField:(0,n.css)({flexGrow:1,marginBottom:0})}}const W=/[^a-z0-9_:]+/;function V(H){if(!H)return null;const G=H?.toLowerCase().split(W).filter(Y=>Y.length>0).map(Y=>`(?=(.*${Y}.*))`);if(G.length===0)return null;const j=G.join("");return new RegExp(j,"igy")}function _(H,G){const j=i.jh.lookupVariable(H,G),Y=(0,o.useCallback)(()=>{if(j)return j.useState()},[j]),{error:oe,loading:se}=Y()||{};return{isLoading:!!se,error:oe}}},90623:(Q,I,e)=>{"use strict";e.d(I,{p:()=>r});var n=e(96540),a=e(67061),o=e(94753);const r=()=>n.createElement(a.B,{direction:"column",gap:1},n.createElement(o.E,{variant:"h1"},"Metrics"),n.createElement(o.E,{color:"secondary"},"Explore your Prometheus-compatible metrics without writing a query"))},69096:(Q,I,e)=>{"use strict";e.d(I,{O:()=>i});var n=e(32196),a=e(96540),o=e(40845),r=e(39558);function i({blockingMessage:d,isLoading:l,children:m}){const s=(0,o.of)(f);return l&&!d&&(d="Loading..."),l?a.createElement(r._,{className:s.statusMessage,text:d}):d?a.createElement("div",{className:s.statusMessage},d):m}function f(d){return{statusMessage:(0,n.css)({fontStyle:"italic",marginTop:d.spacing(7),textAlign:"center",width:"100%"})}}},74764:(Q,I,e)=>{"use strict";e.d(I,{_:()=>y});var n=e(2543),a=e(16401),o=e(99140),r=e(16001),i=e(56833),f=e(4200),d=e(96540),l=e(67061),m=e(55852),s=e(3169);function h(){const p=(0,s.tZ)("Bookmark created");return p.component=d.createElement(l.B,{gap:2,direction:"row"},d.createElement("div",null,"You can view bookmarks under ",d.createElement("i",null,"Explore > Metrics")),d.createElement(m.z9,{fill:"solid",variant:"secondary",href:f.QX},"View bookmarks")),p}const u=20;class b{constructor(){this._recent=[],this._bookmarks=[],this._bookmarkIndexMap=new Map,this.load();const v=()=>{const D=this._recent.slice(0,u).map(S=>this._serializeTrail(S.resolve()));localStorage.setItem(f.sQ,JSON.stringify(D));const E=this._bookmarks.map(S=>this._serializeTrail(S.resolve()));localStorage.setItem(f.me,JSON.stringify(E))};this._save=(0,n.debounce)(v,1e3),window.addEventListener("beforeunload",D=>{this._save=v})}_loadFromStorage(v){const D=[],E=localStorage.getItem(v);if(E){const S=JSON.parse(E);for(const T of S){const M=this._deserializeTrail(T);D.push(M.getRef())}}return D}_deserializeTrail(v){const D=new i.b({createdAt:v.createdAt});v.history.map(S=>{this._loadFromUrl(D,S.urlValues);const T=S.parentIndex??D.state.history.state.steps.length-1;D.state.history.setState({currentStep:T}),D.state.history.addTrailStep(D,S.type)});const E=v.currentStep??D.state.history.state.steps.length-1;return D.state.history.setState({currentStep:E}),D.setState(D.state.history.state.steps[E].trailState),D}_serializeTrail(v){return{history:v.state.history.state.steps.map(E=>{const S=new i.b(a.Go.cloneSceneObjectState(E.trailState));return{urlValues:(0,a.Is)().getUrlState(S),type:E.type,description:E.description,parentIndex:E.parentIndex}}),currentStep:v.state.history.state.currentStep,createdAt:v.state.createdAt}}_loadFromUrl(v,D){v.urlSync?.updateFromUrl(D),v.forEachChild(E=>this._loadFromUrl(E,D))}get recent(){return this._recent}load(){this._recent=this._loadFromStorage(f.sQ),this._bookmarks=this._loadFromStorage(f.me),this._refreshBookmarkIndexMap()}setRecentTrail(v){const{steps:D}=v.state.history.state;if(D.length===0||D.length===1&&D[0].type==="start")return;this._recent=this._recent.filter(S=>S!==v.getRef());const E=g(v);this._recent=this._recent.filter(S=>{const T=g(S.resolve());return!(0,n.isEqual)(E,T)}),this._recent.unshift(v.getRef()),this._save()}findMatchingRecentTrail(v){const D=g(v);return this._recent.find(E=>{const S=g(E.resolve());return(0,n.isEqual)(D,S)})}get bookmarks(){return this._bookmarks}addBookmark(v){const D=new i.b(a.Go.cloneSceneObjectState(v.state));this._bookmarks.unshift(D.getRef()),this._refreshBookmarkIndexMap(),this._save(),(0,o.JD)((0,r.dx)(h()))}removeBookmark(v){v<this._bookmarks.length&&(this._bookmarks.splice(v,1),this._refreshBookmarkIndexMap(),this._save())}getBookmarkIndex(v){const D=P(v);return this._bookmarkIndexMap.get(D)}_refreshBookmarkIndexMap(){this._bookmarkIndexMap.clear(),this._bookmarks.forEach((v,D)=>{const E=v.resolve(),S=P(E);this._bookmarkIndexMap.set(S,D)})}}function g(p){const v=(0,a.Is)().getUrlState(p);return delete v.actionView,delete v.layout,v["var-groupby"]===""&&(v["var-groupby"]="$__all"),v}function P(p){return JSON.stringify(g(p))}let c;function y(){return c||(c=new b),c}},88434:(Q,I,e)=>{"use strict";e.d(I,{R:()=>i,q:()=>r});var n=e(50556),a=e(19347),o=e(4200);class r{constructor(d){this._trail=d}reset(){this._datasource=void 0,this._metricsMetadata=void 0}async getDatasource(){return this._datasource||(this._datasource=(0,a.l)().get(o.gR,{__sceneObject:{value:this._trail}})),await this._datasource}async _getMetricsMetadata(){const d=await this.getDatasource();if(d.languageProvider instanceof n.Ay)return d.languageProvider.metricsMetadata||await d.languageProvider.loadMetricsMetadata(),d.languageProvider.metricsMetadata}async getMetricMetadata(d){return d?(this._metricsMetadata||(this._metricsMetadata=this._getMetricsMetadata()),(await this._metricsMetadata)?.[d]):void 0}}function i(f){if(!f)return;const{type:d,help:l,unit:m}=f;return[l,d&&`**Type:** *${d}*`,m&&`**Unit:** ${m}`].join(`

`)}},40588:(Q,I,e)=>{"use strict";e.d(I,{h:()=>r,z:()=>o});var n=e(14110);const a="grafana_explore_metrics_";function o(i,f){(0,n.rR)(`${a}${i}`,f)}function r(i,f){if(i.length===f.length)for(const d of f)for(const l of i)d.key===l.key&&d.value!==l.value&&o("label_filter_changed",{label:d.key,action:"changed",cause:"adhoc_filter"});else if(i.length<f.length)for(const d of f){let l=!1;for(const m of i)if(d.key===m.key){l=!0;break}l||o("label_filter_changed",{label:d.key,action:"removed",cause:"adhoc_filter"})}else for(const d of i){let l=!1;for(const m of f)if(m.key===d.key){l=!0;break}l||o("label_filter_changed",{label:d.key,action:"added",cause:"adhoc_filter"})}}},4200:(Q,I,e)=>{"use strict";e.d(I,{Ao:()=>d,EY:()=>b,GH:()=>v,MN:()=>f,OO:()=>T,QX:()=>i,Rp:()=>s,aZ:()=>u,gR:()=>g,km:()=>r,me:()=>E,sQ:()=>D,td:()=>y,ui:()=>l,ym:()=>S,yr:()=>h});var n=e(65463),a=e(16401),o=e(79422);const r="/explore/metrics/trail",i="/explore/metrics",f="metricNames",d="filters",l="{${filters}}",m="metric",s="${metric}",h="groupby",u="${groupby}",b="ds",g="${ds}",P="logsDs",c="${logsDs}",y="$__logs__",p="sqr-metric-viz-query",v={uid:g},D="grafana.trails.recent",E="grafana.trails.bookmarks";function S(M){return[new a.x0({name:m,value:M,hide:o.zL.hideVariable})]}class T extends n.x{static{this.type="metric-selected-event"}}},51080:(Q,I,e)=>{"use strict";e.d(I,{KE:()=>h,U4:()=>c,Vy:()=>D,aM:()=>P,aO:()=>p,ef:()=>u,gA:()=>S,hR:()=>v,iG:()=>E,kj:()=>s,nH:()=>y,xi:()=>b});var n=e(76885),a=e(19347),o=e(32264),r=e(16401),i=e(31193),f=e(56833),d=e(75176),l=e(74764),m=e(4200);function s(T){return r.jh.getAncestor(T,f.b)}function h(T){return r.jh.getAncestor(T,f.b).state.settings}function u(T){return new f.b({initialDS:T,$timeRange:new r.JZ({from:"now-1h",to:"now"}),embedded:!1})}function b(T){const M=(0,r.Is)().getUrlState(T);return g(M)}function g(T){return n.kM.renderUrl(m.km,T)}function P(T){if(T instanceof d.R)return T;if(T.parent)return P(T.parent);throw console.error("Unable to find graph view for",T),new Error("Unable to find trail")}function c(T){return r.jh.interpolate(T,m.gR)}function y(T){return(0,a.l)().getInstanceSettings(T)?.name||T}function p(T){return T?T===m.td?"Logs":T:"Select metric"}function v(){const T=(0,l._)().recent[0];if(T){const A=r.jh.interpolate(T.resolve(),m.gR);if(typeof A=="string"&&A.length>0)return A}const M=(0,i.tR)().getList({type:"prometheus"});if(M.length>0)return M.find(A=>A.uid===o.$.defaultDatasource)?.uid??M[0].uid}function D(T){const M=o.$.theme2.visualization;return M.getColorByName(M.palette[T%8])}function E(T){const M=Object.keys(T);return M.includes("from")&&M.includes("to")}function S(T){const M=r.jh.lookupVariable("filters",T);return M instanceof r.H9?M.state.filters:null}},27825:(Q,I,e)=>{"use strict";e.d(I,{J:()=>P});var n=e(52622),a=e(38248),o=e(96540),r=e(91890),i=e(72574),f=e(32264),d=e(66864),l=e(94354),m=e(10354),s=e(88841),h=e(94397);const u=[{label:"Size",value:n.J1.Size,description:"Split the buckets based on size"},{label:"Count",value:n.J1.Count,description:"Split the buckets based on count"}],b=[{label:"Split",value:n.J1.Size,description:"Split the buckets based on size"}],g=({value:c,onChange:y,item:p})=>{const[v,D]=(0,o.useState)(!1),E=M=>{D(!(0,h.N_)(M)),y({...c,value:M})},T=(0,i.w)().getVariables().map(M=>({value:M.name,label:M.label||M.name,origin:r.$0.Template}));return o.createElement(d.Gy,null,o.createElement(l.z,{value:c?.mode||n.J1.Size,options:c?.scale?.type===n.L4.Log?b:u,onChange:M=>{y({...c,mode:M})}}),f.$.featureToggles.transformationsVariableSupport?o.createElement(s.y,{invalid:v,error:"Value needs to be an integer or a variable",value:c?.value??"",placeholder:"Auto",onChange:E,suggestions:T}):o.createElement(m.p,{value:c?.value??"",placeholder:"Auto",onChange:M=>{y({...c,value:M.currentTarget.value})}}))};function P(c,y,p,v){y.addCustomEditor({id:"xBuckets",path:`${c}xBuckets`,name:"X Bucket",editor:g,category:v,defaultValue:{mode:n.J1.Size}}),y.addCustomEditor({id:"yBuckets",path:`${c}yBuckets`,name:"Y Bucket",editor:g,category:v,defaultValue:{mode:n.J1.Size}}),y.addCustomEditor({id:"yBuckets-scale",path:`${c}yBuckets.scale`,name:"Y Bucket scale",category:v,editor:a.W,defaultValue:{type:n.L4.Linear}})}},3290:(Q,I,e)=>{"use strict";e.d(I,{VQ:()=>V,wY:()=>N,Nb:()=>w,eE:()=>B,yJ:()=>U});var n=e(81160),a=e(18282),o=e(81010),r=e(11261),i=e(28240),f=e(83195),d=e(41260),l=e(70416),m=e(77678),s=e(73060),h=e(32264),u=e(52622),b=e(97706);const{abs:g,pow:P}=Math,c=new Map;function y(j,Y,oe,se){let ne=[],ee=se.map(b.E);for(let Z=Y;Z<oe;Z++){let z=g(Z),q=(0,b.h)(P(j,Z),z);for(let ie=0;ie<se.length;ie++){let de=se[ie]*q,ue=(de>=0&&Z>=0?0:z)+(Z>=ee[ie]?0:ee[ie]),fe=(0,b.h)(de,ue);ne.push(fe),c.set(fe,ue)}}return ne}const p=j=>j%1===0,v=[1,1.5,2,2.5,3,3.5,4,4.5,5,5.5,6,6.5,7,7.5,8,8.5,9,9.5],D=y(10,-16,0,v),E=y(10,0,16,v),S=E.filter(p),T=D.concat(E),M=D.concat(S),A=1*1e3,x=60*A,C=60*x,O=24*C,R=365*O,L=[1,2,4,5,10,20,25,40,50,100,200,250,400,500,A,2*A,4*A,5*A,10*A,15*A,20*A,30*A,x,2*x,4*x,5*x,10*x,15*x,20*x,30*x,C,2*C,4*C,6*C,8*C,12*C,18*C,O,2*O,3*O,4*O,5*O,6*O,7*O,10*O,15*O,30*O,45*O,60*O,90*O,180*O,R,2*R,3*R,4*R,5*R,6*R,7*R,8*R,9*R,10*R],N={id:a.F.heatmap,name:"Create heatmap",description:"Generate heatmap data from source data.",defaultOptions:{},isApplicable:j=>{const{xField:Y,yField:oe,xs:se,ys:ne}=_(j);return Y||oe||!se.length||!ne.length?o.M.NotPossible:o.M.Applicable},isApplicableDescription:"The Heatmap transformation requires fields with Heatmap compatible data. No fields with Heatmap data could be found.",operator:(j,Y)=>oe=>oe.pipe((0,n.T)(se=>{if(h.$.featureToggles.transformationsVariableSupport){const ne={...j,xBuckets:{...j.xBuckets},yBuckets:{...j.yBuckets}};return ne.xBuckets?.value&&(ne.xBuckets.value=Y.interpolate(ne.xBuckets.value)),ne.yBuckets?.value&&(ne.yBuckets.value=Y.interpolate(ne.yBuckets.value)),N.transformer(ne,Y)(se)}else return N.transformer(j,Y)(se)})),transformer:j=>Y=>{const oe=V(Y,j);return j.keepOriginalData?[oe,...Y]:[oe]}};function F(j){return j==="+Inf"?1/0:j==="-Inf"?-1/0:+(j??0)}function K(j,Y){return F(j)-F(Y)}function B(j){return j?.meta?.custom??{}}function w(j){let Y=!1;for(let oe of j.fields)switch(oe.name){case"y":case"yMin":case"yMax":if(Y)return!1;Y=!0}return Y}function U(j){const Y=j.frame.fields[0],oe=Y.values,se=j.frame.fields.filter((Se,he)=>Se.type===r.PU.number&&he>0),ne=oe.length*se.length,ee=new Array(ne),Z=new Array(ne),z=new Array(ne),q=se.map(Se=>Se.values.slice());q.forEach((Se,he)=>{for(let ce=0;ce<Se.length;ce++)z[q.length*ce+he]=Se[ce]});const ie=Array.from({length:se.length},(Se,he)=>he);for(let Se=0,he=0,ce=0;Se<ne;he=++Se%ie.length)Z[Se]=ie[he],he===0&&Se>=ie.length&&ce++,ee[Se]=oe[ce];let de=se[0].labels?.le!=null?"yMax":"y";switch(j.layout){case u.D7.le:de="yMax";break;case u.D7.ge:de="yMin";break;case u.D7.unknown:de="y";break}const ue={yOrdinalDisplay:se.map(Se=>(0,i.Ct)(Se,j.frame)),yMatchWithLabel:Object.keys(se[0].labels??{})[0]};if(ue.yMatchWithLabel&&(ue.yOrdinalLabel=se.map(Se=>Se.labels?.[ue.yMatchWithLabel]??""),ue.yMatchWithLabel==="le"&&(ue.yMinDisplay="0.0")),j.unit?.length||j.decimals!=null){const Se=(0,f.j_)(j.unit??"short");ue.yMinDisplay&&(ue.yMinDisplay=(0,f.cN)(Se(0,j.decimals))),ue.yOrdinalDisplay=ue.yOrdinalDisplay.map(he=>{let ce=+he;return Number.isNaN(ce)?he:(0,f.cN)(Se(ce,j.decimals))})}const fe={...se[0].config};return fe.displayNameFromDS&&delete fe.displayNameFromDS,{length:ee.length,refId:j.frame.refId,meta:{type:d.m.HeatmapCells,custom:ue},fields:[{name:Y.type===r.PU.time?"xMax":"x",type:Y.type,values:ee,config:Y.config},{name:de,type:r.PU.number,values:Z,config:{unit:"short"}},{name:j.value?.length?j.value:"Value",type:r.PU.number,values:z,config:fe,display:se[0].display}]}}function W(j){j=j.slice(),j.sort((oe,se)=>K(oe.name,se.name));const Y=j.map(oe=>oe.fields[1].values.slice());return Y.reverse(),Y.forEach((oe,se)=>{if(se<Y.length-1)for(let ne=0;ne<oe.length;ne++)oe[ne]-=Y[se+1][ne]}),Y.reverse(),j.map((oe,se)=>({...oe,fields:[oe.fields[0],{...oe.fields[1],values:Y[se]}]}))}function V(j,Y){const{xField:oe,yField:se,xs:ne,ys:ee}=_(j);if(!oe||!se)throw"no heatmap fields found";if(!ne.length||!ee.length)throw"no values found";const Z=Y.xBuckets??{},z=Y.yBuckets??{};if(Z.scale?.type===u.L4.Log)throw"X axis only supports linear buckets";const q=Y.yBuckets?.scale??{type:u.L4.Linear},ie=H(ne,ee,{xSorted:(0,s.g2)(ne),xTime:oe.type===r.PU.time,xMode:Z.mode,xSize:Z.mode===u.J1.Size?(0,l.WT)((0,l.E9)(Z.value??"")):Z.value?+Z.value:void 0,yMode:z.mode,ySize:z.value?+z.value:void 0,yLog:q?.type===u.L4.Log?q?.log:void 0});return{length:ie.x.length,name:(0,i.Ct)(se),meta:{type:d.m.HeatmapCells},fields:[{name:"xMin",type:oe.type,values:ie.x,config:oe.config},{name:"yMin",type:r.PU.number,values:ie.y,config:{...se.config,custom:{scaleDistribution:q}}},{name:"Count",type:r.PU.number,values:ie.count,config:{unit:"short"}}]}}function _(j){let Y,oe,se=0;for(let z of j)z.fields.find(ie=>ie.type===r.PU.time)&&(se+=z.length);let ne=Array(se),ee=Array(se),Z=0;for(let z of j){const q=z.fields.find(de=>de.type===r.PU.time);if(!q)continue;Y||(Y=q);const ie=q.values;for(let de of z.fields)if(de!==q&&de.type===r.PU.number){const ue=de.values;for(let fe=0;fe<ie.length;fe++,Z++)ne[Z]=ie[fe],ee[Z]=ue[fe];oe||(oe=de)}}return{xField:Y,yField:oe,xs:ne,ys:ee}}function H(j,Y,oe){let se=j.length,ne=oe?.xSorted??!1,ee=oe?.ySorted??!1,Z=ne?j[0]:1/0,z=ee?Y[0]:1/0,q=ne?j[se-1]:-1/0,ie=ee?Y[se-1]:-1/0,de=oe?.yLog;for(let Me=0;Me<se;Me++)ne||(Z=Math.min(Z,j[Me]),q=Math.max(q,j[Me])),ee||(!de||Y[Me]>0)&&(z=Math.min(z,Y[Me]),ie=Math.max(ie,Y[Me]));let ue=oe?.xSize??0,fe=oe?.ySize??0,Se=oe?.xMode,he=oe?.yMode;if((!Number.isFinite(ue)||ue<=0)&&(Se=u.J1.Count,ue=20),(!Number.isFinite(fe)||fe<=0)&&(he=u.J1.Count,fe=10),Se===u.J1.Count){let Me=(q-Z)/Math.max(ue-1,1),$e=oe?.xTime?L:M,ke=$e.findIndex(Ze=>Ze>Me)-1;ue=$e[Math.max(ke,0)]}if(he===u.J1.Count){let Me=(ie-z)/Math.max(fe-1,1),$e=oe?.yTime?L:M,ke=$e.findIndex(Ze=>Ze>Me)-1;fe=$e[Math.max(ke,0)]}let ce=oe?.xCeil?Me=>(0,m.Uh)(Me,ue):Me=>(0,m.rs)(Me,ue),me=oe?.yCeil?Me=>(0,m.Uh)(Me,fe):Me=>(0,m.rs)(Me,fe);if(de){fe=1/(oe?.ySize??1);let Me=de===2?Math.log2:Math.log10;me=oe?.yCeil?$e=>(0,m.Uh)(Me($e),fe):$e=>(0,m.rs)(Me($e),fe)}let pe=ce(Z),ye=ce(q),Pe=me(z),Ie=me(ie),Oe=Math.round((ye-pe)/ue)+1,Ne=Math.round((Ie-Pe)/fe)+1,[We,Ae,Ue]=G(Oe,Ne,pe,ue,Pe,fe,de);for(let Me=0;Me<se;Me++){if(de&&Y[Me]<=0)continue;const $e=(ce(j[Me])-pe)/ue,ke=(me(Y[Me])-Pe)/fe,Ze=$e*Ne+ke;Ue[Ze]++}return{x:We,y:Ae,count:Ue}}function G(j,Y,oe,se,ne,ee,Z){const z=j*Y,q=new Array(z),ie=new Array(z),de=new Array(z);for(let ue=0,fe=0,Se=oe;ue<z;fe=++ue%Y)de[ue]=0,Z?ie[ue]=Z**(ne+fe*ee):ie[ue]=ne+fe*ee,fe===0&&ue>=Y&&(Se+=se),q[ue]=Se;return[q,ie,de]}},91847:(Q,I,e)=>{"use strict";e.d(I,{$n:()=>o,g_:()=>n,uk:()=>a});var n=(i=>(i.ShortcodeFigure="shortcodeFigure",i.UIImage="uiImage",i))(n||{});const a={calculateField:{name:"Add field from calculation",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to add a new field calculated from two other fields. Each transformation allows you to add one new field.

- **Mode** - Select a mode:
  - **Reduce row** - Apply selected calculation on each row of selected fields independently.
  - **Binary operation** - Apply basic binary operations (for example, sum or multiply) on values in a single row from two selected fields.
  - **Unary operation** - Apply basic unary operations on values in a single row from a selected field. The available operations are:
    - **Absolute value (abs)** - Returns the absolute value of a given expression. It represents its distance from zero as a positive number.
    - **Natural exponential (exp)** - Returns _e_ raised to the power of a given expression.
    - **Natural logarithm (ln)** - Returns the natural logarithm of a given expression.
    - **Floor (floor)** - Returns the largest integer less than or equal to a given expression.
    - **Ceiling (ceil)** - Returns the smallest integer greater than or equal to a given expression.
  - **Cumulative functions** - Apply functions on the current row and all preceding rows.
    - **Total** - Calculates the cumulative total up to and including the current row.
    - **Mean** - Calculates the mean up to and including the current row.
  - **Window functions** - Apply window functions. The window can either be **trailing** or **centered**.
    With a trailing window the current row will be the last row in the window.
    With a centered window the window will be centered on the current row.
    For even window sizes, the window will be centered between the current row, and the previous row.
    - **Mean** - Calculates the moving mean or running average.
    - **Stddev** - Calculates the moving standard deviation.
    - **Variance** - Calculates the moving variance.
  - **Row index** - Insert a field with the row index.
- **Field name** - Select the names of fields you want to use in the calculation for the new field.
- **Calculation** - If you select **Reduce row** mode, then the **Calculation** field appears. Click in the field to see a list of calculation choices you can use to create the new field. For information about available calculations, refer to [Calculation types][].
- **Operation** - If you select **Binary operation** or **Unary operation** mode, then the **Operation** fields appear. These fields allow you to apply basic math operations on values in a single row from selected fields. You can also use numerical values for binary operations.
- **As percentile** - If you select **Row index** mode, then the **As percentile** switch appears. This switch allows you to transform the row index as a percentage of the total number of rows.
- **Alias** - (Optional) Enter the name of your new field. If you leave this blank, then the field will be named to match the calculation.
- **Replace all fields** - (Optional) Select this option if you want to hide all other fields and display only your calculated field in the visualization.

> **Note:** **Cumulative functions** and **Window functions** modes are currently in public preview. Grafana Labs offers limited support, and breaking changes might occur prior to the feature being made generally available. Enable the \`addFieldFromCalculationStatFunctions\` feature toggle in Grafana to use this feature. Contact Grafana Support to enable this feature in Grafana Cloud.

In the example below, we added two fields together and named them Sum.

${r("/static/img/docs/transformations/add-field-from-calc-stat-example-7-0.png",i,"A stat visualization including one field called Sum")}
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},concatenate:{name:"Concatenate fields",getHelperDocs:function(){return`
Use this transformation to combine all fields from all frames into one result.

For example, if you have separate queries retrieving temperature and uptime data (Query A) and air quality index and error information (Query B), applying the concatenate transformation yields a consolidated data frame with all relevant information in one view.

Consider the following:

**Query A:**

| Temp  | Uptime  |
| ----- | ------- |
| 15.4  | 1230233 |

**Query B:**

| AQI   | Errors |
| ----- | ------ |
| 3.2   | 5      |

After you concatenate the fields, the data frame would be:

| Temp | Uptime  | AQI | Errors |
| ---- | ------- | --- | ------ |
| 15.4 | 1230233 | 3.2 | 5      |

This transformation simplifies the process of merging data from different sources, providing a comprehensive view for analysis and visualization.
  `}},configFromData:{name:"Config from query results",getHelperDocs:function(){return`
Use this transformation to select a query and extract standard options, such as **Min**, **Max**, **Unit**, and **Thresholds**, and apply them to other query results. This feature enables dynamic visualization configuration based on the data returned by a specific query.

#### Options

- **Config query** - Select the query that returns the data you want to use as configuration.
- **Apply to** - Select the fields or series to which the configuration should be applied.
- **Apply to options** - Specify a field type or use a field name regex, depending on your selection in **Apply to**.

#### Field mapping table

Below the configuration options, you'll find the field mapping table. This table lists all fields found in the data returned by the config query, along with **Use as** and **Select** options. It provides control over mapping fields to config properties, and for multiple rows, it allows you to choose which value to select.

#### Example

Input[0] (From query: A, name: ServerA)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 10    |
| 1626178119129 | 30    |

Input[1] (From query: B)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 100   |
| 1626178119129 | 100   |

Output (Same as Input[0] but now with config on the Value field)

| Time          | Value (config: Max=100) |
| ------------- | ----------------------- |
| 1626178119127 | 10                      |
| 1626178119129 | 30                      |

Each row in the source data becomes a separate field. Each field now has a maximum configuration option set. Options such as **Min**, **Max**, **Unit**, and **Thresholds** are part of the field configuration. If set, they are used by the visualization instead of any options manually configured in the panel editor options pane.

#### Value mappings

You can also transform a query result into value mappings. With this option, every row in the configuration query result defines a single value mapping row. See the following example.

Config query result:

| Value | Text   | Color |
| ----- | ------ | ----- |
| L     | Low    | blue  |
| M     | Medium | green |
| H     | High   | red   |

In the field mapping specify:

| Field | Use as                  | Select     |
| ----- | ----------------------- | ---------- |
| Value | Value mappings / Value  | All values |
| Text  | Value mappings / Text   | All values |
| Color | Value mappings / Color | All values |

Grafana builds value mappings from your query result and applies them to the real data query results. You should see values being mapped and colored according to the config query results.
  `}},convertFieldType:{name:"Convert field type",getHelperDocs:function(){return`
Use this transformation to modify the field type of a specified field.

This transformation has the following options:

- **Field** - Select from available fields
- **as** - Select the FieldType to convert to
  - **Numeric** - attempts to make the values numbers
  - **String** - will make the values strings
  - **Time** - attempts to parse the values as time
    - The input will be parsed according to the [Moment.js parsing format](https://momentjs.com/docs/#/parsing/)
    - It will parse the numeric input as a Unix epoch timestamp in milliseconds.
      You must multiply your input by 1000 if it's in seconds.
    - Will show an option to specify a DateFormat as input by a string like yyyy-mm-dd or DD MM YYYY hh:mm:ss
  - **Boolean** - will make the values booleans
  - **Enum** - will make the values enums
    - Will show a table to manage the enums
  - **Other** - attempts to parse the values as JSON

For example, consider the following query that could be modified by selecting the time field as Time and specifying Date Format as YYYY.

#### Sample Query

| Time       | Mark  | Value |
|------------|-------|-------|
| 2017-07-01 | above | 25    |
| 2018-08-02 | below | 22    |
| 2019-09-02 | below | 29    |
| 2020-10-04 | above | 22    |

The result:

#### Transformed Query

| Time                | Mark  | Value |
|---------------------|-------|-------|
| 2017-01-01 00:00:00 | above | 25    |
| 2018-01-01 00:00:00 | below | 22    |
| 2019-01-01 00:00:00 | below | 29    |
| 2020-01-01 00:00:00 | above | 22    |

This transformation allows you to flexibly adapt your data types, ensuring compatibility and consistency in your visualizations.
  `}},extractFields:{name:"Extract fields",getHelperDocs:function(){return`
Use this transformation to select a source of data and extract content from it in different formats. This transformation has the following fields:

- **Source** - Select the field for the source of data.
- **Format** - Choose one of the following:
  - **JSON** - Parse JSON content from the source.
  - **Key+value pairs** - Parse content in the format 'a=b' or 'c:d' from the source.
  - **Auto** - Discover fields automatically.
- **Replace All Fields** - (Optional) Select this option to hide all other fields and display only your calculated field in the visualization.
- **Keep Time** - (Optional) Available only if **Replace All Fields** is true. Keeps the time field in the output.

Consider the following dataset:

#### Dataset Example

| Timestamp           | json_data     |
|---------------------|---------------|
| 1636678740000000000 | {"value": 1}  |
| 1636678680000000000 | {"value": 5}  |
| 1636678620000000000 | {"value": 12} |

You could prepare the data to be used by a [Time series panel][] with this configuration:

- Source: json_data
- Format: JSON
  - Field: value
  - Alias: my_value
- Replace all fields: true
- Keep time: true

This will generate the following output:

#### Transformed Data

| Timestamp           | my_value |
|---------------------|----------|
| 1636678740000000000 | 1        |
| 1636678680000000000 | 5        |
| 1636678620000000000 | 12       |

This transformation allows you to extract and format data in various ways. You can customize the extraction format based on your specific data needs.
  `},links:[{title:"Time series panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/time-series/"}]},fieldLookup:{name:"Lookup fields from resource",getHelperDocs:function(){return`
Use this transformation to enrich a field value by looking up additional fields from an external source. 
  
This transformation has the following fields:

- **Field** - Select a text field from your dataset.
- **Lookup** - Choose from **Countries**, **USA States**, and **Airports**.

This transformation currently supports spatial data.

For example, if you have this data:

#### Dataset Example

| Location  | Values |
|-----------|--------|
| AL        | 0      |
| AK        | 10     |
| Arizona   | 5      |
| Arkansas  | 1      |
| Somewhere | 5      |

With this configuration:

- Field: location
- Lookup: USA States

You'll get the following output:

#### Transformed Data

| Location  | ID | Name     | Lng         | Lat       | Values |
|-----------|----|----------|-------------|-----------|--------|
| AL        | AL | Alabama  | -80.891064  | 12.448457 | 0      |
| AK        | AK | Arkansas | -100.891064 | 24.448457 | 10     |
| Arizona   |    |          |             |           | 5      |
| Arkansas  |    |          |             |           | 1      |
| Somewhere |    |          |             |           | 5      |

This transformation lets you augment your data by fetching additional information from external sources, providing a more comprehensive dataset for analysis and visualization.
  `}},filterByRefId:{name:"Filter data by query refId",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to hide one or more queries in panels that have multiple queries.

Grafana displays the query identification letters in dark gray text. Click a query identifier to toggle filtering. If the query letter is white, then the results are displayed. If the query letter is dark, then the results are hidden.

> **Note:** This transformation is not available for Graphite because this data source does not support correlating returned data with queries.

In the example below, the panel has three queries (A, B, C). We removed the B query from the visualization.

${r("/static/img/docs/transformations/filter-by-query-stat-example-7-0.png",i,"A stat visualization with results from two queries, A and C")}
  `}},filterByValue:{name:"Filter data by values",getHelperDocs:function(){return`
Use this transformation to selectively filter data points directly within your visualization. This transformation provides options to include or exclude data based on one or more conditions applied to a selected field.

This transformation is very useful if your data source does not natively filter by values. You might also use this to narrow values to display if you are using a shared query.

The available conditions for all fields are:

- **Regex** - Match a regex expression.
- **Is Null** - Match if the value is null.
- **Is Not Null** - Match if the value is not null.
- **Equal** - Match if the value is equal to the specified value.
- **Different** - Match if the value is different than the specified value.

The available conditions for string fields are:

- **Contains substring** - Match if the value contains the specified substring (case insensitive).
- **Does not contain substring** - Match if the value doesn't contain the specified substring (case insensitive).

The available conditions for number fields are:

- **Greater** - Match if the value is greater than the specified value.
- **Lower** - Match if the value is lower than the specified value.
- **Greater or equal** - Match if the value is greater or equal.
- **Lower or equal** - Match if the value is lower or equal.
- **Range** - Match a range between a specified minimum and maximum, min and max included.

Consider the following dataset:

#### Dataset Example

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:23 | 32          | 101      |
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:32:24 | 31          | 95       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

If you **Include** the data points that have a temperature below 30\xB0C, the configuration will look as follows:

- Filter Type: 'Include'
- Condition: Rows where 'Temperature' matches 'Lower Than' '30'

And you will get the following result, where only the temperatures below 30\xB0C are included:

#### Transformed Data

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

You can add more than one condition to the filter. For example, you might want to include the data only if the altitude is greater than 100. To do so, add that condition to the following configuration:

- Filter type: 'Include' rows that 'Match All' conditions
- Condition 1: Rows where 'Temperature' matches 'Lower' than '30'
- Condition 2: Rows where 'Altitude' matches 'Greater' than '100'

When you have more than one condition, you can choose if you want the action (include/exclude) to be applied on rows that **Match all** conditions or **Match any** of the conditions you added.

In the example above, we chose **Match all** because we wanted to include the rows that have a temperature lower than 30\xB0C *AND* an altitude higher than 100. If we wanted to include the rows that have a temperature lower than 30\xB0C *OR* an altitude higher than 100 instead, then we would select **Match any**. This would include the first row in the original data, which has a temperature of 32\xB0C (does not match the first condition) but an altitude of 101 (which matches the second condition), so it is included.

Conditions that are invalid or incompletely configured are ignored.

This versatile data filtering transformation lets you to selectively include or exclude data points based on specific conditions. Customize the criteria to tailor your data presentation to meet your unique analytical needs.
  `}},filterFieldsByName:{name:"Filter fields by name",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to selectively remove parts of your query results. There are three ways to filter field names:

- [Using a regular expression](#use-a-regular-expression)
- [Manually selecting included fields](#manually-select-included-fields)
- [Using a dashboard variable](#use-a-dashboard-variable)

#### Use a regular expression

When you filter using a regular expression, field names that match the regular expression are included. 

For example, from the input data:

| Time                | dev-eu-west | dev-eu-north | prod-eu-west | prod-eu-north |
| ------------------- | ----------- | ------------ | ------------ | ------------- |
| 2023-03-04 23:56:23 | 23.5        | 24.5         | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 23.6        | 24.4         | 22.1         | 20.1          |

The result from using the regular expression 'prod.*' would be:

| Time                | prod-eu-west | prod-eu-north |
| ------------------- | ------------ | ------------- |
| 2023-03-04 23:56:23 | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 22.1         | 20.1          |

The regular expression can include an interpolated dashboard variable by using the \${variableName} syntax.

#### Manually select included fields

Click and uncheck the field names to remove them from the result. Fields that are matched by the regular expression are still included, even if they're unchecked.

#### Use a dashboard variable

Enable 'From variable' to let you select a dashboard variable that's used to include fields. By setting up a [dashboard variable][] with multiple choices, the same fields can be displayed across multiple visualizations.

${r("/static/img/docs/transformations/filter-name-table-before-7-0.png",i,"A table visualization with time, value, Min, and Max columns")}

Here's the table after we applied the transformation to remove the Min field.

${r("/static/img/docs/transformations/filter-name-table-after-7-0.png",i,"A table visualization with time, value, and Max columns")}

Here is the same query using a Stat visualization.

${r("/static/img/docs/transformations/filter-name-stat-after-7-0.png",i,"A stat visualization with value and Max fields")}

This transformation provides flexibility in tailoring your query results to focus on the specific fields you need for effective analysis and visualization.
  `}},formatString:{name:"Format string",getHelperDocs:function(){return`
Use this transformation to customize the output of a string field. This transformation has the following fields:

- **Upper case** - Formats the entire string in uppercase characters.
- **Lower case** - Formats the entire string in lowercase characters.
- **Sentence case** - Formats the first character of the string in uppercase.
- **Title case** - Formats the first character of each word in the string in uppercase.
- **Pascal case** - Formats the first character of each word in the string in uppercase and doesn't include spaces between words.
- **Camel case** - Formats the first character of each word in the string in uppercase, except the first word, and doesn't include spaces between words.
- **Snake case** - Formats all characters in the string in lowercase and uses underscores instead of spaces between words.
- **Kebab case** - Formats all characters in the string in lowercase and uses dashes instead of spaces between words.
- **Trim** - Removes all leading and trailing spaces from the string.
- **Substring** - Returns a substring of the string, using the specified start and end positions.

This transformation provides a convenient way to standardize and tailor the presentation of string data for better visualization and analysis.

> **Note:** This transformation is currently in public preview. Grafana Labs offers limited support, and breaking changes might occur prior to the feature being made generally available. Enable the \`formatString\` feature toggle in Grafana to use this feature. Contact Grafana Support to enable this feature in Grafana Cloud.`}},formatTime:{name:"Format time",getHelperDocs:function(){return`
Use this transformation to customize the output of a time field. Output can be formatted using [Moment.js format strings](https://momentjs.com/docs/#/displaying/). For example, if you want to display only the year of a time field, the format string 'YYYY' can be used to show the calendar year (for example, 1999 or 2012).

**Before Transformation:**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 1636678740000000000 | System Start |
| 1636678680000000000 | User Login   |
| 1636678620000000000 | Data Updated |

**After applying 'YYYY-MM-DD HH:mm:ss':**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 2021-11-12 14:25:40 | System Start |
| 2021-11-12 14:24:40 | User Login   |
| 2021-11-12 14:23:40 | Data Updated |

This transformation lets you tailor the time representation in your visualizations, providing flexibility and precision in displaying temporal data.

> **Note:** This transformation is available in Grafana 10.1+ as an alpha feature.
  `}},groupBy:{name:"Group by",getHelperDocs:function(){return`
Use this transformation to group the data by a specified field (column) value and process calculations on each group. Click to see a list of calculation choices. For information about available calculations, refer to [Calculation types][].

Here's an example of original data.

| Time                | Server ID | CPU Temperature | Server Status |
| ------------------- | --------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
| 2020-07-07 11:34:20 | server 3  | 62              | OK            |
| 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
| 2020-07-07 10:31:22 | server 3  | 55              | OK            |
| 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
| 2020-07-07 09:30:05 | server 2  | 88              | OK            |
| 2020-07-07 09:28:06 | server 1  | 80              | OK            |
| 2020-07-07 09:25:05 | server 2  | 88              | OK            |
| 2020-07-07 09:23:07 | server 1  | 86              | OK            |

This transformation goes in two steps. First you specify one or multiple fields to group the data by. This will group all the same values of those fields together, as if you sorted them. For instance if we group by the Server ID field, then it would group the data this way:

| Time                | Server ID      | CPU Temperature | Server Status |
| ------------------- | -------------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | **server 1**   | 80              | Shutdown      |
| 2020-07-07 09:28:06 | **server 1**   | 80              | OK            |
| 2020-07-07 09:23:07 | **server 1**   | 86              | OK            |
| 2020-07-07 10:32:20 | server 2       | 90              | Overload      |
| 2020-07-07 09:30:05 | server 2       | 88              | OK            |
| 2020-07-07 09:25:05 | server 2       | 88              | OK            |
| 2020-07-07 11:34:20 | **_server 3_** | 62              | OK            |
| 2020-07-07 10:31:22 | **_server 3_** | 55              | OK            |
| 2020-07-07 09:30:57 | **_server 3_** | 62              | Rebooting     |

All rows with the same value of Server ID are grouped together.

After choosing which field you want to group your data by, you can add various calculations on the other fields, and apply the calculation to each group of rows. For instance, we could want to calculate the average CPU temperature for each of those servers. So we can add the _mean_ calculation applied on the CPU Temperature field to get the following:

| Server ID | CPU Temperature (mean) |
| --------- | ---------------------- |
| server 1  | 82                     |
| server 2  | 88.6                   |
| server 3  | 59.6                   |

And we can add more than one calculation. For instance:

- For field Time, we can calculate the _Last_ value, to know when the last data point was received for each server
- For field Server Status, we can calculate the _Last_ value to know what is the last state value for each server
- For field Temperature, we can also calculate the _Last_ value to know what is the latest monitored temperature for each server

We would then get:

| Server ID | CPU Temperature (mean) | CPU Temperature (last) | Time (last)         | Server Status (last) |
| --------- | ---------------------- | ---------------------- | ------------------- | -------------------- |
| server 1  | 82                     | 80                     | 2020-07-07 11:34:20 | Shutdown             |
| server 2  | 88.6                   | 90                     | 2020-07-07 10:32:20 | Overload             |
| server 3  | 59.6                   | 62                     | 2020-07-07 11:34:20 | OK                   |

This transformation allows you to extract essential information from your time series and present it conveniently.
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},groupingToMatrix:{name:"Grouping to matrix",getHelperDocs:function(){return`
Use this transformation to combine three fields\u2014which are used as input for the **Column**, **Row**, and **Cell value** fields from the query output\u2014and generate a matrix. The matrix is calculated as follows:

**Original data**

| Server ID | CPU Temperature | Server Status |
| --------- | --------------- | ------------- |
| server 1  | 82              | OK            |
| server 2  | 88.6            | OK            |
| server 3  | 59.6            | Shutdown      |

We can generate a matrix using the values of 'Server Status' as column names, the 'Server ID' values as row names, and the 'CPU Temperature' as content of each cell. The content of each cell will appear for the existing column ('Server Status') and row combination ('Server ID'). For the rest of the cells, you can select which value to display between: **Null**, **True**, **False**, or **Empty**.

**Output**

| Server IDServer Status | OK   | Shutdown |
| ----------------------- | ---- | -------- |
| server 1                | 82   |          |
| server 2                | 88.6 |          |
| server 3                |      | 59.6     |

Use this transformation to construct a matrix by specifying fields from your query results. The matrix output reflects the relationships between the unique values in these fields. This helps you present complex relationships in a clear and structured matrix format.
  `}},groupToNestedTable:{name:"Group to nested tables",getHelperDocs:function(i="shortcodeFigure"){return`
  Use this transformation to group the data by a specified field (column) value and process calculations on each group. Records are generated that share the same grouped field value, to be displayed in a nested table.
    
  To calculate a statistic for a field, click the selection box next to it and select the **Calculate** option:

  ${r("/static/img/docs/transformations/nested-table-select-calculation.png",i,"A select box showing the Group and Calculate options for the transformation.")}

  Once **Calculate** has been selected, another selection box will appear next to the respective field which will allow statistics to be selected:

  ${r("/static/img/docs/transformations/nested-table-select-stat.png",i,"A select box showing available statistic calculations once the calculate option for the field has been selected.")}

  For information about available calculations, refer to [Calculation types][].

  Here's an example of original data:

  | Time                | Server ID | CPU Temperature | Server Status |
  | ------------------- | --------- | --------------- | ------------- |
  | 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
  | 2020-07-07 11:34:20 | server 3  | 62              | OK            |
  | 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
  | 2020-07-07 10:31:22 | server 3  | 55              | OK            |
  | 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
  | 2020-07-07 09:30:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:28:06 | server 1  | 80              | OK            |
  | 2020-07-07 09:25:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:23:07 | server 1  | 86              | OK            |

  This transformation has two steps. First, specify one or more fields by which to group the data. This groups all the same values of those fields together, as if you sorted them. For instance, if you group by the Server ID field, Grafana groups the data this way:

  | Server ID      |  |
  | -------------- | ------------- |
  | server 1 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>80</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>80</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>86</td><td>OK</td></tr></tbody></table> |
  | server 2 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>90</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>88</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>88</td><td>OK</td></tr></tbody></table> |
  | server 3 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>62</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>55</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>62</td><td>Rebooting</td></tr></tbody></table> |

  After choosing the field by which you want to group your data, you can add various calculations on the other fields and apply the calculation to each group of rows. For instance, you might want to calculate the average CPU temperature for each of those servers. To do so, add the **mean calculation** applied on the CPU Temperature field to get the following result:

  | Server ID      | CPU Temperatute (mean) | |
  | -------------- | ------------- | ------------- |
  | server 1 | 82 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>OK</td></tr></tbody></table> |
  | server 2 | 88.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>OK</td></tr></tbody></table> |
  | server 3 | 59.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>Rebooting</td></tr></tbody></table> |
      `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},heatmap:{name:"Create heatmap",getHelperDocs:function(){return`
Use this transformation to prepare histogram data for visualizing trends over time. Similar to the heatmap visualization, this transformation converts histogram metrics into temporal buckets.

#### X Bucket

This setting determines how the x-axis is split into buckets.

- **Size** - Specify a time interval in the input field. For example, a time range of '1h' creates cells one hour wide on the x-axis.
- **Count** - For non-time-related series, use this option to define the number of elements in a bucket.

#### Y Bucket

This setting determines how the y-axis is split into buckets.

- **Linear**
- **Logarithmic** - Choose between log base 2 or log base 10.
- **Symlog** - Uses a symmetrical logarithmic scale. Choose between log base 2 or log base 10, allowing for negative values.

Assume you have the following dataset:

| Timestamp           | Value |
|-------------------- |-------|
| 2023-01-01 12:00:00 | 5     |
| 2023-01-01 12:15:00 | 10    |
| 2023-01-01 12:30:00 | 15    |
| 2023-01-01 12:45:00 | 8     |

- With X Bucket set to 'Size: 15m' and Y Bucket as 'Linear', the histogram organizes values into time intervals of 15 minutes on the x-axis and linearly on the y-axis.
- For X Bucket as 'Count: 2' and Y Bucket as 'Logarithmic (base 10)', the histogram groups values into buckets of two on the x-axis and use a logarithmic scale on the y-axis.
  `}},histogram:{name:"Histogram",getHelperDocs:function(){return`
Use this transformation to generate a histogram based on input data, allowing you to visualize the distribution of values.

- **Bucket size** - The range between the lowest and highest items in a bucket (xMin to xMax).
- **Bucket offset** - The offset for non-zero-based buckets.
- **Combine series** - Create a unified histogram using all available series.

**Original data**

Series 1:

| A | B | C |
| - | - | - |
| 1 | 3 | 5 |
| 2 | 4 | 6 |
| 3 | 5 | 7 |
| 4 | 6 | 8 |
| 5 | 7 | 9 |

Series 2:

| C |
| - |
| 5 |
| 6 |
| 7 |
| 8 |
| 9 |

**Output**

| xMin | xMax | A | B | C | C |
| ---- | ---- | --| --| --| --|
| 1    | 2    | 1 | 0 | 0 | 0 |
| 2    | 3    | 1 | 0 | 0 | 0 |
| 3    | 4    | 1 | 1 | 0 | 0 |
| 4    | 5    | 1 | 1 | 0 | 0 |
| 5    | 6    | 1 | 1 | 1 | 1 |
| 6    | 7    | 0 | 1 | 1 | 1 |
| 7    | 8    | 0 | 1 | 1 | 1 |
| 8    | 9    | 0 | 0 | 1 | 1 |
| 9    | 10   | 0 | 0 | 1 | 1 |

Visualize the distribution of values using the generated histogram, providing insights into the data's spread and density.
  `}},joinByField:{name:"Join by field",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to merge multiple results into a single table, enabling the consolidation of data from different queries.

This is especially useful for converting multiple time series results into a single wide table with a shared time field.

#### Inner join (for Time Series or SQL-like data)

An inner join merges data from multiple tables where all tables share the same value from the selected field. This type of join excludes data where values do not match in every result.

Use this transformation to combine the results from multiple queries (combining on a passed join field or the first time column) into one result, and drop rows where a successful join cannot occur. This is not optimized for large Time Series datasets.

In the following example, two queries return Time Series data. It is visualized as two separate tables before applying the inner join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the inner join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

This works in the same way for non-Time Series tabular data as well.

**Students**

| StudentID | Name     | Major            |
| --------- | -------- | ---------------- |
| 1         | John     | Computer Science |
| 2         | Emily    | Mathematics      |
| 3         | Michael  | Physics          |
| 4         | Jennifer | Chemistry        |

**Enrollments**

| StudentID | CourseID | Grade |
|-----------|----------|-------|
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the inner join transformation looks like the following:

| StudentID | Name    | Major            | CourseID | Grade |
| --------- | ------- | ---------------- | -------  | ----- |
| 1         | John    | Computer Science | CS101    | A     |
| 1         | John    | Computer Science | CS102    | B     |
| 2         | Emily   | Mathematics      | MATH201  | A     |
| 3         | Michael | Physics          | PHYS101  | B     |

The inner join only includes rows where there is a match between the "StudentID" in both tables. In this case, the result does not include "Jennifer" from the "Students" table because there are no matching enrollments for her in the "Enrollments" table.

#### Outer join (for Time Series data)

An outer join includes all data from an inner join and rows where values do not match in every input. While the inner join joins Query A and Query B on the time field, the outer join includes all rows that don't match on the time field.

In the following example, two queries return table data. It is visualized as two tables before applying the outer join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the outer join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:04:20 |         |           | server 3 | 10     |
| 2020-07-07 11:14:20 | postgre | 345001233 |          |        |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

In the following example, a template query displays time series data from multiple servers in a table visualization. The results of only one query can be viewed at a time.

${r("/static/img/docs/transformations/join-fields-before-7-0.png",i,"A table visualization showing results for one server")}

I applied a transformation to join the query results using the time field. Now I can run calculations, combine, and organize the results in this new table.

${r("/static/img/docs/transformations/join-fields-after-7-0.png",i,"A table visualization showing results for multiple servers")}

#### Outer join (for SQL-like data)

A tabular outer join combining tables so that the result includes matched and unmatched rows from either or both tables.

| StudentID | Name      | Major            |
| --------- | --------- | ---------------- |
| 1         | John      | Computer Science |
| 2         | Emily     | Mathematics      |
| 3         | Michael   | Physics          |
| 4         | Jennifer  | Chemistry        |

Can now be joined with:

| StudentID | CourseID | Grade |
| --------- | -------- | ----- |
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the outer join transformation looks like the following:

| StudentID | Name     | Major            | CourseID | Grade |
| --------- | -------- | ---------------- | -------- | ----- |
| 1         | John     | Computer Science | CS101    | A     |
| 1         | John     | Computer Science | CS102    | B     |
| 2         | Emily    | Mathematics      | MATH201  | A     |
| 3         | Michael  | Physics          | PHYS101  | B     |
| 4         | Jennifer | Chemistry        | NULL     | NULL  |
| 5         | NULL     | NULL             | HIST101  | B     |

Combine and analyze data from various queries with table joining for a comprehensive view of your information.
  `}},joinByLabels:{name:"Join by labels",getHelperDocs:function(){return`
Use this transformation to join multiple results into a single table.

This is especially useful for converting multiple time series results into a single wide table with a shared **Label** field.

- **Join** - Select the label to join by between the labels available or common across all time series.
- **Value** - The name for the output result.

#### Example

##### Input

series1{what="Temp", cluster="A", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series2{what="Temp", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series3{what="Speed", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 22   | 22    |
| 28   | 77    |

##### Config

value: "what"

##### Output

| cluster | job | Temp | Speed |
| ------- | --- | ---- | ----- |
| A       | J1  | 10   |       |
| A       | J1  | 200  |       |
| B       | J1  | 10   | 22    |
| B       | J1  | 200  | 77    |

Combine and organize time series data effectively with this transformation for comprehensive insights.
  `}},labelsToFields:{name:"Labels to fields",getHelperDocs:function(){return`
Use this transformation to convert time series results with labels or tags into a table, including each label's keys and values in the result. Display labels as either columns or row values for enhanced data visualization.

Given a query result of two time series:

- Series 1: labels Server=Server A, Datacenter=EU
- Series 2: labels Server=Server B, Datacenter=EU

In "Columns" mode, the result looks like this:

| Time                | Server   | Datacenter | Value |
| ------------------- | -------- | ---------- | ----- |
| 2020-07-07 11:34:20 | Server A | EU         | 1     |
| 2020-07-07 11:34:20 | Server B | EU         | 2     |

In "Rows" mode, the result has a table for each series and show each label value like this:

| label      | value    |
| ---------- | -------- |
| Server     | Server A |
| Datacenter | EU       |

| label      | value    |
| ---------- | -------- |
| Server     | Server B |
| Datacenter | EU       |

#### Value field name

If you selected Server as the **Value field name**, then you would get one field for every value of the Server label.

| Time                | Datacenter | Server A | Server B |
| ------------------- | ---------- | -------- | -------- |
| 2020-07-07 11:34:20 | EU         | 1        | 2        |

#### Merging behavior

The labels to fields transformer is internally two separate transformations. The first acts on single series and extracts labels to fields. The second is the [merge](#merge) transformation that joins all the results into a single table. The merge transformation tries to join on all matching fields. This merge step is required and cannot be turned off.

To illustrate this, here is an example where you have two queries that return time series with no overlapping labels.

- Series 1: labels Server=ServerA
- Series 2: labels Datacenter=EU

This will first result in these two tables:

| Time                | Server  | Value |
| ------------------- | ------- | ----- |
| 2020-07-07 11:34:20 | ServerA | 10    |

| Time                | Datacenter | Value |
| ------------------- | ---------- | ----- |
| 2020-07-07 11:34:20 | EU         | 20    |

After merge:

| Time                | Server  | Value | Datacenter |
| ------------------- | ------- | ----- | ---------- |
| 2020-07-07 11:34:20 | ServerA | 10    |            |
| 2020-07-07 11:34:20 |         | 20    | EU         |

Convert your time series data into a structured table format for a clearer and more organized representation.
  `}},limit:{name:"Limit",getHelperDocs:function(){return`
Use this transformation to restrict the number of rows displayed, providing a more focused view of your data. This is particularly useful when dealing with large datasets.

Below is an example illustrating the impact of the **Limit** transformation on a response from a data source:

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

Here is the result after adding a Limit transformation with a value of '3':

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

This transformation helps you tailor the visual presentation of your data to focus on the most relevant information.
  `}},merge:{name:"Merge series/tables",getHelperDocs:function(){return`
Use this transformation to combine the results from multiple queries into a single result, which is particularly useful when using the table panel visualization. This transformation merges values into the same row if the shared fields contain the same data.

Here's an example illustrating the impact of the **Merge series/tables** transformation on two queries returning table data:

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |

**Query B:**

| Time                | Job     | Errors |
| ------------------- | ------- | ------ |
| 2020-07-07 11:34:20 | node    | 15     |
| 2020-07-07 11:24:20 | postgre | 5      |

Here is the result after applying the Merge transformation.

| Time                | Job     | Errors | Uptime    |
| ------------------- | ------- | ------ | --------- |
| 2020-07-07 11:34:20 | node    | 15     | 25260122  |
| 2020-07-07 11:24:20 | postgre | 5      | 123001233 |

This transformation combines values from Query A and Query B into a unified table, enhancing the presentation of data for better insights.
  `},links:[{title:"Table panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/"}]},organize:{name:"Organize fields by name",getHelperDocs:function(){return`
Use this transformation to provide the flexibility to rename, reorder, or hide fields returned by a single query in your panel. This transformation is applicable only to panels with a single query. If your panel has multiple queries, consider using an "Outer join" transformation or removing extra queries.

#### Transforming fields

Grafana displays a list of fields returned by the query, allowing you to perform the following actions:

- **Change field order** - Hover over a field, and when your cursor turns into a hand, drag the field to its new position.
- **Hide or show a field** - Use the eye icon next to the field name to toggle the visibility of a specific field.
- **Rename fields** - Type a new name in the "Rename <field>" box to customize field names.

#### Example:

##### Original Query Result

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

##### After Applying Field Overrides

| Time                | Sensor      | Reading |
| ------------------- | ----------- | ------- |
| 2020-07-07 11:34:20 | Temperature | 25      |
| 2020-07-07 11:34:20 | Humidity    | 22      |
| 2020-07-07 10:32:20 | Humidity    | 29      |

This transformation lets you to tailor the display of query results, ensuring a clear and insightful representation of your data in Grafana.
  `}},partitionByValues:{name:"Partition by values",getHelperDocs:function(){return`
Use this transformation to streamline the process of graphing multiple series without the need for multiple queries with different 'WHERE' clauses.

This is particularly useful when dealing with a metrics SQL table, as illustrated below:

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | US     | 1327  |
| 2022-10-20 01:00:00 | EU     | 912   |

With the **Partition by values** transformation, you can issue a single query and split the results by unique values in one or more columns (fields) of your choosing. The following example uses 'Region':

'SELECT Time, Region, Value FROM metrics WHERE Time > "2022-10-20"'

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 01:00:00 | US     | 1327  |

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | EU     | 912   |

This transformation simplifies the process and enhances the flexibility of visualizing multiple series within the same time series visualization.
  `}},prepareTimeSeries:{name:"Prepare time series",getHelperDocs:function(){return`
Use this transformation to address issues when a data source returns time series data in a format that isn't compatible with the desired visualization. This transformation allows you to convert time series data between wide and long formats, providing flexibility in data frame structures.

#### Available options

##### Multi-frame time series

Use this option to transform the time series data frame from the wide format to the long format. This is particularly helpful when your data source delivers time series information in a format that needs to be reshaped for optimal compatibility with your visualization.

**Example: Converting from wide to long format**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

**Transformed to:**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |


##### Wide time series

Select this option to transform the time series data frame from the long format to the wide format. If your data source returns time series data in a long format and your visualization requires a wide format, this transformation simplifies the process.

**Example: Converting from long to wide format**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |

**Transformed to:**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

> **Note:** This transformation is available in Grafana 7.5.10+ and Grafana 8.0.6+.
  `},links:[{title:"Data frames",url:"https://grafana.com/docs/grafana/latest/developers/plugins/introduction-to-plugin-development/data-frames/"}]},reduce:{name:"Reduce",getHelperDocs:function(){return`
Use this transformation to apply a calculation to each field in the data frame and return a single value. This transformation is particularly useful for consolidating multiple time series data into a more compact, summarized format. Time fields are removed when applying this transformation.

Consider the input:

**Query A:**

| Time                | Temp | Uptime  |
| ------------------- | ---- | ------- |
| 2020-07-07 11:34:20 | 12.3 | 256122  |
| 2020-07-07 11:24:20 | 15.4 | 1230233 |

**Query B:**

| Time                | AQI | Errors |
| ------------------- | --- | ------ |
| 2020-07-07 11:34:20 | 6.5 | 15     |
| 2020-07-07 11:24:20 | 3.2 | 5      |

The reduce transformer has two modes:

- **Series to rows** - Creates a row for each field and a column for each calculation.
- **Reduce fields** - Keeps the existing frame structure, but collapses each field into a single value.

For example, if you used the **First** and **Last** calculation with a **Series to rows** transformation, then
the result would be:

| Field  | First  | Last    |
| ------ | ------ | ------- |
| Temp   | 12.3   | 15.4    |
| Uptime | 256122 | 1230233 |
| AQI    | 6.5    | 3.2     |
| Errors | 15     | 5       |

The **Reduce fields** with the **Last** calculation,
results in two frames, each with one row:

**Query A:**

| Temp | Uptime  |
| ---- | ------- |
| 15.4 | 1230233 |

**Query B:**

| AQI | Errors |
| --- | ------ |
| 3.2 | 5      |

This flexible transformation simplifies the process of consolidating and summarizing data from multiple time series into a more manageable and organized format.
  `}},renameByRegex:{name:"Rename by regex",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to rename parts of the query results using a regular expression and replacement pattern.

You can specify a regular expression, which is only applied to matches, along with a replacement pattern that support back references. For example, let's imagine you're visualizing CPU usage per host and you want to remove the domain name. You could set the regex to '/^([^.]+).*/' and the replacement pattern to '$1', 'web-01.example.com' would become 'web-01'.

> **Note:** The Rename by regex transformation was improved in Grafana v9.0.0 to allow global patterns of the form '/<stringToReplace>/g'. Depending on the regex match used, this may cause some transformations to behave slightly differently. You can guarantee the same behavior as before by wrapping the match string in forward slashes '(/)', e.g. '(.*)' would become '/(.*)/'.

In the following example, we are stripping the 'A-' prefix from field names. In the before image, you can see everything is prefixed with 'A-':

${r("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-before-v11.0.png",i,"A time series with full series names")}

With the transformation applied, you can see we are left with just the remainder of the string.

${r("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-after-v11.0.png",i,"A time series with shortened series names")}

This transformation lets you to tailor your data to meet your visualization needs, making your dashboards more informative and user-friendly.
  `}},rowsToFields:{name:"Rows to fields",getHelperDocs:function(){return`
Use this transformation to convert rows into separate fields. This can be useful because fields can be styled and configured individually. It can also use additional fields as sources for dynamic field configuration or map them to field labels. The additional labels can then be used to define better display names for the resulting fields.

This transformation includes a field table which lists all fields in the data returned by the configuration query. This table gives you control over what field should be mapped to each configuration property (the **Use as** option). You can also choose which value to select if there are multiple rows in the returned data.

This transformation requires:

- One field to use as the source of field names.

  By default, the transform uses the first string field as the source. You can override this default setting by selecting **Field name** in the **Use as** column for the field you want to use instead.

- One field to use as the source of values.

  By default, the transform uses the first number field as the source. But you can override this default setting by selecting **Field value** in the **Use as** column for the field you want to use instead.

Useful when visualizing data in:

- Gauge
- Stat
- Pie chart

#### Map extra fields to labels

If a field does not map to config property Grafana will automatically use it as source for a label on the output field-

**Example:**

| Name    | DataCenter | Value |
| ------- | ---------- | ----- |
| ServerA | US         | 100   |
| ServerB | EU         | 200   |

**Output:**

| ServerA (labels: DataCenter: US) | ServerB (labels: DataCenter: EU) |
| -------------------------------- | -------------------------------- |
| 10                               | 20                               |

The extra labels can now be used in the field display name provide more complete field names.

If you want to extract config from one query and apply it to another you should use the config from query results transformation.

#### Example

**Input:**

| Name    | Value | Max |
| ------- | ----- | --- |
| ServerA | 10    | 100 |
| ServerB | 20    | 200 |
| ServerC | 30    | 300 |

**Output:**

| ServerA (config: max=100) | ServerB (config: max=200) | ServerC (config: max=300) |
| ------------------------- | ------------------------- | ------------------------- |
| 10                        | 20                        | 30                        |

As you can see each row in the source data becomes a separate field. Each field now also has a max config option set. Options like **Min**, **Max**, **Unit** and **Thresholds** are all part of field configuration and if set like this will be used by the visualization instead of any options manually configured in the panel editor options pane.

This transformation enables the conversion of rows into individual fields, facilitates dynamic field configuration, and maps additional fields to labels.
  `}},seriesToRows:{name:"Series to rows",getHelperDocs:function(){return`
Use this transformation to combine the result from multiple time series data queries into one single result. This is helpful when using the table panel visualization.

The result from this transformation will contain three columns: Time, Metric, and Value. The Metric column is added so you easily can see from which query the metric originates from. Customize this value by defining Label on the source query.

In the example below, we have two queries returning time series data. It is visualized as two separate tables before applying the transformation.

**Query A:**

| Time                | Temperature |
| ------------------- | ----------- |
| 2020-07-07 11:34:20 | 25          |
| 2020-07-07 10:31:22 | 22          |
| 2020-07-07 09:30:05 | 19          |

**Query B:**

| Time                | Humidity |
| ------------------- | -------- |
| 2020-07-07 11:34:20 | 24       |
| 2020-07-07 10:32:20 | 29       |
| 2020-07-07 09:30:57 | 33       |

Here is the result after applying the Series to rows transformation.

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

This transformation facilitates the consolidation of results from multiple time series queries, providing a streamlined and unified dataset for efficient analysis and visualization in a tabular format.

> **Note:** This transformation is available in Grafana 7.1+.
  `}},sortBy:{name:"Sort by",getHelperDocs:function(){return`
Use this transformation to sort each frame within a query result based on a specified field, making your data easier to understand and analyze. By configuring the desired field for sorting, you can control the order in which the data is presented in the table or visualization.

Use the **Reverse** switch to inversely order the values within the specified field. This functionality is particularly useful when you want to quickly toggle between ascending and descending order to suit your analytical needs.

For example, in a scenario where time-series data is retrieved from a data source, the **Sort by** transformation can be applied to arrange the data frames based on the timestamp, either in ascending or descending order, depending on the analytical requirements. This capability ensures that you can easily navigate and interpret time-series data, gaining valuable insights from the organized and visually coherent presentation.
  `}},spatial:{name:"Spatial",getHelperDocs:function(){return`
Use this transformation to apply spatial operations to query results.

- **Action** - Select an action:
  - **Prepare spatial field** - Set a geometry field based on the results of other fields.
    - **Location mode** - Select a location mode (these options are shared by the **Calculate value** and **Transform** modes):
      - **Auto** - Automatically identify location data based on default field names.
      - **Coords** - Specify latitude and longitude fields.
      - **Geohash** - Specify a geohash field.
      - **Lookup** - Specify Gazetteer location fields.
  - **Calculate value** - Use the geometry to define a new field (heading/distance/area).
    - **Function** - Choose a mathematical operation to apply to the geometry:
      - **Heading** - Calculate the heading (direction) between two points.
      - **Area** - Calculate the area enclosed by a polygon defined by the geometry.
      - **Distance** - Calculate the distance between two points.
  - **Transform** - Apply spatial operations to the geometry.
    - **Operation** - Choose an operation to apply to the geometry:
      - **As line** - Create a single line feature with a vertex at each row.
      - **Line builder** - Create a line between two points.

This transformation allows you to manipulate and analyze geospatial data, enabling operations such as creating lines between points, calculating spatial properties, and more.
  `}},timeSeriesTable:{name:"Time series to table transform",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to convert time series results into a table, transforming a time series data frame into a **Trend** field which can then be used with the [sparkline cell type][]. If there are multiple time series queries, each will result in a separate table data frame. These can be joined using join or merge transforms to produce a single table with multiple sparklines per row.

${r("/static/img/docs/transformations/table-sparklines.png",i,"A table panel showing multiple values and their corresponding sparklines.")}

For each generated **Trend** field value, a calculation function can be selected. This value is displayed next to the sparkline and will be used for sorting table rows.

${r("/static/img/docs/transformations/timeseries-table-select-stat.png",i,"A select box showing available statistics that can be calculated.")}


> **Note:** This transformation is available in Grafana 9.5+ as an opt-in beta feature. Modify the Grafana [configuration file][] to use it.
  `},links:[{title:"sparkline cell type",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/#sparkline"},{title:"configuration file",url:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/"}]},regression:{name:"Regression analysis",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to create a new data frame containing values predicted by a statistical model. This is useful for finding a trend in chaotic data. It works by fitting a mathematical function to the data, using either linear or polynomial regression. The data frame can then be used in a visualization to display a trendline.

There are two different models:

- **Linear regression** - Fits a linear function to the data.
${r("/static/img/docs/transformations/linear-regression.png",i,"A time series visualization with a straight line representing the linear function")}
- **Polynomial regression** - Fits a polynomial function to the data.
${r("/static/img/docs/transformations/polynomial-regression.png",i,"A time series visualization with a curved line representing the polynomial function")}

> **Note:** This transformation is currently in public preview. Grafana Labs offers limited support, and breaking changes might occur prior to the feature being made generally available. Enable the \`regressionTransformation\` feature toggle in Grafana to use this feature. Contact Grafana Support to enable this feature in Grafana Cloud.
  `}}};function o(){return`
  Go to the <a href="https://grafana.com/docs/grafana/latest/panels/transformations/?utm_source=grafana" target="_blank" rel="noreferrer">
  transformation documentation
  </a> for more general documentation.
  `}function r(i,f,d){return f==="shortcodeFigure"?`{{< figure src="${i}" class="docs-image--no-shadow" max-width= "1100px" alt="${d}" >}}`:`![${d}](https://grafana.com${i})`}},9581:(Q,I,e)=>{"use strict";e.d(I,{YD:()=>r,dy:()=>a,kD:()=>o});var n=e(52622),a=(f=>(f.Prepare="prepare",f.Calculate="calculate",f.Modify="modify",f))(a||{}),o=(f=>(f.Heading="heading",f.Distance="distance",f.Area="area",f))(o||{}),r=(f=>(f.AsLine="asLine",f.LineBuilder="lineBuilder",f))(r||{});const i={action:"prepare",source:{mode:n.aG.Auto}}},78134:(Q,I,e)=>{"use strict";e.d(I,{EX:()=>s,pp:()=>u,tt:()=>l});var n=e(70915),a=e(11217),o=e(44294),r=e(22796),i=e(52490),f=e(11261),d=e(9581);function l(b){const g=[];for(const P of b.values)P&&g.push(s(P));return new a.A(g)}function m(b){const g=new Array(b.length);if(b.length>1){let P=h(b[0]);for(let c=1;c<b.length;c++){let y=h(b[c]);if(P&&y){let p=Math.atan2(y[0]-P[0],y[1]-P[1])*180/Math.PI;p<0&&(p+=360),g[c-1]=g[c]=p}}}else g.fill(0);return g}function s(b){return b instanceof o.A?b.getCoordinates():(0,n.q1)(b.getExtent())}function h(b){if(b)return(0,r.WP)(s(b))}function u(b,g){const P=b.values,c=new Array(b.values.length),y=g.calc??d.kD.Heading,p=g.field??y;switch(y){case d.kD.Area:{for(let v=0;v<P.length;v++){const D=P[v];D&&(c[v]=(0,i.UG)(D))}return{name:p,type:f.PU.number,config:{unit:"areaM2"},values:c}}case d.kD.Distance:{for(let v=0;v<P.length;v++){const D=P[v];D&&(c[v]=(0,i.R3)(D))}return{name:p,type:f.PU.number,config:{unit:"lengthm"},values:c}}case d.kD.Heading:default:return{name:p,type:f.PU.number,config:{unit:"degree"},values:m(P)}}}},88841:(Q,I,e)=>{"use strict";e.d(I,{y:()=>P});var n=e(32196),a=e(34743),o=e(36376),r=e(7315),i=e(96540),f=e(40845),d=e(17464),l=e(40276),m=e(72093),s=e(10354),h=e(43538);const u=(y,p)=>y-p*Math.floor(y/p),b=8,g=(y,p)=>({suggestionsWrapper:(0,n.css)({boxShadow:y.shadows.z2}),errorTooltip:(0,n.css)({position:"absolute",top:p+b+"px",zIndex:y.zIndex.tooltip}),inputWrapper:(0,n.css)({position:"relative"})}),P=({value:y="",onChange:p,suggestions:v,placeholder:D,error:E,invalid:S})=>{const[T,M]=(0,i.useState)(!1),[A,x]=(0,i.useState)(0),[C,O]=(0,i.useState)(y.toString()),[R,L]=(0,i.useState)(0),[N,F]=(0,i.useState)(0),[K,B]=(0,i.useState)(0),w=(0,f.$j)(),U=g(w,N),W=(0,i.useRef)(),V=[(0,a.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,a.BN)()],{refs:_,floatingStyles:H}=(0,o.we)({open:T,placement:"bottom-start",onOpenChange:M,middleware:V,whileElementsMounted:r.ll,strategy:"fixed"}),G=(0,i.useCallback)(ee=>{_.setReference(ee),W.current=ee},[_]),j=(0,i.useRef)(null);(0,i.useEffect)(()=>{L(c(j.current,A))},[A]);const Y=i.useCallback((ee,Z=W.current)=>{const z=Z.selectionStart,q=Z.value;q[K-1]==="$"?Z.value=q.slice(0,K)+ee.value+q.slice(z):Z.value=q.slice(0,K)+"$"+ee.value+q.slice(z),O(Z.value),M(!1),x(0),p(Z.value)},[p,K]),oe=i.useCallback(ee=>{if(!T){if(ee.key==="$"||ee.key===" "&&ee.ctrlKey){B(W.current.selectionStart||0),M(!0);return}return}switch(ee.key){case"Backspace":case"Escape":case"ArrowLeft":case"ArrowRight":return M(!1),x(0);case"Enter":return ee.preventDefault(),Y(v[A]);case"ArrowDown":case"ArrowUp":ee.preventDefault();const Z=ee.key==="ArrowDown"?1:-1;return x(z=>u(z+Z,v.length));default:return}},[T,v,A,Y]),se=i.useCallback(ee=>{O(ee.currentTarget.value)},[]),ne=i.useCallback(ee=>{p(ee.currentTarget.value)},[p]);return(0,i.useEffect)(()=>{F(W.current.clientHeight)},[]),i.createElement("div",{className:U.inputWrapper},T&&i.createElement(d.ZL,null,i.createElement("div",{ref:_.setFloating,style:H,className:U.suggestionsWrapper},i.createElement(l.E,{scrollTop:R,autoHeightMax:"300px",setScrollTop:({scrollTop:ee})=>L(ee)},i.createElement(h.k,{activeRef:j,suggestions:v,onSuggestionSelect:Y,onClose:()=>M(!1),activeIndex:A})))),S&&E&&i.createElement("div",{className:U.errorTooltip},i.createElement(m.P,null,E)),i.createElement(s.p,{placeholder:D,invalid:S,ref:G,value:C,onChange:se,onBlur:ne,onKeyDown:oe}))};P.displayName="SuggestionsInput";function c(y,p){return(y?.clientHeight??0)*p}},94397:(Q,I,e)=>{"use strict";e.d(I,{N_:()=>l,ZI:()=>i,aG:()=>f,eJ:()=>d,qt:()=>m});var n=e(96540),a=e(28240),o=e(91410),r=e(32264);function i(s){return(0,n.useMemo)(()=>Array.isArray(s)?Object.keys(s.reduce((h,u)=>!u||!Array.isArray(u.fields)?h:u.fields.reduce((b,g)=>{const P=(0,a.Ct)(g,u,s);return b[P]=!0,b},h),{})):[],[s])}function f(s){const h=new Set;for(const u of s)for(const b of u.fields)if(b.labels)for(const g of Object.keys(b.labels))h.add(g);return h}const d={combine:"Combine",calculateNewFields:"Calculate new fields",createNewVisualization:"Create new visualization",filter:"Filter",performSpatialOperations:"Perform spatial operations",reformat:"Reformat",reorderAndRename:"Reorder and rename"},l=s=>!!(typeof s=="number"||!Number.isNaN(Number(s))||/^\$[A-Za-z0-9_]+$/.test(s)&&r.$.featureToggles.transformationsVariableSupport);function m(s){const h=[];s&&(h.push({label:"Browser",value:"browser"}),h.push({label:"UTC",value:"utc"}));const u=(0,o.P3)();for(const b of u)h.push({label:b,value:b});return h}},87617:(Q,I,e)=>{"use strict";e.d(I,{$u:()=>h,Ay:()=>P,Cj:()=>l,EC:()=>s,Y_:()=>d,dJ:()=>u,g4:()=>m,jE:()=>b,t_:()=>i});var n=e(65307),a=e(2913);const o={users:[],searchQuery:"",page:0,perPage:30,totalPages:1,externalUserMngInfo:a.Ay.externalUserMngInfo,externalUserMngLinkName:a.Ay.externalUserMngLinkName,externalUserMngLinkUrl:a.Ay.externalUserMngLinkUrl,isLoading:!1,rolesLoading:!1},r=(0,n.Z0)({name:"users",initialState:o,reducers:{usersLoaded:(c,y)=>{const{totalCount:p,perPage:v,page:D,orgUsers:E}=y.payload,S=Math.ceil(p/v);return{...c,isLoading:!0,users:E,perPage:v,page:D,totalPages:S}},searchQueryChanged:(c,y)=>({...c,searchQuery:y.payload,page:o.page}),setUsersSearchPage:(c,y)=>({...c,page:y.payload}),pageChanged:(c,y)=>({...c,page:y.payload}),sortChanged:(c,y)=>({...c,sort:y.payload}),usersFetchBegin:c=>({...c,isLoading:!0}),usersFetchEnd:c=>({...c,isLoading:!1}),rolesFetchBegin:c=>({...c,rolesLoading:!0}),rolesFetchEnd:c=>({...c,rolesLoading:!1})}}),{searchQueryChanged:i,setUsersSearchPage:f,usersLoaded:d,usersFetchBegin:l,usersFetchEnd:m,pageChanged:s,sortChanged:h,rolesFetchBegin:u,rolesFetchEnd:b}=r.actions,P={users:r.reducer}},20601:(Q,I,e)=>{"use strict";e.d(I,{B:()=>a});var n=e(83077);const a=new n.O},26260:(Q,I,e)=>{"use strict";e.d(I,{$u:()=>g,D4:()=>y,Iv:()=>p,U2:()=>c,VT:()=>P,z_:()=>b});var n=e(2543),a=e.n(n),o=e(31193),r=e(3843),i=e(24240),f=e(72401),d=e(48594),l=e(87421),m=e(56968),s=e(75096),h=e(53699);const u="Filters",b=E=>async(S,T)=>{let M=D(E,T());if(!M&&(S(v(E)),M=D(E,T()),!M))return;const A=M.filters.findIndex(C=>C.key===E.key&&C.value===E.value);if(A===-1){const{value:C,key:O,operator:R}=E,L={value:C,key:O,operator:R};return await S(c((0,s.jX)(M),L))}const x={...M.filters[A],operator:E.operator};return await S(g((0,s.jX)(M),{index:A,filter:x}))},g=(E,S)=>async(T,M)=>{const A=(0,l.dn)(E,M());T((0,d.kb)(E.rootStateKey,(0,h.E2)((0,s.qD)(A,S)))),await T((0,f.us)((0,s.jX)(A),!0))},P=(E,S)=>async(T,M)=>{const A=(0,l.dn)(E,M());T((0,d.kb)(E.rootStateKey,(0,h.D$)((0,s.qD)(A,S)))),await T((0,f.us)((0,s.jX)(A),!0))},c=(E,S)=>async(T,M)=>{const A=(0,l.dn)(E,M());T((0,d.kb)(E.rootStateKey,(0,h.xt)((0,s.qD)(A,S)))),await T((0,f.us)((0,s.jX)(A),!0))},y=(E,S)=>async(T,M)=>{const A=(0,l.dn)(E,M());T((0,d.kb)(E.rootStateKey,(0,h.qZ)((0,s.qD)(A,S)))),await T((0,f.us)((0,s.jX)(A),!0))},p=(E,S)=>async(T,M)=>{const A=(0,l.dn)(E,M());T((0,d.kb)(E.rootStateKey,(0,m.QP)((0,s.qD)(A,{propName:"datasource",propValue:S}))));const C=(await(0,o.tR)().get(S))?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.";T((0,d.kb)(E.rootStateKey,(0,r.BC)({infoText:C})))},v=E=>(S,T)=>{const M=(0,l.y7)(T()),A={...(0,n.cloneDeep)(h.MK),datasource:E.datasource,name:u,id:u,rootStateKey:M},x=!1,C=(0,l.hk)(M,T()),O={type:"adhoc",id:A.id,rootStateKey:M};S((0,d.kb)(M,(0,m.QV)((0,s.qD)(O,{global:x,model:A,index:C}))))},D=(E,S)=>{const T=(0,l.y7)(S),M=(0,l.nx)(T,S);let A;for(const x of Object.values(M.variables))if((0,i.EW)(x)&&x.datasource?.uid===E.datasource.uid){A=x;break}return A}},53699:(Q,I,e)=>{"use strict";e.d(I,{AA:()=>h,D$:()=>l,E2:()=>m,MK:()=>i,qZ:()=>s,xt:()=>d});var n=e(65307),a=e(80484),o=e(87421),r=e(83370);const i={...a.Vg,type:"adhoc",datasource:null,filters:[]},f=(0,n.Z0)({name:"templating/adhoc",initialState:r.j,reducers:{filterAdded:(u,b)=>{const g=(0,o.Fs)(u,b.payload.id);g.type==="adhoc"&&g.filters.push(b.payload.data)},filterRemoved:(u,b)=>{const g=(0,o.Fs)(u,b.payload.id);if(g.type!=="adhoc")return;const P=b.payload.data;g.filters.splice(P,1)},filterUpdated:(u,b)=>{const g=(0,o.Fs)(u,b.payload.id);if(g.type!=="adhoc")return;const{filter:P,index:c}=b.payload.data;g.filters[c]=P},filtersRestored:(u,b)=>{const g=(0,o.Fs)(u,b.payload.id);g.type==="adhoc"&&(g.filters=b.payload.data)}}}),{filterAdded:d,filterRemoved:l,filterUpdated:m,filtersRestored:s}=f.actions,h=f.reducer},13344:(Q,I,e)=>{"use strict";e.d(I,{Ek:()=>i,To:()=>o,Zm:()=>a,ou:()=>r,qF:()=>n,qz:()=>f});const n="00000000-0000-0000-0000-000000000000",a="All",o="$__all",r="None",i="",f="var-"},35589:(Q,I,e)=>{"use strict";e.d(I,{c:()=>d,z:()=>l});var n=e(92145),a=e(96540),o=e(13544),r=e(40845),i=e(21744),f=e(85140);const d="Grafana-LegacyVariableQueryEditor",l=({onChange:m,query:s})=>{const h=(0,r.of)(f.$),[u,b]=(0,a.useState)(s),g=y=>{b(y.currentTarget.value)},P=(0,a.useCallback)(y=>{m(y.currentTarget.value,y.currentTarget.value)},[m]),c=(0,n.Bi)();return a.createElement(i.f,{id:c,rows:2,value:u,onChange:g,onBlur:P,placeholder:"Metric name or tags query",required:!0,"data-testid":o.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsQueryInput,cols:52,className:h.textarea})};l.displayName=d},70766:(Q,I,e)=>{"use strict";e.d(I,{y:()=>f});var n=e(96540),a=e(72574),o=e(54427),r=e(24240),i=e(35589);async function f(l,m=o.cS){if((0,r.zs)(l))return l.variables.editor;if((0,r.X3)(l)){const s=await m(l.meta);if(!s.components.QueryEditor)throw new Error("Missing QueryEditor in plugin definition.");return s.components.QueryEditor??null}return(0,r.Hf)(l)?d:(0,r.d5)(l)?(await m(l.meta)).components.VariableQueryEditor??i.z:null}function d({datasource:l,query:m,onChange:s}){const h=(0,n.useCallback)(u=>{s({refId:"StandardVariableQuery",query:u})},[s]);return n.createElement(i.z,{query:m.query,onChange:h,datasource:l,templateSrv:(0,a.w)()})}},3843:(Q,I,e)=>{"use strict";e.d(I,{BC:()=>m,DW:()=>f,Eo:()=>h,FN:()=>i,NY:()=>s,T7:()=>l,nS:()=>a,sJ:()=>d,wf:()=>r,y8:()=>u});var n=e(65307);const a={id:"",isValid:!0,errors:{},name:"",extended:null},o=(0,n.Z0)({name:"templating/editor",initialState:a,reducers:{variableEditorMounted:(b,g)=>{b.name=g.payload.name,b.id=g.payload.id},variableEditorUnMounted:(b,g)=>a,changeVariableNameSucceeded:(b,g)=>{b.name=g.payload.data.newName,delete b.errors.name,b.isValid=Object.keys(b.errors).length===0},changeVariableNameFailed:(b,g)=>{b.name=g.payload.newName,b.errors.name=g.payload.errorText,b.isValid=Object.keys(b.errors).length===0},addVariableEditorError:(b,g)=>{b.errors[g.payload.errorProp]=g.payload.errorText,b.isValid=Object.keys(b.errors).length===0},removeVariableEditorError:(b,g)=>{delete b.errors[g.payload.errorProp],b.isValid=Object.keys(b.errors).length===0},changeVariableEditorExtended:(b,g)=>{b.extended={...b.extended,...g.payload}},cleanEditorState:()=>a}}),r=o.reducer,{changeVariableNameSucceeded:i,changeVariableNameFailed:f,variableEditorMounted:d,variableEditorUnMounted:l,changeVariableEditorExtended:m,addVariableEditorError:s,removeVariableEditorError:h,cleanEditorState:u}=o.actions},85830:(Q,I,e)=>{"use strict";e.d(I,{M:()=>n});var n=(a=>(a[a.MaxSize=50]="MaxSize",a))(n||{})},25304:(Q,I,e)=>{"use strict";e.d(I,{z:()=>r});var n=e(72574),a=e(20601),o=e(13344);function r(i){const f={},d=(0,n.w)().getVariables();for(let l=0;l<d.length;l++){const m=d[l],s=i&&i[m.name];m.skipUrlSync||(s?f[o.qz+m.name]=s.value:f[o.qz+m.name]=a.B.get(m.type).getValueForUrl(m))}return f}},24240:(Q,I,e)=>{"use strict";e.d(I,{CH:()=>P,EW:()=>r,Hf:()=>h,P4:()=>o,SP:()=>d,VN:()=>g,VO:()=>i,X3:()=>b,d5:()=>s,iv:()=>f,m8:()=>l,zs:()=>u});var n=e(29505),a=e(35589);const o=c=>c.type==="query",r=c=>c.type==="adhoc",i=c=>c.type==="constant",f=c=>"multi"in c,d=c=>"options"in c,l=c=>"current"in c;function m(c){return c===null?!1:typeof c=="string"}const s=c=>!!c.metricFindQuery&&!c.variables,h=c=>{if(!c.variables||c.variables.getType()!==n.Qz.Standard)return!1;const y=c.variables;return"toDataQuery"in y&&!!y.toDataQuery},u=c=>{if(!c.variables||c.variables.getType()!==n.Qz.Custom)return!1;const y=c.variables;return"query"in y&&"editor"in y&&!!y.query&&!!y.editor},b=c=>c.variables?c.variables.getType()===n.Qz.Datasource:!1;function g(c,y){return c?c.displayName===a.c||s(y):!1}function P(c,y){return c?c.displayName!==a.c&&(b(y)||h(y)||u(y)):!1}},27238:(Q,I,e)=>{"use strict";e.d(I,{WT:()=>a,bX:()=>i,t4:()=>r});var n=e(65307);const a={usages:[],usagesNetwork:[]},o=(0,n.Z0)({name:"templating/inspect",initialState:a,reducers:{initInspect:(f,d)=>{const{usages:l,usagesNetwork:m}=d.payload;f.usages=l,f.usagesNetwork=m}}}),r=o.reducer,{initInspect:i}=o.actions},12846:(Q,I,e)=>{"use strict";e.d(I,{qJ:()=>h,hI:()=>m,hM:()=>c,H7:()=>s,xU:()=>v,P5:()=>x,g0:()=>y,PK:()=>M,Ow:()=>S});var n=e(6709);function a(C,O){const R=new Set;for(const L of C)R.add(O(L));return R}var o=e(84423),r=e(87490),i=e(34214),f=e(20601),d=e(24240),l=e(75096);const m=C=>{const O=[];for(const R of C)O.push({id:R.id,label:`${R.id}`});return O},s=(C,O)=>C.filter(R=>O.some(L=>L.from===R.id||L.to===R.id)),h=C=>{const O=[];for(const R of C)for(const L of C){if(R===L)continue;f.B.get(R.type).dependsOn(R,L)&&O.push({from:R.id,to:L.id})}return O};function u(C){const O=(0,l.t4)(C);if(!O)return;const R=O.slice(1).find(L=>L!==void 0);if(!(R in{}))return R}const b=(C,O)=>{l.SY.lastIndex=0;const R=[],N=(0,r.MA)(O,2).match(l.SY);if(!N)return R;for(const F of N){if(!F||F.indexOf("$__")!==-1||F.indexOf("${__")!==-1||F.indexOf("$hashKey")!==-1)continue;const K=u(F);C.some(B=>B.id===K)||R.find(B=>B===K)||K&&R.push(K)}return R},g={alias:[/^m$/,/^measurement$/,/^col$/,/^tag_(\w+|\d+)$/],query:[/^timeFilter$/]},P=(C,O,R)=>{const L=Object.keys(O.value).reduce((F,K)=>{const B=O.value[K];if(!B||typeof B!="string")return F;const w=g[K]?g[K].find(W=>W.test(C)):void 0;let U=(0,l.wJ)(B,C);return K==="repeat"&&B===C&&(U=!0),!w&&U&&(F={...F,[K]:B}),F},{}),N=Object.keys(O.value).reduce((F,K)=>{const B=O.value[K];if(B&&typeof B=="object"&&Object.keys(B).length){let w=B.title||B.name||B.id||K;Array.isArray(O.value)&&O.key==="panels"&&(w=`${w}[${B.id}]`);const U=P(C,{key:K,value:B},{});Object.keys(U).length&&(F={...F,[w]:U})}return F},{});return(Object.keys(L).length||Object.keys(N).length)&&(R={...R,...L,...N}),R},c=(C,O)=>{if(!O)return{unUsed:[],usages:[]};const R=[];let L=[];const N=O.getSaveModelCloneOld();for(const F of C){const K=F.id,B=P(K,{key:"model",value:N},{});!Object.keys(B).length&&!(0,d.EW)(F)&&R.push(F),Object.keys(B).length&&L.push({variable:F,tree:B})}return{unUsed:R,usages:L}};async function y(C,O){return new Promise((R,L)=>{setTimeout(()=>{try{const N=p(C,O);R(S(N))}catch(N){L(N)}},200)})}function p(C,O){if(!O)return[];let R=[];const L=O.getSaveModelCloneOld(),N=b(C,L);for(const F of N){const K=P(F,{key:"model",value:L},{});if(Object.keys(K).length){const B={id:F,name:F};R.push({variable:B,tree:K})}}return R}function v(C,O,R){const L=a(O.descendants(C),F=>F.name);L.add(n.c.includeVars);for(const F of C)L.add(F);return D([...L],R)}function D(C,O){const R=[];for(const L of C)O[L]&&R.push(...O[L]);return new Set(R)}const E=(C,O)=>{const{id:R,value:L}=O,{nodes:N,edges:F}=C;if(L&&typeof L=="string"){const K=`${O.id}-${L}`;return N.push({id:K,label:L}),F.push({from:K,to:R}),C}if(L&&typeof L=="object"){const K=Object.keys(L);for(const B of K){const w=`${O.id}-${B}`;N.push({id:w,label:B}),F.push({from:w,to:R}),C=E(C,{id:w,value:L[B]})}return C}return C},S=C=>{const O=[];for(const R of C){const{variable:L,tree:N}=R,F={variable:L,nodes:[{id:"dashboard",label:"dashboard"}],edges:[],showGraph:!1};O.push(E(F,{id:"dashboard",value:N}))}return O},T=C=>Object.values(C).reduce((R,L)=>typeof L=="object"?R+T(L):R+1,0),M=(C,O)=>{const R=O.find(L=>L.variable.id===C);return R?T(R.tree):0};function A(C){const O=[];for(const R of C)O.push(R),R.panels?.length&&O.push(...A(R.panels.map(L=>new PanelModel(L))));return O}function x(C){const O={};for(const R of C){const L=(0,o.tw)(R),N=[...L.matchAll(/"repeat":"([^"]+)"/g)].map(B=>B[1]),F=L.match(l.SY)?.map(B=>u(B))??[],K=[...N,...F];for(const B of K)B in O?O[B].add(R.id):O[B]=new Set([R.id])}return O}},81515:(Q,I,e)=>{"use strict";e.d(I,{E5:()=>s,Ez:()=>l,mn:()=>h});var n=e(65307),a=e(2543),o=e.n(a),r=e(12470),i=e(87421),f=e(83370),d=e(80484);const l={...d.Vg,type:"interval",auto_count:30,auto_min:"10s",options:[],auto:!1,query:"1m,10m,30m,1h,6h,12h,1d,7d,14d,30d",refresh:r.CO.onTimeRangeChanged,current:{}},m=(0,n.Z0)({name:"templating/interval",initialState:f.j,reducers:{createIntervalOptions:(u,b)=>{const g=(0,i.Fs)(u,b.payload.id);if(g.type!=="interval")return;const P=(0,a.map)(g.query.match(/(["'])(.*?)\1|\w+/g),c=>(c=c.replace(/["']+/g,""),{text:c.trim(),value:c.trim(),selected:!1}));g.auto&&P.length&&P[0].text!=="auto"&&P.unshift({text:"auto",value:"$__auto_interval_"+g.name,selected:!1}),g.options=P}}}),s=m.reducer,{createIntervalOptions:h}=m.actions},24300:(Q,I,e)=>{"use strict";e.d(I,{jR:()=>x,Fu:()=>D,$z:()=>l,O$:()=>E,ho:()=>C,MO:()=>v,an:()=>S,U9:()=>p,fx:()=>M,qh:()=>A,S8:()=>T});var n=e(53076),a=e(65307),o=e(2543),r=e(92053);const i=(O,...R)=>R.reduce((L,N)=>N(L),O);var f=e(13344),d=e(24240);const l={id:"",highlightIndex:-1,queryValue:"",selectedValues:[],options:[],multi:!1},m=1e3,s=new n.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),h=O=>Array.isArray(O)?O.reduce((R,L)=>((0,o.isString)(L.value)&&(R[L.value]=L),R),{}):{},u=O=>{if(!Array.isArray(O.options))return O.options=[],O;const R=h(O.selectedValues);return O.selectedValues=Object.values(R),O.options=O.options.map(L=>{if(!(0,o.isString)(L.value))return L;const N=!!R[L.value];return L.selected===N?L:{...L,selected:N}}),O.options=b(O.options),O},b=O=>Array.isArray(O)?O.length<=m?O:O.slice(0,m):[],g=O=>{const{options:R,selectedValues:L}=O;return R.length===0||L.length>0||!R[0]||R[0].value!==f.To||(O.selectedValues=[{...R[0],selected:!0}]),O},P=O=>{const{selectedValues:R}=O;return R.length>1&&(O.selectedValues=R.filter(L=>L.value!==f.To)),O},c=O=>O.filter(R=>R.value!==f.To).map(R=>({...R,selected:!0})),y=(0,a.Z0)({name:"templating/optionsPicker",initialState:l,reducers:{showOptions:(O,R)=>{const{query:L,options:N}=R.payload;if(O.highlightIndex=-1,O.options=(0,o.cloneDeep)(N),O.id=R.payload.id,O.queryValue="",O.multi=!1,(0,d.iv)(R.payload)&&(O.multi=R.payload.multi??!1),(0,d.P4)(R.payload)){const{queryValue:F}=R.payload,K=(0,r.E)(L);O.queryValue=K&&F?F:""}return O.selectedValues=O.options.filter(F=>F.selected),i(O,g,u)},hideOptions:(O,R)=>({...l}),toggleOption:(O,R)=>{const{option:L,clearOthers:N,forceSelect:F}=R.payload,{multi:K,selectedValues:B}=O;if(L){const w=!B.find(U=>U.value===L.value&&U.text===L.text);if(L.value===f.To||!K||N)return w||F?O.selectedValues=[{...L,selected:!0}]:O.selectedValues=[],i(O,g,P,u);if(F||w)return O.selectedValues.push({...L,selected:!0}),i(O,g,P,u);O.selectedValues=B.filter(U=>U.value!==L.value&&U.text!==L.text)}else O.selectedValues=[];return i(O,g,P,u)},moveOptionsHighlight:(O,R)=>{let L=O.highlightIndex+R.payload;return L<0?L=-1:L>=O.options.length&&(L=O.options.length-1),{...O,highlightIndex:L}},toggleAllOptions:(O,R)=>{const L=O.selectedValues.find(F=>F.value===f.To),N=O.options.find(F=>F.value===f.To);return O.selectedValues.length>0&&N&&!L?(O.selectedValues=[],O.selectedValues.push({text:N.text??"All",value:N.value,selected:!0}),i(O,u)):L&&O.selectedValues.length===1?(O.selectedValues=c(O.options),i(O,u)):O.selectedValues.length>0&&!N?(O.selectedValues=[],i(O,u)):(O.selectedValues=c(O.options),i(O,u))},updateSearchQuery:(O,R)=>(O.queryValue=R.payload,O),updateOptionsAndFilter:(O,R)=>{const L=O.queryValue.trim();let N=[];if(L==="")N=R.payload;else{const F=R.payload.map(({text:U})=>Array.isArray(U)?U.toString():U),[K,B,w]=s.search(F,L,5);K?.length&&(B&&w?N=w.map(U=>R.payload[B.idx[U]]):N=K.map(U=>R.payload[U]),N.sort((U,W)=>(U.value===f.To?-1:0)-(W.value===f.To?-1:0)))}if(O.highlightIndex=0,L!==""){let F=N.findIndex(K=>K.value!==f.To);(F===-1||N[F].value!==L)&&(N.unshift({selected:!1,text:"> "+L,value:L}),O.highlightIndex=F===-1?0:F+1)}return O.options=N,i(O,g,u)},updateOptionsFromSearch:(O,R)=>(O.options=R.payload,O.highlightIndex=0,i(O,g,u)),cleanPickerState:()=>l}}),{toggleOption:p,showOptions:v,hideOptions:D,moveOptionsHighlight:E,toggleAllOptions:S,updateSearchQuery:T,updateOptionsAndFilter:M,updateOptionsFromSearch:A,cleanPickerState:x}=y.actions,C=y.reducer},86886:(Q,I,e)=>{"use strict";e.d(I,{C:()=>n});const n=(r,i)=>r&&(i&&!Array.isArray(r.value)?{...r,value:o(r.value),text:o(r.text)}:!i&&Array.isArray(r.value)?{...r,value:a(r.value),text:a(r.text)}:r),a=r=>Array.isArray(r)?r.length>0?r[0]:"":r,o=r=>Array.isArray(r)?r:[r]},72401:(Q,I,e)=>{"use strict";e.d(I,{Y7:()=>ke,TI:()=>se,_m:()=>$e,_q:()=>Ue,RK:()=>Ie,t9:()=>Se,x7:()=>de,Hn:()=>Ne,mZ:()=>Ze,kl:()=>fe,us:()=>ce});var n=e(2543),a=e(12470),o=e(92041),r=e(39070),i=e(22391),f=e(12131),d=e(32264),l=e(82467),m=e(16233),s=e(74856),h=e(99140),u=e(3169),b=e(10096),g=e(27677),P=e(34525),c=e(31193),y=e(23989),p=e(20601),v=e(13344),D=e(3843),E=e(24240),S=e(12846),T=e(24300),M=e(86886),A=e(80484),x=e(75096),C=e(73134),O=e(28601),R=e(48594),L=e(84014);const N=(Le,re=-1,X=!1,le=!1)=>{const be={};if(le){const De={...initialVariableModelState,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"A dashboard title",uid:"An dashboard UID",toString:()=>"A dashboard title"}}},Te={...initialVariableModelState,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"An org name",id:1,toString:()=>"1"}}},we={...initialVariableModelState,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{login:"admin",id:1,email:"admin@test",toString:()=>"1"}}};be[De.id]=De,be[Te.id]=Te,be[we.id]=we}for(let De=0;De<Le;De++)be[De]=createQueryVariable({id:De.toString(),name:`Name-${De}`,label:`Label-${De}`,index:De});return X&&(be[NEW_VARIABLE_ID]=createQueryVariable({id:NEW_VARIABLE_ID,name:`Name-${NEW_VARIABLE_ID}`,label:`Label-${NEW_VARIABLE_ID}`,index:Le})),be},F=(Le,re={})=>{const X={id:"0",rootStateKey:"key",index:0,name:"0"};return{initialState:{0:{...{...Le.initialState,...X},...re}}}},K=()=>combineReducers({dashboard:dashboardReducer,templating:keyedVariablesReducer}),B=()=>combineReducers({templating:keyedVariablesReducer});function w(Le,re){return{templating:{lastKey:Le,keys:{[Le]:{...getInitialTemplatingState(),...re}}}}}function U(Le,re){return Le.find(le=>le.name===re)}function W(Le){return(Le.type==="query"||Le.type==="datasource"||Le.type==="interval")&&Le.refresh===C.CO.onTimeRangeChanged}var V=e(87421),_=e(56968),H=e(85675),G=e(15120);const j=(Le,re)=>(X,le)=>{let be=0;const De=re.templating.list;for(let we=0;we<De.length;we++){const Ke=Y(De[we]);Ke.rootStateKey=Le,p.B.getIfExists(Ke.type)&&X((0,R.kb)(Le,(0,_.QV)((0,x.qD)(Ke,{global:!1,index:be++,model:Ke}))))}(0,y.w)().updateTimeRange((0,s.jG)().timeRange());const Te=(0,V.SS)(Le,le());for(const we of Te)X((0,R.kb)(Le,(0,_.wB)((0,x.qD)(we))))};function Y(Le){if(!(0,E.SP)(Le))return Le;let re=!1;for(const X of Le.options)if(X.selected=!1,Array.isArray(Le.current.value))for(const le of Le.current.value)X.value===le&&(X.selected=re=!0);else X.value===Le.current.value&&(X.selected=re=!0);return!re&&Le.options.length&&(Le.options[0].selected=!0),Le}const oe=(Le,re)=>X=>{const le={...A.Vg,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:a.zL.hideVariable,current:{value:{name:re.title,uid:re.uid,toString:()=>re.title}}};X((0,R.kb)(Le,(0,_.QV)((0,x.qD)(le,{global:le.global,index:le.index,model:le}))));const be={...A.Vg,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:a.zL.hideVariable,current:{value:{name:m.TP.user.orgName,id:m.TP.user.orgId,toString:()=>m.TP.user.orgId.toString()}}};X((0,R.kb)(Le,(0,_.QV)((0,x.qD)(be,{global:be.global,index:be.index,model:be}))));const De={...A.Vg,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:a.zL.hideVariable,current:{value:{login:m.TP.user.login,id:m.TP.user.id,email:m.TP.user.email,toString:()=>m.TP.user.id.toString()}}};X((0,R.kb)(Le,(0,_.QV)((0,x.qD)(De,{global:De.global,index:De.index,model:De}))))},se=(Le,re)=>(X,le)=>{const{rootStateKey:be}=Le,De=(0,V.dn)(Le,le());if(!(0,E.iv)(De)||(0,o.R)(De.current))return;const Te=(0,M.C)(De.current,re);X((0,R.kb)(be,(0,_.QP)((0,x.qD)(Le,{propName:"multi",propValue:re})))),X((0,R.kb)(be,(0,_.QP)((0,x.qD)(Le,{propName:"current",propValue:Te}))))},ne=async(Le,re)=>{if(!Le.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${Le.id}`);if(ee(Le,re))throw new Error("Circular dependency in dashboard variables detected. Dashboard may not work as expected.");const X=Z(Le,re);z(Le.rootStateKey,X,re)&&await new Promise(le=>{const be=h.M_.subscribe(()=>{if(!Le.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${Le.id}`);z(Le.rootStateKey,X,h.M_.getState())||(be(),le())})})},ee=(Le,re,X=new Set)=>X.has(Le.id)?!0:(X=new Set([...X,Le.id]),Z(Le,re).some(le=>ee(le,re,X))),Z=(Le,re)=>{if(!Le.rootStateKey)return[];const X=[];for(const le of(0,V.SS)(Le.rootStateKey,re))Le!==le&&p.B.getIfExists(Le.type)&&p.B.get(Le.type).dependsOn(Le,le)&&X.push(le);return X},z=(Le,re,X)=>{if(re.length===0)return!1;const le=(0,V.SS)(Le,X);return re.filter(De=>le.some(Te=>Te.id===De.id&&(Te.state===r.Gu.NotStarted||Te.state===r.Gu.Loading))).length>0},q=(Le,re)=>async(X,le)=>{const be=(0,V.dn)(Le,le());await ne(be,le());const De=re[v.qz+be.name];if(De!==void 0){const Te=(0,x.QT)(De);await p.B.get(be.type).setValueFromUrl(be,Te);return}if(be.hasOwnProperty("refresh")){const Te=be;if(Te.refresh===a.CO.onDashboardLoad||Te.refresh===a.CO.onTimeRangeChanged){await X(Ze((0,x.jX)(Te)));return}}if(be.type==="custom"){await X(Ze((0,x.jX)(be)));return}X(xt(Le))},ie=Le=>async(re,X)=>{const le=f.Ny.getSearchObject(),be=(0,V.SS)(Le,X()).map(async De=>await re(q((0,x.jX)(De),le)));await Promise.all(be)},de=(Le,re)=>async(X,le)=>{const be=(0,x.QT)(re),De=(0,V.dn)(Le,le());(0,x.q$)(De)!==a.CO.never&&await X(Ze((0,x.jX)(De)));const Te=(0,V.dn)((0,x.jX)(De),le());if(!(0,E.SP)(Te))return;if(!Te)throw new Error(`Couldn't find variable with name: ${De.name}`);let we=Te.options.find(Ke=>Ke.text===be||Ke.value===be);if(!we&&(0,E.iv)(Te)&&Te.allValue&&be===Te.allValue&&(we={text:v.Zm,value:v.To,selected:!1}),!we){let Ke=be;const Ve=be;Array.isArray(be)&&(Ke=be.reduce((ht,gt)=>{const bt=Te.options.find(St=>St.value===gt);return bt?[].concat(ht,[bt.text]):[].concat(ht,[gt])},[])),we={text:Ke,value:Ve,selected:!1}}(0,E.iv)(Te)&&(we=(0,M.C)({text:(0,n.castArray)(we.text),value:(0,n.castArray)(we.value),selected:!1},Te.multi)),await p.B.get(De.type).setValue(Te,we)},ue=Le=>{let re,X,le,be;const De=[];for(re=0;re<Le.options.length;re++)if(be={...Le.options[re]},be.selected=!1,Array.isArray(Le.current.value))for(X=0;X<Le.current.value.length;X++)le=Le.current.value[X],be.value===le&&(be.selected=!0,De.push(be));else be.value===Le.current.value&&(be.selected=!0,De.push(be));return De},fe=(Le,re)=>(X,le)=>{const be=(0,V.dn)(Le,le());if(!(0,E.SP)(be))return Promise.resolve();const De=be.current||{},Te=p.B.get(be.type).setValue;if(Array.isArray(De.value)){const ht=ue(be);if(ht.length===0){const bt=be.options[0];return Te(be,{value:typeof bt.value=="string"?[bt.value]:bt.value,text:typeof bt.text=="string"?[bt.text]:bt.text,selected:!0})}const gt={value:ht.map(bt=>bt.value),text:ht.map(bt=>bt.text),selected:!0};return Te(be,gt)}let we=null;const Ke=(0,x.Nz)(be),Ve=(0,x.Lz)(be);if(we=be.options?.find(ht=>ht.text===Ke||ht.value===Ve),we||re&&(we=be.options?.find(ht=>ht.text===re||ht.value===re),we))return Te(be,we);if(be.options){const ht=be.options[0];if(ht)return Te(be,ht)}return Promise.resolve()},Se=(Le,re,X)=>async le=>{const{rootStateKey:be}=Le;return le((0,R.kb)(be,(0,_.dE)((0,x.qD)(Le,{option:re})))),await le(ce(Le,X))},he=Le=>{const re=new P.TS;return Le.forEach(X=>{re.createNode(X.name)}),Le.forEach(X=>{Le.forEach(le=>{X!==le&&p.B.get(X.type).dependsOn(X,le)&&re.link(X.name,le.name)})}),re},ce=(Le,re,X=b.lE)=>async(le,be)=>{const De=be(),{rootStateKey:Te}=Le,we=(0,V.dn)(Le,De);if((0,V.nx)(Te,De).transaction.status===A.x8.Fetching)return(0,x.q$)(we)===a.CO.never&&(await le(ct((0,x.jX)(we))),le(xt(Le))),Promise.resolve();const Ke=(0,V.SS)(Te,De),Ve=he(Ke),ht=De.dashboard?.getModel()?.panels??[],gt=(0,S.P5)(ht),bt=we.type==="adhoc"?{refreshAll:!0,panelIds:[]}:{refreshAll:!1,panelIds:Array.from((0,S.xU)([we.id],Ve,gt)),variable:(0,V.dn)(Le,De)},St=Ve.getNode(we.name);let Je=[];return St&&(Je=St.getOptimizedInputEdges().map(rt=>{const Rt=Ke.find(_t=>_t.name===rt.inputNode?.name);return Rt?le(Ze((0,x.jX)(Rt))):Promise.resolve()})),Promise.all(Je).then(()=>{re&&(X.publish(new A.og(bt)),f.Ny.partial(Ae(Te,be)))})},me=(Le,re,X,le)=>(re.includes(Le.name)||re.push(Le.name),Le.outputEdges.forEach(be=>{const De=be.outputNode;if(De&&!re.includes(De.name)){const Te=X.find(we=>we.name===De.name);Te&&Te.refresh===a.CO.onTimeRangeChanged&&le.indexOf(Te)===-1?(le.push(Te),re.push(De.name)):me(De,re,X,le)}}),le),pe=(Le,re)=>Le.outputEdges.every(X=>{const le=X.outputNode;if(le){const be=U(re,le.name);if(be&&be.type==="query")return be.refresh!==a.CO.onTimeRangeChanged}return!0}),ye=(Le,re)=>{const X=(0,V.SS)(Le,re),le=he(X),be=[],De=[];return X.forEach(Te=>{const we=le.getNode(Te.name);if(!be.includes(Te.name)&&we){const Ke=U(X,we.name);if(!Ke)return;const Ve=W(Ke);Ve&&we.outputEdges.length===0&&De.push(Ke),Ve&&De.includes(Ke)&&we.outputEdges.length>0&&(De.push(Ke),me(we,be,X,De)),Ve&&we.outputEdges.length>0&&pe(we,X)&&(De.includes(Ke)||De.push(Ke)),!Ve&&we.outputEdges.length>0&&me(we,be,X,De)}}),De},Pe=(Le,re)=>(0,V.SS)(Le,re).filter(be=>"refresh"in be&&"options"in be?be.refresh===a.CO.onTimeRangeChanged:!1),Ie=(Le,re,X={templateSrv:(0,y.w)(),events:b.lE})=>async(le,be)=>{X.templateSrv.updateTimeRange(re);let De=[];d.$.featureToggles.refactorVariablesTimeRange?De=ye(Le,be()):De=Pe(Le,be());const Te=De.map(Ke=>Ke.id),we=De.map(Ke=>le(Oe((0,x.jX)(Ke))));try{await Promise.all(we),X.events.publish(new A.BS({variableIds:Te}))}catch(Ke){console.error(Ke),le((0,l.dx)(ot("Template variable service failed",Ke)))}},Oe=Le=>async(re,X)=>{const le=(0,V.dn)(Le,X());if(!(0,E.SP)(le))return;const be=le.options.slice();await re(Ze((0,x.jX)(le),!0));const De=(0,V.dn)(Le,X());if(!(0,E.SP)(De))return;const Te=De.options;JSON.stringify(be)!==JSON.stringify(Te)&&X().dashboard.getModel()?.templateVariableValueUpdated()},Ne=(Le,re,X=b.lE)=>async(le,be)=>{const De=[],Te=be().dashboard.getModel(),we=(0,V.SS)(Le,be());for(const bt of we){const St=v.qz+bt.name;if(!re.hasOwnProperty(St)||!We(bt,re[St].value))continue;let Je=re[St].value;if(re[St].removed){const Rt=Te?.templating.list.find(_t=>_t.name===bt.name);Rt&&(0,E.m8)(Rt)&&(Je=Rt.current.value),Rt&&Rt.type==="constant"&&(Je=Rt.query)}const rt=p.B.get(bt.type).setValueFromUrl(bt,Je);De.push(rt)}const Ke=we.filter(bt=>{const St=v.qz+bt.name;return re.hasOwnProperty(St)&&We(bt,re[St].value)&&bt.type!=="adhoc"}),Ve=he(we),ht=(0,S.P5)(Te?.panels??[]),gt=(0,S.xU)(Ke.map(bt=>bt.id),Ve,ht);De.length&&(await Promise.all(De),X.publish(new A.eF({refreshAll:gt.size===0,panelIds:Array.from(gt)})))};function We(Le,re){const X=p.B.get(Le.type).getValueForUrl(Le);let le=(0,x.QT)(re);return Array.isArray(X)&&!Array.isArray(le)&&(le=[le]),!(0,n.isEqual)(X,le)}const Ae=(Le,re)=>{const X=f.Ny.getSearchObject(),le=Object.keys(X).filter(be=>be.indexOf(v.qz)===-1).reduce((be,De)=>(be[De]=X[De],be),{});for(const be of(0,V.SS)(Le,re())){if(be.skipUrlSync)continue;const De=p.B.get(be.type);le[v.qz+be.name]=De.getValueForUrl(be)}return le},Ue=(Le,re)=>async(X,le)=>{try{const be=(0,x.q4)(Le),De=le(),Te=(0,V.Tk)(De);Te&&(0,V.nx)(Te,De).transaction.status===A.x8.Fetching&&X(ke(Te)),X((0,R.kb)(be,(0,H.kH)({uid:be}))),X(oe(be,re)),X(j(be,re)),X(Me(be)),await X(ie(be)),X((0,R.kb)(be,(0,H.$O)({uid:be})))}catch(be){X((0,l.dx)(ot("Templating init failed",be))),console.error(be)}};function Me(Le,re=c.tR){return(X,le)=>{const be=(0,V.SS)(Le,le());for(const De of be){if(De.type!=="adhoc"&&De.type!=="query")continue;const{datasource:Te}=De;if((0,i.fN)(Te))continue;const we=re().getInstanceSettings(Te),Ke=we?(0,i.p$)(we):{uid:Te};X((0,R.kb)(Le,(0,_.QP)((0,x.qD)(De,{propName:"datasource",propValue:Ke}))))}}}const $e=Le=>re=>{re((0,R.kb)(Le,(0,G.v)())),re((0,R.kb)(Le,(0,D.y8)())),re((0,R.kb)(Le,(0,T.jR)())),re((0,R.kb)(Le,(0,H.pu)()))},ke=(Le,re={getBackendSrv:g.AI})=>X=>{re.getBackendSrv().cancelAllInFlightRequests(),X($e(Le))},Ze=(Le,re=!1)=>async(X,le)=>{const{rootStateKey:be}=Le;try{if(!(0,x.sN)(be,le()))return;const De=(0,V.dn)(Le,le());X((0,R.kb)(be,(0,_.a7)((0,x.qD)(De)))),await X(ct((0,x.jX)(De))),await p.B.get(De.type).updateOptions(De),X(xt(Le))}catch(De){if(X((0,R.kb)(be,(0,_.Te)((0,x.qD)(Le,{error:De})))),re||(console.error(De),X((0,l.dx)(ot("Error updating options:",De,Le)))),re)throw De}},ot=(Le,re,X)=>(0,u.gi)(`${X?`Templating [${X.id}]`:"Templating"}`,re instanceof Error?`${Le} ${re.message}`:`${Le}`),xt=Le=>(re,X)=>{const{rootStateKey:le}=Le;if(!(0,x.sN)(le,X()))return;const be=(0,V.dn)(Le,X());be.state!==r.Gu.Done&&re((0,R.kb)(Le.rootStateKey,(0,_.Pu)((0,x.qD)(be))))};function ct(Le,re=c.tR){return async function(X,le){const{id:be,rootStateKey:De}=Le;if(!(0,x.sN)(De,le()))return;const Te=(0,V.dn)(Le,le());if(Te.type==="query")try{const we=await re().get(Te.datasource??"");if((0,E.d5)(we)||!(0,E.Hf)(we)||ft(Te.query))return;const Ke={refId:`${we.name}-${be}-Variable-Query`,query:Te.query};X((0,R.kb)(De,(0,_.QP)((0,x.qD)(Le,{propName:"query",propValue:Ke}))))}catch(we){X((0,l.dx)(ot("Failed to upgrade legacy queries",we))),console.error(we)}}}function ft(Le){return(0,r.Gv)(Le)&&"refId"in Le&&typeof Le.refId=="string"}},48594:(Q,I,e)=>{"use strict";e.d(I,{Ay:()=>m,L1:()=>r,kb:()=>f});var n=e(75096),a=e(84014),o=e(85675);const r={keys:{}},i=s=>({type:`templating/keyed/${s.action.type.replace(/^templating\//,"")}`,payload:s});function f(s,h){const u=(0,n.q4)(s);return i({key:u,action:h})}const d=s=>typeof s.type=="string"&&s.type.startsWith("templating/keyed")&&"payload"in s&&typeof s.payload.key=="string";function l(s=r,h){if(d(h)){const{key:u,action:b}=h.payload,g=(0,n.q4)(u),P=o.kH.match(b)?g:s.lastKey,c=(0,a.H)(),y=s.keys[g],p=c(y,b);return{...s,lastKey:P,keys:{...s.keys,[g]:p}}}return s}const m={templating:l}},84014:(Q,I,e)=>{"use strict";e.d(I,{H:()=>m,x:()=>s});var n=e(14644),a=e(3843),o=e(27238),r=e(24300),i=e(85675),f=e(83370),d=e(15120);let l;function m(){return l||(l=(0,n.combineReducers)({editor:a.wf,variables:d.Y,optionsPicker:r.ho,transaction:i.Dd,inspect:o.t4})),l}function s(){return{editor:a.nS,variables:f.j,optionsPicker:r.$z,transaction:i.i3,inspect:o.WT}}},87421:(Q,I,e)=>{"use strict";e.d(I,{Fs:()=>D,SS:()=>l,Tk:()=>P,UN:()=>p,_2:()=>v,bZ:()=>y,dn:()=>i,hk:()=>u,nS:()=>h,nx:()=>d,pi:()=>s,wk:()=>b,y7:()=>c});var n=e(41811),a=e(99140),o=e(75096),r=e(84014);function i(E,S=(0,a.Gu)(),T=!0){const{id:M,rootStateKey:A}=E,C=d(A,S).variables[M];if(!C){if(T)throw new Error(`Couldn't find variable with id:${M}`);return}return C}function f(E,S,T=(0,a.Gu)()){return Object.values(d(S,T).variables).filter(E).sort((M,A)=>M.index-A.index)}function d(E,S=(0,a.Gu)()){return S.templating.keys[(0,o.q4)(E)]??(0,r.x)()}function l(E,S=(0,a.Gu)()){return f(m,E,S)}function m(E){return E.type!=="system"}const s=(0,n.A)((E,S)=>l(E,(0,a.Gu)())),h=(E,S)=>l(E,S);function u(E,S=(0,a.Gu)()){return b(Object.values(d(E,S).variables))}function b(E){const S=E.filter(m).sort((T,M)=>T.index-M.index);return S.length>0?S[S.length-1].index+1:0}function g(E,S=getState()){return d(E,S).transaction.isDirty}function P(E=(0,a.Gu)()){return E.templating?.lastKey}function c(E=(0,a.Gu)()){if(!E.templating?.lastKey)throw new Error("Accessing lastKey without initializing it variables");return E.templating.lastKey}function y(E,S=(0,a.Gu)()){const T=P(S);return T?f(E,T,S):[]}function p(E=(0,a.Gu)()){const S=P(E);return S?l(S,E):[]}function v(E,S=(0,a.Gu)()){const T=P(S);if(T)return i({id:E,rootStateKey:T,type:"query"},S,!1)}function D(E,S){return E[S]}},56968:(Q,I,e)=>{"use strict";e.d(I,{Hr:()=>b,Pu:()=>S,QP:()=>P,QV:()=>g,Te:()=>T,a7:()=>E,dE:()=>p,hj:()=>c,l_:()=>v,qi:()=>u,ut:()=>y,wB:()=>D});var n=e(65307),a=e(2543),o=e.n(a),r=e(39070),i=e(20601),f=e(3843),d=e(24240),l=e(75096),m=e(87421),s=e(83370);const h=(0,n.Z0)({name:"templating/shared",initialState:s.j,reducers:{addVariable:(M,A)=>{const x=A.payload.id??A.payload.data.model.name,C=i.B.get(A.payload.type),O=(0,a.cloneDeep)(C.initialState),R=C.beforeAdding?C.beforeAdding(A.payload.data.model):(0,a.cloneDeep)(A.payload.data.model),L={...(0,a.defaults)({},R,O),id:x,index:A.payload.data.index,global:A.payload.data.global};M[x]=L},variableStateNotStarted:(M,A)=>{const x=(0,m.Fs)(M,A.payload.id);x.state=r.Gu.NotStarted,x.error=null},variableStateFetching:(M,A)=>{const x=(0,m.Fs)(M,A.payload.id);x.state=r.Gu.Loading,x.error=null},variableStateCompleted:(M,A)=>{const x=(0,m.Fs)(M,A.payload.id);x&&(x.state=r.Gu.Done,x.error=null)},variableStateFailed:(M,A)=>{const x=(0,m.Fs)(M,A.payload.id);x&&(x.state=r.Gu.Error,x.error=A.payload.data.error)},removeVariable:(M,A)=>{if(delete M[A.payload.id],!A.payload.data.reIndex)return;const x=Object.values(M).sort((C,O)=>C.index-O.index);for(let C=0;C<x.length;C++)x[C].index=C},duplicateVariable:(M,A)=>{function x(w){return w.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const C=(0,a.cloneDeep)(M[A.payload.id]),O=new RegExp(`^copy_of_${x(C.name)}(_(\\d+))?$`),R=Object.values(M).map(({name:w})=>w.match(O)).filter(w=>w!=null),L=R.map(w=>w[2]).filter(w=>w!=null),N=R.length===0?null:L.length===0?1:L.map(w=>+w).sort((w,U)=>U-w)[0]+1,F=`copy_of_${C.name}${N?`_${N}`:""}`,K=A.payload.data?.newId??F,B=(0,m.wk)(Object.values(M));M[K]={...(0,a.cloneDeep)(i.B.get(A.payload.type).initialState),...C,id:K,name:F,index:B}},changeVariableOrder:(M,A)=>{const{toIndex:x,fromIndex:C}=A.payload.data,O=Object.values(M);for(let R=0;R<O.length;R++){const L=O[R];L.index===C?L.index=x:L.index>C&&L.index<=x?L.index--:L.index<C&&L.index>=x&&L.index++}},changeVariableType:(M,A)=>{const{id:x}=A.payload,{label:C,name:O,index:R,description:L,rootStateKey:N}=M[x];M[x]={...(0,a.cloneDeep)(i.B.get(A.payload.data.newType).initialState),id:x,rootStateKey:N,label:C,name:O,index:R,description:L}},setCurrentVariableValue:(M,A)=>{if(!A.payload.data.option)return;const x=(0,m.Fs)(M,A.payload.id);if(!(0,d.SP)(x))return;const{option:C}=A.payload.data,O={...C,text:(0,l.QT)(C?.text),value:(0,l.QT)(C?.value)};x.current=O,x.options=x.options.map(R=>{R.value=(0,l.QT)(R.value),R.text=(0,l.QT)(R.text);let L=!1;if(Array.isArray(O.value))for(let N=0;N<O.value.length;N++){const F=O.value[N];if(R.value===F){L=!0;break}}else R.value===O.value&&(L=!0);return R.selected=L,R})},changeVariableProp:(M,A)=>{const x=(0,m.Fs)(M,A.payload.id);x[A.payload.data.propName]=A.payload.data.propValue}},extraReducers:M=>M.addCase(f.FN,(A,x)=>{const C=(0,m.Fs)(A,x.payload.id);C.name=x.payload.data.newName})}),u=h.reducer,{removeVariable:b,addVariable:g,changeVariableProp:P,changeVariableOrder:c,duplicateVariable:y,setCurrentVariableValue:p,changeVariableType:v,variableStateNotStarted:D,variableStateFetching:E,variableStateCompleted:S,variableStateFailed:T}=h.actions},85675:(Q,I,e)=>{"use strict";e.d(I,{$O:()=>m,Dd:()=>s,i3:()=>r,kH:()=>d,pu:()=>l});var n=e(65307),a=e(80484),o=e(56968);const r={uid:null,status:a.x8.NotStarted,isDirty:!1},i=(0,n.Z0)({name:"templating/transaction",initialState:r,reducers:{variablesInitTransaction:(h,u)=>{h.uid=u.payload.uid,h.status=a.x8.Fetching},variablesCompleteTransaction:(h,u)=>{h.uid===u.payload.uid&&(h.status=a.x8.Completed)},variablesClearTransaction:(h,u)=>{h.uid=null,h.status=a.x8.NotStarted,h.isDirty=!1}},extraReducers:h=>h.addMatcher(f,(u,b)=>{u.status===a.x8.Completed&&(u.isDirty=!0)})});function f(h){return o.Hr.match(h)||o.QV.match(h)||o.QP.match(h)||o.hj.match(h)||o.ut.match(h)||o.l_.match(h)}const{variablesInitTransaction:d,variablesClearTransaction:l,variablesCompleteTransaction:m}=i.actions,s=i.reducer},83370:(Q,I,e)=>{"use strict";e.d(I,{j:()=>n});const n={}},15120:(Q,I,e)=>{"use strict";e.d(I,{Y:()=>f,v:()=>i});var n=e(65307),a=e(20601),o=e(56968),r=e(83370);const i=(0,n.VP)("templating/cleanVariables"),f=(d=r.j,l)=>{if(i.match(l)){const m=Object.values(d).filter(h=>h.global);return m?m.reduce((h,u)=>(h[u.id]=u,h),{}):r.j}return l?.payload?.type&&a.B.getIfExists(l?.payload?.type)?a.B.get(l.payload.type).reducer((0,o.qi)(d,l),l):d}},80484:(Q,I,e)=>{"use strict";e.d(I,{BS:()=>l,Vg:()=>f,eF:()=>m,og:()=>d,x8:()=>i});var n=e(12470),a=e(39070),o=e(65463),r=e(13344),i=(s=>(s.NotStarted="Not started",s.Fetching="Fetching",s.Completed="Completed",s))(i||{});const f={id:r.qF,rootStateKey:null,name:"",type:"query",global:!1,index:-1,hide:n.zL.dontHide,skipUrlSync:!1,state:a.Gu.NotStarted,error:null,description:null};class d extends o.x{static{this.type="variables-changed"}}class l extends o.x{static{this.type="variables-time-range-process-done"}}class m extends o.x{static{this.type="variables-changed-in-url"}}},75096:(Q,I,e)=>{"use strict";e.d(I,{AX:()=>E,Lz:()=>y,ML:()=>P,Nz:()=>c,QT:()=>M,SY:()=>u,Wz:()=>T,iP:()=>v,jX:()=>C,pY:()=>R,q$:()=>D,q4:()=>x,qD:()=>O,sN:()=>A,t4:()=>b,u7:()=>p,wJ:()=>g});var n=e(2543),a=e.n(n),o=e(12470),r=e(72574),i=e(12131),f=e(87490),d=e(99140),l=e(20601),m=e(13344),s=e(87421),h=e(80484);const u=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g,b=L=>(u.lastIndex=0,u.exec(L));function g(...L){const N=L[L.length-1];L[0]=typeof L[0]=="string"?L[0]:(0,f.MA)(L[0]);const K=L.slice(0,-1).join(" ").match(u);return!!(K!==null?K.find(w=>{const U=b(w);return U!==null&&U.indexOf(N)>-1}):!1)}const P=L=>{if(!L||!L.current)return!1;if(L.current.value){const N=Array.isArray(L.current.value);if(N&&L.current.value.length&&L.current.value[0]===m.To||!N&&L.current.value===m.To)return!0}if(L.current.text){const N=Array.isArray(L.current.text);if(N&&L.current.text.length&&L.current.text[0]===m.Zm||!N&&L.current.text===m.Zm)return!0}return!1},c=L=>!L||!L.current||!L.current.text?"":Array.isArray(L.current.text)?L.current.text.toString():typeof L.current.text!="string"?"":L.current.text,y=L=>!L||!L.current||L.current.value===void 0||L.current.value===null?null:Array.isArray(L.current.value)?L.current.value.toString():typeof L.current.value!="string"?null:L.current.value;function p(L,N=(0,r.w)()){return!L||!L.regex?"":N.replace(L.regex,{},"regex")}function v(L,N,F,K){const B={range:void 0,variable:L,searchFilter:N,scopedVars:K};return(L.refresh===o.CO.onTimeRangeChanged||L.refresh===o.CO.onDashboardLoad)&&(B.range=F.timeRange()),B}function D(L){return L?.type==="custom"?o.CO.onDashboardLoad:!L||!("refresh"in L)||L.refresh!==o.CO.onTimeRangeChanged&&L.refresh!==o.CO.onDashboardLoad?o.CO.never:L.refresh}function E(){return l.B.list().filter(L=>L.id!=="system").map(({id:L,name:N,description:F})=>({label:N,value:L,description:F}))}function S(L){return(0,n.isArray)(L)&&(L.length===0?L=void 0:L.length===1&&(L=L[0])),L}function T(L,N){let F=0;const K={};for(const B in L){if(!B.startsWith(m.qz))continue;let w=S(N[B]),U=S(L[B]);(0,n.isEqual)(U,w)||(K[B]={value:L[B]},F++)}for(const B in N){if(!B.startsWith(m.qz))continue;const w=N[B];(0,n.isArray)(w)&&w.length===0||L.hasOwnProperty(B)||(K[B]={value:"",removed:!0},F++)}return F?K:void 0}function M(L){return Array.isArray(L)?L.map(String):L==null?"":typeof L=="number"?L.toString(10):typeof L=="string"?L:typeof L=="boolean"?L.toString():""}function A(L,N=(0,d.Gu)()){return(0,s.nx)(L,N).transaction.status!==h.x8.NotStarted}function x(L){return String(L)}const C=L=>{if(!L.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${L.id}`);return{type:L.type,id:L.id,rootStateKey:L.rootStateKey}};function O(L,N){return{type:L.type,id:L.id,data:N}}function R(){const L=(0,r.w)().getVariables(),N=i.Ny.getSearchObject();return Object.keys(N).filter(F=>F.indexOf(m.qz)!==-1&&L.some(K=>K.name===F.replace(m.qz,""))).reduce((F,K)=>{const B=K.replace(m.qz,"");return F[B]=N[K],F},{})}},1819:(Q,I,e)=>{"use strict";e.d(I,{e:()=>u});var n=e(32196),a=e(96540),o=e(28240),r=e(83195),i=e(14588),f=e(52622),d=e(40845),l=e(72109),m=e(61994),s=e(74007);function h(g,P,c,y,p){const v=g.fields,D=c!=null?v[c]:null,E=v.filter(C=>!C.config.custom?.hideFrom?.tooltip),S=E.find(C=>C.name==="traceID")||v[0],T=[];if(E.filter(C=>S===C).length>0&&T.push(S),T.push(...E.filter(C=>S!==C)),T.length===0)return null;const M=[],A=[],x=new Set;for(const C of T){if(p===f.$N.Single&&C!==D)continue;const O=C.values[P],R=C.display?C.display(O):{text:`${O}`,numeric:+O};C.getLinks&&C.getLinks({calculatedValue:R,valueRowIndex:P}).forEach(L=>{const N=`${L.title}/${L.href}`;x.has(N)||(A.push(L),x.add(N))}),M.push({name:(0,o.Ct)(C,g),value:O,valueString:(0,r.cN)(R),highlight:C===D})}return y&&y!==f.xB.None&&M.sort((C,O)=>i.sortValues(y)(C.value,O.value)),{displayValues:M,links:A}}const u=({data:g,rowIndex:P,columnIndex:c,sortOrder:y,mode:p,header:v,padding:D=0})=>{const E=(0,d.of)(b,D);if(!g||P==null)return null;const S=h(g,P,c,y,p);if(S==null)return null;const{displayValues:T,links:M}=S;return v==="Exemplar"?a.createElement(s.i,{displayValues:T,links:M,header:v}):a.createElement("div",{className:E.wrapper},v&&a.createElement("div",{className:E.header},a.createElement("span",{className:E.title},v)),a.createElement("table",{className:E.infoWrap},a.createElement("tbody",null,T.map((A,x)=>a.createElement("tr",{key:`${x}/${P}`},a.createElement("th",null,A.name),a.createElement("td",null,(0,m.A)(A.valueString)))),M.map((A,x)=>a.createElement("tr",{key:x},a.createElement("th",null,"Link"),a.createElement("td",{colSpan:2},a.createElement(l.Y,{href:A.href,external:A.target==="_blank",weight:"medium",inline:!1},A.title)))))))},b=(g,P=0)=>({wrapper:(0,n.css)({padding:`${P}px`,background:g.components.tooltip.background,borderRadius:g.shape.borderRadius(2)}),header:(0,n.css)({background:g.colors.background.secondary,alignItems:"center",alignContent:"center",display:"flex",paddingBottom:g.spacing(1)}),title:(0,n.css)({fontWeight:g.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),infoWrap:(0,n.css)({padding:g.spacing(1),background:"transparent",border:"none",th:{fontWeight:g.typography.fontWeightMedium,padding:g.spacing(.25,2,.25,0)},tr:{borderBottom:`1px solid ${g.colors.border.weak}`,"&:last-child":{borderBottom:"none"}}}),link:(0,n.css)({color:g.colors.text.link})})},74007:(Q,I,e)=>{"use strict";e.d(I,{i:()=>d});var n=e(32196),a=e(96540),o=e(40845),r=e(14689),i=e(13471),f=e(61994);const d=({displayValues:m,links:s,header:h="Exemplar"})=>{const u=(0,o.of)(l),b=m.find(g=>g.name==="Time");return m=m.filter(g=>g.name!=="Time"),a.createElement("div",{className:u.exemplarWrapper},a.createElement("div",{className:u.exemplarHeader},a.createElement("span",{className:u.title},h),b&&a.createElement("span",{className:u.time},(0,f.A)(b.valueString))),a.createElement("div",{className:u.exemplarContent},m.map((g,P)=>a.createElement(i.B,{key:P,label:g.name,value:(0,f.A)(g.valueString),justify:"space-between",isPinned:!1}))),s&&s.length>0&&a.createElement("div",{className:u.exemplarFooter},s.map((g,P)=>a.createElement(r.R,{link:g,key:P,buttonProps:{size:"md"}}))))},l=(m,s=0)=>({exemplarWrapper:(0,n.css)({display:"flex",flexDirection:"column",flex:1,gap:4,whiteSpace:"pre",borderRadius:m.shape.radius.default,background:m.colors.background.primary,border:`1px solid ${m.colors.border.weak}`,boxShadow:`0 4px 8px ${m.colors.background.primary}`}),exemplarHeader:(0,n.css)({display:"flex",flexDirection:"column",alignItems:"flex-start",gap:m.spacing(.5),color:m.colors.text.secondary,padding:m.spacing(1)}),time:(0,n.css)({color:m.colors.text.primary}),exemplarContent:(0,n.css)({display:"flex",flexDirection:"column",flex:1,gap:4,borderTop:`1px solid ${m.colors.border.medium}`,padding:m.spacing(1)}),exemplarFooter:(0,n.css)({display:"flex",flexDirection:"column",padding:m.spacing(1),borderTop:`1px solid ${m.colors.border.medium}`,gap:4}),linkButton:(0,n.css)({width:"fit-content"}),label:(0,n.css)({color:m.colors.text.secondary,fontWeight:400,textOverflow:"ellipsis",overflow:"hidden",marginRight:m.spacing(.5)}),value:(0,n.css)({fontWeight:500,textOverflow:"ellipsis",overflow:"hidden"}),title:(0,n.css)({fontWeight:m.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1})})},246:(Q,I,e)=>{"use strict";var n=e(6262),a=e(9423),o=e(7452),r=e(78624),i=e(4213),f=e(34796),d=e(13609),l=e(31193),m=e(17493),s=e(14792),h=e(15858),u=e(16495),b=e(16561),g=e(2543),P=e.n(g),c=e(96540),y=e(5338),p=e(47232),v=e(1933),D=e(69550),E=e(97497),S=e(96915),T=e(71733),M=e(17172),A=e(23509),x=e(12131),C=e(96937),O=e(3591),R=e(63639),L=e(89191),N=e(19347),F=e(4402),K=e(3197),B=e(79396),w=e(14778),U=e(63415),W=e(97152),V=e(24308),_=e(46235),H=e(5260),G=e(2913),j=e(94041),Y=e(32264),oe=e(11261),se=e(85200),ne=e(1173),ee=e(28240),Z=e(18282),z=e(57934),q=e(73376),ie=e(14186),de=e(94354),ue=e(90613),fe=e(55852),Se=e(91847);function he(ae){if(ae in Se.uk){const{name:te,getHelperDocs:ge,links:xe}=Se.uk[ae],ze=ge(Se.g_.UIImage),Ye=ce(ze);if(xe?.length){const at=xe.map(Et=>`
  Or visit <a href="${Et.url}" target="_blank">${Et.title}</a>

  `).join("");return{name:te,helperDocs:`
        ${Ye}
        ${(0,Se.$n)()}
  ${at}
        `}}return{name:te,helperDocs:`
      ${Ye}
      ${(0,Se.$n)()}
      `}}return{name:"No documentation found",helperDocs:(0,Se.$n)()}}const ce=ae=>ae.replace(/\[(.*?)\]\(#.*?\)/g,"$1").replace(/\[[^\]]*\]\[\]/g,"");var me=e(39268),pe=e(21594),ye=e(83077),Pe=e(91890),Ie=e(72574),Oe=e(10354),Ne=e(88841),We=e(94397);function Ae(ae,te){switch(te.type){case oe.PU.boolean:return(0,g.isUndefined)(ae)?!1:Ue(ae);case oe.PU.number:return isNaN(ae)?0:parseFloat(ae);case oe.PU.string:return ae?String(ae):"";default:return ae}}const Ue=ae=>(0,g.isString)(ae)?!(ae[0]==="F"||ae[0]==="f"||ae[0]==="0"):!!ae;function Me(ae){return function({options:ge,onChange:xe,field:ze}){const{validator:Ye,converter:at=Ae}=ae,{value:Et}=ge,[Pt,Ut]=(0,c.useState)(!Ye(Et)),Dn=(0,Ie.w)().getVariables().map(Mn=>({value:Mn.name,label:Mn.label||Mn.name,origin:Pe.$0.Template})),xn=(0,c.useCallback)(Mn=>{Ut(!Ye(Mn.currentTarget.value))},[Ut,Ye]),Sn=(0,c.useCallback)(Mn=>{if(Pt)return;const{value:Ra}=Mn.currentTarget;xe({...ge,value:at(Ra,ze)})},[ge,xe,Pt,ze,at]),En=(0,c.useCallback)(Mn=>{Ut(!Ye(Mn)),xe({...ge,value:Mn})},[Ut,Ye,xe,ge]);return Y.$.featureToggles.transformationsVariableSupport?c.createElement(Ne.y,{invalid:Pt,value:Et,error:"Value needs to be an integer or a variable",onChange:En,placeholder:"Value or variable",suggestions:Dn}):c.createElement(Oe.p,{className:"flex-grow-1",invalid:Pt,defaultValue:String(ge.value),placeholder:"Value",onChange:xn,onBlur:Sn})}}const $e=()=>[{name:"Is greater",id:ne.Js.greater,component:Me({validator:We.N_})},{name:"Is greater or equal",id:ne.Js.greaterOrEqual,component:Me({validator:We.N_})},{name:"Is lower",id:ne.Js.lower,component:Me({validator:We.N_})},{name:"Is lower or equal",id:ne.Js.lowerOrEqual,component:Me({validator:We.N_})},{name:"Is equal",id:ne.Js.equal,component:Me({validator:()=>!0})},{name:"Is not equal",id:ne.Js.notEqual,component:Me({validator:()=>!0})},{name:"Is Substring",id:ne.Js.substring,component:Me({validator:()=>!0})},{name:"Is not substring",id:ne.Js.notSubstring,component:Me({validator:()=>!0})}],ke=()=>null,Ze=()=>[{name:"Is null",id:ne.Js.isNull,component:ke},{name:"Is not null",id:ne.Js.isNotNull,component:ke}];var ot=e(76892);function xt(ae){return function({options:ge,onChange:xe,field:ze}){const{validator:Ye}=ae,[at,Et]=(0,c.useState)({from:!Ye(ge.from),to:!Ye(ge.to)}),Ut=(0,Ie.w)().getVariables().map(Sn=>({value:Sn.name,label:Sn.label||Sn.name,origin:Pe.$0.Template})),qt=(0,c.useCallback)((Sn,En)=>{Et({...at,[En]:!Ye(Sn.currentTarget.value)})},[Et,Ye,at]),Dn=(0,c.useCallback)((Sn,En)=>{if(at[En])return;const{value:Mn}=Sn.currentTarget;xe({...ge,[En]:Ae(Mn,ze)})},[ge,xe,at,ze]),xn=(0,c.useCallback)((Sn,En)=>{const Mn=!Ye(Sn);Et({...at,[En]:Mn}),!Mn&&xe({...ge,[En]:Sn})},[ge,xe,at,Et,Ye]);return Y.$.featureToggles.transformationsVariableSupport?c.createElement(c.Fragment,null,c.createElement(Ne.y,{value:String(ge.from),invalid:at.from,error:"Value needs to be an integer or a variable",placeholder:"From",onChange:Sn=>xn(Sn,"from"),suggestions:Ut}),c.createElement(ot.c,null,"and"),c.createElement(Ne.y,{invalid:at.to,error:"Value needs to be an integer or a variable",value:String(ge.to),placeholder:"To",suggestions:Ut,onChange:Sn=>xn(Sn,"to")})):c.createElement(c.Fragment,null,c.createElement(Oe.p,{invalid:at.from,defaultValue:String(ge.from),placeholder:"From",onChange:Sn=>qt(Sn,"from"),onBlur:Sn=>Dn(Sn,"from")}),c.createElement(ot.c,null,"and"),c.createElement(Oe.p,{invalid:at.to,defaultValue:String(ge.to),placeholder:"To",onChange:Sn=>qt(Sn,"to"),onBlur:Sn=>Dn(Sn,"to")}))}}const ct=()=>[{name:"Is between",id:ne.Js.between,component:xt({validator:We.N_})}];function ft(ae){return function({options:ge,onChange:xe,field:ze}){const{validator:Ye,converter:at=Ae}=ae,{value:Et}=ge,[Pt,Ut]=(0,c.useState)(!Ye(Et)),qt=(0,c.useCallback)(xn=>{Ut(!Ye(xn.currentTarget.value))},[Ut,Ye]),Dn=(0,c.useCallback)(xn=>{if(Pt)return;const{value:Sn}=xn.currentTarget;xe({...ge,value:at(Sn,ze)})},[ge,xe,Pt,ze,at]);return c.createElement(Oe.p,{className:"flex-grow-1",invalid:Pt,defaultValue:String(ge.value),placeholder:"Value",onChange:qt,onBlur:Dn})}}const Le=()=>[{name:"Regex",id:ne.Js.regex,component:ft({validator:()=>!0,converter:ae=>String(ae)})}],re=new ye.O(()=>[...$e(),...Ze(),...ct(),...Le()]),X=ae=>{const{onDelete:te,onChange:ge,filter:xe,fieldsInfo:ze}=ae,{fieldsAsOptions:Ye,fieldByDisplayName:at}=ze,Et=De(xe,Ye)??"",Pt=at[Et],Ut=Pt?le(Pt):[],qt=be(xe,Ut),Dn=re.getIfExists(qt),xn=(0,c.useCallback)(Mn=>{Mn?.value&&ge({...xe,fieldName:Mn.value})},[ge,xe]),Sn=(0,c.useCallback)(Mn=>{if(!Mn?.value)return;const Ra=Mn.value,yr=se.hI.get(Ra).getDefaultOptions(Pt);ge({...xe,config:{id:Ra,options:yr}})},[ge,xe,Pt]),En=(0,c.useCallback)(Mn=>{ge({...xe,config:{...xe.config,options:Mn}})},[ge,xe]);return!Pt||!Dn||!Dn.component?null:c.createElement(me.C,null,c.createElement(ie.I,{label:"Field",labelWidth:14},c.createElement(pe.l6,{className:"min-width-15 max-width-24",placeholder:"Field Name",options:Ye,value:xe.fieldName,onChange:xn})),c.createElement(ie.I,{label:"Match"},c.createElement(pe.l6,{className:"width-12",placeholder:"Select test",options:Ut,value:qt,onChange:Sn})),c.createElement(ie.I,{label:"Value",grow:!0},c.createElement(Dn.component,{field:Pt,options:xe.config.options??{},onChange:En})),c.createElement(ue.a,{marginBottom:.5},c.createElement(fe.$n,{icon:"times",onClick:te,variant:"secondary"})))},le=ae=>{const te=[];for(const ge of se.hI.list())!ge.isApplicable(ae)||!re.getIfExists(ge.id)||te.push({value:ge.id,label:ge.name,description:ge.description});return te},be=(ae,te)=>{const ge=te.find(xe=>xe.value===ae.config.id);if(ge&&ge.value)return ge.value;if(te[0]?.value)return te[0]?.value},De=(ae,te)=>{const ge=te.find(xe=>xe.value===ae.fieldName);if(ge&&ge.value)return ge.value;if(te[0]?.value)return te[0]?.value},Te=[{label:"Include",value:q.j4.include},{label:"Exclude",value:q.j4.exclude}],we=[{label:"Match all",value:q.Sm.all},{label:"Match any",value:q.Sm.any}],Ke=ae=>{const{input:te,options:ge,onChange:xe}=ae,ze=ht(te),Ye=(0,c.useCallback)(()=>{const qt=te[0],Dn=qt.fields.find(En=>En.type!==oe.PU.time);if(!Dn)return;const xn=(0,g.cloneDeep)(ge.filters),Sn=se.hI.get(ne.Js.isNull);xn.push({fieldName:(0,ee.Ct)(Dn,qt,te),config:{id:Sn.id,options:Sn.getDefaultOptions(Dn)}}),xe({...ge,filters:xn})},[xe,ge,te]),at=(0,c.useCallback)(qt=>{let Dn=(0,g.cloneDeep)(ge.filters);Dn.splice(qt,1),xe({...ge,filters:Dn})},[ge,xe]),Et=(0,c.useCallback)((qt,Dn)=>{let xn=(0,g.cloneDeep)(ge.filters);xn[Dn]=qt,xe({...ge,filters:xn})},[ge,xe]),Pt=(0,c.useCallback)(qt=>{xe({...ge,type:qt??q.j4.include})},[ge,xe]),Ut=(0,c.useCallback)(qt=>{xe({...ge,match:qt??q.Sm.all})},[ge,xe]);return c.createElement("div",null,c.createElement(ie.I,{label:"Filter type",labelWidth:16},c.createElement("div",{className:"width-15"},c.createElement(de.z,{options:Te,value:ge.type,onChange:Pt,fullWidth:!0}))),c.createElement(ie.I,{label:"Conditions",labelWidth:16},c.createElement("div",{className:"width-15"},c.createElement(de.z,{options:we,value:ge.match,onChange:Ut,fullWidth:!0}))),c.createElement(ue.a,{paddingLeft:2},ge.filters.map((qt,Dn)=>c.createElement(X,{key:Dn,filter:qt,fieldsInfo:ze,onChange:xn=>Et(xn,Dn),onDelete:()=>at(Dn)})),c.createElement(fe.$n,{icon:"plus",size:"sm",onClick:Ye,variant:"secondary"},"Add condition")))},Ve={id:Z.F.filterByValue,editor:Ke,transformation:z.c.filterByValueTransformer,name:z.c.filterByValueTransformer.name,description:"Removes rows of the query results using user-defined filters. This is useful if you can not filter your data in the data source.",categories:new Set([E.m.Filter]),help:he(Z.F.filterByValue).helperDocs},ht=ae=>(0,c.useMemo)(()=>{const te={fieldsAsOptions:[],fieldByDisplayName:{}};return Array.isArray(ae)?ae.reduce((ge,xe)=>xe.fields.reduce((ze,Ye)=>{const at=(0,ee.Ct)(Ye,xe,ae);return ze.fieldByDisplayName[at]||(ze.fieldsAsOptions.push({label:at,value:at,type:Ye.type}),ze.fieldByDisplayName[at]=Ye),ze},ge),te):te},[ae]);var gt=e(43429),bt=e(60264),St=e(48192),Je=e(66211),rt=e(54612);function Rt(ae,te){const ge={data:ae.input,options:ae.options},xe=new St.C({id:"root",title:"root"}),ze=at=>{if(at?.length){const Et=at[0];let Pt=xe.categories.find(Ut=>Ut.props.id===Et);return Pt||(Pt=new St.C({id:Et,title:Et}),xe.categories.push(Pt)),Pt}return xe},Ye={getValue:at=>(0,g.get)(ae.options,at),onChange:(at,Et)=>{ae.onChange((0,rt.Sf)(ae.options,at,Et))}};return(0,Je.g5)(te,Ye,ze,ge),xe}function _t(ae){const te={data:[],options:{}},ge={},xe=new bt.pv;ae(xe,te);for(const ze of xe.getItems())ze.defaultValue!=null&&(0,g.set)(ge,ze.path,ze.defaultValue);return ge}var nn=e(27825),Kt=e(3290);const en=(ae,te)=>{const ge=te.options??{};(0,nn.J)("",ae,ge)},Qt=ae=>{(0,c.useEffect)(()=>{if(!ae.options.xBuckets?.mode){const ge=_t(en);ae.onChange({...ge,...ae.options})}});const te=Rt(ae,en);return c.createElement("div",null,c.createElement("div",null,te.items.map(ge=>ge.render())))},An={id:Kt.wY.id,editor:Qt,transformation:Kt.wY,name:Kt.wY.name,description:Kt.wY.description,state:gt.pn.alpha,categories:new Set([E.m.CreateNewVisualization]),help:he(Kt.wY.id).helperDocs};var un=e(32196),fn=e(40845),Tt=e(84349),$t=e(75059),Yt=e(42734),Cn=e(24293),Tn=e(28802),vn=e(50082),Kn=e(25019);function Yn(ae,te,ge){const xe={},ze={};for(const Ye of ae.fields){const at=(0,ee.Ct)(Ye,ae),Et=ge.index[at],Pt=Et.handler;if(!Pt)continue;const Ut=Ye.values[te];if(Ut==null)continue;const qt=Pt.processor(Ut,xe,ze,Et.handlerArguments);qt!=null&&(xe[Pt.targetProperty??Pt.key]=qt)}return ze.mappingValues&&(xe.mappings=Vt(ze)),xe}var nt=(ae=>(ae.Name="field.name",ae.Value="field.value",ae.Label="field.label",ae.Ignore="__ignore",ae))(nt||{});const yt=[{key:"field.name",name:"Field name",processor:()=>{}},{key:"field.value",name:"Field value",processor:()=>{}},{key:"field.label",name:"Field label",processor:()=>{}},{key:"__ignore",name:"Ignore",processor:()=>{}},{key:"max",processor:Dt},{key:"min",processor:Dt},{key:"unit",processor:ae=>ae.toString()},{key:"decimals",processor:Dt},{key:"displayName",name:"Display name",processor:ae=>ae.toString()},{key:"color",processor:ae=>({fixedColor:ae,mode:Cn.Y.Fixed})},{key:"threshold1",name:"Threshold",targetProperty:"thresholds",processor:(ae,te,ge,xe)=>{const ze=(0,Tn.t)(ae);if(!isNaN(ze))return te.thresholds||(te.thresholds={mode:vn.O.Absolute,steps:[{value:-1/0,color:"green"}]}),te.thresholds.steps.push({value:ze,color:xe.threshold?.color??"red"}),te.thresholds}},{key:"mappings.value",name:"Value mappings / Value",targetProperty:"mappings",defaultReducer:$t.gy.allValues,processor:(ae,te,ge)=>{if((0,g.isArray)(ae))return ge.mappingValues=ae,te.mappings}},{key:"mappings.color",name:"Value mappings / Color",targetProperty:"mappings",defaultReducer:$t.gy.allValues,processor:(ae,te,ge)=>{if((0,g.isArray)(ae))return ge.mappingColors=ae,te.mappings}},{key:"mappings.text",name:"Value mappings / Display text",targetProperty:"mappings",defaultReducer:$t.gy.allValues,processor:(ae,te,ge)=>{if((0,g.isArray)(ae))return ge.mappingTexts=ae,te.mappings}}];function Vt(ae){const te={type:Kn.d.ValueToText,options:{}};if(!ae.mappingValues)return[];for(let ge=0;ge<ae.mappingValues.length;ge++){const xe=ae.mappingValues[ge];xe!=null&&(te.options[xe.toString()]={color:ae.mappingColors&&ae.mappingColors[ge],text:ae.mappingTexts&&ae.mappingTexts[ge],index:ge})}return[te]}let je=null;function tt(){if(je===null){je={};for(const ae of yt)je[ae.key]=ae}return je}function Dt(ae){const te=(0,Tn.t)(ae);if(!isNaN(te))return te}function Ot(ae,te){for(const ge of te)if(ae===ge.fieldName)return ge.handlerKey;return ae.toLowerCase()}function Lt(ae){return ae?tt()[ae]:null}function Gt(ae,te,ge){const xe={index:{}};let ze=te.find(at=>at.handlerKey==="field.name"),Ye=te.find(at=>at.handlerKey==="field.value");for(const at of ae.fields){const Et=(0,ee.Ct)(at,ae),Pt=te.find(Dn=>Dn.fieldName===Et),Ut=Pt?Pt.handlerKey:Et.toLowerCase();let qt=Lt(Ut);ge&&(qt?(qt.key==="field.name"&&(xe.nameField=at),qt.key==="field.value"&&(xe.valueField=at)):Pt||(!xe.nameField&&!ze&&at.type===oe.PU.string&&(xe.nameField=at,qt=Lt("field.name")),!xe.valueField&&!Ye&&at.type===oe.PU.number&&(xe.valueField=at,qt=Lt("field.value")))),!qt&&ge&&(qt=Lt("field.label")),xe.index[Et]={automatic:!Pt,handler:qt,handlerArguments:Pt?.handlerArguments??{},reducerId:Pt?.reducerId??qt?.defaultReducer??$t.gy.lastNotNull}}return xe}var hn=e(83598);function mt(ae){switch(ae){case"threshold1":return!0;default:return!1}}function Bt({handlerArguments:ae,handlerKey:te,onChange:ge}){const xe=ze=>{ge(ze?{...ae,threshold:{...ae.threshold,color:ze}}:{...ae,threshold:void 0})};return c.createElement(c.Fragment,null,te==="threshold1"&&c.createElement(Oe.p,{type:"text",value:"Threshold color","aria-label":"Threshold color",disabled:!0,width:20,prefix:c.createElement(hn.sk,{color:ae.threshold?.color??"red",onChange:xe,enableNamedColors:!0})}))}function Jt({frame:ae,mappings:te,onChange:ge,withReducers:xe,withNameAndValue:ze}){const Ye=(0,fn.of)(wt),at=Rn(ae,te,ze),Et=yt.map(xn=>Mt(xn,!1)),Pt=te.reduce((xn,Sn)=>xn||mt(Sn.handlerKey),!1),Ut=(xn,Sn)=>{const En=te.findIndex(Mn=>Mn.fieldName===xn.fieldName);if(Sn)if(En!==-1){const Mn=[...te];Mn.splice(En,1,{...te[En],handlerKey:Sn.value}),ge(Mn)}else ge([...te,{fieldName:xn.fieldName,handlerKey:Sn.value}]);else ge(En!==-1?te.filter((Mn,Ra)=>Ra!==En):[...te,{fieldName:xn.fieldName,handlerKey:"__ignore"}])},qt=(xn,Sn)=>{const En=te.findIndex(Mn=>Mn.fieldName===xn.fieldName);if(En!==-1){const Mn=[...te];Mn.splice(En,1,{...te[En],reducerId:Sn}),ge(Mn)}else ge([...te,{fieldName:xn.fieldName,handlerKey:xn.handlerKey,reducerId:Sn}])},Dn=(xn,Sn)=>{const En=te.findIndex(Mn=>Mn.fieldName===xn.fieldName);if(En!==-1){const Mn=[...te];Mn.splice(En,1,{...te[En],handlerArguments:Sn}),ge(Mn)}else ge([...te,{fieldName:xn.fieldName,handlerKey:xn.handlerKey,handlerArguments:Sn}])};return c.createElement("table",{className:Ye.table},c.createElement("thead",null,c.createElement("tr",null,c.createElement("th",null,"Field"),c.createElement("th",null,"Use as"),xe&&c.createElement("th",null,"Select"),Pt&&c.createElement("th",null,"Additional settings"))),c.createElement("tbody",null,at.map(xn=>c.createElement("tr",{key:xn.fieldName},c.createElement("td",{className:Ye.labelCell},xn.fieldName),c.createElement("td",{className:Ye.selectCell,"data-testid":`${xn.fieldName}-config-key`},c.createElement(pe.l6,{options:Et,value:xn.configOption,placeholder:xn.placeholder,isClearable:!0,onChange:Sn=>Ut(xn,Sn)})),xe&&c.createElement("td",{"data-testid":`${xn.fieldName}-reducer`,className:Ye.selectCell},c.createElement(Yt.S,{stats:[xn.reducerId],defaultStat:xn.reducerId,onChange:Sn=>qt(xn,Sn[0])})),Pt&&c.createElement("td",{"data-testid":`${xn.fieldName}-handler-arg`,className:Ye.selectCell},c.createElement(Bt,{handlerKey:xn.handlerKey,handlerArguments:xn.handlerArguments,onChange:Sn=>Dn(xn,Sn)}))))))}function Rn(ae,te,ge){const xe=[],ze=Gt(ae,te??[],ge);for(const Ye of ae.fields){const at=(0,ee.Ct)(Ye,ae),Et=ze.index[at],Pt=Mt(Et.handler,Et.automatic);xe.push({fieldName:at,configOption:Et.automatic?null:Pt,placeholder:Et.automatic?Pt?.label:"Choose",handlerKey:Et.handler?.key??null,reducerId:Et.reducerId,handlerArguments:Et.handlerArguments})}for(const Ye of te)if(!xe.find(at=>at.fieldName===Ye.fieldName)){const at=Lt(Ye.handlerKey);xe.push({fieldName:Ye.fieldName,handlerKey:Ye.handlerKey,configOption:Mt(at,!1),missingInFrame:!0,reducerId:Ye.reducerId??$t.gy.lastNotNull,handlerArguments:{}})}return Object.values(xe)}function Mt(ae,te){if(!ae)return null;let ge=ae.name??(0,g.capitalize)(ae.key);return te&&(ge=`${ge} (auto)`),{label:ge,value:ae.key}}const wt=ae=>({table:(0,un.css)`
    margin-top: ${ae.spacing(1)};

    td,
    th {
      border-right: 4px solid ${ae.colors.background.primary};
      border-bottom: 4px solid ${ae.colors.background.primary};
      white-space: nowrap;
    }
    th {
      font-size: ${ae.typography.bodySmall.fontSize};
      line-height: ${ae.spacing(4)};
      padding: ${ae.spacing(0,1)};
    }
  `,labelCell:(0,un.css)`
    font-size: ${ae.typography.bodySmall.fontSize};
    background: ${ae.colors.background.secondary};
    padding: ${ae.spacing(0,1)};
    max-width: 400px;
    overflow: hidden;
    text-overflow: ellipsis;
    min-width: 140px;
  `,selectCell:(0,un.css)`
    padding: 0;
    min-width: 161px;
  `});var Ht=e(81160);function tn(ae,te){let ge=null;for(const Et of te)if(Et.refId===ae.configRefId){ge=Et;break}if(!ge)return te;const xe={fields:[],length:1},ze=Gt(ge,ae.mappings??[],!1);for(const Et of ge.fields){const Pt={...Et},Ut=(0,ee.Ct)(Et,ge),qt=ze.index[Ut],Dn=(0,$t.Nw)({field:Et,reducers:[qt.reducerId]});Pt.values=[Dn[qt.reducerId]],xe.fields.push(Pt)}const Ye=[],at=(0,se.NS)(ae.applyTo||{id:ne.Ct.numeric});for(const Et of te){if(Et===ge&&te.length>1)continue;const Pt={fields:[],length:Et.length,refId:Et.refId};for(const Ut of Et.fields)if(at(Ut,Et,te)){const qt=Yn(xe,0,ze);Pt.fields.push({...Ut,config:{...Ut.config,...qt}})}else Pt.fields.push(Ut);Ye.push(Pt)}return Ye}const It={id:Z.F.configFromData,name:"Config from query results",description:"Set unit, min, max and more from data.",defaultOptions:{configRefId:"config",mappings:[]},operator:ae=>te=>te.pipe((0,Ht.T)(ge=>tn(ae,ge)))};function Xe({input:ae,onChange:te,options:ge}){const xe=(0,fn.of)(Qn),ze=ae.map(Sn=>Sn.refId).filter(Sn=>Sn!=null).map(Sn=>({label:Sn,value:Sn})),Ye=ge.configRefId||"config",at=ge.applyTo??{id:ne.Ct.byType,options:"number"},Et=Tt.g.get(at.id),Pt=ae.find(Sn=>Sn.refId===Ye),Ut=Sn=>{te({...ge,configRefId:Sn.value||"config"})},qt=Sn=>{te({...ge,applyTo:{id:Sn.value}})},Dn=Sn=>{te({...ge,applyTo:{id:at.id,options:Sn}})},xn=Tt.g.list().filter(Sn=>!Sn.excludeFromPicker).map(Sn=>({label:Sn.name,value:Sn.id,description:Sn.description}));return c.createElement(c.Fragment,null,c.createElement(me.C,null,c.createElement(ie.I,{label:"Config query",labelWidth:20},c.createElement(pe.l6,{onChange:Ut,options:ze,value:Ye,width:30}))),c.createElement(me.C,null,c.createElement(ie.I,{label:"Apply to",labelWidth:20},c.createElement(pe.l6,{onChange:qt,options:xn,value:at.id,width:30}))),c.createElement(me.C,null,c.createElement(ie.I,{label:"Apply to options",labelWidth:20,className:xe.matcherOptions},c.createElement(Et.component,{matcher:Et.matcher,data:ae,options:at.options,onChange:Dn}))),c.createElement(me.C,null,Pt&&c.createElement(Jt,{frame:Pt,mappings:ge.mappings,onChange:Sn=>te({...ge,mappings:Sn}),withReducers:!0})))}const jn={id:It.id,editor:Xe,transformation:It,name:It.name,description:It.description,state:gt.pn.beta,categories:new Set([E.m.CalculateNewFields]),help:he(It.id).helperDocs},Qn=ae=>({matcherOptions:(0,un.css)`
    min-width: 404px;
  `});var ia=e(62467),wn=e(58307),sa=e(66350),La=e(15292),xa=e(11710);const ga=16,Ts=ae=>{const{options:te,onChange:ge}=ae,{binary:xe}=te;let ze=!xe?.left,Ye=!xe?.right;const at=ae.names.map(En=>(En===xe?.left&&(ze=!0),En===xe?.right&&(Ye=!0),{label:En,value:En})),Et=ze?at:[...at,{label:xe?.left,value:xe?.left}],Pt=Ye?at:[...at,{label:xe?.right,value:xe?.right}],Ut=xa.b.list().map(En=>({label:En.binaryOperationID,value:En.binaryOperationID})),qt=En=>{ge({...te,mode:sa.UY.BinaryOperation,binary:En})},Dn=En=>{qt({...xe,left:En.value})},xn=En=>{qt({...xe,right:En.value})},Sn=En=>{qt({...xe,operator:En.value})};return c.createElement(c.Fragment,null,c.createElement(me.C,null,c.createElement(ie.I,{label:"Operation",labelWidth:ga},c.createElement(pe.l6,{allowCustomValue:!0,placeholder:"Field or number",options:Et,className:"min-width-18",value:xe?.left,onChange:Dn})),c.createElement(ie.I,null,c.createElement(pe.l6,{className:"width-4",options:Ut,value:xe?.operator??Ut[0].value,onChange:Sn})),c.createElement(ie.I,null,c.createElement(pe.l6,{allowCustomValue:!0,placeholder:"Field or number",className:"min-width-10",options:Pt,value:xe?.right,onChange:xn}))))},Us=ae=>{const{names:te,onChange:ge,options:xe}=ae,{cumulative:ze}=xe,Ye=te.map(Ut=>({label:Ut,value:Ut})),at=Ut=>{const qt=Ut.length?Ut[0]:$t.gy.sum;Et({...ze,reducer:qt})},Et=Ut=>{ge({...xe,mode:sa.UY.CumulativeFunctions,cumulative:Ut})},Pt=Ut=>{Et({...ze,field:Ut.value})};return c.createElement(c.Fragment,null,c.createElement(ie.I,{label:"Field",labelWidth:ga},c.createElement(pe.l6,{placeholder:"Field",options:Ye,className:"min-width-18",value:ze?.field,onChange:Pt})),c.createElement(ie.I,{label:"Calculation",labelWidth:ga},c.createElement(Yt.S,{allowMultiple:!1,className:"width-18",stats:[ze?.reducer||$t.gy.sum],onChange:at,defaultStat:$t.gy.sum,filterOptions:Ut=>Ut.id===$t.gy.sum||Ut.id===$t.gy.mean})))},Bs=ae=>{const{options:te,onChange:ge}=ae,{index:xe}=te,ze=Ye=>{ge({...te,index:{asPercentile:Ye.currentTarget.checked}})};return c.createElement(c.Fragment,null,c.createElement(ie.I,{labelWidth:ga,label:"As percentile",tooltip:"Transform the row index as a percentile."},c.createElement(La.K,{value:!!xe?.asPercentile,onChange:ze})))};var ks=e(66864),Ms=e(92174);const Dr=ae=>{const{names:te,selected:ge,onChange:xe,options:ze}=ae,{reduce:Ye}=ze,at=qt=>{xe({...ze,reduce:qt})},Et=qt=>{ge.indexOf(qt)>-1?Pt(ge.filter(Dn=>Dn!==qt)):Pt([...ge,qt])},Pt=qt=>{at({...Ye,include:qt})},Ut=qt=>{const Dn=qt.length?qt[0]:$t.gy.sum,{reduce:xn}=ze;at({...xn,reducer:Dn})};return c.createElement(c.Fragment,null,c.createElement(ie.I,{label:"Operation",labelWidth:ga,grow:!0},c.createElement(ks.Gy,{spacing:"xs",align:"flex-start",wrap:!0},te.map((qt,Dn)=>c.createElement(Ms.m,{key:`${qt}/${Dn}`,onClick:()=>{Et(qt)},label:qt,selected:ge.indexOf(qt)>-1})))),c.createElement(ie.I,{label:"Calculation",labelWidth:ga},c.createElement(Yt.S,{allowMultiple:!1,className:"width-18",stats:[Ye?.reducer||$t.gy.sum],onChange:Ut,defaultStat:$t.gy.sum})))};var _s=e(27618);const Ir=ae=>{const{options:te,onChange:ge}=ae,{unary:xe}=te,ze=Dn=>{ge({...te,mode:sa.UY.UnaryOperation,unary:Dn})},Ye=Dn=>{ze({...xe,operator:Dn.value})},at=Dn=>{ze({...xe,fieldName:Dn.value})};let Et=!xe?.fieldName;const Pt=ae.names.map(Dn=>(Dn===xe?.fieldName&&(Et=!0),{label:Dn,value:Dn})),Ut=_s.j.list().map(Dn=>({label:Dn.unaryOperationID,value:Dn.unaryOperationID})),qt=Et?Pt:[...Pt,{label:xe?.fieldName,value:xe?.fieldName}];return c.createElement(c.Fragment,null,c.createElement(me.C,null,c.createElement(ie.I,{label:"Operation",labelWidth:ga},c.createElement(pe.l6,{options:Ut,value:xe?.operator??Ut[0].value,onChange:Ye})),c.createElement(ie.I,{label:"(",labelWidth:2},c.createElement(pe.l6,{placeholder:"Field",className:"min-width-11",options:qt,value:xe?.fieldName,onChange:at})),c.createElement(ot.c,{width:2},")")))};var Xs=e(60188);const Gs=ae=>{const{options:te,names:ge,onChange:xe}=ae,{window:ze}=te,Ye=ge.map(En=>({label:En,value:En})),at=[{label:"Trailing",value:sa.ip.Trailing},{label:"Centered",value:sa.ip.Centered}],Et=[{label:"Percentage",value:sa.Bp.Percentage},{label:"Fixed",value:sa.Bp.Fixed}],Pt=En=>{xe({...te,mode:sa.UY.WindowFunctions,window:En})},Ut=En=>{Pt({...ze,field:En.value})},qt=En=>{Pt({...ze,windowSize:En&&ze?.windowSizeMode===sa.Bp.Percentage?En/100:En})},Dn=En=>{Pt({...ze,windowSize:ze?.windowSize?En===sa.Bp.Percentage?ze.windowSize/100:ze.windowSize*100:void 0,windowSizeMode:En})},xn=En=>{const Mn=En.length?En[0]:$t.gy.sum;Pt({...ze,reducer:Mn})},Sn=En=>{Pt({...ze,windowAlignment:En})};return c.createElement(c.Fragment,null,c.createElement(ie.I,{label:"Field",labelWidth:ga},c.createElement(pe.l6,{placeholder:"Field",options:Ye,className:"min-width-18",value:ze?.field,onChange:Ut})),c.createElement(ie.I,{label:"Calculation",labelWidth:ga},c.createElement(Yt.S,{allowMultiple:!1,className:"width-18",stats:[ze?.reducer||$t.gy.mean],onChange:xn,defaultStat:$t.gy.mean,filterOptions:En=>En.id===$t.gy.mean||En.id===$t.gy.variance||En.id===$t.gy.stdDev})),c.createElement(ie.I,{label:"Type",labelWidth:ga},c.createElement(de.z,{value:ze?.windowAlignment??sa.ip.Trailing,options:at,onChange:Sn})),c.createElement(ie.I,{label:"Window size mode"},c.createElement(de.z,{value:ze?.windowSizeMode??sa.Bp.Percentage,options:Et,onChange:Dn})),c.createElement(ie.I,{label:ze?.windowSizeMode===sa.Bp.Percentage?"Window size %":"Window size",labelWidth:ga,tooltip:ze?.windowSizeMode===sa.Bp.Percentage?"Set the window size as a percentage of the total data":"Window size"},c.createElement(Xs.Q,{placeholder:"Auto",min:.1,value:ze?.windowSize&&ze.windowSizeMode===sa.Bp.Percentage?ze.windowSize*100:ze?.windowSize,onChange:qt})))},Br=[{value:sa.UY.BinaryOperation,label:"Binary operation"},{value:sa.UY.UnaryOperation,label:"Unary operation"},{value:sa.UY.ReduceRow,label:"Reduce row"},{value:sa.UY.Index,label:"Row index"}];Y.$.featureToggles.addFieldFromCalculationStatFunctions&&Br.push({value:sa.UY.CumulativeFunctions,label:"Cumulative functions"},{value:sa.UY.WindowFunctions,label:"Window functions"});const Mr=new Set([oe.PU.time,oe.PU.number,oe.PU.string]),vr=ae=>{const{options:te,onChange:ge,input:xe}=ae,ze=te?.reduce?.include,[Ye,at]=(0,c.useState)({names:[],selected:[]});(0,c.useEffect)(()=>{const En={interpolate:Ra=>Ra},Mn=(0,ia.of)(xe).pipe(z.c.ensureColumnsTransformer.operator(null,En),Pt(),Et(),Ut(ze||[])).subscribe(({selected:Ra,names:yr})=>{at({names:yr,selected:Ra})});return()=>{Mn.unsubscribe()}},[xe,ze]);const Et=()=>{if(!Y.$.featureToggles.transformationsVariableSupport)return wn.D;const En=(0,Ie.w)();return Mn=>Mn.pipe((0,Ht.T)(Ra=>(Ra.push(...En.getVariables().map(yr=>"$"+yr.name)),Ra)))},Pt=()=>En=>En.pipe((0,Ht.T)(Mn=>{const Ra=[],yr={};for(const gr of Mn)for(const Sr of gr.fields){if(!Mr.has(Sr.type))continue;const or=(0,ee.Ct)(Sr,gr,Mn);yr[or]||(yr[or]=!0,Ra.push(or))}return Ra})),Ut=En=>Mn=>Mn.pipe((0,Ht.T)(Ra=>{if(!En.length)return{names:Ra,selected:[]};const yr=[],gr=[];for(const Sr of Ra)En.includes(Sr)&&gr.push(Sr),yr.push(Sr);return{names:yr,selected:gr}})),qt=En=>{ge({...te,replaceFields:En.currentTarget.checked})},Dn=En=>{const Mn=En.value??sa.UY.BinaryOperation;Mn===sa.UY.WindowFunctions&&(te.window=te.window??sa.Uj),ge({...te,mode:Mn})},xn=En=>{ge({...te,alias:En.target.value})},Sn=te.mode??sa.UY.BinaryOperation;return c.createElement(c.Fragment,null,c.createElement(ie.I,{labelWidth:ga,label:"Mode"},c.createElement(pe.l6,{className:"width-18",options:Br,value:Br.find(En=>En.value===Sn),onChange:Dn})),Sn===sa.UY.BinaryOperation&&c.createElement(Ts,{options:te,names:Ye.names,onChange:ae.onChange}),Sn===sa.UY.UnaryOperation&&c.createElement(Ir,{names:Ye.names,options:te,onChange:ae.onChange}),Sn===sa.UY.ReduceRow&&c.createElement(Dr,{names:Ye.names,selected:Ye.selected,options:te,onChange:ae.onChange}),Sn===sa.UY.CumulativeFunctions&&c.createElement(Us,{names:Ye.names,options:te,onChange:ae.onChange}),Sn===sa.UY.WindowFunctions&&c.createElement(Gs,{names:Ye.names,options:te,onChange:ae.onChange}),Sn===sa.UY.Index&&c.createElement(Bs,{options:te,onChange:ae.onChange}),c.createElement(ie.I,{labelWidth:ga,label:"Alias"},c.createElement(Oe.p,{className:"width-18",value:te.alias??"",placeholder:(0,sa.sw)(te),onChange:xn})),c.createElement(ie.I,{labelWidth:ga,label:"Replace all fields"},c.createElement(La.K,{value:!!te.replaceFields,onChange:qt})))},fr={id:Z.F.calculateField,editor:vr,transformation:z.c.calculateFieldTransformer,name:z.c.calculateFieldTransformer.name,description:"Use the row values to calculate a new field.",categories:new Set([E.m.CalculateNewFields]),help:he(Z.F.calculateField).helperDocs};var js=e(82150);const to=[{value:js.x1.FieldName,label:"Copy frame name to field name"},{value:js.x1.Label,label:"Add a label with the frame name"},{value:js.x1.Drop,label:"Ignore the frame name"}];class Ar extends c.PureComponent{constructor(te){super(te),this.onModeChanged=ge=>{const{options:xe,onChange:ze}=this.props,Ye=ge.value??js.x1.FieldName;ze({...xe,frameNameMode:Ye})},this.onLabelChanged=ge=>{const{options:xe}=this.props;this.props.onChange({...xe,frameNameLabel:ge.target.value})}}render(){const{options:te}=this.props,ge=te.frameNameMode??js.x1.FieldName;return c.createElement("div",null,c.createElement(ie.I,{label:"Name",labelWidth:16,grow:!0},c.createElement(pe.l6,{width:36,options:to,value:to.find(xe=>xe.value===ge),onChange:this.onModeChanged})),ge===js.x1.Label&&c.createElement(ie.I,{label:"Label",labelWidth:16,grow:!0},c.createElement(Oe.p,{width:36,value:te.frameNameLabel??"",placeholder:"frame",onChange:this.onLabelChanged})))}}const Ko={id:Z.F.concatenate,editor:Ar,transformation:z.c.concatenateTransformer,name:z.c.concatenateTransformer.name,description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",categories:new Set([E.m.Combine]),help:he(Z.F.concatenate).helperDocs};var no=e(91410),vo=e(76218),ao=e(9988),Do=e(63577),Xr=e(75494),mo=e(14578),qr=e(72093),Po=e(29158);const jr=({transformIndex:ae,value:te,index:ge,mappedIndex:xe,onChangeEnumValue:ze,onRemoveEnumRow:Ye,checkIsEnumUniqueValue:at})=>{const Et=(0,fn.of)(Io),[Pt,Ut]=(0,c.useState)(te),[qt,Dn]=(0,c.useState)(Pt===""),[xn,Sn]=(0,c.useState)(null),En=(0,c.useRef)(null);(0,c.useEffect)(()=>{En.current&&En.current.focus()},[En]);const Mn=or=>{or.currentTarget.value!==""&&at(or.currentTarget.value)&&or.currentTarget.value!==te?Sn("Enum value already exists"):Sn(null),Ut(or.currentTarget.value)},Ra=()=>{if(Dn(!1),Sn(null),Pt===""||xn!==null){Ye(xe);return}ze(xe,Pt)},yr=or=>{or.key==="Enter"&&(or.preventDefault(),Ra())},gr=()=>{Dn(!0)},Sr=()=>{Ye(xe)};return c.createElement(Xr.sx,{key:`${ae}/${te}`,draggableId:`${ae}/${te}`,index:ge},or=>c.createElement("tr",{key:ge,ref:or.innerRef,...or.draggableProps},c.createElement("td",null,c.createElement("div",{className:Et.dragHandle,...or.dragHandleProps},c.createElement(mo.I,{name:"draggabledots",size:"lg"}))),qt?c.createElement("td",null,c.createElement(Oe.p,{ref:En,type:"text",value:Pt,onChange:Mn,onBlur:Ra,onKeyDown:yr}),xn&&c.createElement(qr.P,null,xn)):c.createElement("td",{onClick:gr,className:Et.clickableTableCell},te&&te!==""?te:"Click to edit"),c.createElement("td",{className:Et.textAlignCenter},c.createElement(ks.Gy,{spacing:"sm"},c.createElement(Po.K,{name:"trash-alt",onClick:Sr,"data-testid":"remove-enum-row","aria-label":"Delete enum row",tooltip:"Delete"})))))},Io=ae=>({dragHandle:(0,un.css)({cursor:"grab"}),textAlignCenter:(0,un.css)({textAlign:"center"}),clickableTableCell:(0,un.css)({cursor:"pointer",width:"100px","&:hover":{color:ae.colors.text.maxContrast}})}),$o=jr,qo=({input:ae,options:te,transformIndex:ge,onChange:xe})=>{const ze=(0,fn.of)(lo),[Ye,at]=(0,c.useState)(te.conversions[ge].enumConfig?.text??[]);(0,c.useEffect)(()=>{!te.conversions[ge].enumConfig?.text?.length&&ae.length&&Et()},[ae]),(0,c.useEffect)(()=>{(()=>{const Mn=Ye.map(gr=>gr),Ra=te.conversions,yr={text:Mn};Ra[ge]={...Ra[ge],enumConfig:yr},xe({...te,conversions:Ra})})()},[ge,Ye]);const Et=()=>{const En=ae.flatMap(Ra=>Ra?.fields??[]).find(Ra=>Ra.name===te.conversions[ge].targetField);if(!En)return;const Mn=new Set(En?.values);Ye.length>0&&!(0,g.isEqual)(Ye,Array.from(Mn))&&!window.confirm("This action will overwrite the existing configuration. Are you sure you want to continue?")||at([...Mn])},Pt=(En,Mn)=>{const Ra=[...Ye];Ra.splice(En,1,Mn),at(Ra)},Ut=En=>{const Mn=[...Ye];Mn.splice(En,1),at(Mn)},qt=()=>{at(["",...Ye])},Dn=(En,Mn)=>{Ye.includes(Mn)||Pt(En,Mn)},xn=En=>Ye.includes(En),Sn=En=>{if(!En.destination)return;const Mn=Ye.length-En.source.index-1,Ra=Ye.length-En.destination.index-1,yr=[...Ye],gr=yr[Mn];yr.splice(Mn,1),yr.splice(Ra,0,gr),at(yr)};return c.createElement(me.C,null,c.createElement(ks.Gy,null,c.createElement(fe.$n,{size:"sm",icon:"plus",onClick:()=>Et(),className:ze.button},"Generate enum values from data"),c.createElement(fe.$n,{size:"sm",icon:"plus",onClick:()=>qt(),className:ze.button},"Add enum value")),c.createElement(ks.gW,null,c.createElement("table",{className:ze.compactTable},c.createElement(Xr.JY,{onDragEnd:Sn},c.createElement(Xr.gL,{droppableId:"sortable-enum-config-mappings",direction:"vertical"},En=>c.createElement("tbody",{ref:En.innerRef,...En.droppableProps},[...Ye].reverse().map((Mn,Ra)=>{const yr=Ye.length-Ra-1;return c.createElement($o,{key:`${ge}/${Mn}`,transformIndex:ge,value:Mn,index:Ra,mappedIndex:yr,onChangeEnumValue:Dn,onRemoveEnumRow:Ut,checkIsEnumUniqueValue:xn})}),En.placeholder))))))},lo=ae=>({compactTable:(0,un.css)({"tbody td":{padding:ae.spacing(.5)},marginTop:ae.spacing(1),marginBottom:ae.spacing(2)}),button:(0,un.css)({marginTop:ae.spacing(1)})}),Vo={settings:{width:24,isClearable:!1}},Co=({input:ae,options:te,onChange:ge})=>{const xe=ao.bx.filter(Sn=>Sn.value!==oe.PU.trace),ze=(0,We.qt)(!0),Ye=(0,no.P3)();ze.push({label:"Browser",value:"browser"}),ze.push({label:"UTC",value:"utc"});for(const Sn of Ye)ze.push({label:Sn,value:Sn});const at=(0,c.useCallback)(Sn=>En=>{const Mn=te.conversions;Mn[Sn]={...Mn[Sn],targetField:En??"",dateFormat:void 0},ge({...te,conversions:Mn})},[ge,te]),Et=(0,c.useCallback)(Sn=>En=>{const Mn=te.conversions;Mn[Sn]={...Mn[Sn],destinationType:En.value},ge({...te,conversions:Mn})},[ge,te]),Pt=(0,c.useCallback)(Sn=>En=>{const Mn=te.conversions;Mn[Sn]={...Mn[Sn],dateFormat:En.currentTarget.value},ge({...te,conversions:Mn})},[ge,te]),Ut=(0,c.useCallback)(Sn=>En=>{const Mn=te.conversions;Mn[Sn]={...Mn[Sn],joinWith:En.currentTarget.value},ge({...te,conversions:Mn})},[ge,te]),qt=(0,c.useCallback)(()=>{ge({...te,conversions:[...te.conversions,{targetField:void 0,destinationType:void 0,dateFormat:void 0}]})},[ge,te]),Dn=(0,c.useCallback)(Sn=>{const En=te.conversions;En.splice(Sn,1),ge({...te,conversions:En})},[ge,te]),xn=(0,c.useCallback)(Sn=>En=>{const Mn=te.conversions;Mn[Sn]={...Mn[Sn],timezone:En?.value},ge({...te,conversions:Mn})},[ge,te]);return c.createElement(c.Fragment,null,te.conversions.map((Sn,En)=>{const Mn=(0,Do.findField)(ae?.[0],Sn.targetField);return c.createElement("div",{key:`${Sn.targetField}-${En}`},c.createElement(me.C,null,c.createElement(ie.I,{label:"Field"},c.createElement(vo.O,{context:{data:ae},value:Sn.targetField??"",onChange:at(En),item:Vo})),c.createElement(ie.I,{label:"as"},c.createElement(pe.l6,{options:xe,value:Sn.destinationType,placeholder:"Type",onChange:Et(En),width:18})),Sn.destinationType===oe.PU.time&&c.createElement(ie.I,{label:"Input format",tooltip:"Specify the format of the input field so Grafana can parse the date string correctly."},c.createElement(Oe.p,{value:Sn.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:Pt(En),width:24})),Sn.destinationType===oe.PU.string&&c.createElement(c.Fragment,null,(Sn.joinWith?.length||Mn?.type===oe.PU.other)&&c.createElement(ie.I,{label:"Join with",tooltip:"Use an explicit separator when joining array values"},c.createElement(Oe.p,{value:Sn.joinWith,placeholder:"JSON",onChange:Ut(En),width:9})),Sn.dateFormat||Mn?.type===oe.PU.time&&c.createElement(c.Fragment,null,c.createElement(ie.I,{label:"Date format",tooltip:"Specify the output format."},c.createElement(Oe.p,{value:Sn.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:Pt(En),width:24})),c.createElement(ie.I,{label:"Set timezone",tooltip:"Set the timezone of the date manually"},c.createElement(pe.l6,{options:ze,value:Sn.timezone,onChange:xn(En),isClearable:!0})))),c.createElement(fe.$n,{size:"md",icon:"trash-alt",variant:"secondary",onClick:()=>Dn(En),"aria-label":"Remove convert field type transformer"})),Sn.destinationType===oe.PU.enum&&c.createElement(qo,{input:ae,options:te,transformIndex:En,onChange:ge}))}),c.createElement(fe.$n,{size:"sm",icon:"plus",onClick:qt,variant:"secondary","aria-label":"Add a convert field type transformer"},"Convert field type"))},zo={id:Z.F.convertFieldType,editor:Co,transformation:z.c.convertFieldTypeTransformer,name:z.c.convertFieldTypeTransformer.name,description:z.c.convertFieldTypeTransformer.description,categories:new Set([E.m.Reformat]),help:he(Z.F.convertFieldType).helperDocs};var So=e(54479);class si extends c.PureComponent{constructor(te){super(te),this.onFieldToggle=ge=>{const{selected:xe}=this.state;xe.indexOf(ge)>-1?this.onChange(xe.filter(ze=>ze!==ge)):this.onChange([...xe,ge])},this.onChange=ge=>{const{regex:xe,isRegexValid:ze}=this.state,Ye={...this.props.options,include:{names:ge}};xe&&ze&&(Ye.include=Ye.include??{},Ye.include.pattern=xe),this.setState({selected:ge},()=>{this.props.onChange(Ye)})},this.onInputBlur=ge=>{const{selected:xe,regex:ze}=this.state;let Ye=!0;try{ze&&(0,So.dO)(ze)}catch{Ye=!1}Ye?this.props.onChange({...this.props.options,include:{pattern:ze}}):this.props.onChange({...this.props.options,include:{names:xe}}),this.setState({isRegexValid:Ye})},this.onVariableChange=ge=>{this.props.onChange({...this.props.options,include:{variable:ge.value}}),this.setState({variable:ge.value})},this.onFromVariableChange=ge=>{const xe=ge.currentTarget.checked;this.props.onChange({...this.props.options,byVariable:xe}),this.setState({byVariable:xe})},this.state={include:te.options.include?.names||[],regex:te.options.include?.pattern,variable:te.options.include?.variable,byVariable:te.options.byVariable||!1,options:[],variables:[],selected:[],isRegexValid:!0}}componentDidMount(){this.initOptions()}componentDidUpdate(te){this.props.input!==te.input&&this.initOptions()}initOptions(){const{input:te,options:ge}=this.props,xe=Array.from(ge.include?.names??[]),ze=(0,Ie.w)().getVariables().map(Et=>({label:"$"+Et.name,value:"$"+Et.name})),Ye=[],at={};for(const Et of te)for(const Pt of Et.fields){const Ut=(0,ee.Ct)(Pt,Et,te);let qt=at[Ut];qt||(qt=at[Ut]={name:Ut,count:0},Ye.push(qt)),qt.count++}if(ge.include?.pattern)try{const Et=(0,So.dO)(ge.include.pattern);for(const Pt of Ye)Et.test(Pt.name)&&xe.push(Pt.name)}catch(Et){console.error(Et)}if(xe.length){const Et=Ye.filter(Pt=>xe.includes(Pt.name));this.setState({options:Ye,selected:Et.map(Pt=>Pt.name),variables:ze,byVariable:ge.byVariable||!1,variable:ge.include?.variable,regex:ge.include?.pattern})}else this.setState({options:Ye,selected:Ye.map(Et=>Et.name),variables:ze,byVariable:ge.byVariable||!1,variable:ge.include?.variable,regex:ge.include?.pattern})}render(){const{options:te,selected:ge,isRegexValid:xe}=this.state;return c.createElement("div",null,c.createElement(me.C,{label:"Use variable"},c.createElement(ie.I,{label:"From variable"},c.createElement(La.K,{value:this.state.byVariable,onChange:this.onFromVariableChange}))),this.state.byVariable?c.createElement(me.C,null,c.createElement(ie.I,{label:"Variable"},c.createElement(pe.l6,{value:this.state.variable,onChange:this.onVariableChange,options:this.state.variables||[]}))):c.createElement(me.C,{label:"Identifier"},c.createElement(ie.I,{label:"Identifier",invalid:!xe,error:xe?void 0:"Invalid pattern"},c.createElement(Oe.p,{placeholder:"Regular expression pattern",value:this.state.regex||"",onChange:ze=>this.setState({regex:ze.currentTarget.value}),onBlur:this.onInputBlur,width:25})),te.map((ze,Ye)=>{const at=`${ze.name}${ze.count>1?" ("+ze.count+")":""}`,Et=ge.indexOf(ze.name)>-1;return c.createElement(Ms.m,{key:`${ze.name}/${Ye}`,onClick:()=>{this.onFieldToggle(ze.name)},label:at,selected:Et})})))}}const Yo={id:Z.F.filterFieldsByName,editor:si,transformation:z.c.filterFieldsByNameTransformer,name:z.c.filterFieldsByNameTransformer.name,description:"Removes part of the query results using a regex pattern. The pattern can be inclusive or exclusive.",categories:new Set([E.m.Filter]),help:he(Z.F.filterFieldsByName).helperDocs};class ri extends c.PureComponent{constructor(te){super(te),this.onFieldToggle=ge=>{const{selected:xe}=this.state;xe.indexOf(ge)>-1?this.onChange(xe.filter(ze=>ze!==ge)):this.onChange([...xe,ge])},this.onChange=ge=>{this.setState({selected:ge}),this.props.onChange({...this.props.options,include:ge.join("|")})},this.state={include:te.options.include||"",options:[],selected:[]}}componentDidMount(){this.initOptions()}componentDidUpdate(te){this.props.input!==te.input&&this.initOptions()}initOptions(){const{input:te,options:ge}=this.props,xe=ge.include?ge.include.split("|"):[],ze=[],Ye={};for(const at of te)if(at.refId){let Et=Ye[at.refId];Et||(Et=Ye[at.refId]={refId:at.refId,count:0},ze.push(Et)),Et.count++}if(xe.length){const at=[],Et=[];for(const Pt of ze)xe.includes(Pt.refId)&&Et.push(Pt),at.push(Pt);this.setState({options:at,selected:Et.map(Pt=>Pt.refId)})}else this.setState({options:ze,selected:[]})}render(){const{options:te,selected:ge}=this.state,{input:xe}=this.props;return c.createElement(c.Fragment,null,xe.length<=1&&c.createElement("div",null,c.createElement(qr.P,null,"Filter data by query expects multiple queries in the input.")),c.createElement(ie.I,{label:"Series refId",labelWidth:16,shrink:!0},c.createElement(ks.Gy,{spacing:"xs",align:"flex-start",wrap:!0},te.map((ze,Ye)=>{const at=`${ze.refId}${ze.count>1?" ("+ze.count+")":""}`,Et=ge.indexOf(ze.refId)>-1;return c.createElement(Ms.m,{key:`${ze.refId}/${Ye}`,onClick:()=>{this.onFieldToggle(ze.refId)},label:at,selected:Et})}))))}}const Ao={id:Z.F.filterByRefId,editor:ri,transformation:z.c.filterFramesByRefIdTransformer,name:z.c.filterFramesByRefIdTransformer.name,description:"Filter data by query. This is useful if you are sharing the results from a different panel that has many queries and you want to only visualize a subset of that in this panel.",categories:new Set([E.m.Filter]),help:he(Z.F.filterByRefId).helperDocs};var so=e(15400);const ko={settings:{width:30,filter:ae=>ae.type===oe.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null};function eo({input:ae,options:te,onChange:ge}){const xe=(0,c.useCallback)(Pt=>{ge({...te,stringField:Pt??""})},[ge,te]),ze=(0,c.useCallback)(Pt=>{const Ut=Pt.value??so.gs.UpperCase;ge({...te,outputFormat:Ut})},[ge,te]),Ye=(0,c.useCallback)(Pt=>{ge({...te,substringStart:Pt??0})},[ge,te]),at=(0,c.useCallback)(Pt=>{ge({...te,substringEnd:Pt??0})},[ge,te]),Et=Object.values(so.gs).map(Pt=>({label:Pt,value:Pt}));return c.createElement(c.Fragment,null,c.createElement(me.C,null,c.createElement(ie.I,{label:"Field",labelWidth:10},c.createElement(vo.O,{context:{data:ae},value:te.stringField??"",onChange:xe,item:ko})),c.createElement(ie.I,{label:"Format",labelWidth:10},c.createElement(pe.l6,{options:Et,value:te.outputFormat,onChange:ze,width:20}))),te.outputFormat===so.gs.Substring&&c.createElement(me.C,null,c.createElement(ie.I,{label:"Substring range",labelWidth:15},c.createElement(Xs.Q,{min:0,value:te.substringStart??0,onChange:Ye,width:7})),c.createElement(ie.I,null,c.createElement(Xs.Q,{min:0,value:te.substringEnd??0,onChange:at,width:7}))))}const No={id:Z.F.formatString,editor:eo,transformation:z.c.formatStringTransformer,name:z.c.formatStringTransformer.name,state:gt.pn.beta,description:z.c.formatStringTransformer.description,categories:new Set([E.m.Reformat])};function To({input:ae,options:te,onChange:ge}){const xe=[],ze=(0,We.qt)(!0);for(const Pt of ae)for(const Ut of Pt.fields)if(Ut.type==="time"){const qt=(0,ee.Ct)(Ut,Pt,ae);xe.push({label:qt,value:qt})}const Ye=(0,c.useCallback)(Pt=>{const Ut=Pt?.value!==void 0?Pt.value:"";ge({...te,timeField:Ut})},[ge,te]),at=(0,c.useCallback)(Pt=>{const Ut=Pt.target.value;ge({...te,outputFormat:Ut})},[ge,te]),Et=(0,c.useCallback)(Pt=>{const Ut=Pt?.value!==void 0?Pt.value:"";ge({...te,timezone:Ut})},[ge,te]);return c.createElement(c.Fragment,null,c.createElement(me.C,null,c.createElement(ie.I,{label:"Time Field",labelWidth:15,grow:!0},c.createElement(pe.l6,{options:xe,value:te.timeField,onChange:Ye,placeholder:"time",isClearable:!0})),c.createElement(ie.I,{label:"Format",labelWidth:10,tooltip:c.createElement(c.Fragment,null,"The output format for the field specified as a"," ",c.createElement("a",{href:"https://momentjs.com/docs/#/displaying/",target:"_blank",rel:"noopener noreferrer"},"Moment.js format string"),"."),interactive:!0},c.createElement(Oe.p,{onChange:at,value:te.outputFormat})),c.createElement(ie.I,{label:"Set Timezone",tooltip:"Set the timezone of the date manually",labelWidth:20},c.createElement(pe.l6,{options:ze,value:te.timezone,onChange:Et,isClearable:!0}))))}const oi={id:Z.F.formatTime,editor:To,transformation:z.c.formatTimeTransformer,name:z.c.formatTimeTransformer.name,state:gt.pn.alpha,description:z.c.formatTimeTransformer.description,help:he(Z.F.formatTime).helperDocs};var oo=e(25094),zt=e(67061),rn=e(42418);const zn=({input:ae,options:te,onChange:ge})=>{const xe=(0,We.ZI)(ae),ze=(0,c.useCallback)(Pt=>Ut=>{ge({...te,fields:{...te.fields,[Pt]:Ut}})},[ge]);let Ye,at=!1;for(const Pt of Object.values(te.fields))Pt.aggregations.length>0&&Pt.operation!==null&&(at=!0),Pt.operation===oo.R3.groupBy&&(Ye=!0);const Et=at&&!Ye;return c.createElement(zt.B,{direction:"column"},Et&&c.createElement(rn.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),xe.map(Pt=>c.createElement(ta,{onConfigChange:ze(Pt),fieldName:Pt,config:te.fields[Pt],key:Pt})))},Fn=[{label:"Group by",value:oo.R3.groupBy},{label:"Calculate",value:oo.R3.aggregate}],ta=({fieldName:ae,config:te,onConfigChange:ge})=>{const xe=(0,fn.$j)(),ze=ua(xe),Ye=(0,c.useCallback)(at=>{ge({aggregations:te?.aggregations??[],operation:at?.value??null})},[te,ge]);return c.createElement(ie.I,{className:ze.label,label:ae,grow:!0,shrink:!0},c.createElement(zt.B,{gap:.5,direction:"row"},c.createElement("div",{className:ze.operation},c.createElement(pe.l6,{options:Fn,value:te?.operation,placeholder:"Ignored",onChange:Ye,isClearable:!0})),te?.operation===oo.R3.aggregate&&c.createElement(Yt.S,{className:ze.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:te.aggregations,onChange:at=>{ge({...te,aggregations:at})}})))},ua=ae=>({label:(0,un.css)`
      label {
        min-width: ${ae.spacing(32)};
      }
    `,operation:(0,un.css)`
      flex-shrink: 0;
      height: 100%;
      width: ${ae.spacing(24)};
    `,aggregations:(0,un.css)`
      flex-grow: 1;
    `}),ya={id:Z.F.groupBy,editor:zn,transformation:z.c.groupByTransformer,name:z.c.groupByTransformer.name,description:z.c.groupByTransformer.description,categories:new Set([E.m.Combine,E.m.CalculateNewFields,E.m.Reformat]),help:he(Z.F.groupBy).helperDocs};var as=e(68133),Ga=e(46819),_a=e(88575);const nr=({input:ae,options:te,onChange:ge})=>{const xe=(0,We.ZI)(ae),ze=te.showSubframeHeaders===void 0?as.l:te.showSubframeHeaders,Ye=(0,c.useCallback)(qt=>Dn=>{ge({...te,fields:{...te.fields,[qt]:Dn}})},[ge]),at=(0,c.useCallback)(()=>{const qt=te.showSubframeHeaders===void 0?!as.l:!te.showSubframeHeaders;ge({showSubframeHeaders:qt,fields:{...te.fields}})},[ge]);let Et,Pt=!1;for(const qt of Object.values(te.fields))qt.aggregations.length>0&&qt.operation!==null&&(Pt=!0),qt.operation===oo.R3.groupBy&&(Et=!0);const Ut=Pt&&!Et;return c.createElement(Ga.B,{direction:"column"},Ut&&c.createElement(rn.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),c.createElement("div",null,xe.map(qt=>c.createElement(Qs,{onConfigChange:Ye(qt),fieldName:qt,config:te.fields[qt],key:qt}))),c.createElement(_a.D,{label:"Show field names in nested tables",description:"If enabled nested tables will show field names as a table header"},c.createElement(La.d,{value:ze,onChange:at})))},ps=[{label:"Group by",value:oo.R3.groupBy},{label:"Calculate",value:oo.R3.aggregate}],Qs=({fieldName:ae,config:te,onConfigChange:ge})=>{const xe=(0,fn.$j)(),ze=Hr(xe),Ye=(0,c.useCallback)(at=>{ge({aggregations:te?.aggregations??[],operation:at?.value??null})},[te,ge]);return c.createElement(ie.I,{className:ze.label,label:ae,grow:!0,shrink:!0},c.createElement(Ga.B,{gap:.5,direction:"row",wrap:!1},c.createElement("div",{className:ze.operation},c.createElement(pe.l6,{options:ps,value:te?.operation,placeholder:"Ignored",onChange:Ye,isClearable:!0})),te?.operation===oo.R3.aggregate&&c.createElement(Yt.S,{className:ze.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:te.aggregations,onChange:at=>{ge({...te,aggregations:at})}})))},Hr=ae=>({label:(0,un.css)({minWidth:ae.spacing(32)}),operation:(0,un.css)({flexShrink:0,height:"100%",width:ae.spacing(24)}),aggregations:(0,un.css)({flexGrow:1})}),_r={id:Z.F.groupToNestedTable,editor:nr,transformation:z.c.groupToNestedTable,name:z.c.groupToNestedTable.name,description:z.c.groupToNestedTable.description,categories:new Set([E.m.Combine,E.m.CalculateNewFields,E.m.Reformat])};var Rr=e(81010);const Eo=({input:ae,options:te,onChange:ge})=>{const xe=(0,We.ZI)(ae).map(Ut=>({label:Ut,value:Ut})),ze=(0,c.useCallback)(Ut=>{ge({...te,columnField:Ut?.value})},[ge,te]),Ye=(0,c.useCallback)(Ut=>{ge({...te,rowField:Ut?.value})},[ge,te]),at=(0,c.useCallback)(Ut=>{ge({...te,valueField:Ut?.value})},[ge,te]),Et=[{label:"Null",value:Rr.N.Null,description:"Null value"},{label:"True",value:Rr.N.True,description:"Boolean true value"},{label:"False",value:Rr.N.False,description:"Boolean false value"},{label:"Empty",value:Rr.N.Empty,description:"Empty string"}],Pt=(0,c.useCallback)(Ut=>{ge({...te,emptyValue:Ut?.value})},[ge,te]);return c.createElement(c.Fragment,null,c.createElement(me.C,null,c.createElement(ie.I,{label:"Column",labelWidth:8},c.createElement(pe.l6,{options:xe,value:te.columnField,onChange:ze,isClearable:!0})),c.createElement(ie.I,{label:"Row",labelWidth:8},c.createElement(pe.l6,{options:xe,value:te.rowField,onChange:Ye,isClearable:!0})),c.createElement(ie.I,{label:"Cell Value",labelWidth:10},c.createElement(pe.l6,{options:xe,value:te.valueField,onChange:at,isClearable:!0})),c.createElement(ie.I,{label:"Empty Value"},c.createElement(pe.l6,{options:Et,value:te.emptyValue,onChange:Pt,isClearable:!0}))))},co={id:Z.F.groupingToMatrix,editor:Eo,transformation:z.c.groupingToMatrixTransformer,name:z.c.groupingToMatrixTransformer.name,description:"Takes a three fields combination and produces a Matrix.",categories:new Set([E.m.Combine,E.m.Reformat]),help:he(Z.F.groupingToMatrix).helperDocs};var Ur=e(77678);const At=({input:ae,options:te,onChange:ge})=>{const[ze,Ye]=(0,c.useState)({bucketCount:!(0,We.N_)(te.bucketCount||""),bucketSize:!(0,We.N_)(te.bucketSize||""),bucketOffset:!(0,We.N_)(te.bucketOffset||"")}),at=(0,c.useCallback)(Mn=>{ge({...te,bucketCount:Mn})},[ge,te]),Et=(0,c.useCallback)(Mn=>{ge({...te,bucketSize:Mn})},[ge,te]),Pt=(0,c.useCallback)(Mn=>{ge({...te,bucketOffset:Mn})},[ge,te]),Ut=(0,c.useCallback)(Mn=>{Ye({...ze,bucketCount:!(0,We.N_)(Mn)}),ge({...te,bucketCount:Number(Mn)===0?void 0:Number(Mn)})},[ge,te,ze]),qt=(0,c.useCallback)(Mn=>{Ye({...ze,bucketSize:!(0,We.N_)(Mn)}),ge({...te,bucketSize:Mn})},[ge,te,ze,Ye]),Dn=(0,c.useCallback)(Mn=>{Ye({...ze,bucketOffset:!(0,We.N_)(Mn)}),ge({...te,bucketOffset:Mn})},[ge,te,ze,Ye]),xn=(0,c.useCallback)(()=>{ge({...te,combine:!te.combine})},[ge,te]),En=(0,Ie.w)().getVariables().map(Mn=>({value:Mn.name,label:Mn.label||Mn.name,origin:Pe.$0.Template}));if(!Y.$.featureToggles.transformationsVariableSupport){let Mn;typeof te.bucketSize=="string"?Mn=parseInt(te.bucketSize,10):Mn=te.bucketSize;let Ra;return typeof te.bucketOffset=="string"?Ra=parseInt(te.bucketOffset,10):Ra=te.bucketOffset,c.createElement("div",null,c.createElement(me.C,null,c.createElement(ie.I,{labelWidth:18,label:Ur.Rt.bucketCount.name,tooltip:Ur.Rt.bucketCount.description},c.createElement(Xs.Q,{value:te.bucketCount,placeholder:"Default: 30",onChange:at,min:0}))),c.createElement(me.C,null,c.createElement(ie.I,{labelWidth:18,label:Ur.Rt.bucketSize.name,tooltip:Ur.Rt.bucketSize.description},c.createElement(Xs.Q,{value:Mn,placeholder:"auto",onChange:Et,min:0}))),c.createElement(me.C,null,c.createElement(ie.I,{labelWidth:18,label:Ur.Rt.bucketOffset.name,tooltip:Ur.Rt.bucketOffset.description},c.createElement(Xs.Q,{value:Ra,placeholder:"none",onChange:Pt,min:0}))),c.createElement(me.C,null,c.createElement(ie.I,{labelWidth:18,label:Ur.Rt.combine.name,tooltip:Ur.Rt.combine.description},c.createElement(La.K,{value:te.combine??!1,onChange:xn}))))}return c.createElement("div",null,c.createElement(me.C,null,c.createElement(ie.I,{invalid:ze.bucketCount,error:"Value needs to be an integer or a variable",labelWidth:18,label:Ur.Rt.bucketCount.name,tooltip:Ur.Rt.bucketCount.description},c.createElement(Ne.y,{suggestions:En,value:te.bucketCount,placeholder:"Default: 30",onChange:Ut}))),c.createElement(me.C,null,c.createElement(ie.I,{invalid:ze.bucketSize,error:"Value needs to be an integer or a variable",labelWidth:18,label:Ur.Rt.bucketSize.name,tooltip:Ur.Rt.bucketSize.description},c.createElement(Ne.y,{suggestions:En,value:te.bucketSize,placeholder:"auto",onChange:qt}))),c.createElement(me.C,null,c.createElement(ie.I,{labelWidth:18,label:Ur.Rt.bucketOffset.name,tooltip:Ur.Rt.bucketOffset.description,invalid:ze.bucketOffset,error:"Value needs to be an integer or a variable"},c.createElement(Ne.y,{suggestions:En,value:te.bucketOffset,placeholder:"none",onChange:Dn}))),c.createElement(me.C,null,c.createElement(ie.I,{labelWidth:18,label:Ur.Rt.combine.name,tooltip:Ur.Rt.combine.description},c.createElement(La.K,{value:te.combine??!1,onChange:xn}))))},an={id:Z.F.histogram,editor:At,transformation:z.c.histogramTransformer,name:z.c.histogramTransformer.name,description:z.c.histogramTransformer.description,categories:new Set([E.m.CreateNewVisualization]),help:he(Z.F.histogram).helperDocs};var cn=e(41511),On=e(64278);const ha=[{value:cn.W.outer,label:"OUTER (TIME SERIES)",description:"Keep all rows from any table with a value. Join on distinct field values. Performant and best used for time series."},{value:cn.W.outerTabular,label:"OUTER (TABULAR)",description:"Join on a field value with duplicated values. Non performant outer join best used for tabular(SQL like) data."},{value:cn.W.inner,label:"INNER",description:"Combine data from two tables whenever there are matching values in a fields common to both tables."}];function la({input:ae,options:te,onChange:ge}){const xe=(0,On.sE)(ae),ze=(0,On.m3)(xe),Ye=(0,Ie.w)().getVariables().map(Pt=>({value:"$"+Pt.name,label:"$"+Pt.name})),at=(0,c.useCallback)(Pt=>{ge({...te,byField:Pt?.value})},[ge,te]),Et=(0,c.useCallback)(Pt=>{ge({...te,mode:Pt?.value})},[ge,te]);return c.createElement(c.Fragment,null,c.createElement(me.C,null,c.createElement(ie.I,{label:"Mode",labelWidth:8,grow:!0},c.createElement(pe.l6,{options:ha,value:te.mode??cn.W.outer,onChange:Et}))),c.createElement(me.C,null,c.createElement(ie.I,{label:"Field",labelWidth:8,grow:!0},c.createElement(pe.l6,{options:[...ze,...Ye],value:te.byField,onChange:at,placeholder:"time",isClearable:!0}))))}const Ns={id:Z.F.joinByField,aliasIds:[Z.F.seriesToColumns],editor:la,transformation:z.c.joinByFieldTransformer,name:z.c.joinByFieldTransformer.name,description:z.c.joinByFieldTransformer.description,categories:new Set([E.m.Combine]),help:he(Z.F.joinByField).helperDocs};var Ds=e(6829);const Js=[{value:Ds.n.Columns,label:"Columns"},{value:Ds.n.Rows,label:"Rows"}],Rs=({input:ae,options:te,onChange:ge})=>{const{labelNames:ze,selected:Ye}=(0,c.useMemo)(()=>{let Pt=[],Ut={};for(const Dn of ae)for(const xn of Dn.fields)if(xn.labels)for(const Sn of Object.keys(xn.labels))Ut[Sn]||(Pt.push({value:Sn,label:Sn}),Ut[Sn]=!0);const qt=new Set(te.keepLabels?.length?te.keepLabels:Object.keys(Ut));return{labelNames:Pt,selected:qt}},[te.keepLabels,ae]),at=Pt=>{ge({...te,valueLabel:Pt?.value})},Et=Pt=>{if(Ye.has(Pt)?Ye.delete(Pt):Ye.add(Pt),Ye.size===ze.length||!Ye.size){const{keepLabels:Ut,...qt}=te;ge(qt)}else ge({...te,keepLabels:[...Ye]})};return c.createElement("div",null,c.createElement(me.C,null,c.createElement(ie.I,{label:"Mode",labelWidth:20},c.createElement(de.z,{options:Js,value:te.mode??Ds.n.Columns,onChange:Pt=>ge({...te,mode:Pt})}))),c.createElement(me.C,null,c.createElement(ie.I,{label:"Labels",labelWidth:20},c.createElement(zt.B,{gap:1,wrap:"wrap"},ze.map((Pt,Ut)=>{const qt=Pt.label;return c.createElement(Ms.m,{key:`${qt}/${Ut}`,onClick:()=>Et(qt),label:qt,selected:Ye.has(qt)})})))),te.mode!==Ds.n.Rows&&c.createElement(me.C,null,c.createElement(ie.I,{label:"Value field name",labelWidth:20,tooltip:"Replace the value field name with a label",htmlFor:"labels-to-fields-as-name"},c.createElement(pe.l6,{inputId:"labels-to-fields-as-name",isClearable:!0,allowCustomValue:!1,placeholder:"(Optional) Select label",options:ze,value:te?.valueLabel,onChange:at,className:"min-width-16"}))))},Er={id:Z.F.labelsToFields,editor:Rs,transformation:z.c.labelsToFieldsTransformer,name:z.c.labelsToFieldsTransformer.name,description:`Groups series by time and return labels or tags as fields.
                Useful for showing time series with labels in a table where each label key becomes a separate column.`,categories:new Set([E.m.Reformat]),help:he(Z.F.labelsToFields).helperDocs},Vs=({options:ae,onChange:te})=>{const[ge,xe]=(0,c.useState)(!1),ze=(0,c.useCallback)(Pt=>{te({...ae,limitField:Number(Pt.currentTarget.value)})},[te,ae]),Ye=(0,c.useCallback)(Pt=>{xe(!(0,We.N_)(Pt)),te({...ae,limitField:Pt})},[te,ae]),Et=(0,Ie.w)().getVariables().map(Pt=>({value:Pt.name,label:Pt.label||Pt.name,origin:Pe.$0.Template}));return Y.$.featureToggles.transformationsVariableSupport?c.createElement(c.Fragment,null,c.createElement(me.C,null,c.createElement(Ne.y,{invalid:ge,error:"Value needs to be an integer or a variable",value:String(ae.limitField),onChange:Ye,placeholder:"Value or variable",suggestions:Et}))):c.createElement(c.Fragment,null,c.createElement(me.C,null,c.createElement(ie.I,{label:"Limit",labelWidth:8},c.createElement(Oe.p,{placeholder:"Limit count",pattern:"[0-9]*",value:ae.limitField,onChange:ze,width:25}))))},hs={id:Z.F.limit,editor:Vs,transformation:z.c.limitTransformer,name:z.c.limitTransformer.name,description:"Limit the number of items displayed.",categories:new Set([E.m.Filter]),help:he(Z.F.limit).helperDocs},Pr=({input:ae,options:te,onChange:ge})=>ae.length<=1?c.createElement(qr.P,null,"Merge has no effect when applied on a single frame."):null,ro={id:Z.F.merge,editor:Pr,transformation:z.c.mergeTransformer,name:z.c.mergeTransformer.name,description:`Merge many series/tables and return a single table where mergeable values will be combined into the same row.
                Useful for showing multiple series, tables or a combination of both visualized in a table.`,categories:new Set([E.m.Combine]),help:he(Z.F.merge).helperDocs};var yo=e(82280),Kr=e(94753);const io=({options:ae,input:te,onChange:ge})=>{const{indexByName:xe,excludeByName:ze,renameByName:Ye,includeByName:at}=ae,Et=(0,We.ZI)(te),Pt=(0,c.useMemo)(()=>Mo(Et,xe),[Et,xe]),Ut=at&&Object.keys(at).length>0?"include":"exclude",qt=(0,c.useCallback)((En,Mn)=>{ge({...ae,excludeByName:{...ze,[En]:Mn}})},[ge,ae,ze]),Dn=(0,c.useCallback)((En,Mn)=>{const Ra={...ae,includeByName:{...at,[En]:!Mn}};ge(Ra)},[ge,ae,at]),xn=(0,c.useCallback)(En=>{if(!En||!En.destination)return;const Mn=En.source.index,Ra=En.destination.index;Mn!==Ra&&ge({...ae,indexByName:uo(Et,Mn,Ra)})},[ge,ae,Et]),Sn=(0,c.useCallback)((En,Mn)=>{ge({...ae,renameByName:{...ae.renameByName,[En]:Mn}})},[ge,ae]);return te.length>1?c.createElement(qr.P,null,"Organize fields only works with a single frame. Consider applying a join transformation or filtering the input first."):c.createElement(Xr.JY,{onDragEnd:xn},c.createElement(Xr.gL,{droppableId:"sortable-fields-transformer",direction:"vertical"},En=>c.createElement("div",{ref:En.innerRef,...En.droppableProps},Pt.map((Mn,Ra)=>{const yr=at&&Mn in at?at[Mn]:!1,gr=Ut==="include"?yr:!ze[Mn],Sr=Ut==="include"?Dn:qt;return c.createElement(Ro,{fieldName:Mn,renamedFieldName:Ye[Mn],index:Ra,onToggleVisibility:Sr,onRenameField:Sn,visible:gr,key:Mn})}),En.placeholder)))};io.displayName="OrganizeFieldsTransformerEditor";const Ro=({fieldName:ae,renamedFieldName:te,index:ge,visible:xe,onToggleVisibility:ze,onRenameField:Ye})=>{const at=(0,fn.of)(Qr);return c.createElement(Xr.sx,{draggableId:ae,index:ge},Et=>c.createElement(ue.a,{marginBottom:.5,display:"flex",gap:0,ref:Et.innerRef,...Et.draggableProps},c.createElement(ot.c,{width:60,as:"div"},c.createElement(zt.B,{gap:0,justifyContent:"flex-start",alignItems:"center",width:"100%"},c.createElement("span",{...Et.dragHandleProps},c.createElement(mo.I,{name:"draggabledots",title:"Drag and drop to reorder",size:"lg",className:at.draggable})),c.createElement(Po.K,{className:at.toggle,size:"md",name:xe?"eye":"eye-slash",onClick:()=>ze(ae,xe),tooltip:xe?"Disable":"Enable"}),c.createElement(Kr.E,{truncate:!0,element:"p",variant:"bodySmall",weight:"bold"},ae))),c.createElement(Oe.p,{defaultValue:te||"",placeholder:`Rename ${ae}`,onBlur:Pt=>Ye(ae,Pt.currentTarget.value)})))};Ro.displayName="DraggableFieldName";const Qr=ae=>({toggle:(0,un.css)({margin:ae.spacing(0,1),color:ae.colors.text.secondary}),draggable:(0,un.css)({opacity:.4,"&:hover":{color:ae.colors.text.maxContrast}})}),uo=(ae,te,ge)=>{const xe=Array.from(ae),[ze]=xe.splice(te,1);return xe.splice(ge,0,ze),xe.reduce((Ye,at,Et)=>(Ye[at]=Et,Ye),{})},Mo=(ae,te={})=>{if(!te||Object.keys(te).length===0)return ae;const ge=(0,yo.X)(te);return ae.sort(ge)},Jo={id:Z.F.organize,editor:io,transformation:z.c.organizeFieldsTransformer,name:z.c.organizeFieldsTransformer.name,description:"Allows the user to re-order, hide, or rename fields / columns. Useful when data source doesn't allow overrides for visualizing data.",categories:new Set([E.m.ReorderAndRename]),help:he(Z.F.organize).helperDocs};var Lo=e(21128),$r=e(13544);const Ei=({options:ae,onChange:te})=>{const ge=[{label:"Series to rows",value:Lo.rV.SeriesToRows,description:"Create a table with one row for each series value"},{label:"Reduce fields",value:Lo.rV.ReduceFields,description:"Collapse each field into a single value"}],xe=(0,c.useCallback)(at=>{const Et=at.value;te({...ae,mode:Et,includeTimeField:Et===Lo.rV.ReduceFields?!!ae.includeTimeField:!1})},[te,ae]),ze=(0,c.useCallback)(()=>{te({...ae,includeTimeField:!ae.includeTimeField})},[te,ae]),Ye=(0,c.useCallback)(()=>{te({...ae,labelsToFields:!ae.labelsToFields})},[te,ae]);return c.createElement(c.Fragment,null,c.createElement(ie.I,{label:"Mode","data-testid":$r.Tp.components.Transforms.Reduce.modeLabel,grow:!0,labelWidth:16},c.createElement(pe.l6,{options:ge,value:ge.find(at=>at.value===ae.mode)||ge[0],onChange:xe})),c.createElement(ie.I,{label:"Calculations","data-testid":$r.Tp.components.Transforms.Reduce.calculationsLabel,grow:!0,labelWidth:16},c.createElement(Yt.S,{placeholder:"Choose Stat",allowMultiple:!0,stats:ae.reducers||[],onChange:at=>{te({...ae,reducers:at})}})),ae.mode===Lo.rV.ReduceFields&&c.createElement(ie.I,{htmlFor:"include-time-field",labelWidth:16,label:"Include time"},c.createElement(La.K,{id:"include-time-field",value:!!ae.includeTimeField,onChange:ze})),ae.mode!==Lo.rV.ReduceFields&&c.createElement(ie.I,{htmlFor:"labels-to-fields",labelWidth:16,label:"Labels to fields"},c.createElement(La.K,{id:"labels-to-fields",value:!!ae.labelsToFields,onChange:Ye})))},Ki={id:Z.F.reduce,editor:Ei,transformation:z.c.reduceTransformer,name:z.c.reduceTransformer.name,description:z.c.reduceTransformer.description,categories:new Set([E.m.CalculateNewFields]),help:he(Z.F.reduce).helperDocs};class dt extends c.PureComponent{constructor(te){super(te),this.handleRegexChange=ge=>{const xe=ge.currentTarget.value;let ze=!0;if(xe)try{xe&&(0,So.dO)(xe)}catch{ze=!1}this.setState(Ye=>({...Ye,regex:xe,isRegexValid:ze}))},this.handleRenameChange=ge=>{const xe=ge.currentTarget.value;this.setState(ze=>({...ze,renamePattern:xe}))},this.handleRegexBlur=ge=>{const xe=ge.currentTarget.value;let ze=!0;try{xe&&(0,So.dO)(xe)}catch{ze=!1}this.setState({isRegexValid:ze},()=>{ze&&this.props.onChange({...this.props.options,regex:xe})})},this.handleRenameBlur=ge=>{const xe=ge.currentTarget.value;this.setState({renamePattern:xe},()=>this.props.onChange({...this.props.options,renamePattern:xe}))},this.state={regex:te.options.regex,renamePattern:te.options.renamePattern,isRegexValid:!0}}render(){const{regex:te,renamePattern:ge,isRegexValid:xe}=this.state;return c.createElement(c.Fragment,null,c.createElement(ie.I,{label:"Match",labelWidth:16,invalid:!xe,error:xe?void 0:"Invalid pattern"},c.createElement(Oe.p,{placeholder:"Regular expression pattern",value:te||"",onChange:this.handleRegexChange,onBlur:this.handleRegexBlur,width:25})),c.createElement(ie.I,{label:"Replace",labelWidth:16},c.createElement(Oe.p,{placeholder:"Replacement pattern",value:ge||"",onChange:this.handleRenameChange,onBlur:this.handleRenameBlur,width:25})))}}const Pn={id:Z.F.renameByRegex,editor:dt,transformation:z.c.renameByRegexTransformer,name:z.c.renameByRegexTransformer.name,description:"Renames part of the query result by using regular expression with placeholders.",categories:new Set([E.m.ReorderAndRename]),help:he(Z.F.renameByRegex).helperDocs},gn=({input:ae,options:te,onChange:ge})=>null,Jn={id:Z.F.seriesToRows,editor:gn,transformation:z.c.seriesToRowsTransformer,name:z.c.seriesToRowsTransformer.name,description:`Merge many series and return a single series with time, metric and value as columns.
                Useful for showing multiple time series visualized in a table.`,categories:new Set([E.m.Combine,E.m.Reformat]),help:he(Z.F.seriesToRows).helperDocs},Zn=({input:ae,options:te,onChange:ge})=>{const xe=(0,We.ZI)(ae).map(Pt=>({label:Pt,value:Pt})),Ye=(0,Ie.w)().getVariables().map(Pt=>({label:"$"+Pt.name,value:"$"+Pt.name})),at=(0,c.useCallback)((Pt,Ut)=>{ge({...te,sort:[Ut]})},[ge,te]),Et=te.sort?.length?te.sort:[{}];return c.createElement("div",null,Et.map((Pt,Ut)=>c.createElement(me.C,{key:`${Pt.field}/${Ut}`},c.createElement(ie.I,{label:"Field",labelWidth:10,grow:!0},c.createElement(pe.l6,{options:Y.$.featureToggles.transformationsVariableSupport?[...xe,...Ye]:xe,value:Pt.field,placeholder:"Select field",onChange:qt=>{at(Ut,{...Pt,field:qt.value})}})),c.createElement(ie.I,{label:"Reverse"},c.createElement(La.K,{value:!!Pt.desc,onChange:()=>{at(Ut,{...Pt,desc:!Pt.desc})}})))))},_n={id:Z.F.sortBy,editor:Zn,transformation:z.c.sortByTransformer,name:z.c.sortByTransformer.name,description:z.c.sortByTransformer.description,categories:new Set([E.m.ReorderAndRename]),help:he(Z.F.sortBy).helperDocs};function Pa({options:ae,onChange:te}){const[ge,xe]=(0,c.useState)(ae),ze=Ca(),Ye=za(),at=()=>{ge.push({path:""}),xe([...ge]),Ut()},Et=qt=>{ge&&(ge.splice(qt,1),xe([...ge]),Ut())},Pt=(qt,Dn,xn)=>{ge&&(xn==="alias"?ge[Dn].alias=qt.currentTarget.value??"":ge[Dn].path=qt.currentTarget.value??"",xe([...ge]))},Ut=()=>{te(ge)};return c.createElement("ol",{className:(0,un.cx)(Ye.list)},ge&&ge.map((qt,Dn)=>c.createElement("li",{key:Dn},c.createElement(me.C,null,c.createElement(ie.I,{label:"Field",tooltip:ze.field,grow:!0},c.createElement(Oe.p,{onBlur:Ut,onChange:xn=>Pt(xn,Dn,"path"),value:qt.path,placeholder:'A valid json path, e.g. "object.value1" or "object.value2[0]"'})),c.createElement(ie.I,{label:"Alias",tooltip:ze.alias},c.createElement(Oe.p,{width:12,value:qt.alias,onBlur:Ut,onChange:xn=>Pt(xn,Dn,"alias")})),c.createElement(ie.I,{className:(0,un.cx)(Ye.removeIcon)},c.createElement(Po.K,{onClick:()=>Et(Dn),name:"trash-alt",tooltip:"Remove path"}))))),c.createElement(ie.I,null,c.createElement(fe.$n,{icon:"plus",onClick:()=>at(),variant:"secondary"},"Add path")))}const Ca=()=>{const ae=[{path:"object",description:"=> extract fields from object"},{path:"object.value1",description:"=> extract value1"},{path:"object.value2",description:"=> extract value2"},{path:"object.value2[0]",description:"=> extract value2 first element"},{path:"object.value2[1]",description:"=> extract value2 second element"}];return{field:c.createElement("div",null,"A valid path of an json object.",c.createElement("div",null,c.createElement("strong",null,"JSON Value:")),c.createElement("pre",null,c.createElement("code",null,["{",'  "object": {','    "value1": "hello world"','    "value2": [1, 2, 3, 4]',"  }","}"].join(`
`))),c.createElement("strong",null,"Valid Paths:"),ae.map((te,ge)=>c.createElement("p",{key:ge},c.createElement("code",null,te.path),c.createElement("i",null,te.description)))),alias:"An alias name for the variable in the dashboard. If left blank the given path will be used."}};function za(){return{list:(0,un.css)`
      margin-left: 20px;
    `,removeIcon:(0,un.css)`
      margin: 0 0 0 4px;
      align-items: center;
    `}}var xs=e(14236),ms=(ae=>(ae.JSON="json",ae.KeyValues="kvp",ae.Auto="auto",ae))(ms||{});const ls={id:ms.JSON,name:"JSON",description:"Parse JSON string",parse:ae=>JSON.parse(ae)};function Ws(ae){const te=[];let ge="",xe="";const ze={};for(let Ye=0;Ye<ae.length;Ye++){let at=ae[Ye];at===ge&&(ge="",at=ae[++Ye]);const Et=at==="\\";if(Et&&(at=ae[++Ye]),Et||ge.length){te.push(at);continue}switch((at==='"'||at==="'")&&(ge=at),at){case":":case"=":te.length&&(xe&&(ze[xe]=""),xe=te.join(""),te.length=0);break;case'"':case"'":case" ":case`
`:case"	":case"\r":case`
`:te.length&&xe===""&&(ze[te.join("")]="",te.length=0);case",":case";":case"&":case"{":case"}":if(te.length){const Pt=te.join("");xe.length?(ze[xe]=Pt,xe=""):xe=Pt,te.length=0}break;default:te.push(at),Ye===ae.length-1&&xe===""&&te.length&&(ze[te.join("")]="",te.length=0)}}return xe.length&&(ze[xe]=te.join("")),ze}const is={id:ms.KeyValues,name:"Key+value pairs",description:"Look for a=b, c: d values in the line",parse:Ws},fs=[ls,is],ys={id:ms.Auto,name:"Auto",description:"parse new fields automatically",parse:ae=>{for(const te of fs)try{const ge=te.parse(ae);if(ge!=null)return ge}catch{}}},Ps=new ye.O(()=>[...fs,ys]),Lr={id:Z.F.extractFields,name:"Extract fields",description:"Parse fields from the contends of another",defaultOptions:{},operator:(ae,te)=>ge=>ge.pipe((0,Ht.T)(xe=>Lr.transformer(ae,te)(xe))),transformer:ae=>te=>te.map(ge=>Gr(ge,ae))};function Gr(ae,te){if(!te.source)return ae;const ge=(0,Do.findField)(ae,te.source);if(!ge)return ae;const xe=Ps.getIfExists(te.format??ms.Auto);if(!xe)throw new Error("unkonwn extractor");const ze=ae.length,Ye=[],at=new Map;for(let Pt=0;Pt<ze;Pt++){let Ut=ge.values[Pt];if((0,g.isString)(Ut))try{Ut=xe.parse(Ut)}catch{Ut={}}if(Ut!=null){if(te.format===ms.JSON&&te.jsonPaths&&te.jsonPaths?.length>0){const qt={},Dn=te.jsonPaths.filter(xn=>xn.path);Dn.length>0&&(Dn.forEach(xn=>{const Sn=xn.alias&&xn.alias.length>0?xn.alias:xn.path;qt[Sn]=(0,g.get)(Ut,xn.path)??"Not Found"}),Ut=qt)}for(const[qt,Dn]of Object.entries(Ut)){let xn=at.get(qt);xn==null&&(xn=new Array(ze).fill(void 0),at.set(qt,xn),Ye.push(qt)),xn[Pt]=Dn}}}const Et=Ye.map(Pt=>{const Ut=at.get(Pt),qt={name:Pt,values:Ut,type:Ut?(0,xs.oE)(Ut.find(Dn=>Dn!=null)):oe.PU.other,config:{}};return Y.$.featureToggles.extractFieldsNameDeduplication&&(qt.name=(0,ee.fk)(qt,ae)),qt});if(te.keepTime){const Pt=(0,Do.findField)(ae,"Time")||(0,Do.findField)(ae,"time");Pt&&Et.unshift(Pt)}return te.replace||Et.unshift(...ae.fields),{...ae,fields:Et}}const ei={settings:{width:30,placeholderText:"Select field"},name:"",id:"",editor:()=>null},Ji=({input:ae,options:te,onChange:ge})=>{const xe=Ut=>{ge({...te,source:Ut})},ze=Ut=>{ge({...te,format:Ut?.value})},Ye=Ut=>{ge({...te,jsonPaths:Ut})},at=()=>{te.replace&&(te.keepTime=!1),ge({...te,replace:!te.replace})},Et=()=>{ge({...te,keepTime:!te.keepTime})},Pt=Ps.selectOptions(te.format?[te.format]:void 0);return c.createElement("div",null,c.createElement(me.C,null,c.createElement(ie.I,{label:"Source",labelWidth:16},c.createElement(vo.O,{context:{data:ae},value:te.source??"",onChange:xe,item:ei}))),c.createElement(me.C,null,c.createElement(ie.I,{label:"Format",labelWidth:16},c.createElement(pe.l6,{value:Pt.current[0],options:Pt.options,onChange:ze,width:24,placeholder:"Auto"}))),te.format==="json"&&c.createElement(Pa,{options:te.jsonPaths??[],onChange:Ye}),c.createElement(me.C,null,c.createElement(ie.I,{label:"Replace all fields",labelWidth:16},c.createElement(La.K,{value:te.replace??!1,onChange:at}))),te.replace&&c.createElement(me.C,null,c.createElement(ie.I,{label:"Keep time",labelWidth:16},c.createElement(La.K,{value:te.keepTime??!1,onChange:Et}))))},ti={id:Z.F.extractFields,editor:Ji,transformation:Lr,name:Lr.name,description:"Parse fields from content (JSON, labels, etc).",categories:new Set([E.m.Reformat]),help:he(Z.F.extractFields).helperDocs};var di=e(51986);const $i={id:Z.F.joinByLabels,name:"Join by labels",description:"Flatten labeled results into a table joined by labels.",defaultOptions:{},operator:(ae,te)=>ge=>ge.pipe((0,Ht.T)(xe=>$i.transformer(ae,te)(xe))),transformer:ae=>te=>!te||!te.length?te:[Oi(ae,te)]};function Oi(ae,te){if(!ae.value?.length)return xo("No value labele configured");const ge=(0,We.aG)(te);if(ge.size<1)return xo("No labels in result");if(!ge.has(ae.value))return xo("Value label not found");let xe=ae.join?.length?ae.join:Array.from(ge);xe=xe.filter(Dn=>Dn!==ae.value);const ze=new Set,Ye=new Map,at={};for(const Dn of te)for(const xn of Dn.fields)if(xn.labels&&xn.type!==oe.PU.time){const Sn=xe.map(Sr=>xn.labels[Sr]),En=Sn.join(",");let Mn=Ye.get(En);Mn||(Mn={keys:Sn,values:{}},Ye.set(En,Mn));const Ra=xn.labels[ae.value],yr=xn.values,gr=Mn.values[Ra];gr?Mn.values[Ra]=gr.concat(yr):Mn.values[Ra]=yr,at[Ra]||(at[Ra]=xn),ze.add(Ra)}const Et=Array.from(ze),Pt=xe.map(()=>[]),Ut=Et.map(()=>[]);for(const Dn of Ye.values()){let xn=-1,Sn=!1;for(;!Sn;){xn++,Sn=!0;for(let En=0;En<xe.length;En++)Pt[En].push(Dn.keys[En]);for(let En=0;En<Et.length;En++){const Mn=Et[En],Ra=Dn.values[Mn]??[];Ut[En].push(Ra[xn]),Ra.length>xn+1&&(Sn=!1)}}}const qt={fields:[],length:Ut[0].length};for(let Dn=0;Dn<xe.length;Dn++)qt.fields.push({name:xe[Dn],config:{},type:oe.PU.string,values:Pt[Dn]});for(let Dn=0;Dn<Et.length;Dn++){const xn=at[Et[Dn]];qt.fields.push({name:Et[Dn],config:{},type:xn.type??oe.PU.number,values:Ut[Dn]})}return qt}function xo(ae){return{meta:{notices:[{severity:"error",text:ae}]},fields:[{name:"Error",type:oe.PU.string,config:{},values:[ae]}],length:0}}function Vi({input:ae,options:te,onChange:ge}){const xe=(0,c.useMemo)(()=>{let Pt;const Ut=(0,We.aG)(ae),qt=Array.from(Ut).map(Ra=>({label:Ra,value:Ra}));let Dn=qt.find(Ra=>Ra.value===te.value);!Dn&&te.value&&(Dn={label:`${te.value} (not found)`,value:te.value},qt.push(Dn)),ae.length?Ut.size===0&&(Pt=c.createElement(rn.F,{title:"No labels found"},"The input does not contain any labels")):Pt=c.createElement(rn.F,{title:"No input found"},"No input (or labels) found"),Ut.delete(te.value);const xn=Array.from(Ut).map(Ra=>({label:Ra,value:Ra}));let Sn=xn;const En=!!te.join?.length;let Mn="Join";return En?Sn=xn.filter(Ra=>!te.join.includes(Ra.value)):Mn=xn.map(Ra=>Ra.value).join(", "),{warn:Pt,valueOptions:qt,valueOption:Dn,joinOptions:xn,addOptions:Sn,addText:Mn,hasJoin:En,key:Date.now()}},[te,ae]),ze=(Pt,Ut)=>{if(!te.join)return;const qt=te.join.slice();if(Ut)qt[Pt]=Ut;else if(qt.splice(Pt,1),!qt.length){ge({...te,join:void 0});return}const Dn=new Set(qt);te.value&&Dn.delete(te.value),ge({...te,join:Array.from(Dn)})},Ye=Pt=>{const Ut=Pt?.value;if(!Ut)return;const qt=te.join?te.join.slice():[];qt.push(Ut),ge({...te,join:qt})},at=10,Et="No labels found";return c.createElement("div",null,xe.warn,c.createElement(me.C,null,c.createElement(ie.I,{error:"required",invalid:!te.value?.length,label:"Value",labelWidth:at,tooltip:"Select the label indicating the values name"},c.createElement(pe.l6,{options:xe.valueOptions,value:xe.valueOption,onChange:Pt=>ge({...te,value:Pt.value}),noOptionsMessage:Et}))),xe.hasJoin?te.join.map((Pt,Ut)=>c.createElement(me.C,{key:Pt+Ut},c.createElement(ie.I,{label:"Join",labelWidth:at,error:"Unable to join by the value label",invalid:Pt===te.value},c.createElement(ks.Gy,null,c.createElement(pe.l6,{options:xe.joinOptions,value:xe.joinOptions.find(qt=>qt.value===Pt),isClearable:!0,onChange:qt=>ze(Ut,qt?.value),noOptionsMessage:Et}),!!(xe.addOptions.length&&Ut===te.join.length-1)&&c.createElement(di.i,{icon:"plus",label:"",options:xe.addOptions,onChange:Ye,variant:"secondary"}))))):c.createElement(c.Fragment,null,!!xe.addOptions.length&&c.createElement(me.C,null,c.createElement(ie.I,{label:"Join",labelWidth:at},c.createElement(pe.l6,{options:xe.addOptions,placeholder:xe.addText,onChange:Ye,noOptionsMessage:Et})))))}const Zo={id:$i.id,editor:Vi,transformation:$i,name:$i.name,description:$i.description,state:gt.pn.beta,categories:new Set([E.m.Combine]),help:he($i.id).helperDocs};var yi=e(84350),Ii=e(69862),bi=e(65474),$l=e(67140);const Vl={id:Z.F.fieldLookup,name:"Lookup fields from resource",description:"Retrieve matching data based on specified field",defaultOptions:{},operator:ae=>te=>te.pipe((0,Ii.Z)(ge=>(0,bi.H)(Ai(ge,ae))))};async function Ai(ae,te){const ge=se.sJ.get(ne.Ct.byName).get(te?.lookupField),xe=await(0,$l.q3)(te?.gazetteer??$l.fx);return xe.frame?Ri(ae,xe,ge):Promise.reject("missing frame in gazetteer")}function Ri(ae,te,ge){const xe=te.frame()?.fields;return xe?ae.map(ze=>{const Ye=ze.length,at=[];for(const Et of ze.fields)if(at.push(Et),ge(Et,ze,ae)){const Pt=Et.values,Ut=[];for(const qt of xe){const Dn=new Array(Ye);Ut.push(Dn),at.push({...qt,values:Dn})}for(let qt=0;qt<te.count;qt++){const Dn=te.find(Pt[qt]);if(Dn?.index!=null)for(let xn=0;xn<xe.length;xn++)Ut[xn][qt]=xe[xn].values[Dn.index]}}return{...ze,fields:at}}):ae}const zl={settings:{width:30,filter:ae=>ae.type===oe.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null},ul={settings:{}},Di=({input:ae,options:te,onChange:ge})=>{const xe=(0,c.useCallback)(Ye=>{ge({...te,lookupField:Ye})},[ge,te]),ze=(0,c.useCallback)(Ye=>{ge({...te,gazetteer:Ye})},[ge,te]);return c.createElement("div",null,c.createElement(me.C,null,c.createElement(ie.I,{label:"Field",labelWidth:12},c.createElement(vo.O,{context:{data:ae},value:te?.lookupField??"",onChange:xe,item:zl}))),c.createElement(me.C,null,c.createElement(ie.I,{label:"Lookup",labelWidth:12},c.createElement(yi.G,{value:te?.gazetteer??"",context:{data:ae},item:ul,onChange:ze}))))},Os={id:Z.F.fieldLookup,editor:Di,transformation:Vl,name:Vl.name,description:"Use a field value to lookup additional fields from an external source. This currently supports spatial data, but will eventually support more formats.",state:gt.pn.alpha,categories:new Set([E.m.PerformSpatialOperations]),help:he(Z.F.fieldLookup).helperDocs};var _e=e(35602),et=e(64586);const st=(ae,te,ge=[])=>(te===0?ge.push(ae):ae.forEach(xe=>{st(xe,te-1,ge)}),ge);function pt(ae){const te=ae[0].length,ge=ae.length,xe=new Map;for(let ze=0;ze<te;ze++){let Ye=xe;for(let at=0;at<ge;at++){let Et=ae[at][ze],Pt=Ye.get(Et);Pt==null&&(Pt=at===ge-1?[]:new Map,Ye.set(Et,Pt)),Ye=Pt}Ye.push(ze)}return st(xe,ge)}const Wt={asLabels:!0,append:!1,withNames:!1,separator1:"=",separator2:" "};function Xt(ae,te,ge){return te.map((xe,ze)=>ae.withNames?`${xe}${ae.separator1}${ge[ze]}`:ge[ze]).join(ae.separator2)}function dn(ae,te){const ge={};return ae.forEach((xe,ze)=>{ge[xe]=String(te[ze])}),ge}const In={id:Z.F.partitionByValues,name:"Partition by values",description:"Splits a one-frame dataset into multiple series discriminated by unique/enum values in one or more fields.",defaultOptions:{keepFields:!1},operator:(ae,te)=>ge=>ge.pipe((0,Ht.T)(xe=>In.transformer(ae,te)(xe))),transformer:(ae,te)=>{const ge=(0,_e.R)(te,{names:ae.fields});if(!ge)return et.W.transformer({},te);const xe=(0,se.NS)(ge);return ze=>ze.length?Hn(ze[0],xe,ae):ze}};function Hn(ae,te,ge){const xe=ae.fields.filter(Et=>te(Et,ae,[ae]));if(!xe.length)return[ae];const ze=xe.map(Et=>Et.values),Ye=xe.map(Et=>Et.name),at={...Wt,...ge?.naming};return pt(ze).map(Et=>{let Pt=ae.name,Ut={};if(at.asLabels)Ut=dn(Ye,xe.map((Dn,xn)=>ze[xn][Et[0]]));else{let Dn=Xt(at,Ye,xe.map((xn,Sn)=>ze[Sn][Et[0]]));at?.append&&ae.name&&(Dn=`${ae.name} ${Dn}`),Pt=Dn}let qt=ae.fields;if(!ge?.keepFields){const Dn=new Set(Ye);qt=ae.fields.filter(xn=>!Dn.has(xn.name))}return{name:Pt,meta:ae.meta,length:Et.length,fields:qt.map(Dn=>{const xn=Dn.values,Sn=Array(Et.length);for(let En=0;En<Et.length;En++)Sn[En]=xn[Et[En]];return{name:Dn.name,type:Dn.type,config:Dn.config,labels:{...Dn.labels,...Ut},values:Sn}})}})}function ra({input:ae,options:te,onChange:ge}){const xe=(0,On.sE)(ae),ze=(0,On.m3)(xe),Ye=(0,c.useMemo)(()=>{const xn=new Set(te.fields);return xn.size<1?ze:ze.filter(Sn=>!xn.has(Sn.value))},[ze,te]),at=(0,c.useCallback)(xn=>{if(!xn.value)return;const Sn=new Set(te.fields);Sn.add(xn.value),ge({...te,fields:[...Sn]})},[ge,te]);let Et;(xn=>{xn[xn.asLabels=0]="asLabels",xn[xn.frameName=1]="frameName"})(Et||(Et={}));const Pt=[{label:"As label",value:0},{label:"As frame name",value:1}],Ut=[{label:"Yes",value:!0},{label:"No",value:!1}],qt=(0,c.useCallback)(xn=>{if(!xn)return;const Sn=new Set(te.fields);Sn.delete(xn),ge({...te,fields:[...Sn]})},[ge,te]);if(ae.length>1)return c.createElement(qr.P,null,"Partition by values only works with a single frame.");const Dn=[...new Set(te.fields)];return c.createElement("div",null,c.createElement(me.C,null,c.createElement(ie.I,{label:"Field",labelWidth:10,grow:!0},c.createElement(ks.Gy,null,Dn.map(xn=>c.createElement(fe.$n,{key:xn,icon:"times",variant:"secondary",size:"md",onClick:()=>qt(xn)},xn)),Ye.length&&c.createElement(di.i,{variant:"secondary",size:"md",options:Ye,onChange:at,label:"Select field",icon:"plus"})))),c.createElement(me.C,null,c.createElement(ie.I,{tooltip:"Sets how the names of the selected fields are displayed. As frame name is usually better for tabular data",label:"Naming",labelWidth:10},c.createElement(de.z,{options:Pt,value:te.naming?.asLabels===void 0||te.naming.asLabels?0:1,onChange:xn=>ge({...te,naming:{...te.naming,asLabels:xn===0}})}))),c.createElement(me.C,null,c.createElement(ie.I,{tooltip:"Keeps the partition fields in the frames.",label:"Keep fields",labelWidth:16},c.createElement(de.z,{options:Ut,value:te.keepFields,onChange:xn=>ge({...te,keepFields:xn})}))))}const Ba={id:Z.F.partitionByValues,editor:ra,transformation:In,name:In.name,description:In.description,state:gt.pn.alpha,categories:new Set([E.m.Reformat]),help:he(Z.F.partitionByValues).helperDocs};var wa=e(41260),Ua=e(37471),Za=e(73060),cs=(ae=>(ae.TimeSeriesWide="wide",ae.TimeSeriesLong="long",ae.TimeSeriesMulti="multi",ae.TimeSeriesMany="many",ae))(cs||{});function Ya(ae){if(!Array.isArray(ae)||ae.length===0)return ae;const te=[];for(const ge of Ks(ae)){const xe=ge.fields[0];if(!xe||xe.type!==oe.PU.time)continue;const ze=[],Ye=[];for(const at of ge.fields)switch(at.type){case oe.PU.number:case oe.PU.boolean:ze.push(at);break;case oe.PU.string:Ye.push(at);break}for(const at of ze)if(Ye.length){const Et=new Map;for(let Pt=0;Pt<ge.length;Pt++){const Ut=xe.values[Pt],qt=at.values[Pt];if(qt===void 0||Ut==null)continue;const Dn=Ye.map(Sn=>Sn.values[Pt]).join("/");let xn=Et.get(Dn);if(!xn){xn={key:Dn,time:[],value:[],labels:{}};for(const Sn of Ye)xn.labels[Sn.name]=Sn.values[Pt];Et.set(Dn,xn)}xn.time.push(Ut),xn.value.push(qt)}for(const Pt of Et.values())te.push({name:ge.name,refId:ge.refId,meta:{...ge.meta,type:wa.m.TimeSeriesMulti},fields:[{...xe,values:Pt.time},{...at,values:Pt.value,labels:Pt.labels}],length:Pt.time.length})}else te.push({name:ge.name,refId:ge.refId,meta:{...ge.meta,type:wa.m.TimeSeriesMulti},fields:[xe,at],length:ge.length})}return te}function Ks(ae){if(!Array.isArray(ae)||ae.length===0)return ae;const te=[];for(const ge of ae){let xe;const ze=[],Ye={},at={},Et={},Pt={};for(let En=0;En<ge.fields.length;En++){const Mn=ge.fields[En];switch(Mn.type){case oe.PU.string:case oe.PU.boolean:Mn.name in Pt||(Pt[Mn.name]=En,at[Mn.name]=!0);break;case oe.PU.time:if(!xe){xe=Mn;break}default:if(Mn.name in Ye){const gr=Ye[Mn.name];if(Mn.type!==gr)continue}else Ye[Mn.name]=Mn.type,ze.push(Mn.name);const Ra=JSON.stringify(Mn.labels),yr=Et[Ra];if(yr!==void 0?yr.push(En):Et[Ra]=[En],Mn.labels!=null)for(const gr in Mn.labels)at[gr]=!0}}if(!xe)continue;const Ut=[],qt=[],Dn=[],xn=[];for(let En=0;En<ge.length;En++)Ut.push({time:xe.values[En],wideRowIndex:En});for(const En in Et)qt.push(En);for(const En in at)Dn.push(En);for(const En in Pt)xn.push(En);Ut.sort((En,Mn)=>En.time-Mn.time),qt.sort(),Dn.sort(),ze.sort();const Sn=new Ua.k({...ge,meta:{...ge.meta,type:wa.m.TimeSeriesLong},fields:[{name:xe.name,type:xe.type}]});for(const En of ze)Sn.addField({name:En,type:Ye[En]});for(const En of Dn)Sn.addField({name:En,type:oe.PU.string});for(const En of Ut){const{time:Mn,wideRowIndex:Ra}=En;for(const yr of qt){const gr={};for(const or of xn)gr[or]=ge.fields[Pt[or]].values[Ra];let Sr=0;for(const or of Et[yr]){const ll=ge.fields[or];if(Sr++===0&&ll.labels!=null)for(const hc in ll.labels)gr[hc]=ll.labels[hc];gr[ll.name]=ll.values[Ra]}gr[xe.name]=Mn,Sn.add(gr)}}te.push(Sn)}return te}function Ge(ae){return Hn(ae,ge=>ge.type===oe.PU.string).map(ge=>(ge.meta||(ge.meta={}),ge.meta.type=wa.m.TimeSeriesMulti,ge))}const Re={id:Z.F.prepareTimeSeries,name:"Prepare time series",description:"Will stretch data frames from the wide format into the long format. This is really helpful to be able to keep backwards compatibility for panels not supporting the new wide format.",defaultOptions:{},operator:(ae,te)=>ge=>ge.pipe((0,Ht.T)(xe=>Re.transformer(ae,te)(xe))),transformer:ae=>{const te=ae?.format??"wide";if(te==="many"||te==="multi")return Ya;if(te==="long")return Ks;const ge=se.sJ.get(ne.Ct.firstTimeField).get({});return xe=>{if(!xe.length)return[];const ze=[];for(const at of xe)at.meta?.type===wa.m.TimeSeriesLong?Ge(at).forEach(Et=>ze.push(Et)):ze.push(at);const Ye=(0,Za.Fd)({frames:ze,joinBy:ge,keepOriginIndices:!0});return Ye?(Ye.meta||(Ye.meta={}),Ye.meta.type=wa.m.TimeSeriesWide,[Ye]):[]}}},qe={label:"Wide time series",value:cs.TimeSeriesWide,description:"Creates a single frame joined by time",info:c.createElement("ul",null,c.createElement("li",null,"Single frame"),c.createElement("li",null,"1st field is shared time field"),c.createElement("li",null,"Time in ascending order"),c.createElement("li",null,"Multiple value fields of any type"))},ut={label:"Multi-frame time series",value:cs.TimeSeriesMulti,description:"Creates a new frame for each time/number pair",info:c.createElement("ul",null,c.createElement("li",null,"Multiple frames"),c.createElement("li",null,"Each frame has two fields: time, value"),c.createElement("li",null,"Time in ascending order"),c.createElement("li",null,"String values are represented as labels"),c.createElement("li",null,"All values are numeric"))},Ft={label:"Long time series",value:cs.TimeSeriesLong,description:"Convert each frame to long format",info:c.createElement("ul",null,c.createElement("li",null,"Single frame"),c.createElement("li",null,"1st field is time field"),c.createElement("li",null,"Time in ascending order, but may have duplictes"),c.createElement("li",null,"String values are represented as separate fields rather than as labels"),c.createElement("li",null,"Multiple value fields may exist"))},on=[qe,ut,Ft];function sn(ae){const{options:te,onChange:ge}=ae,xe=(0,fn.of)(Ln),ze=(0,c.useCallback)(Ye=>{ge({...te,format:Ye.value})},[ge,te]);return c.createElement(c.Fragment,null,c.createElement(me.C,null,c.createElement(ie.I,{label:"Format",labelWidth:12},c.createElement(pe.l6,{width:35,options:on,value:on.find(Ye=>Ye.value===cs.TimeSeriesMulti&&te.format===cs.TimeSeriesMany?!0:Ye.value===te.format)||on[0],onChange:ze,className:"flex-grow-1"}))),c.createElement(me.C,null,c.createElement(ie.I,{label:"Info",labelWidth:12},c.createElement("div",{className:xe.info},(on.find(Ye=>Ye.value===te.format)||on[0]).info))))}const Ln=ae=>({info:(0,un.css)`
    margin-left: 20px;
  `}),qn={id:Re.id,editor:sn,transformation:Re,name:Re.name,description:Re.description,categories:new Set([E.m.Reformat]),help:he(Re.id).helperDocs};var na=e(66648),Sa=e(48817),ka=(ae=>(ae.linear="linear",ae.polynomial="polynomial",ae))(ka||{});const Da={predictionCount:100,modelType:"linear",degree:2},ds={id:Z.F.regression,name:"Regression analysis",operator:(ae,te)=>ge=>ge.pipe((0,Ht.T)(xe=>ds.transformer(ae,te)(xe))),transformer:(ae,te)=>ge=>{const{predictionCount:xe,modelType:ze,degree:Ye}={...Da,...ae};if(ge.length===0)return ge;const at=se.sJ.get(ne.Ct.byName).get(ae.yFieldName),Et=se.sJ.get(ne.Ct.byName).get(ae.xFieldName);let Pt,Ut,qt;for(const or of ge){const ll=or.fields.find(hc=>at(hc,or,ge));if(ll){Ut=ll;const hc=or.fields.find(rh=>Et(rh,or,ge));if(hc){Pt=hc,qt=or;break}else throw"X and Y fields must be part of the same frame"}}if(!Pt||!Ut)return ge;let Dn=Pt.values[0],xn=Pt.values[0];for(let or=1;or<Pt.values.length;or++)Pt.values[or]<Dn&&(Dn=Pt.values[or]),Pt.values[or]>xn&&(xn=Pt.values[or]);const Sn=(xn-Dn)/(xe-1),En=[...[...Array(xe-1).keys()].map((or,ll)=>ll*Sn+Dn),xn],Mn=Pt.type===oe.PU.time?Dn:0,Ra=[],yr=[];for(let or=0;or<Pt.values.length;or++)Ut.values[or]!==null&&!isNaN(Ut.values[or])&&(yr.push(Pt.values[or]-Mn),Ra.push(Ut.values[or]));let gr;switch(ze){case"linear":gr=new Sa.X(yr,Ra);break;case"polynomial":gr=new na.Y(yr,Ra,Ye);break;default:return ge}const Sr={name:`${ze} regression`,length:En.length,fields:[{name:Pt.name,type:Pt.type,values:En,config:{}},{name:`${(0,ee.Ct)(Ut,qt,ge)} predicted`,type:Ut.type,values:En.map(or=>gr.predict(or-Mn)),config:{}}]};return[...ge,Sr]}},Xa={editor:vo.O,id:"",name:"",settings:{width:24,isClearable:!1}},qs=20,Cs=({input:ae,options:te,onChange:ge})=>{const xe=[{label:"Linear",value:ka.linear},{label:"Polynomial",value:ka.polynomial}];return(0,c.useEffect)(()=>{let ze,Ye;if(!te.xFieldName){const at=se.sJ.get(ne.Ct.firstTimeField).get({});for(const Et of ae)if(ze=Et.fields.find(Pt=>at(Pt,Et,ae)),ze)break;if(!ze){const Et=se.sJ.get(ne.Ct.numeric).get({});for(const Pt of ae)if(ze=Pt.fields.find(Ut=>Et(Ut,Pt,ae)),ze)break}}if(!te.yFieldName){const at=se.sJ.get(ne.Ct.numeric).get({});for(const Et of ae)if(Ye=Et.fields.find(Pt=>at(Pt,Et,ae)&&Pt!==ze),Ye)break}ze&&Ye&&ge({...te,xFieldName:ze.name,yFieldName:Ye.name})}),c.createElement(c.Fragment,null,c.createElement(ie.I,{labelWidth:qs,label:"X field"},c.createElement(vo.O,{context:{data:ae},value:te.xFieldName??"",item:Xa,onChange:ze=>{ge({...te,xFieldName:ze})}})),c.createElement(ie.I,{labelWidth:qs,label:"Y field"},c.createElement(vo.O,{context:{data:ae},value:te.yFieldName??"",item:Xa,onChange:ze=>{ge({...te,yFieldName:ze})}})),c.createElement(ie.I,{labelWidth:qs,label:"Model type"},c.createElement(pe.l6,{value:te.modelType??Da.modelType,onChange:ze=>{ge({...te,modelType:ze.value??Da.modelType})},options:xe})),c.createElement(ie.I,{labelWidth:qs,label:"Predicted points",tooltip:"Number of X,Y points to predict"},c.createElement(Xs.Q,{value:te.predictionCount??Da.predictionCount,onChange:ze=>{ge({...te,predictionCount:ze})}})),te.modelType===ka.polynomial&&c.createElement(ie.I,{labelWidth:qs,label:"Degree"},c.createElement(pe.l6,{value:te.degree??Da.degree,options:[{label:"Quadratic",value:2},{label:"Cubic",value:3},{label:"Quartic",value:4},{label:"Quintic",value:5}],onChange:ze=>{ge({...te,degree:ze.value})}})))},Ss={id:Z.F.regression,editor:Cs,transformation:ds,name:ds.name,description:ds.description,categories:new Set([E.m.CalculateNewFields]),help:he(Z.F.regression).helperDocs},fa={id:Z.F.rowsToFields,name:"Rows to fields",description:"Convert each row into a field with dynamic config.",defaultOptions:{},operator:ae=>te=>te.pipe((0,Ht.T)(ge=>ge.map(xe=>Fa(ae,xe))))};function Fa(ae,te){const ge=Gt(te,ae.mappings??[],!0),{nameField:xe,valueField:ze}=ge;if(!xe||!ze)return te;const Ye=[];for(let at=0;at<xe.values.length;at++){const Et=xe.values[at],Pt=ze.values[at],Ut=Yn(te,at,ge),qt=Na(te,at,ge),Dn={name:`${Et}`,type:ze.type,values:[Pt],config:Ut,labels:qt};Ye.push(Dn)}return{fields:Ye,length:1}}function Na(ae,te,ge){const xe={...ge.nameField.labels};for(let ze=0;ze<ae.fields.length;ze++){const Ye=ae.fields[ze],at=(0,ee.Ct)(Ye,ae),Et=ge.index[at];if(Et.handler&&Et.handler.key!==nt.Label)continue;const Pt=Ye.values[te];Pt!=null&&(xe[at]=Pt)}return xe}function Is({input:ae,options:te,onChange:ge}){return ae.length===0?null:c.createElement("div",null,c.createElement(Jt,{frame:ae[0],mappings:te.mappings??[],onChange:xe=>ge({...te,mappings:xe}),withNameAndValue:!0}))}const pr={id:fa.id,editor:Is,transformation:fa,name:fa.name,description:fa.description,state:gt.pn.beta,categories:new Set([E.m.Reformat]),help:he(fa.id).helperDocs};var ir=e(52622),fo=e(61983),ss=e(9581),wo=e(96606),ui=e(31484),Sl=e(78134);const _o={id:Z.F.spatial,name:"Spatial operations",description:"Apply spatial operations to query results.",defaultOptions:{},operator:ae=>te=>te.pipe((0,Ii.Z)(ge=>(0,bi.H)(mi(ge,ae))))};function Or(ae){return ae.action===ss.dy.Modify&&ae.modify?.op===ss.YD.LineBuilder}async function mi(ae,te){const ge=await(0,ui.nE)(te.source);if(Or(te)){const xe=await(0,ui.nE)(te.modify?.target);return ae.map(ze=>{const Ye=(0,ui.FM)(ze,ge),at=(0,ui.FM)(ze,xe);if(Ye.field&&at.field){const Et=[...ze.fields],Pt=(0,wo.XR)(Ye.field,at.field),Ut=Et[0];return Ut.type===oe.PU.geo&&Ut!==Ye.field&&Ut!==at.field?Et[0]=(0,wo.RA)(Ut,Pt):Et.unshift(Pt),{...ze,fields:Et}}return ze})}return ae.map(xe=>{let ze=(0,ui.FM)(xe,ge);if(ze.field){if(te.action===ss.dy.Modify){switch(te.modify?.op){case ss.YD.AsLine:let at=ze.field.name;return(!at||at==="Point")&&(at="Line"),{...xe,length:1,fields:[{...ze.field,name:at,type:oe.PU.geo,values:[(0,Sl.tt)(ze.field)]}]}}return xe}const Ye=ze.derived?[ze.field,...xe.fields]:xe.fields.slice(0);if(te.action===ss.dy.Calculate&&(Ye.push((0,Sl.pp)(ze.field,te.calculate??{})),ze.derived=!0),ze.derived)return{...xe,fields:Ye}}return xe})}const ii=(ae,te)=>{const ge=te.options??{};ae.addSelect({path:"action",name:"Action",description:"",defaultValue:ss.dy.Prepare,settings:{options:[{value:ss.dy.Prepare,label:"Prepare spatial field",description:"Set a geometry field based on the results of other fields"},{value:ss.dy.Calculate,label:"Calculate value",description:"Use the geometry to define a new field (heading/distance/area)"},{value:ss.dy.Modify,label:"Transform",description:"Apply spatial operations to the geometry"}]}}),ge.action===ss.dy.Calculate?ae.addSelect({path:"calculate.calc",name:"Function",description:"",defaultValue:ss.kD.Heading,settings:{options:[{value:ss.kD.Heading,label:"Heading"},{value:ss.kD.Area,label:"Area"},{value:ss.kD.Distance,label:"Distance"}]}}):ge.action===ss.dy.Modify&&ae.addSelect({path:"modify.op",name:"Operation",description:"",defaultValue:ss.YD.AsLine,settings:{options:[{value:ss.YD.AsLine,label:"As line",description:"Create a single line feature with a vertex at each row"},{value:ss.YD.LineBuilder,label:"Line builder",description:"Create a line between two points"}]}}),Or(ge)?(ae.addNestedOptions({category:["Source"],path:"source",build:(xe,ze)=>{const Ye=ge.source??{mode:ir.aG.Auto};(0,fo.G)("Point","",xe,Ye)}}),ae.addNestedOptions({category:["Target"],path:"modify",build:(xe,ze)=>{const Ye=ge.modify?.target??{mode:ir.aG.Auto};(0,fo.G)("Point","target.",xe,Ye)}})):(0,fo.G)("Location","source.",ae,ge.source)},Li=ae=>{(0,c.useEffect)(()=>{if(!ae.options.source?.mode){const xe=_t(ii);ae.onChange({...xe,...ae.options}),console.log("geometry useEffect",xe)}},[]);const te=_c((0,fn.$j)()),ge=Rt(ae,ii);return c.createElement("div",null,c.createElement("div",null,ge.items.map(xe=>xe.render())),c.createElement("div",null,ge.categories.map(xe=>c.createElement("div",{key:xe.props.id,className:te.wrap},c.createElement("h5",null,xe.props.title),c.createElement("div",{className:te.item},xe.items.map(ze=>ze.render()))))))},_c=ae=>({wrap:(0,un.css)`
      margin-bottom: 20px;
    `,item:(0,un.css)`
      border-left: 4px solid ${ae.colors.border.strong};
      padding-left: 10px;
    `}),ym={id:Z.F.spatial,editor:Li,transformation:_o,name:_o.name,description:_o.description,state:gt.pn.alpha,categories:new Set([E.m.PerformSpatialOperations]),help:he(Z.F.spatial).helperDocs};var vc=e(19845);const Tl={id:Z.F.timeSeriesTable,name:"Time series to table",description:"Convert time series data to table rows so that they can be viewed in tabular or sparkline format.",defaultOptions:{},isApplicable:ae=>{for(const te of ae)if((0,vc.aH)(te))return Rr.M.Applicable;return Rr.M.NotApplicable},isApplicableDescription:"The Time series to table transformation requires at least one time series frame to function. You currently have none.",operator:ae=>te=>te.pipe((0,Ht.T)(ge=>Wd(ae,ge)))};function Wd(ae,te){const ge={},xe={},ze=[];let Ye=Kd(te);for(const at of Object.keys(Ye)){const Et=te.filter(Ut=>Ut.refId===at);ge[at]={},xe[at]={};const Pt=[];Et.forEach(Ut=>{Ut.fields.forEach(qt=>{qt.type===oe.PU.number&&qt.labels&&Object.keys(qt.labels).forEach(Dn=>{Pt.includes(Dn)||(xe[at][Dn]=Oo(Dn,oe.PU.string),Pt.push(Dn))})})});for(let Ut=0;Ut<Et.length;Ut++){const qt=Et[Ut];let Dn=null,xn=ae[at]?.timeField;if(xn&&xn.length>0?Dn=qt.fields.find(Sn=>Sn.name===xn):Dn=qt.fields.find(Sn=>(0,vc.hF)(Sn)),!(0,vc.aH)(qt)){ze.push(qt);continue}for(const Sn of qt.fields){if(Sn.type!==oe.PU.number)continue;const En=ae[at]?.stat??$t.gy.lastNotNull,Mn=(0,$t.Nw)({field:Sn,reducers:[En]})[En]??null,Ra=new Ua.k;Dn!==void 0&&(Ra.addField(Dn),Ra.addField(Sn),ge[at][`Trend #${at}`]===void 0&&(ge[at][`Trend #${at}`]=Oo(`Trend #${at}`,oe.PU.frame)),ge[at][`Trend #${at}`].values.push({...Ra,value:Mn,length:Sn.values.length})),Pt.forEach(yr=>{xe[at][yr].values.push(Sn.labels?.[yr]??"")})}}}for(const at of Object.keys(Ye)){const Et={},Pt=new Ua.k;Pt.refId=at;const Ut=xe[at];if(Ut!==void 0)for(const[Dn,xn]of Object.entries(Ut))Et[Dn]===void 0&&(Et[Dn]=xn);for(const Dn of Object.values(Et))Pt.addField(Dn);const qt=ge[at];for(const Dn of Object.values(qt))Pt.addField(Dn);Pt.fields.length>0&&ze.push(Pt)}return ze}function Oo(ae,te){return{name:ae,type:te,config:{},values:[]}}function Kd(ae){let te={};for(const ge of ae)ge.refId!==void 0&&(te[ge.refId]===void 0?te[ge.refId]=1:te[ge.refId]++);return te}function $d({input:ae,options:te,onChange:ge}){const xe=Kd(ae),ze=(0,c.useCallback)((Et,Pt)=>{const Ut=Pt?.value!==void 0?Pt.value:"";ge({...te,[Et]:{...te[Et],timeField:Ut}})},[ge,te]),Ye=(0,c.useCallback)((Et,Pt)=>{const Ut=Pt[0];Ut&&(0,$t.Em)(Ut)&&ge({...te,[Et]:{...te[Et],stat:Ut}})},[ge,te]);let at=[];for(const Et of Object.keys(xe)){const Pt={},Ut=[];for(const qt of ae)if(qt.refId===Et)for(const Dn of qt.fields)(0,vc.hF)(Dn)&&(Pt[Dn.name]=Dn);for(const qt of Object.values(Pt)){const{name:Dn}=qt;Ut.push({label:Dn,value:Dn})}at.push(c.createElement(me.C,{key:Et},c.createElement(ie.I,null,c.createElement(ot.c,null,`Trend #${Et}`)),c.createElement(ie.I,{label:"Time field",tooltip:"The time field that will be used for the time series. If not selected the first found will be used."},c.createElement(pe.l6,{onChange:ze.bind(null,Et),options:Ut,value:te[Et]?.timeField,isClearable:!0})),c.createElement(ie.I,{label:"Stat",tooltip:"The statistic that should be calculated for this time series."},c.createElement(Yt.S,{stats:[te[Et]?.stat??$t.gy.lastNotNull],onChange:Ye.bind(null,Et),filterOptions:qt=>qt.id!==$t.gy.allValues&&qt.id!==$t.gy.uniqueValues}))))}return c.createElement(c.Fragment,null,at)}const bm={id:Tl.id,editor:$d,transformation:Tl,name:Tl.name,description:Tl.description,state:gt.pn.beta,help:he(Tl.id).helperDocs},Dm=()=>[Ki,Yo,Pn,Ao,Ve,Jo,Ns,Jn,Ko,fr,Er,ya,_n,ro,an,pr,jn,qn,zo,ym,Os,ti,An,co,hs,Zo,Ba,...Y.$.featureToggles.formatString?[No]:[],...Y.$.featureToggles.regressionTransformation?[Ss]:[],...Y.$.featureToggles.groupToNestedTableTransformation?[_r]:[],oi,bm];var ml=e(67278);function Pm(){return new ml.c(new URL(e.p+e.u(7887),e.b))}function Vd(){return[{id:"kusto",name:"kusto",init:Pm}]}var Cm=e(18681),li=e(28138),Sm=e(70944),zd=e(33919),kd=e(72798),Tm=e(67608);function Hc({actions:ae,children:te,info:ge,pageNav:xe,layout:ze,renderTitle:Ye,subTitle:at}){const Et=(0,c.useContext)(kd.A);return c.createElement(Tm.Y,{navModel:Et.sectionNav,pageNav:xe,layout:ze,actions:ae,renderTitle:Ye,info:ge,subTitle:at},c.createElement(Tm.Y.Contents,null,te))}var fl=e(76888),Mm=e(8867),zi=e(91324),_d=e(23227),xm=e(83712),Pi=e(93455),Fo=e(99443),kl=e(70699),Ec=e(63997),Gc=e(5798),Om=e(61061),yc=e(85346),Im=e(41731),Am=e(36294),Rm=e(62575),Hd=e(27798),Gd=e(53392),Lm=e(17694),jc=e(27743),Zg=e(66509),Xg=e(98368),Qc=e(67341),jd=e(51472),qg=e(90517),Bm=e(78412),Qd=e(24548),Yd=e(41366),Yc=e(63892),Ml=e(22965),Jd=e(19336),Zd=e(66163),Xd=e(30259),Jc=e(96725),qd=e(30283),Um=e(53141),Nm=e(69382),wm=e(88790),Ho=e(388),eu=e(58689),tu=e(29342),bc=e(27583),nu=e(34153),au=e(13852),su=e(5614),ru=e(34715),Fm=e(25853),Wm=e(98020),Zi=e(90088),Km=e(79764),ou=e(5422),iu=e(61987),Dc=e(88225),$m=e(13896),Vm=e(68018),xl=e(63023),zm=e(32437),Go=e(99996),gl=e(99641),km=e(70649),Zc=e(98828),_m=e(79151),Hm=e(53663),Gm=e(27193),lu=e(53123),cu=e(4458),Ol=e(28643),Xc=e(33311),du=e(90841),Xi=e(49018),qi=e(63738),uu=e(63263),Il=e(29340),mu=e(45937),jm=e(29339),qc=e(6820),Qm=e(77444),ep=e(3327),fu=e(70794),Pc=e(11273),Xo=e(80641),fi=e(28867),gu=e(11220),ed=e(23544),_l=e(48339),Cc=e(4240),pl=e(95224),pu=e(82382),Hl=e(87048),hu=e(53007),tp=e(12179),Ym=e(17226),Jm=e(42982),td=e(42806),vu=e(50459),Gl=e(84879),Zm=e(52664),nd=e(26868),Xm=e(72805),qm=e(73575),ef=e(56811),tf=e(53896),nf=e(97918),Eu=e(81422),Sc=e(29130),yu=e(45376),af=e(73642),sf=e(83267),bu=e(80021),rf=e(41684),of=e(72215),lf=e(81656),cf=e(29424),df=e(7682),Du=e(51764),uf=e(76151),mf=e(30781),ff=e(65972),ad=e(90756),Pu=e(24289),gf=e(84472),pf=e(71533),hf=e(45298),vf=e(96906),Ef=e(95311),ki=e(82349),gi=e(43482),_i=e(49935),np=e(48761),yf=e(97231),Cu=e(13835),Su=e(91381),bf=e(52859),Tu=e(25928),Df=e(36714),Pf=e(30815),Cf=e(3465),Mu=e(39012),Sf=e(94675),Tf=e(40051),jl=e(4543),xu=e(89579),Mf=e(82524),Tc=e(31115),xf=e(99003),Of=e(95684),ap=e(1624),sp=e(93644),If=e(96619),sd=e(61748),Af=e(57169),Ou=e(11769),Rf=e(26551),Iu=e(40295),el=e(38514),Au=e(81312),Lf=e(64298),Ru=e(70866),Bf=e(30587),Uf=e(44850),Nf=e(54556),Lu=e(81615),wf=e(82798),Ff=e(8687),Wf=e(77270),Ql=e(10742),rd=e(41404),Mc=e(72579),Bu=e(39973),Yl=e(56963),xc=e(8807),Uu=e(24109),Nu=e(46255),Kf=e(68636),$f=e(74305);let hl=!1;function Bn(ae,te){Mm.cacheStore[te]={content:ae,status:"loaded"}}function Vf(){let ae="public/img/icons/";const te=typeof window<"u"&&window.__grafana_public_path__;return te&&(ae=te+"img/icons/"),ge=>ae+ge}function wu(){if(hl)return;hl=!0;const ae=Vf();Bn(zi,ae("unicons/at.svg")),Bn(_d,ae("unicons/adjust-circle.svg")),Bn(xm,ae("unicons/align-left.svg")),Bn(Pi,ae("unicons/align-right.svg")),Bn(Fo,ae("unicons/angle-double-down.svg")),Bn(kl,ae("unicons/angle-double-right.svg")),Bn(Ec,ae("unicons/angle-down.svg")),Bn(Gc,ae("unicons/angle-left.svg")),Bn(Om,ae("unicons/angle-right.svg")),Bn(yc,ae("unicons/angle-up.svg")),Bn(Im,ae("unicons/apps.svg")),Bn(Am,ae("unicons/arrow.svg")),Bn(Rm,ae("unicons/arrow-down.svg")),Bn(Hd,ae("unicons/arrow-from-right.svg")),Bn(Gd,ae("unicons/arrow-left.svg")),Bn(Lm,ae("unicons/arrow-random.svg")),Bn(jc,ae("unicons/arrow-right.svg")),Bn(Zg,ae("unicons/arrow-to-right.svg")),Bn(Xg,ae("unicons/arrow-up.svg")),Bn(Qc,ae("unicons/arrows-h.svg")),Bn(jd,ae("unicons/backward.svg")),Bn(qg,ae("unicons/bars.svg")),Bn(Bm,ae("unicons/bell.svg")),Bn(Qd,ae("unicons/bell-slash.svg")),Bn(Yd,ae("unicons/bolt.svg")),Bn(Yc,ae("unicons/book.svg")),Bn(Ml,ae("unicons/book-open.svg")),Bn(Jd,ae("unicons/brackets-curly.svg")),Bn(Zd,ae("unicons/bug.svg")),Bn(Xd,ae("unicons/building.svg")),Bn(Jc,ae("unicons/calculator-alt.svg")),Bn(qd,ae("unicons/calendar-alt.svg")),Bn(Um,ae("unicons/calendar-slash.svg")),Bn(Nm,ae("unicons/camera.svg")),Bn(wm,ae("unicons/channel-add.svg")),Bn(Ho,ae("unicons/chart-line.svg")),Bn(eu,ae("unicons/check.svg")),Bn(tu,ae("unicons/check-circle.svg")),Bn(bc,ae("unicons/circle.svg")),Bn(nu,ae("unicons/clipboard-alt.svg")),Bn(au,ae("unicons/clock-nine.svg")),Bn(su,ae("unicons/cloud.svg")),Bn(ru,ae("unicons/cloud-download.svg")),Bn(Fm,ae("unicons/code-branch.svg")),Bn(Wm,ae("unicons/cog.svg")),Bn(Zi,ae("unicons/columns.svg")),Bn(Km,ae("unicons/comment-alt.svg")),Bn(ou,ae("unicons/comment-alt-share.svg")),Bn(iu,ae("unicons/comments-alt.svg")),Bn(Dc,ae("unicons/compass.svg")),Bn($m,ae("unicons/copy.svg")),Bn(Vm,ae("unicons/corner-down-right-alt.svg")),Bn(xl,ae("unicons/cube.svg")),Bn(zm,ae("unicons/dashboard.svg")),Bn(Go,ae("unicons/database.svg")),Bn(gl,ae("unicons/document-info.svg")),Bn(km,ae("unicons/download-alt.svg")),Bn(Zc,ae("unicons/draggabledots.svg")),Bn(_m,ae("unicons/edit.svg")),Bn(Hm,ae("unicons/ellipsis-v.svg")),Bn(Gm,ae("unicons/ellipsis-h.svg")),Bn(lu,ae("unicons/envelope.svg")),Bn(cu,ae("unicons/exchange-alt.svg")),Bn(Ol,ae("unicons/exclamation-circle.svg")),Bn(Xc,ae("unicons/exclamation-triangle.svg")),Bn(du,ae("unicons/external-link-alt.svg")),Bn(Xi,ae("unicons/eye.svg")),Bn(qi,ae("unicons/eye-slash.svg")),Bn(uu,ae("unicons/file-alt.svg")),Bn(Il,ae("unicons/file-blank.svg")),Bn(mu,ae("unicons/filter.svg")),Bn(jm,ae("unicons/folder.svg")),Bn(qc,ae("unicons/folder-open.svg")),Bn(Qm,ae("unicons/folder-plus.svg")),Bn(ep,ae("unicons/folder-upload.svg")),Bn(fu,ae("unicons/forward.svg")),Bn(Pc,ae("unicons/graph-bar.svg")),Bn(Xo,ae("unicons/history.svg")),Bn(fi,ae("unicons/history-alt.svg")),Bn(gu,ae("unicons/home-alt.svg")),Bn(ed,ae("unicons/import.svg")),Bn(_l,ae("unicons/info.svg")),Bn(Cc,ae("unicons/info-circle.svg")),Bn(pl,ae("unicons/k6.svg")),Bn(pu,ae("unicons/key-skeleton-alt.svg")),Bn(Hl,ae("unicons/keyboard.svg")),Bn(hu,ae("unicons/link.svg")),Bn(tp,ae("unicons/list-ul.svg")),Bn(Ym,ae("unicons/lock.svg")),Bn(Jm,ae("unicons/minus.svg")),Bn(td,ae("unicons/minus-circle.svg")),Bn(vu,ae("unicons/mobile-android.svg")),Bn(Gl,ae("unicons/monitor.svg")),Bn(Zm,ae("unicons/pause.svg")),Bn(nd,ae("unicons/pen.svg")),Bn(Xm,ae("unicons/play.svg")),Bn(qm,ae("unicons/plug.svg")),Bn(ef,ae("unicons/plus.svg")),Bn(tf,ae("unicons/plus-circle.svg")),Bn(nf,ae("unicons/power.svg")),Bn(Eu,ae("unicons/presentation-play.svg")),Bn(Sc,ae("unicons/process.svg")),Bn(yu,ae("unicons/question-circle.svg")),Bn(af,ae("unicons/repeat.svg")),Bn(sf,ae("unicons/rocket.svg")),Bn(bu,ae("unicons/rss.svg")),Bn(rf,ae("unicons/save.svg")),Bn(of,ae("unicons/search.svg")),Bn(lf,ae("unicons/search-minus.svg")),Bn(cf,ae("unicons/search-plus.svg")),Bn(df,ae("unicons/share-alt.svg")),Bn(Du,ae("unicons/shield.svg")),Bn(uf,ae("unicons/signal.svg")),Bn(mf,ae("unicons/signin.svg")),Bn(ff,ae("unicons/signout.svg")),Bn(ad,ae("unicons/sitemap.svg")),Bn(Pu,ae("unicons/slack.svg")),Bn(gf,ae("unicons/sliders-v-alt.svg")),Bn(pf,ae("unicons/sort-amount-down.svg")),Bn(hf,ae("unicons/sort-amount-up.svg")),Bn(vf,ae("unicons/square-shape.svg")),Bn(Ef,ae("unicons/star.svg")),Bn(ki,ae("unicons/step-backward.svg")),Bn(gi,ae("unicons/sync.svg")),Bn(_i,ae("unicons/stopwatch.svg")),Bn(np,ae("unicons/table.svg")),Bn(yf,ae("unicons/tag-alt.svg")),Bn(Cu,ae("unicons/times.svg")),Bn(Su,ae("unicons/trash-alt.svg")),Bn(bf,ae("unicons/unlock.svg")),Bn(Tu,ae("unicons/upload.svg")),Bn(Df,ae("unicons/user.svg")),Bn(Pf,ae("unicons/users-alt.svg")),Bn(Cf,ae("unicons/wrap-text.svg")),Bn(Mu,ae("unicons/cloud-upload.svg")),Bn(Sf,ae("unicons/credit-card.svg")),Bn(Tf,ae("unicons/file-copy-alt.svg")),Bn(jl,ae("unicons/fire.svg")),Bn(xu,ae("unicons/hourglass.svg")),Bn(Mf,ae("unicons/layer-group.svg")),Bn(Tc,ae("unicons/layers-alt.svg")),Bn(xf,ae("unicons/line-alt.svg")),Bn(Of,ae("unicons/list-ui-alt.svg")),Bn(ap,ae("unicons/message.svg")),Bn(sp,ae("unicons/palette.svg")),Bn(If,ae("unicons/percentage.svg")),Bn(sd,ae("unicons/shield-exclamation.svg")),Bn(Af,ae("unicons/plus-square.svg")),Bn(Ou,ae("unicons/x.svg")),Bn(Rf,ae("unicons/capture.svg")),Bn(Iu,ae("custom/gf-grid.svg")),Bn(el,ae("custom/gf-landscape.svg")),Bn(Au,ae("custom/gf-layout-simple.svg")),Bn(Lf,ae("custom/gf-portrait.svg")),Bn(Ru,ae("custom/gf-show-context.svg")),Bn(Bf,ae("custom/gf-bar-alignment-after.svg")),Bn(Uf,ae("custom/gf-bar-alignment-before.svg")),Bn(Nf,ae("custom/gf-bar-alignment-center.svg")),Bn(Lu,ae("custom/gf-interpolation-linear.svg")),Bn(wf,ae("custom/gf-interpolation-smooth.svg")),Bn(Ff,ae("custom/gf-interpolation-step-after.svg")),Bn(Wf,ae("custom/gf-interpolation-step-before.svg")),Bn(Ql,ae("custom/gf-logs.svg")),Bn(rd,ae("custom/gf-movepane-left.svg")),Bn(Mc,ae("custom/gf-movepane-right.svg")),Bn(Bu,ae("mono/favorite.svg")),Bn(Yl,ae("mono/grafana.svg")),Bn(xc,ae("mono/heart.svg")),Bn(Uu,ae("mono/heart-break.svg")),Bn(Nu,ae("mono/panel-add.svg")),Bn(Kf,ae("mono/library-panel.svg")),Bn($f,ae("unicons/record-audio.svg"))}var tl=e(8484);function zf(){self.MonacoEnvironment={getWorker(ae,te){const ge=S.l.getIfExists(te);return ge?ge.init():te==="json"?new ml.c(new URL(e.p+e.u(1162),e.b)):te==="css"||te==="scss"||te==="less"?new ml.c(new URL(e.p+e.u(9044),e.b)):te==="html"||te==="handlebars"||te==="razor"?new ml.c(new URL(e.p+e.u(4064),e.b)):te==="typescript"||te==="javascript"?new ml.c(new URL(e.p+e.u(2150),e.b)):new ml.c(new URL(e.p+e.u(1821),e.b))}}}var od=e(76885);function kf(ae){const te=ae.target instanceof Element&&rp(ae.target);if(!(ae.ctrlKey||ae.metaKey||ae.defaultPrevented)&&te){let ge=te.getAttribute("href");const xe=te.getAttribute("target");if(ge&&!xe){const ze=od.kM.parseKeyValue(ge.split("?")[1]),Ye=ze.orgId&&Number(ze.orgId)!==G.config.bootData.user.orgId;if((0,x.Lc)("utils",!1,"intercepting link click",ae),ae.preventDefault(),ge=T.I.stripBaseFromUrl(ge),ge[0]!=="/"||Ye)if(ge.indexOf("://")>0||ge.indexOf("mailto:")===0||Ye){window.location.href=ge;return}else if(ge.indexOf("#")===0){window.location.hash=ge;return}else ge=`/${ge}`;x.Ny.push(ge)}}}function rp(ae){for(;ae!==null&&ae.tagName;){if(ae.tagName.toUpperCase()==="A")return ae;ae=ae.parentElement}return null}var _f=e(78731),Oc=e(14110);class Hf{constructor(te){this.hasUpdates=!1,this.checked=Date.now(),this.prevLocationPath="",this.interval=te??1e3*60*5}start(){const te=(0,_f.oF)();te&&te.getConnectionState().subscribe(ge=>{ge&&this._checkForUpdates()}),x.Ny.getHistory().listen(this.locationUpdated.bind(this)),this.prevLocationPath=x.Ny.getLocation().pathname}locationUpdated(te){if(this.prevLocationPath===te.pathname)return;const ge=te.pathname.split("/");ge[1]==="/"&&this.prevLocationPath!=="/"?this.reloadIfUpdateDetected():ge[1]==="d"?this.reloadIfUpdateDetected():this.hasUpdates&&(0,Oc.rR)("new_frontend_assets_reload_ignored",{newLocation:te.pathname,prevLocation:this.prevLocationPath}),this.prevLocationPath=te.pathname}async _checkForUpdates(){if(this.hasUpdates||Date.now()-this.checked<this.interval)return;this.checked=Date.now();const te=this.previous,ge=await(0,M.AI)().get("/api/frontend/assets");te&&!(0,g.isEqual)(te,ge)&&(this.hasUpdates=!0,(0,Oc.rR)("new_frontend_assets_detected",{assets:te.assets!==ge.assets,plugins:te.plugins!==ge.plugins,version:te.version!==ge.version,flags:te.flags!==ge.flags})),this.previous=ge}reloadIfUpdateDetected(){this.hasUpdates&&((0,Oc.rR)("new_frontend_assets_reload",{}),window.location.reload()),this._checkForUpdates()}}var id=e(27677),nl=e(16233),Gf=e(91040),Fu=e(40621);function Ic(ae,te=!1){return new Promise(ge=>{const xe=document.createElement("script");xe.onload=ge,xe.src=ae,xe.async=te,document.head.appendChild(xe)})}const ld=(0,Gf.h)("EchoSrv"),cd=ld.logger;(0,Fu.h)("echo",void 0,ld);class jf{constructor(te){this.config={flushInterval:1e4,debug:!1},this.backends=[],this.flush=()=>{for(const ge of this.backends)ge.flush()},this.addBackend=ge=>{cd("Adding backend",!1,ge),this.backends.push(ge)},this.addEvent=(ge,xe)=>{const ze=this.getMeta(),Ye={...ge,meta:{...ze,...xe}};for(const at of this.backends)(at.supportedEvents.length===0||at.supportedEvents.indexOf(Ye.type)>-1)&&at.addEvent(Ye);cd(`${ge.type} event`,!1,{...ge.payload,meta:Ye.meta})},this.getMeta=()=>({sessionId:"",userId:nl.TP.user.id,userLogin:nl.TP.user.login,userSignedIn:nl.TP.user.isSignedIn,screenSize:{width:window.innerWidth,height:window.innerHeight},windowSize:{width:window.screen.width,height:window.screen.height},userAgent:window.navigator.userAgent,ts:new Date().getTime(),timeSinceNavigationStart:performance.now(),path:window.location.pathname,url:window.location.href}),this.config={...this.config,...te},setInterval(this.flush,this.config.flushInterval)}}var Ac=e(42614);class Wu{constructor(te){this.options=te,this.buffer=[],this.supportedEvents=[U.on.Performance],this.addEvent=ge=>{this.buffer.push(ge.payload)},this.flush=()=>{this.buffer.length!==0&&(id.IB.post("/api/frontend-metrics",{events:this.buffer},{showErrorAlert:!1}).catch(()=>{}),this.buffer=[])}}}var Hi=e(61298);class vl{constructor(te){this.options=te,this.supportedEvents=[U.on.Pageview,U.on.Interaction],this.addEvent=ze=>{window.applicationInsights&&((0,Hi.nB)(ze)&&window.applicationInsights.trackPageView?.(),(0,Hi.fX)(ze)&&window.applicationInsights.trackEvent?.({name:ze.payload.interactionName,properties:ze.payload.properties}))},this.flush=()=>{};const ge={config:{connectionString:te.connectionString,endpointUrl:te.endpointUrl}};System.import("https://js.monitor.azure.com/scripts/b/ai.2.min.js").then(ze=>ze.default?ze.default:ze).then(({ApplicationInsights:ze})=>{const Ye=new ze(ge);window.applicationInsights=Ye.loadAppInsights()})}}class Al{constructor(te){this.options=te,this.supportedEvents=[U.on.Pageview],this.googleAnalytics4SendManualPageViews=!1,this.addEvent=ze=>{window.gtag&&this.googleAnalytics4SendManualPageViews&&window.gtag("event","page_view",{page_path:ze.payload.page})},this.flush=()=>{};const ge=`https://www.googletagmanager.com/gtag/js?id=${te.googleAnalyticsId}`;Ic(ge,!0),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date);const xe={page_path:window.location.pathname};te.user&&(xe.user_id=te.user.analytics.identifier),this.googleAnalytics4SendManualPageViews=te.googleAnalytics4SendManualPageViews,window.gtag("config",te.googleAnalyticsId,xe)}}class dd{constructor(te){this.options=te,this.supportedEvents=[U.on.Pageview],this.trackedUserId=null,this.addEvent=ze=>{if(!window.ga)return;window.ga("set",{page:ze.payload.page}),window.ga("send","pageview");const{userSignedIn:Ye,userId:at}=ze.meta;Ye&&at!==this.trackedUserId&&(this.trackedUserId=at,window.ga("set","userId",at))},this.flush=()=>{};const ge=`https://www.google-analytics.com/analytics${te.debug?"_debug":""}.js`;Ic(ge);const xe=window.ga=window.ga||function(){(xe.q=xe.q||[]).push(arguments)};xe.l=+new Date,xe("create",te.googleAnalyticsId,"auto"),xe("set","anonymizeIp",!0)}}class Qf{constructor(te){this.options=te,this.supportedEvents=[U.on.Pageview,U.on.Interaction,U.on.ExperimentView],this.addEvent=Ye=>{window.rudderanalytics&&((0,Hi.nB)(Ye)&&window.rudderanalytics.page?.(),(0,Hi.fX)(Ye)&&window.rudderanalytics.track?.(Ye.payload.interactionName,Ye.payload.properties),(0,Hi.p6)(Ye)&&window.rudderanalytics.track?.("experiment_viewed",{experiment_id:Ye.payload.experimentId,experiment_group:Ye.payload.experimentGroup,experiment_variant:Ye.payload.experimentVariant}))},this.flush=()=>{};const ge=te.sdkUrl||"https://cdn.rudderlabs.com/v1/rudder-analytics.min.js";Ic(ge);const xe=window.rudderanalytics=[],ze=["load","page","track","identify","alias","group","ready","reset","getAnonymousId","setAnonymousId"];for(let Ye=0;Ye<ze.length;Ye++){const at=ze[Ye];xe[at]=function(Et){return function(){xe.push([Et].concat(Array.prototype.slice.call(arguments)))}}(at)}if(window.rudderanalytics?.load?.(te.writeKey,te.dataPlaneUrl,{configUrl:te.configUrl,destSDKBaseURL:te.integrationsUrl}),te.user){const{identifier:Ye,intercomIdentifier:at}=te.user.analytics,Et={};at&&(Et.Intercom={user_hash:at}),window.rudderanalytics?.identify?.(Ye,{email:te.user.email,orgId:te.user.orgId,language:te.user.language,version:te.buildInfo.version,edition:te.buildInfo.edition},Et)}}}var Yf=e(35896),Jf=e(88285),Wo=e(74940),Ku=e(36043),op=e(8593),al=e(26539),ud=e(21736),Zf=e(20467);class $u extends Zf.j{constructor(){super(...arguments),this.name="EchoSrvTransport",this.version=Y.$.buildInfo.version}send(te){(0,U.x$)().addEvent({type:U.on.GrafanaJavascriptAgent,payload:te})}isBatched(){return!0}getIgnoreUrls(){return[]}}class Xf{constructor(te){this.options=te,this.supportedEvents=[U.on.GrafanaJavascriptAgent],this.addEvent=Ye=>{},this.flush=()=>{};const ge=[],xe=[new $u];te.customEndpoint&&xe.push(new Jf.m({url:te.customEndpoint,apiKey:te.apiKey})),te.errorInstrumentalizationEnabled&&ge.push(new Wo.W),te.consoleInstrumentalizationEnabled&&ge.push(new Ku._),te.webVitalsInstrumentalizationEnabled&&ge.push(new op.I),ge.push(new al.D);const ze={globalObjectKey:te.globalObjectKey||"faro",preventGlobalExposure:te.preventGlobalExposure||!1,app:{version:te.buildInfo.version,environment:te.buildInfo.env},instrumentations:ge,transports:xe,ignoreErrors:["ResizeObserver loop limit exceeded","ResizeObserver loop completed","Non-Error exception captured with keys"],sessionTracking:{persistent:!0},batching:{sendTimeout:1e3},internalLoggerLevel:te.internalLoggerLevel||Yf.vI};this.faroInstance=(0,ud.p)(ze),te.user&&this.faroInstance.api.setUser({id:te.user.id,attributes:{orgId:String(te.user.orgId)||""}})}}var Vu=e(69129),qf=e(26272),eg=e(87490),tg=e(70497),ng=e(1702),El=e(74856),ci=e(28444),ip=e(93522),md=e(10096),Bi=e(4898),fd=e(2769);class gd{constructor(te,ge){this.locationService=te,this.chromeService=ge,this.panelId=null,li.A.subscribe(Vu.Tp,xe=>{this.panelId=xe.payload.panelId})}clearAndInitGlobalBindings(te){Bi.R.reset(),te.chromeless||(this.bind("?",this.showHelpModal),this.bind("g h",this.goToHome),this.bind("g d",this.goToDashboards),this.bind("g e",this.goToExplore),this.bind("g a",this.openAlerting),this.bind("g p",this.goToProfile),this.bind("esc",this.exit),this.bindGlobalEsc()),this.bind("c t",()=>(0,fd.O)(!1)),this.bind("c r",()=>(0,fd.O)(!0))}bindGlobalEsc(){this.bindGlobal("esc",this.globalEsc)}globalEsc(){const ge=document.activeElement;if(!(document.querySelectorAll(".slate-typeahead--open").length>0)){if(ge&&ge instanceof HTMLElement&&(ge.nodeName==="INPUT"||ge.nodeName==="TEXTAREA"||ge.hasAttribute("data-slate-editor"))){ge.blur();return}this.exit()}}closeSearch(){this.locationService.partial({search:null})}openAlerting(){this.locationService.push("/alerting")}goToDashboards(){this.locationService.push("/dashboards")}goToHome(){this.locationService.push("/")}goToProfile(){this.locationService.push("/profile")}goToExplore(){this.locationService.push("/explore")}showHelpModal(){li.A.publish(new ci.S8({component:ip.N}))}exit(){const te=this.locationService.getSearchObject();if(te.editview){this.locationService.partial({editview:null,editIndex:null});return}if(te.inspect){this.locationService.partial({inspect:null,inspectTab:null});return}if(te.editPanel){this.locationService.partial({editPanel:null,tab:null});return}if(te.viewPanel){this.locationService.partial({viewPanel:null,tab:null});return}const{kioskMode:ge}=this.chromeService.state.getValue();ge&&this.chromeService.exitKioskMode(),te.search&&this.closeSearch()}showDashEditView(){this.locationService.partial({editview:"settings"})}bind(te,ge){Bi.R.bind(te,xe=>{xe.preventDefault(),xe.stopPropagation(),xe.returnValue=!1,ge.call(this)},"keydown")}bindGlobal(te,ge){Bi.R.bindGlobal(te,xe=>{xe.preventDefault(),xe.stopPropagation(),xe.returnValue=!1,ge.call(this)},"keydown")}unbind(te,ge){Bi.R.unbind(te,ge)}bindWithPanelId(te,ge){this.bind(te,this.withFocusedPanel(ge))}withFocusedPanel(te){return()=>{if(typeof this.panelId=="number"){te(this.panelId);return}}}setupTimeRangeBindings(te=!0){this.bind("t a",()=>{li.A.publish(new ci.Rh({updateUrl:te}))}),this.bind("t z",()=>{li.A.publish(new ci.U0({scale:2,updateUrl:te}))}),this.bind("ctrl+z",()=>{li.A.publish(new ci.U0({scale:2,updateUrl:te}))}),this.bind("t left",()=>{li.A.publish(new ci.Io({direction:ci.xL.Left,updateUrl:te}))}),this.bind("t right",()=>{li.A.publish(new ci.Io({direction:ci.xL.Right,updateUrl:te}))}),this.bind("t c",()=>{li.A.publish(new ci.Bt)}),this.bind("t v",()=>{li.A.publish(new ci.VZ({updateUrl:te}))})}setupDashboardBindings(te){this.bind("mod+o",()=>{te.graphTooltip=(te.graphTooltip+1)%3,te.events.publish(new qf.Tq),te.startRefresh()}),this.bind("mod+s",()=>{te.meta.canSave&&li.A.publish(new ci.S8({component:tg.$,props:{dashboard:te}}))}),this.setupTimeRangeBindings(),this.bindWithPanelId("e",ge=>{if(te.canEditPanelById(ge)){const xe=this.locationService.getSearchObject().editPanel!==void 0;this.locationService.partial({editPanel:xe?null:ge})}}),this.bindWithPanelId("v",ge=>{const xe=this.locationService.getSearchObject().viewPanel!==void 0;this.locationService.partial({viewPanel:xe?null:ge})}),this.bindWithPanelId("p l",ge=>{const xe=te.getPanelById(ge),ze={...xe.options};ze.legend.showLegend?ze.legend.showLegend=!1:ze.legend.showLegend=!0,xe.updateOptions(ze)}),this.bindWithPanelId("i",ge=>{this.locationService.partial({inspect:ge})}),md.contextSrv.hasAccessToExplore()&&this.bindWithPanelId("p x",async ge=>{const xe=te.getPanelById(ge),ze=await(0,eg.Xe)({queries:xe.targets,dsRef:xe.datasource,scopedVars:xe.scopedVars,timeRange:(0,El.jG)().timeRange()});if(ze){const Ye=T.I.stripBaseFromUrl(ze);Ye&&this.locationService.push(Ye)}}),this.bindWithPanelId("p r",ge=>{te.canEditPanelById(ge)&&!(te.panelInView||te.panelInEdit)&&li.A.publish(new ci.Vz(ge))}),this.bindWithPanelId("p d",ge=>{if(te.canEditPanelById(ge)){const xe=te.getPanelInfoById(ge).index;te.duplicatePanel(te.panels[xe])}}),this.bindWithPanelId("p s",ge=>{const xe=te.getPanelInfoById(ge);li.A.publish(new ci.S8({component:ng.ShareModal,props:{dashboard:te,panel:xe?.panel}}))}),this.bind("d l",()=>{te.toggleLegendsForAll()}),this.bind("d x",()=>{te.toggleExemplarsForAll()}),this.bind("d shift+c",()=>{te.collapseRows()}),this.bind("d shift+e",()=>{te.expandRows()}),this.bind("d n",()=>{this.locationService.push("/dashboard/new")}),this.bind("d r",()=>{te.startRefresh()}),this.bind("d s",()=>{this.showDashEditView()}),this.bind("d k",()=>{this.chromeService.onToggleKioskMode()}),this.bind("d a",()=>{const xe=this.locationService.getSearchObject().autofitpanels?"":"&autofitpanels";window.location.href=window.location.href+xe})}}var Rl=e(78160);async function lp(){if(window.location.search.indexOf("why-render")!==-1){const{default:ae}=await e.e(3718).then(e.t.bind(e,13718,23));ae(React,{trackAllPureComponents:!0})}}var ag=e(20120),zu=e(75471),sg=e(57220);const ku=c.lazy(()=>e.e(192).then(e.bind(e,57029)));function rg(){const ae=(0,zu.Wd)(sg.hY),te=Y.$.unifiedAlertingEnabled;nl.TP.hasPermission(ae.read)&&(0,ag.fP)({show:()=>te,component:({dashboard:ge})=>te?c.createElement(c.Suspense,{fallback:null,key:"alert-rules-button"},ge&&c.createElement(ku,{dashboardUid:ge.uid})):null,index:-2})}var og=e(73399);function ig(ae){return c.createElement(pd,{...ae})}const pd=c.lazy(async()=>{const{EmbeddedDashboard:ae}=await e.e(2859).then(e.bind(e,13251));return{default:ae}});var lg=e(61582),cg=e(67027),hd=e(97527),dg=e(99355),Jl=e(14590),vd=e(19895),Rc=e(44838);const ug=()=>new ml.c(new URL(e.p+e.u(5358),e.b));var Ed=e(88483),_u=e(63720);const mg=ae=>new Ed.c(te=>{const ge=ae.subscribe(Jl.BX(xe=>{te.next(xe)}),Jl.BX(xe=>{te.error(xe)}),Jl.BX(()=>{te.complete()}));return{unsubscribe:()=>{ge.then(xe=>xe.unsubscribe())}}}),yd=ae=>(0,bi.H)(ae).pipe((0,_u.n)(te=>mg(te)));class fg{constructor(te){this.getConnectionState=()=>yd(this.centrifugeWorker.getConnectionState()),this.getDataStream=ge=>yd(this.centrifugeWorker.getDataStream(ge)).pipe((0,vd.Q)(Rc.E)),this.getQueryData=async ge=>{const xe=JSON.parse(JSON.stringify(ge));return this.centrifugeWorker.getQueryData(xe)},this.getPresence=ge=>this.centrifugeWorker.getPresence(ge),this.getStream=ge=>yd(this.centrifugeWorker.getStream(ge)),this.centrifugeWorker=Jl.LV(ug()),this.centrifugeWorker.initialize(te,Jl.BX(te.dataStreamSubscriberReadiness))}}var Lc=e(9631),Zl=e(55004),Ll=e(47773),bd=e(26657),Bc=e(47118);class gg{constructor(te){this.deps=te,this.getConnectionState=()=>this.deps.centrifugeSrv.getConnectionState(),this.getDataStream=ge=>{let xe;const ze=Ye=>{const at=Ye.data[0];if(!xe&&!(0,Bc.ot)(at,Bc._w.FullFrame)){console.warn(`expected first packet to contain a full frame, received ${at?.type}`);return}switch(at.type){case Bc._w.FullFrame:{xe=Lc.k9.deserialize(at.frame);return}case Bc._w.NewValuesSameSchema:{xe.pushNewValues(at.values);return}}};return this.deps.centrifugeSrv.getDataStream(ge).pipe((0,Ht.T)(Ye=>(ze(Ye),{...Ye,data:[xe??Lc.k9.empty()]})))},this.getStream=ge=>this.deps.centrifugeSrv.getStream(ge),this.getQueryData=ge=>(0,bi.H)(this.deps.centrifugeSrv.getQueryData(ge)).pipe((0,_u.n)(xe=>{const ze=(0,Ll.bE)(xe,ge.request.targets);return ze.data?.length&&ze.data.find(at=>at.meta?.channel)?(0,bd.x7)(ze,ge.request,bd.ph):(0,ia.of)(ze)})),this.publish=async(ge,xe)=>this.deps.backendSrv.post("api/live/publish",{channel:(0,Zl.Qp)(ge),data:xe}),this.getPresence=ge=>this.deps.centrifugeSrv.getPresence(ge)}}function pg(){const ae={appUrl:`${window.location.origin}${Y.$.appSubUrl}`,orgId:nl.TP.user.orgId,orgRole:nl.TP.user.orgRole,liveEnabled:Y.$.liveEnabled,dataStreamSubscriberReadiness:lg.a.ok.asObservable(),grafanaAuthToken:(0,cg.r)()},te=Y.$.featureToggles["live-service-web-worker"]?new fg(ae):new hd.w(ae);(0,_f.S8)(new gg({centrifugeSrv:te,backendSrv:(0,M.AI)()}))}function Hu(){return getGrafanaLiveSrv()}var hg=e(17888),vg=e(20726),Xl=e(74135),Yr=e(99140),Uc=e(31678),Jr=e(75462),Gu=e(29436),cp=e(23994),dp=e(11140),up=e(12881);function mp(){try{return[(0,Jr.io)({title:"Add to dashboard",description:"Use the query and panel from explore and create/add it to a dashboard",extensionPointId:Xl.S.ExploreToolbarAction,icon:"apps",category:"Dashboards",configure:()=>{if(md.contextSrv.hasPermission(Uc.AccessControlAction.DashboardsCreate)||md.contextSrv.hasPermission(Uc.AccessControlAction.DashboardsWrite))return{}},onClick:(ae,{context:te,openModal:ge})=>{ge({title:(0,up.t)(),body:({onDismiss:xe})=>c.createElement(dp.v,{onClose:xe,exploreId:te?.exploreId})})}}),(0,Jr.io)({title:"Add correlation",description:"Create a correlation from this query",extensionPointId:Xl.S.ExploreToolbarAction,icon:"link",configure:ae=>ae?.shouldShowAddCorrelation?{}:void 0,onClick:(ae,{context:te})=>{(0,Yr.JD)((0,Gu.am)({editorMode:!0})),(0,Yr.JD)((0,cp.Od)({exploreId:te.exploreId}))}})]}catch(ae){return(0,Jr.FF)(`Could not configure extensions for Explore due to: "${ae}"`),[]}}function fp(){return[...mp()]}function Fp(ae,te="extension is not a link extension"){if(!isPluginExtensionLink(ae))throw new Error(te)}function Wp(ae,te="extension is not a command extension config"){if(!isPluginExtensionLinkConfig(ae))throw new Error(te)}function Eg(ae,te){if(!vp(ae,te))throw new Error(`Invalid link extension. The "path" is required and should start with "/a/${ae}/" (currently: "${te}"). Skipping the extension.`)}function yg(ae){if(!Dd(ae))throw new Error('Invalid component extension, the "component" property needs to be a valid React component.')}function gp(ae,te){if(!Ep(ae,te))throw new Error(`Invalid extension "${te.title}". The extensionPointId should start with either "grafana/", "plugins/" or "capabilities/${ae}" (currently: "${te.extensionPointId}"). Skipping the extension.`)}function pp(ae){if(!yp(ae))throw new Error(`Invalid extension "${ae.title}". The "configure" property must be a function. Skipping the extension.`)}function bg(ae,te){for(const ge of te)if(!bp(ae[ge]))throw new Error(`Invalid extension "${ae.title}". Property "${ge}" must be a string and cannot be empty. Skipping the extension.`)}function hp(ae,te="The provided value is a Promise."){if(Nc(ae))throw new Error(te)}function vp(ae,te){return!!(typeof te=="string"&&te.length>0&&te.startsWith(`/a/${ae}/`))}function Ep(ae,te){return!!(te.extensionPointId?.startsWith("grafana/")||te.extensionPointId?.startsWith("plugins/")||te.extensionPointId?.startsWith(`capabilities/${ae}/`))}function yp(ae){return ae.configure?typeof ae.configure=="function":!0}function bp(ae){return typeof ae=="string"&&ae.length>0}function ju(ae,te){try{if(bg(te,["title","description","extensionPointId"]),gp(ae,te),(0,Jr.z1)(te)){if(pp(te),!te.path&&!te.onClick)return(0,Jr.FF)(`Invalid extension "${te.title}". Either "path" or "onClick" is required.`),!1;te.path&&Eg(ae,te.path)}return(0,Jr.yS)(te)&&yg(te.component),!0}catch(ge){return ge instanceof Error&&(0,Jr.FF)(ge.message),!1}}function Nc(ae){return ae instanceof Promise||typeof ae=="object"&&ae!==null&&"then"in ae&&"catch"in ae}function Dd(ae){const te=xe=>typeof xe=="object"&&xe!==null&&"$$typeof"in xe;return typeof ae=="function"||(xe=>te(xe)&&xe.$$typeof===Symbol.for("react.memo"))(ae)}function Ui(ae){let te={id:"",extensions:{}};return ae.asObservable().subscribe(ge=>{te=ge}),ge=>Bl({...ge,registry:te})}const Bl=({context:ae,extensionPointId:te,limitPerPlugin:ge,registry:xe})=>{const ze=ae?(0,Jr.$Y)(ae):{},Ye=xe.extensions[te]??[],at=[],Et={};for(const Pt of Ye)try{const Ut=Pt.config,{pluginId:qt}=Pt;if(ge&&Et[qt]>=ge)continue;if(Et[qt]===void 0&&(Et[qt]=0),(0,Jr.z1)(Ut)){const Dn=Qu(qt,Ut,ze);if(Ut.configure&&Dn===void 0)continue;const xn=Dn?.path||Ut.path,Sn={id:(0,Jr.yt)(qt,Ut),type:Xl.u.link,pluginId:qt,onClick:Dg(qt,Ut,ze),icon:Dn?.icon||Ut.icon,title:Dn?.title||Ut.title,description:Dn?.description||Ut.description,path:(0,g.isString)(xn)?Yu(qt,xn,Ut):void 0,category:Dn?.category||Ut.category};at.push(Sn),Et[qt]+=1}if((0,Jr.yS)(Ut)){yg(Ut.component);const Dn={id:(0,Jr.yt)(Pt.pluginId,Ut),type:Xl.u.component,pluginId:Pt.pluginId,title:Ut.title,description:Ut.description,component:(0,Jr.nv)(qt,Ut.component)};at.push(Dn),Et[qt]+=1}}catch(Ut){Ut instanceof Error&&(0,Jr.FF)(Ut.message)}return{extensions:at}};function Qu(ae,te,ge){try{const xe=te.configure?.(ge);if(xe===void 0)return;let{title:ze=te.title,description:Ye=te.description,path:at=te.path,icon:Et=te.icon,category:Pt=te.category,...Ut}=xe;return hp(xe,`The configure() function for "${te.title}" returned a promise, skipping updates.`),at&&Eg(ae,at),bg({title:ze,description:Ye},["title","description"]),Object.keys(Ut).length>0&&(0,Jr.FF)(`Extension "${te.title}", is trying to override restricted properties: ${Object.keys(Ut).join(", ")} which will be ignored.`),{title:ze,description:Ye,path:at,icon:Et,category:Pt}}catch(xe){xe instanceof Error&&(0,Jr.FF)(xe.message);return}}function Dg(ae,te,ge){const{onClick:xe}=te;if(xe)return function(Ye){try{(0,Oc.rR)("ui_extension_link_clicked",{pluginId:ae,extensionPointId:te.extensionPointId,title:te.title,category:te.category});const at=xe(Ye,(0,Jr.yb)(ae,ge));Nc(at)&&at.catch(Et=>{Et instanceof Error&&(0,Jr.FF)(Et.message)})}catch(at){at instanceof Error&&(0,Jr.FF)(at.message)}}}function Yu(ae,te,ge){return od.kM.appendQueryToUrl(te,od.kM.toUrlParams({uel_pid:ae,uel_epid:ge.extensionPointId}))}var wc=e(13752),Pd=e(39741),Cd=e(29405),Sd=e(96222),Ci=e(72985),Ju=e(62938);class ql{constructor(){this.resultSubject=new wc.B,this.registrySubject=new Pd.m(1),this.resultSubject.pipe((0,Cd.S)(Td,{id:"",extensions:{}}),(0,Sd.Z)({id:"",extensions:{}}),(0,Ht.T)(te=>(0,Jr.ol)(te))).subscribe(this.registrySubject)}register(te){this.resultSubject.next(te)}asObservable(){return this.registrySubject.asObservable()}getRegistry(){return(0,Ci._)(this.asObservable())}}function Td(ae,te){const{pluginId:ge,extensionConfigs:xe,error:ze}=te;if(ze)return(0,Jr.FF)(`"${ge}" plugin failed to load, skip registering its extensions.`),ae;for(const Ye of xe){const{extensionPointId:at}=Ye;if((0,Jr.WW)(Ye)){const Ut=/capabilities\/([a-zA-Z0-9_.\-\/]+)$/.exec(at);if(!Ut){(0,Jr.FF)(`"${ge}" plugin has an invalid capability ID: ${at.replace("capabilities/","")} (It must be a string)`);continue}Ye.extensionPointId=`capabilities/${Ut[1]}`}if(!Ye||!ju(ge,Ye))return ae;let Et={config:Ye,pluginId:ge};(0,Jr.WW)(Ye)?ae.extensions[at]=[Et]:Array.isArray(ae.extensions[at])?ae.extensions[at].push(Et):ae.extensions[at]=[Et]}return ae.id=(0,Ju.A)(),ae}var Zu=e(24120);function Pg(ae){const te=ae.asObservable();return function(xe){const ze=(0,Zu.A)(te);return(0,c.useMemo)(()=>{if(!ze)return{isLoading:!1,component:null};const Ye=`capabilities/${xe}`,at=ze.extensions[Ye],Et=Array.isArray(at)?at[0]:null;return Et&&(0,Jr.yS)(Et.config)?{isLoading:!1,component:(0,Jr.nv)(Et.pluginId,Et.config.component)}:{isLoading:!1,component:null}},[xe,ze])}}function Xu(ae){const te=ae.asObservable(),ge={id:"",extensions:{}};return function(ze){const Ye=(0,Zu.A)(te);if(!Ye)return{extensions:[],isLoading:!1};Ye.id!==ge.id&&(ge.id=Ye.id,ge.extensions={});const at=`${ze.extensionPointId}-${ze.limitPerPlugin}`;if(ge.extensions[at]&&ge.extensions[at].context===ze.context)return{extensions:ge.extensions[at].extensions,isLoading:!1};const{extensions:Et}=Bl({...ze,registry:Ye});return ge.extensions[at]={context:ze.context,extensions:Et},{extensions:Et,isLoading:!1}}}var Md=e(15162),Cg=e(27716),Gi=e(54427);async function ec(ae=[],te,ge="frontend_plugins_preload"){(0,Rl.j)(ge);const xe=ae.filter(Ye=>Ye.preload).map(Ye=>tc(Ye)),ze=await Promise.all(xe);for(const Ye of ze)te.register(Ye);(0,Rl.z)(ge)}async function tc(ae){const{path:te,version:ge,id:xe}=ae;try{(0,Rl.j)(`frontend_plugin_preload_${xe}`);const{plugin:ze}=await Gi.j4({path:te,version:ge,isAngular:ae.angular.detected,pluginId:xe}),{extensionConfigs:Ye=[]}=ze;return(0,Cg.x)(xe),{pluginId:xe,extensionConfigs:Ye}}catch(ze){return console.error(`[Plugins] Failed to preload plugin: ${te} (version: ${ge})`,ze),{pluginId:xe,extensionConfigs:[],error:ze}}finally{(0,Rl.z)(`frontend_plugin_preload_${xe}`)}}var Dp=e(57532),Fc=e(41987),Sg=e(65879),jo=e(39070),Tg=e(80924),Mg=e(72955),nc=e(39374);class Pp{constructor(){this.subject=new Pd.m(1)}get(){return this.subject.asObservable()}run(te){const{queries:ge,timezone:xe,datasource:ze,panelId:Ye,app:at,dashboardUID:Et,timeRange:Pt,timeInfo:Ut,cacheTimeout:qt,queryCachingTTL:Dn,maxDataPoints:xn,scopedVars:Sn,minInterval:En}=te;this.subscription&&this.subscription.unsubscribe();const Mn={app:at??Fc.Jk.Unknown,requestId:(0,Tg.S)(),timezone:xe,panelId:Ye,dashboardUID:Et,range:Pt,timeInfo:Ut,interval:"",intervalMs:0,targets:(0,g.cloneDeep)(ge),maxDataPoints:xn,scopedVars:Sn||{},cacheTimeout:qt,queryCachingTTL:Dn,startTime:Date.now()};Mn.rangeRaw=Pt.raw,(0,bi.H)(Cp(ze,Mn.scopedVars)).pipe((0,Dp.$)()).subscribe({next:Ra=>{Mn.targets=Mn.targets.map(Sr=>(Sr.datasource||(Sr.datasource=Ra.getRef()),Sr));const yr=En?(0,Ie.w)().replace(En,Mn.scopedVars):Ra.interval,gr=Sg.calculateInterval(Pt,xn,yr);Mn.scopedVars=Object.assign({},Mn.scopedVars,{__interval:{text:gr.interval,value:gr.interval},__interval_ms:{text:gr.intervalMs.toString(),value:gr.intervalMs}}),Mn.interval=gr.interval,Mn.intervalMs=gr.intervalMs,this.subscription=(0,nc.BN)(Ra,Mn).subscribe({next:Sr=>{const or=(0,xs.N$)(Sr,this.lastResult);this.lastResult=(0,Mg.B)(or,this.lastResult),this.subject.next(this.lastResult)}})},error:Ra=>console.error("PanelQueryRunner Error",Ra)})}cancel(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&this.lastResult.state===jo.Gu.Loading&&this.subject.next({...this.lastResult,state:jo.Gu.Done}))}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}}async function Cp(ae,te){return ae&&"query"in ae?ae:(0,l.tR)().get(ae,te)}function Sp(){window.grafanaRuntime={getDashboardSaveModel:()=>{const ae=(0,s.UA)().getCurrent();if(ae)return ae.getSaveModelCloneOld()},getDashboardTimeRange:()=>{const ae=(0,El.jG)().timeRange();return{from:ae.from.valueOf(),to:ae.to.valueOf(),raw:ae.raw}},getPanelData:()=>{const ae=(0,s.UA)().getCurrent();if(ae)return ae.panels.reduce((te,ge)=>(te[ge.id]=ge.getQueryRunner().getLastResult(),te),{})}}}var xg=e(16757),ac=e(20601),vs=e(75096),yl=e(71468),sc=e(22391),qu=e(27803),pi=e(3843);function xd(ae){return ae.extended&&"infoText"in ae.extended?ae.extended:null}function Od(ae){return ae.extended&&"dataSourceTypes"in ae.extended?ae.extended:null}function Id(ae){return ae.extended&&"dataSource"in ae.extended?ae.extended:null}var Cr=e(87421),sl=e(26260);const Og=(ae,te)=>{const{rootStateKey:ge}=te.variable;if(!ge)return console.error("AdHocVariableEditor: variable has no rootStateKey"),{extended:xd(pi.nS)};const{editor:xe}=(0,Cr.nx)(ge,ae);return{extended:xd(xe)}},rc={changeVariableDatasource:sl.Iv},Ad=(0,yl.connect)(Og,rc);class rl extends c.PureComponent{constructor(){super(...arguments),this.onDatasourceChanged=te=>{this.props.changeVariableDatasource((0,vs.jX)(this.props.variable),(0,sc.p$)(te))}}componentDidMount(){const{rootStateKey:te}=this.props.variable;if(!te){console.error("AdHocVariableEditor: variable has no rootStateKey");return}}render(){const{variable:te,extended:ge}=this.props;return c.createElement(qu.Q,{datasource:te.datasource??void 0,onDataSourceChange:this.onDatasourceChanged,infoText:ge?.infoText})}}const Ig=Ad(rl);var em=e(38401),tm=e(83684);const nm=90,bl=({datasource:ae,onChange:te,disabled:ge,filterKey:xe,allFilters:ze})=>{const Ye=()=>Ld(ae,xe,ze),at=()=>Ag(ae,xe,ze);return xe===null?c.createElement("div",{className:"gf-form","data-testid":"AdHocFilterKey-add-key-wrapper"},c.createElement(tm.s,{disabled:ge,className:"query-segment-key",Component:Dl,value:xe,onChange:te,loadOptions:Ye,inputMinWidth:nm})):c.createElement("div",{className:"gf-form","data-testid":"AdHocFilterKey-key-wrapper"},c.createElement(tm.s,{disabled:ge,className:"query-segment-key",value:xe,onChange:te,loadOptions:at,inputMinWidth:nm}))},Ul="-- remove filter --",Rd={label:Ul,value:Ul},Dl=c.createElement("span",{className:"gf-form-label query-part","aria-label":"Add Filter"},c.createElement(mo.I,{name:"plus"})),Ld=async(ae,te,ge)=>{const xe=await(0,l.tR)().get(ae);if(!xe||!xe.getTagKeys)return[];const ze=ge.filter(Et=>Et.key!==te),Ye=await xe.getTagKeys({filters:ze});return(Array.isArray(Ye)?Ye:Ye.data).map(Et=>({label:Et.text,value:Et.text}))},Ag=async(ae,te,ge)=>{const xe=await Ld(ae,te,ge);return[Rd,...xe]},am=({datasource:ae,disabled:te,onChange:ge,filterKey:xe,filterValue:ze,placeHolder:Ye,allFilters:at})=>{const Et=(0,fn.of)(Wc),Pt=()=>Bd(ae,xe,at);return c.createElement("div",{className:"gf-form","data-testid":"AdHocFilterValue-value-wrapper"},c.createElement(tm.s,{className:Et.segment,disabled:te,placeholder:Ye,value:ze,onChange:ge,loadOptions:Pt}))},Bd=async(ae,te,ge)=>{const xe=await(0,l.tR)().get(ae);if(!xe||!xe.getTagValues)return[];const ze=(0,El.jG)().timeRange(),Ye=ge.filter(Pt=>Pt.key!==te),at=await xe.getTagValues({key:te,filters:Ye,timeRange:ze});return(Array.isArray(at)?at:at.data).map(Pt=>({label:Pt.text,value:Pt.text}))};function Wc(){return{segment:(0,un.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"500px"})}}const Rg=["=","!=","<",">","=~","!~"].map(ae=>({label:ae,value:ae})),Ni=({value:ae,disabled:te,onChange:ge})=>c.createElement(em.Y,{className:"query-segment-operator",value:ae,disabled:te,options:Rg,onChange:ge}),oc=({datasource:ae,filter:{key:te,operator:ge,value:xe},onKeyChange:ze,onOperatorChange:Ye,onValueChange:at,placeHolder:Et,allFilters:Pt,disabled:Ut})=>c.createElement(c.Fragment,null,c.createElement(bl,{disabled:Ut,datasource:ae,filterKey:te,onChange:ze,allFilters:Pt}),c.createElement("div",{className:"gf-form"},c.createElement(Ni,{disabled:Ut,value:ge,onChange:Ye})),c.createElement(am,{disabled:Ut,datasource:ae,filterKey:te,filterValue:xe,allFilters:Pt,onChange:at,placeHolder:Et})),sm=({datasource:ae,appendBefore:te,onCompleted:ge,allFilters:xe})=>{const[ze,Ye]=(0,c.useState)(null),[at,Et]=(0,c.useState)("="),Pt=(0,c.useCallback)(Dn=>{if(Dn.value!==Ul){Ye(Dn.value??"");return}Ye(null)},[Ye]),Ut=(0,c.useCallback)(Dn=>Et(Dn.value??""),[Et]),qt=(0,c.useCallback)(Dn=>{ge({value:Dn.value??"",operator:at,key:ze}),Ye(null),Et("=")},[ge,at,ze]);return ze===null?c.createElement(bl,{datasource:ae,filterKey:ze,onChange:Pt,allFilters:xe}):c.createElement(c.Fragment,{key:"filter-builder"},te,c.createElement(oc,{datasource:ae,filter:{key:ze,value:"",operator:at},placeHolder:(0,tl.t)("variable.adhoc.placeholder","Select value"),onKeyChange:Pt,onOperatorChange:Ut,onValueChange:qt,allFilters:xe}))},ic=({label:ae})=>c.createElement("div",{className:"gf-form"},c.createElement("span",{className:"gf-form-label query-keyword"},ae));class rm extends c.PureComponent{constructor(){super(...arguments),this.onChange=(te,ge)=>xe=>{const{filters:ze}=this.props,{value:Ye}=xe;return xe.value===Ul?this.props.removeFilter(te):this.props.changeFilter(te,{...ze[te],[ge]:Ye})},this.appendFilterToVariable=te=>{this.props.addFilter(te)}}render(){const{filters:te,disabled:ge}=this.props;return c.createElement("div",{className:"gf-form-inline"},this.renderFilters(te,ge),!ge&&c.createElement(sm,{datasource:this.props.datasource,appendBefore:te.length>0?c.createElement(ic,{label:"AND"}):null,onCompleted:this.appendFilterToVariable,allFilters:this.getAllFilters()}))}getAllFilters(){return this.props.baseFilters?this.props.baseFilters.concat(this.props.filters):this.props.filters}renderFilters(te,ge){return te.length===0&&ge?c.createElement(em.Y,{disabled:ge,value:"No filters",options:[],onChange:()=>{}}):te.reduce((xe,ze,Ye)=>(xe.length>0&&xe.push(c.createElement(ic,{label:"AND",key:`condition-${Ye}`})),xe.push(this.renderFilterSegments(ze,Ye,ge)),xe),[])}renderFilterSegments(te,ge,xe){return c.createElement(c.Fragment,{key:`filter-${ge}`},c.createElement(oc,{disabled:xe,datasource:this.props.datasource,filter:te,onKeyChange:this.onChange(ge,"key"),onOperatorChange:this.onChange(ge,"operator"),onValueChange:this.onChange(ge,"value"),allFilters:this.getAllFilters()}))}}const Lg={addFilter:sl.U2,removeFilter:sl.VT,changeFilter:sl.$u},om=(0,yl.connect)(null,Lg);class Tp extends c.PureComponent{constructor(){super(...arguments),this.addFilter=te=>{this.props.addFilter((0,vs.jX)(this.props.variable),te)},this.removeFilter=te=>{this.props.removeFilter((0,vs.jX)(this.props.variable),te)},this.changeFilter=(te,ge)=>{this.props.changeFilter((0,vs.jX)(this.props.variable),{index:te,filter:ge})}}render(){const{filters:te,datasource:ge,baseFilters:xe}=this.props.variable;return c.createElement(rm,{datasource:ge,filters:te,baseFilters:xe,disabled:this.props.readOnly,addFilter:this.addFilter,removeFilter:this.removeFilter,changeFilter:this.changeFilter})}}const lc=om(Tp);lc.displayName="AdHocPicker";var Bg=e(53699);const Si=ae=>ae.map(te=>lm(te).map(im).join("|")),ji=ae=>{if((0,g.isArray)(ae))return ae.map(Nl).filter(Kc);const te=Nl(ae);return te===null?[]:[te]};function im(ae){return ae==null?"":/\|/g[Symbol.replace](ae,"__gfp__")}function Ug(ae){return ae==null?"":/__gfp__/g[Symbol.replace](ae,"|")}function lm(ae){return[ae.key,ae.operator,ae.value]}function Nl(ae){if(!(0,g.isString)(ae)||ae.length===0)return null;const te=ae.split("|").map(Ug);return{key:te[0],operator:te[1],value:te[2]}}function Kc(ae){return ae!==null&&(0,g.isString)(ae.value)}const Qi=async()=>{},$c=()=>({id:"adhoc",description:"Add key/value filters on the fly.",name:"Ad hoc filters",initialState:Bg.MK,reducer:Bg.AA,picker:lc,editor:Ig,dependsOn:()=>!1,setValue:Qi,setValueFromUrl:async(ae,te)=>{const ge=ji(te);await(0,Yr.JD)((0,sl.D4)((0,vs.jX)(ae),ge))},updateOptions:Qi,getSaveModel:ae=>{const{index:te,id:ge,state:xe,global:ze,rootStateKey:Ye,...at}=(0,g.cloneDeep)(ae);return at},getValueForUrl:ae=>{const te=ae?.filters??[];return Si(te)}});var cm=e(14644),Ng=e(8866),Bo=e(13344),bo=e(24240),cc=e(13288),dm=e(44240),dc=e(16126),wg=e(38975),hi=e(67791),Mp=e(66847),um=e(69850),go=e(72401),Fr=e(48594),wl=e(65307),po=e(12470),ni=e(83370),Pl=e(80484);const Fg={...Pl.Vg,type:"query",datasource:null,query:"",regex:"",sort:po.ZG.disabled,refresh:po.CO.onDashboardLoad,multi:!1,includeAll:!1,allValue:null,options:[],current:{},definition:""},Vc=(ae,te)=>{if(te===po.ZG.disabled)return ae;const ge=Math.ceil(te/2),xe=te%2===0;return ge===1?ae=(0,g.sortBy)(ae,"text"):ge===2?ae=(0,g.sortBy)(ae,ze=>{if(!ze.text)return-1;const Ye=ze.text.match(/.*?(\d+).*/);return!Ye||Ye.length<2?-1:parseInt(Ye[1],10)}):ge===3?ae=(0,g.sortBy)(ae,ze=>(0,g.toLower)(ze.text)):ge===4&&ae.sort((ze,Ye)=>ze.text?Ye.text?ze.text.localeCompare(Ye.text,void 0,{numeric:!0}):1:-1),xe&&(ae=ae.reverse()),ae},Wg=(ae,te)=>{const ge=[];let xe=null;te.lastIndex=0;do xe=te.exec(ae),xe&&ge.push(xe);while(te.global&&xe&&xe[0]!==""&&xe[0]!==void 0);return ge},uc=(ae,te,ge)=>{let xe,ze=[];ae&&(xe=(0,So.dO)(ae));for(let Ye=0;Ye<ge.length;Ye++){const at=ge[Ye];let Et=at.text===void 0||at.text===null?at.value:at.text,Pt=at.value===void 0||at.value===null?at.text:at.value;if((0,g.isNumber)(Pt)&&(Pt=Pt.toString()),(0,g.isNumber)(Et)&&(Et=Et.toString()),xe){const Ut=Wg(Pt,xe);if(!Ut.length)continue;const qt=Ut.find(En=>En.groups&&En.groups.value),Dn=Ut.find(En=>En.groups&&En.groups.text),xn=Ut.find(En=>En.length>1),Sn=Ut.length>1&&xn;if(qt||Dn)Pt=qt?.groups?.value??Dn?.groups?.text,Et=Dn?.groups?.text??qt?.groups?.value;else if(Sn){for(let En=0;En<Ut.length;En++){const Mn=Ut[En];ze.push({text:Mn[1],value:Mn[1],selected:!1})}continue}else xn&&(Et=xn[1],Pt=xn[1])}ze.push({text:Et,value:Pt,selected:!1})}return ze=(0,g.uniqBy)(ze,"value"),Vc(ze,te)},mm=(0,wl.Z0)({name:"templating/query",initialState:ni.j,reducers:{updateVariableOptions:(ae,te)=>{const{results:ge,templatedRegex:xe}=te.payload.data,ze=(0,Cr.Fs)(ae,te.payload.id);if(ze.type!=="query")return;const{includeAll:Ye,sort:at}=ze,Et=uc(xe,at,ge);Ye&&Et.unshift({text:Bo.Zm,value:Bo.To,selected:!1}),Et.length||Et.push({text:Bo.ou,value:Bo.Ek,isNone:!0,selected:!1}),ze.options=Et}}}),Kg=mm.reducer,{updateVariableOptions:xp}=mm.actions;function Op(){return ae=>ae.pipe((0,Ht.T)($g))}function $g(ae){const te=ae.series;if(!te||!te.length)return[];if(Ud(te))return te;const ge=(0,xs.Bt)(te),xe=[];let ze=-1,Ye=-1,at=-1,Et=-1;for(const Pt of ge)for(let Ut=0;Ut<Pt.fields.length;Ut++){const qt=Pt.fields[Ut],Dn=(0,ee.Ct)(qt,Pt,te).toLowerCase();qt.type===oe.PU.string&&at===-1&&(at=Ut),Dn==="text"&&qt.type===oe.PU.string&&Ye===-1&&(Ye=Ut),Dn==="value"&&qt.type===oe.PU.string&&ze===-1&&(ze=Ut),Dn==="expandable"&&(qt.type===oe.PU.boolean||qt.type===oe.PU.number)&&Et===-1&&(Et=Ut)}if(at===-1)throw new Error("Couldn't find any field of type string in the results.");for(const Pt of ge)for(let Ut=0;Ut<Pt.length;Ut++){const qt=Et!==-1?Pt.fields[Et].values[Ut]:void 0,Dn=Pt.fields[at].values[Ut],xn=Ye!==-1?Pt.fields[Ye].values[Ut]:null,Sn=ze!==-1?Pt.fields[ze].values[Ut]:null;if(ze===-1&&Ye===-1){xe.push({text:Dn,value:Dn,expandable:qt});continue}if(ze===-1&&Ye!==-1){xe.push({text:xn,value:xn,expandable:qt});continue}if(ze!==-1&&Ye===-1){xe.push({text:Sn,value:Sn,expandable:qt});continue}xe.push({text:xn,value:Sn,expandable:qt})}return xe}function fm(ae){return te=>te.pipe((0,Ht.T)(ge=>{const{variable:xe,dispatch:ze,getTemplatedRegexFunc:Ye}=ae;if(!xe.rootStateKey){console.error("updateOptionsState: variable.rootStateKey is not defined");return}const at=Ye(xe),Et=(0,vs.qD)(xe,{results:ge,templatedRegex:at});ze((0,Fr.kb)(xe.rootStateKey,xp(Et)))}))}function Vg(ae){return te=>te.pipe((0,Ii.Z)(()=>{const{dispatch:ge,variable:xe,searchFilter:ze}=ae;return ze?(0,ia.of)():(0,bi.H)(ge((0,go.kl)((0,vs.jX)(xe))))}))}function Ud(ae){if(!ae)return!1;if(!ae.length)return!0;const te=ae[0];if((0,xs.ci)(te))return!1;for(const ge in te){if(!te.hasOwnProperty(ge)||te[ge]!==null&&typeof te[ge]!="string"&&typeof te[ge]!="number")continue;const xe=ge.toLowerCase();if(xe==="text"||xe==="value")return!0}return!1}var mc=e(29505),fc=e(43127);class gm{constructor(){this.runners=[new zg,new pm,new Fl,new kc]}getRunnerForDatasource(te){const ge=this.runners.find(xe=>xe.canRun(te));if(ge)return ge;throw new Error("Couldn't find a query runner that matches supplied arguments.")}isQueryRunnerAvailableForDatasource(te){return this.runners.some(ge=>ge.canRun(te))}}class zg{constructor(){this.type=mc.Qz.Legacy}canRun(te){return(0,bo.d5)(te)}getTarget({datasource:te,variable:ge}){if((0,bo.d5)(te))return ge.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:te,variable:ge,searchFilter:xe,timeSrv:ze},Ye){if(!(0,bo.d5)(te))return ai();const at=(0,vs.iP)(ge,xe,ze,Ye.scopedVars);return(0,bi.H)(te.metricFindQuery(ge.query,at)).pipe((0,Ii.Z)(Et=>{if(!Et||!Et.length)return ai();const Pt=Et;return(0,ia.of)({series:Pt,state:jo.Gu.Done,timeRange:at.range})}))}}class pm{constructor(){this.type=mc.Qz.Standard}canRun(te){return(0,bo.Hf)(te)}getTarget({datasource:te,variable:ge}){if((0,bo.Hf)(te))return te.variables.toDataQuery(ge.query);throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:te,runRequest:ge},xe){return(0,bo.Hf)(te)?te.variables.query?ge(te,xe,te.variables.query.bind(te.variables)):ge(te,xe):ai()}}class Fl{constructor(){this.type=mc.Qz.Custom}canRun(te){return(0,bo.zs)(te)}getTarget({datasource:te,variable:ge}){if((0,bo.zs)(te))return ge.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:te,runRequest:ge},xe){return(0,bo.zs)(te)?ge(te,xe,te.variables.query.bind(te.variables)):ai()}}const zc="variable-query";class kc{constructor(){this.type=mc.Qz.Datasource}canRun(te){return(0,bo.X3)(te)}getTarget({datasource:te,variable:ge}){if((0,bo.X3)(te))return{...ge.query,refId:ge.query.refId??zc};throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:te,runRequest:ge},xe){return(0,bo.X3)(te)?ge(te,xe):ai()}}function ai(){return(0,ia.of)({state:jo.Gu.Done,series:[],timeRange:(0,fc.E2)()})}class hm{constructor(te={dispatch:Yr.JD,getState:Yr.Gu,getVariable:Cr.dn,getTemplatedRegex:vs.u7,getTimeSrv:El.jG,queryRunners:new gm,runRequest:nc.BN}){this.dependencies=te,this.updateOptionsRequests=new wc.B,this.updateOptionsResults=new wc.B,this.cancelRequests=new wc.B,this.onNewRequest=this.onNewRequest.bind(this),this.subscription=this.updateOptionsRequests.subscribe(this.onNewRequest)}queueRequest(te){this.updateOptionsRequests.next(te)}getResponse(te){return this.updateOptionsResults.asObservable().pipe((0,dc.p)(ge=>ge.identifier===te))}cancelRequest(te){this.cancelRequests.next({identifier:te})}destroy(){this.subscription.unsubscribe()}onNewRequest(te){const{datasource:ge,identifier:xe,searchFilter:ze}=te;try{const{dispatch:Ye,runRequest:at,getTemplatedRegex:Et,getVariable:Pt,queryRunners:Ut,getTimeSrv:qt,getState:Dn}=this.dependencies,xn=(0,Cr.y7)(Dn());this.updateOptionsResults.next({identifier:xe,state:jo.Gu.Loading});const Sn=Pt(xe,Dn());if(Sn.type!=="query")return;const En=qt(),Mn={variable:Sn,datasource:ge,searchFilter:ze,timeSrv:En,runRequest:at};if(!Ut.isQueryRunnerAvailableForDatasource(ge)){const Sr=new Error("Query Runner is not available for datasource.");this.updateOptionsResults.next({identifier:xe,state:jo.Gu.Error,error:Sr});return}const Ra=Ut.getRunnerForDatasource(ge),yr=Ra.getTarget({datasource:ge,variable:Sn}),gr=this.getRequest(Sn,te,yr);Ra.runRequest(Mn,gr).pipe((0,dc.p)(()=>{const Sr=(0,Cr.y7)(Dn());return xn===Sr}),(0,dc.p)(Sr=>Sr.state===jo.Gu.Done||Sr.state===jo.Gu.Error),(0,wg.s)(1),(0,Ii.Z)(Sr=>Sr.state===jo.Gu.Error?(0,cc.$)(()=>Sr.error):(0,ia.of)(Sr)),Op(),fm({variable:Sn,dispatch:Ye,getTemplatedRegexFunc:Et}),Vg({variable:Sn,dispatch:Ye,searchFilter:ze}),(0,hi.Q)((0,dm.h)(this.updateOptionsRequests,this.cancelRequests).pipe((0,dc.p)(Sr=>{let or=!1;return Sr.identifier.id===xe.id&&(or=!0,this.updateOptionsResults.next({identifier:xe,state:jo.Gu.Loading,cancelled:or})),or}))),(0,Mp.W)(Sr=>Sr.cancelled?(0,ia.of)({}):(this.updateOptionsResults.next({identifier:xe,state:jo.Gu.Error,error:Sr}),(0,cc.$)(()=>Sr))),(0,um.j)(()=>{this.updateOptionsResults.next({identifier:xe,state:jo.Gu.Done})})).subscribe()}catch(Ye){this.updateOptionsResults.next({identifier:xe,state:jo.Gu.Error,error:Ye})}}getRequest(te,ge,xe){const{searchFilter:ze}=ge,Ye={variable:{text:te.current.text,value:te.current.value}},Pt={...ze?{searchFilter:{text:ze,value:ze}}:{},...Ye},Ut=this.dependencies.getTimeSrv().timeRange();return{app:Fc.Jk.Dashboard,requestId:(0,Ju.A)(),timezone:"",range:Ut,interval:"",intervalMs:0,targets:[xe],scopedVars:Pt,startTime:Date.now()}}}let vm;function kg(ae){vm=ae}function Ti(){return vm}const _g=ae=>{if(!Hg(ae))return ae.name;const{current:te}=ae;return Array.isArray(te.text)?te.text.join(" + "):te.text},Hg=ae=>Array.isArray(ae?.options)||typeof ae?.current=="object";var ol=(ae=>(ae[ae.moveUp=38]="moveUp",ae[ae.moveDown=40]="moveDown",ae[ae.select=32]="select",ae[ae.cancel=27]="cancel",ae[ae.selectAndClose=13]="selectAndClose",ae))(ol||{});class Nd extends c.PureComponent{constructor(){super(...arguments),this.onKeyDown=te=>{if(ol[te.keyCode]&&te.keyCode!==ol.select){const ge=te.ctrlKey||te.metaKey||te.shiftKey;this.props.onNavigate(te.keyCode,ge),te.preventDefault()}},this.onChange=te=>{this.props.onChange(te.target.value)}}render(){const{value:te,id:ge,onNavigate:xe,...ze}=this.props;return c.createElement("input",{...ze,ref:Ye=>{Ye&&(Ye.focus(),Ye.setAttribute("style",`width:${Math.max(Ye.width,150)}px`))},id:ge,type:"text",className:"gf-form-input",value:te??"",onChange:this.onChange,onKeyDown:this.onKeyDown,placeholder:(0,tl.t)("variable.dropdown.placeholder","Enter variable value")})}}var Gg=e(89963);const jg=({loading:ae,disabled:te,onClick:ge,text:xe,onCancel:ze,id:Ye})=>{const at=(0,fn.of)(Ee),Et=(0,c.useCallback)(Pt=>{Pt.stopPropagation(),Pt.preventDefault(),ge()},[ge]);return ae?c.createElement("div",{className:at.container,"data-testid":$r.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${xe}`),title:xe,id:Ye},c.createElement(J,{text:xe}),c.createElement(Gg.I,{loading:!0,onCancel:ze})):c.createElement("button",{onClick:Et,className:at.container,"data-testid":$r.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${xe}`),"aria-expanded":!1,"aria-controls":`options-${Ye}`,id:Ye,title:xe,disabled:te},c.createElement(J,{text:xe}),c.createElement(mo.I,{"aria-hidden":!0,name:"angle-down",size:"sm"}))},J=({text:ae})=>{const te=(0,fn.of)(Ee);return c.createElement("span",{className:te.textAndTags},ae===Bo.Zm?(0,tl.t)("variable.picker.link-all","All"):ae)},Ee=ae=>({container:(0,un.css)`
    max-width: 500px;
    padding-right: 10px;
    padding: 0 ${ae.spacing(1)};
    background-color: ${ae.components.input.background};
    border: 1px solid ${ae.components.input.borderColor};
    border-radius: ${ae.shape.radius.default};
    display: flex;
    align-items: center;
    color: ${ae.colors.text};
    height: ${ae.spacing(ae.components.height.md)};

    .label-tag {
      margin: 0 5px;
    }

    &:disabled {
      background-color: ${ae.colors.action.disabledBackground};
      color: ${ae.colors.action.disabledText};
      border: 1px solid ${ae.colors.action.disabledBackground};
    }
  `,textAndTags:(0,un.css)`
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    margin-right: ${ae.spacing(.25)};
    user-select: none;
  `});var Ce=e(56034),Fe=e(3911);class He extends c.PureComponent{constructor(){super(...arguments),this.onToggle=te=>ge=>{const xe=ge.shiftKey||ge.ctrlKey||ge.metaKey;this.handleEvent(ge),this.props.onToggle(te,xe)},this.onToggleAll=te=>{this.handleEvent(te),this.props.onToggleAll()}}handleEvent(te){te.preventDefault(),te.stopPropagation()}render(){const{multi:te,values:ge,highlightIndex:xe,selectedValues:ze,onToggle:Ye,onToggleAll:at,theme:Et,...Pt}=this.props,Ut=it(Et);return c.createElement("div",{className:Ut.variableValueDropdown},c.createElement("div",{className:Ut.variableOptionsWrapper},c.createElement("ul",{className:Ut.variableOptionsColumn,"aria-label":$r.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownDropDown,...Pt},this.renderMultiToggle(),ge.map((qt,Dn)=>this.renderOption(qt,Dn)))))}renderOption(te,ge){const{highlightIndex:xe,multi:ze,theme:Ye}=this.props,at=it(Ye),Et=te.value===Bo.To;return c.createElement("li",{key:`${te.value}`},c.createElement("button",{"data-testid":$r.Tp.components.Variables.variableOption,role:"checkbox",type:"button","aria-checked":te.selected,className:(0,un.cx)((0,fe.my)(Ye),at.variableOption,{[at.highlighted]:ge===xe,[at.variableAllOption]:Et},at.noStyledButton),onClick:this.onToggle(te)},c.createElement("span",{className:(0,un.cx)(at.variableOptionIcon,{[at.variableOptionIconSelected]:te.selected,[at.hideVariableOptionIcon]:!ze})}),c.createElement("span",{"data-testid":$r.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(`${te.text}`)},Et?(0,tl.t)("variable.picker.option-all","All"):te.text)))}renderMultiToggle(){const{multi:te,selectedValues:ge,theme:xe,values:ze}=this.props,Ye=it(xe),at=ze.some(Pt=>Pt.value===Bo.To);if(!te)return null;const Et=()=>c.createElement(tl.x6,{i18nKey:"variable.picker.option-tooltip"},"Clear selections");return c.createElement(Ce.m,{content:Et,placement:"top"},c.createElement("button",{className:(0,un.cx)((0,fe.my)(xe),Ye.variableOption,Ye.variableOptionColumnHeader,Ye.noStyledButton,{[Ye.noPaddingBotton]:at}),role:"checkbox","aria-checked":ge.length>1?"mixed":"false",onClick:this.onToggleAll,"aria-label":"Toggle all values","data-placement":"top"},c.createElement("span",{className:(0,un.cx)(Ye.variableOptionIcon,{[Ye.variableOptionIconManySelected]:ge.length>1})}),c.createElement(tl.x6,{i18nKey:"variable.picker.option-selected-values"},"Selected")," (",ge.length,")"))}}const it=(0,Fe.N)(ae=>{const te=ae.isDark?"public/img/checkbox.png":"public/img/checkbox_white.png";return{hideVariableOptionIcon:(0,un.css)({display:"none"}),highlighted:(0,un.css)({backgroundColor:ae.colors.action.hover}),noStyledButton:(0,un.css)({width:"100%",textAlign:"left"}),variableOption:(0,un.css)({display:"block",padding:"2px 27px 0 8px",position:"relative",whiteSpace:"nowrap",minWidth:"115px","&:hover":{backgroundColor:ae.colors.action.hover}}),variableOptionColumnHeader:(0,un.css)({paddingTop:"5px",paddingBottom:"5px",marginBottom:"5px"}),variableOptionIcon:(0,un.css)({display:"inline-block",width:"24px",height:"18px",position:"relative",top:"4px",background:`url(${te}) left top no-repeat`}),variableOptionIconManySelected:(0,un.css)({background:`url(${te}) 0px -36px no-repeat`}),variableOptionIconSelected:(0,un.css)({background:`url(${te}) 0px -18px no-repeat`}),variableValueDropdown:(0,un.css)({backgroundColor:ae.colors.background.primary,border:`1px solid ${ae.colors.border.weak}`,borderRadius:ae.shape.borderRadius(2),boxShadow:ae.shadows.z2,position:"absolute",top:ae.spacing(ae.components.height.md),maxHeight:"400px",minHeight:"150px",minWidth:"150px",overflowY:"auto",overflowX:"hidden",zIndex:ae.zIndex.typeahead}),variableOptionsColumn:(0,un.css)({maxHeight:"350px",display:"table-cell",lineHeight:"26px",listStyleType:"none"}),variableOptionsWrapper:(0,un.css)({display:"table",width:"100%"}),variableAllOption:(0,un.css)({borderBottom:`1px solid ${ae.colors.border.weak}`,paddingBottom:ae.spacing(1)}),noPaddingBotton:(0,un.css)({paddingBottom:0})}}),vt=(0,fn.cV)(He);var Nt=e(92053),kt=e(92041),Zt=e(56968),ln=e(24300);const bn=(ae,te,ge)=>async(xe,ze)=>{if(te===ol.cancel)return await xe(Wn(ae));if(te===ol.select)return xe(oa(ae,ge));if(te===ol.selectAndClose)return(0,Cr.nx)(ae,ze()).optionsPicker.multi?xe(oa(ae,ge)):(xe(oa(ae,ge,!0)),xe(Wn(ae)));if(te===ol.moveDown)return xe((0,Fr.kb)(ae,(0,ln.O$)(1)));if(te===ol.moveUp)return xe((0,Fr.kb)(ae,(0,ln.O$)(-1)))},Nn=(ae,te="")=>async(ge,xe)=>{const{rootStateKey:ze}=ae,{id:Ye,queryValue:at}=(0,Cr.nx)(ze,xe()).optionsPicker,Et={id:Ye,rootStateKey:ze,type:"query"},Pt=(0,Cr.dn)(Et,xe());if(!("options"in Pt)||(ge((0,Fr.kb)(ze,(0,ln.S8)(te))),(0,g.trim)(at)===(0,g.trim)(te)))return;const{query:Ut,options:qt}=Pt,Dn=typeof Ut=="string"?Ut:Ut.target;return(0,Nt.E)(Dn)?Xn(ge,xe,te,ze):ge((0,Fr.kb)(ze,(0,ln.fx)(qt)))},mn=async ae=>{if((0,kt.R)(ae.current))return;await ac.B.get(ae.type).setValue(ae,ae.current,!0)},Wn=(ae,te)=>async(ge,xe)=>{const ze=(0,Cr.nx)(ae,xe()).optionsPicker,Ye={id:ze.id,rootStateKey:ae,type:"query"},at=(0,Cr.dn)(Ye,xe());if(!(0,bo.SP)(at))return;const Et={option:Gn(ze)},Pt={propName:"queryValue",propValue:ze.queryValue};ge((0,Fr.kb)(ae,(0,Zt.dE)((0,vs.qD)(at,Et)))),ge((0,Fr.kb)(ae,(0,Zt.QP)((0,vs.qD)(at,Pt))));const Ut=(0,Cr.dn)(Ye,xe());if((0,bo.SP)(Ut)&&(ge((0,Fr.kb)(ae,(0,ln.Fu)())),(0,vs.Lz)(at)!==(0,vs.Lz)(Ut)))return te?te(Ut):await mn(Ut)},ba=(ae,te)=>async(ge,xe)=>{const{id:ze,rootStateKey:Ye}=ae,at=(0,Cr.nx)(Ye,xe()).optionsPicker;at.id&&at.id!==ze&&await ge(Wn(Ye,te));const Et=(0,Cr.dn)(ae,xe());(0,bo.SP)(Et)&&ge((0,Fr.kb)(Ye,(0,ln.MO)(Et)))},oa=(ae,te,ge=!1)=>(xe,ze)=>{const{highlightIndex:Ye,options:at}=(0,Cr.nx)(ae,ze()).optionsPicker,Et=at[Ye];xe((0,Fr.kb)(ae,(0,ln.U9)({option:Et,forceSelect:ge,clearOthers:te})))},da=async(ae,te,ge,xe)=>{try{const{id:ze}=(0,Cr.nx)(xe,te()).optionsPicker,Ye={id:ze,rootStateKey:xe,type:"query"},at=(0,Cr.dn)(Ye,te());if(!(0,bo.SP)(at))return;await ac.B.get(at.type).updateOptions(at,ge);const Pt=(0,Cr.dn)(Ye,te());if(!(0,bo.SP)(Pt))return;ae((0,Fr.kb)(xe,(0,ln.qh)(Pt.options)))}catch(ze){console.error(ze)}},Xn=(0,g.debounce)(da,500);function Gn(ae){const{options:te,selectedValues:ge,queryValue:xe,multi:ze}=ae;if(te.length===0&&xe&&xe.length>0)return{text:xe,value:xe,selected:!1};if(!ze)return ge.find(Et=>Et.selected);const Ye=[],at=[];for(const Et of ge)Et.selected&&(Ye.push(Et.text.toString()),at.push(Et.value.toString()));return{value:at,text:Ye,selected:!0}}const ea=()=>{const ae=Ye=>({...(0,cm.bindActionCreators)({openOptions:ba,commitChangesToVariable:Wn,navigateOptions:bn},Ye),filterOrSearchOptions:(at,Et="")=>{Ye(Nn(at,Et))},toggleAllOptions:at=>Ye((0,Fr.kb)(at.rootStateKey,(0,ln.an)())),toggleOption:(at,Et,Pt,Ut)=>Ye((0,Fr.kb)(at.rootStateKey,(0,ln.U9)({option:Et,clearOthers:Pt,forceSelect:Ut})))}),te=(Ye,at)=>{const{rootStateKey:Et}=at.variable;return Et?{picker:(0,Cr.nx)(Et,Ye).optionsPicker}:(console.error("OptionPickerFactory: variable has no rootStateKey"),{picker:ln.$z})},ge=(0,yl.connect)(te,ae);class xe extends c.PureComponent{constructor(){super(...arguments),this.onShowOptions=()=>this.props.openOptions((0,vs.jX)(this.props.variable),this.props.onVariableChange),this.onHideOptions=()=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.commitChangesToVariable(this.props.variable.rootStateKey,this.props.onVariableChange)},this.onToggleOption=(at,Et)=>{((0,bo.iv)(this.props.variable)&&this.props.variable.multi?this.onToggleMultiValueVariable:this.onToggleSingleValueVariable)(at,Et)},this.onToggleSingleValueVariable=(at,Et)=>{this.props.toggleOption((0,vs.jX)(this.props.variable),at,Et,!1),this.onHideOptions()},this.onToggleMultiValueVariable=(at,Et)=>{this.props.toggleOption((0,vs.jX)(this.props.variable),at,Et,!1)},this.onToggleAllOptions=()=>{this.props.toggleAllOptions((0,vs.jX)(this.props.variable))},this.onFilterOrSearchOptions=at=>{this.props.filterOrSearchOptions((0,vs.jX)(this.props.variable),at)},this.onNavigate=(at,Et)=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.navigateOptions(this.props.variable.rootStateKey,at,Et)},this.onCancel=()=>{Ti().cancelRequest((0,vs.jX)(this.props.variable))}}render(){const{variable:at,picker:Et}=this.props,Pt=Et.id===at.id;return c.createElement("div",{className:"variable-link-wrapper"},Pt?this.renderOptions(Et):this.renderLink(at))}renderLink(at){const Et=_g(at),Pt=at.state===jo.Gu.Loading;return c.createElement(jg,{id:Bo.qz+at.id,text:Et,onClick:this.onShowOptions,loading:Pt,onCancel:this.onCancel,disabled:this.props.readOnly})}renderOptions(at){const{id:Et}=this.props.variable;return c.createElement(Ng.N,{onClick:this.onHideOptions},c.createElement(Nd,{id:Bo.qz+Et,value:at.queryValue,onChange:this.onFilterOrSearchOptions,onNavigate:this.onNavigate,"aria-expanded":!0,"aria-controls":`options-${Et}`}),c.createElement(vt,{values:at.options,onToggle:this.onToggleOption,onToggleAll:this.onToggleAllOptions,highlightIndex:at.highlightIndex,multi:at.multi,selectedValues:at.selectedValues,id:`options-${Et}`}))}}const ze=ge(xe);return ze.displayName="OptionsPicker",ze};var qa=e(95802);class Wa extends c.PureComponent{constructor(){super(...arguments),this.onChange=te=>{this.props.onPropChange({propName:"query",propValue:te.currentTarget.value,updateOptions:!0})}}render(){return c.createElement(qa.d,{constantValue:this.props.variable.query,onChange:this.onChange})}}const Ka={...Pl.Vg,type:"constant",hide:po.zL.hideVariable,query:"",current:{},options:[]},Ta=(0,wl.Z0)({name:"templating/constant",initialState:ni.j,reducers:{createConstantOptionsFromQuery:(ae,te)=>{const ge=(0,Cr.Fs)(ae,te.payload.id);ge.type==="constant"&&(ge.options=[{text:ge.query.trim(),value:ge.query.trim(),selected:!1}])}}}),aa=Ta.reducer,{createConstantOptionsFromQuery:Ha}=Ta.actions,Ma=ae=>async te=>{const{rootStateKey:ge}=ae;await te((0,Fr.kb)(ge,Ha((0,vs.qD)(ae)))),await te((0,go.kl)(ae))},Oa=()=>({id:"constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share.",name:"Constant",initialState:Ka,reducer:aa,picker:ea(),editor:Wa,dependsOn:()=>!1,setValue:async(ae,te,ge=!1)=>{await(0,Yr.JD)((0,go.t9)((0,vs.jX)(ae),te,ge))},setValueFromUrl:async(ae,te)=>{await(0,Yr.JD)((0,go.x7)((0,vs.jX)(ae),te))},updateOptions:async ae=>{await(0,Yr.JD)(Ma((0,vs.jX)(ae)))},getSaveModel:ae=>{const{index:te,id:ge,state:xe,global:ze,current:Ye,options:at,rootStateKey:Et,...Pt}=(0,g.cloneDeep)(ae);return Pt},getValueForUrl:ae=>ae.current.value,beforeAdding:ae=>{const{current:te,options:ge,query:xe,...ze}=(0,g.cloneDeep)(ae),Ye={selected:!0,text:xe,value:xe};return{...ze,current:Ye,options:[Ye],query:xe}}});function Hs(ae,...te){const ge=(0,yl.connect)(...te)(ae);return xe=>c.createElement(ge,{...xe,store:Yr.M_})}function ar(ae,...te){const ge=connect(...te)(ae);return xe=>React.createElement(Provider,{store},React.createElement(ge,{...xe,store}))}var er=e(58711);class As extends c.PureComponent{constructor(){super(...arguments),this.onSelectionOptionsChange=async({propName:te,propValue:ge})=>{this.props.onPropChange({propName:te,propValue:ge,updateOptions:!0})},this.onQueryChange=te=>{this.props.onPropChange({propName:"query",propValue:te.currentTarget.value,updateOptions:!0})}}render(){return c.createElement(er.w,{query:this.props.variable.query,multi:this.props.variable.multi,allValue:this.props.variable.allValue,includeAll:this.props.variable.includeAll,onQueryChange:this.onQueryChange,onMultiChange:te=>this.onSelectionOptionsChange({propName:"multi",propValue:te.currentTarget.checked}),onIncludeAllChange:te=>this.onSelectionOptionsChange({propName:"includeAll",propValue:te.currentTarget.checked}),onAllValueChange:te=>this.onSelectionOptionsChange({propName:"allValue",propValue:te.currentTarget.value})})}}const bs=(ae,te)=>({}),rs={changeVariableMultiValue:go.TI},Zs=Hs(As,bs,rs),hr={...Pl.Vg,type:"custom",multi:!1,includeAll:!1,allValue:null,query:"",options:[],current:{}},Vr=(0,wl.Z0)({name:"templating/custom",initialState:ni.j,reducers:{createCustomOptionsFromQuery:(ae,te)=>{const ge=(0,Cr.Fs)(ae,te.payload.id);if(ge.type!=="custom")return;const{includeAll:xe}=ge,at=(te.payload.data.match(/(?:\\,|[^,])+/g)??[]).map(Et=>{Et=Et.replace(/\\,/g,",");const Pt=/^(.+)\s:\s(.+)$/g.exec(Et)??[];if(Pt.length===3){const[,Ut,qt]=Pt;return{text:Ut.trim(),value:qt.trim(),selected:!1}}else return{text:Et.trim(),value:Et.trim(),selected:!1}});xe&&at.unshift({text:Bo.Zm,value:Bo.To,selected:!1}),ge.options=at}}}),gs=Vr.reducer,{createCustomOptionsFromQuery:os}=Vr.actions,Ja=ae=>async(te,ge)=>{const{rootStateKey:xe}=ae,ze=(0,Cr.dn)(ae,ge());if(ze.type!=="custom")return;const Ye=(0,Ie.w)().replace(ze.query);await te((0,Fr.kb)(xe,os((0,vs.qD)(ae,Ye)))),await te((0,go.kl)(ae))},Es=()=>({id:"custom",description:"Define variable values manually",name:"Custom",initialState:hr,reducer:gs,picker:ea(),editor:Zs,dependsOn:(ae,te)=>(0,vs.wJ)(ae.query,te.name),setValue:async(ae,te,ge=!1)=>{await(0,Yr.JD)((0,go.t9)((0,vs.jX)(ae),te,ge))},setValueFromUrl:async(ae,te)=>{await(0,Yr.JD)((0,go.x7)((0,vs.jX)(ae),te))},updateOptions:async ae=>{await(0,Yr.JD)(Ja((0,vs.jX)(ae)))},getSaveModel:ae=>{const{index:te,id:ge,state:xe,global:ze,rootStateKey:Ye,...at}=(0,g.cloneDeep)(ae);return at},getValueForUrl:ae=>(0,vs.ML)(ae)?Bo.Zm:ae.current.value});var sr=e(98917),cr=e(80147);const xr={...Pl.Vg,type:"datasource",current:{},regex:"",options:[],query:"",multi:!1,includeAll:!1,refresh:po.CO.onDashboardLoad},dr=(0,wl.Z0)({name:"templating/datasource",initialState:ni.j,reducers:{createDataSourceOptions:(ae,te)=>{const{sources:ge,regex:xe}=te.payload.data,ze=[],Ye=(0,Cr.Fs)(ae,te.payload.id);if(Ye.type==="datasource"){for(let at=0;at<ge.length;at++){const Et=ge[at];(0,cr._)(Ye.query,Et.meta)&&(Nr(Et,xe)&&ze.push({text:Et.name,value:Et.uid,selected:!1}),zr(Et,xe)&&ze.push({text:"default",value:"default",selected:!1}))}ze.length===0&&ze.push({text:"No data sources found",value:"",selected:!1}),Ye.includeAll&&ze.unshift({text:Bo.Zm,value:Bo.To,selected:!1}),Ye.options=ze}}}});function Nr(ae,te){return te?te.exec(ae.name):!0}function zr(ae,te){return ae.isDefault?te?te.exec("default"):!0:!1}const kr=dr.reducer,{createDataSourceOptions:ja}=dr.actions,Va=(ae,te={getDatasourceSrv:l.tR})=>async(ge,xe)=>{const{rootStateKey:ze}=ae,Ye=te.getDatasourceSrv().getList({metrics:!0,variables:!1}),at=(0,Cr.dn)(ae,xe());if(at.type!=="datasource")return;let Et;at.regex&&(Et=(0,Ie.w)().replace(at.regex,void 0,"regex"),Et=(0,So.dO)(Et)),ge((0,Fr.kb)(ze,ja((0,vs.qD)(ae,{sources:Ye,regex:Et})))),await ge((0,go.kl)(ae))},us=(ae,te={getDatasourceSrv:l.tR})=>ge=>{const xe=te.getDatasourceSrv().getList({metrics:!0,variables:!0}),ze=(0,g.chain)(xe).uniqBy("meta.id").map(Ye=>({text:Ye.meta.name,value:Ye.meta.id})).value();ze.unshift({text:"",value:""}),ge((0,Fr.kb)(ae,(0,pi.BC)({dataSourceTypes:ze})))},tr=(ae,te)=>{const{variable:{rootStateKey:ge}}=te;if(!ge)return console.error("DataSourceVariableEditor: variable has no rootStateKey"),{extended:Od(pi.nS)};const{editor:xe}=(0,Cr.nx)(ge,ae);return{extended:Od(xe)}},zs={initDataSourceVariableEditor:us,changeVariableMultiValue:go.TI},rr=(0,yl.connect)(tr,zs);class mr extends c.PureComponent{constructor(){super(...arguments),this.onRegExBlur=te=>{this.props.onPropChange({propName:"regex",propValue:te.currentTarget.value,updateOptions:!0})},this.onSelectionOptionsChange=async({propValue:te,propName:ge})=>{this.props.onPropChange({propName:ge,propValue:te,updateOptions:!0})},this.onMultiChanged=te=>{this.props.changeVariableMultiValue((0,vs.jX)(this.props.variable),te.currentTarget.checked)},this.onIncludeAllChanged=te=>{this.onSelectionOptionsChange({propName:"includeAll",propValue:te.currentTarget.checked})},this.onAllValueChanged=te=>{this.onSelectionOptionsChange({propName:"allValue",propValue:te.currentTarget.value})},this.getSelectedDataSourceTypeValue=()=>{const{extended:te}=this.props;if(!te?.dataSourceTypes.length)return"";const ge=te.dataSourceTypes.find(ze=>ze.value===this.props.variable.query);return(ge?ge.value:te.dataSourceTypes[0].value)??""},this.onDataSourceTypeChanged=te=>{this.props.onPropChange({propName:"query",propValue:te.value,updateOptions:!0})}}componentDidMount(){const{rootStateKey:te}=this.props.variable;if(!te){console.error("DataSourceVariableEditor: variable has no rootStateKey");return}this.props.initDataSourceVariableEditor(te)}render(){const{variable:te,extended:ge}=this.props,xe=ge?.dataSourceTypes?.length?ge.dataSourceTypes?.map(ze=>({value:ze.value??"",label:ze.text})):[];return c.createElement(sr.y,{query:te.query,regex:te.regex,multi:te.multi,includeAll:te.includeAll,optionTypes:xe,onChange:this.onDataSourceTypeChanged,onRegExBlur:this.onRegExBlur,onMultiChange:this.onMultiChanged,onIncludeAllChange:this.onIncludeAllChanged,onAllValueChange:this.onAllValueChanged})}}const ho=rr(mr),Wr=()=>({id:"datasource",description:"Enables you to dynamically switch the data source for multiple panels.",name:"Data source",initialState:xr,reducer:kr,picker:ea(),editor:ho,dependsOn:(ae,te)=>ae.regex?(0,vs.wJ)(ae.regex,te.name):!1,setValue:async(ae,te,ge=!1)=>{await(0,Yr.JD)((0,go.t9)((0,vs.jX)(ae),te,ge))},setValueFromUrl:async(ae,te)=>{await(0,Yr.JD)((0,go.x7)((0,vs.jX)(ae),te))},updateOptions:async ae=>{await(0,Yr.JD)(Va((0,vs.jX)(ae)))},getSaveModel:ae=>{const{index:te,id:ge,state:xe,global:ze,rootStateKey:Ye,...at}=(0,g.cloneDeep)(ae);return{...at,options:[]}},getValueForUrl:ae=>(0,vs.ML)(ae)?Bo.Zm:ae.current.value});var Cl=e(25304),vi=e(49317);const il=c.memo(({onPropChange:ae,variable:te})=>{const ge=at=>{ae({propName:"auto",propValue:at.target.checked,updateOptions:!0})},xe=at=>{ae({propName:"query",propValue:at.currentTarget.value,updateOptions:!0})},ze=at=>{ae({propName:"auto_count",propValue:at.value,updateOptions:!0})},Ye=at=>{ae({propName:"auto_min",propValue:at.currentTarget.value,updateOptions:!0})};return c.createElement(vi.s,{intervals:te.query,autoStepCount:te.auto_count,autoEnabled:te.auto,onAutoCountChanged:ze,onIntervalsChange:xe,onAutoEnabledChange:ge,onAutoMinIntervalChanged:Ye,autoMinInterval:te.auto_min})});il.displayName="IntervalVariableEditor";var gc=e(23989),Wl=e(81515);const Mi=ae=>async te=>{const{rootStateKey:ge}=ae;await te((0,Fr.kb)(ge,(0,Wl.mn)((0,vs.qD)(ae)))),await te(Yi(ae)),await te((0,go.kl)(ae))},Yi=(ae,te={calculateInterval:Sg.calculateInterval,getTimeSrv:El.jG,templateSrv:(0,gc.w)()})=>(ge,xe)=>{const ze=(0,Cr.dn)(ae,xe());if(ze.type==="interval"&&ze.auto){const Ye=te.calculateInterval(te.getTimeSrv().timeRange(),ze.auto_count,ze.auto_min);te.templateSrv.setGrafanaVariable("$__auto_interval_"+ze.name,Ye.interval),te.templateSrv.setGrafanaVariable("$__auto_interval",Ye.interval)}},Kl=()=>({id:"interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",name:"Interval",initialState:Wl.Ez,reducer:Wl.E5,picker:ea(),editor:il,dependsOn:()=>!1,setValue:async(ae,te,ge=!1)=>{await(0,Yr.JD)(Yi((0,vs.jX)(ae))),await(0,Yr.JD)((0,go.t9)((0,vs.jX)(ae),te,ge))},setValueFromUrl:async(ae,te)=>{await(0,Yr.JD)(Yi((0,vs.jX)(ae))),await(0,Yr.JD)((0,go.x7)((0,vs.jX)(ae),te))},updateOptions:async ae=>{await(0,Yr.JD)(Mi((0,vs.jX)(ae)))},getSaveModel:ae=>{const{index:te,id:ge,state:xe,global:ze,rootStateKey:Ye,...at}=(0,g.cloneDeep)(ae);return at},getValueForUrl:ae=>ae.current.value});var Qo=e(44890),pc=e(64423),wd=e(12091),Kp=e(70766);function $p(ae,te,ge){return{next:ze=>{if(ze.state===jo.Gu.Error){ge.unsubscribe(),te(ze.error);return}if(ze.state===jo.Gu.Done){ge.unsubscribe(),ae();return}},error:ze=>{ge.unsubscribe(),te(ze)},complete:()=>{ge.unsubscribe(),ae()}}}const ih=(ae,te)=>async(ge,xe)=>{try{const{rootStateKey:ze}=ae;if(!(0,vs.sN)(ze,xe()))return;const Ye=(0,Cr.dn)(ae,xe());if(Ye.type!=="query")return;(0,Cr.nx)(ze,xe()).editor.id===Ye.id&&ge((0,Fr.kb)(ze,(0,pi.Eo)({errorProp:"update"})));const at=await(0,N.l)().get(Ye.datasource??"");await new Promise((Et,Pt)=>{const Ut=new pc.yU,qt=$p(Et,Pt,Ut),Dn=Ti().getResponse(ae).subscribe(qt);Ut.add(Dn),Ti().queueRequest({identifier:ae,datasource:at,searchFilter:te})})}catch(ze){if(ze instanceof Error){const Ye=(0,wd.u)(ze),{rootStateKey:at}=ae;throw(0,Cr.nx)(at,xe()).editor.id===ae.id&&ge((0,Fr.kb)(at,(0,pi.NY)({errorProp:"update",errorText:Ye.message}))),Ye}}},lh=ae=>async(te,ge)=>{const xe=(0,Cr.dn)(ae,ge());xe.type==="query"&&await te(Qg((0,vs.jX)(xe),xe.datasource))},Qg=(ae,te)=>async(ge,xe)=>{try{const{rootStateKey:ze}=ae,{editor:Ye}=(0,Cr.nx)(ze,xe()),Et=Id(Ye)?.dataSource,Pt=await(0,N.l)().get(te??"");Et&&Et.type!==Pt?.type&&ge((0,Fr.kb)(ze,(0,Zt.QP)((0,vs.qD)(ae,{propName:"query",propValue:""}))));const Ut=await(0,Kp.y)(Pt);ge((0,Fr.kb)(ze,(0,pi.BC)({dataSource:Pt,VariableQueryEditor:Ut})))}catch(ze){console.error(ze)}},Vp=(ae,te,ge)=>async(xe,ze)=>{const{rootStateKey:Ye}=ae,at=(0,Cr.dn)(ae,ze());if(at.type==="query"){if(zp(at.name,te)){const Et="Query cannot contain a reference to itself. Variable: $"+at.name;xe((0,Fr.kb)(Ye,(0,pi.NY)({errorProp:"query",errorText:Et})));return}xe((0,Fr.kb)(Ye,(0,pi.Eo)({errorProp:"query"}))),xe((0,Fr.kb)(Ye,(0,Zt.QP)((0,vs.qD)(ae,{propName:"query",propValue:te})))),ge!==void 0?xe((0,Fr.kb)(Ye,(0,Zt.QP)((0,vs.qD)(ae,{propName:"definition",propValue:ge})))):typeof te=="string"&&xe((0,Fr.kb)(Ye,(0,Zt.QP)((0,vs.qD)(ae,{propName:"definition",propValue:te})))),await xe((0,go.mZ)(ae))}};function zp(ae,te){if(typeof te=="string"&&te.match(new RegExp("\\$"+ae+"(/| |$)")))return!0;const ge=Ip(te);for(let xe in ge)if(ge.hasOwnProperty(xe)){const ze=ge[xe];if(typeof ze=="string"&&ze.match(new RegExp("\\$"+ae+"(/| |$)")))return!0}return!1}function Ip(ae){return typeof ae!="object"||ae===null?{query:ae}:Object.keys(ae).reduce((xe,ze)=>{const Ye=ae[ze];if(typeof Ye!="object"||Ye===null)return xe[ze]=Ye,xe;const at=Ip(Ye);for(let Et in at)at.hasOwnProperty(Et)&&(xe[`${ze}_${Et}`]=at[Et]);return xe},{})}const Ap=(ae,te)=>{const{rootStateKey:ge}=te.variable;if(!ge)return console.error("QueryVariableEditor: variable has no rootStateKey"),{extended:Id(pi.nS)};const{editor:xe}=(0,Cr.nx)(ge,ae);return{extended:Id(xe)}},kp={initQueryVariableEditor:lh,changeQueryVariableDataSource:Qg,changeQueryVariableQuery:Vp,changeVariableMultiValue:go.TI},_p=(0,yl.connect)(Ap,kp);class Rp extends c.PureComponent{constructor(){super(...arguments),this.state={regex:null,tagsQuery:null,tagValuesQuery:null},this.onDataSourceChange=te=>{this.props.onPropChange({propName:"datasource",propValue:te.isDefault?null:(0,sc.p$)(te)})},this.onLegacyQueryChange=async(te,ge)=>{this.props.variable.query!==te&&this.props.changeQueryVariableQuery((0,vs.jX)(this.props.variable),te,ge)},this.onQueryChange=async te=>{if(this.props.variable.query!==te){let ge="";te&&te.hasOwnProperty("query")&&typeof te.query=="string"&&(ge=te.query),this.props.changeQueryVariableQuery((0,vs.jX)(this.props.variable),te,ge)}},this.onRegExBlur=async te=>{const ge=te.currentTarget.value;this.props.variable.regex!==ge&&this.props.onPropChange({propName:"regex",propValue:ge,updateOptions:!0})},this.onRefreshChange=te=>{this.props.onPropChange({propName:"refresh",propValue:te})},this.onSortChange=async te=>{this.props.onPropChange({propName:"sort",propValue:te.value,updateOptions:!0})},this.onMultiChange=te=>{this.props.onPropChange({propName:"multi",propValue:te.currentTarget.checked})},this.onIncludeAllChange=te=>{this.props.onPropChange({propName:"includeAll",propValue:te.currentTarget.checked})},this.onAllValueChange=te=>{this.props.onPropChange({propName:"allValue",propValue:te.currentTarget.value})}}async componentDidMount(){await this.props.initQueryVariableEditor((0,vs.jX)(this.props.variable))}componentDidUpdate(te){te.variable.datasource!==this.props.variable.datasource&&this.props.changeQueryVariableDataSource((0,vs.jX)(this.props.variable),this.props.variable.datasource)}render(){const{extended:te,variable:ge}=this.props;if(!te||!te.dataSource)return null;const xe=(0,El.jG)().timeRange();return c.createElement(Qo.u,{datasource:ge.datasource??void 0,onDataSourceChange:this.onDataSourceChange,query:ge.query,onQueryChange:this.onQueryChange,onLegacyQueryChange:this.onLegacyQueryChange,timeRange:xe,regex:ge.regex,onRegExChange:this.onRegExBlur,sort:ge.sort,onSortChange:this.onSortChange,refresh:ge.refresh,onRefreshChange:this.onRefreshChange,isMulti:ge.multi,includeAll:ge.includeAll,allValue:ge.allValue??"",onMultiChange:this.onMultiChange,onIncludeAllChange:this.onIncludeAllChange,onAllValueChange:this.onAllValueChange})}}const Hp=_p(Rp),Gp=()=>({id:"query",description:"Variable values are fetched from a datasource query",name:"Query",initialState:Fg,reducer:Kg,picker:ea(),editor:Hp,dependsOn:(ae,te)=>(0,vs.wJ)(ae.query,ae.datasource?.uid,ae.regex,te.name),setValue:async(ae,te,ge=!1)=>{await(0,Yr.JD)((0,go.t9)((0,vs.jX)(ae),te,ge))},setValueFromUrl:async(ae,te)=>{await(0,Yr.JD)((0,go.x7)((0,vs.jX)(ae),te))},updateOptions:async(ae,te)=>{await(0,Yr.JD)(ih((0,vs.jX)(ae),te))},getSaveModel:ae=>{const{index:te,id:ge,state:xe,global:ze,queryValue:Ye,rootStateKey:at,...Et}=(0,g.cloneDeep)(ae);return ae.refresh!==po.CO.never?{...Et,options:[]}:Et},getValueForUrl:ae=>(0,vs.ML)(ae)?Bo.Zm:ae.current.value}),jp=()=>({id:"system",description:"",name:"system",initialState:{...Pl.Vg,type:"system",hide:po.zL.hideVariable,skipUrlSync:!0,current:{value:{toString:()=>""}},state:jo.Gu.Done},reducer:ae=>ae,picker:null,editor:null,dependsOn:()=>!1,setValue:async(ae,te,ge=!1)=>{},setValueFromUrl:async(ae,te)=>{},updateOptions:async ae=>{},getSaveModel:ae=>({}),getValueForUrl:ae=>""});var Qp=e(58975),ch=e(14329);function dh({onPropChange:ae,variable:{query:te}}){const ge=(0,c.useCallback)((Ye,at)=>{Ye.preventDefault(),ae({propName:"originalQuery",propValue:Ye.currentTarget.value,updateOptions:!1}),ae({propName:"query",propValue:Ye.currentTarget.value,updateOptions:at})},[ae]),xe=(0,c.useCallback)(Ye=>ge(Ye,!1),[ge]),ze=(0,c.useCallback)(Ye=>ge(Ye,!0),[ge]);return c.createElement(c.Fragment,null,c.createElement(Qp.Y,null,"Text options"),c.createElement(ch._,{value:te,name:"Default value",placeholder:"default value, if any",onChange:xe,onBlur:ze,width:30,testId:$r.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2}))}function Yp({variable:ae,onVariableChange:te,readOnly:ge}){const xe=(0,Uc.useDispatch)(),[ze,Ye]=(0,c.useState)(ae.current.value);(0,c.useEffect)(()=>{Ye(ae.current.value)},[ae]);const at=(0,c.useCallback)(()=>{if(!ae.rootStateKey){console.error("Cannot update variable without rootStateKey");return}if(ae.current.value!==ze){if(xe((0,Fr.kb)(ae.rootStateKey,(0,Zt.QP)((0,vs.qD)({id:ae.id,type:ae.type},{propName:"query",propValue:ze})))),te){te({...ae,current:(0,kt.R)(ae.current)?{}:{...ae.current,value:ze}});return}ac.B.get(ae.type).updateOptions(ae)}},[ae,ze,xe,te]),Et=(0,c.useCallback)(qt=>Ye(qt.target.value),[Ye]),Pt=qt=>at(),Ut=qt=>{qt.keyCode===13&&(qt.preventDefault(),at())};return c.createElement(Oe.p,{type:"text",value:ze,onChange:Et,onBlur:Pt,disabled:ge,onKeyDown:Ut,placeholder:(0,tl.t)("variable.textbox.placeholder","Enter variable value"),id:Bo.qz+ae.id})}const Jp={...Pl.Vg,type:"textbox",query:"",current:{},options:[],originalQuery:null},Lp=(0,wl.Z0)({name:"templating/textbox",initialState:ni.j,reducers:{createTextBoxOptions:(ae,te)=>{const ge=(0,Cr.Fs)(ae,te.payload.id);if(ge.type!=="textbox")return;const xe={text:ge.query.trim(),value:ge.query.trim(),selected:!1};ge.options=[xe],ge.current=xe}}}),Zp=Lp.reducer,{createTextBoxOptions:Xp}=Lp.actions,Yg=ae=>async(te,ge)=>{const{rootStateKey:xe,type:ze}=ae;te((0,Fr.kb)(xe,Xp((0,vs.qD)(ae))));const Ye=(0,Cr.dn)(ae,ge());Ye.type==="textbox"&&await ac.B.get(ze).setValue(Ye,Ye.options[0],!0)},Jg=(ae,te)=>async(ge,xe)=>{const{rootStateKey:ze}=ae,Ye=(0,Cr.dn)(ae,xe());if(Ye.type!=="textbox")return;const at=(0,vs.QT)(te);ge((0,Fr.kb)(ze,(0,Zt.QP)((0,vs.qD)(Ye,{propName:"query",propValue:at})))),await ge((0,go.x7)((0,vs.jX)(Ye),at))},Bp=()=>({id:"textbox",description:"Define a textbox variable, where users can enter any arbitrary string",name:"Text box",initialState:Jp,reducer:Zp,picker:Yp,editor:dh,dependsOn:(ae,te)=>!1,setValue:async(ae,te,ge=!1)=>{await(0,Yr.JD)((0,go.t9)((0,vs.jX)(ae),te,ge))},setValueFromUrl:async(ae,te)=>{await(0,Yr.JD)(Jg((0,vs.jX)(ae),te))},updateOptions:async ae=>{await(0,Yr.JD)(Yg((0,vs.jX)(ae)))},getSaveModel:(ae,te)=>{const{index:ge,id:xe,state:ze,global:Ye,originalQuery:at,rootStateKey:Et,...Pt}=(0,g.cloneDeep)(ae);if(ae.query!==at&&!te){const Ut=at??"",qt={selected:!1,text:Ut,value:Ut};return{...Pt,query:Ut,current:qt,options:[qt]}}return Pt},getValueForUrl:ae=>ae.current.value,beforeAdding:ae=>({...(0,g.cloneDeep)(ae),originalQuery:ae.query})});var qp=e(2272);P().move=j.b;const Up=e(39572),Fd=Up.keys().map(ae=>Up(ae));class eh{async init(){try{parent.postMessage("GrafanaAppInit","*");const te=(0,tl.JL)(G.Ay.bootData.user.language);te.then(({language:Ut})=>(0,G._R)({language:Ut})),(0,M.u5)(id.IB),nh(),wu(),(0,Rl.j)("frontend_app_init"),G.Ay.featureToggles.betterPageScrolling||ah(),(0,p.xS)(G.Ay.bootData.user.locale),(0,p.$D)(G.Ay.bootData.user.weekStart),(0,V.Y)(vg.m),(0,_.l)(Hc),(0,W.e)(hg.a),(0,A.T)(x.Ny),(0,C.p)(ig),(0,v.G)(()=>G.Ay.bootData.user.timezone),pg(),(0,og.initAuthConfig)(),(0,O.H8)(li.A),await te,th(),(0,qp.U1)(),Np(),rg(),D.D.setInit(zd.H),D.G.setInit(zd.u),E.h.setInit(Dm),ac.B.setInit(()=>[Gp(),Es(),Bp(),Oa(),Wr(),Kl(),$c(),jp()]),S.l.setInit(Vd),zf(),(0,R.HC)(()=>new Pp),kg(new hm),(0,R.pC)(nc.BN),(0,L.se)({importPanelPlugin:Md.TV,getPanelPluginFromCache:Md.PY}),T.I.initialize({config:G.Ay,getTimeRangeForUrl:(0,El.jG)().timeRangeForUrl,getVariablesUrlParams:Cl.z}),document.addEventListener("click",kf);const ge=new l.xq;ge.init(G.Ay.datasources,G.Ay.defaultDatasource),(0,N.h)(ge),Sp();const xe=new ql;if(xe.register({pluginId:"grafana",extensionConfigs:fp()}),nl.TP.user.orgRole!==""){const Ut=["cloud-home-app"],qt=Object.values(G.Ay.apps).filter(xn=>Ut.includes(xn.id)),Dn=Object.values(G.Ay.apps).filter(xn=>!Ut.includes(xn.id));ec(Dn,xe),await ec(qt,xe,"frontend_awaited_plugins_preload")}(0,F.cE)(Ui(xe)),(0,K.Vu)(Xu(xe)),(0,B.A)(Pg(xe));const ze=x.Ny.getSearchObject(),Ye=new Sm.dk,at=new gd(x.Ny,Ye),Et=new Hf;Et.start(),Ye.setKioskModeFromUrl(ze.kiosk);try{(0,xg.W1)()}catch(Ut){console.warn("Failed to clean up old expanded folders",Ut)}this.context={backend:id.IB,location:x.Ny,chrome:Ye,keybindings:at,newAssetsChecker:Et,config:G.Ay},(0,w._)(fl.ni),(0,y.H)(document.getElementById("reactRoot")).render(c.createElement(Cm.Nz,{app:this}))}catch(te){console.error("Failed to start Grafana",te),window.__grafana_load_failed()}finally{(0,Rl.z)("frontend_app_init")}}}function th(){Fd.length>0&&Fd[0].addExtensionReducers()}function Np(){Fd.length>0&&Fd[0].init()}function nh(){(0,U.H2)(new jf({debug:!1})),window.addEventListener("load",ae=>{const te="frontend_boot_load_time_seconds";performance&&(performance.mark(te),Em("first-paint","frontend_boot_","_time_seconds"),Em("first-contentful-paint","frontend_boot_","_time_seconds"),Em(te),Em("frontend_boot_js_done_time_seconds"),Em("frontend_boot_css_time_seconds"))}),nl.TP.user.orgRole!==""&&(0,U.pl)(new Wu({})),G.Ay.grafanaJavascriptAgent.enabled&&(0,U.pl)(new Xf({...G.Ay.grafanaJavascriptAgent,app:{version:G.Ay.buildInfo.version,environment:G.Ay.buildInfo.env},buildInfo:G.Ay.buildInfo,user:{id:String(G.Ay.bootData.user?.id),email:G.Ay.bootData.user?.email}})),G.Ay.googleAnalyticsId&&(0,U.pl)(new dd({googleAnalyticsId:G.Ay.googleAnalyticsId})),G.Ay.googleAnalytics4Id&&(0,U.pl)(new Al({googleAnalyticsId:G.Ay.googleAnalytics4Id,googleAnalytics4SendManualPageViews:G.Ay.googleAnalytics4SendManualPageViews})),G.Ay.rudderstackWriteKey&&G.Ay.rudderstackDataPlaneUrl&&(0,U.pl)(new Qf({writeKey:G.Ay.rudderstackWriteKey,dataPlaneUrl:G.Ay.rudderstackDataPlaneUrl,user:G.Ay.bootData.user,sdkUrl:G.Ay.rudderstackSdkUrl,configUrl:G.Ay.rudderstackConfigUrl,integrationsUrl:G.Ay.rudderstackIntegrationsUrl,buildInfo:G.Ay.buildInfo})),G.Ay.applicationInsightsConnectionString&&(0,U.pl)(new vl({connectionString:G.Ay.applicationInsightsConnectionString,endpointUrl:G.Ay.applicationInsightsEndpointUrl}))}function ah(){(0,H.X)()>0&&document.body.classList.add("no-overlay-scrollbar")}function Em(ae,te="",ge=""){const xe=P().first(performance.getEntriesByName(ae));if(xe){const ze=xe.name.replace(/-/g,"_");(0,Ac.n)(`${te}${ze}${ge}`,Math.round(xe.startTime)/1e3)}}const sh=new eh;window.public_cdn_path&&(e.p=window.public_cdn_path),window.__grafana_public_path__=e.p.substring(0,e.p.lastIndexOf("build/"))||e.p,window.nonce&&(e.nc=window.nonce),window.__grafana_app_bundle_loaded=!0,sh.init()},60021:(Q,I,e)=>{"use strict";e.d(I,{Or:()=>a,Oz:()=>i,RC:()=>n,ho:()=>o,nA:()=>r});var n=(f=>(f.Active="active",f.Expired="expired",f.Pending="pending",f))(n||{}),a=(f=>(f.Unprocessed="unprocessed",f.Active="active",f.Suppressed="suppressed",f))(a||{}),o=(f=>(f.equal="=",f.notEqual="!=",f.regex="=~",f.notRegex="!~",f))(o||{}),r=(f=>(f.Internal="internal",f.External="external",f.All="all",f))(r||{}),i=(f=>(f.cortex="cortex",f.mimir="mimir",f.prometheus="prometheus",f))(i||{})},91621:(Q,I,e)=>{"use strict";e.d(I,{Dw:()=>f,Rx:()=>o,_W:()=>i,d$:()=>a});const n={statistics:[]};var a=(l=>(l[l.Query=1]="Query",l[l.Search=0]="Search",l))(a||{}),o=(l=>(l[l.Builder=0]="Builder",l[l.Code=1]="Code",l))(o||{});const r={parameters:[]};var i=(l=>(l.And="and",l.Function="function",l.FunctionParameter="functionParameter",l.GroupBy="groupBy",l.Operator="operator",l.Or="or",l.Property="property",l))(i||{}),f=(l=>(l.String="string",l))(f||{});const d={logGroupNames:[],logGroups:[],statsGroups:[]}},25640:(Q,I,e)=>{"use strict";e.d(I,{Rx:()=>n.Rx,YZ:()=>a,b4:()=>o,d$:()=>n.d$});var n=e(91621),a=(r=>(r.Scheduled="Scheduled",r.Running="Running",r.Complete="Complete",r.Failed="Failed",r.Cancelled="Cancelled",r.Timeout="Timeout",r))(a||{}),o=(r=>(r.Regions="regions",r.Namespaces="namespaces",r.Metrics="metrics",r.DimensionKeys="dimensionKeys",r.DimensionValues="dimensionValues",r.EBSVolumeIDs="ebsVolumeIDs",r.EC2InstanceAttributes="ec2InstanceAttributes",r.ResourceArns="resourceARNs",r.Statistics="statistics",r.LogGroups="logGroups",r.Accounts="accounts",r))(o||{})},36666:(Q,I,e)=>{"use strict";e.d(I,{A:()=>A});var n=e(32196),a=e(92145),o=e(55127),r=e.n(o),i=e(96540),f=e(16817),d=e(52622),l=e(21103),m=e(40845),s=e(67061),h=e(88575),u=e(21594),b=e(94354),g=e(15292),P=e(62930),c=e(2913),y=e(14792),p=e(24283),v=e(31193),D=e(65160),E=e(45994);function S(C){return JSON.stringify(C)}function T(C,O){let R=O;return window.__grafanaSceneContext&&window.__grafanaSceneContext instanceof p.H$&&(R=window.__grafanaSceneContext.state.editPanel?.state.panelId),C===R}const M=[{label:"All data",value:!1},{label:"Annotations",value:!0,description:"Include annotations as regular data"}];function A({data:C,query:O,onChange:R,onRunQuery:L}){const{value:N}=(0,f.A)(()=>(0,v.tR)().get()),F=(0,i.useMemo)(()=>(0,y.UA)().getCurrent()?.getPanelById(O.panelId??-124134),[O.panelId]),{value:K,loading:B}=(0,f.A)(async()=>{if(!F||!C)return[];const ne=await(0,v.tR)().get(F.datasource);return Promise.all(F.targets.map(async ee=>{const Z=ee.datasource?await(0,v.tR)().get(ee.datasource):ne,z=Z.getQueryDisplayText||S,q=(0,D.E)(C,ee.refId)??C;return{refId:ee.refId,query:z(ee),name:Z.name,img:Z.meta.info.logos.small,data:q.series,error:q.error}}))},[C,F]),w=(0,i.useCallback)(ne=>{R(ne),L()},[R,L]),U=(0,i.useCallback)(ne=>{w({...O,panelId:ne})},[O,w]),W=(0,i.useCallback)(()=>{w({...O,withTransforms:!O.withTransforms})},[O,w]),V=(0,i.useCallback)(ne=>{w({...O,topic:ne?d.QR.Annotations:void 0})},[O,w]),_=(0,i.useCallback)(ne=>{const ee=ne.datasource??N,Z=(0,v.tR)().getInstanceSettings(ee)?.name,z=ne.targets.length;return`${z} ${r()("query",z)} to ${Z}`},[N]),H=(0,y.UA)().getCurrent(),G=!!(O.withTransforms||F?.transformations?.length),j=(0,i.useMemo)(()=>H?.panels.filter(ne=>c.Ay.panels[ne.type]&&ne.targets&&!T(ne.id,H.panelInEdit?.id)&&ne.datasource?.uid!==E.K).map(ne=>({value:ne.id,label:ne.title??"Panel "+ne.id,description:_(ne),imgUrl:c.Ay.panels[ne.type].info.logos.small}))??[],[H,_]),Y=(0,m.of)(x),oe=(0,a.Bi)();if(!H)return null;if(j.length<1)return i.createElement("p",{className:Y.noQueriesText},"This dashboard does not have any other panels. Add queries to other panels and try again.");const se=j.find(ne=>ne.value===O.panelId);return i.createElement(l.i,null,i.createElement(s.B,{direction:"column"},i.createElement(s.B,{gap:3},i.createElement(h.D,{label:"Source panel",description:"Use query results from another panel"},i.createElement(u.l6,{inputId:oe,placeholder:"Choose panel",isSearchable:!0,options:j,value:se,onChange:ne=>U(ne.value)})),i.createElement(h.D,{label:"Data",description:"Use data or annotations from the panel"},i.createElement(b.z,{options:M,value:O.topic===d.QR.Annotations,onChange:V})),G&&i.createElement(h.D,{label:"Transform",description:"Apply transformations from the source panel"},i.createElement(g.K,{value:!!O.withTransforms,onChange:W}))),B?i.createElement(P.y,null):i.createElement(i.Fragment,null,K&&!!K.length&&i.createElement(h.D,{label:"Queries from panel"},i.createElement(s.B,{direction:"column"},K.map((ne,ee)=>i.createElement(s.B,{key:ee,alignItems:"center",gap:1},i.createElement("div",null,ne.refId),i.createElement("img",{src:ne.img,alt:ne.name,title:ne.name,width:16}),i.createElement("div",null,ne.query))))))))}function x(C){return{noQueriesText:(0,n.css)({padding:C.spacing(1.25)})}}},14348:(Q,I,e)=>{"use strict";e.d(I,{K:()=>d.K,kN:()=>l,mw:()=>m});var n=e(88483),a=e(52622),o=e(39070),r=e(43127),i=e(14792),f=e(34214),d=e(45994);function l(b){return b?typeof b=="string"?b===d.K:"meta"in b&&b.meta.name===d.K||b.uid===d.K:!1}function m(b,g){return new n.c(P=>{const c=(0,i.UA)().getCurrent(),y=s(b.queries);if(!y){P.next(h("Missing panel reference ID"));return}let p=c?.getPanelById(y,!0);if(p instanceof f.a||(p=new f.a(p)),!p){P.next(h("Unknown Panel: "+y));return}const v=p.getQueryRunner(),D=v.getData({withTransforms:!!g?.withTransforms,withFieldConfig:!1}).subscribe({next:E=>{g?.topic===a.QR.Annotations&&(E={...E,series:E.annotations??[],annotations:void 0}),P.next(E)}});if(!p.isInView&&p.refreshWhenInView||c?.otherPanelInFullscreen(p)){const{datasource:E,targets:S}=p,T={...b,datasource:E,panelId:y,queries:S};p.refreshWhenInView=!1,v.run(T)}return()=>{D.unsubscribe()}})}function s(b){if(!(!b||!b.length))return b[0].panelId}function h(b){return{state:o.Gu.Error,series:[],request:{},error:{message:b},timeRange:(0,r.E2)()}}var u=e(36666)},45994:(Q,I,e)=>{"use strict";e.d(I,{K:()=>n});const n="-- Dashboard --",a="dashboard"},90183:(Q,I,e)=>{"use strict";e.d(I,{i:()=>pe,o:()=>ye});var n=e(2543),a=e(65474),o=e(62467),r=e(44240),i=e(81160),f=e(89667),d=e(39070),l=e(55004),m=e(37471),s=e(78368),h=e(14236),u=e(26657),b=e(72574),g=e(78731),P=e(17172),c=e(19347),y=e(79056),p=e(14792),v=e(32196),D=e(96540),E=e(40845),S=e(84167),T=e(88575),M=e(21594),A=e(15292),x=e(99818),C=e(10154),O=e(68706),R=e(95093),L=e.n(R),N=e(91410),F=e(20333),K=e(55852),B=e(67061),w=e(17624),U=e(67459),W=e(57389),V=e(14578),_=e(87266),H=e(16797);const G="time-of-day-picker-panel",j=({minuteStep:Pe=1,showHour:Ie=!0,showSeconds:Oe=!1,onChange:Ne,value:We,size:Ae="auto",disabled:Ue,disabledHours:Me,disabledMinutes:$e,disabledSeconds:ke,placeholder:Ze,format:ot="HH:mm",defaultValue:xt=void 0,allowEmpty:ct=!1,width:ft})=>{const Le=(0,E.of)(oe),re=()=>ft?(0,v.css)`
        width: ${ft}px;
      `:(0,_.lH)()[Ae];return D.createElement(W.A,{value:We,defaultValue:xt,onChange:X=>Ne(X),showHour:Ie,showSecond:Oe,format:ot,allowEmpty:ct,className:(0,v.cx)(re(),Le.input),popupClassName:(0,v.cx)(Le.picker,G),minuteStep:Pe,inputIcon:D.createElement(Y,{wrapperStyle:Le.caretWrapper}),disabled:Ue,disabledHours:Me,disabledMinutes:$e,disabledSeconds:ke,placeholder:Ze})},Y=({wrapperStyle:Pe=""})=>D.createElement("div",{className:Pe},D.createElement(V.I,{name:"angle-down"})),oe=Pe=>{const Ie=Pe.components.input.background,Oe=Pe.v1.palette.black,Ne=Pe.colors.background.secondary,We=Pe.shape.radius.default,Ae=Pe.components.input.borderColor;return{caretWrapper:(0,v.css)`
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      display: inline-block;
      text-align: right;
      color: ${Pe.colors.text.secondary};
    `,picker:(0,v.css)`
      .rc-time-picker-panel-select {
        font-size: 14px;
        background-color: ${Ie};
        border-color: ${Ae};
        li {
          outline-width: 2px;
          &.rc-time-picker-panel-select-option-selected {
            background-color: inherit;
            border: 1px solid ${Pe.v1.palette.orange};
            border-radius: ${We};
          }

          &:hover {
            background: ${Ne};
          }

          &.rc-time-picker-panel-select-option-disabled {
            color: ${Pe.colors.action.disabledText};
          }
        }
      }

      .rc-time-picker-panel-inner {
        box-shadow: 0px 4px 4px ${Oe};
        background-color: ${Ie};
        border-color: ${Ae};
        border-radius: ${We};
        margin-top: 3px;

        .rc-time-picker-panel-input-wrap {
          margin-right: 2px;

          &,
          .rc-time-picker-panel-input {
            background-color: ${Ie};
            padding-top: 2px;
          }
        }

        .rc-time-picker-panel-combobox {
          display: flex;
        }
      }
    `,input:(0,v.css)`
      .rc-time-picker-input {
        background-color: ${Ie};
        border-radius: ${We};
        border-color: ${Ae};
        height: ${Pe.spacing(4)};

        &:focus {
          ${(0,H.focusCss)(Pe)}
        }

        &:disabled {
          background-color: ${Pe.colors.action.disabledBackground};
          color: ${Pe.colors.action.disabledText};
          border: 1px solid ${Pe.colors.action.disabledBackground};
          &:focus {
            box-shadow: none;
          }
        }
      }

      .rc-time-picker-clear {
        position: absolute;
        right: 20px;
        top: 50%;
        cursor: pointer;
        overflow: hidden;
        transform: translateY(-50%);
        color: ${Pe.colors.text.secondary};
      }
    `}},se=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map((Pe,Ie)=>({label:Pe,value:Ie+1})),ne=({value:Pe,onChange:Ie})=>{const Oe=(0,E.of)(ee),Ne=Date.now(),We=(0,N.QZ)(Pe.timezone??"utc",Ne),Ae=(0,p.UA)().getCurrent()?.getTimezone()===Pe.timezone,[Ue,Me]=(0,D.useState)(!1),$e=()=>{Me(!Ue)},ke=X=>{if(!X)return;const le=L()();if(X){const be=X.split(":");le.set("hour",parseInt(be[0],10)),le.set("minute",parseInt(be[1],10))}return le},Ze=()=>{let X="Everyday";return Pe.fromDayOfWeek&&!Pe.toDayOfWeek&&(X=se[Pe.fromDayOfWeek-1].label),X},ot=()=>{const X=D.createElement(D.Fragment,null,D.createElement(U.U,{title:We?.name}),D.createElement(w.X,{timeZone:Pe.timezone,timestamp:Ne}));return Ae?D.createElement(D.Fragment,null,"Dashboard timezone (",X,")"):X},xt=(X,le)=>{const be=X?X.format("HH:mm"):void 0;Ie(le==="from"?{...Pe,from:be}:{...Pe,to:be})},ct=X=>{Ie({...Pe,timezone:X})},ft=X=>{const le=X?X.value:void 0,be=X?Pe.toDayOfWeek:void 0;Ie({...Pe,fromDayOfWeek:le,toDayOfWeek:be})},Le=X=>{Ie({...Pe,toDayOfWeek:X?X.value:void 0})},re=()=>Ue?D.createElement(F.U,{value:Pe.timezone,includeInternal:!0,onChange:X=>ct(X),onBlur:()=>Me(!1),openMenuOnFocus:!1,width:100,autoFocus:!0}):D.createElement("div",{className:Oe.timezoneContainer},D.createElement("div",{className:Oe.timezone},ot()),D.createElement(K.$n,{variant:"secondary",onClick:$e,size:"sm"},"Change timezone"));return D.createElement(S.n,{className:Oe.wrapper},D.createElement(T.D,{label:"From"},D.createElement(B.B,{gap:.5},D.createElement(M.l6,{options:se,isClearable:!0,placeholder:"Everyday",value:Pe.fromDayOfWeek??null,onChange:X=>ft(X),width:20}),D.createElement(j,{value:ke(Pe.from),onChange:X=>xt(X,"from"),allowEmpty:!0,placeholder:"HH:mm",width:100}))),D.createElement(T.D,{label:"To"},D.createElement(B.B,{gap:.5},(Pe.fromDayOfWeek||Pe.toDayOfWeek)&&D.createElement(M.l6,{options:se,isClearable:!0,placeholder:Ze(),value:Pe.toDayOfWeek??null,onChange:X=>Le(X),width:20}),D.createElement(j,{value:ke(Pe.to),onChange:X=>xt(X,"to"),allowEmpty:!0,placeholder:"HH:mm",width:100}))),D.createElement(T.D,{label:"Timezone"},re()))},ee=Pe=>({wrapper:(0,v.css)({maxWidth:Pe.spacing(60),marginBottom:Pe.spacing(2)}),timezoneContainer:(0,v.css)`
      padding: 5px;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
    `,timezone:(0,v.css)`
      margin-right: 5px;
    `}),Z="Enabling this returns annotations that match any of the tags specified below",z=D.createElement("div",null,"Specify a list of tags to match. To specify a key and value tag use `key:value` syntax."),q=[{label:"Dashboard",value:O.St.Dashboard,description:"Query for events created on this dashboard and show them in the panels where they where created"},{label:"Tags",value:O.St.Tags,description:"This will fetch any annotation events that match the tags filter"}],ie=[{label:"Annotations & Alerts",value:O.nj.Annotations,description:"Show annotations or alerts managed by grafana"},{label:"Time regions",value:O.nj.TimeRegions,description:"Configure a repeating time region"}],de=[10,50,100,200,300,500,1e3,2e3].map(Pe=>({label:String(Pe),value:Pe}));function ue({query:Pe,onChange:Ie}){const Oe=Pe,{limit:Ne,matchAny:We,tags:Ae,type:Ue,queryType:Me}=Oe;let $e=Me??O.nj.Annotations;const ke=(0,D.useMemo)(()=>(0,p.UA)().dashboard?.getTimezone(),[]),Ze=(0,E.of)(fe),ot=X=>Ie({...Oe,type:X.value}),xt=X=>Ie({...Oe,limit:X.value}),ct=X=>Ie({...Oe,matchAny:X.target.checked}),ft=X=>Ie({...Oe,tags:X}),Le=X=>{const le={...Oe,queryType:X.value};le.queryType===O.nj.TimeRegions?le.timeRegion||(le.timeRegion={timezone:ke}):delete le.timeRegion,Ie(le)},re=X=>{Ie({...Oe,timeRegion:X})};return D.createElement(S.n,{className:Ze.container},D.createElement(T.D,{label:"Query type"},D.createElement(M.l6,{inputId:"grafana-annotations__query-type",options:ie,value:$e,onChange:Le})),$e===O.nj.Annotations&&D.createElement(D.Fragment,null,D.createElement(T.D,{label:"Filter by"},D.createElement(M.l6,{inputId:"grafana-annotations__filter-by",options:q,value:Ue,onChange:ot})),D.createElement(T.D,{label:"Max limit"},D.createElement(M.l6,{inputId:"grafana-annotations__limit",width:16,options:de,value:Ne,onChange:xt})),Ue===O.St.Tags&&D.createElement(D.Fragment,null,D.createElement(T.D,{label:"Match any",description:Z},D.createElement(A.d,{id:"grafana-annotations__match-any",value:We,onChange:ct})),D.createElement(T.D,{label:"Tags",description:z},D.createElement(x.$,{allowCustomValue:!0,inputId:"grafana-annotations__tags",onChange:ft,tagOptions:C.vy,tags:Ae??[]})))),$e===O.nj.TimeRegions&&Oe.timeRegion&&D.createElement(ne,{value:Oe.timeRegion,onChange:re}))}const fe=Pe=>({container:(0,v.css)({maxWidth:Pe.spacing(60),marginBottom:Pe.spacing(2)})});var Se=e(11261),he=e(94515);function ce(Pe,Ie,Oe,Ne){if(!Ie)return;const We=(0,he.iU)(Ie,Oe);if(!We.length)return;const Ae=[],Ue=[],Me=[],$e=Ie.timezone??Ne;for(const ke of We){let Ze=ke.from,ot=ke.to;const xt=(0,N.QZ)($e,Ze);if(xt){const ct=xt.offsetInMins*60*1e3;Ze+=ct,ot+=ct}Ae.push(Ze),Ue.push(ot),Me.push(Pe)}return{fields:[{name:"time",type:Se.PU.time,values:Ae,config:{}},{name:"timeEnd",type:Se.PU.time,values:Ue,config:{}},{name:"text",type:Se.PU.string,values:Me,config:{}}],length:Ae.length}}let me=100;class pe extends u.iy{constructor(Ie){super(Ie),this.annotations={QueryEditor:ue,prepareAnnotation(Oe){return Oe.target=Oe.target??{type:Oe.type??O.St.Dashboard,limit:Oe.limit??100,tags:Oe.tags??[],matchAny:Oe.matchAny??!1},Oe},prepareQuery(Oe){let Ne;if((0,n.isString)(Oe.datasource)){const Ue=(0,y.og)(Oe.datasource,{returnDefaultAsNull:!1});Ue&&(Ne=Ue)}else Ne=Oe.datasource;const{filter:We,...Ae}=Oe;return{...Ae,refId:Oe.name,queryType:O.nj.Annotations,datasource:Ne}}}}getDefaultQuery(){return{queryType:O.nj.RandomWalk}}query(Ie){const Oe=[],Ne=[],We=(0,b.w)();for(const Ae of Ie.targets){if(Ae.queryType===O.nj.Annotations)return(0,a.H)(this.getAnnotations({range:Ie.range,rangeRaw:Ie.range.raw,annotation:Ae,dashboard:(0,p.UA)().getCurrent()}));if(!Ae.hide){if(Ae.queryType===O.nj.Snapshot){Oe.push((0,o.of)({data:(Ae.snapshot??[]).map(Ue=>(0,f.or)(Ue)),state:d.Gu.Done}));continue}if(Ae.queryType===O.nj.TimeRegions){const Ue=ce("",Ae.timeRegion,Ie.range,Ie.timezone);Oe.push((0,o.of)({data:Ue?[Ue]:[],state:d.Gu.Done}));continue}if(Ae.queryType===O.nj.LiveMeasurements){let Ue=We.replace(Ae.channel,Ie.scopedVars);const{filter:Me}=Ae,$e=(0,l.DG)(Ue);if(!(0,l.aj)($e))continue;const ke={maxLength:Ie.maxDataPoints??500};Ae.buffer?(ke.maxDelta=Ae.buffer,ke.maxLength=ke.maxLength*2):Ie.rangeRaw?.to==="now"&&(ke.maxDelta=Ie.range.to.valueOf()-Ie.range.from.valueOf()),Oe.push((0,g.oF)().getDataStream({key:`${Ie.requestId}.${me++}`,addr:$e,filter:Me,buffer:ke}))}else Ae.queryType||(Ae.queryType=O.nj.RandomWalk),Ne.push(Ae)}}return Ne.length&&Oe.push(super.query({...Ie,targets:Ne})),Oe.length?Oe.length===1?Oe[0]:(0,r.h)(...Oe):(0,o.of)()}listFiles(Ie,Oe){return this.query({targets:[{refId:"A",queryType:O.nj.List,path:Ie}],maxDataPoints:Oe}).pipe((0,i.T)(Ne=>{const We=Ne.data[0]??new m.k;return new s.R(We)}))}metricFindQuery(){return Promise.resolve([])}async getAnnotations(Ie){const Oe=Ie.annotation.target;if(Oe?.queryType===O.nj.TimeRegions){const Me=ce(Ie.annotation.name,Oe.timeRegion,Ie.range,(0,p.UA)().getCurrent()?.timezone);return Promise.resolve({data:Me?[Me]:[]})}const Ne=Ie.annotation,We=Ne.target,Ae={from:Ie.range.from.valueOf(),to:Ie.range.to.valueOf(),limit:We.limit,tags:We.tags,matchAny:We.matchAny};if(We.type===O.St.Dashboard){if(!Ie.dashboard?.uid)return Promise.resolve({data:[]});Ae.dashboardUID=Ie.dashboard.uid,delete Ae.tags}else{if(!Array.isArray(We.tags)||We.tags.length===0)return Promise.resolve({data:[]});const Me=(0,b.w)(),$e="__delimiter__",ke=[];for(const Ze of Ae.tags){const ot=Me.replace(Ze,{},xt=>typeof xt=="string"?xt:xt.join($e));for(const xt of ot.split($e))ke.push(xt)}Ae.tags=ke}const Ue=await(0,P.AI)().get("/api/annotations",Ae,`grafana-data-source-annotations-${Ne.name}-${Ie.dashboard?.uid}`);return{data:[(0,h.Vc)(Ue)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}async function ye(){return await(0,c.l)().get("-- Grafana --")}},68706:(Q,I,e)=>{"use strict";e.d(I,{St:()=>r,dx:()=>o,nj:()=>n,uJ:()=>a});var n=(i=>(i.LiveMeasurements="measurements",i.Annotations="annotations",i.Snapshot="snapshot",i.TimeRegions="timeRegions",i.RandomWalk="randomWalk",i.List="list",i.Read="read",i.Search="search",i))(n||{});const a={refId:"A",queryType:"randomWalk"},o={refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:"snapshot",snapshot:[]};var r=(i=>(i.Dashboard="dashboard",i.Tags="tags",i))(r||{})},90478:(Q,I,e)=>{"use strict";e.d(I,{H:()=>d,j:()=>m});var n=e(89667),a=e(28138),o=e(57220),r=e(40489),i=e(28444),f=e(68706);function d(s,h){return new Promise(u=>{if(s.datasource?.uid===o.vv){l(h,s),u(!0);return}a.A.publish(new i.bY({title:"Change to panel embedded data",text:"If you want to change the data shown in this panel Grafana will need to remove the panels current query and replace it with a snapshot of the current data. This enables you to edit the data.",yesText:"Continue",icon:"pen",onConfirm:()=>{l(h,s),u(!0)},onDismiss:()=>{u(!1)}}))})}function l(s,h){const u=s.map(g=>(0,n.Nw)(g)),b={refId:"A",queryType:f.nj.Snapshot,snapshot:u,datasource:{uid:o.vv}};h.updateQueries({dataSource:{uid:o.vv},queries:[b]}),h.refresh()}function m(s){return(h,u,b)=>{r.vI(h).subscribe(async g=>{const P=[];g.dataFrames.forEach(c=>{const y=(0,n.Nw)(c);P.push(y)}),s({...f.dx,snapshot:P,file:g.file},u)})}}},71713:(Q,I,e)=>{"use strict";e.d(I,{AW:()=>f,Ay:()=>l,RQ:()=>r,dZ:()=>n,fV:()=>i,vB:()=>d});const n=[{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"}],a=[{label:"json",insertText:"json",documentation:"Extracting labels from the log line using json parser."},{label:"regexp",insertText:'regexp ""',documentation:"Extracting labels from the log line using regexp parser.",move:-1},{label:"logfmt",insertText:"logfmt",documentation:"Extracting labels from the log line using logfmt parser."},{label:"pattern",insertText:"pattern",documentation:"Extracting labels from the log line using pattern parser. Only available in Loki 2.3+."},{label:"unpack",insertText:"unpack",detail:"unpack identifier",documentation:'Parses a JSON log line, unpacking all embedded labels in the pack stage. A special property "_entry" will also be used to replace the original log line. Only available in Loki 2.2+.'}],o=[{label:"unwrap",insertText:"unwrap",detail:"unwrap identifier",documentation:"Take labels and use the values as sample data for metric aggregations."},{label:"label_format",insertText:"label_format",documentation:"Use to rename, modify or add labels. For example, | label_format foo=bar ."},{label:"line_format",insertText:"line_format",documentation:'Rewrites log line content. For example, | line_format "{{.query}} {{.duration}}" .'}],r=[{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average of all values in the specified interval."},{insertText:"bytes_over_time",label:"bytes_over_time",detail:"bytes_over_time(range-vector)",documentation:"Counts the amount of bytes used by each log stream for a given range"},{insertText:"bytes_rate",label:"bytes_rate",detail:"bytes_rate(range-vector)",documentation:"Calculates the number of bytes per second for each stream."},{insertText:"first_over_time",label:"first_over_time",detail:"first_over_time(range-vector)",documentation:"The first of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The last of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum of all values in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the number of entries per second."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."}],i=[{insertText:"vector",label:"vector",detail:"vector(scalar)",documentation:"Returns the scalar as a vector with no labels."}],f=[...n,...r,...i],d={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((without|by)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-zA-Z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},"context-pipe":{pattern:/\s\|[^=~]\s?\w*/i,inside:{"pipe-operator":{pattern:/\|/i,alias:"operator"},"pipe-operations":{pattern:new RegExp(`${[...a,...o].map(m=>m.label).join("|")}`,"i"),alias:"keyword"}}},function:new RegExp(`\\b(?:${f.map(m=>m.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=\])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],quote:{pattern:/"(?:\\.|[^\\"])*"/,alias:"string",greedy:!0},backticks:{pattern:/`(?:\\.|[^\\`])*`/,alias:"string",greedy:!0},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:/\s?(\|[=~]?|!=?|<(?:=>?|<|>)?|>[>=]?)\s?/i,punctuation:/[{}(),.]/},l=d},65650:(Q,I,e)=>{"use strict";e.d(I,{HD:()=>f,ti:()=>r,U3:()=>a,ie:()=>d,Q$:()=>o});var n=(l=>(l.Builder="builder",l.Code="code",l))(n||{}),a=(l=>(l.Instant="instant",l.Range="range",l.Stream="stream",l))(a||{}),o=(l=>(l.DataSample="dataSample",l.InfiniteScroll="infiniteScroll",l.LogsSample="logsSample",l.LogsVolume="logsVolume",l))(o||{}),r=(l=>(l.Backward="backward",l.Forward="forward",l))(r||{}),i=(l=>(l.Stream="streams",l.Vector="vector",l.Matrix="matrix",l))(i||{}),f=(l=>(l.Indexed="I",l.StructuredMetadata="S",l.Parsed="P",l))(f||{}),d=(l=>(l[l.LabelNames=0]="LabelNames",l[l.LabelValues=1]="LabelValues",l))(d||{})},14678:(Q,I,e)=>{"use strict";e.d(I,{N8:()=>v,qM:()=>p,uv:()=>y});var n=e(2543),a=e.n(n),o=e(62467),r=e(65474),i=e(45650),f=e(69862),d=e(81160),l=e(9084),m=e(66847),s=e(93031),h=e(71030),u=e(40187),b=e(39070),g=e(72574),P=e(19347),c=e(12091);const y="-- Mixed --",p=(E,S)=>`mixed-${E}-${S||""}`;class v extends u.mA{constructor(S){super(S)}query(S){const T=S.targets.filter(x=>x.datasource?.uid!==y);if(!T.length)return(0,o.of)({data:[]});const M=(0,n.groupBy)(T,"datasource.uid"),A=[];for(const x in M)A.push(...this.getBatchesForQueries(M[x],S));return A.length?this.batchQueries(A,S):(0,o.of)({data:[]})}getBatchesForQueries(S,T){const M=S[0].datasource,A=[],x=(0,g.w)().replace(M?.uid,T.scopedVars,(C,O)=>{if(!Array.isArray(C))return C;for(const R of C){if(R==="default")continue;const L=(0,P.l)().getInstanceSettings(R);A.push({datasource:(0,P.l)().get(R),queries:(0,n.cloneDeep)(S),scopedVars:{...T.scopedVars,[O.name]:{value:R,text:L?.name}}})}return""});return x!==""&&A.push({datasource:(0,P.l)().get(x),queries:(0,n.cloneDeep)(S),scopedVars:{...T.scopedVars}}),A}batchQueries(S,T){const M=S.filter(this.isQueryable).map((A,x)=>(0,r.H)(A.datasource).pipe((0,f.Z)(C=>{const O=(0,n.cloneDeep)(T);return O.requestId=p(x,O.requestId),O.targets=A.queries,O.scopedVars=A.scopedVars,(0,r.H)(C.query(O)).pipe((0,d.T)(R=>({...R,data:R.data||[],state:b.Gu.Loading,key:p(x,R.key)})),(0,l.$)(),(0,m.W)(R=>(R=(0,c.u)(R),R.message=`${C.name}: ${R.message}`,(0,o.of)([{data:[],state:b.Gu.Error,error:R,key:p(x,O.requestId)}]))))})));return(0,i.p)(M).pipe(D(),(0,d.T)(this.finalizeResponses),(0,s.U)())}testDatasource(){return Promise.resolve({message:"",status:""})}isQueryable(S){return S&&Array.isArray(S.queries)&&S.queries.length>0}finalizeResponses(S){const{length:T}=S;if(T===0)return S;const M=S.find(A=>A.state===b.Gu.Error);return M?S.push(M):S[T-1].state=b.Gu.Done,S}}function D(){return(0,h.T)((E,S)=>S.reduce((T,M)=>(T.push.apply(T,M),T),E),[])}},19071:(Q,I,e)=>{"use strict";e.d(I,{cd:()=>_,xw:()=>F});var n=e(37471),a=e(11261);const o={filters:[],groupBy:[]};var r=(de=>(de.Done="done",de.Error="error",de.Pending="pending",de.Streaming="streaming",de))(r||{}),i=(de=>(de.Raw="raw",de.Spans="spans",de.Traces="traces",de))(i||{}),f=(de=>(de.Intrinsic="intrinsic",de.Resource="resource",de.Span="span",de.Unscoped="unscoped",de))(f||{});function d(de){const{nodes:ue,edges:fe}=l(de),[Se,he]=makeFrames();for(const ce of ue)Se.add(ce);for(const ce of fe)he.add(ce);return[Se,he]}function l(de){const ue=[],fe=[],Se=new DataFrameView(de),he=m(Se),ce=makeSpanMap(me=>{if(me>=de.length)return;const pe=Se.get(me);return{span:{...pe},id:pe.spanID,parentIds:pe.parentSpanID?[pe.parentSpanID]:[]}});for(let me=0;me<Se.length;me++){const pe=Se.get(me),ye=ce[pe.spanID].children.map(Ne=>{const We=ce[Ne].span;return[We.startTime,We.startTime+We.duration]}),Pe=getNonOverlappingDuration(ye),Ie=pe.duration-Pe,Oe=getStats(pe.duration,he,Ie);ue.push({[Fields.id]:pe.spanID,[Fields.title]:pe.serviceName??"",[Fields.subTitle]:pe.operationName,[Fields.mainStat]:Oe.main,[Fields.secondaryStat]:Oe.secondary,[Fields.color]:Ie/he}),pe.parentSpanID&&ce[pe.parentSpanID].span&&fe.push({[Fields.id]:pe.parentSpanID+"--"+pe.spanID,[Fields.target]:pe.spanID,[Fields.source]:pe.parentSpanID})}return{nodes:ue,edges:fe}}function m(de){let ue=0,fe=1/0;for(let Se=0;Se<de.length;Se++){const he=de.get(Se);he.startTime<fe&&(fe=he.startTime),he.startTime+he.duration>ue&&(ue=he.startTime+he.duration)}return ue-fe}const s="traces_service_graph_request_server_seconds_sum",h="traces_service_graph_request_total",u="traces_service_graph_request_failed_total",b="traces_service_graph_request_server_seconds_bucket",g={expr:"sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)",topk:5,params:[]},P={expr:"sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)",topk:5,params:['status_code="STATUS_CODE_ERROR"']},c={expr:"histogram_quantile(.9, sum(rate(traces_spanmetrics_latency_bucket{}[$__range])) by (le))",params:[]},y='span_kind="SPAN_KIND_SERVER"',p=[s,h,u,b];function v(de,ue){const fe=E(de),Se={},he={};return T(fe[h],"total",h,Se,he),T(fe[s],"seconds",s,Se,he),T(fe[u],"failed",u,Se,he),M(Se,he,ue)}function D(){function de(Se,he){return new MutableDataFrame({name:Se,fields:he,meta:{preferredVisualisationType:"nodeGraph"}})}const ue=de("Nodes",[{name:Fields.id,type:FieldType.string,values:[]},{name:Fields.title,type:FieldType.string,config:{displayName:"Service name"},values:[]},{name:Fields.subTitle,type:FieldType.string,config:{displayName:"Service namespace"},values:[]},{name:Fields.mainStat,type:FieldType.number,config:{unit:"ms/r",displayName:"Average response time"},values:[]},{name:Fields.secondaryStat,type:FieldType.number,config:{unit:"r/sec",displayName:"Requests per second"},values:[]},{name:Fields.arc+"success",type:FieldType.number,config:{displayName:"Success",color:{fixedColor:"green",mode:FieldColorModeId.Fixed}},values:[]},{name:Fields.arc+"failed",type:FieldType.number,config:{displayName:"Failed",color:{fixedColor:"red",mode:FieldColorModeId.Fixed}},values:[]}]),fe=de("Edges",[{name:Fields.id,type:FieldType.string,values:[]},{name:Fields.source,type:FieldType.string,values:[]},{name:"sourceName",type:FieldType.string,values:[]},{name:"sourceNamespace",type:FieldType.string,values:[]},{name:Fields.target,type:FieldType.string,values:[]},{name:"targetName",type:FieldType.string,values:[]},{name:"targetNamespace",type:FieldType.string,values:[]},{name:Fields.mainStat,type:FieldType.number,config:{unit:"ms/r",displayName:"Average response time"},values:[]},{name:Fields.secondaryStat,type:FieldType.number,config:{unit:"r/sec",displayName:"Requests per second"},values:[]}]);return[ue,fe]}function E(de){return(de[0]?.data||[]).reduce((ue,fe)=>{const Se=toDataFrame(fe);return ue[Se.refId??"A"]=new DataFrameView(Se),ue},{})}var S=(de=>(de.sourceName="sourceName",de.sourceNamespace="sourceNamespace",de.targetName="targetName",de.targetNamespace="targetNamespace",de))(S||{});function T(de,ue,fe,Se,he){if(!de)return;const ce=`Value #${fe}`;for(let me=0;me<de.length;me++){const pe=de.get(me),ye=pe.server_service_namespace?`${pe.server_service_namespace}/${pe.server}`:pe.server,Pe=pe.client_service_namespace?`${pe.client_service_namespace}/${pe.client}`:pe.client,Ie=`${Pe}_${ye}`;he[Ie]?he[Ie][ue]=(he[Ie][ue]||0)+pe[ce]:he[Ie]={target:ye,targetName:pe.server,targetNamespace:pe.server_service_namespace,source:Pe,sourceName:pe.client,sourceNamespace:pe.client_service_namespace,[ue]:pe[ce]},Se[ye]?Se[ye][ue]=(Se[ye][ue]||0)+pe[ce]:Se[ye]={name:pe.server,namespace:pe.server_service_namespace,[ue]:pe[ce]},Se[Pe]||(Se[Pe]={name:pe.client,namespace:pe.client_service_namespace,[ue]:0})}}function M(de,ue,fe){const[Se,he]=D();for(const ce of Object.keys(de)){const me=de[ce];Se.add({[Fields.id]:ce,[Fields.title]:me.name,[Fields.subTitle]:me.namespace,[Fields.mainStat]:me.total?me.seconds/me.total*1e3:Number.NaN,[Fields.secondaryStat]:me.total?Math.round(me.total*100)/100:Number.NaN,[Fields.arc+"success"]:me.total?(me.total-Math.min(me.failed||0,me.total))/me.total:1,[Fields.arc+"failed"]:me.total?Math.min(me.failed||0,me.total)/me.total:0})}for(const ce of Object.keys(ue)){const me=ue[ce];he.add({[Fields.id]:ce,[Fields.source]:me.source,sourceName:me.sourceName,sourceNamespace:me.sourceNamespace,[Fields.target]:me.target,targetName:me.targetName,targetNamespace:me.targetNamespace,[Fields.mainStat]:me.total?me.seconds/me.total*1e3:Number.NaN,[Fields.secondaryStat]:me.total?Math.round(me.total*100)/100:Number.NaN})}return{nodes:Se,edges:he}}function A(de){if(de.stringValue)return de.stringValue;if(de.boolValue!==void 0)return!!de.boolValue;if(de.intValue!==void 0)return Number.parseInt(de.intValue,10);if(de.doubleValue)return Number.parseFloat(de.doubleValue);if(de.arrayValue){const ue=[];for(const fe of de.arrayValue.values)ue.push(A(fe));return ue}return""}function x(de){const ue=[];let fe="OTLPResourceNoServiceName";if(!de)return{serviceName:fe,serviceTags:ue};for(const Se of de.attributes)Se.key===SemanticResourceAttributes.SERVICE_NAME&&(fe=Se.value.stringValue||fe),ue.push({key:Se.key,value:A(Se.value)});return{serviceName:fe,serviceTags:ue}}function C(de){const ue=[];if(de.attributes)for(const fe of de.attributes)ue.push({key:fe.key,value:A(fe.value)});return ue}function O(de){let ue;if(de.kind){const fe=de.kind.toString().toLowerCase().split("_");ue=fe.length?fe[fe.length-1]:de.kind.toString()}return ue}function R(de){const ue=[];if(de.links)for(const fe of de.links){const{traceId:Se,spanId:he}=fe,ce=[];if(fe.attributes)for(const me of fe.attributes)ce.push({key:me.key,value:A(me.value)});ue.push({traceID:Se,spanID:he,tags:ce})}return ue}function L(de){const ue=[];if(de.events)for(const fe of de.events){const Se=[];if(fe.attributes)for(const he of fe.attributes)Se.push({key:he.key,value:A(he.value)});ue.push({fields:Se,timestamp:fe.timeUnixNano/1e6})}return ue}function N(de,ue=!1){const fe=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"kind",type:FieldType.string,values:[]},{name:"statusCode",type:FieldType.number,values:[]},{name:"statusMessage",type:FieldType.string,values:[]},{name:"instrumentationLibraryName",type:FieldType.string,values:[]},{name:"instrumentationLibraryVersion",type:FieldType.string,values:[]},{name:"traceState",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"references",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}});try{for(const he of de){const{serviceName:ce,serviceTags:me}=x(he.resource);for(const pe of he.instrumentationLibrarySpans)for(const ye of pe.spans)fe.add({traceID:ye.traceId.length>16?ye.traceId.slice(16):ye.traceId,spanID:ye.spanId,parentSpanID:ye.parentSpanId||"",operationName:ye.name||"",serviceName:ce,kind:O(ye),statusCode:ye.status?.code,statusMessage:ye.status?.message,instrumentationLibraryName:pe.instrumentationLibrary?.name,instrumentationLibraryVersion:pe.instrumentationLibrary?.version,traceState:ye.traceState,serviceTags:me,startTime:ye.startTimeUnixNano/1e6,duration:(ye.endTimeUnixNano-ye.startTimeUnixNano)/1e6,tags:C(ye),logs:L(ye),references:R(ye)})}}catch(he){return console.error(he),{error:{message:"JSON is not valid OpenTelemetry format: "+he},data:[]}}let Se=[fe];return ue&&Se.push(...createGraphFrames(fe)),{data:Se}}function F(de){let ue={batches:[]},fe={};for(let Se=0;Se<de.length;Se++){const he=de.get(Se);fe[he.serviceName]||(fe[he.serviceName]=ue.batches.length,ue.batches.push({resource:{attributes:[],droppedAttributesCount:0},instrumentationLibrarySpans:[{spans:[]}]}));let ce=fe[he.serviceName];ue.batches[ce].resource.attributes.length===0&&(ue.batches[ce].resource.attributes=B(he.serviceTags)),ue.batches[ce].instrumentationLibrarySpans[0].instrumentationLibrary||he.instrumentationLibraryName&&(ue.batches[ce].instrumentationLibrarySpans[0].instrumentationLibrary={name:he.instrumentationLibraryName,version:he.instrumentationLibraryVersion?he.instrumentationLibraryVersion:""}),ue.batches[ce].instrumentationLibrarySpans[0].spans.push({traceId:he.traceID.padStart(32,"0"),spanId:he.spanID,parentSpanId:he.parentSpanID||"",traceState:he.traceState||"",name:he.operationName,kind:K(he.kind),startTimeUnixNano:he.startTime*1e6,endTimeUnixNano:(he.startTime+he.duration)*1e6,attributes:he.tags?B(he.tags):[],droppedAttributesCount:0,droppedEventsCount:0,droppedLinksCount:0,status:U(he),events:W(he.logs),links:V(he.references)})}return ue}function K(de){let ue;if(de)switch(de){case"server":ue="SPAN_KIND_SERVER";break;case"client":ue="SPAN_KIND_CLIENT";break;case"producer":ue="SPAN_KIND_PRODUCER";break;case"consumer":ue="SPAN_KIND_CONSUMER";break;case"internal":ue="SPAN_KIND_INTERNAL";break}return ue}function B(de){return de.reduce((ue,fe)=>[...ue,{key:fe.key,value:w(fe)}],[])}function w(de){if(typeof de.value=="string")return{stringValue:de.value};if(typeof de.value=="boolean")return{boolValue:de.value};if(typeof de.value=="number")return de.value%1===0?{intValue:de.value}:{doubleValue:de.value};if(typeof de.value=="object"&&Array.isArray(de.value)){const ue=[];for(const fe of de.value)ue.push(w(fe));return{arrayValue:{values:ue}}}return{stringValue:de.value}}function U(de){let ue;return de.statusCode!==void 0&&(ue={code:de.statusCode,message:de.statusMessage?de.statusMessage:""}),ue}function W(de){if(!de||!de.length)return;let ue=[];for(const fe of de){let Se={timeUnixNano:fe.timestamp*1e6,attributes:[],droppedAttributesCount:0,name:""};for(const he of fe.fields)Se.attributes.push({key:he.key,value:w(he)});ue.push(Se)}return ue}function V(de){if(!de||!de.length)return;let ue=[];for(const fe of de){let Se={traceId:fe.traceID,spanId:fe.spanID,attributes:[],droppedAttributesCount:0};if(fe.tags?.length)for(const he of fe.tags)Se.attributes?.push({key:he.key,value:w(he)});ue.push(Se)}return ue}const _="Related profiles";function H(de,ue,fe=!1){const Se=de.data[0];if(!Se)return ie;const ce=ue?.jsonData?.tracesToProfiles;let me;if(ce?.datasourceUid&&(me=getDataSourceSrv().getInstanceSettings(ce.datasourceUid)),ce&&me){const ye=ce.customQuery?ce.query:void 0,Pe={title:_,url:"",internal:{datasourceUid:me.uid,datasourceName:me.name,query:{labelSelector:ye||"{${__tags}}",groupBy:[],profileTypeId:ce.profileTypeId??"",queryType:"profile",spanSelector:['${__span.tags["pyroscope.profile.id"]}'],refId:"profile"}},origin:DataLinkConfigOrigin.Datasource};Se.fields.forEach(Ie=>{Ie.name==="tags"&&(Ie.config.links=[Pe])})}let pe=[...de.data];return fe&&pe.push(...createGraphFrames(toDataFrame(Se))),{...de,data:pe}}function G(de){return{traceID:de.traceID,startTime:parseInt(de.startTimeUnixNano,10)/1e6,traceDuration:de.durationMs,traceService:de.rootServiceName||"",traceName:de.rootTraceName||""}}const j=de=>de.stringValue?`"${de.stringValue}"`:""+(de.intValue||de.doubleValue||de.boolValue||'""');function Y(de,ue){return ue.series.map((Se,he)=>{const ce={};Se.labels?.forEach(pe=>{ce[pe.key]=j(pe.value)});let me=ue.series.length===1?de:"";return Se.labels&&(Se.labels.length===1?me=j(Se.labels[0].value):me=`{${Se.labels.map(pe=>`${pe.key}=${j(pe.value)}`).join(", ")}}`),createDataFrame({refId:me||`A${he}`,fields:[{name:"time",type:FieldType.time,values:Se.samples.map(pe=>parseInt(pe.timestampMs,10))},{name:me,labels:ce,type:FieldType.number,values:Se.samples.map(pe=>pe.value),config:{displayNameFromDS:me}}],meta:{preferredVisualisationType:"graph"}})})}function oe(de,ue,fe){switch(fe){case SearchTableType.Spans:return ee(de,ue);case SearchTableType.Raw:return se(de);default:return ne(de,ue)}}function se(de){return[createDataFrame({name:"Raw response",refId:"raw",fields:[{name:"response",type:FieldType.string,values:[JSON.stringify(de,null,2)]}]})]}function ne(de,ue){const fe=createDataFrame({name:"Traces",refId:"traces",fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",custom:{width:200},links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:ue.uid,datasourceName:ue.name,query:{query:"${__value.raw}",queryType:"traceql"}}}]}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Service"}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Name"}},{name:"traceDuration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ms",custom:{width:120}}},{name:"nested",type:FieldType.nestedFrames}],meta:{preferredVisualisationType:"table",uniqueRowIdFields:[0]}});return de?.length?(fe.length=de.length,de.sort((Se,he)=>parseInt(he?.startTimeUnixNano,10)/1e6-parseInt(Se?.startTimeUnixNano,10)/1e6).forEach(Se=>{const he=G(Se);fe.fields[0].values.push(he.traceID),fe.fields[1].values.push(he.startTime),fe.fields[2].values.push(he.traceService),fe.fields[3].values.push(he.traceName),fe.fields[4].values.push(he.traceDuration?he.traceDuration:"<1ms"),Se.spanSets?fe.fields[5].values.push(Se.spanSets.map(ce=>z(Se,ce,ue))):Se.spanSet&&fe.fields[5].values.push([z(Se,Se.spanSet,ue)])}),[fe]):[fe]}function ee(de,ue){const fe={};let Se=!1;de?.forEach(ce=>Z(ce).forEach(me=>{me.attributes?.forEach(pe=>{fe[pe.key]={name:pe.key,type:FieldType.string,config:{displayNameFromDS:pe.key}}}),me.spans.forEach(pe=>{pe.name&&(Se=!0),pe.attributes?.forEach(ye=>{fe[ye.key]={name:ye.key,type:FieldType.string,config:{displayNameFromDS:ye.key}}})})}));const he=new MutableDataFrame({name:"Spans",refId:"traces",fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Trace Service",custom:{width:200}}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace Name",custom:{width:200}}},{name:"spanID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:ue.uid,datasourceName:ue.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"name",type:FieldType.string,config:{displayNameFromDS:"Name",custom:{hidden:!Se}}},...Object.values(fe).sort((ce,me)=>ce.name.localeCompare(me.name)),{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}});return!de||!de.length?[he]:(de.sort((ce,me)=>parseInt(me?.startTimeUnixNano,10)/1e6-parseInt(ce?.startTimeUnixNano,10)/1e6).forEach(ce=>{Z(ce).forEach(me=>{me.spans.forEach(pe=>{he.add(q(pe,me,ce))})})}),[he])}const Z=de=>de.spanSets||(de.spanSet?[de.spanSet]:[]),z=(de,ue,fe)=>{const Se={};let he=!1;ue.attributes?.map(pe=>{Se[pe.key]={name:pe.key,type:FieldType.string,config:{displayNameFromDS:pe.key},values:[]}}),ue.spans.forEach(pe=>{pe.name&&(he=!0),pe.attributes?.forEach(ye=>{Se[ye.key]={name:ye.key,type:FieldType.string,config:{displayNameFromDS:ye.key},values:[]}})});const ce=new MutableDataFrame({fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}},values:[]},{name:"spanID",type:FieldType.string,values:[],config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:fe.uid,datasourceName:fe.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"name",type:FieldType.string,values:[],config:{displayNameFromDS:"Name",custom:{hidden:!he}}},...Object.values(Se).sort((pe,ye)=>pe.name.localeCompare(ye.name)),{name:"duration",type:FieldType.number,values:[],config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}}),me=createTheme();for(const pe of ce.fields)pe.display=getDisplayProcessor({field:pe,theme:me});return ue.spans.forEach(pe=>{ce.add(q(pe,ue,de))}),ce};function q(de,ue,fe){const Se=parseInt(de.startTimeUnixNano,10)/1e6,he={traceIdHidden:fe.traceID,traceService:fe.rootServiceName||"",traceName:fe.rootTraceName||"",spanID:de.spanID,time:Se,duration:parseInt(de.durationNanos,10),name:de.name};let ce=[];return ue.attributes&&(ce=ce.concat(ue.attributes)),de.attributes&&(ce=ce.concat(de.attributes)),ce.forEach(me=>{(me.value.boolValue||me.value.Value?.bool_value)&&(he[me.key]=me.value.boolValue||me.value.Value?.bool_value),(me.value.doubleValue||me.value.Value?.double_value)&&(he[me.key]=me.value.doubleValue||me.value.Value?.double_value),(me.value.intValue||me.value.Value?.int_value)&&(he[me.key]=me.value.intValue||me.value.Value?.int_value),(me.value.stringValue||me.value.Value?.string_value)&&(he[me.key]=me.value.stringValue||me.value.Value?.string_value)}),he}const ie={data:[new n.k({fields:[{name:"trace",type:a.PU.trace,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}})]}},64861:(Q,I,e)=>{"use strict";e.d(I,{nE:()=>r,r6:()=>o,xB:()=>n});var n=(i=>(i[i.AlphaAsc=1]="AlphaAsc",i[i.AlphaDesc=2]="AlphaDesc",i[i.Importance=3]="Importance",i[i.TimeAsc=4]="TimeAsc",i[i.TimeDesc=5]="TimeDesc",i))(n||{}),a=(i=>(i.Current="current",i.RecentChanges="changes",i))(a||{}),o=(i=>(i.Default="default",i.Custom="custom",i))(o||{}),r=(i=>(i.List="list",i.Stat="stat",i))(r||{})},39758:(Q,I,e)=>{"use strict";e.d(I,{mn:()=>f,ur:()=>a});var n=e(97706);const a=1,o=2,r=3,i=(d,l,m,s)=>(0,n.h)(l+d*(m+s),6);function f(d,l,m,s,h){let u=1-l,b=m===a?u/(d-1):m===o?u/d:m===r?u/(d+1):0;(isNaN(b)||b===1/0)&&(b=0);let g=m===a?0:m===o?b/2:m===r?b:0,P=l/d,c=(0,n.h)(P,6);if(s==null)for(let y=0;y<d;y++)h(y,i(y,g,P,b),c);else h(s,i(s,g,P,b),c)}},4134:(Q,I,e)=>{"use strict";e.d(I,{C$:()=>f,HY:()=>i,Tr:()=>r,ur:()=>o});const n=10,a=4;function o(d,l,m,s,h,u){return d>=m&&d<=h&&l>=s&&l<=u}function r(d,l,m){let s=[];if(d.o.length&&s.push(...d.o.filter(h=>(l==null||h.sidx===l)&&(m==null||h.didx===m))),d.q)for(let h=0;h<d.q.length;h++)s.push(...r(d.q[h],l,m));return s}function i(d,l){return d.x<=l.x+l.w&&d.x+d.w>=l.x&&d.y+d.h>=l.y&&d.y<=l.y+l.h}class f{constructor(l,m,s,h,u=0){this.x=l,this.y=m,this.w=s,this.h=h,this.l=u,this.o=[],this.q=null}split(){let l=this,m=l.x,s=l.y,h=l.w/2,u=l.h/2,b=l.l+1;l.q=[new f(m+h,s,h,u,b),new f(m,s,h,u,b),new f(m,s+u,h,u,b),new f(m+h,s+u,h,u,b)]}quads(l,m,s,h,u){let b=this,g=b.q,P=b.x+b.w/2,c=b.y+b.h/2,y=m<c,p=l<P,v=l+s>P,D=m+h>c;y&&v&&u(g[0]),p&&y&&u(g[1]),p&&D&&u(g[2]),v&&D&&u(g[3])}add(l){let m=this;if(m.q!=null)m.quads(l.x,l.y,l.w,l.h,s=>{s.add(l)});else{let s=m.o;if(s.push(l),s.length>n&&m.l<a){m.split();for(let h=0;h<s.length;h++){let u=s[h];m.quads(u.x,u.y,u.w,u.h,b=>{b.add(u)})}m.o.length=0}}}get(l,m,s,h,u){let b=this,g=b.o;for(let P=0;P<g.length;P++)u(g[P]);b.q!=null&&b.quads(l,m,s,h,P=>{P.get(l,m,s,h,u)})}clear(){this.o.length=0,this.q=null}}},58384:(Q,I,e)=>{"use strict";e.d(I,{d:()=>u,l:()=>b});var n=e(2543),a=e.n(n),o=e(96540),r=e(47070),i=e(56323),f=e(52622),d=e(97696),l=e(59796),m=e(12509),s=e(2913),h=e(17516);class u extends o.PureComponent{constructor(){super(...arguments),this.renderComponent=(P,c)=>{const{options:y,fieldConfig:p}=this.props,{value:v,alignmentFactors:D,orientation:E,width:S,height:T,count:M}=P,{field:A,display:x,view:C,colIndex:O}=v,{openMenu:R,targetClassName:L}=c;let N;return C&&(0,n.isNumber)(O)&&(N=C.getFieldDisplayProcessor(O)),o.createElement(d.xE,{value:b(M,p.defaults,x),width:S,height:T,orientation:E,field:A,text:y.text,display:N,theme:s.config.theme2,itemSpacing:this.getItemSpacing(),displayMode:y.displayMode,onClick:R,className:L,alignmentFactors:M>1?D:void 0,showUnfilled:y.showUnfilled,valueDisplayMode:y.valueMode,namePlacement:y.namePlacement})},this.renderValue=P=>{const{value:c,orientation:y}=P,{hasLinks:p,getLinks:v}=c;return p&&v?o.createElement("div",{style:{width:"100%",display:y===r.wV.Vertical?"flex":"initial"}},o.createElement(l.e,{style:{height:"100%"},links:v},D=>this.renderComponent(P,D))):this.renderComponent(P,{})},this.getValues=()=>{const{data:P,options:c,replaceVariables:y,fieldConfig:p,timeZone:v}=this.props;return(0,i.PI)({fieldConfig:p,reduceOptions:c.reduceOptions,replaceVariables:y,theme:s.config.theme2,data:P.series,timeZone:v})}}getItemSpacing(){return this.props.options.displayMode==="lcd"?2:10}getOrientation(){const{options:P,width:c,height:y}=this.props,{orientation:p}=P;return p===r.wV.Auto?c>y?r.wV.Vertical:r.wV.Horizontal:p}calcBarSize(){const{options:P}=this.props,c=this.getOrientation(),y=P.sizing===f.T6.Manual,p=c===r.wV.Vertical,v=c===r.wV.Horizontal,D=y&&p?P.minVizWidth:h.K.minVizWidth,E=y&&v?P.minVizHeight:h.K.minVizHeight,S=y&&v?P.maxVizHeight:h.K.maxVizHeight;return{minVizWidth:D,minVizHeight:E,maxVizHeight:S}}render(){const{height:P,width:c,options:y,data:p,renderCounter:v}=this.props,{minVizWidth:D,minVizHeight:E,maxVizHeight:S}=this.calcBarSize();return o.createElement(m.S,{source:p,getAlignmentFactors:i.XS,getValues:this.getValues,renderValue:this.renderValue,renderCounter:v,width:c,height:P,maxVizHeight:S,minVizWidth:D,minVizHeight:E,itemSpacing:this.getItemSpacing(),orientation:y.orientation})}}function b(g,P,c){return g===1&&!P.displayName?{...c,title:void 0}:c}},17516:(Q,I,e)=>{"use strict";e.d(I,{K:()=>a});var n=e(52622);const a={displayMode:n.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:n.TZ.Auto,showUnfilled:!0,sizing:n.T6.Auto,valueMode:n.$l.Color}},14738:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{plugin:()=>E});var n=e(65158),a=e(52622),o=e(71242),r=e(23799),i=e(63250);const f=S=>(0,i._$)(S),d=(S,T,M)=>{const A=(0,i.gl)(S,T,M);if(T==="singlestat"&&M.angular){const x=M.angular.gauge;x&&(A.showThresholdMarkers=x.thresholdMarkers,A.showThresholdLabels=x.thresholdLabels)}return A};var l=e(96540),m=e(57875),s=e(56323),h=e(95164),u=e(59796),b=e(12509),g=e(2913),P=e(58384);const c={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:a.T6.Auto};class y extends l.PureComponent{constructor(){super(...arguments),this.renderComponent=(T,M)=>{const{options:A,fieldConfig:x}=this.props,{width:C,height:O,count:R,value:L}=T,{field:N,display:F}=L,{openMenu:K,targetClassName:B}=M;return l.createElement(h._,{value:(0,P.l)(R,x.defaults,F),width:C,height:O,field:N,text:A.text,showThresholdLabels:A.showThresholdLabels,showThresholdMarkers:A.showThresholdMarkers,theme:g.config.theme2,onClick:K,className:B,orientation:A.orientation})},this.renderValue=T=>{const{value:M}=T,{getLinks:A,hasLinks:x}=M;return x&&A?l.createElement(u.e,{links:A,style:{flexGrow:1}},C=>this.renderComponent(T,C)):this.renderComponent(T,{})},this.getValues=()=>{const{data:T,options:M,replaceVariables:A,fieldConfig:x,timeZone:C}=this.props;for(let O of T.series)for(let R of O.fields)if(R.config.unit==="percent"||R.config.unit==="percentunit"){const L=R.config.min??0,N=R.config.max??(R.config.unit==="percent"?100:1);R.state=R.state??{},R.state.range={min:L,max:N,delta:N-L},R.display=(0,m.J)({field:R,theme:g.config.theme2})}return(0,s.PI)({fieldConfig:x,reduceOptions:M.reduceOptions,replaceVariables:A,theme:g.config.theme2,data:T.series,timeZone:C})},this.calculateGaugeSize=()=>{const{options:T}=this.props,M=T.orientation,A=T.sizing===a.T6.Manual,x=M===a.wV.Vertical,C=M===a.wV.Horizontal,O=A&&x?T.minVizWidth:c.minVizWidth,R=A&&C?T.minVizHeight:c.minVizHeight;return{minVizWidth:O,minVizHeight:R}}}render(){const{height:T,width:M,data:A,renderCounter:x,options:C}=this.props,{minVizHeight:O,minVizWidth:R}=this.calculateGaugeSize();return l.createElement(b.S,{getValues:this.getValues,renderValue:this.renderValue,width:M,height:T,source:A,autoGrid:!0,renderCounter:x,orientation:C.orientation,minVizHeight:O,minVizWidth:R})}}var p=e(50082),v=e(38824);class D{getSuggestionsForData(T){const{dataSummary:M}=T;if(!M.hasData||!M.hasNumberField||M.numberFieldCount>=50)return;const A=T.getListAppender({name:v.m.Gauge,pluginId:"gauge",options:{},fieldConfig:{defaults:{thresholds:{steps:[{value:-1/0,color:"green"},{value:70,color:"orange"},{value:85,color:"red"}],mode:p.O.Percentage},custom:{}},overrides:[]},cardOptions:{previewModifier:x=>{x.options.reduceOptions.values&&(x.options.reduceOptions.limit=2)}}});M.hasStringField&&M.frameCount===1&&M.rowCountTotal<10?(A.append({name:v.m.Gauge,options:{reduceOptions:{values:!0,calcs:[]}}}),A.append({name:v.m.GaugeNoThresholds,options:{reduceOptions:{values:!0,calcs:[]},showThresholdMarkers:!1}})):(A.append({name:v.m.Gauge,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),A.append({name:v.m.GaugeNoThresholds,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},showThresholdMarkers:!1}}))}}const E=new n.m(y).useFieldConfig({useCustomConfig:S=>{S.addNumberInput({path:"neutral",name:"Neutral",description:"Leave empty to use Min as neutral point",category:["Gauge"],settings:{placeholder:"auto"}})}}).setPanelOptions(S=>{(0,r.L)(S),(0,r.h)(S),S.addBooleanSwitch({path:"showThresholdLabels",name:"Show threshold labels",description:"Render the threshold values around the gauge bar",defaultValue:c.showThresholdLabels}).addBooleanSwitch({path:"showThresholdMarkers",name:"Show threshold markers",description:"Renders the thresholds as an outer bar",defaultValue:c.showThresholdMarkers}).addRadio({path:"sizing",name:"Gauge size",settings:{options:[{value:a.T6.Auto,label:"Auto"},{value:a.T6.Manual,label:"Manual"}]},defaultValue:c.sizing,showIf:T=>T.orientation!==a.wV.Auto}).addSliderInput({path:"minVizWidth",name:"Min width",description:"Minimum column width (vertical orientation)",defaultValue:c.minVizWidth,settings:{min:0,max:600,step:1},showIf:T=>T.sizing===a.T6.Manual&&T.orientation===a.wV.Vertical}).addSliderInput({path:"minVizHeight",name:"Min height",description:"Minimum row height (horizontal orientation)",defaultValue:c.minVizHeight,settings:{min:0,max:600,step:1},showIf:T=>T.sizing===a.T6.Manual&&T.orientation===a.wV.Horizontal}),o.I(S)}).setPanelChangeHandler(d).setSuggestionsSupplier(new D).setMigrationHandler(f)},19743:(Q,I,e)=>{"use strict";e.d(I,{x:()=>r});var n=e(96540),a=e(1173),o=e(74668);const r=({value:i,context:f,onChange:d})=>{const l=(0,n.useCallback)(m=>{d(m?.length?{id:a.jR.byRefId,options:m}:void 0)},[d]);return n.createElement(o.X,{value:i?.options,onChange:l,data:f.data,placeholder:"Change filter"})}},33744:(Q,I,e)=>{"use strict";e.d(I,{DY:()=>r,G4:()=>d,Sq:()=>m,T5:()=>l,W_:()=>a,_7:()=>o,fX:()=>i,wq:()=>f,yQ:()=>s,yu:()=>h});var n=e(52622),a=(u=>(u.Point="point",u.Line="line",u.Polygon="polygon",u.Any="*any*",u))(a||{});const o=5;var r=(u=>(u.Left="left",u.Center="center",u.Right="right",u))(r||{}),i=(u=>(u.Top="top",u.Middle="middle",u.Bottom="bottom",u))(i||{}),f=(u=>(u.Left="left",u.Center="center",u.Right="right",u))(f||{}),d=(u=>(u.Top="top",u.Center="center",u.Bottom="bottom",u))(d||{});const l=Object.freeze({size:{fixed:o,min:2,max:15},color:{fixed:"dark-green"},opacity:.4,symbol:{mode:n.q_.Fixed,fixed:"img/icons/marker/circle.svg"},symbolAlign:{horizontal:"center",vertical:"center"},textConfig:{fontSize:12,textAlign:"center",textBaseline:"middle",offsetX:0,offsetY:0},rotation:{fixed:0,mode:n.WQ.Mod,min:-360,max:360}});var m=(u=>(u.color="fill",u.opacity="fill-opacity",u.lineWidth="stroke-width",u))(m||{}),s=(u=>(u.color="marker-color",u.size="marker-size",u))(s||{}),h=(u=>(u.color="stroke",u.lineWidth="stroke-width",u))(h||{})},61994:(Q,I,e)=>{"use strict";e.d(I,{A:()=>r});var n=e(32196),a=e(96540),o=e(5636);const r=i=>(0,o.gU)(i)?a.createElement("a",{href:i,target:"_blank",className:(0,n.cx)("external-link"),rel:"noreferrer"},i):i},5636:(Q,I,e)=>{"use strict";e.d(I,{Bz:()=>u,G_:()=>l,cA:()=>h,gU:()=>P,o3:()=>g,q:()=>b,rd:()=>s,ue:()=>f});var n=e(92347),a=e(40239),o=e(63577),r=e(90183),i=e(33744);function f(c,y,p,v){const D={};return v&&Object.keys(v).length?(D.color=(0,o.getColorDimension)(c,v.color??i.T5.color,p),D.size=(0,o.getScaledDimension)(c,v.size??i.T5.size),D.rotation=(0,o.getScalarDimension)(c,v.rotation??i.T5.rotation),v.text&&(v.text.field||v.text.fixed)&&(D.text=(0,o.getTextDimension)(c,v.text))):y.fields&&(y.fields.color&&(D.color=(0,o.getColorDimension)(c,y.config.color??i.T5.color,p)),y.fields.size&&(D.size=(0,o.getScaledDimension)(c,y.config.size??i.T5.size)),y.fields.text&&(D.text=(0,o.getTextDimension)(c,y.config.text)),y.fields.rotation&&(D.rotation=(0,o.getScalarDimension)(c,y.config.rotation??i.T5.rotation))),D}let d;function l(){return d||(d=[],m()),d}async function m(){const c=await(0,r.o)();for(let y of["maps","gazetteer"])c.listFiles(y).subscribe({next:p=>{p.forEach(v=>{if(v.name.endsWith(".geojson")){const D=`public/${y}/${v.name}`;d.push({value:D,label:D})}})}})}const s=(c,y,p)=>{const v=c.initMapView(y.view);return c.map=new n.A({view:v,pixelRatio:1,layers:[],controls:[],target:p,interactions:(0,a.N)({mouseWheelZoom:!1})})},h=(c,y)=>{c.initControls(y.controls),c.forceUpdate()},u=(c,y,p)=>{c.panelContext&&c.panelContext.onInstanceStateChange&&c.panelContext.onInstanceStateChange({map:c.map,layers:y,selected:p,actions:c.actions})},b=c=>{let y=c.layers.length;for(;y<100;){const p=`Layer ${y++}`;if(!c.byName.has(p))return p}return`Layer ${Date.now()}`};function g(c,y,p,v){const D=c.getPixelFromCoordinate(p),E=c.getPixelFromCoordinate(v),S=Math.abs(D[0]-E[0]),T=Math.abs(D[1]-E[1]);return S>y||T>y}const P=c=>{try{return new URL(c).protocol.includes("http")}catch{return!1}}},52995:(Q,I,e)=>{"use strict";e.d(I,{P7:()=>a,uM:()=>o,iS:()=>r,KQ:()=>f});var n=e(52622),a=(d=>(d.Opacity="opacity",d.Scheme="scheme",d))(a||{}),o=(d=>(d.Exponential="exponential",d.Linear="linear",d))(o||{}),r=(d=>(d.X="x",d.Xy="xy",d.Y="y",d))(r||{});const i={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:n.yL.Auto,tooltip:{mode:n.$N.Single,yHistogram:!1,showColorScale:!1}},f={...i,color:{...i.color,mode:a.Scheme,scale:o.Exponential},yAxis:{...i.yAxis,axisPlacement:n.vM.Left},rowsFrame:{...i.rowsFrame,layout:n.D7.auto}}},69386:(Q,I,e)=>{"use strict";e.d(I,{K:()=>s});var n=e(32196),a=e(96540),o=e(70255),r=e(40672),i=e(72724),f=e(40845),d=e(72129);function l({width:u,showImage:b,data:g,index:P}){const c=(0,f.of)(h),y=u>600,p=g.get(P),v=encodeURI(p.title);return a.createElement("article",{"aria-labelledby":v,className:(0,n.cx)(c.item,y&&c.itemWide)},b&&p.ogImage&&a.createElement("a",{tabIndex:-1,href:r.sQ.sanitizeUrl(p.link),target:"_blank",rel:"noopener noreferrer",className:(0,n.cx)(c.socialImage,y&&c.socialImageWide),"aria-hidden":!0},a.createElement("img",{src:p.ogImage,alt:p.title})),a.createElement("div",{className:c.body},a.createElement("time",{className:c.date,dateTime:(0,i.LE)(p.date,{format:"MMM DD"})},(0,i.LE)(p.date,{format:"MMM DD"})," "),a.createElement("a",{className:c.link,href:r.sQ.sanitizeUrl(p.link),target:"_blank",rel:"noopener noreferrer"},a.createElement("h3",{className:c.title,id:v},p.title)),a.createElement("div",{className:c.content,dangerouslySetInnerHTML:{__html:r.sQ.sanitize(p.content)}})))}const m=({width:u,showImage:b,rootProps:g})=>{const P=(0,f.of)(h),c=u>600;return a.createElement("div",{className:(0,n.cx)(P.item,c&&P.itemWide),...g},b&&a.createElement(o.A,{containerClassName:(0,n.cx)(P.socialImage,c&&P.socialImageWide),width:c?"250px":"100%",height:c?"150px":u*.5}),a.createElement("div",{className:P.body},a.createElement(o.A,{containerClassName:P.date,width:60}),a.createElement(o.A,{containerClassName:P.title,width:250}),a.createElement(o.A,{containerClassName:P.content,width:"100%",count:6})))},s=(0,d.j)(l,m),h=u=>({container:(0,n.css)({height:"100%"}),item:(0,n.css)({display:"flex",padding:u.spacing(1),position:"relative",marginBottom:u.spacing(.5),marginRight:u.spacing(1),borderBottom:`2px solid ${u.colors.border.weak}`,background:u.colors.background.primary,flexDirection:"column",flexShrink:0}),itemWide:(0,n.css)({flexDirection:"row"}),body:(0,n.css)({display:"flex",flexDirection:"column",flex:1}),socialImage:(0,n.css)({display:"flex",alignItems:"center",marginBottom:u.spacing(1),"> img":{width:"100%",borderRadius:`${u.shape.radius.default} ${u.shape.radius.default} 0 0`}}),socialImageWide:(0,n.css)({marginRight:u.spacing(2),marginBottom:0,"> img":{width:"250px",borderRadius:u.shape.radius.default}}),link:(0,n.css)({color:u.colors.text.link,display:"inline-block","&:hover":{color:u.colors.text.link,textDecoration:"underline"}}),title:(0,n.css)({fontSize:"16px",marginBottom:u.spacing(.5)}),content:(0,n.css)({p:{marginBottom:u.spacing(.5),color:u.colors.text.primary}}),date:(0,n.css)({marginBottom:u.spacing(.5),fontWeight:500,borderRadius:`0 0 0 ${u.shape.radius.default}`,color:u.colors.text.secondary})})},62372:(Q,I,e)=>{"use strict";e.d(I,{$:()=>n});const n="https://grafana.com/blog/news.xml"},4172:(Q,I,e)=>{"use strict";e.d(I,{n:()=>u});var n=e(41053),a=e(78368);function o(b){const P=new DOMParser().parseFromString(b,"text/xml");return{items:Array.from(P.querySelectorAll("entry")).map(y=>({title:d(y,"title"),link:y.querySelector("link")?.getAttribute("href")??"",content:d(y,"content"),pubDate:d(y,"published"),ogImage:y.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}function r(b){const P=new DOMParser().parseFromString(b,"text/xml");return{items:Array.from(P.querySelectorAll("item")).map(y=>({title:d(y,"title"),link:d(y,"link"),content:d(y,"description"),pubDate:d(y,"pubDate"),ogImage:y.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}async function i(b){return await(await fetch(b)).text()}function f(b){return new DOMParser().parseFromString(b,"text/xml").querySelector("feed")!==null}function d(b,g){return b.querySelector(g)?.textContent??""}async function l(b){const g=await i(b);return f(g)?o(g):r(g)}var m=e(47232),s=e(11261);function h(b){const g=[],P=[],c=[],y=[],p=[];for(const v of b.items){const D=(0,m.KQ)(v.pubDate);try{if(g.push(D.valueOf()),P.push(v.title),c.push(v.link),p.push(v.ogImage),v.content){const E=v.content.replace(/<\/?[^>]+(>|$)/g,"");y.push(E)}}catch(E){console.warn("Error reading news item:",E,v)}}return{fields:[{name:"date",type:s.PU.time,config:{displayName:"Date"},values:g},{name:"title",type:s.PU.string,config:{},values:P},{name:"link",type:s.PU.string,config:{},values:c},{name:"content",type:s.PU.string,config:{},values:y},{name:"ogImage",type:s.PU.string,config:{},values:p}],length:g.length}}function u(b){const[g,P]=(0,n.A)(async()=>{const c=await l(b),y=h(c);return new a.R(y)},[b],{loading:!0});return{state:g,getNews:P}}},23799:(Q,I,e)=>{"use strict";e.d(I,{L:()=>f,h:()=>d});var n=e(69550),a=e(75059),o=e(28240),r=e(54479),i=e(52622);function f(l,m=!0){const s=["Value options"];l.addRadio({path:"reduceOptions.values",name:"Show",description:"Calculate a single value per column or series or show each row",settings:{options:[{value:!1,label:"Calculate"},{value:!0,label:"All values"}]},category:s,defaultValue:!1}),l.addNumberInput({path:"reduceOptions.limit",name:"Limit",description:"Max number of rows to display",category:s,settings:{placeholder:"25",integer:!0,min:1,max:5e3},showIf:h=>h.reduceOptions.values===!0}),l.addCustomEditor({id:"reduceOptions.calcs",path:"reduceOptions.calcs",name:"Calculation",description:"Choose a reducer function / calculation",category:s,editor:n.D.get("stats-picker").editor,defaultValue:[a.gy.lastNotNull],showIf:h=>h.reduceOptions.values===!1}),m&&l.addSelect({path:"reduceOptions.fields",name:"Fields",description:"Select the fields that should be included in the panel",category:s,settings:{allowCustomValue:!0,options:[],getOptions:async h=>{const u=[{value:"",label:"Numeric Fields"},{value:"/.*/",label:"All Fields"}];if(h&&h.data)for(const b of h.data)for(const g of b.fields){const P=(0,o.Ct)(g,b,h.data),c=`/^${(0,r.jD)(P)}$/`;u.push({value:c,label:P})}return Promise.resolve(u)}},defaultValue:""})}function d(l,m){l.addRadio({path:"orientation",name:"Orientation",description:"Layout orientation",category:m,settings:{options:[{value:i.wV.Auto,label:"Auto"},{value:i.wV.Horizontal,label:"Horizontal"},{value:i.wV.Vertical,label:"Vertical"}]},defaultValue:i.wV.Auto})}},36373:(Q,I,e)=>{"use strict";e.r(I),e.d(I,{plugin:()=>E});var n=e(65158),a=e(52622),o=e(71242),r=e(63250),i=e(24293);const f=(S,T,M)=>{const A=(0,r.gl)(S,T,M);if(M.angular&&(T==="singlestat"||T==="grafana-singlestat-panel")){const x=M.angular;if(A.graphMode=a.$p.None,x.sparkline&&x.sparkline.show&&(A.graphMode=a.$p.Area),x.colorBackground)A.colorMode=a.yp.Background;else if(x.colorValue)A.colorMode=a.yp.Value;else if(A.colorMode=a.yp.None,x.sparkline?.lineColor&&A.graphMode===a.$p.Area){const C=S.fieldConfig??{};C.defaults.color={mode:i.Y.Fixed,fixedColor:x.sparkline.lineColor},S.fieldConfig=C}x.valueName==="name"&&(A.textMode=a.SV.Name)}return A};var d=e(2543),l=e(96540),m=e(11261),s=e(56323),h=e(90708),u=e(37494),b=e(59796),g=e(12509),P=e(2913);class c extends l.PureComponent{constructor(){super(...arguments),this.renderComponent=(T,M)=>{const{timeRange:A,options:x}=this.props,{value:C,alignmentFactors:O,width:R,height:L,count:N}=T,{openMenu:F,targetClassName:K}=M;let B=C.sparkline;return B&&(B.timeRange=A),l.createElement(u.yV,{value:C.display,count:N,sparkline:B,colorMode:x.colorMode,graphMode:x.graphMode,justifyMode:x.justifyMode,textMode:this.getTextMode(),alignmentFactors:O,text:x.text,width:R,height:L,theme:P.config.theme2,onClick:F,className:K,disableWideLayout:!x.wideLayout,percentChangeColorMode:x.percentChangeColorMode})},this.renderValue=T=>{const{value:M}=T,{getLinks:A,hasLinks:x}=M;return x&&A?l.createElement(b.e,{links:A},C=>this.renderComponent(T,C)):this.renderComponent(T,{})},this.getValues=()=>{const{data:T,options:M,replaceVariables:A,fieldConfig:x,timeZone:C}=this.props;let O;for(let R of T.series)for(let L of R.fields){let{config:N}=L;if(L.type===m.PU.number){if(L.state?.range)continue;!O&&(!(0,d.isNumber)(N.min)||!(0,d.isNumber)(N.max))&&(O=(0,h.nJ)(T.series));const F=N.min??O.min,K=N.max??O.max;L.state=L.state??{},L.state.range={min:F,max:K,delta:K-F}}}return(0,s.PI)({fieldConfig:x,reduceOptions:M.reduceOptions,replaceVariables:A,theme:P.config.theme2,data:T.series,sparkline:M.graphMode!==a.$p.None,percentChange:M.showPercentChange,timeZone:C})}}getTextMode(){const{options:T,fieldConfig:M,title:A}=this.props;return T.textMode===a.SV.Auto&&(M.defaults.displayName||!A)?a.SV.ValueAndName:T.textMode}render(){const{height:T,options:M,width:A,data:x,renderCounter:C}=this.props;return l.createElement(g.S,{getValues:this.getValues,getAlignmentFactors:s.XS,renderValue:this.renderValue,width:A,height:T,source:x,itemSpacing:3,renderCounter:C,autoGrid:!0,orientation:M.orientation})}}var y=e(23799);const p={colorMode:a.yp.Value,graphMode:a.$p.Area,justifyMode:a.F8.Auto,percentChangeColorMode:a.CD.Standard,showPercentChange:!1,textMode:a.SV.Auto,wideLayout:!0};var v=e(38824);class D{getSuggestionsForData(T){const{dataSummary:M}=T;if(!M.hasData)return;const A=T.getListAppender({name:v.m.Stat,pluginId:"stat",options:{},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:x=>{x.options.reduceOptions.values&&(x.options.reduceOptions.limit=1)}}});M.hasStringField&&M.hasNumberField&&M.frameCount===1&&M.rowCountTotal<10&&(A.append({name:v.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"}}}),A.append({name:v.m.StatColoredBackground,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:a.yp.Background}})),M.stringFieldCount===1&&M.frameCount===1&&M.rowCountTotal<10&&M.fieldCount===1&&A.append({name:v.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:a.yp.None}}),M.hasNumberField&&M.hasTimeField&&(A.append({options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),A.append({name:v.m.StatColoredBackground,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},graphMode:a.$p.None,colorMode:a.yp.Background}}))}}const E=new n.m(c).useFieldConfig().setPanelOptions(S=>{const T=["Stat styles"];(0,y.L)(S),(0,y.h)(S,T),o.I(S),S.addSelect({path:"textMode",name:"Text mode",description:"Control if name and value is displayed or just name",category:T,settings:{options:[{value:a.SV.Auto,label:"Auto"},{value:a.SV.Value,label:"Value"},{value:a.SV.ValueAndName,label:"Value and name"},{value:a.SV.Name,label:"Name"},{value:a.SV.None,label:"None"}]},defaultValue:p.textMode}).addRadio({path:"wideLayout",name:"Wide layout",category:T,settings:{options:[{value:!0,label:"On"},{value:!1,label:"Off"}]},defaultValue:p.wideLayout,showIf:M=>M.textMode===a.SV.ValueAndName}),S.addSelect({path:"colorMode",name:"Color mode",defaultValue:a.yp.Value,category:T,settings:{options:[{value:a.yp.None,label:"None"},{value:a.yp.Value,label:"Value"},{value:a.yp.Background,label:"Background Gradient"},{value:a.yp.BackgroundSolid,label:"Background Solid"}]}}).addRadio({path:"graphMode",name:"Graph mode",description:"Stat panel graph / sparkline mode",category:T,defaultValue:p.graphMode,settings:{options:[{value:a.$p.None,label:"None"},{value:a.$p.Area,label:"Area"}]}}).addRadio({path:"justifyMode",name:"Text alignment",defaultValue:p.justifyMode,category:T,settings:{options:[{value:a.F8.Auto,label:"Auto"},{value:a.F8.Center,label:"Center"}]}}).addBooleanSwitch({path:"showPercentChange",name:"Show percent change",defaultValue:p.showPercentChange,category:T,showIf:M=>!M.reduceOptions.values}).addSelect({path:"percentChangeColorMode",name:"Percent change color mode",defaultValue:p.percentChangeColorMode,category:T,settings:{options:[{value:a.CD.Standard,label:"Standard"},{value:a.CD.Inverted,label:"Inverted"},{value:a.CD.SameAsValue,label:"Same as Value"}]},showIf:M=>M.showPercentChange})}).setNoPadding().setPanelChangeHandler(f).setSuggestionsSupplier(new D).setMigrationHandler(r._$)},21164:(Q,I,e)=>{"use strict";e.d(I,{u:()=>n});const n=(a,o)=>{const r=[],i=new Set;if((a.config.links?.length??0)>0&&a.getLinks!=null){const f=a.values[o],d=a.display?a.display(f):{text:`${f}`,numeric:+f};a.getLinks({calculatedValue:d,valueRowIndex:o}).forEach(l=>{const m=`${l.title}/${l.href}`;i.has(m)||(r.push(l),i.add(m))})}return r}},65885:(Q,I,e)=>{"use strict";e.d(I,{S5:()=>c,fq:()=>f,gy:()=>y,l1:()=>g});var n=e(2543),a=e.n(n),o=e(1173),r=e(50082),i=e(11261);const f=p=>(!p.pluginVersion&&"columns"in p&&console.log("Was angular table",p),p.options),d={timeseries_to_rows:"seriesToRows",timeseries_to_columns:"seriesToColumns",timeseries_aggregations:"reduce",table:"merge"},l={avg:"mean",min:"min",max:"max",total:"sum",current:"lastNotNull",count:"count"},m={cell:"color-background",row:"color-background",value:"color-text"},s=(p,v)=>[-1/0,...p].map((D,E)=>({color:v[E],value:(0,n.isNumber)(D)?D:parseInt(D,10)})),h=(p,v)=>{const D=p.transformations??[];if(Object.keys(d).includes(v.transform)){const E={reducers:[]};v.transform==="timeseries_aggregations"&&(E.includeTimeField=!1,E.reducers=v.columns.map(S=>l[S.value])),D.push({id:d[v.transform],options:E})}return D},u=p=>{const D={matcher:{id:/^\/.*\/$/.test(p.pattern)?o.Ct.byRegexp:o.Ct.byName,options:p.pattern},properties:[]};return p.alias&&D.properties.push({id:"displayName",value:p.alias}),p.unit&&D.properties.push({id:"unit",value:p.unit}),p.decimals&&D.properties.push({id:"decimals",value:p.decimals}),p.type==="date"&&D.properties.push({id:"unit",value:`time: ${p.dateFormat}`}),p.type==="hidden"&&D.properties.push({id:"custom.hidden",value:!0}),p.link&&D.properties.push({id:"links",value:[{title:(0,n.defaultTo)(p.linkTooltip,""),url:(0,n.defaultTo)(p.linkUrl,""),targetBlank:(0,n.defaultTo)(p.linkTargetBlank,!1)}]}),p.colorMode&&D.properties.push({id:"custom.cellOptions",value:{type:m[p.colorMode]}}),p.align&&D.properties.push({id:"custom.align",value:p.align==="auto"?null:p.align}),p.thresholds?.length&&D.properties.push({id:"thresholds",value:{mode:r.O.Absolute,steps:s(p.thresholds,p.colors)}}),D},b=p=>{let v={custom:{}};if(p){if(v=(0,n.omitBy)({unit:p.unit,decimals:p.decimals,displayName:p.alias,custom:{align:p.align==="auto"?null:p.align}},n.isNil),p.thresholds.length){const D={mode:r.O.Absolute,steps:s(p.thresholds,p.colors)};v.thresholds=D}p.colorMode&&(v.custom.cellOptions={type:m[p.colorMode]})}return v},g=(p,v,D)=>{if(v==="table-old"&&D.angular){const E=D.angular,S=h(p,E),T=E.styles.find(x=>x.pattern==="/.*/"),M=b(T),A=E.styles.filter(x=>x.pattern!=="/.*/").map(u);p.transformations=S,p.fieldConfig={defaults:M,overrides:A}}return{}},P=p=>p?.filter(v=>v.meta?.custom?.parentRowIndex===void 0)||[p?.[0]],c=p=>{const v=[];return P(p).filter(E=>!!E&&E.length!==0)?.forEach(E=>{const S=p?.filter(x=>E.refId===x.refId&&x.meta?.custom?.parentRowIndex!==void 0),T=(0,n.groupBy)(S,x=>x.meta?.custom?.parentRowIndex),M=Object.keys(T).map(x=>T[x]),A={...E};S&&S.length>0&&A.fields.push({name:"nested",type:i.PU.nestedFrames,config:{},values:M}),v.push(A)}),v},y=p=>p?.some(v=>v.meta?.custom?.parentRowIndex!==void 0)},11082:(Q,I,e)=>{"use strict";e.d(I,{Z:()=>f});var n=e(96540),a=e(66864),o=e(94354),r=e(51275);const i=[{label:"Never",value:!1},{label:"Threshold",value:36e5}],f=({value:d,onChange:l,item:m})=>{const s=typeof d=="number";return i[1].value=s?d:36e5,n.createElement(a.Gy,null,n.createElement(o.z,{value:d,options:i,onChange:l}),s&&n.createElement(r.g,{value:d,onChange:l,inputPrefix:r.F.GreaterThan,isTime:m.settings?.isTime??!1}))}},43228:(Q,I,e)=>{"use strict";e.d(I,{F:()=>m});var n=e(96540),a=e(66864),o=e(94354),r=e(21594),i=e(29158);const f=[{label:"Solid",value:"solid"},{label:"Dash",value:"dash"},{label:"Dots",value:"dot"}],d=["10, 10","10, 15","10, 20","10, 25","10, 30","10, 40","15, 10","20, 10","25, 10","30, 10","40, 10","50, 10","5, 10","30, 3, 3"].map(h=>({label:h,value:h})),l=["0, 10","0, 20","0, 30","0, 40","0, 3, 3"].map(h=>({label:h,value:h})),m=({value:h,onChange:u})=>{const b=(0,n.useMemo)(()=>h?.fill==="dash"?d:l,[h]),g=(0,n.useMemo)(()=>{if(!h?.dash?.length)return b[0];const P=h.dash?.join(", "),c=b.find(y=>y.value===P);return c||{label:P,value:P}},[h,b]);return n.createElement(a.Gy,null,n.createElement(o.z,{value:h?.fill||"solid",options:f,onChange:P=>{let c;P==="dot"?c=s(l[0].value):P==="dash"&&(c=s(d[0].value)),u({...h,fill:P,dash:c})}}),h?.fill&&h?.fill!=="solid"&&n.createElement(n.Fragment,null,n.createElement(r.l6,{allowCustomValue:!0,options:b,value:g,width:20,onChange:P=>{u({...h,dash:s(P.value??"")})},formatCreateLabel:P=>`Segments: ${s(P).join(", ")}`}),n.createElement("div",null,"\xA0",n.createElement("a",{title:"The input expects a segment list",href:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash#Parameters",target:"_blank",rel:"noreferrer"},n.createElement(i.K,{name:"question-circle",tooltip:"Help"})))))};function s(h){const u=[];for(const b of h.split(/(?:,| )+/)){const g=Number.parseInt(b,10);isNaN(g)||u.push(g)}return u}},51275:(Q,I,e)=>{"use strict";e.d(I,{F:()=>r,g:()=>i});var n=e(96540),a=e(65879),o=e(10354),r=(f=>(f.LessThan="lessthan",f.GreaterThan="greaterthan",f))(r||{});const i=({value:f,onChange:d,inputPrefix:l,isTime:m})=>{let s=a.secondsToHms(f/1e3);m||(s="10");const h=P=>{let c=!1;if(P)try{m&&a.isValidTimeSpan(P)?c=a.intervalToMs(P):c=Number(P)}catch(y){console.warn("ERROR",y)}d(c)},u=P=>{P.key==="Enter"&&h(P.currentTarget.value)},b=P=>{h(P.currentTarget.value)},g=l==="greaterthan"?n.createElement("div",null,">"):l==="lessthan"?n.createElement("div",null,"<"):null;return n.createElement(o.p,{autoFocus:!1,placeholder:"never",width:10,defaultValue:s,onKeyDown:u,onBlur:b,prefix:g,spellCheck:!1})}},34163:(Q,I,e)=>{"use strict";e.d(I,{e:()=>f});var n=e(96540),a=e(66864),o=e(94354),r=e(51275);const i=[{label:"Never",value:!1},{label:"Always",value:!0},{label:"Threshold",value:36e5}],f=({value:d,onChange:l,item:m})=>{const s=typeof d=="number";return i[2].value=s?d:36e5,n.createElement(a.Gy,null,n.createElement(o.z,{value:d,options:i,onChange:l}),s&&n.createElement(r.g,{value:d,onChange:l,inputPrefix:r.F.LessThan,isTime:m.settings?.isTime??!1}))}},24882:(Q,I,e)=>{"use strict";e.d(I,{D:()=>o});var n=e(96540),a=e(21594);const o=({item:r,value:i,onChange:f,id:d})=>{const l=(0,n.useCallback)(m=>{f({mode:m.value})},[f]);return n.createElement(a.l6,{inputId:d,value:i.mode,options:r.settings?.options??[],onChange:l})}},22731:(Q,I,e)=>{"use strict";e.d(I,{$:()=>P,k:()=>g});var n=e(32196),a=e(96540),o=e(83195),r=e(11261),i=e(52622),f=e(40845),d=e(11389),l=e(58749),m=e(52415),s=e(10875),h=e(21164),u=e(5514),b=e(82915);const g=({series:c,_rest:y,dataIdxs:p,seriesIdx:v,mode:D=i.$N.Single,sortOrder:E=i.xB.None,isPinned:S,annotate:T,maxHeight:M})=>{const A=(0,f.of)(P),x=c.fields[0],C=(0,o.cN)(x.display(x.values[p[0]])),O=(0,s.cp)(c.fields,x,p,v,D,E,N=>N.type===r.PU.number||N.type===r.PU.enum);y?.forEach(N=>{N.config.custom?.hideFrom?.tooltip||O.push({label:N.state?.displayName??N.name,value:(0,u.S)(N,N.values[p[0]])})});let R;if(S&&v!=null){const N=c.fields[v],F=p[v],K=(0,h.u)(N,F);R=a.createElement(l.S,{dataLinks:K,annotate:T})}const L=x.config.custom?.hideFrom?.tooltip?null:{label:x.type===r.PU.time?"":x.state?.displayName??x.name,value:C};return a.createElement("div",{className:A.wrapper},L!=null&&a.createElement(m.A,{item:L,isPinned:S}),a.createElement(d.o,{items:O,isPinned:S,scrollable:(0,b.T5)({mode:D,maxHeight:M}),maxHeight:M}),R)},P=()=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column"})})},41706:(Q,I,e)=>{"use strict";e.d(I,{S:()=>g,V:()=>c});var n=e(37055),a=e(24293),o=e(11261),r=e(27310),i=e(52622),f=e(52198),d=e(56675),l=e(38248),m=e(11404),s=e(11082),h=e(43228),u=e(34163),b=e(24882);const g={drawStyle:i.GR.Line,lineInterpolation:i.dx.Linear,lineWidth:1,fillOpacity:0,gradientMode:i.on.None,barAlignment:i.Nj.Center,stacking:{mode:i.gs.None,group:"A"},axisGridShow:!0,axisCenteredZero:!1,axisBorderShow:!1},P=["Graph styles"];function c(y,p=!0){return{standardOptions:{[n.uo.Color]:{settings:{byValueSupport:!0,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:a.Y.PaletteClassic}}},useCustomConfig:v=>{v.addRadio({path:"drawStyle",name:"Style",category:P,defaultValue:y.drawStyle,settings:{options:f.t.drawStyle}}).addRadio({path:"lineInterpolation",name:"Line interpolation",category:P,defaultValue:y.lineInterpolation,settings:{options:f.t.lineInterpolation},showIf:D=>D.drawStyle===i.GR.Line}).addRadio({path:"barAlignment",name:"Bar alignment",category:P,defaultValue:y.barAlignment,settings:{options:f.t.barAlignment},showIf:D=>D.drawStyle===i.GR.Bars}).addSliderInput({path:"lineWidth",name:"Line width",category:P,defaultValue:y.lineWidth,settings:{min:0,max:10,step:1,ariaLabelForHandle:"Line width"},showIf:D=>D.drawStyle!==i.GR.Points}).addSliderInput({path:"fillOpacity",name:"Fill opacity",category:P,defaultValue:y.fillOpacity,settings:{min:0,max:100,step:1,ariaLabelForHandle:"Fill opacity"},showIf:D=>D.drawStyle!==i.GR.Points}).addRadio({path:"gradientMode",name:"Gradient mode",category:P,defaultValue:f.t.fillGradient[0].value,settings:{options:f.t.fillGradient},showIf:D=>D.drawStyle!==i.GR.Points}).addFieldNamePicker({path:"fillBelowTo",name:"Fill below to",category:P,hideFromDefaults:!0,settings:{filter:D=>D.type===o.PU.number}}).addCustomEditor({id:"lineStyle",path:"lineStyle",name:"Line style",category:P,showIf:D=>D.drawStyle===i.GR.Line,editor:h.F,override:h.F,process:r.hS,shouldApply:D=>D.type===o.PU.number}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:"Connect null values",category:P,defaultValue:!1,editor:u.e,override:u.e,showIf:D=>D.drawStyle===i.GR.Line,shouldApply:D=>D.type!==o.PU.time,process:r.hS,settings:{isTime:p}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:"Disconnect values",category:P,defaultValue:!1,editor:s.Z,override:s.Z,showIf:D=>D.drawStyle===i.GR.Line,shouldApply:D=>D.type!==o.PU.time,process:r.hS,settings:{isTime:p}}).addRadio({path:"showPoints",name:"Show points",category:P,defaultValue:f.t.showPoints[0].value,settings:{options:f.t.showPoints},showIf:D=>D.drawStyle!==i.GR.Points}).addSliderInput({path:"pointSize",name:"Point size",category:P,defaultValue:5,settings:{min:1,max:40,step:1,ariaLabelForHandle:"Point size"},showIf:D=>D.showPoints!==i.yL.Never||D.drawStyle===i.GR.Points}),d.I(v,y.stacking,P),v.addSelect({category:P,name:"Transform",path:"transform",settings:{options:[{label:"Constant",value:i.NU.Constant,description:"The first value will be shown as a constant line"},{label:"Negative Y",value:i.NU.NegativeY,description:"Flip the results to negative values on the y axis"}],isClearable:!0},hideFromDefaults:!0}),l.r(v,y),m.e(v),v.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:"Show thresholds",category:["Thresholds"],defaultValue:{mode:i.Ly.Off},settings:{options:f.t.thresholdsDisplayModes},editor:b.D,override:b.D,process:r.hS,shouldApply:()=>!0})}}}},62567:(Q,I,e)=>{"use strict";e.d(I,{W:()=>ne});var n=e(32196),a=e(96540),o=e(40961),r=e(84140),i=e(36613),f=e(33948),d=e(52622),l=e(23596),m=e(24284),s=e(17464),h=e(40845),u=e(7315),b=e(36376),g=e(13544),P=e(49785),c=e(29647),y=e(41053),p=e(72724),v=e(42994),D=e(79041),E=e(67061),S=e(88575),T=e(21744),M=e(55852),A=e(72235),x=e(99818),C=e(10154);const O=({annoVals:Z,annoIdx:z,dismiss:q,timeZone:ie,...de})=>{const ue=(0,h.of)(R),{onAnnotationCreate:fe,onAnnotationUpdate:Se}=(0,D.d2)(),he=(0,a.useRef)(null);(0,c.A)(he,q);const[ce,me]=(0,y.A)(async Me=>{const $e=await fe(Me);return q(),$e}),[pe,ye]=(0,y.A)(async Me=>{const $e=await Se(Me);return q(),$e}),Pe=Me=>(0,p.LE)(Me,{format:v.WC.fullDate,timeZone:ie}),Ie=Z.id?.[z]!=null,Oe=Z.isRegion?.[z],Ne=Ie?ye:me,We=Ie?pe:ce,Ae=Oe?`${Pe(Z.time[z])} - ${Pe(Z.timeEnd[z])}`:Pe(Z.time[z]),Ue=({tags:Me,description:$e})=>{Ne({id:Z.id?.[z]??void 0,tags:Me,description:$e,from:Math.round(Z.time[z]),to:Math.round(Z.timeEnd?.[z]??Z.time[z])})};return a.createElement("div",{ref:he,className:ue.editor,...de},a.createElement("div",{className:ue.header},a.createElement(E.B,{justifyContent:"space-between",alignItems:"center"},a.createElement("div",null,Ie?"Edit annotation":"Add annotation"),a.createElement("div",null,Ae))),a.createElement(A.l,{onSubmit:Ue,defaultValues:{description:Z.text?.[z],tags:Z.tags?.[z]||[]}},({register:Me,errors:$e,control:ke})=>a.createElement(a.Fragment,null,a.createElement("div",{className:ue.content},a.createElement(S.D,{label:"Description",invalid:!!$e.description,error:$e?.description?.message},a.createElement(T.f,{className:ue.textarea,...Me("description",{required:"Annotation description is required"})})),a.createElement(S.D,{label:"Tags"},a.createElement(P.xI,{control:ke,name:"tags",render:({field:{ref:Ze,onChange:ot,...xt}})=>a.createElement(x.$,{allowCustomValue:!0,placeholder:"Add tags",onChange:ot,tagOptions:C.vy,tags:xt.value})}))),a.createElement("div",{className:ue.footer},a.createElement(E.B,{justifyContent:"flex-end"},a.createElement(M.$n,{size:"sm",variant:"secondary",onClick:q,fill:"outline"},"Cancel"),a.createElement(M.$n,{size:"sm",type:"submit",disabled:We?.loading},We?.loading?"Saving":"Save"))))))},R=Z=>({editor:(0,n.css)({background:Z.colors.background.primary,border:`1px solid ${Z.colors.border.weak}`,borderRadius:Z.shape.radius.default,boxShadow:Z.shadows.z3,userSelect:"text",width:"460px"}),content:(0,n.css)({padding:Z.spacing(1)}),header:(0,n.css)({borderBottom:`1px solid ${Z.colors.border.weak}`,padding:Z.spacing(.5,1),fontWeight:Z.typography.fontWeightBold,fontSize:Z.typography.fontSize,color:Z.colors.text.primary}),footer:(0,n.css)({borderTop:`1px solid ${Z.colors.border.weak}`,padding:Z.spacing(1,1)}),textarea:(0,n.css)({color:Z.colors.text.secondary,fontSize:Z.typography.bodySmall.fontSize})});var L=e(40672),N=e(66864),F=e(29158),K=e(78369),B=e(55907);const w=()=>!1,U=({annoVals:Z,annoIdx:z,timeZone:q,onEdit:ie})=>{const de=Z.id?.[z],ue=(0,h.of)(W),{canEditAnnotations:fe=w,canDeleteAnnotations:Se=w,onAnnotationDelete:he}=(0,D.d2)(),ce=Z.dashboardUID?.[z],me=fe(ce),pe=Se(ce)&&he!=null,ye=Ae=>(0,p.LE)(Ae,{format:v.WC.fullDate,timeZone:q});let Pe=ye(Z.time[z]),Ie=Z.text?.[z]??"";Z.isRegion?.[z]&&(Pe+=" - "+ye(Z.timeEnd[z]));let Oe;Z.login?.[z]&&Z.avatarUrl?.[z]&&(Oe=a.createElement("img",{className:ue.avatar,alt:"Annotation avatar",src:Z.avatarUrl[z]}));let Ne=null,We="";if(Z.alertId?.[z]!==void 0&&Z.newState?.[z]){const Ae=B.A.getStateDisplayModel(Z.newState[z]);Ne=a.createElement("div",{className:ue.alertState},a.createElement("i",{className:Ae.stateClass},Ae.text)),We=Z.data?.[z]?B.A.getAlertAnnotationText(Z.data[z]):""}else Z.title?.[z]&&(Ie=Z.title[z]+(Ie?`<br />${Ie}`:""));return a.createElement("div",{className:ue.wrapper},a.createElement("div",{className:ue.header},a.createElement(N.Gy,{justify:"space-between",align:"center",spacing:"md"},a.createElement("div",{className:ue.meta},a.createElement("span",null,Oe,Ne),Pe),(me||pe)&&a.createElement("div",{className:ue.editControls},me&&a.createElement(F.K,{name:"pen",size:"sm",onClick:ie,tooltip:"Edit"}),pe&&a.createElement(F.K,{name:"trash-alt",size:"sm",onClick:()=>he(de),tooltip:"Delete"})))),a.createElement("div",{className:ue.body},Ie&&a.createElement("div",{className:ue.text,dangerouslySetInnerHTML:{__html:L.sQ.sanitize(Ie)}}),We,a.createElement("div",null,a.createElement(N.Gy,{spacing:"xs",wrap:!0},Z.tags?.[z]?.map((Ae,Ue)=>a.createElement(K.v,{name:Ae,key:`${Ae}-${Ue}`}))))))},W=Z=>({wrapper:(0,n.css)({zIndex:Z.zIndex.tooltip,whiteSpace:"initial",borderRadius:Z.shape.radius.default,background:Z.colors.background.primary,border:`1px solid ${Z.colors.border.weak}`,boxShadow:Z.shadows.z2,userSelect:"text"}),header:(0,n.css)({padding:Z.spacing(.5,1),borderBottom:`1px solid ${Z.colors.border.weak}`,fontWeight:Z.typography.fontWeightBold,fontSize:Z.typography.fontSize,color:Z.colors.text.primary,display:"flex"}),meta:(0,n.css)({display:"flex",justifyContent:"space-between",color:Z.colors.text.primary,fontWeight:400}),editControls:(0,n.css)({display:"flex",alignItems:"center","> :last-child":{marginLeft:0}}),body:(0,n.css)({padding:Z.spacing(1),fontSize:Z.typography.bodySmall.fontSize,color:Z.colors.text.secondary,fontWeight:400,a:{color:Z.colors.text.link,"&:hover":{textDecoration:"underline"}}}),text:(0,n.css)({paddingBottom:Z.spacing(1)}),avatar:(0,n.css)({borderRadius:Z.shape.radius.circle,width:16,height:16,marginRight:Z.spacing(1)}),alertState:(0,n.css)({paddingRight:Z.spacing(1),fontWeight:Z.typography.fontWeightMedium})}),V=0,_=1,H=2,G=({annoVals:Z,annoIdx:z,className:q,style:ie,exitWipEdit:de,timeZone:ue,portalRoot:fe})=>{const Se=(0,h.of)(j),[he,ce]=(0,a.useState)(de!=null?_:V),{refs:me,floatingStyles:pe}=(0,b.we)({open:!0,placement:"bottom",middleware:[(0,u.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,u.BN)()],whileElementsMounted:u.ll,strategy:"fixed"}),ye=he===H?a.createElement(U,{annoIdx:z,annoVals:Z,timeZone:ue,onEdit:()=>ce(_)}):he===_?a.createElement(O,{annoIdx:z,annoVals:Z,timeZone:ue,dismiss:()=>{de?.(),ce(V)}}):null;return a.createElement("div",{ref:me.setReference,className:q,style:ie,onMouseEnter:()=>he!==_&&ce(H),onMouseLeave:()=>he!==_&&ce(V),"data-testid":g.Tp.pages.Dashboard.Annotations.marker},ye&&(0,o.createPortal)(a.createElement("div",{ref:me.setFloating,className:Se.annoBox,style:pe,"data-testid":"annotation-marker"},ye),fe))},j=Z=>({annoBox:(0,n.css)({top:0,left:0,zIndex:Z.zIndex.tooltip,borderRadius:Z.shape.radius.default,position:"absolute",background:Z.colors.background.primary,border:`1px solid ${Z.colors.border.weak}`,boxShadow:Z.shadows.z2,userSelect:"text",minWidth:"300px"})}),Y=(Z,z,q,ie,de)=>{Z.beginPath(),Z.moveTo(ie,z),Z.lineTo(ie,q),Z.strokeStyle=de,Z.stroke()},oe=(0,r.A)(m.Mk).toHex8String();function se(Z){let z={};return Z.fields.forEach(q=>{z[q.name]=q.values}),z}const ne=({annotations:Z,timeZone:z,config:q,newRange:ie,setNewRange:de,canvasRegionRendering:ue=!0})=>{const[fe,Se]=(0,a.useState)(),[he]=(0,a.useState)(()=>(0,s.gF)()),ce=(0,h.of)(ee),me=(0,h.$j)().visualization.getColorByName,[pe,ye]=(0,a.useReducer)(Ae=>Ae+1,0),Pe=(0,a.useMemo)(()=>{let Ae=Z.filter(Ue=>Ue.name!=="exemplar"&&Ue.length>0&&Ue.fields.some(Me=>Me.name==="time"));if(ie){let Ue=ie.to>ie.from;const Me=(0,f.I)([{time:ie.from,timeEnd:Ue?ie.to:null,isRegion:Ue,color:oe}]);Me.meta={dataTopic:d.QR.Annotations,custom:{isWip:!0}},Ae.push(Me)}return Ae},[Z,ie]),Ie=(0,a.useCallback)(()=>{de(null)},[de]),Oe=(0,a.useRef)(Pe);Oe.current=Pe;const Ne=(0,a.useRef)(ie);Ne.current=ie;const We=(0,a.useRef)();if((0,a.useLayoutEffect)(()=>{q.addHook("ready",Ae=>{let Ue=Ae.root.querySelector(".u-axis");We.current=Ue,Se(Ae)}),q.addHook("draw",Ae=>{let Ue=Oe.current;const Me=Ae.ctx;Me.save(),Me.beginPath(),Me.rect(Ae.bbox.left,Ae.bbox.top,Ae.bbox.width,Ae.bbox.height),Me.clip(),Ue.forEach($e=>{let ke=se($e);if($e.name==="xymark"){let Ze=q.scales[0].props.scaleKey,ot=q.scales[1].props.scaleKey;for(let xt=0;xt<$e.length;xt++){let ct=me(ke.color?.[xt]||oe),ft=Ae.valToPos(ke.xMin[xt],Ze,!0),Le=Ae.valToPos(ke.xMax[xt],Ze,!0),re=Ae.valToPos(ke.yMax[xt],ot,!0),X=Ae.valToPos(ke.yMin[xt],ot,!0);Me.fillStyle=l.alpha(ct,ke.fillOpacity[xt]),Me.fillRect(ft,re,Le-ft,X-re),Me.lineWidth=Math.round(ke.lineWidth[xt]*i.A.pxRatio),ke.lineStyle[xt]==="dash"?Me.setLineDash([5,5]):Me.setLineDash([]),Me.strokeStyle=ct,Me.strokeRect(ft,re,Le-ft,X-re)}}else{let Ze=Ae.bbox.top,ot=Ze+Ae.bbox.height;Me.lineWidth=2,Me.setLineDash([5,5]);for(let xt=0;xt<ke.time.length;xt++){let ct=me(ke.color?.[xt]||oe),ft=Ae.valToPos(ke.time[xt],"x",!0);if(!ke.isRegion?.[xt])Y(Me,Ze,ot,ft,ct);else if(ue){Y(Me,Ze,ot,ft,ct);let Le=Ae.valToPos(ke.timeEnd[xt],"x",!0);Y(Me,Ze,ot,Le,ct),Me.fillStyle=l.alpha(ct,.1),Me.fillRect(ft,Ze,Le-ft,Ae.bbox.height)}}}}),Me.restore()})},[q,ue,me]),(0,a.useEffect)(()=>{fe&&(fe.redraw(),setTimeout(()=>{ye()},0))},[Pe,fe]),fe){let Ae=Pe.flatMap((Ue,Me)=>{let $e=se(Ue),ke=[];for(let Ze=0;Ze<$e.time.length;Ze++){let ot=me($e.color?.[Ze]||m.Mk),xt=Math.round(fe.valToPos($e.time[Ze],"x"))||0,ct=null,ft="",Le=!0;if($e.isRegion?.[Ze]){let re=Math.round(fe.valToPos($e.timeEnd?.[Ze],"x"))||0;if(Le=xt<fe.rect.width&&re>0,Le){let X=Math.max(0,xt),le=Math.min(fe.rect.width,re);ct={left:X,background:ot,width:le-X},ft=ce.annoRegion}}else Le=xt>=0&&xt<=fe.rect.width,Le&&(ct={left:xt,borderBottomColor:ot},ft=ce.annoMarker);if(Le){let re=Ue.meta?.custom?.isWip;ke.push(a.createElement(G,{annoIdx:Ze,annoVals:$e,className:ft,style:ct,timeZone:z,key:`${Me}:${Ze}`,exitWipEdit:re?Ie:null,portalRoot:he}))}}return ke});return(0,o.createPortal)(Ae,We.current)}return null},ee=()=>({annoMarker:(0,n.css)({position:"absolute",width:0,height:0,borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderBottomWidth:"5px",borderBottomStyle:"solid",transform:"translateX(-50%)",cursor:"pointer",zIndex:1}),annoRegion:(0,n.css)({position:"absolute",height:"5px",cursor:"pointer",zIndex:1})})},7874:(Q,I,e)=>{"use strict";e.d(I,{U:()=>o});var n=e(96540),a=e(55852);const o=({config:r,onChangeTimeRange:i})=>{const f=(0,n.useRef)(),[d,l]=(0,n.useState)([]),[m,s]=(0,n.useState)();if((0,n.useLayoutEffect)(()=>{r.addHook("init",y=>{f.current=y}),r.addHook("setScale",y=>{l(y.data?.[0]??[]),s(y.scales.x??void 0)})},[r]),d.length<2||!i||!m||!m.time||!m.min||!m.max)return null;let h=0,u=d.length-1;for(;h<=u&&d[h]==null;)h++;for(;u>=0&&d[u]==null;)u--;const b=d[h],g=d[u],P=m.min,c=m.max;return b==null||g==null||b<=c&&g>=P?null:n.createElement("div",{style:{position:"absolute",top:"50%",transform:"translateY(-50%)",width:"100%",textAlign:"center"}},n.createElement("div",null,n.createElement("div",null,"Data outside time range"),n.createElement(a.$n,{onClick:y=>i({from:b,to:g}),variant:"secondary","data-testid":"time-series-zoom-to-data"},"Zoom to data")))};o.displayName="OutsideRangePlugin"},82915:(Q,I,e)=>{"use strict";e.d(I,{B_:()=>h,Fg:()=>g,O2:()=>b,T5:()=>P});var n=e(11261),a=e(28240),o=e(83195),r=e(57875),i=e(50311),f=e(46294),d=e(39624),l=e(52622),m=e(55129);function s(c){let y=new Map;return c.map(v=>({...v,fields:v.fields.map(D=>{if(D.type===n.PU.enum){let E=(0,m.M)(D.config,D.type),S=y.get(E);S||(S=[],y.set(E,S));let T=D.values.toArray().slice(),M=D.config.type.enum.text;if(S.length>0)for(let A=0;A<T.length;A++)T[A]+=S.length;return S.push(...M),D.config.type.enum.text=S,{...D,values:T}}return D})}))}function h(c,y,p,v){if(!c?.length)return null;(0,a.Fm)(c);let D=v!=null;v!=null&&v>0&&(c=[{...c[0],fields:[c[0].fields[v],...c[0].fields.filter((M,A)=>A!==v)]}]);for(let M of c)for(let A of M.fields)A.type===n.PU.time&&typeof A.values[0]!="number"&&(A.values=(0,i.s7)(A,{destinationType:n.PU.time}).values);let E=0;e:for(let M of c)for(let A of M.fields)if(A.type===n.PU.enum&&++E>1){c=s(c);break e}let S;const T=[];for(let M of c){const A=[];let x=!1,C=!1,O=D?M:(0,f.M)({frame:M,refFieldPseudoMin:p?.from.valueOf(),refFieldPseudoMax:p?.to.valueOf()});const R=(0,d.C)(O).fields;for(let L=0;L<R?.length;L++){const N=R[L];switch(N.type){case n.PU.time:x=!0,A.push(N);break;case n.PU.number:C=D?L>0:!0,S={...N,values:N.values.map(B=>Number.isFinite(B)||B==null?B:null)},A.push(S);break;case n.PU.enum:C=!0;case n.PU.string:S={...N,values:N.values},A.push(S);break;case n.PU.boolean:C=!0;const F=N.config?.custom??{},K={...N.config,max:1,min:0,custom:F};F.lineInterpolation!==l.dx.StepBefore&&(F.lineInterpolation=l.dx.StepAfter),S={...N,config:K,type:n.PU.number,values:N.values.map(B=>B==null?B:B?1:0)},(0,o.j9)(K.unit)||(K.unit="bool",S.display=(0,r.J)({field:S,theme:y})),A.push(S);break}}(D||x)&&C&&T.push({...M,length:O.length,fields:A})}return T.length?(b(T,y,0),u(T,y),T):null}const u=(c,y)=>{const{palette:p}=y.visualization;for(const v of c)for(const D of v.fields)if(D.type===n.PU.enum){const E=p[D.state?.seriesIndex%p.length],S=y.visualization.getColorByName(E),T=D.config.type.enum;T.color=Array(T.text.length).fill(S),D.display=(0,r.J)({field:D,theme:y})}},b=(c,y,p)=>{let v=0;c.forEach(D=>{D.fields.forEach((E,S)=>{S!==p&&(E.type===n.PU.number||E.type===n.PU.boolean||E.type===n.PU.enum)&&(E.state={...E.state,seriesIndex:v++},E.display=(0,r.J)({field:E,theme:y}))})})};function g(c,y){return!c||!c.length?[y]:c.map(p=>p?.length?p:y)}const P=c=>c.mode===l.$N.Multi&&c.maxHeight!=null},5514:(Q,I,e)=>{"use strict";e.d(I,{S:()=>a});var n=e(83195);function a(o,r){return o.display?(0,n.cN)(o.display(r)):`${r}`}},65191:(Q,I,e)=>{"use strict";e.d(I,{jK:()=>Eo,kz:()=>co});var n=e(96540),a=e(24180),o=e(39070),r=e(32196),i=e(32264),f=e(40845),d=e(42418),l=e(67061),m=e(55852),s=e(19361),h=e(8484),u=e(53153),b=e(87570),g=e(4691),P=e(20851),c=e(2543),y=e(58649),p=e(14578),v=e(2913);const D=()=>{const At=!!v.Ay.oauth;return{saml:{bgColor:"#464646",enabled:v.Ay.samlEnabled,name:v.Ay.samlName||y.En,icon:"key-skeleton-alt"},google:{bgColor:"#e84d3c",enabled:At&&!!v.Ay.oauth.google,name:v.Ay.oauth?.google?.name||"Google",icon:v.Ay.oauth?.google?.icon||"google"},azuread:{bgColor:"#2f2f2f",enabled:At&&!!v.Ay.oauth.azuread,name:v.Ay.oauth?.azuread?.name||"Microsoft",icon:v.Ay.oauth?.azuread?.icon||"microsoft"},github:{bgColor:"#464646",enabled:At&&!!v.Ay.oauth.github,name:v.Ay.oauth?.github?.name||"GitHub",icon:v.Ay.oauth?.github?.icon||"github"},gitlab:{bgColor:"#fc6d26",enabled:At&&!!v.Ay.oauth.gitlab,name:v.Ay.oauth?.gitlab?.name||"GitLab",icon:v.Ay.oauth?.gitlab?.icon||"gitlab"},grafanacom:{bgColor:"#262628",enabled:At&&!!v.Ay.oauth.grafana_com,name:v.Ay.oauth?.grafana_com?.name||"Grafana.com",icon:v.Ay.oauth?.grafana_com?.icon||"grafana",hrefName:"grafana_com"},okta:{bgColor:"#2f2f2f",enabled:At&&!!v.Ay.oauth.okta,name:v.Ay.oauth?.okta?.name||"Okta",icon:v.Ay.oauth?.okta?.icon||"okta"},oauth:{bgColor:"#262628",enabled:At&&!!v.Ay.oauth.generic_oauth,name:v.Ay.oauth?.generic_oauth?.name||"OAuth",icon:v.Ay.oauth?.generic_oauth?.icon||"signin",hrefName:"generic_oauth"}}},E=At=>({button:(0,r.css)({color:"#d8d9da",position:"relative"}),buttonIcon:(0,r.css)({position:"absolute",left:At.spacing(1),top:"50%",transform:"translateY(-50%)"}),divider:{base:(0,r.css)({color:At.colors.text.primary,display:"flex",marginBottom:At.spacing(1),justifyContent:"space-between",textAlign:"center",width:"100%"}),line:(0,r.css)({width:100,height:10,borderBottom:`1px solid ${At.colors.text}`})}}),S=()=>{const At=(0,f.of)(E);return n.createElement(n.Fragment,null,n.createElement("div",{className:At.divider.base},n.createElement("div",null,n.createElement("div",{className:At.divider.line})),n.createElement("div",null,n.createElement("span",null,!v.Ay.disableLoginForm&&n.createElement("span",null,"or"))),n.createElement("div",null,n.createElement("div",{className:At.divider.line}))),n.createElement("div",{className:"clearfix"}))};function T(At,an,cn){return(0,r.cx)(an.button,(0,r.css)({backgroundColor:At.bgColor,color:cn.colors.getContrastText(At.bgColor),"&:hover":{backgroundColor:cn.colors.emphasize(At.bgColor,.15),boxShadow:cn.shadows.z1}}))}const M=()=>{const At=(0,c.pickBy)(D(),ha=>ha.enabled),an=Object.keys(At).length>0,cn=(0,f.$j)(),On=(0,f.of)(E);return an?n.createElement(l.B,{direction:"column",width:"100%"},n.createElement(S,null),Object.entries(At).map(([ha,la])=>{const Ns=la.name;return n.createElement(m.z9,{key:ha,className:T(la,On,cn),href:`login/${la.hrefName?la.hrefName:ha}`,target:"_self",fullWidth:!0},n.createElement(p.I,{className:On.buttonIcon,name:la.icon}),n.createElement(h.x6,{i18nKey:"login.services.sing-in-with-prefix"},"Sign in with ",{serviceName:Ns}))})):null},A=()=>{const At=(0,v.zj)().verifyEmailEnabled?`${(0,v.zj)().appSubUrl}/verify`:`${(0,v.zj)().appSubUrl}/signup`,an=(0,r.css)({paddingTop:"16px"});return n.createElement(l.B,{direction:"column"},n.createElement("div",{className:an},n.createElement(h.x6,{i18nKey:"login.signup.new-to-question"},"New to Grafana?")),n.createElement(m.z9,{className:(0,r.css)({width:"100%",justifyContent:"center"}),href:At,variant:"secondary",fill:"outline"},n.createElement(h.x6,{i18nKey:"login.signup.button-label"},"Sign up")))},x=()=>{const At=(0,f.of)(C);return document.title=s.M.AppTitle,n.createElement(b.A,null,({loginHint:an,passwordHint:cn,disableLoginForm:On,disableUserSignUp:ha,login:la,isLoggingIn:Ns,changePassword:Ds,skipPasswordChange:Js,isChangingPassword:Rs,showDefaultPasswordWarning:Er,loginErrorMessage:Vs})=>n.createElement(P.GU,{isChangingPassword:Rs},!Rs&&n.createElement(P.qm,null,Vs&&n.createElement(d.F,{className:At.alert,severity:"error",title:(0,h.t)("login.error.title","Login failed")},Vs),!On&&n.createElement(g.Q,{onSubmit:la,loginHint:an,passwordHint:cn,isLoggingIn:Ns},n.createElement(l.B,{justifyContent:"flex-end"},!i.$.auth.disableLogin&&n.createElement(m.z9,{className:At.forgottenPassword,fill:"text",href:`${i.$.appSubUrl}/user/password/send-reset-email`},n.createElement(h.x6,{i18nKey:"login.forgot-password"},"Forgot your password?")))),n.createElement(M,null),!ha&&n.createElement(A,null)),Rs&&n.createElement(P.qm,null,n.createElement(u.S,{showDefaultPasswordWarning:Er,onSubmit:Ds,onSkip:()=>Js()}))))},C=At=>({forgottenPassword:(0,r.css)({padding:0,marginTop:At.spacing(.5)}),alert:(0,r.css)({width:"100%"})});var O=e(67608),R=e(25249),L=e(10860);function N({description:At,text:an,url:cn}){const On=(0,f.of)(F);return n.createElement(L.Z,{className:On.card,href:cn},n.createElement(L.Z.Heading,null,an),n.createElement(L.Z.Description,{className:On.description},At))}const F=At=>({card:(0,r.css)({marginBottom:0,gridTemplateRows:"1fr 0 2fr"}),description:(0,r.css)({WebkitLineClamp:3,WebkitBoxOrient:"vertical",display:"-webkit-box",overflow:"hidden"})});function K({navId:At,header:an}){const{node:cn}=(0,R.C)(At),On=(0,f.of)(B),ha=cn.children?.filter(la=>!la.hideFromTabs);return n.createElement(O.Y,{navId:cn.id},n.createElement(O.Y.Contents,null,n.createElement("div",{className:On.content},an,ha&&ha.length>0&&n.createElement("section",{className:On.grid},ha?.map(la=>n.createElement(N,{key:la.id,description:la.subTitle,text:la.text,url:la.url??""}))))))}const B=At=>({content:(0,r.css)({display:"flex",flexDirection:"column",gap:At.spacing(2)}),grid:(0,r.css)({display:"grid",gap:At.spacing(3),gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gridAutoRows:"138px",padding:At.spacing(2,0)})});var w=e(64388),U=e(7392);function W(){return n.createElement(O.Y,{navId:"home",layout:w.k.Canvas,pageNav:{text:"Page not found"}},n.createElement(U.L,{entity:"Page"}))}var V=e(16233),_=e(71468),H=e(33378),G=e(10096),j=e(31678),Y=e(72724);const oe="dddd YYYY-MM-DD HH:mm zz",se="/admin/authentication/ldap";class ne extends n.PureComponent{constructor(){super(...arguments),this.onUserSync=()=>{this.props.onUserSync()}}render(){const{ldapSyncInfo:an,user:cn}=this.props,ha=an&&an.nextSync?(0,Y.LE)(an.nextSync,{format:oe}):"",la=`${se}?user=${cn&&cn.login}`,Ns=G.contextSrv.hasPermission(j.AccessControlAction.LDAPUsersRead),Ds=G.contextSrv.hasPermission(j.AccessControlAction.LDAPUsersSync);return n.createElement(n.Fragment,null,n.createElement("h3",{className:"page-heading"},"LDAP Synchronisation"),n.createElement("div",{className:"gf-form-group"},n.createElement("div",{className:"gf-form"},n.createElement("table",{className:"filter-table form-inline"},n.createElement("tbody",null,n.createElement("tr",null,n.createElement("td",null,"External sync"),n.createElement("td",null,"User synced via LDAP. Some changes must be done in LDAP or mappings."),n.createElement("td",null,n.createElement("span",{className:"label label-tag"},"LDAP"))),n.createElement("tr",null,an.enabled?n.createElement(n.Fragment,null,n.createElement("td",null,"Next scheduled synchronization"),n.createElement("td",{colSpan:2},ha)):n.createElement(n.Fragment,null,n.createElement("td",null,"Next scheduled synchronization"),n.createElement("td",{colSpan:2},"Not enabled")))))),n.createElement("div",{className:"gf-form-button-row"},Ds&&n.createElement(m.$n,{variant:"secondary",onClick:this.onUserSync},"Sync user"),Ns&&n.createElement(m.z9,{variant:"secondary",href:la},"Debug LDAP Mapping"))))}}var ee=e(3911),Z=e(82702),z=e(37390),q=e(88575),ie=e(56034),de=e(89062),ue=e(85927),fe=e(41053),Se=e(17172),he=e(21594);function ce({onSelected:At,className:an,inputId:cn,autoFocus:On,excludeOrgs:ha}){(0,n.useEffect)(()=>{On&&cn&&document.getElementById(cn)?.focus()},[On,cn]);const[la,Ns]=(0,fe.A)(async()=>{const Js=(await(0,Se.AI)().get("/api/orgs")).map(Rs=>({value:{id:Rs.id,name:Rs.name},label:Rs.name}));if(ha){let Rs=ha.map(Vs=>Vs.orgId);return Js.filter(Vs=>!Rs.includes(Vs.value.id))}else return Js});return n.createElement(he.DW,{inputId:cn,className:an,isLoading:la.loading,defaultOptions:!0,loadOptions:Ns,filterOption:(Ds,Js)=>{const Rs=Js.toLowerCase();return!!Ds.value?.name.toLowerCase().includes(Rs)},onChange:At,placeholder:"Select organization",noOptionsMessage:"No organizations found"})}var me=e(5133);class pe extends n.PureComponent{constructor(){super(...arguments),this.addToOrgButtonRef=n.createRef(),this.state={showAddOrgModal:!1},this.showOrgAddModal=()=>{this.setState({showAddOrgModal:!0})},this.dismissOrgAddModal=()=>{this.setState({showAddOrgModal:!1},()=>{this.addToOrgButtonRef.current?.focus()})}}render(){const{user:an,orgs:cn,isExternalUser:On,onOrgRoleChange:ha,onOrgRemove:la,onOrgAdd:Ns}=this.props,{showAddOrgModal:Ds}=this.state,Js=G.contextSrv.hasPermission(j.AccessControlAction.OrgUsersAdd)&&!On;return n.createElement("div",null,n.createElement("h3",{className:"page-heading"},"Organizations"),n.createElement(l.B,{gap:1.5,direction:"column"},n.createElement("table",{className:"filter-table form-inline"},n.createElement("tbody",null,cn.map((Rs,Er)=>n.createElement(Ie,{key:`${Rs.orgId}-${Er}`,isExternalUser:On,user:an,org:Rs,onOrgRoleChange:ha,onOrgRemove:la})))),n.createElement("div",null,Js&&n.createElement(m.$n,{variant:"secondary",onClick:this.showOrgAddModal,ref:this.addToOrgButtonRef},"Add user to organization")),n.createElement(Ne,{user:an,userOrgs:cn,isOpen:Ds,onOrgAdd:Ns,onDismiss:this.dismissOrgAddModal})))}}const ye=(0,ee.N)(At=>({removeButton:(0,r.css)`
      margin-right: 0.6rem;
      text-decoration: underline;
      color: ${At.v1.palette.blue95};
    `,label:(0,r.css)`
      font-weight: 500;
    `,disabledTooltip:(0,r.css)`
      display: flex;
    `,tooltipItem:(0,r.css)`
      margin-left: 5px;
    `,tooltipItemLink:(0,r.css)`
      color: ${At.v1.palette.blue95};
    `,rolePickerWrapper:(0,r.css)`
      display: flex;
    `,rolePicker:(0,r.css)`
      flex: auto;
      margin-right: ${At.spacing(1)};
    `}));class Pe extends n.PureComponent{constructor(){super(...arguments),this.state={currentRole:this.props.org.role,isChangingRole:!1,roleOptions:[]},this.onOrgRemove=async()=>{const{org:an}=this.props;this.props.onOrgRemove(an.orgId)},this.onChangeRoleClick=()=>{const{org:an}=this.props;this.setState({isChangingRole:!0,currentRole:an.role})},this.onOrgRoleChange=an=>{this.setState({currentRole:an})},this.onOrgRoleSave=()=>{this.props.onOrgRoleChange(this.props.org.orgId,this.state.currentRole)},this.onCancelClick=()=>{this.setState({isChangingRole:!1})},this.onBasicRoleChange=an=>{this.props.onOrgRoleChange(this.props.org.orgId,an)}}componentDidMount(){G.contextSrv.licensedAccessControlEnabled()&&G.contextSrv.hasPermission(j.AccessControlAction.ActionRolesList)&&(0,ue.RL)(this.props.org.orgId).then(an=>this.setState({roleOptions:an})).catch(an=>console.error(an))}render(){const{user:an,org:cn,isExternalUser:On,theme:ha}=this.props,la=an?.authLabels?.length&&an?.authLabels[0],Ns=la?`Synced via ${la}`:"",{currentRole:Ds,isChangingRole:Js}=this.state,Rs=ye(ha),Er=(0,r.cx)("width-16",Rs.label),Vs=G.contextSrv.hasPermission(j.AccessControlAction.OrgUsersWrite),hs=G.contextSrv.hasPermission(j.AccessControlAction.OrgUsersRemove)&&!On,Pr=On||!Vs,ro=`${cn.name}-input`;return n.createElement("tr",null,n.createElement("td",{className:Er},n.createElement("label",{htmlFor:ro},cn.name)),G.contextSrv.licensedAccessControlEnabled()?n.createElement("td",null,n.createElement("div",{className:Rs.rolePickerWrapper},n.createElement("div",{className:Rs.rolePicker},n.createElement(de.y,{userId:an?.id||0,orgId:cn.orgId,basicRole:cn.role,roleOptions:this.state.roleOptions,onBasicRoleChange:this.onBasicRoleChange,basicRoleDisabled:Pr,basicRoleDisabledMessage:`This user's role is not editable because it is synchronized from your auth provider.
                    Refer to the Grafana authentication docs for details.`})),On&&n.createElement(Ue,{lockMessage:Ns}))):n.createElement(n.Fragment,null,Js?n.createElement("td",null,n.createElement(me.r,{inputId:ro,value:Ds,onChange:this.onOrgRoleChange,autoFocus:!0})):n.createElement("td",{className:"width-25"},cn.role),n.createElement("td",{colSpan:1},n.createElement("div",{className:"pull-right"},Vs&&n.createElement(Ae,{lockMessage:Ns,isExternalUser:On,onChangeRoleClick:this.onChangeRoleClick,onCancelClick:this.onCancelClick,onOrgRoleSave:this.onOrgRoleSave})))),n.createElement("td",{colSpan:1},n.createElement("div",{className:"pull-right"},hs&&n.createElement(Z.Z,{confirmText:"Confirm removal",confirmVariant:"destructive",onCancel:this.onCancelClick,onConfirm:this.onOrgRemove},"Remove from organization"))))}}const Ie=(0,f.cV)(Pe),Oe=(0,ee.N)(()=>({modal:(0,r.css)`
    width: 500px;
  `,buttonRow:(0,r.css)`
    text-align: center;
  `,modalContent:(0,r.css)`
    overflow: visible;
  `}));class Ne extends n.PureComponent{constructor(){super(...arguments),this.state={selectedOrg:null,role:j.OrgRole.Viewer,roleOptions:[],pendingOrgId:null,pendingUserId:null,pendingRoles:[]},this.onOrgSelect=an=>{const cn=this.props.userOrgs.find(On=>On.orgId===an.value?.id);this.setState({selectedOrg:an.value,role:cn?.role||j.OrgRole.Viewer}),G.contextSrv.licensedAccessControlEnabled()&&G.contextSrv.hasPermission(j.AccessControlAction.ActionRolesList)&&(0,ue.RL)(an.value?.id).then(On=>this.setState({roleOptions:On})).catch(On=>console.error(On))},this.onOrgRoleChange=an=>{this.setState({role:an})},this.onAddUserToOrg=async()=>{const{selectedOrg:an,role:cn}=this.state;this.props.onOrgAdd(an.id,cn),G.contextSrv.licensedAccessControlEnabled()&&G.contextSrv.hasPermission(j.AccessControlAction.ActionUserRolesAdd)&&this.state.pendingUserId&&(await(0,ue.eA)(this.state.pendingRoles,this.state.pendingUserId,this.state.pendingOrgId),this.setState({pendingOrgId:null,pendingRoles:[],pendingUserId:null}))},this.onCancel=()=>{this.setState({selectedOrg:null,pendingRoles:[],pendingOrgId:null,pendingUserId:null}),this.props.onDismiss&&this.props.onDismiss()},this.onRoleUpdate=async(an,cn,On)=>{this.setState({pendingRoles:an,pendingOrgId:On,pendingUserId:cn})}}render(){const{isOpen:an,user:cn,userOrgs:On}=this.props,{role:ha,roleOptions:la,selectedOrg:Ns}=this.state,Ds=Oe();return n.createElement(z.a,{className:Ds.modal,contentClassName:Ds.modalContent,title:"Add to an organization",isOpen:an,onDismiss:this.onCancel},n.createElement(q.D,{label:"Organization"},n.createElement(ce,{inputId:"new-org-input",onSelected:this.onOrgSelect,excludeOrgs:On,autoFocus:!0})),n.createElement(q.D,{label:"Role",disabled:Ns===null},n.createElement(de.y,{userId:cn?.id||0,orgId:Ns?.id,basicRole:ha,onBasicRoleChange:this.onOrgRoleChange,basicRoleDisabled:!1,roleOptions:la,apply:!0,onApplyRoles:this.onRoleUpdate,pendingRoles:this.state.pendingRoles})),n.createElement(z.a.ButtonRow,null,n.createElement(l.B,{gap:2,justifyContent:"center"},n.createElement(m.$n,{variant:"secondary",fill:"outline",onClick:this.onCancel},"Cancel"),n.createElement(m.$n,{variant:"primary",disabled:Ns===null,onClick:this.onAddUserToOrg},"Add to organization"))))}}const We=At=>({disabledTooltip:(0,r.css)`
    display: flex;
  `,tooltipItemLink:(0,r.css)`
    color: ${At.v1.palette.blue95};
  `,lockMessageClass:(0,r.css)`
    font-style: italic;
    margin-left: 1.8rem;
    margin-right: 0.6rem;
  `,icon:(0,r.css)`
    line-height: 2;
  `});function Ae({lockMessage:At,onChangeRoleClick:an,isExternalUser:cn,onOrgRoleSave:On,onCancelClick:ha}){const la=(0,f.of)(We);return n.createElement("div",{className:la.disabledTooltip},cn?n.createElement(n.Fragment,null,n.createElement("span",{className:la.lockMessageClass},At),n.createElement(ie.m,{placement:"right-end",interactive:!0,content:n.createElement("div",null,"This user's role is not editable because it is synchronized from your auth provider. Refer to the\xA0",n.createElement("a",{className:la.tooltipItemLink,href:"https://grafana.com/docs/grafana/latest/auth",rel:"noreferrer",target:"_blank"},"Grafana authentication docs"),"\xA0for details.")},n.createElement("div",{className:la.icon},n.createElement(p.I,{name:"question-circle"})))):n.createElement(Z.Z,{confirmText:"Save",onClick:an,onCancel:ha,onConfirm:On,disabled:cn},"Change role"))}const Ue=({lockMessage:At})=>{const an=(0,f.of)(Me);return n.createElement("div",{className:an.disabledTooltip},n.createElement("span",{className:an.lockMessageClass},At),n.createElement(ie.m,{placement:"right-end",interactive:!0,content:n.createElement("div",null,"This user's built-in role is not editable because it is synchronized from your auth provider. Refer to the\xA0",n.createElement("a",{className:an.tooltipItemLink,href:"https://grafana.com/docs/grafana/latest/auth",rel:"noreferrer noopener",target:"_blank"},"Grafana authentication docs"),"\xA0for details.")},n.createElement(p.I,{name:"question-circle"})))},Me=At=>({disabledTooltip:(0,r.css)`
    display: flex;
  `,tooltipItemLink:(0,r.css)`
    color: ${At.v1.palette.blue95};
  `,lockMessageClass:(0,r.css)`
    font-style: italic;
    margin-left: 1.8rem;
    margin-right: 0.6rem;
  `});var $e=e(94354);const ke=[{label:"Yes",value:!0},{label:"No",value:!1}];function Ze({isGrafanaAdmin:At,isExternalUser:an,lockMessage:cn,onGrafanaAdminChange:On}){const[ha,la]=(0,n.useState)(!1),[Ns,Ds]=(0,n.useState)(At),Js=()=>la(!0),Rs=()=>{la(!1),Ds(At)},Er=()=>On(Ns),Vs=G.contextSrv.hasPermission(j.AccessControlAction.UsersPermissionsUpdate)&&!an,hs=(0,f.of)(ot);return n.createElement("div",null,n.createElement("h3",{className:"page-heading"},"Permissions"),n.createElement("table",{className:"filter-table form-inline"},n.createElement("tbody",null,n.createElement("tr",null,n.createElement("td",{className:"width-16"},"Grafana Admin"),ha?n.createElement("td",{colSpan:2},n.createElement($e.z,{options:ke,value:Ns,onChange:Ds,autoFocus:!0})):n.createElement("td",{colSpan:2},At?n.createElement(n.Fragment,null,n.createElement(p.I,{name:"shield"})," Yes"):n.createElement(n.Fragment,null,"No")),n.createElement("td",null,Vs&&n.createElement(Z.Z,{onClick:Js,onConfirm:Er,onCancel:Rs,confirmText:"Change"},"Change"),an&&n.createElement("div",{className:hs.lockMessageClass},n.createElement(Ue,{lockMessage:cn})))))))}const ot=At=>({lockMessageClass:(0,r.css)`
    display: flex;
    justify-content: flex-end;
    font-style: italic;
    margin-right: ${At.spacing(.6)};
  `});var xt=e(96374),ct=e(91634),ft=e(10354);function Le({user:At,onUserUpdate:an,onUserDelete:cn,onUserDisable:On,onUserEnable:ha,onPasswordChange:la}){const[Ns,Ds]=(0,n.useState)(!1),[Js,Rs]=(0,n.useState)(!1),Er=(0,n.useRef)(null),Vs=dt=>()=>{Ds(dt),!dt&&Er.current&&Er.current.focus()},hs=(0,n.useRef)(null),Pr=dt=>()=>{Rs(dt),!dt&&hs.current&&hs.current.focus()},ro=()=>cn(At.id),yo=()=>On(At.id),Kr=()=>ha(At.id),io=dt=>{an({...At,name:dt})},Ro=dt=>{an({...At,email:dt})},Qr=dt=>{an({...At,login:dt})},uo=At.authLabels?.length&&At.authLabels[0],Mo=uo?`Synced via ${uo}`:"",Jo=At.isExternal||!G.contextSrv.hasPermissionInMetadata(j.AccessControlAction.UsersWrite,At),Lo=At.isExternal||!G.contextSrv.hasPermissionInMetadata(j.AccessControlAction.UsersPasswordUpdate,At),$r=G.contextSrv.hasPermissionInMetadata(j.AccessControlAction.UsersDelete,At),Ei=G.contextSrv.hasPermissionInMetadata(j.AccessControlAction.UsersDisable,At),Ki=G.contextSrv.hasPermissionInMetadata(j.AccessControlAction.UsersEnable,At);return n.createElement("div",null,n.createElement("h3",{className:"page-heading"},"User information"),n.createElement(l.B,{direction:"column",gap:1.5},n.createElement("div",null,n.createElement("table",{className:"filter-table form-inline"},n.createElement("tbody",null,n.createElement(re,{label:"Name",value:At.name,locked:Jo,lockMessage:Mo,onChange:io}),n.createElement(re,{label:"Email",value:At.email,locked:Jo,lockMessage:Mo,onChange:Ro}),n.createElement(re,{label:"Username",value:At.login,locked:Jo,lockMessage:Mo,onChange:Qr}),n.createElement(re,{label:"Password",value:"********",inputType:"password",locked:Lo,lockMessage:Mo,onChange:la})))),n.createElement(l.B,{gap:2},$r&&n.createElement(n.Fragment,null,n.createElement(m.$n,{variant:"destructive",onClick:Vs(!0),ref:Er},"Delete user"),n.createElement(xt.u,{isOpen:Ns,title:"Delete user",body:"Are you sure you want to delete this user?",confirmText:"Delete user",onConfirm:ro,onDismiss:Vs(!1)})),At.isDisabled&&Ki&&n.createElement(m.$n,{variant:"secondary",onClick:Kr},"Enable user"),!At.isDisabled&&Ei&&n.createElement(n.Fragment,null,n.createElement(m.$n,{variant:"secondary",onClick:Pr(!0),ref:hs},"Disable user"),n.createElement(xt.u,{isOpen:Js,title:"Disable user",body:"Are you sure you want to disable this user?",confirmText:"Disable user",onConfirm:yo,onDismiss:Pr(!1)})))))}class re extends n.PureComponent{constructor(){super(...arguments),this.state={editing:!1,value:this.props.value||""},this.setInputElem=an=>{this.inputElem=an},this.onEditClick=()=>{this.props.inputType==="password"?this.setState({editing:!0,value:""},this.focusInput):this.setState({editing:!0},this.focusInput)},this.onCancelClick=()=>{this.setState({editing:!1,value:this.props.value||""})},this.onInputChange=(an,cn)=>{cn!==ct.O.Invalid&&this.setState({value:an.target.value})},this.onInputBlur=(an,cn)=>{cn!==ct.O.Invalid&&this.setState({value:an.target.value})},this.focusInput=()=>{this.inputElem&&this.inputElem.focus&&this.inputElem.focus()},this.onSave=()=>{this.props.onChange&&this.props.onChange(this.state.value)}}static{this.defaultProps={value:"",locked:!1,lockMessage:"",inputType:"text"}}render(){const{label:an,locked:cn,lockMessage:On,inputType:ha}=this.props,{value:la}=this.state,Ns=(0,r.cx)("width-16",(0,r.css)`
        font-weight: 500;
      `);if(cn)return n.createElement(X,{label:an,value:la,lockMessage:On});const Ds=`${an}-input`;return n.createElement("tr",null,n.createElement("td",{className:Ns},n.createElement("label",{htmlFor:Ds},an)),n.createElement("td",{className:"width-25",colSpan:2},this.state.editing?n.createElement(ft.p,{id:Ds,type:ha,defaultValue:la,onBlur:this.onInputBlur,onChange:this.onInputChange,ref:this.setInputElem,width:30}):n.createElement("span",null,this.props.value)),n.createElement("td",null,n.createElement(Z.Z,{confirmText:"Save",onClick:this.onEditClick,onConfirm:this.onSave,onCancel:this.onCancelClick},"Edit")))}}const X=({label:At,value:an,lockMessage:cn})=>{const On=(0,r.css)`
    font-style: italic;
    margin-right: 0.6rem;
  `,ha=(0,r.cx)("width-16",(0,r.css)`
      font-weight: 500;
    `);return n.createElement("tr",null,n.createElement("td",{className:ha},At),n.createElement("td",{className:"width-25",colSpan:2},an),n.createElement("td",null,n.createElement("span",{className:On},cn)))};class le extends n.PureComponent{constructor(){super(...arguments),this.forceAllLogoutButton=n.createRef(),this.state={showLogoutModal:!1},this.showLogoutConfirmationModal=()=>{this.setState({showLogoutModal:!0})},this.dismissLogoutConfirmationModal=()=>{this.setState({showLogoutModal:!1},()=>{this.forceAllLogoutButton.current?.focus()})},this.onSessionRevoke=an=>()=>{this.props.onSessionRevoke(an)},this.onAllSessionsRevoke=()=>{this.setState({showLogoutModal:!1}),this.props.onAllSessionsRevoke()}}render(){const{sessions:an}=this.props,{showLogoutModal:cn}=this.state,On=G.contextSrv.hasPermission(j.AccessControlAction.UsersLogout);return n.createElement("div",null,n.createElement("h3",{className:"page-heading"},"Sessions"),n.createElement(l.B,{direction:"column",gap:1.5},n.createElement("div",null,n.createElement("table",{className:"filter-table form-inline"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"Last seen"),n.createElement("th",null,"Logged on"),n.createElement("th",null,"IP address"),n.createElement("th",{colSpan:2},"Browser and OS"))),n.createElement("tbody",null,an&&an.map((ha,la)=>n.createElement("tr",{key:`${ha.id}-${la}`},n.createElement("td",null,ha.isActive?"Now":ha.seenAt),n.createElement("td",null,(0,h.Xj)(ha.createdAt,{dateStyle:"long"})),n.createElement("td",null,ha.clientIp),n.createElement("td",null,`${ha.browser} on ${ha.os} ${ha.osVersion}`),n.createElement("td",null,n.createElement("div",{className:"pull-right"},On&&n.createElement(Z.Z,{confirmText:"Confirm logout",confirmVariant:"destructive",onConfirm:this.onSessionRevoke(ha.id)},"Force logout")))))))),n.createElement("div",null,On&&an.length>0&&n.createElement(m.$n,{variant:"secondary",onClick:this.showLogoutConfirmationModal,ref:this.forceAllLogoutButton},"Force logout from all devices"),n.createElement(xt.u,{isOpen:cn,title:"Force logout from all devices",body:"Are you sure you want to force logout from all devices?",confirmText:"Force logout",onConfirm:this.onAllSessionsRevoke,onDismiss:this.dismissLogoutConfirmationModal}))))}}const be=le;var De=e(57334);class Te extends n.PureComponent{constructor(){super(...arguments),this.onUserUpdate=an=>{this.props.updateUser(an)},this.onPasswordChange=an=>{const{user:cn,setUserPassword:On}=this.props;cn&&On(cn.id,an)},this.onUserDelete=an=>{this.props.deleteUser(an)},this.onUserDisable=an=>{this.props.disableUser(an)},this.onUserEnable=an=>{this.props.enableUser(an)},this.onGrafanaAdminChange=an=>{const{user:cn,updateUserPermissions:On}=this.props;cn&&On(cn.id,an)},this.onOrgRemove=an=>{const{user:cn,deleteOrgUser:On}=this.props;cn&&On(cn.id,an)},this.onOrgRoleChange=(an,cn)=>{const{user:On,updateOrgUserRole:ha}=this.props;On&&ha(On.id,an,cn)},this.onOrgAdd=(an,cn)=>{const{user:On,addOrgUser:ha}=this.props;On&&ha(On,an,cn)},this.onSessionRevoke=an=>{const{user:cn,revokeSession:On}=this.props;cn&&On(an,cn.id)},this.onAllSessionsRevoke=()=>{const{user:an,revokeAllSessions:cn}=this.props;an&&cn(an.id)},this.onUserSync=()=>{const{user:an,syncLdapUser:cn}=this.props;an&&cn(an.id)}}async componentDidMount(){const{match:an,loadAdminUserPage:cn}=this.props;cn(parseInt(an.params.id,10))}render(){const{user:an,orgs:cn,sessions:On,ldapSyncInfo:ha,isLoading:la}=this.props,Ns=an?.isExternal&&an?.authLabels?.includes("LDAP"),Ds=G.contextSrv.hasPermission(j.AccessControlAction.UsersAuthTokenList),Js=G.contextSrv.hasPermission(j.AccessControlAction.LDAPStatusRead),Rs=an?.authLabels?.[0],Er=Rs?`Synced via ${Rs}`:"",Vs={text:an?.login??"",icon:"shield",subTitle:"Manage settings for an individual user."};return n.createElement(O.Y,{navId:"global-users",pageNav:Vs},n.createElement(O.Y.Contents,{isLoading:la},n.createElement(l.B,{gap:5,direction:"column"},an&&n.createElement(n.Fragment,null,n.createElement(Le,{user:an,onUserUpdate:this.onUserUpdate,onUserDelete:this.onUserDelete,onUserDisable:this.onUserDisable,onUserEnable:this.onUserEnable,onPasswordChange:this.onPasswordChange}),Ns&&an?.isExternallySynced&&(0,H.a)("ldapsync")&&ha&&Js&&n.createElement(ne,{ldapSyncInfo:ha,user:an,onUserSync:this.onUserSync}),n.createElement(Ze,{isGrafanaAdmin:an.isGrafanaAdmin,isExternalUser:an?.isGrafanaAdminExternallySynced,lockMessage:Er,onGrafanaAdminChange:this.onGrafanaAdminChange})),cn&&n.createElement(pe,{user:an,orgs:cn,isExternalUser:an?.isExternallySynced,onOrgRemove:this.onOrgRemove,onOrgRoleChange:this.onOrgRoleChange,onOrgAdd:this.onOrgAdd}),On&&Ds&&n.createElement(be,{sessions:On,onSessionRevoke:this.onSessionRevoke,onAllSessionsRevoke:this.onAllSessionsRevoke}))))}}const we=At=>({user:At.userAdmin.user,sessions:At.userAdmin.sessions,orgs:At.userAdmin.orgs,ldapSyncInfo:At.ldap.syncInfo,isLoading:At.userAdmin.isLoading,error:At.userAdmin.error}),Ke={loadAdminUserPage:De.kz,updateUser:De.TK,setUserPassword:De.ly,disableUser:De.MV,enableUser:De.nr,deleteUser:De.hG,updateUserPermissions:De.N6,addOrgUser:De.nh,updateOrgUserRole:De.P3,deleteOrgUser:De.Pi,revokeSession:De.T$,revokeAllSessions:De.VR,syncLdapUser:De.mI},ht=(0,_.connect)(we,Ke)(Te);var gt=e(49785),bt=e(94753),St=e(48840);const Je=({ldapConnectionInfo:At})=>{const an=(0,n.useMemo)(()=>[{id:"host",header:"Host",disableGrow:!0},{id:"port",header:"Port",disableGrow:!0},{id:"available",cell:On=>On.cell.value?n.createElement(l.B,{justifyContent:"end"},n.createElement(ie.m,{content:"Connection is available"},n.createElement(p.I,{name:"check",className:"pull-right"}))):n.createElement(l.B,{justifyContent:"end"},n.createElement(ie.m,{content:"Connection is not available"},n.createElement(p.I,{name:"exclamation-triangle"})))}],[]),cn=(0,n.useMemo)(()=>At,[At]);return n.createElement("section",null,n.createElement(l.B,{direction:"column",gap:2},n.createElement(bt.E,{color:"primary",element:"h3"},"LDAP Connection"),n.createElement(St.j,{data:cn,columns:an,getRowId:On=>On.host+On.port}),n.createElement(rt,{ldapConnectionInfo:At})))},rt=({ldapConnectionInfo:At})=>{if(!At.some(ha=>ha.error))return null;const cn=[];At.forEach(ha=>{ha.error&&cn.push(ha)});const On=cn.map((ha,la)=>n.createElement("div",{key:la},n.createElement("span",{style:{fontWeight:500}},ha.host,":",ha.port,n.createElement("br",null)),n.createElement("span",null,ha.error),la!==cn.length-1&&n.createElement(n.Fragment,null,n.createElement("br",null),n.createElement("br",null))));return n.createElement(d.F,{title:"Connection error",severity:j.AppNotificationSeverity.Error},On)},Rt="dddd YYYY-MM-DD HH:mm zz",_t=({ldapSyncInfo:At})=>{const an=(0,Y.LE)(At.nextSync,{format:Rt}),cn=[{id:"syncAttribute"},{id:"syncValue"}],On=[{syncAttribute:"Active synchronization",syncValue:At.enabled?"Enabled":"Disabled"},{syncAttribute:"Scheduled",syncValue:At.schedule},{syncAttribute:"Next synchronization",syncValue:an}];return n.createElement("section",null,n.createElement(bt.E,{element:"h3"},"LDAP Synchronization"),n.createElement(St.j,{data:On,columns:cn,getRowId:ha=>ha.syncAttribute}))};var nn=e(90613);const Kt=({groups:At})=>{const an=(0,n.useMemo)(()=>At,[At]),cn=(0,n.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:On=>On.value&&On.row.original.orgRole?On.value:""},{id:"orgRole",header:"Role",cell:On=>On.value||n.createElement(n.Fragment,null,"No match"," ",n.createElement(ie.m,{content:"No matching organizations found"},n.createElement(p.I,{name:"info-circle"})))}],[]);return n.createElement(St.j,{headerTooltips:{orgName:{content:"Only the first match for an Organization will be used",iconName:"info-circle"}},columns:cn,data:an,getRowId:On=>On.orgId+On.orgRole+On.groupDN})},en=({info:At})=>{const an=(0,n.useMemo)(()=>[{id:"userInfo",header:"User Information",disableGrow:!0},{id:"ldapValue"},{id:"cfgAttrValue",header:"LDAP attribute"}],[]),cn=(0,n.useMemo)(()=>[{userInfo:"First name",ldapValue:At.name.ldapValue,cfgAttrValue:At.name.cfgAttrValue},{userInfo:"Surname",ldapValue:At.surname.ldapValue,cfgAttrValue:At.surname.cfgAttrValue},{userInfo:"Username",ldapValue:At.login.ldapValue,cfgAttrValue:At.login.cfgAttrValue},{userInfo:"Email",ldapValue:At.email.ldapValue,cfgAttrValue:At.email.cfgAttrValue}],[At]);return n.createElement(St.j,{columns:an,data:cn,getRowId:On=>On.userInfo})},Qt=({permissions:At})=>{const an=(0,n.useMemo)(()=>[{id:"permission",header:"Permissions",disableGrow:!0},{id:"value"}],[]),cn=(0,n.useMemo)(()=>[{permission:"Grafana admin",value:At.isGrafanaAdmin?n.createElement(n.Fragment,null,n.createElement(p.I,{name:"shield"})," Yes"):"No"},{permission:"Status",value:At.isDisabled?n.createElement(n.Fragment,null,n.createElement(p.I,{name:"times"})," Inactive"):n.createElement(n.Fragment,null,n.createElement(p.I,{name:"check"})," Active")}],[At]);return n.createElement(St.j,{data:cn,columns:an,getRowId:On=>On.permission})},An=({teams:At})=>{const an=(0,n.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:({row:{original:{orgName:cn}}})=>n.createElement(n.Fragment,null,cn||"No matching teams found")},{id:"teamName",header:"Team",cell:({row:{original:{teamName:cn,orgName:On}}})=>cn&&On?cn:""}],[]);return n.createElement(St.j,{data:At,columns:an,getRowId:cn=>cn.teamName})},un=({ldapUser:At})=>n.createElement(l.B,{direction:"column",gap:4},n.createElement(en,{info:At.info}),n.createElement(Qt,{permissions:At.permissions}),At.roles&&At.roles.length>0&&n.createElement(Kt,{groups:At.roles}),At.teams&&At.teams.length>0?n.createElement(An,{teams:At.teams}):n.createElement(nn.a,null,n.createElement(bt.E,null,"No teams found via LDAP"))),fn={text:"LDAP",subTitle:"Verify your LDAP and user mapping configuration.",icon:"book",id:"LDAP"},Tt=({clearUserMappingInfo:At,queryParams:an,loadLdapState:cn,loadLdapSyncStatus:On,loadUserMapping:ha,clearUserError:la,ldapUser:Ns,userError:Ds,ldapError:Js,ldapSyncInfo:Rs,ldapConnectionInfo:Er})=>{const[Vs,hs]=(0,n.useState)(!0),{register:Pr,handleSubmit:ro}=(0,gt.mN)(),yo=(0,n.useCallback)(async Qr=>ha(Qr),[ha]);(0,n.useEffect)(()=>{const Qr=async()=>Promise.all([cn(),On()]);async function uo(){await At(),await Qr(),an.username&&await yo(an.username),hs(!1)}uo()},[At,yo,cn,On,an]);const Kr=({username:Qr})=>{Qr&&yo(Qr)},io=()=>{la()},Ro=G.contextSrv.hasPermission(j.AccessControlAction.LDAPUsersRead);return n.createElement(O.Y,{navId:"authentication",pageNav:fn},n.createElement(O.Y.Contents,{isLoading:Vs},n.createElement(l.B,{direction:"column",gap:4},Js&&Js.title&&n.createElement(d.F,{title:Js.title,severity:j.AppNotificationSeverity.Error},Js.body),n.createElement(Je,{ldapConnectionInfo:Er}),(0,H.a)("ldapsync")&&Rs&&n.createElement(_t,{ldapSyncInfo:Rs}),Ro&&n.createElement("section",null,n.createElement("h3",null,"Test user mapping"),n.createElement("form",{onSubmit:ro(Kr)},n.createElement(q.D,{label:"Username"},n.createElement(ft.p,{...Pr("username",{required:!0}),width:34,id:"username",type:"text",defaultValue:an.username,addonAfter:n.createElement(m.$n,{variant:"primary",type:"submit"},"Run")}))),Ds&&Ds.title&&n.createElement(d.F,{title:Ds.title,severity:j.AppNotificationSeverity.Error,onRemove:io},Ds.body),Ns&&n.createElement(un,{ldapUser:Ns})))))},$t=At=>({ldapConnectionInfo:At.ldap.connectionInfo,ldapUser:At.ldap.user,ldapSyncInfo:At.ldap.syncInfo,userError:At.ldap.userError,ldapError:At.ldap.ldapError}),Yt={loadLdapState:De.JI,loadLdapSyncStatus:De.pm,loadUserMapping:De.Kg,clearUserError:De.DX,clearUserMappingInfo:De.Jc},Tn=(0,_.connect)($t,Yt)(Tt);var vn=e(27921),Kn=e(75471);function Yn(At=v.config){return[{path:"/alerting",component:nt(()=>e.e(3236).then(e.bind(e,86695)))},{path:"/alerting/home",exact:!1,component:nt(()=>e.e(3236).then(e.bind(e,86695)))},{path:"/alerting/list",roles:(0,Kn.C0)([j.AccessControlAction.AlertingRuleRead,j.AccessControlAction.AlertingRuleExternalRead]),component:nt(()=>Promise.all([e.e(6552),e.e(3511)]).then(e.bind(e,76543)))},{path:"/alerting/routes",roles:(0,Kn.C0)([j.AccessControlAction.AlertingNotificationsRead,j.AccessControlAction.AlertingNotificationsExternalRead]),component:nt(()=>Promise.all([e.e(3932),e.e(6719)]).then(e.bind(e,34708)))},{path:"/alerting/routes/mute-timing/new",roles:(0,Kn.C0)([j.AccessControlAction.AlertingNotificationsWrite,j.AccessControlAction.AlertingNotificationsExternalWrite]),component:nt(()=>e.e(4501).then(e.bind(e,39349)))},{path:"/alerting/routes/mute-timing/edit",roles:(0,Kn.C0)([j.AccessControlAction.AlertingNotificationsWrite,j.AccessControlAction.AlertingNotificationsExternalWrite]),component:nt(()=>e.e(4501).then(e.bind(e,39349)))},{path:"/alerting/silences",roles:(0,Kn.C0)([j.AccessControlAction.AlertingInstanceRead,j.AccessControlAction.AlertingInstancesExternalRead,j.AccessControlAction.AlertingSilenceRead]),component:nt(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/silence/new",roles:(0,Kn.C0)([j.AccessControlAction.AlertingInstanceCreate,j.AccessControlAction.AlertingInstancesExternalWrite]),component:nt(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/silence/:id/edit",component:nt(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/notifications",roles:(0,Kn.C0)([j.AccessControlAction.AlertingNotificationsRead,j.AccessControlAction.AlertingNotificationsExternalRead]),component:nt(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/templates/*",roles:(0,Kn.C0)([j.AccessControlAction.AlertingNotificationsRead,j.AccessControlAction.AlertingNotificationsExternalRead]),component:nt(()=>e.e(9224).then(e.bind(e,35868)))},{path:"/alerting/notifications/:type/new",roles:(0,Kn.C0)([j.AccessControlAction.AlertingNotificationsWrite,j.AccessControlAction.AlertingNotificationsExternalWrite]),component:nt(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/receivers/:id/edit",roles:(0,Kn.C0)([j.AccessControlAction.AlertingNotificationsWrite,j.AccessControlAction.AlertingNotificationsExternalWrite,j.AccessControlAction.AlertingNotificationsRead,j.AccessControlAction.AlertingNotificationsExternalRead]),component:nt(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type/:id/edit",roles:(0,Kn.C0)([j.AccessControlAction.AlertingNotificationsWrite,j.AccessControlAction.AlertingNotificationsExternalWrite]),component:nt(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type/:id/duplicate",roles:(0,Kn.C0)([j.AccessControlAction.AlertingNotificationsWrite,j.AccessControlAction.AlertingNotificationsExternalWrite]),component:nt(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type",roles:(0,Kn.C0)([j.AccessControlAction.AlertingNotificationsWrite,j.AccessControlAction.AlertingNotificationsExternalWrite]),component:nt(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/groups/",roles:(0,Kn.C0)([j.AccessControlAction.AlertingInstanceRead,j.AccessControlAction.AlertingInstancesExternalRead]),component:nt(()=>e.e(8427).then(e.bind(e,12564)))},{path:"/alerting/new/:type?",pageClass:"page-alerting",roles:(0,Kn.C0)([j.AccessControlAction.AlertingRuleCreate,j.AccessControlAction.AlertingRuleExternalWrite]),component:nt(()=>Promise.all([e.e(3932),e.e(3726),e.e(9947),e.e(6552),e.e(4009)]).then(e.bind(e,50166)))},{path:"/alerting/:id/edit",pageClass:"page-alerting",roles:(0,Kn.C0)([j.AccessControlAction.AlertingRuleUpdate,j.AccessControlAction.AlertingRuleExternalWrite]),component:nt(()=>Promise.all([e.e(3932),e.e(3726),e.e(9947),e.e(6552),e.e(4009)]).then(e.bind(e,50166)))},{path:"/alerting/:id/modify-export",pageClass:"page-alerting",roles:(0,Kn.C0)([j.AccessControlAction.AlertingRuleRead]),component:nt(()=>Promise.all([e.e(3932),e.e(3726),e.e(9947),e.e(6552),e.e(4009)]).then(e.bind(e,69179)))},{path:"/alerting/:sourceName/:id/view",pageClass:"page-alerting",roles:(0,Kn.C0)([j.AccessControlAction.AlertingRuleRead,j.AccessControlAction.AlertingRuleExternalRead]),component:nt(()=>Promise.resolve().then(e.bind(e,79741)))},{path:"/alerting/:sourceName/:name/find",pageClass:"page-alerting",roles:(0,Kn.C0)([j.AccessControlAction.AlertingRuleRead,j.AccessControlAction.AlertingRuleExternalRead]),component:nt(()=>e.e(5516).then(e.bind(e,6165)))},{path:"/alerting/admin",roles:()=>["Admin"],component:nt(()=>e.e(9438).then(e.bind(e,53191)))}]}function nt(At){const an=()=>e.e(9029).then(e.bind(e,5961));return(0,vn.A)(v.config.unifiedAlertingEnabled?At:an)}var yt=e(56361),Vt=e(6320);const je=At=>({alertContent:(0,r.css)`
    display: flex;
    flex-direction: row;
    padding: 0;
    justify-content: space-between;
    align-items: center;
  `,alertParagraph:(0,r.css)`
    margin: 0 ${At.spacing(1)} 0 0;
    line-height: ${At.spacing(At.components.height.sm)};
  `});function tt(){const At=(0,f.of)(je),[an,cn]=(0,n.useState)(!0);return an?n.createElement(d.F,{severity:"info",title:"",onRemove:()=>cn(!1)},n.createElement("div",{className:At.alertContent},n.createElement("p",{className:At.alertParagraph},"Data sources have a new home! You can discover new data sources or manage existing ones in the Connections page, accessible from the main menu."),n.createElement(m.z9,{"aria-label":"Link to Connections",icon:"arrow-right",href:Vt.b.DataSources,fill:"text"},"Go to connections"))):n.createElement(n.Fragment,null)}function Dt(){return[{path:`/${Vt.q}`,exact:!1,component:(0,vn.A)(()=>Promise.all([e.e(6359),e.e(4253),e.e(2154)]).then(e.bind(e,34362)))}]}var Ot=e(83883),Lt=e(57220),Gt=e(14110),hn=(At=>(At.ViewIRMMainPage="grafana_irm_configuration_tracker_main_page_view",At.OpenEssentials="grafana_irm_configuration_tracker_essentials_open",At.CloseEssentials="grafana_irm_configuration_tracker_essentials_closed",At.ClickDataSources="grafana_irm_configuration_tracker_data_sources_clicked",At))(hn||{});function mt(At,an){(0,Gt.rR)(At,{...an})}var Bt=e(12131),Jt=e(3704),Rn=e(79938),Mt=e(82843),wt=e(37534),Ht=e(730);function tn(){const[At,{data:an,isLoading:cn}]=Rn.hK.endpoints.rulerRules.useLazyQuery({refetchOnFocus:!0,refetchOnReconnect:!0}),{dsFeatures:On,isLoadingDsFeatures:ha}=(0,Ht.O3)(Lt.hY),la=On?.rulerConfig;return(0,n.useEffect)(()=>{la&&At({rulerConfig:la})},[la,At]),{isDone:(an?Object.entries(an).flatMap(([Js,Rs])=>Rs.flatMap(Er=>Er.rules)):[]).length>0,isLoading:cn||ha}}function It(At){return At.some(an=>an.grafana_managed_receiver_configs?.some(cn=>cn.type===wt.J4.OnCall))}function Xe(){const At=Mt.m.endpoints.getAlertmanagerConfiguration.useQuery(Lt.hY,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{contactPoints:At.data?.alertmanager_config?.receivers??[],isLoading:At.isLoading}}function jn(){const At=Mt.m.endpoints.getAlertmanagerConfiguration.useQuery(Lt.hY,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{defaultContactpoint:At.data?.alertmanager_config?.route?.receiver??"",isLoading:At.isLoading}}const Qn="<example@email.com>";function ia(At,an){return an.some(On=>On.name===At&&On.grafana_managed_receiver_configs?.some(ha=>ha.name===At&&ha.settings?.address!==Qn))}var wn=e(99494),sa=e(49962);const La=At=>`/api/plugins/${wn.W.Incident}/resources${At}`,xa=sa.H.injectEndpoints({endpoints:At=>({getIncidentsPluginConfig:At.query({query:()=>({url:La("/api/ConfigurationTrackerService.GetConfigurationTracker"),data:{},method:"POST",showErrorAlert:!1})})})});var ga=e(12210);function Ts(){const{installed:At,loading:an}=(0,ga._)(wn.W.Incident),{data:cn,isLoading:On}=xa.endpoints.getIncidentsPluginConfig.useQuery();return{isInstalled:At??!1,isChatOpsInstalled:cn?.isChatOpsInstalled??!1,isIncidentCreated:cn?.isIncidentCreated??!1,isLoading:an||On}}var Us=e(26423);function Bs(){const{installed:At}=(0,ga._)(wn.W.OnCall),{data:an}=Us.WG.endpoints.grafanaOnCallIntegrations.useQuery(void 0,{skip:!At,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return an??[]}function ks(){const{data:At,isLoading:an}=Us.WG.endpoints.onCallConfigChecks.useQuery(void 0,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:an,onCallConfigChecks:At??{is_chatops_connected:!1,is_integration_chatops_connected:!1}}}function Ms(){return Bs().map(an=>({label:an.display_name,value:an.value}))}function Dr(){const{onCallConfigChecks:{is_chatops_connected:At,is_integration_chatops_connected:an},isLoading:cn}=ks();return{is_chatops_connected:At,is_integration_chatops_connected:an,isLoading:cn}}function _s(){const{contactPoints:At,isLoading:an}=Xe(),{defaultContactpoint:cn,isLoading:On}=jn(),{isDone:ha,isLoading:la}=tn(),{isChatOpsInstalled:Ns,isInstalled:Ds,isLoading:Js}=Ts(),Rs=Ms(),{is_chatops_connected:Er,is_integration_chatops_connected:Vs,isLoading:hs}=Dr();return{alerting:{contactPoints:At,defaultContactpoint:cn,isCreateAlertRuleDone:ha},incidents:{isChatOpsInstalled:Ns,isIncidentsInstalled:Ds},onCall:{onCallOptions:Rs,is_chatops_connected:Er,is_integration_chatops_connected:Vs},isLoading:an||On||la||Js||hs}}function Ir(){const{alerting:{contactPoints:At,defaultContactpoint:an,isCreateAlertRuleDone:cn},incidents:{isChatOpsInstalled:On,isIncidentsInstalled:ha},onCall:{onCallOptions:la,is_chatops_connected:Ns,is_integration_chatops_connected:Ds},isLoading:Js}=_s();function Rs(Pr,ro){const yo=(0,Jt.c)(ro+Pr,{returnTo:location.pathname+location.search});Bt.Ny.push(yo)}const Er={sections:[{title:"Detect",description:"Configure Grafana Alerting",steps:[{title:"Update default email contact point",description:"Add a valid email to the default email contact point.",button:{type:"openLink",urlLink:{url:`/alerting/notifications/receivers/${an}/edit`,queryParams:{alertmanager:"grafana"}},label:"Edit",labelOnDone:"View",urlLinkOnDone:{url:"/alerting/notifications"}},done:ia(an,At)},{title:"Connect alerting to OnCall",description:"Create an OnCall integration for an alerting contact point.",button:{type:"openLink",urlLink:{url:"/alerting/notifications/receivers/new"},label:"Connect",urlLinkOnDone:{url:"/alerting/notifications"},labelOnDone:"View"},done:It(At)},{title:"Create alert rule",description:"Create an alert rule to monitor your system.",button:{type:"openLink",urlLink:{url:"/alerting/new"},label:"Create",urlLinkOnDone:{url:"/alerting/list"},labelOnDone:"View"},done:cn}]},{title:"Respond",description:"Configure OnCall and Incident",steps:[{title:"Initialize Incident plugin",description:"Initialize the Incident plugin to declare and manage incidents.",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app/walkthrough/generate-key"},label:"Initialize",urlLinkOnDone:{url:"/a/grafana-incident-app"},labelOnDone:"View"},done:ha},{title:"Connect your Messaging workspace to OnCall",description:"Receive alerts and oncall notifications within your chat environment.",button:{type:"openLink",urlLink:{url:"/a/grafana-oncall-app/settings",queryParams:{tab:"ChatOps",chatOpsTab:"Slack"}},label:"Connect",urlLinkOnDone:{url:"/a/grafana-oncall-app/settings",queryParams:{tab:"ChatOps"}},labelOnDone:"View"},done:Ns},{title:"Connect your Messaging workspace to Incident",description:"Automatically create an incident channel and manage incidents directly within your chat environment.",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app/integrations/grate.slack"},label:"Connect",urlLinkOnDone:{url:"/a/grafana-incident-app/integrations"}},done:On},{title:"Add Messaging workspace channel to OnCall Integration",description:"Select ChatOps channels to route notifications",button:{type:"openLink",urlLink:{url:"/a/grafana-oncall-app/integrations/"},label:"Add",urlLinkOnDone:{url:"/a/grafana-oncall-app/integrations/"},labelOnDone:"View"},done:Ds}]},{title:"Test your configuration",description:"",steps:[{title:"Send OnCall demo alert via Alerting integration",description:"In the integration page, click Send demo alert, to review your notification",button:{type:"dropDown",label:"Select integration",options:la,onClickOption:Pr=>Rs(Pr,"/a/grafana-oncall-app/integrations/"),stepNotAvailableText:"No integrations available"}},{title:"Create Incident drill",description:"Practice solving an Incident",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app",queryParams:{declare:"new",drill:"1"}},label:"Start drill"}}]}]},{stepsDone:Vs,totalStepsToDo:hs}=Er.sections.reduce((Pr,ro)=>{const yo=ro.steps.filter(io=>io.done).length,Kr=ro.steps.reduce((io,Ro)=>Ro.done!==void 0?io+1:io,0);return{stepsDone:Pr.stepsDone+yo,totalStepsToDo:Pr.totalStepsToDo+Kr}},{stepsDone:0,totalStepsToDo:0});return{essentialContent:Er,stepsDone:Vs,totalStepsToDo:hs,isLoading:Js}}const Xs=({dataSourceConfigurationData:{dataSourceCompatibleWithAlerting:At},essentialsConfigurationData:{stepsDone:an,totalStepsToDo:cn}})=>(0,n.useMemo)(()=>{function On(){const ha=At?"You have connected a datasource.":"Connect at least one data source to start receiving data.",la=At?"View":"Connect";return{id:Io.CONNECT_DATASOURCE,title:"Connect data source",description:ha,actionButtonTitle:la,isDone:At}}return[On(),{id:Io.ESSENTIALS,title:"Essentials",titleIcon:"star",description:"Configure the features you need to start using Grafana IRM workflows",actionButtonTitle:"Start",stepsDone:an,totalStepsToDo:cn}]},[At,an,cn]);var Gs=e(39558);function Br({stepsDone:At,totalStepsToDo:an}){const cn=(0,f.of)(vr);return an===0?null:n.createElement("div",{className:cn.containerStyles,role:"progressbar","aria-valuenow":At,"aria-valuemax":an},n.createElement("div",{className:cn.fillerStyles(At/an*100)}))}function Mr({stepsDone:At,totalStepsToDo:an}){return n.createElement("div",null,n.createElement(bt.E,{color:"success"},At)," of ",an)}function vr(At){return{containerStyles:(0,r.css)({height:At.spacing(2),borderRadius:At.shape.radius.pill,backgroundColor:At.colors.border.weak,flex:"auto"}),fillerStyles:an=>(0,r.css)({height:"100%",width:`${an}%`,backgroundColor:At.colors.success.main,borderRadius:At.shape.radius.pill,textAlign:"right"})}}function fr({config:At,handleActionClick:an,isLoading:cn=!1}){const On=(0,f.of)(js);return n.createElement(l.B,{direction:"column",gap:1,justifyContent:"space-around"},n.createElement("div",{className:On.cardContent},n.createElement(l.B,{direction:"column",gap:1},n.createElement(l.B,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:1},n.createElement(l.B,{direction:"row",gap:1,alignItems:"center"},At.title,At.titleIcon&&n.createElement(p.I,{name:At.titleIcon}),At.isDone&&!cn&&n.createElement(p.I,{name:"check-circle",color:"green",size:"lg"})),At.stepsDone&&At.totalStepsToDo&&!cn&&n.createElement(l.B,{direction:"row",gap:.5},n.createElement(Mr,{stepsDone:At.stepsDone,totalStepsToDo:At.totalStepsToDo}),"complete")),n.createElement(l.B,{direction:"column"},cn?n.createElement(Gs._,{text:"Loading configuration...."}):At.description,!cn&&At.stepsDone&&At.totalStepsToDo&&n.createElement(Br,{stepsDone:At.stepsDone,totalStepsToDo:At.totalStepsToDo}))),n.createElement(l.B,{direction:"row",gap:1,justifyContent:"flex-start",alignItems:"flex-end"},n.createElement(m.$n,{variant:"secondary",onClick:()=>an(At.id,At.isDone)},At.actionButtonTitle))))}const js=At=>({cardTitle:(0,r.css)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"}),cardContent:(0,r.css)({background:At.colors.background.secondary,padding:At.spacing(2),borderRadius:At.shape.radius.default,height:"100%",gap:At.spacing(1),display:"flex",flexDirection:"column",justifyContent:"space-between"})});var to=e(87978),Ar=e(83122),Ko=e(38138);function no({onClose:At,essentialsConfig:an,stepsDone:cn,totalStepsToDo:On}){return n.createElement(to._,{title:"Essentials",subtitle:"Complete the following configuration tasks",onClose:At},n.createElement(vo,{essentialContent:an,stepsDone:cn,totalStepsToDo:On}))}function vo({essentialContent:At,stepsDone:an,totalStepsToDo:cn}){return n.createElement(l.B,{direction:"column",gap:1},n.createElement(Po,{stepsDone:an,totalStepsToDo:cn}),At.sections.map(On=>n.createElement(ao,{key:On.title,section:On})))}function ao({section:At}){const an=(0,f.of)(jr);return n.createElement("div",{className:an.wrapper},n.createElement(bt.E,{element:"h4"},At.title),n.createElement(bt.E,{color:"secondary"},At.description),n.createElement(l.B,{direction:"column",gap:2},At.steps.map((cn,On)=>n.createElement(Xr,{key:On,step:cn}))))}function Do({done:At}){return At?n.createElement(p.I,{name:"check-circle",color:"green","data-testid":"checked-step"}):n.createElement(p.I,{name:"circle","data-testid":"unckecked-step"})}function Xr({step:At}){return n.createElement(l.B,{direction:"row",justifyContent:"space-between","data-testid":"step"},n.createElement(l.B,{direction:"row",alignItems:"center"},At.done!==void 0&&n.createElement(Do,{done:At.done}),n.createElement(bt.E,{variant:"body"},At.title),n.createElement(ie.m,{content:At.description,placement:"right"},n.createElement(p.I,{name:"question-circle"}))),n.createElement(qr,{...At.button,done:At.done,"data-testid":"step-button"}))}function mo(At){const{urlLink:an,label:cn,urlLinkOnDone:On,labelOnDone:ha,done:la}=At,Ns=an?.url?(0,Jt.c)(an.url,{returnTo:location.pathname+location.search,...an.queryParams}):"",Ds=On?.url?(0,Jt.c)(On.url,{returnTo:location.pathname+location.search,...On.queryParams}):"",Js=la?Ds:Ns;return n.createElement(m.z9,{href:Js,variant:"secondary"},la?ha??cn:cn)}function qr({type:At,urlLink:an,urlLinkOnDone:cn,label:On,labelOnDone:ha,options:la,onClickOption:Ns,done:Ds,stepNotAvailableText:Js}){switch(At){case"openLink":return n.createElement(mo,{urlLink:an,label:On,urlLinkOnDone:cn,labelOnDone:ha,done:Ds});case"dropDown":return la?.length?n.createElement(Ar.m,{overlay:n.createElement(Ko.W,null,la?.map(Rs=>n.createElement(Ko.W.Item,{label:Rs.label,key:Rs.value,onClick:()=>{Ns?.(Rs.value)}})))},n.createElement(m.$n,{variant:"secondary",size:"md"},On,n.createElement(p.I,{name:"angle-down"}))):n.createElement(bt.E,null,Js??"No options available"," ")}}function Po({stepsDone:At,totalStepsToDo:an}){return n.createElement(l.B,{direction:"row",gap:1,alignItems:"center"},"Your progress",n.createElement(Br,{stepsDone:At,totalStepsToDo:an}),n.createElement(Mr,{stepsDone:At,totalStepsToDo:an}))}const jr=At=>({wrapper:(0,r.css)({margin:At.spacing(2,0),padding:At.spacing(2),border:`1px solid ${At.colors.border.medium}`,borderRadius:At.shape.radius.default,display:"flex",flexDirection:"column",gap:At.spacing(2)})});var Io=(At=>(At[At.CONNECT_DATASOURCE=0]="CONNECT_DATASOURCE",At[At.ESSENTIALS=1]="ESSENTIALS",At))(Io||{});function $o(){return{dataSourceCompatibleWithAlerting:!!(0,Lt.k5)()}}function qo(){const At=(0,f.of)(lo),an=(0,a.W6)(),cn=$o(),On=Ir(),ha=Xs({dataSourceConfigurationData:cn,essentialsConfigurationData:On});(0,n.useEffect)(()=>{mt(hn.ViewIRMMainPage,{essentialStepsDone:0,essentialStepsToDo:0,dataSourceCompatibleWithAlerting:cn.dataSourceCompatibleWithAlerting})},[cn.dataSourceCompatibleWithAlerting]);const[la,Ns]=(0,n.useState)(!1),Ds=(Rs,Er)=>{switch(mt(hn.ClickDataSources,{essentialStepsDone:On.stepsDone,essentialStepsToDo:On.totalStepsToDo,dataSourceCompatibleWithAlerting:cn.dataSourceCompatibleWithAlerting}),Rs){case 0:Er?an.push(Ot.I.List):an.push(Ot.I.New);break;case 1:Ns(!0),mt(hn.OpenEssentials,{essentialStepsDone:On.stepsDone,essentialStepsToDo:On.totalStepsToDo,dataSourceCompatibleWithAlerting:cn.dataSourceCompatibleWithAlerting});break;default:return}};function Js(){Ns(!1),mt(hn.CloseEssentials,{essentialStepsDone:On.stepsDone,essentialStepsToDo:On.totalStepsToDo,dataSourceCompatibleWithAlerting:cn.dataSourceCompatibleWithAlerting})}return n.createElement(n.Fragment,null,n.createElement(bt.E,{element:"h4",variant:"h4"},"Configure"),n.createElement("section",{className:At.container},ha.map(Rs=>n.createElement(fr,{key:Rs.id,config:Rs,handleActionClick:Ds,isLoading:On.isLoading})),la&&n.createElement(no,{onClose:Js,essentialsConfig:On.essentialContent,stepsDone:On.stepsDone,totalStepsToDo:On.totalStepsToDo})),n.createElement(bt.E,{element:"h4",variant:"h4"},"IRM apps"))}const lo=At=>({container:(0,r.css)({marginBottom:0,display:"grid",gap:At.spacing(3),gridTemplateColumns:" 1fr 1fr"})});var Vo=e(66253);const Co=[{path:"/plugins",navId:"plugins",roles:zo([j.AccessControlAction.PluginsInstall,j.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:Vo.vk.Home,component:(0,vn.A)(()=>e.e(4519).then(e.bind(e,65965)))},{path:"/plugins/browse",navId:"plugins",roles:zo([j.AccessControlAction.PluginsInstall,j.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:Vo.vk.Browse,component:(0,vn.A)(()=>e.e(4519).then(e.bind(e,65965)))},{path:"/plugins/:pluginId/",navId:"plugins",roles:zo([j.AccessControlAction.PluginsInstall,j.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:Vo.vk.Details,component:(0,vn.A)(()=>Promise.all([e.e(6359),e.e(4253),e.e(7891)]).then(e.bind(e,86400)))}];function zo(At,an){return()=>At.some(cn=>G.contextSrv.hasPermission(cn))?[]:an}function So(){return Co}var si=e(17422),Yo=e(65307),ri=e(13834),Ao=e(62625),so=e(26272),ko=e(43429),eo=e(39419),No=e(76888);function To(At){return console.error(At),oo("Exception thrown","See console for details")}function oi(){return oo("Page not found","404 Error")}function oo(At,an){const cn={text:At,subTitle:an,icon:"exclamation-triangle"};return{node:cn,main:cn}}var zt=e(94954),rn=e(27716),zn=e(54427),Fn=e(60677),ta=e(72798);const ua={loading:!0,loadingError:!1,pluginNav:null,plugin:null};function ya({pluginId:At,pluginNavSection:an}){const cn=(0,a.W5)(),On=(0,a.zy)(),[ha,la]=(0,n.useReducer)(as.reducer,ua),Ns=i.$.appSubUrl+On.pathname+On.search,{plugin:Ds,loading:Js,loadingError:Rs,pluginNav:Er}=ha,Vs=(0,Fn.Wy)(an,Er,Ns),hs=(0,n.useMemo)(()=>(0,Bt.SE)(On.search),[On.search]),Pr=(0,n.useMemo)(()=>(0,ta.S)(Vs),[Vs]),ro=(0,No.Il)();(0,n.useEffect)(()=>{Ga(At,la)},[At]);const yo=(0,n.useCallback)(Qr=>la(as.actions.changeNav(Qr)),[]);if(!Ds||At!==Ds.meta.id){const Qr=ro.chrome.state.getValue().layout;return n.createElement(O.Y,{navModel:Vs,pageNav:{text:""},layout:Qr},Js&&n.createElement(eo.A,null),!Js&&Rs&&n.createElement(U.L,{entity:"App"}))}if(!Ds.root)return n.createElement(O.Y,{navModel:Vs??oo("Plugin load error")},n.createElement("div",null,"No root app page component found"));const Kr=Ds.root&&n.createElement(ri.a,{meta:Ds.meta},n.createElement(Ds.root,{meta:Ds.meta,basename:cn.url,onNavChanged:yo,query:hs,path:On.pathname})),io=()=>{if(!Ds.meta?.includes)return!0;const Qr=Ds.meta?.includes.find(Mo=>Mo.path===On.pathname);if(!Qr)return!0;if(Qr?.action&&i.$.featureToggles.accessControlOnCall)return G.contextSrv.hasPermission(Qr.action);if(G.contextSrv.isGrafanaAdmin||G.contextSrv.user.orgRole===Ao.X.Admin)return!0;const uo=Qr?.role||"";return!uo||G.contextSrv.isEditor&&uo===Ao.X.Viewer?!0:G.contextSrv.hasRole(uo)},Ro=()=>n.createElement(d.F,{severity:"warning",title:"Access denied"},"You do not have permission to see this page.");return io()?Er?n.createElement(n.Fragment,null,Vs?n.createElement(O.Y,{navModel:Vs,pageNav:Er?.node},n.createElement(O.Y.Contents,{isLoading:Js},Kr)):n.createElement(O.Y,null,Kr)):n.createElement(ta.A.Provider,{value:Pr},Kr):n.createElement(Ro,null)}const as=(0,Yo.Z0)({name:"prom-builder-container",initialState:ua,reducers:{setState:(At,an)=>{Object.assign(At,an.payload)},changeNav:(At,an)=>{let cn=an.payload;cn&&cn.node.children&&(cn={...cn,node:{...cn.main,hideFromBreadcrumbs:!0}}),At.pluginNav=cn}}});async function Ga(At,an){try{const cn=await(0,rn.x)(At).then(On=>{const ha=_a(On);return ha?(G.lE.emit(so.r1.alertError,[ha]),an(as.actions.setState({pluginNav:oo(ha)})),null):(0,zn.ui)(On)});an(as.actions.setState({plugin:cn,loading:!1,loadingError:!1,pluginNav:null}))}catch(cn){an(as.actions.setState({plugin:null,loading:!1,loadingError:!0,pluginNav:oi()}));const On=cn instanceof Error?cn:new Error((0,zt.q)(cn));Fn.z4.logError(On),console.error(On)}}function _a(At){return At?At.type!==ko.QE.app?"Plugin must be an app":At.enabled?null:"Application Not Enabled":"Unknown Plugin"}const nr=ya;var ps=e(99140);function Qs(){const At=(0,ps.Gu)(),{navIndex:an}=At,cn=la=>la.startsWith("standalone-plugin-page-/"),On=la=>"pluginId"in la&&"id"in la;return[...Object.values(an).filter(On).map(la=>{const Ns=(0,si.rH)(la),Ds=`/a/${la.pluginId}`,Js=cn(la.id)&&la.url||Ds,Rs=cn(la.id)&&!la.url?.startsWith("/a/");return{path:Js,exact:!1,sensitive:Rs,component:()=>n.createElement(nr,{pluginId:la.pluginId,pluginNavSection:Ns})}}),{path:"/a/:pluginId",exact:!1,component:({match:la})=>n.createElement(nr,{pluginId:la.params.pluginId,pluginNavSection:an.home})}]}const Hr=[{path:"/profile",component:(0,vn.A)(()=>e.e(2472).then(e.bind(e,48357)))},{path:"/profile/password",component:(0,vn.A)(()=>e.e(8107).then(e.bind(e,28107)))},{path:"/profile/select-org",component:(0,vn.A)(()=>e.e(7430).then(e.bind(e,44613)))},{path:"/profile/notifications",component:(0,vn.A)(()=>e.e(4140).then(e.bind(e,78015)))}];function _r(At=v.config){return At.profileEnabled?Hr:(0,c.uniq)(Hr.map(cn=>cn.path)).map(cn=>({path:cn,component:(0,vn.A)(()=>e.e(5173).then(e.bind(e,35208)))}))}const Rr=()=>!v.config.publicDashboardsEnabled||!v.config.featureToggles.publicDashboards?[]:[{path:"/dashboard/public",pageClass:"page-dashboard",routeName:j.DashboardRoutes.Public,component:(0,vn.A)(()=>e.e(5761).then(e.bind(e,53371)))},{path:"/public-dashboards/:accessToken",pageClass:"page-dashboard",routeName:j.DashboardRoutes.Public,chromeless:!0,component:(0,vn.A)(()=>Promise.all([e.e(6263),e.e(7197)]).then(e.bind(e,15663)))}],Eo=[];function co(){return[...Qs(),{path:"/",pageClass:"page-dashboard",routeName:j.DashboardRoutes.Home,component:(0,vn.A)(()=>Promise.all([e.e(660),e.e(6263),e.e(9136)]).then(e.bind(e,63392)))},{path:"/d/:uid/:slug?",pageClass:"page-dashboard",routeName:j.DashboardRoutes.Normal,component:(0,vn.A)(()=>Promise.all([e.e(660),e.e(6263),e.e(9136)]).then(e.bind(e,63392)))},{path:"/dashboard/new",roles:()=>V.TP.evaluatePermission([j.AccessControlAction.DashboardsCreate]),pageClass:"page-dashboard",routeName:j.DashboardRoutes.New,component:(0,vn.A)(()=>Promise.all([e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,63392)))},{path:"/dashboard/new-with-ds/:datasourceUid",roles:()=>V.TP.evaluatePermission([j.AccessControlAction.DashboardsCreate]),component:(0,vn.A)(()=>Promise.all([e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,30798)))},{path:"/dashboard/:type/:slug",pageClass:"page-dashboard",routeName:j.DashboardRoutes.Normal,component:(0,vn.A)(()=>Promise.all([e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,63392)))},{path:"/dashboards/embedding-test",component:(0,vn.A)(()=>Promise.all([e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,14962)))},{path:"/d-solo/:uid/:slug?",pageClass:"dashboard-solo",routeName:j.DashboardRoutes.Normal,chromeless:!0,component:(0,vn.A)(()=>v.Ay.featureToggles.dashboardSceneSolo?e.e(7849).then(e.bind(e,24880)):Promise.resolve().then(e.bind(e,55087)))},{path:"/dashboard-solo/:type/:slug",pageClass:"dashboard-solo",routeName:j.DashboardRoutes.Normal,chromeless:!0,component:(0,vn.A)(()=>e.e(7849).then(e.bind(e,55087)))},{path:"/dashboard/import",component:(0,vn.A)(()=>e.e(2550).then(e.bind(e,23390)))},{path:Ot.I.List,component:()=>n.createElement(a.rd,{to:Vt.b.DataSources})},{path:Ot.I.Edit,component:At=>n.createElement(a.rd,{to:Vt.b.DataSourcesEdit.replace(":uid",At.match.params.uid)})},{path:Ot.I.Dashboards,component:At=>n.createElement(a.rd,{to:Vt.b.DataSourcesDashboards.replace(":uid",At.match.params.uid)})},{path:Ot.I.New,component:()=>n.createElement(a.rd,{to:Vt.b.DataSourcesNew})},{path:"/datasources/correlations",component:(0,vn.A)(()=>v.Ay.featureToggles.correlations?e.e(9981).then(e.bind(e,32429)):e.e(8014).then(e.bind(e,55244)))},{path:"/dashboards",component:(0,vn.A)(()=>Promise.all([e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/dashboards/f/:uid/:slug",component:(0,vn.A)(()=>Promise.all([e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/dashboards/f/:uid",component:(0,vn.A)(()=>Promise.all([e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/explore",pageClass:"page-explore",roles:()=>V.TP.evaluatePermission([j.AccessControlAction.DataSourcesExplore]),component:(0,vn.A)(()=>v.Ay.exploreEnabled?Promise.all([e.e(660),e.e(1698),e.e(5511),e.e(9604)]).then(e.bind(e,52379)):e.e(4422).then(e.bind(e,53518)))},{path:"/apps",component:()=>n.createElement(K,{navId:"apps"})},{path:"/alerts-and-incidents",component:()=>n.createElement(K,{navId:"alerts-and-incidents",header:!(0,yt.y$)()&&(0,yt.qc)()||(0,yt.ES)()?n.createElement(qo,null):void 0})},{path:"/testing-and-synthetics",component:()=>n.createElement(K,{navId:"testing-and-synthetics"})},{path:"/monitoring",component:()=>n.createElement(K,{navId:"monitoring"})},{path:"/infrastructure",component:()=>n.createElement(K,{navId:"infrastructure"})},{path:"/frontend",component:()=>n.createElement(K,{navId:"frontend"})},{path:"/admin/general",component:()=>n.createElement(K,{navId:"cfg/general"})},{path:"/admin/plugins",component:()=>n.createElement(K,{navId:"cfg/plugins"})},{path:"/admin/access",component:()=>n.createElement(K,{navId:"cfg/access"})},{path:"/org",component:(0,vn.A)(()=>e.e(1510).then(e.bind(e,69047)))},{path:"/org/new",component:(0,vn.A)(()=>e.e(7930).then(e.bind(e,25913)))},{path:"/org/users",component:(0,vn.A)(()=>e.e(9856).then(e.bind(e,31083)))},{path:"/org/users/invite",component:(0,vn.A)(()=>e.e(7720).then(e.bind(e,91230)))},{path:"/org/apikeys",roles:()=>V.TP.evaluatePermission([j.AccessControlAction.ActionAPIKeysRead]),component:(0,vn.A)(()=>e.e(4196).then(e.bind(e,9699)))},{path:"/org/serviceaccounts",roles:()=>V.TP.evaluatePermission([j.AccessControlAction.ServiceAccountsRead,j.AccessControlAction.ServiceAccountsCreate]),component:(0,vn.A)(()=>e.e(6777).then(e.bind(e,23645)))},{path:"/org/serviceaccounts/create",component:(0,vn.A)(()=>e.e(4176).then(e.bind(e,63606)))},{path:"/org/serviceaccounts/:id",component:(0,vn.A)(()=>e.e(6576).then(e.bind(e,82936)))},{path:"/org/teams",roles:()=>V.TP.evaluatePermission([j.AccessControlAction.ActionTeamsRead,j.AccessControlAction.ActionTeamsCreate]),component:(0,vn.A)(()=>e.e(1036).then(e.bind(e,52576)))},{path:"/org/teams/new",roles:()=>V.TP.evaluatePermission([j.AccessControlAction.ActionTeamsCreate]),component:(0,vn.A)(()=>e.e(5436).then(e.bind(e,80011)))},{path:"/org/teams/edit/:id/:page?",roles:()=>V.TP.evaluatePermission([j.AccessControlAction.ActionTeamsRead,j.AccessControlAction.ActionTeamsCreate]),component:(0,vn.A)(()=>e.e(2212).then(e.bind(e,82508)))},{path:"/admin",component:()=>n.createElement(K,{navId:"cfg",header:n.createElement(tt,null)})},{path:"/admin/authentication",roles:()=>V.TP.evaluatePermission([j.AccessControlAction.SettingsWrite]),component:v.Ay.licenseInfo.enabledFeatures?.saml||v.Ay.ldapEnabled||v.Ay.featureToggles.ssoSettingsApi?(0,vn.A)(()=>e.e(5592).then(e.bind(e,51332))):()=>n.createElement(a.rd,{to:"/admin"})},{path:"/admin/authentication/ldap",component:Tn},{path:"/admin/authentication/:provider",roles:()=>V.TP.evaluatePermission([j.AccessControlAction.SettingsWrite]),component:v.Ay.featureToggles.ssoSettingsApi?(0,vn.A)(()=>e.e(5592).then(e.bind(e,22468))):()=>n.createElement(a.rd,{to:"/admin"})},{path:"/admin/settings",component:(0,vn.A)(()=>e.e(7659).then(e.bind(e,98493)))},{path:"/admin/upgrading",component:(0,vn.A)(()=>Promise.resolve().then(e.bind(e,55356)))},{path:"/admin/users",component:(0,vn.A)(()=>e.e(1743).then(e.bind(e,18231)))},{path:"/admin/users/create",component:(0,vn.A)(()=>e.e(9239).then(e.bind(e,64665)))},{path:"/admin/users/edit/:id",component:ht},{path:"/admin/orgs",component:(0,vn.A)(()=>e.e(9736).then(e.bind(e,24870)))},{path:"/admin/orgs/edit/:id",component:(0,vn.A)(()=>e.e(9119).then(e.bind(e,57582)))},{path:"/admin/featuretoggles",component:v.Ay.featureToggles.featureToggleAdminPage?(0,vn.A)(()=>e.e(7024).then(e.bind(e,47295))):()=>n.createElement(a.rd,{to:"/admin"})},{path:"/admin/storage/:path*",roles:()=>["Admin"],component:(0,vn.A)(()=>e.e(1927).then(e.bind(e,68932)))},{path:"/admin/stats",component:(0,vn.A)(()=>Promise.resolve().then(e.bind(e,51372)))},v.Ay.featureToggles.onPremToCloudMigrations&&{path:"/admin/migrate-to-cloud",roles:()=>["Admin"],component:(0,vn.A)(()=>e.e(3704).then(e.bind(e,44953)))},{path:"/login",component:x,pageClass:"login-page",chromeless:!0},{path:"/invite/:code",component:(0,vn.A)(()=>e.e(8576).then(e.bind(e,14383))),chromeless:!0},{path:"/verify",component:v.Ay.verifyEmailEnabled?(0,vn.A)(()=>e.e(8786).then(e.bind(e,78786))):()=>n.createElement(a.rd,{to:"/signup"}),pageClass:"login-page",chromeless:!0},{path:"/signup",component:v.Ay.disableUserSignUp?()=>n.createElement(a.rd,{to:"/login"}):(0,vn.A)(()=>e.e(7914).then(e.bind(e,27914))),pageClass:"login-page",chromeless:!0},{path:"/user/password/send-reset-email",chromeless:!0,component:(0,vn.A)(()=>e.e(3818).then(e.bind(e,2713)))},{path:"/user/password/reset",component:(0,vn.A)(()=>e.e(641).then(e.bind(e,37344))),pageClass:"login-page",chromeless:!0},{path:"/dashboard/snapshots",component:(0,vn.A)(()=>e.e(6590).then(e.bind(e,72602)))},v.Ay.featureToggles.dashboardRestore&&{path:"/dashboard/recentlyDeleted",roles:()=>V.TP.evaluatePermission([j.AccessControlAction.DashboardsDelete]),component:(0,vn.A)(()=>Promise.all([e.e(6359),e.e(6299)]).then(e.bind(e,92126)))},{path:"/playlists",component:(0,vn.A)(()=>e.e(1168).then(e.bind(e,44450)))},{path:"/playlists/play/:uid",component:(0,vn.A)(()=>e.e(1374).then(e.bind(e,93129)))},{path:"/playlists/new",component:(0,vn.A)(()=>e.e(7616).then(e.bind(e,62579)))},{path:"/playlists/edit/:uid",component:(0,vn.A)(()=>e.e(7620).then(e.bind(e,84535)))},{path:"/sandbox/benchmarks",component:(0,vn.A)(()=>e.e(9354).then(e.bind(e,98351)))},{path:"/sandbox/test",component:(0,vn.A)(()=>e.e(5354).then(e.bind(e,65802)))},{path:"/dashboards/f/:uid/:slug/library-panels",component:(0,vn.A)(()=>e.e(5804).then(e.bind(e,15111)))},{path:"/dashboards/f/:uid/:slug/alerting",roles:()=>V.TP.evaluatePermission([j.AccessControlAction.AlertingRuleRead]),component:(0,vn.A)(()=>e.e(4333).then(e.bind(e,30027)))},{path:"/library-panels",component:(0,vn.A)(()=>e.e(8516).then(e.bind(e,45434)))},{path:"/notifications",component:(0,vn.A)(()=>e.e(4140).then(e.bind(e,78015)))},{path:"/explore/metrics",chromeless:!1,exact:!1,component:(0,vn.A)(()=>e.e(4785).then(e.bind(e,89858)))},...So(),...Ur(),...Yn(),..._r(),...Eo,...Rr(),...Dt(),{path:"/*",component:W}].filter(o.zz)}function Ur(At=v.Ay){return At.supportBundlesEnabled?[{path:"/support-bundles",component:(0,vn.A)(()=>e.e(123).then(e.bind(e,21821)))},{path:"/support-bundles/create",component:(0,vn.A)(()=>e.e(1515).then(e.bind(e,33809)))}]:[]}},2272:(Q,I,e)=>{"use strict";e.d(I,{C3:()=>Ne,Co:()=>Pe,U1:()=>We});var n=e(65307),a=e(10378),o=e(55314),r=e(72686),i=e(59120),f=e(28215),d=e(14644),l=e(16001),m=e(91219);const s={navBarTree:m.I_,navIndex:f._h,appNotifications:l.g5};var h=e(44672),u=e(47232),b=e(88467),g=e(23770);const c=(0,d.combineReducers)({dataSources:(0,b.Xw)("dataSources",g.DC,({rulesSourceName:Ae})=>Ae).reducer,promRules:(0,b.Xw)("promRules",g.mB,({rulesSourceName:Ae})=>Ae).reducer,rulerRules:(0,b.Xw)("rulerRules",g.eB,({rulesSourceName:Ae})=>Ae).reducer,ruleForm:(0,d.combineReducers)({saveRule:(0,b.J7)("saveRule",g._$).reducer}),grafanaNotifiers:(0,b.J7)("grafanaNotifiers",g.mF).reducer,saveAMConfig:(0,b.J7)("saveAMConfig",g.RW).reducer,deleteAMConfig:(0,b.J7)("deleteAMConfig",g.nO).reducer,folders:(0,b.Xw)("folders",g.Tp,Ae=>Ae).reducer,amAlertGroups:(0,b.Xw)("amAlertGroups",g.D3,Ae=>Ae).reducer,testReceivers:(0,b.J7)("testReceivers",g.bO).reducer,updateLotexNamespaceAndGroup:(0,b.J7)("updateLotexNamespaceAndGroup",g.LU).reducer,managedAlertStateHistory:(0,b.J7)("managedAlertStateHistory",g.JH).reducer});var y=e(55907);const p={items:[],searchQuery:"",isLoading:!1},v={notificationChannelTypes:[],notificationChannel:{},notifiers:[]};function D(Ae,Ue){const Me=y.A.getStateDisplayModel(Ue),$e={...Ae,stateText:Me.text,stateIcon:Me.iconClass,stateClass:Me.stateClass,stateAge:(0,u.KQ)(Ae.newStateDate).fromNow(!0)};return $e.state!=="paused"&&($e.executionError&&($e.info="Execution Error: "+$e.executionError),$e.evalData&&$e.evalData.noData&&($e.info="Query returned no data")),$e}const E=(0,n.Z0)({name:"alertRules",initialState:p,reducers:{loadAlertRules:Ae=>({...Ae,isLoading:!0}),loadedAlertRules:(Ae,Ue)=>{const $e=Ue.payload.map(ke=>D(ke,ke.state));return{...Ae,items:$e,isLoading:!1}},setSearchQuery:(Ae,Ue)=>({...Ae,searchQuery:Ue.payload})}}),S=(0,n.Z0)({name:"notificationChannel",initialState:v,reducers:{setNotificationChannels:(Ae,Ue)=>({...Ae,notificationChannelTypes:K(Ue.payload),notifiers:Ue.payload}),notificationChannelLoaded:(Ae,Ue)=>{const Me=Ue.payload,ke=Ae.notifiers.find(Ze=>Ze.type===Me.type).options.filter(Ze=>Ze.secure);return ke.length>0&&ke.some(Ze=>Me.settings[Ze.propertyName]!=="")?F(Ae,Ue.payload,ke):{...Ae,notificationChannel:Me}},resetSecureField:(Ae,Ue)=>({...Ae,notificationChannel:{...Ae.notificationChannel,secureFields:{...Ae.notificationChannel.secureFields,[Ue.payload]:!1}}})}}),{loadAlertRules:T,loadedAlertRules:M,setSearchQuery:A}=E.actions,{setNotificationChannels:x,notificationChannelLoaded:C,resetSecureField:O}=S.actions,R=E.reducer,L=S.reducer,N={alertRules:R,notificationChannel:L,unifiedAlerting:c};function F(Ae,Ue,Me){const $e={},ke={};return Me.forEach(Ze=>{ke[Ze.propertyName]=Ue.settings[Ze.propertyName],$e[Ze.propertyName]=""}),{...Ae,notificationChannel:{...Ue,settings:{...Ue.settings,...$e},secureSettings:{...ke}}}}function K(Ae){return Ae.map(Ue=>({value:Ue.type,label:Ue.name,...Ue,typeName:Ue.type})).sort((Ue,Me)=>Ue.name>Me.name?1:-1)}var B=e(93584),w=e(20604),U=e(79763),W=e(53466),V=e(28601),_=e(36227),H=e(29436),G=e(54650),j=e(40823),Y=e(88264),oe=e(10943),se=e(80095),ne=e(31326),ee=e(81862),Z=e(1936),z=e(8212),q=e(34655),ie=e(87617),de=e(48594),ue=e(49962),fe=e(82537),Se=e(97007);const he={...s,...N,...q.Ay,...B.Ay,...G.Ay,...V.Ay,...H.Ay,..._.Ay,...ie.Ay,...Z.Ay,...ee.Ay,...j.Ay,...oe.Ay,...U.Ay,...h.Ay,...Y.Ay,...W.Ay,...se.Ay,...de.Ay,...z.Ay,...w.Ay,plugins:ne.Ff,[ue.H.reducerPath]:ue.H.reducer,[r.Sm.reducerPath]:r.Sm.reducer,[o.cU.reducerPath]:o.cU.reducer,[i.O5.reducerPath]:i.O5.reducer,[fe.g.reducerPath]:fe.g.reducer},ce={},me=Ae=>{Object.assign(ce,Ae)},pe=()=>{const Ae=(0,d.combineReducers)({...he,...ce});return(Ue,Me)=>{if(Me.type!==Se.N.type)return Ae(Ue,Me);const{cleanupAction:$e}=Me.payload;return $e(Ue),Ae(Ue,Me)}};var ye=e(99140);function Pe(Ae){me(Ae)}const Ie=(0,n.Nc)(),Oe=[];function Ne(Ae){Oe.push(Ae)}function We(Ae){const Ue=(0,n.U1)({reducer:pe(),middleware:Me=>Me({thunk:!0,serializableCheck:!1,immutableCheck:!1}).concat(Ie.middleware,ue.H.middleware,r.Sm.middleware,o.cU.middleware,i.O5.middleware,fe.g.middleware,...Oe),devTools:!1,preloadedState:{navIndex:(0,f.s2)(),...Ae}});return(0,a.$k)(Ue.dispatch),(0,ye.k3)(Ue),Ue}},99140:(Q,I,e)=>{"use strict";e.d(I,{Gu:()=>r,JD:()=>i,M_:()=>a,k3:()=>o});var n=e(48594);let a;function o(f){a=f}function r(){return!a||!a.getState?{templating:{...n.L1,lastKey:"key"}}:a.getState()}function i(f){if(!(!a||!a.getState))return a.dispatch(f)}},24897:(Q,I,e)=>{"use strict";e.d(I,{RG:()=>o,Vz:()=>r,XT:()=>n.X,Xe:()=>a});var n=e(62625),a=(i=>(i[i.Admin=4]="Admin",i[i.Editor=2]="Editor",i[i.Member=0]="Member",i[i.Viewer=1]="Viewer",i))(a||{}),o=(i=>(i.View="View",i.Edit="Edit",i.Admin="Admin",i))(o||{}),r=(i=>(i.Folder="dash-folder",i.Dashboard="dash-db",i.AlertFolder="dash-folder-alerting",i))(r||{})},50271:()=>{"use strict"},18625:()=>{"use strict"},14276:()=>{"use strict"},95425:(Q,I,e)=>{"use strict";e.d(I,{Z4:()=>n,_g:()=>a,d9:()=>o});var n=(r=>(r.Home="home-dashboard",r.New="new-dashboard",r.Normal="normal-dashboard",r.Path="path-dashboard",r.Scripted="scripted-dashboard",r.Public="public-dashboard",r.Embedded="embedded-dashboard",r.Report="report-dashboard",r))(n||{}),a=(r=>(r.NotStarted="Not started",r.Fetching="Fetching",r.Services="Services",r.Failed="Failed",r.Completed="Completed",r))(a||{}),o=(r=>(r.TV="tv",r.Full="full",r))(o||{})},62543:()=>{"use strict"},28444:(Q,I,e)=>{"use strict";e.d(I,{Bt:()=>p,Cf:()=>u,Eu:()=>x,Io:()=>y,JI:()=>m,PR:()=>s,Ps:()=>S,Q$:()=>h,Rh:()=>D,S8:()=>M,U0:()=>P,VZ:()=>v,Vz:()=>E,XM:()=>g,Yn:()=>f,aP:()=>A,bG:()=>i,bY:()=>T,i0:()=>L,sL:()=>R,u4:()=>d,vk:()=>b,xL:()=>c,xc:()=>C,yj:()=>O,zq:()=>l});var n=e(89550),a=e(65463);const o=(0,n.R)("ds-request-response"),r=(0,n.R)("ds-request-error"),i=(0,n.R)("template-variable-value-updated"),f=(0,n.R)("graph-click"),d=(0,n.R)("threshold-changed");class l extends a.a{static{this.type="panel-queries-changed"}}class m extends a.a{static{this.type="panel-transformations-changed"}}class s extends a.a{static{this.type="panels-options-changed"}}class h extends a.a{static{this.type="dashboard-panels-changed"}}class u extends a.a{static{this.type="dashboard-meta-changed"}}class b extends a.a{static{this.type="panel-directive-ready"}}class g extends a.a{static{this.type="render"}}class P extends a.x{static{this.type="zoom-out"}}var c=(N=>(N[N.Left=-1]="Left",N[N.Right=1]="Right",N))(c||{});class y extends a.x{static{this.type="shift-time"}}class p extends a.a{static{this.type="copy-time"}}class v extends a.x{static{this.type="paste-time"}}class D extends a.x{static{this.type="absolute-time"}}class E extends a.x{static{this.type="remove-panel"}}class S extends a.x{static{this.type="show-modal"}}class T extends a.x{static{this.type="show-confirm-modal"}}class M extends a.x{static{this.type="show-react-modal"}}class A extends a.a{static{this.type="hide-modal"}}class x extends a.a{static{this.type="dashboard-saved"}}class C extends a.x{static{this.type="annotation-query-started"}}class O extends a.x{static{this.type="annotation-query-finished"}}class R extends a.x{static{this.type="panel-edit-started"}}class L extends a.x{static{this.type="panel-edit-finished"}}},76698:(Q,I,e)=>{"use strict";e.d(I,{IW:()=>n,aA:()=>o,jH:()=>r,sG:()=>a});var n=(i=>(i[i.CLOSE_PANE=0]="CLOSE_PANE",i[i.CHANGE_DATASOURCE=1]="CHANGE_DATASOURCE",i[i.CLOSE_EDITOR=2]="CLOSE_EDITOR",i))(n||{});const a=["lines","bars","points","stacked_lines","stacked_bars"];var o=(i=>(i.table="table",i.raw="raw",i))(o||{});const r=["table","raw"]},8904:()=>{"use strict"},31678:(Q,I,e)=>{"use strict";e.d(I,{AccessControlAction:()=>D,AppNotificationSeverity:()=>u,CORRELATION_EDITOR_POST_CONFIRM_ACTION:()=>P.IW,CoreEvents:()=>E,DashboardInitPhase:()=>r._g,DashboardRoutes:()=>r.Z4,EXPLORE_GRAPH_STYLES:()=>P.sG,KioskMode:()=>r.d9,OrgRole:()=>i.XT,PermissionLevelString:()=>i.RG,SearchQueryType:()=>i.Vz,ServiceAccountStateFilter:()=>l,TABLE_RESULTS_STYLE:()=>P.aA,TeamPermissionLevel:()=>i.Xe,addListener:()=>c.ch,createAsyncThunk:()=>c.zD,timeoutMap:()=>g,useDispatch:()=>c.wA,useSelector:()=>c.d4});var n=e(50271),a=e(54034),o=e(8904),r=e(95425),i=e(24897),f=e(18625),d=e(64998),l=(S=>(S.All="All",S.WithExpiredTokens="WithExpiredTokens",S.External="External",S.Disabled="Disabled",S))(l||{}),m=e(62543),s=e(77237),h=e(75330),u=(S=>(S.Success="success",S.Warning="warning",S.Error="error",S.Info="info",S))(u||{}),b=(S=>(S[S.Success=3e3]="Success",S[S.Warning=5e3]="Warning",S[S.Error=7e3]="Error",S))(b||{});const g={success:3e3,warning:5e3,error:7e3,info:3e3};var P=e(76698),c=e(64756),y=e(13868),p=e(14276),v=e(90697),D=(S=>(S.UsersRead="users:read",S.UsersWrite="users:write",S.UsersAuthTokenList="users.authtoken:read",S.UsersAuthTokenUpdate="users.authtoken:write",S.UsersPasswordUpdate="users.password:write",S.UsersDelete="users:delete",S.UsersCreate="users:create",S.UsersEnable="users:enable",S.UsersDisable="users:disable",S.UsersPermissionsUpdate="users.permissions:write",S.UsersLogout="users:logout",S.UsersQuotasList="users.quotas:read",S.UsersQuotasUpdate="users.quotas:write",S.ServiceAccountsRead="serviceaccounts:read",S.ServiceAccountsCreate="serviceaccounts:create",S.ServiceAccountsWrite="serviceaccounts:write",S.ServiceAccountsDelete="serviceaccounts:delete",S.ServiceAccountsPermissionsRead="serviceaccounts.permissions:read",S.ServiceAccountsPermissionsWrite="serviceaccounts.permissions:write",S.OrgsRead="orgs:read",S.OrgsPreferencesRead="orgs.preferences:read",S.OrgsWrite="orgs:write",S.OrgsPreferencesWrite="orgs.preferences:write",S.OrgsCreate="orgs:create",S.OrgsDelete="orgs:delete",S.OrgUsersRead="org.users:read",S.OrgUsersAdd="org.users:add",S.OrgUsersRemove="org.users:remove",S.OrgUsersWrite="org.users:write",S.LDAPUsersRead="ldap.user:read",S.LDAPUsersSync="ldap.user:sync",S.LDAPStatusRead="ldap.status:read",S.DataSourcesExplore="datasources:explore",S.DataSourcesRead="datasources:read",S.DataSourcesCreate="datasources:create",S.DataSourcesWrite="datasources:write",S.DataSourcesDelete="datasources:delete",S.DataSourcesPermissionsRead="datasources.permissions:read",S.DataSourcesCachingRead="datasources.caching:read",S.DataSourcesInsightsRead="datasources.insights:read",S.ActionServerStatsRead="server.stats:read",S.ActionTeamsCreate="teams:create",S.ActionTeamsDelete="teams:delete",S.ActionTeamsRead="teams:read",S.ActionTeamsWrite="teams:write",S.ActionTeamsPermissionsRead="teams.permissions:read",S.ActionTeamsPermissionsWrite="teams.permissions:write",S.ActionRolesList="roles:read",S.ActionTeamsRolesList="teams.roles:read",S.ActionTeamsRolesAdd="teams.roles:add",S.ActionTeamsRolesRemove="teams.roles:remove",S.ActionUserRolesList="users.roles:read",S.ActionUserRolesAdd="users.roles:add",S.ActionUserRolesRemove="users.roles:remove",S.DashboardsRead="dashboards:read",S.DashboardsWrite="dashboards:write",S.DashboardsDelete="dashboards:delete",S.DashboardsCreate="dashboards:create",S.DashboardsPermissionsRead="dashboards.permissions:read",S.DashboardsPermissionsWrite="dashboards.permissions:write",S.DashboardsPublicWrite="dashboards.public:write",S.FoldersRead="folders:read",S.FoldersWrite="folders:write",S.FoldersDelete="folders:delete",S.FoldersCreate="folders:create",S.FoldersPermissionsRead="folders.permissions:read",S.FoldersPermissionsWrite="folders.permissions:write",S.ActionSupportBundlesCreate="support.bundles:create",S.ActionSupportBundlesRead="support.bundles:read",S.ActionSupportBundlesDelete="support.bundles:delete",S.AlertingRuleCreate="alert.rules:create",S.AlertingRuleRead="alert.rules:read",S.AlertingRuleUpdate="alert.rules:write",S.AlertingRuleDelete="alert.rules:delete",S.AlertingInstanceCreate="alert.instances:create",S.AlertingInstanceUpdate="alert.instances:write",S.AlertingInstanceRead="alert.instances:read",S.AlertingSilenceCreate="alert.silences:create",S.AlertingSilenceUpdate="alert.silences:write",S.AlertingSilenceRead="alert.silences:read",S.AlertingNotificationsRead="alert.notifications:read",S.AlertingNotificationsWrite="alert.notifications:write",S.AlertingRuleExternalWrite="alert.rules.external:write",S.AlertingRuleExternalRead="alert.rules.external:read",S.AlertingInstancesExternalWrite="alert.instances.external:write",S.AlertingInstancesExternalRead="alert.instances.external:read",S.AlertingNotificationsExternalWrite="alert.notifications.external:write",S.AlertingNotificationsExternalRead="alert.notifications.external:read",S.AlertingProvisioningReadSecrets="alert.provisioning.secrets:read",S.AlertingProvisioningRead="alert.provisioning:read",S.AlertingProvisioningWrite="alert.provisioning:write",S.ActionAPIKeysRead="apikeys:read",S.ActionAPIKeysCreate="apikeys:create",S.ActionAPIKeysDelete="apikeys:delete",S.PluginsInstall="plugins:install",S.PluginsWrite="plugins:write",S.SettingsRead="settings:read",S.SettingsWrite="settings:write",S))(D||{}),E=e(28444)},13868:()=>{"use strict"},54034:()=>{"use strict"},75330:()=>{"use strict"},77237:()=>{"use strict"},90697:()=>{"use strict"},64756:(Q,I,e)=>{"use strict";e.d(I,{ch:()=>f,d4:()=>r,wA:()=>o,zD:()=>i});var n=e(65307),a=e(71468);const o=a.useDispatch,r=a.useSelector,i=(d,l,m)=>(0,n.zD)(d,l,m),f=n.ch},38824:(Q,I,e)=>{"use strict";e.d(I,{m:()=>n});var n=(a=>(a.LineChart="Line chart",a.LineChartSmooth="Line chart smooth",a.LineChartGradientColorScheme="Line chart with gradient color scheme",a.AreaChart="Area chart",a.AreaChartStacked="Area chart stacked",a.AreaChartStackedPercent="Area chart 100% stacked",a.BarChart="Bar chart",a.BarChartGradientColorScheme="Bar chart with gradient color scheme",a.BarChartStacked="Bar chart stacked",a.BarChartStackedPercent="Bar chart 100% stacked",a.BarChartHorizontal="Bar chart horizontal",a.BarChartHorizontalStacked="Bar chart horizontal stacked",a.BarChartHorizontalStackedPercent="Bar chart horizontal 100% stacked",a.Candlestick="Candlestick",a.PieChart="Pie chart",a.PieChartDonut="Pie chart donut",a.Stat="Stat",a.StatColoredBackground="Stat colored background",a.Gauge="Gauge",a.GaugeNoThresholds="Gauge no thresholds",a.BarGaugeBasic="Bar gauge basic",a.BarGaugeLCD="Bar gauge LCD",a.Table="Table",a.StateTimeline="State timeline",a.StatusHistory="Status history",a.TextPanel="Text",a.DashboardList="Dashboard list",a.Logs="Logs",a.FlameGraph="Flame graph",a.Trace="Trace",a.NodeGraph="Node graph",a))(n||{})},94822:(Q,I,e)=>{"use strict";e.d(I,{Gi:()=>a,JS:()=>d,N1:()=>l,Q8:()=>m,Si:()=>o,cF:()=>n,lh:()=>f,s1:()=>r});var n=(s=>(s.Firing="firing",s.Inactive="inactive",s.Pending="pending",s))(n||{}),a=(s=>(s.Normal="Normal",s.Alerting="Alerting",s.Pending="Pending",s.NoData="NoData",s.Error="Error",s))(a||{});function o(s){return Object.values(n).includes(s)}function r(s){return Object.values(a).some(h=>h===s)}function i(s){const h=Object.values(n);return s!=null&&!h.includes(s)}function f(s){return i(s)?s.split(" ")[0]:s}var d=(s=>(s.Alerting="alerting",s.Recording="recording",s))(d||{}),l=(s=>(s.Cortex="Cortex",s.Mimir="Mimir",s.Prometheus="Prometheus",s.Thanos="Thanos",s))(l||{}),m=(s=>(s.Alerting="Alerting",s.NoData="NoData",s.KeepLast="KeepLast",s.OK="OK",s.Error="Error",s))(m||{})},54317:(Q,I,e)=>{"use strict";e.d(I,{$:()=>r,S:()=>a});var n=e(94822);function a(i,f){return(0,n.lh)(i.state)===f}var o=(i=>(i.Firing="firing",i))(o||{}),r=(i=>(i.Alerting="alerting",i.Pending="pending",i.Normal="inactive",i.NoData="nodata",i.Error="error",i))(r||{})},64998:()=>{"use strict"},72834:Q=>{const I="    ";function e(r){let i="";return r&&Object.keys(r).forEach(function(f){i+=f+":"+r[f]+";"}),i}function n(r){function i(d){return'class="'+d+'"'}function f(d){return'style="'+e(r["."+d])+'"'}return r?f:i}function a(r){return r===null?"null":Array.isArray(r)?"array":typeof r=="string"&&/^https?:/.test(r)?"link":typeof r=="object"&&typeof r.toISOString=="function"?"date":typeof r}function o(r){return r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}Q.exports=function(r,i){let f="";const d=n(i);let l=function(s,h,u,b){if(!s.length)return h+" "+u;let g=h+`
`;return f+=I,s.forEach(function(P,c){g+=f+b(P)+(c<s.length-1?",":"")+`
`}),f=f.slice(0,-I.length),g+f+u};function m(s){if(s===void 0)return"";switch(a(s)){case"boolean":return"<span "+d("json-markup-bool")+">"+s+"</span>";case"number":return"<span "+d("json-markup-number")+">"+s+"</span>";case"date":return'<span class="json-markup-string">"'+o(s.toISOString())+'"</span>';case"null":return"<span "+d("json-markup-null")+">null</span>";case"string":return"<span "+d("json-markup-string")+'>"'+o(s.replace(/\n/g,`
`+f))+'"</span>';case"link":return"<span "+d("json-markup-string")+'>"<a href="'+encodeURI(s)+'">'+o(s)+'</a>"</span>';case"array":return l(s,"[","]",m);case"object":const h=Object.keys(s).filter(function(u){return s[u]!==void 0});return l(h,"{","}",function(u){return"<span "+d("json-markup-key")+'>"'+o(u)+'":</span> '+m(s[u])})}return""}return"<div "+d("json-markup")+">"+m(r)+"</div>"}},13609:()=>{(function(Q){"use strict";Q(function(){Q.support.transition=function(){var I=function(){var e=document.createElement("bootstrap"),n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},a;for(a in n)if(e.style[a]!==void 0)return n[a]}();return I&&{end:I}}()})})(window.jQuery),function(Q){"use strict";var I="[data-toggle=dropdown]",e=function(r){var i=Q(r).on("click.dropdown.data-api",this.toggle);Q("html").on("click.dropdown.data-api",function(){i.parent().removeClass("open")})};e.prototype={constructor:e,toggle:function(r){var i=Q(this),f,d;if(!i.is(".disabled, :disabled"))return f=a(i),d=f.hasClass("open"),n(),d||("ontouchstart"in document.documentElement&&Q('<div class="dropdown-backdrop"/>').insertBefore(Q(this)).on("click",n),f.toggleClass("open")),i.focus(),!1},keydown:function(r){var i,f,d,l,m,s;if(/(38|40|27)/.test(r.keyCode)&&(i=Q(this),r.preventDefault(),r.stopPropagation(),!i.is(".disabled, :disabled"))){if(l=a(i),m=l.hasClass("open"),!m||m&&r.keyCode==27)return r.which==27&&l.find(I).focus(),i.click();f=Q("[role=menu] li:not(.divider):visible a",l),f.length&&(s=f.index(f.filter(":focus")),r.keyCode==38&&s>0&&s--,r.keyCode==40&&s<f.length-1&&s++,~s||(s=0),f.eq(s).focus())}}};function n(){Q(".dropdown-backdrop").remove(),Q(I).each(function(){a(Q(this)).removeClass("open")})}function a(r){var i=r.attr("data-target"),f;return i||(i=r.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,"")),f=i&&Q.find(i),(!f||!f.length)&&(f=r.parent()),f}var o=Q.fn.dropdown;Q.fn.dropdown=function(r){return this.each(function(){var i=Q(this),f=i.data("dropdown");f||i.data("dropdown",f=new e(this)),typeof r=="string"&&f[r].call(i)})},Q.fn.dropdown.Constructor=e,Q.fn.dropdown.noConflict=function(){return Q.fn.dropdown=o,this},Q(document).on("click.dropdown.data-api",n).on("click.dropdown.data-api",".dropdown form",function(r){r.stopPropagation()}).on("click.dropdown.data-api",I,e.prototype.toggle).on("keydown.dropdown.data-api",I+", [role=menu]",e.prototype.keydown)}(window.jQuery),function(Q){"use strict";var I=function(n,a){this.options=a,this.$element=Q(n).delegate('[data-dismiss="modal"]',"click.dismiss.modal",Q.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};I.prototype={constructor:I,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var n=this,a=Q.Event("show");this.$element.trigger(a),!(this.isShown||a.isDefaultPrevented())&&(this.isShown=!0,this.escape(),this.backdrop(function(){var o=Q.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show(),o&&n.$element[0].offsetWidth,n.$element.addClass("in").attr("aria-hidden",!1),n.enforceFocus(),o?n.$element.one(Q.support.transition.end,function(){n.$element.focus().trigger("shown")}):n.$element.focus().trigger("shown")}))},hide:function(n){n&&n.preventDefault();var a=this;n=Q.Event("hide"),this.$element.trigger(n),!(!this.isShown||n.isDefaultPrevented())&&(this.isShown=!1,this.escape(),Q(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),Q.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var n=this;Q(document).on("focusin.modal",function(a){n.$element[0]!==a.target&&!n.$element.has(a.target).length&&n.$element.focus()})},escape:function(){var n=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(a){a.which==27&&n.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var n=this,a=setTimeout(function(){n.$element.off(Q.support.transition.end),n.hideModal()},500);this.$element.one(Q.support.transition.end,function(){clearTimeout(a),n.hideModal()})},hideModal:function(){var n=this;this.$element.hide(),this.backdrop(function(){n.removeBackdrop(),n.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(n){var a=this,o=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var r=Q.support.transition&&o;if(this.$backdrop=Q('<div class="modal-backdrop '+o+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?Q.proxy(this.$element[0].focus,this.$element[0]):Q.proxy(this.hide,this)),r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!n)return;r?this.$backdrop.one(Q.support.transition.end,n):n()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),Q.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(Q.support.transition.end,n):n()):n&&n()}};var e=Q.fn.modal;Q.fn.modal=function(n){return this.each(function(){var a=Q(this),o=a.data("modal"),r=Q.extend({},Q.fn.modal.defaults,a.data(),typeof n=="object"&&n);o||a.data("modal",o=new I(this,r)),typeof n=="string"?o[n]():r.show&&o.show()})},Q.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},Q.fn.modal.Constructor=I,Q.fn.modal.noConflict=function(){return Q.fn.modal=e,this},Q(document).on("click.modal.data-api",'[data-toggle="modal"]',function(n){var a=Q(this),o=a.attr("href"),r=Q.find(a.attr("data-target")||o&&o.replace(/.*(?=#[^\s]+$)/,"")),i=r.data("modal")?"toggle":Q.extend({remote:!/#/.test(o)&&o},r.data(),a.data());n.preventDefault(),r.modal(i).one("hide",function(){a.focus()})})}(window.jQuery),function(Q){"use strict";var I=function(n,a){this.init("tooltip",n,a)};I.prototype={constructor:I,init:function(n,a,o){var r,i,f,d,l;for(this.type=n,this.$element=Q(a),this.options=this.getOptions(o),this.enabled=!0,f=this.options.trigger.split(" "),l=f.length;l--;)d=f[l],d=="click"?this.$element.on("click."+this.type,this.options.selector,Q.proxy(this.toggle,this)):d!="manual"&&(r=d=="hover"?"mouseenter":"focus",i=d=="hover"?"mouseleave":"blur",this.$element.on(r+"."+this.type,this.options.selector,Q.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,Q.proxy(this.leave,this)));this.options.selector?this._options=Q.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(n){return n=Q.extend({},Q.fn[this.type].defaults,this.$element.data(),n),n.delay&&typeof n.delay=="number"&&(n.delay={show:n.delay,hide:n.delay}),n},enter:function(n){var a=Q.fn[this.type].defaults,o={},r;if(this._options&&Q.each(this._options,function(i,f){a[i]!=f&&(o[i]=f)},this),r=Q(n.currentTarget)[this.type](o).data(this.type),!r.options.delay||!r.options.delay.show)return r.show();clearTimeout(this.timeout),r.hoverState="in",this.timeout=setTimeout(function(){r.hoverState=="in"&&r.show()},r.options.delay.show)},leave:function(n){var a=Q(n.currentTarget)[this.type](this._options).data(this.type);if(this.timeout&&clearTimeout(this.timeout),!a.options.delay||!a.options.delay.hide)return a.hide();a.hoverState="out",this.timeout=setTimeout(function(){a.hoverState=="out"&&a.hide()},a.options.delay.hide)},show:function(){var n,a,o,r,i,f,d=Q.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(d),d.isDefaultPrevented())return;switch(n=this.tip(),this.setContent(),this.options.animation&&n.addClass("fade"),i=typeof this.options.placement=="function"?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,n.detach().css({top:0,left:0,display:"block"}),this.options.container?n.appendTo(Q.find(this.options.container)):n.insertAfter(this.$element),a=this.getPosition(),o=n[0].offsetWidth,r=n[0].offsetHeight,i){case"bottom":f={top:a.top+a.height,left:a.left+a.width/2-o/2};break;case"top":f={top:a.top-r,left:a.left+a.width/2-o/2};break;case"left":f={top:a.top+a.height/2-r/2,left:a.left-o};break;case"right":f={top:a.top+a.height/2-r/2,left:a.left+a.width};break;case"topLeft":f={top:a.top-r,left:a.left+a.width/2-o*.1};break;case"topRight":f={top:a.top-r,left:a.left+a.width/2-o*.9};break;case"rightTop":f={top:a.top+a.height/2-r*.1,left:a.left+a.width};break;case"rightBottom":f={top:a.top+a.height/2-r*.9,left:a.left+a.width};break;case"bottomLeft":f={top:a.top+a.height,left:a.left+a.width/2-o*.1};break;case"bottomRight":f={top:a.top+a.height,left:a.left+a.width/2-o*.9};break;case"leftTop":f={top:a.top+a.height/2-r*.1,left:a.left-o};break;case"leftBottom":f={top:a.top+a.height/2-r*.9,left:a.left-o};break}this.applyPlacement(f,i),this.$element.trigger("shown")}},applyPlacement:function(n,a){var o=this.tip(),r=o[0].offsetWidth,i=o[0].offsetHeight,f,d,l,m;o.offset(n).addClass(a).addClass("in"),f=o[0].offsetWidth,d=o[0].offsetHeight,a=="top"&&d!=i&&(n.top=n.top+i-d,m=!0),a=="bottom"||a=="top"?(l=0,n.left<0&&(l=n.left*-2,n.left=0,o.offset(n),f=o[0].offsetWidth,d=o[0].offsetHeight),this.replaceArrow(l-r+f,f,"left")):this.replaceArrow(d-i,d,"top"),m&&o.offset(n)},replaceArrow:function(n,a,o){this.arrow().css(o,n?50*(1-n/a)+"%":"")},setContent:function(){var n=this.tip(),a=this.getTitle();n.find(".tooltip-inner").text(a),n.removeClass("fade in top bottom left right")},hide:function(){var n=this,a=this.tip(),o=Q.Event("hide");if(this.$element.trigger(o),o.isDefaultPrevented())return;a.removeClass("in");function r(){var i=setTimeout(function(){a.off(Q.support.transition.end).detach()},500);a.one(Q.support.transition.end,function(){clearTimeout(i),a.detach()})}return Q.support.transition&&this.$tip.hasClass("fade")?r():a.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var n=this.$element;(n.attr("title")||typeof n.attr("data-original-title")!="string")&&n.attr("data-original-title",n.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var n=this.$element[0];return Q.extend({},typeof n.getBoundingClientRect=="function"?n.getBoundingClientRect():{width:n.offsetWidth,height:n.offsetHeight},this.$element.offset())},getTitle:function(){var n,a=this.$element,o=this.options;return n=a.attr("data-original-title")||(typeof o.title=="function"?o.title.call(a[0]):o.title),n},tip:function(){return this.$tip=this.$tip||Q(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(n){var a=n?Q(n.currentTarget)[this.type](this._options).data(this.type):this;a.tip().hasClass("in")?a.hide():a.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var e=Q.fn.tooltip;Q.fn.tooltip=function(n){return this.each(function(){var a=Q(this),o=a.data("tooltip"),r=typeof n=="object"&&n;o||a.data("tooltip",o=new I(this,r)),typeof n=="string"&&o[n]()})},Q.fn.tooltip.Constructor=I,Q.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},Q.fn.tooltip.noConflict=function(){return Q.fn.tooltip=e,this}}(window.jQuery),function(Q){"use strict";var I=function(n){this.element=Q(n)};I.prototype={constructor:I,show:function(){var n=this.element,a=n.closest("ul:not(.dropdown-menu)"),o=n.attr("data-target"),r,i,f;o||(o=n.attr("href"),o=o&&o.replace(/.*(?=#[^\s]*$)/,"")),!n.parent("li").hasClass("active")&&(r=a.find(".active:last a")[0],f=Q.Event("show",{relatedTarget:r}),n.trigger(f),!f.isDefaultPrevented()&&(i=Q.find(o),this.activate(n.parent("li"),a),this.activate(i,i.parent(),function(){n.trigger({type:"shown",relatedTarget:r})})))},activate:function(n,a,o){var r=a.find("> .active"),i=o&&Q.support.transition&&r.hasClass("fade");function f(){r.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),n.addClass("active"),i?(n[0].offsetWidth,n.addClass("in")):n.removeClass("fade"),n.parent(".dropdown-menu")&&n.closest("li.dropdown").addClass("active"),o&&o()}i?r.one(Q.support.transition.end,f):f(),r.removeClass("in")}};var e=Q.fn.tab;Q.fn.tab=function(n){return this.each(function(){var a=Q(this),o=a.data("tab");o||a.data("tab",o=new I(this)),typeof n=="string"&&o[n]()})},Q.fn.tab.Constructor=I,Q.fn.tab.noConflict=function(){return Q.fn.tab=e,this},Q(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(n){n.preventDefault(),Q(this).tab("show")})}(window.jQuery),function(Q){"use strict";var I=function(n,a){this.$element=Q(n),this.options=Q.extend({},Q.fn.typeahead.defaults,a),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=Q(this.options.menu),this.shown=!1,this.listen()};I.prototype={constructor:I,select:function(){var n=this.$menu.find(".active").attr("data-value")||this.$element.val();return this.$element.val(this.updater(n)).change(),this.hide()},updater:function(n){return n},show:function(){var n=Q.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:n.top+n.height,left:n.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(n){var a;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(a=Q.isFunction(this.source)?this.source(this.query,Q.proxy(this.process,this)):this.source,a?this.process(a):this)},process:function(n){var a=this;return n=Q.grep(n,function(o){return a.matcher(o)}),n=this.sorter(n),n.length?this.render(n.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(n){return~n.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(n){for(var a=[],o=[],r=[],i;i=n.shift();)i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?o.push(i):r.push(i):a.push(i);return a.concat(o,r)},highlighter:function(n){var a=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return a?n.replace(new RegExp("("+a+")","ig"),function(o,r){return"<strong>"+r+"</strong>"}):n},render:function(n){var a=this;return n=Q(n).map(function(o,r){return o=Q(a.options.item).attr("data-value",r),o.find("a").html(a.highlighter(r)),o[0]}),this.$menu.html(n),this},next:function(n){var a=this.$menu.find(".active").removeClass("active"),o=a.next();o.length||(o=Q(this.$menu.find("li")[0])),o.addClass("active")},prev:function(n){var a=this.$menu.find(".active").removeClass("active"),o=a.prev();o.length||(o=this.$menu.find("li").last()),o.addClass("active")},listen:function(){this.$element.on("focus",Q.proxy(this.focus,this)).on("blur",Q.proxy(this.blur,this)).on("keypress",Q.proxy(this.keypress,this)).on("keyup",Q.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",Q.proxy(this.keydown,this)),this.$menu.on("click",Q.proxy(this.click,this)).on("mouseenter","li",Q.proxy(this.mouseenter,this)).on("mouseleave","li",Q.proxy(this.mouseleave,this))},destroy:function(){this.$element.off().removeData("typeahead"),this.$menu.off()},eventSupported:function(n){var a=n in this.$element;return a||(this.$element.setAttribute(n,"return;"),a=typeof this.$element[n]=="function"),a},move:function(n){if(this.shown&&!(n.shiftKey&&n.keyCode===40)){switch(n.keyCode){case 9:case 13:case 27:n.preventDefault();break;case 38:n.preventDefault(),this.prev();break;case 40:n.preventDefault(),this.next();break}n.stopPropagation()}},keydown:function(n){this.suppressKeyPressRepeat=~Q.inArray(n.keyCode,[40,38,9,13,27,57]),this.move(n)},keypress:function(n){this.suppressKeyPressRepeat||this.move(n)},keyup:function(n){switch(n.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}n.keyCode===13&&typeof this.$menu.find(".active").attr("data-value")>"u"?this.$element.submit():(n.stopPropagation(),n.preventDefault())},focus:function(n){this.focused=!0},blur:function(n){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(n){n.stopPropagation(),n.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(n){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),Q(n.currentTarget).addClass("active")},mouseleave:function(n){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var e=Q.fn.typeahead;Q.fn.typeahead=function(n){return this.each(function(){var a=Q(this),o=a.data("typeahead"),r=typeof n=="object"&&n;o||a.data("typeahead",o=new I(this,r)),typeof n=="string"&&o[n]()})},Q.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},Q.fn.typeahead.Constructor=I,Q.fn.typeahead.noConflict=function(){return Q.fn.typeahead=e,this},Q(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(n){var a=Q(this);a.data("typeahead")||a.typeahead(a.data())})}(window.jQuery),function(Q){"use strict";var I=function(n,a){this.options=Q.extend({},Q.fn.affix.defaults,a),this.$window=Q(window).on("scroll.affix.data-api",Q.proxy(this.checkPosition,this)).on("click.affix.data-api",Q.proxy(function(){setTimeout(Q.proxy(this.checkPosition,this),1)},this)),this.$element=Q(n),this.checkPosition()};I.prototype.checkPosition=function(){if(this.$element.is(":visible")){var n=Q(document).height(),a=this.$window.scrollTop(),o=this.$element.offset(),r=this.options.offset,i=r.bottom,f=r.top,d="affix affix-top affix-bottom",l;typeof r!="object"&&(i=f=r),typeof f=="function"&&(f=r.top()),typeof i=="function"&&(i=r.bottom()),l=this.unpin!=null&&a+this.unpin<=o.top?!1:i!=null&&o.top+this.$element.height()>=n-i?"bottom":f!=null&&a<=f?"top":!1,this.affixed!==l&&(this.affixed=l,this.unpin=l=="bottom"?o.top-a:null,this.$element.removeClass(d).addClass("affix"+(l?"-"+l:"")))}};var e=Q.fn.affix;Q.fn.affix=function(n){return this.each(function(){var a=Q(this),o=a.data("affix"),r=typeof n=="object"&&n;o||a.data("affix",o=new I(this,r)),typeof n=="string"&&o[n]()})},Q.fn.affix.Constructor=I,Q.fn.affix.defaults={offset:0},Q.fn.affix.noConflict=function(){return Q.fn.affix=e,this},Q(window).on("load",function(){Q('[data-spy="affix"]').each(function(){var n=Q(this),a=n.data();a.offset=a.offset||{},a.offsetBottom&&(a.offset.bottom=a.offsetBottom),a.offsetTop&&(a.offset.top=a.offsetTop),n.affix(a)})})}(window.jQuery)},82013:()=>{(function(Q){var I={crosshair:{mode:null,color:"rgba(170, 0, 0, 0.80)",lineWidth:1}};function e(n){var a={x:-1,y:-1,locked:!1};n.setCrosshair=function(f){if(!f)a.x=-1;else{var d=n.p2c(f);a.x=Math.max(0,Math.min(d.left,n.width())),a.y=Math.max(0,Math.min(d.top,n.height()))}n.triggerRedrawOverlay()},n.clearCrosshair=n.setCrosshair,n.lockCrosshair=function(f){f&&n.setCrosshair(f),a.locked=!0},n.unlockCrosshair=function(){a.locked=!1};function o(i){a.locked||a.x!=-1&&(a.x=-1,n.triggerRedrawOverlay())}function r(i){if(!a.locked){if(n.getSelection&&n.getSelection()){a.x=-1;return}var f=n.offset();a.x=Math.max(0,Math.min(i.pageX-f.left,n.width())),a.y=Math.max(0,Math.min(i.pageY-f.top,n.height())),n.triggerRedrawOverlay()}}n.hooks.bindEvents.push(function(i,f){i.getOptions().crosshair.mode&&(f.mouseout(o),f.mousemove(r))}),n.hooks.drawOverlay.push(function(i,f){var d=i.getOptions().crosshair;if(d.mode){var l=i.getPlotOffset();if(f.save(),f.translate(l.left,l.top),a.x!=-1){var m=i.getOptions().crosshair.lineWidth%2?.5:0;if(f.strokeStyle=d.color,f.lineWidth=d.lineWidth,f.lineJoin="round",f.beginPath(),d.mode.indexOf("x")!=-1){var s=Math.floor(a.x)+m;f.moveTo(s,0),f.lineTo(s,i.height())}if(d.mode.indexOf("y")!=-1){var h=Math.floor(a.y)+m;f.moveTo(0,h),f.lineTo(i.width(),h)}f.stroke()}f.restore()}}),n.hooks.shutdown.push(function(i,f){f.unbind("mouseout",o),f.unbind("mousemove",r)})}Q.plot.plugins.push({init:e,options:I,name:"crosshair",version:"1.0"})})(jQuery)},2341:()=>{(function(Q){function I(e){e.hooks.processDatapoints.push(function(n,a,o){a.dashes.show&&n.hooks.draw.push(function(r,i){var f=r.getPlotOffset(),d=a.xaxis,l=a.yaxis;function m(b,g){var P=o.points,c=o.pointsize,y=null,p=null,v=0,D=!0,E,S;a.dashes.dashLength[0]?(E=a.dashes.dashLength[0],a.dashes.dashLength[1]?S=a.dashes.dashLength[1]:S=E):S=E=a.dashes.dashLength,i.beginPath();for(var T=c;T<P.length;T+=c){let B=function(w){var U=Math.sqrt(Math.pow(L-O,2)+Math.pow(N-R,2));if(U<=w)return{deltaX:L-O,deltaY:N-R,distance:U,remainder:w-U};var W=L>O?1:-1,V=N>R?1:-1;return{deltaX:W*Math.sqrt(Math.pow(w,2)/(1+Math.pow((N-R)/(L-O),2))),deltaY:V*Math.sqrt(Math.pow(w,2)-Math.pow(w,2)/(1+Math.pow((N-R)/(L-O),2))),distance:w,remainder:0}};var K=B,M=P[T-c],A=P[T-c+1],x=P[T],C=P[T+1];if(!(M==null||x==null)){if(A<=C&&A<l.min){if(C<l.min)continue;M=(l.min-A)/(C-A)*(x-M)+M,A=l.min}else if(C<=A&&C<l.min){if(A<l.min)continue;x=(l.min-A)/(C-A)*(x-M)+M,C=l.min}if(A>=C&&A>l.max){if(C>l.max)continue;M=(l.max-A)/(C-A)*(x-M)+M,A=l.max}else if(C>=A&&C>l.max){if(A>l.max)continue;x=(l.max-A)/(C-A)*(x-M)+M,C=l.max}if(M<=x&&M<d.min){if(x<d.min)continue;A=(d.min-M)/(x-M)*(C-A)+A,M=d.min}else if(x<=M&&x<d.min){if(M<d.min)continue;C=(d.min-M)/(x-M)*(C-A)+A,x=d.min}if(M>=x&&M>d.max){if(x>d.max)continue;A=(d.max-M)/(x-M)*(C-A)+A,M=d.max}else if(x>=M&&x>d.max){if(M>d.max)continue;C=(d.max-M)/(x-M)*(C-A)+A,x=d.max}(M!=y||A!=p)&&i.moveTo(d.p2c(M)+b,l.p2c(A)+g);var O=d.p2c(M)+b,R=l.p2c(A)+g,L=d.p2c(x)+b,N=l.p2c(C)+g,F;do F=B(v>0?v:D?E:S),(F.deltaX!=0||F.deltaY!=0)&&(D?i.lineTo(O+F.deltaX,R+F.deltaY):i.moveTo(O+F.deltaX,R+F.deltaY)),D=!D,v=F.remainder,O+=F.deltaX,R+=F.deltaY;while(F.distance>0);y=x,p=C}}i.stroke()}i.save(),i.translate(f.left,f.top),i.lineJoin="round";var s=a.dashes.lineWidth,h=a.shadowSize;if(s>0&&h>0){i.lineWidth=h,i.strokeStyle="rgba(0,0,0,0.1)";var u=Math.PI/18;m(Math.sin(u)*(s/2+h/2),Math.cos(u)*(s/2+h/2)),i.lineWidth=h/2,m(Math.sin(u)*(s/2+h/4),Math.cos(u)*(s/2+h/4))}i.lineWidth=s,i.strokeStyle=a.color,s>0&&m(0,0),i.restore()})})}Q.plot.plugins.push({init:I,options:{series:{dashes:{show:!1,lineWidth:2,dashLength:10}}},name:"dashes",version:"0.1"})})(jQuery)},92275:()=>{(function(Q){"use strict";var I={series:{fillBelowTo:null}};function e(n){function a(i,f){var d;for(d=0;d<f.length;++d)if(f[d].id===i.fillBelowTo)return f[d];return null}function o(i,f,d,l,m,s,h,u){var b,g,P,c,y,p;return b=d-i,g=l-f,P=h-m,c=u-s,y=(-g*(i-m)+b*(f-s))/(-P*g+b*c),p=(P*(f-s)-c*(i-m))/(-P*g+b*c),y>=0&&y<=1&&p>=0&&p<=1?[i+p*b,f+p*g]:null}function r(i,f,d){if(d.fillBelowTo===null)return;var l,m,s,h,u,b,g;function P(S,T){f.beginPath(),f.moveTo(d.xaxis.p2c(S)+b.left,d.yaxis.p2c(T)+b.top)}function c(){f.closePath(),f.fill()}function y(){if(s.length/m!==u.length/h)return console.error("Refusing to graph inconsistent number of points"),!1;var S;for(S=0;S<s.length/m;S++)if(s[S*m]!==null&&u[S*h]!==null&&s[S*m]!==u[S*h])return console.error("Refusing to graph points without matching value"),!1;return!0}function p(S,T){console.assert(T>S,"expects the end index to be greater than the start index");var M=S===0||s[S-1]===null||u[S-1]===null,A=!1,x,C;for(x=S;x<T;x++)if(s[x*m+1]===null||u[x*m+1]===null)A=!1,M=!0;else if(s[x*m+1]===u[x*h+1])A=!0,M=!1;else if(s[x*m+1]>u[x*h+1]){M?P(s[x*m],s[x*m+1]):A?P(s[(x-1)*m],s[(x-1)*m+1]):(C=v(x),P(C[0],C[1])),E(x,T);return}else M=!1,A=!1}function v(S){console.assert(S>0,"expects the second point in the series line segment");var T,M;for(T=1;T<u.length/h;T++)if(M=o(s[(S-1)*m],s[(S-1)*m+1],s[S*m],s[S*m+1],u[(T-1)*h],u[(T-1)*h+1],u[T*h],u[T*h+1]),M!==null)return M;console.error("intersectionPoint() should only be called when an intersection happens")}function D(S,T){console.assert(S>=T,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var M;for(M=S;M>=T;M--)f.lineTo(l.xaxis.p2c(u[M*h])+b.left,l.yaxis.p2c(u[M*h+1])+b.top);c()}function E(S,T){console.assert(S<=T,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var M,A;for(M=S;M<T;M++)if(s[M*m+1]===null&&M>S){D(M-1,S),p(M,T);return}else if(s[M*m+1]===u[M*h+1]){D(M,S),p(M,T);return}else if(s[M*m+1]<u[M*h+1]){A=v(M),f.lineTo(d.xaxis.p2c(A[0])+b.left,d.yaxis.p2c(A[1])+b.top),D(M,S),p(M,T);return}else f.lineTo(d.xaxis.p2c(s[M*m])+b.left,d.yaxis.p2c(s[M*m+1])+b.top);D(T,S)}l=a(d,i.getData()),l&&(m=d.datapoints.pointsize,s=d.datapoints.points,h=l.datapoints.pointsize,u=l.datapoints.points,b=i.getPlotOffset(),y()&&(g=Q.color.parse(d.color),g.a=.4,g.normalize(),f.fillStyle=g.toString(),p(0,s.length/m)))}n.hooks.drawSeries.push(r)}Q.plot.plugins.push({init:e,options:I,name:"fillbelow",version:"0.1.0"})})(jQuery)},19538:()=>{/*!
 * jquery.flot.gauge v1.1.0 *
 *
 * Flot plugin for rendering gauge charts.
 *
 * Copyright (c) 2015 @toyoty99.
 * Licensed under the MIT license.
 */(function(Q){var I=function(){var d,l,m,s,h,u,b=function(S,T){d=T,l=S.getPlaceholder(),m=S.getOptions(),s=m.series.gauges,h=S.getData(),u=e(s.debug)};b.prototype.calculateLayout=function(){var S=l.width(),T=l.height(),M=Math.min(h.length,s.layout.columns),A=Math.ceil(h.length/M),x=s.layout.margin,C=s.layout.hMargin,O=s.layout.vMargin,R=(S-x*2-C*(M-1))/M,L=(T-x*2-O*(A-1))/A;if(s.layout.square){var N=Math.min(R,L);R=N,L=N}g(s,R);var F=s.cell.margin,K=0,B=0;s.label.show&&(K=s.label.margin,B=s.label.font.size);var w=0,U=0;s.value.show&&(w=s.value.margin,U=s.value.font.size);var W=0;s.threshold.show&&(W=s.threshold.width);var V=0,_=0;s.threshold.label.show&&(V=s.threshold.label.margin,_=s.threshold.label.font.size);for(var H=R/2-F-W-V*2-_,G=s.gauge.startAngle,j=s.gauge.endAngle,Y=(j-G)/100,oe=-1,se=G;se<j;se+=Y)oe=Math.max(oe,Math.sin(o(se)));oe=Math.max(oe,Math.sin(o(j)));var ne=(L-F*2-K*2-B)/(1+oe);ne*oe<w+U/2&&(ne=L-F*2-K*2-B-w-U/2);var ee=ne-V*2-_-W,Z=Math.min(H,ee),z=s.gauge.width;z>=Z&&(z=Math.max(3,Z/3));var q=V*2+_+W+Z,ie=Math.max(q*(1+oe),q+w+U/2);return{canvasWidth:S,canvasHeight:T,margin:x,hMargin:C,vMargin:O,columns:M,rows:A,cellWidth:R,cellHeight:L,cellMargin:F,labelMargin:K,labelFontSize:B,valueMargin:w,valueFontSize:U,width:z,radius:Z,thresholdWidth:W,thresholdLabelMargin:V,thresholdLabelFontSize:_,gaugeOuterHeight:ie}};function g(S,T){S.gauge.width==="auto"&&(S.gauge.width=Math.max(5,T/8)),S.label.margin==="auto"&&(S.label.margin=Math.max(1,T/20)),S.label.font.size==="auto"&&(S.label.font.size=Math.max(5,T/8)),S.value.margin==="auto"&&(S.value.margin=Math.max(1,T/30)),S.value.font.size==="auto"&&(S.value.font.size=Math.max(5,T/9)),S.threshold.width==="auto"&&(S.threshold.width=Math.max(3,T/100)),S.threshold.label.margin==="auto"&&(S.threshold.label.margin=Math.max(3,T/40)),S.threshold.label.font.size==="auto"&&(S.threshold.label.font.size=Math.max(5,T/15))}b.prototype.calculateAutoValues=g,b.prototype.calculateCellLayout=function(S,T,M){var A=n(T.columns,M),x=a(T.columns,M),C=T.margin+(T.cellWidth+T.hMargin)*A,O=T.margin+(T.cellHeight+T.vMargin)*x,R=C+T.cellWidth/2,L=O+T.cellMargin+T.labelMargin*2+T.labelFontSize+T.thresholdWidth+T.thresholdLabelFontSize+T.thresholdLabelMargin*2+T.radius,N=T.cellHeight-T.cellMargin*2-T.labelMargin*2-T.labelFontSize-T.gaugeOuterHeight,F=0;return S.cell.vAlign==="middle"?F=N/2:S.cell.vAlign==="bottom"&&(F=N),L+=F,{col:A,row:x,x:C,y:O,offsetY:F,cellWidth:T.cellWidth,cellHeight:T.cellHeight,cellMargin:T.cellMargin,cx:R,cy:L}},b.prototype.drawBackground=function(S){s.frame.show&&(d.save(),d.strokeStyle=m.grid.borderColor,d.lineWidth=m.grid.borderWidth,d.strokeRect(0,0,S.canvasWidth,S.canvasHeight),m.grid.backgroundColor&&(d.fillStyle=m.grid.backgroundColor,d.fillRect(0,0,S.canvasWidth,S.canvasHeight)),d.restore())},b.prototype.drawCellBackground=function(S,T){d.save(),S.cell.border&&S.cell.border.show&&S.cell.border.color&&S.cell.border.width&&(d.strokeStyle=S.cell.border.color,d.lineWidth=S.cell.border.width,d.strokeRect(T.x,T.y,T.cellWidth,T.cellHeight)),S.cell.background&&S.cell.background.color&&(d.fillStyle=S.cell.background.color,d.fillRect(T.x,T.y,T.cellWidth,T.cellHeight)),d.restore()},b.prototype.drawGauge=function(S,T,M,A,x){var C=S.gauge.shadow.show?S.gauge.shadow.blur:0,O=y(S,x),R=P(S,T,x);v(M.cx,M.cy,T.radius,T.width,o(S.gauge.startAngle),o(S.gauge.endAngle),S.gauge.border.color,S.gauge.border.width,S.gauge.background.color,C),v(M.cx,M.cy,T.radius-1,T.width-2,o(R.a1),o(R.a2),O,1,O,C),S.gauge.neutralValue!=null&&c(S,T,M,O)};function P(S,T,M){let A={};var x=S.gauge.neutralValue;return x!=null?M<x?(A.a1=p(S,T,M),A.a2=p(S,T,x)):(A.a1=p(S,T,x),A.a2=p(S,T,M)):(A.a1=S.gauge.startAngle,A.a2=p(S,T,M)),A}function c(S,T,M,A){var x=(S.gauge.max-S.gauge.min)/600;r(d,M.cx,M.cy,T.radius-2,T.width-4,o(p(S,T,S.gauge.neutralValue-x)),o(p(S,T,S.gauge.neutralValue+x)),A,2,S.gauge.background.color)}function y(S,T){for(var M,A=0;A<S.threshold.values.length;A++){var x=S.threshold.values[A];if(M=x.color,T<x.value)break}return M}function p(S,T,M){var A=S.gauge.startAngle+(S.gauge.endAngle-S.gauge.startAngle)*((M-S.gauge.min)/(S.gauge.max-S.gauge.min));return A<S.gauge.startAngle?A=S.gauge.startAngle:A>S.gauge.endAngle&&(A=S.gauge.endAngle),A}b.prototype.drawThreshold=function(S,T,M){for(var A=S.gauge.startAngle,x=0;x<S.threshold.values.length;x++){var C=S.threshold.values[x];c1=C.color,a2=p(S,T,C.value),r(d,M.cx,M.cy,T.radius+T.thresholdWidth,T.thresholdWidth-2,o(A),o(a2),c1,1,c1),A=a2}};function v(S,T,M,A,x,C,O,R,L,N){x!==C&&(d.save(),r(d,S,T,M,A,x,C,O,R,L),N&&(r(d,S,T,M,A,x,C),d.clip(),d.shadowOffsetX=0,d.shadowOffsetY=0,d.shadowBlur=10,d.shadowColor="gray",r(d,S,T,M+1,A+2,x,C,O,1)),d.restore())}b.prototype.drawLable=function(S,T,M,A,x){E(M.cx,M.y+M.cellMargin+T.labelMargin+M.offsetY,"flotGaugeLabel"+A,S.label.formatter?S.label.formatter(x.label,x.data[0][1]):text,S.label)},b.prototype.drawValue=function(S,T,M,A,x){E(M.cx,M.cy-S.value.font.size/2,"flotGaugeValue"+A,S.value.formatter?S.value.formatter(x.label,x.data[0][1]):text,S.value)},b.prototype.drawThresholdValues=function(S,T,M,A){D(S,T,M,"Min"+A,S.gauge.min,S.gauge.startAngle),D(S,T,M,"Max"+A,S.gauge.max,S.gauge.endAngle);for(var x=0;x<S.threshold.values.length;x++){var C=S.threshold.values[x];if(C.value>S.gauge.min&&C.value<S.gauge.max){var O=p(S,T,C.value);D(S,T,M,A+"_"+x,C.value,O)}}var R=S.gauge.neutralValue;R!=null&&R>S.gauge.min&&R<S.gauge.max&&D(S,T,M,"Neutral"+A,R,p(S,T,R))};function D(S,T,M,A,x,C){E(M.cx+(T.thresholdLabelMargin+T.thresholdLabelFontSize/2+T.radius)*Math.cos(o(C)),M.cy+(T.thresholdLabelMargin+T.thresholdLabelFontSize/2+T.radius)*Math.sin(o(C)),"flotGaugeThresholdValue"+A,S.threshold.label.formatter?S.threshold.label.formatter(x):x,S.threshold.label,C)}function E(S,T,M,A,x,C){var O=Q(l).find("#"+M),R=O.length;R||(O=Q("<span></span>"),O.attr("id",M),O.attr("class","flot-temp-elem"),l.append(O)),O.css("position","absolute"),O.css("top",T+"px"),O.css("white-space","nowrap"),x.font.size&&O.css("font-size",x.font.size+"px"),x.font.family&&O.css("font-family",x.font.family),x.color&&O.css("color",x.color),x.background.color&&O.css("background-color",x.background.color),x.background.opacity&&O.css("opacity",x.background.opacity),O.text(A),O.css("left",S+"px"),O.css("left",parseInt(O.css("left"))-O.width()/2+"px"),!R&&C&&(O.css("top",parseInt(O.css("top"))-O.height()/2+"px"),O.css("transform","rotate("+(180*C+90)+"deg)"))}return b}();function e(d){return typeof Logger<"u"?new Logger(d):null}function n(d,l){return l%d}function a(d,l){return Math.floor(l/d)}function o(d){return d*Math.PI}function r(d,l,m,s,h,u,b,g,P,c){if(u!==b){var y=!1;d.save(),d.beginPath(),d.arc(l,m,s,u,b,y),d.lineTo(l+(s-h)*Math.cos(b),m+(s-h)*Math.sin(b)),d.arc(l,m,s-h,b,u,!y),d.closePath(),P&&(d.lineWidth=P),g&&(d.strokeStyle=g,d.stroke()),c&&(d.fillStyle=c,d.fill()),d.restore()}}function i(d){d.hooks.processOptions.push(function(l,m){var s=e(m.series.gauges.debug);m.series.gauges.show&&(m.grid.show=!1,m.legend.show=!1);var h=m.series.gauges.threshold.values;h.sort(function(u,b){return u.value<b.value?-1:u.value>b.value?1:0})}),d.hooks.draw.push(function(l,m){var s=l.getOptions(),h=s.series.gauges,u=e(h.debug);if(h.show){var b=l.getData();if(!(!b||!b.length)){var g=new I(l,m),P=g.calculateLayout();h.debug.layout,g.drawBackground(P);for(var c=0;c<b.length;c++){var y=b[c],p=Q.extend({},h,y.gauges);y.gauges&&g.calculateAutoValues(p,P.cellWidth);var v=g.calculateCellLayout(p,P,c);g.drawCellBackground(p,v),p.debug.layout,p.label.show&&g.drawLable(p,P,v,c,y),g.drawGauge(p,P,v,y.label,y.data[0][1]),p.threshold.show&&g.drawThreshold(p,P,v),p.threshold.label.show&&g.drawThresholdValues(p,P,v,c),p.value.show&&g.drawValue(p,P,v,c,y)}}}})}var f={series:{gauges:{debug:{log:!1,layout:!1,alert:!1},show:!1,layout:{margin:5,columns:3,hMargin:5,vMargin:5,square:!1},frame:{show:!0},cell:{background:{color:null},border:{show:!0,color:"black",width:1},margin:5,vAlign:"middle"},gauge:{width:"auto",startAngle:.9,endAngle:2.1,min:0,max:100,background:{color:"white"},border:{color:"lightgray",width:2},shadow:{show:!0,blur:5}},label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(d,l){return d}},value:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(d,l){return parseInt(l)}},threshold:{show:!0,width:"auto",label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:",sans-serif"},color:null,formatter:function(d){return d}},values:[]}}}};Q.plot.plugins.push({init:i,options:f,name:"gauge",version:"1.1.0"})})(jQuery)},54087:()=>{(function(Q){Q.color={},Q.color.make=function(e,n,a,o){var r={};return r.r=e||0,r.g=n||0,r.b=a||0,r.a=o??1,r.add=function(i,f){for(var d=0;d<i.length;++d)r[i.charAt(d)]+=f;return r.normalize()},r.scale=function(i,f){for(var d=0;d<i.length;++d)r[i.charAt(d)]*=f;return r.normalize()},r.toString=function(){return r.a>=1?"rgb("+[r.r,r.g,r.b].join(",")+")":"rgba("+[r.r,r.g,r.b,r.a].join(",")+")"},r.normalize=function(){function i(f,d,l){return d<f?f:d>l?l:d}return r.r=i(0,parseInt(r.r),255),r.g=i(0,parseInt(r.g),255),r.b=i(0,parseInt(r.b),255),r.a=i(0,r.a,1),r},r.clone=function(){return Q.color.make(r.r,r.b,r.g,r.a)},r.normalize()},Q.color.extract=function(e,n){var a;do{if(a=e.css(n).toLowerCase(),a!=""&&a!="transparent")break;e=e.parent()}while(e.length&&!Q.nodeName(e.get(0),"body"));return a=="rgba(0, 0, 0, 0)"&&(a="transparent"),Q.color.parse(a)},Q.color.parse=function(e){var n,a=Q.color.make;if(n=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))return a(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10));if(n=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return a(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),parseFloat(n[4]));if(n=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e))return a(parseFloat(n[1])*2.55,parseFloat(n[2])*2.55,parseFloat(n[3])*2.55);if(n=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return a(parseFloat(n[1])*2.55,parseFloat(n[2])*2.55,parseFloat(n[3])*2.55,parseFloat(n[4]));if(n=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e))return a(parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16));if(n=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e))return a(parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16));var o=Q.trim(e).toLowerCase();return o=="transparent"?a(255,255,255,0):(n=I[o]||[0,0,0],a(n[0],n[1],n[2]))};var I={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery),function(Q){var I=Object.prototype.hasOwnProperty;Q.fn.detach||(Q.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})});function e(o,r){var i=r.children("."+o)[0];if(i==null&&(i=document.createElement("canvas"),i.className=o,Q(i).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(r),!i.getContext))if(window.G_vmlCanvasManager)i=window.G_vmlCanvasManager.initElement(i);else throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=i;var f=this.context=i.getContext("2d"),d=window.devicePixelRatio||1,l=f.webkitBackingStorePixelRatio||f.mozBackingStorePixelRatio||f.msBackingStorePixelRatio||f.oBackingStorePixelRatio||f.backingStorePixelRatio||1;this.pixelRatio=d/l,this.resize(r.width(),r.height()),this.textContainer=null,this.text={},this._textCache={},this._textSizeCache=window.flotTextSizeCache=window.flotTextSizeCache||{}}e.prototype.resize=function(o,r){if(o<=0||r<=0)throw new Error("Invalid dimensions for plot, width = "+o+", height = "+r);var i=this.element,f=this.context,d=this.pixelRatio;this.width!=o&&(i.width=o*d,i.style.width=o+"px",this.width=o),this.height!=r&&(i.height=r*d,i.style.height=r+"px",this.height=r),f.restore(),f.save(),f.scale(d,d)},e.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.prototype.render=function(){var o=this._textCache;for(var r in o)if(I.call(o,r)){var i=this.getTextLayer(r),f=o[r];i.hide();for(var d in f)if(I.call(f,d)){var l=f[d];for(var m in l)if(I.call(l,m)){for(var s=l[m].positions,h=0,u;u=s[h];h++)u.active?u.rendered||(i.append(u.element),u.rendered=!0):(s.splice(h--,1),u.rendered&&u.element.detach());s.length==0&&delete l[m]}}i.show()}},e.prototype.getTextLayer=function(o){var r=this.text[o];return r==null&&(this.textContainer==null&&(this.textContainer=Q("<div class='flot-text flot-temp-elem'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),r=this.text[o]=Q("<div></div>").addClass(o).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),r},e.prototype.getTextInfo=function(o,r,i,f,d){var l,m,s,h;if(r=""+r,typeof i=="object"?l=i.style+" "+i.variant+" "+i.weight+" "+i.size+"px/"+i.lineHeight+"px "+i.family:l=i,m=this._textCache[o],m==null&&(m=this._textCache[o]={}),s=m[l],s==null&&(s=m[l]={}),h=s[r],h==null){var u=Q("<div></div>").html(r).css({position:"absolute","max-width":d,top:-9999}).appendTo(this.getTextLayer(o));typeof i=="object"?u.css({font:l,color:i.color}):typeof i=="string"&&u.addClass(i),h=s[r]={element:u,positions:[]};var b=this._textSizeCache[r];b?(h.width=b.width,h.height=b.height):(h.width=u.outerWidth(!0),h.height=u.outerHeight(!0),this._textSizeCache[r]={width:h.width,height:h.height}),u.detach()}return h},e.prototype.addText=function(o,r,i,f,d,l,m,s,h){var u=this.getTextInfo(o,f,d,l,m),b=u.positions;s=="center"?r-=u.width/2:s=="right"&&(r-=u.width),h=="middle"?i-=u.height/2:h=="bottom"&&(i-=u.height);for(var g=0,P;P=b[g];g++)if(P.x==r&&P.y==i){P.active=!0;return}P={active:!0,rendered:!1,element:b.length?u.element.clone():u.element,x:r,y:i},b.push(P),P.element.css({top:Math.round(i),left:Math.round(r),"text-align":s})},e.prototype.removeText=function(o,r,i,f,d,l){if(f==null){var m=this._textCache[o];if(m!=null){for(var s in m)if(I.call(m,s)){var h=m[s];for(var u in h)if(I.call(h,u))for(var b=h[u].positions,g=0,P;P=b[g];g++)P.active=!1}}}else for(var b=this.getTextInfo(o,f,d,l).positions,g=0,P;P=b[g];g++)P.x==r&&P.y==i&&(P.active=!1)};function n(o,r,i,f){var d=[],l={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,eventSectionHeight:0,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:16.666666666666668},hooks:{}},m=null,s=null,h=null,u=null,b=null,g=[],P=[],c={left:0,right:0,top:0,bottom:0},y=0,p=0,v={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],processRange:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},D=this;D.setData=M,D.setupGrid=G,D.draw=ee,D.getPlaceholder=function(){return o},D.getCanvas=function(){return m.element},D.getPlotOffset=function(){return c},D.width=function(){return y},D.height=function(){return p},D.offset=function(){var re=h.offset();return re.left+=c.left,re.top+=c.top,re},D.getData=function(){return d},D.getAxes=function(){var re={},X;return Q.each(g.concat(P),function(le,be){be&&(re[be.direction+(be.n!=1?be.n:"")+"axis"]=be)}),re},D.getXAxes=function(){return g},D.getYAxes=function(){return P},D.c2p=O,D.p2c=R,D.getOptions=function(){return l},D.highlight=Ze,D.unhighlight=ot,D.triggerRedrawOverlay=$e,D.pointOffset=function(re){return{left:parseInt(g[x(re,"x")-1].p2c(+re.x)+c.left,10),top:parseInt(P[x(re,"y")-1].p2c(+re.y)+c.top,10)}},D.shutdown=w,D.destroy=function(){w(),o.removeData("plot").empty(),d=[],l=null,m=null,s=null,h=null,u=null,b=null,g=[],P=[],v=null,ye=[],D=null},D.resize=function(){var re=o.width(),X=o.height();m.resize(re,X),s.resize(re,X)},D.hooks=v,S(D),T(i),K(),M(r),G(),ee(),B();function E(re,X){X=[D].concat(X);for(var le=0;le<re.length;++le)re[le].apply(this,X)}function S(){for(var re={Canvas:e},X=0;X<f.length;++X){var le=f[X];le.init(D,re),le.options&&Q.extend(!0,l,le.options)}}function T(re){Q.extend(!0,l,re),re&&re.colors&&(l.colors=re.colors),l.xaxis.color==null&&(l.xaxis.color=Q.color.parse(l.grid.color).scale("a",.22).toString()),l.yaxis.color==null&&(l.yaxis.color=Q.color.parse(l.grid.color).scale("a",.22).toString()),l.xaxis.tickColor==null&&(l.xaxis.tickColor=l.grid.tickColor||l.xaxis.color),l.yaxis.tickColor==null&&(l.yaxis.tickColor=l.grid.tickColor||l.yaxis.color),l.grid.borderColor==null&&(l.grid.borderColor=l.grid.color),l.grid.tickColor==null&&(l.grid.tickColor=Q.color.parse(l.grid.color).scale("a",.22).toString());var X,le,be,De=o.css("font-size"),Te=De?+De.replace("px",""):13,we={style:o.css("font-style"),size:Math.round(.8*Te),variant:o.css("font-variant"),weight:o.css("font-weight"),family:o.css("font-family")};for(be=l.xaxes.length||1,X=0;X<be;++X)le=l.xaxes[X],le&&!le.tickColor&&(le.tickColor=le.color),le=Q.extend(!0,{},l.xaxis,le),l.xaxes[X]=le,le.font&&(le.font=Q.extend({},we,le.font),le.font.color||(le.font.color=le.color),le.font.lineHeight||(le.font.lineHeight=Math.round(le.font.size*1.15)));for(be=l.yaxes.length||1,X=0;X<be;++X)le=l.yaxes[X],le&&!le.tickColor&&(le.tickColor=le.color),le=Q.extend(!0,{},l.yaxis,le),l.yaxes[X]=le,le.font&&(le.font=Q.extend({},we,le.font),le.font.color||(le.font.color=le.color),le.font.lineHeight||(le.font.lineHeight=Math.round(le.font.size*1.15)));for(l.xaxis.noTicks&&l.xaxis.ticks==null&&(l.xaxis.ticks=l.xaxis.noTicks),l.yaxis.noTicks&&l.yaxis.ticks==null&&(l.yaxis.ticks=l.yaxis.noTicks),l.x2axis&&(l.xaxes[1]=Q.extend(!0,{},l.xaxis,l.x2axis),l.xaxes[1].position="top",l.x2axis.min==null&&(l.xaxes[1].min=null),l.x2axis.max==null&&(l.xaxes[1].max=null)),l.y2axis&&(l.yaxes[1]=Q.extend(!0,{},l.yaxis,l.y2axis),l.yaxes[1].position="right",l.y2axis.min==null&&(l.yaxes[1].min=null),l.y2axis.max==null&&(l.yaxes[1].max=null)),l.grid.coloredAreas&&(l.grid.markings=l.grid.coloredAreas),l.grid.coloredAreasColor&&(l.grid.markingsColor=l.grid.coloredAreasColor),l.lines&&Q.extend(!0,l.series.lines,l.lines),l.points&&Q.extend(!0,l.series.points,l.points),l.bars&&Q.extend(!0,l.series.bars,l.bars),l.shadowSize!=null&&(l.series.shadowSize=l.shadowSize),l.highlightColor!=null&&(l.series.highlightColor=l.highlightColor),X=0;X<l.xaxes.length;++X)L(g,X+1).options=l.xaxes[X];for(X=0;X<l.yaxes.length;++X)L(P,X+1).options=l.yaxes[X];for(var Ke in v)l.hooks[Ke]&&l.hooks[Ke].length&&(v[Ke]=v[Ke].concat(l.hooks[Ke]));E(v.processOptions,[l])}function M(re){d=A(re),N(),F()}function A(re){for(var X=[],le=0;le<re.length;++le){var be=Q.extend(!0,{},l.series);re[le].data!=null?(be.data=re[le].data,delete re[le].data,Q.extend(!0,be,re[le]),re[le].data=be.data):be.data=re[le],X.push(be)}return X}function x(re,X){var le=re[X+"axis"];return typeof le=="object"&&(le=le.n),typeof le!="number"&&(le=1),le}function C(){return Q.grep(g.concat(P),function(re){return re})}function O(re){var X={},le,be;for(le=0;le<g.length;++le)be=g[le],be&&(X["x"+be.n]=be.c2p(re.left));for(le=0;le<P.length;++le)be=P[le],be&&(X["y"+be.n]=be.c2p(re.top));return X.x1!==void 0&&(X.x=X.x1),X.y1!==void 0&&(X.y=X.y1),X}function R(re){var X={},le,be,De;for(le=0;le<g.length;++le)if(be=g[le],be&&be.used&&(De="x"+be.n,re[De]==null&&be.n==1&&(De="x"),re[De]!=null)){X.left=be.p2c(re[De]);break}for(le=0;le<P.length;++le)if(be=P[le],be&&be.used&&(De="y"+be.n,re[De]==null&&be.n==1&&(De="y"),re[De]!=null)){X.top=be.p2c(re[De]);break}return X}function L(re,X){return re[X-1]||(re[X-1]={n:X,direction:re==g?"x":"y",options:Q.extend(!0,{},re==g?l.xaxis:l.yaxis)}),re[X-1]}function N(){var re=d.length,X=-1,le;for(le=0;le<d.length;++le){var be=d[le].color;be!=null&&(re--,typeof be=="number"&&be>X&&(X=be))}re<=X&&(re=X+1);var De,Te=[],we=l.colors,Ke=we.length,Ve=0;for(le=0;le<re;le++)De=Q.color.parse(we[le%Ke]||"#666"),le%Ke==0&&le&&(Ve>=0?Ve<.5?Ve=-Ve-.2:Ve=0:Ve=-Ve),Te[le]=De.scale("rgb",1+Ve);var ht=0,gt;for(le=0;le<d.length;++le){if(gt=d[le],gt.color==null?(gt.color=Te[ht].toString(),++ht):typeof gt.color=="number"&&(gt.color=Te[gt.color].toString()),gt.lines.show==null){var bt,St=!0;for(bt in gt)if(gt[bt]&&gt[bt].show){St=!1;break}St&&(gt.lines.show=!0)}gt.lines.zero==null&&(gt.lines.zero=!!gt.lines.fill),gt.xaxis=L(g,x(gt,"x")),gt.yaxis=L(P,x(gt,"y"))}}function F(){var re=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,le=Number.MAX_VALUE,be,De,Te,we,Ke,Ve,ht,gt,bt,St,Je,rt,Rt,_t,nn,Kt;function en(Tn,vn,Kn){vn<Tn.datamin&&vn!=-le&&(Tn.datamin=vn),Kn>Tn.datamax&&Kn!=le&&(Tn.datamax=Kn)}for(Q.each(C(),function(Tn,vn){vn.datamin=re,vn.datamax=X,vn.used=!1}),be=0;be<d.length;++be)Ve=d[be],Ve.datapoints={points:[]},E(v.processRawData,[Ve,Ve.data,Ve.datapoints]);for(be=0;be<d.length;++be){if(Ve=d[be],nn=Ve.data,Kt=Ve.datapoints.format,!Kt){if(Kt=[],Kt.push({x:!0,number:!0,required:!0}),Kt.push({y:!0,number:!0,required:!0}),Ve.stack||Ve.bars.show||Ve.lines.show&&Ve.lines.fill){var Qt=!!(Ve.bars.show&&Ve.bars.zero||Ve.lines.show&&Ve.lines.zero);Kt.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:Qt}),Ve.bars.horizontal&&(delete Kt[Kt.length-1].y,Kt[Kt.length-1].x=!0)}Ve.datapoints.format=Kt}if(Ve.datapoints.pointsize==null){Ve.datapoints.pointsize=Kt.length,gt=Ve.datapoints.pointsize,ht=Ve.datapoints.points;var An=Ve.lines.show&&Ve.lines.steps;for(Ve.xaxis.used=Ve.yaxis.used=!0,De=Te=0;De<nn.length;++De,Te+=gt){_t=nn[De];var un=_t==null;if(!un)for(we=0;we<gt;++we)rt=_t[we],Rt=Kt[we],Rt&&(Rt.number&&rt!=null&&(rt=+rt,isNaN(rt)?rt=null:rt==1/0?rt=le:rt==-1/0&&(rt=-le)),rt==null&&(Rt.required&&(un=!0),Rt.defaultValue!=null&&(rt=Rt.defaultValue))),ht[Te+we]=rt;if(un)for(we=0;we<gt;++we)rt=ht[Te+we],rt!=null&&(Rt=Kt[we],Rt.autoscale!==!1&&(Rt.x&&en(Ve.xaxis,rt,rt),Rt.y&&en(Ve.yaxis,rt,rt))),ht[Te+we]=null;if(An&&Te>0&&(!un||ht[Te-gt]!=null)){for(we=0;we<gt;++we)ht[Te+gt+we]=ht[Te+we];ht[Te+1]=ht[Te-gt+1]||0,un&&(ht[Te]=_t[0]),Te+=gt}}}}for(be=0;be<d.length;++be){if(Ve=d[be],ht=Ve.datapoints.points,gt=Ve.datapoints.pointsize,Ve.transform==="negative-Y")for(De=0;De<ht.length;De+=gt)ht[De]!=null&&(rt=ht[De+1],ht[De+1]=-rt);E(v.processDatapoints,[Ve,Ve.datapoints])}for(be=0;be<d.length;++be){Ve=d[be],ht=Ve.datapoints.points,gt=Ve.datapoints.pointsize,Kt=Ve.datapoints.format;var fn=re,Tt=re,$t=X,Yt=X;for(De=0;De<ht.length;De+=gt)if(ht[De]!=null)for(we=0;we<gt;++we)rt=ht[De+we],Rt=Kt[we],!(!Rt||Rt.autoscale===!1||rt==le||rt==-le)&&(Rt.x&&(rt<fn&&(fn=rt),rt>$t&&($t=rt)),Rt.y&&(rt<Tt&&(Tt=rt),rt>Yt&&(Yt=rt)));if(Ve.bars.show){var Cn;switch(Ve.bars.align){case"left":Cn=0;break;case"right":Cn=-Ve.bars.barWidth;break;default:Cn=-Ve.bars.barWidth/2}Ve.bars.horizontal?(Tt+=Cn,Yt+=Cn+Ve.bars.barWidth):(fn+=Cn,$t+=Cn+Ve.bars.barWidth)}en(Ve.xaxis,fn,$t),en(Ve.yaxis,Tt,Yt)}Q.each(C(),function(Tn,vn){vn.datamin==re&&(vn.datamin=null),vn.datamax==X&&(vn.datamax=null)})}function K(){o.find(".flot-temp-elem").remove(),o.css("position")=="static"&&o.css("position","relative"),m=new e("flot-base",o),s=new e("flot-overlay",o),u=m.context,b=s.context,h=Q(s.element).unbind();var re=o.data("plot");re&&(re.shutdown(),s.clear()),o.data("plot",D)}function B(){l.grid.hoverable&&(h.mousemove(Oe),h.bind("mouseleave",Ne),Q(document).bind("touchend",Ae)),l.grid.clickable&&h.click(We),E(v.bindEvents,[h])}function w(){Pe&&clearTimeout(Pe),h.unbind("mousemove",Oe),h.unbind("mouseleave",Ne),h.unbind("click",We),Q(document).unbind("touchend",Ae),E(v.shutdown,[h])}function U(re){function X(we){return we}var le,be,De=re.options.transform||X,Te=re.options.inverseTransform;re.direction=="x"?(le=re.scale=y/Math.abs(De(re.max)-De(re.min)),be=Math.min(De(re.max),De(re.min))):(le=re.scale=p/Math.abs(De(re.max)-De(re.min)),le=-le,be=Math.max(De(re.max),De(re.min))),De==X?re.p2c=function(we){return(we-be)*le}:re.p2c=function(we){return(De(we)-be)*le},Te?re.c2p=function(we){return Te(be+we/le)}:re.c2p=function(we){return be+we/le}}function W(re){for(var X=re.options,le=re.ticks||[],be=X.labelWidth||0,De=X.labelHeight||0,Te=be||(re.direction=="x"?Math.floor(m.width/(le.length||1)):null),we=re.direction+"Axis "+re.direction+re.n+"Axis",Ke="flot-"+re.direction+"-axis flot-"+re.direction+re.n+"-axis "+we,Ve=X.font||"flot-tick-label tickLabel",ht=0;ht<le.length;++ht){var gt=le[ht];if(gt.label){var bt=m.getTextInfo(Ke,gt.label,Ve,null,Te);be=Math.max(be,bt.width+1),De=Math.max(De,bt.height)}}re.labelWidth=X.labelWidth||be,re.labelHeight=X.labelHeight||De}function V(re){var X=re.labelWidth,le=re.labelHeight,be=re.options.position,De=re.direction==="x",Te=re.options.tickLength,we=l.grid.axisMargin,Ke=l.grid.labelMargin,Ve=l.grid.eventSectionHeight,ht=!0,gt=!0,bt=!0,St=!1;Q.each(De?g:P,function(Je,rt){rt&&(rt.show||rt.reserveSpace)&&(rt===re?St=!0:rt.options.position===be&&(St?gt=!1:ht=!1),St||(bt=!1))}),gt&&(we=0),Te==null&&(Te=bt?"full":5),isNaN(+Te)||(Ke+=+Te),De?(le+=Ke,le+=Ve,be=="bottom"?(c.bottom+=le+we,re.box={top:m.height-c.bottom,height:le}):(re.box={top:c.top+we,height:le},c.top+=le+we)):(X+=Ke,be=="left"?(re.box={left:c.left+we,width:X},c.left+=X+we):(c.right+=X+we,re.box={left:m.width-c.right,width:X})),re.position=be,re.tickLength=Te,re.box.padding=Ke,re.box.eventSectionPadding=Ve,re.innermost=ht}function _(re){re.direction=="x"?(re.box.left=c.left-re.labelWidth/2,re.box.width=m.width-c.left-c.right+re.labelWidth):(re.box.top=c.top-re.labelHeight/2,re.box.height=m.height-c.bottom-c.top+re.labelHeight)}function H(){var re=l.grid.minBorderMargin,X,le;if(re==null)for(re=0,le=0;le<d.length;++le)re=Math.max(re,2*(d[le].points.radius+d[le].points.lineWidth/2));var be={left:re,right:re,top:re,bottom:re};Q.each(C(),function(De,Te){Te.reserveSpace&&Te.ticks&&Te.ticks.length&&(Te.direction==="x"?(be.left=Math.max(be.left,Te.labelWidth/2),be.right=Math.max(be.right,Te.labelWidth/2)):(be.bottom=Math.max(be.bottom,Te.labelHeight/2),be.top=Math.max(be.top,Te.labelHeight/2)))}),c.left=Math.ceil(Math.max(be.left,c.left)),c.right=Math.ceil(Math.max(be.right,c.right)),c.top=Math.ceil(Math.max(be.top,c.top)),c.bottom=Math.ceil(Math.max(be.bottom,c.bottom))}function G(){var re,X=C(),le=l.grid.show;for(var be in c){var De=l.grid.margin||0;c[be]=typeof De=="number"?De:De[be]||0}E(v.processOffset,[c]);for(var be in c)typeof l.grid.borderWidth=="object"?c[be]+=le?l.grid.borderWidth[be]:0:c[be]+=le?l.grid.borderWidth:0;if(Q.each(X,function(Ke,Ve){var ht=Ve.options;Ve.show=ht.show==null?Ve.used:ht.show,Ve.reserveSpace=ht.reserveSpace==null?Ve.show:ht.reserveSpace,j(Ve)}),E(v.processRange,[]),le){for(var Te=Q.grep(X,function(Ke){return Ke.show||Ke.reserveSpace}),we=!1,re=0;re<2&&(Q.each(Te,function(Ve,ht){oe(ht),se(ht),we=ne(ht,ht.ticks)||we,W(ht)}),we&&v.processRange.length>0);re++)E(v.processRange,[]),we=!1;for(re=Te.length-1;re>=0;--re)V(Te[re]);H(),Q.each(Te,function(Ke,Ve){_(Ve)})}y=m.width-c.left-c.right,p=m.height-c.bottom-c.top,Q.each(X,function(Ke,Ve){U(Ve)}),le&&ie(),pe()}function j(re){var X=re.options,le=+(X.min!=null?X.min:re.datamin),be=+(X.max!=null?X.max:re.datamax),De=be-le;if(De==0){var Te=.25,we=Math.abs(be==0?1:be*Te);X.min==null&&(le-=we),(X.max==null||X.min!=null)&&(be+=we)}else{var Ke=X.autoscaleMargin;Ke!=null&&(X.min==null&&(le-=De*Ke,le<0&&re.datamin!=null&&re.datamin>=0&&(le=0)),X.max==null&&(be+=De*Ke,be>0&&re.datamax!=null&&re.datamax<=0&&(be=0)))}re.min=le,re.max=be}function Y(re){if(re=Math.abs(String(re).replace(".","")),re==0)return 0;for(;re!=0&&re%10==0;)re/=10;return Math.floor(Math.log(re)/Math.LN10)+1}function oe(re){var X=re.options,le;typeof X.ticks=="number"&&X.ticks>0?le=X.ticks:le=.3*Math.sqrt(re.direction=="x"?m.width:m.height);var be=(re.max-re.min)/le,De=-Math.floor(Math.log(be)/Math.LN10),Te=X.tickDecimals;Te!=null&&De>Te&&(De=Te);var we=Math.pow(10,-De),Ke=be/we,Ve;if(Ke<1.5?Ve=1:Ke<3?(Ve=2,Ke>2.25&&(Te==null||De+1<=Te)&&(Ve=2.5,++De)):Ke<7.5?Ve=5:Ve=10,Ve*=we,X.minTickSize!=null&&Ve<X.minTickSize&&(Ve=X.minTickSize),re.delta=be,re.tickDecimals=Math.max(0,Te??De),re.tickSize=X.tickSize||Ve,X.mode=="time"&&!re.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(re.tickGenerator||(re.tickGenerator=function(Je){var rt=[],Rt=a(Je.min,Je.tickSize),_t=0,nn=Number.NaN,Kt;do Kt=nn,nn=Rt+_t*Je.tickSize,rt.push(nn),++_t;while(nn<Je.max&&nn!=Kt);return rt},re.tickFormatter=function(Je,rt){var Rt=rt.tickDecimals?Math.pow(10,rt.tickDecimals):1,_t=""+Math.round(Je*Rt)/Rt;if(rt.tickDecimals!=null){var nn=_t.indexOf("."),Kt=nn==-1?0:_t.length-nn-1;if(Kt<rt.tickDecimals)return(Kt?_t:_t+".")+(""+Rt).substr(1,rt.tickDecimals-Kt)}return _t}),Q.isFunction(X.tickFormatter)&&(re.tickFormatter=function(Je,rt){return""+X.tickFormatter(Je,rt)}),X.alignTicksWithAxis!=null){var ht=(re.direction=="x"?g:P)[X.alignTicksWithAxis-1];if(ht&&ht.used&&ht!=re){var gt=re.tickGenerator(re);if(gt.length>0&&(X.min==null&&(re.min=Math.min(re.min,gt[0])),X.max==null&&gt.length>1&&(re.max=Math.max(re.max,gt[gt.length-1]))),re.tickGenerator=function(Je){var rt=[],Rt,_t;for(_t=0;_t<ht.ticks.length;++_t)Rt=(ht.ticks[_t].v-ht.min)/(ht.max-ht.min),Rt=Je.min+Rt*(Je.max-Je.min),rt.push(Rt);return rt},!re.mode&&X.tickDecimals==null){var bt=Math.max(0,-Math.floor(Math.log(re.delta)/Math.LN10)+1),St=re.tickGenerator(re);St.length>1&&/\..*0$/.test((St[1]-St[0]).toFixed(bt))||(re.tickDecimals=bt)}}}}function se(re){var X=re.options.ticks,le=[];X==null||typeof X=="number"&&X>0?le=re.tickGenerator(re):X&&(Q.isFunction(X)?le=X(re):le=X);var be,De;for(re.ticks=[],be=0;be<le.length;++be){var Te=null,we=le[be];typeof we=="object"?(De=+we[0],we.length>1&&(Te=we[1])):De=+we,Te==null&&(Te=re.tickFormatter(De,re)),isNaN(De)||re.ticks.push({v:De,label:Te})}}function ne(re,X){var le=!1;return re.options.autoscaleMargin&&X.length>0&&(re.options.min==null&&(re.min=Math.min(re.min,X[0].v),le=!0),re.options.max==null&&X.length>1&&(re.max=Math.max(re.max,X[X.length-1].v),le=!0)),le}function ee(){m.clear(),E(v.drawBackground,[u]);var re=l.grid;re.show&&re.backgroundColor&&z(),re.show&&!re.aboveData&&q();for(var X=0;X<d.length;++X)E(v.drawSeries,[u,d[X]]),ue(d[X]);E(v.draw,[u]),re.show&&re.aboveData&&q(),m.render(),$e()}function Z(re,X){for(var le,be,De,Te,we=C(),Ke=0;Ke<we.length;++Ke)if(le=we[Ke],le.direction==X&&(Te=X+le.n+"axis",!re[Te]&&le.n==1&&(Te=X+"axis"),re[Te])){be=re[Te].from,De=re[Te].to;break}if(re[Te]||(le=X=="x"?g[0]:P[0],be=re[X+"1"],De=re[X+"2"]),be!=null&&De!=null&&be>De){var Ve=be;be=De,De=Ve}return{from:be,to:De,axis:le}}function z(){u.save(),u.translate(c.left,c.top),u.fillStyle=Le(l.grid.backgroundColor,p,0,"rgba(255, 255, 255, 0)"),u.fillRect(0,0,y,p),u.restore()}function q(){var re,X,le,be;u.save(),u.translate(c.left,c.top);var De=l.grid.markings;if(De)for(Q.isFunction(De)&&(X=D.getAxes(),X.xmin=X.xaxis.min,X.xmax=X.xaxis.max,X.ymin=X.yaxis.min,X.ymax=X.yaxis.max,De=De(X)),re=0;re<De.length;++re){var Te=De[re],we=Z(Te,"x"),Ke=Z(Te,"y");if(we.from==null&&(we.from=we.axis.min),we.to==null&&(we.to=we.axis.max),Ke.from==null&&(Ke.from=Ke.axis.min),Ke.to==null&&(Ke.to=Ke.axis.max),!(we.to<we.axis.min||we.from>we.axis.max||Ke.to<Ke.axis.min||Ke.from>Ke.axis.max)){we.from=Math.max(we.from,we.axis.min),we.to=Math.min(we.to,we.axis.max),Ke.from=Math.max(Ke.from,Ke.axis.min),Ke.to=Math.min(Ke.to,Ke.axis.max);var Ve=we.from===we.to,ht=Ke.from===Ke.to;if(!(Ve&&ht))if(we.from=Math.floor(we.axis.p2c(we.from)),we.to=Math.floor(we.axis.p2c(we.to)),Ke.from=Math.floor(Ke.axis.p2c(Ke.from)),Ke.to=Math.floor(Ke.axis.p2c(Ke.to)),Ve||ht){var gt=Te.lineWidth||l.grid.markingsLineWidth,bt=gt%2?.5:0;u.beginPath(),u.strokeStyle=Te.color||l.grid.markingsColor,u.lineWidth=gt,Ve?(u.moveTo(we.to+bt,Ke.from),u.lineTo(we.to+bt,Ke.to)):(u.moveTo(we.from,Ke.to+bt),u.lineTo(we.to,Ke.to+bt)),u.stroke()}else u.fillStyle=Te.color||l.grid.markingsColor,u.fillRect(we.from,Ke.to,we.to-we.from,Ke.from-Ke.to)}}X=C(),le=l.grid.borderWidth;for(var St=0;St<X.length;++St){var Je=X[St],rt=Je.box,Rt=Je.tickLength,_t,nn,Kt,en;if(!(!Je.show||Je.ticks.length==0)){for(u.lineWidth=1,Je.direction=="x"?(_t=0,Rt=="full"?nn=Je.position=="top"?0:p:nn=rt.top-c.top+(Je.position=="top"?rt.height:0)):(nn=0,Rt=="full"?_t=Je.position=="left"?0:y:_t=rt.left-c.left+(Je.position=="left"?rt.width:0)),Je.innermost||(u.strokeStyle=Je.options.color,u.beginPath(),Kt=en=0,Je.direction=="x"?Kt=y+1:en=p+1,u.lineWidth==1&&(Je.direction=="x"?nn=Math.floor(nn)+.5:_t=Math.floor(_t)+.5),u.moveTo(_t,nn),u.lineTo(_t+Kt,nn+en),u.stroke()),u.strokeStyle=Je.options.tickColor,u.beginPath(),re=0;re<Je.ticks.length;++re){var Qt=Je.ticks[re].v;Kt=en=0,!(isNaN(Qt)||Qt<Je.min||Qt>Je.max||Rt=="full"&&(typeof le=="object"&&le[Je.position]>0||le>0)&&(Qt==Je.min||Qt==Je.max))&&(Je.direction=="x"?(_t=Je.p2c(Qt),en=Rt=="full"?-p:Rt,Je.position=="top"&&(en=-en)):(nn=Je.p2c(Qt),Kt=Rt=="full"?-y:Rt,Je.position=="left"&&(Kt=-Kt)),u.lineWidth==1&&(Je.direction=="x"?_t=Math.floor(_t)+.5:nn=Math.floor(nn)+.5),u.moveTo(_t,nn),u.lineTo(_t+Kt,nn+en))}u.stroke()}}le&&(be=l.grid.borderColor,typeof le=="object"||typeof be=="object"?(typeof le!="object"&&(le={top:le,right:le,bottom:le,left:le}),typeof be!="object"&&(be={top:be,right:be,bottom:be,left:be}),le.top>0&&(u.strokeStyle=be.top,u.lineWidth=le.top,u.beginPath(),u.moveTo(0-le.left,0-le.top/2),u.lineTo(y,0-le.top/2),u.stroke()),le.right>0&&(u.strokeStyle=be.right,u.lineWidth=le.right,u.beginPath(),u.moveTo(y+le.right/2,0-le.top),u.lineTo(y+le.right/2,p),u.stroke()),le.bottom>0&&(u.strokeStyle=be.bottom,u.lineWidth=le.bottom,u.beginPath(),u.moveTo(y+le.right,p+le.bottom/2),u.lineTo(0,p+le.bottom/2),u.stroke()),le.left>0&&(u.strokeStyle=be.left,u.lineWidth=le.left,u.beginPath(),u.moveTo(0-le.left/2,p+le.bottom),u.lineTo(0-le.left/2,0),u.stroke())):(u.lineWidth=le,u.strokeStyle=l.grid.borderColor,u.strokeRect(-le/2,-le/2,y+le,p+le))),u.restore()}function ie(){Q.each(C(),function(re,X){var le=X.box,be=X.direction+"Axis "+X.direction+X.n+"Axis",De="flot-"+X.direction+"-axis flot-"+X.direction+X.n+"-axis "+be,Te=X.options.font||"flot-tick-label tickLabel",we,Ke,Ve,ht,gt;if(m.removeText(De),!(!X.show||X.ticks.length==0))for(var bt=0;bt<X.ticks.length;++bt)we=X.ticks[bt],!(!we.label||we.v<X.min||we.v>X.max)&&(X.direction=="x"?(ht="center",Ke=c.left+X.p2c(we.v),X.position=="bottom"?Ve=le.top+le.padding+le.eventSectionPadding:(Ve=le.top+le.height-le.padding,gt="bottom")):(gt="middle",Ve=c.top+X.p2c(we.v),X.position=="left"?(Ke=le.left+le.width-le.padding,ht="right"):Ke=le.left+le.padding),m.addText(De,Ke,Ve,we.label,Te,null,null,ht,gt))})}function de(re){for(var X=[],le=null,be=null,De=re.datapoints,Te=[],we=0;we<De.pointsize-2;we++)Te.push(0);for(var Ke=0;Ke<De.points.length;Ke+=De.pointsize){var Ve=De.points[Ke],ht=De.points[Ke+1];Ke===De.points.length-De.pointsize?be=null:be=De.points[Ke+De.pointsize],Ve!==null&&ht!==null&&le===null&&be===null&&(X.push(Ve),X.push(ht),X.push.apply(X,Te)),le=Ve}var gt=De.points;De.points=X,re.points.radius=re.lines.lineWidth/2,Se(re),De.points=gt}function ue(re){re.lines.show&&(fe(re),!re.points.show&&!re.bars.show&&de(re)),re.bars.show&&ce(re),re.points.show&&Se(re)}function fe(re){function X(Ke,Ve,ht,gt,bt){var St=Ke.points,Je=Ke.pointsize,rt=null,Rt=null;u.beginPath();for(var _t=Je;_t<St.length;_t+=Je){var nn=St[_t-Je],Kt=St[_t-Je+1],en=St[_t],Qt=St[_t+1];if(!(nn==null||en==null)){if(Kt<=Qt&&Kt<bt.min){if(Qt<bt.min)continue;nn=(bt.min-Kt)/(Qt-Kt)*(en-nn)+nn,Kt=bt.min}else if(Qt<=Kt&&Qt<bt.min){if(Kt<bt.min)continue;en=(bt.min-Kt)/(Qt-Kt)*(en-nn)+nn,Qt=bt.min}if(Kt>=Qt&&Kt>bt.max){if(Qt>bt.max)continue;nn=(bt.max-Kt)/(Qt-Kt)*(en-nn)+nn,Kt=bt.max}else if(Qt>=Kt&&Qt>bt.max){if(Kt>bt.max)continue;en=(bt.max-Kt)/(Qt-Kt)*(en-nn)+nn,Qt=bt.max}if(nn<=en&&nn<gt.min){if(en<gt.min)continue;Kt=(gt.min-nn)/(en-nn)*(Qt-Kt)+Kt,nn=gt.min}else if(en<=nn&&en<gt.min){if(nn<gt.min)continue;Qt=(gt.min-nn)/(en-nn)*(Qt-Kt)+Kt,en=gt.min}if(nn>=en&&nn>gt.max){if(en>gt.max)continue;Kt=(gt.max-nn)/(en-nn)*(Qt-Kt)+Kt,nn=gt.max}else if(en>=nn&&en>gt.max){if(nn>gt.max)continue;Qt=(gt.max-nn)/(en-nn)*(Qt-Kt)+Kt,en=gt.max}(nn!=rt||Kt!=Rt)&&u.moveTo(gt.p2c(nn)+Ve,bt.p2c(Kt)+ht),rt=en,Rt=Qt,u.lineTo(gt.p2c(en)+Ve,bt.p2c(Qt)+ht)}}u.stroke()}function le(Ke,Ve,ht){for(var gt=Ke.points,bt=Ke.pointsize,St=Math.min(Math.max(0,ht.min),ht.max),Je=0,rt,Rt=!1,_t=1,nn=0,Kt=0;!(bt>0&&Je>gt.length+bt);){Je+=bt;var en=gt[Je-bt],Qt=gt[Je-bt+_t],An=gt[Je],un=gt[Je+_t];if(Rt){if(bt>0&&en!=null&&An==null){Kt=Je,bt=-bt,_t=2;continue}if(bt<0&&Je==nn+bt){u.fill(),Rt=!1,bt=-bt,_t=1,Je=nn=Kt+bt;continue}}if(!(en==null||An==null)){if(en<=An&&en<Ve.min){if(An<Ve.min)continue;Qt=(Ve.min-en)/(An-en)*(un-Qt)+Qt,en=Ve.min}else if(An<=en&&An<Ve.min){if(en<Ve.min)continue;un=(Ve.min-en)/(An-en)*(un-Qt)+Qt,An=Ve.min}if(en>=An&&en>Ve.max){if(An>Ve.max)continue;Qt=(Ve.max-en)/(An-en)*(un-Qt)+Qt,en=Ve.max}else if(An>=en&&An>Ve.max){if(en>Ve.max)continue;un=(Ve.max-en)/(An-en)*(un-Qt)+Qt,An=Ve.max}if(Rt||(u.beginPath(),u.moveTo(Ve.p2c(en),ht.p2c(St)),Rt=!0),Qt>=ht.max&&un>=ht.max){u.lineTo(Ve.p2c(en),ht.p2c(ht.max)),u.lineTo(Ve.p2c(An),ht.p2c(ht.max));continue}else if(Qt<=ht.min&&un<=ht.min){u.lineTo(Ve.p2c(en),ht.p2c(ht.min)),u.lineTo(Ve.p2c(An),ht.p2c(ht.min));continue}var fn=en,Tt=An;Qt<=un&&Qt<ht.min&&un>=ht.min?(en=(ht.min-Qt)/(un-Qt)*(An-en)+en,Qt=ht.min):un<=Qt&&un<ht.min&&Qt>=ht.min&&(An=(ht.min-Qt)/(un-Qt)*(An-en)+en,un=ht.min),Qt>=un&&Qt>ht.max&&un<=ht.max?(en=(ht.max-Qt)/(un-Qt)*(An-en)+en,Qt=ht.max):un>=Qt&&un>ht.max&&Qt<=ht.max&&(An=(ht.max-Qt)/(un-Qt)*(An-en)+en,un=ht.max),en!=fn&&u.lineTo(Ve.p2c(fn),ht.p2c(Qt)),u.lineTo(Ve.p2c(en),ht.p2c(Qt)),u.lineTo(Ve.p2c(An),ht.p2c(un)),An!=Tt&&(u.lineTo(Ve.p2c(An),ht.p2c(un)),u.lineTo(Ve.p2c(Tt),ht.p2c(un)))}}}u.save(),u.translate(c.left,c.top),u.lineJoin="round";var be=re.lines.lineWidth,De=re.shadowSize;if(be>0&&De>0){u.lineWidth=De,u.strokeStyle="rgba(0,0,0,0.1)";var Te=Math.PI/18;X(re.datapoints,Math.sin(Te)*(be/2+De/2),Math.cos(Te)*(be/2+De/2),re.xaxis,re.yaxis),u.lineWidth=De/2,X(re.datapoints,Math.sin(Te)*(be/2+De/4),Math.cos(Te)*(be/2+De/4),re.xaxis,re.yaxis)}u.lineWidth=be,u.strokeStyle=re.color;var we=me(re.lines,re.color,0,p);we&&(u.fillStyle=we,le(re.datapoints,re.xaxis,re.yaxis)),be>0&&X(re.datapoints,0,0,re.xaxis,re.yaxis),u.restore()}function Se(re){function X(Ke,Ve,ht,gt,bt,St,Je,rt){for(var Rt=Ke.points,_t=Ke.pointsize,nn=0;nn<Rt.length;nn+=_t){var Kt=Rt[nn],en=Rt[nn+1];Kt==null||Kt<St.min||Kt>St.max||en<Je.min||en>Je.max||(u.beginPath(),Kt=St.p2c(Kt),en=Je.p2c(en)+gt,rt=="circle"?u.arc(Kt,en,Ve,0,bt?Math.PI:Math.PI*2,!1):rt(u,Kt,en,Ve,bt),u.closePath(),ht&&(u.fillStyle=ht,u.fill()),u.stroke())}}u.save(),u.translate(c.left,c.top);var le=re.points.lineWidth,be=re.shadowSize,De=re.points.radius,Te=re.points.symbol;if(le==0&&(le=1e-4),le>0&&be>0){var we=be/2;u.lineWidth=we,u.strokeStyle="rgba(0,0,0,0.1)",X(re.datapoints,De,null,we+we/2,!0,re.xaxis,re.yaxis,Te),u.strokeStyle="rgba(0,0,0,0.2)",X(re.datapoints,De,null,we/2,!0,re.xaxis,re.yaxis,Te)}u.lineWidth=le,u.strokeStyle=re.color,X(re.datapoints,De,me(re.points,re.color),0,!1,re.xaxis,re.yaxis,Te),u.restore()}function he(re,X,le,be,De,Te,we,Ke,Ve,ht,gt){var bt,St,Je,rt,Rt,_t,nn,Kt,en;ht?(Kt=_t=nn=!0,Rt=!1,bt=le,St=re,rt=X+be,Je=X+De,St<bt&&(en=St,St=bt,bt=en,Rt=!0,_t=!1)):(Rt=_t=nn=!0,Kt=!1,bt=re+be,St=re+De,Je=le,rt=X,rt<Je&&(en=rt,rt=Je,Je=en,Kt=!0,nn=!1)),!(St<we.min||bt>we.max||rt<Ke.min||Je>Ke.max)&&(bt<we.min&&(bt=we.min,Rt=!1),St>we.max&&(St=we.max,_t=!1),Je<Ke.min&&(Je=Ke.min,Kt=!1),rt>Ke.max&&(rt=Ke.max,nn=!1),bt=we.p2c(bt),Je=Ke.p2c(Je),St=we.p2c(St),rt=Ke.p2c(rt),Te&&(Ve.fillStyle=Te(Je,rt),Ve.fillRect(bt,rt,St-bt,Je-rt)),gt>0&&(Rt||_t||nn||Kt)&&(Ve.beginPath(),Ve.moveTo(bt,Je),Rt?Ve.lineTo(bt,rt):Ve.moveTo(bt,rt),nn?Ve.lineTo(St,rt):Ve.moveTo(St,rt),_t?Ve.lineTo(St,Je):Ve.moveTo(St,Je),Kt?Ve.lineTo(bt,Je):Ve.moveTo(bt,Je),Ve.stroke()))}function ce(re){function X(De,Te,we,Ke,Ve,ht){for(var gt=De.points,bt=De.pointsize,St=0;St<gt.length;St+=bt)gt[St]!=null&&he(gt[St],gt[St+1],gt[St+2],Te,we,Ke,Ve,ht,u,re.bars.horizontal,re.bars.lineWidth)}u.save(),u.translate(c.left,c.top),u.lineWidth=re.bars.lineWidth,u.strokeStyle=re.color;var le;switch(re.bars.align){case"left":le=0;break;case"right":le=-re.bars.barWidth;break;default:le=-re.bars.barWidth/2}var be=re.bars.fill?function(De,Te){return me(re.bars,re.color,De,Te)}:null;X(re.datapoints,le,le+re.bars.barWidth,be,re.xaxis,re.yaxis),u.restore()}function me(re,X,le,be){var De=re.fill;if(!De)return null;if(re.fillColor)return Le(re.fillColor,le,be,X);var Te=Q.color.parse(X);return Te.a=typeof De=="number"?De:.4,Te.normalize(),Te.toString()}function pe(){if(l.legend.container!=null?Q.find(l.legend.container).html(""):o.find(".legend").remove(),!!l.legend.show){for(var re=[],X=[],le=!1,be=l.legend.labelFormatter,De,Te,we=0;we<d.length;++we)De=d[we],De.label&&(Te=be?be(De.label,De):De.label,Te&&X.push({label:Te,color:De.color}));if(l.legend.sorted)if(Q.isFunction(l.legend.sorted))X.sort(l.legend.sorted);else if(l.legend.sorted=="reverse")X.reverse();else{var Ke=l.legend.sorted!="descending";X.sort(function(_t,nn){return _t.label==nn.label?0:_t.label<nn.label!=Ke?1:-1})}for(var we=0;we<X.length;++we){var Ve=X[we];we%l.legend.noColumns==0&&(le&&re.push("</tr>"),re.push("<tr>"),le=!0),re.push('<td class="legendColorBox"><div style="border:1px solid '+l.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+Ve.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+Ve.label+"</td>")}if(le&&re.push("</tr>"),re.length!=0){var ht='<table style="font-size:smaller;color:'+l.grid.color+'">'+re.join("")+"</table>";if(l.legend.container!=null)Q(l.legend.container).html(ht);else{var gt="",bt=l.legend.position,St=l.legend.margin;St[0]==null&&(St=[St,St]),bt.charAt(0)=="n"?gt+="top:"+(St[1]+c.top)+"px;":bt.charAt(0)=="s"&&(gt+="bottom:"+(St[1]+c.bottom)+"px;"),bt.charAt(1)=="e"?gt+="right:"+(St[0]+c.right)+"px;":bt.charAt(1)=="w"&&(gt+="left:"+(St[0]+c.left)+"px;");var Je=Q('<div class="legend">'+ht.replace('style="','style="position:absolute;'+gt+";")+"</div>").appendTo(o);if(l.legend.backgroundOpacity!=0){var rt=l.legend.backgroundColor;rt==null&&(rt=l.grid.backgroundColor,rt&&typeof rt=="string"?rt=Q.color.parse(rt):rt=Q.color.extract(Je,"background-color"),rt.a=1,rt=rt.toString());var Rt=Je.children();Q('<div style="position:absolute;width:'+Rt.width()+"px;height:"+Rt.height()+"px;"+gt+"background-color:"+rt+';"> </div>').prependTo(Je).css("opacity",l.legend.backgroundOpacity)}}}}}var ye=[],Pe=null;function Ie(re,X,le){var be=l.grid.mouseActiveRadius,De=be*be+1,Te=null,we=!1,Ke,Ve,ht;for(Ke=d.length-1;Ke>=0;--Ke)if(le(d[Ke])){var gt=d[Ke],bt=gt.xaxis,St=gt.yaxis,Je=gt.datapoints.points,rt=bt.c2p(re),Rt=St.c2p(X),_t=be/bt.scale,nn=be/St.scale;if(ht=gt.datapoints.pointsize,bt.options.inverseTransform&&(_t=Number.MAX_VALUE),St.options.inverseTransform&&(nn=Number.MAX_VALUE),gt.lines.show||gt.points.show)for(Ve=0;Ve<Je.length;Ve+=ht){var Kt=Je[Ve],en=Je[Ve+1];if(Kt!=null&&!(Kt-rt>_t||Kt-rt<-_t||en-Rt>nn||en-Rt<-nn)){var Qt=Math.abs(bt.p2c(Kt)-re),An=Math.abs(St.p2c(en)-X),un=Qt*Qt+An*An;un<De&&(De=un,Te=[Ke,Ve/ht])}}if(gt.bars.show&&!Te){var fn,Tt;switch(gt.bars.align){case"left":fn=0;break;case"right":fn=-gt.bars.barWidth;break;default:fn=-gt.bars.barWidth/2}for(Tt=fn+gt.bars.barWidth,Ve=0;Ve<Je.length;Ve+=ht){var Kt=Je[Ve],en=Je[Ve+1],$t=Je[Ve+2];Kt!=null&&(d[Ke].bars.horizontal?rt<=Math.max($t,Kt)&&rt>=Math.min($t,Kt)&&Rt>=en+fn&&Rt<=en+Tt:rt>=Kt+fn&&rt<=Kt+Tt&&Rt>=Math.min($t,en)&&Rt<=Math.max($t,en))&&(Te=[Ke,Ve/ht])}}}return Te?(Ke=Te[0],Ve=Te[1],ht=d[Ke].datapoints.pointsize,{datapoint:d[Ke].datapoints.points.slice(Ve*ht,(Ve+1)*ht),dataIndex:Ve,series:d[Ke],seriesIndex:Ke}):null}function Oe(re){l.grid.hoverable&&Me("plothover",re,function(X){return X.hoverable!=!1})}function Ne(re){l.grid.hoverable&&Me("plothover",re,function(X){return!1})}function We(re){D.isSelecting||Me("plotclick",re,function(X){return X.clickable!=!1})}function Ae(re){if(re.cancelable){if(!h.is(re.target)&&h.has(re.target).length===0){Me("plotleave",re,function(X){});return}Oe(Ue(re)),re.preventDefault()}}function Ue(re){if(!re||!re.originalEvent||re.pageX&&re.pageY)return re;var X=re.originalEvent;if(X.changedTouches.length===0)return re;var le=X.changedTouches[0];return re.pageX=le.pageX,re.pageY=le.pageY,re}function Me(re,X,le){var be=h.offset(),De=X.pageX-be.left-c.left,Te=X.pageY-be.top-c.top,we=O({left:De,top:Te});we.pageX=X.pageX,we.pageY=X.pageY,we.ctrlKey=X.ctrlKey,we.metaKey=X.metaKey;var Ke=Ie(De,Te,le);if(Ke&&(Ke.pageX=parseInt(Ke.series.xaxis.p2c(Ke.datapoint[0])+be.left+c.left,10),Ke.pageY=parseInt(Ke.series.yaxis.p2c(Ke.datapoint[1])+be.top+c.top,10)),l.grid.autoHighlight){for(var Ve=0;Ve<ye.length;++Ve){var ht=ye[Ve];ht.auto==re&&!(Ke&&ht.series==Ke.series&&ht.point[0]==Ke.datapoint[0]&&ht.point[1]==Ke.datapoint[1])&&ot(ht.series,ht.point)}Ke&&Ze(Ke.series,Ke.datapoint,re)}o.trigger(re,[we,Ke])}function $e(){var re=l.interaction.redrawOverlayInterval;if(re==-1){ke();return}Pe||(Pe=setTimeout(ke,re))}function ke(){Pe=null,b.save(),s.clear(),b.translate(c.left,c.top);var re,X;for(re=0;re<ye.length;++re)X=ye[re],X.series.bars.show?ft(X.series,X.point):ct(X.series,X.point);b.restore(),E(v.drawOverlay,[b])}function Ze(re,X,le){if(typeof re=="number"&&(re=d[re]),typeof X=="number"){var be=re.datapoints.pointsize;X=re.datapoints.points.slice(be*X,be*(X+1))}var De=xt(re,X);De==-1?(ye.push({series:re,point:X,auto:le}),$e()):le||(ye[De].auto=!1)}function ot(re,X){if(re==null&&X==null){ye=[],$e();return}if(typeof re=="number"&&(re=d[re]),typeof X=="number"){var le=re.datapoints.pointsize;X=re.datapoints.points.slice(le*X,le*(X+1))}var be=xt(re,X);be!=-1&&(ye.splice(be,1),$e())}function xt(re,X){for(var le=0;le<ye.length;++le){var be=ye[le];if(be.series==re&&be.point[0]==X[0]&&be.point[1]==X[1])return le}return-1}function ct(re,X){var le=X[0],be=X[1],De=re.xaxis,Te=re.yaxis,we=typeof re.highlightColor=="string"?re.highlightColor:Q.color.parse(re.color).scale("a",.5).toString();if(!(le<De.min||le>De.max||be<Te.min||be>Te.max)){var Ke=re.points.radius+re.points.lineWidth/2;b.lineWidth=Ke,b.strokeStyle=we;var Ve=1.5*Ke;le=De.p2c(le),be=Te.p2c(be),b.beginPath(),re.points.symbol=="circle"?b.arc(le,be,Ve,0,2*Math.PI,!1):re.points.symbol(b,le,be,Ve,!1),b.closePath(),b.stroke()}}function ft(re,X){var le=typeof re.highlightColor=="string"?re.highlightColor:Q.color.parse(re.color).scale("a",.5).toString(),be=le,De;switch(re.bars.align){case"left":De=0;break;case"right":De=-re.bars.barWidth;break;default:De=-re.bars.barWidth/2}b.lineWidth=re.bars.lineWidth,b.strokeStyle=le,he(X[0],X[1],X[2]||0,De,De+re.bars.barWidth,function(){return be},re.xaxis,re.yaxis,b,re.bars.horizontal,re.bars.lineWidth)}function Le(re,X,le,be){if(typeof re=="string")return re;for(var De=u.createLinearGradient(0,le,0,X),Te=0,we=re.colors.length;Te<we;++Te){var Ke=re.colors[Te];if(typeof Ke!="string"){var Ve=Q.color.parse(be);Ke.brightness!=null&&(Ve=Ve.scale("rgb",Ke.brightness)),Ke.opacity!=null&&(Ve.a*=Ke.opacity),Ke=Ve.toString()}De.addColorStop(Te/(we-1),Ke)}return De}}Q.plot=function(o,r,i){var f=new n(Q(o),r,i,Q.plot.plugins);return f},Q.plot.version="0.8.3",Q.plot.plugins=[],Q.fn.plot=function(o,r){return this.each(function(){Q.plot(this,o,r)})};function a(o,r){return r*Math.floor(o/r)}}(jQuery)},80851:()=>{(function(Q){function I(e){var n={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},a={},o=null;function r(c){n.active&&(h(c),e.getPlaceholder().trigger("plotselecting",[d()]))}function i(c){c.which==1&&(document.body.focus(),document.onselectstart!==void 0&&a.onselectstart==null&&(a.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),document.ondrag!==void 0&&a.ondrag==null&&(a.ondrag=document.ondrag,document.ondrag=function(){return!1}),s(n.first,c),n.active=!0,o=function(y){f(y)},Q(document).one("mouseup",o))}function f(c){return o=null,document.onselectstart!==void 0&&(document.onselectstart=a.onselectstart),document.ondrag!==void 0&&(document.ondrag=a.ondrag),n.active=!1,h(c),P()?l(c):(e.getPlaceholder().trigger("plotunselected",[]),e.getPlaceholder().trigger("plotselecting",[null])),setTimeout(function(){e.isSelecting=!1},10),!1}function d(){if(!P()||!n.show)return null;var c={},y=n.first,p=n.second,v=e.getAxes(),D=!0;return Q.each(v,function(E,S){S.used&&(anyUsed=!1)}),Q.each(v,function(E,S){if(S.used||D){var T=S.c2p(y[S.direction]),M=S.c2p(p[S.direction]);c[E]={from:Math.min(T,M),to:Math.max(T,M)}}}),c}function l(c){var y=d();y.ctrlKey=c.ctrlKey,y.metaKey=c.metaKey,e.getPlaceholder().trigger("plotselected",[y]),y.xaxis&&y.yaxis&&e.getPlaceholder().trigger("selected",[{x1:y.xaxis.from,y1:y.yaxis.from,x2:y.xaxis.to,y2:y.yaxis.to}])}function m(c,y,p){return y<c?c:y>p?p:y}function s(c,y){var p=e.getOptions(),v=e.getPlaceholder().offset(),D=e.getPlotOffset();c.x=m(0,y.pageX-v.left-D.left,e.width()),c.y=m(0,y.pageY-v.top-D.top,e.height()),p.selection.mode=="y"&&(c.x=c==n.first?0:e.width()),p.selection.mode=="x"&&(c.y=c==n.first?0:e.height())}function h(c){c.pageX!=null&&(s(n.second,c),P()?(e.isSelecting=!0,n.show=!0,e.triggerRedrawOverlay()):u(!0))}function u(c){n.show&&(n.show=!1,e.triggerRedrawOverlay(),c||e.getPlaceholder().trigger("plotunselected",[]))}function b(c,y){var p,v,D,E,S=e.getAxes();for(var T in S)if(p=S[T],p.direction==y&&(E=y+p.n+"axis",!c[E]&&p.n==1&&(E=y+"axis"),c[E])){v=c[E].from,D=c[E].to;break}if(c[E]||(p=y=="x"?e.getXAxes()[0]:e.getYAxes()[0],v=c[y+"1"],D=c[y+"2"]),v!=null&&D!=null&&v>D){var M=v;v=D,D=M}return{from:v,to:D,axis:p}}function g(c,y){var p,v,D=e.getOptions();D.selection.mode=="y"?(n.first.x=0,n.second.x=e.width()):(v=b(c,"x"),n.first.x=v.axis.p2c(v.from),n.second.x=v.axis.p2c(v.to)),D.selection.mode=="x"?(n.first.y=0,n.second.y=e.height()):(v=b(c,"y"),n.first.y=v.axis.p2c(v.from),n.second.y=v.axis.p2c(v.to)),n.show=!0,e.triggerRedrawOverlay(),!y&&P()&&l()}function P(){var c=e.getOptions().selection.minSize;return Math.abs(n.second.x-n.first.x)>=c&&Math.abs(n.second.y-n.first.y)>=c}e.clearSelection=u,e.setSelection=g,e.getSelection=d,e.hooks.bindEvents.push(function(c,y){var p=c.getOptions();p.selection.mode!=null&&(y.mousemove(r),y.mousedown(i))}),e.hooks.drawOverlay.push(function(c,y){if(n.show&&P()){var p=c.getPlotOffset(),v=c.getOptions();y.save(),y.translate(p.left,p.top);var D=Q.color.parse(v.selection.color);y.strokeStyle=D.scale("a",.8).toString(),y.lineWidth=1,y.lineJoin=v.selection.shape,y.fillStyle=D.scale("a",.4).toString();var E=Math.min(n.first.x,n.second.x)+.5,S=Math.min(n.first.y,n.second.y)+.5,T=Math.abs(n.second.x-n.first.x)-1,M=Math.abs(n.second.y-n.first.y)-1;y.fillRect(E,S,T,M),y.strokeRect(E,S,T,M),y.restore()}}),e.hooks.shutdown.push(function(c,y){y.unbind("mousemove",r),y.unbind("mousedown",i),o&&(Q(document).unbind("mouseup",o),document.onselectstart!==void 0&&(document.onselectstart=a.onselectstart),document.ondrag!==void 0&&(document.ondrag=a.ondrag))})}Q.plot.plugins.push({init:I,options:{selection:{mode:null,color:"#e8cfac",shape:"round",minSize:5}},name:"selection",version:"1.1"})})(jQuery)},31221:()=>{(function(Q){var I={series:{stack:null}};function e(n){function a(r,i){for(var f=null,d=0;d<i.length&&r!=i[d];++d)i[d].stack==r.stack&&(f=i[d]);return f}function o(r,i,f){if(!(i.stack==null||i.stack===!1)){var d=a(i,r.getData());if(d){for(var l=f.pointsize,m=f.points,s=d.datapoints.pointsize,h=d.datapoints.points,u=[],b,g,P,c,y,p,v=i.lines.show,D=i.bars.horizontal,E=l>2&&(D?f.format[2].x:f.format[2].y),S=v&&i.lines.steps,T=D?1:0,M=D?0:1,A=0,x=0,C,O;!(A>=m.length&&x>=h.length);){if(C=u.length,A<m.length&&m[A]==null){for(O=0;O<l;++O)u.push(m[A+O]);A+=l}else if(A>=m.length){for(O=0;O<l;++O)u.push(h[x+O]);E&&(u[C+2]=h[x+M]),x+=s}else if(x>=h.length){for(O=0;O<l;++O)u.push(m[A+O]);A+=l}else if(x<h.length&&h[x]==null)x+=s;else{if(b=m[A+T],g=m[A+M],c=h[x+T],y=h[x+M],p=0,b==c){for(O=0;O<l;++O)u.push(m[A+O]);u[C+M]+=y,p=y,A+=l,x+=s}else if(b>c){if(A==0){for(O=0;O<l;++O)u.push(h[x+O]);p=y}if(A>0&&m[A-l]!=null){for(P=0,u.push(c),u.push(P+y),O=2;O<l;++O)u.push(m[A+O]);p=y}x+=s}else{for(O=0;O<l;++O)u.push(m[A+O]);x>0&&h[x-s]!=null&&(p=0),u[C+M]+=p,A+=l}fromgap=!1,C!=u.length&&E&&(u[C+2]=p)}if(S&&C!=u.length&&C>0&&u[C]!=null&&u[C]!=u[C-l]&&u[C+1]!=u[C-l+1]){for(O=0;O<l;++O)u[C+l+O]=u[C+O];u[C+1]=u[C-l+1]}}f.points=u}}}n.hooks.processDatapoints.push(o)}Q.plot.plugins.push({init:e,options:I,name:"stack",version:"1.2"})})(jQuery)},91520:()=>{(function(Q){var I={series:{stackpercent:null}};function e(n){var a={},o=!1,r={};function i(l,m,s,h){if(o||(o=!0,r=f(l.getData())),m.stackpercent==!0){var u=s.length;m.percents=[];var b=0,g=1;m.bars&&m.bars.horizontal&&m.bars.horizontal===!0&&(b=1,g=0);for(var P=0;P<u;P++){var c=r[s[P][b]+""];c>0?m.percents.push(s[P][g]*100/c):m.percents.push(0)}}}function f(l){var m=l.length,s={};if(m>0){for(var h=0;h<m;h++)if(l[h].stackpercent){var u=0,b=1;l[h].bars&&l[h].bars.horizontal&&l[h].bars.horizontal===!0&&(u=1,b=0);for(var g=l[h].data.length,P=0;P<g;P++){var c=0;l[h].data[P][1]!=null&&(c=l[h].data[P][b]),s[l[h].data[P][u]+""]?s[l[h].data[P][u]+""]+=c:s[l[h].data[P][u]+""]=c}}}return s}function d(l,m,s){if(m.stackpercent){o||(r=f(l.getData()));var h=[],u=0,b=1;m.bars&&m.bars.horizontal&&m.bars.horizontal===!0&&(u=1,b=0);for(var g=0;g<s.points.length;g+=3)a[s.points[g+u]]||(a[s.points[g+u]]=0),h[g+u]=s.points[g+u],h[g+b]=s.points[g+b]+a[s.points[g+u]],h[g+2]=a[s.points[g+u]],a[s.points[g+u]]+=s.points[g+b],r[h[g+u]+""]>0?(h[g+b]=h[g+b]*100/r[h[g+u]+""],h[g+2]=h[g+2]*100/r[h[g+u]+""]):(h[g+b]=0,h[g+2]=0);s.points=h}}n.hooks.processRawData.push(i),n.hooks.processDatapoints.push(d)}Q.plot.plugins.push({init:e,options:I,name:"stackpercent",version:"0.1"})})(jQuery)},32176:()=>{(function(Q){var I={xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}};function e(m,s){return s*Math.floor(m/s)}function n(m,s,h,u){if(typeof m.strftime=="function")return m.strftime(s);var b=function(E,S){return E=""+E,S=""+(S??"0"),E.length==1?S+E:E},g=[],P=!1,c=m.getHours(),y=c<12;h==null&&(h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),u==null&&(u=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);var p;c>12?p=c-12:c==0?p=12:p=c;for(var v=0;v<s.length;++v){var D=s.charAt(v);if(P){switch(D){case"a":D=""+u[m.getDay()];break;case"b":D=""+h[m.getMonth()];break;case"d":D=b(m.getDate(),"");break;case"e":D=b(m.getDate()," ");break;case"h":case"H":D=b(c);break;case"I":D=b(p);break;case"l":D=b(p," ");break;case"m":D=b(m.getMonth()+1,"");break;case"M":D=b(m.getMinutes());break;case"q":D=""+(Math.floor(m.getMonth()/3)+1);break;case"S":D=b(m.getSeconds());break;case"y":D=b(m.getFullYear()%100);break;case"Y":D=""+m.getFullYear();break;case"p":D=y?"am":"pm";break;case"P":D=y?"AM":"PM";break;case"w":D=""+m.getDay();break}g.push(D),P=!1}else D=="%"?P=!0:g.push(D)}return g.join("")}function a(m){function s(g,P,c,y){g[P]=function(){return c[y].apply(c,arguments)}}var h={date:m};m.strftime!=null&&s(h,"strftime",m,"strftime"),s(h,"getTime",m,"getTime"),s(h,"setTime",m,"setTime");for(var u=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],b=0;b<u.length;b++)s(h,"get"+u[b],m,"getUTC"+u[b]),s(h,"set"+u[b],m,"setUTC"+u[b]);return h}function o(m,s){if(s.timezone=="browser")return new Date(m);if(!s.timezone||s.timezone=="utc")return a(new Date(m));if(typeof timezoneJS<"u"&&typeof timezoneJS.Date<"u"){var h=new timezoneJS.Date;return h.setTimezone(s.timezone),h.setTime(m),h}else return a(new Date(m))}var r={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:30*24*60*60*1e3,quarter:3*30*24*60*60*1e3,year:365.2425*24*60*60*1e3},i=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],f=i.concat([[3,"month"],[6,"month"],[1,"year"]]),d=i.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);function l(m){m.hooks.processOptions.push(function(s,h){Q.each(s.getAxes(),function(u,b){var g=b.options;g.mode=="time"&&(b.tickGenerator=function(P){var c=[],y=o(P.min,g),p=0,v=g.tickSize&&g.tickSize[1]==="quarter"||g.minTickSize&&g.minTickSize[1]==="quarter"?d:f;g.minTickSize!=null&&(typeof g.tickSize=="number"?p=g.tickSize:p=g.minTickSize[0]*r[g.minTickSize[1]]);for(var D=0;D<v.length-1&&!(P.delta<(v[D][0]*r[v[D][1]]+v[D+1][0]*r[v[D+1][1]])/2&&v[D][0]*r[v[D][1]]>=p);++D);var E=v[D][0],S=v[D][1];if(S=="year"){if(g.minTickSize!=null&&g.minTickSize[1]=="year")E=Math.floor(g.minTickSize[0]);else{var T=Math.pow(10,Math.floor(Math.log(P.delta/r.year)/Math.LN10)),M=P.delta/r.year/T;M<1.5?E=1:M<3?E=2:M<7.5?E=5:E=10,E*=T}E<1&&(E=1)}P.tickSize=g.tickSize||[E,S];var A=P.tickSize[0];S=P.tickSize[1];var x=A*r[S];S=="second"?y.setSeconds(e(y.getSeconds(),A)):S=="minute"?y.setMinutes(e(y.getMinutes(),A)):S=="hour"?y.setHours(e(y.getHours(),A)):S=="month"?y.setMonth(e(y.getMonth(),A)):S=="quarter"?y.setMonth(3*e(y.getMonth()/3,A)):S=="year"&&y.setFullYear(e(y.getFullYear(),A)),y.setMilliseconds(0),x>=r.minute&&y.setSeconds(0),x>=r.hour&&y.setMinutes(0),x>=r.day&&y.setHours(0),x>=r.day*4&&y.setDate(1),x>=r.month*2&&y.setMonth(e(y.getMonth(),3)),x>=r.quarter*2&&y.setMonth(e(y.getMonth(),6)),x>=r.year&&y.setMonth(0);var C=0,O=Number.NaN,R;do if(R=O,O=y.getTime(),c.push(O),S=="month"||S=="quarter")if(A<1){y.setDate(1);var L=y.getTime();y.setMonth(y.getMonth()+(S=="quarter"?3:1));var N=y.getTime();y.setTime(O+C*r.hour+(N-L)*A),C=y.getHours(),y.setHours(0)}else y.setMonth(y.getMonth()+A*(S=="quarter"?3:1));else S=="year"?y.setFullYear(y.getFullYear()+A):y.setTime(O+x);while(O<P.max&&O!=R);return c},b.tickFormatter=function(P,c){var y=o(P,c.options);if(g.timeformat!=null)return n(y,g.timeformat,g.monthNames,g.dayNames);var p=c.options.tickSize&&c.options.tickSize[1]=="quarter"||c.options.minTickSize&&c.options.minTickSize[1]=="quarter",v=c.tickSize[0]*r[c.tickSize[1]],D=c.max-c.min,E=g.twelveHourClock?" %p":"",S=g.twelveHourClock?"%I":"%H",T;v<r.minute?T=S+":%M:%S"+E:v<r.day?D<2*r.day?T=S+":%M"+E:T="%b %d "+S+":%M"+E:v<r.month?T="%b %d":p&&v<r.quarter||!p&&v<r.year?D<r.year?T="%b":T="%b %Y":p&&v<r.year?D<r.year?T="Q%q":T="Q%q %Y":T="%Y";var M=n(y,T,g.monthNames,g.dayNames);return M})})})}Q.plot.plugins.push({init:l,options:I,name:"time",version:"1.0"}),Q.plot.formatDate=n})(jQuery)}}]);

//# sourceMappingURL=3785.ef1dd594e3a11114c4cb.js.map
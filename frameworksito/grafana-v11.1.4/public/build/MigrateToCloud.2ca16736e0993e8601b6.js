"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3704],{44953:(Te,L,r)=>{r.r(L),r.d(L,{default:()=>xe});var e=r(96540),D=r(32264),N=r(67608),h=r(32196),p=r(40845),G=r(71259),y=r(90613),s=r(67061),T=r(72109),t=r(8484),l=r(94753);const m=({children:n,title:a,linkHref:o,linkTitle:i})=>e.createElement(s.B,{gap:2,direction:"column"},e.createElement(l.E,{element:"h4"},a),e.createElement(l.E,{color:"secondary"},n),o&&e.createElement(T.Y,{href:o,external:!0},i??o)),Y=()=>{const n=(0,p.of)($);return e.createElement(y.a,{alignItems:"flex-start",display:"flex",padding:2,gap:2,direction:"column",backgroundColor:"secondary"},e.createElement(m,{title:(0,t.t)("migrate-to-cloud.migrate-to-this-stack.title","Migrate configuration to this stack"),linkTitle:(0,t.t)("migrate-to-cloud.migrate-to-this-stack.link-title","View the full migration guide"),linkHref:"https://grafana.com/docs/grafana-cloud/account-management/migration-guide"},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.migrate-to-this-stack.body"},"Some configuration from your self-managed Grafana instance can be automatically copied to this cloud stack.")),e.createElement(m,{title:(0,t.t)("migrate-to-cloud.get-started.title","How to get started"),linkTitle:(0,t.t)("migrate-to-cloud.get-started.link-title","Learn more about Private Data Source Connect"),linkHref:"https://grafana.com/docs/grafana-cloud/connect-externally-hosted/private-data-source-connect"},e.createElement(s.B,{direction:"column",gap:2},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.get-started.body"},"The migration process must be started from your self-managed Grafana instance."),e.createElement("ol",{className:n.list},e.createElement("li",null,e.createElement(t.x6,{i18nKey:"migrate-to-cloud.get-started.step-1"},"Log in to your self-managed instance and navigate to Administration, General, Migrate to Grafana Cloud.")),e.createElement("li",null,e.createElement(t.x6,{i18nKey:"migrate-to-cloud.get-started.step-2"},'Select "Migrate this instance to Cloud".')),e.createElement("li",null,e.createElement(t.x6,{i18nKey:"migrate-to-cloud.get-started.step-3"},"You'll be prompted for a migration token. Generate one from this screen.")),e.createElement("li",null,e.createElement(t.x6,{i18nKey:"migrate-to-cloud.get-started.step-4"},'In your self-managed instance, select "Upload everything" to upload data sources and dashboards to this cloud stack.')),e.createElement("li",null,e.createElement(t.x6,{i18nKey:"migrate-to-cloud.get-started.step-5"},"If some of your data sources will not work over the public internet, you\u2019ll need to install Private Data Source Connect in your self-managed environment."))))),e.createElement(T.Y,{href:"/connections/private-data-source-connections"},(0,t.t)("migrate-to-cloud.get-started.configure-pdc-link","Configure PDC for this stack")))},$=n=>({list:(0,h.css)({padding:"revert"})});var g=r(55852),E=r(59120),k=r(42418);function R(){return e.createElement(k.F,{severity:"error",title:(0,t.t)("migrate-to-cloud.migration-token.error-title","Something went wrong")},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.migration-token.error-body"},"Unable to generate a migration token. Please try again later."))}var I=r(37390),F=r(10534),A=r(88575),B=r(10354);const z=({isOpen:n,hideModal:a,migrationToken:o})=>e.createElement(I.a,{isOpen:n,title:(0,t.t)("migrate-to-cloud.migration-token.modal-title","Migration token created"),onDismiss:a},o?e.createElement(j,{migrationToken:o}):e.createElement(R,null),e.createElement(I.a.ButtonRow,null,e.createElement(g.$n,{variant:"secondary",onClick:a},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.migration-token.modal-close"},"Close")),o&&e.createElement(F.b,{variant:"primary",getText:()=>o,onClipboardCopy:a},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.migration-token.modal-copy-and-close"},"Copy to clipboard and close"))));function j({migrationToken:n}){const a=(0,e.useId)();return e.createElement(A.D,{description:(0,t.t)("migrate-to-cloud.migration-token.modal-field-description","Copy the token now as you will not be able to see it again. Losing a token requires creating a new one."),htmlFor:a,label:(0,t.t)("migrate-to-cloud.migration-token.modal-field-label","Token")},e.createElement(s.B,null,e.createElement(B.p,{id:a,value:n,readOnly:!0}),e.createElement(F.b,{icon:"clipboard-alt",getText:()=>n},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.migration-token.modal-copy-button"},"Copy to clipboard"))))}var M=r(70255);const W=({hasToken:n,isFetching:a})=>a?e.createElement(M.A,{width:100}):n?e.createElement(l.E,{color:"success"},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.token-status.active"},"Token created and active")):e.createElement(t.x6,{i18nKey:"migrate-to-cloud.token-status.no-active"},"No active token"),V=()=>{const[n,a]=(0,e.useState)(!1),o=!1,[i,c]=(0,E.dX)(),d=!!c.data?.token,f=o||c.isLoading,u=(0,e.useCallback)(async()=>{"error"in await i()||a(!0)},[i]);return e.createElement(e.Fragment,null,e.createElement(y.a,{display:"flex",alignItems:"flex-start",padding:2,gap:2,direction:"column",backgroundColor:"secondary"},e.createElement(m,{title:(0,t.t)("migrate-to-cloud.migration-token.title","Migration token")},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.migration-token.body"},"Your self-managed Grafana instance will require a special authentication token to securely connect to this cloud stack.")),c?.isError?e.createElement(R,null):e.createElement(l.E,{color:"secondary"},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.migration-token.status"},"Current status: ",e.createElement(W,{hasToken:d,isFetching:f}))),e.createElement(g.$n,{disabled:f||d,onClick:u},c.isLoading?(0,t.t)("migrate-to-cloud.migration-token.generate-button-loading","Generating a migration token..."):(0,t.t)("migrate-to-cloud.migration-token.generate-button","Generate a migration token"))),e.createElement(z,{isOpen:n,hideModal:()=>a(!1),migrationToken:c.data?.token}))},Z=()=>{const n=(0,p.of)(Q);return e.createElement("div",{className:n.container},e.createElement(G.x,{alignItems:"flex-start",gap:1,columns:{xs:1,lg:2}},e.createElement(Y,null),e.createElement(V,null)))},Q=n=>({container:(0,h.css)({maxWidth:n.breakpoints.values.xl})});var O=r(10378),X=r(96374);const J=({isOpen:n,isError:a,isLoading:o,onDisconnectConfirm:i,onDismiss:c})=>{const d=e.createElement(s.B,{direction:"column"},a&&e.createElement(k.F,{severity:"error",title:(0,t.t)("migrate-to-cloud.disconnect-modal.error","There was an error disconnecting")}),e.createElement("div",null,e.createElement(t.x6,{i18nKey:"migrate-to-cloud.disconnect-modal.body"},"This will remove the migration token from this installation. If you wish to upload more resources in the future, you will need to enter a new migration token.")));return e.createElement(X.u,{isOpen:n,title:(0,t.t)("migrate-to-cloud.disconnect-modal.title","Disconnect from cloud stack"),body:e.createElement(e.Fragment,null),description:d,confirmText:o?(0,t.t)("migrate-to-cloud.disconnect-modal.disconnecting","Disconnecting..."):(0,t.t)("migrate-to-cloud.disconnect-modal.disconnect","Disconnect"),dismissText:(0,t.t)("migrate-to-cloud.disconnect-modal.cancel","Cancel"),onConfirm:i,onDismiss:c})};var q=r(49785);const _=({isOpen:n,isLoading:a,isError:o,hideModal:i,onConfirm:c})=>{const d=(0,e.useId)(),f=(0,p.of)(ee),{handleSubmit:u,register:v,formState:{errors:b},watch:x}=(0,q.mN)({defaultValues:{token:""}}),w=x("token"),K=C=>{c({cloudMigrationRequest:{authToken:C.token}}).then(S=>{typeof S=="object"&&S&&"error"in S||i()})};return e.createElement(I.a,{isOpen:n,title:(0,t.t)("migrate-to-cloud.connect-modal.title","Connect to a cloud stack"),onDismiss:i},e.createElement("form",{onSubmit:u(K)},e.createElement(l.E,{color:"secondary"},e.createElement(s.B,{direction:"column",gap:2},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.connect-modal.body-get-started"},"To get started, you'll need a Grafana.com account."),e.createElement("div",null,e.createElement(T.Y,{href:"https://grafana.com/auth/sign-up/create-user?pg=prod-cloud",external:!0},(0,t.t)("migrate-to-cloud.connect-modal.body-sign-up","Sign up for a Grafana.com account"))),e.createElement(t.x6,{i18nKey:"migrate-to-cloud.connect-modal.body-cloud-stack"},"You'll also need a cloud stack. If you just signed up, we'll automatically create your first stack. If you have an account, you'll need to select or create a stack."),e.createElement("div",null,e.createElement(T.Y,{href:"https://grafana.com/auth/sign-in/",external:!0},(0,t.t)("migrate-to-cloud.connect-modal.body-view-stacks","View my cloud stacks"))),e.createElement("div",null,e.createElement(t.x6,{i18nKey:"migrate-to-cloud.connect-modal.body-token"},"Your self-managed Grafana installation needs special access to securely migrate content. You'll need to create a migration token on your chosen cloud stack.")),e.createElement("div",null,e.createElement(t.x6,{i18nKey:"migrate-to-cloud.connect-modal.body-token-instructions"},"Log into your cloud stack and navigate to Administration, General, Migrate to Grafana Cloud. Create a migration token on that screen and paste the token here.")),o&&e.createElement(k.F,{severity:"error",title:(0,t.t)("migrate-to-cloud.connect-modal.token-error-title","Error saving token")},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.connect-modal.token-error-description"},"There was an error saving the token. See the Grafana server logs for more details.")),e.createElement(A.D,{className:f.field,invalid:!!b.token,error:b.token?.message,label:(0,t.t)("migrate-to-cloud.connect-modal.body-token-field","Migration token"),required:!0},e.createElement(B.p,{...v("token",{required:(0,t.t)("migrate-to-cloud.connect-modal.token-required-error","Migration token is required")}),id:d,placeholder:(0,t.t)("migrate-to-cloud.connect-modal.body-token-field-placeholder","Paste token here")})))),e.createElement(I.a.ButtonRow,null,e.createElement(g.$n,{variant:"secondary",onClick:i},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.connect-modal.cancel"},"Cancel")),e.createElement(g.$n,{type:"submit",disabled:a||!w},a?(0,t.t)("migrate-to-cloud.connect-modal.connecting","Connecting to this stack..."):(0,t.t)("migrate-to-cloud.connect-modal.connect","Connect to this stack")))))},ee=n=>({field:(0,h.css)({alignSelf:"stretch"})}),te=()=>{const[n,a]=(0,e.useState)(!1),[o,i]=(0,E.Z1)();return e.createElement(e.Fragment,null,e.createElement(y.a,{display:"flex",padding:5,gap:2,direction:"column",alignItems:"center",backgroundColor:"secondary"},e.createElement(l.E,{variant:"h3",textAlignment:"center"},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.cta.header"},"Let us manage your Grafana stack")),e.createElement(g.$n,{disabled:i.isLoading,onClick:()=>a(!0)},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.cta.button"},"Migrate this instance to Cloud"))),e.createElement(_,{isOpen:n,isLoading:i.isLoading,isError:i.isError,onConfirm:o,hideModal:()=>a(!1)}))},ne=()=>e.createElement(y.a,{alignItems:"flex-start",display:"flex",padding:2,gap:2,direction:"column",backgroundColor:"secondary"},e.createElement(m,{title:(0,t.t)("migrate-to-cloud.what-is-cloud.title","What is Grafana Cloud?"),linkTitle:(0,t.t)("migrate-to-cloud.what-is-cloud.link-title","Learn about cloud features"),linkHref:"https://grafana.com/products/cloud"},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.what-is-cloud.body"},"Grafana cloud is a fully managed cloud-hosted observability platform ideal for cloud native environments. It's everything you love about Grafana without the overhead of maintaining, upgrading, and supporting an installation.")),e.createElement(m,{title:(0,t.t)("migrate-to-cloud.why-host.title","Why host with Grafana?"),linkTitle:(0,t.t)("migrate-to-cloud.why-host.link-title","More questions? Talk to an expert"),linkHref:"https://grafana.com/contact"},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.why-host.body"},"In addition to the convenience of managed hosting, Grafana Cloud includes many cloud-exclusive features like SLOs, incident management, machine learning, and powerful observability integrations.")),e.createElement(m,{title:(0,t.t)("migrate-to-cloud.is-it-secure.title","Is it secure?"),linkTitle:(0,t.t)("migrate-to-cloud.is-it-secure.link-title","Grafana Labs Trust Center"),linkHref:"https://trust.grafana.com"},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.is-it-secure.body"},"Grafana Labs is committed to maintaining the highest standards of data privacy and security. By implementing industry-standard security technologies and procedures, we help protect our customers' data from unauthorized access, use, or disclosure."))),ae=()=>e.createElement(y.a,{alignItems:"flex-start",display:"flex",direction:"column",gap:2,padding:2,backgroundColor:"secondary"},e.createElement(m,{title:(0,t.t)("migrate-to-cloud.pdc.title","Not all my data sources are on the public internet"),linkTitle:(0,t.t)("migrate-to-cloud.pdc.link-title","Learn about PDC"),linkHref:"https://grafana.com/docs/grafana-cloud/connect-externally-hosted/private-data-source-connect"},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.pdc.body"},"Exposing your data sources to the internet can raise security concerns. Private data source connect (PDC) allows Grafana Cloud to access your existing data sources over a secure network tunnel.")),e.createElement(m,{title:(0,t.t)("migrate-to-cloud.pricing.title","How much does it cost?"),linkTitle:(0,t.t)("migrate-to-cloud.pricing.link-title","Grafana Cloud pricing"),linkHref:"https://grafana.com/pricing"},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.pricing.body"},"Grafana Cloud has a generous free plan and a 14 day unlimited usage trial. After your trial expires, you'll be billed based on usage over the free plan limits.")),e.createElement(m,{title:(0,t.t)("migrate-to-cloud.can-i-move.title","Can I move this installation to Grafana Cloud?"),linkTitle:(0,t.t)("migrate-to-cloud.can-i-move.link-title","Learn about migrating other settings"),linkHref:"https://grafana.com/docs/grafana-cloud/account-management/migration-guide"},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.can-i-move.body"},"Once you connect this installation to a cloud stack, you'll be able to upload data sources and dashboards."))),oe=()=>{const n=(0,p.of)(re);return e.createElement("div",{className:n.container},e.createElement(s.B,{direction:"column"},e.createElement(te,null),e.createElement(G.x,{alignItems:"flex-start",gap:1,columns:{xs:1,lg:2}},e.createElement(ne,null),e.createElement(ae,null))))},re=n=>({container:(0,h.css)({maxWidth:n.breakpoints.values.xl})});function ie({title:n,value:a}){return e.createElement(s.B,{direction:"column"},e.createElement(l.E,{variant:"bodySmall",color:"secondary"},n),e.createElement(l.E,{variant:"h4"},a))}var le=r(48840),P=r(14578),U=r(78318);function ce(n){const a=n.row.original;return e.createElement(s.B,{direction:"row",gap:2,alignItems:"center"},e.createElement(ge,{resource:a}),e.createElement(s.B,{direction:"column",gap:0},a.type==="DATASOURCE"?e.createElement(de,{data:a}):e.createElement(me,{data:a})))}function se(n){if("title"in n&&typeof n.title=="string")return n.title}function de({data:n}){const a=n.refId,o=H(a);return o?e.createElement(e.Fragment,null,e.createElement("span",null,o.name),e.createElement(l.E,{color:"secondary"},o.type)):e.createElement(e.Fragment,null,e.createElement(l.E,null,e.createElement(t.x6,{i18nKey:"migrate-to-cloud.resource-table.unknown-datasource-title"},"Data source ",{datasourceUID:a})),e.createElement(l.E,{color:"secondary"},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.resource-table.unknown-datasource-type"},"Unknown data source")))}function me({data:n}){const a=n.refId,{data:o,isError:i}=(0,E.bM)({uid:a}),c=(0,e.useMemo)(()=>(o?.dashboard&&se(o.dashboard))??a,[o,a]);return i?e.createElement(e.Fragment,null,e.createElement(l.E,{italic:!0},"Unable to load dashboard"),e.createElement(l.E,{color:"secondary"},"Dashboard ",a)):o?e.createElement(e.Fragment,null,e.createElement("span",null,c),e.createElement(l.E,{color:"secondary"},o.meta?.folderTitle??"Dashboards")):e.createElement(ue,null)}function ue(){return e.createElement(e.Fragment,null,e.createElement(M.A,{width:250}),e.createElement(M.A,{width:130}))}function ge({resource:n}){const a=(0,p.of)(Ee),o=H(n.type==="DATASOURCE"?n.refId:void 0);if(n.type==="DASHBOARD")return e.createElement(P.I,{size:"xl",name:"dashboard"});if(n.type==="DATASOURCE"&&o?.meta?.info?.logos?.small)return e.createElement("img",{className:a.icon,src:o.meta.info.logos.small,alt:""});if(n.type==="DATASOURCE")return e.createElement(P.I,{size:"xl",name:"database"})}function Ee(){return{icon:(0,h.css)({display:"block",width:(0,U.cs)("xl"),height:(0,U.cs)("xl")})}}function H(n){return(0,e.useMemo)(()=>{if(n)return D.$.datasources[n]||Object.values(D.$.datasources).find(o=>o.uid===n)},[n])}function fe(n){const{status:a,error:o}=n.row.original;return a==="OK"?e.createElement(l.E,{color:"success"},(0,t.t)("migrate-to-cloud.resource-status.migrated","Uploaded to cloud")):a==="ERROR"?e.createElement(s.B,{alignItems:"center"},e.createElement(l.E,{color:"error"},(0,t.t)("migrate-to-cloud.resource-status.failed","Error")),o&&e.createElement(g.$n,{size:"sm",variant:"secondary",onClick:()=>window.alert(o)},(0,t.t)("migrate-to-cloud.resource-status.error-details-button","Details"))):e.createElement(l.E,{color:"secondary"},(0,t.t)("migrate-to-cloud.resource-status.unknown","Unknown"))}function ye(n){const{type:a}=n.row.original;switch(a){case"DATASOURCE":return(0,t.t)("migrate-to-cloud.resource-type.datasource","Data source");case"DASHBOARD":return(0,t.t)("migrate-to-cloud.resource-type.dashboard","Dashboard");case"FOLDER":return(0,t.t)("migrate-to-cloud.resource-type.folder","Folder");default:return(0,t.t)("migrate-to-cloud.resource-type.unknown","Unknown")}}const he=[{id:"name",header:"Name",cell:ce},{id:"type",header:"Type",cell:ye},{id:"status",header:"Status",cell:fe}];function pe({resources:n}){return e.createElement(le.j,{columns:he,data:n,getRowId:a=>a.refId,pageSize:15})}function ke(){const n=(0,E.Wu)(),a=n.data?.migrations?.at(-1);return{...n,data:a}}function ve(n){const a=(0,E.Yl)(n?{uid:n}:O.hT),o=a.data?.runs?.at(-1),i=(0,E.QZ)(o?.uid&&n?{runUid:o.uid}:O.hT);return{...i,data:i.data,error:a.error||i.error,isError:a.isError||i.isError,isLoading:a.isLoading||i.isLoading,isFetching:a.isFetching||i.isFetching}}const be=()=>{const[n,a]=(0,e.useState)(!1),o=ke(),i=ve(o.data?.uid),[c,d]=(0,E.TH)(),[f,u]=(0,E.Zd)(),v=d.isLoading||o.isFetching||i.isFetching||u.isLoading,b=i.data?.items,x=o.data?.uid,w=(0,e.useCallback)(async()=>{if(!x)return;"error"in await f({uid:x})||a(!1)},[x,f]),K=(0,e.useCallback)(()=>{o.data?.uid&&c({uid:o.data?.uid})},[c,o]),C=o.data;return o.isLoading?e.createElement("div",null,"Loading..."):C?e.createElement(e.Fragment,null,e.createElement(s.B,{direction:"column",gap:4},d.isError&&e.createElement(k.F,{severity:"error",title:(0,t.t)("migrate-to-cloud.summary.run-migration-error-title","There was an error migrating your resources")},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.summary.run-migration-error-description"},"See the Grafana server logs for more details")),u.isError&&e.createElement(k.F,{severity:"error",title:(0,t.t)("migrate-to-cloud.summary.disconnect-error-title","There was an error disconnecting")},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.summary.disconnect-error-description"},"See the Grafana server logs for more details")),C.stack&&e.createElement(y.a,{borderColor:"weak",borderStyle:"solid",padding:2,display:"flex",gap:4,alignItems:"center",justifyContent:"space-between"},e.createElement(ie,{title:(0,t.t)("migrate-to-cloud.summary.target-stack-title","Uploading to"),value:e.createElement(e.Fragment,null,C.stack," ",e.createElement(g.$n,{disabled:v,onClick:()=>a(!0),variant:"secondary",size:"sm",icon:u.isLoading?"spinner":void 0},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.summary.disconnect"},"Disconnect")))}),e.createElement(g.$n,{disabled:v,onClick:K,icon:d.isLoading?"spinner":void 0},e.createElement(t.x6,{i18nKey:"migrate-to-cloud.summary.start-migration"},"Upload everything"))),b&&e.createElement(pe,{resources:b})),e.createElement(J,{isOpen:n,isLoading:u.isLoading,isError:u.isError,onDisconnectConfirm:w,onDismiss:()=>a(!1)})):e.createElement(oe,null)};function xe(){return e.createElement(N.Y,{navId:"migrate-to-cloud"},D.$.cloudMigrationIsTarget?e.createElement(Z,null):e.createElement(be,null))}}}]);

//# sourceMappingURL=MigrateToCloud.2ca16736e0993e8601b6.js.map
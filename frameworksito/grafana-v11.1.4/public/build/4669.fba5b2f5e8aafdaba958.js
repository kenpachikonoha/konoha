(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4669],{29020:(Te,ce,y)=>{"use strict";y.d(ce,{I:()=>K});var D=y(96540),T=y(47433),j=Object.defineProperty,$=Object.defineProperties,H=Object.getOwnPropertyDescriptors,E=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable,w=(Y,le,z)=>le in Y?j(Y,le,{enumerable:!0,configurable:!0,writable:!0,value:z}):Y[le]=z,_=(Y,le)=>{for(var z in le||(le={}))C.call(le,z)&&w(Y,z,le[z]);if(E)for(var z of E(le))V.call(le,z)&&w(Y,z,le[z]);return Y},q=(Y,le)=>$(Y,H(le)),Q=(Y,le)=>{var z={};for(var be in Y)C.call(Y,be)&&le.indexOf(be)<0&&(z[be]=Y[be]);if(Y!=null&&E)for(var be of E(Y))le.indexOf(be)<0&&V.call(Y,be)&&(z[be]=Y[be]);return z};const K=Y=>{var le=Y,{children:z}=le,be=Q(le,["children"]);return D.createElement(T.x,q(_({},be),{kind:"sub-section"}),z)}},6191:(Te,ce,y)=>{"use strict";y.d(ce,{X:()=>$});var D=y(32196),T=y(96540),j=y(40845);const $=({children:E})=>{const C=(0,j.of)(H);return T.createElement("div",{className:C.root},E)},H=E=>({root:(0,D.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:E.spacing(3),minHeight:E.spacing(4)})})},31347:(Te,ce,y)=>{"use strict";y.d(ce,{Z:()=>T});var D=y(96540);const T=({grow:j,shrink:$})=>D.createElement("div",{style:{display:"block",flexGrow:j,flexShrink:$}})},22354:(Te,ce,y)=>{"use strict";y.d(ce,{W:()=>z});var D=y(32196),T=y(96540),j=y(40845),$=y(21594),H=y(4603),E=Object.defineProperty,C=Object.defineProperties,V=Object.getOwnPropertyDescriptors,w=Object.getOwnPropertySymbols,_=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable,Q=(Ie,Ee,ge)=>Ee in Ie?E(Ie,Ee,{enumerable:!0,configurable:!0,writable:!0,value:ge}):Ie[Ee]=ge,K=(Ie,Ee)=>{for(var ge in Ee||(Ee={}))_.call(Ee,ge)&&Q(Ie,ge,Ee[ge]);if(w)for(var ge of w(Ee))q.call(Ee,ge)&&Q(Ie,ge,Ee[ge]);return Ie},Y=(Ie,Ee)=>C(Ie,V(Ee)),le=(Ie,Ee)=>{var ge={};for(var Me in Ie)_.call(Ie,Me)&&Ee.indexOf(Me)<0&&(ge[Me]=Ie[Me]);if(Ie!=null&&w)for(var Me of w(Ie))Ee.indexOf(Me)<0&&q.call(Ie,Me)&&(ge[Me]=Ie[Me]);return ge};function z(Ie){var Ee=Ie,{label:ge}=Ee,Me=le(Ee,["label"]);const Ve=(0,j.of)(Ke),[Xe]=(0,T.useState)(()=>Math.random().toString(16).slice(2)),pr={SelectContainer:be,ValueContainer:Ge,SingleValue:Ge};return T.createElement("div",{className:Ve.root},ge&&T.createElement("label",{className:Ve.label,htmlFor:Xe},ge,":","\xA0"),T.createElement($.l6,Y(K({openMenuOnFocus:!0,inputId:Xe},Me),{components:pr})))}const be=Ie=>{const{children:Ee}=Ie,ge=(0,j.of)(Ke);return T.createElement(H.K,Y(K({},Ie),{className:(0,D.cx)(Ie.className,ge.container)}),Ee)},Ge=Ie=>{const{className:Ee,children:ge}=Ie,Me=(0,j.of)(Ke);return T.createElement("div",{className:(0,D.cx)(Ee,Me.valueContainer)},ge)},Ke=Ie=>({root:(0,D.css)({display:"flex",fontSize:12,alignItems:"center"}),label:(0,D.css)({color:Ie.colors.text.secondary,whiteSpace:"nowrap"}),container:(0,D.css)({background:"none",borderColor:"transparent"}),valueContainer:(0,D.css)({display:"flex",alignItems:"center",flex:"initial",color:Ie.colors.text.secondary,fontSize:12})})},1779:(Te,ce,y)=>{var D=y(48287).Buffer,T=function(){"use strict";function j(K,Y){return Y!=null&&K instanceof Y}var $;try{$=Map}catch{$=function(){}}var H;try{H=Set}catch{H=function(){}}var E;try{E=Promise}catch{E=function(){}}function C(K,Y,le,z,be){typeof Y=="object"&&(le=Y.depth,z=Y.prototype,be=Y.includeNonEnumerable,Y=Y.circular);var Ge=[],Ke=[],Ie=typeof D<"u";typeof Y>"u"&&(Y=!0),typeof le>"u"&&(le=1/0);function Ee(ge,Me){if(ge===null)return null;if(Me===0)return ge;var Ve,Xe;if(typeof ge!="object")return ge;if(j(ge,$))Ve=new $;else if(j(ge,H))Ve=new H;else if(j(ge,E))Ve=new E(function(et,me){ge.then(function(oe){et(Ee(oe,Me-1))},function(oe){me(Ee(oe,Me-1))})});else if(C.__isArray(ge))Ve=[];else if(C.__isRegExp(ge))Ve=new RegExp(ge.source,Q(ge)),ge.lastIndex&&(Ve.lastIndex=ge.lastIndex);else if(C.__isDate(ge))Ve=new Date(ge.getTime());else{if(Ie&&D.isBuffer(ge))return D.allocUnsafe?Ve=D.allocUnsafe(ge.length):Ve=new D(ge.length),ge.copy(Ve),Ve;j(ge,Error)?Ve=Object.create(ge):typeof z>"u"?(Xe=Object.getPrototypeOf(ge),Ve=Object.create(Xe)):(Ve=Object.create(z),Xe=z)}if(Y){var pr=Ge.indexOf(ge);if(pr!=-1)return Ke[pr];Ge.push(ge),Ke.push(Ve)}j(ge,$)&&ge.forEach(function(et,me){var oe=Ee(me,Me-1),pe=Ee(et,Me-1);Ve.set(oe,pe)}),j(ge,H)&&ge.forEach(function(et){var me=Ee(et,Me-1);Ve.add(me)});for(var $e in ge){var Ye;Xe&&(Ye=Object.getOwnPropertyDescriptor(Xe,$e)),!(Ye&&Ye.set==null)&&(Ve[$e]=Ee(ge[$e],Me-1))}if(Object.getOwnPropertySymbols)for(var vr=Object.getOwnPropertySymbols(ge),$e=0;$e<vr.length;$e++){var Jr=vr[$e],Qr=Object.getOwnPropertyDescriptor(ge,Jr);Qr&&!Qr.enumerable&&!be||(Ve[Jr]=Ee(ge[Jr],Me-1),Qr.enumerable||Object.defineProperty(Ve,Jr,{enumerable:!1}))}if(be)for(var gt=Object.getOwnPropertyNames(ge),$e=0;$e<gt.length;$e++){var fr=gt[$e],Qr=Object.getOwnPropertyDescriptor(ge,fr);Qr&&Qr.enumerable||(Ve[fr]=Ee(ge[fr],Me-1),Object.defineProperty(Ve,fr,{enumerable:!1}))}return Ve}return Ee(K,le)}C.clonePrototype=function(Y){if(Y===null)return null;var le=function(){};return le.prototype=Y,new le};function V(K){return Object.prototype.toString.call(K)}C.__objToStr=V;function w(K){return typeof K=="object"&&V(K)==="[object Date]"}C.__isDate=w;function _(K){return typeof K=="object"&&V(K)==="[object Array]"}C.__isArray=_;function q(K){return typeof K=="object"&&V(K)==="[object RegExp]"}C.__isRegExp=q;function Q(K){var Y="";return K.global&&(Y+="g"),K.ignoreCase&&(Y+="i"),K.multiline&&(Y+="m"),Y}return C.__getRegExpFlags=Q,C}();Te.exports&&(Te.exports=T)},84669:(Te,ce,y)=>{"use strict";y.d(ce,{jN:()=>eb,gv:()=>ge,oK:()=>QO,e_:()=>ap,To:()=>Xt,oF:()=>jr,se:()=>YO.s,YW:()=>Dn,nj:()=>nb});var D={};y.r(D),y.d(D,{applyToJS:()=>Po,cleanJSX:()=>jo,deepEqual:()=>Da,deepFreeze:()=>ou,escapeRegExp:()=>tu,getFirstDefined:()=>lu,getLogger:()=>uu,getOpCardinality:()=>Mr,isDirtyJSX:()=>Na,isImmutable:()=>Gn,isJSX:()=>Io,isJsonCompatible:()=>iu,isJsonLogic:()=>lt,logger:()=>vn,mergeArraysSmart:()=>au,mergeCustomizerNoArrays:()=>ca,opDefKeysToOmit:()=>_n,shallowEqual:()=>sa,sleep:()=>nu,toImmutableList:()=>_r,uuid:()=>sr,widgetDefKeysToOmit:()=>En});var T={};y.r(T),y.d(T,{getItemInListValues:()=>fa,getListValue:()=>_a,getTitleInListValues:()=>fu,getValueInListValues:()=>Sp,listValuesToArray:()=>du,makeCustomListValue:()=>Do,mapListValues:()=>No,searchListValue:()=>Fp,toListValue:()=>an});var j={};y.r(j),y.d(j,{_fixImmutableValue:()=>$o,expandTreePath:()=>Fe,expandTreeSubpath:()=>xo,fixEmptyGroupsInTree:()=>Ga,fixPathsInTree:()=>Dt,getFlatTree:()=>ko,getItemByPath:()=>$n,getLightTree:()=>vu,getSwitchValues:()=>gu,getTotalReordableNodesCountInTree:()=>Ep,getTotalRulesCountInTree:()=>Mo,getTreeBadFields:()=>ti,hasChildren:()=>Go,immutableToJs:()=>Po,isEmptyTree:()=>_o,isImmutable:()=>Gn,jsToImmutable:()=>pa,removeIsLockedInTree:()=>pu,toImmutableList:()=>_r});var $={};y.r($),y.d($,{SqlString:()=>gn,mongoEmptyValue:()=>wu,spelEscape:()=>Bn,spelFixList:()=>Ru,spelFormatConcat:()=>Up,spelImportConcat:()=>Bp,sqlEmptyValue:()=>Lu,stringifyForDisplay:()=>Pu});var H={};y.r(H),y.d(H,{_loadFromJsonLogic:()=>Fu,_loadFromSpel:()=>qu,checkTree:()=>ni,getTree:()=>Cp,isImmutableTree:()=>mu,isJsonLogic:()=>lt,isTree:()=>hu,isValidTree:()=>ri,jsToImmutable:()=>pa,loadFromJsonLogic:()=>wp,loadFromSpel:()=>ev,loadTree:()=>Uo});var E={};y.r(E),y.d(E,{createListFromArray:()=>gv,defaultConjunction:()=>Kt,defaultGroupConjunction:()=>Ua,defaultGroupProperties:()=>mn,defaultItemProperties:()=>tl,defaultOperatorOptions:()=>ga,defaultRoot:()=>vv,defaultRule:()=>nl,defaultRuleProperties:()=>Wt,emptyProperties:()=>mv,getDefaultField:()=>el,getDefaultFieldSrc:()=>Qo,getDefaultOperator:()=>Yo,getDefaultSubField:()=>rl});var C={};y.r(C),y.d(C,{_validateTree:()=>ma,checkTree:()=>ni,getNewValueForFieldOp:()=>Tn,getTreeBadFields:()=>ti,isValidTree:()=>ri,sanitizeTree:()=>ql,translateValidation:()=>Nt,validateAndFixTree:()=>Jl,validateRange:()=>ai,validateTree:()=>zl,validateValue:()=>Hn});var V={};y.r(V),y.d(V,{completeFuncValue:()=>Zl,getCompatibleArgsOnFuncChange:()=>ns,setArgValue:()=>ii,setArgValueSrc:()=>ts,setFunc:()=>es,setFuncDefaultArg:()=>Wa});var w={};y.r(w),y.d(w,{calculateValueType:()=>os,completeValue:()=>Ln,filterValueSourcesForField:()=>An,formatFieldName:()=>un,getFieldPartsConfigs:()=>is,getFieldPathLabels:()=>ha,getFirstOperator:()=>ui,getFuncPathLabels:()=>Vv,getOperatorsForField:()=>Ha,getOperatorsForType:()=>as,getValueLabel:()=>Dv,getValueSourcesForFieldOp:()=>us,getWidgetForFieldOp:()=>Tr,getWidgetsForFieldOp:()=>Nv,isEmptyGroupChildren:()=>ci,isEmptyItem:()=>si,isEmptyRuleGroupExtPropertiesAndChildren:()=>ls,isEmptyRuleProperties:()=>di,selectTypes:()=>Ka,whatRulePropertiesAreCompleted:()=>fi});var _={};y.r(_),y.d(_,{_widgetDefKeysToOmit:()=>og,applyJsonLogic:()=>$v,cleanJSX:()=>jo,compileConfig:()=>bs,compressConfig:()=>ys,configKeys:()=>qa,decompressConfig:()=>Os,extendConfig:()=>xt,getFieldConfig:()=>Re,getFieldParts:()=>Vr,getFieldPath:()=>Oi,getFieldPathParts:()=>ig,getFieldRawConfig:()=>kt,getFieldSrc:()=>ws,getFieldWidgetConfig:()=>rt,getFirstField:()=>Rs,getFuncArgConfig:()=>yi,getFuncConfig:()=>Gr,getFuncSignature:()=>hi,getOperatorConfig:()=>cr,isDirtyJSX:()=>Na,isFieldDescendantOfField:()=>Ls,isJSX:()=>Io,iterateFields:()=>As,iterateFuncs:()=>Qn,normalizeField:()=>Qa});var q={};y.r(q),y.d(q,{_mongodbFormat:()=>Ks,_spelFormat:()=>xu,_sqlFormat:()=>Qs,elasticSearchFormat:()=>nc,jsonLogicFormat:()=>dg,mongodbFormat:()=>hg,queryBuilderFormat:()=>ug,queryString:()=>ll,spelFormat:()=>Hp,sqlFormat:()=>Eg});var Q={};y.r(Q),y.d(Q,{fixListValuesGroupOrder:()=>zg,getListValue:()=>_a,listValueToOption:()=>Hg,mergeListValues:()=>Bg,optionToListValue:()=>Wg,optionsToListValues:()=>Kg,simulateAsyncFetch:()=>Ug});var K={};y.r(K),y.d(K,{Autocomplete:()=>Q,ConfigUtils:()=>_,DefaultUtils:()=>E,ExportUtils:()=>$,FuncUtils:()=>V,ListUtils:()=>T,OtherUtils:()=>D,RuleUtils:()=>w,TreeUtils:()=>j,Validation:()=>C,checkTree:()=>ni,clone:()=>Rt(),compressConfig:()=>ys,decompressConfig:()=>Os,getSwitchValues:()=>gu,i18n:()=>Tv,isValidTree:()=>ri,moment:()=>Un(),sanitizeTree:()=>ql,uuid:()=>sr,validateAndFixTree:()=>Jl,validateTree:()=>zl});var Y={};y.r(Y),y.d(Y,{LINEAR_REGRESSION:()=>Xg,LOWER:()=>Qg,NOW:()=>qg,RELATIVE_DATETIME:()=>Jg,UPPER:()=>Yg});var le={};y.r(le),y.d(le,{addCaseGroup:()=>Mm,addDefaultCaseGroup:()=>km,addGroup:()=>_m,addRule:()=>Nm,moveItem:()=>$m,removeGroup:()=>Gm,removeRule:()=>xm,setTree:()=>Dm});var z={};y.r(z),y.d(z,{setConjunction:()=>Um,setLock:()=>Wm,setNot:()=>Bm});var be={};y.r(be),y.d(be,{setField:()=>Km,setFieldSrc:()=>Hm,setFuncValue:()=>Qm,setOperator:()=>zm,setOperatorOption:()=>Ym,setValue:()=>qm,setValueSrc:()=>Jm});var Ge={};y.r(Ge),y.d(Ge,{bindActionCreators:()=>nd,isUsingLegacyReactDomRender:()=>td,liteShouldComponentUpdate:()=>ki,pureShouldComponentUpdate:()=>ea,useOnPropsChanged:()=>Xr});var Ke={};y.r(Ke),y.d(Ke,{FuncWidget:()=>Hi,ValueFieldWidget:()=>$f,VanillaBooleanWidget:()=>X0,VanillaButton:()=>pO,VanillaButtonGroup:()=>gO,VanillaConjs:()=>dO,VanillaDateTimeWidget:()=>nO,VanillaDateWidget:()=>rO,VanillaFieldSelect:()=>cO,VanillaIcon:()=>vO,VanillaMultiSelectWidget:()=>oO,VanillaNumberWidget:()=>lO,VanillaProvider:()=>OO,VanillaSelectWidget:()=>uO,VanillaSliderWidget:()=>sO,VanillaSwitch:()=>hO,VanillaTextAreaWidget:()=>eO,VanillaTextWidget:()=>Z0,VanillaTimeWidget:()=>tO,VanillaValueSources:()=>mO,vanillaConfirm:()=>yO});var Ie={};y.r(Ie),y.d(Ie,{ProximityOperator:()=>Yi});var Ee=y(50877),ge=(n=>(n.Timeseries="time_series",n.Table="table",n))(ge||{});const Me=[{label:"Time series",value:"time_series"},{label:"Table",value:"table"}],Ve=n=>({label:n,value:n}),Xe=Ee.z??Ve;var pr=y(13288),$e=y(75505),Ye=y(81160),vr=y(41987),Jr=y(92053),Qr=y(43127),gt=y(78368),fr=y(98765),et=y(26657),me=y(72574),oe=y(14110),pe=y(17172),De=y(47773),xe=y(2543);class ae{transformMetricFindResponse(e){const t=[],r=e.fields.find(o=>o.name==="__text"),a=e.fields.find(o=>o.name==="__value");if(r&&a)for(let o=0;o<r.values.length;o++)t.push({text:""+r.values[o],value:""+a.values[o]});else for(const o of e.fields)for(const u of o.values)t.push({text:u});return(0,xe.uniqBy)(t,"text")}}var m=y(96540),Le=y(16817),er=y(68402),ot=(n=>(n.String="string",n))(ot||{}),Rr=(n=>(n.Property="property",n.Operator="operator",n.Or="or",n.And="and",n.GroupBy="groupBy",n.Function="function",n.FunctionParameter="functionParameter",n))(Rr||{});function jr(n){return`SELECT ${n.map(t=>{let r="";return t.name&&t.alias?r+=`${t.name}(${t.parameters?.map(a=>`${a.name}`)}) AS ${t.alias}`:t.name?r+=`${t.name}(${t.parameters?.map(a=>`${a.name}`)})`:t.alias?r+=`${t.parameters?.map(a=>`${a.name}`)} AS ${t.alias}`:r+=`${t.parameters?.map(a=>`${a.name}`)}`,r}).join(", ")} `}const Dn=n=>{if(!n)return!1;const e=n.some(r=>r.parameters?.length||r.parameters?.some(a=>a.name)),t=n.some(r=>r.name);return e||t};function Lt(n){return{type:Rr.GroupBy,property:{type:ot.String,name:n}}}function mo(n){return{type:Rr.Property,property:{type:ot.String,name:n}}}function Nn(n){return{type:Rr.Function,name:n,parameters:[]}}function Xt(n){let e=n?.editorMode||fr.lX.Builder;return n?.editorMode===void 0&&n?.rawSql!==void 0&&(e=fr.lX.Code),{...n,refId:n?.refId||"A",format:n?.format!==void 0?n.format:ge.Table,rawSql:n?.rawSql||"",editorMode:e,sql:n?.sql??{columns:[Nn()],groupBy:[Lt()],limit:50}}}var bn=y(73287),it=y(13544),Zt=y(6191),ho=y(22354),yo=y(31347),Ir=y(9e4),mt=y(81580),fn=y(15292),Vt=y(55852),en=y(56034),ia=y(94354),xn=y(37390),wt=y(14578);function Oo({isOpen:n,onCancel:e,onDiscard:t,onCopy:r}){const a=(0,m.useRef)(null);return(0,m.useEffect)(()=>{n&&a.current?.focus()},[n]),m.createElement(xn.a,{title:m.createElement("div",{className:"modal-header-title"},m.createElement(wt.I,{name:"exclamation-triangle",size:"lg"}),m.createElement("span",{className:"p-l-1"},"Warning")),onDismiss:e,isOpen:n},m.createElement("p",null,"Builder mode does not display changes made in code. The query builder will display the last changes you made in builder mode."),m.createElement("p",null,"Do you want to copy your code to the clipboard?"),m.createElement(xn.a.ButtonRow,null,m.createElement(Vt.$n,{type:"button",variant:"secondary",onClick:e,fill:"outline"},"Cancel"),m.createElement(Vt.$n,{variant:"destructive",type:"button",onClick:t,ref:a},"Discard code and switch"),m.createElement(Vt.$n,{variant:"primary",onClick:r},"Copy code and switch")))}var ht=y(21594),rn=y(32264);const kn=()=>!!rn.$.featureToggles.sqlDatasourceDatabaseSelection,Ca=({dataset:n,db:e,dialect:t,onChange:r,inputId:a,preconfiguredDataset:o})=>{const u=!!o||t==="postgres",i=(0,Le.A)(async()=>kn()&&u?(r(Xe(o)),[Xe(o)]):(n&&r(Xe(n)),(await e.datasets()).map(Xe)),[]);return(0,m.useEffect)(()=>{kn()||(n?i.value&&i.value.find(l=>l.value===n)===void 0&&i.value.length>0&&r(i.value[0]):i.value&&i.value[0]&&r(i.value[0]))},[i.value,r,n]),m.createElement(ht.l6,{"aria-label":"Dataset selector",inputId:a,value:n,options:i.value,onChange:r,disabled:i.loading,isLoading:i.loading,menuShouldPortal:!0})},Ta=({db:n,dataset:e,table:t,className:r,onChange:a,inputId:o})=>{const u=(0,Le.A)(async()=>e?(await n.tables(e)).map(Ee.z):[],[e]);return m.createElement(ht.l6,{className:r,disabled:u.loading,"aria-label":"Table selector",inputId:o,"data-testid":it.Tp.components.SQLQueryEditor.headerTableSelector,value:t,options:u.value,onChange:a,isLoading:u.loading,menuShouldPortal:!0,placeholder:u.loading?"Loading tables":"Select table"})},bo=[{label:"Builder",value:fr.lX.Builder},{label:"Code",value:fr.lX.Code}];function Aa({db:n,dialect:e,isQueryRunnable:t,onChange:r,onQueryRowChange:a,onRunQuery:o,preconfiguredDataset:u,query:i,queryRowFilter:l}){const{editorMode:s}=i,[c,d]=(0,bn.A)(),[f,p]=(0,m.useState)(!1),v=n.toRawSql,g=(0,m.useId)(),h=(0,m.useCallback)(L=>{if(L===fr.lX.Code&&(0,oe.rR)("grafana_sql_editor_mode_changed",{datasource:i.datasource?.type,selectedEditorMode:fr.lX.Code}),s===fr.lX.Code){p(!0);return}r({...i,editorMode:L})},[s,r,i]),b=L=>{const F={...i,format:L.value!==void 0?L.value:ge.Table};(0,oe.rR)("grafana_sql_format_changed",{datasource:i.datasource?.type,selectedFormat:F.format}),r(F)},O=L=>{if(L.value===i.dataset)return;const F={...i,dataset:L.value,table:void 0,sql:void 0,rawSql:""};r(F)},S=L=>{if(L.value===i.table)return;const F={...i,table:L.value,sql:void 0,rawSql:""};r(F)},A=()=>!(e==="influx"||!kn()&&e==="postgres");return m.createElement(m.Fragment,null,m.createElement(Zt.X,null,m.createElement(ho.W,{label:"Format",value:i.format,placeholder:"Select format",menuShouldPortal:!0,onChange:b,options:Me}),s===fr.lX.Builder&&m.createElement(m.Fragment,null,m.createElement(fn.K,{id:`sql-filter-${g}`,label:"Filter","data-testid":it.Tp.components.SQLQueryEditor.headerFilterSwitch,transparent:!0,showLabel:!0,value:l.filter,onChange:L=>{L.target instanceof HTMLInputElement&&((0,oe.rR)("grafana_sql_filter_toggled",{datasource:i.datasource?.type,displayed:L.target.checked}),a({...l,filter:L.target.checked}))}}),m.createElement(fn.K,{id:`sql-group-${g}`,label:"Group","data-testid":it.Tp.components.SQLQueryEditor.headerGroupSwitch,transparent:!0,showLabel:!0,value:l.group,onChange:L=>{L.target instanceof HTMLInputElement&&((0,oe.rR)("grafana_sql_group_toggled",{datasource:i.datasource?.type,displayed:L.target.checked}),a({...l,group:L.target.checked}))}}),m.createElement(fn.K,{id:`sql-order-${g}`,label:"Order","data-testid":it.Tp.components.SQLQueryEditor.headerOrderSwitch,transparent:!0,showLabel:!0,value:l.order,onChange:L=>{L.target instanceof HTMLInputElement&&((0,oe.rR)("grafana_sql_order_toggled",{datasource:i.datasource?.type,displayed:L.target.checked}),a({...l,order:L.target.checked}))}}),m.createElement(fn.K,{id:`sql-preview-${g}`,label:"Preview","data-testid":it.Tp.components.SQLQueryEditor.headerPreviewSwitch,transparent:!0,showLabel:!0,value:l.preview,onChange:L=>{L.target instanceof HTMLInputElement&&((0,oe.rR)("grafana_sql_preview_toggled",{datasource:i.datasource?.type,displayed:L.target.checked}),a({...l,preview:L.target.checked}))}})),m.createElement(yo.Z,{grow:1}),t?m.createElement(Vt.$n,{icon:"play",variant:"primary",size:"sm",onClick:()=>o()},"Run query"):m.createElement(en.m,{theme:"error",content:m.createElement(m.Fragment,null,"Your query is invalid. Check below for details. ",m.createElement("br",null),"However, you can still run this query."),placement:"top"},m.createElement(Vt.$n,{icon:"exclamation-triangle",variant:"secondary",size:"sm",onClick:()=>o()},"Run query")),m.createElement(ia.z,{options:bo,size:"sm",value:s,onChange:h}),m.createElement(Oo,{isOpen:f,onCopy:()=>{(0,oe.rR)("grafana_sql_editor_mode_changed",{datasource:i.datasource?.type,selectedEditorMode:fr.lX.Builder,type:"copy"}),p(!1),d(i.rawSql),r({...i,rawSql:v(i),editorMode:fr.lX.Builder})},onDiscard:()=>{(0,oe.rR)("grafana_sql_editor_mode_changed",{datasource:i.datasource?.type,selectedEditorMode:fr.lX.Builder,type:"discard"}),p(!1),r({...i,rawSql:v(i),editorMode:fr.lX.Builder})},onCancel:()=>{(0,oe.rR)("grafana_sql_editor_mode_changed",{datasource:i.datasource?.type,selectedEditorMode:fr.lX.Builder,type:"cancel"}),p(!1)}})),s===fr.lX.Builder&&m.createElement(m.Fragment,null,m.createElement(er.$,{v:.5}),m.createElement(Ir.U,null,A()&&m.createElement(mt.c,{label:"Dataset",width:25},m.createElement(Ca,{db:n,inputId:`sql-dataset-${g}`,dataset:i.dataset,dialect:e,preconfiguredDataset:u,onChange:O})),m.createElement(mt.c,{label:"Table",width:25},m.createElement(Ta,{db:n,inputId:`sql-tableselect-${g}`,dataset:i.dataset||u,table:i.table,onChange:S})))))}var yt=y(32196),La=y(49185),So=y(70713),Sn=y(40845),Fo=y(6867);function wa({children:n,onChange:e,query:t,width:r,height:a,editorLanguageDefinition:o}){const u=(0,m.useRef)(t);(0,m.useEffect)(()=>{u.current=t},[t]);const i=(0,m.useCallback)((l,s)=>{const c={...u.current,rawQuery:!0,rawSql:l};e(c,s)},[e]);return m.createElement(Fo.Y,{width:r,height:a,query:t.rawSql,onChange:i,language:o},n)}var Ra=y(66864),ua=y(29158),Pa=y(41053),ja=y(75198),Ia=y(83195),Va=y(62930);function Eo({db:n,query:e,onValidate:t,range:r}){const[a,o]=(0,m.useState)(),u=(0,Sn.$j)(),i=(0,m.useMemo)(()=>(0,Ia.j_)("bytes"),[]),l=(0,m.useMemo)(()=>({error:(0,yt.css)({color:u.colors.error.text,fontSize:u.typography.bodySmall.fontSize,fontFamily:u.typography.fontFamilyMonospace}),valid:(0,yt.css)({color:u.colors.success.text}),info:(0,yt.css)({color:u.colors.text.secondary})}),[u]),[s,c]=(0,Pa.A)(async f=>f.rawSql?.trim()===""?null:await n.validateQuery(f,r),[n]),[,]=(0,ja.A)(async()=>{const f=await c(e);return f&&o(f),null},1e3,[e,c]);if((0,m.useEffect)(()=>{a?.isError&&t(!1),a?.isValid&&t(!0)},[a,t]),!s.value&&!s.loading)return null;const d=s.value?.error?Sr(s.value.error):"";return m.createElement(m.Fragment,null,s.loading&&m.createElement("div",{className:l.info},m.createElement(Va.y,{inline:!0,size:"xs"})," Validating query..."),!s.loading&&s.value&&m.createElement(m.Fragment,null,m.createElement(m.Fragment,null,s.value.isValid&&s.value.statistics&&m.createElement("div",{className:l.valid},m.createElement(wt.I,{name:"check"})," This query will process"," ",m.createElement("strong",null,(0,Ia.cN)(i(s.value.statistics.TotalBytesProcessed)))," ","when run.")),m.createElement(m.Fragment,null,s.value.isError&&m.createElement("div",{className:l.error},d))))}function Sr(n){const e=n.split(":");return e.length>2?e.slice(2).join(":"):n}function Ot({showTools:n,onFormatCode:e,onExpand:t,isExpanded:r,...a}){const o=(0,Sn.$j)(),[u,i]=(0,m.useState)(),l=(0,m.useMemo)(()=>({container:(0,yt.css)({border:`1px solid ${o.colors.border.medium}`,borderTop:"none",padding:o.spacing(.5,.5,.5,.5),display:"flex",flexGrow:1,justifyContent:"space-between",fontSize:o.typography.bodySmall.fontSize}),error:(0,yt.css)({color:o.colors.error.text,fontSize:o.typography.bodySmall.fontSize,fontFamily:o.typography.fontFamilyMonospace}),valid:(0,yt.css)({color:o.colors.success.text}),info:(0,yt.css)({color:o.colors.text.secondary}),hint:(0,yt.css)({color:o.colors.text.disabled,whiteSpace:"nowrap",cursor:"help"})}),[o]);let s={};return!n&&u===void 0&&(s={height:0,padding:0,visibility:"hidden"}),m.createElement("div",{className:l.container,style:s},m.createElement("div",null,a.onValidate&&m.createElement(Eo,{...a,onValidate:c=>{i(c),a.onValidate(c)}})),n&&m.createElement("div",null,m.createElement(Ra.Gy,{spacing:"sm"},e&&m.createElement(ua.K,{onClick:()=>{(0,oe.rR)("grafana_sql_query_formatted",{datasource:a.query.datasource?.type}),e()},name:"brackets-curly",size:"xs",tooltip:"Format query"}),t&&m.createElement(ua.K,{onClick:()=>{(0,oe.rR)("grafana_sql_editor_expand",{datasource:a.query.datasource?.type,expanded:!r}),t(!r)},name:r?"angle-up":"angle-down",size:"xs",tooltip:r?"Collapse editor":"Expand editor"}),m.createElement(en.m,{content:"Hit CTRL/CMD+Return to run query"},m.createElement(wt.I,{className:l.hint,name:"keyboard"})))))}function Co({db:n,query:e,onChange:t,onRunQuery:r,onValidate:a,queryToValidate:o,range:u}){const i=(0,Sn.$j)(),l=(0,Sn.of)(To),[s,c]=(0,m.useState)(!1),[d,f]=(0,La.A)(),[p,v]=(0,La.A)(),g=(0,m.useMemo)(()=>n.getEditorLanguageDefinition(),[n]),h=(S,A)=>m.createElement(wa,{editorLanguageDefinition:g,query:e,width:S,height:A?A-f.height:void 0,onChange:t},({formatQuery:L})=>m.createElement("div",{ref:d},m.createElement(Ot,{db:n,query:o,onValidate:a,onFormatCode:L,showTools:!0,range:u,onExpand:c,isExpanded:s}))),b=(S=!1)=>S?m.createElement(So.Ay,null,({width:A,height:L})=>h(A,L)):m.createElement("div",{ref:p},h()),O=()=>m.createElement("div",{style:{width:v.width,height:v.height,background:i.colors.background.primary,display:"flex",alignItems:"center",justifyContent:"center"}},"Editing in expanded code editor");return m.createElement(m.Fragment,null,s?O():b(),s&&m.createElement(xn.a,{title:`Query ${e.refId}`,closeOnBackdropClick:!1,closeOnEscape:!1,className:l.modal,contentClassName:l.modalContent,isOpen:s,onDismiss:()=>{(0,oe.rR)("grafana_sql_editor_expand",{datasource:e.datasource?.type,expanded:!1}),c(!1)}},b(!0)))}function To(n){return{modal:(0,yt.css)({width:"95vw",height:"95vh"}),modalContent:(0,yt.css)({height:"100%",paddingTop:0})}}var Ao=y(71087),Dr=y(11807);function Lr({query:n,onQueryChange:e,db:t}){return{onSqlChange:(0,m.useCallback)(a=>{const o=t.toRawSql,u=o({sql:a,dataset:n.dataset,table:n.table,refId:n.refId}),i={...n,sql:a,rawSql:u};e(i)},[t,e,n])}}var dt=y(85269),tn=y(81392),Fn=y(3721);function Lo({sql:n,columns:e,onSqlChange:t}){const r=(0,m.useCallback)(a=>{const o=a.map(i=>Lt(i.property?.name)),u={...n,groupBy:o};t(u)},[t,n]);return m.createElement(dt.o,{items:n.groupBy,onChange:r,renderItem:pn({options:e})})}function pn({options:n}){return function(t,r,a){return m.createElement(tn.M,null,m.createElement(ht.l6,{value:t.property?.name?(0,Ee.z)(t.property.name):null,"aria-label":"Group by",options:n,menuShouldPortal:!0,onChange:({value:o})=>o&&r(Lt(o))}),m.createElement(Fn.Z,{title:"Remove group by column",icon:"times",variant:"secondary",onClick:a}))}}function Or({fields:n,query:e,onQueryChange:t,db:r}){const{onSqlChange:a}=Lr({query:e,onQueryChange:t,db:r});return m.createElement(Lo,{columns:n,sql:e.sql,onSqlChange:a})}var gr=y(10354);const Yr=[{description:"Sort by ascending",value:"ASC",icon:"sort-amount-up"},{description:"Sort by descending",value:"DESC",icon:"sort-amount-down"}];function wo({sql:n,onSqlChange:e,columns:t,showOffset:r}){const a=(0,m.useCallback)(l=>{const s={...n,orderByDirection:l};e(s)},[e,n]),o=(0,m.useCallback)(l=>{const s={...n,limit:Number.parseInt(l.currentTarget.value,10)};e(s)},[e,n]),u=(0,m.useCallback)(l=>{const s={...n,offset:Number.parseInt(l.currentTarget.value,10)};e(s)},[e,n]),i=(0,m.useCallback)(l=>{const s={...n,orderBy:mo(l?.value)};l===null&&(s.orderByDirection=void 0),e(s)},[e,n]);return m.createElement(m.Fragment,null,m.createElement(mt.c,{label:"Order by",width:25},m.createElement(tn.M,null,m.createElement(ht.l6,{"aria-label":"Order by",options:t,value:n.orderBy?.property.name?(0,Ee.z)(n.orderBy.property.name):null,isClearable:!0,menuShouldPortal:!0,onChange:i}),m.createElement(er.$,{h:1.5}),m.createElement(ia.z,{options:Yr,disabled:!n?.orderBy?.property.name,value:n.orderByDirection,onChange:a}))),m.createElement(mt.c,{label:"Limit",optional:!0,width:25},m.createElement(gr.p,{type:"number",min:0,id:(0,xe.uniqueId)("limit-"),value:n.limit||"",onChange:o})),r&&m.createElement(mt.c,{label:"Offset",optional:!0,width:25},m.createElement(gr.p,{type:"number",id:(0,xe.uniqueId)("offset-"),value:n.offset||"",onChange:u})))}function Mn({fields:n,query:e,onQueryChange:t,db:r}){const{onSqlChange:a}=Lr({query:e,onQueryChange:t,db:r});let o=[];return n&&(o=[{value:"",label:"Selected columns",options:e.sql?.columns?.map((i,l)=>{const s=i.name?`${i.name}(${i.parameters?.map(c=>c.name)})`:i.parameters?.map(c=>c.name);return{value:s,label:`${l+1} - ${s}`}}),expanded:!0},...n]),m.createElement(wo,{sql:e.sql,onSqlChange:a,columns:o})}const Ro=["AVG","COUNT","MAX","MIN","SUM"],la=["$__time","$__timeEpoch","$__timeFilter","$__timeFrom","$__timeTo","$__timeGroup","$__timeGroupAlias","$__unixEpochFilter","$__unixEpochNanoFilter","$__unixEpochNanoFrom","$__unixEpochNanoTo","$__unixEpochGroup","$__unixEpochGroupAlias"];var ke=y(46819);const ft={label:"*",value:"*"};function M({sql:n,format:e,columns:t,onSqlChange:r,functions:a}){const o=(0,Sn.of)(Z),u=[ft,...t||[]],i=[];e===ge.Timeseries&&(i.push({label:"time",value:"time"}),i.push({label:"value",value:"value"}));const l=(0,m.useCallback)((p,v)=>g=>{let h={...p};p.parameters?.length?h.parameters=p.parameters.map(O=>O.type===Rr.FunctionParameter?{...O,name:g.value}:O):h.parameters=[{type:Rr.FunctionParameter,name:g.value}];const b={...n,columns:n.columns?.map((O,S)=>S===v?h:O)};r(b)},[r,n]),s=(0,m.useCallback)((p,v)=>g=>{const h={...p,name:g?.value},b={...n,columns:n.columns?.map((O,S)=>S===v?h:O)};r(b)},[r,n]),c=(0,m.useCallback)((p,v)=>g=>{let h={...p};g!==null?h={...p,alias:`"${g?.value?.trim()}"`}:delete h.alias;const b={...n,columns:n.columns?.map((O,S)=>S===v?h:O)};r(b)},[r,n]),d=(0,m.useCallback)(p=>()=>{const v=[...n.columns];v.splice(p,1);const g={...n,columns:v};r(g)},[r,n]),f=(0,m.useCallback)(()=>{const p={...n,columns:[...n.columns,Nn()]};r(p)},[r,n]);return m.createElement(ke.B,{gap:2,wrap:!0,direction:"column"},n.columns?.map((p,v)=>m.createElement("div",{key:v},m.createElement(ke.B,{gap:2,alignItems:"end"},m.createElement(mt.c,{label:"Column",width:25},m.createElement(ht.l6,{value:Oe(p),"data-testid":it.Tp.components.SQLQueryEditor.selectColumn,options:u,inputId:`select-column-${v}-${(0,xe.uniqueId)()}`,menuShouldPortal:!0,allowCustomValue:!0,onChange:l(p,v)})),m.createElement(mt.c,{label:"Aggregation",optional:!0,width:25},m.createElement(ht.l6,{value:p.name?(0,Ee.z)(p.name):null,inputId:`select-aggregation-${v}-${(0,xe.uniqueId)()}`,"data-testid":it.Tp.components.SQLQueryEditor.selectAggregation,isClearable:!0,menuShouldPortal:!0,allowCustomValue:!0,options:a,onChange:s(p,v)})),m.createElement(mt.c,{label:"Alias",optional:!0,width:15},m.createElement(ht.l6,{value:p.alias?(0,Ee.z)(p.alias):null,inputId:`select-alias-${v}-${(0,xe.uniqueId)()}`,"data-testid":it.Tp.components.SQLQueryEditor.selectAlias,options:i,onChange:c(p,v),isClearable:!0,menuShouldPortal:!0,allowCustomValue:!0})),m.createElement(Vt.$n,{title:"Remove column",type:"button",icon:"trash-alt",variant:"secondary",size:"md",onClick:d(v)})))),m.createElement(Vt.$n,{type:"button",onClick:f,variant:"secondary",title:"Add column",size:"md",icon:"plus",className:o.addButton}))}const Z=()=>({addButton:(0,yt.css)({alignSelf:"flex-start"})});function Oe({parameters:n}){const e=n?.find(t=>t.type===Rr.FunctionParameter);return e?.name?(0,Ee.z)(e.name):null}function He({fields:n,query:e,onQueryChange:t,db:r}){const{onSqlChange:a}=Lr({query:e,onQueryChange:t,db:r}),o=[...Ro,...r.functions?.()||[]].map(Ee.z);return m.createElement(M,{columns:n,sql:e.sql,format:e.format,functions:o,onSqlChange:a})}var ut=y(24705),ze=y(23029),mr=y(92901),br=y(56822),Ae=y(53954),hr=y(85501),re=y(64467),Se=y(60436),we=y(5544),Fr=y(82284),ye=y(49568),sp=y(90179),Er=y.n(sp),cp=0;const sr=function(){var n=(new Date().getTime().toString(16)+"FF").substr(0,11),e="ssssssss-xxxx-4xxx-yxxx-x".replace(/[xys]/g,function(t){var r=t==="s"?Math.floor(Math.random()*16):cp++&15,a=t==="x"?r:r&3|8;return a.toString(16)});return e+n};var ru=function(e){return(0,Fr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},En=["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue","spelImportFuncs","spelImportValue"],_n=["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"],Mr=function(e){var t;return(t=e?.cardinality)!==null&&t!==void 0?t:1},Da=function(e,t){return e===t?!0:ye.Map.isMap(e)?e.equals(t):JSON.stringify(e)==JSON.stringify(t)},sa=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e===t?!0:Array.isArray(e)?dp(e,t,r):ye.Map.isMap(e)?e.equals(t):(0,Fr.A)(e)=="object"?fp(e,t,r):e===t};function dp(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=n.length;if(e.length!==r)return!1;for(var a=0;a<r;a++){var o=t?sa(n[a],e[a],t):n[a]===e[a];if(!o)return!1}return!0}function fp(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=Object.keys(n),a=Object.keys(e),o=r.length;if(a.length!==o)return!1;for(var u=0;u<o;u++){var i=r[u],l=t?sa(n[i],e[i],t):n[i]===e[i];if(!l)return!1}return!0}var Gn=function(e){return(0,Fr.A)(e)==="object"&&e!==null&&typeof e.toJS=="function"};function _r(n){return Gn(n)?n:new ye.default.List(n)}function Po(n){return Gn(n)?n.toJS():n}var tu=function(e){return e.replace(/[.*+?^${}()|[\]\\/]/g,"\\$&")},ca=function(e,t,r,a,o,u){if(Array.isArray(e))return t},jo=function n(e){var t=["$$typeof","_owner","_store","ref","key"],r=function(i){return typeof i=="string"?i:typeof i=="function"?i.name:i};if(e instanceof Array)return e.map(function(u,i){return n(u)});if((0,Fr.A)(e)==="object"&&e!==null&&Na(e)){var a,o=Er()(e,t);return o.type&&(o.type=r(o.type)),o!=null&&(a=o.props)!==null&&a!==void 0&&a.children&&(o.props.children=n(o.props.children)),o}return e},Na=function(e){return(0,Fr.A)(e)==="object"&&e!==null&&!Array.isArray(e)&&Object.keys(e).includes("type")&&Object.keys(e).includes("props")&&Object.keys(e).includes("key")&&Object.keys(e).includes("ref")&&Object.keys(e).includes("$$typeof")},Io=function(e){return(0,Fr.A)(e)==="object"&&e!==null&&!Array.isArray(e)&&typeof e.type=="string"&&Object.keys(e).includes("props")},lt=function(e){var t=(0,Fr.A)(e)==="object"&&e!==null&&!Array.isArray(e)&&Object.keys(e).length===1;return t};function nu(n){return new Promise(function(e){setTimeout(e,n)})}function au(n,e){return n||(n=[]),e||(e=[]),e.map(function(t){return[t,n.indexOf(t)]}).map(function(t,r,a){var o=(0,we.A)(t,2),u=o[0],i=o[1];if(i==-1){var l=a.slice(r+1),s=a.slice(0,r),c=s.reverse().find(function(f){var p=(0,we.A)(f,2),v=p[0],g=p[1];return g!=-1}),d=l.find(function(f){var p=(0,we.A)(f,2),v=p[0],g=p[1];return g!=-1});return d?[u,"before",d[0]]:c?[u,"after",c[0]]:[u,"append",null]}else return null}).filter(function(t){return t!==null}).reduce(function(t,r){var a=(0,we.A)(r,3),o=a[0],u=a[1],i=a[2],l=t.indexOf(i);return t.indexOf(o)==-1&&(l>-1?t.splice(l+(u=="after"?1:0),0,o):t.splice(u=="append"?1/0:0,0,o)),t},n.slice())}var ou=function n(e){(0,Fr.A)(e)==="object"&&e!==null&&(Object.keys(e).forEach(function(t){n(e[t])}),Object.freeze(e))},iu=function n(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(ru(e)){if(e.var)return r[e.var]=t,!0;if(!ru(t))return!1;for(var o in e){var u=e[o],i=t[o];if(!n(u,i,r,[].concat((0,Se.A)(a),[o])))return!1}return!0}else if(Array.isArray(e)){if(!Array.isArray(t))return!1;for(var l=0;l<e.length;l++){var s=e[l],c=t[l];if(!n(s,c,r,[].concat((0,Se.A)(a),[l])))return!1}return!0}else return e===t},pp=function(){return typeof process<"u"&&process.env&&!1},uu=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=e??pp();return t?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},lu=function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t,r=0;r<e.length;r++){var a=e[r];if(a!==void 0){t=a;break}}return t},vn=uu(),vp=y(54756),nn=y.n(vp),gp=y(55364),da=y.n(gp),mp=y(44383),Ut=y.n(mp),hp=y(6924),xa=y.n(hp),yp=y(68090),ka=y.n(yp);function Op(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=bp(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function bp(n,e){if(n){if(typeof n=="string")return su(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return su(n,e)}}function su(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function cu(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ma(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?cu(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):cu(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Vo=function(e){return(0,Fr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},an=function(e,t){if(!(e==null||e==""))return Vo(e)?Ma(Ma({},e),{},{title:e.title||e.value}):{value:e,title:t!==void 0?t:""+e}},Do=function(e){var t=an(e);return Vo(t)?Ma(Ma({},an(e)),{},{isCustom:!0}):t},du=function(e){if(Array.isArray(e))return e.map(function(o){return an(o)});if(!Vo(e))return e;var t=[];for(var r in e){var a=e[r];t.push(an(r,a))}return t},fa=function(e,t){if(Array.isArray(e)){var r=e.map(function(a){return an(a)});return r.find(function(a){return""+a.value==""+t})}else return e[t]!==void 0?an(t,e[t]):void 0},fu=function(e,t){if(e==null)return t;var r=fa(e,t);return r!==void 0?r.title:t},Sp=function(e,t){if(e==null)return t;var r=fa(e,t);return r!==void 0?r.value:t},No=function(e,t){var r=[];if(Array.isArray(e)){var a=Op(e),o;try{for(a.s();!(o=a.n()).done;){var u=o.value,i=t(an(u));i!=null&&r.push(i)}}catch(c){a.e(c)}finally{a.f()}}else for(var l in e){var s=t(an(l,e[l]));s!=null&&r.push(s)}return r},Fp=function(e,t){return No(t,function(r){return"".concat(r.value).indexOf(e)!=-1||r.title.indexOf(e)!=-1?r:null}).filter(function(r){return r!==null}).shift()},_a=function(e,t){return No(t,function(r){return""+r.value==""+e?r:null}).filter(function(r){return r!==null}).shift()},Fe=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return e.interpose("children1").withMutations(function(o){return o.skip(1),o.push.apply(o,r),o})},xo=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return e.interpose("children1").withMutations(function(o){return o.push.apply(o,r),o})},$n=function(e,t){var r=new ye.default.OrderedMap((0,re.A)({},e.get("id"),e)),a=e;return t.forEach(function(o){var u;a=r.get(o),r=(u=a)===null||u===void 0?void 0:u.get("children1")}),a},pu=function(e){var t=e;function r(a,o){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=o.push(a.get("id")),l=a.getIn(["properties","isLocked"]);u&&l&&(t=t.deleteIn(Fe(i,"properties","isLocked")));var s=a.get("children1");s&&s.map(function(c,d){r(c,i,l||u)})}return r(e,new ye.default.List),t},Dt=function(e){var t=e;function r(a,o,u,i){if(a){var l=a.get("path"),s=a.get("id"),c=s||i||sr(),d=o.push(c);(!l||!l.equals(d))&&(t=t.setIn(Fe(d,"path"),d)),s||(t=t.setIn(Fe(d,"id"),c));var f=a.get("children1");f&&(f.constructor.name==="Map"&&(t=t.setIn(Fe(d,"children1"),new ye.default.OrderedMap(f))),f.map(function(p,v){r(p,d,u+1,v)}))}}return r(e,new ye.default.List,0),t},Ga=function(e){var t=e;function r(a,o,u,i){if(!a)return!1;var l=a.get("id")||i,s=o.push(l),c=a.get("children1");if(c){var d=c.map(function(f,p){return r(f,s,u+1,p)}).reduce(function(f,p){return f&&p},!0);if((c.size==0||d)&&u>0)return t=t.deleteIn(Fe(s)),!0}return!1}return r(e,new ye.default.List,0),t},ko=function(e){var t=[],r={},a=[],o=0,u=0,i=0,l=0,s={};function c(g,h,b,O,S,A,L,F){var P=g===e,N=g.get("type"),k=g.get("collapsed"),I=g.get("id"),B=g.get("children1"),U=g.getIn(["properties","isLocked"]),x=B?B.map(function(We,or){return or}).valueSeq().toArray():null,X=N==="rule_group",W=N==="rule",J=N==="group",G=N==="case_group",ee=!S&&(!B||X),ie=x?.length>0,de=h.length?h[h.length-1]:null,fe=G?I:L;G&&(a.push(I),u=0,i=0,l=0,s={});var ne=fe?a.indexOf(fe):null,te=t.length,ve=o,se;P||(se={},se.caseNo=ne,se.globalNoByType=s[N]||0,se.indexPath=[].concat((0,Se.A)(h.slice(1).map(function(We){return r[We].childNo})),[F]),W?se.globalLeafNo=u:J&&(se.globalGroupNo=l)),t.push(I),r[I]={node:g,index:te,id:I,type:N,parent:de,parentType:de?r[de].type:null,children:x,childNo:F,caseId:fe,caseNo:ne,path:h.concat(I),lev:A,isLeaf:!B,isAtomicRule:ee,isLocked:U||O,top:b?null:ve,isDefaultCase:G?!B:void 0,atomicRulesCountInCase:G?0:void 0,position:se,collapsed:k,_top:te,leaf:!B};var ue=0,Ce=0;b||(o+=1,ue+=1,ie&&!k&&!X&&(Ce+=1),!P&&!G&&(J&&l++,ee&&i++,W&&u++,s[N]=(s[N]||0)+1)),L&&ee&&r[L].atomicRulesCountInCase++;var he=0,Pe=0;if(ie){var Ne=0;B.map(function(We,or){if(We){c(We,h.concat(I),b||k,O||U,S||X,A+1,fe,Ne);var ar=r[or];he=Math.max(he,ar.depth||0),Pe+=ar.height,Ne++}})}ue+=Pe,Ce+=he;var Be=t.length,Qe=Be-te,Je=b?null:ve+ue;Object.assign(r[I],{depth:B?Ce:void 0,_height:Qe,height:ue,bottom:Je})}c(e,[],!1,!1,!1,0,null,null);for(var d=0;d<t.length;d++){var f=d>0?t[d-1]:null,p=d<t.length-1?t[d+1]:null,v=r[t[d]];v.prev=f,v.next=p}return{flat:t,items:r,cases:a}},Ep=function(e){if(!e)return-1;var t=0;function r(a,o,u){var i,l,s;typeof a.get=="function"?(i=a.get("id"),l=a.get("children1"),s=a.get("type")):(i=a.id,l=a.children1,s=a.type);var c=s=="rule_group";t++,l&&!c&&l.map(function(d,f){d&&r(d,o.concat(i),u+1)})}return r(e,[],0),t-1},Mo=function(e){if(!e)return-1;var t=0;function r(a,o,u){var i,l,s;typeof a.get=="function"?(i=a.get("id"),l=a.get("children1"),s=a.get("type")):(i=a.id,l=a.children1,s=a.type),s=="rule"||s=="rule_group"?t++:l&&l.map(function(c,d){c&&r(c,o.concat(i),u+1)})}return r(e,[],0),t},vu=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=e;function o(u,i){t&&u.path&&delete u.path,t&&!r&&i&&delete u.id;var l=u.properties;l&&l.operatorOptions==null&&delete l.operatorOptions;var s=u.children1;if(s){for(var c in s)s[c]&&o(s[c],c);r&&(u.children1=Object.values(s))}}return o(e,null),a},gu=function(e){var t=[],r=e.get("children1");return r&&r.map(function(a){var o=a.getIn(["properties","value"]),u;o&&o.size==1?(u=o.get(0),Array.isArray(u)&&u.length==0&&(u=null)):u=null,t=[].concat((0,Se.A)(t),[u])}),t},_o=function(e){return!e.get("children1")||e.get("children1").size==0},Go=function(e,t){return e.getIn(Fe(t,"children1")).size>0},$o=function(e){if(e!=null&&e.toJS){var t,r=e==null||(t=e.toJS)===null||t===void 0?void 0:t.call(e);return r!=null&&r.func?e.toOrderedMap():r}else return e},Cp=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e){var a=e;return a=a.toJS(),a=vu(a,t,r),a}},Uo=function(e){if(mu(e))return e;if(hu(e))return Dt(pa(e));if(typeof e=="string"&&e.startsWith('["~#iM"'))throw new Error("You are trying to load query in obsolete serialization format (Immutable string) which is not supported in versions starting from 2.1.17");if(typeof e=="string")return Dt(pa(JSON.parse(e)));throw new Error("Can't load tree!")},mu=function(e){return ye.Map.isMap(e)},hu=function(e){return(0,Fr.A)(e)=="object"&&(e.type=="group"||e.type=="switch_group")};function pa(n){var e=(0,ye.fromJS)(n,function(t,r,a){var o=a&&a.length>3&&a[a.length-1]==="value"&&a[a.length-3]==="args",u=a&&a.length>3&&a[a.length-1]==="value"&&a[a.length-2]==="properties",i;if(t=="properties"){i=r.toOrderedMap();for(var l=0;l<2;l++){var s,c,d;((s=i.get("value"))===null||s===void 0||(c=(d=s).get)===null||c===void 0?void 0:c.call(d,l))===null&&(i=i.setIn(["value",l],void 0))}}else o?i=$o(r):(a?u:t=="value")&&ye.default.Iterable.isIndexed(r)?i=r.map($o).toList():t=="asyncListValues"?i=r.toJS():t=="children1"&&ye.default.Iterable.isIndexed(r)?i=new ye.default.OrderedMap(r.map(function(f){return[f?.get("id")||sr(),f]})):i=ye.default.Iterable.isIndexed(r)?r.toList():r.toOrderedMap();return i});return e}var yu=y(87695),Tp=y(95093),Un=y.n(Tp);function Ou(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Ap(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Ap(n,e){if(n){if(typeof n=="string")return bu(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return bu(n,e)}}function bu(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Su(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Cn(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Su(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Su(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Lp=function(e){return Array.from(new Set(e))},ub=function(e){return e.reduce(function(t,r){var a=_slicedToArray(r,2),o=a[0],u=a[1];return Cn(Cn({},t),{},_defineProperty({},o,u))},{})},Bo=function(e){return{errors:[],settings:e?.settings}},wp=function(e,t){return Fu(e,t,!1)},Fu=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Bo();a.settings={allowUnknownFields:!1,returnErrors:r};var o=xt(t,void 0,!1),u=Rp(o),i=e?$a(e,u,o,"rule",a):void 0;i&&i.type!="group"&&(i=Wo(i,o));var l=i?Uo(i):void 0;return r?[l,a.errors]:(a.errors.length&&console.warn("Errors while importing from JsonLogic:",a.errors),l)},Rp=function(e){var t={};for(var r in e.operators){var a=e.operators[r];if(typeof a.jsonLogic=="string"){var o=(a._jsonLogicIsRevArgs?"#":"")+a.jsonLogic+"/"+Mr(a);t[o]||(t[o]=[]),t[o].push(r)}else if(typeof a.jsonLogic2=="string"){var u=a.jsonLogic2+"/"+Mr(a);t[u]||(t[u]=[]),t[u].push(r)}}var i={};for(var l in e.conjunctions){var s=e.conjunctions[l],c=s.jsonLogicConj||l.toLowerCase();i[c]=l}var d={},f=Ou(Qn(e)),p;try{for(f.s();!(p=f.n()).done;){var v=(0,we.A)(p.value,2),g=v[0],h=v[1],b=void 0;h.jsonLogicIsMethod?b="#"+h.jsonLogic:typeof h.jsonLogic=="string"&&(b=h.jsonLogic),b&&(d[b]||(d[b]=[]),d[b].push(g))}}catch(L){f.e(L)}finally{f.f()}var O=e.settings.jsonLogic,S=O.groupVarKey,A=O.altVarKey;return{operators:t,conjunctions:i,funcs:d,varKeys:["var",S,A]}},$a=function n(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,i=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:null,c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d,f;lt(e)&&(d=Object.keys(e)[0],f=e[d],Array.isArray(f)||(f=[f]));var p,v=o.errors.length,g=r.settings.jsonLogic.lockedOp,h=d=="!"&&f.length==1&&f[0]&&lt(f[0])&&t.varKeys.includes(Object.keys(f[0])[0]),b=d=="!"&&!h,O=g&&d==g;O?p=n(f[0],t,r,a,o,u,i,l,s,!0):b?p=n(f[0],t,r,a,o,!u,i,l,s):a=="val"?p=Eu(d,f,t,r,u,o,s)||Cu(d,f,t,r,u,i,o,s)||Pp(e,i,l,r,o):a=="rule"&&(p=Tu(d,f,t,r,u,o,s,!1)||xp(d,f,t,r,u,o,s));var S=o.errors.length;return d!="!"&&p===void 0&&S==v&&o.errors.push("Can't parse logic ".concat(JSON.stringify(e))),O&&(p.properties.isLocked=!0),p},Pp=function(e,t,r,a,o){var u;if(e===void 0&&(e=t?.defaultValue),e!==void 0){var i=a.widgets[r||t?.mainWidget],l=t?.type;if(l&&!i){o.errors.push("No widget for type ".concat(l));return}if(lt(e)){o.errors.push("Unexpected logic in value: ".concat(JSON.stringify(e)));return}if(l=="time"&&typeof e=="number"){var s=Math.floor(e/60/60)%24,c=Math.floor(e/60)%60,d=e%60,f=i.valueFormat;if(f){var p=new Date(e);p.setMilliseconds(0),p.setHours(s),p.setMinutes(c),p.setSeconds(d),e=Un()(p).format(f)}else e="".concat(s,":").concat(c,":").concat(d)}if(["date","datetime"].includes(l)&&e&&!(e instanceof Date))try{var v=new Date(e);v instanceof Date&&v.toISOString()===e&&(e=v)}catch{o.errors.push("Can't convert value ".concat(e," as Date")),e=void 0}if(e instanceof Date&&t){var g=i.valueFormat;g&&(e=Un()(e).format(g))}var h;if(e&&t!==null&&t!==void 0&&(u=t.fieldSettings)!==null&&u!==void 0&&u.asyncFetch){var b=Array.isArray(e)?e:[e];h=b}return{valueSrc:"value",value:e,valueType:i?.type,asyncListValues:h}}},Eu=function(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(r.varKeys.includes(e)&&typeof t[0]=="string"){var l,s=Qa(a,t[0],i),c=Re(a,s);if(!c&&!((l=u.settings)!==null&&l!==void 0&&l.allowUnknownFields)){u.errors.push("No config for field ".concat(s));return}return{valueSrc:"field",value:s,valueType:c?.type}}},jp=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7?arguments[7]:void 0,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:null,c=Object.keys(t)[0],d=Object.values(t)[0],f=function(J,G){return Ip(J,G,a,o,u,l,s)||Vp(J,G,a,o,u,i,l,s)},p=l.errors.length,v,g,h,b,O=f(c,d);if(O&&(v=O.field,g=O.fieldSrc),e&&(b=!0,h=r[0],r=[]),c=="reduce"&&Array.isArray(d)&&d.length==3){var S=d,A=(0,we.A)(S,3),L=A[0],F=A[1],P=A[2];if(lt(L)&&P==0&&lt(F)&&Array.isArray(F["+"])&&F["+"][0]==1&&lt(F["+"][1])&&F["+"][1].var=="accumulator")if(c=Object.keys(L)[0],d=Object.values(L)[0],c=="filter"){var N=d,k=(0,we.A)(N,2),I=k[0],B=k[1];if(lt(I)){c=Object.keys(I)[0],d=Object.values(I)[0];var U=f(c,d);U&&(v=U.field,g=U.fieldSrc,h=B,b=!0)}}else{var x=f(c,d);x&&(v=x.field,g=x.fieldSrc,b=!0)}}var X=l.errors.length;if(!v&&X==p&&l.errors.push("Unknown LHS ".concat(JSON.stringify(t))),!!v)return{field:v,fieldSrc:g,having:h,isGroup:b,args:r}},Ip=function(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Array.isArray(t)||(t=[t]);var l=Eu(e,t,r,a,o,u,i);if(l)return{fieldSrc:"field",field:l.value}},Vp=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=arguments.length>6?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,s=Cu(e,t,r,a,o,u,i,l);if(s)return{fieldSrc:"func",field:s.value}},Cu=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=arguments.length>6?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null;if(e){var s,c,d,f=e=="method";if(f){var p,v,g=(0,yu.A)(t);p=g[0],s=g[1],v=g.slice(2),c=[p].concat((0,Se.A)(v))}else s=e,c=t;var h=(f?"#":"")+s,b=u?.type||u?.returnType,O=(r.funcs[h]||[]).filter(function(G){return u?Gr(a,G).returnType==b:!0});if(O.length)d=O[0];else{var S=(0,re.A)({},e,t),A=Ou(Qn(a)),L;try{for(A.s();!(L=A.n()).done;){var F=(0,we.A)(L.value,2),P=F[0],N=F[1];if(N.jsonLogicImport&&(!b||N.returnType==b)){var k=void 0;try{k=N.jsonLogicImport(S)}catch{}k&&(d=P,c=k)}}}catch(G){A.e(G)}finally{A.f()}}if(d&&d){var I=Gr(a,d),B=Object.keys(I.args||{}),U=c.reduce(function(G,ee,ie){var de=B[ie],fe=I.args[de],ne;return fe&&(ne=$a(ee,r,a,"val",i,!1,fe,null,l)),ne!==void 0?Cn(Cn({},G),{},(0,re.A)({},de,ne)):G},{});for(var x in I.args){var X=I.args[x],W=U[x];if(W===void 0){if(W=X?.defaultValue,W!==void 0){var J;W={value:W,valueSrc:(J=W)!==null&&J!==void 0&&J.func?"func":"value",valueType:X.type}}if(W===void 0){if(!(X!=null&&X.isOptional)){i.errors.push("No value for arg ".concat(x," of func ").concat(d));return}}else U[x]=W}}return{valueSrc:"func",value:{func:d,args:U},valueType:I.returnType}}}},Tu=function(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,s=r.conjunctions[e],c=a.settings.fieldSeparator;if(s){var d="group",f=t.map(function(S){return $a(S,r,a,"rule",u,!1,null,null,i)}).filter(function(S){return S!==void 0}).reduce(function(S,A){return Cn(Cn({},S),{},(0,re.A)({},A.id,A))},{}),p=Object.values(f).map(function(S){var A,L;return(S==null||(A=S.properties)===null||A===void 0?void 0:A.fieldSrc)=="field"&&(S==null||(L=S.properties)===null||L===void 0?void 0:L.field)}).filter(function(S){var A;return S==null||(A=S.includes)===null||A===void 0?void 0:A.call(S,c)}),v=Object.fromEntries(Lp(p).map(function(S){var A=S.split(c),L=Object.fromEntries(A.slice(0,-1).map(function(F,P,N){return[].concat((0,Se.A)(N.slice(0,P)),[F])}).map(function(F){return[F.join(c),Re(a,F)]}).filter(function(F){var P=(0,we.A)(F,2),N=P[0],k=P[1];return k?.type=="!group"}));return[S,Object.keys(L)]})),g={conjunction:s,not:o},h=sr(),b={},O={};return Object.entries(f).map(function(S){var A=(0,we.A)(S,2),L=A[0],F=A[1];if(F?.type=="group"||F?.type=="rule_group")b[L]=F;else{var P,N=F==null||(P=F.properties)===null||P===void 0?void 0:P.field,k=v[N]||[],I=k[k.length-1];if(!I)F&&(b[L]=F);else{var B=b,U=Vr(i,a),x=Vr(I,a),X=sa(U,x.slice(0,U.length));X||(U=[]);var W=I.split(c).slice(U.length).map(function(J,G,ee){return[].concat((0,Se.A)(U),(0,Se.A)(ee.slice(0,G)),[J]).join(c)}).map(function(J){return{f:J,fc:Re(a,J)||{}}}).filter(function(J){var G=J.fc;return G.type!="!struct"});W.map(function(J,G){var ee=J.f,ie=J.fc,de=O[ee];de||(de=sr(),O[ee]=de,B[de]={type:"rule_group",id:de,children1:{},properties:{conjunction:s,not:!1,field:ee,fieldSrc:"field",mode:ie.mode}}),B=B[de].children1}),B[L]=F}}}),{type:d,id:h,children1:b,properties:g}}},Dp=function(e,t,r,a,o){if(e)return{type:"rule_group",id:sr(),children1:(0,re.A)({},e.id,e),properties:{conjunction:o||Ua(a,r),not:!1,field:t}}},Wo=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return{type:"group",id:sr(),children1:(0,re.A)({},e.id,e),properties:{conjunction:Kt(t),not:r}}},Np=function(e,t,r,a,o,u,i){var l=Bo(i),s=Au(e,t,r,a,o,u,!1,l);if(s||(s=Au(e,t,r,a,o,u,!0,Bo(i))),!s){i.errors.push(l.errors.join("; ")||"Unknown op ".concat(e,"/").concat(t));return}return s},Au=function(e,t,r,a,o,u,i,l){var s,c,d=(e=="all"||e=="some")&&lt(r[1])&&Object.keys(r[1])[0]=="in"&&((s=r[1].in[0])===null||s===void 0?void 0:s.var)==="",f=!d&&u.settings.groupOperators.includes(e),p=["==","!="],v=f?0:t-1;f?v=0:p.includes(e)&&v==1&&r[1]===null&&(t=1,v=0,r=[r[0]]);var g=e+"/"+v,h=o.operators[(i?"#":"")+g];if(h){var b,O=[],S=["<","<=",">",">="];if(S.includes(e)&&t==3)b=r[1],O=[r[0],r[2]];else if(i)b=r[1],O=[r[0]];else{var A=r,L=(0,yu.A)(A);b=L[0],O=L.slice(1)}if(!lt(b)){l.errors.push("Incorrect operands for ".concat(e,": ").concat(JSON.stringify(r)));return}var F=jp(f,b,O,o,u,null,null,l,a);if(F){var P=F.field,N=F.fieldSrc,k=F.having,I=F.isGroup,B=F.args,U=Re(u,P);if(!U&&!((c=l.settings)!==null&&c!==void 0&&c.allowUnknownFields)){l.errors.push("No config for LHS ".concat(P));return}var x=h[0];if(h.length>1&&U&&U.operators){if(h=h.filter(function(X){return U.operators.includes(X)}),h.length==0){l.errors.push("No corresponding ops for LHS ".concat(P));return}x=h[0]}return{field:P,fieldSrc:N,fieldConfig:U,opKey:x,args:B,having:k}}}},xp=function n(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(e){var l=t.length;if((e=="all"||e=="some")&&lt(t[1])){var s,c=Object.keys(t[1])[0],d=((s=t[1][c][0])===null||s===void 0?void 0:s.var)==="";c=="in"&&d&&(t=[t[0],t[1][c][1]],e=e+"-"+c)}var f=Np(e,l,t,i,r,a,u);if(f){var p=f.field,v=f.fieldSrc,g=f.fieldConfig,h=f.opKey,b=f.args,O=f.having,S=a.operators[h],A=g?.showNot!==void 0?g.showNot:a.settings.showNot,L=!0,F,P,N=!1;if(g?.type=="!group"&&O){F=Object.keys(O)[0],P=O[F],Array.isArray(P)||(P=[P]);var k=F=="!"&&P.length==1&&P[0]&&lt(P[0])&&r.varKeys.includes(Object.keys(P[0])[0]);F=="!"&&!k&&(N=!0,O=O["!"],F=Object.keys(O)[0],P=O[F],Array.isArray(P)||(P=[P]))}o&&L&&S.reversedOp&&(o=!1,h=S.reversedOp,S=a.operators[h]);var I=Tr(a,p,h,null),B=b.map(function(G){return $a(G,r,a,"val",u,!1,g,I,i)});if(!B.filter(function(G){return G===void 0}).length){var U,x=g?.type;if((x==="!group"||x==="!struct")&&(x=null),g?.type=="!group"&&O){if(r.conjunctions[F]!==void 0)U=Tu(F,P,r,a,N,u,p,!0),N=!1;else{var X=n(F,P,r,a,N,u,p);N=!1,U=Dp(X,p,g,a,r.conjunctions.and)}if(!U)return;U.type="rule_group",Object.assign(U.properties,{field:p,mode:g.mode,operator:h}),g.mode=="array"&&Object.assign(U.properties,{value:B.map(function(G){return G.value}),valueSrc:B.map(function(G){return G.valueSrc}),valueType:B.map(function(G){return G.valueType})}),o&&(U=Wo(U,a,o))}else if(g?.type=="!group"&&!O)U={type:"rule_group",id:sr(),children1:{},properties:{conjunction:Ua(a,g),not:o,mode:g.mode,field:p,operator:h}},g.mode=="array"&&Object.assign(U.properties,{value:B.map(function(G){return G.value}),valueSrc:B.map(function(G){return G.valueSrc}),valueType:B.map(function(G){return G.valueType})});else{var W=B.map(function(G){return G.asyncListValues}).filter(function(G){return G!=null}),J=W.length?W[0]:void 0;U={type:"rule",id:sr(),properties:Cn({field:p,fieldSrc:v,operator:h,value:B.map(function(G){return G.value}),valueSrc:B.map(function(G){return G.valueSrc}),valueType:B.map(function(G){return G.valueType})},J?{asyncListValues:J}:{})},o&&(U=Wo(U,a,o))}return U}}}},kp=y(21450),Mp=y(61526),_p=y.n(Mp),gn=_p();gn.trim=function(n){return n.charAt(0)=="'"?n.substring(1,n.length-1):n},gn.escapeLike=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=gn.escape(n);return r=gn.trim(r),r=r.replace(/[%_]/g,"\\$&"),r=(e?"%":"")+r+(t?"%":""),r="'"+r+"'",r};var Lu=function(e){var t="''",r=e?.type;return r=="date"?t="'0000-00-00'":r=="datetime"?t="'0000-00-00 00:00'":r=="time"?t="'00:00'":r=="number"&&(t="0"),t},wu=function(e){var t="",r=e?.type;return r=="number"&&(t=0),t},Gp=function(e){return"'"+e.replace(/'/g,"''")+"'"},$p=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r,a,o=["int","float"];e.map(function(l){if(l!=null){if(typeof l=="string")a="String";else if(typeof l=="number")a=Number.isInteger(l)?"int":"float";else throw new Error("spelEscape: Can't use value ".concat(l," in array"));if(!r)r=a;else if(r!=a)if(o.includes(r)&&o.includes(a))r="float";else throw new Error("spelEscape: Can't use different types in array: found ".concat(r," and ").concat(a))}}),r||(r="String");var u;r=="float"?u=e.map(function(l){return Bn(l,!0)}):u=e.map(function(l){return Bn(l)});var i;return t?i="new ".concat(r,"[]{").concat(u.join(", "),"}"):i="{".concat(u.join(", "),"}"),i},Ru=function(e){return"".concat(e,".?[true]")},Bn=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(e==null)return"null";switch((0,Fr.A)(e)){case"boolean":return e?"true":"false";case"number":return!Number.isFinite(e)||isNaN(e)?void 0:e+(!Number.isInteger(e)||t?"f":"");case"object":if(Array.isArray(e))return $p(e,r);throw new Error("spelEscape: Object is not supported");default:return Gp(e)}},Up=function(e){return e&&Array.isArray(e)&&e.length?e.map(function(t){if(t.type=="const")return Bn(t.value);if(t.type=="property")return""+t.value;if(t.type=="variable")return"#"+t.value}).filter(function(t){return t!=null}).join(" + "):"null"},Bp=function(e){if(e==null)return[void 0,[]];var t=[],r=e.valueType=="case_value"?e.value:[e],a=r.map(function(o){if(o.valueSrc=="value")return o.value===null?void 0:{type:"const",value:o.value};if(o.valueSrc=="field")return{type:o.isVariable?"variable":"property",value:o.value};t.push("Unsupported valueSrc ".concat(o.valueSrc," in concatenation"))}).filter(function(o){return o!=null});return[a,t]},Pu=function(e){return e==null?"NULL":e.toString()};function ju(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Wp(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Wp(n,e){if(n){if(typeof n=="string")return Iu(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Iu(n,e)}}function Iu(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Vu(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Du(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Vu(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Vu(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Nu="${0}.compareTo(${1})",Kp={datetime:!0,time:!0,date:!0},Hp=function(e,t){return xu(e,t,!1)},xu=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},o=xt(t,void 0,!1),u=ku(e,o,a,null);return r?[u,a.errors]:(a.errors.length&&console.warn("Errors while exporting to SpEL:",a.errors),u)},ku=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(e){var o=e.get("type");if(o==="group"||o==="rule_group")return _u(e,t,r,a);if(o==="rule")return Jp(e,t,r,a);if(o=="switch_group")return zp(e,t,r,a);if(o=="case_group")return Mu(e,t,r,a)}},Mu=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("type");if(o!="case_group"){r.errors.push("Unexpected child of type ".concat(o," inside switch"));return}var u=e.get("properties")||new ye.Map,i=Ko(t,u,r,null,a,"!case_value"),l=(0,we.A)(i,3),s=l[0],c=l[1],d=l[2],f=_u(e,t,r,a);return[f,s]},zp=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("properties")||new ye.Map,u=e.get("children1");if(u){var i=u.map(function(h){return Mu(h,t,r,null)}).filter(function(h){return typeof h<"u"}).valueSeq().toArray();if(i.length){if(i.length==1&&!i[0][0])return i[0][1];for(var l=[],s=0;s<i.length;s++)s!=i.length-1&&!i[s][0]?r.errors.push("No condition for case ".concat(s)):(l.push(i[s]),s==i.length-1&&i[s][0]&&l.push([void 0,null]));for(var c="",d="",f=0;f<l.length;f++){var p=(0,we.A)(l[f],2),v=p[0],g=p[1];g==null&&(g="null"),v==null&&(v="true"),f!=l.length-1?(c+="(".concat(v," ? ").concat(g," : "),d+=")"):c+="".concat(g)}return c+d}}},_u=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("type"),u=e.get("properties")||new ye.Map,i=u.get("mode"),l=e.get("children1")||new ye.List,s=u.get("field"),c=u.get("conjunction");c||(c=Kt(t));var d=t.conjunctions[c],f=u.get("not"),p=o==="rule_group",v=p&&i!="struct",g=v?s:a,h=Re(t,g)||{},b=h.isSpelArray,O=t.settings.fieldSeparator,S=u.get("operator");!S&&(!i||i=="some")&&(S="some");var A=$u(t,S,s),L=A!=S,F=S&&cr(t,A,s)||null,P=p&&(!A||F.cardinality==0),N=Ko(t,u,r,A,a,null),k=(0,we.A)(N,3),I=k[0],B=k[1],U=k[2],x=l.map(function(te){return ku(te,t,r,g)}).filter(function(te){return typeof te<"u"});if(v&&!P){if(I==null)return}else if(!x.size)return;var X=p,W=x.size?d.spelFormatConj(x,c,f,X):null,J;if(v){var G=zo(r,t,s,a),ee=O||".",ie=ee+(b?"length":"size()"),de="".concat(G).concat(ie),fe=W?"".concat(G,".?[").concat(W,"]").concat(ie):de,ne=P?de:I;J=Gu(r,t,u,fe,ne,A,B,U,L)}else J=W;return J},qp=function(e,t,r){var a=t.spelOp;if(a){var o=a.includes("${0}"),u=Kp[r],i=a,l,s=Mr(t);return u?l=function(d,f,p,v,g,h,b,O){var S=Nu.replace(/\${(\w+)}/g,function(A,L){return L==0?d:s>1?p[L-1]:p});return"".concat(S," ").concat(i," 0")}:o?l=function(d,f,p,v,g,h,b,O){return a.replace(/\${(\w+)}/g,function(S,A){return A==0?d:s>1?p[A-1]:p})}:s==0?l=function(d,f,p,v,g,h,b,O){return"".concat(d," ").concat(i)}:s==1&&(l=function(d,f,p,v,g,h,b,O){return"".concat(d," ").concat(i," ").concat(p)}),l}},Gu=function(e,t,r,a,o,u,i,l){var s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=r.get("field"),d=cr(t,u,c)||{},f=Re(t,c)||{},p=r.get("operatorOptions"),v=d.spelFormatOp||qp(u,d,l);if(!v){e.errors.push("Operator ".concat(u," is not supported"));return}var g=[a,u,o,i,l,Er()(d,_n),p,f],h;return h=v.call.apply(v,[t.ctx].concat(g)),s&&(h=t.settings.spelFormatReverse(h)),h===void 0&&e.errors.push("Operator ".concat(u," is not supported for value source ").concat(i)),h},$u=function(e,t,r){if(t){var a=cr(e,t,r)||{},o=a.reversedOp,u=cr(e,o,r)||{},i=!1,l=a.spelOp||a.spelFormatOp,s=u.spelOp||u.spelFormatOp;if(!(!l&&!s)){if(!l&&s){i=!0;var c=[o,t];t=c[0],o=c[1];var d=[u,a];a=d[0],u=d[1]}return t}}},Jp=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("properties")||new ye.Map,u=o.get("field"),i=o.get("fieldSrc"),l=o.get("operator");if(!(u==null||l==null)){var s=$u(t,l,u);if(!s){r.errors.push("Operator ".concat(l," is not supported"));return}var c=s!=l,d=Ko(t,o,r,s,a,null),f=(0,we.A)(d,3),p=f[0],v=f[1],g=f[2];if(p!==void 0){var h=Qp(r,t,u,i,a);if(h!==void 0){var b=Gu(r,t,o,h,p,s,v,g,c);return b}}}},Qp=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;return a==="func"?Uu(e,t,r,o):zo(e,t,r,o)},Ko=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=t.get("field"),l=t.get("valueSrc"),s=t.get("valueType");(u=="!case_value"||s&&s.get(0)=="case_value")&&(i="!case_value");var c=Re(e,i)||{},d=cr(e,a,i)||{},f=Mr(d),p=t.get("value"),v=t.get("asyncListValues"),g=[],h=[],b;if(p!=null){var O=p.map(function(A,L){var F=l?l.get(L):null,P=s?s.get(L):null,N=Ln(A,F,e),k=Tr(e,i,a,F),I=Er()(rt(e,i,a,k,F),["factory"]),B=Ho(r,e,N,F,P,I,c,a,d,o,v);return B!==void 0&&(g.push(F),h.push(P)),B}),S=O.filter(function(A){return A===void 0}).size>0;O.size<f||S||(b=f>1?O.toArray():f==1?O.first():null)}return[b,g.length>1?g:g[0],h.length>1?h:h[0]]},Ho=function(e,t,r,a,o,u,i,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0;if(r!==void 0){var f;if(a==="field")f=zo(e,t,r,c);else if(a==="func")f=Uu(e,t,r,c);else if(typeof u.spelFormatValue=="function"){var p=u.spelFormatValue,v=[r,Du(Du({},Ut()(i,["fieldSettings","listValues"])),{},{asyncListValues:d}),Er()(u,En)];if(l&&(v.push(l),v.push(s)),a=="field"){var g=Re(t,r)||{};v.push(g)}f=p.call.apply(p,[t.ctx].concat(v))}else f=Bn(r);return f}},zo=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(r){var o=t.settings.fieldSeparator,u=Re(t,r)||{},i=Vr(r,t),l=is(r,t,a),s=t.settings.formatSpelField,c=un(r,t,e,a),d=l.map(function(p){var v=(0,we.A)(p,3),g=v[0],h=v[1],b=v[2],O;b&&(b.type=="!struct"||b.type=="!group"&&b.mode=="struct"?O=h.isSpelMap?"map":"class":b.type=="!group"?O=h.isSpelItemMap?"[map]":"[class]":O="class");var S=h?.isSpelVariable;return{key:g,parent:O,isSpelVariable:S,fieldSeparator:o}}),f=s.call(t.ctx,c,a,i,d,u,t);return f}},Uu=function(e,t,r){var a,o,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=(a=r.get)===null||a===void 0?void 0:a.call(r,"func"),l=(o=r.get)===null||o===void 0?void 0:o.call(r,"args"),s=Gr(t,i);if(!s){e.errors.push("Func ".concat(i," is not defined in config"));return}var c={},d=[],f=[];for(var p in s.args){var v,g,h=s.args[p],b=Re(t,h),O=h.defaultValue,S=h.isOptional,A=O!=null&&O.func?"func":"value",L=l?l.get(p):void 0,F=L?L.get("value"):void 0,P=L?L.get("valueSrc"):void 0;P!=="func"&&(v=F)!==null&&v!==void 0&&v.toJS&&(F=F.toJS());var N=L?L.get("asyncListValues"):void 0,k=(g=h.spelEscapeForFormat)!==null&&g!==void 0?g:!0,I=null,B=Tr(t,h,I,P),U=Er()(rt(t,h,I,B,P),["factory"]),x=Ho(e,t,F,P,h.type,U,b,null,null,u,N);if(F!=null&&x===void 0){P!="func"&&e.errors.push("Can't format value of arg ".concat(p," for func ").concat(i));return}var X=void 0;if(x===void 0&&!S&&O!=null){var W=Tr(t,h,I,A),J=Er()(rt(t,h,I,W,A),["factory"]);if(X=Ho(e,t,O,A,h.type,J,b,null,null,u,N),X===void 0){A!="func"&&e.errors.push("Can't format default value of arg ".concat(p," for func ").concat(i));return}}var G=x??X;if(G!==void 0){var ee;if(d.length){var ie=ju(d),de;try{for(ie.s();!(de=ie.n()).done;){var fe=de.value;c[fe]=void 0}}catch(Pe){ie.e(Pe)}finally{ie.f()}d=[]}c[p]=k?G:(ee=F)!==null&&ee!==void 0?ee:O}else S||f.push(p),d.push(p)}if(!f.length){var ne;if(typeof s.spelFormatFunc=="function"){var te=s.spelFormatFunc,ve=[c];ne=te.call.apply(te,[t.ctx].concat(ve))}else if(s.spelFunc){ne=s.spelFunc.replace(/\${(\w+)}/g,function(Pe,Ne){var Be;return(Be=c[Ne])!==null&&Be!==void 0?Be:Pe});var se=Object.keys(s.args||{}).reverse().filter(function(Pe){return!!s.args[Pe].isOptional}),ue=ju(se),Ce;try{for(ue.s();!(Ce=ue.n()).done;){var he=Ce.value;if(c[he]!=null)break;ne=ne.replace(new RegExp("(, )?\\${"+he+"}","g"),"")}}catch(Pe){ue.e(Pe)}finally{ue.f()}ne=ne.replace(/\${(\w+)}/g,"null")}else e.errors.push("Func ".concat(i," is not supported"));return ne}};function Bt(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Yp(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Yp(n,e){if(n){if(typeof n=="string")return Bu(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Bu(n,e)}}function Bu(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Wu(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function nr(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Wu(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Wu(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Ku={number:"number",string:"text",boolean:"boolean",null:"null"},Hu={String:"text"},Xp="multiselect",Zp=function(e){return["length"].includes(e)},zu=function(e){return(0,Fr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},ev=function(e,t){return qu(e,t,!0)},qu=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},o=xt(t,void 0,!1),u=nv(o),i,l,s=void 0;try{var c=kp.SpelExpressionEvaluator.compile(e);i=c._compiledExpression}catch(f){a.errors.push(f)}i&&(l=rv(i,a),vn.debug("convertedObj:",l,a),s=qo(l,u,o,a),s&&s.type!="group"&&s.type!="switch_group"&&(s=va(s,o,l.not)),vn.debug("jsTree:",s));var d=s?Uo(s):void 0;return r?[d,a.errors]:(a.errors.length&&console.warn("Errors while importing from SpEL:",a.errors),d)},rv=function n(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=e.getType(),o=e.getChildren().map(function(x){return n(x,t,e)});if((a=="op-or"||a=="op-and")&&(o=o.reduce(function(x,X){var W=X.type==a&&!X.not,J=W?X.children:[X];return[].concat((0,Se.A)(x),(0,Se.A)(J))},[])),a=="op-not")return o.length!=1&&t.errors.push("Operator NOT should have 1 child, but got ".concat(o.length,"}")),nr(nr({},o[0]),{},{not:!o[0].not});if(a=="compound"){o=o.filter(function(x){var X=x.type=="selection"&&x.children.length==1&&x.children[0].type=="boolean"&&x.children[0].val==!0;return!X});var u=o.find(function(x){return x.type=="selection"});u&&u.children.length!=1&&t.errors.push("Selection should have 1 child, but got ".concat(u.children.length));var i=u?u.children[0]:null,l=o[o.length-1],s=l.type=="method"&&l.val.methodName=="size"||l.type=="!func"&&l.methodName=="size",c=l.type=="property"&&l.val=="length",d=o.filter(function(x){return x!==u&&x!==l}),f={type:"compound",children:d},p=(s||c)&&Ju(d)!=null;if(p)return{type:"!aggr",filter:i,source:f};if(o=o.filter(function(x){var X=x.type=="variable"&&x.val=="this",W=x.type=="variable"&&x.val=="root";return!(X||W)}),o=o.map(function(x){return x.type=="indexer"&&x.children.length==1?{type:"indexer",val:x.children[0].val,itype:x.children[0].type}:x}),l.type=="!func"){var v={},g=v;do{var h,b;Object.assign(g,l),o=o.filter(function(x){return x!==l}),l=o[o.length-1],((b=l)===null||b===void 0?void 0:b.type)=="!func"?(g.obj={},g=g.obj):o.length>1?g.obj={type:"compound",children:o}:g.obj=l}while(((h=l)===null||h===void 0?void 0:h.type)=="!func");return v}}var O;try{e.getRaw?O=e.getRaw():e.getValue.length==0&&(O=e.getValue())}catch(x){vn.error("[spel2js] Error in getValue()",x)}if(a=="ternary"&&(O=tv(o)),(0,Fr.A)(O)==="object"&&O!==null&&(O.methodName||O.functionName)&&(O.args=O.args.map(function(x){return n(x,t,e)})),a=="list"&&(O=O.map(function(x){return n(x,t,e)}),!r&&O.length==1))return O[0];if(a=="constructorref"){var S=o.find(function(x){return x.type=="qualifiedidentifier"}),A=S?.val;if(!A){t.errors.push("Can't find qualifiedidentifier in constructorref children: ".concat(JSON.stringify(o)));return}var L=o.filter(function(x){return x.type!="qualifiedidentifier"});return{type:"!new",cls:A,args:L}}if(a=="typeref"){var F=o.find(function(x){return x.type=="qualifiedidentifier"}),P=F?.val;if(!P){t.errors.push("Can't find qualifiedidentifier in typeref children: ".concat(JSON.stringify(o)));return}var N=o.filter(function(x){return x.type!="qualifiedidentifier"});return{type:"!type",cls:P}}if(a=="function"||a=="method"){var k=O,I=k.functionName,B=k.methodName,U=k.args;return{type:"!func",methodName:I||B,isVar:a=="function",args:U}}return{type:a,children:o,val:O}},tv=function(e){var t=[];function r(a){var o=(0,we.A)(a,3),u=o[0],i=o[1],l=o[2];t.push([u,i]),l?.type=="ternary"?r(l.children):t.push([void 0,l])}return r(e),t},nv=function(e){var t={},r=function(W){var J=e.operators[W];if(J.spelOps)J.spelOps.forEach(function(ee){var ie=ee;t[ie]||(t[ie]=[]),t[ie].push(W)});else if(J.spelOp){var G=J.spelOp;t[G]||(t[G]=[]),t[G].push(W)}else vn.log("[spel] No spelOp for operator ".concat(W))};for(var a in e.operators)r(a);var o={};for(var u in e.conjunctions){var i=e.conjunctions[u],l=i.spelConj||u.toLowerCase();o[l]=u}var s={},c=Bt(Qn(e)),d;try{var f=function(){var W=(0,we.A)(d.value,2),J=W[0],G=W[1],ee=[],ie=G.spelFunc;if(typeof ie=="string"){var de=Object.keys(G.args||{}).reverse().filter(function(ue){return!!G.args[ue].isOptional||G.args[ue].defaultValue!=null}),fe=ie.replace(/\${(\w+)}/g,function(ue,Ce){return"?"}),ne=de.reduce(function(ue,Ce){return[].concat((0,Se.A)(ue),[[Ce].concat((0,Se.A)(ue[ue.length-1]||[]))])},[]).map(function(ue){return ie.replace(/(?:, )?\${(\w+)}/g,function(Ce,he){return ue.includes(he)?"":Ce}).replace(/\${(\w+)}/g,function(Ce,he){return"?"})});ee=[fe].concat((0,Se.A)(ne))}var te=Bt(ee),ve;try{for(te.s();!(ve=te.n()).done;){var se=ve.value;s[se]||(s[se]=[]),s[se].push(J)}}catch(ue){te.e(ue)}finally{te.f()}};for(c.s();!(d=c.n()).done;)f()}catch(X){c.e(X)}finally{c.f()}var p={};for(var v in e.widgets){var g=e.widgets[v],h=g.spelImportFuncs,b=g.type;if(h){var O=Bt(h),S;try{for(O.s();!(S=O.n()).done;){var A=S.value;if(typeof A=="string"){var L=A.replace(/\${(\w+)}/g,function(X,W){return"?"}),F=(0,Se.A)(A.matchAll(/\${(\w+)}/g)).map(function(X){var W=(0,we.A)(X,2),J=W[0],G=W[1];return G});p[L]||(p[L]=[]),p[L].push({w:v,argsOrder:F})}}}catch(X){O.e(X)}finally{O.f()}}}var P={};for(var N in e.operators){var k=e.operators[N],I=k.spelOp;if(I!=null&&I.includes("${0}")){var B=I.replace(/\${(\w+)}/g,function(X,W){return"?"}),U=(0,Se.A)(I.matchAll(/\${(\w+)}/g)).map(function(X){var W=(0,we.A)(X,2),J=W[0],G=W[1];return G});P[B]||(P[B]=[]),P[B].push({op:N,argsOrder:U})}}var x=Nu.replace(/\${(\w+)}/g,function(X,W){return"?"});return P[x]=[{op:"!compare",argsOrder:["0","1"]}],{operators:t,conjunctions:o,funcs:s,valueFuncs:p,opFuncs:P}},qo=function n(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(e){var u,i=!0;if(e.type.indexOf("op-")===0||e.type==="matches")u=av(e,t,r,a,o);else if(e.type=="!aggr"){var l,s=n(e.source,t,r,a,nr(nr({},e),{},{_groupField:o?._groupField})),c=n(e.filter,t,r,a,nr(nr({},e),{},{_groupField:s?.value}));((l=c)===null||l===void 0?void 0:l.type)=="rule"&&(c=va(c,r,e.filter.not)),u={groupFilter:c,groupFieldValue:s},o||(u=void 0,a.errors.push("Unexpected !aggr in root"),i=!1)}else if(e.type=="ternary"){var d={};e.val.forEach(function(p){var v=(0,we.A)(p,2),g=v[0],h=v[1],b=Yu(g,h,t,r,a,e);b&&(d[b.id]=b)}),u={type:"switch_group",id:sr(),children1:d,properties:{}}}if(!u&&i&&(u=Wn(e,t,r,a,o)),u&&!u.type&&!o){var f=Qu(e,t,r,a);f?u=f:(u=void 0,a.errors.push("Can't convert rule of type ".concat(e.type,", it looks like var/literal")))}return u}},av=function n(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u,i=e.type.startsWith("op-")?e.type.slice(3):e.type,l=(i=="minus"||i=="plus")&&e.children.length==1;if(l)return e.isUnary=!0,n(e.children[0],t,r,a,e);var s=i=="and"&&e.children.length==2&&e.children[0].type=="op-ge"&&e.children[1].type=="op-le",c=i=="or"&&e.children.length==2&&e.children[0].type=="op-lt"&&e.children[1].type=="op-gt",d=s||c;if(d){var f=(0,we.A)(e.children[0].children,2),p=f[0],v=f[1],g=(0,we.A)(e.children[1].children,2),h=g[0],b=g[1],O=dv(p,h,e,t,r,a,o);if(O){var S=v.val,A=b.val,L={type:"op-between",children:[p,v,b],not:c};return n(L,t,r,a,o)}}var F=t.operators[i];i=="eq"&&e.children[1].type=="null"?F=["is_null"]:i=="ne"&&e.children[1].type=="null"?F=["is_not_null"]:i=="le"&&e.children[1].type=="string"&&e.children[1].val==""?F=["is_empty"]:i=="gt"&&e.children[1].type=="string"&&e.children[1].val==""?F=["is_not_empty"]:i=="between"&&(F=["between"]);var P=function(){var Pe,Ne=e.children.map(function(Be){return qo(Be,t,r,a,nr(nr({},e),{},{_groupField:o?._groupField}))});return Ne.length>=2&&((Pe=Ne)===null||Pe===void 0||(Pe=Pe[0])===null||Pe===void 0?void 0:Pe.type)=="!compare"&&(Ne=Ne[0].children),Ne};if(i=="and"||i=="or"){var N={},k=P();k.forEach(function(he){if(he){var Pe=sr();he.id=Pe,he.type!=null?N[Pe]=he:a.errors.push("Bad item in AND/OR: ".concat(JSON.stringify(he)))}}),u={type:"group",id:sr(),children1:N,properties:{conjunction:t.conjunctions[i],not:e.not}}}else if(F){var I,B,U=P(),x=U[0],X=U.slice(1),W=x==null||(I=x.groupFieldValue)===null||I===void 0?void 0:I.value,J=(B=X)===null||B===void 0?void 0:B[0],G=F[0];if(F.length>1){var ee,ie,de=((ee=U[0])===null||ee===void 0?void 0:ee.valueType)||((ie=U[1])===null||ie===void 0?void 0:ie.valueType),fe=x?.value,ne=F.map(function(he){return{op:he,widget:Tr(r,fe,he)}});if(vn.warn("[spel] Spel operator ".concat(i," can be mapped to ").concat(F,"."),"widgets:",ne,"vals:",U,"valueType=",de),i=="eq"||i=="ne"){var te=ne.find(function(he){var Pe=he.op,Ne=he.widget;return Ne&&Ne!="field"});te&&(G=te.op)}}x!=null&&x.groupFieldValue&&(J&&J.groupFieldValue&&J.groupFieldValue.valueSrc=="field"&&J.groupFieldValue.value==W?(G="all",X=[]):G=="equal"&&J.valueSrc=="value"&&J.valueType=="number"&&J.value==0?(G="none",X=[]):G=="greater"&&J.valueSrc=="value"&&J.valueType=="number"&&J.value==0&&(G="some",X=[]));var ve=!0,se=!1;if(e.not&&ve){var ue=r.operators[G];ue.reversedOp?(G=ue.reversedOp,e.not=!1):se=!0}if(x)if(x.groupFieldValue)x.groupFieldValue.valueSrc!="field"&&a.errors.push("Expected group field ".concat(JSON.stringify(x))),u=cv(x,G,X,r,a);else{x.valueSrc!="field"&&x.valueSrc!="func"&&a.errors.push("Expected field/func at LHS, but got ".concat(JSON.stringify(x)));var Ce=x.value;u=Jo(r,a,Ce,G,X)}se&&(u.type!=="group"?u=va(u,r,e.not):u.properties.not=!u.properties.not)}else o||(u=Qu(e,t,r,a));return u},Ju=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,o=e.map(function(u){if(u.type=="variable"||u.type=="property"||u.type=="indexer"&&u.itype=="string")return u.val;var i,l;a=!0,r&&(t==null||(i=t.errors)===null||i===void 0||(l=i.push)===null||l===void 0||l.call(i,"Unexpected item in field path compound: ".concat(JSON.stringify(u))))});return a?void 0:o},Wn=function n(e,t,r,a,o){if(e!=null){var u=r.settings.fieldSeparator;if(e.type=="variable"||e.type=="property"){var i=Qa(r,e.val,o?._groupField),l=Re(r,i),s=e.type=="variable";return{valueSrc:"field",valueType:l?.type,isVariable:s,value:i}}else if(e.type=="compound"){var c=Ju(e.children,a);if(c){var d,f=Qa(r,c.join(u),o?._groupField),p=Re(r,f),v=((d=e.children)===null||d===void 0||(d=d[0])===null||d===void 0?void 0:d.type)=="variable";return{valueSrc:"field",valueType:p?.type,isVariable:v,value:f}}}else if(Ku[e.type]){var g=e.val,h=Ku[e.type];return o!=null&&o.isUnary&&(g=-g),{valueSrc:"value",valueType:h,value:g}}else if(e.type=="!new"&&Hu[e.cls.at(-1)]){var b=e.args.map(function(I){return n(I,t,r,a,e)}),O=b?.[0],S=Hu[e.cls.at(-1)];return nr(nr({},O),{},{valueType:S})}else if(e.type=="list"){var A,L=e.val.map(function(I){return n(I,t,r,a,e)}),F=L.length?(A=L[0])===null||A===void 0?void 0:A.valueType:null,P=L.map(function(I){return I?.value}),N=Xp;return{valueSrc:"value",valueType:N,value:P}}else if(e.type=="op-plus"&&o?.type=="ternary")return Xu(e,t,r,a);var k=uv(e,t,r,a,o);if(k!==void 0)return k;a.errors.push("Can't convert arg of type ".concat(e.type))}},ov=function(e){var t=[{s:"",params:[],objs:[]}];return iv(e,t),t.map(function(r){var a=r.s,o=r.params;return{s:a,params:o}}).reverse().filter(function(r){var a=r.s;return a!==""&&a!=="?"})},iv=function n(e,t){var r=[],a="",o=e.type,u=e.methodName,i=e.val,l=e.obj,s=e.args,c=e.isVar,d=e.cls,f=e.children,p=f?.[f.length-1],v=t[t.length-1];if(o==="!func"){for(var g=l;g;){var h,b=n(nr(nr({},g),{},{obj:null}),[{}]),O=(0,we.A)(b,2),S=O[0],A=O[1];if(S!=="?"){var L={s:v.s,params:(0,Se.A)(v.params),objs:(0,Se.A)(v.objs)};v.objs.unshift("?"),v.params.unshift(g),t.push(L),v=t[t.length-1]}v.objs.unshift(S),(h=v.params).unshift.apply(h,(0,Se.A)(A)),g=g.type==="!func"?g.obj:null}var F=Bt(t),P;try{for(F.s();!(P=F.n()).done;){var N,k=P.value;r=[].concat((0,Se.A)(k?.params||[]),(0,Se.A)(s||[])),a="",k!=null&&(N=k.objs)!==null&&N!==void 0&&N.length&&(a+=k.objs.join(".")+"."),a+=(c?"#":"")+u,a+="("+(s||[]).map(function(I){return"?"}).join(", ")+")",k.s=a,k.params=r}}catch(I){F.e(I)}finally{F.f()}}else o==="!new"?(r=s||[],a="new ".concat(d.join("."),"(").concat(r.map(function(I){return"?"}).join(", "),")")):o==="!type"?a="T(".concat(d.join("."),")"):o==="compound"&&p.type==="property"&&Zp(p.val)?a=f.map(function(I){var B;if(I===p)return I.val;var U=n(nr(nr({},I),{},{obj:null}),[{}]),x=(0,we.A)(U,2),X=x[0],W=x[1];return(B=r).push.apply(B,(0,Se.A)(W)),X}).join("."):(r=[e],a="?");return v&&(v.s=a,v.params=r),[a,r]},uv=function(e,t,r,a,o){var u,i=function(J){return Wn(J,t,r,a,nr(nr({},e),{},{_groupField:o?._groupField}))},l=ov(e),s=l==null||(u=l[0])===null||u===void 0?void 0:u.s;l.length&&vn.debug("Signatures for ",e,":",s,l);var c=lv(e,t,r,a,o,l,i);if(c!==void 0)return c;var d=sv(e,t,r,a,o,l,i);if(d!==void 0)return d;var f,p,v,g=Bt(l),h;try{var b=function(){var J=h.value,G=J.s,ee=J.params,ie=t.funcs[G];if(ie){f=ie[0],p=Gr(r,f);var de=p,fe=de.spelFunc,ne=ee.map(i),te=(0,Se.A)(fe.matchAll(/\${(\w+)}/g)).map(function(ve){var se=(0,we.A)(ve,2),ue=se[0],Ce=se[1];return Ce});return v=Object.fromEntries(te.map(function(ve,se){return[ve,ne[se]]})),1}};for(g.s();!(h=g.n()).done&&!b(););}catch(W){g.e(W)}finally{g.f()}if(!f){var O=Bt(Qn(r)),S;try{for(O.s();!(S=O.n()).done;){var A=(0,we.A)(S.value,2),L=A[0],F=A[1];if(F.spelImport){var P=void 0;try{P=F.spelImport(e)}catch{}if(P){f=L,p=Gr(r,f),v={};for(var N in P)v[N]=i(P[N])}}}}catch(W){O.e(W)}finally{O.f()}}if(f){var k={};for(var I in p.args){var B=p.args[I],U=v[I];if(U===void 0)if(U=B?.defaultValue,U===void 0){if(!(B!=null&&B.isOptional)){a.errors.push("No value for arg ".concat(I," of func ").concat(f));return}}else{var x;U={value:U,valueSrc:(x=U)!==null&&x!==void 0&&x.func?"func":"value",valueType:B.type}}U&&(k[I]=U)}return{valueSrc:"func",value:{func:f,args:k},valueType:p.returnType}}var X=e.methodName;X&&a.errors.push("Signature ".concat(s," - failed to convert"))},lv=function(e,t,r,a,o,u,i){var l,s,c,d=[];for(var f in r.widgets){var p=r.widgets[f],v=p.spelImportFuncs;if(v)for(var g=0;g<v.length;g++){var h=v[g];if(zu(h)){var b={};if(iu(h,e,b)){for(var O in b)b[O]=i(b[O]);d.push({s:"widgets.".concat(f,".spelImportFuncs[").concat(g,"]"),w:f,argsObj:b})}}}}var S=Bt(u),A;try{for(S.s();!(A=S.n()).done;){var L=A.value,F=L.s,P=L.params,N=t.valueFuncs[F]||[],k=Bt(N),I;try{var B=function(){var ue=I.value,Ce=ue.w,he=ue.argsOrder,Pe=P.map(i),Ne=Object.fromEntries(he.map(function(Be,Qe){return[Be,Pe[Qe]]}));d.push({s:F,w:Ce,argsObj:Ne})};for(k.s();!(I=k.n()).done;)B()}catch(se){k.e(se)}finally{k.f()}}}catch(se){S.e(se)}finally{S.f()}for(var U=0,x=d;U<x.length;U++){var X=x[U],W=X.s,J=X.w,G=X.argsObj,ee=r.widgets[J],ie=ee.spelImportValue,de=ee.type;c=J,s=W,l=[];for(var fe in G)["value"].includes(G[fe].valueSrc)||l.push("".concat(fe," has unsupported value src ").concat(G[fe].valueSrc));var ne=G.v.value;if(ie&&!l.length){var te=ie.call(r.ctx,G.v,ee,G),ve=(0,we.A)(te,2);ne=ve[0],l=ve[1],l&&!Array.isArray(l)&&(l=[l])}if(!l.length)return{valueSrc:"value",valueType:de,value:ne}}c&&l.length&&a.errors.push("Signature ".concat(s," - looks like convertable to ").concat(c,", but: ").concat(l.join("; ")))},sv=function(e,t,r,a,o,u,i){var l,s,c,d=Bt(u),f;try{for(d.s();!(f=d.n()).done;){var p=f.value,v=p.s,g=p.params,h=t.opFuncs[v]||[],b=Bt(h),O;try{var S=function(){var F,P=O.value,N=P.op,k=P.argsOrder,I=g.map(i);if(s=N,N==="!compare"){if(o.type.startsWith("op-")&&o.children.length==2&&o.children[1].type=="number"&&o.children[1].val===0)return{v:{type:"!compare",children:I}};l.push("Result of compareTo() should be compared to 0")}c=v,l=[];var B=r.operators[s],U=B.spelOp,x=B.valueTypes,X=Object.fromEntries(k.map(function(ee,ie){return[ee,I[ie]]})),W=X[0],J=Object.keys(X).filter(function(ee){return parseInt(ee)>0}).map(function(ee){return X[ee]}),G=(F=I.filter(function(ee){return!!ee}).find(function(ee){var ie=ee.valueSrc;return ie==="value"}))===null||F===void 0?void 0:F.valueType;if(x&&G&&!x.includes(G)&&l.push("Op supports types ".concat(x,", but got ").concat(G)),!l.length)return{v:Jo(r,a,W,s,J,e)}},A;for(b.s();!(O=b.n()).done;)if(A=S(),A)return A.v}catch(L){b.e(L)}finally{b.f()}}}catch(L){d.e(L)}finally{d.f()}s&&l.length&&a.errors.push("Signature ".concat(c," - looks like convertable to ").concat(s,", but: ").concat(l.join("; ")))},Jo=function(e,t,r,a,o,u){var i;if(!o.filter(function(O){return O===void 0}).length){var l=(i=r)!==null&&i!==void 0&&i.func?"func":"field";zu(r)&&r.valueSrc&&(l=r.valueSrc,r=r.value);var s=Re(e,r);if(!s){t.errors.push("No config for field ".concat(r));return}var c=!0,d=!1;if(u!=null&&u.not&&c){var f=e.operators[a];f.reversedOp?(a=f.reversedOp,u.not=!1):d=!0}var p=Tr(e,r,a),v=e.widgets[p||s.mainWidget],g=o.map(function(O){return O.asyncListValues}).filter(function(O){return O!=null}),h=g.length?g[0]:void 0,b={type:"rule",id:sr(),properties:nr({field:r,fieldSrc:l,operator:a,value:o.map(function(O){return O.value}),valueSrc:o.map(function(O){return O.valueSrc}),valueType:o.map(function(O){return O.valueSrc=="value"&&(v?.type||s?.type)||O.valueType})},h?{asyncListValues:h}:{})};return d&&(b=va(b,e,u?.not),u!=null&&u.not&&(u.not=!1)),b}},cv=function(e,t,r,a,o){var u=e.groupFilter,i=e.groupFieldValue;if(i.valueSrc!="field")throw"Bad groupFieldValue: ".concat(JSON.stringify(i));var l=i.value,s=Jo(a,o,l,t,r);if(s){var c=Re(a,l),d=c?.mode,f;return u?.type==="group"?f=nr(nr({},u||{}),{},{type:"rule_group",properties:nr(nr(nr({},s.properties),u?.properties||{}),{},{mode:d})}):u?f=nr(nr({},s||{}),{},{type:"rule_group",children1:[u],properties:nr(nr({},s.properties),{},{mode:d})}):f=nr(nr({},s||{}),{},{type:"rule_group",properties:nr(nr({},s.properties),{},{mode:d})}),f.id||(f.id=sr()),f}},dv=function(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(e.type==t.type)if(e.type=="!aggr"){var l=[e.source,t.source].map(function(h){return Wn(h,a,o,u,nr(nr({},r),{},{_groupField:i?._groupField}))}),s=(0,we.A)(l,2),c=s[0],d=s[1];return c.value==d.value}else{var f=[e,t].map(function(h){return Wn(h,a,o,u,nr(nr({},r),{},{_groupField:i?._groupField}))}),p=(0,we.A)(f,2),v=p[0],g=p[1];return v.value==g.value}return!1},Qu=function(e,t,r,a){var o={},u=null,i=Yu(u,e,t,r,a);i&&(o[i.id]=i);var l={type:"switch_group",id:sr(),children1:o,properties:{}};return l},Yu=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=fv(a,o,r,t,u),l;return e?(l=qo(e,r,a,o,u),l&&l.type?(l.type!="group"&&(l=va(l,a)),l.type="case_group"):(o.errors.push("Unexpected case: ".concat(JSON.stringify(l))),l=void 0)):l={id:sr(),type:"case_group",properties:{}},l&&(l.properties=nr(nr({},l.properties),i)),l},Xu=function(e,t,r,a){var o=[];function u(i){i.map(function(l){if(l.type=="op-plus")u(l.children);else{var s=Wn(l,t,r,a,e);s?o.push(s):a.errors.push("Can't convert ".concat(l.type," in concatenation"))}})}return u(e.children),{valueSrc:"value",valueType:"case_value",value:o}},fv=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u={},i;a?.type=="op-plus"?i=Xu(a,r,e,t):i=Wn(a,r,e,t,o);var l=e.widgets.case_value,s=l?.spelImportValue;if(s){var c=s(i),d=(0,we.A)(c,2),f=d[0],p=d[1];p.map(function(v){return t.errors.push(v)}),f&&(u={value:[f],valueSrc:["value"],valueType:["case_value"]})}else t.errors.push("No fucntion to import case value");return u},lb=function(e,t,r,a,o){if(e)return{type:"rule_group",id:uuid(),children1:_defineProperty({},e.id,e),properties:{conjunction:o||defaultGroupConjunction(a,r),not:!1,field:t}}},va=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return{type:"group",id:sr(),children1:(0,re.A)({},e.id,e),properties:{conjunction:Kt(t),not:r||!1}}};function Zu(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function pv(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Zu(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Zu(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var el=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=e.settings.defaultField,o=(r?rl(e,r):a)||t&&Rs(e,r)||null;return o!=null&&typeof o!="string"&&!Gn(o)&&(o=pa(o)),o},rl=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!r)return null;var a=(e==null||(t=e.settings)===null||t===void 0?void 0:t.fieldSeparator)||".",o=Re(e,r),u=o?.defaultField;return u&&(u=[].concat((0,Se.A)(Vr(r)),[u]).join(a)),u},Qo=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return r&&((t=e.settings.fieldSources)===null||t===void 0?void 0:t[0])||"field"},Yo=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=e.settings.defaultOperator,o=Re(e,t),u=o?.operators||[];a&&!u.includes(a)&&(a=null);var i=o?.defaultOperator;i&&!u.includes(i)&&(i=null),!i&&r&&(i=ui(e,t));var l=o?._origDefaultOperator,s=l&&i||a||i;return s},ga=function(e,t,r){var a=t?cr(e,t,r):null;return a&&a.options?new ye.default.Map(a.options&&a.options.defaults||{}):null},Wt=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=null,i=null,l=null,s=e.settings.showErrorMessage;if(r){var c,d,f;l=r==null||(c=r.properties)===null||c===void 0?void 0:c.fieldSrc,u=r==null||(d=r.properties)===null||d===void 0?void 0:d.field,i=r==null||(f=r.properties)===null||f===void 0?void 0:f.operator}else a?(u=el(e,o,t),u?l=Gn(u)?"func":"field":l=Qo(e),i=Yo(e,u,!0)):l=Qo(e);var p=new ye.default.Map({fieldSrc:l,field:u,operator:i,value:new ye.default.List,valueSrc:new ye.default.List,operatorOptions:ga(e,i,u)});if(s&&(p=p.set("valueError",new ye.default.List)),u&&i){var v=!1,g=Tn(e,e,p,u,i,"operator",v),h=g.newValue,b=g.newValueSrc,O=g.newValueType,S=g.newValueError,A=g.newFieldError;p=p.set("value",h).set("valueSrc",b).set("valueType",O),s&&(p=p.set("valueError",S).set("fieldError",A))}return p},Ua=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;t=Re(e,t);var r=t&&t.conjunctions||Object.keys(e.conjunctions);return r.length==1?r[0]:e.settings.defaultGroupConjunction||e.settings.defaultConjunction||r[0]},Kt=function(e){return e.settings.defaultConjunction||Object.keys(e.conjunctions)[0]},mn=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return new ye.default.Map({conjunction:Ua(e,t),not:!1})},tl=function(e,t){var r;return t&&t.type=="group"?mn(e,t==null||(r=t.properties)===null||r===void 0?void 0:r.field):Wt(e,null,t)},nl=function(e,t){return(0,re.A)({},e,new ye.default.Map({type:"rule",id:e,properties:Wt(t)}))},vv=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return new ye.default.Map({type:"group",id:sr(),children1:new ye.default.OrderedMap(t?pv({},nl(sr(),e)):{}),properties:mn(e)})},gv=function(e){return new ye.default.List(e)},mv=function(){return new ye.default.Map};function al(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=hv(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function hv(n,e){if(n){if(typeof n=="string")return ol(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ol(n,e)}}function ol(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function il(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function ul(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?il(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):il(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var ll=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o={errors:[],settings:{isForDisplay:r,isDebugMode:a}},u=xt(t,void 0,!1),i=sl(e,u,o,null);return o.errors.length&&console.warn("Errors while exporting to string:",o.errors),i},sl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(e){var o=e.get("type"),u=e.get("children1");if(o==="group"||o==="rule_group")return yv(e,t,r,a);if(o==="rule")return cl(e,t,r,a)}},yv=function(e,t,r){var a,o,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=r.settings,l=i.isForDisplay,s=i.isDebugMode,c=e.get("type"),d=e.get("properties")||new ye.Map,f=d.get("mode"),p=e.get("children1")||new ye.List,v=c==="rule_group",g=v&&f=="array"?d.get("field"):null,h=c==="rule_group"?d.get("operator"):null,b=h?(a=(o=t.operators[h])===null||o===void 0?void 0:o.cardinality)!==null&&a!==void 0?a:1:void 0,O=v&&f==="array"&&b>=1,S=d.get("not"),A=p.map(function(x){return sl(x,t,r,g)}).filter(function(x){return typeof x<"u"});if(!(!O&&!A.size&&!s)){var L=d.get("conjunction");L||(L=Kt(t));var F=t.conjunctions[L],P=A.size?F.formatConj(A,L,S,l):null,N;if(g){var k=cl(e,t,r,u,!0);if(k){var I,B=k.pop(),U=[P].concat((0,Se.A)(k));N=(I=t.settings).formatAggr.apply(I,(0,Se.A)(U)),B&&(N=t.settings.formatReverse(N,null,null,null,null,l))}}else N=P;return s&&N==null&&(N="?"),N}},Ov=function(e,t,r,a,o){var u=r.settings,i=u.isForDisplay,l=u.isDebugMode,s=t.get("field"),c=t.get("valueSrc"),d=t.get("valueType"),f=Re(e,s)||{},p=a||t.get("operator"),v=cr(e,p,s)||{},g=Mr(v),h=t.get("value"),b=t.get("asyncListValues"),O=[],S=[],A,L;if(h!=null){L=h.map(function(N,k){var I=c?c.get(k):null,B=d?d.get(k):null,U=l?N:Ln(N,I,e),x=Tr(e,s,p,I),X=Er()(rt(e,s,p,x,I),["factory"]),W=Xo(e,r,U,I,B,X,f,p,v,o,b);return W!==void 0&&(O.push(I),S.push(B)),W});var F=L.filter(function(N){return N===void 0}).size>0,P=!F&&L.size===g;P&&(A=g==1?L.first():L)}return l&&!A&&(A=g>1?new ye.List(Array.from({length:g}).map(function(N,k){var I,B;return(I=(B=L)===null||B===void 0?void 0:B.get(k))!==null&&I!==void 0?I:"?"})):"?"),[A,O.length>1?O:O[0],S.length>1?S:S[0]]},bv=function(e,t,r){var a=r.settings.isDebugMode,o=t?.labelForFormat||e,u=Mr(t),i;return u==0?i=function(s,c,d,f,p,v,g,h){return"".concat(s," ").concat(o)}:u==1?i=function(s,c,d,f,p,v,g,h){return a&&c==="?"&&d==="?"?s&&s!=="?"?"".concat(s," ?"):"?":"".concat(s," ").concat(o," ").concat(d)}:u==2&&(i=function(s,c,d,f,p,v,g,h){var b,O,S=d==null||(b=d.first)===null||b===void 0?void 0:b.call(d),A=d==null||(O=d.get)===null||O===void 0?void 0:O.call(d,1);return"".concat(s," ").concat(o," ").concat(S," AND ").concat(A)}),i},cl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=r.settings,i=u.isForDisplay,l=u.isDebugMode,s=e.get("properties")||new ye.Map,c=s.get("field"),d=s.get("fieldSrc"),f=s.get("operator"),p=s.get("operatorOptions");if(!((c==null||f==null)&&!l)){var v=Re(t,c)||{},g=cr(t,f,c)||{},h=g.reversedOp,b=cr(t,h,c)||{},O=!1,S=g.formatOp;if(!S&&h&&(S=b.formatOp,S)){O=!0;var A=[h,f];f=A[0],h=A[1];var L=[b,g];g=L[0],b=L[1]}if(l&&!f&&(f="?"),S||(S=bv(f,g,r)),!!S){var F=d==="func"?fl(t,r,c,a):dl(t,r,c,a);if(F!=null){var P=Ov(t,s,r,f,a),N=(0,we.A)(P,3),k=N[0],I=N[1],B=N[2];if(k!==void 0){var U=[F,f,k,I,B,Er()(g,_n),p,i,v,O];if(o)return U;var x,X=(x=S).call.apply(x,[t.ctx].concat(U));return O&&(X=t.settings.formatReverse(X,f,h,g,b,i)),X}}}}},Xo=function(e,t,r,a,o,u,i,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0,f=t.settings,p=f.isForDisplay,v=f.isDebugMode;if(r===void 0)return v?u?.jsType==="array"?[]:"?":void 0;var g;if(a=="field")g=dl(e,t,r,c);else if(a=="func")g=fl(e,t,r,c);else if(typeof u.formatValue=="function"){var h=u.formatValue,b=[r,ul(ul({},Ut()(i,["fieldSettings","listValues"])),{},{asyncListValues:d}),Er()(u,En),p];if(l&&(b.push(l),b.push(s)),a=="field"){var O=Re(e,r)||{};b.push(O)}g=h.call.apply(h,[e.ctx].concat(b))}else g=r;return g},dl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,u=t.settings,i=u.isForDisplay,l=u.isDebugMode,s=e.settings,c=s.fieldSeparator,d=s.fieldSeparatorDisplay,f=null;if(r){var p=Re(e,r)||{},v=Vr(r,e),g=ha(r,e,o?a:null),h=g?g.join(d):null,b=p.label2||h,O=e.settings.formatField,S=un(r,e,t,o?a:null,{useTableName:!0});f=O(S,v,b,p,e,i)}else l&&(f="?");return f},fl=function(e,t,r){var a,o,u,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,l=t.settings,s=l.isForDisplay,c=l.isDebugMode,d=r==null||(a=r.get)===null||a===void 0?void 0:a.call(r,"func");if(!d)return c?"?()":void 0;var f=(o=r.get)===null||o===void 0?void 0:o.call(r,"args"),p=Gr(e,d);if(!p&&!c){t.errors.push("Func ".concat(d," is not defined in config"));return}var v=Vr(d,e),g=v[v.length-1],h=s&&p?.label||g,b={},O=[],S=[],A={},L=p?Object.keys(p.args||{}):(f==null||(u=f.keySeq)===null||u===void 0?void 0:u.call(f).toArray())||[],F=al(L),P;try{for(F.s();!(P=F.n()).done;){var N,k=P.value,I=p?.args[k],B=Re(e,I),U=I||{},x=U.defaultValue,X=U.isOptional,W=x!=null&&x.func?"func":"value",J=s&&I?.label||k,G=f?f.get(k):void 0,ee=G?G.get("value"):void 0,ie=G?G.get("valueSrc"):void 0;ie!=="func"&&(N=ee)!==null&&N!==void 0&&N.toJS&&(ee=ee.toJS());var de=G?G.get("asyncListValues"):void 0,fe=Xo(e,t,ee,ie,I?.type,B,I,null,null,i,de);ee!=null&&fe===void 0&&ie!="func"&&t.errors.push("Can't format value of arg ".concat(k," for func ").concat(d));var ne=void 0;if(fe===void 0&&!X&&x!=null&&(ne=Xo(e,t,x,W,I?.type,B,I,null,null,i,de),ne===void 0)){W!="func"&&t.errors.push("Can't format default value of arg ".concat(k," for func ").concat(d));return}var te=fe??ne;if(te!==void 0){if(O.length){var ve=al(k),se;try{for(ve.s();!(se=ve.n()).done;){var ue=(0,we.A)(se.value,2),Ce=ue[0],he=ue[1];b[Ce]=void 0}}catch(Je){ve.e(Je)}finally{ve.f()}O=[]}b[k]=te,A[J]=te}else X||S.push(k),O.push([k,J])}}catch(Je){F.e(Je)}finally{F.f()}if(!(S.length&&!c)){var Pe=null;if(typeof p?.formatFunc=="function"){var Ne=p.formatFunc,Be=[b,s];Pe=Ne.call.apply(Ne,[e.ctx].concat(Be))}else{var Qe=Object.entries(s?A:b).map(function(Je){var We=(0,we.A)(Je,2),or=We[0],ar=We[1];return s?"".concat(or,": ").concat(ar):"".concat(ar)}).join(", ");Pe="".concat(h,"(").concat(Qe,")")}return Pe}},pl="EMPTY_GROUP",vl="EMPTY_RULE_GROUP",gl="EMPTY_QUERY",ml="EMPTY_CASE",hl="NO_CONFIG_FOR_FIELD",yl="NO_CONFIG_FOR_OPERATOR",Sv="FIXED_OPERATOR",Ol="NO_CONFIG_FOR_FUNCTION",bl="INVALID_VALUE",Sl="INVALID_FUNC_ARG_VALUE",Fl="UNSUPPORTED_FIELD_TYPE",El="UNSUPPORTED_OPERATOR_FOR_FIELD",Cl="INVALID_VALUE_SRC",Zo="INCOMPLETE_RULE",Tl="INCOMPLETE_LHS",Al="INCOMPLETE_RHS",ei="BAD_MULTISELECT_VALUES",Ll="BAD_SELECT_VALUE",wl="INCORRECT_VALUE_TYPE",Rl="INCORRECT_VALUE_JS_TYPE",Pl="VALUE_LENGTH_CONSTRAINT_FAIL",jl="VALUE_MIN_CONSTRAINT_FAIL",Il="VALUE_MAX_CONSTRAINT_FAIL",Vl="NO_CONFIG_FOR_FIELD_VALUE",Dl="CANT_COMPARE_FIELD_WITH_ITSELF",Nl="CANT_COMPARE_FIELD_WITH_FIELD",xl="INCORRECT_FIELD_TYPE",kl="UNSUPPORTED_FUNCTION_FOR_FIELD",Ml="REQUIRED_FUNCTION_ARG",_l="INCORRECT_FUNCTION_RETURN_TYPE",Gl="INVALID_RANGE",on="ITEM_POSITION",$l="ITEM_POSITION_ROOT",Ul="ITEM_POSITION_WITH_INDEX_PATH",Bl="ITEM_POSITION_IN_CASE",Fv=y(72635),Kn,Ev=(Kn={},(0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)(Kn,pl,"Empty group"),vl,"No conditions for group field {{field}}"),gl,"Empty query"),ml,"Empty case"),hl,"No config for field {{field}}"),Sv,"Fixed operator {{from}} to {{to}} for field {{field}}"),yl,"No config for operator {{operator}}"),Ol,"No config for function {{funcKey}}"),bl,"Invalid value"),Sl,"Invalid value of arg {{argName}} for func {{funcName}}: {{argValidationError}}"),(0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)(Kn,Fl,"Type of field {{field}} is not supported"),El,"Operator {{operator}} is not supported for field {{field}}"),Zo,"Incomplete rule"),Tl,"Incomplete LHS"),Al,"Incomplete RHS"),Cl,"Invalid value src {{valueSrcs, list}}"),ei+"_one","Value {{badValues, list}} is not in the list of allowed values"),ei+"_other","Values {{badValues, list}} are not in the list of allowed values"),Ll,"Value {{value}} is not in the list of allowed values"),wl,"Value should have type {{wType}}, but got value of type {{valueType}}"),(0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)(Kn,Rl,"Value should have JS type {{jsType}}, but got value of type {{valueTypeof}}"),Pl,"Value {{value}} should have max length {{fieldSettings.maxLength}} but got {{length}}"),jl,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),Il,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),Vl,"No config for field {{field}}"),Dl,"Can't compare field {{field}} with itself"),Nl,"Can't compare field {{leftField}} with {{rightField}}"),xl,"Field {{field}} is of type {{type}}, but expected {{expected}}"),kl,"Unsupported function {{funcKey}} for field {{field}}"),Ml,"Value of arg {{argName}} for func {{funcName}} is required"),(0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)((0,re.A)(Kn,_l,"Function {{funcKey}} should return value of type {{returnType}}, but got {{valueType}}"),Gl,"Invalid range"),$l,"Root"),on+"__rule","Leaf #{{globalLeafNo}}"),on+"__group","Group #{{globalGroupNo}}"),on+"__rule_group","Rule-group #{{globalNoByType}}"),on+"__case_group","Case #{{globalNoByType}}"),on+"__rule__deleted","Deleted leaf #{{globalLeafNo}}"),on+"__group__deleted","Deleted group #{{globalGroupNo}}"),on+"__rule_group__deleted","Deleted rule-group #{{globalNoByType}}"),(0,re.A)((0,re.A)((0,re.A)(Kn,on+"__case_group__deleted","Deleted case #{{globalNoByType}}"),Bl,"{{str}} in case #{{caseNo}}"),Ul,"{{str}} (index path: {{indexPath, list}})")),Wl="raqbvalidation",Cv="".concat(Wl,":"),Ba=Fv.default.createInstance();Ba.init({fallbackLng:"en"}),Ba.addResources("en",Wl,Ev);var Nt=function n(e,t){return e!=null&&e.str?e.str:e!=null&&e.key?n(e.key,e.args):t===null?e:Ba.t(e.includes(":")?e:Cv+e,t)};const Tv=Ba;function Kl(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Cr(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Kl(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Kl(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Hl=function(e){return(0,Fr.A)(e)==="object"&&e!==null&&Array.isArray(e)?"array":(0,Fr.A)(e)},Av=function(e,t){return Hl(e)===t||t==="number"&&!isNaN(e)},ri=function(e,t){return ti(e,t).length===0},ti=function(e,t){var r=t.settings.showErrorMessage,a=[];function o(u,i,l){var s,c,d=u.get("id"),f=u.get("children1"),p=u.getIn(["properties","valueError"]),v=u.getIn(["properties","fieldError"]),g=u.getIn(["properties","field"]),h=(s=g==null||(c=g.get)===null||c===void 0?void 0:c.call(g,"func"))!==null&&s!==void 0?s:g,b=p?.size>0&&p.filter(function(S){return S!=null}).size>0,O=b||!!v;O&&r&&a.push(h),f&&f.map(function(S,A){S&&o(S,i.concat(d),l+1)})}return e&&o(e,[],0),Array.from(new Set(a))},ni=function(e,t){var r=xt(t,void 0,!0),a={removeEmptyGroups:t.settings.removeEmptyGroupsOnLoad,removeIncompleteRules:t.settings.removeIncompleteRulesOnLoad,removeEmptyRules:t.settings.removeEmptyRulesOnLoad,forceFix:!1},o=ma(e,null,r,r,a),u=o.fixedTree,i=o.allErrors,l=o.isSanitized;return l&&i.length&&console.warn("Tree check errors: ",i),u},zl=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=xt(t,void 0,!0),o=Cr(Cr({},r),{},{removeEmptyGroups:!1,removeEmptyRules:!1,removeIncompleteRules:!1,forceFix:!1}),u=ma(e,null,a,a,o),i=u.allErrors;return i},ql=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=xt(t,void 0,!0),o=Cr({removeEmptyGroups:!0,removeEmptyRules:!0,removeIncompleteRules:!0,forceFix:!1},r),u=ma(e,null,a,a,o),i=u.fixedTree,l=u.fixedErrors,s=u.nonFixedErrors,c=u.allErrors;return{fixedTree:i,fixedErrors:l,nonFixedErrors:s,allErrors:c}},Jl=function(e,t,r,a,o,u,i){o===void 0&&(o=r.settings.removeEmptyGroupsOnLoad),u===void 0&&(u=r.settings.removeEmptyRulesOnLoad),i===void 0&&(i=r.settings.removeIncompleteRulesOnLoad);var l={removeEmptyGroups:o,removeEmptyRules:u,removeIncompleteRules:i,forceFix:!1},s=ma(e,t,r,a,l),c=s.fixedTree,d=s.allErrors,f=s.fixedErrors,p=s.nonFixedErrors,v=s.isSanitized;return v&&f.length&&console.warn("Fixed tree errors: ",f),c=Dt(c),c},ma=function(e,t,r,a,o){if(!e)return{fixedTree:e,allErrors:[],fixedErrors:[],nonFixedErrors:[],isSanitized:!1};var u=o||{},i=u.removeEmptyGroups,l=u.removeEmptyRules,s=u.removeIncompleteRules,c=u.forceFix,d=u.translateErrors,f=d===void 0?!0:d,p=u.includeStringifiedItems,v=p===void 0?!0:p,g=u.stringifyFixedItems,h=g===void 0?!1:g,b=u.stringifyItemsUserFriendly,O=b===void 0?!0:b,S=u.includeItemsPositions,A=S===void 0?!0:S,L={config:r,oldConfig:a,removeEmptyGroups:i,removeEmptyRules:l,removeIncompleteRules:s,forceFix:c},F={errors:{}},P=Yl(e,[],null,F,L),N=F.sanitized,k=[],I,B;A&&(I=ko(P).items);for(var U in F.errors){var x=F.errors[U],X=x.path,W=x.errors;f&&(W=W.map(function(tr){return Cr(Cr({},tr),{},{str:Nt(tr)})}));var J={path:X,errors:W};if(v){var G=$n(h?P:e,X),ee=X.length===1;if(!ee&&G.get("type")!=="group"){var ie=!0,de=O,fe=ll(G,r,de,ie);J.itemStr=fe}}if(A){var ne=I[U],te=!ne;if(te&&(B||(B=ko(e).items),ne=B[U]),ne){var ve=Cr(Cr({},ne.position),{},{index:ne.index,type:ne.type,isDeleted:te});J.itemPosition=ve;var se=ne.index?on+"__"+ne.type+(te?"__deleted":""):$l,ue=Cr({},ve);if(O){for(var Ce,he=0,Pe=["caseNo","globalLeafNo","globalGroupNo","globalNoByType"];he<Pe.length;he++){var Ne=Pe[he];ue[Ne]!=null&&(ue[Ne]=ue[Ne]+1)}ue.indexPath=(Ce=ve.indexPath)===null||Ce===void 0?void 0:Ce.map(function(tr){return tr+1})}J.itemPositionStr=Nt(se,ue),ne.index&&(ne.caseId&&ne.type!=="case_group"&&(J.itemPositionStr=Nt(Bl,Cr(Cr({},ue),{},{str:J.itemPositionStr}))),J.itemPositionStr=Nt(Ul,Cr(Cr({},ue),{},{str:J.itemPositionStr})))}}k.push(J)}for(var Be=[],Qe=[],Je=0,We=k;Je<We.length;Je++){var or=We[Je],ar=or.errors.filter(function(tr){return!!tr.fixed}),Ar=or.errors.filter(function(tr){return!tr.fixed&&tr.key!=="EMPTY_QUERY"});ar.length&&Be.push(Cr(Cr({},or),{},{errors:ar})),Ar.length&&Qe.push(Cr(Cr({},or),{},{errors:Ar}))}return{fixedTree:P,allErrors:k,fixedErrors:Be,nonFixedErrors:Qe,isSanitized:N}};function hn(n,e,t,r){var a=e.get("id");n.errors[a]||(n.errors[a]={path:[].concat((0,Se.A)(t),[a]),errors:[]}),n.errors[a].errors.push(r)}function Ql(n,e){var t=e.get("id");n.errors[t]&&n.errors[t].errors.map(function(r){r.fixed=!0})}function Yl(n,e,t,r,a){var o=n?.get("type");return o==="group"||o==="rule_group"||o=="case_group"||o=="switch_group"?Lv(n,e,t,r,a):o==="rule"?Xl(n,e,t,r,a):n}function Lv(n,e,t,r,a){var o,u,i,l,s,c,d=a.removeEmptyGroups,f=a.removeIncompleteRules,p=a.forceFix,v=a.config,g=v.settings.showErrorMessage,h=!g||p,b=n.get("id"),O=n.get("children1"),S=!e.length,A=O,L=n.get("type"),F=n.get("properties"),P=F?.get("field"),N=F?.get("mode"),k=F==null||(o=F.get)===null||o===void 0?void 0:o.call(F,"operator"),I=L==="rule_group"&&N==="array",B=L==="case_group",U=B&&O==null,x=k?(u=(i=v.operators[k])===null||i===void 0?void 0:i.cardinality)!==null&&u!==void 0?u:1:void 0,X=B?!U:I?x==0:!0;!b&&t&&(b=t,n=n.set("id",b),r.sanitized=!0),I&&(n=Xl(n,e,t,r,a));var W={errors:{}};O=(l=O)===null||l===void 0?void 0:l.map(function(de,fe){return Yl(de,e.concat(b),fe,W,a)});var J=(s=O)===null||s===void 0?void 0:s.filter(function(de){return de!=null});d&&(O=J);var G=W.sanitized||A?.size!=((c=O)===null||c===void 0?void 0:c.size),ee=!(J!=null&&J.size),ie=d&&!S;return I&&P&&(ie=f),ee&&X&&(hn(r,n,e,{key:S?gl:B?ml:I?vl:pl,args:{field:P},fixed:ie}),ie&&(Ql(r,n),n=void 0)),G&&(r.sanitized=!0),G&&n&&(n=n.set("children1",O)),r.errors=Cr(Cr({},r.errors),W?.errors||{}),n}function Xl(n,e,t,r,a){var o=a.removeIncompleteRules,u=a.removeEmptyRules,i=a.forceFix,l=a.config,s=a.oldConfig,c=l.settings.showErrorMessage,d=!c||i,f=n,p=n.get("id"),v=n.get("properties");if(!v){var g={key:Zo,args:{},fixed:o||u};hn(r,n,e,g);return}var h=v.get("field")||null,b=v.get("fieldSrc")||null,O=v.get("operator")||null,S=v.get("operatorOptions"),A=v.get("valueSrc"),L=v.get("value"),F=v.get("valueError"),P=v.get("fieldError"),N=function(){var Qe,Je;return{field:((Qe=h)===null||Qe===void 0||(Je=Qe.toJS)===null||Je===void 0?void 0:Je.call(Qe))||h,fieldSrc:b,operator:O,operatorOptions:S?S.toJS():{},valueSrc:A?A.toJS():null,value:L?L.toJS():null,valueError:F?F.toJS():null,fieldError:P||null}},k=N();!p&&t&&(p=t,n=n.set("id",p),r.sanitized=!0);var I=h?Re(l,h):null;h&&!I&&(hn(r,n,e,{key:hl,args:{field:h},side:"lhs",fixed:o||u}),h=null),h==null&&(v=["operator","operatorOptions","valueSrc","value","valueError","fieldError","field"].reduce(function(Be,Qe){return Be.delete(Qe)},v),O=null),b||(b=ws(h),v=v.set("fieldSrc",b)),(O==="range_between"||O==="range_not_between")&&(O=O==="range_between"?"between":"not_between",v=v.set("operator",O));var B=O?cr(l,O,h):null;O&&!B&&(hn(r,n,e,{key:yl,args:{operator:O},side:"op",fixed:o||u}),O=null);var U=h?Ha(l,h):[];h&&(U!=null&&U.length?O&&U.indexOf(O)==-1&&(O==="is_empty"||O==="is_not_empty"?(O=O==="is_empty"?"is_null":"is_not_null",v=v.set("operator",O)):(hn(r,n,e,{key:El,args:{operator:O,field:h},side:"lhs",fixed:o||u}),O=null)):(hn(r,n,e,{key:Fl,args:{field:h},side:"lhs",fixed:o||u}),O=null)),O==null&&(v=["operatorOptions","valueSrc","value","valueError"].reduce(function(Be,Qe){return Be.delete(Qe)},v)),S=v.get("operatorOptions"),!O||S&&!B.options?(S=null,v=v.delete("operatorOptions")):O&&!S&&B.options&&(S=ga(l,O,h),v=v.set("operatorOptions",S)),A=v.get("valueSrc"),L=v.get("value");var x=!0,X=Tn(l,s,v,h,O,null,d,x),W=X.newValue,J=X.newValueSrc,G=X.newValueError,ee=X.validationErrors,ie=X.newFieldError,de=X.fixedField;L=W,A=J,F=G,P=ie,h=de,v=v.set("field",h),v=v.set("value",L),v=v.set("valueSrc",A),c?v=v.set("valueError",F).set("fieldError",P):v=v.delete("valueError").delete("fieldError");var fe=N(),ne=!Da(k,fe),te=fi(v.toObject(),l),ve=te.score>=3;if(ne&&(r.sanitized=!0,n=n.set("properties",v)),ee?.map(function(Be){return hn(r,n,e,Be)}),!ve){var se=te.score?o:u,ue={key:Zo,args:{}};if(!te.parts.field)ue.key=Tl,ue.side="lhs";else if(!te.parts.value){var Ce,he,Pe,Ne;ue.key=Al,ue.side="rhs",(Ce=fe.valueSrc)!==null&&Ce!==void 0&&Ce[0]&&((he=fe.valueSrc)===null||he===void 0?void 0:he[0])!=((Pe=k.valueSrc)===null||Pe===void 0?void 0:Pe[0])&&((Ne=fe.value)===null||Ne===void 0?void 0:Ne[0])!=null&&(ue.key=Cl,ue.args={valueSrcs:fe.valueSrc})}ue.fixed=se,hn(r,n,e,ue),se&&(Ql(r,n),n=void 0)}return n}var Hn=function(e,t,r,a,o,u,i,l){var s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d=arguments.length>10&&arguments[10]!==void 0?arguments[10]:!1,f=[],p=o;if(o!=null){var v,g,h,b;if(i==="field"){var O=Pv(t,r,o,i,u,l,e,a,s,c),S=(0,we.A)(O,2);p=S[0],f=S[1]}else if(i==="func"){var A=jv(t,r,o,i,u,l,e,a,s,c,d),L=(0,we.A)(A,2);p=L[0],f=L[1]}else if(i==="value"||!i){var F=Rv(r,o,i,u,l,e,a,s,c),P=(0,we.A)(F,2);p=P[0],f=P[1]}var N=!((v=f)!==null&&v!==void 0&&v.find(function(ve){return!ve.fixed})),k=!!r&&!["field","func"].includes(i)&&(!((g=f)!==null&&g!==void 0&&g.length)||N);if(k){var I=Tr(e,r,a,i),B=a?cr(e,a,r):null,U=Er()(rt(e,r,a,I,i),["factory"]),x=i==="field"?Re(e,o):null,X=U,W=U.validateValue;if(typeof W=="function"){var J=[p,X,a,B];i==="field"&&J.push(x);var G=W.call.apply(W,[e.ctx].concat(J));if((0,Fr.A)(G)==="object"&&G!==null&&!Array.isArray(G)){var ee,ie;(ee=G.error)!==null&&ee!==void 0&&ee.key?ie=Cr({},G.error):ie={key:G.error,args:null},G.fixedValue!==void 0&&s&&(ie.fixed=!0,ie.fixedFrom=p,ie.fixedTo=G.fixedValue,p=G.fixedValue),f.push(ie)}else typeof G=="boolean"?G==!1&&f.push({key:bl,args:{}}):typeof G=="string"&&f.push({key:G,args:null})}}if(N=!((h=f)!==null&&h!==void 0&&h.find(function(ve){return!ve.fixed})),(b=f)!==null&&b!==void 0&&b.length&&!N&&s){var de=Re(e,r),fe=de?.fieldSettings,ne=fe?.defaultValue;if(ne!==void 0){var te=f[f.length-1];te.fixed=!0,te.fixedFrom=p,te.fixedTo=ne,p=ne,f.map(function(ve){ve.fixed=!0})}}}return[p,f]},wv=function(e,t,r,a,o){var u=ye.default.List.isList(e)?e.toJS():e instanceof Array?(0,Se.A)(e):void 0,i=e,l=[];if(u){var s=u.reduce(function(h,b){var O=(0,we.A)(h,2),S=O[0],A=O[1],L=fa(t,b);return L==null?[S,[].concat((0,Se.A)(A),[b])]:[[].concat((0,Se.A)(S),[L.value]),A]},[[],[]]),c=(0,we.A)(s,2),d=c[0],f=c[1],p=f.length>0;if(r=r||o===!0,i=r&&p?d:e,f.length){var v=r&&p;l.push({key:ei,args:{badValues:f,count:f.length},fixed:v,fixedFrom:v?u:void 0,fixedTo:v?i:void 0})}return[i,l]}else{var g=fa(t,e);return g==null?(i=r?null:e,l.push({key:Ll,args:{value:e},fixed:r,fixedFrom:r?e:void 0,fixedTo:r?i:void 0})):i=g.value,[i,l]}},Rv=function(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=[],d=t;if(e){var f=Re(u,e),p=Tr(u,e,i,r),v=u.widgets[p],g=v?.type,h=v?.jsType,b=f?.fieldSettings,O=b?.treeValues||b?.listValues,S=!!(b!=null&&b.asyncFetch),A=O||S;if(a&&g&&a!=g)return c.push({key:wl,args:{wType:g,valueType:a}}),[t,c];if(h&&!Av(t,h)&&!A)return c.push({key:Rl,args:{jsType:h,valueTypeof:Hl(t)}}),[t,c];if(b){var L=o||O;if(L&&!b.allowCustomValues){var F=wv(t,L,l,s,u.settings.removeInvalidMultiSelectValuesOnLoad),P=(0,we.A)(F,2);d=P[0],c=P[1]}b.maxLength>0&&t!=null&&String(t).length>b.maxLength&&(d=l?String(t).substring(0,b.maxLength):t,c.push({key:Pl,args:{value:t,length:String(t).length,fieldSettings:b},fixed:l,fixedFrom:l?t:void 0,fixedTo:l?d:void 0})),b.min!=null&&t<b.min&&(d=l?b.min:t,c.push({key:jl,args:{value:t,fieldSettings:b},fixed:l,fixedFrom:l?t:void 0,fixedTo:l?d:void 0})),b.max!=null&&t>b.max&&(d=l?b.max:t,c.push({key:Il,args:{value:t,fieldSettings:b},fixed:l,fixedFrom:l?t:void 0,fixedTo:l?d:void 0}))}}return[d,c]},Pv=function(e,t,r,a,o,u,i){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d=[],f=i.settings,p=f.fieldSeparator,v=f.canCompareFieldWithField,g=(0,Fr.A)(t)=="object"&&t?._isFuncArg,h=Array.isArray(e)?e.join(p):e,b=Re(i,e),O=Array.isArray(r)?r.join(p):r,S=Re(i,r);if(!S)return d.push({key:Vl,args:{field:O}}),[r,d];if(e&&O===h&&!g)return d.push({key:Dl,args:{field:h}}),[r,d];if(o&&o!=S.type)return d.push({key:xl,args:{field:O,type:S.type,expected:o}}),[r,d];if(e&&!g&&v){var A=v(h,b,O,S,l);if(!A)return d.push({key:Nl,args:{leftField:h,rightField:O}}),[r,d]}return[r]},jv=function(e,t,r,a,o,u,i){var l,s,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,d=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,f=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,p=arguments.length>10&&arguments[10]!==void 0?arguments[10]:!1,v=r,g=[];if(!r)return[r];var h=(l=r.get)===null||l===void 0?void 0:l.call(r,"func");if(!h)return[r];var b=Re(i,t);if(b!=null&&b.funcs&&!b.funcs.includes(h))return g.push({key:kl,args:{funcKey:h,field:t}}),[r,g];var O=Gr(i,h);if(!O)return g.push({key:Ol,args:{funcKey:h}}),[r,g];var S=(s=O.label)!==null&&s!==void 0?s:h;if(o&&O.returnType!=o)return g.push({key:_l,args:{funcKey:h,funcName:S,returnType:O.returnType,valueType:o}}),[r,g];d=d||p;for(var A in O.args){var L,F=O.args[A],P=v.get("args"),N=P?P.get(A):void 0,k=Re(i,F),I=(L=k?.label)!==null&&L!==void 0?L:A,B=N?N.get("value"):void 0,U=N?N.get("valueSrc"):void 0;if(B!==void 0){var x=Hn(i,e,k,c,B,F.type,U,u,d,f,p),X=(0,we.A)(x,2),W=X[0],J=X[1],G=!(J!=null&&J.length),ee=d&&W!==B,ie=d&&!G&&!ee&&(f||p);if(ee&&(v=v.setIn(["args",A,"value"],W)),ie&&(v=v.deleteIn(["args",A]),v=Wa(i,v,O,A)),!G){var de,fe,ne=(de=(fe=J.find(function(he){return!he.fixed&&!he.ignore}))!==null&&fe!==void 0?fe:J.find(function(he){return!he.fixed}))!==null&&de!==void 0?de:J[0],te=ee||ie,ve=J.filter(function(he){return!he.ignore}).length===0;if(ne){var se=Nt(ne);g.push({key:Sl,args:{funcKey:h,funcName:S,argKey:A,argName:I,argValidationError:se,argErrors:J},ignore:ve,fixed:te,fixedFrom:te?B:void 0,fixedTo:te?ee?W:F.defaultValue:void 0})}}}else if(!F.isOptional&&(f||p)){var ue=d&&F.defaultValue!==void 0&&(f||p),Ce=f;Ce&&g.push({key:Ml,args:{funcKey:h,funcName:S,argKey:A,argName:I},fixed:ue,fixedTo:ue?F.defaultValue:void 0,ignore:!ue}),ue&&(v=v.deleteIn(["args",A]),v=Wa(i,v,O,A))}}return[v,g]},ai=function(e,t,r,a,o){var u=cr(e,r,t),i=r?Mr(u):null,l=o.toJS?o.toJS():o,s=a.toJS?a.toJS():a,c=l.filter(function(b){return b=="value"||b==null}).length==i,d;if(u!=null&&u.validateValues&&c){var f=l[0],p=Tr(e,t,r,f),v=rt(e,t,r,p,f),g=v!=null&&v.toJS?s.map(function(b){var O=v.toJS.call(e.ctx,b,v);return O instanceof Date&&(O=O.getTime()),O}):s,h=u.validateValues(g);typeof h=="boolean"&&h==!1&&(d={key:Gl,args:{jsValues:g,values:s}})}return d},Tn=function(e){var t,r,a,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,u=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1,d=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,f=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1;o||(o=e);var p=e.settings,v=p.keepInputOnChangeFieldSrc,g=p.convertableWidgets,h=p.clearValueOnChangeField,b=p.clearValueOnChangeOp,O=u.get("field"),S=u.get("fieldType"),A=u.get("fieldSrc"),L=u.get("operator"),F=u.get("value"),P=u.get("valueSrc",new ye.default.List),N=u.get("valueType",new ye.default.List),k=u.get("asyncListValues"),I=cr(o,L),B=cr(e,l,i),U=L?Mr(I):null,x=l?Mr(B):null,X=Re(o,O),W=Re(e,i),J=!O&&S&&v,G=X?.type||S,ee=W?.type||!i&&J&&G,ie=X?.listValuesType,de=W?.listValuesType,fe=(O==null||(t=O.get)===null||t===void 0?void 0:t.call(O,"func"))||O,ne=((r=i)===null||r===void 0||(a=r.get)===null||a===void 0?void 0:a.call(r,"func"))||i,te=ne!=fe,ve=[],se=(O||J)&&L&&l&&F!=null;(!(G&&ee&&G==ee)||s==="field"&&te&&h||s==="operator"&&b)&&(se=!1),te&&Ka.includes(ee)&&(de&&de===ie||(se=!1));var ue;if(A==="func"&&i){var Ce=Hn(e,null,null,l,i,ee,A,k,c,d,f),he=(0,we.A)(Ce,2),Pe=he[0],Ne=he[1],Be=!(Ne!=null&&Ne.length),Qe=Pe!==i,Je=!Be&&Qe&&!Ne.find(function(qr){return!qr.fixed}),We=c&&!Be&&!Je&&!!s&&i!==O,or=!1;if(or?i=null:We?i=O:Qe&&(i=Pe),!Be){var ar=!Be&&!Je&&!or&&!We,Ar=Ne.find(function(qr){return!qr.fixed&&!qr.ignore});ar&&Ar&&(ue=Nt(Ar)),Ne.map(function(qr){return ve.push(Cr(Cr({side:"lhs"},qr),{},{fixed:qr.fixed||We||or}))})}}for(var tr=0;tr<x;tr++){var st=P.get(tr)||null,Mt=Tr(o,O,L,st),St=Tr(e,i,l,st),Ft=st==="value"?Mt:Tr(o,O,L,"value"),vt=st==="value"?St:Tr(e,i,l,"value"),_t=vt==Ft||(g[Ft]||[]).includes(vt)||!Ft&&J;_t||(se=!1)}L!=l&&[L,l].includes("proximity")&&(se=!1);var Gt=P.first(),tt=rt(e,i,l,null,Gt),Hr=us(e,i,l,null);!i&&J&&(Hr=Object.keys(e.settings.valueSourcesInfo));var sn=Hr[0],cn;x==1&&tt&&tt.type!==void 0?cn=tt.type:x==1&&W&&W.type!==void 0&&(cn=W.type==="!group"?"number":W.type);var nt=se&&s==="operator"&&U===1&&x===2,Nr=[],rr=[],Zr=[],zr=Array.from({length:x},function(){return null});if(se)for(var qt=function(lr){var at=F.get(lr),ct=N.get(lr)||null,On=P.get(lr)||null;nt&&lr===1&&(at=Nr[0]!==void 0?Nr[0]:F.get(0),Nr[lr]=at,ct=N.get(0)||null,On=P.get(0)||null);var vo=On?Hr.find(function(It){return It==On})!==void 0:!0,ip=Hn(e,i,i,l,at,ct,On,k,c,d,f),Wr=(0,we.A)(ip,2),At=Wr[0],Kr=Wr[1],Ea=!(Kr!=null&&Kr.length),go=At!==at,ab=!Ea&&go&&!(Kr!=null&&Kr.find(function(It){return!It.fixed})),ob=!(Kr!=null&&Kr.find(function(It){return!It.fixed&&!It.ignore})),up=!vo||c&&!Ea&&!ab&&(!ob||te);Ea||Kr?.map(function(It){return ve.push(Cr(Cr({side:"rhs",delta:lr},It),{},{fixed:It.fixed||up}))}),up&&(Nr[lr]=null,lr===0&&delete Nr[1]);var ib=!Ea&&!go,lp=Kr?.find(function(It){return!It.fixed&&!It.ignore});ib&&lp&&(zr[lr]=Nt(lp)),go&&(Nr[lr]=At),nt&&lr===0&&!Ea&&!go&&(nt=!1),nt&&lr===0&&["func","field"].includes(On)&&(nt=!1)},Et=0;Et<x;Et++)qt(Et);if(!se){for(var Vn=0;Vn<x;Vn++)if(x===1){var jt,wr=lu([W?.defaultValue,W==null||(jt=W.fieldSettings)===null||jt===void 0?void 0:jt.defaultValue,tt?.defaultValue]);Nr[Vn]=wr,wr!=null&&wr.func&&(rr[Vn]="func")}}for(var je=0;je<x;je++){var _e=se&&P.get(je)||null,Ze=se&&N.get(je)||null;if(se&&nt&&je===1){var ir,xr;_e=(ir=rr[je])!==null&&ir!==void 0?ir:P.get(0),Ze=(xr=Zr[je])!==null&&xr!==void 0?xr:N.get(0),rr[je]=_e,Zr[je]=Ze}var kr=Hr.includes(_e);kr||(rr[je]=sn),Ze||(Zr[je]=cn)}var yr=new ye.default.List(Array.from({length:x},function(qr,lr){return Nr[lr]!==void 0?Nr[lr]:se?F.get(lr):void 0})),Ct=new ye.default.List(Array.from({length:x},function(qr,lr){var at;return(at=rr[lr])!==null&&at!==void 0?at:se&&P.get(lr)||null})),Br=new ye.default.List(Array.from({length:x},function(qr,lr){var at;return(at=Zr[lr])!==null&&at!==void 0?at:se&&N.get(lr)||null})),Jt=ai(e,i,l,yr,Ct);if(Jt){var Qt=Nt(Jt),Tt=c&&x>=2,dn=yr;Tt&&(Nr[1]=yr.get(0),yr=yr.set(1,Nr[1]),zr[1]=zr[0]);var Yt=!Tt;Yt&&zr.push(Qt),ve.push(Cr(Cr({side:"rhs",delta:-1},Jt),{},{fixed:Tt,fixedFrom:Tt?[dn.get(0),dn.get(1)]:void 0,fixedTo:Tt?[yr.get(0),yr.get(1)]:void 0}))}var $t=new ye.default.List(zr);return{canReuseValue:se,newValue:yr,newValueSrc:Ct,newValueType:Br,operatorCardinality:x,fixedField:i,newValueError:$t,newFieldError:ue,validationErrors:ve}},oi=function(e){return(0,Fr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},Zl=function(e,t){if(e){var r=e.get("func"),a=r&&Gr(t,r);if(a){var o=e,u=!1;for(var i in a.args){var l=a.args[i],s=l.valueSources,c=l.isOptional,d=l.defaultValue,f=An(t,s,l),p=o.get("args"),v=f.length==1?f[0]:void 0,g=p?p.get(i):void 0,h=g?g.get("value"):void 0,b=(g?g.get("valueSrc"):void 0)||v;if(h!==void 0){var O=Ln(h,b,t);if(O===void 0||(O!==h&&(o=o.setIn(["args",i,"value"],O)),u))return}else if(d!==void 0&&!oi(d))o=o.setIn(["args",i,"value"],rs(l)),o=o.setIn(["args",i,"valueSrc"],"value");else if(c)u=!0;else return}return o}}},es=function(e,t,r,a){var o=r.settings.fieldSeparator;e=e||new ye.default.Map,Array.isArray(t)&&(t=t.join(o));var u=e.get("func"),i=e.get("args");e=e.set("func",t);var l=t&&Gr(r,t),s=t&&hi(r,t),c=u&&hi(r,u),d=ns(c,s,i,r,a);if(d.length){var f=Object.keys(s.args),p=f.filter(function(v){return!d.includes(v)});e=p.reduce(function(v,g){return v.deleteIn(["args",g])},e)}else e=e.set("args",new ye.default.Map);return e=Iv(r,e,l),e},Iv=function(e,t,r){if(r)for(var a in r.args)t=Wa(e,t,r,a);return t},Wa=function(e,t,r,a){var o=r.args[a],u=o.valueSources,i=o.defaultValue,l=An(e,u,o),s=l.length?l[0]:void 0,c=i?oi(i)&&i.func?"func":"value":void 0,d=c||s,f=t.getIn(["args",a]);return f||(i!==void 0&&(t=t.setIn(["args",a,"value"],rs(o))),d&&(t=t.setIn(["args",a,"valueSrc"],d))),t},rs=function(e){var t=e.defaultValue;return oi(t)&&!ye.default.Map.isMap(t)&&t.func?ye.default.fromJS(t,function(r,a){return ye.default.Iterable.isIndexed(a)?a.toList():a.toOrderedMap()}):t},ii=function(e,t,r,a,o){if(e&&e.get("func")){e=e.setIn(["args",t,"value"],r);var u=e.getIn(["args",t,"valueSrc"]),i=a.valueSources,l=An(o,i,a),s=l.length==1?l[0]:void 0;!s&&l.includes("value")&&(s="value"),!u&&s&&(e=e.setIn(["args",t,"valueSrc"],s))}return e},ts=function(e,t,r,a,o){return e&&e.get("func")&&(e=e.setIn(["args",t],new ye.default.Map({valueSrc:r}))),e},ns=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(e?.returnType!=t?.returnType)return[];var u=!1,i=Object.keys(t.args),l=i.filter(function(s,c){var d=t.args[s],f=e.args[s],p=Object.keys(e.args).indexOf(s);if(!f&&(d.defaultValue!==void 0||d.isOptional))return!0;if(u&&c!==p||f?.type!=d.type||Ka.includes(d.type)&&(!f.listValuesType||f.listValuesType!==d.listValuesType))return!1;if(r){var v,g=r.get(s),h=g?.get("value"),b=g?.get("valueSrc");if(b&&d.valueSources&&!d.valueSources.includes(b))return!1;var O=null,S=null,A=d,L=null,F=!0,P=Hn(a,O,A,S,h,A.type,b,L,o,F),N=(0,we.A)(P,2),k=N[0],I=N[1];if(I!=null&&(v=I.filter(function(B){return!B.fixed}))!==null&&v!==void 0&&v.length)return!1}return!0});return l},Ka=["select","multiselect","treeselect","treemultiselect"],as=function(e,t){var r;return((r=e.types[t])===null||r===void 0?void 0:r.operators)||null},Ha=function(e,t){var r=Re(e,t),a=r?r.operators:[];return a},ui=function(e,t){var r,a=Ha(e,t);return(r=a?.[0])!==null&&r!==void 0?r:null},os=function(e,t,r){var a=null;if(e){if(t==="field"){var o=Re(r,e);o&&(a=o.type)}else if(t==="func"){var u=e.get("func");if(u){var i=Gr(r,u);i&&(a=i.returnType||i.type)}}}return a},Vv=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return ha(e,t,r,"funcs","subfields")},ha=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"fields",o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"subfields";if(!e)return null;var u=t.settings.fieldSeparator,i=Vr(e,t),l=Vr(r,t),s=i.slice(l.length).map(function(c,d,f){return f.slice(0,d+1)}).map(function(c){return[].concat((0,Se.A)(l),(0,Se.A)(c)).join(u)}).map(function(c){var d=kt(t,c,a,o);return d&&d.label||ka()(c.split(u))}).filter(function(c){return c!=null});return s},is=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!e)return null;var a=r&&kt(t,r)||null,o=t.settings.fieldSeparator,u=Vr(e,t),i=Ls(e,r,t),l=i?Vr(r,t):[];return u.slice(l.length).map(function(s,c,d){return d.slice(0,c+1)}).map(function(s){return{part:[].concat((0,Se.A)(l),(0,Se.A)(s)).join(o),key:s[s.length-1]}}).map(function(s){var c=s.part,d=s.key,f=kt(t,c);return{key:d,cnf:f}}).map(function(s,c,d){var f=s.key,p=s.cnf,v=c>0?d[c-1].cnf:a;return[f,p,v]})},Dv=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,i=t&&(0,Fr.A)(t)=="object"&&!!t.func&&!!t.arg,l=e.settings.showLabels,s=Re(e,t),c=rt(e,t,r,null,o)||{},d=cr(e,r,t)||{},f=u?1:d.cardinality,p=null;if(f>1){var v=c.valueLabels||d.valueLabels;v&&(p=v[a]),p&&(0,Fr.A)(p)!="object"&&(p={label:p,placeholder:p}),p||(p={label:e.settings.valueLabel+" "+(a+1),placeholder:e.settings.valuePlaceholder+" "+(a+1)})}else{var g=c.valueLabel,h=c.valuePlaceholder;i&&(g||(g=s.label||t.arg),!h&&!l&&(h=s.label||t.arg)),p={label:g||e.settings.valueLabel,placeholder:h||e.settings.valuePlaceholder}}return p};function li(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,a=[],o=[];if(!e)return{widgets:a,valueSrcs:o};var u=(0,Fr.A)(e)==="object"&&(!!e.func&&!!e.arg||e._isFuncArg),i=Re(n,e),l=t?n.operators[t]:null;if(i!=null&&i.widgets){var s=function(){var p=i.widgets[c];if(!n.widgets[c])return 1;var v=n.widgets[c].valueSrc||"value",g=!0;if(c=="field"&&(g=g&&An(n,["field"],i).length>0),c=="func"&&(g=g&&An(n,["func"],i).length>0),r=="value"&&!p.operators&&!u&&e!="!case_value"&&(g=!1),p.operators&&t&&(g=g&&p.operators.indexOf(t)!=-1),r&&r!=v&&r!="const"&&(g=!1),l&&l.cardinality==0&&v!="value"&&(g=!1),g){var h,b;a.push(c);var O=((h=i.valueSources)===null||h===void 0?void 0:h.indexOf(v))!=-1;(l==null||(b=l.valueSources)===null||b===void 0?void 0:b.indexOf(v))==-1&&(O=!1),O&&!o.find(function(S){return S==v})&&o.push(v)}};for(var c in i.widgets)s()}var d=function(p){var v=0;return i.preferWidgets?i.preferWidgets.includes(p)&&(v+=10-i.preferWidgets.indexOf(p)):p==i.mainWidget&&(v+=100),p=="field"&&(v-=1),p=="func"&&(v-=2),v};return a.sort(function(f,p){return d(p)-d(f)}),{widgets:a,valueSrcs:o}}var Nv=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=li(e,t,r,a),u=o.widgets;return u},An=function(e,t,r){var a;if(!r)return t;var o=(a=r.type)!==null&&a!==void 0?a:r.returnType;return t||(t=Object.keys(e.settings.valueSourcesInfo)),t.filter(function(u){var i=!0;if(u=="field"&&e.__fieldsCntByType){var l=r._isFuncArg?0:1;i=i&&e.__fieldsCntByType[o]>l}return u=="func"&&(e.__funcsCntByType&&(i=i&&!!e.__funcsCntByType[o]),r.funcs&&(i=i&&r.funcs.length>0)),i})},us=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=li(e,t,r,null),u=o.valueSrcs,i=An(e,u,a);return i},Tr=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=li(e,t,r,a),u=o.widgets,i=null;return u.length&&(i=u[0]),i},un=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};if(e){var u=Re(t,e)||{},i=t.settings.fieldSeparator,l=Vr(e,t),s=Array.isArray(e)?e.join(i):e;if(o!=null&&o.useTableName&&u.tableName){var c=(0,Se.A)(l);c[0]=u.tableName,s=c.join(i)}if(u.fieldName&&(s=u.fieldName),a){var d=Re(t,a)||{},f=a;s.indexOf(f+i)==0?s=s.slice((f+i).length):u.fieldName||r.errors.push("Can't cut group ".concat(f," from field ").concat(s))}return s}},si=function(e,t){var r=e.get("type"),a=e.getIn(["properties","mode"]);return r=="rule_group"&&a=="array"?xv(e,t):r=="group"||r=="rule_group"?kv(e,t):Mv(e,t)},xv=function(e,t){var r=e.get("children1"),a=e.get("properties");return ls(a.toObject(),r,t)},ls=function(e,t,r){var a,o,u=e.operator,i=(a=(o=r.operators[u])===null||o===void 0?void 0:o.cardinality)!==null&&a!==void 0?a:1,l=i==0,s={group:!di(e,r),children:!ci(t,r)},c=s.group&&(l?s.children:!0);return!c},kv=function(e,t){var r=e.get("children1");return ci(r,t)},ci=function(e,t){var r=e?.size>0&&e.filter(function(a){return!si(a,t)}).size>0;return!r},Mv=function(e,t){var r=e.get("properties");return di(r?.toObject()||{},t)},di=function(e,t){var r=!0,a=3,o=fi(e,t,r),u=o.score>=a;return!u},fi=function(e,t){var r,a,o,u=e.field,i=e.fieldSrc,l=e.fieldType,s=e.operator,c=e.value,d=e.valueSrc,f=e.valueType,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,v=(r=(a=t.operators[s])===null||a===void 0?void 0:a.cardinality)!==null&&r!==void 0?r:1,g=d!=null&&d.get?d.toJS():d,h={parts:{},score:0};if(h.parts.field=p?u!=null:za(u,i,t),h.parts.operator=!!s,h.parts.value=(c==null||(o=c.filter(function(O,S){return za(O,g?.[S],t,p)}))===null||o===void 0?void 0:o.size)>=(p?Math.min(v,1):v),h.score=Object.keys(h.parts).filter(function(O){return!!h.parts[O]}).length,p&&h.score<3){var b=!0;!h.parts.value&&i==="func"&&za(u,i,t,!1,b)&&h.score++,h.parts.field||c?.map(function(O,S){g?.[S]==="func"&&za(O,g?.[S],t,!1,b)&&h.score++})}return h},za=function n(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;if(!a&&t=="func"&&e){var u,i=(u=e.get)===null||u===void 0?void 0:u.call(e,"func"),l=Gr(r,i);if(l){var s=e.get("args");for(var c in l.args){var d=l.args[c],f=s?s.get(c):void 0,p=f?f.get("value"):void 0,v=f?f.get("valueSrc"):void 0;if(p==null&&d?.defaultValue===void 0&&!(d!=null&&d.isOptional)||p!=null&&!n(p,v,r,o?a:!0))return!1}return!0}}return e!=null},Ln=function(e,t,r){return t=="func"?Zl(e,r):e},_v=y(1779),Rt=y.n(_v),Gv=y(18678),pi=y.n(Gv);function ss(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function cs(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ss(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ss(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function $v(n,e){return pi().apply(n,e)}function Uv(n,e){return pi().add_operation(n,e)}var ds={CALL:function(e,t){for(var r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];return e.call.apply(e,[t].concat(a))},JSX:function(e,t){return{type:e,props:t}},mergeObjects:function(e,t){return cs(cs({},e),t)},fromEntries:function(e){return Object.fromEntries(e)},strlen:function(e){return e?.length||0},regexTest:function(e,t,r){return e?.match(new RegExp(t,r))!=null},now:function(){return new Date},date_add:function(e,t,r){return Un()(e).add(t,r).toDate()},toLowerCase:function(e){return e.toLowerCase()},toUpperCase:function(e){return e.toUpperCase()}};function Bv(){for(var n in ds)Uv(n,ds[n])}function Wv(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Kv(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Kv(n,e){if(n){if(typeof n=="string")return fs(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return fs(n,e)}}function fs(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function ps(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function bt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ps(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ps(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}Bv();function vs(n,e,t){var r;try{r=pi().apply(n,e)}catch(a){throw a.message="".concat(t.join(".")," :: ").concat(a.message),a}return r}function gs(n,e,t,r){var a;try{a=e.call.apply(e,[n].concat((0,Se.A)(t)))}catch(o){throw o.message="".concat(r.join(".")," :: ").concat(o.message),o}return a}var qa=["conjunctions","fields","types","operators","widgets","settings","funcs","ctx"],zn={asyncFetch:{type:"f",args:["search","offset"]},labelYes:{type:"r"},labelNo:{type:"r"},marks:{type:"r",isArr:!0},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]}},vi=bt(bt({},zn),{},{factory:{type:"rf"},formatValue:{type:"f",args:["val","fieldDef","wgtDef","isForDisplay","op","opDef","rightFieldDef"]},sqlFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelImportValue:{type:"f",args:["val","wgtDef","args"]},mongoFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},elasticSearchFormatValue:{type:"f",args:["queryType","val","op","field","config"]},jsonLogic:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]},toJS:{type:"f",args:["val"]}}),ms={options:{factory:{type:"rf"}},formatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","isForDisplay","fieldDef"]},mongoFormatOp:{type:"f",args:["field","op","vals","useExpr","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},sqlFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},spelFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},jsonLogic:{type:"f",ignore:"string",args:["field","op","vals","opDef","operatorOptions","fieldDef"]},elasticSearchQueryType:{type:"f",ignore:"string",args:["valueType"]},textSeparators:{type:"r",isArr:!0}},Hv={formatConj:{type:"f",args:["children","conj","not","isForDisplay"]},sqlFormatConj:{type:"f",args:["children","conj","not"]},spelFormatConj:{type:"f",args:["children","conj","not","omitBrackets"]}},hs={widgetProps:vi,opProps:ms},zv={renderBrackets:{type:"r",isArr:!0},renderSeps:{type:"r",isArr:!0},jsonLogic:{type:"f",ignore:"string",args:["formattedArgs"]},jsonLogicImport:{type:"f",args:["val"]},spelImport:{type:"f",args:["spel"]},formatFunc:{type:"f",args:["formattedArgs","isForDisplay"]},sqlFormatFunc:{type:"f",args:["formattedArgs"]},mongoFormatFunc:{type:"f",args:["formattedArgs"]},spelFormatFunc:{type:"f",args:["formattedArgs"]}},qv={locale:{mui:{type:"f",args:[],invokeWith:[],ignore:"jl"}},canCompareFieldWithField:{type:"f",args:["leftField","leftFieldConfig","rightField","rightFieldConfig","op"]},formatReverse:{type:"f",args:["q","op","reversedOp","operatorDefinition","revOperatorDefinition","isForDisplay"]},sqlFormatReverse:{type:"f",args:["q"]},spelFormatReverse:{type:"f",args:["q"]},formatField:{type:"f",args:["field","parts","label2","fieldDefinition","config","isForDisplay"]},formatSpelField:{type:"f",args:["field","parentField","parts","partsExt","fieldDefinition","config"]},formatAggr:{type:"f",args:["whereStr","aggrField","operator","value","valueSrc","valueType","opDef","operatorOptions","isForDisplay","aggrFieldDef"]},normalizeListValues:{type:"f",args:["listValues","type","fieldSettings"]},renderConfirm:{type:"f",args:["props"]},useConfirm:{type:"f",args:[]},renderField:{type:"rf"},renderOperator:{type:"rf"},renderFunc:{type:"rf"},renderConjs:{type:"rf"},renderButton:{type:"rf"},renderIcon:{type:"rf"},renderButtonGroup:{type:"rf"},renderValueSources:{type:"rf"},renderFieldSources:{type:"rf"},renderProvider:{type:"rf"},renderSwitch:{type:"rf"},renderSwitchPrefix:{type:"r"},renderItem:{type:"rf"},renderBeforeWidget:{type:"rf"},renderAfterWidget:{type:"rf"},renderBeforeActions:{type:"rf"},renderAfterActions:{type:"rf"},renderRuleError:{type:"rf"}},Jv={fields:{x:{fieldSettings:zn,widgets:{x:hs},mainWidgetProps:vi}},widgets:{x:vi},conjunctions:{x:Hv},operators:{x:ms},types:{x:{widgets:{x:hs}}},funcs:{x:bt(bt(bt({},zv),zn),{},{fieldSettings:zn,args:{x:bt(bt({},zn),{},{fieldSettings:zn})}})},settings:qv},qn=function(e){return(0,Fr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},ys=function(e,t){if(e.__fieldNames)throw new Error("Don't apply `compressConfig()` to extended config");var r=Ut()(e,qa);delete r.ctx;for(var a=function s(c,d,f,p){if(qn(c)){if(Na(c)&&(c=jo(c)),f[0]==="funcs"&&!d){var v=f[f.length-1];d=kt({funcs:p.BasicFuncs},v,"funcs","subfields")||void 0,d&&(c.$$key=v)}if(d!==void 0&&qn(d))for(var g in d)Object.prototype.hasOwnProperty.call(d,g)&&(!Object.keys(c).includes(g)||c[g]===void 0&&d[g]!==void 0?c[g]="$$deleted":(c[g]=s(c[g],d[g],[].concat((0,Se.A)(f),[g]),p),c[g]===void 0&&delete c[g]));for(var h in c)if(Object.prototype.hasOwnProperty.call(c,h)){if(!d||!Object.keys(d).includes(h)){var b;c[h]=s(c[h],(b=d)===null||b===void 0?void 0:b[h],[].concat((0,Se.A)(f),[h]),p)}c[h]===void 0&&delete c[h]}Object.keys(c).length===0&&(c=void 0)}else Array.isArray(c)&&c.forEach(function(O,S){c[S]=s(c[S],void 0,[].concat((0,Se.A)(f),[S]),p)});if(!(d!==void 0&&sa(c,d,!0))){if(typeof c=="function")throw new Error("compressConfig: function at ".concat(f.join(".")," should be converted to JsonLogic"));return c}},o=0,u=qa;o<u.length;o++){var i=u[o];if(i!=="ctx")if(i==="fields")r[i]=Rt()(r[i]),a(r[i],{},[i]);else if(i==="funcs"){r[i]=Rt()(r[i]||{});for(var l in r[i])a(r[i][l],null,[i,l],{BasicFuncs:Y})}else r[i]=Rt()(r[i]),a(r[i],t[i],[i])}return r},Os=function(e,t,r){if(!e.settings.useConfigCompress)throw new Error("Please enable `useConfigCompress` in config settings to use decompressConfig()");for(var a={},o=function c(d,f,p){if(qn(f)){qn(d)||(d={});for(var v in f)Object.prototype.hasOwnProperty.call(f,v)&&(f[v]==="$$deleted"?delete d[v]:d[v]=c(d[v],f[v],[].concat((0,Se.A)(p),[v])))}else Array.isArray(f)?d=Rt()(f):d=f;return d},u=function c(d,f,p){var v=!1;if(qn(d)&&Object.prototype.hasOwnProperty.call(d,"$$key")&&d.$$key){var g=kt({funcs:p.BasicFuncs},d.$$key,"funcs","subfields");if(g)delete d.$$key,d=o(Rt()(g),d,f),v=!0;else throw new Error("decompressConfig: basic function not found by key ".concat(d.$$key," at ").concat(f.join(".")))}if(!v){if(qn(d))for(var h in d)Object.prototype.hasOwnProperty.call(d,h)&&(d[h]=c(d[h],[].concat((0,Se.A)(f),[h]),p));else if(Array.isArray(d)){var b=Wv(d),O;try{for(b.s();!(O=b.n()).done;){var S=O.value;d[S]=c(d[S],[].concat((0,Se.A)(f),[S]),p)}}catch(A){b.e(A)}finally{b.f()}}}return d},i=0,l=qa;i<l.length;i++){var s=l[i];s==="ctx"?a[s]=da()({},t.ctx||{},r||{}):s==="funcs"?(a[s]=Rt()(e[s]||{}),u(a[s],[s],{BasicFuncs:Y})):s==="fields"?a[s]=Rt()(e[s]||{}):(a[s]=Rt()(t[s]||{}),o(a[s],e[s]||{},[s]))}return a},bs=function(e){if(e.__compliled)return e;e=Rt()(e);var t={ctx:e.ctx},r=[];return Ja(e,e,t,Jv,r),Object.defineProperty(e,"__compliled",{enumerable:!1,writable:!1,value:!0}),e};function Ja(n,e,t,r,a){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[];if(e){var u=!o.length;for(var i in r){var l=r[i],s=i==="x"?o:[].concat((0,Se.A)(o),[i]);if(l.type==="r"){var c=e,d=c[i];if(l.isArr)for(var f in d){var p=Jn(d[f],t,[].concat((0,Se.A)(s),[f]));p!==d[f]&&(a.push("Compiled ".concat(s.join("."),"[").concat(f,"]")),d[f]=p)}else{var v=Jn(d,t,s,void 0);v!==d&&(a.push("Compiled R ".concat(s.join("."))),c[i]=v)}}else if(l.type==="rf"){var g=e,h=g[i],b=Qv(h,t,s,l.ignore);b!==h&&(a.push("Compiled JL-RF ".concat(s.join("."))),g[i]=b)}else if(l.type==="f"){var O=e,S=O[i],A=Yv(S,t,s,l.args,l.ignore);if(l.invokeWith&&A&&typeof A=="function"){var L;A=(L=A).call.apply(L,[null].concat((0,Se.A)(l.invokeWith)))}A!==S&&(a.push("Compiled JL-F ".concat(s.join("."))),O[i]=A)}else if(i==="x")for(var F in e){s=[].concat((0,Se.A)(o),[F]);var P=e[F];Ja(n,P,t,l,a,s),P.subfields&&Ja(n,P.subfields,t,r,a,s)}else{var N=e[i];Ja(n,N,t,l,a,s)}}}}function Qv(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0;return lt(n)?function(a,o){o=o||e?.ctx;var u={props:a,ctx:o},i=vs(n,u,t);typeof i=="string"&&(i={type:i,props:a});var l=Jn(i,{ctx:o},t);return l}:typeof n=="string"?function(a,o){o=o||e?.ctx;var u=n.split(".").reduce(function(s,c){return s?.[c]},o);if(u)return gs(this,u,[a,o],t);var i={type:n,props:a},l=Jn(i,{ctx:o},t);return l}:n}function Yv(n,e,t,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;return lt(n)&&a!=="jl"?function(){for(var o=arguments.length,u=new Array(o),i=0;i<o;i++)u[i]=arguments[i];var l=this||e?.ctx,s=(r||[]).reduce(function(d,f,p){return bt(bt({},d),{},(0,re.A)({},f,u[p]))},{args:u,ctx:l}),c=vs(n,s,t);return c}.bind(e?.ctx):typeof n=="string"&&a!=="string"?function(){var o=this||e?.ctx,u=n.split(".").reduce(function(c,d){return c?.[d]},o);if(u){for(var i=arguments.length,l=new Array(i),s=0;s<i;s++)l[s]=arguments[s];return gs(this,u,l,t)}else throw new Error("".concat(t.join(".")," :: Function ").concat(n," is not found in ctx"))}.bind(e?.ctx):n}function Xv(n,e){var t;return(e==null||(t=e.components)===null||t===void 0?void 0:t[n])||e.W[n]||e.O[n]}function Jn(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0;if(Io(n)){var a,o=n.type,u=n.props;if(typeof o!="string")throw new Error("renderReactElement for ".concat(t.join("."),": type should be string"));var i=Xv(o,e.ctx)||o.toLowerCase(),l;r!==void 0&&(u=bt(bt({},u),{},{key:r})),(a=u)!==null&&a!==void 0&&a.children&&(l=Jn(u.children,e,t),u=bt(bt({},u),{},{children:l}));var s=e.ctx.RCE(i,u);return s}else if(n instanceof Array)return n.map(function(c,d){return Jn(c,e,t,""+d)});return n}var Ss={formatField:function(e,t,r,a,o,u){return u?r:e},fieldSources:["field"],keepInputOnChangeFieldSrc:!0,fieldItemKeysForSearch:["label","path","altLabel","grouplabel"],listKeysForSearch:["title","value"],valueSourcesInfo:{value:{}},fieldSeparator:".",fieldSeparatorDisplay:".",canReorder:!0,canRegroup:!0,canDeleteLocked:!1,canLeaveEmptyGroup:!0,shouldCreateEmptyGroup:!1,canShortMongoQuery:!0,removeEmptyGroupsOnLoad:!0,removeEmptyRulesOnLoad:!0,removeIncompleteRulesOnLoad:!1,removeInvalidMultiSelectValuesOnLoad:!0,optimizeRenderWithInternals:!1,showErrorMessage:!1,setOpOnChangeField:["keep","default"],groupOperators:["some","all","none"],defaultGroupConjunction:"AND",locale:{moment:"en"},valueLabel:"Value",valuePlaceholder:"Value",fieldLabel:"Field",operatorLabel:"Operator",funcLabel:"Function",fieldPlaceholder:"Select field",funcPlaceholder:"Select function",operatorPlaceholder:"Select operator",lockLabel:"Lock",lockedLabel:"Locked",deleteLabel:"Delete",addGroupLabel:"Add group",addCaseLabel:"Add condition",addDefaultCaseLabel:"Add default condition",defaultCaseLabel:"Default:",addRuleLabel:"Add rule",addSubRuleLabel:"Add sub rule",delGroupLabel:"Delete",notLabel:"Not",fieldSourcesPopupTitle:"Select source",valueSourcesPopupTitle:"Select value source",removeRuleConfirmOptions:null,removeGroupConfirmOptions:null};function Fs(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Zv(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Zv(n,e){if(n){if(typeof n=="string")return Es(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Es(n,e)}}function Es(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var xt=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e.__configId)return e;r&&e.settings.useConfigCompress?e.__compliled?e=Rt()(e):e=bs(e):e=Rt()(e),e.settings=xa()({},Ss,e.settings,ca),e.__fieldsCntByType={},e.__funcsCntByType={},e.__fieldNames={},eg(e.types,e),Cs(e.fields,e),Ts(e.funcs,e);var a=e.settings.locale.moment;return a&&Un().locale(a),Object.defineProperty(e,"__configId",{enumerable:!1,writable:!1,value:t||sr()}),ou(e),e};function eg(n,e){for(var t in n){var r=n[t];rg(t,r,e)}}function rg(n,e,t){var r=null,a=null;e.mainWidget=e.mainWidget||Object.keys(e.widgets).filter(function(d){return d!="field"&&d!="func"})[0];for(var o in e.widgets){var u=e.widgets[o];if(u.operators){var i=u.operators;e.excludeOperators&&(i=i.filter(function(d){return!e.excludeOperators.includes(d)})),r=au(r,i)}u.defaultOperator&&(a=u.defaultOperator),o==e.mainWidget&&(u=da()({},{widgetProps:e.mainWidgetProps||{}},u)),e.widgets[o]=u}e.valueSources||(e.valueSources=Object.keys(t.settings.valueSourcesInfo));var l=Fs(e.valueSources),s;try{for(l.s();!(s=l.n()).done;){var c=s.value;c!="value"&&!e.widgets[c]&&(e.widgets[c]={})}}catch(d){l.e(d)}finally{l.f()}!e.operators&&r&&(e.operators=Array.from(new Set(r))),!e.defaultOperator&&a&&(e.defaultOperator=a)}function Cs(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];for(var r in n)gi(n[r],e,[].concat((0,Se.A)(t),[r])),n[r].subfields&&Cs(n[r].subfields,e,[].concat((0,Se.A)(t),[r]))}function Ts(n,e){var t,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(n){var a=(e==null||(t=e.settings)===null||t===void 0?void 0:t.fieldSeparator)||".";for(var o in n){var u=[].concat((0,Se.A)(r),[o]).join(a),i=n[o];if(i.returnType&&(e.__funcsCntByType[i.returnType]||(e.__funcsCntByType[i.returnType]=0),e.__funcsCntByType[i.returnType]++),gi(i,e,null,!1),i.args){for(var l in i.args)gi(i.args[l],e,null,!0);var s=Object.keys(i.args),c=!0,d=Fs(s.reverse()),f;try{for(d.s();!(f=d.n()).done;){var p=f.value,v=i.args[p];!c&&v.isOptional&&(vn.info("Arg ".concat(p," for func ").concat(u," can't be optional")),delete v.isOptional),v.isOptional||(c=!1)}}catch(g){d.e(g)}finally{d.f()}}i.subfields&&Ts(i.subfields,e,[].concat((0,Se.A)(r),[o]))}}}function gi(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=null,o=null,u=e.types[n.type||n.returnType],i=!!n.returnType,l=n.excludeOperators||[];if(n.type!="!struct"&&n.type!="!group"){var s=["listValues","treeValues","allowCustomValues","validateValue"];n.fieldSettings||(n.fieldSettings={});for(var c=0,d=s;c<d.length;c++){var f=d[c];n[f]&&(n.fieldSettings[f]=n[f],delete n[f])}if(n.fieldSettings.listValues&&e.settings.normalizeListValues&&(n.fieldSettings.listValues=e.settings.normalizeListValues.call(e.ctx,n.fieldSettings.listValues,n.type,n.fieldSettings)),n.fieldSettings.treeValues&&e.settings.normalizeListValues&&(n.fieldSettings.treeValues=e.settings.normalizeListValues.call(e.ctx,n.fieldSettings.treeValues,n.type,n.fieldSettings)),!u){n.disabled=!0;return}if(!r&&!i&&(e.__fieldsCntByType[n.type]||(e.__fieldsCntByType[n.type]=0),e.__fieldsCntByType[n.type]++),r&&(n._isFuncArg=!0),!i){n.mainWidget=n.mainWidget||u.mainWidget,n.valueSources=n.valueSources||u.valueSources;var p=u.excludeOperators||[];n.widgets||(n.widgets={});var v=function(){var A=n.widgets[g]||{},L=u.widgets[g]||{};if(!r){var F=[].concat((0,Se.A)(l),(0,Se.A)(p)),P=n.preferWidgets&&(g=="field"||n.preferWidgets.includes(g))||F.length>0;if(A.operators){var N=A.operators.filter(function(I){return!F.includes(I)});a=[].concat((0,Se.A)(a||[]),(0,Se.A)(N))}else if(P&&L.operators){var k=L.operators.filter(function(I){return!F.includes(I)});a=[].concat((0,Se.A)(a||[]),(0,Se.A)(k))}A.defaultOperator&&(o=A.defaultOperator)}g==n.mainWidget&&(A=da()({},{widgetProps:n.mainWidgetProps||{}},A)),n.widgets[g]=A};for(var g in u.widgets)v()}r||(!n.operators&&a&&(n.operators=Array.from(new Set(a))),n._origDefaultOperator=n.defaultOperator,!n.defaultOperator&&o&&(n.defaultOperator=o))}var h=tg(e,t),b=h.fieldName,O=h.inGroup;b&&(n.fieldName=b,e.__fieldNames[b]||(e.__fieldNames[b]=[]),e.__fieldNames[b].push({fullPath:t,inGroup:O}))}function tg(n,e){if(!e)return{};var t=n.settings.fieldSeparator,r=(0,Se.A)(e).reduce(function(i,l,s,c){var d=i.computedPath,f=i.computed,p=i.inGroup,v=[].concat((0,Se.A)(c.slice(0,s)),[l]),g=kt(n,v);return g?.type==="!group"&&s<c.length-1?(p=v.join(t),d=[]):g!=null&&g.fieldName?(f=!0,d=[g.fieldName]):d=[].concat((0,Se.A)(d),[l]),{computedPath:d,computed:f,inGroup:p}},{computedPath:[],computed:!1,inGroup:void 0}),a=r.computedPath,o=r.computed,u=r.inGroup;return o?{fieldName:a.join(t),inGroup:u}:{}}var ng=nn().mark(Qn),ag=nn().mark(As),og=En;function Qn(n){return nn().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(mi(n,n.funcs||{},[]),"t0",1);case 1:case"end":return t.stop()}},ng)}function As(n){return nn().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(mi(n,n.fields||{},[]),"t0",1);case 1:case"end":return t.stop()}},ag)}function mi(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"subfields";return nn().mark(function a(o){var u,i,l;return nn().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:u=(n==null||(o=n.settings)===null||o===void 0?void 0:o.fieldSeparator)||".",c.t0=nn().keys(e);case 2:if((c.t1=c.t0()).done){c.next=13;break}if(i=c.t1.value,l=e[i],!l[r]){c.next=9;break}return c.delegateYield(mi(n,l[r],[].concat((0,Se.A)(t),[i]),r),"t2",7);case 7:c.next=11;break;case 9:return c.next=11,[[].concat((0,Se.A)(t),[i]).join(u),l];case 11:c.next=2;break;case 13:case"end":return c.stop()}},a)})()}var kt=function(e,t){var r,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"fields",o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"subfields";if(!t)return null;if(t=="!case_value")return{type:"case_value",mainWidget:"case_value",widgets:{case_value:e.widgets.case_value}};var u=(e==null||(r=e.settings)===null||r===void 0?void 0:r.fieldSeparator)||".",i=Vr(t,e),l=e[a];if(!l)return null;for(var s=l,c=null,d=[],f=0;f<i.length;f++){var p=i[f];d.push(p);var v=d.join(u);c=s[v],f<i.length-1&&(c&&c[o]?(s=c[o],d=[]):c=null)}return c},Qa=function(e,t){var r,a,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,u=e.settings.fieldSeparator,i=[o].concat((0,Se.A)(t.split(u))).filter(function(c){return c!=null}),l=t,s=(r=e.__fieldNames[l])===null||r===void 0||(a=r.find)===null||a===void 0||(a=a.call(r,function(c){var d=c.inGroup;return d?o?.startsWith(d):!0}))===null||a===void 0?void 0:a.fullPath;return(s||i).join(u)},hi=function(e,t){if(!t)return null;var r=kt(e,t,"funcs","subfields");if(!r)return null;var a=r.returnType,o=r.args,u=Object.fromEntries(Object.entries(o||{}).map(function(l){var s=(0,we.A)(l,2),c=s[0],d=s[1],f=Ut()(d,["type","valueSources","defaultValue","fieldSettings","isOptional"]);return[c,f]})),i={returnType:a,args:u};return i},Gr=function(e,t){if(!t)return null;var r=kt(e,t,"funcs","subfields");if(!r)return null;var a=e.types[r.returnType]||{},o=xa()({},a,r,ca);return o.type=r.returnType||r.type,o},yi=function(e,t,r){var a=Gr(e,t);if(!a)return null;var o=a.args&&a.args[r]||null;if(!o)return null;var u=e.types[o.type]||{},i=xa()({},u,o||{},ca);return i},Ls=function(e,t){var r,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!t)return!1;var o=(a==null||(r=a.settings)===null||r===void 0?void 0:r.fieldSeparator)||".",u=Oi(e,a),i=Oi(t,a);return u.startsWith(i+o)},Oi=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof e=="string")return e;var a=(r==null||(t=r.settings)===null||t===void 0?void 0:t.fieldSeparator)||".";return Vr(e,r).join(a)},Vr=function(e){var t,r,a,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!e)return[];if(Array.isArray(e))return e;var u=(o==null||(t=o.settings)===null||t===void 0?void 0:t.fieldSeparator)||".";if(e!=null&&e.func)return Array.isArray(e.func)?e.func:e.func.split(u);if(e!=null&&(r=e.get)!==null&&r!==void 0&&r.call(e,"func")){var i;return e==null||(i=e.get)===null||i===void 0?void 0:i.call(e,"func").split(u)}return(e==null||(a=e.split)===null||a===void 0?void 0:a.call(e,u))||[]},ig=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!e)return null;var a=t.settings.fieldSeparator,o=Vr(e,t);return r?o:o.map(function(u,i,l){return l.slice(0,i+1)}).map(function(u){return u.join(a)})},ws=function(e){var t;if(!e)return null;if((0,Fr.A)(e)=="object"){if(!e.func&&e.type)return"field";if(e.func)return e.func&&e.arg?null:"func"}return e!=null&&(t=e.get)!==null&&t!==void 0&&t.call(e,"func")?e!=null&&e.get("arg")?null:"func":"field"},Re=function(e,t){var r;if(!t)return null;if((0,Fr.A)(t)=="object"){if(!t.func&&t.type)return t;if(t.func)return t.func&&t.arg?yi(e,t.func,t.arg):Gr(e,t.func)}if(t!=null&&(r=t.get)!==null&&r!==void 0&&r.call(t,"func"))return t!=null&&t.get("arg")?yi(e,t.get("func"),t.get("arg")):Gr(e,t.get("func"));var a=kt(e,t);if(!a)return null;var o=e.types[a.type]||{},u=xa()({},o,a||{},ca);return u},cr=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!t)return null;var a=e.operators[t];if(r){var o=Re(e,r),u=Tr(e,r,t,null),i=e.widgets[u]||{},l=(o&&o.widgets?o.widgets[u]:{})||{},s=(i.opProps||{})[t],c=(l.opProps||{})[t],d=da()({},a,s,c);return d}else return a},rt=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!t||!(r||a)&&o!=="const"&&t!=="!case_value")return null;var u=Re(e,t);a||(a=Tr(e,t,r,o));var i=e.widgets[a]||{},l=(u&&u.widgets?u.widgets[a]:{})||{},s=l.widgetProps||{},c=(o==="value"||!o)&&u?.fieldSettings||{},d=da()({},i,s,c);return d},Rs=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=e.settings.fieldSeparator,a=Vr(t,e),o=t?kt(e,t):e,u=o,i=null,l=[];do{var s,c=u===e?e.fields:(s=u)===null||s===void 0?void 0:s.subfields;if(!c||!Object.keys(c).length){u=i=null;break}i=Object.keys(c)[0],l.push(i),u=c[i]}while(u.type=="!struct"||u.type=="!group");return(a||[]).concat(l).join(r)};function Ps(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function js(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ps(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ps(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var ug=function(e,t){var r={usedFields:[]},a=Is(e,t,r);if(a)return js(js({},a),r)},Is=function(e,t,r){if(e){var a=e.get("type"),o=e.get("children1");if((a==="group"||a==="rule_group")&&o&&o.size)return lg(e,t,r);if(a==="rule")return sg(e,t,r)}},lg=function(e,t,r){var a=e.get("properties")||new ye.Map,o=e.get("children1"),u=e.get("id"),i=o.map(function(d){return Is(d,t,r)}).filter(function(d){return typeof d<"u"});if(i.size){var l=a.get("conjunction");l||(l=Kt(t));var s=a.get("not"),c={id:u,rules:i.toList(),condition:l.toUpperCase(),not:s};return c}},sg=function(e,t,r){var a,o=e.get("properties")||new ye.Map,u=e.get("id"),i=o.get("operator"),l=o.get("operatorOptions"),s=o.get("field"),c=o.get("value"),d=o.get("valueSrc"),f=o.get("valueType"),p=c.filter(function(I){return I===void 0}).size>0;if(!(s==null||i==null||p)){var v=Re(t,s)||{},g=cr(t,i,s)||{},h=v.type||"undefined",b=Mr(g),O=t.types[v.type]||{},S=un(s,t,r);if(!(c.size<b)){r.usedFields.indexOf(s)==-1&&r.usedFields.push(s),c=c.toArray(),d=d.toArray(),f=((a=f)===null||a===void 0?void 0:a.toArray())||[];for(var A=[],L=0;L<c.length;L++){var F={type:f[L],value:c[L]};if(A.push(F),d[L]=="field"){var P=c[L];r.usedFields.indexOf(P)==-1&&r.usedFields.push(P)}}var N=l?l.toJS():null;N&&!Object.keys(N).length&&(N=null);var k={id:u,fieldName:S,type:h,input:O.mainWidget,operator:i};return N&&(k.operatorOptions=N),k.values=A,k}}};function Vs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ds(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Vs(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Vs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Ns(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=cg(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function cg(n,e){if(n){if(typeof n=="string")return xs(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return xs(n,e)}}function xs(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var dg=function(e,t){var r={usedFields:[],errors:[]},a=xt(t,void 0,!1),o=ks(e,a,r,!0),u=r.errors,i=r.usedFields,l=a.settings.fieldSeparator,s={},c=Ns(i),d;try{for(c.s();!(d=c.n()).done;)for(var f=d.value,p=Vr(f,t),v=Re(a,f)||{},g=s,h=0;h<p.length;h++){var b=p[h],O=Re(a,p.slice(0,h+1))||{};h!=p.length-1?O.type=="!group"&&O.mode!="struct"?(g[b]||(g[b]=[{}]),g=g[b][0]):(g[b]||(g[b]={}),g=g[b]):g[b]||(g[b]=null)}}catch(S){c.e(S)}finally{c.f()}return{errors:u,logic:o,data:s}},ks=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(e){var u=e.get("type"),i=e.get("properties")||new ye.Map,l=i.get("isLocked"),s=t.settings.jsonLogic.lockedOp,c;return u==="group"||u==="rule_group"?c=fg(e,t,r,a,o):u==="rule"&&(c=pg(e,t,r,o)),l&&c&&s&&(c=(0,re.A)({},s,c)),c}},fg=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=e.get("type"),i=e.get("properties")||new ye.Map,l=i.get("mode"),s=e.get("children1")||new ye.List,c=i.get("field"),d=i.get("conjunction");d||(d=Kt(t));var f=t.conjunctions[d],p=f.jsonLogicConj||d.toLowerCase(),v=i.get("not"),g=u==="rule_group"&&!a,h=g&&l!="struct"?c:o,b=i.get("operator"),O=b&&cr(t,b,c)||null,S=Ms(t,i,r,b,o),A=g&&(!b||O.cardinality==0),L=s.map(function(B){return ks(B,t,r,!1,h)}).filter(function(B){return typeof B<"u"});if(g&&l!="struct"&&!A){if(S==null)return}else if(!L.size)return;var F={};if(L.size==1&&!a?F=L.first():F[p]=L.toList().toJS(),v&&(F={"!":F}),g&&l!="struct"){var P=Si(r,t,c,o);if(A){var N=b||"some";F=(0,re.A)({},N,[P,F])}else{var k=L.size?{filter:[P,F]}:P,I={reduce:[k,{"+":[1,{var:"accumulator"}]},0]};F=Gs(t,i,I,S,b)}}return F},pg=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("properties")||new ye.Map,u=o.get("field"),i=o.get("fieldSrc"),l=o.get("operator"),s=o.get("operatorOptions");if(s=s?s.toJS():null,s&&!Object.keys(s).length&&(s=null),!(u==null||l==null)){var c=Re(t,u)||{},d=cr(t,l,u)||{},f=d.reversedOp,p=cr(t,f,u)||{},v=!1;if(!d.jsonLogic&&!p.jsonLogic){r.errors.push("Operator ".concat(l," is not supported"));return}if(!d.jsonLogic&&p.jsonLogic){v=!0;var g=[f,l];l=g[0],f=g[1];var h=[p,d];d=h[0],p=h[1]}var b=Ms(t,o,r,l,a);if(b!==void 0){var O=i==="func"?_s(r,t,u,a):Si(r,t,u,a);if(O!==void 0)return Gs(t,o,O,b,l,s,c,v)}}},Ms=function(e,t,r,a,o){var u=t.get("field"),i=t.get("valueSrc"),l=t.get("valueType"),s=Re(e,u)||{},c=cr(e,a,u)||{},d=Mr(c),f=t.get("value"),p=t.get("asyncListValues");if(f!=null){var v=[],g=[],h=r.usedFields,b=f.map(function(S,A){var L=i?i.get(A):null,F=l?l.get(A):null,P=Ln(S,L,e),N=Tr(e,u,a,L),k=Er()(rt(e,u,a,N,L),["factory"]),I=bi(r,e,P,L,F,k,s,a,c,o,p);return I!==void 0&&(v.push(L),g.push(F)),I}),O=b.filter(function(S){return S===void 0}).size>0;if(b.size<d||O){r.usedFields=h;return}return d>1?b.toArray():d==1?b.first():null}},bi=function(e,t,r,a,o,u,i,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0;if(r!==void 0){var f;if(a=="field")f=Si(e,t,r,c);else if(a=="func")f=_s(e,t,r,c);else if(typeof u.jsonLogic=="function"){var p=u.jsonLogic,v=[r,Ds(Ds({},Ut()(i,["fieldSettings","listValues"])),{},{asyncListValues:d}),Er()(u,En)];l&&(v.push(l),v.push(s)),f=p.call.apply(p,[t.ctx].concat(v))}else f=r;return f}},_s=function(e,t,r){var a,o,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=(a=r.get)===null||a===void 0?void 0:a.call(r,"func"),l=(o=r.get)===null||o===void 0?void 0:o.call(r,"args"),s=Gr(t,i),c=Vr(i,t),d=c[c.length-1];if(!s){e.errors.push("Func ".concat(i," is not defined in config"));return}if(!(s!=null&&s.jsonLogic)){e.errors.push("Func ".concat(i," is not supported"));return}var f={},p=[],v=[];for(var g in s.args){var h,b=s.args[g],O=Re(t,b),S=b.defaultValue,A=b.isOptional,L=S!=null&&S.func?"func":"value",F=l?l.get(g):void 0,P=F?F.get("value"):void 0,N=F?F.get("valueSrc"):void 0;N!=="func"&&(h=P)!==null&&h!==void 0&&h.toJS&&(P=P.toJS());var k=null,I=Tr(t,b,k,N),B=Er()(rt(t,b,k,I,N),["factory"]),U=bi(e,t,P,N,b.type,B,O,null,null,u);if(P!=null&&U===void 0){N!="func"&&e.errors.push("Can't format value of arg ".concat(g," for func ").concat(i));return}var x=void 0;if(U===void 0&&!A&&S!=null){var X=Tr(t,b,k,L),W=Er()(rt(t,b,k,X,L),["factory"]);if(x=bi(e,t,S,L,b.type,W,O,null,null,u),x===void 0){L!="func"&&e.errors.push("Can't format default value of arg ".concat(g," for func ").concat(i));return}}var J=U??x;if(J!==void 0){if(p.length){var G=Ns(p),ee;try{for(G.s();!(ee=G.n()).done;){var ie=ee.value;f[ie]=void 0}}catch(he){G.e(he)}finally{G.f()}p=[]}f[g]=J}else A||v.push(g),p.push(g)}if(!v.length){var de=Object.values(f),fe;if(typeof s.jsonLogic=="function"){var ne=s.jsonLogic,te=[f];fe=ne.call.apply(ne,[t.ctx].concat(te))}else{var ve=s.jsonLogic||d,se=!!s.jsonLogicIsMethod;if(se){var ue=de[0],Ce=de.slice(1);Ce.length?fe={method:[ue,ve,Ce]}:fe={method:[ue,ve]}}else fe=(0,re.A)({},ve,de)}return fe}},Si=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=t.settings,u=o.fieldSeparator,i=o.jsonLogic,l;if(r){Array.isArray(r)&&(r=r.join(u));var s=Re(t,r)||{},c=un(r,t,e,a),d=s.jsonLogicVar||(s.type=="!group"?i.groupVarKey:"var");l=(0,re.A)({},d,c),e.usedFields.indexOf(r)==-1&&e.usedFields.push(r)}return l},vg=function(e,t,r,a){var o,u=e,i=Mr(t),l=(o=t._jsonLogicIsRevArgs)!==null&&o!==void 0?o:!1;typeof t.jsonLogic=="string"&&(u=t.jsonLogic);var s=["<","<=",">",">="],c=["==","!="],d=function(p,v,g,h,b){return i==0&&c.includes(u)?(0,re.A)({},u,[r,null]):i==0?(0,re.A)({},u,r):i==1&&l?(0,re.A)({},u,[a,r]):i==1?(0,re.A)({},u,[r,a]):i==2&&s.includes(u)?(0,re.A)({},u,[a[0],r,a[1]]):(0,re.A)({},u,[r].concat((0,Se.A)(a)))};return d},Gs=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,s=t.get("field"),c=cr(e,o,s)||{},d=typeof c.jsonLogic=="function"?c.jsonLogic:vg(o,c,r,a),f=[r,o,a,Er()(c,_n),u,i],p=d.call.apply(d,[e.ctx].concat(f));return l&&(p={"!":p}),p};function gg(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=mg(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function mg(n,e){if(n){if(typeof n=="string")return $s(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return $s(n,e)}}function $s(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Us(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Bs(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Us(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Us(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Ws=function(e){return(0,Fr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},hg=function(e,t){return Ks(e,t,!1)},Ks=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},o=xt(t,void 0,!1),u=Fi([],e,o,a);return r?[u,a.errors]:(a.errors.length&&console.warn("Errors while exporting to MongoDb:",a.errors),u)},Fi=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0;if(t){var s=t.get("type");if(s==="group"||s==="rule_group")return yg(e,t,r,a,o,u,i,l);if(s==="rule")return Og(e,t,r,a,o,u,i,l)}},yg=function(e,t,r,a){var o,u,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0,d=t.get("type"),f=t.get("properties")||new ye.Map,p=t.get("children1")||new ye.List,v=r.settings,g=v.canShortMongoQuery,h=v.fieldSeparator,b=h,O=e.filter(function(te){return te.get("type")=="rule_group"}).length>0,S=e.filter(function(te){return te.get("type")=="rule_group"}).map(function(te){return te.get("properties").get("field")}).slice(-1).pop(),A=O&&S,L=d==="rule_group"?f.get("field"):null,F=d==="rule_group"?f.get("operator"):null,P=F?(o=(u=r.operators[F])===null||u===void 0?void 0:u.cardinality)!==null&&o!==void 0?o:1:void 0,N=un(L,r,a,A),k=Re(r,L)||{},I=k.mode,B=L&&I==="array"&&P>=1,U=i?!f.get("not"):f.get("not"),x=p.map(function(te){return Fi([].concat((0,Se.A)(e),[t]),te,r,a,U,I!="array",I=="array"?function(ve){return"$$el".concat(b).concat(ve)}:void 0)}).filter(function(te){return typeof te<"u"});if(!(!B&&!x.size)){var X=f.get("conjunction");X||(X=Kt(r));var W=r.conjunctions[X],J=W.reversedConj;if(U&&J&&(X=J,W=r.conjunctions[X]),!!W){var G=W.mongoConj,ee;if(x.size==1)ee=x.first();else if(x.size>1){var ie=x.toList().toJS(),de=g&&G=="$and";de&&(ee=ie.reduce(function(te,ve){if(te){for(var se in ve){if(se[0]=="$"){te=void 0;break}if(te[se]==null)te[se]=ve[se];else{var ue=te[se],Ce=ve[se];Ws(ue)||(ue={$eq:ue}),Ws(Ce)||(Ce={$eq:Ce});var he=Object.keys(ue)[0],Pe=Object.keys(Ce)[0];if(he==Pe){te=void 0;break}te[se]=Object.assign({},ue,Ce)}}return te}},{})),ee||(ee=(0,re.A)({},G,ie))}if(L)if(I=="array"){var fe={$size:{$ifNull:["$"+N,[]]}},ne=ee?{$size:{$ifNull:[{$filter:{input:"$"+N,as:"el",cond:ee}},[]]}}:fe;ee=Fi(e,t.set("type","rule"),r,a,!1,!1,function(te){return ne},fe),ee={$expr:ee}}else ee=(0,re.A)({},N,{$elemMatch:ee});return ee}}},Og=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0,s=t.get("properties")||new ye.Map,c=e.filter(function(ue){return ue.get("type")=="rule_group"}).length>0,d=e.filter(function(ue){return ue.get("type")=="rule_group"}).map(function(ue){return ue.get("properties").get("field")}).slice(-1).pop(),f=c&&d,p=s.get("operator"),v=s.get("operatorOptions"),g=s.get("field"),h=s.get("fieldSrc"),b=s.get("value"),O=s.get("valueSrc"),S=s.get("valueType"),A=s.get("asyncListValues");if(!(g==null||p==null||b===void 0)){var L=Re(r,g)||{},F=cr(r,p,g)||{},P=F.reversedOp,N=cr(r,P,g)||{},k=Mr(F),I=o;if(I&&P){var B=[P,p];p=B[0],P=B[1];var U=[N,F];F=U[0],N=U[1],I=!1}var x,X=!1;if(h=="func"){var W=Hs(a,r,g,f),J=(0,we.A)(W,2);x=J[0],X=J[1]}else x=un(g,r,a,f),i&&(X=!0,x=i(x));if(x!=null){var G=[],ee=[],ie;if(b!=null){var de=b.map(function(ue,Ce){var he=O?O.get(Ce):null,Pe=S?S.get(Ce):null,Ne=Ln(ue,he,r),Be=Tr(r,g,p,he),Qe=Er()(rt(r,g,p,Be,he),["factory"]),Je=Ei(a,r,Ne,he,Pe,Qe,L,f,p,F,A),We=(0,we.A)(Je,2),or=We[0],ar=We[1];return or!==void 0&&(X=X||ar,G.push(he),ee.push(Pe)),or}),fe=de.filter(function(ue){return ue===void 0}).size>0;if(de.size<k||fe)return;ie=k>1?de.toArray():k==1?de.first():null}var ne=X&&u,te=F.mongoFormatOp;if(!te){a.errors.push("Operator ".concat(p," is not supported"));return}var ve=[x,p,l!==void 0&&ie==null?l:ie,X,G.length>1?G:G[0],ee.length>1?ee:ee[0],Er()(F,_n),v,L],se=te.call.apply(te,[r.ctx].concat(ve));return ne&&(se={$expr:se}),I&&(se={$not:se}),se}}},Ei=function(e,t,r,a,o,u,i,l,s,c,d){if(r===void 0)return[void 0,!1];var f,p=!1;if(a=="field"){var v=bg(e,t,r,l),g=(0,we.A)(v,2);f=g[0],p=g[1]}else if(a=="func"){var h=Hs(e,t,r,l),b=(0,we.A)(h,2);f=b[0],p=b[1]}else if(typeof u.mongoFormatValue=="function"){var O=u.mongoFormatValue,S=[r,Bs(Bs({},Ut()(i,["fieldSettings","listValues"])),{},{asyncListValues:d}),Er()(u,En)];s&&(S.push(s),S.push(c)),f=O.call.apply(O,[t.ctx].concat(S))}else f=r;return[f,p]},bg=function(e,t,r,a){var o=t.settings.fieldSeparator,u,i=!0;if(r){var l=Re(t,r)||{},s=Vr(r,t),c=ha(r,t),d=c?c.join(o):null,f=t.settings.formatField,p=un(r,t,e,a),v=f(p,s,d,l,t,!1);u="$"+v}return[u,i]},Hs=function(e,t,r,a){var o,u,i=!0,l,s=(o=r.get)===null||o===void 0?void 0:o.call(r,"func"),c=(u=r.get)===null||u===void 0?void 0:u.call(r,"args"),d=Gr(t,s);if(!d)return e.errors.push("Func ".concat(s," is not defined in config")),[void 0,!1];var f=Vr(s,t),p=f[f.length-1],v=d.mongoFunc||p,g=d.mongoArgsAsObject,h={},b=0,O=void 0,S=[],A=[];for(var L in d.args){var F;b++;var P=d.args[L],N=Re(t,P),k=P.defaultValue,I=P.isOptional,B=k!=null&&k.func?"func":"value",U=c?c.get(L):void 0,x=U?U.get("value"):void 0,X=U?U.get("valueSrc"):void 0;X!=="func"&&(F=x)!==null&&F!==void 0&&F.toJS&&(x=x.toJS());var W=U?U.get("asyncListValues"):void 0,J=null,G=Tr(t,P,J,X),ee=Er()(rt(t,P,J,G,X),["factory"]),ie=Ei(e,t,x,X,P.type,ee,N,a,null,null,W),de=(0,we.A)(ie,2),fe=de[0],ne=de[1];if(x!=null&&fe===void 0)return X!="func"&&e.errors.push("Can't format value of arg ".concat(L," for func ").concat(s)),[void 0,!1];var te=void 0;if(fe===void 0&&!I&&k!=null){var ve=Tr(t,P,J,B),se=Er()(rt(t,P,J,ve,B),["factory"]),ue=void 0,Ce=Ei(e,t,k,B,P.type,se,N,a,null,null,W),he=(0,we.A)(Ce,2);if(te=he[0],ue=he[1],te===void 0)return B!="func"&&e.errors.push("Can't format default value of arg ".concat(L," for func ").concat(s)),[void 0,!1]}var Pe=fe??te;if(Pe!==void 0){if(S.length){var Ne=gg(S),Be;try{for(Ne.s();!(Be=Ne.n()).done;){var Qe=Be.value;h[Qe]=void 0}}catch(or){Ne.e(or)}finally{Ne.f()}S=[]}h[L]=Pe,O=Pe}else I||A.push(L),S.push(L)}if(A.length)return[void 0,!1];if(typeof d.mongoFormatFunc=="function"){var Je=d.mongoFormatFunc,We=[h];l=Je.call.apply(Je,[t.ctx].concat(We))}else{if(d.mongoFormatFunc===null)return e.errors.push("Functon ".concat(v," is not supported")),[void 0,!1];g?l=(0,re.A)({},v,h):b==1&&O!==void 0?l=(0,re.A)({},v,O):l=(0,re.A)({},v,Object.values(h))}return[l,i]};function Sg(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Fg(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Fg(n,e){if(n){if(typeof n=="string")return zs(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return zs(n,e)}}function zs(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function qs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Js(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qs(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):qs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Eg=function(e,t){return Qs(e,t,!1)},Qs=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},o=xt(t,void 0,!1),u=Ys(e,o,a);return r?[u,a.errors]:(a.errors.length&&console.warn("Errors while exporting to SQL:",a.errors),u)},Ys=function(e,t,r){if(e){var a=e.get("type"),o=e.get("children1");if(a==="group"||a==="rule_group")return Cg(e,t,r);if(a==="rule")return Ag(e,t,r)}},Cg=function(e,t,r){var a=e.get("type"),o=e.get("properties")||new ye.Map,u=e.get("children1")||new ye.List,i=a==="rule_group",l=i?o.get("field"):null,s=Re(t,l)||{},c=s.mode;c=="array"&&r.errors.push("Aggregation is not supported for ".concat(l));var d=o.get("not"),f=!1,p=u.map(function(h){return Ys(h,t,r)}).filter(function(h){return typeof h<"u"});if(!(!f&&!p.size)){var v=o.get("conjunction");v||(v=Kt(t));var g=t.conjunctions[v];return g.sqlFormatConj(p,v,d)}},Tg=function(e,t){var r=t.sqlOp||e,a=Mr(t),o;return a==0?o=function(i,l,s,c,d,f,p,v){return"".concat(i," ").concat(r)}:a==1?o=function(i,l,s,c,d,f,p,v){return"".concat(i," ").concat(r," ").concat(s)}:a==2&&(o=function(i,l,s,c,d,f,p,v){var g,h,b=s==null||(g=s.first)===null||g===void 0?void 0:g.call(s),O=s==null||(h=s.get)===null||h===void 0?void 0:h.call(s,1);return"".concat(i," ").concat(r," ").concat(b," AND ").concat(O)}),o},Ag=function(e,t,r){var a=e.get("properties")||new ye.Map,o=a.get("field"),u=a.get("fieldSrc"),i=a.get("operator"),l=a.get("operatorOptions"),s=a.get("valueSrc"),c=a.get("valueType"),d=a.get("value"),f=a.get("asyncListValues");if(!(o==null||i==null)){var p=Re(t,o)||{},v=cr(t,i,o)||{},g=v.reversedOp,h=cr(t,g,o)||{},b=Mr(v),O=!1,S=v.sqlOp||v.sqlFormatOp,A=h.sqlOp||h.sqlFormatOp;if(!S&&!A){r.errors.push("Operator ".concat(i," is not supported"));return}if(!S&&A){O=!0;var L=[g,i];i=L[0],g=L[1];var F=[h,v];v=F[0],h=F[1]}var P=[],N=[],k;if(d!=null){var I=d.map(function(J,G){var ee=s?s.get(G):null,ie=c?c.get(G):null,de=Ln(J,ee,t),fe=Tr(t,o,i,ee),ne=Er()(rt(t,o,i,fe,ee),["factory"]),te=Ci(r,t,de,ee,ie,ne,p,i,v,f);return te!==void 0&&(P.push(ee),N.push(ie)),te}),B=I.filter(function(J){return J===void 0}).size>0;if(B||I.size<b)return;k=b==1?I.first():I}var U=v.sqlFormatOp||Tg(i,v);if(!U){r.errors.push("Operator ".concat(i," is not supported"));return}var x=u=="func"?Zs(r,t,o):Xs(r,t,o);if(x!=null){var X=[x,i,k,P.length>1?P:P[0],N.length>1?N:N[0],Er()(v,_n),l,p],W;if(W=U.call.apply(U,[t.ctx].concat(X)),O&&(W=t.settings.sqlFormatReverse(W)),W===void 0){r.errors.push("Operator ".concat(i," is not supported for value source ").concat(P.join(", ")));return}return W}}},Ci=function(e,t,r,a,o,u,i,l,s,c){if(r!==void 0){var d;if(a=="field")d=Xs(e,t,r);else if(a=="func")d=Zs(e,t,r);else if(typeof u.sqlFormatValue=="function"){var f=u.sqlFormatValue,p=[r,Js(Js({},Ut()(i,["fieldSettings","listValues"])),{},{asyncListValues:c}),Er()(u,En)];if(l&&(p.push(l),p.push(s)),a=="field"){var v=Re(t,r)||{};p.push(v)}d=f.call.apply(f,[t.ctx].concat(p))}else Array.isArray(r)?d=r.map(function(g){return gn.escape(g)}):d=gn.escape(r);return d}},Xs=function(e,t,r){if(r){var a=t.settings.fieldSeparator,o=Re(t,r)||{},u=Vr(r,t),i=ha(r,t),l=i?i.join(a):null,s=t.settings.formatField,c=un(r,t,e,null,{useTableName:!0}),d=s(c,u,l,o,t);return d}},Zs=function(e,t,r){var a,o,u=(a=r.get)===null||a===void 0?void 0:a.call(r,"func"),i=(o=r.get)===null||o===void 0?void 0:o.call(r,"args"),l=Gr(t,u);if(!l){e.errors.push("Func ".concat(u," is not defined in config"));return}var s=Vr(u,t),c=s[s.length-1],d=l.sqlFunc||c,f={},p=[],v=[];for(var g in l.args){var h,b=l.args[g],O=Re(t,b),S=b.defaultValue,A=b.isOptional,L=S!=null&&S.func?"func":"value",F=i?i.get(g):void 0,P=F?F.get("value"):void 0,N=F?F.get("valueSrc"):void 0;N!=="func"&&(h=P)!==null&&h!==void 0&&h.toJS&&(P=P.toJS());var k=F?F.get("asyncListValues"):void 0,I=Ci(e,t,P,N,b.type,O,b,null,null,k);if(P!=null&&I===void 0){N!="func"&&e.errors.push("Can't format value of arg ".concat(g," for func ").concat(u));return}var B=void 0;if(I===void 0&&!A&&S!=null&&(B=Ci(e,t,S,L,b.type,O,b,null,null,k),B===void 0)){L!="func"&&e.errors.push("Can't format default value of arg ".concat(g," for func ").concat(u));return}var U=I??B;if(U!==void 0){if(p.length){var x=Sg(g),X;try{for(x.s();!(X=x.n()).done;){var W=X.value;f[W]=void 0}}catch(de){x.e(de)}finally{x.f()}p=[]}f[g]=U}else A||v.push(g),p.push(g)}if(!v.length){var J;if(typeof l.sqlFormatFunc=="function"){var G=l.sqlFormatFunc,ee=[f];J=G.call.apply(G,[t.ctx].concat(ee))}else{var ie=Object.entries(f).map(function(de){var fe=(0,we.A)(de,2),ne=fe[0],te=fe[1];return te}).join(", ");J="".concat(d,"(").concat(ie,")")}return J}};function ec(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function rc(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ec(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ec(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Lg(n){if(n==null)return null;var e=n.split(",").map(Number);return{top_left:{lat:e[0],lon:e[1]},bottom_right:{lat:e[2],lon:e[3]}}}function wg(n,e){if(n.length>1)return{gte:"".concat(n[0]),lte:"".concat(n[1])};var t=n[0];switch(e){case"on_date":case"not_on_date":case"equal":case"select_equals":case"not_equal":return{gte:"".concat(t,"||/d"),lte:"".concat(t,"||+1d")};case"less_or_equal":return{lte:"".concat(t)};case"greater_or_equal":return{gte:"".concat(t)};case"less":return{lt:"".concat(t)};case"greater":return{gt:"".concat(t)};default:return}}function Rg(n){return{value:"*"+n+"*"}}function Pg(n,e){switch(n){case"AND":return e?"must_not":"must";case"OR":return e?"should_not":"should";case"NOT":return e?"must":"must_not";default:return}}function jg(n){return{value:n}}function Ig(n,e){return n}function Vg(n,e,t,r,a,o){var u=Ig(r,a);switch(n){case"filter":return{script:a.operators[t].elasticSearchScript(r,e)};case"exists":return{field:r};case"match":return(0,re.A)({},u,e[0]);case"term":return o===Ng?(0,re.A)({},r,{value:e[0]}):(0,re.A)({},r,e[0]);case"geo_bounding_box":return(0,re.A)({},r,Lg(e[0]));case"range":return(0,re.A)({},r,wg(e,t));case"wildcard":return(0,re.A)({},r,Rg(e[0]));case"regexp":return(0,re.A)({},r,jg(e[0]));default:return}}function tc(n,e,t,r,a,o){if(!(!n||!t||e==null)){var u=t,i=r.operators[u];if(i){var l=i,s=l.elasticSearchQueryType,c=!1;if(!s&&i.reversedOp){c=!0,u=i.reversedOp,i=r.operators[u];var d=i;s=d.elasticSearchQueryType}var f=Tr(r,n,u,a),p=r.widgets[f];if(p){var v=p.elasticSearchFormatValue,g;if(typeof s=="function"?g=s(f):g=s,!!g){var h;return typeof v=="function"?h=v(g,e,u,n,r):h=Vg(g,e,u,n,r,o),c?{bool:{must_not:(0,re.A)({},g,rc({},h))}}:(0,re.A)({},g,rc({},h))}}}}}function Dg(n,e,t,r,a,o){if(!(!n||!n.size)){var u=n.valueSeq().toArray(),i=Pg(e,t),l=u.map(function(c){return r(c,a,o)}).filter(function(c){return c!==void 0});if(l.length){var s=l.flat(1/0);return{bool:(0,re.A)({},i,s)}}}}var Ng="ES_7_SYNTAX",xg="ES_6_SYNTAX";function nc(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:xg;if(n){var r=n.get("type"),a=n.get("properties")||new Map;if(r==="rule"&&a.get("field")){var o,u,i,l=a.get("operator"),s=a.get("field"),c=a.get("fieldSrc"),d=(o=a.get("value"))===null||o===void 0?void 0:o.toJS(),f=(u=a.get("valueType"))===null||u===void 0?void 0:u.get(0),p=(i=a.get("valueSrc"))===null||i===void 0?void 0:i.get(0);return p==="func"||c=="func"?void 0:d&&Array.isArray(d[0])?d[0].map(function(b){return tc(s,[b],l,e,p,t)}):tc(s,d,l,e,p,t)}if(r==="group"||r==="rule_group"){var v=a.get("not"),g=a.get("conjunction");g||(g=Kt(e));var h=n.get("children1");return Dg(h,g,v,nc,e,t)}}}var Yn=y(80045);function ac(n,e,t,r,a,o,u){try{var i=n[o](u),l=i.value}catch(s){return void t(s)}i.done?e(l):Promise.resolve(l).then(r,a)}function kg(n){return function(){var e=this,t=arguments;return new Promise(function(r,a){var o=n.apply(e,t);function u(l){ac(o,r,a,u,i,"next",l)}function i(l){ac(o,r,a,u,i,"throw",l)}u(void 0)})}}var Mg=["title","value","disabled","groupTitle","grouplabel","renderTitle","children","label","isCustom","isHidden"];function _g(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Gg(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Gg(n,e){if(n){if(typeof n=="string")return oc(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return oc(n,e)}}function oc(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function ic(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function yn(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ic(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ic(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var $g=function(e,t){if(e.findLastIndex)return e.findLastIndex(t);var r=(0,Se.A)(e).reverse().findIndex(t);return r==-1?-1:e.length-1-r},Ug=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3;return function(){var a=kg(nn().mark(function o(u,i,l){var s,c,d,f,p,v,g,h;return nn().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(s=l?.pageSize!=null?l.pageSize:t,c=du(e).filter(function(S){var A=S.title,L=S.value;return u==null?!0:A.toUpperCase().indexOf(u.toUpperCase())!=-1||"".concat(L).toUpperCase().indexOf(u.toUpperCase())!=-1}),d=s?Math.ceil(c.length/s):0,f=i||0,p=s?Math.ceil(f/s):null,v=s?c.slice(f,f+s):c,g=s?f+v.length:null,h=s?g<c.length:!1,!r){O.next=11;break}return O.next=11,nu(r);case 11:return O.abrupt("return",{values:v,hasMore:h});case 12:case"end":return O.stop()}},o)}));return function(o,u,i){return a.apply(this,arguments)}}()},Bg=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!t)return e;var o=e||[],u=t.filter(function(l){return o.find(function(s){return""+s.value==""+l.value})==null}).map(function(l){return a?yn(yn({},l),{},{isHidden:!0}):l}),i=r?[].concat((0,Se.A)(u),(0,Se.A)(o)):[].concat((0,Se.A)(o),(0,Se.A)(u));return i},Wg=function(e,t,r){var a,o=e==null||e==""?void 0:(a=e?.value)!==null&&a!==void 0?a:e,u=_a(o,t),i=r&&!u?Do(o):void 0,l=u||i,s=l?[l]:void 0;return[o,s]},Kg=function(e,t,r){var a=e.map(function(u,i){var l,s=u==null||u==""?void 0:(l=u?.value)!==null&&l!==void 0?l:u,c=_a(s,t),d=r&&!c?Do(s):void 0,f=c||d;return f}).filter(function(u){return u!=null}),o=a.map(function(u){var i;return(i=u?.value)!==null&&i!==void 0?i:u});return o.length||(o=void 0),[o,a]},Hg=function(e){if(e==null)return null;var t=e.title,r=e.value,a=e.disabled,o=e.groupTitle,u=e.grouplabel,i=e.renderTitle,l=e.children,s=e.label,c=e.isCustom,d=e.isHidden,f=(0,Yn.A)(e,Mg),p={value:r,title:t||s||l};return a&&(p.disabled=a),c&&(p.isCustom=c),d&&(p.isHidden=d),(o||u)&&(p.groupTitle=o||u),i&&(p.renderTitle=i),p=yn(yn({},p),f),p},zg=function(e){var t=[],r=[],a=_g(e),o;try{var u=function(){var l=o.value,s=$g(t,function(c){var d,f;return((d=c.groupTitle)!==null&&d!==void 0?d:"")==((f=l.groupTitle)!==null&&f!==void 0?f:"")});l.groupTitle!=null&&!r.includes(l.groupTitle)&&(r.push(l.groupTitle),r.length===1&&(t=t.map(function(c){return yn(yn({},c),{},{groupTitle:""})}))),l.groupTitle==null&&r.length&&(l=yn(yn({},l),{},{groupTitle:""})),s!=-1?t.splice(s+1,0,l):t.push(l)};for(a.s();!(o=a.n()).done;)u()}catch(i){a.e(i)}finally{a.f()}return t},qg={label:"Now",returnType:"datetime",jsonLogic:"now",jsonLogicCustomOps:{now:{}},spelFunc:"T(java.time.LocalDateTime).now()",sqlFormatFunc:function(){return"NOW()"},mongoFormatFunc:function(){return new Date},formatFunc:function(){return"NOW"}},Jg={label:"Relative",returnType:"datetime",renderBrackets:["",""],renderSeps:["","",""],spelFormatFunc:function(e){var t=e.date,r=e.op,a=e.val,o=e.dim,u=o.charAt(0).toUpperCase()+o.slice(1)+"s",i=r+u;return"".concat(t,".").concat(i,"(").concat(a,")")},spelImport:function(e){var t,r,a,o,u,i=(t=e.methodName)===null||t===void 0?void 0:t.match(/^(minus|plus)(\w+)s$/);if(i&&(u=i[2].toLowerCase(),a=i[1],["minus","plus"].includes(a)&&["day","week","month","year"].includes(u)))return a={type:"string",val:a},u={type:"string",val:u},o=e.args[0],r=e.obj,{date:r,op:a,val:o,dim:u}},jsonLogic:function(e){var t=e.date,r=e.op,a=e.val,o=e.dim;return{date_add:[t,a*(r=="minus"?-1:1),o]}},jsonLogicImport:function(e){var t=e.date_add[0],r=Math.abs(e.date_add[1]),a=e.date_add[1]>=0?"plus":"minus",o=e.date_add[2];return[t,a,r,o]},jsonLogicCustomOps:{date_add:{}},sqlFormatFunc:function(e){var t=e.date,r=e.op,a=e.val,o=e.dim;return"DATE_ADD(".concat(t,", INTERVAL ").concat(parseInt(a)*(r=="minus"?-1:1)," ").concat(o.replace(/^'|'$/g,""),")")},mongoFormatFunc:null,formatFunc:function(e){var t=e.date,r=e.op,a=e.val,o=e.dim;return a?"".concat(t," ").concat(r=="minus"?"-":"+"," ").concat(a," ").concat(o):t},args:{date:{label:"Date",type:"datetime",defaultValue:{func:"NOW",args:[]},valueSources:["func","field","value"],spelEscapeForFormat:!0},op:{label:"Op",type:"select",defaultValue:"plus",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{plus:"+",minus:"-"}},spelEscapeForFormat:!1},val:{label:"Value",type:"number",fieldSettings:{min:0},defaultValue:0,valueSources:["value"],spelEscapeForFormat:!1},dim:{label:"Dimension",type:"select",defaultValue:"day",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{day:"day",week:"week",month:"month",year:"year"}},spelEscapeForFormat:!1}}},Qg={label:"Lowercase",mongoFunc:"$toLower",jsonLogic:"toLowerCase",spelFunc:"${str}.toLowerCase()",jsonLogicCustomOps:{toLowerCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},Yg={label:"Uppercase",mongoFunc:"$toUpper",jsonLogic:"toUpperCase",spelFunc:"${str}.toUpperCase()",jsonLogicCustomOps:{toUpperCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},Xg={label:"Linear regression",returnType:"number",formatFunc:function(e,t){var r=e.coef,a=e.bias,o=e.val;return"(".concat(r," * ").concat(o," + ").concat(a,")")},sqlFormatFunc:function(e){var t=e.coef,r=e.bias,a=e.val;return"(".concat(t," * ").concat(a," + ").concat(r,")")},spelFormatFunc:function(e){var t=e.coef,r=e.bias,a=e.val;return"(".concat(t," * ").concat(a," + ").concat(r,")")},spelImport:function(e){var t,r,a,o;if(e.type==="op-plus"){var u=(0,we.A)(e.children,2);if(o=u[0],a=u[1],o.type==="op-multiply"){var i=(0,we.A)(o.children,2);return t=i[0],r=i[1],{coef:t,val:r,bias:a}}}},mongoFormatFunc:function(e){var t=e.coef,r=e.bias,a=e.val;return{$sum:[{$multiply:[t,a]},r]}},jsonLogic:function(e){var t=e.coef,r=e.bias,a=e.val;return{"+":[{"*":[t,a]},r]}},jsonLogicImport:function(e){var t=e["+"][0]["*"][0],r=e["+"][0]["*"][1],a=e["+"][1];return[t,r,a]},renderBrackets:["",""],renderSeps:[" * "," + "],args:{coef:{label:"Coef",type:"number",defaultValue:1,valueSources:["value"]},val:{label:"Value",type:"number",valueSources:["value","field"]},bias:{label:"Bias",type:"number",defaultValue:0,valueSources:["value"]}}},Zg=function(e,t,r,a,o,u,i,l,s,c,d,f){var p=typeof a=="string"&&!a.startsWith("$")?"$"+a:a,v=t(u,f);if(v!==void 0)return r?!i&&(!e||e=="$eq")?(0,re.A)({},a,{$ne:v}):i?{$not:(0,re.A)({},e,[p,v])}:(0,re.A)({},a,{$not:(0,re.A)({},e,v)}):!i&&(!e||e=="$eq")?(0,re.A)({},a,v):i?(0,re.A)({},e,[p,v]):(0,re.A)({},a,(0,re.A)({},e,v))},em=function(e,t,r,a,o,u,i,l,s,c,d){var f=typeof r=="string"&&!r.startsWith("$")?"$"+r:r;return t?u?{$not:{$and:[(0,re.A)({},e[0],[f,o[0]]),(0,re.A)({},e[1],[f,o[1]])]}}:(0,re.A)({},r,{$not:(0,re.A)((0,re.A)({},e[0],o[0]),e[1],o[1])}):u?{$and:[(0,re.A)({},e[0],[f,o[0]]),(0,re.A)({},e[1],[f,o[1]])]}:(0,re.A)({},r,(0,re.A)((0,re.A)({},e[0],o[0]),e[1],o[1]))},rm={utils:{SqlString:gn,moment:Un(),mongoFormatOp1:Zg,mongoFormatOp2:em,mongoEmptyValue:wu,escapeRegExp:tu,sqlEmptyValue:Lu,stringifyForDisplay:Pu,getTitleInListValues:fu,spelEscape:Bn,spelFixList:Ru}};const tm=rm;function nm(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=am(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function am(n,e){if(n){if(typeof n=="string")return uc(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return uc(n,e)}}function uc(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function lc(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function ur(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?lc(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):lc(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var om={AND:{label:"And",mongoConj:"$and",jsonLogicConj:"and",sqlConj:"AND",spelConj:"and",spelConjs:["and","&&"],reversedConj:"OR",formatConj:function(e,t,r,a){return e.size>1?(r?"NOT ":"")+"("+e.join(" "+(a?"AND":"&&")+" ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},sqlFormatConj:function(e,t,r){return e.size>1?(r?"NOT ":"")+"("+e.join(" AND ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},spelFormatConj:function(e,t,r,a){return r&&(a=!1),e.size>1?(r?"!":"")+(a?"":"(")+e.join(" && ")+(a?"":")"):(r?"!(":"")+e.first()+(r?")":"")}},OR:{label:"Or",mongoConj:"$or",jsonLogicConj:"or",sqlConj:"OR",spelConj:"or",spelConjs:["or","||"],reversedConj:"AND",formatConj:function(e,t,r,a){return e.size>1?(r?"NOT ":"")+"("+e.join(" "+(a?"OR":"||")+" ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},sqlFormatConj:function(e,t,r){return e.size>1?(r?"NOT ":"")+"("+e.join(" OR ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},spelFormatConj:function(e,t,r,a){return r&&(a=!1),e.size>1?(r?"!":"")+(a?"":"(")+e.join(" || ")+(a?"":")"):(r?"!(":"")+e.first()+(r?")":"")}}},im={equal:{label:"==",labelForFormat:"==",sqlOp:"=",spelOp:"==",spelOps:["==","eq"],reversedOp:"not_equal",formatOp:function(e,t,r,a,o,u,i,l,s){var c=l?"=":u.label;return o=="boolean"&&l?r=="No"?"NOT ".concat(e):"".concat(e):"".concat(e," ").concat(c," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(r))},jsonLogic:"==",elasticSearchQueryType:"term"},not_equal:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",spelOp:"!=",spelOps:["!=","ne"],reversedOp:"equal",formatOp:function(e,t,r,a,o,u,i,l,s){return o=="boolean"&&l?r=="No"?"".concat(e):"NOT ".concat(e):"".concat(e," ").concat(u.label," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return o},!1].concat(r))},jsonLogic:"!="},less:{label:"<",labelForFormat:"<",sqlOp:"<",spelOp:"<",spelOps:["<","lt"],reversedOp:"greater_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$lt",function(o){return o},!1].concat(r))},jsonLogic:"<",elasticSearchQueryType:"range"},less_or_equal:{label:"<=",labelForFormat:"<=",sqlOp:"<=",spelOp:"<=",spelOps:["<=","le"],reversedOp:"greater",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$lte",function(o){return o},!1].concat(r))},jsonLogic:"<=",elasticSearchQueryType:"range"},greater:{label:">",labelForFormat:">",sqlOp:">",spelOp:">",spelOps:[">","gt"],reversedOp:"less_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(o){return o},!1].concat(r))},jsonLogic:">",elasticSearchQueryType:"range"},greater_or_equal:{label:">=",labelForFormat:">=",sqlOp:">=",spelOp:">=",spelOps:[">=","ge"],reversedOp:"less",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$gte",function(o){return o},!1].concat(r))},jsonLogic:">=",elasticSearchQueryType:"range"},like:{label:"Contains",labelForFormat:"Contains",reversedOp:"not_like",sqlOp:"LIKE",spelOp:"${0}.contains(${1})",valueTypes:["text"],mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?t.utils.escapeRegExp(u):void 0},!1].concat(a))},jsonLogic:"in",_jsonLogicIsRevArgs:!0,valueSources:["value"],elasticSearchQueryType:"regexp"},not_like:{isNotOp:!0,label:"Not contains",reversedOp:"like",labelForFormat:"Not Contains",sqlOp:"NOT LIKE",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?t.utils.escapeRegExp(u):void 0},!0].concat(a))},valueSources:["value"]},starts_with:{label:"Starts with",labelForFormat:"Starts with",sqlOp:"LIKE",spelOp:"${0}.startsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?"^"+t.utils.escapeRegExp(u):void 0},!1].concat(a))},jsonLogic:void 0,valueSources:["value"]},ends_with:{label:"Ends with",labelForFormat:"Ends with",sqlOp:"LIKE",spelOp:"${0}.endsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?t.utils.escapeRegExp(u)+"$":void 0},!1].concat(a))},jsonLogic:void 0,valueSources:["value"]},between:{label:"Between",labelForFormat:"BETWEEN",sqlOp:"BETWEEN",cardinality:2,formatOp:function(e,t,r,a,o,u,i,l){var s=r.first(),c=r.get(1);return l?"".concat(e," BETWEEN ").concat(s," AND ").concat(c):"".concat(e," >= ").concat(s," && ").concat(e," <= ").concat(c)},spelFormatOp:function(e,t,r,a,o,u,i,l){var s=r[0],c=r[1];return"".concat(e," >= ").concat(s," && ").concat(e," <= ").concat(c)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!1].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"not_between",jsonLogic:"<=",validateValues:function(e){return e[0]!=null&&e[1]!=null?e[0]<=e[1]:null},elasticSearchQueryType:function(e){return e==="time"?"filter":"range"}},not_between:{isNotOp:!0,label:"Not between",labelForFormat:"NOT BETWEEN",sqlOp:"NOT BETWEEN",cardinality:2,formatOp:function(e,t,r,a,o,u,i,l){var s=r.first(),c=r.get(1);return l?"".concat(e," NOT BETWEEN ").concat(s," AND ").concat(c):"(".concat(e," < ").concat(s," || ").concat(e," > ").concat(c,")")},spelFormatOp:function(e,t,r,a,o,u,i,l){var s=r[0],c=r[1];return"(".concat(e," < ").concat(s," || ").concat(e," > ").concat(c,")")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!0].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"between",validateValues:function(e){return e[0]!=null&&e[1]!=null?e[0]<=e[1]:null}},is_empty:{label:"Is empty",labelForFormat:"IS EMPTY",cardinality:0,reversedOp:"is_not_empty",formatOp:function(e,t,r,a,o,u,i,l){return l?"".concat(e," IS EMPTY"):"!".concat(e)},sqlFormatOp:function(e,t,r,a,o,u,i,l){var s=this.utils.sqlEmptyValue(l);return"COALESCE(".concat(e,", ").concat(s,") = ").concat(s)},spelFormatOp:function(e,t,r,a,o,u,i,l){return"".concat(e," <= ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(u,i){return[t.utils.mongoEmptyValue(i),null]},!1].concat(a))},jsonLogic:"!"},is_not_empty:{isNotOp:!0,label:"Is not empty",labelForFormat:"IS NOT EMPTY",cardinality:0,reversedOp:"is_empty",formatOp:function(e,t,r,a,o,u,i,l){return l?"".concat(e," IS NOT EMPTY"):"!!".concat(e)},sqlFormatOp:function(e,t,r,a,o,u,i,l){var s=this.utils.sqlEmptyValue(l);return"COALESCE(".concat(e,", ").concat(s,") <> ").concat(s)},spelFormatOp:function(e,t,r,a,o,u,i,l){return"".concat(e," > ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(u,i){return[t.utils.mongoEmptyValue(i),null]},!1].concat(a))},jsonLogic:"!!",elasticSearchQueryType:"exists"},is_null:{label:"Is null",labelForFormat:"IS NULL",sqlOp:"IS NULL",cardinality:0,reversedOp:"is_not_null",formatOp:function(e,t,r,a,o,u,i,l){return l?"".concat(e," IS NULL"):"!".concat(e)},spelFormatOp:function(e,t,r,a,o,u,i,l){return"".concat(e," == null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return null},!1].concat(r))},jsonLogic:"=="},is_not_null:{label:"Is not null",labelForFormat:"IS NOT NULL",sqlOp:"IS NOT NULL",cardinality:0,reversedOp:"is_null",formatOp:function(e,t,r,a,o,u,i,l){return l?"".concat(e," IS NOT NULL"):"!!".concat(e)},spelFormatOp:function(e,t,r,a,o,u,i,l){return"".concat(e," != null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return null},!1].concat(r))},jsonLogic:"!=",elasticSearchQueryType:"exists"},select_equals:{label:"==",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,a,o,u,i,l){var s=l?"=":"==";return"".concat(e," ").concat(s," ").concat(r)},spelOp:"==",spelOps:["==","eq"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(r))},reversedOp:"select_not_equals",jsonLogic:"==",elasticSearchQueryType:"term"},select_not_equals:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,a,o,u,i,l){return"".concat(e," != ").concat(r)},spelOp:"!=",spelOps:["!=","ne"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return o},!1].concat(r))},reversedOp:"select_equals",jsonLogic:"!="},select_any_in:{label:"Any in",labelForFormat:"IN",sqlOp:"IN",formatOp:function(e,t,r,a,o,u,i,l){return a=="value"?"".concat(e," IN (").concat(r.join(", "),")"):"".concat(e," IN (").concat(r,")")},sqlFormatOp:function(e,t,r,a,o,u,i,l){if(a=="value")return"".concat(e," IN (").concat(r.join(", "),")")},valueTypes:["multiselect"],spelOp:"${1}.contains(${0})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(o){return o},!1].concat(r))},reversedOp:"select_not_any_in",jsonLogic:"in",elasticSearchQueryType:"term"},select_not_any_in:{isNotOp:!0,label:"Not in",labelForFormat:"NOT IN",sqlOp:"NOT IN",formatOp:function(e,t,r,a,o,u,i,l){return a=="value"?"".concat(e," NOT IN (").concat(r.join(", "),")"):"".concat(e," NOT IN (").concat(r,")")},sqlFormatOp:function(e,t,r,a,o,u,i,l){if(a=="value")return"".concat(e," NOT IN (").concat(r.join(", "),")")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(o){return o},!1].concat(r))},reversedOp:"select_any_in"},multiselect_contains:{label:"Contains",labelForFormat:"CONTAINS",formatOp:function(e,t,r,a,o,u,i,l){return a=="value"?"".concat(e," CONTAINS [").concat(r.join(", "),"]"):"".concat(e," CONTAINS ").concat(r)},reversedOp:"multiselect_not_contains",jsonLogic2:"some-in",jsonLogic:function(e,t,r){return{some:[e,{in:[{var:""},r]}]}},spelOp:"T(CollectionUtils).containsAny(${0}, ${1})",elasticSearchQueryType:"term",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(o){return o},!1].concat(r))}},multiselect_not_contains:{isNotOp:!0,label:"Not contains",labelForFormat:"NOT CONTAINS",formatOp:function(e,t,r,a,o,u,i,l){return a=="value"?"".concat(e," NOT CONTAINS [").concat(r.join(", "),"]"):"".concat(e," NOT CONTAINS ").concat(r)},reversedOp:"multiselect_contains"},multiselect_equals:{label:"Equals",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,a,o,u,i,l){var s=l?"=":"==";return a=="value"?"".concat(e," ").concat(s," [").concat(r.join(", "),"]"):"".concat(e," ").concat(s," ").concat(r)},sqlFormatOp:function(e,t,r,a,o,u,i,l){var s=this;if(a=="value")return"".concat(e," = '").concat(r.map(function(c){return s.utils.SqlString.trim(c)}).join(","),"'")},spelOp:"${0}.equals(${1})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(r))},reversedOp:"multiselect_not_equals",jsonLogic2:"all-in",jsonLogic:function(e,t,r){return{all:[e,{in:[{var:""},r]}]}},elasticSearchQueryType:"term"},multiselect_not_equals:{isNotOp:!0,label:"Not equals",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,a,o,u,i,l){return a=="value"?"".concat(e," != [").concat(r.join(", "),"]"):"".concat(e," != ").concat(r)},sqlFormatOp:function(e,t,r,a,o,u,i,l){var s=this;if(a=="value")return"".concat(e," != '").concat(r.map(function(c){return s.utils.SqlString.trim(c)}).join(","),"'")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return o},!1].concat(r))},reversedOp:"multiselect_equals"},proximity:{label:"Proximity search",cardinality:2,valueLabels:[{label:"Word 1",placeholder:"Enter first word"},{label:"Word 2",placeholder:"Enter second word"}],textSeparators:[],formatOp:function(e,t,r,a,o,u,i,l){var s=r.first(),c=r.get(1),d=i.get("proximity");return"".concat(e," ").concat(s," NEAR/").concat(d," ").concat(c)},sqlFormatOp:function(e,t,r,a,o,u,i,l){var s=r.first(),c=r.get(1),d=this.utils.SqlString.trim(s),f=this.utils.SqlString.trim(c),p=i.get("proximity");return"CONTAINS(".concat(e,", 'NEAR((").concat(d,", ").concat(f,"), ").concat(p,")')")},mongoFormatOp:void 0,jsonLogic:void 0,options:{optionLabel:"Near",optionTextBefore:"Near",optionPlaceholder:"Select words between",minProximity:2,maxProximity:10,defaults:{proximity:2}}},some:{label:"Some",labelForFormat:"SOME",cardinality:0,jsonLogic:"some",spelFormatOp:function(e){return"".concat(e," > 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(o){return 0},!1].concat(r))}},all:{label:"All",labelForFormat:"ALL",cardinality:0,jsonLogic:"all",spelFormatOp:function(e,t,r){return"".concat(e," == ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(r))}},none:{label:"None",labelForFormat:"NONE",cardinality:0,jsonLogic:"none",spelFormatOp:function(e){return"".concat(e," == 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return 0},!1].concat(r))}}},um={text:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"String",valuePlaceholder:"Enter string",formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},spelFormatValue:function(e,t,r,a,o){return this.utils.spelEscape(e)},sqlFormatValue:function(e,t,r,a,o){return o.sqlOp=="LIKE"||o.sqlOp=="NOT LIKE"?this.utils.SqlString.escapeLike(e,a!="starts_with",a!="ends_with"):this.utils.SqlString.escape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},textarea:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"Text",valuePlaceholder:"Enter text",formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){return o.sqlOp=="LIKE"||o.sqlOp=="NOT LIKE"?this.utils.SqlString.escapeLike(e,a!="starts_with",a!="ends_with"):this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e},fullWidth:!0},number:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r){var a=r.step&&!Number.isInteger(r.step);return this.utils.spelEscape(e,a)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},slider:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number or move slider",formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},select:{type:"select",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,t,r,a){var o=this.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,e);return a?this.utils.stringifyForDisplay(o):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},multiselect:{type:"multiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,t,r,a){var o=this,u=e.map(function(i){return o.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,i)});return a?u.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,t,r,a,o){var u=this;return e.map(function(i){return u.utils.SqlString.escape(i)})},spelFormatValue:function(e,t,r,a,o){var u=o&&o.spelOp&&o.spelOp.startsWith("${1}"),i=this.utils.spelEscape(e);return u&&(i=this.utils.spelFixList(i)),i},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},date:{type:"date",jsType:"string",valueSrc:"value",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD",valueLabel:"Date",valuePlaceholder:"Enter date",valueLabels:[{label:"Date from",placeholder:"Enter date from"},{label:"Date to",placeholder:"Enter date to"}],formatValue:function(e,t,r,a){var o=this.utils.moment(e,r.valueFormat);return a?o.format(r.dateFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(u.format("YYYY-MM-DD"))},spelFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat),i=u.format("YYYY-MM-DD"),l="yyyy-MM-dd";return"T(java.time.LocalDate).parse('".concat(i,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat(l,"'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDate"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var a,o,u,i;if(!t)return[void 0,"No widget def to get value format"];if(r!=null&&(a=r.fmt)!==null&&a!==void 0&&(a=a.value)!==null&&a!==void 0&&(o=a.includes)!==null&&o!==void 0&&o.call(a," ")||(u=r.fmt)!==null&&u!==void 0&&(u=u.value)!==null&&u!==void 0&&(i=u.toLowerCase)!==null&&i!==void 0&&i.call(u).includes("hh:mm"))return[void 0,"Invalid date format ".concat(JSON.stringify(r.fmt))];var l=this.utils.moment(e.value,this.utils.moment.ISO_8601);return l.isValid()?[l.format(t?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.isValid()?a.toDate():void 0}},time:{type:"time",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",valueFormat:"HH:mm:ss",use12Hours:!1,valueLabel:"Time",valuePlaceholder:"Enter time",valueLabels:[{label:"Time from",placeholder:"Enter time from"},{label:"Time to",placeholder:"Enter time to"}],formatValue:function(e,t,r,a){var o=this.utils.moment(e,r.valueFormat);return a?o.format(r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(u.format("HH:mm:ss"))},spelFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat),i="HH:mm:ss",l=u.format("HH:mm:ss");return"T(java.time.LocalTime).parse('".concat(l,"')")},spelImportFuncs:["T(java.time.LocalTime).parse(${v})"],spelImportValue:function(e,t,r){var a,o,u;if(!t)return[void 0,"No widget def to get value format"];if(r!=null&&r.fmt&&(!((a=r.fmt)!==null&&a!==void 0&&(a=a.value)!==null&&a!==void 0&&(o=a.toLowerCase)!==null&&o!==void 0&&o.call(a).includes("hh:mm"))||(u=r.fmt)!==null&&u!==void 0&&(u=u.value)!==null&&u!==void 0&&u.includes(" ")))return[void 0,"Invalid time format ".concat(JSON.stringify(r.fmt))];var i=this.utils.moment(e.value,"HH:mm:ss");return i.isValid()?[i.format(t?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.get("hour")*60*60+a.get("minute")*60+a.get("second")},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.get("hour")*60*60+r.get("minute")*60+r.get("second"):void 0},mongoFormatValue:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.get("hour")*60*60+a.get("minute")*60+a.get("second")},elasticSearchFormatValue:function(e,t,r,a){return{script:{script:{source:"doc[".concat(a,"][0].getHour() >== params.min && doc[").concat(a,"][0].getHour() <== params.max"),params:{min:t[0],max:t[1]}}}}}},datetime:{type:"datetime",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD HH:mm:ss",use12Hours:!1,valueLabel:"Datetime",valuePlaceholder:"Enter datetime",valueLabels:[{label:"Datetime from",placeholder:"Enter datetime from"},{label:"Datetime to",placeholder:"Enter datetime to"}],formatValue:function(e,t,r,a){var o=this.utils.moment(e,r.valueFormat);return a?o.format(r.dateFormat+" "+r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(u.toDate())},spelFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat),i=u.format("YYYY-MM-DD HH:mm:ss"),l="yyyy-MM-dd HH:mm:ss";return"T(java.time.LocalDateTime).parse('".concat(i,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat(l,"'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDateTime"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var a,o;if(!t)return[void 0,"No widget def to get value format"];if(!(r!=null&&(a=r.fmt)!==null&&a!==void 0&&(a=a.value)!==null&&a!==void 0&&(o=a.includes)!==null&&o!==void 0&&o.call(a," ")))return[void 0,"Invalid datetime format ".concat(JSON.stringify(r.fmt))];var u=this.utils.moment(e.value,this.utils.moment.ISO_8601);return u.isValid()?[u.format(t?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.isValid()?a.toDate():void 0}},boolean:{type:"boolean",jsType:"boolean",valueSrc:"value",labelYes:"Yes",labelNo:"No",formatValue:function(e,t,r,a){return a?e?"Yes":"No":JSON.stringify(!!e)},sqlFormatValue:function(e,t,r,a,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r,a,o){return this.utils.spelEscape(e)},defaultValue:!1,toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},field:{valueSrc:"field",formatValue:function(e,t,r,a,o,u,i){return a&&i.label||e},sqlFormatValue:function(e,t,r,a,o,u){return e},spelFormatValue:function(e,t,r,a,o){return e},valueLabel:"Field to compare",valuePlaceholder:"Select field to compare"},func:{valueSrc:"func",valueLabel:"Function",valuePlaceholder:"Select function"},case_value:{valueSrc:"value",type:"case_value",spelFormatValue:function(e){return this.utils.spelEscape(e===""?null:e)},spelImportValue:function(e){return[e.value,[]]}}},lm={text:{defaultOperator:"equal",mainWidget:"text",widgets:{text:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","proximity","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},textarea:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},field:{operators:["equal","not_equal","proximity"]}}},number:{defaultOperator:"equal",mainWidget:"number",widgets:{number:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]},slider:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","is_null","is_not_null"]}}},date:{defaultOperator:"equal",widgets:{date:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},time:{defaultOperator:"equal",widgets:{time:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},datetime:{defaultOperator:"equal",widgets:{datetime:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},select:{mainWidget:"select",defaultOperator:"select_equals",widgets:{select:{operators:["select_equals","select_not_equals","is_null","is_not_null"]},multiselect:{operators:["select_any_in","select_not_any_in","is_null","is_not_null"]}}},multiselect:{defaultOperator:"multiselect_equals",widgets:{multiselect:{operators:["multiselect_contains","multiselect_not_contains","multiselect_equals","multiselect_not_equals","is_null","is_not_null"]}}},boolean:{defaultOperator:"equal",widgets:{boolean:{operators:["equal","not_equal","is_null","is_not_null"],widgetProps:{}},field:{operators:["equal","not_equal"]}}},"!group":{defaultOperator:"some",mainWidget:"number",widgets:{number:{widgetProps:{min:0},operators:["some","all","none","equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between"],opProps:{equal:{label:"Count =="},not_equal:{label:"Count !="},less:{label:"Count <"},less_or_equal:{label:"Count <="},greater:{label:"Count >"},greater_or_equal:{label:"Count >="},between:{label:"Count between"},not_between:{label:"Count not between"}}}}},case_value:{mainWidget:"case_value",widgets:{case_value:{}}}},sm=ur(ur({},Ss),{},{convertableWidgets:{number:["slider","rangeslider"],slider:["number","rangeslider"],rangeslider:["number","slider"],text:["textarea"],textarea:["text"]},formatSpelField:function(e,t,r,a,o,u){var i=this,l=a.map(function(s,c){var d=s.key,f=s.parent,p=s.fieldSeparator;return c==0?f=="[map]"?"#this[".concat(i.utils.spelEscape(d),"]"):(f=="[class]",d):f=="map"||f=="[map]"?"[".concat(i.utils.spelEscape(d),"]"):(f=="class"||f=="[class]","".concat(p).concat(d))}).join("");return o.fieldName&&(l=e),o.isSpelVariable&&(l="#"+l),l},sqlFormatReverse:function(e){if(e!=null)return"NOT("+e+")"},spelFormatReverse:function(e){if(e!=null)return"!("+e+")"},formatReverse:function(e,t,r,a,o,u){if(e!=null)return u?"NOT ("+e+")":"!("+e+")"},formatAggr:function(e,t,r,a,o,u,i,l,s,c){var d=i.labelForFormat,f=i.cardinality;if(f==0){var p=e?" HAVE ".concat(e):"";return"".concat(d," OF ").concat(t).concat(p)}else if(f==null||f==1){var v=e?" WHERE ".concat(e):"";return"COUNT OF ".concat(t).concat(v," ").concat(d," ").concat(a)}else if(f==2){var g=e?" WHERE ".concat(e):"",h=a.first(),b=a.get(1);return"COUNT OF ".concat(t).concat(g," ").concat(d," ").concat(h," AND ").concat(b)}},jsonLogic:{groupVarKey:"var",altVarKey:"var",lockedOp:"locked"},canCompareFieldWithField:function(e,t,r,a){return!0},valueSourcesInfo:{value:{label:"Value"},field:{label:"Field",widget:"field"},func:{label:"Function",widget:"func"}}}),sc=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={rangeslider:fm,treeselect:pm,treemultiselect:vm,rangeable__date:dm("date","date")},o=nm(t),u;try{for(o.s();!(u=o.n()).done;){var i=u.value,l=a[i];if(l)e=l(e,r);else throw new Error("Can't ".concat(r?"add":"remove"," mixin ").concat(i))}}catch(s){o.e(s)}finally{o.f()}return e},cc=function(e,t){return sc(e,t,!0)},cm=function(e,t){return sc(e,t,!1)},dm=function(e,t){return function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.types;return o=ur(ur({},o),{},(0,re.A)({},e,ur(ur({},o[e]),{},{widgets:ur({},o[e].widgets)}))),a?o[e].widgets[t]=ur({opProps:{between:{isSpecialRange:!0,textSeparators:[null,null]},not_between:{isSpecialRange:!0,textSeparators:[null,null]}}},o[e].widgets[t]):delete o[e].widgets[t],ur(ur({},r),{},{types:o})}},fm=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=e.widgets,a=e.types;return r=ur({},r),t?r.rangeslider=ur({type:"number",jsType:"number",valueSrc:"value",valueLabel:"Range",valuePlaceholder:"Select range",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(u,i,l,s){return s?this.utils.stringifyForDisplay(u):JSON.stringify(u)},sqlFormatValue:function(u,i,l,s,c){return this.utils.SqlString.escape(u)},spelFormatValue:function(u){return this.utils.spelEscape(u)},singleWidget:"slider",toJS:function(u,i){return u}},r.rangeslider):delete r.rangeslider,a=ur(ur({},a),{},{number:ur(ur({},a.number),{},{widgets:ur({},a.number.widgets)})}),t?a.number.widgets.rangeslider=ur({opProps:{between:{isSpecialRange:!0},not_between:{isSpecialRange:!0}},operators:["between","not_between","is_null","is_not_null"]},a.number.widgets.rangeslider):delete a.number.widgets.rangeslider,ur(ur({},e),{},{widgets:r,types:a})},pm=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=e.widgets,a=e.types;return r=ur({},r),t?r.treeselect=ur({type:"treeselect",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(u,i,l,s){var c=i.fieldSettings.treeValues||i.fieldSettings.listValues||i.asyncListValues,d=this.utils.getTitleInListValues(c,u);return s?this.utils.stringifyForDisplay(d):JSON.stringify(u)},sqlFormatValue:function(u,i,l,s,c){return this.utils.SqlString.escape(u)},spelFormatValue:function(u){return this.utils.spelEscape(u)},toJS:function(u,i){return u}},r.treeselect):delete r.treeselect,a=ur({},a),t?a.treeselect=ur({mainWidget:"treeselect",defaultOperator:"select_equals",widgets:{treeselect:{operators:["select_equals","select_not_equals"]},treemultiselect:{operators:["select_any_in","select_not_any_in"]}}},a.treeselect):delete a.treeselect,ur(ur({},e),{},{widgets:r,types:a})},vm=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=e.widgets,a=e.types;return r=ur({},r),t?r.treemultiselect=ur({type:"treemultiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(u,i,l,s){var c=this,d=i.fieldSettings.treeValues||i.fieldSettings.listValues||i.asyncListValues,f=u.map(function(p){return c.utils.getTitleInListValues(d,p)});return s?f.map(this.utils.stringifyForDisplay):u.map(JSON.stringify)},sqlFormatValue:function(u,i,l,s,c){var d=this;return u.map(function(f){return d.utils.SqlString.escape(f)})},spelFormatValue:function(u){return this.utils.spelEscape(u)},toJS:function(u,i){return u}},r.treemultiselect):delete r.treemultiselect,a=ur({},a),t?a.treemultiselect=ur({defaultOperator:"multiselect_equals",widgets:{treemultiselect:{operators:["multiselect_equals","multiselect_not_equals"]}}},a.treemultiselect):delete a.treemultiselect,ur(ur({},e),{},{widgets:r,types:a})},gm={addMixins:cc,removeMixins:cm},Ti={conjunctions:om,operators:im,widgets:um,types:lm,settings:sm,ctx:tm};Ti=cc(Ti,["rangeslider","treeselect","treemultiselect"]);const Pr=Ti;var dc="ADD_GROUP",Ai="ADD_CASE_GROUP",fc="REMOVE_GROUP",pc="SET_CONJUNCTION",vc="SET_NOT",gc="ADD_RULE",mc="REMOVE_RULE",hc="SET_FIELD",yc="SET_FIELD_SRC",Oc="SET_OPERATOR",bc="SET_VALUE",Sc="SET_VALUE_SRC",Fc="SET_FUNC_VALUE",Ec="SET_OPERATOR_OPTION",Cc="SET_LOCK",Li="SET_TREE",Tc="MOVE_ITEM",Ac="after",Lc="before",wi="append",Ri="prepend",wc="SET_DRAG_PROGRESS",Rc="SET_DRAG_START",Pc="SET_DRAG_END",mm=y(73916),Ya=y.n(mm);function Pi(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=hm(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function hm(n,e){if(n){if(typeof n=="string")return jc(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return jc(n,e)}}function jc(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Ic(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ht(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ic(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ic(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Vc=function(e,t,r,a,o,u){var i,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},c=(o==null||(i=o.get)===null||i===void 0?void 0:i.call(o,"id"))||a,d=u.settings.shouldCreateEmptyGroup,f=t.push(c),p=!d,v=!!(s!=null&&s.isDefaultCase),g=e;return e=wn(e,t,r,c,mn(u).merge((0,ye.fromJS)(o)||{}),u,l),e!==g&&(!l&&!v&&(e=e.setIn(Fe(f,"children1"),new ye.default.OrderedMap),p&&(e=wn(e,f,"rule",sr(),Wt(u),u))),e=Dt(e)),e},ym=function(e,t,r){e=ji(e,t);var a=r.settings.canLeaveEmptyGroup,o=t.slice(0,-1),u=!Go(e,o);if(u&&!a&&(e=Ga(e),_o(e)&&!a)){var i=!1,l=!1;e=wn(e,new ye.default.List,"rule",sr(),Wt(r,void 0,void 0,i,l),r)}return e=Dt(e),e},Om=function(e,t,r){e=ji(e,t);var a=r.settings.canLeaveEmptyGroup,o=t.pop(),u=e.getIn(Fe(o)),i=u.getIn(["properties","field"]),l=u.getIn(["properties","operator"]),s=u.getIn(["properties","value",0]),c=i?Re(r,i):null,d=l?cr(r,l,i):null,f=i&&l&&d.cardinality!=0,p=u.get("type")=="rule_group",v=!Go(e,o),g=p?f&&c.initialEmptyWhere:a;if(v&&!g&&(p&&(e=e.deleteIn(Fe(o))),e=Ga(e),_o(e)&&!a)){var h=!1,b=!1;e=wn(e,new ye.default.List,"rule",sr(),Wt(r,void 0,void 0,h,b),r)}return e=Dt(e),e},bm=function(e,t,r){return e.setIn(Fe(t,"properties","not"),r)},Sm=function(e,t,r){return pu(e.setIn(Fe(t,"properties","isLocked"),r))},Fm=function(e,t,r){return e.setIn(Fe(t,"properties","conjunction"),r)},Em=function n(e,t,r){r&&Array.isArray(r)&&(t.children1=new ye.default.OrderedMap(r.reduce(function(a,o){var u,i=(u=o.id)!==null&&u!==void 0?u:sr(),l=Ht(Ht({},o),{},{properties:tl(e,o).merge((0,ye.fromJS)(o.properties)||{}),id:i});return n(e,l,l.children1),Ht(Ht({},a),{},(0,re.A)({},i,new ye.default.Map(l)))},{})))},wn=function(e,t,r,a,o,u){var i,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,s=(o==null||(i=o.get)===null||i===void 0?void 0:i.call(o,"id"))||a;if(r=="switch_group")throw new Error("Can't add switch_group programmatically");var c=u.settings,d=c.maxNumberOfCases,f=c.maxNumberOfRules,p=c.maxNesting,v=e.get("type"),g=v=="switch_group",h=e.getIn(Fe(t)),b=g?e.getIn(Fe(t.take(2))):null,O=Fe(t,"children1"),S=e.getIn(O),A=!!S&&S.size,L=A?S.size:null,F,P;r=="case_group"?(F=L,P=d):r=="group"?(F=t.size,P=p):h?.get("type")=="rule_group"||(F=Mo(g?b:e),P=f);var N=P&&F?F<P:!0,k={type:r,id:s,properties:o};Em(u,k,l);var I=r=="case_group"&&A&&S.last().get("children1")==null;if(N){var B=new ye.default.OrderedMap((0,re.A)({},s,new ye.default.Map(k)));if(!A)e=e.setIn(O,B);else if(I){var U=S.last(),x=new ye.default.OrderedMap((0,re.A)((0,re.A)({},s,new ye.default.Map(k)),U.get("id"),U));e=e.deleteIn(Fe(O,"children1",U.get("id"))),e=e.mergeIn(O,x)}else e=e.mergeIn(O,B);e=Dt(e)}return e},ji=function(e,t){return e=e.deleteIn(Fe(t)),e=Dt(e),e},Cm=function(e,t,r,a,o){var u=$n(e,t),i=t.pop(),l=t.size>1?$n(e,i):null,s=l?l.get("children1"):null,c=$n(e,r),d=a==wi||a==Ri?r:r.pop(),f=a==wi||a==Ri?c:r.size>1?$n(e,d):null,p=f?f.get("children1"):null;if(!l||!f||!u)return e;var v=l.get("id")==f.get("id"),g=d.size<i.size&&Da(d.toArray(),i.toArray().slice(0,d.size)),h=d.size>i.size&&Da(i.toArray(),d.toArray().slice(0,i.size)),b=null,O=null;g?b=ye.default.List(i.toArray().slice(d.size)):h&&(O=ye.default.List(d.toArray().slice(i.size)));var S=p,A=s;return h||(A=A.delete(u.get("id"))),v?S=A:g&&(S=S.updateIn(xo(b,"children1"),function(L){return A})),a==Lc||a==Ac?S=ye.default.OrderedMap().withMutations(function(L){var F=Pi(S.entries()),P;try{for(F.s();!(P=F.n()).done;){var N=(0,we.A)(P.value,2),k=N[0],I=N[1];k==c.get("id")&&a==Lc&&L.set(u.get("id"),u),L.set(k,I),k==c.get("id")&&a==Ac&&L.set(u.get("id"),u)}}catch(B){F.e(B)}finally{F.f()}}):a==wi?S=S.merge(ye.default.OrderedMap((0,re.A)({},u.get("id"),u))):a==Ri&&(S=ye.default.OrderedMap((0,re.A)({},u.get("id"),u)).merge(S)),h&&(A=A.updateIn(xo(O,"children1"),function(L){return S}),A=A.delete(u.get("id"))),!v&&!g&&(e=e.updateIn(Fe(i,"children1"),function(L){return A})),h||(e=e.updateIn(Fe(d,"children1"),function(L){return S})),e=Dt(e),e},Tm=function(e,t,r,a){var o=a.settings.keepInputOnChangeFieldSrc,u=e.getIn(Fe(t)),i=u.get("type"),l=u.get("properties"),s=l?.get("field"),c=l?.get("fieldType"),d=Re(a,s),f=d?.type||c;(!f||f==="!group"||f==="!struct")&&(f=null);var p=!Ka.includes(f),v=o&&!si(u,a)&&p;return v?(e=e.setIn(Fe(t,"properties","field"),null),e=e.deleteIn(Fe(t,"properties","fieldError")),e=e.setIn(Fe(t,"properties","fieldType"),f)):e=e.setIn(Fe(t,"properties"),Wt(a,null,null,!1)),e=e.setIn(Fe(t,"properties","fieldSrc"),r),e},Am=function(e,t,r,a,o,u,i,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:{},d=e.settings.showErrorMessage,f=a===-1,p=t.getIn(Fe(r,"properties")),v=p.get("field"),g=p.get("value"),h=f?v:g.getIn([a]),b=[],O=h,S=Pi(o||[]),A;try{for(S.s();!(A=S.n()).done;){var L=(0,we.A)(A.value,2),F=L[0],P=L[1];if(b.push([F,P,O]),F!==O.get("func")){var N=b.map(function(ve){var se=(0,we.A)(ve,2),ue=se[0],Ce=se[1];return"".concat(ue,"(").concat(Ce,")")}).join("/")||"root";throw new Error("In ".concat(f?"LHS":"RHS"," for path ").concat(N," expected func key ").concat(F," but got ").concat(parent.get("func")))}O=O.getIn(["args",P,"value"])}}catch(ve){S.e(ve)}finally{S.f()}if(u){var B=O.get("func"),U=Gr(e,B),x=U.args,X=x[u];l==="!valueSrc"?O=ts(O,u,i,X,e):O=ii(O,u,i,X,e)}else{var k=i,I=!0;O=es(O,k,e,I),c.canDropArgs=!0}for(var W=O;b.length;){var J=b.pop(),G=(0,we.A)(J,3),ee=G[0],ie=G[1],de=G[2],fe=Gr(e,ee),ne=fe.args,te=ne[ie];W=ii(de,ie,W,te,e)}return f?Dc(t,r,W,e,s,c):Nc(t,r,a,W,void 0,e,s,c)},Dc=function(e,t,r,a,o){var u,i,l,s,c,d,f=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},p=f.__isInternal,v=f.isEndValue,g=f.canDropArgs,h;if(!r)return{tree:ji(e,t),isInternalValueChange:h};var b=a.settings,O=b.fieldSeparator,S=b.setOpOnChangeField,A=b.showErrorMessage;Array.isArray(r)&&(r=r.join(O));var L=e.getIn(Fe(t,"type")),F=e.getIn(Fe(t,"properties")),P=L=="rule_group",N=F?.get("fieldSrc"),k=F?.get("fieldError"),I=Re(a,r);if(!I)return console.warn("No config for LHS ".concat(r)),{tree:e,isInternalValueChange:h};var B=I.type;(B==="!group"||B==="!struct")&&(B=null);var U=F?.get("operator"),x=F?.get("operatorOptions"),X=F?.get("field"),W=F==null||(u=F.get("valueError"))===null||u===void 0||(i=u.join)===null||i===void 0?void 0:i.call(u,"|"),J=I.type=="!group",G=J&&I.mode=="array",ee=P!=J,ie=I&&((l=I.operators)===null||l===void 0?void 0:l.indexOf(U))!==-1?U:null,de=N==="func"&&(X==null||(s=X.get)===null||s===void 0?void 0:s.call(X,"func"))===((c=r)===null||c===void 0||(d=c.get)===null||d===void 0?void 0:d.call(c,"func")),fe=de&&!!ie,ne=null,te=N==="func"?as(a,B):Ha(a,r);if(te&&te.length==1)ne=te[0];else if(fe)ne=ie;else if(te&&te.length>1){var ve=Pi(S),se;try{for(ve.s();!(se=ve.n()).done;){var ue=se.value;if(ue=="keep"&&!ee?ne=ie:ue=="default"?ne=Yo(a,r,!1):ue=="first"&&(ne=ui(a,r)),ne)break}}catch(or){ve.e(or)}finally{ve.f()}}if(!J&&!I.operators)return console.warn("Type ".concat(I.type," is not supported")),{tree:e,isInternalValueChange:h};P&&!J&&(e=e.setIn(Fe(t,"type"),"rule"),e=e.deleteIn(Fe(t,"children1")),e=e.setIn(Fe(t,"properties"),new ye.default.OrderedMap)),F||(e=e.setIn(Fe(t,"properties"),new ye.default.OrderedMap));var Ce=!A;if(J){e=e.setIn(Fe(t,"type"),"rule_group");var he=Tn(a,a,F,r,ne,"field",Ce,v,g),Pe=he.canReuseValue,Ne=he.newValue,Be=he.newValueSrc,Qe=he.newValueType,Je=he.operatorCardinality,We=mn(a,I).merge({field:r,fieldSrc:"field",mode:I.mode});G&&(We=We.merge({operator:ne,value:Ne,valueSrc:Be,valueType:Qe})),e=e.setIn(Fe(t,"children1"),new ye.default.OrderedMap),e=e.setIn(Fe(t,"properties"),We),I.initialEmptyWhere&&Je==1||(e=wn(e,t,"rule",sr(),Wt(a,r),a)),e=Dt(e)}else e=e.updateIn(Fe(t,"properties"),function(or){return or.withMutations(function(ar){var Ar,tr=Tn(a,a,ar,r,ne,"field",Ce,v,g),st=tr.canReuseValue,Mt=tr.newValue,St=tr.newValueSrc,Ft=tr.newValueType,vt=tr.newValueError,_t=tr.newFieldError,Gt=tr.fixedField,tt=vt==null||(Ar=vt.join)===null||Ar===void 0?void 0:Ar.call(vt,"|"),Hr=r,sn=Gt!==r;sn&&(Hr=Gt);var cn=A?k!=_t:!!k!=!!_t,nt=A?W!=tt:!!W!=!!tt,Nr=cn||nt;h=!!p&&!Nr&&!sn,(A||p&&Nr)&&(ar=ar.set("fieldError",_t),ar=ar.set("valueError",vt));var rr=st?x:ga(a,ne,Hr);return ar=ar.set("field",Hr).delete("fieldType").set("fieldSrc",N).set("operator",ne).set("operatorOptions",rr).set("value",Mt).set("valueSrc",St).set("valueType",Ft),st||(ar=ar.delete("asyncListValues")),ar})});return{tree:e,isInternalValueChange:h}},Lm=function(e,t,r,a){var o=a.settings.showErrorMessage,u=e.getIn(Fe(t,"properties")),i=e.getIn(Fe(t,"children1")),l=u.get("field"),s=u.get("fieldSrc"),c=Re(a,l),d=c?.type=="!group",f=cr(a,r,l),p=f?Mr(f):null,v=!0;return e=e.updateIn(Fe(t,"properties"),function(g){return g.withMutations(function(h){var b=h.get("field"),O=h.get("operatorOptions"),S=h.get("value",new ye.default.List),A=h.get("valueSrc",new ye.default.List),L=h.get("operator"),F=Tn(a,a,h,b,r,"operator",v),P=F.canReuseValue,N=F.newValue,k=F.newValueSrc,I=F.newValueType,B=F.newValueError;o&&(h=h.set("valueError",B));var U=P?O:ga(a,r,b);return P||(h=h.delete("asyncListValues")),h.set("operator",r).set("operatorOptions",U).set("value",N).set("valueSrc",k).set("valueType",I)})}),d&&p==0&&i.size==0&&(e=wn(e,t,"rule",sr(),Wt(a,l),a)),e},Nc=function(e,t,r,a,o,u,i){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},s=l.__isInternal,c=l.canDropArgs,d=l.isEndValue,f=u.settings,p=f.fieldSeparator,v=f.showErrorMessage,g,h=e.getIn(Fe(t,"properties","valueSrc",r+""))||null;h==="field"&&Array.isArray(a)&&(a=a.join(p));var b=e.getIn(Fe(t,"properties","field"))||null,O=e.getIn(Fe(t,"properties","operator"))||null,S=cr(u,O,b),A=O?Mr(S):null,L=o||os(a,h,u),F=!v,P=Hn(u,b,b,O,a,L,h,i,F,d,c),N=(0,we.A)(P,2),k=N[0],I=N[1],B=I?.find(function(he){return!he.fixed&&!he.ignore}),U=B?Nt(B):null,x=k!==a;x&&(a=k),e=xc(e,t,u,A);var X=Array.from({length:A},function(he,Pe){return Pe==r?a:e.getIn(Fe(t,"properties","value",Pe+""))||null}),W=Array.from({length:A},function(he,Pe){return e.getIn(Fe(t,"properties","valueSrc",Pe+""))||null}),J=ai(u,b,O,X,W),G=J?Nt(J):null,ee=!U&&!G,ie=e.getIn(Fe(t,"properties","value",r)),de=e.getIn(Fe(t,"properties","valueError",r)),fe=e.getIn(Fe(t,"properties","valueError",A)),ne=v?de!=U:!!de!=!!U,te=v?fe!=G:!!fe!=!!G,ve=ne||te,se=!!ie!=!!a,ue=v?!0:ee||x;if(g=!!s&&!se&&!ve&&!x,ue&&(e=e.deleteIn(Fe(t,"properties","asyncListValues")),typeof a>"u"?(e=e.setIn(Fe(t,"properties","value",r),void 0),e=e.setIn(Fe(t,"properties","valueType",r),null)):(i&&(e=e.setIn(Fe(t,"properties","asyncListValues"),i)),e=e.setIn(Fe(t,"properties","value",r),a),e=e.setIn(Fe(t,"properties","valueType",r),L))),v||s&&ve){var Ce=e.getIn(Fe(t,"properties","valueError"));Ce||(e=e.setIn(Fe(t,"properties","valueError"),new ye.default.List(new Array(A)))),e=e.setIn(Fe(t,"properties","valueError",r),U),A>=2&&(e=e.setIn(Fe(t,"properties","valueError",A),G))}return{tree:e,isInternalValueChange:g}},wm=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},i=o.settings.showErrorMessage,l=e.getIn(Fe(t,"properties","field"))||null,s=e.getIn(Fe(t,"properties","operator"))||null,c=cr(o,s,l),d=s?Mr(c):null;if(e=xc(e,t,o,d),e=e.setIn(Fe(t,"properties","value",r+""),void 0),e=e.setIn(Fe(t,"properties","valueType",r+""),null),e=e.deleteIn(Fe(t,"properties","asyncListValues")),i&&(e=e.setIn(Fe(t,"properties","valueError",r),null),c.validateValues&&(e=e.setIn(Fe(t,"properties","valueError",d),null))),typeof a>"u"?e=e.setIn(Fe(t,"properties","valueSrc",r+""),null):e=e.setIn(Fe(t,"properties","valueSrc",r+""),a),a){var f=e.getIn(Fe(t,"properties")),p=!0,v=Tn(o,o,f,l,s,"valueSrc",p),g=v.canReuseValue,h=v.newValue,b=v.newValueSrc,O=v.newValueType,S=v.newValueError;!g&&b.get(r)==a&&(e=e.setIn(Fe(t,"properties","value",r+""),h.get(r)),e=e.setIn(Fe(t,"properties","valueType",r+""),O.get(r)))}return e},Rm=function(e,t,r,a){return e.setIn(Fe(t,"properties","operatorOptions",r),a)},Pm=function(e,t){var r=t.settings.canLeaveEmptyGroup;return r||(e=Ga(e)),e},xc=function(e,t,r,a){if(!a){var o=e.getIn(Fe(t,"properties","field"))||null,u=e.getIn(Fe(t,"properties","operator"))||null,i=cr(r,u,o);a=u?Mr(i):null}for(var l=0,s=["value","valueType","valueError","valueSrc"];l<s.length;l++){var c=s[l];e.getIn(Fe(t,"properties",c))||(e=e.setIn(Fe(t,"properties",c),new ye.default.List(a?Array.from({length:a}):[])))}return e},jm=function(e,t){var r=e.getIn(Fe(t,"properties","field"))||null;return r},kc={dragging:{id:null,x:null,y:null,w:null,h:null},mousePos:{},dragStart:{id:null}},Im=function(e,t){if(!e||!e.type)return null;var r=["config","asyncListValues"],a=[Li,Rc,wc,Pc],o=Ya()(Er()(e,r),Po),u=e.path&&jm(t.tree,e.path)||e.field;if(u){var i;(i=u)!==null&&i!==void 0&&i.toJS&&(u=u.toJS()),o.affectedField=u}return(a.includes(e.type)||e.type.indexOf("@@redux")==0)&&(o=null),o};const Vm=function(n,e,t,r,a){var o=e,u=Ht({tree:o},kc);return function(){var i,l,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:u,c=arguments.length>1?arguments[1]:void 0,d=(i=(l=a?.())!==null&&l!==void 0?l:c.config)!==null&&i!==void 0?i:n,f={__isInternalValueChange:void 0,__lastAction:void 0},p={},v=Im(c,s);switch(c?.type){case Li:{var g=t(d,c.tree);p.tree=g;break}case Ai:{p.tree=Vc(s.tree,c.path,"case_group",c.id,c.properties,d,c.children,c.meta);break}case dc:{p.tree=Vc(s.tree,c.path,"group",c.id,c.properties,d,c.children,c.meta);break}case fc:{p.tree=ym(s.tree,c.path,d);break}case gc:{p.tree=wn(s.tree,c.path,c.ruleType,c.id,c.properties,d,c.children);break}case mc:{p.tree=Om(s.tree,c.path,d);break}case pc:{p.tree=Fm(s.tree,c.path,c.conjunction);break}case vc:{p.tree=bm(s.tree,c.path,c.not);break}case hc:{var h=d.settings.optimizeRenderWithInternals,b=Dc(s.tree,c.path,c.field,d,c.asyncListValues,c._meta),O=b.tree,S=b.isInternalValueChange;p.__isInternalValueChange=h&&S,p.tree=O;break}case yc:{p.tree=Tm(s.tree,c.path,c.srcKey,d);break}case Cc:{p.tree=Sm(s.tree,c.path,c.lock);break}case Oc:{p.tree=Lm(s.tree,c.path,c.operator,d);break}case bc:{var A=d.settings.optimizeRenderWithInternals,L=Nc(s.tree,c.path,c.delta,c.value,c.valueType,d,c.asyncListValues,c._meta),F=L.tree,P=L.isInternalValueChange;p.__isInternalValueChange=A&&P,p.tree=F;break}case Fc:{var N=d.settings.optimizeRenderWithInternals,k=Am(d,s.tree,c.path,c.delta,c.parentFuncs,c.argKey,c.value,c.valueType,c.asyncListValues,c._meta),I=k.tree,B=k.isInternalValueChange;p.__isInternalValueChange=N&&B,p.tree=I;break}case Sc:{p.tree=wm(s.tree,c.path,c.delta,c.srcKey,d,c._meta);break}case Ec:{p.tree=Rm(s.tree,c.path,c.name,c.value);break}case Tc:{p.tree=Cm(s.tree,c.fromPath,c.toPath,c.placement,d);break}case Rc:{p.dragStart=c.dragStart,p.dragging=c.dragging,p.mousePos=c.mousePos;break}case wc:{p.mousePos=c.mousePos,p.dragging=c.dragging;break}case Pc:{p.tree=Pm(s.tree,d),p=Ht(Ht({},p),kc);break}default:break}return v&&(p.__lastAction=v),r&&p.tree&&s.tree&&r(s.tree),Ht(Ht(Ht({},s),f),p)}};var Dm=function(e,t){return{type:Li,tree:t,config:e}},Nm=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"rule",o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;return{type:gc,ruleType:a,children:o,path:_r(t),id:sr(),properties:Wt(e,u).merge((0,ye.fromJS)(r)||{}),config:e}},xm=function(e,t){return{type:mc,path:_r(t),config:e}},km=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:Ai,path:_r(t),children:a,id:sr(),properties:mn(e).merge((0,ye.fromJS)(r)||{}),config:e,meta:{isDefaultCase:!0}}},Mm=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:Ai,path:_r(t),children:a,id:sr(),properties:mn(e).merge((0,ye.fromJS)(r)||{}),config:e}},_m=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:dc,path:_r(t),children:a,id:sr(),properties:mn(e).merge((0,ye.fromJS)(r)||{}),config:e}},Gm=function(e,t){return{type:fc,path:_r(t),config:e}},$m=function(e,t,r,a){return{type:Tc,fromPath:_r(t),toPath:_r(r),placement:a,config:e}},Um=function(e,t,r){return{type:pc,path:_r(t),conjunction:r}},Bm=function(e,t,r){return{type:vc,path:_r(t),not:r}},Wm=function(e,t,r){return{type:Cc,path:_r(t),lock:r}},Km=function(e,t,r,a,o){return{type:hc,path:_r(t),field:r,config:e,asyncListValues:a,_meta:o}},Hm=function(e,t,r){return{type:yc,path:_r(t),srcKey:r,config:e}},zm=function(e,t,r){return{type:Oc,path:_r(t),operator:r,config:e}},qm=function(e,t,r,a,o,u,i){return{type:bc,path:_r(t),delta:r,value:a,valueType:o,asyncListValues:u,config:e,_meta:i}},Jm=function(e,t,r,a,o){return{type:Sc,path:_r(t),delta:r,srcKey:a,config:e,_meta:o}},Qm=function(e,t,r,a,o,u,i,l,s){return{type:Fc,path:_r(t),delta:r,parentFuncs:a,argKey:o,value:u,valueType:i,asyncListValues:l,config:e,_meta:s}},Ym=function(e,t,r,a){return{type:Ec,path:_r(t),name:r,value:a,config:e}};function Mc(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ii(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Mc(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Mc(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var qe=Ii(Ii(Ii({},K),{},{Export:q,Import:H,ConfigMixins:gm},q),H),Xm=y(5556),R=y.n(Xm);const Zm=Vm,ya=m.createContext();var eh=y(14644),rh=y(19888),th=y(69242),nh=y(40961);function ah(n){n()}let _c=ah;const oh=n=>_c=n,ih=()=>_c,Gc=Symbol.for("react-redux-context"),$c=typeof globalThis<"u"?globalThis:{};function uh(){var n;if(!m.createContext)return{};const e=(n=$c[Gc])!=null?n:$c[Gc]=new Map;let t=e.get(m.createContext);return t||(t=m.createContext(null),e.set(m.createContext,t)),t}const Uc=uh(),sb=null;function cb(n=ReactReduxContext){return function(){return useContext(n)}}const db=null;let Bc=null;const lh=n=>{Bc=n},sh=(n,e)=>n===e;function fb(n=ReactReduxContext){const e=n===ReactReduxContext?useDefaultReduxContext:createReduxContextHook(n);return function(r,a={}){const{equalityFn:o=sh,stabilityCheck:u=void 0,noopCheck:i=void 0}=typeof a=="function"?{equalityFn:a}:a,{store:l,subscription:s,getServerState:c,stabilityCheck:d,noopCheck:f}=e(),p=useRef(!0),v=useCallback({[r.name](h){return r(h)}}[r.name],[r,d,u]),g=Bc(s.addNestedSub,l.getState,c||l.getState,v,o);return useDebugValue(g),g}}const pb=null;var dr=y(58168),Wc=y(98587),ch=y(4146),Kc=y.n(ch),dh=y(44363);const fh=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function ph(n,e,t,r,{areStatesEqual:a,areOwnPropsEqual:o,areStatePropsEqual:u}){let i=!1,l,s,c,d,f;function p(O,S){return l=O,s=S,c=n(l,s),d=e(r,s),f=t(c,d,s),i=!0,f}function v(){return c=n(l,s),e.dependsOnOwnProps&&(d=e(r,s)),f=t(c,d,s),f}function g(){return n.dependsOnOwnProps&&(c=n(l,s)),e.dependsOnOwnProps&&(d=e(r,s)),f=t(c,d,s),f}function h(){const O=n(l,s),S=!u(O,c);return c=O,S&&(f=t(c,d,s)),f}function b(O,S){const A=!o(S,s),L=!a(O,l,S,s);return l=O,s=S,A&&L?v():A?g():L?h():f}return function(S,A){return i?b(S,A):p(S,A)}}function vh(n,e){let{initMapStateToProps:t,initMapDispatchToProps:r,initMergeProps:a}=e,o=(0,Wc.A)(e,fh);const u=t(n,o),i=r(n,o),l=a(n,o);return ph(u,i,l,n,o)}function gh(n,e){const t={};for(const r in n){const a=n[r];typeof a=="function"&&(t[r]=(...o)=>e(a(...o)))}return t}function Vi(n){return function(t){const r=n(t);function a(){return r}return a.dependsOnOwnProps=!1,a}}function Hc(n){return n.dependsOnOwnProps?!!n.dependsOnOwnProps:n.length!==1}function zc(n,e){return function(r,{displayName:a}){const o=function(i,l){return o.dependsOnOwnProps?o.mapToProps(i,l):o.mapToProps(i,void 0)};return o.dependsOnOwnProps=!0,o.mapToProps=function(i,l){o.mapToProps=n,o.dependsOnOwnProps=Hc(n);let s=o(i,l);return typeof s=="function"&&(o.mapToProps=s,o.dependsOnOwnProps=Hc(s),s=o(i,l)),s},o}}function Di(n,e){return(t,r)=>{throw new Error(`Invalid value of type ${typeof n} for ${e} argument when connecting component ${r.wrappedComponentName}.`)}}function mh(n){return n&&typeof n=="object"?Vi(e=>gh(n,e)):n?typeof n=="function"?zc(n,"mapDispatchToProps"):Di(n,"mapDispatchToProps"):Vi(e=>({dispatch:e}))}function hh(n){return n?typeof n=="function"?zc(n,"mapStateToProps"):Di(n,"mapStateToProps"):Vi(()=>({}))}function yh(n,e,t){return(0,dr.A)({},t,n,e)}function Oh(n){return function(t,{displayName:r,areMergedPropsEqual:a}){let o=!1,u;return function(l,s,c){const d=n(l,s,c);return o?a(d,u)||(u=d):(o=!0,u=d),u}}}function bh(n){return n?typeof n=="function"?Oh(n):Di(n,"mergeProps"):()=>yh}function Sh(){const n=ih();let e=null,t=null;return{clear(){e=null,t=null},notify(){n(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){let r=[],a=e;for(;a;)r.push(a),a=a.next;return r},subscribe(r){let a=!0,o=t={callback:r,next:null,prev:t};return o.prev?o.prev.next=o:e=o,function(){!a||e===null||(a=!1,o.next?o.next.prev=o.prev:t=o.prev,o.prev?o.prev.next=o.next:e=o.next)}}}}const qc={notify(){},get:()=>[]};function Jc(n,e){let t,r=qc,a=0,o=!1;function u(g){c();const h=r.subscribe(g);let b=!1;return()=>{b||(b=!0,h(),d())}}function i(){r.notify()}function l(){v.onStateChange&&v.onStateChange()}function s(){return o}function c(){a++,t||(t=e?e.addNestedSub(l):n.subscribe(l),r=Sh())}function d(){a--,t&&a===0&&(t(),t=void 0,r.clear(),r=qc)}function f(){o||(o=!0,c())}function p(){o&&(o=!1,d())}const v={addNestedSub:u,notifyNestedSubs:i,handleChangeWrapper:l,isSubscribed:s,trySubscribe:f,tryUnsubscribe:p,getListeners:()=>r};return v}const Xa=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?m.useLayoutEffect:m.useEffect;function Qc(n,e){return n===e?n!==0||e!==0||1/n===1/e:n!==n&&e!==e}function Ni(n,e){if(Qc(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;const t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(!Object.prototype.hasOwnProperty.call(e,t[a])||!Qc(n[t[a]],e[t[a]]))return!1;return!0}const Fh=()=>{throw new Error("uSES not initialized!")},Eh=["reactReduxForwardedRef"];let Yc=Fh;const Ch=n=>{Yc=n},Th=null,Ah=[null,null],gb=n=>{try{return JSON.stringify(n)}catch{return String(n)}};function Lh(n,e,t){Xa(()=>n(...e),t)}function wh(n,e,t,r,a,o){n.current=r,t.current=!1,a.current&&(a.current=null,o())}function Rh(n,e,t,r,a,o,u,i,l,s,c){if(!n)return()=>{};let d=!1,f=null;const p=()=>{if(d||!i.current)return;const g=e.getState();let h,b;try{h=r(g,a.current)}catch(O){b=O,f=O}b||(f=null),h===o.current?u.current||s():(o.current=h,l.current=h,u.current=!0,c())};return t.onStateChange=p,t.trySubscribe(),p(),()=>{if(d=!0,t.tryUnsubscribe(),t.onStateChange=null,f)throw f}}const mb=()=>Th;function Ph(n,e){return n===e}let hb=!1;function jh(n,e,t,{pure:r,areStatesEqual:a=Ph,areOwnPropsEqual:o=Ni,areStatePropsEqual:u=Ni,areMergedPropsEqual:i=Ni,forwardRef:l=!1,context:s=Uc}={}){const c=s,d=hh(n),f=mh(e),p=bh(t),v=!!n;return h=>{const b=h.displayName||h.name||"Component",O=`Connect(${b})`,S={shouldHandleStateChanges:v,displayName:O,wrappedComponentName:b,WrappedComponent:h,initMapStateToProps:d,initMapDispatchToProps:f,initMergeProps:p,areStatesEqual:a,areStatePropsEqual:u,areOwnPropsEqual:o,areMergedPropsEqual:i};function A(P){const[N,k,I]=m.useMemo(()=>{const{reactReduxForwardedRef:Je}=P,We=(0,Wc.A)(P,Eh);return[P.context,Je,We]},[P]),B=m.useMemo(()=>N&&N.Consumer&&(0,dh.isContextConsumer)(m.createElement(N.Consumer,null))?N:c,[N,c]),U=m.useContext(B),x=!!P.store&&!!P.store.getState&&!!P.store.dispatch,X=!!U&&!!U.store,W=x?P.store:U.store,J=X?U.getServerState:W.getState,G=m.useMemo(()=>vh(W.dispatch,S),[W]),[ee,ie]=m.useMemo(()=>{if(!v)return Ah;const Je=Jc(W,x?void 0:U.subscription),We=Je.notifyNestedSubs.bind(Je);return[Je,We]},[W,x,U]),de=m.useMemo(()=>x?U:(0,dr.A)({},U,{subscription:ee}),[x,U,ee]),fe=m.useRef(),ne=m.useRef(I),te=m.useRef(),ve=m.useRef(!1),se=m.useRef(!1),ue=m.useRef(!1),Ce=m.useRef();Xa(()=>(ue.current=!0,()=>{ue.current=!1}),[]);const he=m.useMemo(()=>()=>te.current&&I===ne.current?te.current:G(W.getState(),I),[W,I]),Pe=m.useMemo(()=>We=>ee?Rh(v,W,ee,G,ne,fe,ve,ue,te,ie,We):()=>{},[ee]);Lh(wh,[ne,fe,ve,I,te,ie]);let Ne;try{Ne=Yc(Pe,he,J?()=>G(J(),I):he)}catch(Je){throw Ce.current&&(Je.message+=`
The error may be correlated with this previous error:
${Ce.current.stack}

`),Je}Xa(()=>{Ce.current=void 0,te.current=void 0,fe.current=Ne});const Be=m.useMemo(()=>m.createElement(h,(0,dr.A)({},Ne,{ref:k})),[k,h,Ne]);return m.useMemo(()=>v?m.createElement(B.Provider,{value:de},Be):Be,[B,Be,de])}const F=m.memo(A);if(F.WrappedComponent=h,F.displayName=A.displayName=O,l){const N=m.forwardRef(function(I,B){return m.createElement(F,(0,dr.A)({},I,{reactReduxForwardedRef:B}))});return N.displayName=O,N.WrappedComponent=h,Kc()(N,h)}return Kc()(F,h)}}const Za=jh;function Ih({store:n,context:e,children:t,serverState:r,stabilityCheck:a="once",noopCheck:o="once"}){const u=m.useMemo(()=>{const s=Jc(n);return{store:n,subscription:s,getServerState:r?()=>r:void 0,stabilityCheck:a,noopCheck:o}},[n,r,a,o]),i=m.useMemo(()=>n.getState(),[n]);Xa(()=>{const{subscription:s}=u;return s.onStateChange=s.notifyNestedSubs,s.trySubscribe(),i!==n.getState()&&s.notifyNestedSubs(),()=>{s.tryUnsubscribe(),s.onStateChange=void 0}},[u,i]);const l=e||Uc;return m.createElement(l.Provider,{value:u},t)}const Vh=Ih;function yb(n=ReactReduxContext){const e=n===ReactReduxContext?useDefaultReduxContext:createReduxContextHook(n);return function(){const{store:r}=e();return r}}const Ob=null;function bb(n=ReactReduxContext){const e=n===ReactReduxContext?useDefaultStore:createStoreHook(n);return function(){return e().dispatch}}const Sb=null;lh(th.useSyncExternalStoreWithSelector),Ch(rh.useSyncExternalStore),oh(nh.unstable_batchedUpdates);var Fb="ADD_GROUP",Eb="ADD_CASE_GROUP",Cb="REMOVE_GROUP",Tb="SET_CONJUNCTION",Ab="SET_NOT",Lb="ADD_RULE",wb="REMOVE_RULE",Rb="SET_FIELD",Pb="SET_FIELD_SRC",jb="SET_OPERATOR",Ib="SET_VALUE",Vb="SET_VALUE_SRC",Db="SET_OPERATOR_OPTION",Nb="SET_LOCK",xb="SET_TREE",kb="MOVE_ITEM",eo="after",ro="before",Rn="append",Xn="prepend",Dh="SET_DRAG_PROGRESS",Nh="SET_DRAG_START",xh="SET_DRAG_END",kh=function(e,t){return{type:Dh,mousePos:e,dragging:t}},Mh=function(e,t,r){return{type:Nh,dragStart:e,dragging:t,mousePos:r}},_h=function(){return{type:xh}},Xc=le,Gh=z,$h=be;function xi(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Uh(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Uh(n,e){if(n){if(typeof n=="string")return Zc(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Zc(n,e)}}function Zc(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var ed=qe.ConfigUtils,Bh=ed.extendConfig,Zn=ed.configKeys,Wh=function(e){return Ut()(e,Zn)},Kh=function(){var e=new Map,t=2,r=0,a=function(s){var c=Bh(s,++r);return e.size+1>t&&e.delete(e.keys().next().value),e.set(s,c),c},o=function(s){var c=xi(e.keys()),d;try{var f=function(){var g=d.value,h=e.get(g),b=Zn.map(function(O){return h[O]===s[O]}).filter(function(O){return!O}).length===0;if(b)return{v:g}},p;for(c.s();!(d=c.n()).done;)if(p=f(),p)return p.v}catch(v){c.e(v)}finally{c.f()}return s},u=function(s){var c=xi(e.keys()),d;try{var f=function(){var S=d.value,A=Zn.filter(function(F){return S[F]===s[F]}),L=A.length===Zn.length;if(L)return{v:e.get(S)}},p;for(c.s();!(d=c.n()).done;)if(p=f(),p)return p.v}catch(O){c.e(O)}finally{c.f()}var v=xi(e.values()),g;try{var h=function(){var S=g.value,A=Zn.filter(function(F){return S[F]===s[F]}),L=A.length===Zn.length;if(L)return{v:S}},b;for(v.s();!(g=v.n()).done;)if(b=h(),b)return b.v}catch(O){v.e(O)}finally{v.f()}return null},i=function(s){return u(s)||a(s)};return{getExtended:function(s){return i(Wh(s))},getBasic:o}},Hh=function(e){var t;return(t=e?.cardinality)!==null&&t!==void 0?t:1},to=function(e,t,r){if(!t||!e||e.length<=t)return e;var a=e.substr(0,t-1);return(r?a.substr(0,a.lastIndexOf(" ")):a)+"..."},Pn=function(e,t){return e===t?!0:e?.equals(t)},jn=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e===t?!0:Array.isArray(e)?zh(e,t,r):e&&typeof e.equals=="function"?e.equals(t):(0,Fr.A)(e)==="object"?qh(e,t,r):e===t};function zh(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=n.length;if(e.length!==r)return!1;for(var a=0;a<r;a++){var o=t?jn(n[a],e[a],t):n[a]===e[a];if(!o)return!1}return!0}function qh(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=Object.keys(n),a=Object.keys(e),o=r.length;if(a.length!==o)return!1;for(var u=0;u<o;u++){var i=r[u],l=t?jn(n[i],e[i],t):n[i]===e[i];if(!l)return!1}return!0}var Jh=function(){return typeof process<"u"&&process.env&&!1},Qh=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=e??Jh();return t?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},Yh=Qh(),rd=qe.Validation.validateAndFixTree,Xh=function(){var e,t,r;return function(a,o){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return o?(a.__configId===r&&(Pn(o,e)||Pn(o,t))||(r=a.__configId,e=o,i===!1?t=rd(o,null,a,u||a,!1,!1,!1):t=rd(o,null,a,u||a)),t):null}},Zh=function(e){if(e._reactRootContainer)return"root";if(Object.getOwnPropertyNames(e).filter(function(t){return t.startsWith("__reactContainer")}).length>0)return"container"},ey=function n(e){if(e){var t=Zh(e);return t!==void 0?t:n(e.parentNode)}},td=function(e){return ey(e)==="root"},ki=function(e,t){return function(r,a){var o=e.props,u=e.state,i=r!=o||a!=u;if(i&&u==a&&o!=r){var l=[];for(var s in r){var c=r[s]!=o[s];c&&(t[s]=="ignore"?c=!1:t[s]=="shallow_deep"?c=!jn(r[s],o[s],!0):t[s]=="shallow"?c=!jn(r[s],o[s]):typeof t[s]=="function"&&(c=t[s](r[s],o[s],a))),c&&l.push(s)}l.length||(i=!1)}return i}},ea=function(e){return function(t,r){return!jn(e.props,t)||!jn(e.state,r)}},ry=function(){var e=m.version.split(".").map(parseInt.bind(null,10));return e[0]==16&&e[1]<3||e[0]<16},Xr=function(e){if(e.shouldComponentUpdate||(e.shouldComponentUpdate=ea(e)),ry())e.componentWillReceiveProps=function(a){e.onPropsChanged(a)};else{var t=e.shouldComponentUpdate,r=function(o,u){var i=!jn(e.props,o);i&&e.onPropsChanged(o);var l=t.call(e,o,u);return l};e.shouldComponentUpdate=r.bind(e)}},nd=function(e,t,r){return Ya()(e,function(a){return function(){for(var o=arguments.length,u=new Array(o),i=0;i<o;i++)u[i]=arguments[i];return r(a.apply(void 0,[t].concat(u)))}})};function ad(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Mi(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ad(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ad(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function ty(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,od()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function od(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(od=function(){return!!n})()}var id=function(n){function e(t){var r;(0,ze.A)(this,e),r=ty(this,e,[t]),r.shouldComponentUpdate=ki(r,{tree:function(u){return!(u===r.oldValidatedTree&&r.oldValidatedTree===r.validatedTree)}}),Xr(r),r._updateActions(t),r.validatedTree=t.getMemoizedTree(t.config,t.tree,void 0,t.sanitizeTree),r.oldValidatedTree=r.validatedTree;var a=t.getBasicConfig(t.config);return t.onInit&&t.onInit(r.validatedTree,a,void 0,r.actions),r}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"_updateActions",value:function(r){var a=r.config,o=r.dispatch;this.actions=nd(Mi(Mi(Mi({},Xc),Gh),$h),a,o)}},{key:"onPropsChanged",value:function(r){var a=r.onChange,o=this.props.config,u=r.tree,i=this.props.tree,l=r.config;this.oldValidatedTree=this.validatedTree,this.validatedTree=u,o!==l&&(this._updateActions(r),this.validatedTree=r.getMemoizedTree(l,u,o));var s=!Pn(this.validatedTree,this.oldValidatedTree);if(s){var c=r.getBasicConfig(l);a&&a(this.validatedTree,c,r.__lastAction,this.actions)}}},{key:"render",value:function(){var r=this.props,a=r.config,o=r.renderBuilder,u=r.dispatch,i=r.__isInternalValueChange,l={tree:this.validatedTree,actions:this.actions,config:a,dispatch:u,__isInternalValueChange:i};return o(l)}}])}(m.Component);id.propTypes={config:R().object.isRequired,onChange:R().func,onInit:R().func,renderBuilder:R().func,tree:R().any};var ud=Za(function(n){return{tree:n.tree,__isInternalValueChange:n.__isInternalValueChange,__lastAction:n.__lastAction}},null,null,{context:ya})(id);ud.displayName="ConnectedQuery";const ny=ud;function ay(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,ld()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function ld(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ld=function(){return!!n})()}var sd=qe.DefaultUtils.defaultRoot,cd=function(n){function e(t,r){var a;(0,ze.A)(this,e),a=ay(this,e,[t,r]),a.setLastTree=function(b){a.prevTree&&(a.prevprevTree=a.prevTree),a.prevTree=b},a.getConfig=function(){return a.config},a.shouldComponentUpdate=ki(a,{value:function(O,S,A){return!1}}),Xr(a);var o=Kh(),u=o.getExtended,i=o.getBasic;a.getMemoizedConfig=u,a.getBasicConfig=i,a.getMemoizedTree=Xh();var l=a.getMemoizedConfig(t),s=l.settings.shouldCreateEmptyGroup,c=!s,d=sd(l,c),f=!!t.value,p=t.value||d,v=a.getMemoizedTree(l,p,void 0,f),g=Zm(l,v,a.getMemoizedTree,a.setLastTree,a.getConfig),h=(0,eh.createStore)(g);return a.config=l,a.state={store:h},a.QueryWrapper=function(b){return l.settings.renderProvider(b,l.ctx)},a}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=this.config,u=this.getMemoizedConfig(r),i=o!==u,l=this.state.store.getState().tree,s=!Pn(r.value,this.props.value)&&!Pn(r.value,l),c=s?r.value||sd(r):l,d=s&&!Pn(r.value,this.prevTree)&&!Pn(r.value,this.prevprevTree);if(this.sanitizeTree=d||i,i&&(a.settings.renderProvider!==r.settings.renderProvider&&(this.QueryWrapper=function(p){return u.settings.renderProvider(p,u.ctx)}),this.config=u),s||i){var f=this.getMemoizedTree(u,c,o,this.sanitizeTree);this.state.store.dispatch(Xc.setTree(u,f))}}},{key:"render",value:function(){var r=this.props,a=r.renderBuilder,o=r.get_children,u=r.onChange,i=r.onInit,l=this.state.store,s=this.config,c=this.QueryWrapper;return m.createElement(c,{config:s},m.createElement(Vh,{store:l,context:ya},m.createElement(ny,{config:s,getMemoizedTree:this.getMemoizedTree,getBasicConfig:this.getBasicConfig,sanitizeTree:this.sanitizeTree,onChange:u,onInit:i,renderBuilder:a||o})))}}])}(m.Component);cd.propTypes={conjunctions:R().object.isRequired,fields:R().object.isRequired,types:R().object.isRequired,operators:R().object.isRequired,widgets:R().object.isRequired,settings:R().object.isRequired,ctx:R().object.isRequired,onChange:R().func,onInit:R().func,renderBuilder:R().func,value:R().any};var oy=y(46942),Pt=y.n(oy);function iy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,dd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function dd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dd=function(){return!!n})()}var uy=qe.ConfigUtils.getFieldConfig,ly=function(e){var t;return t=function(r){function a(o){var u;return(0,ze.A)(this,a),u=iy(this,a,[o]),u.dummyFn=function(){},u.removeSelf=function(){u.props.actions.removeRule(u.props.path)},u.setLock=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;u.props.actions.setLock(u.props.path,i)},u.setField=function(i,l,s){u.props.actions.setField(u.props.path,i,l,s)},u.setFieldSrc=function(i){u.props.actions.setFieldSrc(u.props.path,i)},u.setOperator=function(i){u.props.actions.setOperator(u.props.path,i)},u.setOperatorOption=function(i,l){u.props.actions.setOperatorOption(u.props.path,i,l)},u.setValue=function(i,l,s,c,d){u.props.actions.setValue(u.props.path,i,l,s,c,d)},u.setValueSrc=function(i,l,s){u.props.actions.setValueSrc(u.props.path,i,l,s)},u.setFuncValue=function(i,l,s,c,d,f,p){u.props.actions.setFuncValue(u.props.path,i,l,s,c,d,f,p)},u.pureShouldComponentUpdate=ea(u),u.dummyFn.isDummyFn=!0,u}return(0,hr.A)(a,r),(0,mr.A)(a,[{key:"shouldComponentUpdate",value:function(u,i){var l=this.props,s=this.state,c=this.pureShouldComponentUpdate(u,i);if(c&&s==i&&l!=u){var d=u.dragging.id||l.dragging.id,f=d==u.id,p=[];for(var v in u){var g=u[v]!=l[v];v=="dragging"&&!f&&(g=!1),g&&p.push(v)}p.length||(c=!1)}return c}},{key:"render",value:function(){var u=this.props.dragging.id==this.props.id,i=uy(this.props.config,this.props.field),l=this.props.fieldType||i?.type||null,s=this.props.config.settings.showErrorMessage,c=i&&i.type=="!struct",d=!u&&this.props.isDraggingTempo,f=this.props,p=f.valueError,v=f.fieldError,g=[v].concat((0,Se.A)(p?.toArray()||[])).filter(function(b){return!!b}).shift()||null,h=g!=null&&s;return m.createElement("div",{className:Pt()("group-or-rule-container","rule-container",h?"rule-with-error":null),"data-id":this.props.id},[u?m.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,setField:this.dummyFn,setFieldSrc:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setOperatorOption:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:l,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,m.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:u,isDraggingTempo:d,onDragStart:this.props.onDragStart,setLock:d?this.dummyFn:this.setLock,removeSelf:d?this.dummyFn:this.removeSelf,setField:d?this.dummyFn:this.setField,setFieldSrc:d?this.dummyFn:this.setFieldSrc,setFuncValue:d?this.dummyFn:this.setFuncValue,setOperator:d?this.dummyFn:this.setOperator,setOperatorOption:d?this.dummyFn:this.setOperatorOption,setValue:d?this.dummyFn:this.setValue,setValueSrc:d?this.dummyFn:this.setValueSrc,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:l,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(m.Component),t.propTypes={id:R().string.isRequired,groupId:R().string,config:R().object.isRequired,path:R().any.isRequired,operator:R().string,field:R().any,fieldSrc:R().string,fieldType:R().string,actions:R().object.isRequired,onDragStart:R().func,value:R().any,valueSrc:R().any,asyncListValues:R().array,valueError:R().any,fieldError:R().string,operatorOptions:R().object,reordableNodesCnt:R().number,parentField:R().string,isLocked:R().bool,isTrueLocked:R().bool,dragging:R().object,isDraggingTempo:R().bool},t};const sy=function(n){var e=Za(function(t){return{dragging:t.dragging}},null,null,{context:ya})(ly(n));return e.displayName="ConnectedRuleContainer",e};function cy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,fd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function fd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fd=function(){return!!n})()}var pd=qe.clone,dy=qe.TreeUtils.getFlatTree,_i=!1,fy=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return t=function(a){function o(u){var i;return(0,ze.A)(this,o),i=cy(this,o,[u]),i._getEventTarget=function(l,s){return l&&l.__mocked_window||document.body||window},i.onDragStart=function(l,s,c){var d=s.closest(".query-builder");i._isUsingLegacyReactDomRender===void 0&&(i._isUsingLegacyReactDomRender=td(d)),document.body.classList.add("qb-dragging"),d.classList.add("qb-dragging");var f=d.closest(".query-builder-container")||d;f=i._getScrollParent(f)||document.body;var p=f.scrollTop,v=i._getDraggableNodeEl(d),g=i._getPlaceholderNodeEl(d),h=d.querySelectorAll(".group--children"),b=h.length?h[0]:null,O;b&&(O=window.getComputedStyle(b,null).getPropertyValue("padding-left"),O=parseInt(O));var S={id:l,x:s.offsetLeft,y:s.offsetTop,w:s.offsetWidth,h:s.offsetHeight,itemInfo:i.tree.items[l],paddingLeft:O},A={id:l,x:s.offsetLeft,y:s.offsetTop,scrollTop:p,clientX:c.clientX,clientY:c.clientY,itemInfo:pd(i.tree.items[l]),treeEl:d,treeElContainer:f},L={clientX:c.clientX,clientY:c.clientY},F=i._getEventTarget(c,A);i.eventTarget=F,F.addEventListener("mousemove",i.onDrag),F.addEventListener("mouseup",i.onDragEnd),i.props.setDragStart(A,S,L)},i.onDrag=function(l){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,c=Object.assign({},i.props.dragging),d=i.props.dragStart,f=c.paddingLeft,p=d.treeElContainer,v=p.scrollTop;if(c.itemInfo=i.tree.items[c.id],!!c.itemInfo){var g={clientX:l.clientX,clientY:l.clientY},h={clientX:d.clientX,clientY:d.clientY};if(l.__mock_dom){var b=d.treeEl,O=i._getDraggableNodeEl(b),S=i._getPlaceholderNodeEl(b);l.__mock_dom({treeEl:b,dragEl:O,plhEl:S})}if(!d.plX){var A=d.treeEl,L=i._getPlaceholderNodeEl(A);L&&(d.plX=L.getBoundingClientRect().left+window.scrollX,d.plY=L.getBoundingClientRect().top+window.scrollY)}var F=d.x,P=d.y,N=d.clientX,k=d.clientY,I=d.scrollTop,B={x:F+(l.clientX-N),y:P+(l.clientY-k)+(v-I)};c.x=B.x,c.y=B.y,c.paddingLeft=f,c.mousePos=g,c.startMousePos=h,i.props.setDragProgress(g,c);var U=s?i.handleDrag(c,l,r):!1;U||l.preventDefault&&l.preventDefault()}},i.onDragEnd=function(){var l=i.props.dragStart.treeEl;i.props.setDragEnd(),l.classList.remove("qb-dragging"),document.body.classList.remove("qb-dragging"),i._cacheEls={};var s=i.eventTarget||i._getEventTarget();s.removeEventListener("mousemove",i.onDrag),s.removeEventListener("mouseup",i.onDragEnd)},i.pureShouldComponentUpdate=ea(i),Xr(i),i.onPropsChanged(u),i}return(0,hr.A)(o,a),(0,mr.A)(o,[{key:"onPropsChanged",value:function(i){this.tree=dy(i.tree)}},{key:"shouldComponentUpdate",value:function(i,l){var s=this.props,c=this.state,d=this.pureShouldComponentUpdate(i,l);if(d&&c==l&&s!=i){var f=[];for(var p in i){var v=i[p]!=s[p];v&&p!="dragging"&&p!="mousePos"&&f.push(p)}f.length||(d=!1)}return d}},{key:"componentDidUpdate",value:function(i,l){var s=this.props.dragging,c=this.props.dragStart;if(_i=!1,c&&c.id&&(s.itemInfo=this.tree.items[s.id],s.itemInfo&&(s.itemInfo.index!=c.itemInfo.index||s.itemInfo.parent!=c.itemInfo.parent))){var d=c.treeEl,f=c.treeElContainer,p=this._getPlaceholderNodeEl(d,!0);if(p){var v=p.getBoundingClientRect().left+window.scrollX,g=p.getBoundingClientRect().top+window.scrollY,h=c.plX,b=c.plY,O=f.scrollTop;c.plX=v,c.plY=g,c.itemInfo=pd(s.itemInfo),c.y=p.offsetTop,c.x=p.offsetLeft,c.clientY+=g-b,c.clientX+=v-h,f!=document.body&&(c.scrollTop=O),this.onDrag(this.props.mousePos,!1)}}}},{key:"_getNodeElById",value:function(i,l){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(l==null)return null;this._cacheEls||(this._cacheEls={});var c=this._cacheEls[l];return c&&document.contains(c)&&!s||(c=i.querySelector('.group-or-rule-container[data-id="'+l+'"]'),this._cacheEls[l]=c),c}},{key:"_getDraggableNodeEl",value:function(i){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this._cacheEls||(this._cacheEls={});var s=this._cacheEls.draggable;if(s&&document.contains(s)&&!l)return s;var c=i.getElementsByClassName("qb-draggable");return s=c.length?c[0]:null,this._cacheEls.draggable=s,s}},{key:"_getPlaceholderNodeEl",value:function(i){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this._cacheEls||(this._cacheEls={});var s=this._cacheEls.placeholder;if(s&&document.contains(s)&&!l)return s;var c=i.getElementsByClassName("qb-placeholder");return s=c.length?c[0]:null,this._cacheEls.placeholder=s,s}},{key:"_isScrollable",value:function(i){var l=window.getComputedStyle(i)["overflow-y"];return(l==="scroll"||l==="auto")&&i.scrollHeight>i.offsetHeight}},{key:"_getScrollParent",value:function(i){return i==null?null:i===document.body||this._isScrollable(i)?i:this._getScrollParent(i.parentNode)}},{key:"handleDrag",value:function(i,l,s){var c=this,d=!0,f=i.itemInfo,p=i.paddingLeft,v=null,g=this.props.dragStart.treeEl,h=i.id,b=this._getDraggableNodeEl(g),O=this._getPlaceholderNodeEl(g),S,A,L,F;if(b&&O){if(S=b.getBoundingClientRect(),A=O.getBoundingClientRect(),!A.width)return;var P={hrz:0,vrt:0};S.top<A.top?P.vrt=-1:S.bottom>A.bottom&&(P.vrt=1),S.left>A.left?P.hrz=1:S.left<A.left&&(P.hrz=-1),F=g.getBoundingClientRect();var N={x:F.left+(F.right-F.left)/2,y:P.vrt>=0?S.bottom:S.top},k;if(l.__mocked_hov_container)k=l.__mocked_hov_container;else{var I=document.elementFromPoint(N.x,N.y-1);if(k=I?I.closest(".group-or-rule-container"):null,!k&&I&&I.classList.contains("query-builder-container")){var B,U=I==null||(B=I.firstChild)===null||B===void 0?void 0:B.firstChild;U&&U.classList.contains("group-or-rule-container")&&(k=U)}}if(!k)Yh.log("out of tree bounds!");else{var x=k.classList.contains("group-container"),X=k.getAttribute("data-id"),W=k,J=!1,G=!1;if(W){L=W.getBoundingClientRect();var ee=L.bottom-L.top,ie=this.tree.items[X];if(!ie)throw new Error("There is an issue with rendering. If you use Next.js, please check getServerSideProps() method.");var de=null,fe=null,ne=null,te=null;if(P.vrt==0)ne=f,fe=O,fe&&(de=fe.getBoundingClientRect());else if(x){if(P.vrt>0){var ve=k.getElementsByClassName("group--header"),se=ve.length?ve[0]:null;if(se){var ue=se.getBoundingClientRect(),Ce=ue.bottom-ue.top,he=S.bottom-ue.top>Ce*3/4;he&&ie.top>i.itemInfo.top&&(ne=ie,de=ue,fe=se,G=!0)}}else if(P.vrt<0&&ie.lev>=f.lev){var Pe=L.bottom-S.top>=2;Pe&&ie.top<i.itemInfo.top&&(ne=ie,de=L,fe=W,J=!0)}if(!G&&!J||d){var Ne=P.vrt<0?L.bottom-S.top>ee-5:S.bottom-L.top>ee-5;Ne&&(!G&&!J&&(ne=ie,de=L,fe=W),d&&(te=ie))}}else{var Be=P.vrt<0?L.bottom-S.top>ee/2:S.bottom-L.top>ee/2;Be&&(ne=ie,de=L,fe=W)}var Qe=ne&&ne.id==h;if(de){var Je=S.left-F.left,We=de.left-F.left,or=We/p,ar=Math.max(0,Math.round(Je/p)),Ar=[],tr=[];if(!Qe){if(x&&(J?Ar.push([Rn,ne,ne.lev+1]):G&&Ar.push([Xn,ne,ne.lev+1]),d&&te)){var st=te.lev==0,Mt=te.type=="case_group"&&f.type!="case_group",St=te.prev&&this.tree.items[te.prev].caseId,Ft=te.next&&this.tree.items[te.next].caseId;f.caseId==St&&(St=null),f.caseId==Ft&&(Ft=null);var vt=St&&this.tree.items[St],_t=Ft&&this.tree.items[Ft];P.vrt>0?st?tr.push([Rn,te,te.lev+1]):Mt&&_t?tr.push([Xn,_t,_t.lev+1]):tr.push([eo,te,te.lev]):P.vrt<0&&(st?tr.push([Xn,te,te.lev+1]):Mt&&vt?tr.push([Rn,vt,vt.lev+1]):tr.push([ro,te,te.lev]))}!J&&!G&&(P.vrt<0?Ar.push([ro,ne,ne.lev]):P.vrt>0&&Ar.push([eo,ne,ne.lev]))}var Gt=function(Zr){var zr=Zr[1],qt=f.caseId?c.tree.items[f.caseId]:null,Et=zr.caseId?c.tree.items[zr.caseId]:null;return[].concat((0,Se.A)(Zr),[qt,Et])};Ar=Ar.map(Gt),tr=tr.map(Gt),Ar=Ar.filter(function(rr){var Zr=rr[0],zr=rr[1];if((Zr==ro||Zr==eo)&&zr.parent==null||zr.collapsed&&(Zr==Rn||Zr==Xn))return!1;var qt=zr.id==f.id;if(!qt){for(var Et=zr;Et.parent;)if(Et=c.tree.items[Et.parent],Et.id==f.id){qt=!0;break}}return!qt}).map(function(rr){var Zr=rr[0],zr=rr[1],qt=rr[2],Et=rr[3],Vn=rr[4],jt=null;return Zr==Rn||Zr==Xn?jt=zr:jt=c.tree.items[zr.parent],jt&&jt.parent==null&&(jt=null),rr[5]=jt,rr});var tt=null,Hr=Ar.filter(function(rr){return c.canMove(f,rr[1],rr[0],rr[3],rr[4],rr[5],s)});d&&Hr.length==0&&tr.length>0&&(Hr=tr.filter(function(rr){return c.canMove(f,rr[1],rr[0],rr[3],rr[4],rr[5],s)}));var sn=Hr.map(function(rr){return rr[2]}),cn=f.lev,nt=sn.concat(cn),Nr=null;nt.indexOf(ar)!=-1?Nr=ar:ar>Math.max.apply(Math,(0,Se.A)(nt))?Nr=Math.max.apply(Math,(0,Se.A)(nt)):ar<Math.min.apply(Math,(0,Se.A)(nt))&&(Nr=Math.min.apply(Math,(0,Se.A)(nt))),tt=Hr.find(function(rr){return rr[2]==Nr}),!Qe&&!tt&&Hr.length&&(tt=Hr[0]),v=tt}}}}return v?(this.move(f,v[1],v[0],v[3]),!0):!1}},{key:"canMove",value:function(i,l,s,c,d,f,p){if(!i||!l||i.id===l.id)return!1;var v=this.props.config.settings,g=v.canRegroup,h=v.canRegroupCases,b=v.maxNesting,O=v.maxNumberOfRules,S=v.canLeaveEmptyCase,A=f?f.lev+1:l.lev,L=A+(i.depth||0),F=s==ro||s==eo,P=s==Xn||s==Rn,N=F&&l.lev==1||P&&l.lev==0,k=i.parent!=l.parent,I=P||k,B=i.type=="case_group"&&!N||i.parentType=="rule_group"||l.type=="rule_group"||l.parentType=="rule_group"||i.type!="case_group"&&l.type=="case_group"&&F||i.type!="case_group"&&l.type=="switch_group"||!h&&i.caseId!=l.caseId,U=l.isLocked||i.isLocked||f&&f.isLocked;if(b&&L>b||I&&(!g||B||U))return!1;if(i.type!="case_group"&&i.caseId!=l.caseId){var x=c?c._height==2:!1,X=d?d.atomicRulesCountInCase+1:0;if(O&&X>O||x&&!S)return!1}if(i.type=="case_group"&&(i.isDefaultCase||l.isDefaultCase||l.type=="switch_group"&&s==Rn))return!1;var W=!0;return p&&(W=p(i.node.toJS(),l.node.toJS(),s,f?f.node.toJS():null)),W}},{key:"move",value:function(i,l,s,c){this._isUsingLegacyReactDomRender||(_i=!0),this.props.actions.moveItem(i.path,l.path,s)}},{key:"render",value:function(){return m.createElement(e,(0,dr.A)({},this.props,{onDragStart:this.onDragStart}))}}])}(m.Component),t.propTypes={tree:R().any.isRequired,actions:R().object.isRequired},t};const py=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=Za(function(r){return{dragging:r.dragging,dragStart:r.dragStart,mousePos:r.mousePos}},{setDragStart:Mh,setDragProgress:kh,setDragEnd:_h},null,{context:ya})(fy(n,e));return t.displayName="ConnectedSortableContainer",t};var vy=["isDraggingTempo","isDraggingMe","dragging"];function gy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,vd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function vd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vd=function(){return!!n})()}const ra=function(n){return function(e){var t;return t=function(r){function a(o){var u;return(0,ze.A)(this,a),u=gy(this,a,[o]),u.handleDraggerMouseDown=function(i){var l=u.props.id,s=u.wrapper.current;u.props.onDragStart&&u.props.onDragStart(l,s,i)},u.wrapper=m.createRef(),u}return(0,hr.A)(a,r),(0,mr.A)(a,[{key:"render",value:function(){var u=this.props,i=u.isDraggingTempo,l=u.isDraggingMe,s=u.dragging,c=(0,Yn.A)(u,vy),d=c.isTrueLocked,f={};l&&i&&(_i||(f={top:s.y,left:s.x,width:s.w}));var p=Pt()(n,"group-or-rule",l&&i?"qb-draggable":null,l&&!i?"qb-placeholder":null,d?"locked":null);return m.createElement("div",{className:p,style:f,ref:this.wrapper,"data-id":this.props.id},m.createElement(e,(0,dr.A)({handleDraggerMouseDown:this.handleDraggerMouseDown,isDraggingMe:l,isDraggingTempo:i},c)))}}])}(m.PureComponent),t.propTypes={isDraggingTempo:R().bool,isDraggingMe:R().bool,onDragStart:R().func,dragging:R().object,isLocked:R().bool,isTrueLocked:R().bool},t}};var my=y(73569),ta=y.n(my),hy=y(71086),yy=y.n(hy);function gd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Oy(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?gd(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):gd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function by(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,md()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function md(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(md=function(){return!!n})()}var hd=qe.ConfigUtils,Sy=hd.getFieldConfig,Fy=hd.getOperatorConfig,yd=function(n){function e(t){var r;return(0,ze.A)(this,e),r=by(this,e,[t]),Xr(r),r.onPropsChanged(t),r}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["config","selectedField","selectedFieldSrc","selectedFieldType","selectedOperator"],u=!this.meta||o.map(function(i){return r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a,o=r.config,u=r.selectedField,i=r.selectedFieldType,l=r.selectedOperator,s=Sy(o,u),c=(0,Se.A)(s?.operators||((a=o.types[i])===null||a===void 0?void 0:a.operators)||[]);!u&&!c.includes(l)&&c.push(l);var d=Ya()(yy()(o.operators,function(S,A){return c?.indexOf(A)!==-1}),function(S,A){return Fy(o,A,u)}),f=this.buildOptions(o,d,c),p=d[l]||{},v=this.props.config.settings.operatorPlaceholder,g=l,h=g?[g]:null,b=h,O=p.label;return{placeholder:v,items:f,selectedKey:g,selectedKeys:h,selectedPath:b,selectedLabel:O,selectedOpts:p,fieldConfig:s}}},{key:"buildOptions",value:function(r,a,o){return!a||!o?null:ta()(a).sort(function(u,i){return o.indexOf(u)-o.indexOf(i)}).map(function(u){var i=a[u],l=i.label;return{key:u,path:u,label:l}})}},{key:"render",value:function(){var r=this.props,a=r.config,o=r.customProps,u=r.setOperator,i=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderOperator,d=Oy({id:l,groupId:s,config:a,customProps:o,readonly:i,setField:u},this.meta);return d.items?c(d,a.ctx):null}}])}(m.Component);yd.propTypes={id:R().string,groupId:R().string,config:R().object.isRequired,selectedField:R().any,selectedFieldType:R().string,selectedFieldSrc:R().string,selectedOperator:R().string,readonly:R().bool,setOperator:R().func.isRequired};var Ey=["children"],$r=function(e){var t=e.children,r=(0,Yn.A)(e,Ey);return m.createElement("div",r,t)},pt=function(){},Od=function(){return m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"gray",width:"18px",height:"18px"},m.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),m.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))},na=function(e){return function(t){var r=t.config.settings.useConfirm,a=r?r.call(t.config.ctx,t.config.ctx):null;return m.createElement(e,(0,dr.A)({},t,{confirmFn:a}))}};function Cy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,bd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function bd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bd=function(){return!!n})()}var Sd=function(n){function e(){return(0,ze.A)(this,e),Cy(this,e,arguments)}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedFieldSrc,i=r.selectedFieldType,l=r.selectedOperator,s=r.setOperator,c=r.selectedFieldParts,d=r.showOperator,f=r.showOperatorLabel,p=r.selectedFieldWidgetConfig,v=r.readonly,g=r.id,h=r.groupId,b=d&&m.createElement($r,{key:"operators-for-"+(c||[]).join("_"),className:"rule--operator"},a.settings.showLabels&&m.createElement("label",{className:"rule--label"},a.settings.operatorLabel),m.createElement(yd,{key:"operator",config:a,selectedField:o,selectedFieldSrc:u,selectedFieldType:i,selectedOperator:l,setOperator:s,readonly:v,id:g,groupId:h})),O=f&&m.createElement($r,{key:"operators-for-"+(c||[]).join("_"),className:"rule--operator"},m.createElement("div",{className:"rule--operator-wrapper"},a.settings.showLabels?m.createElement("label",{className:"rule--label"},"\xA0"):null,m.createElement("div",{className:"rule--operator-text-wrapper"},m.createElement("span",{className:"rule--operator-text"},p.operatorInlineLabel))));return[b,O]}}])}(m.PureComponent);function Fd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ty(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Fd(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Fd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Ay(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Ed()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Ed(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ed=function(){return!!n})()}var Cd=qe.RuleUtils.getFieldPathLabels,Gi=qe.ConfigUtils,Td=Gi.getFieldConfig,Ad=Gi.getFieldParts,Ld=Gi.getFieldPathParts,wd=function(n){function e(t){var r;return(0,ze.A)(this,e),r=Ay(this,e,[t]),r.setField=function(a,o){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=r.props.id;if(!u.widgetId){var l=[i,"L",-1].join(":");u.widgetId=l}r.props.setField(a,o,u)},Xr(r),r.onPropsChanged(t),r}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["selectedField","selectedFieldSrc","selectedFieldType","config","parentField"],u=!this.meta||o.map(function(i){return r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a=r.selectedField,o=r.selectedFieldType,u=r.config,i=r.parentField,l=a,s=u.settings,c=s.maxLabelsLength,d=s.fieldSeparatorDisplay,f=s.fieldPlaceholder,p=s.fieldSeparator,v=!!a,g=v?null:to(f,c),h=v?Td(u,l):null,b=h||{},O=Ld(l,u),S=Ld(l,u,!0),A=this.getFieldLabel(h,l,u),L=Cd(l,u),F=L?L.join(d):null;(F==A||i)&&(F=null);var P=b.label2,N=Ad(i,u),k=i?Td(u,i):null,I=i?k&&k.subfields:u.fields,B=!v&&o,U=this.buildOptions(N,u,I,B,N),x=B?"Please select field":null;return l&&(0,Fr.A)(l)==="object"&&(l=void 0),{placeholder:g,items:U,parentField:i,selectedKey:l,selectedKeys:O,selectedPath:S,selectedLabel:A,selectedOpts:b,selectedAltLabel:P,selectedFullLabel:F,errorText:x}}},{key:"getFieldLabel",value:function(r,a,o){if(!a)return null;var u=o.settings.maxLabelsLength,i=Ad(a,o),l=r?.label||ka()(i);return l=to(l,u),l}},{key:"buildOptions",value:function(r,a,o){var u=this,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;if(!o)return null;var c=a.settings,d=c.fieldSeparator,f=c.fieldSeparatorDisplay,p=l!=null&&l.length?l.join(d)+d:"",v=function g(h){return Object.keys(h||{}).reduce(function(b,O){var S=h[O];return S.type==="!struct"?b+g(S.subfields):b+(S.type===i?1:0)},0)};return ta()(o).map(function(g){var h=[].concat((0,Se.A)(l??[]),[g]),b=o[g],O=u.getFieldLabel(b,h,a),S=Cd(h,a),A=S.join(f);(A==O||r!=null&&r.length)&&(A=null);var L=b.label2,F=b.tooltip,P=b.disabled;if(!b.hideForSelect)if(b.type=="!struct"){var N=u.buildOptions(r,a,b.subfields,i,h,{label:O,tooltip:F}),k=v(b.subfields)>0;return{disabled:P,key:g,path:p+g,label:O,fullLabel:A,altLabel:L,tooltip:F,items:N,matchesType:k}}else{var I=i!==void 0?b.type===i:void 0;return{disabled:P,key:g,path:p+g,label:O,fullLabel:A,altLabel:L,tooltip:F,grouplabel:s?.label,group:s,matchesType:I}}}).filter(function(g){return!!g})}},{key:"render",value:function(){var r=this.props,a=r.config,o=r.customProps,u=r.setFieldSrc,i=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderField,d=Ty({id:l,groupId:s,config:a,customProps:o,readonly:i,setField:this.setField,setFieldSrc:u},this.meta);return c(d,a.ctx)}}])}(m.Component);wd.propTypes={id:R().string,groupId:R().string,config:R().object.isRequired,selectedField:R().any,selectedFieldSrc:R().string,selectedFieldType:R().string,parentField:R().string,customProps:R().object,readonly:R().bool,setField:R().func.isRequired,setFieldSrc:R().func};function Rd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ly(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Rd(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Rd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function wy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Pd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Pd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pd=function(){return!!n})()}var Ry=qe.clone,no=qe.ConfigUtils,Py=no.getFieldConfig,jd=no.getFuncConfig,jy=no.getFieldParts,Id=no.getFieldPathParts,Vd=qe.RuleUtils,Dd=Vd.getFuncPathLabels,Iy=Vd.getWidgetForFieldOp,Vy=qe.OtherUtils.shallowEqual,Nd=function(n){function e(t){var r;return(0,ze.A)(this,e),r=wy(this,e,[t]),Xr(r),r.onPropsChanged(t),r}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["config","field","fieldType","fieldSrc","operator","isFuncArg","isLHS","parentFuncs"],u=["config","field","fieldType","fieldSrc","value","isLHS"],i=!this.items||o.map(function(s){return s==="parentFuncs"?!Vy(r[s],a[s],!0):r[s]!==a[s]}).filter(function(s){return s}).length>0,l=!this.meta||u.map(function(s){return r[s]!==a[s]}).filter(function(s){return s}).length>0;l&&(this.meta=this.getMeta(r)),i&&(this.items=this.getItems(r,this.meta))}},{key:"getItems",value:function(r,a){var o=r.config,u=r.field,i=r.fieldType,l=r.isLHS,s=r.operator,c=r.parentFuncs,d=r.fieldDefinition,f=r.isFuncArg,p=a.lookingForFieldType,v=o.settings.canUseFuncForField,g=this.filterFuncs(o,o.funcs,u,i,l,s,v,c,f,d),h=this.buildOptions(o,g,p);return h}},{key:"getMeta",value:function(r){var a=r.config,o=r._field,u=r.fieldType,i=r.value,l=r.isLHS,s=r.isFuncArg,c=a.settings,d=c.funcPlaceholder,f=c.fieldSeparatorDisplay,p=i,v=!!i,g=v?null:d,h=v?jd(a,p):null,b=h||{},O=Id(p,a),S=Id(p,a,!0),A=this.getFuncLabel(h,p,a),L=Dd(p,a),F=L?L.join(f):null;F==A&&(F=null);var P=l&&!s,N=P&&!v&&u,k=N?"Please select function":null;return{placeholder:g,selectedKey:p,selectedKeys:O,selectedPath:S,selectedLabel:A,selectedOpts:b,selectedFullLabel:F,errorText:k,lookingForFieldType:N}}},{key:"filterFuncs",value:function(r,a,o,u,i,l,s,c,d,f){a=Ry(a);var p=r.settings.fieldSeparator,v=Py(r,o),g=!1,h,b=v,O=Iy(r,o,l,"value"),S=O&&r.widgets[O];d?(b=f,h=f?.type):g&&S?h=S.type:v?h=v.type:i||(h=u);function A(L,F){for(var P in L){var N=L[P].subfields,k=(F||[]).concat(P),I=k.join(p),B=jd(r,I);if(B.type=="!struct")A(N,k)==0&&delete L[P];else{var U,x=!h||B.returnType==h;(U=b)!==null&&U!==void 0&&U.funcs&&(x=x&&b.funcs.includes(I)),s&&(x=x&&s(o,v,I,B,l)),!B.allowSelfNesting&&c&&c.map(function(X){var W=(0,we.A)(X,2),J=W[0],G=W[1];return J}).includes(I)&&(x=!1),x||delete L[P]}}return ta()(L).length}return A(a,[]),a}},{key:"buildOptions",value:function(r,a){var o=this,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!a)return null;var s=r.settings,c=s.fieldSeparator,d=s.fieldSeparatorDisplay,f=i!=null&&i.length?i.join(c)+c:"",p=function v(g){return Object.keys(g||{}).reduce(function(h,b){var O=g[b];return O.type==="!struct"?h+v(O.subfields):h+(O.type===u?1:0)},0)};return ta()(a).map(function(v){var g=[].concat((0,Se.A)(i??[]),[v]),h=a[v],b=o.getFuncLabel(h,g,r),O=Dd(g,r),S=O.join(d);S==b&&(S=null);var A=h.tooltip;if(h.type=="!struct"){var L=o.buildOptions(r,h.subfields,u,g,{label:b,tooltip:A}),F=p(h.subfields)>0;return{key:v,path:f+v,label:b,fullLabel:S,tooltip:A,items:L,matchesType:F}}else{var P=u!==void 0?h.returnType===u:void 0;return{key:v,path:f+v,label:b,fullLabel:S,tooltip:A,grouplabel:l?.label,group:l,matchesType:P}}})}},{key:"getFuncLabel",value:function(r,a,o){if(!a)return null;var u=o.settings.maxLabelsLength,i=jy(a,o),l=r?.label||ka()(i);return l=to(l,u),l}},{key:"render",value:function(){var r=this.props,a=r.config,o=r.customProps,u=r.setValue,i=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderFunc,d=Ly({config:a,customProps:o,readonly:i,setField:u,items:this.items,id:l,groupId:s},this.meta);return c(d,a.ctx)}}])}(m.Component);Nd.propTypes={id:R().string,groupId:R().string,config:R().object.isRequired,field:R().any,fieldType:R().string,fieldSrc:R().string,operator:R().string,customProps:R().object,value:R().string,setValue:R().func.isRequired,readonly:R().bool,parentFuncs:R().array,fieldDefinition:R().object,isFuncArg:R().bool,isLHS:R().bool};var Dy=y(23181),$i=y.n(Dy),Ny=["factory"];function xd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ui(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xd(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):xd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var kd=qe.ListUtils.getTitleInListValues,xy=qe.ConfigUtils._widgetDefKeysToOmit,ky=qe.TreeUtils._fixImmutableValue;const My=function(n){var e=n.delta,t=n.isFuncArg,r=n.valueSrc,a=n.value,o=n.valueError,u=n.fieldError,i=n.asyncListValues,l=n.isSpecialRange,s=n.fieldDefinition,c=n.widget,d=n.widgetDefinition,f=n.widgetValueLabel,p=n.valueLabels,v=n.textSeparators,g=n.setValueHandler,h=n.setFuncValue,b=n.config,O=n.field,S=n.fieldSrc,A=n.fieldType,L=n.isLHS,F=n.operator,P=n.readonly,N=n.parentField,k=n.parentFuncs,I=n.id,B=n.groupId,U=n.widgetId,x=d.factory,X=(0,Yn.A)(d,Ny),W=t&&s.valueSources&&s.valueSources.length==1&&s.valueSources[0]=="const",J=s.defaultValue;if(!x)return"?";var G=a?a.map(function(se){return ky(se)}):void 0,ee=l?[G?.get(0),G?.get(1)]:G?G.get(e):void 0,ie=o?.get&&(l?[o.get(0),o.get(1),o.get(2)]:o.get(e))||null,de=L?u:ie;l&&ee[0]===void 0&&ee[1]===void 0&&(ee=void 0);var fe=s||{},ne=fe.fieldSettings,te=Er()(Ui(Ui(Ui({},X),ne),{},{config:b,field:O,fieldSrc:S,fieldType:A,isLHS:L,parentField:N,parentFuncs:k,fieldDefinition:s,operator:F,delta:e,isSpecialRange:l,isFuncArg:t,value:ee,valueError:ie,fieldError:u,errorMessage:de,label:f.label,placeholder:f.placeholder,placeholders:p?p.placeholder:null,textSeparators:v,setValue:g,setFuncValue:h,readonly:P,asyncListValues:i,id:I,groupId:B,widgetId:U}),[].concat((0,Se.A)(xy),["toJS"]));if(c=="field",W&&J){var ve=ne?.treeValues||ne?.listValues;return typeof J=="boolean"?J?te.labelYes||"YES":te.labelNo||"NO":ve?Array.isArray(J)?J.map(function(se){return kd(ve,se)||se}).join(", "):kd(ve,J)||J:""+J}return x(te,b.ctx)};function _y(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Md()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Md(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Md=function(){return!!n})()}var Bi=qe.ConfigUtils,Gy=Bi.getFieldConfig,$y=Bi.getOperatorConfig,_d=Bi.getFieldWidgetConfig,Wi=qe.RuleUtils,Uy=Wi.getValueSourcesForFieldOp,Gd=Wi.getWidgetForFieldOp,ao=Wi.getValueLabel,$d=qe.DefaultUtils.createListFromArray,By=qe.OtherUtils.shallowEqual,Wy={cardinality:1},Oa=function(n){function e(t){var r;return(0,ze.A)(this,e),r=_y(this,e,[t]),r._setValue=function(a,o,u,i,l,s){var c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{};if(c.widgetId||(c.widgetId=i),a&&Array.isArray(l)){var d=[r.props.value.get(0),r.props.value.get(1)];d[0]!=l[0]&&r.props.setValue(0,l[0],u,s,c),d[1]!=l[1]&&r.props.setValue(1,l[1],u,s,c)}else r.props.setValue(o,l,u,s,c)},r._setValueSrc=function(a,o,u){var i={widgetId:o};r.props.setValueSrc(a,u,i)},r.renderWidget=function(a,o,u){var i=u.config,l=u.isFuncArg,s=u.leftField,c=u.operator,d=u.value,f=u.valueError,p=u.fieldError,v=u.readonly,g=u.parentField,h=u.parentFuncs,b=u.id,O=u.groupId,S=u.fieldSrc,A=u.fieldType,L=u.isLHS,F=u.setFuncValue,P=i.settings,N=o.widgets,k=o.iValues,I=o.aField,B=o.valueSources,U=l?k:d,x=l?s:I,X=N[a],W=X.valueSrc,J=X.valueLabel,G=X.widgetId,ee=B.length>1&&!v,ie=P.showLabels?m.createElement("label",{className:"rule--label"},J.label):null;return m.createElement("div",{key:"widget-"+x+"-"+a,className:Pt()(W=="func"?"widget--func":"widget--widget",ee?"widget--has-valuerscs":"widget--has-no-valuerscs")},W=="func"?null:ie,m.createElement(My,(0,dr.A)({id:b,groupId:O,widgetId:G,valueSrc:W,delta:a,value:U,valueError:f,fieldError:p,isFuncArg:l,isLHS:L},Ut()(o,["isSpecialRange","fieldDefinition","asyncListValues"]),Ut()(N[a],["widget","widgetDefinition","widgetValueLabel","valueLabels","textSeparators","setValueHandler"]),{setFuncValue:F,config:i,field:x,fieldSrc:S,fieldType:A,parentField:g,parentFuncs:h,operator:c,readonly:v})))},r.renderValueSources=function(a,o,u){var i=u.config,l=u.isFuncArg,s=u.leftField,c=u.operator,d=u.readonly,f=i.settings,p=o.valueSources,v=o.widgets,g=o.aField,h=l?s:g,b=v[a],O=b.valueSrc,S=b.setValueSrcHandler,A=f.valueSourcesInfo,L=f.renderValueSources,F=p.map(function(k){return[k,{label:A[k].label}]}),P=function(I){return L(I,i.ctx)},N=f.showLabels?m.createElement("label",{className:"rule--label"},"\xA0"):null;return p.length>1&&!d&&m.createElement("div",{key:"valuesrc-"+h+"-"+a,className:"widget--valuesrc"},N,m.createElement(P,{key:"valuesrc-"+a,delta:a,valueSources:F,valueSrc:O,config:i,field:h,operator:c,setValueSrc:S,readonly:d,title:f.valueSourcesPopupTitle}))},r.renderSep=function(a,o,u){var i=u.config,l=o.widgets,s=i.settings,c=l[a].sepText,d=s.showLabels?m.createElement("label",{className:"rule--label"},"\xA0"):null;return c&&m.createElement("div",{key:"widget-separators-"+a,className:Pt()("widget--sep",a==0&&"widget--sep-first")},d,m.createElement("span",null,c))},r.renderWidgetDelta=function(a){var o=r.renderSep(a,r.meta,r.props),u=r.renderValueSources(a,r.meta,r.props),i=r.renderWidget(a,r.meta,r.props);return[o,u,i]},Xr(r),r.onPropsChanged(t),r}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["config","id","parentFuncs","field","fieldSrc","fieldType","fieldFunc","fieldArg","leftField","operator","valueSrc","asyncListValues","isLHS","isFuncArg","isForRuleGroup","isCaseValue"],u=!this.meta||o.map(function(i){return i==="parentFuncs"?!By(r[i],a[i],!0):i==="isFuncArg"?r[i]!==a[i]||r.isFuncArg&&r.value!==a.value:r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a,o,u=this,i=r.config,l=r.field,s=r.fieldSrc,c=r.fieldType,d=r.fieldFunc,f=r.fieldArg,p=r.operator,v=r.valueSrc,g=r.value,h=r.isForRuleGroup,b=r.isCaseValue,O=r.isFuncArg,S=r.leftField,A=r.asyncListValues,L=r.parentFuncs,F=r.isLHS,P=r.id,N=O?{func:d,arg:f}:l,k=!l&&c,I=v,B=g;(O||h||b)&&(I=$d([v]),B=$d([g]));var U=Gy(i,N);!U&&k&&(U=i.types[c]);var x=Gd(i,N,p);if(!x&&k){var X;x=(X=i.types[c])===null||X===void 0?void 0:X.mainWidget}var W=O?Wy:$y(i,p,N);if((U==null||W==null)&&!b)return null;var J=W?.isSpecialRange,G=J&&(((a=I)===null||a===void 0?void 0:a.get(0))=="field"||((o=I)===null||o===void 0?void 0:o.get(1))=="field"),ee=J&&!G,ie=ee?1:Hh(W);if(ie===0)return null;var de=Uy(i,N,p,U);N||(de=Object.keys(i.settings.valueSourcesInfo));var fe=$i()(0,ie).map(function(ne){var te,ve,se=((te=I)===null||te===void 0?void 0:te.get(ne))||null,ue=Gd(i,N,p,se),Ce=_d(i,N,p,ue,se);G&&(ue=Ce.singleWidget,Ce=_d(i,N,p,ue,se)),!Ce&&k&&(ue=["func","field"].includes(se)?se:x,Ce=i.widgets[ue]);var he=(ve=Ce)===null||ve===void 0?void 0:ve.type,Pe=ao(i,N,p,ne,se,ee),Ne=ao(i,N,p,ne,null,ee),Be=W!=null&&W.textSeparators?W?.textSeparators[ne]:null,Qe=null,Je=null;J&&(Qe=[ao(i,N,p,0),ao(i,N,p,1)],Qe={placeholder:[Qe[0].placeholder,Qe[1].placeholder],label:[Qe[0].label,Qe[1].label]},Je=W?.textSeparators);var We=[P,F?"L":"R",F?-1:ne||0,(L||[]).map(function(tr){var st=(0,we.A)(tr,2),Mt=st[0],St=st[1];return"".concat(Mt,"(").concat(St,")")}).join("/")].join(":"),or=We+":VS",ar=u._setValueSrc.bind(u,ne,or),Ar=u._setValue.bind(u,J,ne,he,We);return{valueSrc:se,valueLabel:Pe,widget:ue,sepText:Be,widgetDefinition:Ce,widgetValueLabel:Ne,valueLabels:Qe,textSeparators:Je,setValueSrcHandler:ar,setValueHandler:Ar,widgetId:We}});return{defaultWidget:x,fieldDefinition:U,operatorDefinition:W,isSpecialRange:ee,cardinality:ie,valueSources:de,widgets:fe,iValues:B,aField:N,asyncListValues:A}}},{key:"render",value:function(){if(!this.meta)return null;var r=this.meta,a=r.defaultWidget,o=r.cardinality;if(!a)return null;var u=a;return m.createElement($r,{className:"rule--widget rule--widget--".concat(u.toUpperCase()),key:"widget-col-"+u},$i()(0,o).map(this.renderWidgetDelta))}}])}(m.Component);Oa.propTypes={config:R().object.isRequired,value:R().any,valueSrc:R().any,valueError:R().any,fieldError:R().string,field:R().any,fieldSrc:R().string,fieldType:R().string,operator:R().string,readonly:R().bool,asyncListValues:R().array,id:R().string,groupId:R().string,setValue:R().func,setValueSrc:R().func,setFuncValue:R().func,isFuncArg:R().bool,fieldFunc:R().string,fieldArg:R().string,leftField:R().any,isForRuleGroup:R().bool,parentField:R().string,parentFuncs:R().array,isLHS:R().bool,isCaseValue:R().bool};function Ud(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Bd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Bd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Bd=function(){return!!n})()}var Ky=qe.ConfigUtils.getFuncConfig,Ki=qe.FuncUtils,Mb=Ki.setFunc,_b=Ki.setArgValue,Gb=Ki.setArgValueSrc,Wd=qe.OtherUtils.shallowEqual,Hi=function(n){function e(t){var r;return(0,ze.A)(this,e),r=Ud(this,e,[t]),r.setFunc=function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=r.props,i=u.isLHS,l=u.delta,s=u.parentFuncs,c=u.id;if(!o.widgetId){var d=[c,i?"L":"R",i?-1:l||0,(s||[]).map(function(f){var p=(0,we.A)(f,2),v=p[0],g=p[1];return"".concat(v,"(").concat(g,")")}).join("/"),"F"].join(":");o.widgetId=d}r.props.setFuncValue(i?-1:l||0,s,null,a,"!func",void 0,o)},r.setArgValue=function(a,o,u,i,l){var s=r.props,c=s.config,d=s.delta,f=s.isLHS,p=s.parentFuncs;r.props.setFuncValue(f?-1:d||0,p,a,o,u,i,l)},r.setArgValueSrc=function(a,o,u){var i=r.props,l=i.config,s=i.delta,c=i.isLHS,d=i.parentFuncs;r.props.setFuncValue(c?-1:s||0,d,a,o,"!valueSrc",void 0,u)},r.renderFuncSelect=function(){var a,o,u=r.props,i=u.config,l=u.field,s=u.fieldType,c=u.fieldSrc,d=u.isLHS,f=u.operator,p=u.customProps,v=u.value,g=u.readonly,h=u.parentFuncs,b=u.id,O=u.groupId,S=u.isFuncArg,A=u.fieldDefinition,L=(a=v==null||(o=v.get)===null||o===void 0?void 0:o.call(v,"func"))!==null&&a!==void 0?a:null,F={value:L,setValue:r.setFunc,config:i,field:l,fieldType:s,fieldSrc:c,isLHS:d,operator:f,customProps:p,readonly:g,parentFuncs:h,isFuncArg:S,fieldDefinition:A,id:b,groupId:O},P=i.settings,N=P.showLabels,k=P.funcLabel,I=N?m.createElement("label",{className:"rule--label"},k):null;return m.createElement($r,{key:"func",className:"rule--func"},I,m.createElement(Nd,F))},r.renderArgLabel=function(a,o){var u=o.valueSources,i=o.type,l=o.showPrefix,s=o.label,c=r.props.config,d=u&&u.length==1&&u[0]=="const",f=!c.settings.showLabels&&(i=="boolean"||d)&&l;return f?m.createElement($r,{className:"rule--func--arg-label"},s||a):null},r.renderArgLabelSep=function(a,o){var u=o.valueSources,i=o.type,l=o.showPrefix,s=r.props.config,c=u&&u.length==1&&u[0]=="const",d=!s.settings.showLabels&&(i=="boolean"||c)&&l;return d?m.createElement($r,{className:"rule--func--arg-label-sep"},":"):null},r.renderArgVal=function(a,o,u){var i=r.props,l=i.config,s=i.field,c=i.fieldType,d=i.fieldSrc,f=i.isLHS,p=i.operator,v=i.value,g=i.readonly,h=i.parentFuncs,b=i.id,O=i.groupId,S=i.fieldError,A=i.valueError,L=i.setFuncValue,F=v?v.getIn(["args",o]):null,P=F?F.get("value"):void 0,N=u.valueSources.length==1?u.valueSources[0]:void 0,k=F?F.get("valueSrc")||N||"value":N,I={config:l,fieldFunc:a,fieldArg:o,leftField:s,fieldType:c,fieldSrc:d,fieldError:S,valueError:A,isLHS:f,operator:null,value:P,valueSrc:k,setValue:r.setArgValue,setValueSrc:r.setArgValueSrc,setFuncValue:L,funcKey:a,argKey:o,argDefinition:u,readonly:g,parentFuncs:h,id:b,groupId:O};return m.createElement($r,{className:"rule--func--arg-value"},m.createElement(Kd,I))},r.renderArgSep=function(a,o,u,i){var l=i.renderSeps;return u?m.createElement($r,{className:"rule--func--arg-sep"},l?l[u-1]:", "):null},r.renderBracketBefore=function(a){var o=a.renderBrackets;return m.createElement($r,{key:"before_args",className:"rule--func--bracket-before"},o?o[0]:"(")},r.renderBracketAfter=function(a){var o=a.renderBrackets;return m.createElement($r,{key:"after_args",className:"rule--func--bracket-after"},o?o[1]:")")},r.renderFuncArgs=function(){var a=r.meta,o=a.funcDefinition,u=a.funcKey;if(!u)return null;var i=o||{},l=i.args;return l?m.createElement(m.Fragment,null,r.renderBracketBefore(o),m.createElement($r,{key:"args-".concat(u),className:"rule--func--args rule--func--".concat(u,"--args")},Object.keys(l).map(function(s,c){return m.createElement($r,{key:"arg-".concat(s,"-").concat(c),className:"rule--func--arg rule--func--".concat(u,"--arg--").concat(s)},r.renderArgSep(s,l[s],c,o),r.renderArgLabel(s,l[s]),r.renderArgLabelSep(s,l[s]),r.renderArgVal(u,s,l[s]))})),r.renderBracketAfter(o)):null},Xr(r),r.onPropsChanged(t),r}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["config","field","operator","value","fieldSrc","fieldType","isLHS"],u=!this.meta||o.map(function(i){return i==="parentFuncs"?!Wd(r[i],a[i],!0):r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a,o,u=r.config,i=r.field,l=r.operator,s=r.value,c=(a=s==null||(o=s.get)===null||o===void 0?void 0:o.call(s,"func"))!==null&&a!==void 0?a:null,d=c?Ky(u,c):null;return{funcDefinition:d,funcKey:c}}},{key:"render",value:function(){var r=this.props.parentFuncs,a=r?r.map(function(u){var i=(0,we.A)(u,2),l=i[0],s=i[1];return"".concat(l,"_").concat(s)}).join("-"):"root",o=r?.length||0;return m.createElement($r,{className:"rule--func--wrapper rule--func--wrapper--under-".concat(a," rule--func--wrapper--lev-").concat(o)},this.renderFuncSelect(),this.renderFuncArgs())}}])}(m.Component);Hi.propTypes={id:R().string,groupId:R().string,config:R().object.isRequired,field:R().any,fieldSrc:R().string,fieldType:R().string,fieldError:R().string,operator:R().string,customProps:R().object,value:R().object,setValue:R().func.isRequired,setFuncValue:R().func,readonly:R().bool,parentFuncs:R().array,fieldDefinition:R().object,isFuncArg:R().bool,isLHS:R().bool,valueError:R().string};var Kd=function(n){function e(t){var r;return(0,ze.A)(this,e),r=Ud(this,e,[t]),r.setValue=function(a,o,u,i,l){var s=r.props,c=s.setValue,d=s.argKey;c(d,o,u,i,l)},r.setValueSrc=function(a,o,u){var i=r.props,l=i.setValueSrc,s=i.argKey;l(s,o,u)},Xr(r),r.onPropsChanged(t),r}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["parentFuncs","funcKey","argKey"],u=!this.meta||o.map(function(i){return i==="parentFuncs"?!Wd(r[i],a[i],!0):r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a=r.parentFuncs,o=r.funcKey,u=r.argKey,i=[].concat((0,Se.A)(a||[]),[[o,u]]);return{parentFuncs:i}}},{key:"render",value:function(){var r=this.meta.parentFuncs;return m.createElement(Oa,(0,dr.A)({},this.props,{setValue:this.setValue,setValueSrc:this.setValueSrc,isFuncArg:!0,parentFuncs:r}))}}])}(m.Component);Kd.propTypes={funcKey:R().string.isRequired,argKey:R().string.isRequired,setValue:R().func.isRequired,setValueSrc:R().func.isRequired,readonly:R().bool,isLHS:R().bool,parentFuncs:R().array,id:R().string,groupId:R().string};function Hy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Hd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Hd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Hd=function(){return!!n})()}var zi=function(n){function e(){var t;(0,ze.A)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=Hy(this,e,[].concat(a)),t.renderField=function(){var u=t.props,i=u.config,l=u.classname,s=u.selectedField,c=u.selectedFieldSrc,d=u.selectedFieldType,f=u.setField,p=u.setFuncValue,v=u.parentField,g=u.readonly,h=u.id,b=u.groupId,O=u.fieldError,S=u.valueError,A=["func","field"];if(!A.includes(c))return"?";var L=c==="func"?m.createElement(Hi,{isLHS:!0,config:i,value:s,fieldSrc:c,fieldType:d,fieldError:O,valueError:S,parentField:v,setValue:f,setFuncValue:p,readonly:g,id:h,groupId:b,key:"field-func-"+h}):m.createElement(wd,{config:i,selectedField:s,selectedFieldSrc:c,selectedFieldType:d,parentField:v,setField:f,customProps:i.settings.customFieldSelectProps,readonly:g,id:h,groupId:b,key:"field-"+h}),F=c==="func"?i.settings.funcLabel:i.settings.fieldLabel,P=i.settings.showLabels&&c!=="func"&&m.createElement("label",{className:"rule--label"},F);return m.createElement("div",{key:c,className:l},P,L)},t.renderFieldSources=function(){var u=t.props,i=u.config,l=u.readonly,s=u.selectedFieldSrc,c=u.setFieldSrc,d=u.id,f=i.settings,p=f.fieldSources,v=f.valueSourcesInfo,g=f.renderValueSources,h=p.map(function(S){return[S,{label:v[S].label}]}),b=function(A){return g(A,i.ctx)},O=f.showLabels?m.createElement("label",{className:"rule--label"},"\xA0"):null;return p.length>1&&!l&&m.createElement("div",{key:"fieldsrc",className:"rule--fieldsrc"},O,m.createElement(b,{key:"fieldsrc-"+d,valueSources:h,valueSrc:s,config:i,setValueSrc:c,readonly:l,title:f.fieldSourcesPopupTitle}))},t}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.classname,o=r.canSelectFieldSource,u=o&&this.renderFieldSources(),i=this.renderField();return o?m.createElement($r,{className:"rule--field-wrapper"},u,i):i}}])}(m.PureComponent),zy=["factory"];function qy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,zd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function zd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zd=function(){return!!n})()}var Jy=qe.ConfigUtils.getOperatorConfig,qd=function(n){function e(){return(0,ze.A)(this,e),qy(this,e,arguments)}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"render",value:function(){if(!this.props.selectedOperator)return null;var r=Jy(this.props.config,this.props.selectedOperator,this.props.selectedField);if(typeof r.options>"u")return null;var a=r.options,o=a.factory,u=(0,Yn.A)(a,zy),i=Object.assign({},u,{config:this.props.config,field:this.props.selectedField,fieldSrc:this.props.selectedFieldSrc,operator:this.props.selectedOperator,options:this.props.operatorOptions,setOption:this.props.setOperatorOption,readonly:this.props.readonly}),l=o(i,this.props.config.ctx),s=this.props.selectedOperator;return m.createElement("div",{className:"rule--operator rule--operator--".concat(s.toUpperCase())},l)}}])}(m.PureComponent);qd.propTypes={config:R().object.isRequired,operatorOptions:R().any.isRequired,selectedField:R().any,selectedFieldSrc:R().string,selectedOperator:R().string.isRequired,readonly:R().bool,setOperatorOption:R().func.isRequired};function Jd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Qd(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Jd(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Jd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Qy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Yd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Yd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Yd=function(){return!!n})()}var oo=qe.ConfigUtils,Yy=oo.getFieldConfig,Xy=oo.getOperatorConfig,Zy=oo.getFieldWidgetConfig,e0=oo.getFieldParts,r0=qe.RuleUtils.isEmptyRuleProperties,Xd=function(n){function e(t){var r;return(0,ze.A)(this,e),r=Qy(this,e,[t]),Xr(r),r.removeSelf=r.removeSelf.bind(r),r.setLock=r.setLock.bind(r),r.onPropsChanged(t),r}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["selectedField","selectedFieldSrc","selectedFieldType","selectedOperator","config","reordableNodesCnt","isLocked"],u=!this.meta||o.map(function(i){return r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a=r.selectedField,o=r.selectedFieldType,u=r.selectedOperator,i=r.config,l=r.reordableNodesCnt,s=r.isLocked,c=i.settings.keepInputOnChangeFieldSrc,d=e0(a,i),f=Yy(i,a),p=f&&f.type=="!struct",v=c&&o,g=!!a||v,h=g&&u,b=Xy(i,u,a),O=b&&b.options!=null,S=Zy(i,a,u,null,null)||{},A=S.hideOperator,L=i.settings.canReorder&&l>1&&!s,F=g&&!A,P=g&&A&&S.operatorInlineLabel,N=h&&!p,k=h&&O;return{selectedFieldParts:d,selectedFieldWidgetConfig:S,showDragIcon:L,showOperator:F,showOperatorLabel:P,showWidget:N,showOperatorOptions:k}}},{key:"setLock",value:function(r){this.props.setLock(r)}},{key:"removeSelf",value:function(){var r=this,a=this.props,o=a.confirmFn,u=a.config,i=u.settings,l=i.renderConfirm,s=i.removeRuleConfirmOptions,c=function(){r.props.removeSelf()};s&&!this.isEmptyCurrentRule()?l.call(u.ctx,Qd(Qd({},s),{},{onOk:c,onCancel:null,confirmFn:o}),u.ctx):c()}},{key:"_buildWidgetProps",value:function(r){var a=r.selectedField,o=r.selectedFieldSrc,u=r.selectedFieldType,i=r.selectedOperator,l=r.operatorOptions,s=r.value,c=r.valueType,d=r.valueSrc,f=r.asyncListValues,p=r.valueError,v=r.fieldError,g=r.parentField;return{field:a,fieldSrc:o,fieldType:u,operator:i,operatorOptions:l,value:s,valueType:c,valueSrc:d,asyncListValues:f,valueError:p,fieldError:v,parentField:g}}},{key:"isEmptyCurrentRule",value:function(){var r=this.props.config,a=this._buildWidgetProps(this.props);return r0(a,r)}},{key:"renderField",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=r.parentField,i=r.groupId,l=r.id,s=r.selectedFieldSrc,c=r.selectedField,d=r.selectedFieldType,f=r.setField,p=r.setFuncValue,v=r.setFieldSrc,g=r.fieldError,h=a.settings.immutableFieldsMode;return m.createElement(zi,{key:"field",classname:Pt()(s=="func"?"rule--field--func":"rule--field"),config:a,canSelectFieldSource:!u,selectedField:c,selectedFieldSrc:s,selectedFieldType:d,fieldError:g,setField:h?pt:f,setFuncValue:h?pt:p,setFieldSrc:h?pt:v,parentField:u,readonly:h||o,id:l,groupId:i})}},{key:"renderOperator",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=this.meta,i=u.selectedFieldParts,l=u.selectedFieldWidgetConfig,s=u.showOperator,c=u.showOperatorLabel,d=a.settings.immutableOpsMode;return m.createElement(Sd,{key:"operator",config:a,selectedField:this.props.selectedField,selectedFieldSrc:this.props.selectedFieldSrc,selectedFieldType:this.props.selectedFieldType,selectedOperator:this.props.selectedOperator,setOperator:d?pt:this.props.setOperator,selectedFieldParts:i,showOperator:s,showOperatorLabel:c,selectedFieldWidgetConfig:l,readonly:d||o,id:this.props.id,groupId:this.props.groupId})}},{key:"renderWidget",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=this.meta.showWidget,i=a.settings.immutableValuesMode;if(!u)return null;var l=m.createElement(Oa,(0,dr.A)({key:"values"},this._buildWidgetProps(this.props),{config:a,setValue:i?pt:this.props.setValue,setValueSrc:i?pt:this.props.setValueSrc,setFuncValue:i?pt:this.props.setFuncValue,readonly:i||o,id:this.props.id,groupId:this.props.groupId}));return m.createElement($r,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},l)}},{key:"renderOperatorOptions",value:function(){var r=this.props.config,a=this.meta.showOperatorOptions,o=r.settings,u=o.immutableOpsMode,i=o.immutableValuesMode;if(!a)return null;var l=m.createElement(qd,{key:"operatorOptions",selectedField:this.props.selectedField,selectedOperator:this.props.selectedOperator,operatorOptions:this.props.operatorOptions,setOperatorOption:u?pt:this.props.setOperatorOption,config:r,readonly:i});return m.createElement($r,{key:"op-options-for-"+this.props.selectedOperator,className:"rule--operator-options"},l)}},{key:"renderBeforeWidget",value:function(){var r=this.props.config,a=r.settings.renderBeforeWidget;return a&&m.createElement($r,{key:"before-widget-for-"+this.props.selectedOperator,className:"rule--before-widget"},typeof a=="function"?a(this.props,r.ctx):a)}},{key:"renderAfterWidget",value:function(){var r=this.props.config,a=r.settings.renderAfterWidget;return a&&m.createElement($r,{key:"after-widget-for-"+this.props.selectedOperator,className:"rule--after-widget"},typeof a=="function"?a(this.props,r.ctx):a)}},{key:"renderError",value:function(){var r=this.props,a=r.config,o=r.valueError,u=r.fieldError,i=a.settings,l=i.renderRuleError,s=i.showErrorMessage,c=[u].concat((0,Se.A)(o?.toArray()||[])).filter(function(d){return!!d}).shift()||null;return s&&c&&m.createElement("div",{className:"rule--error"},l?l({error:c},a.ctx):c)}},{key:"renderDrag",value:function(){var r=this.props.handleDraggerMouseDown,a=this.props.config,o=this.meta.showDragIcon,u=a.settings.renderIcon,i=function(c){return u?.(c,a.ctx)},l=m.createElement(i,{type:"drag"});return o&&m.createElement("div",{key:"rule-drag-icon",onMouseDown:r,className:"qb-drag-handler rule--drag-handler"},l)}},{key:"renderDel",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=a.settings,i=u.deleteLabel,l=u.immutableGroupsMode,s=u.renderButton,c=u.renderIcon,d=u.canDeleteLocked,f=function(g){return c(g,a.ctx)},p=function(g){return s(g,a.ctx)};return!l&&(!o||o&&d)&&m.createElement(p,{type:"delRule",onClick:this.removeSelf,label:i,config:a,renderIcon:f})}},{key:"renderLock",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=r.isTrueLocked,i=r.id,l=a.settings,s=l.lockLabel,c=l.lockedLabel,d=l.showLock,f=l.renderSwitch,p=function(g){return f(g,a.ctx)};return d&&!(o&&!u)&&m.createElement(p,{type:"lock",id:i,value:o,setValue:this.setLock,label:s,checkedLabel:c,hideLabel:!0,config:a})}},{key:"render",value:function(){var r=this.meta,a=r.showOperatorOptions,o=r.selectedFieldWidgetConfig,u=this.props,i=u.valueSrc,l=u.value,s=u.config,c=i?.first()=="value"&&!a&&l.size==1&&o.fullWidth,d=s.settings.renderButtonGroup,f=function(A){return d(A,s.ctx)},p=[this.renderField(),this.renderOperator(),this.renderBeforeWidget(),this.renderWidget(),this.renderAfterWidget(),this.renderOperatorOptions()],v=m.createElement("div",{key:"rule-body",className:Pt()("rule--body",c&&"can--shrink--value")},p),g=this.renderError(),h=this.renderDrag(),b=this.renderLock(),O=this.renderDel();return m.createElement(m.Fragment,null,h,m.createElement("div",{className:"rule--body--wrapper"},v,g),m.createElement("div",{className:"rule--header"},m.createElement(f,{config:s},b,O)))}}])}(m.Component);Xd.propTypes={id:R().string.isRequired,groupId:R().string,selectedField:R().any,selectedFieldSrc:R().string,selectedFieldType:R().string,selectedOperator:R().string,operatorOptions:R().object,config:R().object.isRequired,value:R().any,valueSrc:R().any,valueType:R().any,asyncListValues:R().array,isDraggingMe:R().bool,isDraggingTempo:R().bool,parentField:R().string,valueError:R().any,fieldError:R().string,isLocked:R().bool,isTrueLocked:R().bool,handleDraggerMouseDown:R().func,setField:R().func,setFieldSrc:R().func,setOperator:R().func,setOperatorOption:R().func,setLock:R().func,removeSelf:R().func,setValue:R().func,setValueSrc:R().func,reordableNodesCnt:R().number,totalRulesCnt:R().number,parentReordableNodesCnt:R().number};const t0=sy(ra("rule")(na(Xd)));var n0=y(22331),a0=y.n(n0);function o0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Zd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Zd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zd=function(){return!!n})()}var i0=qe.DefaultUtils.defaultGroupConjunction,u0=function(e,t){var r;return r=function(a){function o(u){var i;return(0,ze.A)(this,o),i=o0(this,o,[u]),i._selectedConjunction=function(l){return l=l||i.props,l.conjunction||i0(l.config,l.field)},i.setConjunction=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;i.props.actions.setConjunction(i.props.path,l)},i.setNot=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;i.props.actions.setNot(i.props.path,l)},i.setLock=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;i.props.actions.setLock(i.props.path,l)},i.dummyFn=function(){},i.removeSelf=function(){i.props.actions.removeGroup(i.props.path)},i.addGroup=function(){i.props.actions.addGroup(i.props.path)},i.addCaseGroup=function(){i.props.actions.addCaseGroup(i.props.path)},i.addDefaultCaseGroup=function(){i.props.actions.addDefaultCaseGroup(i.props.path)},i.addRule=function(){var l=t=="rule_group"?i.props.field:null;i.props.actions.addRule(i.props.path,void 0,void 0,void 0,l)},i.setField=function(l,s,c){i.props.actions.setField(i.props.path,l,s,c)},i.setOperator=function(l){i.props.actions.setOperator(i.props.path,l)},i.setValue=function(l,s,c,d,f){i.props.actions.setValue(i.props.path,l,s,c,d,f)},i.setFuncValue=function(l,s,c,d,f,p,v){i.props.actions.setFuncValue(i.props.path,l,s,c,d,f,p,v)},i.pureShouldComponentUpdate=ea(i),Xr(i),i.selectedConjunction=i._selectedConjunction(u),i.conjunctionOptions=i._getConjunctionOptions(u),i.dummyFn.isDummyFn=!0,i}return(0,hr.A)(o,a),(0,mr.A)(o,[{key:"shouldComponentUpdate",value:function(i,l){var s=this.props,c=this.state,d=this.pureShouldComponentUpdate(i,l);if(d&&c==l&&s!=i){var f=i.dragging.id||s.dragging.id,p=f==i.id,v=[];for(var g in i){var h=i[g]!=s[g];g=="dragging"&&!p&&(h=!1),h&&v.push(g)}v.length||(d=!1)}return d}},{key:"onPropsChanged",value:function(i){var l=i.config,s=i.id,c=i.conjunction,d=this.props.config,f=this.props.conjunction;(d!=l||f!=c)&&(this.selectedConjunction=this._selectedConjunction(i),this.conjunctionOptions=this._getConjunctionOptions(i))}},{key:"_getConjunctionOptions",value:function(i){var l=this;return Ya()(i.config.conjunctions,function(s,c){return{id:"conjunction-".concat(i.id,"-").concat(c),name:"conjunction[".concat(i.id,"]"),key:c,label:s.label,checked:c===l._selectedConjunction(i)}})}},{key:"render",value:function(){var i=this.props.config.settings.showErrorMessage,l=this.props.dragging.id==this.props.id,s=this.props.path.size,c=this.props.config.settings.maxNesting,d=!l&&this.props.isDraggingTempo,f=this.props.fieldType||null,p=this.props.valueError,v=(0,Se.A)(p?.toArray()||[]).filter(function(O){return!!O}).shift()||null,g=v!=null&&i,h=typeof c>"u"||s<c,b=s==1;return m.createElement("div",{className:Pt()("group-or-rule-container","group-container",g?"group-with-error":null),"data-id":this.props.id},[l?m.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,isRoot:b,allowFurtherNesting:h,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:this.dummyFn,setNot:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,addGroup:this.dummyFn,addCaseGroup:this.dummyFn,addDefaultCaseGroup:this.dummyFn,addRule:this.dummyFn,setField:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setValue:this.dummyFn,value:this.props.value||null,valueError:this.props.valueError||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:f,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,m.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:l,isDraggingTempo:d,onDragStart:this.props.onDragStart,isRoot:b,allowFurtherNesting:h,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:d?this.dummyFn:this.setConjunction,setNot:d?this.dummyFn:this.setNot,setLock:d?this.dummyFn:this.setLock,removeSelf:d?this.dummyFn:this.removeSelf,addGroup:d?this.dummyFn:this.addGroup,addCaseGroup:d?this.dummyFn:this.addCaseGroup,addDefaultCaseGroup:d?this.dummyFn:this.addDefaultCaseGroup,addRule:d?this.dummyFn:this.addRule,setField:d?this.dummyFn:this.setField,setFuncValue:d?this.dummyFn:this.setFuncValue,setOperator:d?this.dummyFn:this.setOperator,setValue:d?this.dummyFn:this.setValue,value:this.props.value||null,valueError:this.props.valueError||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:f,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(m.Component),r.propTypes={config:R().object.isRequired,actions:R().object.isRequired,path:R().any.isRequired,id:R().string.isRequired,groupId:R().string,not:R().bool,conjunction:R().string,children1:R().any,onDragStart:R().func,reordableNodesCnt:R().number,field:R().any,fieldSrc:R().string,fieldType:R().string,parentField:R().string,valueError:R().any,isLocked:R().bool,isTrueLocked:R().bool,dragging:R().object,isDraggingTempo:R().bool},r};const ba=function(n,e){var t=Za(function(r){return{dragging:r.dragging}},null,null,{context:ya})(u0(n,e));return t.displayName="ConnectedGroupContainer",t};function l0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,ef()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function ef(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ef=function(){return!!n})()}var s0={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},c0="topRight",rf=function(n){function e(){return(0,ze.A)(this,e),l0(this,e,arguments)}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.addGroup,i=r.removeSelf,l=r.setLock,s=r.isLocked,c=r.isTrueLocked,d=r.id,f=r.canAddGroup,p=r.canAddRule,v=r.canDeleteGroup,g=a.settings,h=g.immutableGroupsMode,b=g.addRuleLabel,O=g.addGroupLabel,S=g.delGroupLabel,A=g.groupActionsPosition,L=g.renderButton,F=g.renderIcon,P=g.renderSwitch,N=g.renderButtonGroup,k=g.lockLabel,I=g.lockedLabel,B=g.showLock,U=g.canDeleteLocked,x=function(te){return F(te,a.ctx)},X=function(te){return L(te,a.ctx)},W=function(te){return P(te,a.ctx)},J=function(te){return N(te,a.ctx)},G=s0[A||c0],ee=B&&!(s&&!c)&&m.createElement(W,{type:"lock",id:d,value:s,setValue:l,label:k,checkedLabel:I,config:a}),ie=!h&&p&&!s&&m.createElement(X,{type:"addRule",onClick:o,label:b,readonly:s,config:a,renderIcon:x}),de=!h&&f&&!s&&m.createElement(X,{type:"addGroup",onClick:u,label:O,readonly:s,config:a,renderIcon:x}),fe=!h&&v&&(!s||s&&U)&&m.createElement(X,{type:"delGroup",onClick:i,label:S,config:a,renderIcon:x});return m.createElement("div",{className:"group--actions ".concat(G)},m.createElement(J,{config:a},ee,ie,de,fe))}}])}(m.PureComponent);function tf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function nf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?tf(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):tf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function d0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,af()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function af(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(af=function(){return!!n})()}var f0=qe.RuleUtils.isEmptyGroupChildren,p0="topRight",zt=function(n){function e(t){var r;return(0,ze.A)(this,e),r=d0(this,e,[t]),r.childrenClassName=function(){return""},r.renderBeforeActions=function(){var a=r.props.config.settings.renderBeforeActions;return a==null?null:typeof a=="function"?a(r.props,r.props.config.ctx):a},r.renderAfterActions=function(){var a=r.props.config.settings.renderAfterActions;return a==null?null:typeof a=="function"?a(r.props,r.props.config.ctx):a},r.removeSelf=r.removeSelf.bind(r),r.setLock=r.setLock.bind(r),r.renderItem=r.renderItem.bind(r),r}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"isGroupTopPosition",value:function(){return a0()(this.props.config.settings.groupActionsPosition||p0,"top")}},{key:"setLock",value:function(r){this.props.setLock(r)}},{key:"removeSelf",value:function(){var r=this,a=this.props,o=a.confirmFn,u=a.config,i=u.settings,l=i.renderConfirm,s=i.removeGroupConfirmOptions,c=function(){r.props.removeSelf()};s&&!this.isEmptyCurrentGroup()?l.call(u.ctx,nf(nf({},s),{},{onOk:c,onCancel:null,confirmFn:o}),u.ctx):c()}},{key:"isEmptyCurrentGroup",value:function(){var r=this.props,a=r.children1,o=r.config;return f0(a,o)}},{key:"render",value:function(){return m.createElement(m.Fragment,null,this.renderHeaderWrapper(),this.renderChildrenWrapper(),this.renderFooterWrapper())}},{key:"showNot",value:function(){var r=this.props.config;return r.settings.showNot}},{key:"showConjs",value:function(){var r=this.props,a=r.conjunctionOptions,o=r.children1,u=r.config,i=Object.keys(a).length;return i>1||this.showNot()}},{key:"isNoChildren",value:function(){var r=this.props.children1;return r?r.size==0:!0}},{key:"isOneChild",value:function(){var r=this.props.children1;return r?r.size<2:!0}},{key:"renderChildrenWrapper",value:function(){var r=this.props.children1;return r&&m.createElement("div",{key:"group-children",className:Pt()("group--children",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isOneChild()?"one--child":"",this.childrenClassName())},this.renderChildren())}},{key:"renderHeaderWrapper",value:function(){var r=this.isGroupTopPosition();return m.createElement("div",{key:"group-header",className:Pt()("group--header",this.isOneChild()?"one--child":"",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"")},this.renderHeader(),r&&this.renderBeforeActions(),r&&this.renderActions(),r&&this.renderAfterActions())}},{key:"renderFooterWrapper",value:function(){var r=this.isGroupTopPosition();return!r&&m.createElement("div",{key:"group-footer",className:"group--footer"},this.renderBeforeActions(),this.renderActions(),this.renderAfterActions())}},{key:"renderActions",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.addGroup,i=r.isLocked,l=r.isTrueLocked,s=r.id;return m.createElement(rf,{config:a,addRule:o,addGroup:u,canAddGroup:this.canAddGroup(),canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:i,isTrueLocked:l,id:s})}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var r=this.props.config.settings.maxNumberOfRules,a=this.props.totalRulesCnt;return r?a<r:!0}},{key:"canDeleteGroup",value:function(){return!this.props.isRoot}},{key:"renderChildren",value:function(){var r=this.props.children1;return r?r.valueSeq().map(this.renderItem).toArray():null}},{key:"renderItem",value:function(r){if(r){var a=this.props,o=a.config,u=a.actions,i=a.onDragStart,l=a.isLocked,s=r.get("type")=="group"&&r.getIn(["properties","field"])!=null,c=s?"rule_group":r.get("type");return m.createElement(Ji,(0,dr.A)({},this.extraPropsForItem(r),{key:r.get("id"),id:r.get("id"),groupId:a.id,path:r.get("path"),type:c,properties:r.get("properties"),config:o,actions:u,children1:r.get("children1"),reordableNodesCnt:this.reordableNodesCntForItem(r),totalRulesCnt:this.totalRulesCntForItem(r),parentReordableNodesCnt:this.reordableNodesCnt(),onDragStart:i,isDraggingTempo:this.props.isDraggingTempo,isParentLocked:l}))}}},{key:"extraPropsForItem",value:function(r){return{}}},{key:"reordableNodesCnt",value:function(){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(r){return this.props.totalRulesCnt}},{key:"reordableNodesCntForItem",value:function(r){return this.props.isLocked?0:this.reordableNodesCnt()}},{key:"showDragIcon",value:function(){var r=this.props,a=r.config,o=r.isRoot,u=r.isLocked,i=this.reordableNodesCnt();return a.settings.canReorder&&!o&&i>1&&!u}},{key:"renderDrag",value:function(){var r=this.props.handleDraggerMouseDown,a=this.props.config,o=a.settings.renderIcon,u=function(s){return o?.(s,a.ctx)},i=m.createElement(u,{type:"drag"});return this.showDragIcon()&&m.createElement("div",{key:"group-drag-icon",onMouseDown:r,className:"qb-drag-handler group--drag-handler"},i)}},{key:"conjunctionOptions",value:function(){var r=this.props.conjunctionOptions;return r}},{key:"renderConjs",value:function(){var r=this.props,a=r.config,o=r.children1,u=r.id,i=r.selectedConjunction,l=r.setConjunction,s=r.not,c=r.setNot,d=r.isLocked,f=a.settings,p=f.immutableGroupsMode,v=f.renderConjs,g=f.showNot,h=f.notLabel,b=this.conjunctionOptions();if(!this.showConjs()||!o||!o.size)return null;var O={disabled:this.isOneChild(),readonly:p||d,selectedConjunction:i,setConjunction:p?pt:l,conjunctionOptions:b,config:a,not:s||!1,id:u,setNot:p?pt:c,notLabel:h,showNot:this.showNot(),isLocked:d};return v(O,a.ctx)}},{key:"renderHeader",value:function(){return m.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}}])}(m.Component);zt.propTypes={reordableNodesCnt:R().number,conjunctionOptions:R().object.isRequired,allowFurtherNesting:R().bool.isRequired,isRoot:R().bool.isRequired,not:R().bool,selectedConjunction:R().string,config:R().object.isRequired,id:R().string.isRequired,groupId:R().string,path:R().any,children1:R().any,isDraggingMe:R().bool,isDraggingTempo:R().bool,isLocked:R().bool,isTrueLocked:R().bool,handleDraggerMouseDown:R().func,onDragStart:R().func,addRule:R().func.isRequired,addGroup:R().func.isRequired,removeSelf:R().func.isRequired,setConjunction:R().func.isRequired,setNot:R().func.isRequired,setLock:R().func.isRequired,actions:R().object.isRequired};const v0=ba(ra("group")(na(zt)),"group");function g0(n,e){for(;!{}.hasOwnProperty.call(n,e)&&(n=(0,Ae.A)(n))!==null;);return n}function ln(){return ln=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(n,e,t){var r=g0(n,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(arguments.length<3?n:t):a.value}},ln.apply(null,arguments)}function m0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,of()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function of(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(of=function(){return!!n})()}var h0=function(n){function e(){return(0,ze.A)(this,e),m0(this,e,arguments)}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.canAddRule,i=r.canDeleteGroup,l=r.removeSelf,s=r.setLock,c=r.isLocked,d=r.isTrueLocked,f=r.id,p=a.settings,v=p.immutableGroupsMode,g=p.addRuleLabel,h=p.delGroupLabel,b=p.renderButton,O=p.renderIcon,S=p.renderSwitch,A=p.renderButtonGroup,L=p.lockLabel,F=p.lockedLabel,P=p.showLock,N=p.canDeleteLocked,k=function(G){return O(G,a.ctx)},I=function(G){return b(G,a.ctx)},B=function(G){return S(G,a.ctx)},U=function(G){return A(G,a.ctx)},x=P&&!(c&&!d)&&m.createElement(B,{type:"lock",id:f,value:c,setValue:s,label:L,checkedLabel:F,hideLabel:!0,config:a}),X=!v&&u&&!c&&m.createElement(I,{type:"addRuleGroup",onClick:o,label:g,readonly:c,config:a,renderIcon:k}),W=!v&&i&&(!c||c&&N)&&m.createElement(I,{type:"delRuleGroup",onClick:l,label:h,config:a,renderIcon:k});return m.createElement("div",{className:"group--actions"},m.createElement(U,{config:a},x,X,W))}}])}(m.PureComponent);function uf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function lf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?uf(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):uf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function y0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,sf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function sf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sf=function(){return!!n})()}var cf=function(n){function e(t){var r;return(0,ze.A)(this,e),r=y0(this,e,[t]),r.childrenClassName=function(){return"rule_group--children"},r.renderHeaderWrapper=function(){return null},r.renderFooterWrapper=function(){return null},r.renderConjs=function(){return null},r.canAddGroup=function(){return!1},r.canAddRule=function(){return!0},r.canDeleteGroup=function(){return!1},Xr(r),r.onPropsChanged(t),r}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"onPropsChanged",value:function(r){}},{key:"reordableNodesCntForItem",value:function(r){if(this.props.isLocked)return 0;var a=this.props.children1;return a?.size||0}},{key:"renderChildrenWrapper",value:function(){return m.createElement(m.Fragment,null,this.renderDrag(),this.renderField(),this.renderActions(),ln((0,Ae.A)(e.prototype),"renderChildrenWrapper",this).call(this))}},{key:"renderField",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedFieldSrc,i=r.selectedFieldType,l=r.setField,s=r.setFuncValue,c=r.setFieldSrc,d=r.parentField,f=r.id,p=r.groupId,v=r.isLocked,g=a.settings.immutableFieldsMode;return m.createElement(zi,{key:"field",classname:"group--field",config:a,canSelectFieldSource:!1,selectedField:o,selectedFieldSrc:u,selectedFieldType:i,setField:l,setFuncValue:s,setFieldSrc:c,parentField:d,readonly:g||v,id:f,groupId:p})}},{key:"renderActions",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.isLocked,i=r.isTrueLocked,l=r.id;return m.createElement(h0,{config:a,addRule:o,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:u,isTrueLocked:i,id:l})}},{key:"extraPropsForItem",value:function(r){return{parentField:this.props.selectedField}}}])}(zt);cf.propTypes=lf(lf({},zt.propTypes),{},{selectedField:R().any,selectedFieldSrc:R().string,parentField:R().string,setField:R().func,setFieldSrc:R().func});const O0=ba(ra("group rule_group")(na(cf)),"rule_group");function b0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,df()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function df(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(df=function(){return!!n})()}var S0=function(n){function e(){return(0,ze.A)(this,e),b0(this,e,arguments)}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.canAddRule,i=r.canDeleteGroup,l=r.removeSelf,s=r.setLock,c=r.isLocked,d=r.isTrueLocked,f=r.id,p=a.settings,v=p.immutableGroupsMode,g=p.addSubRuleLabel,h=p.delGroupLabel,b=p.renderButton,O=p.renderIcon,S=p.renderSwitch,A=p.renderButtonGroup,L=p.lockLabel,F=p.lockedLabel,P=p.showLock,N=p.canDeleteLocked,k=function(G){return O(G,a.ctx)},I=function(G){return b(G,a.ctx)},B=function(G){return S(G,a.ctx)},U=function(G){return A(G,a.ctx)},x=P&&!(c&&!d)&&m.createElement(B,{type:"lock",id:f,value:c,setValue:s,label:L,checkedLabel:F,config:a}),X=!v&&u&&!c&&m.createElement(I,{type:"addRuleGroupExt",onClick:o,label:g,readonly:c,config:a,renderIcon:k}),W=!v&&i&&(!c||c&&N)&&m.createElement(I,{type:"delRuleGroup",onClick:l,label:h,config:a,renderIcon:k});return m.createElement("div",{className:"group--actions group--actions--tr"},m.createElement(U,{config:a},x,X,W))}}])}(m.PureComponent);function ff(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function pf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ff(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ff(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function F0(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=E0(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function E0(n,e){if(n){if(typeof n=="string")return vf(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return vf(n,e)}}function vf(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function C0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,gf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function gf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gf=function(){return!!n})()}var mf=qe.ConfigUtils,hf=mf.getFieldConfig,T0=mf.getFieldWidgetConfig,A0=qe.RuleUtils.isEmptyRuleGroupExtPropertiesAndChildren,yf=function(n){function e(t){var r;return(0,ze.A)(this,e),r=C0(this,e,[t]),r.childrenClassName=function(){return"rule_group_ext--children"},r.renderFooterWrapper=function(){return null},r.canAddGroup=function(){return!1},r.canAddRule=function(){return!0},r.canDeleteGroup=function(){return!0},Xr(r),r.onPropsChanged(t),r}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"onPropsChanged",value:function(r){}},{key:"renderHeaderWrapper",value:function(){return m.createElement("div",{key:"group-header",className:Pt()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()&&(!this.isOneChild()||this.showNot())?"with--conjs":"hide--conjs")},this.renderHeader(),this.renderGroupField(),this.renderActions())}},{key:"renderHeader",value:function(){return m.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderGroupField",value:function(){return m.createElement("div",{className:"group--field--count--rule"},this.renderField(),this.renderOperator(),this.renderWidget(),this.renderError())}},{key:"renderError",value:function(){var r=this.props,a=r.config,o=r.valueError,u=a.settings,i=u.renderRuleError,l=u.showErrorMessage,s=(0,Se.A)(o?.toArray()||[]).filter(function(c){return!!c}).shift()||null;return l&&s&&m.createElement("div",{className:"rule_group--error"},i?i({error:s},a.ctx):s)}},{key:"showNot",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedOperator,i=hf(a,o)||{};return i.showNot!=null?i.showNot:a.settings.showNot}},{key:"conjunctionOptions",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedOperator,i=hf(a,o)||{},l=ln((0,Ae.A)(e.prototype),"conjunctionOptions",this).call(this);if(i.conjunctions){var s={},c=F0(i.conjunctions),d;try{for(c.s();!(d=c.n()).done;){var f=d.value,p=l[f];p&&(s[f]=p)}}catch(v){c.e(v)}finally{c.f()}l=s}return l}},{key:"renderField",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedFieldSrc,i=r.selectedFieldType,l=r.setField,s=r.setFieldSrc,c=r.setFuncValue,d=r.parentField,f=r.id,p=r.groupId,v=r.isLocked,g=a.settings.immutableFieldsMode;return m.createElement(zi,{key:"field",classname:"rule--field",config:a,canSelectFieldSource:!1,selectedField:o,selectedFieldSrc:u,selectedFieldType:i,setField:l,setFuncValue:c,setFieldSrc:s,parentField:d,readonly:g||v,id:f,groupId:p})}},{key:"renderOperator",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedFieldSrc,i=r.selectedOperator,l=r.setField,s=r.setOperator,c=r.isLocked,d=a.settings.immutableFieldsMode,f=T0(a,o,i)||{},p=f.hideOperator,v=o&&p&&f.operatorInlineLabel,g=o&&!p;return m.createElement(Sd,{key:"operator",classname:"group--operator",config:a,selectedField:o,selectedFieldSrc:u,selectedOperator:i,setOperator:s,selectedFieldPartsLabels:["group"],showOperator:g,showOperatorLabel:v,selectedFieldWidgetConfig:f,readonly:d||c,id:this.props.id,groupId:this.props.groupId})}},{key:"isEmptyCurrentGroup",value:function(){var r=this.props,a=r.children1,o=r.config,u=this._buildWidgetProps(this.props);return A0(u,a,o)}},{key:"_buildWidgetProps",value:function(r){var a=r.selectedField,o=r.selectedFieldSrc,u=r.selectedFieldType,i=r.selectedOperator,l=r.operatorOptions,s=r.value,c=r.valueType,d=r.valueSrc,f=r.asyncListValues,p=r.valueError,v=r.fieldError,g=r.parentField;return{field:a,fieldSrc:o,fieldType:u,operator:i,operatorOptions:l,value:s,valueType:c,valueSrc:["value"],valueError:p,fieldError:null,parentField:g}}},{key:"renderWidget",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedOperator,i=r.isLocked,l=a.settings.immutableValuesMode,s=o&&u,c=s;if(!c)return null;var d=m.createElement(Oa,(0,dr.A)({key:"values",isForRuleGroup:!0},this._buildWidgetProps(this.props),{config:a,setValue:l?pt:this.props.setValue,setValueSrc:pt,readonly:l||i,id:this.props.id,groupId:this.props.groupId}));return m.createElement($r,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},d)}},{key:"renderActions",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.isLocked,i=r.isTrueLocked,l=r.id;return m.createElement(S0,{config:a,addRule:o,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:u,isTrueLocked:i,id:l})}},{key:"reordableNodesCntForItem",value:function(r){if(this.props.isLocked)return 0;var a=this.props.children1;return a?.size||0}},{key:"extraPropsForItem",value:function(r){return{parentField:this.props.selectedField}}}])}(zt);yf.propTypes=pf(pf({},zt.propTypes),{},{selectedField:R().any,selectedFieldSrc:R().string,selectedOperator:R().string,value:R().any,parentField:R().string,setField:R().func,setFieldSrc:R().func,setOperator:R().func,setValue:R().func,valueError:R().any});const L0=ba(ra("group rule_group_ext")(na(yf)),"rule_group");function w0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Of()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Of(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Of=function(){return!!n})()}var R0={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},P0="topRight",j0=function(n){function e(){return(0,ze.A)(this,e),w0(this,e,arguments)}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,o=r.addCaseGroup,u=r.addDefaultCaseGroup,i=r.setLock,l=r.isLocked,s=r.isTrueLocked,c=r.id,d=r.canAddGroup,f=r.canAddDefault,p=a.settings,v=p.immutableGroupsMode,g=p.addCaseLabel,h=p.addDefaultCaseLabel,b=p.groupActionsPosition,O=p.renderButton,S=p.renderIcon,A=p.renderSwitch,L=p.renderButtonGroup,F=p.lockLabel,P=p.lockedLabel,N=p.showLock,k=function(ee){return S(ee,a.ctx)},I=function(ee){return O(ee,a.ctx)},B=function(ee){return A(ee,a.ctx)},U=function(ee){return L(ee,a.ctx)},x=R0[b||P0],X=N&&!(l&&!s)&&m.createElement(B,{type:"lock",id:c,value:l,setValue:i,label:F,checkedLabel:P,config:a}),W=!v&&d&&!l&&m.createElement(I,{type:"addCaseGroup",onClick:o,label:g,readonly:l,config:a,renderIcon:k}),J=!v&&f&&!l&&m.createElement(I,{type:"addDefaultCaseGroup",onClick:u,label:h,readonly:l,config:a,renderIcon:k});return m.createElement("div",{className:"group--actions ".concat(x)},m.createElement(U,{config:a},X,W,J))}}])}(m.PureComponent);function bf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function I0(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?bf(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):bf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function V0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Sf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Sf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Sf=function(){return!!n})()}var Ff=qe.TreeUtils,D0=Ff.getTotalReordableNodesCountInTree,N0=Ff.getTotalRulesCountInTree,Ef=function(n){function e(t){var r;return(0,ze.A)(this,e),r=V0(this,e,[t]),r.childrenClassName=function(){return"switch_group--children"},r.renderFooterWrapper=function(){return null},r.hasDefaultCase=function(){var a;return((a=r.props.children1)===null||a===void 0?void 0:a.size)&&r.props.children1.filter(function(o){return o.get("children1")==null}).size>0},Xr(r),r.onPropsChanged(t),r}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"onPropsChanged",value:function(r){}},{key:"canAddGroup",value:function(){var r,a=this.props.config.settings.maxNumberOfCases,o=((r=this.props.children1)===null||r===void 0?void 0:r.size)||0;return a?o<a:!0}},{key:"canAddRule",value:function(){return!1}},{key:"reordableNodesCnt",value:function(){var r,a=((r=this.props.children1)===null||r===void 0?void 0:r.size)||0,o=a;return this.hasDefaultCase()&&o--,o}},{key:"totalRulesCntForItem",value:function(r){return N0(r)}},{key:"reordableNodesCntForItem",value:function(r){var a;if(this.props.isLocked)return 0;var o=this.props.config.settings,u=o.canLeaveEmptyCase,i=o.canRegroupCases,l=((a=this.props.children1)===null||a===void 0?void 0:a.size)||0,s=l;this.hasDefaultCase()&&s--;var c=D0(r),d=c;return d==1&&i&&u&&s>1&&(d=111),d}},{key:"renderHeaderWrapper",value:function(){return m.createElement("div",{key:"group-header",className:Pt()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag")},this.renderHeader(),this.renderActions())}},{key:"renderHeader",value:function(){return m.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderConjs",value:function(){var r=this.props.config,a=r.settings.renderSwitchPrefix;return a||null}},{key:"showNot",value:function(){return!1}},{key:"renderActions",value:function(){var r=this.props,a=r.config,o=r.addCaseGroup,u=r.addDefaultCaseGroup,i=r.isLocked,l=r.isTrueLocked,s=r.id;return m.createElement(j0,{config:a,addCaseGroup:o,addDefaultCaseGroup:u,canAddDefault:!this.hasDefaultCase(),canAddGroup:this.canAddGroup(),setLock:this.setLock,isLocked:i,isTrueLocked:l,id:s})}}])}(zt);Ef.propTypes=I0({},zt.propTypes);const x0=ba(ra("group switch_group")(na(Ef)),"switch_group");function Cf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Tf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Cf(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Cf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function k0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Af()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Af(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Af=function(){return!!n})()}var Lf=function(n){function e(t){var r;return(0,ze.A)(this,e),r=k0(this,e,[t]),r.childrenClassName=function(){return"case_group--children"},r.renderFooterWrapper=function(){return null},Xr(r),r.onPropsChanged(t),r}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"onPropsChanged",value:function(r){}},{key:"isDefaultCase",value:function(){return this.props.children1==null}},{key:"reordableNodesCnt",value:function(){return this.props.parentReordableNodesCnt}},{key:"reordableNodesCntForItem",value:function(r){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(r){return this.props.totalRulesCnt}},{key:"showDragIcon",value:function(){return this.isDefaultCase()?!1:ln((0,Ae.A)(e.prototype),"showDragIcon",this).call(this)}},{key:"renderHeaderWrapper",value:function(){return m.createElement("div",{key:"group-header",className:Pt()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()&&(!this.isOneChild()||this.showNot())?"with--conjs":"hide--conjs")},this.renderHeaderLeft(),this.renderHeaderCenter(),this.renderActions())}},{key:"renderChildrenWrapper",value:function(){return this.isDefaultCase()?null:m.createElement("div",{className:"case_group--body"},this.renderCondition(),this.renderValue())}},{key:"renderHeaderLeft",value:function(){if(this.isDefaultCase()){var r=this.props.config.settings.defaultCaseLabel;return r||""}return m.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderCondition",value:function(){return this.isDefaultCase()?null:ln((0,Ae.A)(e.prototype),"renderChildrenWrapper",this).call(this)}},{key:"renderHeaderCenter",value:function(){return this.isDefaultCase()?this.renderValue():null}},{key:"canAddGroup",value:function(){return this.isDefaultCase()?!1:ln((0,Ae.A)(e.prototype),"canAddGroup",this).call(this)}},{key:"canAddRule",value:function(){return this.isDefaultCase()?!1:ln((0,Ae.A)(e.prototype),"canAddRule",this).call(this)}},{key:"renderValue",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=r.value,i=r.setValue,l=r.id,s=a.settings.immutableValuesMode,c=m.createElement(Oa,{key:"values",isCaseValue:!0,field:"!case_value",operator:null,value:u,valueSrc:"value",valueError:null,fieldError:null,config:a,setValue:s?pt:i,setValueSrc:pt,readonly:s||o,id:l,groupId:null});return m.createElement($r,{className:"case_group--value"},c)}},{key:"renderActions",value:function(){var r=this.props,a=r.config,o=r.addGroup,u=r.addRule,i=r.isLocked,l=r.isTrueLocked,s=r.id;return m.createElement(rf,{config:a,addGroup:o,addRule:u,canAddRule:this.canAddRule(),canAddGroup:this.canAddGroup(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:i,isTrueLocked:l,id:s})}},{key:"isEmptyCurrentGroup",value:function(){var r=this.props.value,a=r&&r.size?r.get(0):null,o=a!=null&&(Array.isArray(a)?a.length>0:!0);return ln((0,Ae.A)(e.prototype),"isEmptyCurrentGroup",this).call(this)&&!o}}])}(zt);Lf.propTypes=Tf(Tf({},zt.propTypes),{},{parentReordableNodesCnt:R().number,value:R().any,setValue:R().func});const M0=ba(ra("group case_group")(na(Lf)),"case_group");var _0=["type"];function G0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,wf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function wf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wf=function(){return!!n})()}function Rf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function qi(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Rf(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Rf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var $0=["rule","group","rule_group","switch_group","case_group"],aa=function(e){var t,r=((t=e.properties)===null||t===void 0?void 0:t.toObject())||{},a=qi({},r);return e.isParentLocked&&(a.isLocked=!0),r.isLocked&&(a.isTrueLocked=!0),a},U0={rule:function(e){return m.createElement(t0,(0,dr.A)({},aa(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,config:e.config,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},group:function(e){return m.createElement(v0,(0,dr.A)({},aa(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group:function(e){return m.createElement(O0,(0,dr.A)({},aa(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group_ext:function(e){return m.createElement(L0,(0,dr.A)({},aa(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},switch_group:function(e){return m.createElement(x0,(0,dr.A)({},aa(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},case_group:function(e){return m.createElement(M0,(0,dr.A)({},aa(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))}},Ji=function(n){function e(){return(0,ze.A)(this,e),G0(this,e,arguments)}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"render",value:function(){var r,a=this.props,o=a.type,u=(0,Yn.A)(a,_0),i=(r=u.properties)===null||r===void 0?void 0:r.get("mode"),l=i=="array"?"_ext":"",s=u.config.settings.renderItem,c=U0[o+l];return s?s(qi(qi({},u),{},{type:o,itemComponent:c}),u.config.ctx):c?c(u):null}}])}(m.PureComponent);Ji.propTypes={config:R().object.isRequired,id:R().string.isRequired,groupId:R().string,type:R().oneOf($0).isRequired,path:R().any.isRequired,properties:R().any,children1:R().any,actions:R().object.isRequired,reordableNodesCnt:R().number,onDragStart:R().func,parentField:R().string,isDraggingTempo:R().bool,isParentLocked:R().bool};function B0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Pf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Pf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pf=function(){return!!n})()}var jf=qe.TreeUtils,W0=jf.getTotalReordableNodesCountInTree,K0=jf.getTotalRulesCountInTree,If=qe.DefaultUtils,H0=If.createListFromArray,Vf=If.emptyProperties,Df=function(n){function e(t){var r;return(0,ze.A)(this,e),r=B0(this,e,[t]),r.pureShouldComponentUpdate=ea(r),r._updPath(t),r}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"shouldComponentUpdate",value:function(r,a){var o=this.props,u=this.pureShouldComponentUpdate(r,a);if(u){var i=[];for(var l in r){var s=r[l]!==o[l];s&&l!="__isInternalValueChange"&&i.push(l)}i.length||(u=!1),i.length==1&&i[0]=="tree"&&r.__isInternalValueChange&&(u=!1)}return u}},{key:"_updPath",value:function(r){var a=r.tree.get("id");this.path=H0([a])}},{key:"render",value:function(){var r=this.props,a=r.tree,o=r.config,u=r.actions,i=r.onDragStart,l=a.get("type"),s=l=="switch_group",c=s?null:W0(a),d=s?null:K0(a),f=a.get("id");return m.createElement(Ji,{key:f,id:f,path:this.path,type:l,properties:a.get("properties")||Vf(),config:o,actions:u,children1:a.get("children1")||Vf(),reordableNodesCnt:c,totalRulesCnt:d,parentReordableNodesCnt:0,onDragStart:i})}}])}(m.Component);Df.propTypes={tree:R().any.isRequired,config:R().object.isRequired,actions:R().object.isRequired,onDragStart:R().func};const z0=py(Df);function Nf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function q0(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Nf(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Nf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function J0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,xf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function xf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xf=function(){return!!n})()}var Q0=qe.clone,Qi=qe.ConfigUtils,Sa=Qi.getFieldConfig,kf=Qi.getFieldParts,Mf=Qi.getFieldPathParts,_f=qe.RuleUtils,Gf=_f.getFieldPathLabels,Y0=_f.getWidgetForFieldOp,$f=function(n){function e(t){var r;return(0,ze.A)(this,e),r=J0(this,e,[t]),Xr(r),r.onPropsChanged(t),r}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["config","field","fieldSrc","fieldType","operator","isFuncArg","parentField"],u=["config","field","fieldSrc","fieldType","operator","value","placeholder","isFuncArg","parentField"],i=!this.items||o.map(function(s){return r[s]!==a[s]}).filter(function(s){return s}).length>0,l=!this.meta||u.map(function(s){return r[s]!==a[s]}).filter(function(s){return s}).length>0;i&&(this.items=this.getItems(r)),l&&(this.meta=this.getMeta(r))}},{key:"getItems",value:function(r){var a=r.config,o=r.field,u=r.fieldType,i=r.operator,l=r.parentField,s=r.isFuncArg,c=r.fieldDefinition,d=a.settings.canCompareFieldWithField,f=a.settings.fieldSeparator,p=kf(l,a),v=l?Sa(a,l):null,g=l?v?.subfields:a.fields,h=this.filterFields(a,g,o,l,p,i,d,s,c,u),b=this.buildOptions(p,a,h,p);return b}},{key:"getMeta",value:function(r){var a,o=r.config,u=r.field,i=r.fieldType,l=r.operator,s=r.value,c=r.placeholder,d=r.isFuncArg,f=r.parentField,p=o.settings,v=p.fieldPlaceholder,g=p.fieldSeparatorDisplay,h=s,b=!!s,O=u?Sa(o,u):{},S=O==null||(a=O.widgets)===null||a===void 0?void 0:a.field,A=S?.widgetProps||{},L=b?null:d&&c||A.valuePlaceholder||v,F=b?Sa(o,h):null,P=F||{},N=Mf(h,o),k=Mf(h,o,!0),I=this.getFieldLabel(F,h,o),B=Gf(h,o),U=B?B.join(g):null;(U==I||f)&&(U=null);var x=P.label2;return{placeholder:L,selectedKey:h,selectedKeys:N,selectedPath:k,selectedLabel:I,selectedOpts:P,selectedAltLabel:x,selectedFullLabel:U}}},{key:"filterFields",value:function(r,a,o,u,i,l,s,c,d,f){a=Q0(a);var p=r.settings.fieldSeparator,v=Sa(r,o),g=!1,h=Y0(r,o,l,"value"),b=r.widgets[h],O;c?O=d?.type:g&&b?O=b.type:v?O=v.type:O=f;function S(A,L){for(var F in A){var P=A[F].subfields,N=(L||[]).concat(F),k=N.join(p),I=Sa(r,k);if(!I)delete A[F];else if(I.type=="!struct"||I.type=="!group")S(P,N)==0&&delete A[F];else{var B=(!O||I.type==O)&&(c?!0:k!=o),U=s||r.settings.canCompareFieldWithField;U&&(B=B&&U(o,v,k,I,l)),B||delete A[F]}}return ta()(A).length}return S(a,i||[]),a}},{key:"buildOptions",value:function(r,a,o){var u=this,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!o)return null;var s=a.settings,c=s.fieldSeparator,d=s.fieldSeparatorDisplay,f=i!=null&&i.length?i.join(c)+c:"";return ta()(o).map(function(p){var v=[].concat((0,Se.A)(i??[]),[p]),g=o[p],h=u.getFieldLabel(g,v,a),b=Gf(v,a),O=b.join(d);(O==h||r)&&(O=null);var S=g.label2,A=g.tooltip;if(!g.hideForCompare)return g.type=="!struct"||g.type=="!group"?{key:p,path:f+p,label:h,fullLabel:O,altLabel:S,tooltip:A,items:u.buildOptions(r,a,g.subfields,v,{label:h,tooltip:A})}:{key:p,path:f+p,label:h,fullLabel:O,altLabel:S,tooltip:A,grouplabel:l?.label,group:l}}).filter(function(p){return!!p})}},{key:"getFieldLabel",value:function(r,a,o){if(!a)return null;var u=o.settings.maxLabelsLength,i=kf(a,o),l=r?.label||ka()(i);return l=to(l,u),l}},{key:"render",value:function(){var r=this.props,a=r.config,o=r.customProps,u=r.setValue,i=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderField,d=q0({isValueField:!0,config:a,customProps:o,setField:u,readonly:i,items:this.items,id:l,groupId:s},this.meta);return c(d,a.ctx)}}])}(m.Component);$f.propTypes={id:R().string,groupId:R().string,setValue:R().func.isRequired,config:R().object.isRequired,field:R().any,fieldSrc:R().string,fieldType:R().string,value:R().string,operator:R().string,customProps:R().object,readonly:R().bool,parentField:R().string,fieldDefinition:R().object,isFuncArg:R().bool};const X0=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.labelYes,o=n.labelNo,u=n.readonly,i=n.widgetId,l=n.customProps,s=l===void 0?{}:l,c=s.radioYes||{},d=s.radioNo||{},f=function(g){return t(g.target.checked)},p=function(g){return t(g.target.value=="true")};return m.createElement(m.Fragment,null,m.createElement("input",(0,dr.A)({type:"radio",value:!0,checked:!!e,disabled:u,onChange:p},c))," ",a,m.createElement("input",(0,dr.A)({type:"radio",value:!1,checked:!e,disabled:u,onChange:p},d))," ",o)},Z0=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,o=n.placeholder,u=n.maxLength,i=n.customProps,l=function(d){var f=d.target.value;f===""&&(f=void 0),t(f)},s=e||"";return m.createElement("input",(0,dr.A)({type:"text",value:s,placeholder:o,disabled:a,onChange:l,maxLength:u},i))},eO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,o=n.placeholder,u=n.maxLength,i=n.maxRows,l=n.fullWidth,s=n.customProps,c=function(p){var v=p.target.value;v===""&&(v=void 0),t(v)},d=e||"";return m.createElement("textarea",(0,dr.A)({value:d,placeholder:o,disabled:a,onChange:c,maxLength:u,style:{width:l?"100%":void 0}},s))};var $b=qe.moment;const rO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.valueFormat,o=n.readonly,u=n.customProps,i=function(s){var c=s.target.value;c==""&&(c=void 0),t(c)};return m.createElement("input",(0,dr.A)({type:"date",value:e||"",disabled:o,onChange:i},u))},tO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.valueFormat,o=n.use12Hours,u=n.readonly,i=n.customProps,l=function(c){var d=c.target.value;d==""&&(d=void 0),t(d)};return m.createElement("input",(0,dr.A)({type:"time",value:e||"",disabled:u,onChange:l},i))};var Uf=qe.moment;const nO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.valueFormat,o=n.use12Hours,u=n.readonly,i=n.customProps,l=function(d){var f=d.target.value;f==""?f=void 0:f=Uf(new Date(f)).format(a),t(f)},s=e;return e?s=Uf(e).format("YYYY-MM-DDTHH:mm"):s="",m.createElement("input",(0,dr.A)({type:"datetime-local",value:s,disabled:u,onChange:l},i))};var aO=qe.ListUtils.mapListValues;const oO=function(n){var e=n.listValues,t=n.value,r=n.setValue,a=n.allowCustomValues,o=n.readonly,u=n.customProps,i=function(){return aO(e,function(d){var f=d.title,p=d.value;return m.createElement("option",{key:p,value:p},f)})},l=function(d){for(var f=[],p=d.options,v=0;v<p.length;v++){var g=p[v];g.selected&&f.push(g.value)}return f.length||(f=void 0),f},s=function(d){return r(l(d.target))};return m.createElement("select",(0,dr.A)({multiple:!0,onChange:s,value:t,disabled:o},Er()(u,["showSearch","input","showCheckboxes"])),i())};var iO=qe.ListUtils.mapListValues;const uO=function(n){var e=n.listValues,t=n.value,r=n.setValue,a=n.allowCustomValues,o=n.readonly,u=n.customProps,i=function(){return iO(e,function(d){var f=d.title,p=d.value;return m.createElement("option",{key:p,value:p},f)})},l=function(d){return r(d.target.value)},s=t!=null;return m.createElement("select",(0,dr.A)({onChange:l,value:s?t:"",disabled:o},Er()(u,["showSearch","input"])),!s&&m.createElement("option",{disabled:!0,value:""}),i())},lO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,o=n.min,u=n.max,i=n.step,l=n.placeholder,s=n.customProps,c=function(p){var v=p.target.value;v===""||v===null?v=void 0:v=Number(v),t(v)},d=e??"";return m.createElement("input",(0,dr.A)({type:"number",value:d,placeholder:l,disabled:a,min:o,max:u,step:i,onChange:c},s))},sO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,o=n.min,u=n.max,i=n.step,l=n.placeholder,s=n.customProps,c=s===void 0?{}:s,d=c.input||{},f=c.slider||c,p=function(h){var b=h.target.value;b===""||b===null?b=void 0:b=Number(b),t(b)},v=e??"";return m.createElement("div",{style:{display:"inline-flex"}},m.createElement("input",(0,dr.A)({key:"number",type:"number",value:v,placeholder:l,disabled:a,min:o,max:u,step:i,onChange:p},d)),m.createElement("input",(0,dr.A)({key:"range",type:"range",value:v,disabled:a,min:o,max:u,step:i,onChange:p},f)))},cO=function(n){var e=n.items,t=n.setField,r=n.selectedKey,a=n.readonly,o=n.errorText,u=function s(c){return c.map(function(d){var f=d.items,p=d.path,v=d.label,g=d.disabled,h=d.matchesType;if(f)return m.createElement("optgroup",{disabled:g,key:p,label:v},s(f));var b=h?{fontWeight:"bold"}:{};return m.createElement("option",{disabled:g,key:p,value:p,style:b},v)})},i=function(c){return t(c.target.value)},l=r!=null;return m.createElement("select",{onChange:i,value:l?r:"",disabled:a,style:{color:o?"red":null}},!l&&m.createElement("option",{disabled:!0,value:""}),u(e))},dO=function(n){var e=n.id,t=n.not,r=n.setNot,a=n.conjunctionOptions,o=n.setConjunction,u=n.disabled,i=n.readonly,l=n.config,s=n.showNot,c=n.notLabel,d=Object.keys(a).length,f=u,p=l.settings.forceShowConj,v=p||d>1&&!f,g=function(){return Object.keys(a).map(function(A){var L=a[A],F=L.id,P=L.name,N=L.label,k=L.checked,I=o.isDummyFn?"__dummy":"";return(i||u)&&!k?null:[m.createElement("input",{key:F+I,type:"radio",id:F+I,name:P+I,checked:k,disabled:i||u,value:A,onChange:b}),m.createElement("label",{key:F+I+"label",htmlFor:F+I},N)]})},h=function(){var A="not";return[m.createElement("input",{key:e+A,type:"checkbox",id:e+A,checked:t,disabled:i,onChange:O}),m.createElement("label",{key:e+A+"label",htmlFor:e+A},c||"NOT")]},b=function(A){return o(A.target.value)},O=function(A){return r(A.target.checked)};return[s&&h(),v&&g()]};var fO={addRuleGroup:"+",addRuleGroupExt:"+",delGroup:"x",delRuleGroup:"x",delRule:"x"};const pO=function(n){var e=n.type,t=n.label,r=n.onClick,a=n.readonly,o=t||fO[e];return m.createElement("button",{onClick:r,type:"button",disabled:a},o)},vO=function(n){var e=n.type,t={},r=t[e]||null;return!r&&e==="drag"&&(r=m.createElement(Od,null)),r},gO=function(n){var e=n.children,t=n.config;return m.createElement(m.Fragment,null,e)},mO=function(n){var e=n.config,t=n.valueSources,r=n.valueSrc,a=n.title,o=n.setValueSrc,u=n.readonly,i=function(c){return c.map(function(d){var f=(0,we.A)(d,2),p=f[0],v=f[1];return m.createElement("option",{key:p,value:p},v.label)})},l=function(c){return o(c.target.value)};return m.createElement("select",{onChange:l,value:r||"",disabled:u},i(t))},hO=function(n){var e=n.value,t=n.setValue,r=n.label,a=n.id,o=n.config,u=n.type,i=function(c){return t(c.target.checked)},l=u;return[m.createElement("input",{key:a+l,type:"checkbox",id:a+l,checked:!!e,onChange:i}),m.createElement("label",{key:a+l+"label",htmlFor:a+l},r)]},yO=function(n){var e=n.onOk,t=n.okText,r=n.cancelText,a=n.title;confirm(a)&&e()};var OO=function(e){var t=e.config,r=e.children;return r};function bO(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Bf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Bf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Bf=function(){return!!n})()}var Yi=function(n){function e(){var t;(0,ze.A)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=bO(this,e,[].concat(a)),t.handleChange=function(u){t.props.setOption("proximity",parseInt(u))},t}return(0,hr.A)(e,n),(0,mr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.defaults,o=r.options,u=r.config,i=r.optionLabel,l=r.optionPlaceholder,s=r.customProps,c=r.minProximity,d=r.maxProximity,f=r.optionTextBefore,p=r.readonly,v=u.settings,g=u.widgets,h=u.ctx,b=a?a.proximity:void 0,O=v.showLabels,S=o.get("proximity",b),A=$i()(c,d+1).map(function(P){return{title:P,value:P}}),L=g.select.factory,F=function(N){return L(N,h)};return m.createElement("div",{className:"operator--PROXIMITY"},m.createElement("div",{className:"operator--options"},O&&m.createElement("label",{className:"rule--label"},i),!O&&f&&m.createElement("div",{className:"operator--options--sep"},m.createElement("span",null,f)),m.createElement(F,(0,dr.A)({config:u,value:S,listValues:A,setValue:this.handleChange,readonly:p,placeholder:l},s))),m.createElement("div",{className:"operator--widgets"},this.props.children))}}])}(m.PureComponent);Yi.propTypes={config:R().object.isRequired,setOption:R().func.isRequired,options:R().any.isRequired,minProximity:R().number,maxProximity:R().number,optionPlaceholder:R().string,optionTextBefore:R().string,optionLabel:R().string,customProps:R().object,readonly:R().bool},Yi.defaultProps={customProps:{},minProximity:2,maxProximity:10,optionPlaceholder:"Select words between",optionLabel:"Words between",optionTextBefore:null};function Wf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ue(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Wf(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Wf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var SO=Ue({},Pr.conjunctions),FO=Ue(Ue({},Pr.operators),{},{proximity:Ue(Ue({},Pr.operators.proximity),{},{options:Ue(Ue({},Pr.operators.proximity.options),{},{factory:function(e,t){var r=t.RCE,a=t.O.ProximityOperator;return r(a,e)}})})}),EO={text:Ue(Ue({},Pr.widgets.text),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTextWidget;return r(a,e)}}),textarea:Ue(Ue({},Pr.widgets.textarea),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTextAreaWidget;return r(a,e)}}),number:Ue(Ue({},Pr.widgets.number),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaNumberWidget;return r(a,e)}}),slider:Ue(Ue({},Pr.widgets.slider),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaSliderWidget;return r(a,e)}}),select:Ue(Ue({},Pr.widgets.select),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaSelectWidget;return r(a,e)}}),multiselect:Ue(Ue({},Pr.widgets.multiselect),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaMultiSelectWidget;return r(a,e)}}),date:Ue(Ue({},Pr.widgets.date),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaDateWidget;return r(a,e)}}),time:Ue(Ue({},Pr.widgets.time),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTimeWidget;return r(a,e)}}),datetime:Ue(Ue({},Pr.widgets.datetime),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaDateTimeWidget;return r(a,e)}}),boolean:Ue(Ue({},Pr.widgets.boolean),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaBooleanWidget;return r(a,e)}}),field:Ue(Ue({},Pr.widgets.field),{},{factory:function(e,t){var r=t.RCE,a=t.W.ValueFieldWidget;return r(a,e)},customProps:{showSearch:!0}}),func:Ue(Ue({},Pr.widgets.func),{},{factory:function(e,t){var r=t.RCE,a=t.W.FuncWidget;return r(a,e)},customProps:{}}),case_value:Ue(Ue({},Pr.widgets.case_value),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTextWidget;return r(a,e)}})},CO=Ue(Ue({},Pr.types),{},{select:Ue(Ue({},Pr.types.select),{},{widgets:Ue(Ue({},Pr.types.select.widgets),{},{select:Ue(Ue({},Pr.types.select.widgets.select),{},{widgetProps:{customProps:{showSearch:!0}}})})})}),TO=Ue(Ue({},Pr.settings),{},{renderField:function(e,t){var r=t.RCE,a=t.W.VanillaFieldSelect;return r(a,e)},renderOperator:function(e,t){var r=t.RCE,a=t.W.VanillaFieldSelect;return r(a,e)},renderFunc:function(e,t){var r=t.RCE,a=t.W.VanillaFieldSelect;return r(a,e)},renderConjs:function(e,t){var r=t.RCE,a=t.W.VanillaConjs;return r(a,e)},renderSwitch:function(e,t){var r=t.RCE,a=t.W.VanillaSwitch;return r(a,e)},renderButton:function(e,t){var r=t.RCE,a=t.W.VanillaButton;return r(a,e)},renderIcon:function(e,t){var r=t.RCE,a=t.W.VanillaIcon;return r(a,e)},renderButtonGroup:function(e,t){var r=t.RCE,a=t.W.VanillaButtonGroup;return r(a,e)},renderProvider:function(e,t){var r=t.RCE,a=t.W.VanillaProvider;return r(a,e)},renderValueSources:function(e,t){var r=t.RCE,a=t.W.VanillaValueSources;return r(a,e)},renderFieldSources:function(e,t){var r=t.RCE,a=t.W.VanillaValueSources;return r(a,e)},renderConfirm:function(e,t){var r=t.W.vanillaConfirm;return r(e)},renderSwitchPrefix:"Conditions",customFieldSelectProps:{showSearch:!0},defaultSliderWidth:"200px",defaultSelectWidth:"200px",defaultSearchWidth:"100px",defaultMaxRows:5,renderSize:"small",maxLabelsLength:100,showLock:!1,showNot:!0,forceShowConj:!1,groupActionsPosition:"topRight"}),AO=Ue(Ue({},Pr.ctx),{},{W:Ue({},Ke),O:Ue({},Ie),RCE:function(e,t){return m.createElement(e,t)}}),Xi={conjunctions:SO,operators:FO,widgets:EO,types:CO,settings:TO,ctx:AO};Xi=qe.ConfigMixins.removeMixins(Xi,["rangeslider","treeselect","treemultiselect"]);const Ur=Xi;var Ub=y(38221);function Kf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function io(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Kf(Object(t),!0).forEach(function(r){_defineProperty(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Kf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Fa=qe.Autocomplete,uo=Fa.mergeListValues,Hf=Fa.listValueToOption,LO=Fa.optionToListValue,wO=Fa.optionsToListValues,RO=Fa.fixListValuesGroupOrder,oa=qe.ListUtils,PO=oa.mapListValues,lo=oa.listValuesToArray,so=oa.getListValue,jO=oa.makeCustomListValue,IO=oa.searchListValue,Bb=oa.getItemInListValues;function zf(n){return new Promise(function(e){setTimeout(e,n)})}var Wb=function(e,t){var r=e.asyncFetch,a=e.useLoadMore,o=e.useAsyncSearch,u=e.forceAsyncSearch,i=e.asyncListValues,l=e.listValues,s=e.allowCustomValues,c=e.value,d=e.setValue,f=e.placeholder,p=e.config,v=t.debounceTimeout,g=t.multiple,h=t.uif,b=t.isFieldAutocomplete,O=["LOAD_MORE","LOADING_MORE"],S="Load more...",A="Loading more...",L=u?"Type to search":f,F=React.useState(!1),P=_slicedToArray(F,2),N=P[0],k=P[1],I=React.useState(void 0),B=_slicedToArray(I,2),U=B[0],x=B[1],X=React.useState(0),W=_slicedToArray(X,2),J=W[0],G=W[1],ee=React.useState(!1),ie=_slicedToArray(ee,2),de=ie[0],fe=ie[1],ne=React.useState(""),te=_slicedToArray(ne,2),ve=te[0],se=te[1],ue=React.useState(void 0),Ce=_slicedToArray(ue,2),he=Ce[0],Pe=Ce[1],Ne=React.useRef(0),Be=React.useRef(0),Qe=React.useRef(!1),Je=React.useMemo(function(){return lo(i)},[i]),We=React.useMemo(function(){return r?i?uo(he,Je,!0):he:lo(l)},[r,i,he,l]),or=r?he:lo(l);s&&ve&&!IO(ve,he)&&(or=uo(or,[jO(ve)],!0)),r&&!he&&i&&!ve&&!N&&h==="antd"&&(or=We),r&&!s&&i&&h==="mui"&&(or=uo(or,Je,!0,!0));var ar=J>0,Ar=N&&r&&he===void 0&&(u?ve:!0),tr=Ar&&ar,st=!tr&&We&&We.length>0&&U&&U.hasMore&&(U.filter||"")===ve,Mt=!ar&&st,St=PO(or,Hf),Ft=c!=null,vt=!g&&Ft?so(c,We):null,_t=function(){var wr=_asyncToGenerator(_regeneratorRuntime.mark(function je(){var _e,Ze,ir,xr,kr,yr,Ct,Br,Jt,Qt,Tt,dn,Yt,$t,qr,lr=arguments;return _regeneratorRuntime.wrap(function(ct){for(;;)switch(ct.prev=ct.next){case 0:return _e=lr.length>0&&lr[0]!==void 0?lr[0]:null,Ze=lr.length>1&&lr[1]!==void 0?lr[1]:!1,!Ze&&U&&x(void 0),ir=Ze&&he?he.length:0,xr=Ze&&U||!a&&{pageSize:0},kr=++Ne.current,ct.next=8,r.call(p?.ctx,_e,ir,xr);case 8:if(yr=ct.sent,Ct=Ne.current!=kr,!(Ct||!Be.current)){ct.next=12;break}return ct.abrupt("return",null);case 12:return Br=yr!=null&&yr.values?yr:{values:yr},Jt=Br.values,Qt=Br.hasMore,Tt=Br.meta,dn=lo(Jt),Ze?($t=uo(he,dn,!1),Yt=$t.length>he.length):($t=dn,a&&(Yt=$t.length>0)),qr=Qt!=null||Tt!=null||Yt!=null?io(io(io(io({},Yt!=null?{hasMore:Yt}:{}),Qt!=null?{hasMore:Qt}:{}),Tt??{}),{},{filter:_e}):void 0,qr&&x(qr),ct.abrupt("return",$t);case 18:case"end":return ct.stop()}},je)}));return function(){return wr.apply(this,arguments)}}(),Gt=function(){var wr=_asyncToGenerator(_regeneratorRuntime.mark(function je(){var _e,Ze,ir,xr=arguments;return _regeneratorRuntime.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return _e=xr.length>0&&xr[0]!==void 0?xr[0]:null,Ze=xr.length>1&&xr[1]!==void 0?xr[1]:!1,G(function(Ct){return Ct+1}),fe(Ze),yr.next=6,_t(_e,Ze);case 6:if(ir=yr.sent,Be.current){yr.next=9;break}return yr.abrupt("return");case 9:ir!=null&&Pe(ir),G(function(Ct){return Ct-1}),fe(!1);case 12:case"end":return yr.stop()}},je)}));return function(){return wr.apply(this,arguments)}}(),tt=React.useCallback(debounce(Gt,v),[]);React.useEffect(function(){return Be.current++,Ar&&J==0&&Ne.current==0&&_asyncToGenerator(_regeneratorRuntime.mark(function wr(){return _regeneratorRuntime.wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:return _e.next=2,Gt();case 2:case"end":return _e.stop()}},wr)}))(),function(){Be.current--}},[Ar]);var Hr=function(){k(!0)},sn=function(){var wr=_asyncToGenerator(_regeneratorRuntime.mark(function je(_e){var Ze,ir;return _regeneratorRuntime.wrap(function(kr){for(;;)switch(kr.prev=kr.next){case 0:if(Ze=Qe.current,Ze?(Qe.current=!1,g&&k(!1)):k(!1),!(h==="mui"&&!Ze)){kr.next=6;break}return ir="",kr.next=6,rr(null,ir,"my-reset");case 6:case"end":return kr.stop()}},je)}));return function(_e){return wr.apply(this,arguments)}}(),cn=function(je){je?Hr():sn()},nt=function(je){var _e=je?.specialValue||je?.value;return O.includes(_e)},Nr=function(){var wr=_asyncToGenerator(_regeneratorRuntime.mark(function je(_e,Ze,ir){var xr,kr,yr,Ct,Br,Jt,Qt,Tt,dn,Yt,$t,qr,lr,at,ct,On,vo;return _regeneratorRuntime.wrap(function(Wr){for(;;)switch(Wr.prev=Wr.next){case 0:if(kr=g&&h==="mui"&&ir==="clear",yr=!g&&h==="mui"&&ir==="clear"&&_e?.type==="change",Ct=!g&&h==="mui"&&ir==="clear"&&_e?.type!=="change",h==="mui"&&(ir=Ze,g?Ze=ir.map(function(At){var Kr;return(Kr=At?.value)!==null&&Kr!==void 0?Kr:At}):Ze=(Br=(Jt=ir)===null||Jt===void 0?void 0:Jt.value)!==null&&Br!==void 0?Br:ir),Qt=g&&Array.isArray(ir)&&ir.map(function(At){return At?.specialValue}).find(function(At){return!!At})||((xr=ir)===null||xr===void 0?void 0:xr.specialValue),g&&Ze&&!Array.isArray(Ze)&&(Ze=[].concat(_toConsumableArray(c||[]),[Ze]),ir=null),Tt=kr&&Ze.length===0&&ve&&N||yr,!Tt){Wr.next=9;break}return Wr.abrupt("return");case 9:if(dn=g&&Ze.length&&Ze.length>(c||[]).length&&Ze[Ze.length-1]==ve&&!so(ve,he),Qt!="LOAD_MORE"){Wr.next=17;break}return se(ve),Qe.current=!0,Wr.next=15,Gt(ve,!0);case 15:Wr.next=37;break;case 17:if(Qt!="LOADING_MORE"){Wr.next=21;break}Qe.current=!0,Wr.next=37;break;case 21:if(!g){Wr.next=31;break}if(Yt=wO(Ze,We,s),$t=_slicedToArray(Yt,2),qr=$t[0],lr=$t[1],d(qr,r?lr:void 0),!dn){Wr.next=29;break}return Wr.next=27,zf(0);case 27:return Wr.next=29,rr(null,"","my-reset");case 29:Wr.next=37;break;case 31:if(at=LO(Ze,We,s),ct=_slicedToArray(at,2),On=ct[0],vo=ct[1],d(On,r?vo:void 0),!(Ct&&b)){Wr.next=37;break}return Wr.next=36,zf(0);case 36:k(!1);case 37:case"end":return Wr.stop()}},je)}));return function(_e,Ze,ir){return wr.apply(this,arguments)}}(),rr=function(){var wr=_asyncToGenerator(_regeneratorRuntime.mark(function je(_e,Ze,ir){var xr,kr,yr;return _regeneratorRuntime.wrap(function(Br){for(;;)switch(Br.prev=Br.next){case 0:if(xr=h==="mui"&&ir==="reset",kr=Ze,!(kr===S||kr===A||xr)){Br.next=4;break}return Br.abrupt("return");case 4:if(Ze==ve){Br.next=13;break}if(se(kr),yr=o&&(u?!!kr:!0),!yr){Br.next=12;break}return Br.next=10,tt(kr);case 10:Br.next=13;break;case 12:o&&u&&Pe([]);case 13:case"end":return Br.stop()}},je)}));return function(_e,Ze,ir){return wr.apply(this,arguments)}}(),Zr=function(je){var _e=_toConsumableArray(je);return a&&(Mt?_e.push({specialValue:"LOAD_MORE",title:S}):de&&_e.push({specialValue:"LOADING_MORE",title:A,disabled:!0})),_e},zr=function(je,_e){if(_e==null)return null;var Ze=_e.value!=null?_e.value:_e;return je.value===Ze},qt=function(je){return je&&je.disabled},Et=function(je){var _e;if(je!=null&&je.isCustom)return!0;var Ze=(_e=je?.value)!==null&&_e!==void 0?_e:je,ir=so(Ze,We);return ir?.isCustom||!1},Vn=function(je){if(je==null)return null;var _e=je.value!=null?je:Hf(so(je,We));return!_e&&je.specialValue?je.title:!_e&&s||!_e?je:_e.title||_e.label||_e.value},jt=h==="mui"?RO(St):St;return{options:jt,listValues:We,hasValue:Ft,selectedListValue:vt,open:N,onOpen:Hr,onClose:sn,onDropdownVisibleChange:cn,onChange:Nr,inputValue:ve,onInputChange:rr,canShowLoadMore:Mt,isInitialLoading:tr,isLoading:ar,isLoadingMore:de,isSpecialValue:nt,extendOptions:Zr,getOptionSelected:zr,getOptionDisabled:qt,getOptionIsCustom:Et,getOptionLabel:Vn,aPlaceholder:L}};const Kb=null;function qf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Jf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qf(Object(t),!0).forEach(function(r){(0,re.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):qf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}const In=Jf(Jf({},qe),{},{ReactUtils:Ge,DragIcon:Od});var Qf=y(47232),VO=y(63383);const Zi={add:"Add",remove:"Remove"},Yf={id:In.uuid(),type:"group"},Xf="timeFilter",Zf=[Xf],DO={...Ur.widgets,text:{...Ur.widgets.text,factory:function(e){return m.createElement(gr.p,{value:e?.value||"",placeholder:e?.placeholder,onChange:t=>e?.setValue(t.currentTarget.value)})}},number:{...Ur.widgets.number,factory:function(e){return m.createElement(gr.p,{value:e?.value,placeholder:e?.placeholder,type:"number",onChange:t=>e?.setValue(Number.parseInt(t.currentTarget.value,10))})}},datetime:{...Ur.widgets.datetime,factory:function(e){if(e?.operator==="macros")return m.createElement(ht.l6,{id:e.id,"aria-label":"Macros value selector",menuShouldPortal:!0,options:Zf.map(Ee.z),value:e?.value,onChange:r=>e.setValue(r.value)});const t=(0,Qf.KQ)(e?.value).isValid()?(0,Qf.KQ)(e?.value).utc():void 0;return m.createElement(VO.K,{onChange:r=>{e?.setValue(r?.format(Ur.widgets.datetime.valueFormat))},date:t})},sqlFormatValue:(n,e,t,r,a,o)=>r==="macros"?Zf.includes(n)?n:void 0:typeof Ur.widgets.datetime.sqlFormatValue=="string"||typeof Ur.widgets.datetime.sqlFormatValue=="object"?void 0:Ur.widgets.datetime.sqlFormatValue?.call(Ur.ctx,n,e,t,r,a,o)||""}},NO={...Ur.settings,canRegroup:!1,maxNesting:1,canReorder:!1,showNot:!1,addRuleLabel:Zi.add,deleteLabel:Zi.remove,renderConjs:function(e){return m.createElement(ht.l6,{id:e?.id,"aria-label":"Conjunction","data-testid":it.Tp.components.SQLQueryEditor.filterConjunction,menuShouldPortal:!0,options:e?.conjunctionOptions?Object.keys(e?.conjunctionOptions).map(Ee.z):void 0,value:e?.selectedConjunction,onChange:t=>e?.setConjunction(t.value)})},renderField:function(e){const t=e?.config?.fields||{};return m.createElement(ht.l6,{id:e?.id,width:25,"aria-label":"Field","data-testid":it.Tp.components.SQLQueryEditor.filterField,menuShouldPortal:!0,options:e?.items.map(r=>{const a=t[r.key].mainWidgetProps?.customProps?.icon;return{label:r.label,value:r.key,icon:a}}),value:e?.selectedKey,onChange:r=>{e?.setField(r.label)}})},renderButton:function(e){return m.createElement(Vt.$n,{type:"button",title:`${e?.label} filter`,onClick:e?.onClick,variant:"secondary",size:"md",icon:e?.label===Zi.add?"plus":"times"})},renderOperator:function(e){return m.createElement(ht.l6,{options:e?.items.map(t=>({label:t.label,value:t.key})),"aria-label":"Operator","data-testid":it.Tp.components.SQLQueryEditor.filterOperator,menuShouldPortal:!0,value:e?.selectedKey,onChange:t=>{e?.setField(t.value||"")}})}};var xO=(n=>(n.IN="select_any_in",n.NOT_IN="select_not_any_in",n.MACROS="macros",n))(xO||{});const kO=UO(Ur),ep=Ur.types.text.widgets.text,MO=[...ep.operators||[],"select_any_in","select_not_any_in"],_O={...ep,operators:MO},GO={...Ur.types,text:{...Ur.types.text,widgets:{...Ur.types.text.widgets,text:_O}},datetime:{...Ur.types.datetime,widgets:{...Ur.types.datetime.widgets,datetime:{...Ur.types.datetime.widgets.datetime,operators:["macros",...Ur.types.datetime.widgets.datetime.operators||[]]}}}},$O={...Ur,widgets:DO,settings:NO,operators:kO,types:GO},rp=()=>"",tp=n=>typeof n=="function";function UO(n){const{...e}=n.operators,t=()=>{const i=e.select_any_in.sqlFormatOp;return tp(i)?i:rp},r=(i,l,s,c,d,f,p,v)=>t()(i,l,np(s),c,d,f,p,v),a=()=>{const i=e.select_not_any_in.sqlFormatOp;return tp(i)?i:rp},o=(i,l,s,c,d,f,p,v)=>a()(i,l,np(s),c,d,f,p,v);return{...e,select_any_in:{...e.select_any_in,sqlFormatOp:r},select_not_any_in:{...e.select_not_any_in,sqlFormatOp:o},macros:{label:"Macros",sqlFormatOp:(i,l,s)=>s===Xf?`$__timeFilter(${i})`:s}}}function np(n){return(0,xe.isString)(n)?n.split(","):n}function BO({sql:n,config:e,onSqlChange:t}){const[r,a]=(0,m.useState)(),o=(0,m.useMemo)(()=>({...$O,...e}),[e]);(0,m.useEffect)(()=>{if(!r){const i=In.checkTree(In.loadTree(n.whereJsonTree??Yf),o);a(i)}},[o,n.whereJsonTree,r]),(0,m.useEffect)(()=>{n.whereJsonTree||a(In.checkTree(In.loadTree(Yf),o))},[o,n.whereJsonTree]);const u=(0,m.useCallback)((i,l)=>{a(i);const s={...n,whereJsonTree:In.getTree(i),whereString:In.sqlFormat(i,l)};t(s)},[t,n]);return r?m.createElement(cd,{...o,value:r,onChange:u,renderBuilder:i=>m.createElement(z0,{...i})}):null}function co(n){return`
    display: flex;
    gap: 8px;
    flex-direction: ${n};`}(0,yt.injectGlobal)`
  .group--header {
    ${co("row")}
  }

  .group-or-rule {
    ${co("column")}
    .rule {
      flex-direction: row;
    }
  }

  .rule--body {
    ${co("row")}
  }

  .group--children {
    ${co("column")}
  }

  .group--conjunctions:empty {
    display: none;
  }
`;function WO({query:n,fields:e,onQueryChange:t,db:r}){const a=(0,ut.A)(async()=>KO(e),[e]),{onSqlChange:o}=Lr({query:n,onQueryChange:t,db:r});return m.createElement(BO,{key:JSON.stringify(a.value),config:{fields:a.value||{}},sql:n.sql,onSqlChange:u=>{const i=(0,me.w)().getVariables();HO(u,i),o(u)}})}function KO(n){const e={};for(const t of n)e[t.value]={type:t.raqbFieldType||"text",valueSources:["value"],mainWidgetProps:{customProps:{icon:t.icon}}};return e}function HO(n,e){const t=r=>"multi"in r&&r.multi&&(n.whereString?.includes(`\${${r.name}}`)||n.whereString?.includes(`$${r.name}`));e.some(r=>t(r))&&(n.whereString=n.whereString?.replaceAll("')",")"),n.whereString=n.whereString?.replaceAll("('","("))}const zO=({query:n,db:e,queryRowFilter:t,onChange:r,onValidate:a,range:o})=>{const u=(0,Le.A)(async()=>await e.fields(n),[e,n.dataset,n.table]);return m.createElement(m.Fragment,null,m.createElement(Ao.D,null,m.createElement(Ir.U,null,m.createElement(He,{fields:u.value||[],query:n,onQueryChange:r,db:e})),t.filter&&m.createElement(Ir.U,null,m.createElement(mt.c,{label:"Filter by column value",optional:!0},m.createElement(WO,{fields:u.value||[],query:n,onQueryChange:r,db:e}))),t.group&&m.createElement(Ir.U,null,m.createElement(mt.c,{label:"Group by column"},m.createElement(Or,{fields:u.value||[],query:n,onQueryChange:r,db:e}))),t.order&&m.createElement(Ir.U,null,m.createElement(Mn,{fields:u.value||[],query:n,onQueryChange:r,db:e})),t.preview&&n.rawSql&&m.createElement(Ir.U,null,m.createElement(Dr.l,{rawSql:n.rawSql,datasourceType:n.datasource?.type}))),m.createElement(Ot,{db:e,query:n,onValidate:a,range:o}))};function ap({datasource:n,query:e,onChange:t,onRunQuery:r,range:a,queryHeaderProps:o}){const[u,i]=(0,m.useState)(!0),l=n.getDB(),{preconfiguredDatabase:s}=n,c=o?.dialect??"other",{loading:d,error:f}=(0,Le.A)(async()=>()=>{n.getDB(n.id).init!==void 0&&n.getDB(n.id).init()},[n]),p=Xt(e),[v,g]=(0,m.useState)({filter:!!p.sql?.whereString,group:!!p.sql?.groupBy?.[0]?.property.name,order:!!p.sql?.orderBy?.property.name,preview:!0}),[h,b]=(0,m.useState)(p);(0,m.useEffect)(()=>()=>{n.getDB(n.id).dispose!==void 0&&n.getDB(n.id).dispose()},[n]);const O=(0,m.useCallback)(L=>{qO(L)&&r&&r()},[r]),S=(L,F=!0)=>{b(L),t(L),Dn(L.sql?.columns)&&L.sql?.columns.some(P=>P.name)&&!v.group&&g({...v,group:!0}),F&&O(L)},A=L=>{b(L),t(L)};return d||f?null:m.createElement(m.Fragment,null,m.createElement(Aa,{db:l,preconfiguredDataset:s,onChange:A,onRunQuery:r,onQueryRowChange:g,queryRowFilter:v,query:p,isQueryRunnable:u,dialect:c}),m.createElement(er.$,{v:.5}),p.editorMode!==fr.lX.Code&&m.createElement(zO,{db:l,query:p,onChange:L=>S(L,!1),queryRowFilter:v,onValidate:i,range:a}),p.editorMode===fr.lX.Code&&m.createElement(Co,{db:l,query:p,queryToValidate:h,onChange:S,onRunQuery:r,onValidate:i,range:a}))}const qO=n=>!!n.rawSql;function JO(n){const e=typeof n.rawQuery=="string"?n.rawQuery:null;if(!e)return n;const t=Xt({refId:"Annotation",...n.target??{},rawSql:e});return{...n,rawQuery:void 0,workspace:void 0,subscription:void 0,queryType:void 0,target:t}}class QO extends et.iy{constructor(e,t=(0,me.w)()){super(e),this.templateSrv=t,this.interpolateVariable=(a,o)=>typeof a=="string"?o.multi||o.includeAll?this.getQueryModel().quoteLiteral(a):String(a).replace(/'/g,"''"):typeof a=="number"?a:Array.isArray(a)?a.map(i=>this.getQueryModel().quoteLiteral(i)).join(","):a,this.name=e.name,this.responseParser=new ae,this.id=e.id;const r=e.jsonData||{};this.interval=r.timeInterval||"1m",this.db=this.getDB(),this.preconfiguredDatabase=r.database??"",this.annotations={prepareAnnotation:JO,QueryEditor:ap}}getResponseParser(){return this.responseParser}interpolateVariablesInQueries(e,t){let r=e;return e&&e.length>0&&(r=e.map(a=>({...a,datasource:this.getRef(),rawSql:this.templateSrv.replace(a.rawSql,t,this.interpolateVariable),rawQuery:!0}))),r}filterQuery(e){return!e.hide}applyTemplateVariables(e,t){return{refId:e.refId,datasource:this.getRef(),rawSql:this.templateSrv.replace(e.rawSql,t,this.interpolateVariable),format:e.format}}query(e){if(kn()){const t=this.checkForDatabaseIssue(e);if(t){const r=new Error(t);return(0,pr.$)(()=>r)}}return e.targets.forEach(t=>{e.app===vr.Jk.Dashboard||e.app===vr.Jk.PanelViewer||(0,oe.rR)("grafana_sql_query_executed",{datasource:t.datasource?.type,editorMode:t.editorMode,format:t.format,app:e.app})}),super.query(e)}checkForDatabaseIssue(e){if(this.type==="postgres"&&!this.preconfiguredDatabase)return`You do not currently have a default database configured for this data source. Postgres requires a default
             database with which to connect. Please configure one through the Data Sources Configuration page, or if you
             are using a provisioning file, update that configuration file with a default database.`;if(e.app!==vr.Jk.Explore&&this.preconfiguredDatabase){for(const t of e.targets)if(t.editorMode===fr.lX.Builder&&t.dataset!==this.preconfiguredDatabase)return`The configuration for this panel's data source has been modified. The previous database used in this panel's
                   saved query is no longer available. Please update the query to use the new database option.
                   Previous query parameters will be preserved until the query is updated.`}}async metricFindQuery(e,t){const r=t?.range;if(r==null)return[];let a="tempvar";t&&t.variable&&t.variable.name&&(a=t.variable.name);const o={...t?.scopedVars,...(0,Jr.c)({query:e,wildcardChar:"%",options:t})},u=this.templateSrv.replace(e,o,this.interpolateVariable),i={refId:a,datasource:this.getRef(),rawSql:u,format:ge.Table};let l;try{l=await this.runMetaQuery(i,r)}catch(s){throw console.error(s),new Error("error when executing the sql query")}return this.getResponseParser().transformMetricFindResponse(l)}async runSql(e,t){const r=(0,Qr.E2)(),a=await this.runMetaQuery({rawSql:e,format:ge.Table,refId:t?.refId},r);return new gt.R(a)}runMetaQuery(e,t){const r=e.refId||"meta",a=[{...e,datasource:e.datasource||this.getRef(),refId:r}];return(0,$e.s)((0,pe.AI)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:t.from.valueOf().toString(),to:t.to.valueOf().toString(),queries:a},requestId:r}).pipe((0,Ye.T)(o=>(0,De.bE)(o,a).data[0]??{fields:[]})))}targetContainsTemplate(e){let t=e.rawSql;return la.forEach(r=>{t=t?.replace(r,"")||""}),this.templateSrv.containsTemplate(t)}}var YO=y(94471),XO=y(29020),fo=y(88575),po=y(60029),ZO=y(76892);function eu({value:n,defaultValue:e,onChange:t,width:r}){const[a,o]=m.useState(!1);return m.createElement(gr.p,{type:"number",placeholder:String(e),value:a?"":n,onChange:u=>{if(u.currentTarget.value?.trim()==="")o(!0),t(e);else{o(!1);const i=Number(u.currentTarget.value);Number.isNaN(i)||t(i)}},width:r})}const eb=n=>{const{onOptionsChange:e,options:t}=n,r=t.jsonData,a=r.maxIdleConnsAuto!==void 0?r.maxIdleConnsAuto:!1,o=c=>{const d={...t,jsonData:{...r,...c}};return e(d)},u=c=>d=>{o({[c]:d})},i=c=>{o(a&&c?{maxOpenConns:c,maxIdleConns:c}:{maxOpenConns:c})},l=()=>{let c,d;a?(d=r.maxOpenConns,c=r.maxIdleConns):r.maxOpenConns!==void 0&&(d=r.maxOpenConns,c=r.maxOpenConns),o({maxIdleConnsAuto:!a,maxIdleConns:c,maxOpenConns:d})},s=40;return m.createElement(XO.I,{title:"Connection limits"},m.createElement(fo.D,{label:m.createElement(po.J,null,m.createElement(ke.B,{gap:.5},m.createElement("span",null,"Max open"),m.createElement(en.m,{content:m.createElement("span",null,"The maximum number of open connections to the database. If ",m.createElement("i",null,"Max idle connections")," is greater than 0 and the ",m.createElement("i",null,"Max open connections")," is less than ",m.createElement("i",null,"Max idle connections"),", then",m.createElement("i",null,"Max idle connections")," will be reduced to match the ",m.createElement("i",null,"Max open connections")," limit. If set to 0, there is no limit on the number of open connections.")},m.createElement(wt.I,{name:"info-circle",size:"sm"}))))},m.createElement(eu,{value:r.maxOpenConns,defaultValue:rn.$.sqlConnectionLimits.maxOpenConns,onChange:c=>{i(c)},width:s})),m.createElement(fo.D,{label:m.createElement(po.J,null,m.createElement(ke.B,{gap:.5},m.createElement("span",null,"Auto max idle"),m.createElement(en.m,{content:m.createElement("span",null,"If enabled, automatically set the number of ",m.createElement("i",null,"Maximum idle connections")," to the same value as",m.createElement("i",null," Max open connections"),". If the number of maximum open connections is not set it will be set to the default (",rn.$.sqlConnectionLimits.maxIdleConns,").")},m.createElement(wt.I,{name:"info-circle",size:"sm"}))))},m.createElement(fn.d,{value:a,onChange:l})),m.createElement(fo.D,{label:m.createElement(po.J,null,m.createElement(ke.B,{gap:.5},m.createElement("span",null,"Max idle"),m.createElement(en.m,{content:m.createElement("span",null,"The maximum number of connections in the idle connection pool.If ",m.createElement("i",null,"Max open connections")," is greater than 0 but less than the ",m.createElement("i",null,"Max idle connections"),", then the ",m.createElement("i",null,"Max idle connections")," ","will be reduced to match the ",m.createElement("i",null,"Max open connections")," limit. If set to 0, no idle connections are retained.")},m.createElement(wt.I,{name:"info-circle",size:"sm"}))))},a?m.createElement(ZO.c,{width:s},t.jsonData.maxIdleConns):m.createElement(eu,{value:r.maxIdleConns,defaultValue:rn.$.sqlConnectionLimits.maxIdleConns,onChange:c=>{u("maxIdleConns")(c)},width:s})),m.createElement(fo.D,{label:m.createElement(po.J,null,m.createElement(ke.B,{gap:.5},m.createElement("span",null,"Max lifetime"),m.createElement(en.m,{content:m.createElement("span",null,"The maximum amount of time in seconds a connection may be reused. If set to 0, connections are reused forever.")},m.createElement(wt.I,{name:"info-circle",size:"sm"}))))},m.createElement(eu,{value:r.connMaxLifetime,defaultValue:rn.$.sqlConnectionLimits.connMaxLifetime,onChange:c=>{u("connMaxLifetime")(c)},width:s})))},Hb=()=>{const n=useStyles2(rb);return React.createElement("hr",{className:n.horizontalDivider})},rb=n=>({horizontalDivider:css({borderTop:`1px solid ${n.colors.border.weak}`,margin:n.spacing(2,0),width:"100%"})}),zb=n=>{const{editorProps:e,showCACert:t,showKeyPair:r=!0}=n,{secureJsonFields:a}=e.options;return React.createElement(React.Fragment,null,r?React.createElement(Field,{label:React.createElement(Label,null,React.createElement(Stack,{gap:.5},React.createElement("span",null,"TLS/SSL Client Certificate"),React.createElement(Tooltip,{content:React.createElement("span",null,"To authenticate with an TLS/SSL client certificate, provide the client certificate here.")},React.createElement(Icon,{name:"info-circle",size:"sm"}))))},React.createElement(SecretTextArea,{placeholder:"-----BEGIN CERTIFICATE-----",cols:45,rows:7,isConfigured:a&&a.tlsClientCert,onChange:onUpdateDatasourceSecureJsonDataOption(e,"tlsClientCert"),onReset:()=>{updateDatasourcePluginResetOption(e,"tlsClientCert")}})):null,t?React.createElement(Field,{label:React.createElement(Label,null,React.createElement(Stack,{gap:.5},React.createElement("span",null,"TLS/SSL Root Certificate"),React.createElement(Tooltip,{content:React.createElement("span",null,"If the selected TLS/SSL mode requires a server root certificate, provide it here.")},React.createElement(Icon,{name:"info-circle",size:"sm"}))))},React.createElement(SecretTextArea,{placeholder:"-----BEGIN CERTIFICATE-----",cols:45,rows:7,isConfigured:a&&a.tlsCACert,onChange:onUpdateDatasourceSecureJsonDataOption(e,"tlsCACert"),onReset:()=>{updateDatasourcePluginResetOption(e,"tlsCACert")}})):null,r?React.createElement(Field,{label:React.createElement(Label,null,React.createElement(Stack,{gap:.5},React.createElement("span",null,"TLS/SSL Client Key"),React.createElement(Tooltip,{content:React.createElement("span",null,"To authenticate with a client TLS/SSL certificate, provide the key here.")},React.createElement(Icon,{name:"info-circle",size:"sm"}))))},React.createElement(SecretTextArea,{placeholder:"-----BEGIN RSA PRIVATE KEY-----",cols:45,rows:7,isConfigured:a&&a.tlsClientKey,onChange:onUpdateDatasourceSecureJsonDataOption(e,"tlsClientKey"),onReset:()=>{updateDatasourcePluginResetOption(e,"tlsClientKey")}})):null)};var tb=y(34867);const op=(0,tb.DW)("features.plugins.sql");function nb({onOptionsChange:n,options:e}){(0,m.useEffect)(()=>{const t=e.jsonData;let r={...e},a=!1;if(e.database&&(op.logDebug(`Migrating from options.database with value ${e.database} for ${e.name}`),r.database="",r.jsonData={...t,database:e.database},a=!0),t.maxOpenConns===void 0&&t.maxIdleConns===void 0&&t.maxIdleConnsAuto===void 0){const{maxOpenConns:o,maxIdleConns:u}=rn.$.sqlConnectionLimits;op.logDebug(`Setting default max open connections to ${o} and setting max idle connection to ${u}`),r.jsonData={...r.jsonData,maxOpenConns:o,maxIdleConns:u,maxIdleConnsAuto:!0},a=!0}if(t.connMaxLifetime===void 0){const{connMaxLifetime:o}=rn.$.sqlConnectionLimits;r.jsonData={...r.jsonData,connMaxLifetime:o},a=!0}a&&n(r)},[n,e])}},18678:function(Te,ce,y){var D,T;(function(j,$){D=$,T=typeof D=="function"?D.call(ce,y,ce,Te):D,T!==void 0&&(Te.exports=T)})(this,function(){"use strict";Array.isArray||(Array.isArray=function(E){return Object.prototype.toString.call(E)==="[object Array]"});function j(E){for(var C=[],V=0,w=E.length;V<w;V++)C.indexOf(E[V])===-1&&C.push(E[V]);return C}var $={},H={"==":function(E,C){return E==C},"===":function(E,C){return E===C},"!=":function(E,C){return E!=C},"!==":function(E,C){return E!==C},">":function(E,C){return E>C},">=":function(E,C){return E>=C},"<":function(E,C,V){return V===void 0?E<C:E<C&&C<V},"<=":function(E,C,V){return V===void 0?E<=C:E<=C&&C<=V},"!!":function(E){return $.truthy(E)},"!":function(E){return!$.truthy(E)},"%":function(E,C){return E%C},log:function(E){return console.log(E),E},in:function(E,C){return!C||typeof C.indexOf>"u"?!1:C.indexOf(E)!==-1},cat:function(){return Array.prototype.join.call(arguments,"")},substr:function(E,C,V){if(V<0){var w=String(E).substr(C);return w.substr(0,w.length+V)}return String(E).substr(C,V)},"+":function(){return Array.prototype.reduce.call(arguments,function(E,C){return parseFloat(E,10)+parseFloat(C,10)},0)},"*":function(){return Array.prototype.reduce.call(arguments,function(E,C){return parseFloat(E,10)*parseFloat(C,10)})},"-":function(E,C){return C===void 0?-E:E-C},"/":function(E,C){return E/C},min:function(){return Math.min.apply(this,arguments)},max:function(){return Math.max.apply(this,arguments)},merge:function(){return Array.prototype.reduce.call(arguments,function(E,C){return E.concat(C)},[])},var:function(E,C){var V=C===void 0?null:C,w=this;if(typeof E>"u"||E===""||E===null)return w;for(var _=String(E).split("."),q=0;q<_.length;q++)if(w==null||(w=w[_[q]],w===void 0))return V;return w},missing:function(){for(var E=[],C=Array.isArray(arguments[0])?arguments[0]:arguments,V=0;V<C.length;V++){var w=C[V],_=$.apply({var:w},this);(_===null||_==="")&&E.push(w)}return E},missing_some:function(E,C){var V=$.apply({missing:C},this);return C.length-V.length>=E?[]:V}};return $.is_logic=function(E){return typeof E=="object"&&E!==null&&!Array.isArray(E)&&Object.keys(E).length===1},$.truthy=function(E){return Array.isArray(E)&&E.length===0?!1:!!E},$.get_operator=function(E){return Object.keys(E)[0]},$.get_values=function(E){return E[$.get_operator(E)]},$.apply=function(E,C){if(Array.isArray(E))return E.map(function(be){return $.apply(be,C)});if(!$.is_logic(E))return E;var V=$.get_operator(E),w=E[V],_,q,Q,K,Y;if(Array.isArray(w)||(w=[w]),V==="if"||V=="?:"){for(_=0;_<w.length-1;_+=2)if($.truthy($.apply(w[_],C)))return $.apply(w[_+1],C);return w.length===_+1?$.apply(w[_],C):null}else if(V==="and"){for(_=0;_<w.length;_+=1)if(q=$.apply(w[_],C),!$.truthy(q))return q;return q}else if(V==="or"){for(_=0;_<w.length;_+=1)if(q=$.apply(w[_],C),$.truthy(q))return q;return q}else{if(V==="filter")return K=$.apply(w[0],C),Q=w[1],Array.isArray(K)?K.filter(function(be){return $.truthy($.apply(Q,be))}):[];if(V==="map")return K=$.apply(w[0],C),Q=w[1],Array.isArray(K)?K.map(function(be){return $.apply(Q,be)}):[];if(V==="reduce")return K=$.apply(w[0],C),Q=w[1],Y=typeof w[2]<"u"?w[2]:null,Array.isArray(K)?K.reduce(function(be,Ge){return $.apply(Q,{current:Ge,accumulator:be})},Y):Y;if(V==="all"){if(K=$.apply(w[0],C),Q=w[1],!Array.isArray(K)||!K.length)return!1;for(_=0;_<K.length;_+=1)if(!$.truthy($.apply(Q,K[_])))return!1;return!0}else if(V==="none"){if(K=$.apply(w[0],C),Q=w[1],!Array.isArray(K)||!K.length)return!0;for(_=0;_<K.length;_+=1)if($.truthy($.apply(Q,K[_])))return!1;return!0}else if(V==="some"){if(K=$.apply(w[0],C),Q=w[1],!Array.isArray(K)||!K.length)return!1;for(_=0;_<K.length;_+=1)if($.truthy($.apply(Q,K[_])))return!0;return!1}}if(w=w.map(function(be){return $.apply(be,C)}),H.hasOwnProperty(V)&&typeof H[V]=="function")return H[V].apply(C,w);if(V.indexOf(".")>0){var le=String(V).split("."),z=H;for(_=0;_<le.length;_++){if(!z.hasOwnProperty(le[_]))throw new Error("Unrecognized operation "+V+" (failed at "+le.slice(0,_+1).join(".")+")");z=z[le[_]]}return z.apply(C,w)}throw new Error("Unrecognized operation "+V)},$.uses_data=function(E){var C=[];if($.is_logic(E)){var V=$.get_operator(E),w=E[V];Array.isArray(w)||(w=[w]),V==="var"?C.push(w[0]):w.forEach(function(_){C.push.apply(C,$.uses_data(_))})}return j(C)},$.add_operation=function(E,C){H[E]=C},$.rm_operation=function(E){delete H[E]},$.rule_like=function(E,C){if(C===E||C==="@")return!0;if(C==="number")return typeof E=="number";if(C==="string")return typeof E=="string";if(C==="array")return Array.isArray(E)&&!$.is_logic(E);if($.is_logic(C)){if($.is_logic(E)){var V=$.get_operator(C),w=$.get_operator(E);if(V==="@"||V===w)return $.rule_like($.get_values(E,!1),$.get_values(C,!1))}return!1}if(Array.isArray(C))if(Array.isArray(E)){if(C.length!==E.length)return!1;for(var _=0;_<C.length;_+=1)if(!$.rule_like(E[_],C[_]))return!1;return!0}else return!1;return!1},$})},87805:(Te,ce,y)=>{var D=y(43360),T=y(75288);function j($,H,E){(E!==void 0&&!T($[H],E)||E===void 0&&!(H in $))&&D($,H,E)}Te.exports=j},85250:(Te,ce,y)=>{var D=y(37217),T=y(87805),j=y(86649),$=y(42824),H=y(23805),E=y(37241),C=y(14974);function V(w,_,q,Q,K){w!==_&&j(_,function(Y,le){if(K||(K=new D),H(Y))$(w,_,le,q,V,Q,K);else{var z=Q?Q(C(w,le),Y,le+"",w,_,K):void 0;z===void 0&&(z=Y),T(w,le,z)}},E)}Te.exports=V},42824:(Te,ce,y)=>{var D=y(87805),T=y(93290),j=y(71961),$=y(23007),H=y(35529),E=y(72428),C=y(56449),V=y(83693),w=y(3656),_=y(1882),q=y(23805),Q=y(11331),K=y(37167),Y=y(14974),le=y(69884);function z(be,Ge,Ke,Ie,Ee,ge,Me){var Ve=Y(be,Ke),Xe=Y(Ge,Ke),pr=Me.get(Xe);if(pr){D(be,Ke,pr);return}var $e=ge?ge(Ve,Xe,Ke+"",be,Ge,Me):void 0,Ye=$e===void 0;if(Ye){var vr=C(Xe),Jr=!vr&&w(Xe),Qr=!vr&&!Jr&&K(Xe);$e=Xe,vr||Jr||Qr?C(Ve)?$e=Ve:V(Ve)?$e=$(Ve):Jr?(Ye=!1,$e=T(Xe,!0)):Qr?(Ye=!1,$e=j(Xe,!0)):$e=[]:Q(Xe)||E(Xe)?($e=Ve,E(Ve)?$e=le(Ve):(!q(Ve)||_(Ve))&&($e=H(Xe))):Ye=!1}Ye&&(Me.set(Xe,$e),Ee($e,Xe,Ie,ge,Me),Me.delete(Xe)),D(be,Ke,$e)}Te.exports=z},69302:(Te,ce,y)=>{var D=y(83488),T=y(56757),j=y(32865);function $(H,E){return j(T(H,E,D),H+"")}Te.exports=$},20999:(Te,ce,y)=>{var D=y(69302),T=y(36800);function j($){return D(function(H,E){var C=-1,V=E.length,w=V>1?E[V-1]:void 0,_=V>2?E[2]:void 0;for(w=$.length>3&&typeof w=="function"?(V--,w):void 0,_&&T(E[0],E[1],_)&&(w=V<3?void 0:w,V=1),H=Object(H);++C<V;){var q=E[C];q&&$(H,q,C,w)}return H})}Te.exports=j},14974:Te=>{function ce(y,D){if(!(D==="constructor"&&typeof y[D]=="function")&&D!="__proto__")return y[D]}Te.exports=ce},83693:(Te,ce,y)=>{var D=y(64894),T=y(40346);function j($){return T($)&&D($)}Te.exports=j},73916:(Te,ce,y)=>{var D=y(43360),T=y(30641),j=y(15389);function $(H,E){var C={};return E=j(E,3),T(H,function(V,w,_){D(C,w,E(V,w,_))}),C}Te.exports=$},55364:(Te,ce,y)=>{var D=y(85250),T=y(20999),j=T(function($,H,E){D($,H,E)});Te.exports=j},6924:(Te,ce,y)=>{var D=y(85250),T=y(20999),j=T(function($,H,E,C){D($,H,E,C)});Te.exports=j},71086:(Te,ce,y)=>{var D=y(34932),T=y(15389),j=y(97420),$=y(83349);function H(E,C){if(E==null)return{};var V=D($(E),function(w){return[w]});return C=T(C),j(E,V,function(w,_){return C(w,_[0])})}Te.exports=H},22331:(Te,ce,y)=>{var D=y(87133),T=y(77556),j=y(61489),$=y(13222);function H(E,C,V){return E=$(E),V=V==null?0:D(j(V),0,E.length),C=T(C),E.slice(V,V+C.length)==C}Te.exports=H},69884:(Te,ce,y)=>{var D=y(21791),T=y(37241);function j($){return D($,T($))}Te.exports=j},21450:function(Te){(function(y,D){Te.exports=D()})(this,function(){return function(ce){var y={};function D(T){if(y[T])return y[T].exports;var j=y[T]={i:T,l:!1,exports:{}};return ce[T].call(j.exports,j,j.exports,D),j.l=!0,j.exports}return D.m=ce,D.c=y,D.d=function(T,j,$){D.o(T,j)||Object.defineProperty(T,j,{configurable:!1,enumerable:!0,get:$})},D.n=function(T){var j=T&&T.__esModule?function(){return T.default}:function(){return T};return D.d(j,"a",j),j},D.o=function(T,j){return Object.prototype.hasOwnProperty.call(T,j)},D.p="",D(D.s=3)}([function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0});function T($,H){var E={},C=$||"Abstract",V=[],w=null,_;if(E._type=C,E.getType=function(){return C},E.setType=function(Y){C=Y},E.getChildren=function(){return V},E.addChild=function(Y){if(Y){if(!Y.setParent)throw{name:"Error",message:"Trying to add a child which is not a node: "+JSON.stringify(Y)};Y.setParent(E),V.push(Y)}},E.getParent=function(){return w},E.setParent=function(Y){w=Y},E.getContext=function(Y){return _||Y.activeContext.peek()},E.setContext=function(Y){_=Y},E.getStartPosition=function(){return H>>16},E.getEndPosition=function(){return H&65535},E.getValue=function(){throw{name:"MethodNotImplementedException",message:"SpelNode#getValue() must be overridden."}},E.toString=function(){var Y="Kind: "+E.getType();Y+=", Children: [";for(var le=0,z=E.getChildren().length;le<z;le+=1)Y+="{"+E.getChildren()[le]+"}, ";return Y+="]",Y},H===0)throw{name:"Error",message:"Position cannot be 0"};for(var q=arguments.length,Q=Array(q>2?q-2:0),K=2;K<q;K++)Q[K-2]=arguments[K];return Q&&Q.forEach(function(Y){E.addChild(Y)}),E}var j=y.SpelNode={create:T}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Stack=T;function T(j){this.elements=j||[]}T.prototype.push=function(j){return this.elements.push(j),j},T.prototype.pop=function(){return this.elements.pop()},T.prototype.peek=function(){return this.elements[this.elements.length-1]},T.prototype.empty=function(){return this.elements.length>0},T.prototype.search=function(j){return this.elements.length-this.elements.indexOf(j)}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var T={LITERAL_INT:1,LITERAL_LONG:2,LITERAL_HEXINT:3,LITERAL_HEXLONG:4,LITERAL_STRING:5,LITERAL_REAL:6,LITERAL_REAL_FLOAT:7,LPAREN:"(",RPAREN:")",COMMA:",",IDENTIFIER:0,COLON:":",HASH:"#",RSQUARE:"]",LSQUARE:"[",LCURLY:"{",RCURLY:"}",DOT:".",PLUS:"+",STAR:"*",MINUS:"-",SELECT_FIRST:"^[",SELECT_LAST:"$[",QMARK:"?",PROJECT:"![",DIV:"/",GE:">=",GT:">",LE:"<=",LT:"<",EQ:"==",NE:"!=",MOD:"%",NOT:"!",ASSIGN:"=",INSTANCEOF:"instanceof",MATCHES:"matches",BETWEEN:"between",SELECT:"?[",POWER:"^",ELVIS:"?:",SAFE_NAVI:"?.",BEAN_REF:"@",SYMBOLIC_OR:"||",SYMBOLIC_AND:"&&",INC:"++",DEC:"--"};function j(H){this.type=H,this.tokenChars=T[H],this._hasPayload=typeof T[H]!="string",typeof T[H]=="number"&&(this._ordinal=T[H])}for(var $ in T)T.hasOwnProperty($)&&(j[$]=new j($));j.prototype.toString=function(){return this.type+(this.tokenChars.length!==0?"("+this.tokenChars+")":"")},j.prototype.getLength=function(){return this.tokenChars.length},j.prototype.hasPayload=function(){return this._hasPayload},j.prototype.valueOf=function(H){for(var E in T)if(T.hasOwnProperty(E)&&T[E]===H)return j[E]},j.prototype.ordinal=function(){return this._ordinal},y.TokenKind=j},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.StandardContext=y.SpelExpressionEvaluator=void 0;var T=D(4),j=D(50);y.SpelExpressionEvaluator=T.SpelExpressionEvaluator,y.StandardContext=j.StandardContext},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.SpelExpressionEvaluator=void 0;var T=D(5),j=D(1),$={};function H(E,C,V){var w=new j.Stack,_;return C||(C={}),w.push(C),_={rootContext:C,activeContext:w,locals:V},E.getValue(_)}$.compile=function(E){var C=(0,T.SpelExpressionParser)().parse(E);return{eval:function(w,_){return H(C,w,_)},_compiledExpression:C}},$.eval=function(E,C,V){return $.compile(E).eval(C,V)},y.SpelExpressionEvaluator=$},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.SpelExpressionParser=void 0;var T=D(2),j=D(6),$=D(8),H=D(9),E=D(10),C=D(11),V=D(12),w=D(13),_=D(14),q=D(15),Q=D(16),K=D(17),Y=D(18),le=D(19),z=D(20),be=D(21),Ge=D(22),Ke=D(23),Ie=D(24),Ee=D(25),ge=D(26),Me=D(27),Ve=D(28),Xe=D(29),pr=D(30),$e=D(31),Ye=D(32),vr=D(33),Jr=D(34),Qr=D(35),gt=D(36),fr=D(37),et=D(38),me=D(39),oe=D(40),pe=D(41),De=D(42),xe=D(43),ae=D(44),m=D(45),Le=D(46),er=D(47),ot=D(48),Rr=D(49),jr=y.SpelExpressionParser=function(){var Lt=new RegExp("[\\p{L}\\p{N}_$]+"),mo,Nn=[],Xt,bn,it,Zt;function ho(M){mo=M}function yo(M,Z){try{Xt=M,bn=j.Tokenizer.tokenize(M),it=bn.length,Zt=0,Nn=[];var Oe=Ir();return pn()&&Yr(gr().startPos,"MORE_INPUT",Or().toString()),Oe}catch(He){throw He.message}}function Ir(){var M=mt();if(pn()){var Z=gr();if(Z.getKind()===T.TokenKind.ASSIGN){M===null&&(M=C.NullLiteral.create(ft(Z.startPos-1,Z.endPos-1))),Or();var Oe=mt();return Y.Assign.create(ke(Z),M,Oe)}if(Z.getKind()===T.TokenKind.ELVIS){M===null&&(M=C.NullLiteral.create(ft(Z.startPos-1,Z.endPos-2))),Or();var He=Ir();return He===null&&(He=C.NullLiteral.create(ft(Z.startPos+1,Z.endPos+1))),et.Elvis.create(ke(Z),M,He)}if(Z.getKind()===T.TokenKind.QMARK){M===null&&(M=C.NullLiteral.create(ft(Z.startPos-1,Z.endPos-1))),Or();var ut=Ir();Dr(T.TokenKind.COLON);var ze=Ir();return fr.Ternary.create(ke(Z),M,ut,ze)}}return M}function mt(){for(var M=fn();Fn("or")||Lr(T.TokenKind.SYMBOLIC_OR);){var Z=Or(),Oe=fn();Mn(Z,M,Oe),M=Qr.OpOr.create(ke(Z),M,Oe)}return M}function fn(){for(var M=Vt();Fn("and")||Lr(T.TokenKind.SYMBOLIC_AND);){var Z=Or(),Oe=Vt();Mn(Z,M,Oe),M=Jr.OpAnd.create(ke(Z),M,Oe)}return M}function Vt(){var M=en(),Z=Ao();if(Z!==null){var Oe=Or(),He=en();Mn(Oe,M,He);var ut=Z.kind;if(Z.isNumericRelationalOperator()){var ze=ke(Oe);return ut===T.TokenKind.GT?Ge.OpGT.create(ze,M,He):ut===T.TokenKind.LT?Ie.OpLT.create(ze,M,He):ut===T.TokenKind.LE?Ke.OpLE.create(ze,M,He):ut===T.TokenKind.GE?be.OpGE.create(ze,M,He):ut===T.TokenKind.EQ?le.OpEQ.create(ze,M,He):z.OpNE.create(ze,M,He)}return ut===T.TokenKind.INSTANCEOF?xe.OpInstanceof.create(ke(Oe),M,He):ut===T.TokenKind.MATCHES?gt.OpMatches.create(ke(Oe),M,He):ae.OpBetween.create(ke(Oe),M,He)}return M}function en(){for(var M=ia();tn(T.TokenKind.PLUS,T.TokenKind.MINUS,T.TokenKind.INC);){var Z=Or(),Oe=ia();la(Z,Oe),Z.getKind()===T.TokenKind.PLUS?M=Ee.OpPlus.create(ke(Z),M,Oe):Z.getKind()===T.TokenKind.MINUS&&(M=ge.OpMinus.create(ke(Z),M,Oe))}return M}function ia(){for(var M=xn();tn(T.TokenKind.STAR,T.TokenKind.DIV,T.TokenKind.MOD);){var Z=Or(),Oe=xn();Mn(Z,M,Oe),Z.getKind()===T.TokenKind.STAR?M=Me.OpMultiply.create(ke(Z),M,Oe):Z.getKind()===T.TokenKind.DIV?M=Ve.OpDivide.create(ke(Z),M,Oe):M=Xe.OpModulus.create(ke(Z),M,Oe)}return M}function xn(){var M=wt(),Z;if(Lr(T.TokenKind.POWER)){Z=Or();var Oe=wt();return la(Z,Oe),pr.OpPower.create(ke(Z),M,Oe)}return M!==null&&tn(T.TokenKind.INC,T.TokenKind.DEC)?(Z=Or(),Z.getKind()===T.TokenKind.INC?$e.OpInc.create(ke(Z),!0,M):Ye.OpDec.create(ke(Z),!0,M)):M}function wt(){var M,Z;return tn(T.TokenKind.PLUS,T.TokenKind.MINUS,T.TokenKind.NOT)?(M=Or(),Z=wt(),M.getKind()===T.TokenKind.NOT?vr.OpNot.create(ke(M),Z):M.getKind()===T.TokenKind.PLUS?Ee.OpPlus.create(ke(M),Z):ge.OpMinus.create(ke(M),Z)):tn(T.TokenKind.INC,T.TokenKind.DEC)?(M=Or(),Z=wt(),M.getKind()===T.TokenKind.INC?$e.OpInc.create(ke(M),!1,Z):Ye.OpDec.create(ke(M),!1,Z)):Oo()}function Oo(){var M=[],Z=La();for(M.push(Z);ht();)M.push(Ot());return M.length===1?M[0]:Q.CompoundExpression.create(ft(Z.getStartPosition(),M[M.length-1].getEndPosition()),M)}function ht(){var M=null;return tn(T.TokenKind.DOT,T.TokenKind.SAFE_NAVI)?M=kn():M=rn(),M===null?!1:(Sr(M),!0)}function rn(){return Lr(T.TokenKind.LSQUARE)&&ua()?Ot():null}function kn(){var M=Or(),Z=M.getKind()===T.TokenKind.SAFE_NAVI;return Va(Z)||Ca()||wa(Z)||Pa(Z)?Ot():(gr()===null?Yr(M.startPos,"OOD"):Yr(M.startPos,"UNEXPECTED_DATA_AFTER_DOT",wo(gr())),null)}function Ca(){if(!Lr(T.TokenKind.HASH))return!1;var M=Or(),Z=Dr(T.TokenKind.IDENTIFIER),Oe=Ta();return Oe===null?(Sr(q.VariableReference.create(Z.data,ft(M.startPos,Z.endPos))),!0):(Sr(V.FunctionReference.create(Z.data,ft(M.startPos,Z.endPos),Oe)),!0)}function Ta(){if(!Lr(T.TokenKind.LPAREN))return null;var M=[];return Aa(M),Dr(T.TokenKind.RPAREN),M}function bo(M){Lr(T.TokenKind.LPAREN)||Yr(ke(gr()),"MISSING_CONSTRUCTOR_ARGS"),Aa(M),Dr(T.TokenKind.RPAREN)}function Aa(M){var Z=gr().startPos,Oe;do{Or();var He=gr();He===null&&Yr(Z,"RUN_OUT_OF_ARGUMENTS"),He.getKind()!==T.TokenKind.RPAREN&&M.push(Ir()),Oe=gr()}while(Oe!==null&&Oe.kind===T.TokenKind.COMMA);Oe===null&&Yr(Z,"RUN_OUT_OF_ARGUMENTS")}function yt(M){return M===null?Xt.length:M.startPos}function La(){return Co()||To()||Sn()||Fo()||Eo()||Va(!1)||Ca()||So()||wa(!1)||Pa(!1)||ua()||Ra()?Ot():null}function So(){if(Lr(T.TokenKind.BEAN_REF)){var M=Or(),Z=null,Oe=null;Lr(T.TokenKind.IDENTIFIER)?(Z=Dr(T.TokenKind.IDENTIFIER),Oe=Z.data):Lr(T.TokenKind.LITERAL_STRING)?(Z=Dr(T.TokenKind.LITERAL_STRING),Oe=Z.stringValue(),Oe=Oe.substring(1,Oe.length()-1)):Yr(M.startPos,"INVALID_BEAN_REFERENCE");var He=Le.BeanReference.create(ke(Z),Oe);return Sr(He),!0}return!1}function Sn(){if(Lr(T.TokenKind.IDENTIFIER)){var M=gr();if(M.stringValue()!=="T")return!1;var Z=Or();if(Lr(T.TokenKind.RSQUARE))return Sr(_.PropertyReference.create(Z.stringValue(),ke(Z))),!0;Dr(T.TokenKind.LPAREN);for(var Oe=ja(),He=0;dt(T.TokenKind.LSQUARE,!0);)Dr(T.TokenKind.RSQUARE),He++;return Dr(T.TokenKind.RPAREN),Sr(m.TypeReference.create(ke(M),Oe,He)),!0}return!1}function Fo(){if(Lr(T.TokenKind.IDENTIFIER)){var M=gr();return M.stringValue().toLowerCase()!=="null"?!1:(Or(),Sr(C.NullLiteral.create(ke(M))),!0)}return!1}function wa(M){var Z=gr();if(!dt(T.TokenKind.PROJECT,!0))return!1;var Oe=Ir();return Dr(T.TokenKind.RSQUARE),Sr(De.Projection.create(M,ke(Z),Oe)),!0}function Ra(){var M=gr(),Z=[];if(!dt(T.TokenKind.LCURLY,!0))return!1;var Oe=null,He=gr();if(dt(T.TokenKind.RCURLY,!0))Oe=me.InlineList.create(ft(M.startPos,He.endPos));else if(dt(T.TokenKind.COLON,!0))He=Dr(T.TokenKind.RCURLY),Oe=oe.InlineMap.create(ft(M.startPos,He.endPos));else{var ut=Ir();if(Lr(T.TokenKind.RCURLY))Z.push(ut),He=Dr(T.TokenKind.RCURLY),Oe=me.InlineList.create(ft(M.startPos,He.endPos),Z);else if(dt(T.TokenKind.COMMA,!0)){Z.push(ut);do Z.push(Ir());while(dt(T.TokenKind.COMMA,!0));He=Dr(T.TokenKind.RCURLY),Oe=me.InlineList.create(ke(M.startPos,He.endPos),Z)}else if(dt(T.TokenKind.COLON,!0)){var ze=[];for(ze.push(ut),ze.push(Ir());dt(T.TokenKind.COMMA,!0);)ze.push(Ir()),Dr(T.TokenKind.COLON),ze.push(Ir());He=Dr(T.TokenKind.RCURLY),Oe=oe.InlineMap.create(ft(M.startPos,He.endPos),ze)}else Yr(M.startPos,"OOD")}return Sr(Oe),!0}function ua(){var M=gr();if(!dt(T.TokenKind.LSQUARE,!0))return!1;var Z=Ir();return Dr(T.TokenKind.RSQUARE),Sr(K.Indexer.create(ke(M),Z)),!0}function Pa(M){var Z=gr();if(!Lo())return!1;Or();var Oe=Ir();return Oe===null&&Yr(ke(Z),"MISSING_SELECTION_EXPRESSION"),Dr(T.TokenKind.RSQUARE),Z.getKind()===T.TokenKind.SELECT_FIRST?Sr(pe.Selection.create(M,pe.Selection.FIRST,ke(Z),Oe)):Z.getKind()===T.TokenKind.SELECT_LAST?Sr(pe.Selection.create(M,pe.Selection.LAST,ke(Z),Oe)):Sr(pe.Selection.create(M,pe.Selection.ALL,ke(Z),Oe)),!0}function ja(){for(var M=[],Z=gr();Ia(Z);)Or(),Z.kind!==T.TokenKind.DOT&&M.push(er.Identifier.create(Z.stringValue(),ke(Z))),Z=gr();M.length||(Z===null&&Yr(Xt.length(),"OOD"),Yr(Z.startPos,"NOT_EXPECTED_TOKEN","qualified ID",Z.getKind().toString().toLowerCase()));var Oe=ft(M[0].getStartPosition(),M[M.length-1].getEndPosition());return ot.QualifiedIdentifier.create(Oe,M)}function Ia(M){if(M===null||M.kind===T.TokenKind.LITERAL_STRING)return!1;if(M.kind===T.TokenKind.DOT||M.kind===T.TokenKind.IDENTIFIER)return!0;var Z=M.stringValue();return Z&&Z.length&&Lt.test(Z)}function Va(M){if(Lr(T.TokenKind.IDENTIFIER)){var Z=Or(),Oe=Ta();return Oe===null?(Sr(_.PropertyReference.create(M,Z.stringValue(),ke(Z))),!0):(Sr(w.MethodReference.create(M,Z.stringValue(),ke(Z),Oe)),!0)}return!1}function Eo(){if(Fn("new")){var M=Or();if(Lr(T.TokenKind.RSQUARE))return Sr(_.PropertyReference.create(M.stringValue(),ke(M))),!0;var Z=ja(),Oe=[];if(Oe.push(Z),Lr(T.TokenKind.LSQUARE)){for(var He=[];dt(T.TokenKind.LSQUARE,!0);)Lr(T.TokenKind.RSQUARE)?He.push(null):He.push(Ir()),Dr(T.TokenKind.RSQUARE);Ra()&&Oe.push(Ot()),Sr(Rr.ConstructorReference.create(ke(M),He,Oe))}else bo(Oe),Sr(Rr.ConstructorReference.create(ke(M),Oe));return!0}return!1}function Sr(M){Nn.push(M)}function Ot(){return Nn.pop()}function Co(){var M=gr();if(M===null)return!1;if(M.getKind()===T.TokenKind.LITERAL_INT||M.getKind()===T.TokenKind.LITERAL_LONG)Sr(H.NumberLiteral.create(parseInt(M.stringValue(),10),ke(M)));else if(M.getKind()===T.TokenKind.LITERAL_REAL||M.getKind()===T.TokenKind.LITERAL_REAL_FLOAT)Sr(H.NumberLiteral.create(parseFloat(M.stringValue()),ke(M)));else if(M.getKind()===T.TokenKind.LITERAL_HEXINT||M.getKind()===T.TokenKind.LITERAL_HEXLONG)Sr(H.NumberLiteral.create(parseInt(M.stringValue(),16),ke(M)));else if(Fn("true"))Sr($.BooleanLiteral.create(!0,ke(M)));else if(Fn("false"))Sr($.BooleanLiteral.create(!1,ke(M)));else if(M.getKind()===T.TokenKind.LITERAL_STRING)Sr(E.StringLiteral.create(M.stringValue(),ke(M)));else return!1;return Or(),!0}function To(){if(Lr(T.TokenKind.LPAREN)){Or();var M=Ir();return Dr(T.TokenKind.RPAREN),Sr(M),!0}else return!1}function Ao(){var M=gr();if(M===null)return null;if(M.isNumericRelationalOperator())return M;if(M.isIdentifier()){var Z=M.stringValue();if(Z.toLowerCase()==="instanceof")return M.asInstanceOfToken();if(Z.toLowerCase()==="matches")return M.asMatchesToken();if(Z.toLowerCase()==="between")return M.asBetweenToken()}return null}function Dr(M){var Z=Or();return Z===null&&Yr(Xt.length,"OOD"),Z.getKind()!==M&&Yr(Z.startPos,"NOT_EXPECTED_TOKEN",M.toString().toLowerCase(),Z.getKind().toString().toLowerCase()),Z}function Lr(M){return dt(M,!1)}function dt(M,Z){if(!pn())return!1;var Oe=gr();return Oe.getKind()===M?(Z&&Zt++,!0):M===T.TokenKind.IDENTIFIER&&Oe.getKind().ordinal()>=T.TokenKind.DIV.ordinal()&&Oe.getKind().ordinal()<=T.TokenKind.NOT.ordinal()&&Oe.data!==null}function tn(){if(!pn())return!1;for(var M=gr(),Z=Array.prototype.slice.call(arguments),Oe=0,He=Z.length;Oe<He;Oe+=1)if(M.getKind()===Z[Oe])return!0;return!1}function Fn(M){if(!pn())return!1;var Z=gr();return Z.getKind()===T.TokenKind.IDENTIFIER&&Z.stringValue().toLowerCase()===M.toLowerCase()}function Lo(){if(!pn())return!1;var M=gr();return M.getKind()===T.TokenKind.SELECT||M.getKind()===T.TokenKind.SELECT_FIRST||M.getKind()===T.TokenKind.SELECT_LAST}function pn(){return Zt<bn.length}function Or(){return Zt>=it?null:bn[Zt++]}function gr(){return Zt>=it?null:bn[Zt]}function Yr(M,Z,Oe,He){throw Oe&&(Z+=`
Expected: `+Oe),He&&(Z+=`
Actual: `+He),{name:"InternalParseException",message:"Error occurred while attempting to parse expression '"+Xt+"' at position "+M+". Message: "+Z}}function wo(M){return M.getKind().hasPayload()?M.stringValue():M.getKind().toString().toLowerCase()}function Mn(M,Z,Oe){Ro(M,Z),la(M,Oe)}function Ro(M,Z){Z===null&&Yr(M.startPos,"LEFT_OPERAND_PROBLEM")}function la(M,Z){Z===null&&Yr(M.startPos,"RIGHT_OPERAND_PROBLEM")}function ke(M){return(M.startPos<<16)+M.endPos}function ft(M,Z){return(M<<16)+Z}return{setConfiguration:ho,parse:yo}}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Tokenizer=void 0;var T=D(7),j=D(2),$=["DIV","EQ","GE","GT","LE","LT","MOD","NE","NOT"],H=[],E=1,C=2,V=4;function w(){var Q;for(Q=48;Q<=57;Q+=1)H[Q]|=E|C;for(Q=65;Q<=70;Q+=1)H[Q]|=C;for(Q=97;Q<=102;Q+=1)H[Q]|=C;for(Q=65;Q<=90;Q+=1)H[Q]|=V;for(Q=97;Q<=122;Q+=1)H[Q]|=V}w();function _(Q){var K=Q,Y=Q+"\0",le=Y.length,z=0,be=[];function Ge(){for(var ae;z<le;)if(ae=Y[z],De(ae))ge();else switch(ae){case"+":$e(j.TokenKind.INC)?vr(j.TokenKind.INC):Ye(j.TokenKind.PLUS);break;case"_":ge();break;case"-":$e(j.TokenKind.DEC)?vr(j.TokenKind.DEC):Ye(j.TokenKind.MINUS);break;case":":Ye(j.TokenKind.COLON);break;case".":Ye(j.TokenKind.DOT);break;case",":Ye(j.TokenKind.COMMA);break;case"*":Ye(j.TokenKind.STAR);break;case"/":Ye(j.TokenKind.DIV);break;case"%":Ye(j.TokenKind.MOD);break;case"(":Ye(j.TokenKind.LPAREN);break;case")":Ye(j.TokenKind.RPAREN);break;case"[":Ye(j.TokenKind.LSQUARE);break;case"#":Ye(j.TokenKind.HASH);break;case"]":Ye(j.TokenKind.RSQUARE);break;case"{":Ye(j.TokenKind.LCURLY);break;case"}":Ye(j.TokenKind.RCURLY);break;case"@":Ye(j.TokenKind.BEAN_REF);break;case"^":$e(j.TokenKind.SELECT_FIRST)?vr(j.TokenKind.SELECT_FIRST):Ye(j.TokenKind.POWER);break;case"!":$e(j.TokenKind.NE)?vr(j.TokenKind.NE):$e(j.TokenKind.PROJECT)?vr(j.TokenKind.PROJECT):Ye(j.TokenKind.NOT);break;case"=":$e(j.TokenKind.EQ)?vr(j.TokenKind.EQ):Ye(j.TokenKind.ASSIGN);break;case"&":if(!$e(j.TokenKind.SYMBOLIC_AND))throw{name:"SpelParseException",message:"Missing character '&' in expression ("+K+") at position "+z};vr(j.TokenKind.SYMBOLIC_AND);break;case"|":if(!$e(j.TokenKind.SYMBOLIC_OR))throw{name:"SpelParseException",message:"Missing character '|' in expression ("+K+") at position "+z};vr(j.TokenKind.SYMBOLIC_OR);break;case"?":$e(j.TokenKind.SELECT)?vr(j.TokenKind.SELECT):$e(j.TokenKind.ELVIS)?vr(j.TokenKind.ELVIS):$e(j.TokenKind.SAFE_NAVI)?vr(j.TokenKind.SAFE_NAVI):Ye(j.TokenKind.QMARK);break;case"$":$e(j.TokenKind.SELECT_LAST)?vr(j.TokenKind.SELECT_LAST):ge();break;case">":$e(j.TokenKind.GE)?vr(j.TokenKind.GE):Ye(j.TokenKind.GT);break;case"<":$e(j.TokenKind.LE)?vr(j.TokenKind.LE):Ye(j.TokenKind.LT);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":Ee(ae==="0");break;case" ":case"	":case"\r":case`
`:z+=1;break;case"'":Ke();break;case'"':Ie();break;case"\0":z+=1;break;case"\\":throw{name:"SpelParseException",message:"Unexpected escape character in expression ("+K+") at position "+z};default:throw{name:"SpelParseException",message:"Cannot handle character '"+ae+"' in expression ("+K+") at position "+z}}}function Ke(){for(var ae=z,m=!1,Le;!m;)if(z+=1,Le=Y[z],Le==="'"&&(Y[z+1]==="'"?z+=1:m=!0),Le.charCodeAt(0)===0)throw{name:"SpelParseException",message:"Non-terminating quoted string in expression ("+K+") at position "+z};z+=1,be.push(new T.Token(j.TokenKind.LITERAL_STRING,pr(ae,z),ae,z))}function Ie(){for(var ae=z,m=!1,Le;!m;)if(z+=1,Le=Y[z],Le==='"'&&(Y[z+1]==='"'?z+=1:m=!0),Le.charCodeAt(0)===0)throw{name:"SpelParseException",message:"Non-terminating double-quoted string in expression ("+K+") at position "+z};z+=1,be.push(new T.Token(j.TokenKind.LITERAL_STRING,pr(ae,z),ae,z))}function Ee(ae){var m=!1,Le=z,er=Y[z+1],ot=er==="x"||er==="X",Rr,jr,Dn,Lt;if(ae&&ot){z=z+1;do z+=1;while(xe(Y[z]));gt("L","l")?(Ve(pr(Le+2,z),!0,Le,z),z+=1):Ve(pr(Le+2,z),!1,Le,z);return}do z+=1;while(pe(Y[z]));if(er=Y[z],er==="."){m=!0,Rr=z;do z+=1;while(pe(Y[z]));if(z===Rr+1){z=Rr,Me(pr(Le,z),!1,Le,z);return}}if(jr=z,gt("L","l")){if(m)throw{name:"SpelParseException",message:"Real cannot be long in expression ("+K+") at position "+z};Me(pr(Le,jr),!0,Le,jr),z+=1}else if(fr(Y[z])){m=!0,z+=1,Dn=Y[z],oe(Dn)&&(z+=1);do z+=1;while(pe(Y[z]));Lt=!1,et(Y[z])?(Lt=!0,z+=1,jr=z):me(Y[z])&&(z+=1,jr=z),Xe(pr(Le,z),Lt,Le,z)}else er=Y[z],Lt=!1,et(er)?(m=!0,Lt=!0,z+=1,jr=z):me(er)&&(m=!0,z+=1,jr=z),m?Xe(pr(Le,jr),Lt,Le,jr):Me(pr(Le,jr),!1,Le,jr)}function ge(){var ae=z,m,Le,er;do z+=1;while(Qr(Y[z]));if(m=pr(ae,z),(z-ae===2||z-ae===3)&&(Le=m.toUpperCase(),er=$.indexOf(Le),er>=0)){Jr(j.TokenKind.valueOf(Le),ae,m);return}be.push(new T.Token(j.TokenKind.IDENTIFIER,m.replace("\0",""),ae,z))}function Me(ae,m,Le,er){m?be.push(new T.Token(j.TokenKind.LITERAL_LONG,ae,Le,er)):be.push(new T.Token(j.TokenKind.LITERAL_INT,ae,Le,er))}function Ve(ae,m,Le,er){if(ae.length===0)throw m?{name:"SpelParseException",message:"Not a long in expression ("+K+") at position "+z}:{name:"SpelParseException",message:"Not an int in expression ("+K+") at position "+z};m?be.push(new T.Token(j.TokenKind.LITERAL_HEXLONG,ae,Le,er)):be.push(new T.Token(j.TokenKind.LITERAL_HEXINT,ae,Le,er))}function Xe(ae,m,Le,er){m?be.push(new T.Token(j.TokenKind.LITERAL_REAL_FLOAT,ae,Le,er)):be.push(new T.Token(j.TokenKind.LITERAL_REAL,ae,Le,er))}function pr(ae,m){return Y.substring(ae,m)}function $e(ae){return ae.tokenChars.length===2&&Y[z]===ae.tokenChars[0]?Y[z+1]===ae.tokenChars[1]:!1}function Ye(ae){be.push(new T.Token(ae,null,z,z+1)),z+=1}function vr(ae){be.push(new T.Token(ae,null,z,z+2)),z+=2}function Jr(ae,m,Le){be.push(new T.Token(ae,Le,m,m+ae.getLength()))}function Qr(ae){return De(ae)||pe(ae)||ae==="_"||ae==="$"}function gt(ae,m){var Le=Y[z];return Le===ae||Le===m}function fr(ae){return ae==="e"||ae==="E"}function et(ae){return ae==="f"||ae==="F"}function me(ae){return ae==="d"||ae==="D"}function oe(ae){return ae==="+"||ae==="-"}function pe(ae){return ae.charCodeAt(0)>255?!1:(H[ae.charCodeAt(0)]&E)!==0}function De(ae){return ae.charCodeAt(0)>255?!1:(H[ae.charCodeAt(0)]&V)!==0}function xe(ae){return ae.charCodeAt(0)>255?!1:(H[ae.charCodeAt(0)]&C)!==0}return Ge(),be}var q=y.Tokenizer={tokenize:_}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Token=void 0;var T=D(2);function j($,H,E,C){this.kind=$,this.startPos=E,this.endPos=C,H&&(this.data=H)}j.prototype.getKind=function(){return this.kind},j.prototype.toString=function(){var $="[";return $+=this.kind.toString(),this.kind.hasPayload()&&($+=":"+this.data),$+="]",$+="("+this.startPos+","+this.endPos+")",$},j.prototype.isIdentifier=function(){return this.kind===T.TokenKind.IDENTIFIER},j.prototype.isNumericRelationalOperator=function(){return this.kind===T.TokenKind.GT||this.kind===T.TokenKind.GE||this.kind===T.TokenKind.LT||this.kind===T.TokenKind.LE||this.kind===T.TokenKind.EQ||this.kind===T.TokenKind.NE},j.prototype.stringValue=function(){return this.data},j.prototype.asInstanceOfToken=function(){return new j(T.TokenKind.INSTANCEOF,this.startPos,this.endPos)},j.prototype.asMatchesToken=function(){return new j(T.TokenKind.MATCHES,this.startPos,this.endPos)},j.prototype.asBetweenToken=function(){return new j(T.TokenKind.BETWEEN,this.startPos,this.endPos)},j.prototype.getStartPosition=function(){return this.startPos},j.prototype.getEndPosition=function(){return this.endPos},y.Token=j},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BooleanLiteral=void 0;var T=D(0);function j(H,E){var C=T.SpelNode.create("boolean",E);return C.getValue=function(){return H},C.setValue=function(V){return H=V},C}var $=y.BooleanLiteral={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.NumberLiteral=void 0;var T=D(0);function j(H,E){var C=T.SpelNode.create("number",E);return C.getValue=function(){return H},C.setValue=function(V){return H=V},C}var $=y.NumberLiteral={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.StringLiteral=void 0;var T=D(0);function j(H,E){var C=T.SpelNode.create("string",E);function V(w){return(w[0]==="'"&&w[w.length-1]==="'"||w[0]==='"'&&w[w.length-1]==='"')&&(w=w.substring(1,w.length-1)),w.replace(/''/g,"'").replace(/""/g,'"')}return H=V(H),C.getValue=function(){return H},C.setValue=function(w){return H=w},C}var $=y.StringLiteral={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.NullLiteral=void 0;var T=D(0);function j(H,E){var C=T.SpelNode.create("null",E);return C.getValue=function(){return null},C}var $=y.NullLiteral={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.FunctionReference=void 0;var T=D(0),j=D(1);function $(E,C,V){var w=T.SpelNode.create("function",C);return w.getRaw=function(){return{functionName:E,args:V}},w.getValue=function(_){var q=_.locals||{},Q=_.rootContext,K=[];if(V.forEach(function(Y){var le=_.activeContext;_.activeContext=new j.Stack,_.activeContext.push(_.rootContext),K.push(Y.getValue(_)),_.activeContext=le}),q[E])return q[E].apply(Q,K);throw{name:"FunctionDoesNotExistException",message:"Function '"+E+"' does not exist."}},w}var H=y.FunctionReference={create:$}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.MethodReference=void 0;var T=D(0),j=D(1);function $(E,C,V,w){var _=T.SpelNode.create("method",V);return _.getRaw=function(){return{methodName:C,args:w}},_.getValue=function(q){var Q=q.activeContext.peek(),K=[],Y;if(!Q)throw{name:"ContextDoesNotExistException",message:"Attempting to look up property '"+C+"' for an undefined context."};function le(z){if(z==null){if(E)return null;throw{name:"NullPointerException",message:"Method "+C+" does not exist."}}return z}if(w.forEach(function(z){var be=q.activeContext;q.activeContext=new j.Stack,q.activeContext.push(q.rootContext),K.push(z.getValue(q)),q.activeContext=be}),C.substr(0,3)==="get"&&!Q[C])return le(Q[C.charAt(3).toLowerCase()+C.substring(4)]);if(C.substr(0,3)==="set"&&!Q[C])return Q[C.charAt(3).toLowerCase()+C.substring(4)]=K[0];if(Array.isArray(Q)){if(C==="size")return Q.length;if(C==="contains")return Q.includes(K[0])}return Y=le(Q[C]),Y?Y.apply(Q,K):null},_}var H=y.MethodReference={create:$}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.PropertyReference=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("property",C);return V.getRaw=function(){return E},V.getValue=function(w){var _=w.activeContext.peek();if(!_){if(H)return null;throw{name:"ContextDoesNotExistException",message:"Attempting to look up property '"+E+"' for an undefined context."}}if(_[E]===void 0||_[E]===null){if(H)return null;if(E==="size"&&Array.isArray(_))return _.length;throw{name:"NullPointerException",message:"Property '"+E+"' does not exist."}}return _[E]},V.setValue=function(w,_){var q=_.activeContext.peek();if(!q)throw{name:"ContextDoesNotExistException",message:"Attempting to assign property '"+E+"' for an undefined context."};return q[E]=w},V.getName=function(){return E},V}var $=y.PropertyReference={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.VariableReference=void 0;var T=D(0);function j(H,E){var C=T.SpelNode.create("variable",E);return C.getRaw=function(){return H},C.getValue=function(V){var w=V.activeContext.peek(),_=V.locals;if(!w)throw{name:"ContextDoesNotExistException",message:"Attempting to look up variable '"+H+"' for an undefined context."};return H==="this"?w:H==="root"?V.rootContext:_[H]},C.setValue=function(V,w){var _=w.locals;return _[H]=V},C}var $=y.VariableReference={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.CompoundExpression=void 0;var T=D(0);function j(H,E){var C=T.SpelNode.create.apply(null,["compound",H].concat(E));function V(w){var _=C.getChildren().length,q;for(q=0;q<_;q+=1)C.getChildren()[q].getType()==="indexer"?w.activeContext.push(w.activeContext.peek()[C.getChildren()[q].getValue(w)]):w.activeContext.push(C.getChildren()[q].getValue(w));return function(){for(q=0;q<_;q+=1)w.activeContext.pop()}}return C.getValue=function(w){var _=w.activeContext.peek(),q;if(!_)throw{name:"ContextDoesNotExistException",message:"Attempting to evaluate compound expression with an undefined context."};var Q=V(w);return q=w.activeContext.peek(),Q(),q},C.setValue=function(w,_){var q=V(_),Q=C.getChildren().length;return _.activeContext.pop(),w=C.getChildren()[Q-1].setValue(w,_),_.activeContext.push(null),q(),w},C}var $=y.CompoundExpression={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Indexer=void 0;var T=D(0),j=D(1);function $(E,C){var V=T.SpelNode.create.apply(null,["indexer",E].concat(C));return V.getValue=function(w){var _=w.activeContext,q,Q=V.getChildren().length,K,Y;if(w.activeContext=new j.Stack,w.activeContext.push(w.rootContext),q=w.activeContext.peek(),!q)throw{name:"ContextDoesNotExistException",message:"Attempting to evaluate compound expression with an undefined context."};for(K=0;K<Q;K+=1)w.activeContext.push(V.getChildren()[K].getValue(w));for(Y=w.activeContext.peek(),K=0;K<Q;K+=1)w.activeContext.pop();return w.activeContext=_,Y},V}var H=y.Indexer={create:$}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Assign=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("assign",H,E,C);return V.getValue=function(w){var _=w.activeContext.peek();if(!_)throw{name:"ContextDoesNotExistException",message:"Attempting to assign property '"+E.getValue(w)+"' for an undefined context."};return E.setValue(C.getValue(w),w)},V}var $=y.Assign={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpEQ=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-eq",H,E,C);return V.getValue=function(w){return E.getValue(w)===C.getValue(w)},V}var $=y.OpEQ={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpNE=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-ne",H,E,C);return V.getValue=function(w){return E.getValue(w)!==C.getValue(w)},V}var $=y.OpNE={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpGE=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-ge",H,E,C);return V.getValue=function(w){return E.getValue(w)>=C.getValue(w)},V}var $=y.OpGE={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpGT=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-gt",H,E,C);return V.getValue=function(w){return E.getValue(w)>C.getValue(w)},V}var $=y.OpGT={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpLE=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-le",H,E,C);return V.getValue=function(w){return E.getValue(w)<=C.getValue(w)},V}var $=y.OpLE={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpLT=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-lt",H,E,C);return V.getValue=function(w){return E.getValue(w)<C.getValue(w)},V}var $=y.OpLT={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpPlus=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-plus",H,E,C);return V.getValue=function(w){return C?E.getValue(w)+C.getValue(w):+E.getValue(w)},V}var $=y.OpPlus={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpMinus=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-minus",H,E,C);return V.getValue=function(w){return C?E.getValue(w)-C.getValue(w):-E.getValue(w)},V}var $=y.OpMinus={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpMultiply=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-multiply",H,E,C);return V.getValue=function(w){var _=E.getValue(w),q=C.getValue(w);if(typeof _=="number"&&typeof q=="number")return _*q;if(typeof _=="string"&&typeof q=="number"){for(var Q="",K=0;K<q;K+=1)Q+=_;return Q}return null},V}var $=y.OpMultiply={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpDivide=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-divide",H,E,C);return V.getValue=function(w){return E.getValue(w)/C.getValue(w)},V}var $=y.OpDivide={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpModulus=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-modulus",H,E,C);return V.getValue=function(w){return E.getValue(w)%C.getValue(w)},V}var $=y.OpModulus={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpPower=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-power",H,E,C);return V.getValue=function(w){return Math.pow(E.getValue(w),C.getValue(w))},V}var $=y.OpPower={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpInc=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-inc",H,C);return V.getValue=function(w){var _=C.getValue(w);return C.setValue(_+1,w),E?_:_+1},V}var $=y.OpInc={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpDec=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-dec",H,C);return V.getValue=function(w){var _=C.getValue(w);return C.setValue(_-1,w),E?_:_-1},V}var $=y.OpDec={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpNot=void 0;var T=D(0);function j(H,E){var C=T.SpelNode.create("op-not",H,E);return C.getValue=function(V){return!E.getValue(V)},C}var $=y.OpNot={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpAnd=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-and",H,E,C);return V.getValue=function(w){return!!E.getValue(w)&&!!C.getValue(w)},V}var $=y.OpAnd={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpOr=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("op-or",H,E,C);return V.getValue=function(w){return!!E.getValue(w)||!!C.getValue(w)},V}var $=y.OpOr={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpMatches=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("matches",H,E,C);return V.getValue=function(w){var _=E.getValue(w),q=C.getValue(w);try{var Q=new RegExp(q);return!!Q.exec(_)}catch(K){throw{name:"EvaluationException",message:K.toString()}}},V}var $=y.OpMatches={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Ternary=void 0;var T=D(0);function j(H,E,C,V){var w=T.SpelNode.create("ternary",H,E,C,V);return w.getValue=function(_){return E.getValue(_)?C.getValue(_):V.getValue(_)},w}var $=y.Ternary={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Elvis=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("elvis",H,E,C);return V.getValue=function(w){return E.getValue(w)!==null?E.getValue(w):C.getValue(w)},V}var $=y.Elvis={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.InlineList=void 0;var T=D(0);function j(H,E){var C=T.SpelNode.create("list",H),V=[].concat(E||[]);return C.getRaw=function(){return V},C.getValue=function(w){return V.map(function(_){return _.getValue(w)})},C}var $=y.InlineList={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.InlineMap=void 0;var T=D(0);function j(H,E){var C=T.SpelNode.create("map",H),V=[].concat(E||[]);return C.getValue=function(w){var _=!0,q=null,Q={};return V.forEach(function(K){_?K.getType()==="property"?q=K.getName():q=K.getValue(w):Q[q]=K.getValue(w),_=!_}),Q},C}var $=y.InlineMap={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Selection=void 0;var T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},j=D(0);function $(w,_,q){var Q=!1;return q.activeContext.push(w),Q=_.getValue(q),q.activeContext.pop(),Q}function H(w,_,q,Q){var K=w.filter(function(Y){return $(Y,q,Q)});switch(_){case"ALL":return K;case"FIRST":return K[0]||null;case"LAST":return K.length?K[K.length-1]:null}}function E(w,_,q,Q){var K={},Y,le,z=[],be={};for(le in w)w.hasOwnProperty(le)&&(Y={key:le,value:w[le]},$(Y,q,Q)&&z.push(Y));switch(_){case"ALL":return z.forEach(function(Ge){K[Ge.key]=Ge.value}),K;case"FIRST":return z.length?(be[z[0].key]=z[0].value,be):null;case"LAST":return z.length?(be[z[z.length-1].key]=z[z.length-1].value,be):null}z.forEach(function(Ge){K[Ge.key]=Ge.value})}function C(w,_,q,Q){var K=j.SpelNode.create("selection",q,Q);return K.getValue=function(Y){var le=Y.activeContext.peek();if(le){if(Array.isArray(le))return H(le,_,Q,Y);if((typeof le>"u"?"undefined":T(le))==="object")return E(le,_,Q,Y)}return null},K}var V=y.Selection={create:C,FIRST:"FIRST",LAST:"LAST",ALL:"ALL"}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Projection=void 0;var T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},j=D(0);function $(C,V,w){return C.map(function(_){var q;return w.activeContext.push(_),q=V.getValue(w),w.activeContext.pop(),q})}function H(C,V,w){var _=j.SpelNode.create("projection",V,w);return _.getValue=function(q){var Q=q.activeContext.peek(),K=[],Y;if(Array.isArray(Q))return $(Q,w,q);if((typeof Q>"u"?"undefined":T(Q))==="object"){for(Y in Q)Q.hasOwnProperty(Y)&&K.push(Q[Y]);return $(K,w,q)}return null},_}var E=y.Projection={create:H}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpInstanceof=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("instanceof",H,E,C);return V.getValue=function(w){throw{name:"MethodNotImplementedException",message:"OpInstanceOf: Not implemented"}},V}var $=y.OpInstanceof={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpBetween=void 0;var T=D(0);function j(H,E,C){var V=T.SpelNode.create("between",H,E,C);return V.getValue=function(w){throw{name:"MethodNotImplementedException",message:"OpBetween: Not implemented"}},V}var $=y.OpBetween={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.TypeReference=void 0;var T=D(0);function j(H,V,C){var V=T.SpelNode.create("typeref",H,V);return V.getValue=function(w){throw{name:"MethodNotImplementedException",message:"TypeReference: Not implemented"}},V}var $=y.TypeReference={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BeanReference=void 0;var T=D(0);function j(H,E){var C=T.SpelNode.create("beanref",H);return C.getValue=function(V){throw{name:"MethodNotImplementedException",message:"BeanReference: Not implemented"}},C}var $=y.BeanReference={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Identifier=void 0;var T=D(0);function j(H,E){var C=T.SpelNode.create("identifier",E);return C.getRaw=function(){return H},C.getValue=function(V){throw{name:"MethodNotImplementedException",message:"Identifier: Not implemented"}},C}var $=y.Identifier={create:j}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.QualifiedIdentifier=void 0;var T=D(0);function j(E){if(Array.isArray(E)){for(var C=0,V=Array(E.length);C<E.length;C++)V[C]=E[C];return V}else return Array.from(E)}function $(E,C){var V=T.SpelNode.create.apply(T.SpelNode,["qualifiedidentifier",E].concat(j(C)));return V.getRaw=function(){return C.map(function(w){return w.getRaw()})},V.getValue=function(w){throw{name:"MethodNotImplementedException",message:"QualifiedIdentifier: Not implemented"}},V}var H=y.QualifiedIdentifier={create:$}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.ConstructorReference=void 0;var T=D(0),j=D(1);function $(V){if(Array.isArray(V)){for(var w=0,_=Array(V.length);w<V.length;w++)_[w]=V[w];return _}else return Array.from(V)}function H(V){return Array.isArray(V)?V:Array.from(V)}function E(V,w,_){var q=_!==void 0,Q;q?Q=w.length&&w[0]&&w[0].getType()==="number"?w[0].getValue():null:(_=w,w=void 0);var K=_,Y=H(K),le=Y[0],z=Y.slice(1),be=T.SpelNode.create.apply(T.SpelNode,["constructorref",V].concat($(_)));return be.getRaw=function(){return Q},be.getValue=function(Ge){if(q&&z.length<=1){var Ke=[];return z.forEach(function(Ie){var Ee=Ge.activeContext;Ge.activeContext=new j.Stack,Ge.activeContext.push(Ge.rootContext),Ke.push(Ie.getValue(Ge)),Ge.activeContext=Ee}),z.length===1?Ke[0]:Q?new Array(Q):[]}throw{name:"MethodNotImplementedException",message:"ConstructorReference: Not implemented"}},be}var C=y.ConstructorReference={create:E}},function(ce,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0});function T($,H){var E={};return E.authentication=$||{},E.principal=H||{},E.hasRole=function(C){var V=!1;return!C||!E.authentication&&!Array.isArray(E.authentication.authorities)?!1:(E.authentication.authorities.forEach(function(w){w.authority.toLowerCase()===C.toLowerCase()&&(V=!0)}),V)},E.hasPermission=function(){var C=Array.prototype.slice.call(arguments);if(C.length===1)return E.hasRole(C[0])},E}var j=y.StandardContext={create:T}}])})},61526:(Te,ce,y)=>{Te.exports=y(88319)},88319:(Te,ce,y)=>{var D=y(48287).Buffer,T=ce,j=/`/g,$=/\./g,H=/[\0\b\t\n\r\x1a\"\'\\]/g,E={"\0":"\\0","\b":"\\b","	":"\\t","\n":"\\n","\r":"\\r","":"\\Z",'"':'\\"',"'":"\\'","\\":"\\\\"};T.escapeId=function(q,Q){if(Array.isArray(q)){for(var K="",Y=0;Y<q.length;Y++)K+=(Y===0?"":", ")+T.escapeId(q[Y],Q);return K}else return Q?"`"+String(q).replace(j,"``")+"`":"`"+String(q).replace(j,"``").replace($,"`.`")+"`"},T.escape=function(q,Q,K){if(q==null)return"NULL";switch(typeof q){case"boolean":return q?"true":"false";case"number":return q+"";case"object":return Object.prototype.toString.call(q)==="[object Date]"?T.dateToString(q,K||"local"):Array.isArray(q)?T.arrayToList(q,K):D.isBuffer(q)?T.bufferToString(q):typeof q.toSqlString=="function"?String(q.toSqlString()):Q?C(q.toString()):T.objectToValues(q,K);default:return C(q)}},T.arrayToList=function(q,Q){for(var K="",Y=0;Y<q.length;Y++){var le=q[Y];Array.isArray(le)?K+=(Y===0?"":", ")+"("+T.arrayToList(le,Q)+")":K+=(Y===0?"":", ")+T.escape(le,!0,Q)}return K},T.format=function(q,Q,K,Y){if(Q==null)return q;Array.isArray(Q)||(Q=[Q]);for(var le=0,z=/\?+/g,be="",Ge=0,Ke;Ge<Q.length&&(Ke=z.exec(q));){var Ie=Ke[0].length;if(!(Ie>2)){var Ee=Ie===2?T.escapeId(Q[Ge]):T.escape(Q[Ge],K,Y);be+=q.slice(le,Ke.index)+Ee,le=z.lastIndex,Ge++}}return le===0?q:le<q.length?be+q.slice(le):be},T.dateToString=function(q,Q){var K=new Date(q);if(isNaN(K.getTime()))return"NULL";var Y,le,z,be,Ge,Ke,Ie;if(Q==="local")Y=K.getFullYear(),le=K.getMonth()+1,z=K.getDate(),be=K.getHours(),Ge=K.getMinutes(),Ke=K.getSeconds(),Ie=K.getMilliseconds();else{var Ee=w(Q);Ee!==!1&&Ee!==0&&K.setTime(K.getTime()+Ee*6e4),Y=K.getUTCFullYear(),le=K.getUTCMonth()+1,z=K.getUTCDate(),be=K.getUTCHours(),Ge=K.getUTCMinutes(),Ke=K.getUTCSeconds(),Ie=K.getUTCMilliseconds()}var ge=V(Y,4)+"-"+V(le,2)+"-"+V(z,2)+" "+V(be,2)+":"+V(Ge,2)+":"+V(Ke,2)+"."+V(Ie,3);return C(ge)},T.bufferToString=function(q){return"X"+C(q.toString("hex"))},T.objectToValues=function(q,Q){var K="";for(var Y in q){var le=q[Y];typeof le!="function"&&(K+=(K.length===0?"":", ")+T.escapeId(Y)+" = "+T.escape(le,!0,Q))}return K},T.raw=function(q){if(typeof q!="string")throw new TypeError("argument sql must be a string");return{toSqlString:function(){return q}}};function C(_){for(var q=H.lastIndex=0,Q="",K;K=H.exec(_);)Q+=_.slice(q,K.index)+E[K[0]],q=H.lastIndex;return q===0?"'"+_+"'":q<_.length?"'"+Q+_.slice(q)+"'":"'"+Q+"'"}function V(_,q){for(_=_.toString();_.length<q;)_="0"+_;return _}function w(_){if(_==="Z")return 0;var q=_.match(/([\+\-\s])(\d\d):?(\d\d)?/);return q?(q[1]==="-"?-1:1)*(parseInt(q[2],10)+(q[3]?parseInt(q[3],10):0)/60)*60:!1}},1063:(Te,ce,y)=>{"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D=y(96540);function T(Q,K){return Q===K&&(Q!==0||1/Q===1/K)||Q!==Q&&K!==K}var j=typeof Object.is=="function"?Object.is:T,$=D.useState,H=D.useEffect,E=D.useLayoutEffect,C=D.useDebugValue;function V(Q,K){var Y=K(),le=$({inst:{value:Y,getSnapshot:K}}),z=le[0].inst,be=le[1];return E(function(){z.value=Y,z.getSnapshot=K,w(z)&&be({inst:z})},[Q,Y,K]),H(function(){return w(z)&&be({inst:z}),Q(function(){w(z)&&be({inst:z})})},[Q]),C(Y),Y}function w(Q){var K=Q.getSnapshot;Q=Q.value;try{var Y=K();return!j(Q,Y)}catch{return!0}}function _(Q,K){return K()}var q=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?_:V;ce.useSyncExternalStore=D.useSyncExternalStore!==void 0?D.useSyncExternalStore:q},88940:(Te,ce,y)=>{"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D=y(96540),T=y(19888);function j(_,q){return _===q&&(_!==0||1/_===1/q)||_!==_&&q!==q}var $=typeof Object.is=="function"?Object.is:j,H=T.useSyncExternalStore,E=D.useRef,C=D.useEffect,V=D.useMemo,w=D.useDebugValue;ce.useSyncExternalStoreWithSelector=function(_,q,Q,K,Y){var le=E(null);if(le.current===null){var z={hasValue:!1,value:null};le.current=z}else z=le.current;le=V(function(){function Ge(Me){if(!Ke){if(Ke=!0,Ie=Me,Me=K(Me),Y!==void 0&&z.hasValue){var Ve=z.value;if(Y(Ve,Me))return Ee=Ve}return Ee=Me}if(Ve=Ee,$(Ie,Me))return Ve;var Xe=K(Me);return Y!==void 0&&Y(Ve,Xe)?Ve:(Ie=Me,Ee=Xe)}var Ke=!1,Ie,Ee,ge=Q===void 0?null:Q;return[function(){return Ge(q())},ge===null?void 0:function(){return Ge(ge())}]},[q,Q,K,Y]);var be=H(_,le[0],le[1]);return C(function(){z.hasValue=!0,z.value=be},[be]),w(be),be}},19888:(Te,ce,y)=>{"use strict";Te.exports=y(1063)},69242:(Te,ce,y)=>{"use strict";Te.exports=y(88940)},4633:(Te,ce,y)=>{var D=y(73738).default;function T(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Te.exports=T=function(){return $},Te.exports.__esModule=!0,Te.exports.default=Te.exports;var j,$={},H=Object.prototype,E=H.hasOwnProperty,C=Object.defineProperty||function(me,oe,pe){me[oe]=pe.value},V=typeof Symbol=="function"?Symbol:{},w=V.iterator||"@@iterator",_=V.asyncIterator||"@@asyncIterator",q=V.toStringTag||"@@toStringTag";function Q(me,oe,pe){return Object.defineProperty(me,oe,{value:pe,enumerable:!0,configurable:!0,writable:!0}),me[oe]}try{Q({},"")}catch{Q=function(pe,De,xe){return pe[De]=xe}}function K(me,oe,pe,De){var xe=oe&&oe.prototype instanceof Ie?oe:Ie,ae=Object.create(xe.prototype),m=new fr(De||[]);return C(ae,"_invoke",{value:vr(me,pe,m)}),ae}function Y(me,oe,pe){try{return{type:"normal",arg:me.call(oe,pe)}}catch(De){return{type:"throw",arg:De}}}$.wrap=K;var le="suspendedStart",z="suspendedYield",be="executing",Ge="completed",Ke={};function Ie(){}function Ee(){}function ge(){}var Me={};Q(Me,w,function(){return this});var Ve=Object.getPrototypeOf,Xe=Ve&&Ve(Ve(et([])));Xe&&Xe!==H&&E.call(Xe,w)&&(Me=Xe);var pr=ge.prototype=Ie.prototype=Object.create(Me);function $e(me){["next","throw","return"].forEach(function(oe){Q(me,oe,function(pe){return this._invoke(oe,pe)})})}function Ye(me,oe){function pe(xe,ae,m,Le){var er=Y(me[xe],me,ae);if(er.type!=="throw"){var ot=er.arg,Rr=ot.value;return Rr&&D(Rr)=="object"&&E.call(Rr,"__await")?oe.resolve(Rr.__await).then(function(jr){pe("next",jr,m,Le)},function(jr){pe("throw",jr,m,Le)}):oe.resolve(Rr).then(function(jr){ot.value=jr,m(ot)},function(jr){return pe("throw",jr,m,Le)})}Le(er.arg)}var De;C(this,"_invoke",{value:function(ae,m){function Le(){return new oe(function(er,ot){pe(ae,m,er,ot)})}return De=De?De.then(Le,Le):Le()}})}function vr(me,oe,pe){var De=le;return function(xe,ae){if(De===be)throw Error("Generator is already running");if(De===Ge){if(xe==="throw")throw ae;return{value:j,done:!0}}for(pe.method=xe,pe.arg=ae;;){var m=pe.delegate;if(m){var Le=Jr(m,pe);if(Le){if(Le===Ke)continue;return Le}}if(pe.method==="next")pe.sent=pe._sent=pe.arg;else if(pe.method==="throw"){if(De===le)throw De=Ge,pe.arg;pe.dispatchException(pe.arg)}else pe.method==="return"&&pe.abrupt("return",pe.arg);De=be;var er=Y(me,oe,pe);if(er.type==="normal"){if(De=pe.done?Ge:z,er.arg===Ke)continue;return{value:er.arg,done:pe.done}}er.type==="throw"&&(De=Ge,pe.method="throw",pe.arg=er.arg)}}}function Jr(me,oe){var pe=oe.method,De=me.iterator[pe];if(De===j)return oe.delegate=null,pe==="throw"&&me.iterator.return&&(oe.method="return",oe.arg=j,Jr(me,oe),oe.method==="throw")||pe!=="return"&&(oe.method="throw",oe.arg=new TypeError("The iterator does not provide a '"+pe+"' method")),Ke;var xe=Y(De,me.iterator,oe.arg);if(xe.type==="throw")return oe.method="throw",oe.arg=xe.arg,oe.delegate=null,Ke;var ae=xe.arg;return ae?ae.done?(oe[me.resultName]=ae.value,oe.next=me.nextLoc,oe.method!=="return"&&(oe.method="next",oe.arg=j),oe.delegate=null,Ke):ae:(oe.method="throw",oe.arg=new TypeError("iterator result is not an object"),oe.delegate=null,Ke)}function Qr(me){var oe={tryLoc:me[0]};1 in me&&(oe.catchLoc=me[1]),2 in me&&(oe.finallyLoc=me[2],oe.afterLoc=me[3]),this.tryEntries.push(oe)}function gt(me){var oe=me.completion||{};oe.type="normal",delete oe.arg,me.completion=oe}function fr(me){this.tryEntries=[{tryLoc:"root"}],me.forEach(Qr,this),this.reset(!0)}function et(me){if(me||me===""){var oe=me[w];if(oe)return oe.call(me);if(typeof me.next=="function")return me;if(!isNaN(me.length)){var pe=-1,De=function xe(){for(;++pe<me.length;)if(E.call(me,pe))return xe.value=me[pe],xe.done=!1,xe;return xe.value=j,xe.done=!0,xe};return De.next=De}}throw new TypeError(D(me)+" is not iterable")}return Ee.prototype=ge,C(pr,"constructor",{value:ge,configurable:!0}),C(ge,"constructor",{value:Ee,configurable:!0}),Ee.displayName=Q(ge,q,"GeneratorFunction"),$.isGeneratorFunction=function(me){var oe=typeof me=="function"&&me.constructor;return!!oe&&(oe===Ee||(oe.displayName||oe.name)==="GeneratorFunction")},$.mark=function(me){return Object.setPrototypeOf?Object.setPrototypeOf(me,ge):(me.__proto__=ge,Q(me,q,"GeneratorFunction")),me.prototype=Object.create(pr),me},$.awrap=function(me){return{__await:me}},$e(Ye.prototype),Q(Ye.prototype,_,function(){return this}),$.AsyncIterator=Ye,$.async=function(me,oe,pe,De,xe){xe===void 0&&(xe=Promise);var ae=new Ye(K(me,oe,pe,De),xe);return $.isGeneratorFunction(oe)?ae:ae.next().then(function(m){return m.done?m.value:ae.next()})},$e(pr),Q(pr,q,"Generator"),Q(pr,w,function(){return this}),Q(pr,"toString",function(){return"[object Generator]"}),$.keys=function(me){var oe=Object(me),pe=[];for(var De in oe)pe.push(De);return pe.reverse(),function xe(){for(;pe.length;){var ae=pe.pop();if(ae in oe)return xe.value=ae,xe.done=!1,xe}return xe.done=!0,xe}},$.values=et,fr.prototype={constructor:fr,reset:function(oe){if(this.prev=0,this.next=0,this.sent=this._sent=j,this.done=!1,this.delegate=null,this.method="next",this.arg=j,this.tryEntries.forEach(gt),!oe)for(var pe in this)pe.charAt(0)==="t"&&E.call(this,pe)&&!isNaN(+pe.slice(1))&&(this[pe]=j)},stop:function(){this.done=!0;var oe=this.tryEntries[0].completion;if(oe.type==="throw")throw oe.arg;return this.rval},dispatchException:function(oe){if(this.done)throw oe;var pe=this;function De(ot,Rr){return m.type="throw",m.arg=oe,pe.next=ot,Rr&&(pe.method="next",pe.arg=j),!!Rr}for(var xe=this.tryEntries.length-1;xe>=0;--xe){var ae=this.tryEntries[xe],m=ae.completion;if(ae.tryLoc==="root")return De("end");if(ae.tryLoc<=this.prev){var Le=E.call(ae,"catchLoc"),er=E.call(ae,"finallyLoc");if(Le&&er){if(this.prev<ae.catchLoc)return De(ae.catchLoc,!0);if(this.prev<ae.finallyLoc)return De(ae.finallyLoc)}else if(Le){if(this.prev<ae.catchLoc)return De(ae.catchLoc,!0)}else{if(!er)throw Error("try statement without catch or finally");if(this.prev<ae.finallyLoc)return De(ae.finallyLoc)}}}},abrupt:function(oe,pe){for(var De=this.tryEntries.length-1;De>=0;--De){var xe=this.tryEntries[De];if(xe.tryLoc<=this.prev&&E.call(xe,"finallyLoc")&&this.prev<xe.finallyLoc){var ae=xe;break}}ae&&(oe==="break"||oe==="continue")&&ae.tryLoc<=pe&&pe<=ae.finallyLoc&&(ae=null);var m=ae?ae.completion:{};return m.type=oe,m.arg=pe,ae?(this.method="next",this.next=ae.finallyLoc,Ke):this.complete(m)},complete:function(oe,pe){if(oe.type==="throw")throw oe.arg;return oe.type==="break"||oe.type==="continue"?this.next=oe.arg:oe.type==="return"?(this.rval=this.arg=oe.arg,this.method="return",this.next="end"):oe.type==="normal"&&pe&&(this.next=pe),Ke},finish:function(oe){for(var pe=this.tryEntries.length-1;pe>=0;--pe){var De=this.tryEntries[pe];if(De.finallyLoc===oe)return this.complete(De.completion,De.afterLoc),gt(De),Ke}},catch:function(oe){for(var pe=this.tryEntries.length-1;pe>=0;--pe){var De=this.tryEntries[pe];if(De.tryLoc===oe){var xe=De.completion;if(xe.type==="throw"){var ae=xe.arg;gt(De)}return ae}}throw Error("illegal catch attempt")},delegateYield:function(oe,pe,De){return this.delegate={iterator:et(oe),resultName:pe,nextLoc:De},this.method==="next"&&(this.arg=j),Ke}},$}Te.exports=T,Te.exports.__esModule=!0,Te.exports.default=Te.exports},73738:Te=>{function ce(y){"@babel/helpers - typeof";return Te.exports=ce=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},Te.exports.__esModule=!0,Te.exports.default=Te.exports,ce(y)}Te.exports=ce,Te.exports.__esModule=!0,Te.exports.default=Te.exports},54756:(Te,ce,y)=>{var D=y(4633)();Te.exports=D;try{regeneratorRuntime=D}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=D:Function("r","regeneratorRuntime = r")(D)}}}]);

//# sourceMappingURL=4669.fba5b2f5e8aafdaba958.js.map